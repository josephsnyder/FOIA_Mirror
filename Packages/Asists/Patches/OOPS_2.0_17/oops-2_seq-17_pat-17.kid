Released OOPS*2*17 SEQ #17
Extracted from mail message
**KIDS**:OOPS*2.0*17^

**INSTALL NAME**
OOPS*2.0*17
"BLD",7848,0)
OOPS*2.0*17^ASISTS^0^3081008^y
"BLD",7848,1,0)
^^1^1^3081007^^
"BLD",7848,1,1,0)
This patch provides a fix to transmission errors received from Austin. 
"BLD",7848,4,0)
^9.64PA^^
"BLD",7848,6.3)
2
"BLD",7848,"KRN",0)
^9.67PA^8989.52^19
"BLD",7848,"KRN",.4,0)
.4
"BLD",7848,"KRN",.401,0)
.401
"BLD",7848,"KRN",.402,0)
.402
"BLD",7848,"KRN",.403,0)
.403
"BLD",7848,"KRN",.5,0)
.5
"BLD",7848,"KRN",.84,0)
.84
"BLD",7848,"KRN",3.6,0)
3.6
"BLD",7848,"KRN",3.8,0)
3.8
"BLD",7848,"KRN",9.2,0)
9.2
"BLD",7848,"KRN",9.8,0)
9.8
"BLD",7848,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7848,"KRN",9.8,"NM",1,0)
OOPSDOLX^^0^B23349324
"BLD",7848,"KRN",9.8,"NM",2,0)
OOPSDOL2^^0^B49496083
"BLD",7848,"KRN",9.8,"NM",3,0)
OOPSDOL1^^0^B67499196
"BLD",7848,"KRN",9.8,"NM","B","OOPSDOL1",3)

"BLD",7848,"KRN",9.8,"NM","B","OOPSDOL2",2)

"BLD",7848,"KRN",9.8,"NM","B","OOPSDOLX",1)

"BLD",7848,"KRN",19,0)
19
"BLD",7848,"KRN",19.1,0)
19.1
"BLD",7848,"KRN",101,0)
101
"BLD",7848,"KRN",409.61,0)
409.61
"BLD",7848,"KRN",771,0)
771
"BLD",7848,"KRN",870,0)
870
"BLD",7848,"KRN",8989.51,0)
8989.51
"BLD",7848,"KRN",8989.52,0)
8989.52
"BLD",7848,"KRN",8994,0)
8994
"BLD",7848,"KRN","B",.4,.4)

"BLD",7848,"KRN","B",.401,.401)

"BLD",7848,"KRN","B",.402,.402)

"BLD",7848,"KRN","B",.403,.403)

"BLD",7848,"KRN","B",.5,.5)

"BLD",7848,"KRN","B",.84,.84)

"BLD",7848,"KRN","B",3.6,3.6)

"BLD",7848,"KRN","B",3.8,3.8)

"BLD",7848,"KRN","B",9.2,9.2)

"BLD",7848,"KRN","B",9.8,9.8)

"BLD",7848,"KRN","B",19,19)

"BLD",7848,"KRN","B",19.1,19.1)

"BLD",7848,"KRN","B",101,101)

"BLD",7848,"KRN","B",409.61,409.61)

"BLD",7848,"KRN","B",771,771)

"BLD",7848,"KRN","B",870,870)

"BLD",7848,"KRN","B",8989.51,8989.51)

"BLD",7848,"KRN","B",8989.52,8989.52)

"BLD",7848,"KRN","B",8994,8994)

"BLD",7848,"QUES",0)
^9.62^^
"BLD",7848,"REQB",0)
^9.611^2^2
"BLD",7848,"REQB",1,0)
OOPS*2.0*11^2
"BLD",7848,"REQB",2,0)
OOPS*2.0*7^2
"BLD",7848,"REQB","B","OOPS*2.0*11",1)

"BLD",7848,"REQB","B","OOPS*2.0*7",2)

"MBREQ")
0
"PKG",513,-1)
1^1
"PKG",513,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",513,20,0)
^9.402P^^
"PKG",513,22,0)
^9.49I^1^1
"PKG",513,22,1,0)
2.0^3020709^3030619^2
"PKG",513,22,1,"PAH",1,0)
17^3081008
"PKG",513,22,1,"PAH",1,1,0)
^^1^1^3081008
"PKG",513,22,1,"PAH",1,1,1,0)
This patch provides a fix to transmission errors received from Austin. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","OOPSDOL1")
0^3^B67499196^B66731874
"RTN","OOPSDOL1",1,0)
OOPSDOL1 ;WIOFO/CAH-CA1 EXTRACT FOR DOL ;3/15/00
"RTN","OOPSDOL1",2,0)
 ;;2.0;ASISTS;**4,7,17**;Jun 03, 2002;Build 2
"RTN","OOPSDOL1",3,0)
EN ; Entry
"RTN","OOPSDOL1",4,0)
 N OCC,NAME,FN,KK,D62,D123,D124,D126,WITN
"RTN","OOPSDOL1",5,0)
 S OOPSAR("CA")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA")))
"RTN","OOPSDOL1",6,0)
 S OOPSAR(0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,0)))
"RTN","OOPSDOL1",7,0)
 S OOPSAR("CA1A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1A")))
"RTN","OOPSDOL1",8,0)
 S OOPSAR("CA1B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1B")))
"RTN","OOPSDOL1",9,0)
 S OOPSAR("CA1C")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1C")))
"RTN","OOPSDOL1",10,0)
 S OOPSAR("CA1D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1D")))
"RTN","OOPSDOL1",11,0)
 S OOPSAR("CA1ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1ES")))
"RTN","OOPSDOL1",12,0)
 S OOPSAR("CA1F")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1F")))
"RTN","OOPSDOL1",13,0)
 S OOPSAR("CA1G")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1G")))
"RTN","OOPSDOL1",14,0)
 S OOPSAR("CA1H")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1H")))
"RTN","OOPSDOL1",15,0)
 S OOPSAR("CA1I")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1I")))
"RTN","OOPSDOL1",16,0)
 S OOPSAR("CA1J")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1J",0)))
"RTN","OOPSDOL1",17,0)
 S OOPSAR("CA1K")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1K",0)))
"RTN","OOPSDOL1",18,0)
 S OOPSAR("CA1L")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1L")))
"RTN","OOPSDOL1",19,0)
 S OOPSAR("CA1M")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1M")))
"RTN","OOPSDOL1",20,0)
 S OOPSAR("CA1N")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1N")))
"RTN","OOPSDOL1",21,0)
 ; get witness data once
"RTN","OOPSDOL1",22,0)
 S WITN=$O(^OOPS(2260,OOPDA,"CA1W",0))
"RTN","OOPSDOL1",23,0)
 I $G(WITN)'="" D
"RTN","OOPSDOL1",24,0)
 . S OOPSAR("CA1W",0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1W",WITN,0)))
"RTN","OOPSDOL1",25,0)
 . S OOPSAR("CA1W",1)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1W",WITN,1)))
"RTN","OOPSDOL1",26,0)
OP02 ; Seg OP02
"RTN","OOPSDOL1",27,0)
 K OPX
"RTN","OOPSDOL1",28,0)
 N OFF
"RTN","OOPSDOL1",29,0)
 S OFF=$$GET1^DIQ(2260,OOPDA,"73:1")
"RTN","OOPSDOL1",30,0)
 S OPX="OP02^"_$E("00",$L(OFF)+1,2)_OFF
"RTN","OOPSDOL1",31,0)
 S OPX=OPX_U_$P(OOPSAR("CA1M"),U,1)_U_$P(OOPSAR("CA1M"),U,2)
"RTN","OOPSDOL1",32,0)
 S OPX=OPX_U_$P(OOPSAR("CA1M"),U,3)_U_$$GET1^DIQ(2260,OOPDA,"179:1")
"RTN","OOPSDOL1",33,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA1M"),U,5),1,5)_U_$P(OOPSAR("CA1F"),U,1)
"RTN","OOPSDOL1",34,0)
 S OPX=OPX_U_$P(OOPSAR("CA1F"),U,2)_U_$P(OOPSAR("CA1F"),U,3)
"RTN","OOPSDOL1",35,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"133:1")_U_$E($P(OOPSAR("CA1F"),U,5),1,5)
"RTN","OOPSDOL1",36,0)
 S OPX=OPX_U_U_U_"^|"
"RTN","OOPSDOL1",37,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",38,0)
OP03 ; Seg OP03
"RTN","OOPSDOL1",39,0)
 K OPX
"RTN","OOPSDOL1",40,0)
 S OPX="OP03^"_$$GET1^DIQ(2260,OOPDA,60,"E")
"RTN","OOPSDOL1",41,0)
 S OPX=OPX_U_$P(OOPSAR("CA"),U,5)
"RTN","OOPSDOL1",42,0)
 S D62=$$GET1^DIQ(2260,OOPDA,"62:1"),D123=$$GET1^DIQ(2260,OOPDA,"123:1")
"RTN","OOPSDOL1",43,0)
 S D124=$$GET1^DIQ(2260,OOPDA,"124:1"),D126=$$GET1^DIQ(2260,OOPDA,"126:1")
"RTN","OOPSDOL1",44,0)
 S OPX=OPX_U_$E("000",$L(D123)+1,3)_D123
"RTN","OOPSDOL1",45,0)
 S OPX=OPX_U_$E("0000",$L(D124)+1,4)_D124
"RTN","OOPSDOL1",46,0)
 S OPX=OPX_U_$E("00",$L(D62)+1,2)_D62
"RTN","OOPSDOL1",47,0)
 S OPX=OPX_U_$E("00",$L(D126)+1,2)_D126
"RTN","OOPSDOL1",48,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1L"),U,7))
"RTN","OOPSDOL1",49,0)
 S NAME=$$GET1^DIQ(2260,OOPDA,"169:.01"),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",50,0)
 S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",51,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",52,0)
 S OPX=OPX_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL1",53,0)
 S OPX=OPX_U_$P(OOPSAR("CA1L"),U,4)_U_$$MKNUM^OOPSUTL2($P(OOPSAR("CA1L"),U,5))
"RTN","OOPSDOL1",54,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1ES"),U,6))
"RTN","OOPSDOL1",55,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1I"),U,6))
"RTN","OOPSDOL1",56,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR(0),U,5),"."))_"^|"
"RTN","OOPSDOL1",57,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",58,0)
OP04 ; Seg OP04
"RTN","OOPSDOL1",59,0)
 K OPX
"RTN","OOPSDOL1",60,0)
 N CAT,GRD,STP,PAYP
"RTN","OOPSDOL1",61,0)
 S CAT=$$GET1^DIQ(2260,OOPDA,2,"I"),PAYP=$P(OOPSAR(0),U,13)
"RTN","OOPSDOL1",62,0)
 S GRD=$P(OOPSAR("2162A"),U,12),STP=$P(OOPSAR("2162A"),U,13)
"RTN","OOPSDOL1",63,0)
 I STP="N" S STP=" N"  ; special case on step
"RTN","OOPSDOL1",64,0)
 S OPX="OP04^"_$$DC^OOPSUTL3($P(OOPSAR("CA1ES"),U,3))
"RTN","OOPSDOL1",65,0)
 I $P(OOPSAR("CA1F"),U,13) D
"RTN","OOPSDOL1",66,0)
 .S Y=$P(OOPSAR("CA1F"),U,13) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL1",67,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA1F"),U,13),"."))_Y
"RTN","OOPSDOL1",68,0)
 I '$P(OOPSAR("CA1F"),U,13) S OPX=OPX_U
"RTN","OOPSDOL1",69,0)
 I $P(OOPSAR("CA1G"),U,3) D
"RTN","OOPSDOL1",70,0)
 .S Y=$P(OOPSAR("CA1G"),U,3) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL1",71,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA1G"),U,3),"."))_Y
"RTN","OOPSDOL1",72,0)
 I '$P(OOPSAR("CA1G"),U,3) S OPX=OPX_U
"RTN","OOPSDOL1",73,0)
 I $P(OOPSAR("CA1G"),U,2) D
"RTN","OOPSDOL1",74,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1G"),U,2))
"RTN","OOPSDOL1",75,0)
 I '$P(OOPSAR("CA1G"),U,2) S OPX=OPX_U
"RTN","OOPSDOL1",76,0)
 S RPOL=$P(OOPSAR("CA1A"),U,13)
"RTN","OOPSDOL1",77,0)
 S VAL=$S(RPOL="COP":"RS",RPOL="L":"ZZ",1:"NU")
"RTN","OOPSDOL1",78,0)
 S OPX=OPX_U_VAL_U_$P(OOPSAR("CA1I"),U,7)
"RTN","OOPSDOL1",79,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U,13),1,2)
"RTN","OOPSDOL1",80,0)
 ; V2.0 - fix Grade/Step, send nill if Volunteer or Fee Basis
"RTN","OOPSDOL1",81,0)
 I CAT=2!(PAYP="OT") S OPX=OPX_U_""
"RTN","OOPSDOL1",82,0)
 E  S OPX=OPX_U_$E("00",$L(GRD)+1,2)_GRD
"RTN","OOPSDOL1",83,0)
 I (CAT=2)!(PAYP="OT") S OPX=OPX_U_""
"RTN","OOPSDOL1",84,0)
 E  S OPX=OPX_U_$E("00",$L(STP)+1,2)_STP
"RTN","OOPSDOL1",85,0)
 I $P(OOPSAR("CA1A"),U,8)=1!($P(OOPSAR("CA1A"),U,8)=4)!($P(OOPSAR("CA1A"),U,8)=5)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",86,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",87,0)
 I $P(OOPSAR("CA1A"),U,8)=2!($P(OOPSAR("CA1A"),U,8)=4)!($P(OOPSAR("CA1A"),U,8)=6)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",88,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",89,0)
 I $P(OOPSAR("CA1A"),U,8)=3!($P(OOPSAR("CA1A"),U,8)=5)!($P(OOPSAR("CA1A"),U,8)=6)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",90,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",91,0)
 S OPX=OPX_U_"Y^Y^Y^Y"
"RTN","OOPSDOL1",92,0)
 I $G(WITN) D
"RTN","OOPSDOL1",93,0)
 . S NM=$P($G(OOPSAR("CA1W",0)),U)
"RTN","OOPSDOL1",94,0)
 . S:$G(NM)'="" OPX=OPX_U_"Y" S:$G(NM)="" OPX=OPX_U_"N"
"RTN","OOPSDOL1",95,0)
 . S WS=$P($G(OOPSAR("CA1W",0)),U,6)
"RTN","OOPSDOL1",96,0)
 . S:$G(WS) OPX=OPX_U_"Y" S:'$G(WS) OPX=OPX_U
"RTN","OOPSDOL1",97,0)
 . K NM,WS
"RTN","OOPSDOL1",98,0)
 I '$G(WITN) S OPX=OPX_"^N^N"
"RTN","OOPSDOL1",99,0)
 S OPX=OPX_U_"ASISTS^C2^Y^"
"RTN","OOPSDOL1",100,0)
 S OPX=OPX_$$DC^OOPSUTL3($P(OOPSAR("CA1A"),U,11))
"RTN","OOPSDOL1",101,0)
 S OPX=OPX_U_$P(OOPSAR("CA1A"),U,9)
"RTN","OOPSDOL1",102,0)
 S OPX=OPX_U_$P(OOPSAR("CA1N"),U)
"RTN","OOPSDOL1",103,0)
 S OPX=OPX_U_$P(OOPSAR("CA1N"),U,2)
"RTN","OOPSDOL1",104,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"185:1")
"RTN","OOPSDOL1",105,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA1A"),U,14),1,5)_"^|"
"RTN","OOPSDOL1",106,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",107,0)
OP05 ; Seg OP05
"RTN","OOPSDOL1",108,0)
 ;V2.0 if Pay Plan="OT" emp is Fee Basis send "C" in PPER
"RTN","OOPSDOL1",109,0)
 N PPER
"RTN","OOPSDOL1",110,0)
 S PPER=$P(OOPSAR("CA1L"),U,2) I (PAYP="OT") S PPER="C"
"RTN","OOPSDOL1",111,0)
 K OPX
"RTN","OOPSDOL1",112,0)
 S OPX="OP05^"_$P(OOPSAR("CA1G"),U,8)_U_$P(OOPSAR("CA1H"),U)
"RTN","OOPSDOL1",113,0)
 S OPX=OPX_U_$P(OOPSAR("CA1H"),U,2)_U_$P(OOPSAR("CA1H"),U,3)
"RTN","OOPSDOL1",114,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"154:1")_U_$E($P(OOPSAR("CA1H"),U,5),1,5)
"RTN","OOPSDOL1",115,0)
 I $P(OOPSAR("CA1I"),U)'="" D
"RTN","OOPSDOL1",116,0)
 .S OPX=OPX_U_1
"RTN","OOPSDOL1",117,0)
 .S NAME=$P(OOPSAR("CA1I"),U),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",118,0)
 .F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",119,0)
 .S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",120,0)
 .S OPX=OPX_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL1",121,0)
 .S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"182:1")
"RTN","OOPSDOL1",122,0)
 I $P(OOPSAR("CA1I"),U)="" S OPX=OPX_U_"3^^^^"
"RTN","OOPSDOL1",123,0)
 S OPX=OPX_U_$P(OOPSAR("CA1I"),U,2)_U_$P(OOPSAR("CA1I"),U,3)
"RTN","OOPSDOL1",124,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"159:1")_U_$E($P(OOPSAR("CA1I"),U,5),1,5)
"RTN","OOPSDOL1",125,0)
 ; if the claim is for a volunteer both the pay rate and the pay period
"RTN","OOPSDOL1",126,0)
 ; should be blank - llh 12/29/03
"RTN","OOPSDOL1",127,0)
 I CAT=2 S OPX=OPX_U_U_"^|"
"RTN","OOPSDOL1",128,0)
 E  S OPX=OPX_U_$P(OOPSAR("CA1L"),U)_U_PPER_"^|"
"RTN","OOPSDOL1",129,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",130,0)
OP06 ; Seg OP06
"RTN","OOPSDOL1",131,0)
 S DATA=$$CONV^OOPSUTL5($P(OOPSAR("CA1F"),U,11))
"RTN","OOPSDOL1",132,0)
 K OPX
"RTN","OOPSDOL1",133,0)
 S OPX="OP06"
"RTN","OOPSDOL1",134,0)
 F X=1:1:7 D
"RTN","OOPSDOL1",135,0)
 .I DATA[X D
"RTN","OOPSDOL1",136,0)
 ..S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",137,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA1F"),U,9))
"RTN","OOPSDOL1",138,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA1F"),U,10))
"RTN","OOPSDOL1",139,0)
 .I DATA'[X S OPX=OPX_"^N^^"
"RTN","OOPSDOL1",140,0)
 ; Generate Occ Code for DOL transfer
"RTN","OOPSDOL1",141,0)
 S OCC=$$GET1^DIQ(2260,OOPDA,15)      ; Occupation code from PAID
"RTN","OOPSDOL1",142,0)
 S OCC=$S(OCC<2300:"G"_OCC,(OCC>2499&(OCC<9001)):"W"_OCC,(OCC=9999):"Z"_OCC,1:"")
"RTN","OOPSDOL1",143,0)
 S OPX=OPX_U_OCC_U_$P(OOPSAR("CA1A"),U,12)_"^|"
"RTN","OOPSDOL1",144,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",145,0)
 K DATA
"RTN","OOPSDOL1",146,0)
OP07 ; Seg OP07
"RTN","OOPSDOL1",147,0)
 K OPX
"RTN","OOPSDOL1",148,0)
 I $L($P(OOPSAR("CA1B"),U))<133 D
"RTN","OOPSDOL1",149,0)
 .S OPX="OP07^1^1^"_$P(OOPSAR("CA1B"),U)_"^|"
"RTN","OOPSDOL1",150,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",151,0)
 I $L($P(OOPSAR("CA1B"),U))>132 D
"RTN","OOPSDOL1",152,0)
 .S OPX="OP07^1^2^"_$E($P(OOPSAR("CA1B"),U),1,132)_"^|"
"RTN","OOPSDOL1",153,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",154,0)
 .K OPX
"RTN","OOPSDOL1",155,0)
 .S OPX="OP07^2^2^"_$E($P(OOPSAR("CA1B"),U),133,200)_"^|"
"RTN","OOPSDOL1",156,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",157,0)
OP08 ; Seg OP08
"RTN","OOPSDOL1",158,0)
 N BK36 S BK36="" K OPX
"RTN","OOPSDOL1",159,0)
 S OPX="OP08^"_$S($P(OOPSAR("CA1G"),U,4)="N":"NW",1:"")
"RTN","OOPSDOL1",160,0)
 S OPX=OPX_U_$S($P(OOPSAR("CA1G"),U,6)="Y":"WM",1:"")
"RTN","OOPSDOL1",161,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1G"),U))
"RTN","OOPSDOL1",162,0)
 I $G(OOPSAR("CA1K"))'="",($P(OOPSAR("CA1K"),U,4)'=0) S BK36="E5"
"RTN","OOPSDOL1",163,0)
 ;I $G(OOPSAR("CA1I"))'="",($P(OOPSAR("CA1I"),U,12)'="") S BK36="E5"
"RTN","OOPSDOL1",164,0)
 I $G(OOPSAR("CA1I"))'="" D
"RTN","OOPSDOL1",165,0)
 .I $P(OOPSAR("CA1I"),U,12)'="" S BK36="E5"
"RTN","OOPSDOL1",166,0)
 .I $P(OOPSAR("CA1I"),U,13)'="" S BK36="E5"
"RTN","OOPSDOL1",167,0)
 S OPX=OPX_U_BK36_U
"RTN","OOPSDOL1",168,0)
 I $P(OOPSAR("CA1I"),U,8)="N" S OPX=OPX_U_"CN"
"RTN","OOPSDOL1",169,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",170,0)
 I $P(OOPSAR("CA1L"),U,3)'="" S OPX=OPX_U_97
"RTN","OOPSDOL1",171,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",172,0)
 I $G(OOPSAR("CA1W",0))'="" D
"RTN","OOPSDOL1",173,0)
 . S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",174,0)
 . S NAME=$P(OOPSAR("CA1W",0),U),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",175,0)
 . F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",176,0)
 . S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",177,0)
 . S OPX=OPX_U_$E($P(FN," "),1,10)_U
"RTN","OOPSDOL1",178,0)
 . S OPX=OPX_U_$P(OOPSAR("CA1W",0),U,2)
"RTN","OOPSDOL1",179,0)
 . S OPX=OPX_U_$P(OOPSAR("CA1W",0),U,3)
"RTN","OOPSDOL1",180,0)
 . S OPX=OPX_U_$$GET1^DIQ(5,$P(OOPSAR("CA1W",0),U,4),1)  ; State Code
"RTN","OOPSDOL1",181,0)
 . S OPX=OPX_U_$E($P(OOPSAR("CA1W",0),U,5),1,5)
"RTN","OOPSDOL1",182,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1W",0),U,6))
"RTN","OOPSDOL1",183,0)
 I $G(OOPSAR("CA1W",0))="" S OPX=OPX_U_"^^^^^^^^"
"RTN","OOPSDOL1",184,0)
 S FL174=$P(OOPSAR("CA1L"),U,6)  ;FILING INSTRUCTION
"RTN","OOPSDOL1",185,0)
 S CATY=$S(FL174=1:"2^0",FL174=2:"2^1",FL174=3:"1^",FL174=4:"6^",1:"")
"RTN","OOPSDOL1",186,0)
 S OPX=OPX_U_CATY_"^|"
"RTN","OOPSDOL1",187,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",188,0)
OP09 ; Seg OP09
"RTN","OOPSDOL1",189,0)
 I $P(OOPSAR("CA1G"),U,4)="N" D
"RTN","OOPSDOL1",190,0)
 .K OPX
"RTN","OOPSDOL1",191,0)
 .S OPX="OP09^1^1^"_$P(OOPSAR("CA1G"),U,5)_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",192,0)
OP10 ; Seg OP10
"RTN","OOPSDOL1",193,0)
 I $P(OOPSAR("CA1G"),U,7)'="" D
"RTN","OOPSDOL1",194,0)
 .K OPX
"RTN","OOPSDOL1",195,0)
 .S OPX="OP10^1^1^"_$P(OOPSAR("CA1G"),U,7)_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",196,0)
OP11 ; Seg OP11 - Reason for Convert (Word Processing)
"RTN","OOPSDOL1",197,0)
 I ($G(OOPSAR("CA1K"))'="")!($P($G(OOPSAR("CA1I")),U,12)'="") D
"RTN","OOPSDOL1",198,0)
 .S OPFLD=165,SEG="OP11" D WP^OOPSDOLX
"RTN","OOPSDOL1",199,0)
OP12 ; Seg OP12 - Supervisor not agree explain (Word Processing)
"RTN","OOPSDOL1",200,0)
 I $G(OOPSAR("CA1J"))'="" D
"RTN","OOPSDOL1",201,0)
 .S OPFLD=164,SEG="OP12" D WP^OOPSDOLX
"RTN","OOPSDOL1",202,0)
OP13 ; Seg OP13 - Nature of Injury
"RTN","OOPSDOL1",203,0)
 I $P(OOPSAR("CA1C"),U)'="" D
"RTN","OOPSDOL1",204,0)
 .K OPX
"RTN","OOPSDOL1",205,0)
 .S OPX="OP13^1^1^"_$P(OOPSAR("CA1C"),U)_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",206,0)
OP14 ; Seg OP14 - Supervisor Exception
"RTN","OOPSDOL1",207,0)
 I $P(OOPSAR("CA1L"),U,3)'="" D
"RTN","OOPSDOL1",208,0)
 .K OPX
"RTN","OOPSDOL1",209,0)
 .S OPX="OP14^1^1"
"RTN","OOPSDOL1",210,0)
 .S OPX=OPX_U_$P(OOPSAR("CA1L"),U,3)_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",211,0)
OP20 ; Seg OP20
"RTN","OOPSDOL1",212,0)
 K OPX
"RTN","OOPSDOL1",213,0)
 I $P(OOPSAR("2162B"),U,4)'="" D
"RTN","OOPSDOL1",214,0)
 .S OPX="OP20^"_"P"_U_$$GET1^DIQ(2260,OOPDA,"30:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",215,0)
 .Q
"RTN","OOPSDOL1",216,0)
OP21 ; Seg OP21 Defined for future use
"RTN","OOPSDOL1",217,0)
OP22 ; Seg OP22 Defined for future use
"RTN","OOPSDOL1",218,0)
OP23 ; Seg OP23 - Statement of Witness (Not yet used)
"RTN","OOPSDOL1",219,0)
 I $G(OOPSAR("CA1W",1))'="" D
"RTN","OOPSDOL1",220,0)
 . I $L(OOPSAR("CA1W",1))<133 D
"RTN","OOPSDOL1",221,0)
 .. K OPX
"RTN","OOPSDOL1",222,0)
 .. S OPX="OP23^1^1^"_OOPSAR("CA1W",1)_"^|"
"RTN","OOPSDOL1",223,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",224,0)
 . I $L(OOPSAR("CA1W",1))>132 D
"RTN","OOPSDOL1",225,0)
 .. K OPX
"RTN","OOPSDOL1",226,0)
 .. S OPX="OP23^1^2^"_$E(OOPSAR("CA1W",1),1,132)_"^|"
"RTN","OOPSDOL1",227,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",228,0)
 .. K OPX
"RTN","OOPSDOL1",229,0)
 .. S OPX="OP23^2^2^"_$E(DATA,133,264)_"^|"
"RTN","OOPSDOL1",230,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",231,0)
 ;
"RTN","OOPSDOL1",232,0)
EXIT ; End of routine
"RTN","OOPSDOL1",233,0)
 K WITN
"RTN","OOPSDOL1",234,0)
 Q
"RTN","OOPSDOL2")
0^2^B49496083^B49114251
"RTN","OOPSDOL2",1,0)
OOPSDOL2 ;WIOFO/CAH-CA2 EXTRACT FOR DOL ;3/15/00
"RTN","OOPSDOL2",2,0)
 ;;2.0;ASISTS;**17**;Jun 03, 2002;Build 2
"RTN","OOPSDOL2",3,0)
EN ; Entry
"RTN","OOPSDOL2",4,0)
 N OCC,NAME,FN,KK,D62,D126,D226,D227
"RTN","OOPSDOL2",5,0)
 S OOPSAR("CA")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA")))
"RTN","OOPSDOL2",6,0)
 S OOPSAR("CA2A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2A")))
"RTN","OOPSDOL2",7,0)
 S OOPSAR("CA2B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2B")))
"RTN","OOPSDOL2",8,0)
 S OOPSAR("CA2C")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2C",0)))
"RTN","OOPSDOL2",9,0)
 S OOPSAR("CA2D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2D",0)))
"RTN","OOPSDOL2",10,0)
 S OOPSAR("CA2E")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2E",0)))
"RTN","OOPSDOL2",11,0)
 S OOPSAR("CA2ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2ES")))
"RTN","OOPSDOL2",12,0)
 S OOPSAR("CA2F")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2F",0)))
"RTN","OOPSDOL2",13,0)
 S OOPSAR("CA2G")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2G",0)))
"RTN","OOPSDOL2",14,0)
 S OOPSAR("CA2H")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2H")))
"RTN","OOPSDOL2",15,0)
 S OOPSAR("CA2I")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2I")))
"RTN","OOPSDOL2",16,0)
 S OOPSAR("CA2J")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2J")))
"RTN","OOPSDOL2",17,0)
 S OOPSAR("CA2K")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2K",0)))
"RTN","OOPSDOL2",18,0)
 S OOPSAR("CA2L")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2L")))
"RTN","OOPSDOL2",19,0)
OP02 ; Seg OP02
"RTN","OOPSDOL2",20,0)
 K OPX
"RTN","OOPSDOL2",21,0)
 N OFF
"RTN","OOPSDOL2",22,0)
 S OFF=$$GET1^DIQ(2260,OOPDA,"73:1")
"RTN","OOPSDOL2",23,0)
 S OPX="OP02^"_$E("00",$L(OFF)+1,2)_OFF
"RTN","OOPSDOL2",24,0)
 S OPX=OPX_U_$P(OOPSAR("CA2I"),U,1)_U_$P(OOPSAR("CA2I"),U,2)
"RTN","OOPSDOL2",25,0)
 S OPX=OPX_U_$P(OOPSAR("CA2I"),U,3)_U_$$GET1^DIQ(2260,OOPDA,"240:1")
"RTN","OOPSDOL2",26,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA2I"),U,5),1,5)_U_$P(OOPSAR("CA2H"),U,1)
"RTN","OOPSDOL2",27,0)
 S OPX=OPX_U_$P(OOPSAR("CA2H"),U,2)_U_$P(OOPSAR("CA2H"),U,3)
"RTN","OOPSDOL2",28,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"233:1")_U_$E($P(OOPSAR("CA2H"),U,5),1,5)
"RTN","OOPSDOL2",29,0)
 S OPX=OPX_U_U_U_"^|"
"RTN","OOPSDOL2",30,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",31,0)
OP03 ; Seg OP03
"RTN","OOPSDOL2",32,0)
 K OPX
"RTN","OOPSDOL2",33,0)
 S OPX="OP03^"_$$GET1^DIQ(2260,OOPDA,60,"E")
"RTN","OOPSDOL2",34,0)
 S OPX=OPX_U_$P(OOPSAR("CA"),U,5)
"RTN","OOPSDOL2",35,0)
 S D62=$$GET1^DIQ(2260,OOPDA,"62:1")
"RTN","OOPSDOL2",36,0)
 S D126=$$GET1^DIQ(2260,OOPDA,"126:1")
"RTN","OOPSDOL2",37,0)
 S D226=$$GET1^DIQ(2260,OOPDA,"226:1")
"RTN","OOPSDOL2",38,0)
 S D227=$$GET1^DIQ(2260,OOPDA,"227:1")
"RTN","OOPSDOL2",39,0)
 S OPX=OPX_U_$E("000",$L(D226)+1,3)_D226
"RTN","OOPSDOL2",40,0)
 S OPX=OPX_U_$E("0000",$L(D227)+1,4)_D227
"RTN","OOPSDOL2",41,0)
 S OPX=OPX_U_$E("00",$L(D62)+1,2)_D62
"RTN","OOPSDOL2",42,0)
 S OPX=OPX_U_$E("00",$L(D126)+1,2)_D126
"RTN","OOPSDOL2",43,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,8))
"RTN","OOPSDOL2",44,0)
 ; V2_P15 - name fix to remove spaces and dashes
"RTN","OOPSDOL2",45,0)
 S NAME=$$NAMEFIX^OOPSDOLX($$GET1^DIQ(2260,OOPDA,"265:.01"))
"RTN","OOPSDOL2",46,0)
 S OPX=OPX_U_$P(NAME,U,1)_U_$P(NAME,U,2)_U_$P(NAME,U,3)
"RTN","OOPSDOL2",47,0)
 S OPX=OPX_U_$P(OOPSAR("CA2H"),U,8)_U_$$MKNUM^OOPSUTL2($P(OOPSAR("CA2H"),U,9))
"RTN","OOPSDOL2",48,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2ES"),U,6))
"RTN","OOPSDOL2",49,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,6))_U_"^|"
"RTN","OOPSDOL2",50,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",51,0)
OP04 ; Seg OP04
"RTN","OOPSDOL2",52,0)
 K OPX
"RTN","OOPSDOL2",53,0)
 N CAT,GRADE,STEP
"RTN","OOPSDOL2",54,0)
 S CAT=$$GET1^DIQ(2260,OOPDA,2,"I")
"RTN","OOPSDOL2",55,0)
 S GRADE=$P(OOPSAR("2162A"),U,12),STEP=$P(OOPSAR("2162A"),U,13)
"RTN","OOPSDOL2",56,0)
 I STEP="N" S STEP=" N"  ; special case on step = N
"RTN","OOPSDOL2",57,0)
 S OPX="OP04^"_$$DC^OOPSUTL3($P(OOPSAR("CA2ES"),U,3))
"RTN","OOPSDOL2",58,0)
 I $P(OOPSAR("CA2J"),U,9) D
"RTN","OOPSDOL2",59,0)
 .S Y=$P(OOPSAR("CA2J"),U,9) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",60,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,9),"."))_Y
"RTN","OOPSDOL2",61,0)
 I '$P(OOPSAR("CA2J"),U,9) S OPX=OPX_U
"RTN","OOPSDOL2",62,0)
 I $P(OOPSAR("CA2J"),U,12) D
"RTN","OOPSDOL2",63,0)
 .S Y=$P(OOPSAR("CA2J"),U,12) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",64,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,12),"."))_Y
"RTN","OOPSDOL2",65,0)
 I '$P(OOPSAR("CA2J"),U,12) S OPX=OPX_U
"RTN","OOPSDOL2",66,0)
 S OPX=OPX_"^^^"_$P(OOPSAR("CA2J"),U,7)
"RTN","OOPSDOL2",67,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U,13),1,2)
"RTN","OOPSDOL2",68,0)
 ;V2.0 1/9/02 - fix Grade/Step, send nill if Volunteer or Fee Basis
"RTN","OOPSDOL2",69,0)
 I (CAT=2)!($$GET1^DIQ(2260,OOPDA,63)="OT") S OPX=OPX_U_""
"RTN","OOPSDOL2",70,0)
 E  S OPX=OPX_U_$E("00",$L(GRADE)+1,2)_GRADE
"RTN","OOPSDOL2",71,0)
 I (CAT=2)!($$GET1^DIQ(2260,OOPDA,63)="OT") S OPX=OPX_U_""
"RTN","OOPSDOL2",72,0)
 E  S OPX=OPX_U_$E("00",$L(STEP)+1,2)_STEP
"RTN","OOPSDOL2",73,0)
 I $P(OOPSAR("CA2A"),U,8)=1!($P(OOPSAR("CA2A"),U,8)=4)!($P(OOPSAR("CA2A"),U,8)=5)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",74,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",75,0)
 I $P(OOPSAR("CA2A"),U,8)=2!($P(OOPSAR("CA2A"),U,8)=4)!($P(OOPSAR("CA2A"),U,8)=6)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",76,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",77,0)
 I $P(OOPSAR("CA2A"),U,8)=3!($P(OOPSAR("CA2A"),U,8)=5)!($P(OOPSAR("CA2A"),U,8)=6)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",78,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",79,0)
 S OPX=OPX_U_"Y^Y^Y^Y"
"RTN","OOPSDOL2",80,0)
 S OPX=OPX_U_"^^ASISTS^C2^Y"
"RTN","OOPSDOL2",81,0)
 S OPX=OPX_U                         ;Date of this Notice
"RTN","OOPSDOL2",82,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U)    ;Illness Occurred Location
"RTN","OOPSDOL2",83,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U,2)  ;Illness Occurred Address
"RTN","OOPSDOL2",84,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U,3)  ;Illness Occurred City
"RTN","OOPSDOL2",85,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"212:1") ;Illness Occurred State
"RTN","OOPSDOL2",86,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA2B"),U,5),1,5)_"^|"
"RTN","OOPSDOL2",87,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",88,0)
OP05 ; Seg OP05
"RTN","OOPSDOL2",89,0)
 K OPX
"RTN","OOPSDOL2",90,0)
 S OPX="OP05^"_$P(OOPSAR("CA2L"),U)
"RTN","OOPSDOL2",91,0)
 ;V2_P15 - name fix to remove spaces and dashes - not needed here
"RTN","OOPSDOL2",92,0)
 ;      as name sent in 1 field, put in for consistency
"RTN","OOPSDOL2",93,0)
 S NAME=$$NAMEFIX^OOPSDOLX($P(OOPSAR("CA2L"),U,2))
"RTN","OOPSDOL2",94,0)
 S OPX=OPX_U_$E($P(NAME,U,1)_","_$P(NAME,U,2)_" "_$P(NAME,U,3),1,35)
"RTN","OOPSDOL2",95,0)
 S OPX=OPX_U_$P(OOPSAR("CA2L"),U,3)_U_$P(OOPSAR("CA2L"),U,4)
"RTN","OOPSDOL2",96,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"262:1")_U_$E($P(OOPSAR("CA2L"),U,6),1,5)
"RTN","OOPSDOL2",97,0)
 I $P(OOPSAR("CA2J"),U)'="" S OPX=OPX_U_1
"RTN","OOPSDOL2",98,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL2",99,0)
 ;V2_P15 - name fix to remove spaces and dashes
"RTN","OOPSDOL2",100,0)
 S NAME=$$NAMEFIX^OOPSDOLX($P(OOPSAR("CA2J"),U))
"RTN","OOPSDOL2",101,0)
 S OPX=OPX_U_$P(NAME,U,1)_U_$P(NAME,U,2)_U_$P(NAME,U,3)
"RTN","OOPSDOL2",102,0)
 I $P(OOPSAR("CA2J"),U)'="" S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"270:1")
"RTN","OOPSDOL2",103,0)
 I $P(OOPSAR("CA2J"),U,2)'="" D
"RTN","OOPSDOL2",104,0)
 .S OPX=OPX_U_$P(OOPSAR("CA2J"),U,2)_U_$P(OOPSAR("CA2J"),U,3)
"RTN","OOPSDOL2",105,0)
 .S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"248:1")_U_$E($P(OOPSAR("CA2J"),U,5),1,5)
"RTN","OOPSDOL2",106,0)
 I $P(OOPSAR("CA2J"),U,2)="" S OPX=OPX_"^^^^"
"RTN","OOPSDOL2",107,0)
 S OPX=OPX_U_"^^|"
"RTN","OOPSDOL2",108,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",109,0)
OP06 ; Seg OP06
"RTN","OOPSDOL2",110,0)
 S DATA=$$CONV^OOPSUTL5($P(OOPSAR("CA2I"),U,8))
"RTN","OOPSDOL2",111,0)
 K OPX
"RTN","OOPSDOL2",112,0)
 S OPX="OP06"
"RTN","OOPSDOL2",113,0)
 F X=1:1:7 D          ;Loop for seven days of the week
"RTN","OOPSDOL2",114,0)
 .I DATA[X D
"RTN","OOPSDOL2",115,0)
 ..S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",116,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA2I"),U,6))_U_$$HM^OOPSUTL3($P(OOPSAR("CA2I"),U,7))
"RTN","OOPSDOL2",117,0)
 .I DATA'[X S OPX=OPX_"^N^^"
"RTN","OOPSDOL2",118,0)
 ; Generate Occ Code for DOL transfer
"RTN","OOPSDOL2",119,0)
 S OCC=$$GET1^DIQ(2260,OOPDA,15)      ; Occupation code from PAID
"RTN","OOPSDOL2",120,0)
 S OCC=$S(OCC<2300:"G"_OCC,(OCC>2499&(OCC<9001)):"W"_OCC,(OCC=9999):"Z"_OCC,1:"")
"RTN","OOPSDOL2",121,0)
 S OPX=OPX_U_OCC_U_$P(OOPSAR("CA2A"),U,9)_"^|"
"RTN","OOPSDOL2",122,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",123,0)
OP07 ; Seg OP07 RELATIONSHIP OF ILLNESS TO EMP (Word Processing)
"RTN","OOPSDOL2",124,0)
 I $G(OOPSAR("CA2C"))'="",($P(OOPSAR("CA2C"),U,4)'=0) D
"RTN","OOPSDOL2",125,0)
 . S OPFLD=216,SEG="OP07"
"RTN","OOPSDOL2",126,0)
 . D WP^OOPSDOLX
"RTN","OOPSDOL2",127,0)
OP08 ; Seg OP08
"RTN","OOPSDOL2",128,0)
 K OPX
"RTN","OOPSDOL2",129,0)
 S OPX="OP08^^^^^^^"
"RTN","OOPSDOL2",130,0)
 I $P(OOPSAR("CA2L"),U,7)'="" S OPX=OPX_97_U
"RTN","OOPSDOL2",131,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL2",132,0)
 ; patch 11 - moved Witness indicator to correct piece
"RTN","OOPSDOL2",133,0)
 S OPX=OPX_"N^^^^^^^^^^^|"
"RTN","OOPSDOL2",134,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",135,0)
OP13 ; Seg OP13 Nature of Disease/Illness (Word Processing)
"RTN","OOPSDOL2",136,0)
 I $G(OOPSAR("CA2D"))'="",($P(OOPSAR("CA2D"),U,4)'=0) D
"RTN","OOPSDOL2",137,0)
 .S OPFLD=217,SEG="OP13"
"RTN","OOPSDOL2",138,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",139,0)
OP14 ;Seg OP14 Supervisor Exception
"RTN","OOPSDOL2",140,0)
 S S97=$P(OOPSAR("CA2L"),U,7)     ; patch 11, don't send if only a space
"RTN","OOPSDOL2",141,0)
 I (S97'=""),(S97'=" ") D
"RTN","OOPSDOL2",142,0)
 .K OPX
"RTN","OOPSDOL2",143,0)
 .S OPX="OP14^1^1^"_S97_"^|"   ;Supervisor Exception
"RTN","OOPSDOL2",144,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL2",145,0)
 K S97
"RTN","OOPSDOL2",146,0)
OP15 ; Seg OP15
"RTN","OOPSDOL2",147,0)
 K OPX
"RTN","OOPSDOL2",148,0)
 S OPX="OP15^"_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,11))
"RTN","OOPSDOL2",149,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2B"),U,6))
"RTN","OOPSDOL2",150,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2B"),U,7))
"RTN","OOPSDOL2",151,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,10),"."))
"RTN","OOPSDOL2",152,0)
 S Y=$P(OOPSAR("CA2J"),U,10) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",153,0)
 S OPX=OPX_Y
"RTN","OOPSDOL2",154,0)
 I $G(OOPSAR("CA2C"))'="",($P(OOPSAR("CA2C"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",155,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",156,0)
 I $G(OOPSAR("CA2K"))'="",($P(OOPSAR("CA2K"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",157,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",158,0)
 I $G(OOPSAR("CA2E"))'="",($P(OOPSAR("CA2E"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",159,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",160,0)
 I $G(OOPSAR("CA2G"))'="",($P(OOPSAR("CA2G"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",161,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",162,0)
 I $G(OOPSAR("CA2F"))'="",($P(OOPSAR("CA2F"),U,4)'=0) S OPX=OPX_U_"Y^|"
"RTN","OOPSDOL2",163,0)
 E  S OPX=OPX_U_"N^|"
"RTN","OOPSDOL2",164,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",165,0)
OP16 ; Seg OP16 Work Duty Changed (Word Processing)
"RTN","OOPSDOL2",166,0)
 I $G(OOPSAR("CA2K"))'="",($P(OOPSAR("CA2K"),U,4)'=0) D
"RTN","OOPSDOL2",167,0)
 .S OPFLD=257,SEG="OP16"
"RTN","OOPSDOL2",168,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",169,0)
OP17 ; Seg OP17 Claim not Filed (Word Processing)
"RTN","OOPSDOL2",170,0)
 I $G(OOPSAR("CA2E"))'="",($P(OOPSAR("CA2E"),U,4)'=0) D
"RTN","OOPSDOL2",171,0)
 .S OPFLD=218,SEG="OP17"
"RTN","OOPSDOL2",172,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",173,0)
OP18 ; Seg OP18 Medical Report Delay (Word Processing)
"RTN","OOPSDOL2",174,0)
 I $G(OOPSAR("CA2G"))'="",($P(OOPSAR("CA2G"),U,4)'=0) D
"RTN","OOPSDOL2",175,0)
 .S OPFLD=220,SEG="OP18"
"RTN","OOPSDOL2",176,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",177,0)
OP19 ; Seg OP19 Employee Statement Delayed (Word Processing)
"RTN","OOPSDOL2",178,0)
 I $G(OOPSAR("CA2F"))'="",($P(OOPSAR("CA2F"),U,4)'=0) D
"RTN","OOPSDOL2",179,0)
 .S OPFLD=219,SEG="OP19"
"RTN","OOPSDOL2",180,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",181,0)
OP20 ; Seg OP20
"RTN","OOPSDOL2",182,0)
 K OPX
"RTN","OOPSDOL2",183,0)
 I $P(OOPSAR("2162B"),U,4)'="" D
"RTN","OOPSDOL2",184,0)
 .S OPX="OP20^"_"P"_U_$$GET1^DIQ(2260,OOPDA,"30:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL2",185,0)
 .Q
"RTN","OOPSDOL2",186,0)
 ; Only send Primary Body part at this time - per AAC 6/30/2000
"RTN","OOPSDOL2",187,0)
 ; I $P(OOPSAR("2162B"),U,8)'="" D
"RTN","OOPSDOL2",188,0)
 ; . N OPX
"RTN","OOPSDOL2",189,0)
 ; . S OPX="OP20^"_"S"_U_$$GET1^DIQ(2260,OOPDA,"30.1:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL2",190,0)
 ; . Q
"RTN","OOPSDOL2",191,0)
OP21 ; Seg OP21 Define for future use
"RTN","OOPSDOL2",192,0)
OP22 ; Seg OP22 Define for future use
"RTN","OOPSDOL2",193,0)
EXIT ; exit the routine
"RTN","OOPSDOL2",194,0)
 K IEN,DATA,MAX
"RTN","OOPSDOL2",195,0)
 Q
"RTN","OOPSDOLX")
0^1^B23349324^B20702638
"RTN","OOPSDOLX",1,0)
OOPSDOLX ;WIOFO/CAH-Extract data for DOL XMIT ;3/15/00
"RTN","OOPSDOLX",2,0)
 ;;2.0;ASISTS;**8,11,17**;Jun 03, 2002;Build 2
"RTN","OOPSDOLX",3,0)
 ;
"RTN","OOPSDOLX",4,0)
 ;Retrieves data from ^OOPS(2260, for CA1/CA2
"RTN","OOPSDOLX",5,0)
 ;Variables used
"RTN","OOPSDOLX",6,0)
 ;  OOPDA-----IEN of Case
"RTN","OOPSDOLX",7,0)
 ;  OOPSAR----Array holding data
"RTN","OOPSDOLX",8,0)
 ;  OPL-------Last line number written in message text
"RTN","OOPSDOLX",9,0)
 ;  XMZ-------Message Number
"RTN","OOPSDOLX",10,0)
 ; Entry
"RTN","OOPSDOLX",11,0)
 N ARR,KK,FN,FORM,MESS,NAME,OPC,OPSAR,OPT,OPX,SEG,OOPSAR,FYM,MON
"RTN","OOPSDOLX",12,0)
 S RSIZE=0,ARR=0
"RTN","OOPSDOLX",13,0)
 S OOPSAR(0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,0)))
"RTN","OOPSDOLX",14,0)
 S OOPSAR("2162A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162A")))
"RTN","OOPSDOLX",15,0)
 S OOPSAR("2162B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162B")))
"RTN","OOPSDOLX",16,0)
 S OOPSAR("2162D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162D")))
"RTN","OOPSDOLX",17,0)
 S OOPSAR("2162ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162ES")))
"RTN","OOPSDOLX",18,0)
OP01 ; Seg OP01
"RTN","OOPSDOLX",19,0)
 K OPX,DTINJ
"RTN","OOPSDOLX",20,0)
 S OPX="OP01^"_$TR($P(OOPSAR(0),U),"-")
"RTN","OOPSDOLX",21,0)
 ;V2_P15 - name fix to remove spaces and dashes
"RTN","OOPSDOLX",22,0)
 S NAME=$$NAMEFIX^OOPSDOLX($P(OOPSAR(0),U,2))
"RTN","OOPSDOLX",23,0)
 S OPX=OPX_U_$E($P(NAME,U,1)_","_$P(NAME,U,2)_" "_$P(NAME,U,3),1,35)
"RTN","OOPSDOLX",24,0)
 S OPX=OPX_U_$P(OOPSAR(0),U,7)_U_$TR($P(OOPSAR("2162A"),U),"-")
"RTN","OOPSDOLX",25,0)
 ; patch 11 - send field 109 if CA1, field 214 if CA2
"RTN","OOPSDOLX",26,0)
 ;            left old code, commented below
"RTN","OOPSDOLX",27,0)
 S FORM=$$GET1^DIQ(2260,OOPDA,52,"I")
"RTN","OOPSDOLX",28,0)
 I FORM=1 D
"RTN","OOPSDOLX",29,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,109,"I")
"RTN","OOPSDOLX",30,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))
"RTN","OOPSDOLX",31,0)
 . S Y=DTINJ D DD^%DT S Y=$P($TR(Y,":",""),"@",2),OPX=OPX_U_Y
"RTN","OOPSDOLX",32,0)
 I FORM=2 D
"RTN","OOPSDOLX",33,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,214,"I")
"RTN","OOPSDOLX",34,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))_U
"RTN","OOPSDOLX",35,0)
 K DTINJ
"RTN","OOPSDOLX",36,0)
 ;
"RTN","OOPSDOLX",37,0)
 ; S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR(0),U,5),"."))
"RTN","OOPSDOLX",38,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=1 D
"RTN","OOPSDOLX",39,0)
 ; .S Y=$P(OOPSAR(0),U,5) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOLX",40,0)
 ; .S OPX=OPX_U_Y
"RTN","OOPSDOLX",41,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=2 S OPX=OPX_U
"RTN","OOPSDOLX",42,0)
 S MON=$E($P(OOPSAR(0),U,5),4,5)
"RTN","OOPSDOLX",43,0)
 S FYM=$S(MON=10:1,MON=11:2,MON=12:3,MON="01":4,MON="02":5,MON="03":6,MON="04":7,MON="05":8,MON="06":9,MON="07":10,MON="08":11,MON="09":12,1:0)
"RTN","OOPSDOLX",44,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U),1,4)_U_$E("00",$L(FYM)+1,2)_FYM
"RTN","OOPSDOLX",45,0)
 ;V2_P15 - name fix to remove spaces and dashes (have name from above)
"RTN","OOPSDOLX",46,0)
 S OPX=OPX_U_$P(NAME,U,1)_U_$P(NAME,U,2)_U_$P(NAME,U,3)
"RTN","OOPSDOLX",47,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,4)_U_$P(OOPSAR("2162A"),U,5)_U_$$GET1^DIQ(2260,OOPDA,"10:1")_U_$E($P(OOPSAR("2162A"),U,7),1,5)
"RTN","OOPSDOLX",48,0)
 S OPX=OPX_U_$TR($P(OOPSAR("2162A"),U,8),"(,)-^*/# ")
"RTN","OOPSDOLX",49,0)
 S OPX=OPX_U_$E($$GET1^DIQ(2260,OOPDA,7,"E"))_U_$$DC^OOPSUTL3($P(OOPSAR("2162A"),U,2))
"RTN","OOPSDOLX",50,0)
 ; Patch 5 llh - changed next line from "70:.01" to 331
"RTN","OOPSDOLX",51,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,331)
"RTN","OOPSDOLX",52,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,10)_"^|"
"RTN","OOPSDOLX",53,0)
 D STORE
"RTN","OOPSDOLX",54,0)
 I $P(OOPSAR(0),U,7)=1 D ^OOPSDOL1
"RTN","OOPSDOLX",55,0)
 I $P(OOPSAR(0),U,7)=2 D ^OOPSDOL2
"RTN","OOPSDOLX",56,0)
EXIT ; Loads the message and Quits the routine
"RTN","OOPSDOLX",57,0)
 I RSIZE+MSIZE>30000 D
"RTN","OOPSDOLX",58,0)
 .S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSDOLX",59,0)
 .D SEND^OOPSDOL,CREATE^OOPSDOL
"RTN","OOPSDOLX",60,0)
 .S (START,END)=""
"RTN","OOPSDOLX",61,0)
 F I=1:1:ARR I $G(MESS(I))'="" D
"RTN","OOPSDOLX",62,0)
 .S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=MESS(I)
"RTN","OOPSDOLX",63,0)
 .I START="" S START=$P($P(OOPSAR(0),U),"-",2)
"RTN","OOPSDOLX",64,0)
 S MSIZE=MSIZE+RSIZE
"RTN","OOPSDOLX",65,0)
 K ARR,MESS,OPDT,RSIZE
"RTN","OOPSDOLX",66,0)
 Q
"RTN","OOPSDOLX",67,0)
STORE ;
"RTN","OOPSDOLX",68,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",69,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",70,0)
 Q
"RTN","OOPSDOLX",71,0)
WP ; Word Processing Fields
"RTN","OOPSDOLX",72,0)
 K OPX
"RTN","OOPSDOLX",73,0)
 N DIWL,DIWR,DIWF,OPGLB,OPNODE,X,OPI,NUM,WPAR,F332,F347
"RTN","OOPSDOLX",74,0)
 S NUM=0,OPI=0
"RTN","OOPSDOLX",75,0)
 K ^UTILITY($J,"W")
"RTN","OOPSDOLX",76,0)
 S DIWL=1,DIWR="",DIWF="|C132"
"RTN","OOPSDOLX",77,0)
 ; Patch 5 llh - added logic to concatenate field 332 to WP field (165)
"RTN","OOPSDOLX",78,0)
 I OPFLD=165 D
"RTN","OOPSDOLX",79,0)
 .S F332=$$GET1^DIQ(2260,OOPDA,"332:1")
"RTN","OOPSDOLX",80,0)
 .I $G(F332)'="" S X=F332 D ^DIWP
"RTN","OOPSDOLX",81,0)
 .;v2 p11 - concatenate Reason for Dispute to fld 165 in block 36
"RTN","OOPSDOLX",82,0)
 .S F347=$$GET1^DIQ(2260,OOPDA,"347:.01")
"RTN","OOPSDOLX",83,0)
 .I $G(F347)'="" S X=F347 D ^DIWP
"RTN","OOPSDOLX",84,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSDOLX",85,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,OOPDA,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,OOPDA,OPNODE,OPI,0)) D
"RTN","OOPSDOLX",86,0)
 . I $TR(X," ","")="" Q
"RTN","OOPSDOLX",87,0)
 . I X]"" D ^DIWP
"RTN","OOPSDOLX",88,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSDOLX",89,0)
 ; If OPT=0 then no data in ^UTILITY($J,"W") so quit
"RTN","OOPSDOLX",90,0)
 I 'OPT Q
"RTN","OOPSDOLX",91,0)
 ; Need to set up an array to see if max segments exceeded
"RTN","OOPSDOLX",92,0)
 I OPT S OPI=0 F OPC=1:1:OPT S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSDOLX",93,0)
 . S NUM=NUM+1
"RTN","OOPSDOLX",94,0)
 . S WPAR(NUM)=SEG_U_OPC_U_OPT_U_$$UP^OOPSUTL4($E(^UTILITY($J,"W",1,OPI,0),1,132))_"^|"
"RTN","OOPSDOLX",95,0)
 ; Fileman puts spaces at end of last node - need to strip off.
"RTN","OOPSDOLX",96,0)
 S STRP=$P(WPAR(NUM),U,4)
"RTN","OOPSDOLX",97,0)
 F K=$L(STRP):-1:1 Q:$E(STRP,K)'=" "  S STRP=$E(STRP,1,(K-1))
"RTN","OOPSDOLX",98,0)
 S $P(WPAR(NUM),U,4)=STRP
"RTN","OOPSDOLX",99,0)
 K STRP
"RTN","OOPSDOLX",100,0)
 I NUM>4 D  ; if max segments exceeded fix here
"RTN","OOPSDOLX",101,0)
 . N BEG,END,STR,TMP
"RTN","OOPSDOLX",102,0)
 . F I=1:1:NUM S STR(I)=$P(WPAR(I),U,4)
"RTN","OOPSDOLX",103,0)
 . F I=1:1:(NUM-1) S TMP=132-$L(STR(I)) I TMP D
"RTN","OOPSDOLX",104,0)
 .. S END=$E(STR(I),$L(STR(I))),BEG=$E(STR(I+1))
"RTN","OOPSDOLX",105,0)
 .. ; put a blank in if needed
"RTN","OOPSDOLX",106,0)
 .. I $A(END)'=32,$A(BEG)'=32 S STR(I)=STR(I)_" ",TMP=TMP-1
"RTN","OOPSDOLX",107,0)
 .. S STR(I)=STR(I)_$E(STR(I+1),1,TMP)
"RTN","OOPSDOLX",108,0)
 .. S STR(I+1)=$E(STR(I+1),(TMP+1),$L(STR(I+1)))
"RTN","OOPSDOLX",109,0)
 .. I $L(STR(I)) S $P(WPAR(I),U,4)=STR(I)
"RTN","OOPSDOLX",110,0)
 .. I '$L(STR(I)) K WPAR(I)
"RTN","OOPSDOLX",111,0)
 . I '$L(STR(NUM)) K WPAR(NUM)
"RTN","OOPSDOLX",112,0)
 ; load temporary array into MESS array to load into Mailman message
"RTN","OOPSDOLX",113,0)
 S NSEG=$O(WPAR(""),-1)
"RTN","OOPSDOLX",114,0)
 S NUM=0 F  S NUM=$O(WPAR(NUM)) Q:NUM=""  D
"RTN","OOPSDOLX",115,0)
 . S OPX=WPAR(NUM),$P(OPX,U,3)=NSEG
"RTN","OOPSDOLX",116,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",117,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",118,0)
 K ^UTILITY($J,"W"),X,OPFLD,NSEG
"RTN","OOPSDOLX",119,0)
 Q
"RTN","OOPSDOLX",120,0)
NAMEFIX(NAME) ; strips dashes and spaces out of name and returns it in
"RTN","OOPSDOLX",121,0)
 ;  the format lastname, firstname middleinitial
"RTN","OOPSDOLX",122,0)
 ;
"RTN","OOPSDOLX",123,0)
 ;  Input:  Name - name in the format LN, FN MI
"RTN","OOPSDOLX",124,0)
 ; Output:  Name - name in the format LN, FN MI with embedded spaces
"RTN","OOPSDOLX",125,0)
 ;                 and dashes removed
"RTN","OOPSDOLX",126,0)
 I $G(NAME)="" Q ""
"RTN","OOPSDOLX",127,0)
 N FN,KK,LN,MI
"RTN","OOPSDOLX",128,0)
 S LN=$P($TR(NAME,"- ",""),","),FN=$P($TR(NAME,"-",""),",",2)
"RTN","OOPSDOLX",129,0)
 ; remove any leading spaces
"RTN","OOPSDOLX",130,0)
 F KK=1:0:1 Q:$E(LN,KK)'=" "  S LN=$E(LN,KK+1,$L(LN))
"RTN","OOPSDOLX",131,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOLX",132,0)
 I $L(FN," ")=1 S MI=""
"RTN","OOPSDOLX",133,0)
 I $L(FN," ")=2 D
"RTN","OOPSDOLX",134,0)
 .S FN=$P(FN," "),MI=$P(FN," ",2)
"RTN","OOPSDOLX",135,0)
 ;how to collaspe first and middle names with extra spaces is
"RTN","OOPSDOLX",136,0)
 ;totally arbitary - no way to know which spaces go w/which name
"RTN","OOPSDOLX",137,0)
 I $L(FN," ")>2 D
"RTN","OOPSDOLX",138,0)
 .S MI=$TR($P(FN," ",3,$L(FN," "))," ","")
"RTN","OOPSDOLX",139,0)
 .S FN=$TR($P(FN," ",1,2)," ","")
"RTN","OOPSDOLX",140,0)
 Q $E(LN,1,20)_U_$E(FN,1,10)_U_$E(MI,1,10)
"VER")
8.0^22.0
"BLD",7848,6)
^17
**END**
**END**
