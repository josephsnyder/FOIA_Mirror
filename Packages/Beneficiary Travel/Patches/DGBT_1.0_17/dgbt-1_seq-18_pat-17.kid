Released DGBT*1*17 SEQ #18
Extracted from mail message
**KIDS**:DGBT*1.0*17^

**INSTALL NAME**
DGBT*1.0*17
"BLD",7846,0)
DGBT*1.0*17^BENEFICIARY TRAVEL^0^3081210^y
"BLD",7846,1,0)
^^1^1^3081119^
"BLD",7846,1,1,0)
Update Beneficiary Travel Deductible Rates
"BLD",7846,4,0)
^9.64PA^^
"BLD",7846,6.3)
6
"BLD",7846,"INID")
^n
"BLD",7846,"INIT")
EN^DGBT1P17
"BLD",7846,"KRN",0)
^9.67PA^779.2^20
"BLD",7846,"KRN",.4,0)
.4
"BLD",7846,"KRN",.401,0)
.401
"BLD",7846,"KRN",.402,0)
.402
"BLD",7846,"KRN",.403,0)
.403
"BLD",7846,"KRN",.5,0)
.5
"BLD",7846,"KRN",.84,0)
.84
"BLD",7846,"KRN",3.6,0)
3.6
"BLD",7846,"KRN",3.8,0)
3.8
"BLD",7846,"KRN",9.2,0)
9.2
"BLD",7846,"KRN",9.8,0)
9.8
"BLD",7846,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7846,"KRN",9.8,"NM",1,0)
DGBTCE^^0^B23736161
"BLD",7846,"KRN",9.8,"NM",2,0)
DGBTCE1^^0^B6499015
"BLD",7846,"KRN",9.8,"NM",3,0)
DGBTEE2^^0^B11057513
"BLD",7846,"KRN",9.8,"NM","B","DGBTCE",1)

"BLD",7846,"KRN",9.8,"NM","B","DGBTCE1",2)

"BLD",7846,"KRN",9.8,"NM","B","DGBTEE2",3)

"BLD",7846,"KRN",19,0)
19
"BLD",7846,"KRN",19,"NM",0)
^9.68A^^
"BLD",7846,"KRN",19.1,0)
19.1
"BLD",7846,"KRN",101,0)
101
"BLD",7846,"KRN",409.61,0)
409.61
"BLD",7846,"KRN",771,0)
771
"BLD",7846,"KRN",779.2,0)
779.2
"BLD",7846,"KRN",870,0)
870
"BLD",7846,"KRN",8989.51,0)
8989.51
"BLD",7846,"KRN",8989.52,0)
8989.52
"BLD",7846,"KRN",8994,0)
8994
"BLD",7846,"KRN","B",.4,.4)

"BLD",7846,"KRN","B",.401,.401)

"BLD",7846,"KRN","B",.402,.402)

"BLD",7846,"KRN","B",.403,.403)

"BLD",7846,"KRN","B",.5,.5)

"BLD",7846,"KRN","B",.84,.84)

"BLD",7846,"KRN","B",3.6,3.6)

"BLD",7846,"KRN","B",3.8,3.8)

"BLD",7846,"KRN","B",9.2,9.2)

"BLD",7846,"KRN","B",9.8,9.8)

"BLD",7846,"KRN","B",19,19)

"BLD",7846,"KRN","B",19.1,19.1)

"BLD",7846,"KRN","B",101,101)

"BLD",7846,"KRN","B",409.61,409.61)

"BLD",7846,"KRN","B",771,771)

"BLD",7846,"KRN","B",779.2,779.2)

"BLD",7846,"KRN","B",870,870)

"BLD",7846,"KRN","B",8989.51,8989.51)

"BLD",7846,"KRN","B",8989.52,8989.52)

"BLD",7846,"KRN","B",8994,8994)

"BLD",7846,"QDEF")
^^^^NO^^^^^^NO
"BLD",7846,"QUES",0)
^9.62^^
"BLD",7846,"REQB",0)
^9.611^2^2
"BLD",7846,"REQB",1,0)
DGBT*1.0*16^1
"BLD",7846,"REQB",2,0)
DGBT*1.0*14^1
"BLD",7846,"REQB","B","DGBT*1.0*14",2)

"BLD",7846,"REQB","B","DGBT*1.0*16",1)

"INIT")
EN^DGBT1P17
"MBREQ")
0
"PKG",154,-1)
1^1
"PKG",154,0)
BENEFICIARY TRAVEL^DGBT^Beneficiary Travel
"PKG",154,20,0)
^9.402P^^
"PKG",154,22,0)
^9.49I^1^1
"PKG",154,22,1,0)
1.0^3030731^3020423^66481
"PKG",154,22,1,"PAH",1,0)
17^3081210
"PKG",154,22,1,"PAH",1,1,0)
^^1^1^3081210
"PKG",154,22,1,"PAH",1,1,1,0)
Update Beneficiary Travel Deductible Rates
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","DGBT1P17")
0^^B1393525^n/a
"RTN","DGBT1P17",1,0)
DGBT1P17 ;RLS/MJB - BENE TRAVEL UPDATE POST-INIT ; 10/14/08 10:45
"RTN","DGBT1P17",2,0)
 ;;1.0;Beneficiary Travel;**17**;September 25, 2001;Build 6
"RTN","DGBT1P17",3,0)
 ;
"RTN","DGBT1P17",4,0)
 Q
"RTN","DGBT1P17",5,0)
EN ;
"RTN","DGBT1P17",6,0)
 D START,UPDATE,FINISH
"RTN","DGBT1P17",7,0)
 Q
"RTN","DGBT1P17",8,0)
 ;
"RTN","DGBT1P17",9,0)
START D BMES^XPDUTL(" Post-Install Starting")
"RTN","DGBT1P17",10,0)
 Q
"RTN","DGBT1P17",11,0)
 ;
"RTN","DGBT1P17",12,0)
FINISH D BMES^XPDUTL(" Post-Install Complete")
"RTN","DGBT1P17",13,0)
 Q
"RTN","DGBT1P17",14,0)
 ;
"RTN","DGBT1P17",15,0)
UPDATE ;Insert new rate/deductible record
"RTN","DGBT1P17",16,0)
 ;ESTABLISH THE RECORD
"RTN","DGBT1P17",17,0)
 N DO,DIC,DIE,X,Y,DINUM,DR,DA
"RTN","DGBT1P17",18,0)
 S DIC="^DG(43.1,",DIC(0)="E",X=3090109,DINUM=9999999.9999-X
"RTN","DGBT1P17",19,0)
 I $D(^DG(43.1,DINUM,0)) D  Q  ;9'S INVERSE OF EFFECTIVE DATE
"RTN","DGBT1P17",20,0)
 . D BMES^XPDUTL("Record already exists, exiting")
"RTN","DGBT1P17",21,0)
 D FILE^DICN
"RTN","DGBT1P17",22,0)
 ;
"RTN","DGBT1P17",23,0)
 ;NOW EDIT THE REST OF THE FIELDS
"RTN","DGBT1P17",24,0)
 S DIE=DIC,DR="30.01///6;30.02///18;30.03///.415;30.05///.415"
"RTN","DGBT1P17",25,0)
 S DA=+Y
"RTN","DGBT1P17",26,0)
 D ^DIE
"RTN","DGBT1P17",27,0)
 D BMES^XPDUTL("New record added to MAS EVENT RATES file")
"RTN","DGBT1P17",28,0)
 Q
"RTN","DGBT1P17",29,0)
 ;
"RTN","DGBTCE")
0^1^B23736161^B23446493
"RTN","DGBTCE",1,0)
DGBTCE ;ALB/SCK - BENEFICIARY TRAVEL CLAIM RE-ENTER/EDIT; 12/15/92  06/04/93
"RTN","DGBTCE",2,0)
 ;;1.0;Beneficiary Travel;**2,14,17**;September 25, 2001;Build 6
"RTN","DGBTCE",3,0)
 Q
"RTN","DGBTCE",4,0)
SCREEN ;
"RTN","DGBTCE",5,0)
 D QUIT^DGBTCE1
"RTN","DGBTCE",6,0)
 D SCREEN^DGBTEE1 Q:'$D(^DGBT(392,DGBTDT,0))  I DGBTTOUT=-1 S DGBTTOUT=1 Q
"RTN","DGBTCE",7,0)
 I $D(DGBTOACT) I DGBTOACT'=DGBTACCT S DGBTVAR(0)=^DGBT(392,DGBTDT,0) D FILE
"RTN","DGBTCE",8,0)
 S (DGBTMAL,DGBTFAB,DGBTME,DGBTCP,DGBTFLAG,DGBTDE,DGBTDCV,DGBTDCM,DGBTDPV,DGBTDPM)=0
"RTN","DGBTCE",9,0)
 S:$G(DGBTACCT)'>0 DGBTACCT=$P($G(DGBTVAR(0)),U,6)
"RTN","DGBTCE",10,0)
 S DGBTAP=VADM(1),DIE="^DGBT(392,",DA=DGBTDT,DR=$S(DGBTACCT=4:"42//"_DGBTAP,DGBTACCT=5:"43;S DGBTCP=X;42//"_DGBTAP,1:"44")
"RTN","DGBTCE",11,0)
 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",12,0)
 I DGBTACCT=4!(DGBTACCT=5) S:$D(^DGBT(392,DGBTDT,"M")) DGBTWAY=$P(^("M"),"^"),DGBTMILE=$P(^("M"),"^",2) S:$D(^DGBT(392,DGBTDT,"D")) DGBTCITY=$P(^("D"),"^",4),DGBTSTAT=$P(^("D"),"^",5)
"RTN","DGBTCE",13,0)
 S DGBTDIV=$P($G(^DGBT(392,DA,0)),U,11),DGBTRMK=$S($D(DGBTREC):$$DICLKUP^DGBTUTL(DGBTREC,DGBTDIV,4),1:"")
"RTN","DGBTCE",14,0)
 S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",15,0)
 S DR="3////"_DGBTELIG_";6////"_DGBTACTN_";21;I X="""" S Y=24;22;I X="""" S Y=24;23;24;24.1;24.2;25;I X="""" S Y=28;26;I X="""" S Y=28;27;28;28.1;28.2"
"RTN","DGBTCE",16,0)
 D ^DIE K DIE I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",17,0)
 W:DGBTRMK]"" !!,*7,"MILEAGE REMARKS: ",DGBTRMK,!
"RTN","DGBTCE",18,0)
 I DGBTACCT=4!(DGBTACCT=5) D  Q:$G(DGBTTOUT)
"RTN","DGBTCE",19,0)
 . S DR="31//;S DGBTOWRT=X;32//;S DGBTML=X"
"RTN","DGBTCE",20,0)
 . I DGBTACCT=5&(DGBTCP=1) S DGBTMR=DGBTMR1
"RTN","DGBTCE",21,0)
 . S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",22,0)
 . D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1
"RTN","DGBTCE",23,0)
DIE1 ;
"RTN","DGBTCE",24,0)
 S DGBTMLT=$S($D(DGBTVAR("M"))&((DGBTACCT=4)!(DGBTACCT=5)):$J((DGBTOWRT*DGBTML*DGBTMR),0,2),1:""),$P(^DGBT(392,DGBTDT,"M"),"^",3)=DGBTMLT,$P(DGBTVAR("M"),"^",3)=DGBTMLT
"RTN","DGBTCE",25,0)
 ;
"RTN","DGBTCE",26,0)
 S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE",27,0)
 I 'DGBTCORE D
"RTN","DGBTCE",28,0)
 . S DR="I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;7;@1;I DGBTMLFB=0 S Y=""@2"";34//;S DGBTMAL=X;35//;S DGBTFAB=X;@2;8//;S DGBTME=X"
"RTN","DGBTCE",29,0)
 I DGBTCORE S DR="" D
"RTN","DGBTCE",30,0)
 . S DR(1,392,1)="I DGBTACCT=4!(DGBTACCT=5) S Y=""@1"";41;@3;14;S DGBTCSL=$$AFTER^DGBTCSL(392,D0,X,$G(DGBTPRV)) S:DGBTCSL<1 Y=""@3"" W:DGBTCSL<1 ""   Required"" K DGBTPRV,DGBTCSL;"
"RTN","DGBTCE",31,0)
 . S DR(1,392,2)="@1;I DGBTMLFB=0 S Y=""@2"";34//;S DGBTMAL=X;35//;S DGBTFAB=X;@2;8//;S DGBTME=X"
"RTN","DGBTCE",32,0)
DIE3 ;
"RTN","DGBTCE",33,0)
 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",34,0)
 ;
"RTN","DGBTCE",35,0)
TCOST ;CALCULATE TOTAL COST AND MONTHLY CUM. DEDUCTIBLE
"RTN","DGBTCE",36,0)
MLFB ;
"RTN","DGBTCE",37,0)
 S DGBTMAF=$S(DGBTMLFB:DGBTMAL+DGBTFAB,1:0),DGBTMETC=DGBTME+$S($D(DGBTMAL):DGBTMAL,1:0)
"RTN","DGBTCE",38,0)
 I DGBTACCT'=4&(DGBTACCT'=5) S DGBTPA=DGBTMAF+DGBTME G CONT
"RTN","DGBTCE",39,0)
 I $D(DGBTMLT) S DGBTTC=$S(DGBTMLT+DGBTMAF'>DGBTMETC:DGBTMLT+DGBTMAF,DGBTMLT+DGBTMAF>DGBTMETC&(DGBTME>0):DGBTMETC,DGBTME'>0:DGBTMLT+DGBTMAF,1:DGBTMETC)
"RTN","DGBTCE",40,0)
 I DGBTACCT=5 S DGBTDE=0 S DGBTPA=$S((DGBTMLT+DGBTMAF)'=0:DGBTTC,1:DGBTMETC) G CONT
"RTN","DGBTCE",41,0)
DED ;
"RTN","DGBTCE",42,0)
 F I=$E(DGBTDT,1,5)_"00.2399":0 S I=$O(^DGBT(392,"C",DFN,I)) Q:'I!($E(I,1,5)>$E(DGBTDT,1,5))  I I'=DGBTDT S DGBTDCM=DGBTDCM+($P(^DGBT(392,I,0),"^",9))
"RTN","DGBTCE",43,0)
 I $D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")) S DGBTRATE=^("BT"),DGBTDPV=$P(DGBTRATE,"^"),DGBTDPM=$P(DGBTRATE,"^",2),DGBTMR=$P(DGBTRATE,"^",3)
"RTN","DGBTCE",44,0)
 I $D(^DGBT(392,DGBTDT,"M")) S:$P(^("M"),"^")=1 DGBTDPV=DGBTDPV/2 I DGBTWAY'=$P(^("M"),"^")!(DGBTMILE'=$P(^("M"),"^",2)) I $D(^DGBT(392,DGBTDT,0)) S $P(^(0),"^",9)="" K ^DGBT(392,"AD",$P(^(0),"^",2),$E(DGBTDT,2,5),DGBTDT)
"RTN","DGBTCE",45,0)
 S DGBTDRM=DGBTDPM-DGBTDCM
"RTN","DGBTCE",46,0)
 I DGBTDRM<0 S DGBTDRM=0
"RTN","DGBTCE",47,0)
 I DGBTDE<0 S DGBTDE=0
"RTN","DGBTCE",48,0)
 S DGBTDCV=$S(DGBTDCM'<DGBTDPM:0,DGBTDRM'<DGBTDPV&(DGBTTC'<DGBTDPV):DGBTDPV,DGBTDRM'<DGBTDPV&(DGBTTC'>DGBTDPV):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'>DGBTDRM):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'<DGBTDRM):DGBTDRM,1:0)
"RTN","DGBTCE",49,0)
DED1 ;
"RTN","DGBTCE",50,0)
 S DR="I $P(^DGBT(392,DGBTDT,0),""^"",9)]"""" S Y=""@9"";9///"_DGBTDCV_";@9;9;S DGBTDE=X S:DGBTDE>DGBTTC DGBTDE=DGBTTC,DGBTFLAG=2 S:DGBTDE>DGBTDRM DGBTDE=DGBTDRM,DGBTFLAG=1"
"RTN","DGBTCE",51,0)
DIE4 ;
"RTN","DGBTCE",52,0)
 S DIE="^DGBT(392,",DA=DGBTDT D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=1 Q
"RTN","DGBTCE",53,0)
CONT ;
"RTN","DGBTCE",54,0)
 D CONT^DGBTCE1
"RTN","DGBTCE",55,0)
 Q
"RTN","DGBTCE",56,0)
FILE ;      Reset values if account changes
"RTN","DGBTCE",57,0)
 S DGBTVAR(0)=$P(DGBTVAR(0),"^",1,6)_"^^0^^"_$S($L(DGBTVAR(0),"^")>10:$P(DGBTVAR(0),"^",10,$L(DGBTVAR(0),"^")),1:""),DGBTVAR("A")="^"_$P(DGBTVAR("A"),"^",2)_"^^^"_$S($L(DGBTVAR("A"),"^")>4:$P(DGBTVAR("A"),"^",5,$L(DGBTVAR("A"),"^")),1:"")
"RTN","DGBTCE",58,0)
 I DGBTACCT<4 S DGBTVAR("M")="^^^"_$S($L(DGBTVAR("M"),"^")>3:$P(DGBTVAR("M"),"^",4,$L(DGBTVAR("M"),"^")),1:"")
"RTN","DGBTCE",59,0)
 S ^DGBT(392,DGBTDT,0)=DGBTVAR(0),^("A")=DGBTVAR("A") S:DGBTACCT<4 ^("M")=DGBTVAR("M") S DA=DGBTDT,DIK="^DGBT(392," D IX^DIK
"RTN","DGBTCE",60,0)
 Q
"RTN","DGBTCE1")
0^2^B6499015^B6397951
"RTN","DGBTCE1",1,0)
DGBTCE1 ;ALB/LM - BENEFICIARY TRAVEL CLAIM RE-ENTER/EDIT CONT.; 9/13/89@8:00 ;4/23/91  09:42
"RTN","DGBTCE1",2,0)
 ;;1.0;Beneficiary Travel;**17**;September 25, 2001;Build 6
"RTN","DGBTCE1",3,0)
 Q
"RTN","DGBTCE1",4,0)
CONT ; ENTRY POINTS FROM DGBTEE,DGBTCE
"RTN","DGBTCE1",5,0)
 I DGBTDE<0 S DGBTDE=0
"RTN","DGBTCE1",6,0)
 S DGBTFLX=" DEDUCTIBLE AMOUNT HAS BEEN CHANGED " I DGBTACCT=4 S DGBTPA=$S(DGBTTC-DGBTDE>0:DGBTTC-DGBTDE,DGBTTC-DGBTDE<0:DGBTTC,1:0)
"RTN","DGBTCE1",7,0)
DIE5 S DGBTINFL=$S(DGBTDE=DGBTDCV:$P(DGBTVAR("R"),DGBTFLX)_$P(DGBTVAR("R"),DGBTFLX,2)_" ",DGBTDE'=DGBTDCV&(DGBTVAR("R")'[DGBTFLX):$E(DGBTVAR("R")_DGBTINFL_DGBTFLX,1,79),1:DGBTVAR("R"))
"RTN","DGBTCE1",8,0)
 S DIE="^DGBT(392,",DA=DGBTDT
"RTN","DGBTCE1",9,0)
 S DR="9///"_DGBTDE_";10///"_DGBTPA_$S(DGBTINFL=" ":"",1:";51///^S X=DGBTINFL") S DGBTINFL=""
"RTN","DGBTCE1",10,0)
 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=-1 Q
"RTN","DGBTCE1",11,0)
 ;    stuff amount payable
"RTN","DGBTCE1",12,0)
 I DGBTFLAG=2 W !!,"DEDUCTIBLE AMOUNT CAN NOT EXCEED THE TOTAL COSTS FOR THIS CLAIM",! K X S DGBTFLAG=0 G DED1^DGBTCE
"RTN","DGBTCE1",13,0)
 I DGBTFLAG=1 W !!,"DEDUCTIBLE FOR THIS CLAIM CAN NOT EXCEED THE AMOUNT REMAINING FOR THIS MONTH",! K X S DGBTFLAG=0 G DED1^DGBTCE
"RTN","DGBTCE1",14,0)
 ;
"RTN","DGBTCE1",15,0)
 S DIE="^DGBT(392,",DA=DGBTDT,DIE("NO^")="BACK",DR="51"
"RTN","DGBTCE1",16,0)
DIE6 D ^DIE K DIE,DQ,DR I $D(DTOUT)!($D(Y)) S DGBTTOUT=-1 Q
"RTN","DGBTCE1",17,0)
 D QUIT
"RTN","DGBTCE1",18,0)
 D SCREEN^DGBTCD
"RTN","DGBTCE1",19,0)
 Q
"RTN","DGBTCE1",20,0)
QUIT ;KILL VARIABLES
"RTN","DGBTCE1",21,0)
 K DGBTCITY,DGBTSTAT,DGBTWAY,DGBTMILE,DIE,DR,DGBTOWRT,DGBTML,DGBTMLFB,DGBTACCT,DGBTAP,DGBTMAL,DGBTFAB,DGBTME,DGBTMAF,DGBTTC,DGBTDCM,DGBTDPV,DGBTDPM,DGBTDRM,DGBTDCV,DGBTDE,DGBTPA,I,DGBTELIG,DGBTFLAG,DGBTMETC,DGBTMLT,DGBTCP,DGBTMR1
"RTN","DGBTCE1",22,0)
 K DGBTFR1,DGBTFR2,DGBTFR3,DGBTFR4,DGBTTO1,DGBTTO2,DGBTTO3,DGBTTO4,DGBTMR,DGBTRATE,DGBTSCP,DGBTFLX Q
"RTN","DGBTEE2")
0^3^B11057513^B10939988
"RTN","DGBTEE2",1,0)
DGBTEE2 ;ALB/SCK BENEFICIARY TRAVEL ENTER/EDIT CONT; 03/23/93
"RTN","DGBTEE2",2,0)
 ;;1.0;Beneficiary Travel;**17**;September 25, 2001;Build 6
"RTN","DGBTEE2",3,0)
START ;
"RTN","DGBTEE2",4,0)
 Q
"RTN","DGBTEE2",5,0)
STUFF ;  stuff departure=home address, destination=division(ins) address, and attendant/payee=patient        
"RTN","DGBTEE2",6,0)
 S DGBTFR1=VAPA(1),DGBTFR2=VAPA(2),DGBTFR3=VAPA(3),DGBTAP=VADM(1)
"RTN","DGBTEE2",7,0)
 ; function call $$DEPCTY passes the zip code from the patient data, and returns with the departure city name or a null.
"RTN","DGBTEE2",8,0)
 ; if a null for the city is returned, the city name in the patient data is defaulted to.
"RTN","DGBTEE2",9,0)
 S XX=$$DEPCTY^DGBTUTL($P(VAPA(11),U,1)) S X=$S(+XX>0:$P(XX,U,2),1:VAPA(4))
"RTN","DGBTEE2",10,0)
 D UP^DGBTHELP S DGBTFR4=X
"RTN","DGBTEE2",11,0)
 K DGBTVAR(0) S DGBTVAR(0)=$S($D(^DGBT(392,DGBTDT,0)):^(0),1:"")
"RTN","DGBTEE2",12,0)
 S (DGBTDIV,DGBTDV1)=$P(DGBTVAR(0),"^",11),DGBTTO1=$P(^DG(40.8,DGBTDIV,0),"^"),DGBTDIV=$P(^DG(40.8,DGBTDIV,0),"^",7)
"RTN","DGBTEE2",13,0)
 S (DGBTTO2,DGBTTO3,DGBTTO4,X)=""
"RTN","DGBTEE2",14,0)
 I $D(^DIC(4,DGBTDIV,1))#10=1 S DGBTTO2=$P(^DIC(4,DGBTDIV,1),"^"),DGBTTO3=$P(^(1),"^",2),X=$P(^(1),"^",3) D UP^DGBTHELP S DGBTTO4=X ; ref file #4, institution file by selected div
"RTN","DGBTEE2",15,0)
 Q
"RTN","DGBTEE2",16,0)
DED ;
"RTN","DGBTEE2",17,0)
 F I=$E(DGBTDT,1,5)_"00.2399":0 S I=$O(^DGBT(392,"C",DFN,I)) Q:'I!($E(I,1,5)>$E(DGBTDT,1,5))  S DGBTDCM=DGBTDCM+($P(^DGBT(392,I,0),"^",9))
"RTN","DGBTEE2",18,0)
 I $D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")) D
"RTN","DGBTEE2",19,0)
 . S DGBTRATE=^("BT"),DGBTDPV=$P(DGBTRATE,"^"),DGBTDPM=$P(DGBTRATE,"^",2),DGBTMR=$P(DGBTRATE,"^",3) ; ref file #43, MAS parameters file for BT settings
"RTN","DGBTEE2",20,0)
 I $D(^DGBT(392,DGBTDT,"M")) I $P(^("M"),"^")=1 S DGBTDPV=DGBTDPV/2 ; ref file #392, claims file.
"RTN","DGBTEE2",21,0)
 S DGBTDRM=DGBTDPM-DGBTDCM
"RTN","DGBTEE2",22,0)
 I DGBTDRM<0 S DGBTDRM=0
"RTN","DGBTEE2",23,0)
 S DGBTDCV=$S(DGBTDCM'<DGBTDPM:0,DGBTDRM'<DGBTDPV&(DGBTTC'<DGBTDPV):DGBTDPV,DGBTDRM'<DGBTDPV&(DGBTTC'>DGBTDPV):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'>DGBTDRM):DGBTTC,DGBTDRM'>DGBTDPV&(DGBTTC'<DGBTDRM):DGBTDRM,1:0)
"RTN","DGBTEE2",24,0)
DED1 ;
"RTN","DGBTEE2",25,0)
 S DR="9////"_DGBTDCV_";9;S DGBTDE=X S:DGBTDE>DGBTTC DGBTDE=DGBTTC,DGBTFlAG=2 S:DGBTDE>DGBTDRM DGBTDE=DGBTDRM,DGBTFLAG=1"
"RTN","DGBTEE2",26,0)
 Q
"RTN","DGBTEE2",27,0)
RATES ;  checks parameter to ask meals & lodging, ferrys & bridges        
"RTN","DGBTEE2",28,0)
 S DGBTMLFB=$S($D(^DG(43,1,"BT")):$P(^DG(43,1,"BT"),"^",2),1:0)
"RTN","DGBTEE2",29,0)
 ;  mileage rate
"RTN","DGBTEE2",30,0)
 S DGBTMR=$S($D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")):$P(^("BT"),"^",3),1:0) ; ref file #43.1, MAS event rates file for BT rates
"RTN","DGBTEE2",31,0)
 S DGBTMR1=$S($D(^DG(43.1,$O(^DG(43.1,(9999999.99999-DGBTDT))),"BT")):$P(^("BT"),"^",5),1:0) ; ref file #43.1, MAS event rates file for BT rates
"RTN","DGBTEE2",32,0)
ELIG ;  lookup current eligibilities for patient and put into TMP list
"RTN","DGBTEE2",33,0)
 S DGBTCT=1,^TMP("DGBT",$J,DGBTCT)=VAEL(1)
"RTN","DGBTEE2",34,0)
 F I=0:0 S I=$O(VAEL(1,I)) Q:'I  S DGBTCT=DGBTCT+1,^TMP("DGBT",$J,DGBTCT)=VAEL(1,I)
"RTN","DGBTEE2",35,0)
 Q
"RTN","DGBTEE2",36,0)
ELIST ;
"RTN","DGBTEE2",37,0)
 W !!?5,"Primary and other entitled eligibilities for patient:",!
"RTN","DGBTEE2",38,0)
 I DGBTCT>1 F I=0:0 S I=$O(^TMP("DGBT",$J,I)) Q:'I  W !?10,$P(^TMP("DGBT",$J,I),U,2)
"RTN","DGBTEE2",39,0)
 Q
"RTN","DGBTEE2",40,0)
EXIT ;
"RTN","DGBTEE2",41,0)
 Q
"VER")
8.0^22.0
"BLD",7846,6)
^18
**END**
**END**
