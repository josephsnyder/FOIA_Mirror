Released GMRV*5*24 SEQ #18
Extracted from mail message
**KIDS**:GMRV*5.0*24^

**INSTALL NAME**
GMRV*5.0*24
"BLD",6925,0)
GMRV*5.0*24^GEN. MED. REC. - VITALS^0^3100222^y
"BLD",6925,1,0)
^^3^3^3090929^^
"BLD",6925,1,1,0)
This patch will correct the hospital location pointers in the GMRV VITAL 
"BLD",6925,1,2,0)
MEASUREMENT file (#120.5) by making a call to the Registration package to 
"BLD",6925,1,3,0)
get the hospital location pointer the patient was checked in to.
"BLD",6925,4,0)
^9.64PA^^
"BLD",6925,6.3)
24
"BLD",6925,"ABPKG")
n
"BLD",6925,"INIT")
EN^GMVFIXHL
"BLD",6925,"KRN",0)
^9.67PA^8989.52^19
"BLD",6925,"KRN",.4,0)
.4
"BLD",6925,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",6925,"KRN",.401,0)
.401
"BLD",6925,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",6925,"KRN",.402,0)
.402
"BLD",6925,"KRN",.403,0)
.403
"BLD",6925,"KRN",.5,0)
.5
"BLD",6925,"KRN",.84,0)
.84
"BLD",6925,"KRN",3.6,0)
3.6
"BLD",6925,"KRN",3.8,0)
3.8
"BLD",6925,"KRN",9.2,0)
9.2
"BLD",6925,"KRN",9.8,0)
9.8
"BLD",6925,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6925,"KRN",9.8,"NM",1,0)
GMVFIXHL^^0^B41436949
"BLD",6925,"KRN",9.8,"NM","B","GMVFIXHL",1)

"BLD",6925,"KRN",19,0)
19
"BLD",6925,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6925,"KRN",19.1,0)
19.1
"BLD",6925,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6925,"KRN",101,0)
101
"BLD",6925,"KRN",409.61,0)
409.61
"BLD",6925,"KRN",771,0)
771
"BLD",6925,"KRN",870,0)
870
"BLD",6925,"KRN",8989.51,0)
8989.51
"BLD",6925,"KRN",8989.52,0)
8989.52
"BLD",6925,"KRN",8994,0)
8994
"BLD",6925,"KRN","B",.4,.4)

"BLD",6925,"KRN","B",.401,.401)

"BLD",6925,"KRN","B",.402,.402)

"BLD",6925,"KRN","B",.403,.403)

"BLD",6925,"KRN","B",.5,.5)

"BLD",6925,"KRN","B",.84,.84)

"BLD",6925,"KRN","B",3.6,3.6)

"BLD",6925,"KRN","B",3.8,3.8)

"BLD",6925,"KRN","B",9.2,9.2)

"BLD",6925,"KRN","B",9.8,9.8)

"BLD",6925,"KRN","B",19,19)

"BLD",6925,"KRN","B",19.1,19.1)

"BLD",6925,"KRN","B",101,101)

"BLD",6925,"KRN","B",409.61,409.61)

"BLD",6925,"KRN","B",771,771)

"BLD",6925,"KRN","B",870,870)

"BLD",6925,"KRN","B",8989.51,8989.51)

"BLD",6925,"KRN","B",8989.52,8989.52)

"BLD",6925,"KRN","B",8994,8994)

"BLD",6925,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",6925,"QUES",0)
^9.62^^0
"BLD",6925,"REQB",0)
^9.611^3^2
"BLD",6925,"REQB",2,0)
GMRV*5.0*22^2
"BLD",6925,"REQB",3,0)
XU*8.0*491^2
"BLD",6925,"REQB","B","GMRV*5.0*22",2)

"BLD",6925,"REQB","B","XU*8.0*491",3)

"INIT")
EN^GMVFIXHL
"MBREQ")
0
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
5.0^3021029
"PKG",44,22,1,"PAH",1,0)
24^3100222
"PKG",44,22,1,"PAH",1,1,0)
^^3^3^3100222
"PKG",44,22,1,"PAH",1,1,1,0)
This patch will correct the hospital location pointers in the GMRV VITAL 
"PKG",44,22,1,"PAH",1,1,2,0)
MEASUREMENT file (#120.5) by making a call to the Registration package to 
"PKG",44,22,1,"PAH",1,1,3,0)
get the hospital location pointer the patient was checked in to.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMVFIXHL")
0^1^B41436949^n/a
"RTN","GMVFIXHL",1,0)
GMVFIXHL ;HIOFO/FT - HOSPITAL LOCATION FIX ;10/20/09  11:42
"RTN","GMVFIXHL",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**24**;Oct 31, 2002;Build 24
"RTN","GMVFIXHL",3,0)
 ;
"RTN","GMVFIXHL",4,0)
 ; This routine uses the following IAs:
"RTN","GMVFIXHL",5,0)
 ; #2320  - ^%ZISH calls             (supported)
"RTN","GMVFIXHL",6,0)
 ; #4253  - ^VDEFQM calls            (controlled)
"RTN","GMVFIXHL",7,0)
 ; #10039 - FILE 42 references       (supported)
"RTN","GMVFIXHL",8,0)
 ; #10040 - FILE 44 references       (supported)
"RTN","GMVFIXHL",9,0)
 ; #10061 - ^VADPT calls             (supported)
"RTN","GMVFIXHL",10,0)
 ; #10063 - ^%ZTLOAD                 (supported)
"RTN","GMVFIXHL",11,0)
 ; #10070 - ^XMD calls               (supported)
"RTN","GMVFIXHL",12,0)
 ; #10103 - ^XLFDT calls             (supported)
"RTN","GMVFIXHL",13,0)
 ; #10141 - ^XPDUTL calls            (supported)
"RTN","GMVFIXHL",14,0)
 ;
"RTN","GMVFIXHL",15,0)
EN ;
"RTN","GMVFIXHL",16,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZTSTOP
"RTN","GMVFIXHL",17,0)
 S ZTDESC="GMRV*5.0*24 HOSPITAL LOCATION FIX",ZTIO=""
"RTN","GMVFIXHL",18,0)
 S ZTSAVE("DUZ")=""
"RTN","GMVFIXHL",19,0)
 S ZTRTN="QUEUE^GMVFIXHL",ZTDTH=$$NOW^XLFDT()
"RTN","GMVFIXHL",20,0)
 D ^%ZTLOAD
"RTN","GMVFIXHL",21,0)
 D EN^DDIOL("Task "_ZTSK_" has started. I'll send you a MailMan message when I finish.","","!?5")
"RTN","GMVFIXHL",22,0)
 Q
"RTN","GMVFIXHL",23,0)
QUEUE ; The problem started when GMRV*5.0*3 was installed.
"RTN","GMVFIXHL",24,0)
 ; a) Find date patch 3 was installed. Go back a little farther to be safe.
"RTN","GMVFIXHL",25,0)
 ; b) Loop through FILE 120.5.
"RTN","GMVFIXHL",26,0)
 ; c) Ignore if not inpatient.
"RTN","GMVFIXHL",27,0)
 ; d) Check hospital location pointer of the Vitals record.
"RTN","GMVFIXHL",28,0)
 ; e)Determine if pointer can/needs to be changed.
"RTN","GMVFIXHL",29,0)
 N GMVBEG,GMVCNT,GMVDFN,GMVECNT,GMVEDT,GMVEND,GMVFILE,GMVHL,GMVIEN,GMVMSG,GMVNODE,GMVODT,GMVPATH,GMVPIEN,GMVSDT,GMVTOT,GMVTOTAL
"RTN","GMVFIXHL",30,0)
 N POP
"RTN","GMVFIXHL",31,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","GMVFIXHL",32,0)
 K ^TMP($J,"GMVHL")
"RTN","GMVFIXHL",33,0)
 S GMVBEG=$$FMTE^XLFDT($$NOW^XLFDT,"5Z")
"RTN","GMVFIXHL",34,0)
 ;Get patch 3 installation date
"RTN","GMVFIXHL",35,0)
 D INSTALDT^XPDUTL("GMRV*5.0*3",.GMVDATES)
"RTN","GMVFIXHL",36,0)
 I $G(GMVDATES(0))=0 D  Q
"RTN","GMVFIXHL",37,0)
 .K GMVTEXT
"RTN","GMVFIXHL",38,0)
 .S GMVTEXT(1)="I cannot find an installation date for GMRV*5.0*3."
"RTN","GMVFIXHL",39,0)
 .S GMVTEXT(2)="Please file a Remedy ticket."
"RTN","GMVFIXHL",40,0)
 .D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",41,0)
 .Q
"RTN","GMVFIXHL",42,0)
 S GMVSDT=0
"RTN","GMVFIXHL",43,0)
 S GMVSDT=$O(GMVDATES(GMVSDT)) ;get the earliest install date
"RTN","GMVFIXHL",44,0)
 I 'GMVSDT D  Q
"RTN","GMVFIXHL",45,0)
 .K GMVTEXT
"RTN","GMVFIXHL",46,0)
 .S GMVTEXT(1)="I cannot find a valid installation date for GMRV*5.0*3."
"RTN","GMVFIXHL",47,0)
 .S GMVTEXT(2)="Please file a Remedy ticket."
"RTN","GMVFIXHL",48,0)
 .D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",49,0)
 .Q
"RTN","GMVFIXHL",50,0)
 ;problem fixed with patch 22 installation
"RTN","GMVFIXHL",51,0)
 K GMVDATES
"RTN","GMVFIXHL",52,0)
 D INSTALDT^XPDUTL("GMRV*5.0*22",.GMVDATES)
"RTN","GMVFIXHL",53,0)
 I $G(GMVDATES(0))=0 D  Q
"RTN","GMVFIXHL",54,0)
 .K GMVTEXT
"RTN","GMVFIXHL",55,0)
 .S GMVTEXT(1)="I cannot find an installation date for GMRV*5.0*22."
"RTN","GMVFIXHL",56,0)
 .S GMVTEXT(2)="Please file a Remedy ticket."
"RTN","GMVFIXHL",57,0)
 .D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",58,0)
 .Q
"RTN","GMVFIXHL",59,0)
 S GMVEDT=0
"RTN","GMVFIXHL",60,0)
 S GMVEDT=$O(GMVDATES(GMVEDT)) ;get the earliest install date
"RTN","GMVFIXHL",61,0)
 I 'GMVEDT D  Q
"RTN","GMVFIXHL",62,0)
 .K GMVTEXT
"RTN","GMVFIXHL",63,0)
 .S GMVTEXT(1)="I cannot find a valid installation date for GMRV*5.0*22."
"RTN","GMVFIXHL",64,0)
 .S GMVTEXT(2)="Please file a Remedy ticket."
"RTN","GMVFIXHL",65,0)
 .D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",66,0)
 .Q
"RTN","GMVFIXHL",67,0)
 ; set host file name and directory path
"RTN","GMVFIXHL",68,0)
 S GMVFILE="GMRV_5_24.DAT"
"RTN","GMVFIXHL",69,0)
 S GMVPATH=$$PWD^%ZISH ;current directory
"RTN","GMVFIXHL",70,0)
 ; Open up device to print to
"RTN","GMVFIXHL",71,0)
 D OPEN^%ZISH("VITAL",GMVPATH,GMVFILE,"A") ;'A' for append
"RTN","GMVFIXHL",72,0)
 I POP D  Q  ;send email if device cannot be opened
"RTN","GMVFIXHL",73,0)
 .K GMVTEXT
"RTN","GMVFIXHL",74,0)
 .S GMVTEXT(1)="Could not open file "_GMVFILE_" in path "_GMVPATH_"."
"RTN","GMVFIXHL",75,0)
 .S GMVTEXT(2)="Please try again."
"RTN","GMVFIXHL",76,0)
 .D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",77,0)
 .Q
"RTN","GMVFIXHL",78,0)
 U IO
"RTN","GMVFIXHL",79,0)
 ; from this point on, the Write commands are to the host file.
"RTN","GMVFIXHL",80,0)
 S GMVSDT=$$FMADD^XLFDT(GMVSDT,-7) ;go back additional 7 days to be certain
"RTN","GMVFIXHL",81,0)
 S (GMVCNT,GMVECNT,GMVPIEN,GMVTOT,GMVTOTAL)=0
"RTN","GMVFIXHL",82,0)
 F  S GMVSDT=$O(^GMR(120.5,"B",GMVSDT)) Q:'GMVSDT!($G(ZTSTOP)=1)!(GMVSDT>GMVEDT)  D
"RTN","GMVFIXHL",83,0)
 .S GMVIEN=0
"RTN","GMVFIXHL",84,0)
 .K GMVLOC
"RTN","GMVFIXHL",85,0)
 .F  S GMVIEN=$O(^GMR(120.5,"B",GMVSDT,GMVIEN)) Q:'GMVIEN!($G(ZTSTOP)=1)  D
"RTN","GMVFIXHL",86,0)
 ..S GMVTOTAL=GMVTOTAL+1
"RTN","GMVFIXHL",87,0)
 ..S GMVCNT=GMVCNT+1
"RTN","GMVFIXHL",88,0)
 ..I GMVCNT>10000 D  ;check if user wants to stop the job
"RTN","GMVFIXHL",89,0)
 ...S GMVCNT=0
"RTN","GMVFIXHL",90,0)
 ...Q:'$D(ZTQUEUED)  ;not a background task
"RTN","GMVFIXHL",91,0)
 ...I $$S^%ZTLOAD D
"RTN","GMVFIXHL",92,0)
 ....S ZTSTOP=1 ;set TaskMan variable equal to 1 to stop task
"RTN","GMVFIXHL",93,0)
 ....W !,"Task stopped. Last record processed was "_GMVPIEN
"RTN","GMVFIXHL",94,0)
 ....K ZTREQ ;keep record of task in task log
"RTN","GMVFIXHL",95,0)
 ..S GMVNODE=$G(^GMR(120.5,GMVIEN,0)),GMVPIEN=GMVIEN
"RTN","GMVFIXHL",96,0)
 ..I ($P(GMVNODE,U,1)="")!($P(GMVNODE,U,2)="")!($P(GMVNODE,U,3)="")!($P(GMVNODE,U,8)="") Q
"RTN","GMVFIXHL",97,0)
 ..S GMVHL=+$P(GMVNODE,U,5),GMVDFN=+$P(GMVNODE,U,2),GMVODT=+$P(GMVNODE,U,1)
"RTN","GMVFIXHL",98,0)
 ..;get inpatient location for this dfn & d/t
"RTN","GMVFIXHL",99,0)
 ..I '$D(GMVLOC(GMVDFN,GMVODT)) D INP
"RTN","GMVFIXHL",100,0)
 ..I $G(GMVLOC(GMVDFN,GMVODT))'>0 Q  ;not an inpatient
"RTN","GMVFIXHL",101,0)
 ..I $G(GMVLOC(GMVDFN,GMVODT))=GMVHL Q  ;no discrepancy
"RTN","GMVFIXHL",102,0)
 ..Q:$D(^SC(+GMVHL,0))  ;quit if FILE 44 entry exists
"RTN","GMVFIXHL",103,0)
 ..I $G(GMVLOC(GMVDFN,GMVODT))'=GMVHL D
"RTN","GMVFIXHL",104,0)
 ...S GMVMSG=$$SETHL(GMVLOC(GMVDFN,GMVODT),GMVIEN,GMVHL)
"RTN","GMVFIXHL",105,0)
 ...W !,GMVMSG
"RTN","GMVFIXHL",106,0)
 ...D HDR(GMVIEN,GMVDFN) ;upload record to HDR
"RTN","GMVFIXHL",107,0)
 S GMVEND=$$FMTE^XLFDT($$NOW^XLFDT,"5Z")
"RTN","GMVFIXHL",108,0)
 W !,"                            Start Date/time: "_GMVBEG
"RTN","GMVFIXHL",109,0)
 W !,"                           Finish Date/time: "_GMVEND
"RTN","GMVFIXHL",110,0)
 W !,"                  Number of records checked: "_GMVTOTAL
"RTN","GMVFIXHL",111,0)
 W !,"                  Number of records changed: "_GMVTOT
"RTN","GMVFIXHL",112,0)
 W !,"Number of records that could not be changed: "_GMVECNT
"RTN","GMVFIXHL",113,0)
 D CLOSE^%ZISH("VITAL")
"RTN","GMVFIXHL",114,0)
 K GMVTEXT
"RTN","GMVFIXHL",115,0)
 S GMVTEXT(1)="              The repair utility started at: "_GMVBEG
"RTN","GMVFIXHL",116,0)
 S GMVTEXT(2)="             The repair utility finished at: "_GMVEND
"RTN","GMVFIXHL",117,0)
 S GMVTEXT(3)="                  Number of records checked: "_GMVTOTAL
"RTN","GMVFIXHL",118,0)
 S GMVTEXT(4)="                  Number of records changed: "_GMVTOT
"RTN","GMVFIXHL",119,0)
 S GMVTEXT(5)="Number of records that could not be changed: "_GMVECNT
"RTN","GMVFIXHL",120,0)
 S GMVTEXT(6)=" "
"RTN","GMVFIXHL",121,0)
 S GMVTEXT(7)="The "_GMVFILE_" file in the "_GMVPATH_" directory contains"
"RTN","GMVFIXHL",122,0)
 S GMVTEXT(8)="a listing of entries changed."
"RTN","GMVFIXHL",123,0)
 D EMAIL(.GMVTEXT)
"RTN","GMVFIXHL",124,0)
 Q
"RTN","GMVFIXHL",125,0)
SETHL(NEWHL,IEN,OLDHL) ; Set hospital location pointer (.05) field in 120.5. 
"RTN","GMVFIXHL",126,0)
 ; Returns a line of text
"RTN","GMVFIXHL",127,0)
 ; NEWHL = New File 44 pointer
"RTN","GMVFIXHL",128,0)
 ;   IEN = File 120.5 record ien
"RTN","GMVFIXHL",129,0)
 ; OLDHL = Old File 44 pointer
"RTN","GMVFIXHL",130,0)
 N GMVERR,GMVFDA,GMVDA,GMVLINE
"RTN","GMVFIXHL",131,0)
 S GMVLINE=""
"RTN","GMVFIXHL",132,0)
 S GMVFDA(120.5,IEN_",",.05)=NEWHL
"RTN","GMVFIXHL",133,0)
 D UPDATE^DIE("","GMVFDA","GMVDA","GMVERR")
"RTN","GMVFIXHL",134,0)
 I +$P($G(GMVERR("DIERR")),U,1)>0 D
"RTN","GMVFIXHL",135,0)
 .S GMVLINE="RECORD: "_IEN_", not changed because: "_$G(GMVERR("DIERR",1,"TEXT",1))
"RTN","GMVFIXHL",136,0)
 .S GMVECNT=GMVECNT+1
"RTN","GMVFIXHL",137,0)
 I +$P($G(GMVERR("DIERR")),U,1)'>0 D
"RTN","GMVFIXHL",138,0)
 .S GMVLINE="RECORD: "_IEN_"  OLD LOCATION: "_OLDHL_"  NEW LOCATION: "_NEWHL
"RTN","GMVFIXHL",139,0)
 .S GMVTOT=GMVTOT+1
"RTN","GMVFIXHL",140,0)
 Q GMVLINE
"RTN","GMVFIXHL",141,0)
 ;
"RTN","GMVFIXHL",142,0)
INP ;get inpatient location
"RTN","GMVFIXHL",143,0)
 N DFN,GMVAIN,GMVHLPTR,GMVWPTR,VAINDT,VAROOT
"RTN","GMVFIXHL",144,0)
 S DFN=GMVDFN,VAINDT=GMVODT,VAROOT="GMVAIN",GMVLOC(GMVDFN,GMVODT)=""
"RTN","GMVFIXHL",145,0)
 D INP^VADPT
"RTN","GMVFIXHL",146,0)
 S GMVWPTR=+$P(GMVAIN(4),U,1)
"RTN","GMVFIXHL",147,0)
 D KVAR^VADPT
"RTN","GMVFIXHL",148,0)
 Q:'GMVWPTR
"RTN","GMVFIXHL",149,0)
 S GMVHLPTR=+$P($G(^DIC(42,GMVWPTR,44)),U,1)
"RTN","GMVFIXHL",150,0)
 Q:'GMVHLPTR
"RTN","GMVFIXHL",151,0)
 S GMVLOC(GMVDFN,GMVODT)=GMVHLPTR
"RTN","GMVFIXHL",152,0)
 Q
"RTN","GMVFIXHL",153,0)
EMAIL(GMVTXT) ; Send a MailMan message
"RTN","GMVFIXHL",154,0)
 N DIFROM,XMDUZ,XMSUB,XMTEXT,XMY
"RTN","GMVFIXHL",155,0)
 S XMSUB="GMRV*5.0*24 HOSPITAL LOCATION REPAIR"
"RTN","GMVFIXHL",156,0)
 S XMY(DUZ)="",XMDUZ=.5
"RTN","GMVFIXHL",157,0)
 S XMTEXT="GMVTXT("
"RTN","GMVFIXHL",158,0)
 D ^XMD
"RTN","GMVFIXHL",159,0)
 Q
"RTN","GMVFIXHL",160,0)
HDR(GMVX,GMVY) ; Send record to Health Data Repository (HDR)
"RTN","GMVFIXHL",161,0)
 ;  Input: GMVX - FILE 120.5 IEN
"RTN","GMVFIXHL",162,0)
 ;         GMVY - DFN
"RTN","GMVFIXHL",163,0)
 ; Output: none
"RTN","GMVFIXHL",164,0)
 N ERR,GMVFLAG
"RTN","GMVFIXHL",165,0)
 S GMVX=+$G(GMVX),GMVY=+$G(GMVY)
"RTN","GMVFIXHL",166,0)
 Q:'GMVX
"RTN","GMVFIXHL",167,0)
 Q:'GMVY
"RTN","GMVFIXHL",168,0)
 Q:$$TESTPAT^VADPT(GMVY)  ;ignore test patients
"RTN","GMVFIXHL",169,0)
 I $T(QUEUE^VDEFQM)]"" D
"RTN","GMVFIXHL",170,0)
 .S GMVFLAG=$$QUEUE^VDEFQM("ORU^R01","SUBTYPE=VTLS^IEN="_GMVX,.ERR)
"RTN","GMVFIXHL",171,0)
 Q
"VER")
8.0^22.0
"BLD",6925,6)
^18
**END**
**END**
