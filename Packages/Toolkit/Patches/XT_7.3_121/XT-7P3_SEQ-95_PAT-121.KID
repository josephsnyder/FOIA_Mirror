Released XT*7.3*121 SEQ #95
Extracted from mail message
**KIDS**:XT*7.3*121^

**INSTALL NAME**
XT*7.3*121
"BLD",1249,0)
XT*7.3*121^TOOLKIT^0^3091202^y
"BLD",1249,1,0)
^^3^3^3090812^
"BLD",1249,1,1,0)
Please see the patch description on FORUM, in the National
"BLD",1249,1,2,0)
 Patch Module.
"BLD",1249,1,3,0)

"BLD",1249,4,0)
^9.64PA^^
"BLD",1249,6.3)
7
"BLD",1249,"ABPKG")
n
"BLD",1249,"KRN",0)
^9.67PA^9002226^21
"BLD",1249,"KRN",.4,0)
.4
"BLD",1249,"KRN",.401,0)
.401
"BLD",1249,"KRN",.402,0)
.402
"BLD",1249,"KRN",.403,0)
.403
"BLD",1249,"KRN",.5,0)
.5
"BLD",1249,"KRN",.84,0)
.84
"BLD",1249,"KRN",3.6,0)
3.6
"BLD",1249,"KRN",3.8,0)
3.8
"BLD",1249,"KRN",9.2,0)
9.2
"BLD",1249,"KRN",9.8,0)
9.8
"BLD",1249,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",1249,"KRN",9.8,"NM",1,0)
XINDEX^^0^B27883860
"BLD",1249,"KRN",9.8,"NM",2,0)
XINDX2^^0^B18776883
"BLD",1249,"KRN",9.8,"NM",3,0)
XINDX3^^0^B12135035
"BLD",1249,"KRN",9.8,"NM",4,0)
XINDX5^^0^B11265539
"BLD",1249,"KRN",9.8,"NM",5,0)
XINDX9^^0^B16811292
"BLD",1249,"KRN",9.8,"NM",6,0)
XINDX11^^0^B11119765
"BLD",1249,"KRN",9.8,"NM",7,0)
XINDX1^^0^B17282098
"BLD",1249,"KRN",9.8,"NM","B","XINDEX",1)

"BLD",1249,"KRN",9.8,"NM","B","XINDX1",7)

"BLD",1249,"KRN",9.8,"NM","B","XINDX11",6)

"BLD",1249,"KRN",9.8,"NM","B","XINDX2",2)

"BLD",1249,"KRN",9.8,"NM","B","XINDX3",3)

"BLD",1249,"KRN",9.8,"NM","B","XINDX5",4)

"BLD",1249,"KRN",9.8,"NM","B","XINDX9",5)

"BLD",1249,"KRN",19,0)
19
"BLD",1249,"KRN",19.1,0)
19.1
"BLD",1249,"KRN",101,0)
101
"BLD",1249,"KRN",409.61,0)
409.61
"BLD",1249,"KRN",771,0)
771
"BLD",1249,"KRN",779.2,0)
779.2
"BLD",1249,"KRN",870,0)
870
"BLD",1249,"KRN",8989.51,0)
8989.51
"BLD",1249,"KRN",8989.52,0)
8989.52
"BLD",1249,"KRN",8994,0)
8994
"BLD",1249,"KRN",9002226,0)
9002226
"BLD",1249,"KRN","B",.4,.4)

"BLD",1249,"KRN","B",.401,.401)

"BLD",1249,"KRN","B",.402,.402)

"BLD",1249,"KRN","B",.403,.403)

"BLD",1249,"KRN","B",.5,.5)

"BLD",1249,"KRN","B",.84,.84)

"BLD",1249,"KRN","B",3.6,3.6)

"BLD",1249,"KRN","B",3.8,3.8)

"BLD",1249,"KRN","B",9.2,9.2)

"BLD",1249,"KRN","B",9.8,9.8)

"BLD",1249,"KRN","B",19,19)

"BLD",1249,"KRN","B",19.1,19.1)

"BLD",1249,"KRN","B",101,101)

"BLD",1249,"KRN","B",409.61,409.61)

"BLD",1249,"KRN","B",771,771)

"BLD",1249,"KRN","B",779.2,779.2)

"BLD",1249,"KRN","B",870,870)

"BLD",1249,"KRN","B",8989.51,8989.51)

"BLD",1249,"KRN","B",8989.52,8989.52)

"BLD",1249,"KRN","B",8994,8994)

"BLD",1249,"KRN","B",9002226,9002226)

"BLD",1249,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",1249,"QUES",0)
^9.62^^
"BLD",1249,"REQB",0)
^9.611^1^1
"BLD",1249,"REQB",1,0)
XT*7.3*110^2
"BLD",1249,"REQB","B","XT*7.3*110",1)

"MBREQ")
0
"PKG",6,-1)
1^1
"PKG",6,0)
TOOLKIT^XT^PROGRAMMERS OPTIONS, MULTI. TERM LOOKUP^
"PKG",6,20,0)
^9.402P^^0
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.3^3040428^2970513^2
"PKG",6,22,1,"PAH",1,0)
121^3091202
"PKG",6,22,1,"PAH",1,1,0)
^^3^3^3091202
"PKG",6,22,1,"PAH",1,1,1,0)
Please see the patch description on FORUM, in the National
"PKG",6,22,1,"PAH",1,1,2,0)
 Patch Module.
"PKG",6,22,1,"PAH",1,1,3,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","XINDEX")
0^1^B27883860^B27047863
"RTN","XINDEX",1,0)
XINDEX ;ISC/REL,GFT,GRK,RWF - INDEX & CROSS-REFERENCE ;08/04/08  13:19
"RTN","XINDEX",2,0)
 ;;7.3;TOOLKIT;**20,27,48,61,66,68,110,121**;Apr 25, 1995;Build 7
"RTN","XINDEX",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDEX",4,0)
 G ^XINDX6
"RTN","XINDEX",5,0)
SEP F I=1:1 S CH=$E(LIN,I) D QUOTE:CH=Q Q:" "[CH
"RTN","XINDEX",6,0)
 S ARG=$E(LIN,1,I-1) S:CH=" " I=I+1 S LIN=$E(LIN,I,999) Q
"RTN","XINDEX",7,0)
QUOTE F I=I+1:1 S CH=$E(LIN,I) Q:CH=""!(CH=Q)
"RTN","XINDEX",8,0)
 Q:CH]""  S ERR=6 G ^XINDX1
"RTN","XINDEX",9,0)
ALIVE ;enter here from taskman
"RTN","XINDEX",10,0)
 D SETUP^XINDX7 ;Get ready to process
"RTN","XINDEX",11,0)
A2 S RTN=$O(^UTILITY($J,RTN)) G ^XINDX5:RTN=""
"RTN","XINDEX",12,0)
 S INDLC=(RTN?1"|"1.4L.NP) D LOAD:'INDLC
"RTN","XINDEX",13,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD S RTN="~",IND("QUIT")=1,ZTSTOP=1 G A2
"RTN","XINDEX",14,0)
 I 'INDDS,INDLC W !!?10,"Data Dictionaries",! S INDDS=1
"RTN","XINDEX",15,0)
 D BEG
"RTN","XINDEX",16,0)
 G A2
"RTN","XINDEX",17,0)
 ;
"RTN","XINDEX",18,0)
LOAD S X=RTN,XCNP=0,DIF="^UTILITY("_$J_",1,RTN,0," X ^%ZOSF("TEST") Q:'$T  X ^%ZOSF("LOAD") S ^UTILITY($J,1,RTN,0,0)=XCNP-1
"RTN","XINDEX",19,0)
 I $D(^UTILITY($J,1,RTN,0,0)) S ^UTILITY($J,1,RTN,"RSUM")="B"_$$SUMB^XPDRSUM($NA(^UTILITY($J,1,RTN,0)))
"RTN","XINDEX",20,0)
 Q
"RTN","XINDEX",21,0)
BEG ;
"RTN","XINDEX",22,0)
 S %=INDLC*5 W:$X+10+%>IOM ! W RTN,$J("",10+%-$L(RTN))
"RTN","XINDEX",23,0)
 S (IND("DO"),IND("SZT"),IND("SZC"),LABO)=0,LC=$G(^UTILITY($J,1,RTN,0,0))
"RTN","XINDEX",24,0)
 I LC="" W !,">>>Routine '",RTN,"' not found <<<",! Q
"RTN","XINDEX",25,0)
 S TXT="",LAB=$P(^UTILITY($J,1,RTN,0,1,0)," ") I RTN'=$P(LAB,"(") D E^XINDX1(17)
"RTN","XINDEX",26,0)
 I 'INDLC,LAB["(" D E^XINDX1(55) S LAB=$P(LAB,"(")
"RTN","XINDEX",27,0)
 I 'INDLC,LC>2 S LIN=$G(^UTILITY($J,1,RTN,0,2,0)),TXT=2 D
"RTN","XINDEX",28,0)
 . N LABO S LABO=1
"RTN","XINDEX",29,0)
 . I $P(LIN,";",3,99)'?1.2N1"."1.2N.1(1"T",1"V").2N1";".E D E^XINDX1(44) ;patch 121
"RTN","XINDEX",30,0)
 . I $L(INP(11)) X INP(11) ;Version number check
"RTN","XINDEX",31,0)
 . I $L(INP(12)) X INP(12) ;Patch number check
"RTN","XINDEX",32,0)
B5 F TXT=1:1:LC S LIN=^UTILITY($J,1,RTN,0,TXT,0),LN=$L(LIN),IND("SZT")=IND("SZT")+LN+2 D LN,ST ;Process Line
"RTN","XINDEX",33,0)
 S LAB="",LABO=0,TXT=0,^UTILITY($J,1,RTN,0)=IND("SZT")_"^"_LC_"^"_IND("SZC")
"RTN","XINDEX",34,0)
 I IND("SZT")>INP("MAX"),'INDLC S ERR=35,ERR(1)=IND("SZT") D ^XINDX1
"RTN","XINDEX",35,0)
 I IND("SZT")-IND("SZC")>INP("CMAX"),'INDLC S ERR=58,ERR(1)=IND("SZT")-IND("SZC") D ^XINDX1
"RTN","XINDEX",36,0)
 D POSTRTN
"RTN","XINDEX",37,0)
 Q
"RTN","XINDEX",38,0)
 ;Proccess one line, LN = Length, LIN = Line.
"RTN","XINDEX",39,0)
LN K V S (ARG,GRB,IND("COM"))="",X=$P(LIN," ") I '$L(X) S LABO=LABO+1 G CD
"RTN","XINDEX",40,0)
 S (IND("COM"),LAB)=$P(X,"("),ARG=$P($P(X,"(",2),")"),LABO=0,IND("PP")=X?1.8E1"(".E1")"
"RTN","XINDEX",41,0)
 D:$L(ARG) NE^XINDX3 ;Process formal parameters as New list.
"RTN","XINDEX",42,0)
 I 'INDLC,'$$VT^XINDX2(LAB) D E^XINDX1($S(LAB=$$CASE^XINDX52(LAB):37,1:55)) ;Check for bad labels
"RTN","XINDEX",43,0)
 I $D(^UTILITY($J,1,RTN,"T",LAB)) D E^XINDX1(15) G CD ;DUP label
"RTN","XINDEX",44,0)
 S ^UTILITY($J,1,RTN,"T",LAB)=""
"RTN","XINDEX",45,0)
CD I LN>245 D:'(LN=246&($E(RTN,1,3)="|dd")) E^XINDX1(19) ;patch 119
"RTN","XINDEX",46,0)
 D:LIN'?1.ANP E^XINDX1(18)
"RTN","XINDEX",47,0)
 S LIN=$P(LIN," ",2,999),IND("LCC")=1
"RTN","XINDEX",48,0)
 I LIN="" D E^XINDX1(42) Q  ;Blank line ;p110
"RTN","XINDEX",49,0)
 S I=0 ;Watch the scope of I.
"RTN","XINDEX",50,0)
 I " ."[$E(LIN) D  S X=$L($E(LIN,1,I),".")-1,LIN=$E(LIN,I,999)
"RTN","XINDEX",51,0)
 . F I=1:1:245 Q:". "'[$E(LIN,I)
"RTN","XINDEX",52,0)
 . Q
"RTN","XINDEX",53,0)
 D:'I&$G(IND("DO1")) E^XINDX1(51) S IND("DO1")=0 S:'I IND("DO")=0 I I D:X>IND("DO") E^XINDX1(51) S IND("DO")=X
"RTN","XINDEX",54,0)
 ;Count Comment lines, skip ;; lines
"RTN","XINDEX",55,0)
 I $E(LIN)=";",$E(LIN,2)'=";" S IND("SZC")=IND("SZC")+$L(LIN) ;p110
"RTN","XINDEX",56,0)
 ;Process commands on line.
"RTN","XINDEX",57,0)
EE I LIN="" D ^XINDX2 Q
"RTN","XINDEX",58,0)
 S COM=$E(LIN),GK="",ARG=""
"RTN","XINDEX",59,0)
 I COM=";" S LIN="" G EE ;p110
"RTN","XINDEX",60,0)
 I COM=" " S ERR=$S(LIN?1." ":13,1:0),LIN=$S(ERR:"",1:$E(LIN,2,999)) D:ERR ^XINDX1 G EE
"RTN","XINDEX",61,0)
 D SEP
"RTN","XINDEX",62,0)
 S CM=$P(ARG,":",1),POST=$P(ARG,":",2,999),IND("COM")=IND("COM")_$C(9)_COM,ERR=48 D:ARG[":"&(POST']"") ^XINDX1 S:POST]"" GRB=GRB_$C(9)_POST,IND("COM")=IND("COM")_":"
"RTN","XINDEX",63,0)
 ;SAC now allows lowercase commands
"RTN","XINDEX",64,0)
 I CM?.E1L.E S CM=$$CASE^XINDX52(CM),COM=$E(CM) ;I IND("LCC") S IND("LCC")=0 D E^XINDX1(47)
"RTN","XINDEX",65,0)
 I CM="" D E^XINDX1(21) G EE ;Missing command
"RTN","XINDEX",66,0)
 S CX=$G(IND("CMD",CM)) I CX="" D  G:CX="" EE
"RTN","XINDEX",67,0)
 . I $E(CM)="Z" S CX="^Z" Q  ;Proccess Z commands
"RTN","XINDEX",68,0)
 . D E^XINDX1(1) S LIN="" Q
"RTN","XINDEX",69,0)
 S CX=$P(CX,"^",2,9)
"RTN","XINDEX",70,0)
 D SEP I '$L(LIN),CH=" " D E^XINDX1(13) ;trailing space
"RTN","XINDEX",71,0)
 I ARG="","CGJMORSUWX"[COM S ERR=49 G ^XINDX1
"RTN","XINDEX",72,0)
 I CX>0 D E^XINDX1(CX) S CX=""
"RTN","XINDEX",73,0)
 D:$L(CX) @CX S:ARG'="" GRB=GRB_$C(9)_ARG G EE
"RTN","XINDEX",74,0)
B S ERR=25 G ^XINDX1
"RTN","XINDEX",75,0)
C S ERR=29 G ^XINDX1
"RTN","XINDEX",76,0)
D G DG1^XINDX4
"RTN","XINDEX",77,0)
E Q:ARG=""  S ERR=7 G ^XINDX1
"RTN","XINDEX",78,0)
F G:ARG]"" FR^XINDX4 Q
"RTN","XINDEX",79,0)
G G DG^XINDX4
"RTN","XINDEX",80,0)
H Q:ARG'=""  S ERR=32 G ^XINDX1
"RTN","XINDEX",81,0)
J S ERR=36,ARG="" G ^XINDX1
"RTN","XINDEX",82,0)
K S ERR=$S(ARG?1"(".E:22,ARG?." ":23,1:0) D:ERR ^XINDX1
"RTN","XINDEX",83,0)
 G KL^XINDX3
"RTN","XINDEX",84,0)
L G LO^XINDX4
"RTN","XINDEX",85,0)
M G S^XINDX3
"RTN","XINDEX",86,0)
N G NE^XINDX3
"RTN","XINDEX",87,0)
O S ERR=34 D ^XINDX1,O^XINDX3 Q
"RTN","XINDEX",88,0)
Q Q:ARG=""  G Q^XINDX4
"RTN","XINDEX",89,0)
R S RDTIME=0 G RD^XINDX3
"RTN","XINDEX",90,0)
S G S^XINDX3
"RTN","XINDEX",91,0)
TR Q  ;What to process. p110
"RTN","XINDEX",92,0)
U S ARG=$P(ARG,":") Q
"RTN","XINDEX",93,0)
V S ARG="",ERR=20 G ^XINDX1
"RTN","XINDEX",94,0)
W G WR^XINDX4
"RTN","XINDEX",95,0)
X G XE^XINDX4
"RTN","XINDEX",96,0)
Z S ERR=2 D ^XINDX1 G ZC^XINDX4
"RTN","XINDEX",97,0)
 ;
"RTN","XINDEX",98,0)
 ;Save off items from line.
"RTN","XINDEX",99,0)
ST S R=LAB_$S(LABO:"+"_LABO,1:"")
"RTN","XINDEX",100,0)
 ;Local variable, Global, Marked Items, Naked global, Internal ref, eXternal ref., Tag ref.
"RTN","XINDEX",101,0)
 S LOC="" F  S LOC=$O(V(LOC)),S="" Q:LOC=""  F  S S=$O(V(LOC,S)) Q:S=""  D SET
"RTN","XINDEX",102,0)
 S ^UTILITY($J,1,RTN,"COM",TXT)=IND("COM")
"RTN","XINDEX",103,0)
 Q
"RTN","XINDEX",104,0)
 ;
"RTN","XINDEX",105,0)
SET I V(LOC,S)]"" F %="!","~" I V(LOC,S)[%,$G(^UTILITY($J,1,RTN,LOC,S))'[% S ^(S)=$G(^(S))_%
"RTN","XINDEX",106,0)
 S %=0
"RTN","XINDEX",107,0)
SE2 S ARG=$G(^UTILITY($J,1,RTN,LOC,S,%)) I $L(ARG)>230 S %=%+1 G SE2
"RTN","XINDEX",108,0)
 S ^UTILITY($J,1,RTN,LOC,S,%)=ARG_R_V(LOC,S)_","
"RTN","XINDEX",109,0)
 Q
"RTN","XINDEX",110,0)
 ;
"RTN","XINDEX",111,0)
POSTRTN ;Do more overall checking
"RTN","XINDEX",112,0)
 N V,E,T,T1,T2
"RTN","XINDEX",113,0)
 S T="" ;Check for missing Labels
"RTN","XINDEX",114,0)
 F  S T=$O(^UTILITY($J,1,RTN,"I",T)),T2=T Q:T=""  S T1=$G(^(T,0)) D
"RTN","XINDEX",115,0)
 . Q:$E(T2,1,2)="@("
"RTN","XINDEX",116,0)
 . S:$E(T2,1,2)="$$" T2=$E(T2,3,99)
"RTN","XINDEX",117,0)
 . I T2]"",'$D(^UTILITY($J,1,RTN,"T",$P(T2,"+",1))) D
"RTN","XINDEX",118,0)
 . . F I=1:1:$L(T1,",")-1 S LAB=$P(T1,",",I),LABO=+$P(LAB,"+",2),LAB=$P(LAB,"+"),E=14,E(1)=T D E^XINDX1(.E)
"RTN","XINDEX",119,0)
 . . Q
"RTN","XINDEX",120,0)
 . Q
"RTN","XINDEX",121,0)
 S LAB="",LABO=0 ;Check for valid label names
"RTN","XINDEX",122,0)
 I 'INDLC F  S LAB=$O(^UTILITY($J,1,RTN,"T",LAB)) Q:LAB=""  D
"RTN","XINDEX",123,0)
 . I '$$VA^XINDX2(LAB) D E^XINDX1(55) Q
"RTN","XINDEX",124,0)
 . D:'$$VT^XINDX2(LAB) E^XINDX1(37)
"RTN","XINDEX",125,0)
 . Q
"RTN","XINDEX",126,0)
 S LAB="",LABO=0 ;Check for valid variable names.
"RTN","XINDEX",127,0)
 F  S LAB=$O(^UTILITY($J,1,RTN,"L",LAB)) Q:LAB=""  D
"RTN","XINDEX",128,0)
 . D VLNF^XINDX3($P(LAB,"("))
"RTN","XINDEX",129,0)
 . Q
"RTN","XINDEX",130,0)
 Q
"RTN","XINDEX",131,0)
 ;
"RTN","XINDEX",132,0)
QUICK ;Quick, Just get a routine an print the results
"RTN","XINDEX",133,0)
 D QUICK^XINDX6()
"RTN","XINDEX",134,0)
 Q
"RTN","XINDX1")
0^7^B17282098^B17410203
"RTN","XINDX1",1,0)
XINDX1 ;ISC/REL,GRK,RWF - ERROR ROUTINE ;08/05/08  13:59
"RTN","XINDX1",2,0)
 ;;7.3;TOOLKIT;**20,61,66,68,110,121**;Apr 25, 1995;Build 7
"RTN","XINDX1",3,0)
 G A
"RTN","XINDX1",4,0)
E(ERR) ;
"RTN","XINDX1",5,0)
A N %,%1 ;TXT is the line of the error.
"RTN","XINDX1",6,0)
 S ERTX=LAB_$S(LABO:"+"_LABO,1:"")_$C(9),%1=$T(ERROR+ERR),ERTX=ERTX_$S(ERR:$P(%1,";",4,9),1:ERR) ;p110
"RTN","XINDX1",7,0)
 I ERTX["|" F %=1:1 S ERTX=$P(ERTX,"|")_$S($D(ERR(%)):ERR(%),1:"??")_$P(ERTX,"|",%+1,99) Q:ERTX'["|"
"RTN","XINDX1",8,0)
B I $P(%1,";",3)]"" D  Q:%1]""  ;Don't flag kernel doing kernel.
"RTN","XINDX1",9,0)
 . S %1=$P(%1,";",3)
"RTN","XINDX1",10,0)
 . F  Q:RTN[$P(%1,",")  S %1=$P(%1,",",2,99) ;quit if RTN[%1 or null.
"RTN","XINDX1",11,0)
 . Q
"RTN","XINDX1",12,0)
 I ERR=17,$E(RTN)'="%",$E(LAB)="%" Q  ;Don't flag %RTN w/o %.
"RTN","XINDX1",13,0)
 ;Global is Error Line,tab,error tag,tab,error text
"RTN","XINDX1",14,0)
 S %=$G(^UTILITY($J,1,RTN,"E",0))+1,^(0)=%,^(%)=TXT_$C(9)_ERTX
"RTN","XINDX1",15,0)
 Q
"RTN","XINDX1",16,0)
 ;
"RTN","XINDX1",17,0)
 ;F = Fatal, S = Standard, W = Warning, I = Info
"RTN","XINDX1",18,0)
ERROR ;
"RTN","XINDX1",19,0)
1 ;;;F - UNDEFINED COMMAND (rest of line not checked).
"RTN","XINDX1",20,0)
2 ;;;F - Non-standard (Undefined) 'Z' command.
"RTN","XINDX1",21,0)
3 ;;XTRMON;F - Undefined Function.
"RTN","XINDX1",22,0)
4 ;;;F - Undefined Special Variable.
"RTN","XINDX1",23,0)
5 ;;;F - Unmatched Parenthesis.
"RTN","XINDX1",24,0)
6 ;;;F - Unmatched Quotation Marks.
"RTN","XINDX1",25,0)
7 ;;;F - ELSE Command followed by only one space.
"RTN","XINDX1",26,0)
8 ;;;F - FOR Command did not contain '='.
"RTN","XINDX1",27,0)
9 ;;;I - QUIT Command followed by only one space.
"RTN","XINDX1",28,0)
10 ;;;F - Unrecognized argument in SET command.
"RTN","XINDX1",29,0)
11 ;;;W - Invalid local variable name.
"RTN","XINDX1",30,0)
12 ;;;W - Invalid global variable name.
"RTN","XINDX1",31,0)
13 ;;;W - Blank(s) at end of line.
"RTN","XINDX1",32,0)
14 ;;;F - Call to missing label '|' in this routine.
"RTN","XINDX1",33,0)
15 ;;;W - Duplicate label. (M57)
"RTN","XINDX1",34,0)
16 ;;;F - Error in pattern code.
"RTN","XINDX1",35,0)
17 ;;;W - First line label NOT routine name.
"RTN","XINDX1",36,0)
18 ;;;W - Line contains a CONTROL (non-graphic) character.
"RTN","XINDX1",37,0)
19 ;;;S - Line is longer than 245 bytes.
"RTN","XINDX1",38,0)
20 ;;;S - View command used.
"RTN","XINDX1",39,0)
21 ;;;F - General Syntax Error.
"RTN","XINDX1",40,0)
22 ;;;S - Exclusive Kill.
"RTN","XINDX1",41,0)
23 ;;;S - Unargumented Kill.
"RTN","XINDX1",42,0)
24 ;;;S - Kill of an unsubscripted global.
"RTN","XINDX1",43,0)
25 ;;;S - Break command used.
"RTN","XINDX1",44,0)
26 ;;;S - Exclusive or Unargumented NEW command.
"RTN","XINDX1",45,0)
27 ;;;S - $View function used.
"RTN","XINDX1",46,0)
28 ;;ZOSV,ZIS,ZT;S - Non-standard $Z special variable used.
"RTN","XINDX1",47,0)
29 ;;ZIS,ZTM;S - 'Close' command should be invoked through 'D ^%ZISC'.
"RTN","XINDX1",48,0)
30 ;;;S - LABEL+OFFSET syntax.
"RTN","XINDX1",49,0)
31 ;;ZOSV,ZIS,ZT;S - Non-standard $Z function used.
"RTN","XINDX1",50,0)
32 ;;;S - 'HALT' command should be invoked through 'G ^XUSCLEAN'.
"RTN","XINDX1",51,0)
33 ;;;S - Read command doesn't have a timeout.
"RTN","XINDX1",52,0)
34 ;;ZIS;S - 'OPEN' command should be invoked through ^%ZIS.
"RTN","XINDX1",53,0)
35 ;;;S - Routine exceeds SACC maximum size of 20000 (|).
"RTN","XINDX1",54,0)
36 ;;ZTM;S - Should use 'TASKMAN' instead of 'JOB' command.
"RTN","XINDX1",55,0)
37 ;;;F - Label is not valid.
"RTN","XINDX1",56,0)
38 ;;;F - Call to this |
"RTN","XINDX1",57,0)
39 ;;ZIS,XUS,XUP;S - Kill of a protected variable (|).
"RTN","XINDX1",58,0)
40 ;;;S - Space where a command should be.
"RTN","XINDX1",59,0)
41 ;;;I - Star or pound READ used.
"RTN","XINDX1",60,0)
42 ;;;W - Null line (no commands or comment).
"RTN","XINDX1",61,0)
43 ;;;F - Invalid or wrong number of arguments to a function.
"RTN","XINDX1",62,0)
44 ;;;S - 2nd line of routine violates the SAC.
"RTN","XINDX1",63,0)
45 ;;ZT,ZIS,XUTM,XTER;S - Set to a '%' global.
"RTN","XINDX1",64,0)
46 ;;;F - Quoted string not followed by a separator.
"RTN","XINDX1",65,0)
47 ;;;S - Lowercase command(s) used in line.
"RTN","XINDX1",66,0)
48 ;;;F - Missing argument to a command post-conditional.
"RTN","XINDX1",67,0)
49 ;;;F - Command missing an argument.
"RTN","XINDX1",68,0)
50 ;;ZTM;S - Extended reference.
"RTN","XINDX1",69,0)
51 ;;;F - Block structure mismatch.
"RTN","XINDX1",70,0)
52 ;;;F - Reference to routine '^|'. That isn't in this UCI.
"RTN","XINDX1",71,0)
53 ;;;F - Bad Number.
"RTN","XINDX1",72,0)
54 ;;XG;S - Access to SSVN's restricted to Kernel.
"RTN","XINDX1",73,0)
55 ;;;S - Violates VA programming standards.
"RTN","XINDX1",74,0)
56 ;;;S - Patch number '|' missing from second line.
"RTN","XINDX1",75,0)
57 ;;;S - Lower/Mixed case Variable name used.
"RTN","XINDX1",76,0)
58 ;;;S - Routine code exceeds SACC maximum size of 15000 (|).
"RTN","XINDX1",77,0)
59 ;;;F - Bad WRITE syntax.
"RTN","XINDX1",78,0)
60 ;;;S - Lock missing Timeout.
"RTN","XINDX1",79,0)
61 ;;;S - Non-Incremental Lock.
"RTN","XINDX11")
0^6^B11119765^B10659627
"RTN","XINDX11",1,0)
XINDX11 ;ISC/GRK - Create phantom routines for functions, options, etc. ;07/08/98  15:06
"RTN","XINDX11",2,0)
 ;;7.3;TOOLKIT;**20,27,121**;Apr 25, 1995;Build 7
"RTN","XINDX11",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDX11",4,0)
 W !,"The option and function files are being processed.",!
"RTN","XINDX11",5,0)
 I INP(10)=9.4 G PKG
"RTN","XINDX11",6,0)
 N KRN,TYPE ;Build file
"RTN","XINDX11",7,0)
 S INDFN="^DD(""FUNC"",",INDRN="|func",INDD="Function",INDSB="FUNC",INDXN="Build file" D HDR
"RTN","XINDX11",8,0)
 F KRN=0:0 S KRN=$O(^XPD(9.6,INDDA,"KRN",.5,"NM",KRN)) Q:KRN'>0  S INDXN=$P(^(KRN,0),U) D ENTRY
"RTN","XINDX11",9,0)
 I INDLC=2 K ^UTILITY($J,INDRN),^UTILITY($J,1,INDRN) ;patch 121
"RTN","XINDX11",10,0)
 S INDFN="^DIC(19,",INDRN="|opt",INDD="Option",INDSB="OPT",INDXN="Build file" D HDR
"RTN","XINDX11",11,0)
 F KRN=0:0 S KRN=$O(^XPD(9.6,INDDA,"KRN",19,"NM",KRN)) Q:KRN'>0  S INDXN=$P(^(KRN,0),U) D ENTRY
"RTN","XINDX11",12,0)
 I INDLC=2 K ^UTILITY($J,INDRN),^UTILITY($J,1,INDRN)
"RTN","XINDX11",13,0)
 ;Routines
"RTN","XINDX11",14,0)
 ;F KRN=0:0 S KRN=$O(^XPD(9.6,INDDA,"KRN",9.8,"NM",KRN)) Q:KRN'>0  S X=^(KRN,0) I '$P(X,U,3) S ^UTILITY($J,$P(X,U))=""
"RTN","XINDX11",15,0)
 I $T(RTN^XTRUTL1)]"" D RTN^XTRUTL1(INDDA)
"RTN","XINDX11",16,0)
 Q
"RTN","XINDX11",17,0)
PKG D NAMSP ;Package file
"RTN","XINDX11",18,0)
 S INDFN="^DD(""FUNC"",",INDRN="|func",INDD="Function",INDSB="FUNC" D NAME
"RTN","XINDX11",19,0)
 S INDFN="^DIC(19,",INDRN="|opt",INDD="Option",INDSB="OPT" D NAME
"RTN","XINDX11",20,0)
 Q
"RTN","XINDX11",21,0)
NAME Q:'$D(@(INDFN_"""B"")"))
"RTN","XINDX11",22,0)
 D HDR
"RTN","XINDX11",23,0)
 S INDL=$E(INDXN,1,$L(INDXN)-1)_$C($A(INDXN,$L(INDXN))-1)_"z"
"RTN","XINDX11",24,0)
 F A=0:0 S INDL=$O(@(INDFN_"""B"",INDL)")) Q:$P(INDL,INDXN,1)]""!(INDL="")  F B=0:0 S B=$O(@(INDFN_"""B"",INDL,B)")) Q:B=""  X INDF D:C8 @INDSB
"RTN","XINDX11",25,0)
 I INDLC=2 K ^UTILITY($J,INDRN),^UTILITY($J,1,INDRN) Q
"RTN","XINDX11",26,0)
 S ^UTILITY($J,1,INDRN,0,0)=INDLC
"RTN","XINDX11",27,0)
 Q
"RTN","XINDX11",28,0)
NAMSP S INDXN=$P(^DIC(9.4,DA,0),"^",2),C9=0,INDXN(C9)="," F A=0:0 S A=$O(^DIC(9.4,DA,"EX",A)) Q:A'>0  I $D(^(A,0))#2 S C9=C9+1,INDXN(C9)=$P(^(0),"^")
"RTN","XINDX11",29,0)
 S INDF="S C8=1 F H=1:1:C9 I $P(INDL,INDXN(H))="""" S C8=0 Q" ; Checks excluded namespaces
"RTN","XINDX11",30,0)
 Q
"RTN","XINDX11",31,0)
HDR S INDLC=0,INDC=INDRN_" ; '"_INDXN_"' "_INDD_"s.",INDX=";" D ADD S ^UTILITY($J,INDRN)="",^UTILITY($J,1,INDRN,0,0)=0
"RTN","XINDX11",32,0)
 Q
"RTN","XINDX11",33,0)
ENTRY F B=0:0 S B=$O(@(INDFN_"""B"",INDXN,B)")) Q:B=""  D @INDSB
"RTN","XINDX11",34,0)
 ;I INDLC=2 K ^UTILITY($J,INDRN),^UTILITY($J,1,INDRN) Q ;patch 121 moved to top of routine
"RTN","XINDX11",35,0)
 S ^UTILITY($J,1,INDRN,0,0)=INDLC
"RTN","XINDX11",36,0)
 Q
"RTN","XINDX11",37,0)
FUNC ;Process Function file entry
"RTN","XINDX11",38,0)
 Q:'($D(^DD("FUNC",B,0))#2)  S INDC=B_" ; "_$P(^(0),"^",1)_" - "_$S($D(^(9))#2:$E(^(9),1,190),1:""),INDX=$S($D(^(1))#2:^(1),1:";") D ADD
"RTN","XINDX11",39,0)
 Q
"RTN","XINDX11",40,0)
OPT ;Process option file entry for MUMPS code
"RTN","XINDX11",41,0)
 Q:'$D(^DIC(19,B,0))  S T=$P(^(0),"^",4),INDC=B_" ; "_$P(^(0),"^",1)_" - "_$P(^(0),"^",2)_" ("_$P($P($P(^DD(19,4,0),"^",3),T_":",2),";",1)_")"_$S($P(^DIC(19,B,0),"^",6)]"":" - Locked by "_$P(^(0),"^",6),1:""),INDX="" D ADD
"RTN","XINDX11",42,0)
 S INDN="15,20,26,"_$S(T="E":"34,35,54",T="I":"34,35",T="P":"69,69.1,69.2,69.3,71,72,73",T="R":25,1:"") D OPTC:INDN
"RTN","XINDX11",43,0)
 Q
"RTN","XINDX11",44,0)
OPTC F J=1:1 S H=$P(INDN,",",J) Q:H=""  I $D(^DIC(19,B,H))#2 D
"RTN","XINDX11",45,0)
 . S %=^(H),INDX=$S(H'=25:%,1:"D "_$E("^",%'["^")_$P(%,"[")),INDC=" ; "_$P(^DD(19,H,0),"^",1) D ADD
"RTN","XINDX11",46,0)
 Q
"RTN","XINDX11",47,0)
ADD ;Put code in UTILITY for processing
"RTN","XINDX11",48,0)
 S INDLC=INDLC+1,^UTILITY($J,1,INDRN,0,INDLC,0)=INDC I INDX]"" S INDLC=INDLC+1,^UTILITY($J,1,INDRN,0,INDLC,0)=" "_INDX
"RTN","XINDX11",49,0)
 Q
"RTN","XINDX2")
0^2^B18776883^B17870564
"RTN","XINDX2",1,0)
XINDX2 ;ISC/REL,GRK,RWF - PROCESS "GRB" ;4/2/08  16:35
"RTN","XINDX2",2,0)
 ;;7.3;TOOLKIT;**20,27,48,110,121**;Apr 25, 1995;Build 7
"RTN","XINDX2",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDX2",4,0)
% S LINE=GRB,(CM,COM)="" F I=0:0 S STR=$P(LINE,$C(9),1),LINE=$P(LINE,$C(9),2,999),NOA=0 D:STR]"" ARGG Q:LINE']""
"RTN","XINDX2",5,0)
 Q
"RTN","XINDX2",6,0)
 ;Process argument
"RTN","XINDX2",7,0)
ARGG D ^XINDX9 S I=0,AC=999 F %=0:0 S %=$O(LV(%)) Q:%'>0  S I(%)=0
"RTN","XINDX2",8,0)
ARGS ;Proccess all agruments at this level
"RTN","XINDX2",9,0)
 S AC=LI+AC F  Q:AC'>LI  D INC Q:S=""  D ARG
"RTN","XINDX2",10,0)
 Q
"RTN","XINDX2",11,0)
 ;
"RTN","XINDX2",12,0)
ARG ;Process one argument
"RTN","XINDX2",13,0)
 I CH="," D PEEK,E^XINDX1(21):(","[Y)&($$FNC()'="$$") Q
"RTN","XINDX2",14,0)
 Q:CH=Q
"RTN","XINDX2",15,0)
 I (CH?1A)!(CH="%") D LOC Q
"RTN","XINDX2",16,0)
 I CH="^" S LOC="G" G NAK:S="^",EXTGLO:S["[",EXTGLO:S["|",GLO Q
"RTN","XINDX2",17,0)
 I CH="$" D FUN Q
"RTN","XINDX2",18,0)
 I CH="?" D PAT Q
"RTN","XINDX2",19,0)
 I CH="(" D INC S NOA=S D DN,INC Q
"RTN","XINDX2",20,0)
 Q
"RTN","XINDX2",21,0)
 ;
"RTN","XINDX2",22,0)
NAK S LOC="N"
"RTN","XINDX2",23,0)
 G GLO
"RTN","XINDX2",24,0)
EXTGLO D E^XINDX1(50),EG,INC S S=U_S
"RTN","XINDX2",25,0)
 G GLO
"RTN","XINDX2",26,0)
EG N GK,LOC S GK="",LOC="L" ;HANDLE EXTENDED GLOBAL
"RTN","XINDX2",27,0)
 F  D INC Q:"]"[CH  Q:"|"[CH  D ARG
"RTN","XINDX2",28,0)
 Q
"RTN","XINDX2",29,0)
GLO S X=$E(S,2,99) I X]"",S'["^$",X'?1(1U,1"%").7UN D E^XINDX1(12)
"RTN","XINDX2",30,0)
 I GK["*",$E(S,1,2)["^%" D E^XINDX1(45)
"RTN","XINDX2",31,0)
 I S1="(" S S=S_S1 D PEEKDN S:(Y?1N.NP)!($A(Y)=34)!("^$J^$I^$H^"[(U_Y)) S=S_Y
"RTN","XINDX2",32,0)
 D ST(LOC,S) I S1="(" D INC2 S NOA=S D DN,INC
"RTN","XINDX2",33,0)
 Q
"RTN","XINDX2",34,0)
 ;
"RTN","XINDX2",35,0)
LOC S LOC="L" ;Check variables at end. I S'?1.8UN,S'?1"%".7UN,S'?1.8LN,S'?1"%".7LN D E^XINDX1(11)
"RTN","XINDX2",36,0)
 I S1="(" S S=S_S1 D PEEKDN S:(Y?1.N)!($A(Y)=34) S=S_Y
"RTN","XINDX2",37,0)
 D ST(LOC,S) I S1="(" D INC2 S NOA=S D DN,INC
"RTN","XINDX2",38,0)
 Q
"RTN","XINDX2",39,0)
 ;
"RTN","XINDX2",40,0)
PEEK S Y=$G(LV(LV,LI+1)) Q
"RTN","XINDX2",41,0)
 ;
"RTN","XINDX2",42,0)
INC2 S LI=LI+1 ;Drop into INC
"RTN","XINDX2",43,0)
INC S LI=LI+1,S=$G(LV(LV,LI)),S1=$G(LV(LV,LI+1)),CH=$E(S) G:$A(S)=10 ERR Q
"RTN","XINDX2",44,0)
 ;
"RTN","XINDX2",45,0)
DN S LI(LV)=LI,LI(LV,1)=AC,LV=LV+1,LI=LI(LV),AC=NOA
"RTN","XINDX2",46,0)
 D ARGS,UP Q
"RTN","XINDX2",47,0)
UP ;Inc LI as we save to skip the $C(10).
"RTN","XINDX2",48,0)
 D PEEK D:$A(Y)'=10 ERR S LI(LV)=LI+1,LV=LV-1,LI=LI(LV),AC=LI(LV,1) Q
"RTN","XINDX2",49,0)
 ;
"RTN","XINDX2",50,0)
PEEKDN S Y=$G(LV(LV+1,LI(LV+1)+1)) Q
"RTN","XINDX2",51,0)
 ;
"RTN","XINDX2",52,0)
ERR D E^XINDX1(43) S (S,S1,CH)="" Q
"RTN","XINDX2",53,0)
 S Z=$P(LV(LV+1),$C(9),LI(LV+1),99),Z=$P(Z,$C(10)) W !,"COUNT=",$L(Z,",")
"RTN","XINDX2",54,0)
 ;functions
"RTN","XINDX2",55,0)
FUN N FUN S FUN=S G EXT:S["$$",PKG:S["$&",SPV:S1'["(" S NOA=$P(S,"^",2)
"RTN","XINDX2",56,0)
 D INC2 I S'>0 D E^XINDX1(43) ;Sit on NOA
"RTN","XINDX2",57,0)
 G:FUN["$TE" TEXT
"RTN","XINDX2",58,0)
 S Y=1 F Z1=LI(LV+1)+1:1 S X=$G(LV(LV+1,Z1)) Q:$A(X)=10!(X="")  S:X="," Y=Y+1
"RTN","XINDX2",59,0)
 I NOA,Y<NOA!(Y>$P(NOA,";",2)) D E^XINDX1(43)
"RTN","XINDX2",60,0)
 S NOA=S D DN,INC Q
"RTN","XINDX2",61,0)
 ;
"RTN","XINDX2",62,0)
TEXT S Y=$$ASM^XINDX3(LV+1,LI(LV+1)+1,$C(10)) D ST("MK","$T("_$S($E(Y)'="+":Y,1:""))
"RTN","XINDX2",63,0)
 I $$VT(Y) D ST("I",Y)
"RTN","XINDX2",64,0)
 I Y["^",$$VT($P(Y,"^",2)) N X1,X2 S X1=$P(Y,"^"),X2=$P(Y,"^",2) D ST("X",X2_$S($$VT(X1):" "_X1,1:""))
"RTN","XINDX2",65,0)
 D FLUSH(LV+1) Q
"RTN","XINDX2",66,0)
 ;special variables
"RTN","XINDX2",67,0)
SPV ;
"RTN","XINDX2",68,0)
 I "^$D^$EC^$ES^$ET^$I^$K^$P^$Q^$ST^$SY^"[("^"_X_"^") D ST("MK",X)
"RTN","XINDX2",69,0)
 Q
"RTN","XINDX2",70,0)
 ;
"RTN","XINDX2",71,0)
EXT ;Extrinsic functions
"RTN","XINDX2",72,0)
 I $E(S1)="^" S Y=$E(S1,2,99)_" "_S D INC S S=Y ;Build S and fall thru
"RTN","XINDX2",73,0)
 D ST($S(S[" ":"X",1:"I"),S) ;Internal, eXternal
"RTN","XINDX2",74,0)
 I S1["(" D INC2 S NOA=S D DN,INC ;Process param.
"RTN","XINDX2",75,0)
 Q
"RTN","XINDX2",76,0)
 ;
"RTN","XINDX2",77,0)
PKG ;External Package
"RTN","XINDX2",78,0)
 D ST("X",S) ;Record External name
"RTN","XINDX2",79,0)
 I S1["(" D INC2 S NOA=S D DN,INC ;Process param.
"RTN","XINDX2",80,0)
 Q
"RTN","XINDX2",81,0)
 ;
"RTN","XINDX2",82,0)
PAT D INC I $E(S)="@" D INC,ARG Q
"RTN","XINDX2",83,0)
 F  D REPCNT,PATCODE Q:$E(S)=""
"RTN","XINDX2",84,0)
 Q
"RTN","XINDX2",85,0)
 ;
"RTN","XINDX2",86,0)
REPCNT F I=1:1 Q:("0123456789."'[$E(S,I))!($E(S,I)="")
"RTN","XINDX2",87,0)
 S X=$E(S,1,I-1),S=$E(S,I,999) I ('$L(X))!($L(X,".")>2) S S="" D E^XINDX1(16)
"RTN","XINDX2",88,0)
 Q
"RTN","XINDX2",89,0)
 ;
"RTN","XINDX2",90,0)
PATCODE I $E(S)=Q S I=1 D PATQ S S=$E(S,I,999) S:$L(CH)&(",)"[CH) S=$E(S,2,999) Q
"RTN","XINDX2",91,0)
 F I=1:1 Q:("ACELNPUacelnpu()"'[$E(S,I))!($E(S,I)="")
"RTN","XINDX2",92,0)
 S X=$E(S,1,I-1),S=$E(S,I,999) I I=1 S S="" D E^XINDX1(16)
"RTN","XINDX2",93,0)
 I $E(S)="," S S=$E(S,2,999) ;Pull ',' out of alternation
"RTN","XINDX2",94,0)
 Q
"RTN","XINDX2",95,0)
 ;
"RTN","XINDX2",96,0)
PATQ F I=I+1:1 S CH=$E(S,I) Q:CH=""!(CH=Q)
"RTN","XINDX2",97,0)
 S I=I+1 D:CH="" E^XINDX1(6) S CH=$E(S,I) G:CH=Q PATQ
"RTN","XINDX2",98,0)
 Q
"RTN","XINDX2",99,0)
 ;
"RTN","XINDX2",100,0)
ST(LOC,S) S:'$D(V(LOC,S)) V(LOC,S)="" I $D(GK),GK]"",V(LOC,S)'[GK S V(LOC,S)=V(LOC,S)_GK
"RTN","XINDX2",101,0)
 S GK=""
"RTN","XINDX2",102,0)
 Q
"RTN","XINDX2",103,0)
 ;
"RTN","XINDX2",104,0)
VT(X) ;Check if a valid label
"RTN","XINDX2",105,0)
 Q (X?1A.31AN)!(X?1"%".31UN)!(X?1.31N)
"RTN","XINDX2",106,0)
 ;
"RTN","XINDX2",107,0)
VA(X) ;Check if VA Standard label
"RTN","XINDX2",108,0)
 Q (X?1U.7UN)!(X?1"%".7UN)!(X?1.8N)
"RTN","XINDX2",109,0)
 ;
"RTN","XINDX2",110,0)
FLUSH(L) ;Flush rest of list with this offset
"RTN","XINDX2",111,0)
 N I,CH S I=LI(L)+1 F I=I:1 S CH=$G(LV(L,I)) Q:$C(10)[CH  D:CH="(" FLUSH(L+1)
"RTN","XINDX2",112,0)
 S LI(L)=I Q
"RTN","XINDX2",113,0)
 ;
"RTN","XINDX2",114,0)
FNC(NEW) ;Sets or returns the current function
"RTN","XINDX2",115,0)
 I $D(NEW) S LV(LV+1,"FNC",LI)=NEW Q
"RTN","XINDX2",116,0)
 N W
"RTN","XINDX2",117,0)
 S W=+$S($D(LV(LV,"FNC",LI)):LI,$O(LV(LV,"FNC",LI),-1):$O(LV(LV,"FNC",LI),-1),1:$O(LV(LV,"FNC",LI))) ;patch 119,121
"RTN","XINDX2",118,0)
 Q $G(LV(LV,"FNC",W))
"RTN","XINDX2",119,0)
 ;
"RTN","XINDX2",120,0)
OP(NEW) ;Sets or returns the current operator
"RTN","XINDX2",121,0)
 I $D(NEW) S LV(LV,"OP",LI)=NEW Q
"RTN","XINDX2",122,0)
 N W S W=+$S($D(LV(LV,"OP",LI)):LI,1:$O(LV(LV,"OP",LI),-1))
"RTN","XINDX2",123,0)
 Q $G(LV(LV,"OP",W))
"RTN","XINDX2",124,0)
 ;
"RTN","XINDX3")
0^3^B12135035^B11413243
"RTN","XINDX3",1,0)
XINDX3 ;ISC/REL,GRK,RWF - PROCESS MERGE/SET/READ/KILL/NEW/OPEN COMMANDS ;06/24/08  15:44
"RTN","XINDX3",2,0)
 ;;7.3;TOOLKIT;**20,27,61,68,110,121**;Apr 25, 1995;Build 7
"RTN","XINDX3",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDX3",4,0)
PEEK S Y=$G(LV(LV,LI+1)) Q
"RTN","XINDX3",5,0)
PEEK2 S Y=$G(LV(LV,LI+2)) Q
"RTN","XINDX3",6,0)
INC2 S LI=LI+1 ;Drop into INC
"RTN","XINDX3",7,0)
INC S LI=LI+1,S=$G(LV(LV,LI)),S1=$G(LV(LV,LI+1)),CH=$E(S) G ERR:$A(S)=10 Q
"RTN","XINDX3",8,0)
DN S LI(LV)=LI,LI(LV,1)=AC,LV=LV+1,LI=LI(LV),AC=NOA
"RTN","XINDX3",9,0)
 Q
"RTN","XINDX3",10,0)
UP ;Inc LI as we save to skip the $C(10).
"RTN","XINDX3",11,0)
 D PEEK S:$A(Y)=10 LI=LI+1 S LI(LV)=LI,LV=LV-1,LI=LI(LV),AC=LI(LV,1) Q
"RTN","XINDX3",12,0)
PEEKDN S Y=$G(LV(LV+1,LI(LV+1)+1)) Q
"RTN","XINDX3",13,0)
FIND F Y=LI:1:AC Q:L[$G(LV(LV,Y))
"RTN","XINDX3",14,0)
ERR D E^XINDX1(43) S (S,S1,CH)="" Q
"RTN","XINDX3",15,0)
 Q
"RTN","XINDX3",16,0)
 Q
"RTN","XINDX3",17,0)
S ;Set
"RTN","XINDX3",18,0)
 S STR=ARG,ARG="",RHS=0 D ^XINDX9
"RTN","XINDX3",19,0)
S2 S GK="" D INC I S="" D:'RHS E^XINDX1(10) Q
"RTN","XINDX3",20,0)
 I CH=",","!""#&)*+-,./:;<=?\]_~"[$E(S1),RHS=1 D E^XINDX1(10) G S2 ;patch 121
"RTN","XINDX3",21,0)
 I CH="," S RHS=0 G S2
"RTN","XINDX3",22,0)
 I CH="=" S RHS=1 D:"!#&)*,/:;<=?\]_~"[$E(S1) E^XINDX1(10) G S2 ;patch 119
"RTN","XINDX3",23,0)
 I CH="$",'RHS D  D:% E^XINDX1(10) ;Can't be on RHS of set.
"RTN","XINDX3",24,0)
 . S %=1
"RTN","XINDX3",25,0)
 . I "$E$P$X$Y"[$E(S,1,2) S %=0 Q
"RTN","XINDX3",26,0)
 . I "$EC$ET$QS"[$E(S,1,3) S %=0 Q
"RTN","XINDX3",27,0)
 . I "$ZE$ZT"[$E(S,1,3) S %=0 Q  ;Pickup in XINDX9
"RTN","XINDX3",28,0)
 . Q
"RTN","XINDX3",29,0)
 I CH="^" D FL G S2
"RTN","XINDX3",30,0)
 I CH="@" S Y=$$ASM(LV,LI,",") S:Y'["=" RHS=1 D INC,ARG^XINDX2 G S2
"RTN","XINDX3",31,0)
 I CH="(" D MULT G S2
"RTN","XINDX3",32,0)
 D FL G S2
"RTN","XINDX3",33,0)
MULT D INC S NOA=S I S'>0 S ERR=5 G ^XINDX1
"RTN","XINDX3",34,0)
 D DN S AC=AC+LI F  Q:AC'>LI  S:'RHS GK="*" D INC,ARG^XINDX2
"RTN","XINDX3",35,0)
 D UP Q
"RTN","XINDX3",36,0)
FL ;
"RTN","XINDX3",37,0)
 S:'RHS GK="*" D ARG^XINDX2
"RTN","XINDX3",38,0)
 Q
"RTN","XINDX3",39,0)
VLNF(X) ;Drop into VLN
"RTN","XINDX3",40,0)
VLN ;Valid Local Name > Variable
"RTN","XINDX3",41,0)
 S ERR=0
"RTN","XINDX3",42,0)
 Q:X?1(1U,1"%").15UN
"RTN","XINDX3",43,0)
 I X?1(1A,1"%").15AN D E^XINDX1(57) Q  ;Lowercase
"RTN","XINDX3",44,0)
 D E^XINDX1(11) ;Too long or other problem
"RTN","XINDX3",45,0)
 Q
"RTN","XINDX3",46,0)
VGN ;Valid Global Name
"RTN","XINDX3",47,0)
 S ERR=0 I X'?1(1U,1"%").7UN D E^XINDX1(12)
"RTN","XINDX3",48,0)
 Q
"RTN","XINDX3",49,0)
KL ;Process KILL
"RTN","XINDX3",50,0)
 S STR=ARG,ARG(1)=ARG,ARG="" D ^XINDX9
"RTN","XINDX3",51,0)
A D INC Q:S=""  G A:CH="," S LOC="L" D @$S(CH="@":"KL1",CH="^":"KL2",CH="(":"KL4",1:"KL3") G A
"RTN","XINDX3",52,0)
KL1 D INC,ARG^XINDX2 Q
"RTN","XINDX3",53,0)
KL2 S GK="!"
"RTN","XINDX3",54,0)
 I S1'="(" S ERR=24 D ^XINDX1
"RTN","XINDX3",55,0)
 G ARG^XINDX2
"RTN","XINDX3",56,0)
KL3 I "^DT^DTIME^DUZ^IOST^IOM^U^"[("^"_S_"^") S ERR=39,ERR(1)=S D ^XINDX1
"RTN","XINDX3",57,0)
 I "IO"=S D:S1="(" PEEKDN S ERR=39,ERR(1)=S_$S(S1["(":S1_Y_")",1:"") D:S1'="(" ^XINDX1 I S1="(",("QC"'[$E(Y,2)) D ^XINDX1
"RTN","XINDX3",58,0)
KL5 S GK="!" D ARG^XINDX2 Q  ;KILL SUBS
"RTN","XINDX3",59,0)
 Q
"RTN","XINDX3",60,0)
KL4 S NOA=S1 D DN,ARGS^XINDX2,UP,INC2 Q
"RTN","XINDX3",61,0)
NE ;NEW
"RTN","XINDX3",62,0)
 S ERR=$S("("[$E(ARG):26,1:0) I ERR G ^XINDX1 ;look for null or (
"RTN","XINDX3",63,0)
 S STR=ARG D ^XINDX9
"RTN","XINDX3",64,0)
N2 D INC Q:S=""  G N2:CH="," I CH?1P,("%@()"'[CH)&("$E"'[$E(S,1,2)) D E^XINDX1(11) G N2
"RTN","XINDX3",65,0)
 S GK="~" D ARG^XINDX2 G N2
"RTN","XINDX3",66,0)
 ;
"RTN","XINDX3",67,0)
RD S STR=ARG D ^XINDX9 S ARG=""
"RTN","XINDX3",68,0)
RD1 D INC Q:S=""
"RTN","XINDX3",69,0)
 ;I (CH="!")!(CH=",")!(CH=Q)!(CH="#") G RD1
"RTN","XINDX3",70,0)
 ;I CH="^" S ERR=11 D ^XINDX1
"RTN","XINDX3",71,0)
 I '((CH="%")!(CH?1A)!(CH="*")) D RD3 G RD1
"RTN","XINDX3",72,0)
 S Y=$$ASM(LV,LI,",") I Y'[":" S ERR=33,RDTIME=1 D ^XINDX1
"RTN","XINDX3",73,0)
 D RD2 G RD1
"RTN","XINDX3",74,0)
RD2 Q:","[CH
"RTN","XINDX3",75,0)
 I "*#"[CH D E^XINDX1(41)
"RTN","XINDX3",76,0)
 I "#:"[CH D INC,ARG^XINDX2,INC G RD2
"RTN","XINDX3",77,0)
 I (CH="%")!(CH?1A) S LOC="L",GK="*" D ARG^XINDX2,INC G RD2
"RTN","XINDX3",78,0)
 D INC G RD2
"RTN","XINDX3",79,0)
RD3 Q:","[CH  I "!#?"[CH D INC G RD3
"RTN","XINDX3",80,0)
 I (CH="%")!(CH?1A)!(CH="@") D ARG^XINDX2,INC G RD3
"RTN","XINDX3",81,0)
 Q
"RTN","XINDX3",82,0)
O S STR=ARG,AC=99 D ^XINDX9,INC S ARG="" I S["@" D ARGS^XINDX2 Q
"RTN","XINDX3",83,0)
 D ARG^XINDX2,INC D  D INC,ARGS^XINDX2 Q
"RTN","XINDX3",84,0)
 . F  D INC Q:":"[S
"RTN","XINDX3",85,0)
 . Q
"RTN","XINDX3",86,0)
 Q
"RTN","XINDX3",87,0)
ERRCP S ERR=5 D ^XINDX1 Q
"RTN","XINDX3",88,0)
ST ;
"RTN","XINDX3",89,0)
 S:'$D(V(LOC,S)) V(LOC,S)="" S:V(LOC,S)'[GK V(LOC,S)=V(LOC,S)_GK,GK="" Q
"RTN","XINDX3",90,0)
 Q
"RTN","XINDX3",91,0)
ASM(WL,SI,L,SEP) ;
"RTN","XINDX3",92,0)
 N %,CH,Y S SEP=$G(SEP),Y="" F %=SI:1 S CH=$G(LV(WL,%)) Q:L[CH  S Y=Y_SEP_CH
"RTN","XINDX3",93,0)
 Q Y
"RTN","XINDX5")
0^4^B11265539^B10983849
"RTN","XINDX5",1,0)
XINDX5 ;SF-ISC/RWF - CROSS REFERENCE ALL ROUTINES ;03/26/2002  09:57
"RTN","XINDX5",2,0)
 ;;7.3;TOOLKIT;**20,27,61,121**;Apr 25, 1995;Build 7
"RTN","XINDX5",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDX5",4,0)
 G END:$D(IND("QUIT")) I INP(8) W !,"Called Routines",! D ^XINDX52 ;Get called routines
"RTN","XINDX5",5,0)
 K ARG,CCN,CH,COM,ERR,GK,GRB,I,INDDA,INDDS,L,LAB,LAB0,LC,LIN,LOC,PC,PRV,R,RTN,S,STR,TXT,V,X,Y
"RTN","XINDX5",6,0)
 D ^XINDX53:INP(7) ;Load routine file
"RTN","XINDX5",7,0)
 ;Check called tags and routines
"RTN","XINDX5",8,0)
 S RN="$",TXT="" W !!,"--- CROSS REFERENCING ---",!
"RTN","XINDX5",9,0)
A S RN=$O(^UTILITY($J,RN)),L="",LABO=0 I RN="" G B
"RTN","XINDX5",10,0)
 F  S L=$O(^UTILITY($J,1,RN,"X",L)) Q:L=""  S XX2=^(L,0),XX1=$P(L," ",2),T=$P(XX1,"+",1),P=$P(L," ",1) D AA
"RTN","XINDX5",11,0)
 G A
"RTN","XINDX5",12,0)
AA Q:P=""  I '$D(^UTILITY($J,1,P)) D  Q  ;We can now check % routines
"RTN","XINDX5",13,0)
 . I (P["&")!(P["@") Q  ;External subroutine
"RTN","XINDX5",14,0)
 . S:T["$" T=$E(T,3,99) S:P["(" P=$P(P,"(")
"RTN","XINDX5",15,0)
 . I '$$VTAG(P) S ERR=52,ERR(1)=P D AAER(.ERR,RN,"",0) Q
"RTN","XINDX5",16,0)
 . S X=$T(^@P) I X="" S ERR=52,ERR(1)=P D AAER(.ERR,RN,$P(XX2,","),0) Q
"RTN","XINDX5",17,0)
 . Q:T=""
"RTN","XINDX5",18,0)
 . I '$$VTAG(T) D AAER(37,RN,$P(XX2,","),0) Q
"RTN","XINDX5",19,0)
 . I $$VTAG(T),$T(@T^@P)="" S E=38,E(1)="MISSING LABEL "_XX1_"^"_P D AAER(.E,RN,"",0)
"RTN","XINDX5",20,0)
 . Q
"RTN","XINDX5",21,0)
 I T]"",$D(^UTILITY($J,1,P)) D
"RTN","XINDX5",22,0)
 . S:T["$$" T=$E(T,3,99) S:T["@" T=""
"RTN","XINDX5",23,0)
 . I T]"",'$D(^UTILITY($J,1,P,"T",T)) S E=38,E(1)="MISSING LABEL (see INVOKED BY list)." D AAER(.E,P,XX1,0)
"RTN","XINDX5",24,0)
 Q
"RTN","XINDX5",25,0)
AAER(ERR,RTN,LAB,LABO) ;Report error. error code, routine, label, label offset
"RTN","XINDX5",26,0)
 D ^XINDX1
"RTN","XINDX5",27,0)
 Q
"RTN","XINDX5",28,0)
VTAG(K) ;Check for a valid tag. works for routine name.
"RTN","XINDX5",29,0)
 Q (K?1(1"%",1A).7NA)!(K?1.8N)
"RTN","XINDX5",30,0)
 ;
"RTN","XINDX5",31,0)
B D ^XINDX51
"RTN","XINDX5",32,0)
END W:$D(IND("QUIT")) !!,"--- ",$S($D(ZTSTOP):"TASK ",1:""),"STOPPED ---" W !!,"--- END ---"
"RTN","XINDX5",33,0)
 I IO'=IO(0) U IO(0) W !,"--- D O N E ---" U IO
"RTN","XINDX5",34,0)
 D ^%ZISC
"RTN","XINDX5",35,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","XINDX5",36,0)
CLEAN ;Come here from XINDX6 if queued output.
"RTN","XINDX5",37,0)
 K %,%1,%2,%I1,%IN1,%UCN,A,ARG,C,C9,CCN,CH,COM,DA,DIC,DUOUT,ERR,ERTX,F,F1,G,GK,GRB,H,HED,HS
"RTN","XINDX5",38,0)
 K ^UTILITY($J),I,IND,INDB,INDC,INDDA,INDDS,INDF,INDFN,INDLC,INDPM,INDX,INDXDT,INDXJ,INP,IP,J,K,K1,K3,L,LAB,LABO,LBL,LC,LIN,LINE,LOC,NRO,OFF,P,PC,PGM,POP,POST,Q,R,RDTIME,RHS,ROU,RTN,S,S1,STR,SYM,TAB,TAG,TXT,TY,V,VZ,X,X1,X2,X3,Y
"RTN","XINDX5",39,0)
 Q
"RTN","XINDX5",40,0)
CRX S RTN="$" F I=0:0 S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""  F LOC="L","G","MK","N","X" D CR0 ;patch 121
"RTN","XINDX5",41,0)
 K VZ Q
"RTN","XINDX5",42,0)
 ;
"RTN","XINDX5",43,0)
CR0 N VZ S S=-1 I LOC="X",'$D(^UTILITY($J,1,"***","X",RTN_" ")) S ^UTILITY($J,1,"***","X",RTN_" ")=""
"RTN","XINDX5",44,0)
CR1 S S=$O(^UTILITY($J,1,RTN,LOC,S)) Q:S=""  ;Loop
"RTN","XINDX5",45,0)
 S X=$G(^UTILITY($J,1,RTN,LOC,S))
"RTN","XINDX5",46,0)
 F J=1:1:$L(X) S:$G(^UTILITY($J,1,"***",LOC,S))'[$E(X,J) ^(S)=$G(^(S))_$E(X,J) ;Pass on flags
"RTN","XINDX5",47,0)
 F J=0:1 Q:'$D(^UTILITY($J,1,RTN,LOC,S,J))  D CR2
"RTN","XINDX5",48,0)
 G CR1
"RTN","XINDX5",49,0)
 ;
"RTN","XINDX5",50,0)
CR2 S PC="" I LOC'="X" S:^UTILITY($J,1,RTN,LOC,S,J)["*" PC=PC_"*" S:^(J)["!" PC=PC_"!" S:^(J)["~" PC=PC_"~" D CR3(RTN,S,LOC) Q
"RTN","XINDX5",51,0)
 Q:$D(VZ(S))  S S1=$S($P(S," ",2)]"":$P(S," ",2)_"^",1:"")_$P(S," ",1),VZ(S)=""
"RTN","XINDX5",52,0)
 ;S X1=LOC,X2=S,X3=RTN,LOC="Z",S=RTN,RTN=S1 D CR3 S LOC=X1,S=X2,RTN=X3 K X1,X2,X3
"RTN","XINDX5",53,0)
 D CR3(S1,RTN,"Z"),CR3(RTN,S,LOC)
"RTN","XINDX5",54,0)
 Q
"RTN","XINDX5",55,0)
CR3(X1,X2,X3) ;(RTN,REF,LOC)
"RTN","XINDX5",56,0)
 S K=0
"RTN","XINDX5",57,0)
CR4 S ARG="" I $D(^UTILITY($J,1,"***",X3,X2,K)) S ARG=^(K) I $L(ARG)>230 S K=K+1 G CR4
"RTN","XINDX5",58,0)
 S ^UTILITY($J,1,"***",X3,X2,K)=ARG_X1_PC_"," Q
"RTN","XINDX9")
0^5^B16811292^B15969319
"RTN","XINDX9",1,0)
XINDX9 ;SF/RWF - XINDEX SYNTAX CHECKER ;06/24/08  15:39
"RTN","XINDX9",2,0)
 ;;7.3;TOOLKIT;**20,27,48,61,66,68,110,121**;Apr 25, 1995;Build 7
"RTN","XINDX9",3,0)
 ; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XINDX9",4,0)
 N CH1,EC,OP
"RTN","XINDX9",5,0)
 D PARSE S LI=0,AC=255 F %=0:0 S %=$O(LV(%)) Q:%'>0  S LI(%)=0
"RTN","XINDX9",6,0)
 Q
"RTN","XINDX9",7,0)
 ;LV is a set of Linked Values
"RTN","XINDX9",8,0)
PARSE K LV,LI S (ERR,LI,I)=0,(LL,LV)=1,(OP,CH)="",Q=""""
"RTN","XINDX9",9,0)
 ;
"RTN","XINDX9",10,0)
PA2 S I=I+1,CH=$E(STR,I),CH1=$E(STR,I+1) G:CH="" PEND
"RTN","XINDX9",11,0)
 G E:CH=";"!(CH'?1ANP) I """$()"[CH D QUOTE:CH=Q,FUNC:CH="$",DN:CH="(",UP:CH=")" G PA2
"RTN","XINDX9",12,0)
 I CH="^",CH1="$" D SSVN G PA2
"RTN","XINDX9",13,0)
 I CH="^",I=LL G PA2:CH1'="[" S I=I+1,X=$E(STR,LL,I) D ADD S LL=I+1 G PA2
"RTN","XINDX9",14,0)
 I CH?1A!(CH="%") D VAR G PA2
"RTN","XINDX9",15,0)
 I CH?1N D NUM G PA2
"RTN","XINDX9",16,0)
 S:"+-#'/*_&![]<>?"[CH OP=CH
"RTN","XINDX9",17,0)
 I CH="?",",!#"'[$E(STR,I-1) D AR,PAT G PA2
"RTN","XINDX9",18,0)
 I CH=",",CH1=":" D E^XINDX1(21) ;P121
"RTN","XINDX9",19,0)
 I CH?1P D  ;Check for dup operators
"RTN","XINDX9",20,0)
 . D AR
"RTN","XINDX9",21,0)
 . Q:(CH_CH1="]]")
"RTN","XINDX9",22,0)
 . I ((CH=CH1)&(",_/\[]&|"[CH))&($$FNC()'="$$") D E^XINDX1(21) ;p110
"RTN","XINDX9",23,0)
 G PA2
"RTN","XINDX9",24,0)
 ;End of parse
"RTN","XINDX9",25,0)
PEND D AR,E^XINDX1(5):LV>1,E^XINDX1(21):($G(LV(1,1))=",") ;LV>1 means mis-match ()
"RTN","XINDX9",26,0)
 Q
"RTN","XINDX9",27,0)
 ;
"RTN","XINDX9",28,0)
DN D STR S X=CH D ADD,NEW S LI(LV)=LI,LV=LV+1 S:'$D(LI(LV)) LI(LV)=0 S LI=LI(LV),LI(LV-1,1)=LI
"RTN","XINDX9",29,0)
 Q
"RTN","XINDX9",30,0)
UP I LV<2 D E^XINDX1(5) Q
"RTN","XINDX9",31,0)
 D STR S EC=LI-LI(LV-1,1),X=$C(10) D ADD,NEW S LI(LV)=LI,LV=LV-1,LI=LI(LV)
"RTN","XINDX9",32,0)
 S X=EC D ADD S X=CH D ADD I CH1]"",",_=+-*/\#'):<>[]?&!@"'[CH1 D E^XINDX1(43)
"RTN","XINDX9",33,0)
 Q
"RTN","XINDX9",34,0)
NEW S LL=I+1
"RTN","XINDX9",35,0)
 Q
"RTN","XINDX9",36,0)
AR D STR S X=CH D ADD,NEW Q
"RTN","XINDX9",37,0)
STR S X=$E(STR,LL,I-1) Q:'$L(X)  ;Drop into ADD
"RTN","XINDX9",38,0)
ADD S LI=LI+1,LV(LV,LI)=X Q
"RTN","XINDX9",39,0)
 ;
"RTN","XINDX9",40,0)
FNC(NEW) ;Sets or returns the current function
"RTN","XINDX9",41,0)
 I $D(NEW) S LV(LV+1,"FNC",$G(LI(LV))+1)=NEW Q
"RTN","XINDX9",42,0)
 N W S W=+$S($D(LV(LV,"FNC",LI)):LI,$O(LV(LV,"FNC",LI)):$O(LV(LV,"FNC",LI)),1:$O(LV(LV,"FNC",LI),-1)) ;patch 119
"RTN","XINDX9",43,0)
 Q $G(LV(LV,"FNC",W))
"RTN","XINDX9",44,0)
 ;
"RTN","XINDX9",45,0)
OP(NEW) ;Sets or returns the current operator
"RTN","XINDX9",46,0)
 I $D(NEW) S LV(LV,"OP",LI)=NEW Q
"RTN","XINDX9",47,0)
 N W S W=+$S($D(LV(LV,"OP",LI)):LI,1:$O(LV(LV,"OP",LI),-1))
"RTN","XINDX9",48,0)
 Q $G(LV(LV,"OP",W))
"RTN","XINDX9",49,0)
 ;
"RTN","XINDX9",50,0)
QUOTE F I=I+1:1 S CH=$E(STR,I) Q:CH=""!(CH=Q)
"RTN","XINDX9",51,0)
 I $E(STR,I+1)=Q S I=I+1 G QUOTE
"RTN","XINDX9",52,0)
 I OP'="?",$E(STR,I+1)]"","[]()<>\/+-=&!_#*,:'|"'[$E(STR,I+1) D E^XINDX1(46) Q
"RTN","XINDX9",53,0)
 Q:CH]""  D E^XINDX1(6) Q
"RTN","XINDX9",54,0)
GVAR() ;EF get var
"RTN","XINDX9",55,0)
 N % D VAR S %=$E(STR,LL,I),LL=I+1
"RTN","XINDX9",56,0)
 Q %
"RTN","XINDX9",57,0)
VAR F J=I+1:1 S CH=$E(STR,J) Q:CH'?1AN
"RTN","XINDX9",58,0)
 S I=J-1 D SUM("V")
"RTN","XINDX9",59,0)
 Q
"RTN","XINDX9",60,0)
NUM F J=I+1:1 S CH=$E(STR,J) Q:"0123456789."'[CH!(CH="")
"RTN","XINDX9",61,0)
 I CH="E" S CH=$E(STR,J+1) I CH?1N!("+-"[CH) S I=J G NUM
"RTN","XINDX9",62,0)
 I CH]"",CH'?1P S ERR=53 D ^XINDX1
"RTN","XINDX9",63,0)
 S I=J-1 D SUM("N")
"RTN","XINDX9",64,0)
 Q
"RTN","XINDX9",65,0)
INC S I=I+1,CH=$E(STR,I)
"RTN","XINDX9",66,0)
 Q
"RTN","XINDX9",67,0)
FUNC ;Functions and special var's.
"RTN","XINDX9",68,0)
 D INC S X=CH,S=$$GVAR() G EXT:S["$$",PKG:S["$&",SPV:CH'="("
"RTN","XINDX9",69,0)
 S S=$$CASE($E(S,2,11)),F1=$G(IND("FNC",S)) I '$L(F1) D E^XINDX1(3) S F1=S G FX
"RTN","XINDX9",70,0)
 I "ZV"[X S ERR=$S("Z"[X:31,1:27) D ^XINDX1
"RTN","XINDX9",71,0)
FX S X="$"_F1,CH="" D FNC("$F"),ADD,SUM("F") Q
"RTN","XINDX9",72,0)
SPV S X=S D FNC("$V"),ADD,SUM("V") S X=$E(S,2,9),CH=""
"RTN","XINDX9",73,0)
 I $E(S,2)="Z" D E^XINDX1(28) Q
"RTN","XINDX9",74,0)
 I '$D(IND("SVN",X)) D E^XINDX1(4)
"RTN","XINDX9",75,0)
 Q
"RTN","XINDX9",76,0)
EXT ;EXTRINSIC
"RTN","XINDX9",77,0)
 S X=S,CH="" D FNC("$$"),ADD,SUM("V") Q
"RTN","XINDX9",78,0)
SSVN ;Error 54 access for Kernel only
"RTN","XINDX9",79,0)
 D INC S X=$$GVAR() I '$D(IND("SSVN",$E(X,3,99))) D E^XINDX1(4) Q  ;Need new #
"RTN","XINDX9",80,0)
 D E^XINDX1(54),ADD,SUM("V") Q
"RTN","XINDX9",81,0)
PKG ;External Function
"RTN","XINDX9",82,0)
 S J=$F(STR,"(",I),I=J-2,X=S_$E(STR,LL,I),LL=J-1,CH=""
"RTN","XINDX9",83,0)
 D ADD,E^XINDX1(55) ;Not standard VA
"RTN","XINDX9",84,0)
 Q
"RTN","XINDX9",85,0)
E D E^XINDX1(11)
"RTN","XINDX9",86,0)
 Q
"RTN","XINDX9",87,0)
PAT N PC S PC=0
"RTN","XINDX9",88,0)
 F I=I+1:1 S CH=$E(STR,I) D PATQ:CH=Q,PATD:CH="(",PATU:CH=")",PATC:CH="," I CH=""!(CH'?1N&("ACELNPUacelnpu."'[CH)) Q
"RTN","XINDX9",89,0)
 I PC D E^XINDX1(5)
"RTN","XINDX9",90,0)
 S I=I-1 I ":),@+-_*/\!&'"'[CH D E^XINDX1(16),SEP Q
"RTN","XINDX9",91,0)
 Q
"RTN","XINDX9",92,0)
 ;Quote in Pattern
"RTN","XINDX9",93,0)
PATQ F I=I+1:1 S CH=$E(STR,I) Q:CH=""!(CH=Q)
"RTN","XINDX9",94,0)
 D:CH="" E^XINDX1(6) S I=I+1,CH=$E(STR,I) G:CH=Q PATQ
"RTN","XINDX9",95,0)
 Q
"RTN","XINDX9",96,0)
PATD S PC=PC+1,CH="." ;p110 Start Alt.
"RTN","XINDX9",97,0)
 Q
"RTN","XINDX9",98,0)
PATU I 'PC,LV>1 S CH="" Q  ;End
"RTN","XINDX9",99,0)
 S PC=PC-1,CH="." ;p110 End Alt.
"RTN","XINDX9",100,0)
 Q
"RTN","XINDX9",101,0)
PATC I PC<1 Q  ;
"RTN","XINDX9",102,0)
 S CH="." ;p110 Comma in Alt.
"RTN","XINDX9",103,0)
 Q
"RTN","XINDX9",104,0)
PAREN F I=I+1:1 S CH=$E(STR,I) Q:CH=""!(CH=")")
"RTN","XINDX9",105,0)
 D:CH="" E^XINDX1(5) S CH="."
"RTN","XINDX9",106,0)
 Q
"RTN","XINDX9",107,0)
SEP ;Find sep
"RTN","XINDX9",108,0)
 Q
"RTN","XINDX9",109,0)
SUM(P) ;Build summry line
"RTN","XINDX9",110,0)
 S LV(LV,"S")=$G(LV(LV,"S"))_P
"RTN","XINDX9",111,0)
 Q
"RTN","XINDX9",112,0)
CASE(%) ;UpperCase
"RTN","XINDX9",113,0)
 Q $TR(%,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XINDX9",114,0)
 ;
"RTN","XINDX9",115,0)
TEST S STR=$E($T(TEST+2),4,999) D XINDX9
"RTN","XINDX9",116,0)
 Q
"RTN","XINDX9",117,0)
 ;;NUMVAL?.1(1"+",1"-")1(1.N.1".".N,.N.1"."1.N).1(1"E".1(1"+",1"-")1.N)
"VER")
8.0^22.0
"BLD",1249,6)
^95
**END**
**END**
