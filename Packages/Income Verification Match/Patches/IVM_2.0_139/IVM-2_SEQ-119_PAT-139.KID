Released IVM*2*139 SEQ #119
Extracted from mail message
**KIDS**:IVM*2.0*139^

**INSTALL NAME**
IVM*2.0*139
"BLD",7783,0)
IVM*2.0*139^INCOME VERIFICATION MATCH^0^3090612^y
"BLD",7783,4,0)
^9.64PA^^
"BLD",7783,6.3)
3
"BLD",7783,"ABPKG")
n
"BLD",7783,"KRN",0)
^9.67PA^779.2^20
"BLD",7783,"KRN",.4,0)
.4
"BLD",7783,"KRN",.401,0)
.401
"BLD",7783,"KRN",.402,0)
.402
"BLD",7783,"KRN",.403,0)
.403
"BLD",7783,"KRN",.5,0)
.5
"BLD",7783,"KRN",.84,0)
.84
"BLD",7783,"KRN",3.6,0)
3.6
"BLD",7783,"KRN",3.8,0)
3.8
"BLD",7783,"KRN",9.2,0)
9.2
"BLD",7783,"KRN",9.8,0)
9.8
"BLD",7783,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7783,"KRN",9.8,"NM",1,0)
IVMCM2^^0^B20142565
"BLD",7783,"KRN",9.8,"NM",2,0)
IVMCM4^^0^B5050426
"BLD",7783,"KRN",9.8,"NM",3,0)
IVMUM4^^0^B5278918
"BLD",7783,"KRN",9.8,"NM","B","IVMCM2",1)

"BLD",7783,"KRN",9.8,"NM","B","IVMCM4",2)

"BLD",7783,"KRN",9.8,"NM","B","IVMUM4",3)

"BLD",7783,"KRN",19,0)
19
"BLD",7783,"KRN",19,"NM",0)
^9.68A^^
"BLD",7783,"KRN",19.1,0)
19.1
"BLD",7783,"KRN",101,0)
101
"BLD",7783,"KRN",409.61,0)
409.61
"BLD",7783,"KRN",771,0)
771
"BLD",7783,"KRN",779.2,0)
779.2
"BLD",7783,"KRN",870,0)
870
"BLD",7783,"KRN",8989.51,0)
8989.51
"BLD",7783,"KRN",8989.52,0)
8989.52
"BLD",7783,"KRN",8994,0)
8994
"BLD",7783,"KRN","B",.4,.4)

"BLD",7783,"KRN","B",.401,.401)

"BLD",7783,"KRN","B",.402,.402)

"BLD",7783,"KRN","B",.403,.403)

"BLD",7783,"KRN","B",.5,.5)

"BLD",7783,"KRN","B",.84,.84)

"BLD",7783,"KRN","B",3.6,3.6)

"BLD",7783,"KRN","B",3.8,3.8)

"BLD",7783,"KRN","B",9.2,9.2)

"BLD",7783,"KRN","B",9.8,9.8)

"BLD",7783,"KRN","B",19,19)

"BLD",7783,"KRN","B",19.1,19.1)

"BLD",7783,"KRN","B",101,101)

"BLD",7783,"KRN","B",409.61,409.61)

"BLD",7783,"KRN","B",771,771)

"BLD",7783,"KRN","B",779.2,779.2)

"BLD",7783,"KRN","B",870,870)

"BLD",7783,"KRN","B",8989.51,8989.51)

"BLD",7783,"KRN","B",8989.52,8989.52)

"BLD",7783,"KRN","B",8994,8994)

"BLD",7783,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",7783,"QUES",0)
^9.62^^
"BLD",7783,"REQB",0)
^9.611^1^1
"BLD",7783,"REQB",1,0)
IVM*2.0*115^2
"BLD",7783,"REQB","B","IVM*2.0*115",1)

"MBREQ")
0
"PKG",120,-1)
1^1
"PKG",120,0)
INCOME VERIFICATION MATCH^IVM^IVM Software for interface with the IVM Center
"PKG",120,20,0)
^9.402P^^
"PKG",120,22,0)
^9.49I^1^1
"PKG",120,22,1,0)
2.0^2941021^2960823
"PKG",120,22,1,"PAH",1,0)
139^3090612
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","IVMCM2")
0^1^B20142565^B19385978
"RTN","IVMCM2",1,0)
IVMCM2 ;ALB/SEK,CKN,TDM - ADD NEW DCD DEPENDENT TO INCOME PERSON FILE ; 6/12/09 12:16pm
"RTN","IVMCM2",2,0)
 ;;2.0;INCOME VERIFICATION MATCH;**17,105,115,139**;21-OCT-94;Build 3
"RTN","IVMCM2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IVMCM2",4,0)
 ;
"RTN","IVMCM2",5,0)
EN ; this routine will add entries to INCOME PERSON file (408.13) for
"RTN","IVMCM2",6,0)
 ; new dependents (spouse/children).  if DCD demo data (name, dob, 
"RTN","IVMCM2",7,0)
 ; ssn, sex) is different than VAMC data, 408.13 will be changed to
"RTN","IVMCM2",8,0)
 ; contain the DCD data.  the MEANS TEST CHANGES file (408.41) will
"RTN","IVMCM2",9,0)
 ; contain both values.
"RTN","IVMCM2",10,0)
 ;
"RTN","IVMCM2",11,0)
INPIEN ; get INCOME PERSON IEN
"RTN","IVMCM2",12,0)
 ; if PATIENT RELATION IEN not in ZDP
"RTN","IVMCM2",13,0)
 ;    add dependent to INCOME PERSON file if dependent not found
"RTN","IVMCM2",14,0)
 ;    dependent found if dob, sex, & relationship (408.12) match
"RTN","IVMCM2",15,0)
 ;
"RTN","IVMCM2",16,0)
 ;     Input    DFN     IEN of file #2
"RTN","IVMCM2",17,0)
 ;              IVMSEG  dependent's ZDP segment
"RTN","IVMCM2",18,0)
 ;
"RTN","IVMCM2",19,0)
 ; ivmflg1=1 have 408.13 ien when exit (found or added)
"RTN","IVMCM2",20,0)
 ; ivmflg2=1 dep record must be added to 408.12
"RTN","IVMCM2",21,0)
 ; ivmflg5=1 spouse ZDP incomplete(not dependent) - always spouse records
"RTN","IVMCM2",22,0)
 S (IVMFLG1,IVMFLG2,IVMFLG5)=0
"RTN","IVMCM2",23,0)
 S DGPRI=$P(IVMSEG,"^",7) ; ien of patient relation file
"RTN","IVMCM2",24,0)
 ;
"RTN","IVMCM2",25,0)
 S IVMNM=$$FMNAME^HLFNC($P(IVMSEG,"^",2)),IVMSEX=$P(IVMSEG,"^",3),IVMDOB=$$FMDATE^HLFNC($P(IVMSEG,"^",4)),IVMSSN=$P(IVMSEG,"^",5)
"RTN","IVMCM2",26,0)
 S IVMPSSNR=$P(IVMSEG,"^",10) ;Pseudo SSN Reason IVM*2*105
"RTN","IVMCM2",27,0)
 ;if there is a valid Pseudo SSN Reason, then append a "P" to the end
"RTN","IVMCM2",28,0)
 ;of the SSN so that it cam be recognized on VistA as a pseudo - IVM*2*115
"RTN","IVMCM2",29,0)
 S IVMSSN=$G(IVMSSN)_$S($G(IVMPSSNR)="N":"P",$G(IVMPSSNR)="R":"P",$G(IVMPSSNR)="S":"P",1:"")
"RTN","IVMCM2",30,0)
 S IVMEFFDT=$$FMDATE^HLFNC($P(IVMSEG,"^",9)),IVMRELN=$P(IVMSEG,"^",6)
"RTN","IVMCM2",31,0)
 S IVMSPMNM=$P(IVMSEG,"^",8) ;Spouse Maiden Name IVM*2*105
"RTN","IVMCM2",32,0)
 ;If not valid value, set it to null
"RTN","IVMCM2",33,0)
 I IVMPSSNR]"",IVMPSSNR'="R",IVMPSSNR'="S",IVMPSSNR'="N" S IVMPSSNR=""
"RTN","IVMCM2",34,0)
 S IVMSSNVS=$P(IVMSEG,"^",12) ;SSN Verification Status IVM*2*115
"RTN","IVMCM2",35,0)
 ;If not valid value, set it to null
"RTN","IVMCM2",36,0)
 I IVMSSNVS]"",IVMSSNVS'=2,IVMSSNVS'=4 S IVMSSNVS=""  ;IVM*2*115
"RTN","IVMCM2",37,0)
 ;
"RTN","IVMCM2",38,0)
 I IVMSPCHV="S"&((IVMNM']"")!(IVMSEX']"")!(IVMDOB']"")) S IVMFLG5=1 Q
"RTN","IVMCM2",39,0)
 I 'DGPRI G NOIEN
"RTN","IVMCM2",40,0)
 ;
"RTN","IVMCM2",41,0)
 ; if ien of patient relation file (dgpri) transmitted by IVM Center
"RTN","IVMCM2",42,0)
 ; and found in 408.12, get ien of income person.  if DCD demo data
"RTN","IVMCM2",43,0)
 ; is different, change in 408.13 & add to 408.41
"RTN","IVMCM2",44,0)
 ; ivmprn is 0 node of 408.12
"RTN","IVMCM2",45,0)
 ; dgipi is ien of 408.13
"RTN","IVMCM2",46,0)
 S IVMPRN=$G(^DGPR(408.12,+DGPRI,0))
"RTN","IVMCM2",47,0)
 I IVMPRN]"" D GETIPI Q:$D(IVMFERR)  S DGIPI=+$P($P(IVMPRN,"^",3),";"),IVMFLG1=1,IVMRELO=$P(IVMPRN,"^",2) D AUDITP^IVMCM9,AUDIT^IVMCM9 Q
"RTN","IVMCM2",48,0)
 ;
"RTN","IVMCM2",49,0)
NOIEN ; ien of patient relation file is not transmitted or transmitted and
"RTN","IVMCM2",50,0)
 ; not found
"RTN","IVMCM2",51,0)
 ; check if dependent in income person file
"RTN","IVMCM2",52,0)
 ; if dependent not found in 408.13, setup ivmstr =  0 node of 408.13
"RTN","IVMCM2",53,0)
 ; subscript of array IVMAR is ien of 408.12 transmitted by IVM Center or
"RTN","IVMCM2",54,0)
 ; created or found by upload.
"RTN","IVMCM2",55,0)
 ;
"RTN","IVMCM2",56,0)
 S DGPRI=0 F  S DGPRI=$O(^DGPR(408.12,"B",DFN,DGPRI)) Q:'DGPRI  D  Q:IVMFLG1!($D(IVMFERR))
"RTN","IVMCM2",57,0)
 .D GETIP
"RTN","IVMCM2",58,0)
 .Q:$D(IVMFERR)!($D(IVMAR(DGPRI)))!(IVMRELO=1)
"RTN","IVMCM2",59,0)
 .I IVMSEX=IVMSEX13&(IVMDOB=IVMDOB13)&(IVMRELN=IVMRELO) S IVMFLG1=1,IVMAR(DGPRI)=""
"RTN","IVMCM2",60,0)
 .Q
"RTN","IVMCM2",61,0)
 ;
"RTN","IVMCM2",62,0)
 ; found dependent in 408.13. if demo data different, change in 408.13
"RTN","IVMCM2",63,0)
 ; and add in 408.41
"RTN","IVMCM2",64,0)
 Q:$D(IVMFERR)
"RTN","IVMCM2",65,0)
 I IVMFLG1 S DGIPI=+$P($P(IVMPRN,"^",3),";") D AUDITP^IVMCM9,AUDIT1^IVMCM9 Q
"RTN","IVMCM2",66,0)
 ;
"RTN","IVMCM2",67,0)
 ; dependent not found. add record to 408.13
"RTN","IVMCM2",68,0)
 I 'IVMFLG1 D
"RTN","IVMCM2",69,0)
 .S $P(IVMSTR,"^")=IVMNM,$P(IVMSTR,"^",2)=IVMSEX,$P(IVMSTR,"^",3)=IVMDOB,$P(IVMSTR,"^",9)=IVMSSN,$P(IVMSTR,"^",10)=IVMPSSNR,$P(IVMSTR,"^",11)=IVMSSNVS,$P(IVMSTR1,"^")=IVMSPMNM
"RTN","IVMCM2",70,0)
 .D ADDDEP
"RTN","IVMCM2",71,0)
 Q
"RTN","IVMCM2",72,0)
 ;
"RTN","IVMCM2",73,0)
ADDDEP ; add dependent to 408.13 file
"RTN","IVMCM2",74,0)
 ; In - DFN=IEN of File #2
"RTN","IVMCM2",75,0)
 ;      DGRP0ND=0 node of 408.13
"RTN","IVMCM2",76,0)
 ;      DGRP1ND=1 node of 408.13
"RTN","IVMCM2",77,0)
 ;Out - DGIPI=408.13 IEN
"RTN","IVMCM2",78,0)
 ;
"RTN","IVMCM2",79,0)
 N X,Y
"RTN","IVMCM2",80,0)
 S DGRP0ND=IVMSTR
"RTN","IVMCM2",81,0)
 S DGRP1ND=IVMSTR1
"RTN","IVMCM2",82,0)
 K DINUM
"RTN","IVMCM2",83,0)
 N CNT,I S CNT=0
"RTN","IVMCM2",84,0)
 F I=2,3,9 D
"RTN","IVMCM2",85,0)
 .S CNT=CNT+1,$P(DIC("DR"),";",CNT)=".0"_I_"////"_$P(DGRP0ND,U,I)
"RTN","IVMCM2",86,0)
 F I=10,11 D
"RTN","IVMCM2",87,0)
 .S CNT=CNT+1,$P(DIC("DR"),";",CNT)="."_I_"////"_$P(DGRP0ND,U,I)
"RTN","IVMCM2",88,0)
 F I=1:1:8 S DIC("DR")=DIC("DR")_";1."_I_"////"_$P(DGRP1ND,U,I)
"RTN","IVMCM2",89,0)
 S (DIK,DIC)="^DGPR(408.13,",DIC(0)="L",DLAYGO=408.13,X=$P(DGRP0ND,"^") K DD,DO D FILE^DICN S (DGIPI,DA)=+Y K DLAYGO
"RTN","IVMCM2",90,0)
 ;
"RTN","IVMCM2",91,0)
 ; if can't create stub notify site & IVM Center
"RTN","IVMCM2",92,0)
 I DGIPI'>0 D  Q
"RTN","IVMCM2",93,0)
 .S (IVMTEXT(6))="Can't create stub for file 408.13"
"RTN","IVMCM2",94,0)
 .D PROB^IVMCMC(IVMTEXT(6))
"RTN","IVMCM2",95,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMCM2",96,0)
 .S IVMFERR=""
"RTN","IVMCM2",97,0)
 S IVMFLG2=1 ; added dep to 408.13 must add to 408.12
"RTN","IVMCM2",98,0)
 K DIK,DIC
"RTN","IVMCM2",99,0)
 Q
"RTN","IVMCM2",100,0)
 ;
"RTN","IVMCM2",101,0)
 ;
"RTN","IVMCM2",102,0)
GETIP ; if can't find 408.12 record notify site & IVM Center
"RTN","IVMCM2",103,0)
 S IVMPRN=$G(^DGPR(408.12,+DGPRI,0))
"RTN","IVMCM2",104,0)
 S IVMRELO=$P(IVMPRN,"^",2)
"RTN","IVMCM2",105,0)
 I IVMPRN']"" D  Q
"RTN","IVMCM2",106,0)
 .S (IVMTEXT(6))="Can't find 408.12 record "_DGPRI
"RTN","IVMCM2",107,0)
 .D PROB^IVMCMC(IVMTEXT(6))
"RTN","IVMCM2",108,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMCM2",109,0)
 .S IVMFERR=""
"RTN","IVMCM2",110,0)
 Q:IVMRELO=1
"RTN","IVMCM2",111,0)
 ;
"RTN","IVMCM2",112,0)
GETIPI ; ivmseg13 is 0 node of income person file
"RTN","IVMCM2",113,0)
 ; get demo data in 408.13 & 408.12
"RTN","IVMCM2",114,0)
 S IVMSEG13=$$DEM^DGMTU1(DGPRI)
"RTN","IVMCM2",115,0)
 S IVMSG131=$$DEM1^DGMTU1(DGPRI) ;Get node 1
"RTN","IVMCM2",116,0)
 I IVMSEG13']"" D  Q
"RTN","IVMCM2",117,0)
 .S (IVMTEXT(6))="Can't find 408.13 record"
"RTN","IVMCM2",118,0)
 .D PROB^IVMCMC(IVMTEXT(6))
"RTN","IVMCM2",119,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMCM2",120,0)
 .S IVMFERR=""
"RTN","IVMCM2",121,0)
 S IVMSEX13=$P(IVMSEG13,"^",2),IVMDOB13=$P(IVMSEG13,"^",3),IVMSSN13=$P(IVMSEG13,"^",9),IVMPSR13=$P(IVMSEG13,"^",10),IVMSVS13=$P(IVMSEG13,"^",11)
"RTN","IVMCM2",122,0)
 S IVMSMN13=$P($G(IVMSG131),"^")
"RTN","IVMCM2",123,0)
 S IVMNM13=$P(IVMSEG13,"^")
"RTN","IVMCM2",124,0)
 Q
"RTN","IVMCM4")
0^2^B5050426^B4317028
"RTN","IVMCM4",1,0)
IVMCM4 ;ALB/SEK,ERC - ADD DCD NEW INDIVIDUAL ANNUAL INCOME FILE ENTRIES ; 6/12/09 12:50pm
"RTN","IVMCM4",2,0)
 ;;2.0;INCOME VERIFICATION MATCH;**17,115,139**;21-OCT-94;Build 3
"RTN","IVMCM4",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IVMCM4",4,0)
 ;
"RTN","IVMCM4",5,0)
EN ; this routine will add entries to INDIVIDUAL ANNUAL INCOME file
"RTN","IVMCM4",6,0)
 ; (408.21)
"RTN","IVMCM4",7,0)
 ;
"RTN","IVMCM4",8,0)
 ; DFN       Patient file IEN
"RTN","IVMCM4",9,0)
 ; DGPRI     Patient Relation IEN
"RTN","IVMCM4",10,0)
 ; DGLY      Last Year
"RTN","IVMCM4",11,0)
 ; DGINI     New Individual Annual Income IEN
"RTN","IVMCM4",12,0)
 ; IVMSEG    ZIC record for veteran or spouse or dependent
"RTN","IVMCM4",13,0)
 ; IVMMTIEN  Means Test IEN (#408.31)
"RTN","IVMCM4",14,0)
 ; IVM0      408.21 0 node pieces 8-20
"RTN","IVMCM4",15,0)
 ; IVM1             1 node pieces 1-3
"RTN","IVMCM4",16,0)
 ; IVM2             2 node pieces 1-5
"RTN","IVMCM4",17,0)
 ;
"RTN","IVMCM4",18,0)
 N IVM0,IVM1,IVM2,IVMC
"RTN","IVMCM4",19,0)
 S DGINI=$$ADDIN^DGMTU2(DFN,DGPRI,DGLY)
"RTN","IVMCM4",20,0)
 ;
"RTN","IVMCM4",21,0)
 ; if can't create stub notify site & IVM Center
"RTN","IVMCM4",22,0)
 I DGINI'>0 D  Q
"RTN","IVMCM4",23,0)
 .S (IVMTEXT(6),HLERR)="Can't create stub for file 408.21"
"RTN","IVMCM4",24,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMCM4",25,0)
 .S IVMFERR=""
"RTN","IVMCM4",26,0)
 ;
"RTN","IVMCM4",27,0)
 ; if can't lock stub notify site & IVM Center
"RTN","IVMCM4",28,0)
 L +^DGMT(408.21,DGINI):10 E  D  Q
"RTN","IVMCM4",29,0)
 .S (IVMTEXT(6),HLERR)="Can't update stub for file 408.21"
"RTN","IVMCM4",30,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMCM4",31,0)
 .S IVMFERR=""
"RTN","IVMCM4",32,0)
 ;
"RTN","IVMCM4",33,0)
EN1 ; add 1 node for vet & child
"RTN","IVMCM4",34,0)
 ; add 2 node for vet, spouse & (when VR 1) child
"RTN","IVMCM4",35,0)
 ;
"RTN","IVMCM4",36,0)
 ; - zero node:pieces 8-20
"RTN","IVMCM4",37,0)
 F IVMC=3:1:12 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMCM4",38,0)
 S IVM0=$P(IVMSEG,"^",3,12)
"RTN","IVMCM4",39,0)
 ;
"RTN","IVMCM4",40,0)
 I IVMSPCHV'="S" F IVMC=13:1:15 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMCM4",41,0)
 I IVMSPCHV'="S" S IVM1=$P(IVMSEG,"^",13,15)
"RTN","IVMCM4",42,0)
 ;IVM*2.0*115
"RTN","IVMCM4",43,0)
 S $P(^DGMT(408.21,DGINI,0),"^",8,20)=IVM0,DA=DGINI S:IVMSPCHV'="S" ^(1)=IVM1
"RTN","IVMCM4",44,0)
 N MTVERS
"RTN","IVMCM4",45,0)
 S MTVERS=$S(+$G(DGMTI):+$P($G(^DGMT(408.31,$G(DGMTI),2)),"^",11),1:0)
"RTN","IVMCM4",46,0)
 I +$G(MTVERS)=0 D
"RTN","IVMCM4",47,0)
 . I IVMSPCHV'="C" F IVMC=16:1:20 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMCM4",48,0)
 . I IVMSPCHV'="C" S IVM2=$P(IVMSEG,"^",16,20)
"RTN","IVMCM4",49,0)
 . S:IVMSPCHV'="C" ^DGMT(408.21,DGINI,2)=IVM2
"RTN","IVMCM4",50,0)
 E  D
"RTN","IVMCM4",51,0)
 . F IVMC=16,18,19 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMCM4",52,0)
 . S IVM2=$P(IVMSEG,"^",16)_"^^"_$P(IVMSEG,"^",18,19)
"RTN","IVMCM4",53,0)
 . S ^DGMT(408.21,DGINI,2)=IVM2
"RTN","IVMCM4",54,0)
 S DIK="^DGMT(408.21,"
"RTN","IVMCM4",55,0)
 D IX1^DIK L -^DGMT(408.21,DGINI)
"RTN","IVMCM4",56,0)
 K DA,DIK
"RTN","IVMCM4",57,0)
 Q
"RTN","IVMUM4")
0^3^B5278918^B4479688
"RTN","IVMUM4",1,0)
IVMUM4 ;ALB/SEK - ADD NEW INDIVIDUAL ANNUAL INCOME FILE ENTRIES ; 6/12/09 12:55pm
"RTN","IVMUM4",2,0)
 ;;2.0;INCOME VERIFICATION MATCH;**1,8,17,115,139**;21-OCT-94;Build 3
"RTN","IVMUM4",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","IVMUM4",4,0)
 ;
"RTN","IVMUM4",5,0)
EN ; this routine will add entries to INDIVIDUAL ANNUAL INCOME file
"RTN","IVMUM4",6,0)
 ; (408.21)
"RTN","IVMUM4",7,0)
 ; 
"RTN","IVMUM4",8,0)
 ; * A reference to this code in Vista was not discovered.  This may be dead code!
"RTN","IVMUM4",9,0)
 ; *   IVM*2*115 updated EN1 so that Version 1 means test data returned on ZIC
"RTN","IVMUM4",10,0)
 ; *   segments in a Z06 message will be processed for dependent children, if that
"RTN","IVMUM4",11,0)
 ; *   information is ever added to Vista Z06 messages.  Additionally, the code remains
"RTN","IVMUM4",12,0)
 ; *   in case analysis of Vista missed any reference to this routine.
"RTN","IVMUM4",13,0)
 ;
"RTN","IVMUM4",14,0)
 ; DFN    Patient file IEN
"RTN","IVMUM4",15,0)
 ; DGPRI  Patient Relation IEN
"RTN","IVMUM4",16,0)
 ; DGLY      Last Year
"RTN","IVMUM4",17,0)
 ; DGINI     New Individual Annual Income IEN
"RTN","IVMUM4",18,0)
 ; IVMSEG    ZIC record for veteran or spouse or dependent
"RTN","IVMUM4",19,0)
 ; IVMMTIEN  Means Test IEN (#408.31)
"RTN","IVMUM4",20,0)
 ; IVM0      408.21 0 node pieces 8-18
"RTN","IVMUM4",21,0)
 ; IVM1             1 node pieces 1-3
"RTN","IVMUM4",22,0)
 ; IVM2             2 node pieces 1-5
"RTN","IVMUM4",23,0)
 ;
"RTN","IVMUM4",24,0)
 N IVM0,IVM1,IVM2,IVMC
"RTN","IVMUM4",25,0)
 S DGINI=$$ADDIN^DGMTU2(DFN,DGPRI,DGLY)
"RTN","IVMUM4",26,0)
 ;
"RTN","IVMUM4",27,0)
 ; if can't create stub notify site & IVM Center
"RTN","IVMUM4",28,0)
 I DGINI'>0 D  Q
"RTN","IVMUM4",29,0)
 . S (IVMTEXT(6),HLERR)="Can't create stub for file 408.21"
"RTN","IVMUM4",30,0)
 . D ERRBULL^IVMPREC7,MAIL^IVMUFNC()
"RTN","IVMUM4",31,0)
 . S IVMFERR=""
"RTN","IVMUM4",32,0)
 ;
"RTN","IVMUM4",33,0)
 ; if can't lock stub notify site & IVM Center
"RTN","IVMUM4",34,0)
 L +^DGMT(408.21,DGINI):10 E  D  Q
"RTN","IVMUM4",35,0)
 .S (IVMTEXT(6),HLERR)="Can't update stub for file 408.21"
"RTN","IVMUM4",36,0)
 .D ERRBULL^IVMPREC7,MAIL^IVMUFNC("DGMT MT/CT UPLOAD ALERTS")
"RTN","IVMUM4",37,0)
 .S IVMFERR=""
"RTN","IVMUM4",38,0)
 ;
"RTN","IVMUM4",39,0)
EN1 ; add 1 node for vet & child
"RTN","IVMUM4",40,0)
 ; add 2 node for vet, spouse & (when VR 1) child
"RTN","IVMUM4",41,0)
 F IVMC=3:1:12 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMUM4",42,0)
 S IVM0=$P(IVMSEG,"^",3,12)
"RTN","IVMUM4",43,0)
 I IVMSPCHV'="S" F IVMC=13:1:15 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMUM4",44,0)
 I IVMSPCHV'="S" S IVM1=$P(IVMSEG,"^",13,15)
"RTN","IVMUM4",45,0)
 ;IVM*2.0*115
"RTN","IVMUM4",46,0)
 S $P(^DGMT(408.21,DGINI,0),"^",8,17)=IVM0,DA=DGINI S:IVMSPCHV'="S" ^(1)=IVM1
"RTN","IVMUM4",47,0)
 N MTVERS
"RTN","IVMUM4",48,0)
 S MTVERS=$S(+$G(IVMMTIEN):+$P($G(^DGMT(408.31,$G(IVMMTIEN),2)),"^",11),1:0)
"RTN","IVMUM4",49,0)
 I +$G(MTVERS)=0 D
"RTN","IVMUM4",50,0)
 . I IVMSPCHV'="C" F IVMC=16:1:20 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMUM4",51,0)
 . I IVMSPCHV'="C" S IVM2=$P(IVMSEG,"^",16,20)
"RTN","IVMUM4",52,0)
 . S:IVMSPCHV'="C" ^DGMT(408.21,DGINI,2)=IVM2
"RTN","IVMUM4",53,0)
 E  D
"RTN","IVMUM4",54,0)
 . F IVMC=16,18,19 S:$P(IVMSEG,"^",IVMC)=HLQ $P(IVMSEG,"^",IVMC)=""
"RTN","IVMUM4",55,0)
 . S IVM2=$P(IVMSEG,"^",16)_"^^"_$P(IVMSEG,"^",18,19)
"RTN","IVMUM4",56,0)
 . S ^DGMT(408.21,DGINI,2)=IVM2
"RTN","IVMUM4",57,0)
 S DIK="^DGMT(408.21,"
"RTN","IVMUM4",58,0)
 D IX1^DIK L -^DGMT(408.21,DGINI)
"RTN","IVMUM4",59,0)
 K DA,DIK
"RTN","IVMUM4",60,0)
 Q
"VER")
8.0^22.0
"BLD",7783,6)
^119
**END**
**END**
