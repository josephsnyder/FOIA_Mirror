Released PSA*3*67 SEQ #51
Extracted from mail message
**KIDS**:PSA*3.0*67^

**INSTALL NAME**
PSA*3.0*67
"BLD",6427,0)
PSA*3.0*67^DRUG ACCOUNTABILITY^0^3080221^y
"BLD",6427,1,0)
^9.61A^37^37^3080221^^^^
"BLD",6427,1,1,0)
This patch modifies the screens within the processing and verification
"BLD",6427,1,2,0)
processes within Drug Accountability. Additional drug information is
"BLD",6427,1,3,0)
now being included in the invoice files received from the prime vendor.
"BLD",6427,1,4,0)
 
"BLD",6427,1,5,0)
The additional fields are:
"BLD",6427,1,6,0)
 Generic Description
"BLD",6427,1,7,0)
 Item Description
"BLD",6427,1,8,0)
 Prime Vendor Units (i.e. # bottles in sell unit)
"BLD",6427,1,9,0)
 Inner Pack   (i.e. # pills in bottle)
"BLD",6427,1,10,0)
 
"BLD",6427,1,11,0)
Currently, the Item Description and the inner pack fields are stored in
"BLD",6427,1,12,0)
a temporary global which was setup in patch PSA*3*54. This global is no
"BLD",6427,1,13,0)
longer used. The addition of the four fields is intended to assist the
"BLD",6427,1,14,0)
user with the matching of incoming invoice items to the Drug (#50) file.
"BLD",6427,1,15,0)
Below is an example of what the screens look like prior to installation
"BLD",6427,1,16,0)
of this patch.
"BLD",6427,1,17,0)
 
"BLD",6427,1,18,0)
                       <<< PROCESS LINE ITEM SCREEN >>>
"BLD",6427,1,19,0)
Order#: 3TC01  Invoice#: 7289249573  Invoice Date: Oct 05, 2007
"BLD",6427,1,20,0)
6  HYDROCORTISONE
"BLD",6427,1,21,0)
Qty Invoiced: 1                       UPC: 30472034356
"BLD",6427,1,22,0)
Order Unit  : EA                      NDC: 00472-0343-56
"BLD",6427,1,23,0)
Unit Price  : $0.67                   VSN: 1279124
"BLD",6427,1,24,0)
 
"BLD",6427,1,25,0)
PV-Drug-Descrip: HYDROCORT AC CRM 1%  ALP 30GM@  PV-DUOU: 28.4
"BLD",6427,1,26,0)
 
"BLD",6427,1,27,0)
After patch installation:
"BLD",6427,1,28,0)
 
"BLD",6427,1,29,0)
                       <<< PROCESS LINE ITEM SCREEN >>>
"BLD",6427,1,30,0)
Order#: 3TC01  Invoice#: 7289249573  Invoice Date: Oct 05, 2007
"BLD",6427,1,31,0)
6  HYDROCORTISONE
"BLD",6427,1,32,0)
Qty Invoiced: 1                       UPC: 30472034356
"BLD",6427,1,33,0)
Order Unit  : EA                      NDC: 00472-0343-56
"BLD",6427,1,34,0)
Unit Price  : $0.67                   VSN: 1279124
"BLD",6427,1,35,0)
 
"BLD",6427,1,36,0)
PV-Drug-Description  : HYDROCORT AC CRM 1%  ALP 30GM@  PV-DUOU : 28.4
"BLD",6427,1,37,0)
PV-Drug-Generic Name : HYDROCORTISONE                  PV-Units: 1
"BLD",6427,4,0)
^9.64PA^58.811^1
"BLD",6427,4,58.811,0)
58.811
"BLD",6427,4,58.811,222)
y^^f^^^^n
"BLD",6427,4,"B",58.811,58.811)

"BLD",6427,6.3)
15
"BLD",6427,10,0)
^9.63
"BLD",6427,"INID")
^n
"BLD",6427,"INIT")

"BLD",6427,"KRN",0)
^9.67PA^^
"BLD",6427,"KRN",.4,0)
.4
"BLD",6427,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",6427,"KRN",.401,0)
.401
"BLD",6427,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",6427,"KRN",.402,0)
.402
"BLD",6427,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",6427,"KRN",.403,0)
.403
"BLD",6427,"KRN",.5,0)
.5
"BLD",6427,"KRN",.84,0)
.84
"BLD",6427,"KRN",3.6,0)
3.6
"BLD",6427,"KRN",3.8,0)
3.8
"BLD",6427,"KRN",9.2,0)
9.2
"BLD",6427,"KRN",9.8,0)
9.8
"BLD",6427,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",6427,"KRN",9.8,"NM",1,0)
PSABRKU3^^0^B26272833
"BLD",6427,"KRN",9.8,"NM",2,0)
PSABRKU5^^0^B2166774
"BLD",6427,"KRN",9.8,"NM",3,0)
PSAUTL1^^0^B58704156
"BLD",6427,"KRN",9.8,"NM",4,0)
PSAUTL4^^0^B27358372
"BLD",6427,"KRN",9.8,"NM",5,0)
PSAP67^^0^B2116360
"BLD",6427,"KRN",9.8,"NM",6,0)
PSAPROC7^^0^B56573649
"BLD",6427,"KRN",9.8,"NM",7,0)
PSAUP4^^0^B72871098
"BLD",6427,"KRN",9.8,"NM",8,0)
PSAORDP1^^0^B73055637
"BLD",6427,"KRN",9.8,"NM","B","PSABRKU3",1)

"BLD",6427,"KRN",9.8,"NM","B","PSABRKU5",2)

"BLD",6427,"KRN",9.8,"NM","B","PSAORDP1",8)

"BLD",6427,"KRN",9.8,"NM","B","PSAP67",5)

"BLD",6427,"KRN",9.8,"NM","B","PSAPROC7",6)

"BLD",6427,"KRN",9.8,"NM","B","PSAUP4",7)

"BLD",6427,"KRN",9.8,"NM","B","PSAUTL1",3)

"BLD",6427,"KRN",9.8,"NM","B","PSAUTL4",4)

"BLD",6427,"KRN",19,0)
19
"BLD",6427,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6427,"KRN",19.1,0)
19.1
"BLD",6427,"KRN",101,0)
101
"BLD",6427,"KRN",409.61,0)
409.61
"BLD",6427,"KRN",771,0)
771
"BLD",6427,"KRN",869.2,0)
869.2
"BLD",6427,"KRN",870,0)
870
"BLD",6427,"KRN",8994,0)
8994
"BLD",6427,"KRN","B",.4,.4)

"BLD",6427,"KRN","B",.401,.401)

"BLD",6427,"KRN","B",.402,.402)

"BLD",6427,"KRN","B",.403,.403)

"BLD",6427,"KRN","B",.5,.5)

"BLD",6427,"KRN","B",.84,.84)

"BLD",6427,"KRN","B",3.6,3.6)

"BLD",6427,"KRN","B",3.8,3.8)

"BLD",6427,"KRN","B",9.2,9.2)

"BLD",6427,"KRN","B",9.8,9.8)

"BLD",6427,"KRN","B",19,19)

"BLD",6427,"KRN","B",19.1,19.1)

"BLD",6427,"KRN","B",101,101)

"BLD",6427,"KRN","B",409.61,409.61)

"BLD",6427,"KRN","B",771,771)

"BLD",6427,"KRN","B",869.2,869.2)

"BLD",6427,"KRN","B",870,870)

"BLD",6427,"KRN","B",8994,8994)

"BLD",6427,"QUES",0)
^9.62^^
"BLD",6427,"REQB",0)
^9.611^4^2
"BLD",6427,"REQB",2,0)
PSA*3.0*47^1
"BLD",6427,"REQB",4,0)
PSA*3.0*65^1
"BLD",6427,"REQB","B","PSA*3.0*47",2)

"BLD",6427,"REQB","B","PSA*3.0*65",4)

"BLD",6427,"REQG",0)
^9.611^^
"FIA",58.811)
DRUG ACCOUNTABILITY ORDER
"FIA",58.811,0)
^PSD(58.811,
"FIA",58.811,0,0)
58.811
"FIA",58.811,0,1)
y^^f^^^^n
"FIA",58.811,0,10)

"FIA",58.811,0,11)

"FIA",58.811,0,"RLRO")

"FIA",58.811,0,"VR")
3.0^PSA
"FIA",58.811,58.811)
0
"FIA",58.811,58.8112)
0
"FIA",58.811,58.81125)
0
"FIA",58.811,58.811259)
0
"FIA",58.811,58.81126)
0
"MBREQ")
0
"PKG",287,-1)
1^1
"PKG",287,0)
DRUG ACCOUNTABILITY^PSA^Drug Accountability Inventory and Tracking module.
"PKG",287,22,0)
^9.49I^1^1
"PKG",287,22,1,0)
3.0^2971024^2971030^11595
"PKG",287,22,1,"PAH",1,0)
67^3080221
"PKG",287,22,1,"PAH",1,1,0)
^^37^37^3080221
"PKG",287,22,1,"PAH",1,1,1,0)
This patch modifies the screens within the processing and verification
"PKG",287,22,1,"PAH",1,1,2,0)
processes within Drug Accountability. Additional drug information is
"PKG",287,22,1,"PAH",1,1,3,0)
now being included in the invoice files received from the prime vendor.
"PKG",287,22,1,"PAH",1,1,4,0)
 
"PKG",287,22,1,"PAH",1,1,5,0)
The additional fields are:
"PKG",287,22,1,"PAH",1,1,6,0)
 Generic Description
"PKG",287,22,1,"PAH",1,1,7,0)
 Item Description
"PKG",287,22,1,"PAH",1,1,8,0)
 Prime Vendor Units (i.e. # bottles in sell unit)
"PKG",287,22,1,"PAH",1,1,9,0)
 Inner Pack   (i.e. # pills in bottle)
"PKG",287,22,1,"PAH",1,1,10,0)
 
"PKG",287,22,1,"PAH",1,1,11,0)
Currently, the Item Description and the inner pack fields are stored in
"PKG",287,22,1,"PAH",1,1,12,0)
a temporary global which was setup in patch PSA*3*54. This global is no
"PKG",287,22,1,"PAH",1,1,13,0)
longer used. The addition of the four fields is intended to assist the
"PKG",287,22,1,"PAH",1,1,14,0)
user with the matching of incoming invoice items to the Drug (#50) file.
"PKG",287,22,1,"PAH",1,1,15,0)
Below is an example of what the screens look like prior to installation
"PKG",287,22,1,"PAH",1,1,16,0)
of this patch.
"PKG",287,22,1,"PAH",1,1,17,0)
 
"PKG",287,22,1,"PAH",1,1,18,0)
                       <<< PROCESS LINE ITEM SCREEN >>>
"PKG",287,22,1,"PAH",1,1,19,0)
Order#: 3TC01  Invoice#: 7289249573  Invoice Date: Oct 05, 2007
"PKG",287,22,1,"PAH",1,1,20,0)
6  HYDROCORTISONE
"PKG",287,22,1,"PAH",1,1,21,0)
Qty Invoiced: 1                       UPC: 30472034356
"PKG",287,22,1,"PAH",1,1,22,0)
Order Unit  : EA                      NDC: 00472-0343-56
"PKG",287,22,1,"PAH",1,1,23,0)
Unit Price  : $0.67                   VSN: 1279124
"PKG",287,22,1,"PAH",1,1,24,0)
 
"PKG",287,22,1,"PAH",1,1,25,0)
PV-Drug-Descrip: HYDROCORT AC CRM 1%  ALP 30GM@  PV-DUOU: 28.4
"PKG",287,22,1,"PAH",1,1,26,0)
 
"PKG",287,22,1,"PAH",1,1,27,0)
After patch installation:
"PKG",287,22,1,"PAH",1,1,28,0)
 
"PKG",287,22,1,"PAH",1,1,29,0)
                       <<< PROCESS LINE ITEM SCREEN >>>
"PKG",287,22,1,"PAH",1,1,30,0)
Order#: 3TC01  Invoice#: 7289249573  Invoice Date: Oct 05, 2007
"PKG",287,22,1,"PAH",1,1,31,0)
6  HYDROCORTISONE
"PKG",287,22,1,"PAH",1,1,32,0)
Qty Invoiced: 1                       UPC: 30472034356
"PKG",287,22,1,"PAH",1,1,33,0)
Order Unit  : EA                      NDC: 00472-0343-56
"PKG",287,22,1,"PAH",1,1,34,0)
Unit Price  : $0.67                   VSN: 1279124
"PKG",287,22,1,"PAH",1,1,35,0)
 
"PKG",287,22,1,"PAH",1,1,36,0)
PV-Drug-Description  : HYDROCORT AC CRM 1%  ALP 30GM@  PV-DUOU : 28.4
"PKG",287,22,1,"PAH",1,1,37,0)
PV-Drug-Generic Name : HYDROCORTISONE                  PV-Units: 1
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","PSABRKU3")
0^1^B26272833^B20933321
"RTN","PSABRKU3",1,0)
PSABRKU3 ;BIR/JMB/PDW-Upload and Process Prime Vendor Invoice Data - CONT'D ;8/13/97
"RTN","PSABRKU3",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**26,41,47,67**; 10/24/97;Build 15
"RTN","PSABRKU3",3,0)
 ;Checking the X12 invoice data.
"RTN","PSABRKU3",4,0)
 S (PSASTCNT,PSAITCNT,PSACTRL(1))=0
"RTN","PSABRKU3",5,0)
 K ^TMP($J,"PSAPV SET"),PSAERR
"RTN","PSABRKU3",6,0)
 S PSALAST=""
"RTN","PSABRKU3",7,0)
 S PSALINE=0 F  S PSALINE=$O(^TMP($J,"PSAPVS",PSALINE)) Q:PSALINE=""  S PSADATA=^(PSALINE) D
"RTN","PSABRKU3",8,0)
 .;check segment order
"RTN","PSABRKU3",9,0)
 .D ^PSABRKU5 S PSALAST=$P(PSADATA,"^")
"RTN","PSABRKU3",10,0)
ISA .;control header
"RTN","PSABRKU3",11,0)
 .I PSALAST="ISA" D  Q
"RTN","PSABRKU3",12,0)
 ..S PSASTCNT=0
"RTN","PSABRKU3",13,0)
 ..S PSAISA=PSADATA,PSACTRL="" I $L($P(PSADATA,"^",14))'=9 S PSASEG="ISA" D MSG^PSABRKU8
"RTN","PSABRKU3",14,0)
 .;
"RTN","PSABRKU3",15,0)
IEA .;control trailer
"RTN","PSABRKU3",16,0)
 .I PSALAST="IEA" D  Q
"RTN","PSABRKU3",17,0)
 ..I $P(PSADATA,"^",3)'=$P(PSAISA,"^",14) S PSASEG="IEA" D MSG^PSABRKU8
"RTN","PSABRKU3",18,0)
 .;
"RTN","PSABRKU3",19,0)
GS .;group header
"RTN","PSABRKU3",20,0)
 .I PSALAST="GS" S PSAGS=PSADATA D  Q
"RTN","PSABRKU3",21,0)
 ..F %=3,4 S PSAPC=$S(%=3:7,1:9) I $P(PSADATA,"^",%)'=$TR($P(PSAISA,"^",PSAPC)," ") S PSASEG="GS" D MSG^PSABRKU8
"RTN","PSABRKU3",22,0)
 .;
"RTN","PSABRKU3",23,0)
GE .;group trailer
"RTN","PSABRKU3",24,0)
 .I PSALAST="GE" D  Q
"RTN","PSABRKU3",25,0)
 ..I $P(PSADATA,"^",3)'=$P($G(PSAGS),"^",7) S PSASEG="GE" D MSG^PSABRKU8
"RTN","PSABRKU3",26,0)
 .;
"RTN","PSABRKU3",27,0)
ST .;set header
"RTN","PSABRKU3",28,0)
 .I PSALAST="ST" D  Q
"RTN","PSABRKU3",29,0)
 ..S PSAST=PSADATA,PSACTRL=$P(PSADATA,"^",3),PSASTCNT=1,PSAITCNT=0,PSANTYPE=""
"RTN","PSABRKU3",30,0)
 ..I $L(PSACTRL)<4!($L(PSACTRL)>10) S PSASEG="ST" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",31,0)
 .. I PSACTRL="0001" S PSACTRL=0 D RESETST
"RTN","PSABRKU3",32,0)
 ..;PSA*3*41 - McKesson probability of multiple files, may have to
"RTN","PSABRKU3",33,0)
 ..;increment transaction set control numbers in 'ST' & 'SE'
"RTN","PSABRKU3",34,0)
 ..I $D(^TMP($J,"PSAPV SET",PSACTRL,"IN")) D RESETST
"RTN","PSABRKU3",35,0)
 ..I $D(^XTMP("PSAPV",PSACTRL)) D RESETST ;may already be on file
"RTN","PSABRKU3",36,0)
 .;
"RTN","PSABRKU3",37,0)
SE .;set trailer
"RTN","PSABRKU3",38,0)
 .I PSALAST="SE" S PSASTCNT=PSASTCNT+1 D  Q
"RTN","PSABRKU3",39,0)
 ..I $G(PSACTRL(1))'>0,$P(PSADATA,"^",3)'=PSACTRL S PSASEG="SE1" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",40,0)
 ..I PSASTCNT'=$P(PSADATA,"^",2) S PSASEG="SE2" D MSG^PSABRKU8
"RTN","PSABRKU3",41,0)
 .;
"RTN","PSABRKU3",42,0)
BIG .;beginning segment for invoice
"RTN","PSABRKU3",43,0)
 .I PSALAST="BIG" S PSASTCNT=PSASTCNT+1 D  Q
"RTN","PSABRKU3",44,0)
 ..I $P(PSADATA,"^",4)="" S $P(PSADATA,"^",4)=$P(PSADATA,"^",2)
"RTN","PSABRKU3",45,0)
 ..S $P(PSADATA,"^",5)=$TR($P(PSADATA,"^",5)," ")
"RTN","PSABRKU3",46,0)
 ..S ^TMP($J,"PSAPV SET",PSACTRL,"IN")=$P(PSADATA,"^",2,5)
"RTN","PSABRKU3",47,0)
 .;
"RTN","PSABRKU3",48,0)
REF .;(not used)
"RTN","PSABRKU3",49,0)
 .I PSALAST="REF" S PSASTCNT=PSASTCNT+1 Q
"RTN","PSABRKU3",50,0)
 .;
"RTN","PSABRKU3",51,0)
 .;buyer, seller, shipping addresses
"RTN","PSABRKU3",52,0)
N1 .I PSALAST="N1" S PSASTCNT=PSASTCNT+1,PSANTYPE=$P(PSADATA,"^",2) D  Q
"RTN","PSABRKU3",53,0)
 ..I PSANTYPE'="BY",PSANTYPE'="DS",PSANTYPE'="ST" S PSASEG="N1" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",54,0)
 ..S ^TMP($J,"PSAPV SET",PSACTRL,PSANTYPE)=$P(PSADATA,"^",3)
"RTN","PSABRKU3",55,0)
 .;
"RTN","PSABRKU3",56,0)
N2 .I PSALAST="N2" D  Q
"RTN","PSABRKU3",57,0)
 ..D:PSANTYPE="" NTYPE
"RTN","PSABRKU3",58,0)
 ..S $P(^TMP($J,"PSAPV SET",PSACTRL,PSANTYPE),"^",2)=$P(PSADATA,"^",2) S PSASTCNT=PSASTCNT+1
"RTN","PSABRKU3",59,0)
 .;
"RTN","PSABRKU3",60,0)
N3 .I PSALAST="N3" D  Q
"RTN","PSABRKU3",61,0)
 ..D:PSANTYPE="" NTYPE
"RTN","PSABRKU3",62,0)
 ..S $P(^TMP($J,"PSAPV SET",PSACTRL,PSANTYPE),"^",3)=$P(PSADATA,"^",2) S PSASTCNT=PSASTCNT+1
"RTN","PSABRKU3",63,0)
 .;
"RTN","PSABRKU3",64,0)
N4 .I PSALAST="N4" D  Q
"RTN","PSABRKU3",65,0)
 ..D:PSANTYPE="" NTYPE
"RTN","PSABRKU3",66,0)
 ..S $P(^TMP($J,"PSAPV SET",PSACTRL,PSANTYPE),"^",4,6)=$P(PSADATA,"^",2,4) S PSASTCNT=PSASTCNT+1,PSANTYPE=""
"RTN","PSABRKU3",67,0)
 .;
"RTN","PSABRKU3",68,0)
DTM .;date time reference
"RTN","PSABRKU3",69,0)
 .I PSALAST="DTM" S PSASTCNT=PSASTCNT+1 D  Q
"RTN","PSABRKU3",70,0)
 ..S %=$S($P(PSADATA,"^",2)="002":5,$P(PSADATA,"^",2)="035":6,1:0) I '% Q
"RTN","PSABRKU3",71,0)
 ..S $P(^TMP($J,"PSAPV SET",PSACTRL,"IN"),"^",%)=$P(PSADATA,"^",3)
"RTN","PSABRKU3",72,0)
 .;
"RTN","PSABRKU3",73,0)
IT1 .;invoice line item
"RTN","PSABRKU3",74,0)
 .I PSALAST="IT1" S PSASTCNT=PSASTCNT+1,PSAITCNT=PSAITCNT+1 D ITEM Q
"RTN","PSABRKU3",75,0)
 .;BGN PSA*3*67
"RTN","PSABRKU3",76,0)
PID .;generic vendor item name
"RTN","PSABRKU3",77,0)
 .I PSALAST="PID" S PSASTCNT=PSASTCNT+1,$P(^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM),"^",29)=$S($P(PSADATA,"^",6)=$P(^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM),"^",28):"Unknown",1:$P(PSADATA,"^",6)) Q
"RTN","PSABRKU3",78,0)
PO4 .;DESCRIPTION OF ITEM
"RTN","PSABRKU3",79,0)
 .I PSALAST="PO4" S PSASTCNT=PSASTCNT+1,$P(^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM),"^",30)=$P(PSADATA,"^",3)_"^"_$P(PSADATA,"^",9) D  Q
"RTN","PSABRKU3",80,0)
 .;END PSA*3*67
"RTN","PSABRKU3",81,0)
CTT .;item count
"RTN","PSABRKU3",82,0)
 .I PSALAST="CTT" S PSASTCNT=PSASTCNT+1 D  Q
"RTN","PSABRKU3",83,0)
 ..I PSAITCNT'=$P(PSADATA,"^",2) S PSASEG="CTT" D MSG^PSABRKU8
"RTN","PSABRKU3",84,0)
 .;
"RTN","PSABRKU3",85,0)
UNKNOWN .;Segment we don't use
"RTN","PSABRKU3",86,0)
 .S PSASTCNT=PSASTCNT+1
"RTN","PSABRKU3",87,0)
 ;
"RTN","PSABRKU3",88,0)
ERROR S PSASEG=$O(PSAERR("")) D:PSASEG'="" ERROR^PSABRKU8
"RTN","PSABRKU3",89,0)
 Q
"RTN","PSABRKU3",90,0)
 ;
"RTN","PSABRKU3",91,0)
NTYPE S PSASEG="NONTYPE" D NONTYPE^PSABRKU8
"RTN","PSABRKU3",92,0)
 Q
"RTN","PSABRKU3",93,0)
 ;
"RTN","PSABRKU3",94,0)
ITEM ;check line item
"RTN","PSABRKU3",95,0)
 I '$P(PSADATA,"^",2) S PSASEG="IT1-1" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",96,0)
 I $P(PSADATA,"^",6)'="DS" S PSASEG="IT1-2" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",97,0)
 I $P(PSADATA,"^",8)="",$P(PSADATA,"^",10)="",$P(PSADATA,"^",12)="" S PSASEG="IT1-3" D MSG^PSABRKU8 Q
"RTN","PSABRKU3",98,0)
 ;"IT1" Seg=Qty Invoiced ^ Unit of Measure ^ Unit Price ^ Basic Unit Code "DS" ^ NDC ^ VSN
"RTN","PSABRKU3",99,0)
 S PSAITEM=+$P(PSADATA,"^",2),^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM)=+$P(PSADATA,"^",3)_"^"_$P(PSADATA,"^",4)_"^"_$P(PSADATA,"^",5)_"^"_$P(PSADATA,"^",8)_"^"_$P(PSADATA,"^",10)
"RTN","PSABRKU3",100,0)
 I $P(PSADATA,"^",12)'="",$P(PSADATA,"^",11)="UP" S $P(^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM),"^",26)=$P(PSADATA,"^",12)
"RTN","PSABRKU3",101,0)
 ;Next line to add vendor Generic Description
"RTN","PSABRKU3",102,0)
 I $P(PSADATA,"^",14)'="" S $P(^TMP($J,"PSAPV SET",PSACTRL,"IT",PSAITEM),"^",28)=$P(PSADATA,"^",14)
"RTN","PSABRKU3",103,0)
 ;Eop67
"RTN","PSABRKU3",104,0)
 Q
"RTN","PSABRKU3",105,0)
RESETST ;Reset PSACTRL
"RTN","PSABRKU3",106,0)
 S PSACTRL(1)=+PSACTRL+1,X1=PSACTRL(1)
"RTN","PSABRKU3",107,0)
 S PSACTRL=X1 I $D(^TMP($J,"PSAPV SET",PSACTRL)) G RESETST
"RTN","PSABRKU3",108,0)
 I $D(^XTMP("PSAPV",PSACTRL)) G RESETST
"RTN","PSABRKU3",109,0)
 Q
"RTN","PSABRKU5")
0^2^B2166774^B2524103
"RTN","PSABRKU5",1,0)
PSABRKU5 ;BIR/DB-Upload and Process Prime Vendor Invoice Data - CONT'D ;7/23/97
"RTN","PSABRKU5",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**26,67**; 10/24/97;Build 15
"RTN","PSABRKU5",3,0)
 ;This routine checks for correct X12 formating.
"RTN","PSABRKU5",4,0)
 ;
"RTN","PSABRKU5",5,0)
ORDER ;  check order of code sheets
"RTN","PSABRKU5",6,0)
 S PSANEXT=$P(PSADATA,"^")
"RTN","PSABRKU5",7,0)
 ;
"RTN","PSABRKU5",8,0)
 I PSALAST="GE",PSANEXT="GS" Q
"RTN","PSABRKU5",9,0)
 I PSALAST="GE",PSANEXT'="IEA" D ORDERROR("GE",PSANEXT,"IEA") Q
"RTN","PSABRKU5",10,0)
 ;
"RTN","PSABRKU5",11,0)
 I PSALAST="ISA",PSANEXT'="GS" D ORDERROR("ISA",PSANEXT,"GS") Q
"RTN","PSABRKU5",12,0)
 ;
"RTN","PSABRKU5",13,0)
 I PSALAST="SE",PSANEXT="ST" Q
"RTN","PSABRKU5",14,0)
 I PSALAST="SE",PSANEXT'="GE" D ORDERROR("SE",PSANEXT,"GE") Q
"RTN","PSABRKU5",15,0)
 ;
"RTN","PSABRKU5",16,0)
 I PSALAST="GS",PSANEXT'="ST" D ORDERROR("GS",PSANEXT,"ST") Q
"RTN","PSABRKU5",17,0)
 ;
"RTN","PSABRKU5",18,0)
 I PSALAST="CTT",PSANEXT'="SE" D ORDERROR("CTT",PSANEXT,"SE") Q
"RTN","PSABRKU5",19,0)
 ;
"RTN","PSABRKU5",20,0)
 I PSALAST="ST",PSANEXT'="BIG" D ORDERROR("ST",PSANEXT,"BIG") Q
"RTN","PSABRKU5",21,0)
 ;
"RTN","PSABRKU5",22,0)
 ;adding next two lines for new format
"RTN","PSABRKU5",23,0)
 I PSALAST="IT1",PSANEXT="PID" Q
"RTN","PSABRKU5",24,0)
 I PSALAST="PO4",PSANEXT'="IT1",PSANEXT'="CTT"&(PSANEXT'="TDS") D ORDERROR("PO4",PSANEXT,"CTT") Q
"RTN","PSABRKU5",25,0)
 ;End of PSA*3*67 Changes
"RTN","PSABRKU5",26,0)
 Q
"RTN","PSABRKU5",27,0)
 ;
"RTN","PSABRKU5",28,0)
ORDERROR(PSALAST,PSANEW,PSAEXPEC) ;Segments out of order
"RTN","PSABRKU5",29,0)
 ;ISA segment should be first
"RTN","PSABRKU5",30,0)
 I PSALAST="" S PSASEG="ORDER1" D MSG^PSABRKU8 Q
"RTN","PSABRKU5",31,0)
 ;Segments other than ISA
"RTN","PSABRKU5",32,0)
 S PSASEG="ORDER2" D MSG^PSABRKU8
"RTN","PSABRKU5",33,0)
 Q
"RTN","PSAORDP1")
0^8^B73055637^B72593730
"RTN","PSAORDP1",1,0)
PSAORDP1 ;BIR/JMB-Print Orders - CONT'D ;9/19/97
"RTN","PSAORDP1",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**3,12,21,61,65,67**; 10/24/97;Build 15
"RTN","PSAORDP1",3,0)
 ;This routine prints invoices.
"RTN","PSAORDP1",4,0)
 ;
"RTN","PSAORDP1",5,0)
 ;References to global ^DIC(51.5 are covered by IA #1931
"RTN","PSAORDP1",6,0)
 ;References to global ^PSDRUG( are covered by IA #2095
"RTN","PSAORDP1",7,0)
 ;References to global ^PSDRUG("C" are covered by IA #2095
"RTN","PSAORDP1",8,0)
 ;
"RTN","PSAORDP1",9,0)
DQ S IOM=80 D NOW^%DTC S Y=% D DD^%DT S PSARUN=$E(Y,1,18),PSAPAGE=1,$P(PSASLN,"-",80)="",$P(PSADLN,"=",80)="",(PSADJDRG,PSAOUT)=0,PSAFPG=1
"RTN","PSAORDP1",10,0)
 S PSAEND=0,PSAORDER=$P(^PSD(58.811,PSAORD,0),"^") D HEADER^PSAORDP2
"RTN","PSAORDP1",11,0)
 S PSAIN=$G(^PSD(58.811,PSAORD,1,PSAINV,0)),PSAINVN=$P(PSAIN,"^"),PSASTA=$P(PSAIN,"^",3),PSADEL=+$P(PSAIN,"^",6),PSAREC=+$P(PSAIN,"^",7)
"RTN","PSAORDP1",12,0)
START W !,"PRIME VENDOR : ",$S($P($G(^PSD(58.811,PSAORD,0)),"^",2)'="":$P($G(^(0)),"^",2),1:"UNKNOWN")
"RTN","PSAORDP1",13,0)
 W !!,"ORDER#  : "_PSAORDER,?40,"ORDER DATE   : "_$$DATE($P(PSAIN,"^",4))
"RTN","PSAORDP1",14,0)
 W !,"INVOICE#: "_PSAINVN,?40,"INVOICE DATE : "_$$DATE($P(PSAIN,"^",2))
"RTN","PSAORDP1",15,0)
 W !,"STATUS  : "_$S(PSASTA="P":"PROCESSED",PSASTA="V":"VERIFIED",PSASTA="L":"LOCKED VERIFYING",PSASTA="C":"COMPLETED",1:"UNKNOWN")_$S(+$P(PSAIN,"^",13):" (SUPPLY INVOICE)",1:"") ;;<*65 RJS>
"RTN","PSAORDP1",16,0)
 W ?40,"DELIVERY DATE: "_$S(PSADEL:$$DATE(PSADEL),1:"UNKNOWN")
"RTN","PSAORDP1",17,0)
 W !?40,"DATE RECEIVED: "_$S(PSAREC:$$DATE(PSAREC),PSADEL:$$DATE(PSADEL),1:"UNKNOWN"),!
"RTN","PSAORDP1",18,0)
 S PSADJDRG=0 S (PSAIECST,PSAAECST)=0 D LINE
"RTN","PSAORDP1",19,0)
 ;
"RTN","PSAORDP1",20,0)
EXIT ;Kills 
"RTN","PSAORDP1",21,0)
 K %,DIR,DIRUT,PSAAECST,PSACIEN,PSADATA,PSADATE,PSADEC,PSADEL,PSADJ,PSADJD,PSADJDP,PSADJDRG,PSADJSUP,PSADJDV,PSADPDT,PSADPDUZ,PSADVDT,PSADVDUZ,PSADJO,PSADJOP,PSADJOV
"RTN","PSAORDP1",22,0)
 K PSADJP,PSADJPP,PSADJPV,PSADJQ,PSADJQP,PSADJQV,PSADLN,PSADRG,PSAECOST,PSAEND,PSAFPG,PSAICOST,PSAIECST,PSAIN,PSAINVN
"RTN","PSAORDP1",23,0)
 K PSALN,PSAMORE,PSANDC,PSANODE,PSAOPDT,PSAOPDUZ,PSAORDER,PSAOU,PSAOVDT,PSAOVDUZ,PSAPAGE,PSAPPDT,PSAPPDUZ,PSAPRICE
"RTN","PSAORDP1",24,0)
 K PSAPVDT,PSAPVDUZ,PSAQPDT,PSAQPDUZ,PSAQPREA,PSAQVDT,PSAQVDUZ,PSAQVREA,PSAREC,PSARUN,PSAS,PSASLN,PSASS,PSASTA,PSATOT,Y
"RTN","PSAORDP1",25,0)
 Q
"RTN","PSAORDP1",26,0)
 ;
"RTN","PSAORDP1",27,0)
DATE(PSADATE)         ;convert date
"RTN","PSAORDP1",28,0)
 S %=$E(PSADATE,4,5)_"/"_$E(PSADATE,6,7)_"/"_$E(PSADATE,2,3)
"RTN","PSAORDP1",29,0)
 I $TR(%,"/")="" S %="UNKNOWN"
"RTN","PSAORDP1",30,0)
 Q %
"RTN","PSAORDP1",31,0)
 ;
"RTN","PSAORDP1",32,0)
LINE ;print line items
"RTN","PSAORDP1",33,0)
 D LINEHDR^PSAORDP2 S (PSAICOST,PSALN,PSATOT)=0
"RTN","PSAORDP1",34,0)
 F  S PSALN=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN)) Q:'PSALN!(PSAOUT)  D  Q:PSAOUT
"RTN","PSAORDP1",35,0)
 .Q:'$D(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,0))
"RTN","PSAORDP1",36,0)
 .S PSADATA=^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,0)
"RTN","PSAORDP1",37,0)
 .K PSADJQP,PSAQPDUZ,PSAQPDT,PSAQPREA,PSADJQV,PSAQVDUZ,PSAQVDT,PSAQVREA
"RTN","PSAORDP1",38,0)
 .K PSADJOP,PSAOPDUZ,PSAOPDT,PSADJOV,PSAOVDUZ,PSAOVDT
"RTN","PSAORDP1",39,0)
 .K PSADJPP,PSAPPDUZ,PSAPPDT,PSADJPV,PSAPVDUZ,PSAPVDT
"RTN","PSAORDP1",40,0)
 .K PSADJDP,PSADPDUZ,PSADPDT,PSADJDV,PSADVDUZ,PSADVDT
"RTN","PSAORDP1",41,0)
 .S PSADJSUP=0
"RTN","PSAORDP1",42,0)
 .I $D(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)) S PSAMORE=4 D
"RTN","PSAORDP1",43,0)
 ..S:+$P(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2),"^") PSAMORE=5
"RTN","PSAORDP1",44,0)
 ..S:+$P(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2),"^",2) PSAMORE=PSAMORE+1
"RTN","PSAORDP1",45,0)
 .E  S PSAMORE=4
"RTN","PSAORDP1",46,0)
 .I ($Y+PSAMORE)>IOSL D:$E(IOST,1,2)="C-" SCREEN^PSAORDP2 Q:PSAOUT  D HEADER^PSAORDP2,LINEHDR^PSAORDP2
"RTN","PSAORDP1",47,0)
 .W !,$P(PSADATA,"^")
"RTN","PSAORDP1",48,0)
DRUG .S PSADRG=0,PSADJ=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,"B","D",0))
"RTN","PSAORDP1",49,0)
 .I $G(PSADJ) D
"RTN","PSAORDP1",50,0)
 ..S PSANODE=$G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,PSADJ,0))
"RTN","PSAORDP1",51,0)
 ..S PSADJD=$S($P(PSANODE,"^",6)'="":$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAORDP1",52,0)
 ..I $G(PSADJD),$L(PSADJD)=$L(+PSADJD),$P($G(^PSDRUG(+PSADJD,0)),"^")'="" D  Q
"RTN","PSAORDP1",53,0)
 ...W ?8,"*"_$P($G(^PSDRUG(+PSADJD,0)),"^") S PSADJDRG=1,PSADRG=PSADJD
"RTN","PSAORDP1",54,0)
 ...I $P(PSANODE,"^",6)'="" S PSADJDV=$P(PSANODE,"^",6),PSADVDT=$P(PSANODE,"^",8),PSADVDUZ=$P(PSANODE,"^",9)
"RTN","PSAORDP1",55,0)
 ...I $P(PSANODE,"^",2)'="" S PSADJDP=$P(PSANODE,"^",2),PSADPDT=$P(PSANODE,"^",4),PSADPDUZ=$P(PSANODE,"^",5)
"RTN","PSAORDP1",56,0)
 ..I $G(PSADJD),$L(PSADJD)=$L(+PSADJD),$P($G(^PSDRUG(+PSADJD,0)),"^")="" S PSADJ=0 Q
"RTN","PSAORDP1",57,0)
 ..W ?7,"**"_PSADJD S PSADJSUP=1,PSADRG=0
"RTN","PSAORDP1",58,0)
 ..I $P(PSANODE,"^",6)'="" S PSADJDV=$P(PSANODE,"^",6),PSADVDT=$P(PSANODE,"^",8),PSADVDUZ=$P(PSANODE,"^",9)
"RTN","PSAORDP1",59,0)
 ..I $P(PSANODE,"^",2)'="" S PSADJDP=$P(PSANODE,"^",2),PSADPDT=$P(PSANODE,"^",4),PSADPDUZ=$P(PSANODE,"^",5)
"RTN","PSAORDP1",60,0)
 .I '$G(PSADJ) D
"RTN","PSAORDP1",61,0)
 ..S PSADRG=$S(+$P(PSADATA,"^",2)&($P($G(^PSDRUG(+$P(PSADATA,"^",2),0)),"^")'=""):+$P(PSADATA,"^",2),1:0)
"RTN","PSAORDP1",62,0)
 ..W ?9,$S(+$P(PSADATA,"^",2)&($P($G(^PSDRUG(+$P(PSADATA,"^",2),0)),"^")'=""):$P(^PSDRUG(+$P(PSADATA,"^",2),0),"^"),1:"DRUG UNKNOWN")
"RTN","PSAORDP1",63,0)
CS .I +$P(PSADATA,"^",10) W " (CONTROLLED SUBS)" I $P($G(^PSD(58.8,+$P(PSAIN,"^",12),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !?5,"*** INACTIVE IN MASTER VAULT ***"
"RTN","PSAORDP1",64,0)
 .E  I PSADRG,$P($G(^PSD(58.8,+$P(PSAIN,"^",5),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !?5,"*** INACTIVE IN PHARMACY LOCATION ***"
"RTN","PSAORDP1",65,0)
 .I PSADRG,$D(^PSDRUG(+PSADRG,"I")) W !?5,"*** INACTIVE IN DRUG FILE ***"
"RTN","PSAORDP1",66,0)
 .;
"RTN","PSAORDP1",67,0)
UPC .W:$P(PSADATA,"^",13)'="" !?9,"UPC: "_$P(PSADATA,"^",13)
"RTN","PSAORDP1",68,0)
NDC .S PSANDC=$P(PSADATA,"^",11)
"RTN","PSAORDP1",69,0)
 .I $E(PSANDC)'="S" D PSANDC1^PSAHELP S PSANDC=PSANDCX K PSANDCX W !?9,PSANDC
"RTN","PSAORDP1",70,0)
 .S PSASUB=$S(+$P($G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)),"^",3):+$P($G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)),"^",3),$G(PSANDC)'="":$S(+$O(^PSDRUG("C",PSANDC,+PSADRG,0)):+$O(^PSDRUG("C",PSANDC,+PSADRG,0)),1:0),1:0)
"RTN","PSAORDP1",71,0)
VSN .W ?25,$S($P(PSADATA,"^",12)'="":$P(PSADATA,"^",12),1:"VSN UNKNOWN")
"RTN","PSAORDP1",72,0)
 .;
"RTN","PSAORDP1",73,0)
QTY .;No Adj. Qty
"RTN","PSAORDP1",74,0)
 .S PSAIECST=PSAIECST+($P(PSADATA,"^",3)*$P(PSADATA,"^",5))
"RTN","PSAORDP1",75,0)
 .S PSADJP=0,PSADJ=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,"B","P",0))
"RTN","PSAORDP1",76,0)
 .I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,PSADJ,0)),PSAPRICE=$S($P(PSANODE,"^",6)'="":$P(PSANODE,"^",6),1:+$P(PSANODE,"^",2))
"RTN","PSAORDP1",77,0)
 .I '$G(PSADJ) S PSAPRICE=$P(PSADATA,"^",5)
"RTN","PSAORDP1",78,0)
 .S PSADJQ="",PSADJ=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,"B","Q",0))
"RTN","PSAORDP1",79,0)
 .I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,PSADJ,0)),PSADJQ=$S($P(PSANODE,"^",6)'="":+$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAORDP1",80,0)
 .;Adj. Qty
"RTN","PSAORDP1",81,0)
 .I $G(PSADJQ) D
"RTN","PSAORDP1",82,0)
 ..I $P(PSANODE,"^",6)'="" S PSADJQV=$P(PSANODE,"^",6),PSAQVREA=$P(PSANODE,"^",7),PSAQVDT=$P(PSANODE,"^",8),PSAQVDUZ=$P(PSANODE,"^",9)
"RTN","PSAORDP1",83,0)
 ..I $P(PSANODE,"^",2)'="" S PSADJQP=$P(PSANODE,"^",2),PSAQPREA=$P(PSANODE,"^",3),PSAQPDT=$P(PSANODE,"^",4),PSAQPDUZ=$P(PSANODE,"^",5)
"RTN","PSAORDP1",84,0)
 ..S PSAECOST=PSADJQ*PSAPRICE,PSAAECST=PSAAECST+PSAECOST
"RTN","PSAORDP1",85,0)
 ..W ?40,$S($G(PSADJQV)'="":$J(PSADJQV,6),1:$J(PSADJQP,6))_"("_$P(PSADATA,"^",3)_")"
"RTN","PSAORDP1",86,0)
 .I '$G(PSADJQ) W ?40,$J($P(PSADATA,"^",3),6) S PSAECOST=$P(PSADATA,"^",3)*PSAPRICE,PSAAECST=PSAAECST+PSAECOST
"RTN","PSAORDP1",87,0)
 .;
"RTN","PSAORDP1",88,0)
OU .;Order Unit
"RTN","PSAORDP1",89,0)
 .S PSAOU=$S(+$P(PSADATA,"^",4):$P($G(^DIC(51.5,+$P(PSADATA,"^",4),0)),"^"),+PSASUB&(+$P($G(^PSDRUG(PSADRG,1,+PSASUB,0)),"^",5)):$P($G(^DIC(51.5,+$P($G(^PSDRUG(PSADRG,1,+PSASUB,0)),"^",5),0)),"^"),1:"")
"RTN","PSAORDP1",90,0)
 .S PSADJO="",PSADJ=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,"B","O",0))
"RTN","PSAORDP1",91,0)
 .I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,PSADJ,0)),PSADJO=$S($P(PSANODE,"^",6)'="":$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAORDP1",92,0)
 .;Adj. Order Unit
"RTN","PSAORDP1",93,0)
 .I PSADJO'="" D
"RTN","PSAORDP1",94,0)
 ..I $P(PSANODE,"^",6)'="" S PSADJOV=$P(PSANODE,"^",6),PSAOVDT=$P(PSANODE,"^",8),PSAOVDUZ=$P(PSANODE,"^",9)
"RTN","PSAORDP1",95,0)
 ..I $P(PSANODE,"^",2)'="" S PSADJOP=$P(PSANODE,"^",2),PSAOPDT=$P(PSANODE,"^",4),PSAOPDUZ=$P(PSANODE,"^",5)
"RTN","PSAORDP1",96,0)
 ..W ?53,$S(+PSADJO:$P($G(^DIC(51.5,+PSADJO,0)),"^"),1:"UNKNOWN")_" ("_$S(PSAOU'="":PSAOU,1:"")_")"
"RTN","PSAORDP1",97,0)
 .I PSADJO="" W ?53,$S(PSAOU'="":PSAOU,1:"()")
"RTN","PSAORDP1",98,0)
 .;
"RTN","PSAORDP1",99,0)
PRICE .;Unit price
"RTN","PSAORDP1",100,0)
 .S PSADEC=$S($L($P($P(PSADATA,"^",5),".",2))>1:$L($P($P(PSADATA,"^",5),".",2)),1:2)
"RTN","PSAORDP1",101,0)
 .S PSADJP=0,PSADJ=+$O(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,"B","P",0))
"RTN","PSAORDP1",102,0)
 .I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,1,PSADJ,0)),PSADJP=$S(+$P(PSANODE,"^",6):+$P(PSANODE,"^",6),1:+$P(PSANODE,"^",2))
"RTN","PSAORDP1",103,0)
 .;Adj. Unit Price
"RTN","PSAORDP1",104,0)
 .I $G(PSADJP) D
"RTN","PSAORDP1",105,0)
 ..I +$P(PSANODE,"^",6) S PSADJPV=$P(PSANODE,"^",6),PSAPVDT=$P(PSANODE,"^",8),PSAPVDUZ=$P(PSANODE,"^",9)
"RTN","PSAORDP1",106,0)
 ..I +$P(PSANODE,"^",2) S PSADJPP=$P(PSANODE,"^",2),PSAPPDT=$P(PSANODE,"^",4),PSAPPDUZ=$P(PSANODE,"^",5)
"RTN","PSAORDP1",107,0)
 ..W ?60,$J(PSADJP,7,2)_" ("_$S(+$P(PSADATA,"^",5):$P(PSADATA,"^",5),$P(PSADATA,"^",5)=0:0,1:"")_")"
"RTN","PSAORDP1",108,0)
 .I '$G(PSADJP) D
"RTN","PSAORDP1",109,0)
 ..I +$P(PSADATA,"^",5)!($P(PSADATA,"^",5)=0) W ?60,$S(+$P(PSADATA,"^",5):$J($P(PSADATA,"^",5),7,PSADEC),1:0) Q
"RTN","PSAORDP1",110,0)
 ..W ?65,"(Blank)"
"RTN","PSAORDP1",111,0)
 .;
"RTN","PSAORDP1",112,0)
XCOST .;Extended cost
"RTN","PSAORDP1",113,0)
 .W:PSADJP ?67,$J(PSAECOST,7,2) W:'PSADJP ?70,$J(PSAECOST,9,2)
"RTN","PSAORDP1",114,0)
 .;
"RTN","PSAORDP1",115,0)
LEVELS .;DAVE B (PSA*3*3)
"RTN","PSAORDP1",116,0)
 .S OU=$P($G(^PSDRUG(+PSADRG,660)),"^",2) I OU'="" S OU=$P($G(^DIC(51.5,OU,0)),"^",1)
"RTN","PSAORDP1",117,0)
 .W !!,"Drug file Data - Dispense Unit: ",$P($G(^PSDRUG(+PSADRG,660)),"^",8),?40,"Order Unit : ",$G(OU)
"RTN","PSAORDP1",118,0)
 .;W !,?20," Disp. Unit: ",$P($G(^PSDRUG(+PSADRG,660)),"^",8)
"RTN","PSAORDP1",119,0)
 .W " DUOU: ",$P($G(^PSDRUG(+PSADRG,660)),"^",5)
"RTN","PSAORDP1",120,0)
 .W !,"Invoiced ",?40,"Order Unit : ",$S($P(PSADATA,"^",4)=""!($P(PSADATA,"^",4)=0):"None Sent",1:$S($P(PSADATA,"^",4)["~":"Invalid: "_$P(PSADATA,"^",4),1:$P(^DIC(51.5,$P(PSADATA,"^",4),0),"^")))
"RTN","PSAORDP1",121,0)
 .W " DUOU: ",$S(+$P($G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)),"^")'=0:$P(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2),"^"),1:"nothing changed")
"RTN","PSAORDP1",122,0)
 .K OU
"RTN","PSAORDP1",123,0)
 .W:+$P($G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)),"^",4)'=0 !?9,"STOCK LEVEL  : "_$FN(+$P(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2),"^",4),",")
"RTN","PSAORDP1",124,0)
 .W:+$P($G(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2)),"^",2)'=0 !?9,"REORDER LEVEL: "_$FN(+$P(^PSD(58.811,PSAORD,1,PSAINV,1,PSALN,2),"^",2),",")
"RTN","PSAORDP1",125,0)
 .;
"RTN","PSAORDP1",126,0)
 .;BGN 67
"RTN","PSAORDP1",127,0)
 .D DISP2^PSAP67
"RTN","PSAORDP1",128,0)
 .;END 67
"RTN","PSAORDP1",129,0)
 .I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN^PSAORDP2 Q:PSAOUT  D HEADER^PSAORDP2 D LINEHDR^PSAORDP2
"RTN","PSAORDP1",130,0)
 .D ^PSAORDP2 Q:PSAOUT
"RTN","PSAORDP1",131,0)
 .W !
"RTN","PSAORDP1",132,0)
 Q:PSAOUT
"RTN","PSAORDP1",133,0)
 I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN^PSAORDP2 Q:PSAOUT  D HEADER^PSAORDP2
"RTN","PSAORDP1",134,0)
 W !,PSASLN
"RTN","PSAORDP1",135,0)
 S PSADJSUP=$S($P($G(^PSD(58.811,PSAORD,1,PSAINV,0)),"^",13)=1:1,1:0)
"RTN","PSAORDP1",136,0)
 I $G(PSAAECST)'=$G(PSAIECST) D
"RTN","PSAORDP1",137,0)
 .W !?47,"TOTAL ADJUSTED COST",?67,$J(PSAAECST,12,2),!
"RTN","PSAORDP1",138,0)
 .I +$O(^PSD(58.811,PSAORD,1,PSAINV,2,0)) D
"RTN","PSAORDP1",139,0)
 ..S PSACIEN=0 F  S PSACIEN=+$O(^PSD(58.811,PSAORD,1,PSAINV,2,PSACIEN)) Q:'PSACIEN  D
"RTN","PSAORDP1",140,0)
 ...Q:'$D(^PSD(58.811,PSAORD,1,PSAINV,2,PSACIEN,0))
"RTN","PSAORDP1",141,0)
 ...I $Y+3>IOSL D:$E(IOST,1,2)="C-" SCREEN^PSAORDP2 Q:PSAOUT  D HEADER^PSAORDP2
"RTN","PSAORDP1",142,0)
 ...W:+$P(^PSD(58.811,PSAORD,1,PSAINV,2,PSACIEN,0),"^",3) ?55,"CREDIT MEMO "_$J($P(^(0),"^",3),12,2),!
"RTN","PSAORDP1",143,0)
 W !?47,"TOTAL INVOICED COST",?67,$J(PSAIECST,12,2)
"RTN","PSAORDP1",144,0)
 S PSAEND=1
"RTN","PSAORDP1",145,0)
 I $E(IOST)'="C" D
"RTN","PSAORDP1",146,0)
 .I PSADJDRG D:$Y+4>IOSL HEADER^PSAORDP2 W !!," * THE DRUG WAS MATCHED TO THE DRUG FILE.",!
"RTN","PSAORDP1",147,0)
 .I PSADJSUP D:$Y+4>IOSL HEADER^PSAORDP2 W !,"** THE ITEM IS A SUPPLY ITEM.",!
"RTN","PSAORDP1",148,0)
 D:$E(IOST,1,2)="C-" SCREEN^PSAORDP2
"RTN","PSAORDP1",149,0)
 W !
"RTN","PSAORDP1",150,0)
 Q
"RTN","PSAP67")
0^5^B2116360^n/a
"RTN","PSAP67",1,0)
PSAP67 ;BIR/DB - New Prime Vendor field checker ;9/19/97
"RTN","PSAP67",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**67**; 10/1/07;Build 15
"RTN","PSAP67",3,0)
DISP ;
"RTN","PSAP67",4,0)
 W !?9,"PV-Drug-Description  : ",$S($P(PSADATA,"^",28)'="":$P(PSADATA,"^",28),1:"Unknown")
"RTN","PSAP67",5,0)
 W ?65,"PV-DUOU  : ",$S($P(PSADATA,"^",31)'="":$P(PSADATA,"^",31),1:"")
"RTN","PSAP67",6,0)
 W !?9,"PV-Drug-Generic Name : ",$S($P(PSADATA,"^",29)'="":$P(PSADATA,"^",29),1:"Unknown")
"RTN","PSAP67",7,0)
 W ?65,"PV-UNITS : ",$S($P(PSADATA,"^",30)'="":$P(PSADATA,"^",30),1:"")
"RTN","PSAP67",8,0)
 Q
"RTN","PSAP67",9,0)
DISP2 ;
"RTN","PSAP67",10,0)
 S PSAP67=$G(^PSD(58.811,PSAORD,1,PSAINV,3,PSALN,0))
"RTN","PSAP67",11,0)
 W !,"PV-Drug-Description  : ",$S($P(PSAP67,"^",1)'="":$P(PSAP67,"^",1),1:"Unknown")
"RTN","PSAP67",12,0)
 W ?55,"PV-DUOU  : ",$S($P(PSAP67,"^",4)'="":$P(PSAP67,"^",4),1:"Unknown")
"RTN","PSAP67",13,0)
 W !,"PV-Drug-Generic Name : ",$S($P(PSAP67,"^",2)'="":$P(PSAP67,"^",2),1:"Unknown")
"RTN","PSAP67",14,0)
 W ?55,"PV-UNITS : ",$S($P(PSAP67,"^",3)'="":$P(PSAP67,"^",3),1:"Unknown"),!
"RTN","PSAP67",15,0)
 K PSAP67 Q
"RTN","PSAPROC7")
0^6^B56573649^B51722446
"RTN","PSAPROC7",1,0)
PSAPROC7 ;BIR/JMB-Process Uploaded Prime Vendor Invoice Data - CONT'D ;9/6/97
"RTN","PSAPROC7",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**3,12,27,21,42,61,64,67**; 10/24/97;Build 15
"RTN","PSAPROC7",3,0)
 ;This routine takes the data in XTMP and moves it to DA ORDERS file.
"RTN","PSAPROC7",4,0)
 ;It deletes the data in XTMP after it is copies.
"RTN","PSAPROC7",5,0)
 ;
"RTN","PSAPROC7",6,0)
 ;References to ^PSDRUG( are covered by IA #2095
"RTN","PSAPROC7",7,0)
INVOICE ;PSA*3*21 (3JAN01) - FILE INVOICE IMMEDIATELY
"RTN","PSAPROC7",8,0)
 ;
"RTN","PSAPROC7",9,0)
 S PSAIN=$G(^XTMP("PSAPV",PSACTRL,"IN")) Q:PSAIN=""
"RTN","PSAPROC7",10,0)
 Q:$P(PSAIN,"^",8)'="P"
"RTN","PSAPROC7",11,0)
 S PSAORD=$P(PSAIN,"^",4),PSAIEN=+$O(^PSD(58.811,"B",PSAORD,0)),PSACRED=0
"RTN","PSAPROC7",12,0)
 I 'PSAIEN D
"RTN","PSAPROC7",13,0)
 .F  L +^PSD(58.811,0):$S($G(DILOCKTM)>0:DILOCKTM,1:3) I  Q
"RTN","PSAPROC7",14,0)
 .;(PSA*3*24 - Dave B. Jun 2 00 - Improper DIC call)
"RTN","PSAPROC7",15,0)
 .;(PSA*3*61 - add N DO. DICN will use DO if defined, we do not want to use it since DIC is defined.
"RTN","PSAPROC7",16,0)
 .N DO S DIC="^PSD(58.811,",DIC(0)="L",X=PSAORD D FILE^DICN K DIC L -^PSD(58.811,0) S PSAIEN=+Y
"RTN","PSAPROC7",17,0)
 F  L +^PSD(58.811,PSAIEN,0):10 I  Q
"RTN","PSAPROC7",18,0)
 S:'$D(^PSD(58.811,PSAIEN,1,0)) DIC("P")=$P(^DD(58.811,2,0),"^",2)
"RTN","PSAPROC7",19,0)
 S DA(1)=PSAIEN,DIC="^PSD(58.811,"_DA(1)_",1,",DIC(0)="L",X=$P(PSAIN,"^",2),DLAYGO=58.811 D ^DIC K DA,DLAYGO S PSAIEN1=+Y
"RTN","PSAPROC7",20,0)
 S DA(1)=PSAIEN,DA=PSAIEN1,DIE=DIC K DIC
"RTN","PSAPROC7",21,0)
 S PSALOCDR=$P($G(PSAIN),"^",7)
"RTN","PSAPROC7",22,0)
 S PSADELDR=$P($G(PSAIN),"^",6)
"RTN","PSAPROC7",23,0)
 S PSACSDR=$S($P(PSAIN,"^",10)="ALL CS":"A",$P(PSAIN,"^",9)="CS":"S",1:"N")
"RTN","PSAPROC7",24,0)
 S PSARECD=$P($G(PSAIN),"^",11)
"RTN","PSAPROC7",25,0)
 S PSAMV=$S(+$P(PSAIN,"^",12):$P(PSAIN,"^",12),1:"")
"RTN","PSAPROC7",26,0)
 S PSASUP=$S($P(PSAIN,"^",13)="SUP":1,1:"")
"RTN","PSAPROC7",27,0)
 ;DAVE B ( PSA*3*12) Invalid Concatenation of zero node
"RTN","PSAPROC7",28,0)
 S ^PSD(58.811,DA(1),1,DA,0)=$P(^(0),"^")_"^"_$P(PSAIN,"^",1)_"^P^"_$P(PSAIN,"^",3)_"^"_$G(PSALOCDR)_"^"_$G(PSADELDR)_"^"_$G(PSARECD)_"^"_$G(PSACSDR)_"^^"_DUZ_"^^"_$G(PSAMV)_"^"_$G(PSASUP)
"RTN","PSAPROC7",29,0)
 S DIK=DIE D IX^DIK
"RTN","PSAPROC7",30,0)
 K ^TMP($J,"PSADIF"),PSADIFLC ;*42 pre verify storage for  OU, DUOU, Cost, NDC changes
"RTN","PSAPROC7",31,0)
 S PSALINE=0 F  S PSALINE=$O(^XTMP("PSAPV",PSACTRL,"IT",PSALINE)) Q:PSALINE=""  D LINE
"RTN","PSAPROC7",32,0)
 D SCANDIF,MM ;*42 look for differences to drug file SEND EMAIL
"RTN","PSAPROC7",33,0)
 I PSACRED K DA S DA(1)=PSAIEN,DA=PSAIEN1,DIE="^PSD(58.811,"_DA(1)_",1,",DR="10///^S X=1" D ^DIE K DIE
"RTN","PSAPROC7",34,0)
 S $P(^PSD(58.811,PSAIEN,0),"^",2)=$P($G(^XTMP("PSAPV",PSACTRL,"DS")),"^")
"RTN","PSAPROC7",35,0)
 L -^PSD(58.811,PSAIEN,0)
"RTN","PSAPROC7",36,0)
 K ^XTMP("PSAPV",PSACTRL)
"RTN","PSAPROC7",37,0)
 Q
"RTN","PSAPROC7",38,0)
 ;
"RTN","PSAPROC7",39,0)
LINE ;Files line items.
"RTN","PSAPROC7",40,0)
 S PSADATA=^XTMP("PSAPV",PSACTRL,"IT",PSALINE) S:'$D(^PSD(58.811,PSAIEN,1,PSAIEN1,1,0)) DIC("P")=$P(^DD(58.8112,5,0),"^",2)
"RTN","PSAPROC7",41,0)
 ;PSA*3*31 Dave B - Check for invoice already in file
"RTN","PSAPROC7",42,0)
 S DA(2)=PSAIEN,DA(1)=PSAIEN1,(DA,X)=PSALINE,DIC="^PSD(58.811,"_DA(2)_",1,"_DA(1)_",1,",DIC(0)="L",DLAYGO=58.811 D ^DIC S PSAIEN2=+Y K DA,DIC,DLAYGO
"RTN","PSAPROC7",43,0)
 ;
"RTN","PSAPROC7",44,0)
 ;DAVEB PSA*3*3 (5may98)
"RTN","PSAPROC7",45,0)
 S PSADRG=$P($G(PSADATA),"^",6)
"RTN","PSAPROC7",46,0)
 S PSASYN=$P($G(PSADATA),"^",7)
"RTN","PSAPROC7",47,0)
 K PSAUNIT
"RTN","PSAPROC7",48,0)
 I $G(PSASYN)'="",$G(PSADRG)'="" S PSAUNIT=+$P($G(^PSDRUG(PSADRG,1,PSASYN,0)),"^",5)
"RTN","PSAPROC7",49,0)
 ;
"RTN","PSAPROC7",50,0)
 ;DAVE B (PSA*3*12) Assignment of order unit didn't take into 
"RTN","PSAPROC7",51,0)
 ;account the adjusted order unit.
"RTN","PSAPROC7",52,0)
 S PSAUNIT=$S($D(PSAUNIT):PSAUNIT,$P(PSADATA,"^",12)'="":$P(PSADATA,"^",12),+$P($P(PSADATA,"^",2),"~",2):+$P($P(PSADATA,"^",2),"~",2),1:0)
"RTN","PSAPROC7",53,0)
 S PSACS=$S($P(PSADATA,"^",19)="CS":1,1:0),PSANDC=$P($P(PSADATA,"^",4),"~"),PSAVSN=$P($P(PSADATA,"^",5),"~"),PSAUPC=$P($P(PSADATA,"^",26),"~")
"RTN","PSAPROC7",54,0)
 I PSANDC="",$P($P(PSADATA,"^",26),"~")'="" S PSANDC="S"_$P($P(PSADATA,"^",26),"~")
"RTN","PSAPROC7",55,0)
 S DA(2)=PSAIEN,DA(1)=PSAIEN1,DA=$S($D(PSAIEN2):PSAIEN2,1:PSALINE),DIE="^PSD(58.811,"_DA(2)_",1,"_DA(1)_",1,"
"RTN","PSAPROC7",56,0)
 ;DaveB (4may98) hard code filing data
"RTN","PSAPROC7",57,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",3)=+PSADATA
"RTN","PSAPROC7",58,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",11)=PSANDC
"RTN","PSAPROC7",59,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",12)=PSAVSN
"RTN","PSAPROC7",60,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",13)=PSAUPC
"RTN","PSAPROC7",61,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",10)=PSACS
"RTN","PSAPROC7",62,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",2)=PSADRG
"RTN","PSAPROC7",63,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",4)=PSAUNIT
"RTN","PSAPROC7",64,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",5)=$P(PSADATA,"^",3)
"RTN","PSAPROC7",65,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",6)=DT
"RTN","PSAPROC7",66,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),1,DA,0),"^",7)=DUZ
"RTN","PSAPROC7",67,0)
 ;BGN 67
"RTN","PSAPROC7",68,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),3,DA,0),"^",1)=$P(PSADATA,"^",28)
"RTN","PSAPROC7",69,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),3,DA,0),"^",2)=$P(PSADATA,"^",29)
"RTN","PSAPROC7",70,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),3,DA,0),"^",3)=$P(PSADATA,"^",30)
"RTN","PSAPROC7",71,0)
 S $P(^PSD(58.811,DA(2),1,DA(1),3,DA,0),"^",4)=$P(PSADATA,"^",31)
"RTN","PSAPROC7",72,0)
 ;END 67
"RTN","PSAPROC7",73,0)
 S DIK=DIE D IX^DIK
"RTN","PSAPROC7",74,0)
 ;End PSA*3*7
"RTN","PSAPROC7",75,0)
 ;
"RTN","PSAPROC7",76,0)
 I +$P(PSADATA,"^",15)!($D(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP"))) D ADJDRUG
"RTN","PSAPROC7",77,0)
 I $P(PSADATA,"^",8)'="" D QTY
"RTN","PSAPROC7",78,0)
 I +$P(PSADATA,"^",12) D OU
"RTN","PSAPROC7",79,0)
 I +$P(PSADATA,"^",23) D PRICE
"RTN","PSAPROC7",80,0)
 ;Adds the reorder level and/or dispense units per order unit
"RTN","PSAPROC7",81,0)
 I +$P(PSADATA,"^",7)!(+$P(PSADATA,"^",20))!(+$P(PSADATA,"^",21))!(+$P(PSADATA,"^",27)) D
"RTN","PSAPROC7",82,0)
 .S ^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSAIEN2,2)=$P(PSADATA,"^",20)_"^"_$P(PSADATA,"^",21)_"^"_$S(+$P(PSADATA,"^",7):+$P(PSADATA,"^",7),1:0)_"^"_+$P(PSADATA,"^",27)
"RTN","PSAPROC7",83,0)
 ;Bgn 67
"RTN","PSAPROC7",84,0)
 I $P(PSADATA,"^",5)'="" S ^XTMP("PSAVSN",$P(PSADATA,"^",5))=$P(PSADATA,"^",28)_"^"_$P(PSADATA,"^",29)_"^"_$P(PSADATA,"^",30)_"^"_$P(PSADATA,"^",31)
"RTN","PSAPROC7",85,0)
 ;End 67
"RTN","PSAPROC7",86,0)
 K ^XTMP("PSAPV",PSACTRL,"IT",PSALINE)
"RTN","PSAPROC7",87,0)
 Q
"RTN","PSAPROC7",88,0)
ADJDRUG ;Records adjusted drug received
"RTN","PSAPROC7",89,0)
 S PSAFLD="D"
"RTN","PSAPROC7",90,0)
 I +$P(PSADATA,"^",15) S PSADJ=+$P(PSADATA,"^",15),PSADUZ=+$P(PSADATA,"^",16),PSADT=+$P(PSADATA,"^",17),PSAREA="" D RECORD Q
"RTN","PSAPROC7",91,0)
 I $D(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP")) S PSASNODE=^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP"),PSADJ=$P(PSASNODE,"^",3),PSADUZ=+$P(PSASNODE,"^"),PSADT=+$P(PSASNODE,"^",2),PSAREA="" D RECORD
"RTN","PSAPROC7",92,0)
 Q
"RTN","PSAPROC7",93,0)
OU ;Records adjusted order unit
"RTN","PSAPROC7",94,0)
 S PSAFLD="O",PSADJ=+$P(PSADATA,"^",12),PSADUZ=+$P(PSADATA,"^",13),PSADT=+$P(PSADATA,"^",14),PSAREA=""
"RTN","PSAPROC7",95,0)
 D RECORD
"RTN","PSAPROC7",96,0)
 Q
"RTN","PSAPROC7",97,0)
PRICE ;Records adjusted price per order unit
"RTN","PSAPROC7",98,0)
 S PSAFLD="P",PSADJ=+$P(PSADATA,"^",23),PSADUZ=+$P(PSADATA,"^",24),PSADT=+$P(PSADATA,"^",25),PSAREA=""
"RTN","PSAPROC7",99,0)
 S:PSADJ'=+$P(PSADATA,"^",3) PSACRED=1
"RTN","PSAPROC7",100,0)
 D RECORD
"RTN","PSAPROC7",101,0)
 Q
"RTN","PSAPROC7",102,0)
QTY ;Records adjusted quantity received.
"RTN","PSAPROC7",103,0)
 S PSAFLD="Q",PSADJ=+$P(PSADATA,"^",8),PSADUZ=+$P(PSADATA,"^",9),PSADT=+$P(PSADATA,"^",10),PSAREA=$P(PSADATA,"^",11)
"RTN","PSAPROC7",104,0)
 S:PSADJ'=+$P(PSADATA,"^") PSACRED=1
"RTN","PSAPROC7",105,0)
 D RECORD
"RTN","PSAPROC7",106,0)
 Q
"RTN","PSAPROC7",107,0)
RECORD ;Adds adjusted data to DA ORDERS file
"RTN","PSAPROC7",108,0)
 K DA S DA(3)=PSAIEN,DA(2)=PSAIEN1,DA(1)=PSAIEN2,X=PSAFLD
"RTN","PSAPROC7",109,0)
 S:'$D(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSAIEN2,1,0)) DIC("P")=$P(^DD(58.81125,9,0),"^",2)
"RTN","PSAPROC7",110,0)
 ;PSA*3*27 (DAVE B) removed killing of DA variable on next line
"RTN","PSAPROC7",111,0)
 S DIC="^PSD(58.811,"_DA(3)_",1,"_DA(2)_",1,"_DA(1)_",1,",DIC(0)="L",DLAYGO=58.811 D ^DIC S PSAIEN3=+Y K DLAYGO
"RTN","PSAPROC7",112,0)
 ;
"RTN","PSAPROC7",113,0)
 ;PSA*3*3
"RTN","PSAPROC7",114,0)
 ;DAVEB Hard code filing
"RTN","PSAPROC7",115,0)
 S DIE=DIC,DA=PSAIEN3
"RTN","PSAPROC7",116,0)
 S $P(^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,DA,0),"^",2)=PSADJ
"RTN","PSAPROC7",117,0)
 S $P(^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,DA,0),"^",3)=$G(PSAREA)
"RTN","PSAPROC7",118,0)
 S $P(^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,DA,0),"^",4)=DT
"RTN","PSAPROC7",119,0)
 S $P(^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,DA,0),"^",5)=DUZ
"RTN","PSAPROC7",120,0)
 ;
"RTN","PSAPROC7",121,0)
 ;S DIE=DIC,DA=PSAIEN3,DR="1///"_PSADJ_$S(PSAREA'="":";2////^S X=PSAREA",1:"")_";3///^S X="_PSADT_";4///^S X="_PSADUZ K DIC D ^DIE
"RTN","PSAPROC7",122,0)
 S DIK=DIE,DA=PSAIEN3 D IX1^DIK K DA,DIE,DIK,PSAFLD
"RTN","PSAPROC7",123,0)
 Q
"RTN","PSAPROC7",124,0)
 ;*42 CHANGES
"RTN","PSAPROC7",125,0)
SCANDIF ; inspect invoice for noted differences in OU,DUOU,PPDU,NDC
"RTN","PSAPROC7",126,0)
 ;NEEDS PSAIEN, PSAIEN1
"RTN","PSAPROC7",127,0)
 K ^TMP($J,"PSADIF"),PSADIFLC
"RTN","PSAPROC7",128,0)
 S PSALINE=0 F  S PSALINE=$O(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE)) Q:PSALINE'>0  D CHECK
"RTN","PSAPROC7",129,0)
 Q
"RTN","PSAPROC7",130,0)
MM ;
"RTN","PSAPROC7",131,0)
 I $D(^TMP($J,"PSADIF")) D MESSAGE
"RTN","PSAPROC7",132,0)
 Q
"RTN","PSAPROC7",133,0)
CHECK ;Check line item for differences to drug file *42
"RTN","PSAPROC7",134,0)
 N ITM,ITMI,DRG,DRIEN,DIF,ZZ,XX,XXX,PCNT,PDIF,T,IENS
"RTN","PSAPROC7",135,0)
 ; use new API call to retrieve item fields see PSAUTL6
"RTN","PSAPROC7",136,0)
 D ITEM^PSAUTL6(PSAIEN,PSAIEN1,PSALINE,.ITM)
"RTN","PSAPROC7",137,0)
 D ITEM^PSAUTL6(PSAIEN,PSAIEN1,PSALINE,.ITMI,"I")
"RTN","PSAPROC7",138,0)
 I ITM(2)'>0 Q  ;zero quantity will not be filed
"RTN","PSAPROC7",139,0)
 S ITM("OU")=ITM(3),ITM("DUOU")=ITM(10),ITM("NDC")=ITM(13),ITM("PPOU")=ITM(4),ITM("PPDU")=$J(ITM("PPOU")/ITM("DUOU"),1,4)
"RTN","PSAPROC7",140,0)
 S DRIEN=+ITMI(1)
"RTN","PSAPROC7",141,0)
 S DRG("OU")=$$GET1^DIQ(50,DRIEN,12),DRG("DUOU")=$$GET1^DIQ(50,DRIEN,15),DRG("NDC")=$$GET1^DIQ(50,DRIEN,31),DRG("PPDU")=$$GET1^DIQ(50,DRIEN,16)
"RTN","PSAPROC7",142,0)
 K DIF
"RTN","PSAPROC7",143,0)
 F XX="OU","DUOU","NDC" I ITM(XX)'=DRG(XX) S DIF(XX)=""
"RTN","PSAPROC7",144,0)
 I ITM("PPDU")'=DRG("PPDU") S PCNT=.05*DRG("PPDU"),PDIF=DRG("PPDU")-ITM("PPDU") S:PDIF<0 PDIF=-1*PDIF S:PDIF>PCNT DIF("PPDU")=""
"RTN","PSAPROC7",145,0)
 I $D(DIF) D
"RTN","PSAPROC7",146,0)
 . F ZZ=" ",$J(ITM(.01),3)_"   "_ITM(1) D SET
"RTN","PSAPROC7",147,0)
 . S XXX="" F  S XXX=$O(DIF(XXX)) Q:XXX=""  D
"RTN","PSAPROC7",148,0)
 .. S ZZ="  ",T=XXX,ZZ=$$SETSTR^VALM1(T,ZZ,4,$L(T))
"RTN","PSAPROC7",149,0)
 .. S T="Old: "_DRG(XXX),ZZ=$$SETSTR^VALM1(T,ZZ,13,$L(T))
"RTN","PSAPROC7",150,0)
 .. S T="New: "_ITM(XXX),ZZ=$$SETSTR^VALM1(T,ZZ,36,$L(T))
"RTN","PSAPROC7",151,0)
 .. D SET
"RTN","PSAPROC7",152,0)
 Q
"RTN","PSAPROC7",153,0)
SET ;set differences into ^TMP
"RTN","PSAPROC7",154,0)
 S:'$G(PSADIFLC) PSADIFLC=3
"RTN","PSAPROC7",155,0)
 S ^TMP($J,"PSADIF",PSADIFLC,0)=ZZ,PSADIFLC=PSADIFLC+1
"RTN","PSAPROC7",156,0)
 Q
"RTN","PSAPROC7",157,0)
MESSAGE ;differences found, notify user and send message to g.PSA NDC UPDATES.
"RTN","PSAPROC7",158,0)
 K DIR N IENS
"RTN","PSAPROC7",159,0)
 S PSAORD=$$GET1^DIQ(58.811,PSAIEN,.01),IENS=PSAIEN1_","_PSAIEN
"RTN","PSAPROC7",160,0)
 S PSAINV=$$GET1^DIQ(58.8112,IENS,.01)
"RTN","PSAPROC7",161,0)
 S XMSUB="PRE Verify "_PSAORD_" : "_PSAINV_" Variance Report"
"RTN","PSAPROC7",162,0)
 S ^TMP($J,"PSADIF",1,0)=XMSUB,^TMP($J,"PSADIF",2,0)=" "
"RTN","PSAPROC7",163,0)
 W !,XMSUB,!
"RTN","PSAPROC7",164,0)
 W !,"Noted differences between the invoice line items and the drug file have",!,"been found. A mail message is being sent to G.PSA NDC UPDATES."
"RTN","PSAPROC7",165,0)
 W !!,"    Please check the message for accuracy.",!
"RTN","PSAPROC7",166,0)
 K DIR S DIR(0)="E",DIR("A")="<cr> - continue" D ^DIR
"RTN","PSAPROC7",167,0)
 K DIR
"RTN","PSAPROC7",168,0)
 S XMTEXT="^TMP($J,""PSADIF"",",XMY("G.PSA NDC UPDATES")=""
"RTN","PSAPROC7",169,0)
 D ^XMD
"RTN","PSAPROC7",170,0)
 K PSADIFLC,^TMP($J,"PSADIF")
"RTN","PSAPROC7",171,0)
 Q
"RTN","PSAUP4")
0^7^B72871098^B72473581
"RTN","PSAUP4",1,0)
PSAUP4 ;BIR/JMB-Upload and Process Prime Vendor Invoice Data - CONT'D ;9/19/97
"RTN","PSAUP4",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**3,12,20,21,67**; 10/24/97;Build 15
"RTN","PSAUP4",3,0)
 ;This routine prints invoices from the ^XTMP global on the screen or
"RTN","PSAUP4",4,0)
 ;to a printer.
"RTN","PSAUP4",5,0)
 ;
"RTN","PSAUP4",6,0)
 ;References to ^PSDRUG( are covered by IA #2095
"RTN","PSAUP4",7,0)
 ;References to ^DIC(51.5( are covered by IA #1931
"RTN","PSAUP4",8,0)
 ;
"RTN","PSAUP4",9,0)
 W !!,"Enter the device which will be used to print",!,"the invoices with all items, errors, and adjustments.",!
"RTN","PSAUP4",10,0)
 S %ZIS="Q" D ^%ZIS I POP S PSAOUT=1 Q
"RTN","PSAUP4",11,0)
 I $D(IO("Q")) S ZTDESC="Drug Acct. - Prime Vendor Invoice Upload Report",ZTRTN="DQ^PSAUP4" D ^%ZTLOAD Q
"RTN","PSAUP4",12,0)
 ;
"RTN","PSAUP4",13,0)
DQ ;queue starts here
"RTN","PSAUP4",14,0)
 S IOM=80
"RTN","PSAUP4",15,0)
 D NOW^%DTC S Y=% D DD^%DT S PSARUN=$E(Y,1,18),$P(PSASLN,"-",80)="",$P(PSADLN,"=",80)="",(PSADJDRG,PSADJSUP,PSAOUT)=0,PSAFPG=1
"RTN","PSAUP4",16,0)
 U IO
"RTN","PSAUP4",17,0)
 S PSACTRL=0 F  S PSACTRL=$O(^XTMP("PSAPV",PSACTRL)) Q:PSACTRL=""!(PSAOUT)  D START
"RTN","PSAUP4",18,0)
 W @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" K IO("Q")
"RTN","PSAUP4",19,0)
 ;
"RTN","PSAUP4",20,0)
EXIT ;Kills printing variables only
"RTN","PSAUP4",21,0)
 K %,%ZIS,DIR,DIRUT,PSAAECST,PSABY,PSACS,PSACTRL,PSADATA,PSADATE,PSADEC,PSADRG,PSADJDRG,PSADJORD,PSADJQTY,PSADJSUP,PSADLN,PSADS,PSAECOST,PSAEND,PSAFPG,PSAICOST,PSAIECST
"RTN","PSAUP4",22,0)
 K PSAIN,PSALINE,PSANDC,PSAODT,PSAODUZ,PSAOREA,PSAOUT,PSAPAGE,PSAPHARM,PSAQDT,PSAQDUZ,PSAQREA,PSAMV,PSARUN,PSAS,PSASLN,PSASS,PSAST,PSASTA,PSATOT,Y,ZTDESC,ZTRTN,ZTSK
"RTN","PSAUP4",23,0)
 Q
"RTN","PSAUP4",24,0)
 ;
"RTN","PSAUP4",25,0)
START S PSAPAGE=1,PSAEND=0 D HEADER S PSAIN=$G(^XTMP("PSAPV",PSACTRL,"IN"))
"RTN","PSAUP4",26,0)
 S (PSADJDRG,PSADJSUP,PSAIECST,PSAAECST)=0,PSAPHARM=$P(PSAIN,"^",7),PSAMV=$P(PSAIN,"^",12)
"RTN","PSAUP4",27,0)
 W !,"PRIME VENDOR : ",$S($P($G(^XTMP("PSAPV",PSACTRL,"DS")),"^")'="":$P($G(^("DS")),"^"),1:"UNKNOWN")
"RTN","PSAUP4",28,0)
 W !!,"ORDER#  : "_$P(PSAIN,"^",4),?40,"ORDER DATE  : "_$$DATE($P(PSAIN,"^",3))
"RTN","PSAUP4",29,0)
 W !,"INVOICE#: "_$P(PSAIN,"^",2),?40,"INVOICE DATE: "_$$DATE(+PSAIN)
"RTN","PSAUP4",30,0)
 S PSASTA=$P(PSAIN,"^",8)
"RTN","PSAUP4",31,0)
 W !,"STATUS  : "_$S(PSASTA="":"UPLOADED WITH ERRORS",PSASTA="OK":"UPLOADED WITHOUT ERRORS",PSASTA="P":"PROCESSED",1:"UNKNOWN")_$S($P(PSAIN,"^",13)="SUP":" (SUPPLY INVOICE)",1:"")
"RTN","PSAUP4",32,0)
 I $Y+8>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER
"RTN","PSAUP4",33,0)
 I $E(IOST,1,2)="C-" D LINE Q
"RTN","PSAUP4",34,0)
 W !!,"DELIVERY DATE REQUESTED: ",$$DATE($P(PSAIN,"^",5))
"RTN","PSAUP4",35,0)
 W !,"DATE RECEIVED          : "_$S(+$P(PSAIN,"^",11)&($$DATE(+$P(PSAIN,"^",11))):" ("_$$DATE($P(PSAIN,"^",6))_")",1:$$DATE($P(PSAIN,"^",6)))
"RTN","PSAUP4",36,0)
 I $Y+8>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:$G(PSAOUT)  D HEADER
"RTN","PSAUP4",37,0)
 ;
"RTN","PSAUP4",38,0)
BUYSHIP W !!,"BUYER INFORMATION:",?40,"SHIPPING INFORMATION:"
"RTN","PSAUP4",39,0)
 S PSABY=$G(^XTMP("PSAPV",PSACTRL,"BY"))
"RTN","PSAUP4",40,0)
 S PSAST=$G(^XTMP("PSAPV",PSACTRL,"ST"))
"RTN","PSAUP4",41,0)
 W !?2,$P(PSABY,"^"),?42,$P(PSAST,"^")
"RTN","PSAUP4",42,0)
 I $P(PSABY,"^",2)'=""!($P(PSAST,"^",2)'="") W ! W:$P(PSABY,"^",2)'="" ?2,$P(PSABY,"^",2) W:$P(PSAST,"^",2)'="" ?42,$P(PSAST,"^",2)
"RTN","PSAUP4",43,0)
 I $P(PSABY,"^",3)'=""!($P(PSAST,"^",3)'="") W ! W:$P(PSABY,"^",3)'="" ?2,$P(PSABY,"^",3) W:$P(PSAST,"^",3)'="" ?42,$P(PSAST,"^",3)
"RTN","PSAUP4",44,0)
 W !?2,$P(PSABY,"^",4)_" "_$P(PSABY,"^",5)_"  ",$P(PSABY,"^",6)
"RTN","PSAUP4",45,0)
 W ?42,$P(PSAST,"^",4)_" "_$P(PSAST,"^",5)_"  ",$P(PSAST,"^",6)
"RTN","PSAUP4",46,0)
 I $Y+8>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER
"RTN","PSAUP4",47,0)
 ;
"RTN","PSAUP4",48,0)
DISTRIB W !!,"DISTRIBUTOR INFORMATION:"
"RTN","PSAUP4",49,0)
 S PSADS=$G(^XTMP("PSAPV",PSACTRL,"DS"))
"RTN","PSAUP4",50,0)
 W !?2,$P(PSADS,"^")
"RTN","PSAUP4",51,0)
 W:$P(PSADS,"^",2)'="" !?2,$P(PSADS,"^",2)
"RTN","PSAUP4",52,0)
 W:$P(PSADS,"^",3)'="" !?2,$P(PSADS,"^",3)
"RTN","PSAUP4",53,0)
 W !?2,$P(PSADS,"^",4)_" "_$P(PSADS,"^",5)_"  ",$P(PSADS,"^",6)
"RTN","PSAUP4",54,0)
 I $Y+8>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER
"RTN","PSAUP4",55,0)
 D LINE
"RTN","PSAUP4",56,0)
 Q
"RTN","PSAUP4",57,0)
 ;
"RTN","PSAUP4",58,0)
DATE(PSADATE)         ;convert date
"RTN","PSAUP4",59,0)
 S %=$E(PSADATE,4,5)_"/"_$E(PSADATE,6,7)_"/"_$E(PSADATE,2,3)
"RTN","PSAUP4",60,0)
 I $TR(%,"/")="" S %="UNKNOWN"
"RTN","PSAUP4",61,0)
 Q %
"RTN","PSAUP4",62,0)
 ;
"RTN","PSAUP4",63,0)
LINE ;print line items
"RTN","PSAUP4",64,0)
 D LINEHDR
"RTN","PSAUP4",65,0)
 S (PSAICOST,PSALINE,PSATOT)=0 F  S PSALINE=$O(^XTMP("PSAPV",PSACTRL,"IT",PSALINE)) Q:'PSALINE!(PSAOUT)  S PSADATA=^(PSALINE),PSADRG=0 D  Q:PSAOUT
"RTN","PSAUP4",66,0)
 .I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER,LINEHDR
"RTN","PSAUP4",67,0)
 .K PSADJQTY,PSAQDUZ,PSAQDT,PSAQREA,PSADJORD,PSAODUZ,PSAODT,PSAOREA
"RTN","PSAUP4",68,0)
 .W !,PSALINE
"RTN","PSAUP4",69,0)
DRUG .;Drug
"RTN","PSAUP4",70,0)
 .I +$P(PSADATA,"^",15) S PSADRG=+$P(PSADATA,"^",15) W ?8,"*"_$P($G(^PSDRUG(+$P(PSADATA,"^",15),0)),"^")_$S(+$P(PSADATA,"^",6)&($P($G(^PSDRUG(+$P(PSADATA,"^",6),0)),"^")'=""):" ("_$P(^PSDRUG(+$P(PSADATA,"^",6),0),"^")_")",1:"") S PSADJDRG=1
"RTN","PSAUP4",71,0)
 .I PSADRG,$D(^PSDRUG(PSADRG,"I")) W !,?5,"** INACTIVE IN DRUG FILE **"
"RTN","PSAUP4",72,0)
 .I '+$P(PSADATA,"^",15) D
"RTN","PSAUP4",73,0)
 ..I +$P(PSADATA,"^",6),$P($G(^PSDRUG(+$P(PSADATA,"^",6),0)),"^")'="" W ?9,$P(^PSDRUG(+$P(PSADATA,"^",6),0),"^") S PSADRG=+$P(PSADATA,"^",6) Q
"RTN","PSAUP4",74,0)
 ..I $P($G(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP")),"^",3)'="" W ?7,"**"_$P(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP"),"^",3)  S PSADJSUP=1,PSADRG=0 Q
"RTN","PSAUP4",75,0)
 ..W ?9,"DRUG UNKNOWN"
"RTN","PSAUP4",76,0)
 .I $P(PSADATA,"^",19)="CS" W " (CONTROLLED SUBS)" I $P($G(^PSD(58.8,+$P(PSAIN,"^",12),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT  W !?5,"*** INACTIVE IN MASTER VAULT"
"RTN","PSAUP4",77,0)
 .E  I PSADRG,$P($G(^PSD(58.8,+$P(PSAIN,"^",7),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !?5,"*** INACTIVE IN PHARMACY LOCATION"
"RTN","PSAUP4",78,0)
 .;UPC
"RTN","PSAUP4",79,0)
 .I $P($P(PSADATA,"^",26),"~")'="" W !?9,"UPC: "_$P($P(PSADATA,"^",26),"~")
"RTN","PSAUP4",80,0)
 .;NDC
"RTN","PSAUP4",81,0)
 .S PSANDC=$P($P(PSADATA,"^",4),"~")
"RTN","PSAUP4",82,0)
 .I $E(PSANDC)'="S" D
"RTN","PSAUP4",83,0)
 ..W !?9 D PSANDC1^PSAHELP S PSANDC=PSANDCX
"RTN","PSAUP4",84,0)
 ..I PSANDC'="" W PSANDC Q
"RTN","PSAUP4",85,0)
 ..W "NDC UNKNOWN"
"RTN","PSAUP4",86,0)
 .;
"RTN","PSAUP4",87,0)
 .;VSN
"RTN","PSAUP4",88,0)
 .W ?25,$S($P($P(PSADATA,"^",5),"~")'="":$E($P($P(PSADATA,"^",5),"~"),1,14),1:"VSN UNKNOWN")
"RTN","PSAUP4",89,0)
 .;
"RTN","PSAUP4",90,0)
 .;QTY
"RTN","PSAUP4",91,0)
 .;No Adjusted Qty
"RTN","PSAUP4",92,0)
 .S PSAIECST=PSAIECST+($P(PSADATA,"^")*$P(PSADATA,"^",3))
"RTN","PSAUP4",93,0)
 .I $P(PSADATA,"^",8)="" W ?40,$J($P(PSADATA,"^"),6) S PSAECOST=$P(PSADATA,"^")*$P(PSADATA,"^",3),PSAAECST=PSAAECST+PSAECOST
"RTN","PSAUP4",94,0)
 .;Adj. Qty (P)
"RTN","PSAUP4",95,0)
 .I $P(PSADATA,"^",8)'="" D
"RTN","PSAUP4",96,0)
 ..S PSADJQTY=$P(PSADATA,"^",8),PSAQDUZ=$P(PSADATA,"^",9),PSAQDT=$P(PSADATA,"^",10),PSAQREA=$P(PSADATA,"^",11)
"RTN","PSAUP4",97,0)
 ..S PSAECOST=PSADJQTY*$P(PSADATA,"^",3),PSAAECST=PSAAECST+PSAECOST
"RTN","PSAUP4",98,0)
 ..W ?40,$J($P(PSADATA,"^",8),6)_"("_$P(PSADATA,"^")_")"
"RTN","PSAUP4",99,0)
 .;
"RTN","PSAUP4",100,0)
OU .;Order Unit
"RTN","PSAUP4",101,0)
 .I '+$P(PSADATA,"^",12) D
"RTN","PSAUP4",102,0)
 ..I +$P($P(PSADATA,"^",2),"~",2),$P($G(^DIC(51.5,+$P($P(PSADATA,"^",2),"~",2),0)),"^")'="" W ?53,$P($G(^DIC(51.5,+$P($P(PSADATA,"^",2),"~",2),0)),"^") Q
"RTN","PSAUP4",103,0)
 ..I $P($G(PSADATA),"^",2)'="",$P($G(PSADATA),"^",2)'["~",'$D(^DIC(51.5,"B",$P(PSADATA,"^",2))) W ?48," ?-> "_$P(PSADATA,"^",2)
"RTN","PSAUP4",104,0)
 ..I $P($P(PSADATA,"^",2),"~")="" D ^PSAHELP
"RTN","PSAUP4",105,0)
 .;Adj. OU (P)
"RTN","PSAUP4",106,0)
 .I +$P(PSADATA,"^",12) S PSADJORD=$P(PSADATA,"^",12),PSAODUZ=$P(PSADATA,"^",13),PSAODT=$P(PSADATA,"^",14) W ?53,$P($G(^DIC(51.5,+$P(PSADATA,"^",12),0)),"^")_"("_$P($P(PSADATA,"^",2),"~")_")"
"RTN","PSAUP4",107,0)
 .;Unit price
"RTN","PSAUP4",108,0)
 .S PSADEC=$S($L($P($P(PSADATA,"^",3),".",2))>1:$L($P($P(PSADATA,"^",3),".",2)),1:2)
"RTN","PSAUP4",109,0)
 .W ?59,$J($P(PSADATA,"^",3),7,PSADEC)
"RTN","PSAUP4",110,0)
 .;Extended cost
"RTN","PSAUP4",111,0)
 .W ?67,$J(PSAECOST,12,2)
"RTN","PSAUP4",112,0)
 .I $Y+9>IOSL,+$P(PSADATA,"^",21),+$P(PSADATA,"^",27) D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER,LINEHDR
"RTN","PSAUP4",113,0)
 .I $G(PSADRG) D HAVEDRG
"RTN","PSAUP4",114,0)
 .I '$G(PSADRG) W !?9,"STOCK LEVEL  : ",!?9,"REORDER LEVEL: "_$P(PSADATA,"^",21),!?9,"DISPENSE UNITS/ORDER UNIT: " D DISP^PSAP67
"RTN","PSAUP4",115,0)
 .;
"RTN","PSAUP4",116,0)
 .;Print Adj Qty
"RTN","PSAUP4",117,0)
 .I $G(PSADJQTY)'="" D
"RTN","PSAUP4",118,0)
 ..I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER,LINEHDR
"RTN","PSAUP4",119,0)
 ..W !!?9,"ADJUSTED QUANTITY: "_PSADJQTY,!?9,$$DATE(PSAQDT)_" "_$P($G(^VA(200,+PSAQDUZ,0)),"^"),!?11,PSAQREA
"RTN","PSAUP4",120,0)
 .;Print Adj OU
"RTN","PSAUP4",121,0)
 .I +$G(PSADJORD) D
"RTN","PSAUP4",122,0)
 ..I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER,LINEHDR
"RTN","PSAUP4",123,0)
 ..W !!,?9,"ADJUSTED ORDER UNIT: "_$P($G(^DIC(51.5,+PSADJORD,0)),"^")
"RTN","PSAUP4",124,0)
 ..W !?9,$$DATE(PSAODT)_" "_$P($G(^VA(200,+PSAODUZ,0)),"^")_" - "_$P($G(^DIC(51.5,PSADJORD,0)),"^")
"RTN","PSAUP4",125,0)
 .W !
"RTN","PSAUP4",126,0)
 Q:PSAOUT
"RTN","PSAUP4",127,0)
 I $Y+6>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER
"RTN","PSAUP4",128,0)
 W !,PSASLN
"RTN","PSAUP4",129,0)
 W:$G(PSAAECST)'=$G(PSAIECST) !?48,"TOTAL ADUSTED COST",?67,$J(PSAAECST,12,2),!
"RTN","PSAUP4",130,0)
 W !?48,"TOTAL INVOICED COST",?67,$J(PSAIECST,12,2)
"RTN","PSAUP4",131,0)
 S PSAEND=1
"RTN","PSAUP4",132,0)
 I $Y+5>IOSL D:$E(IOST,1,2)="C-" SCREEN Q:PSAOUT  D HEADER
"RTN","PSAUP4",133,0)
 I PSADJDRG,$E(IOST)'="C" W !!,"* THE DRUG WAS MATCHED TO THE DRUG FILE."
"RTN","PSAUP4",134,0)
 I PSADJSUP,$E(IOST)'="C" W !!,"* THE ITEM IS A SUPPLY ITEM."
"RTN","PSAUP4",135,0)
 D:$E(IOST,1,2)="C-" SCREEN
"RTN","PSAUP4",136,0)
 Q
"RTN","PSAUP4",137,0)
 ;
"RTN","PSAUP4",138,0)
LINEHDR ;item header
"RTN","PSAUP4",139,0)
 W !?50,"ORDER",?62,"COST/",?71,"EXTENDED"
"RTN","PSAUP4",140,0)
 W !,"LINE#",?9,"NDC",?25,"VSN",?43,"QTY",?51,"UNIT",?62,"UNIT",?75,"COST",!,PSADLN,!
"RTN","PSAUP4",141,0)
 Q
"RTN","PSAUP4",142,0)
 ;
"RTN","PSAUP4",143,0)
HEADER ;Page header
"RTN","PSAUP4",144,0)
 I PSAFPG&($E(IOST,1,2)="C-") W @IOF G HDR1
"RTN","PSAUP4",145,0)
 S PSAFPG=0
"RTN","PSAUP4",146,0)
 W:'PSAFPG @IOF
"RTN","PSAUP4",147,0)
HDR1 W !?20,"DRUG ACCOUNTABILITY/INVENTORY INTERFACE"
"RTN","PSAUP4",148,0)
 W !?26,"PRIME VENDOR UPLOAD REPORT",!
"RTN","PSAUP4",149,0)
 W:PSAPAGE'=1 !,"ORDER#: "_$P(PSAIN,"^",4)_"  INVOICE#: "_$P(PSAIN,"^",2)
"RTN","PSAUP4",150,0)
 I $E(IOST,1,2)="C-" W ?(74-$L(PSAPAGE)),"PAGE "_PSAPAGE,!,PSADLN
"RTN","PSAUP4",151,0)
 I $E(IOST)'="C" W !,"RUN: "_PSARUN,?(74-$L(PSAPAGE)),"PAGE "_PSAPAGE,!,PSADLN
"RTN","PSAUP4",152,0)
 S PSAPAGE=PSAPAGE+1
"RTN","PSAUP4",153,0)
 Q
"RTN","PSAUP4",154,0)
SCREEN ;Hold on screen
"RTN","PSAUP4",155,0)
 S PSAS=20-$Y I PSAS F PSASS=1:1:PSAS W !
"RTN","PSAUP4",156,0)
 I PSADJDRG,PSAEND W !," * THE DRUG WAS MATCHED TO THE DRUG FILE."
"RTN","PSAUP4",157,0)
 I PSADJSUP,PSAEND W !,"** THE ITEM IS A SUPPLY ITEM."
"RTN","PSAUP4",158,0)
 S DIR(0)="E" D ^DIR K DIR I $G(DIRUT) S PSAOUT=1
"RTN","PSAUP4",159,0)
 Q
"RTN","PSAUP4",160,0)
 ;
"RTN","PSAUP4",161,0)
HAVEDRG ;Display data if drug is found.
"RTN","PSAUP4",162,0)
 ;DAVE B (PSA*3*20) 7SEP99 ADDED $G TO NEXT LINE
"RTN","PSAUP4",163,0)
 S PSACS=$S($P($G(^PSDRUG(PSADRG,2)),"^",3)["N":1,1:0)
"RTN","PSAUP4",164,0)
 I PSACS D
"RTN","PSAUP4",165,0)
 .I PSAMV,+$P($G(^PSD(58.8,PSAMV,0)),"^",14) D  Q
"RTN","PSAUP4",166,0)
 ..W !?9,"STOCK LEVEL  : "_$S(+$P(PSADATA,"^",27):+$P(PSADATA,"^",27),1:+$P($G(^PSD(58.8,PSAMV,1,PSADRG,0)),"^",3))
"RTN","PSAUP4",167,0)
 ..W !?9,"REORDER LEVEL: "_$S(+$P(PSADATA,"^",21):+$P(PSADATA,"^",21),1:+$P($G(^PSD(58.8,PSAMV,1,PSADRG,0)),"^",5))
"RTN","PSAUP4",168,0)
 .I 'PSAMV W !?9,"STOCK LEVEL  : "_$P(PSADATA,"^",27),!?9,"REORDER LEVEL: "_$P(PSADATA,"^",21)
"RTN","PSAUP4",169,0)
 I 'PSACS D
"RTN","PSAUP4",170,0)
 .I PSAPHARM,+$P($G(^PSD(58.8,PSAPHARM,0)),"^",14) D
"RTN","PSAUP4",171,0)
 ..W !?9,"STOCK LEVEL  : "_$S(+$P(PSADATA,"^",27):+$P(PSADATA,"^",27),1:+$P($G(^PSD(58.8,PSAPHARM,1,PSADRG,0)),"^",3))
"RTN","PSAUP4",172,0)
 ..W !?9,"REORDER LEVEL: "_$S(+$P(PSADATA,"^",21):+$P(PSADATA,"^",21),1:+$P($G(^PSD(58.8,PSAPHARM,1,PSADRG,0)),"^",5))
"RTN","PSAUP4",173,0)
 .I 'PSAPHARM W !?9,"STOCK LEVEL  : "_$P(PSADATA,"^",27),!?9,"REORDER LEVEL: "_$P(PSADATA,"^",21)
"RTN","PSAUP4",174,0)
 W !?9,"DISPENSE UNITS/ORDER UNIT: "
"RTN","PSAUP4",175,0)
 W $S(+$P(PSADATA,"^",20):+$P(PSADATA,"^",20),+$P($G(^PSDRUG(PSADRG,1,+$P(PSADATA,"^",7),0)),"^",7):+$P($G(^PSDRUG(PSADRG,1,+$P(PSADATA,"^",7),0)),"^",7),1:"")
"RTN","PSAUP4",176,0)
 D DISP^PSAP67
"RTN","PSAUP4",177,0)
 Q
"RTN","PSAUTL1")
0^3^B58704156^B58194382
"RTN","PSAUTL1",1,0)
PSAUTL1 ;BIR/JMB-Prime Vendor Invoice Data Utility ;9/19/97
"RTN","PSAUTL1",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**3,12,15,21,48,49,54,67**; 10/24/97;Build 15
"RTN","PSAUTL1",3,0)
 ;This routine contains utilities to get the location name, display an
"RTN","PSAUTL1",4,0)
 ;error-free item, display an item with errors, and display a line ready
"RTN","PSAUTL1",5,0)
 ;for verification.
"RTN","PSAUTL1",6,0)
 ;References to global ^PS(59.4, are covered under IA #2505
"RTN","PSAUTL1",7,0)
 ;References to global ^DIC(51.5, are covered under IA #1931
"RTN","PSAUTL1",8,0)
 ;References to global ^PS(59, are covered under IA #212
"RTN","PSAUTL1",9,0)
 ;References to ^PSDRUG( are covered by IA #2095
"RTN","PSAUTL1",10,0)
 ;
"RTN","PSAUTL1",11,0)
SITES ;Gets the combined IP/OP's IP & OP site names
"RTN","PSAUTL1",12,0)
 ;PSA*3*22 (DAVE B) no location defined
"RTN","PSAUTL1",13,0)
 I $G(PSALOC)'>0 S (PSAISITN,PSAOSITN)="Unknown",PSACOMB=" No location identified" Q
"RTN","PSAUTL1",14,0)
 ;End PSA*3*22
"RTN","PSAUTL1",15,0)
 S PSAISIT=+$P($G(^PSD(58.8,PSALOC,0)),"^",3) D OPSITE
"RTN","PSAUTL1",16,0)
 I $G(PSAOSIT)="" S PSAOSIT=0
"RTN","PSAUTL1",17,0)
 S PSAISITN=$S($P($G(^PS(59.4,PSAISIT,0)),"^")'="":$P($G(^PS(59.4,PSAISIT,0)),"^"),1:"UNKNOWN")
"RTN","PSAUTL1",18,0)
 I PSAISIT,PSAOSIT S PSACOMB=": "_PSAISITN_" (IP) "_PSAOSITN_" (OP)" Q
"RTN","PSAUTL1",19,0)
 I PSAISIT S PSACOMB=": "_PSAISITN_" (IP)" Q
"RTN","PSAUTL1",20,0)
 I PSAOSIT S PSACOMB=": "_PSAOSITN_" (OP)" Q
"RTN","PSAUTL1",21,0)
 ;DAVE B (PSA*3*12) no DA sites defined
"RTN","PSAUTL1",22,0)
 S PSACOMB="No Inpatient or Outpatient Sites defined"
"RTN","PSAUTL1",23,0)
 Q
"RTN","PSAUTL1",24,0)
OPSITE ;PSA*3*25 - check for multiple OP sites
"RTN","PSAUTL1",25,0)
 ;VMP OIFO BAY PINES;ELR;PSA*3*49  ADDED THE FOLLOWING LINE
"RTN","PSAUTL1",26,0)
 S (PSAOSIT,PSAOSITN)=""
"RTN","PSAUTL1",27,0)
 K PSAOSITC
"RTN","PSAUTL1",28,0)
 Q:'$D(PSALOC)
"RTN","PSAUTL1",29,0)
 I '$D(^PSD(58.8,+PSALOC,7)),$P(^PSD(58.8,+PSALOC,0),"^",10)'="" S PSAOSIT=$P(^PSD(58.8,+PSALOC,0),"^",10),PSAOSITN=$P($G(^PS(59,PSAOSIT,0)),"^"),PSAOSITN=$S($G(PSAOSITN)="":"Unknown",1:PSAOSITN)
"RTN","PSAUTL1",30,0)
 S XX=0 F  S XX=$O(^PSD(58.8,+PSALOC,7,XX)) Q:XX'>0  S PSAOSIT=XX,PSAOSITC=$G(PSAOSITC)+1,SN=$P($G(^PS(59,XX,0)),"^") D
"RTN","PSAUTL1",31,0)
 .I PSAOSITC=1 S PSAOSITN=SN Q
"RTN","PSAUTL1",32,0)
 .S PSAOSITN=PSAOSITN_" & "_SN
"RTN","PSAUTL1",33,0)
 I $G(PSAOSITN)="",$P(^PSD(58.8,+PSALOC,0),"^",10)'="" S PSAOSIT=$P(^PSD(58.8,+PSALOC,0),"^",10),PSAOSITN=$P($G(^PS(59,+PSAOSIT,0)),"^")
"RTN","PSAUTL1",34,0)
 S PSAOSITN=$S($G(PSAOSITN)="":"unknown",1:PSAOSITN)
"RTN","PSAUTL1",35,0)
 Q
"RTN","PSAUTL1",36,0)
 ;
"RTN","PSAUTL1",37,0)
DISPLAY ;Displays an error-free line item
"RTN","PSAUTL1",38,0)
 S PSADISP=1
"RTN","PSAUTL1",39,0)
 S PSAIEN=$P(PSADATA,"^",6),PSASUB=$P($P(PSADATA,"^",7),"~"),PSANDC=$P($P(PSADATA,"^",4),"~"),PSAVSN=$P($P(PSADATA,"^",5),"~")
"RTN","PSAUTL1",40,0)
 W !,PSALINE_"  "_$S($P($G(^PSDRUG(PSAIEN,0)),"^")'="":$P(^PSDRUG(PSAIEN,0),"^"),1:"UNKNOWN")
"RTN","PSAUTL1",41,0)
 I PSAIEN D
"RTN","PSAUTL1",42,0)
 .I $P($G(^PSDRUG(PSAIEN,2)),"^",3)["N" W " (Controlled Substance)" I $P($G(^PSD(58.8,+$P(PSAIN,"^",12),1,PSAIEN,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN MASTER VAULT **" Q
"RTN","PSAUTL1",43,0)
 .I $P($G(^PSD(58.8,+$P(PSAIN,"^",7),1,PSAIEN,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN PHARMACY LOCATION **"
"RTN","PSAUTL1",44,0)
 .I $D(^PSDRUG(PSAIEN,"I")) W !?5,"** INACTIVE IN DRUG FILE **"
"RTN","PSAUTL1",45,0)
 W !,"Qty Invoiced: "_+$P(PSADATA,"^")
"RTN","PSAUTL1",46,0)
 W:$P($P(PSADATA,"^",26),"~")'="" ?38,"UPC: "_$P($P(PSADATA,"^",26),"~")
"RTN","PSAUTL1",47,0)
 W !,"Order Unit  : "
"RTN","PSAUTL1",48,0)
 S PSAOU=$S(+$P(PSADATA,"^",12):+$P(PSADATA,"^",12),+$P($P(PSADATA,"^",2),"~",2):+$P($P(PSADATA,"^",2),"~",2),PSAIEN&(PSASUB)&(+$P($G(^PSDRUG(PSAIEN,1,PSASUB,0)),"^",5)):+$P(^PSDRUG(PSAIEN,1,PSASUB,0),"^",5),1:0)
"RTN","PSAUTL1",49,0)
 W $S(PSAOU:$P($G(^DIC(51.5,+PSAOU,0)),"^"),1:"UNKNOWN")
"RTN","PSAUTL1",50,0)
 W:$E(PSANDC)'="S" ?38,"NDC: " D PSANDC1^PSAHELP W PSANDCX K PSANDCX
"RTN","PSAUTL1",51,0)
 W !,"Unit Price  : $"_$P(PSADATA,"^",3),?38,"VSN: "_$S(PSAVSN'="":PSAVSN,1:"Blank"),!
"RTN","PSAUTL1",52,0)
 I $P(PSADATA,U,13)=.5 D  ;*48 AUTO OU UPDATE FOR MCKESSON
"RTN","PSAUTL1",53,0)
 .W !,"*****>",!,"Note: The order unit was changed from EACH to ",$P($G(^DIC(51.5,+PSAOU,0)),"^")," by Drug Accountability"
"RTN","PSAUTL1",54,0)
 .W !,"      during the upload of the invoiced data. Adjustments may be necessary.",!,"*****<"
"RTN","PSAUTL1",55,0)
 ;bgn *67
"RTN","PSAUTL1",56,0)
 W !,"PV-Drug-Description  : ",$S($P(PSADATA,"^",28)'="":$P(PSADATA,"^",28),1:"Unknown")
"RTN","PSAUTL1",57,0)
 W ?55,"PV-DUOU  : ",$S($P(PSADATA,"^",31)'="":$P(PSADATA,"^",31),1:"Unknown")
"RTN","PSAUTL1",58,0)
 W !,"PV-Drug-Generic Name : ",$S($P(PSADATA,"^",29)'="":$P(PSADATA,"^",29),1:"Unknown")
"RTN","PSAUTL1",59,0)
 W ?55,"PV-UNITS : ",$S($P(PSADATA,"^",30)'="":$P(PSADATA,"^",30),1:"Unknown"),!
"RTN","PSAUTL1",60,0)
 ;end *67
"RTN","PSAUTL1",61,0)
 W !,"Dispense Units: "_$S(+PSAIEN&($P($G(^PSDRUG(+PSAIEN,660)),"^",8)'=""):$P($G(^PSDRUG(+PSAIEN,660)),"^",8),1:"Blank")
"RTN","PSAUTL1",62,0)
 W !,"Dispense Units Per Order Unit: "_$S($P(PSADATA,"^",20):+$P(PSADATA,"^",20),+PSASUB&(+$P($G(^PSDRUG(+PSAIEN,1,PSASUB,0)),"^",7)):+$P($G(^PSDRUG(+PSAIEN,1,PSASUB,0)),"^",7),1:"Blank")
"RTN","PSAUTL1",63,0)
 S PSALOC=$S($P(PSADATA,"^",19)="":+$P(PSAIN,"^",7),1:+$P(PSAIN,"^",12))
"RTN","PSAUTL1",64,0)
 Q:'+$P($G(^PSD(58.8,+PSALOC,0)),"^",14)!('$G(PSAIEN))
"RTN","PSAUTL1",65,0)
 S PSASTOCK=$S(+$P(PSADATA,"^",27):+$P(PSADATA,"^",27),+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",3):+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",3),1:"Blank")
"RTN","PSAUTL1",66,0)
 W !,"Stock Level   : "_PSASTOCK
"RTN","PSAUTL1",67,0)
 S PSAREORD=$S(+$P(PSADATA,"^",21):+$P(PSADATA,"^",21),+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",5):+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",5),1:"Blank") ;*48
"RTN","PSAUTL1",68,0)
 W !,"Reorder Level : "_PSAREORD,!
"RTN","PSAUTL1",69,0)
 Q
"RTN","PSAUTL1",70,0)
 ;
"RTN","PSAUTL1",71,0)
EDITDISP ;Displays a line item with errors.
"RTN","PSAUTL1",72,0)
 W @IOF,!?23,"<<< PROCESS LINE ITEM SCREEN >>>",!,"Order#: "_$P(PSAIN,"^",4)_"  Invoice#: "_$P(PSAIN,"^",2)_"  Invoice Date: "_$$FMTE^XLFDT(+PSAIN),!,PSASLN
"RTN","PSAUTL1",73,0)
EDIT1 S PSADATA=$G(^XTMP("PSAPV",PSACTRL,"IT",PSALINE))
"RTN","PSAUTL1",74,0)
 S PSASUB=+$P(PSADATA,"^",7) ;*54
"RTN","PSAUTL1",75,0)
 S PSAIEN=+$P(PSADATA,"^",15) I PSAIEN ;*54
"RTN","PSAUTL1",76,0)
 E  S PSAIEN=+$P(PSADATA,"^",6) ;*54
"RTN","PSAUTL1",77,0)
 S PSALOC=$S($P(PSADATA,"^",19)="":+$P(PSAIN,"^",7),1:+$P(PSAIN,"^",12))
"RTN","PSAUTL1",78,0)
 W !,PSALINE_"  "_$S($D(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP")):$P(^XTMP("PSAPV",PSACTRL,"IT",PSALINE,"SUP"),"^",3),PSAIEN&($P($G(^PSDRUG(PSAIEN,0)),"^")'=""):$P(^PSDRUG(PSAIEN,0),"^"),1:"UNKNOWN ITEM")
"RTN","PSAUTL1",79,0)
 I PSAIEN D
"RTN","PSAUTL1",80,0)
 .I $P($G(^PSDRUG(PSAIEN,2)),"^",3)["N" W " (Controlled Substance)" I $P($G(^PSD(58.8,+$P(PSAIN,"^",12),1,PSAIEN,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN MASTER VAULT **" Q
"RTN","PSAUTL1",81,0)
 .I $P($G(^PSD(58.8,+$P(PSAIN,"^",7),1,PSAIEN,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN PHARMACY LOCATION **"
"RTN","PSAUTL1",82,0)
 ;
"RTN","PSAUTL1",83,0)
 W !,"Qty Invoiced: "
"RTN","PSAUTL1",84,0)
 I $P(PSADATA,"^",8)'="" W $P(PSADATA,"^",8)_" ("_$S(+PSADATA:+PSADATA,$P(PSADATA,"^")=0:0,1:"Blank")_")"
"RTN","PSAUTL1",85,0)
 I $P(PSADATA,"^",8)="" W $S(+PSADATA:+PSADATA,$P(PSADATA,"^")=0:0,1:"Blank")
"RTN","PSAUTL1",86,0)
 W:$P($P(PSADATA,"^",26),"~")'="" ?38,"UPC: "_$P($P(PSADATA,"^",26),"~")
"RTN","PSAUTL1",87,0)
 ;
"RTN","PSAUTL1",88,0)
 W !,"Order Unit  : "
"RTN","PSAUTL1",89,0)
 I +$P(PSADATA,"^",12) D
"RTN","PSAUTL1",90,0)
 .W $P($G(^DIC(51.5,+$P(PSADATA,"^",12),0)),"^")
"RTN","PSAUTL1",91,0)
 .W " ("_$S($P($P(PSADATA,"^",2),"~")'="":$P($P(PSADATA,"^",2),"~"),$P($G(^DIC(51.5,+$P($P(PSADATA,"^",2),"~",3),0)),"^")'="":$P($G(^DIC(51.5,+$P($P(PSADATA,"^",2),"~",3),0)),"^"),1:"Blank")_")"
"RTN","PSAUTL1",92,0)
 I '+$P(PSADATA,"^",12) D
"RTN","PSAUTL1",93,0)
 .W $S(+$P($P(PSADATA,"^",2),"~",2):$P($P(PSADATA,"^",2),"~"),PSAIEN&(PSASUB)&(+$P($G(^PSDRUG(PSAIEN,1,PSASUB,0)),"^",5)):$P($G(^DIC(51.5,+$P(^PSDRUG(PSAIEN,1,PSASUB,0),"^",5),0)),"^"),1:"Blank")
"RTN","PSAUTL1",94,0)
 ;
"RTN","PSAUTL1",95,0)
 W:$E(PSANDC)'="S" ?38,"NDC: " D PSANDC1^PSAHELP W PSANDCX K PSANDCX
"RTN","PSAUTL1",96,0)
 S PSAPRICE=$P(PSADATA,"^",3)
"RTN","PSAUTL1",97,0)
 I +PSAPRICE,$L($P(PSAPRICE,".",2))<2 S PSAPRICE=$P(PSAPRICE,".")_"."_$P(PSAPRICE,".",2)_$E("00",1,(2-$L($P(PSAPRICE,".",2))))
"RTN","PSAUTL1",98,0)
 W !,"Unit Price  : $"_$S($G(PSAPRICE):PSAPRICE,PSAPRICE=0:0,1:"Blank"),?38,"VSN: "_$S(PSAVSN'="":PSAVSN,1:"Blank"),!
"RTN","PSAUTL1",99,0)
 I $P(PSADATA,U,13)=.5 D  ;*48 AUTO OU UPDATE FOR MCKESSON
"RTN","PSAUTL1",100,0)
 .N PSAOU S PSAOU=$P(PSADATA,U,12)
"RTN","PSAUTL1",101,0)
 .W !,"*****>",!,"Note: The order unit was changed from EACH to ",$P($G(^DIC(51.5,+PSAOU,0)),"^")," by Drug Accountability"
"RTN","PSAUTL1",102,0)
 .W !,"      during the upload of the invoiced data. Adjustments may be necessary.",!,"*****<"
"RTN","PSAUTL1",103,0)
 ;bgn *67
"RTN","PSAUTL1",104,0)
 W !,"PV-Drug-Description  : ",$S($P(PSADATA,"^",28)'="":$P(PSADATA,"^",28),1:"Unknown")
"RTN","PSAUTL1",105,0)
 W ?55,"PV-DUOU  : ",$S($P(PSADATA,"^",31)'="":$P(PSADATA,"^",31),1:"Unknown")
"RTN","PSAUTL1",106,0)
 W !,"PV-Drug-Generic Name : ",$S($P(PSADATA,"^",29)'="":$P(PSADATA,"^",29),1:"Unknown")
"RTN","PSAUTL1",107,0)
 W ?55,"PV-UNITS : ",$S($P(PSADATA,"^",30)'="":$P(PSADATA,"^",30),1:"Unknown"),!
"RTN","PSAUTL1",108,0)
 ;end *67
"RTN","PSAUTL1",109,0)
 S PSAIN=^XTMP("PSAPV",PSACTRL,"IN"),PSALOC=$S($P(PSADATA,"^",19)="CS":+$P(PSAIN,"^",12),1:+$P(PSAIN,"^",7))
"RTN","PSAUTL1",110,0)
DU W !,"Dispense Units: "_$S(+PSAIEN&($P($G(^PSDRUG(+PSAIEN,660)),"^",8)'=""):$P($G(^PSDRUG(+PSAIEN,660)),"^",8),1:"Blank")
"RTN","PSAUTL1",111,0)
DUOU W !,"Dispense Units Per Order Unit: "_$S($P(PSADATA,"^",20):+$P(PSADATA,"^",20),+PSASUB&(+$P($G(^PSDRUG(+PSAIEN,1,PSASUB,0)),"^",7)):+$P($G(^PSDRUG(+PSAIEN,1,PSASUB,0)),"^",7),1:"Blank"),!
"RTN","PSAUTL1",112,0)
 ;
"RTN","PSAUTL1",113,0)
 Q:'+$P($G(^PSD(58.8,+PSALOC,0)),"^",14)
"RTN","PSAUTL1",114,0)
 ;
"RTN","PSAUTL1",115,0)
 S PSASTOCK=$S(+$P(PSADATA,"^",27):+$P(PSADATA,"^",27),+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",3):+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",3),1:"Blank")
"RTN","PSAUTL1",116,0)
 W "Stock Level   : "_PSASTOCK
"RTN","PSAUTL1",117,0)
 S PSAREORD=$S(+$P(PSADATA,"^",21):+$P(PSADATA,"^",21),+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",5):+$P($G(^PSD(58.8,+PSALOC,1,+PSAIEN,0)),"^",5),1:"Blank")
"RTN","PSAUTL1",118,0)
 W !,"Reorder Level : "_PSAREORD,!
"RTN","PSAUTL1",119,0)
 Q
"RTN","PSAUTL4")
0^4^B27358372^B26805479
"RTN","PSAUTL4",1,0)
PSAUTL4 ;BIR ISC/JMB-Verify Invoices Utility ; 8/19/97
"RTN","PSAUTL4",2,0)
 ;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**3,21,48,54,61,67**; 10/24/97;Build 15
"RTN","PSAUTL4",3,0)
 ;
"RTN","PSAUTL4",4,0)
 ;References to ^DIC(51.5 are covered by IA #1931
"RTN","PSAUTL4",5,0)
 ;References to ^PSDRUG( are covered by IA #2095
"RTN","PSAUTL4",6,0)
 I $G(PSADICW)=1 S PSALINE=Y
"RTN","PSAUTL4",7,0)
 ;This routine contains a utility to display a line item ready for
"RTN","PSAUTL4",8,0)
 ;verification. It is called by PSAVER1 and PSAVER2.
"RTN","PSAUTL4",9,0)
 ;
"RTN","PSAUTL4",10,0)
VERDISP ;Displays a line item on a processed or verified invoice
"RTN","PSAUTL4",11,0)
 W PSALINEN_"  "
"RTN","PSAUTL4",12,0)
DRUG S PSADJ=+$O(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,"B","D",0))
"RTN","PSAUTL4",13,0)
 I $G(PSADJ) D
"RTN","PSAUTL4",14,0)
 .S PSANODE=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,PSADJ,0))
"RTN","PSAUTL4",15,0)
 .S PSADJD=$S($P(PSANODE,"^",6)'="":$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAUTL4",16,0)
 .I PSADJD'?1.N S PSASUP=1
"RTN","PSAUTL4",17,0)
 .S PSADRG=$S(PSADJ&('PSASUP):$G(PSADJD),PSADJ&(PSASUP):0,1:+$P(PSADATA,"^",2))
"RTN","PSAUTL4",18,0)
 .I $G(PSADJD),$L(PSADJD)=$L(+PSADJD),$P($G(^PSDRUG(+PSADJD,0)),"^")'="" W "*"_$P($G(^PSDRUG(+PSADJD,0)),"^") S (PSADRG,PSA50IEN)=+PSADJD Q
"RTN","PSAUTL4",19,0)
 .I $G(PSADJD),$L(PSADJD)=$L(+PSADJD),$P($G(^PSDRUG(+PSADJD,0)),"^")="" S (PSADJ,PSADRG)=0 Q
"RTN","PSAUTL4",20,0)
 .W ?7,"**"_PSADJD S PSADJSUP=1,(PSADRG,PSA50IEN)=PSADJD
"RTN","PSAUTL4",21,0)
 I '$G(PSADJ) D
"RTN","PSAUTL4",22,0)
 .S (PSA50IEN,PSADRG)=$S(+$P(PSADATA,"^",2)&($P($G(^PSDRUG(+$P(PSADATA,"^",2),0)),"^")'=""):+$P(PSADATA,"^",2),1:0)
"RTN","PSAUTL4",23,0)
 .W $S(+$P(PSADATA,"^",2)&($P($G(^PSDRUG(+$P(PSADATA,"^",2),0)),"^")'=""):$P(^PSDRUG(+$P(PSADATA,"^",2),0),"^"),1:"DRUG UNKNOWN")
"RTN","PSAUTL4",24,0)
 I PSADRG D
"RTN","PSAUTL4",25,0)
 .I $P($G(^PSDRUG(PSADRG,2)),"^",3)["N" W " (Controlled Substance)" I $P($G(^PSD(58.8,+$P(PSAIN,"^",12),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN MASTER VAULT **"
"RTN","PSAUTL4",26,0)
 .I $D(^PSDRUG(PSADRG,"I")) W !?5,"** INACTIVE IN DRUG FILE **" Q
"RTN","PSAUTL4",27,0)
 .I $P($G(^PSD(58.8,+$P(PSAIN,"^",5),1,PSADRG,0)),"^",14),$P($G(^(0)),"^",14)'>DT W !,$C(7),$C(7),"** INACTIVE IN PHARMACY LOCATION **"
"RTN","PSAUTL4",28,0)
QTY W !,"Qty Invoiced: "
"RTN","PSAUTL4",29,0)
 ;No Adj. Qty
"RTN","PSAUTL4",30,0)
 S PSADJQ="",PSADJ=+$O(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,"B","Q",0))
"RTN","PSAUTL4",31,0)
 I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,PSADJ,0)),PSADJQ=$S($P(PSANODE,"^",6)'="":+$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAUTL4",32,0)
 ;Adj. Qty
"RTN","PSAUTL4",33,0)
 I $G(PSADJQ) S PSAQTY=PSADJQ W PSAQTY_" ("_$S($P(PSADATA,"^",3):$P(PSADATA,"^",3),$P(PSADATA,"^",3)=0:0,1:"Blank")_")"
"RTN","PSAUTL4",34,0)
 I '$G(PSADJQ) W $P(PSADATA,"^",3) S PSAQTY=$P(PSADATA,"^",3)
"RTN","PSAUTL4",35,0)
UPC S PSAUPC=$P(PSADATA,U,13) W:PSAUPC'="" ?38,"UPC: "_PSAUPC
"RTN","PSAUTL4",36,0)
OU W !,"Order Unit  : "
"RTN","PSAUTL4",37,0)
 S PSAOU=$S(+$P(PSADATA,"^",4)&($P($G(^DIC(51.5,+$P(PSADATA,"^",4),0)),"^")'=""):+$P(PSADATA,"^",4),1:"")
"RTN","PSAUTL4",38,0)
 S PSATEMP=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,2))
"RTN","PSAUTL4",39,0)
 I +$P(PSATEMP,"^",3),PSADRG,+$P($G(^PSDRUG(PSADRG,1,+$P(PSATEMP,"^",3),0)),"^",5) S PSAOU=+$P(^PSDRUG(PSADRG,1,+$P(PSATEMP,"^",3),0),"^",5)
"RTN","PSAUTL4",40,0)
 S PSADJO="",PSADJ=+$O(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,"B","O",0))
"RTN","PSAUTL4",41,0)
 I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,PSADJ,0)),PSADJO=$S($P(PSANODE,"^",6)'="":$P(PSANODE,"^",6),1:$P(PSANODE,"^",2))
"RTN","PSAUTL4",42,0)
 ;Adj. Order Unit
"RTN","PSAUTL4",43,0)
 I PSADJO'="" W $S(+PSADJO&($P($G(^DIC(51.5,+PSADJO,0)),"^")'=""):$P($G(^DIC(51.5,+PSADJO,0)),"^"),1:"UNKNOWN")_" ("_$S(PSAOU:$P($G(^DIC(51.5,+PSAOU,0)),"^"),1:"Blank")_")" S PSAOU=+PSADJO
"RTN","PSAUTL4",44,0)
 I PSADJO="" W $S(+PSAOU:$P($G(^DIC(51.5,+PSAOU,0)),"^"),1:"Blank")
"RTN","PSAUTL4",45,0)
 ;
"RTN","PSAUTL4",46,0)
NDC S PSANDC=$P(PSADATA,"^",11)
"RTN","PSAUTL4",47,0)
 I $E(PSANDC)'="S" W ?38,"NDC: " D PSANDC1^PSAHELP W PSANDCX K PSANDCX
"RTN","PSAUTL4",48,0)
 ;
"RTN","PSAUTL4",49,0)
PRICE W !,"Unit Price  : $"
"RTN","PSAUTL4",50,0)
 S PSADJP=0,PSADJ=+$O(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,"B","P",0))
"RTN","PSAUTL4",51,0)
 I $G(PSADJ) S PSANODE=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,1,PSALINE,1,PSADJ,0)),PSADJP=$S(+$P(PSANODE,"^",6):+$P(PSANODE,"^",6),1:+$P(PSANODE,"^",2))
"RTN","PSAUTL4",52,0)
 ;Adj. Unit Price
"RTN","PSAUTL4",53,0)
 I $G(PSADJP) D
"RTN","PSAUTL4",54,0)
 .I $L($P(PSADJP,".",2))<2 S PSADJP=$P(PSADJP,".")_"."_$P(PSADJP,".",2)_$E("00",1,(2-$L($P(PSADJP,".",2))))
"RTN","PSAUTL4",55,0)
 .W $FN(PSADJP,",")_" ($"_$S(+$P(PSADATA,"^",5):$FN($P(PSADATA,"^",5),","),$P(PSADATA,"^",5)=0:"0.00",1:"")_")"
"RTN","PSAUTL4",56,0)
 .S PSAPRICE=PSADJP
"RTN","PSAUTL4",57,0)
 I '$G(PSADJP) D
"RTN","PSAUTL4",58,0)
 .S PSAPRICE=+$P(PSADATA,"^",5)
"RTN","PSAUTL4",59,0)
 .I $G(PSAPRICE)!(PSAPRICE=0) W $S($G(PSAPRICE):PSAPRICE,1:"0.00") Q
"RTN","PSAUTL4",60,0)
 .W "Blank"
"RTN","PSAUTL4",61,0)
 ;
"RTN","PSAUTL4",62,0)
VSN S:$D(PSADATA) PSAVSN=$P(PSADATA,"^",12) ;*48
"RTN","PSAUTL4",63,0)
 W ?38,"VSN: "_$S(PSAVSN'="":PSAVSN,1:"Blank"),!
"RTN","PSAUTL4",64,0)
 ;bgn *67
"RTN","PSAUTL4",65,0)
 S PSAP67=$G(^PSD(58.811,PSAIEN,1,PSAIEN1,3,PSALINE,0))
"RTN","PSAUTL4",66,0)
 W !,"PV-Drug-Description  : ",$S($P(PSAP67,"^",1)'="":$P(PSAP67,"^",1),1:"Unknown")
"RTN","PSAUTL4",67,0)
 W ?55,"PV-DUOU  : ",$S($P(PSAP67,"^",4)'="":$P(PSAP67,"^",4),1:"Unknown")
"RTN","PSAUTL4",68,0)
 W !,"PV-Drug-Generic Name : ",$S($P(PSAP67,"^",2)'="":$P(PSAP67,"^",2),1:"Unknown")
"RTN","PSAUTL4",69,0)
 W ?55,"PV-UNITS : ",$S($P(PSAP67,"^",3)'="":$P(PSAP67,"^",3),1:"Unknown"),!
"RTN","PSAUTL4",70,0)
 ;end *67
"RTN","PSAUTL4",71,0)
VDU S PSADUOU=+$P(PSATEMP,"^"),PSAREORD=+$P(PSATEMP,"^",2),PSASUB=+$P(PSATEMP,"^",3),PSASTOCK=+$P(PSATEMP,"^",4)
"RTN","PSAUTL4",72,0)
 W !,"Dispense Units: "_$S($P($G(^PSDRUG(+PSADRG,660)),"^",8)'="":$P($G(^PSDRUG(+PSADRG,660)),"^",8),1:"Blank")
"RTN","PSAUTL4",73,0)
VDUOU W !,"Dispense Units Per Order Unit: "_$S(+PSADUOU:+PSADUOU,+PSASUB&(+$P($G(^PSDRUG(+PSADRG,1,PSASUB,0)),"^",7)):+$P($G(^PSDRUG(+PSADRG,1,PSASUB,0)),"^",7),1:"Blank"),!
"RTN","PSAUTL4",74,0)
 ;
"RTN","PSAUTL4",75,0)
 Q:'+$P($G(^PSD(58.8,+PSALOC,0)),"^",14)
"RTN","PSAUTL4",76,0)
 ;
"RTN","PSAUTL4",77,0)
STOCK S PSASTOCK=$S(+PSASTOCK:+PSASTOCK,+$P($G(^PSD(58.8,+PSALOC,1,+PSADRG,0)),"^",3):+$P($G(^PSD(58.8,+PSALOC,1,+PSADRG,0)),"^",3),1:"Blank")
"RTN","PSAUTL4",78,0)
 W "Stock Level   : "_PSASTOCK
"RTN","PSAUTL4",79,0)
REORDER S PSAREORD=$S(+PSAREORD:+PSAREORD,+$P($G(^PSD(58.8,+PSALOC,1,+PSADRG,0)),"^",5):+$P($G(^PSD(58.8,+PSALOC,1,+PSADRG,0)),"^",5),1:"Blank")
"RTN","PSAUTL4",80,0)
 W !,"Reorder Level : "_PSAREORD,!
"RTN","PSAUTL4",81,0)
 Q
"VER")
8.0^22.0
"^DD",58.811,58.811,0)
FIELD^^2^3
"^DD",58.811,58.811,0,"DDA")
N
"^DD",58.811,58.811,0,"DT")
3071120
"^DD",58.811,58.811,0,"IX","AC",58.8112,10)

"^DD",58.811,58.811,0,"IX","ADATE",58.8112,1)

"^DD",58.811,58.811,0,"IX","AINV",58.8112,.01)

"^DD",58.811,58.811,0,"IX","AINV2",58.811,.01)

"^DD",58.811,58.811,0,"IX","AINVDT",58.8112,1)

"^DD",58.811,58.811,0,"IX","ALOC",58.8112,4)

"^DD",58.811,58.811,0,"IX","ALOCMV",58.8112,13)

"^DD",58.811,58.811,0,"IX","ASTAT",58.8112,2)

"^DD",58.811,58.811,0,"IX","B",58.811,.01)

"^DD",58.811,58.811,0,"NM","DRUG ACCOUNTABILITY ORDER")

"^DD",58.811,58.811,0,"VRPK")
DRUG ACCOUNTABILITY V.
"^DD",58.811,58.811,.01,0)
ORDER NUMBER^RF^^0;1^K:$L(X)>22!($L(X)<1)!'(X'?1P.E) X
"^DD",58.811,58.811,.01,.1)
Order Number
"^DD",58.811,58.811,.01,1,0)
^.1
"^DD",58.811,58.811,.01,1,1,0)
58.811^B
"^DD",58.811,58.811,.01,1,1,1)
S ^PSD(58.811,"B",$E(X,1,30),DA)=""
"^DD",58.811,58.811,.01,1,1,2)
K ^PSD(58.811,"B",$E(X,1,30),DA)
"^DD",58.811,58.811,.01,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.811,.01,1,1,"%D",0)
^^1^1^2970522^
"^DD",58.811,58.811,.01,1,1,"%D",1,0)
This cross-reference is used to locate an order number.
"^DD",58.811,58.811,.01,1,2,0)
58.811^AINV2^MUMPS
"^DD",58.811,58.811,.01,1,2,1)
D SETAORD^PSAUTL3
"^DD",58.811,58.811,.01,1,2,2)
D KILLAORD^PSAUTL3
"^DD",58.811,58.811,.01,1,2,3)
DO NOT DELETE!
"^DD",58.811,58.811,.01,1,2,"%D",0)
^^5^5^2970923^
"^DD",58.811,58.811,.01,1,2,"%D",1,0)
This cross-reference is used to determine if an order's invoice has been
"^DD",58.811,58.811,.01,1,2,"%D",2,0)
received. It set the "AORD" cross-reference.
"^DD",58.811,58.811,.01,1,2,"%D",3,0)
 
"^DD",58.811,58.811,.01,1,2,"%D",4,0)
^PSD(58.811,"AORD",ORDER NUMBER,INVOICE NUMBER,DA,Invoice internal
"^DD",58.811,58.811,.01,1,2,"%D",5,0)
entry#)=""
"^DD",58.811,58.811,.01,1,2,"DT")
2970522
"^DD",58.811,58.811,.01,3)
Enter the order number.
"^DD",58.811,58.811,.01,9)
^
"^DD",58.811,58.811,.01,21,0)
^^2^2^2970922^^^^
"^DD",58.811,58.811,.01,21,1,0)
The ORDER NUMBER field contains number of the order placed with 
"^DD",58.811,58.811,.01,21,2,0)
the prime vendor.
"^DD",58.811,58.811,.01,"DT")
2971021
"^DD",58.811,58.811,1,0)
VENDOR NAME^F^^0;2^K:$L(X)>35!($L(X)<3) X
"^DD",58.811,58.811,1,.1)
Vendor Name
"^DD",58.811,58.811,1,3)
Enter the vendor's name.
"^DD",58.811,58.811,1,9)
^
"^DD",58.811,58.811,1,21,0)
^^2^2^2960503^^
"^DD",58.811,58.811,1,21,1,0)
The VENDOR NAME field contains the name of the vendor from
"^DD",58.811,58.811,1,21,2,0)
whom the order was placed.
"^DD",58.811,58.811,1,"DT")
2971021
"^DD",58.811,58.811,2,0)
INVOICE DATA^58.8112AI^^1;0
"^DD",58.811,58.811,2,9)
^
"^DD",58.811,58.811,2,21,0)
^^2^2^2970926^^^
"^DD",58.811,58.811,2,21,1,0)
The INVOICE DATA multiple contains detail invoice data. It contains the
"^DD",58.811,58.811,2,21,2,0)
line item data and adjustment data.
"^DD",58.811,58.811,2,"DT")
2970926
"^DD",58.811,58.8112,0)
INVOICE DATA SUB-FIELD^^14^15
"^DD",58.811,58.8112,0,"DT")
3071120
"^DD",58.811,58.8112,0,"ID",1)
W "   ",$E($P(^(0),U,2),4,5)_"-"_$E($P(^(0),U,2),6,7)_"-"_$E($P(^(0),U,2),2,3)
"^DD",58.811,58.8112,0,"IX","B",58.8112,.01)

"^DD",58.811,58.8112,0,"NM","INVOICE DATA")

"^DD",58.811,58.8112,0,"UP")
58.811
"^DD",58.811,58.8112,.01,0)
INVOICE NUMBER^F^^0;1^K:$L(X)>22!($L(X)<1) X
"^DD",58.811,58.8112,.01,.1)
Invoice Number
"^DD",58.811,58.8112,.01,1,0)
^.1
"^DD",58.811,58.8112,.01,1,1,0)
58.8112^B
"^DD",58.811,58.8112,.01,1,1,1)
S ^PSD(58.811,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",58.811,58.8112,.01,1,1,2)
K ^PSD(58.811,DA(1),1,"B",$E(X,1,30),DA)
"^DD",58.811,58.8112,.01,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,.01,1,1,"%D",0)
^^1^1^2970522^
"^DD",58.811,58.8112,.01,1,1,"%D",1,0)
This cross-reference is used to locate an invoice number.
"^DD",58.811,58.8112,.01,1,2,0)
58.811^AINV^MUMPS
"^DD",58.811,58.8112,.01,1,2,1)
S ^PSD(58.811,"AORD",$P($G(^PSD(58.811,DA(1),0)),"^"),X,DA(1),DA)=""
"^DD",58.811,58.8112,.01,1,2,2)
K ^PSD(58.811,"AORD",$P($G(^PSD(58.811,DA(1),0)),"^"),X,DA(1),DA)
"^DD",58.811,58.8112,.01,1,2,3)
DO NOT DELETE!
"^DD",58.811,58.8112,.01,1,2,"%D",0)
^^5^5^2970923^
"^DD",58.811,58.8112,.01,1,2,"%D",1,0)
This cross-reference is used to determine if an order's invoice has been
"^DD",58.811,58.8112,.01,1,2,"%D",2,0)
received. It set the "AORD" cross-reference.
"^DD",58.811,58.8112,.01,1,2,"%D",3,0)
 
"^DD",58.811,58.8112,.01,1,2,"%D",4,0)
^PSD(58.811,"AORD",ORDER NUMBER,INVOICE NUMBER,Order internal
"^DD",58.811,58.8112,.01,1,2,"%D",5,0)
entry#,DA)=""
"^DD",58.811,58.8112,.01,1,2,"DT")
2961127
"^DD",58.811,58.8112,.01,3)
Enter the invoice number from the prime vendor.
"^DD",58.811,58.8112,.01,21,0)
^^2^2^2960503^
"^DD",58.811,58.8112,.01,21,1,0)
The INVOICE NUMBER field contains the number of the invoice from
"^DD",58.811,58.8112,.01,21,2,0)
the prime vendor.
"^DD",58.811,58.8112,.01,"DT")
2971021
"^DD",58.811,58.8112,1,0)
INVOICE DATE^D^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.8112,1,.1)
Invoice Date
"^DD",58.811,58.8112,1,1,0)
^.1
"^DD",58.811,58.8112,1,1,1,0)
58.811^ADATE
"^DD",58.811,58.8112,1,1,1,1)
S ^PSD(58.811,"ADATE",$E(X,1,30),DA(1),DA)=""
"^DD",58.811,58.8112,1,1,1,2)
K ^PSD(58.811,"ADATE",$E(X,1,30),DA(1),DA)
"^DD",58.811,58.8112,1,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,1,1,1,"%D",0)
^^1^1^2971015^^
"^DD",58.811,58.8112,1,1,1,"%D",1,0)
This cross-reference is used to locate an invoice number.
"^DD",58.811,58.8112,1,1,1,"DT")
2970510
"^DD",58.811,58.8112,1,1,2,0)
58.811^AINVDT^MUMPS
"^DD",58.811,58.8112,1,1,2,1)
D SLOCDT^PSAUTL3
"^DD",58.811,58.8112,1,1,2,2)
D KLOCDT^PSAUTL3
"^DD",58.811,58.8112,1,1,2,3)
DO NOT DELETE!
"^DD",58.811,58.8112,1,1,2,"%D",0)
^^13^13^2970926^
"^DD",58.811,58.8112,1,1,2,"%D",1,0)
This cross-reference is used to locate invoices within a pharmacy location
"^DD",58.811,58.8112,1,1,2,"%D",2,0)
or master vault for a specific invoice date. It sets the "ALOC"
"^DD",58.811,58.8112,1,1,2,"%D",3,0)
cross-reference.
"^DD",58.811,58.8112,1,1,2,"%D",4,0)
 
"^DD",58.811,58.8112,1,1,2,"%D",5,0)
If there is data in the PHARMACY LOCATION field (#4),
"^DD",58.811,58.8112,1,1,2,"%D",6,0)
^PSD(58.811,"ALOC",PHARMACY LOCATION,Order's internal entry#,DA)="" is
"^DD",58.811,58.8112,1,1,2,"%D",7,0)
set.
"^DD",58.811,58.8112,1,1,2,"%D",8,0)
 
"^DD",58.811,58.8112,1,1,2,"%D",9,0)
If there is data in the MASTER VAULT field (#13),
"^DD",58.811,58.8112,1,1,2,"%D",10,0)
^PSD(58.811,"ALOC",MASTER VAULT,Order's internal entry#,DA)="" is set.
"^DD",58.811,58.8112,1,1,2,"%D",11,0)
 
"^DD",58.811,58.8112,1,1,2,"%D",12,0)
If there is data in both the PHARMACY LOCATION and MASTER VAULT fields,
"^DD",58.811,58.8112,1,1,2,"%D",13,0)
both cross-references are set.
"^DD",58.811,58.8112,1,1,2,"DT")
2970522
"^DD",58.811,58.8112,1,3)
Enter the date of the invoice.
"^DD",58.811,58.8112,1,21,0)
^^2^2^2960503^^
"^DD",58.811,58.8112,1,21,1,0)
The INVOICE DATE field contains the date the invoice was issued
"^DD",58.811,58.8112,1,21,2,0)
by the vendor
"^DD",58.811,58.8112,1,"DT")
2970522
"^DD",58.811,58.8112,2,0)
INVOICE STATUS^S^P:PROCESSED;V:VERIFIED;C:COMPLETED;L:LOCKED VERIFYING;^0;3^Q
"^DD",58.811,58.8112,2,.1)
Invoice Status
"^DD",58.811,58.8112,2,1,0)
^.1
"^DD",58.811,58.8112,2,1,1,0)
58.811^ASTAT
"^DD",58.811,58.8112,2,1,1,1)
S ^PSD(58.811,"ASTAT",$E(X,1,30),DA(1),DA)=""
"^DD",58.811,58.8112,2,1,1,2)
K ^PSD(58.811,"ASTAT",$E(X,1,30),DA(1),DA)
"^DD",58.811,58.8112,2,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,2,1,1,"%D",0)
^^2^2^2961129^^
"^DD",58.811,58.8112,2,1,1,"%D",1,0)
This cross-reference is used to locate all invoices with a specific
"^DD",58.811,58.8112,2,1,1,"%D",2,0)
status.
"^DD",58.811,58.8112,2,1,1,"DT")
2961129
"^DD",58.811,58.8112,2,3)
Enter the status of the invoice.
"^DD",58.811,58.8112,2,21,0)
^^3^3^2960503^^
"^DD",58.811,58.8112,2,21,1,0)
The INVOICE STATUS field contains the status of the invoice. 
"^DD",58.811,58.8112,2,21,2,0)
When the invoice is completed, the drug balances are incremented 
"^DD",58.811,58.8112,2,21,3,0)
with the quantities received on the invoice.
"^DD",58.811,58.8112,2,"DT")
3060322
"^DD",58.811,58.8112,3,0)
ORDER DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.8112,3,.1)
Order Date
"^DD",58.811,58.8112,3,3)
Enter the date the order was placed with the prime vendor.
"^DD",58.811,58.8112,3,21,0)
^^2^2^2960503^^
"^DD",58.811,58.8112,3,21,1,0)
The ORDER DATE field contains the date the order was placed for
"^DD",58.811,58.8112,3,21,2,0)
the invoiced drugs.
"^DD",58.811,58.8112,3,"DT")
2960503
"^DD",58.811,58.8112,4,0)
PHARMACY LOCATION^*P58.8'^PSD(58.8,^0;5^S DIC("S")="I $P($G(^PSD(58.8,+Y,0)),U,2)=""P""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.8112,4,.1)
Pharmacy Location
"^DD",58.811,58.8112,4,1,0)
^.1
"^DD",58.811,58.8112,4,1,1,0)
58.811^ALOC^MUMPS
"^DD",58.811,58.8112,4,1,1,1)
D SLOC^PSAUTL3
"^DD",58.811,58.8112,4,1,1,2)
D KLOC^PSAUTL3
"^DD",58.811,58.8112,4,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,4,1,1,"%D",0)
^^4^4^2970926^^
"^DD",58.811,58.8112,4,1,1,"%D",1,0)
This cross-reference is used to locate invoices within a pharmacy location
"^DD",58.811,58.8112,4,1,1,"%D",2,0)
for a specific invoice date. It sets the "ALOC"cross-reference.
"^DD",58.811,58.8112,4,1,1,"%D",3,0)
 
"^DD",58.811,58.8112,4,1,1,"%D",4,0)
^PSD(58.811,"ALOC",PHARMACY LOCATION,Order's internal entry#,DA)=""
"^DD",58.811,58.8112,4,1,1,"DT")
2970522
"^DD",58.811,58.8112,4,3)
Enter the Drug Accountability pharmacy location for which the order was placed.
"^DD",58.811,58.8112,4,12)
Only pharmacy locations can be selected.
"^DD",58.811,58.8112,4,12.1)
S DIC("S")="I $P($G(^PSD(58.8,+Y,0)),U,2)=""P"""
"^DD",58.811,58.8112,4,21,0)
^^3^3^2970923^^^^
"^DD",58.811,58.8112,4,21,1,0)
The PHARMACY LOCATION field contains the Drug Accountability pharmacy
"^DD",58.811,58.8112,4,21,2,0)
location for which the invoiced order was placed. The pharmacy location 
"^DD",58.811,58.8112,4,21,3,0)
received the items not marked as a controlled substance.
"^DD",58.811,58.8112,4,23,0)
^^2^2^2970926^
"^DD",58.811,58.8112,4,23,1,0)
The field points to the DRUG ACCOUNTABILITY STATS file (#58.8). The node
"^DD",58.811,58.8112,4,23,2,0)
pointed to must contain an "P" in the LOCATION TYPE field (#1).
"^DD",58.811,58.8112,4,"DT")
2970829
"^DD",58.811,58.8112,5,0)
LINE ITEM DATA^58.81125AI^^1;0
"^DD",58.811,58.8112,5,21,0)
^^4^4^2970923^
"^DD",58.811,58.8112,5,21,1,0)
The LINE ITEM DATA multiple contains the line item number, drug, quantity
"^DD",58.811,58.8112,5,21,2,0)
invoiced, order unit, price per order unit, date drugs were received, date
"^DD",58.811,58.8112,5,21,3,0)
the line item was processed, processor, date the line item was verified,
"^DD",58.811,58.8112,5,21,4,0)
verifier, and adjustment data for each line item.
"^DD",58.811,58.8112,6,0)
CREDITS^58.81126A^^2;0
"^DD",58.811,58.8112,6,21,0)
^^2^2^2961107^
"^DD",58.811,58.8112,6,21,1,0)
The CREDITS multiple contains the credit memo data issued
"^DD",58.811,58.8112,6,21,2,0)
against the invoice.
"^DD",58.811,58.8112,7,0)
DELIVERY DATE^D^^0;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.8112,7,.1)
Delivery Date
"^DD",58.811,58.8112,7,3)
Enter the delivery date on the invoice.
"^DD",58.811,58.8112,7,21,0)
^^2^2^2961107^^
"^DD",58.811,58.8112,7,21,1,0)
The DELIVERY DATE field contains the date the prime
"^DD",58.811,58.8112,7,21,2,0)
vendor's invoice shows the items were delivered.
"^DD",58.811,58.8112,7,"DT")
2961107
"^DD",58.811,58.8112,8,0)
DATE RECEIVED^D^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.8112,8,.1)
Date Received
"^DD",58.811,58.8112,8,3)
Enter the date the items were received.
"^DD",58.811,58.8112,8,21,0)
^^3^3^2961107^^
"^DD",58.811,58.8112,8,21,1,0)
The DATE RECEIVED field contains the date the drugs were 
"^DD",58.811,58.8112,8,21,2,0)
received if it is different than the delivery date on the 
"^DD",58.811,58.8112,8,21,3,0)
invoice.
"^DD",58.811,58.8112,8,"DT")
2961107
"^DD",58.811,58.8112,9,0)
CONTROLLED SUBSTANCES^S^A:ALL;S:SOME;N:NONE;^0;8^Q
"^DD",58.811,58.8112,9,.1)
Controlled Substances
"^DD",58.811,58.8112,9,3)
Enter the invoice's controlled substances category.
"^DD",58.811,58.8112,9,21,0)
^^2^2^2970923^
"^DD",58.811,58.8112,9,21,1,0)
The CONTROLLED SUBSTANCES field contains a flag indicating if all, some,
"^DD",58.811,58.8112,9,21,2,0)
or none of the drugs on the invoice are flagged as controlled substances.
"^DD",58.811,58.8112,9,"DT")
2961108
"^DD",58.811,58.8112,10,0)
OUTSTANDING CREDIT MEMO^S^1:YES;^0;9^Q
"^DD",58.811,58.8112,10,.1)
Outstanding Credit Memo
"^DD",58.811,58.8112,10,1,0)
^.1
"^DD",58.811,58.8112,10,1,1,0)
58.811^AC
"^DD",58.811,58.8112,10,1,1,1)
S ^PSD(58.811,"AC",$E(X,1,30),DA(1),DA)=""
"^DD",58.811,58.8112,10,1,1,2)
K ^PSD(58.811,"AC",$E(X,1,30),DA(1),DA)
"^DD",58.811,58.8112,10,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,10,1,1,"%D",0)
^^2^2^2971017^^
"^DD",58.811,58.8112,10,1,1,"%D",1,0)
The cross-reference is used to determine if there is an outstanding
"^DD",58.811,58.8112,10,1,1,"%D",2,0)
credit memo for the invoice.
"^DD",58.811,58.8112,10,1,1,"DT")
2961205
"^DD",58.811,58.8112,10,3)
Enter "1" if there is an outstanding credit memo for the invoice.
"^DD",58.811,58.8112,10,21,0)
^^3^3^2970923^
"^DD",58.811,58.8112,10,21,1,0)
The CREDIT MEMO REQUIRED? field is a flag used to determine if there is an
"^DD",58.811,58.8112,10,21,2,0)
outstanding credit memo for the invoice. The field is set to "1" if a
"^DD",58.811,58.8112,10,21,3,0)
credit memo is needed and has not been received.
"^DD",58.811,58.8112,10,"DT")
2961205
"^DD",58.811,58.8112,11,0)
PROCESSOR^*P200'^VA(200,^0;10^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.8112,11,.1)
Processor
"^DD",58.811,58.8112,11,3)
Enter the last person who processed the invoice.
"^DD",58.811,58.8112,11,12)
The user must hold the PSA ORDERS key.
"^DD",58.811,58.8112,11,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.8112,11,21,0)
^^2^2^2961210^^
"^DD",58.811,58.8112,11,21,1,0)
The PROCESSOR field contains the name of the person who last processed
"^DD",58.811,58.8112,11,21,2,0)
the invoice.
"^DD",58.811,58.8112,11,"DT")
2961210
"^DD",58.811,58.8112,12,0)
VERIFIER^*P200'^VA(200,^0;11^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.8112,12,.1)
Verifier
"^DD",58.811,58.8112,12,3)
Enter the name of the person who verified the invoice.
"^DD",58.811,58.8112,12,12)
The user must hold the PSA ORDERS key.
"^DD",58.811,58.8112,12,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.8112,12,21,0)
^^2^2^2961210^^^^
"^DD",58.811,58.8112,12,21,1,0)
The VERIFIER field contains the name of the person who last verified
"^DD",58.811,58.8112,12,21,2,0)
the invoice. The verifier cannot be the processor.
"^DD",58.811,58.8112,12,"DT")
2961210
"^DD",58.811,58.8112,13,0)
MASTER VAULT^*P58.8'^PSD(58.8,^0;12^S DIC("S")="I $P($G(^PSD(58.8,+Y,0)),U,2)=""M""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.8112,13,.1)
Master Vault
"^DD",58.811,58.8112,13,1,0)
^.1
"^DD",58.811,58.8112,13,1,1,0)
58.811^ALOCMV^MUMPS
"^DD",58.811,58.8112,13,1,1,1)
D SLOC^PSAUTL3
"^DD",58.811,58.8112,13,1,1,2)
D KLOC^PSAUTL3
"^DD",58.811,58.8112,13,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.8112,13,1,1,"%D",0)
^^4^4^2970926^^
"^DD",58.811,58.8112,13,1,1,"%D",1,0)
This cross-reference is used to locate invoices within a master vault for
"^DD",58.811,58.8112,13,1,1,"%D",2,0)
a specific invoice date. It sets the "ALOC"cross-reference.
"^DD",58.811,58.8112,13,1,1,"%D",3,0)
 
"^DD",58.811,58.8112,13,1,1,"%D",4,0)
^PSD(58.811,"ALOC",MASTER VAULT,Order's internal entry#,DA)=""
"^DD",58.811,58.8112,13,1,1,"DT")
2970522
"^DD",58.811,58.8112,13,3)
Enter the master vault that received the controlled substances.
"^DD",58.811,58.8112,13,12)
Only master vaults can be selected.
"^DD",58.811,58.8112,13,12.1)
S DIC("S")="I $P($G(^PSD(58.8,+Y,0)),U,2)=""M"""
"^DD",58.811,58.8112,13,21,0)
^^2^2^2970923^^^^
"^DD",58.811,58.8112,13,21,1,0)
The MASTER VAULT field contains the master vault that received the
"^DD",58.811,58.8112,13,21,2,0)
controlled substances on the invoice.
"^DD",58.811,58.8112,13,23,0)
^^2^2^2970923^
"^DD",58.811,58.8112,13,23,1,0)
The field points to the DRUG ACCOUNTABILITY STATS file (#58.8). The master
"^DD",58.811,58.8112,13,23,2,0)
vault pointed to must contain an "M" in the LOCATION TYPE field (#1).
"^DD",58.811,58.8112,13,"DT")
2970829
"^DD",58.811,58.8112,14,0)
ALL SUPPLY ITEMS?^S^1:YES;0:NO;^0;13^Q
"^DD",58.811,58.8112,14,.1)
All Supply Items?
"^DD",58.811,58.8112,14,3)
Enter "YES" if all items on the invoice are supply items.
"^DD",58.811,58.8112,14,21,0)
^^4^4^2970923^
"^DD",58.811,58.8112,14,21,1,0)
The ALL SUPPLY ITEMS? field contains "YES" if all items on the invoice are
"^DD",58.811,58.8112,14,21,2,0)
supply items or will never be matched to drugs in the DRUG file (#50). It
"^DD",58.811,58.8112,14,21,3,0)
contains "NO" if there is at least one item on the invoice that is not a
"^DD",58.811,58.8112,14,21,4,0)
supply item or will be matched to a drug in the DRUG file.
"^DD",58.811,58.8112,14,"DT")
2970131
"^DD",58.811,58.81125,0)
LINE ITEM DATA SUB-FIELD^^21^22
"^DD",58.811,58.81125,0,"DT")
3071120
"^DD",58.811,58.81125,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^PSDRUG(+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(50,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",58.811,58.81125,0,"IX","B",58.81125,.01)

"^DD",58.811,58.81125,0,"NM","LINE ITEM DATA")

"^DD",58.811,58.81125,0,"UP")
58.8112
"^DD",58.811,58.81125,.01,0)
LINE ITEM NUMBER^F^^0;1^K:$L(X)>11!($L(X)<1) X
"^DD",58.811,58.81125,.01,.1)
Line Item Number
"^DD",58.811,58.81125,.01,1,0)
^.1
"^DD",58.811,58.81125,.01,1,1,0)
58.81125^B
"^DD",58.811,58.81125,.01,1,1,1)
S ^PSD(58.811,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",58.811,58.81125,.01,1,1,2)
K ^PSD(58.811,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",58.811,58.81125,.01,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.81125,.01,1,1,"%D",0)
^^1^1^2970522^
"^DD",58.811,58.81125,.01,1,1,"%D",1,0)
This cross-reference is used to locate a line item number.
"^DD",58.811,58.81125,.01,3)
Enter the number of the item on the invoice.
"^DD",58.811,58.81125,.01,21,0)
^^2^2^2960503^
"^DD",58.811,58.81125,.01,21,1,0)
The LINE ITEM NUMBER field contains the number of the item on the
"^DD",58.811,58.81125,.01,21,2,0)
invoice.
"^DD",58.811,58.81125,.01,"DT")
2960503
"^DD",58.811,58.81125,1,0)
DRUG^P50'^PSDRUG(^0;2^Q
"^DD",58.811,58.81125,1,.1)
Drug
"^DD",58.811,58.81125,1,3)
Enter the drug that was invoiced.
"^DD",58.811,58.81125,1,21,0)
^^1^1^2960503^
"^DD",58.811,58.81125,1,21,1,0)
The DRUG field contains the drug that was invoiced.
"^DD",58.811,58.81125,1,"DT")
2960503
"^DD",58.811,58.81125,2,0)
QUANTITY INVOICED^NJ10,0^^0;3^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",58.811,58.81125,2,.1)
Quantity Invoiced
"^DD",58.811,58.81125,2,3)
Enter the quantity of the drug that was invoiced.
"^DD",58.811,58.81125,2,21,0)
^^2^2^2960503^
"^DD",58.811,58.81125,2,21,1,0)
The QUANTITY INVOICED field contains the quantity of the ordered
"^DD",58.811,58.81125,2,21,2,0)
drug that invoiced.
"^DD",58.811,58.81125,2,"DT")
2960503
"^DD",58.811,58.81125,3,0)
ORDER UNIT^P51.5'^DIC(51.5,^0;4^Q
"^DD",58.811,58.81125,3,.1)
Order Unit
"^DD",58.811,58.81125,3,3)
Enter the order unit for which the drug was invoiced.
"^DD",58.811,58.81125,3,21,0)
^^2^2^2961205^^
"^DD",58.811,58.81125,3,21,1,0)
The ORDER UNIT field contains the packaging unit for which
"^DD",58.811,58.81125,3,21,2,0)
the drug was invoiced.
"^DD",58.811,58.81125,3,"DT")
2960503
"^DD",58.811,58.81125,4,0)
PRICE PER ORDER UNIT^NJ14,3^^0;5^K:+X'=X!(X>9999999999.999)!(X<0)!(X?.E1"."4N.N) X
"^DD",58.811,58.81125,4,.1)
Price per Order Unit
"^DD",58.811,58.81125,4,3)
Enter the dollar amount invoiced for each unit of order.
"^DD",58.811,58.81125,4,21,0)
^^2^2^2960503^^
"^DD",58.811,58.81125,4,21,1,0)
The PRICE PER ORDER UNIT field contains the dollar amount for each
"^DD",58.811,58.81125,4,21,2,0)
order unit.
"^DD",58.811,58.81125,4,"DT")
2960503
"^DD",58.811,58.81125,5,0)
DATE PROCESSED^D^^0;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.81125,5,.1)
Date Processed
"^DD",58.811,58.81125,5,3)
Enter the date the line item was processed.
"^DD",58.811,58.81125,5,21,0)
^^1^1^2961105^^^^
"^DD",58.811,58.81125,5,21,1,0)
The DATE PROCESSED field contains the date the line item was processed.
"^DD",58.811,58.81125,5,"DT")
2961105
"^DD",58.811,58.81125,6,0)
PROCESSOR^*P200'^VA(200,^0;7^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.81125,6,.1)
Processor
"^DD",58.811,58.81125,6,3)
Enter the name of the person who processed the line item.
"^DD",58.811,58.81125,6,12)
The user must hold the PSA ORDERS key.
"^DD",58.811,58.81125,6,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.81125,6,21,0)
^^2^2^2961203^^^^
"^DD",58.811,58.81125,6,21,1,0)
The PROCESSOR field contains the name of the person who processed
"^DD",58.811,58.81125,6,21,2,0)
the line item.
"^DD",58.811,58.81125,6,"DT")
2961203
"^DD",58.811,58.81125,7,0)
DATE VERIFIED^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.81125,7,.1)
Date Verified
"^DD",58.811,58.81125,7,3)
Enter the date the line item was verified.
"^DD",58.811,58.81125,7,21,0)
^^1^1^2961105^^^
"^DD",58.811,58.81125,7,21,1,0)
The DATE VERIFIED field contains the date the line item was verified.
"^DD",58.811,58.81125,7,"DT")
2961105
"^DD",58.811,58.81125,8,0)
VERIFIER^*P200'^VA(200,^0;9^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.81125,8,.1)
Verifier
"^DD",58.811,58.81125,8,3)
Enter the name of the person who verified the line item.
"^DD",58.811,58.81125,8,12)
The user must hold the PSA ORDERS key.
"^DD",58.811,58.81125,8,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.81125,8,21,0)
^^2^2^2961205^^^^
"^DD",58.811,58.81125,8,21,1,0)
The VERIFIER field contains the name of the person who verified the
"^DD",58.811,58.81125,8,21,2,0)
line item.
"^DD",58.811,58.81125,8,"DT")
2961205
"^DD",58.811,58.81125,9,0)
ADJUSTMENTS^58.811259SA^^1;0
"^DD",58.811,58.81125,9,21,0)
^^2^2^2961107^^
"^DD",58.811,58.81125,9,21,1,0)
The ADJUSTMENTS multiple contains the changes the processor and
"^DD",58.811,58.81125,9,21,2,0)
verifier made to the invoice data.
"^DD",58.811,58.81125,10,0)
DISPENSE UNITS PER ORDER UNIT^NJ10,3^^2;1^K:+X'=X!(X>999999)!(X<1)!(X?.E1"."4N.N) X
"^DD",58.811,58.81125,10,.1)
Dispense Units per Order Unit
"^DD",58.811,58.81125,10,3)
Enter the number of dispense units contained in one order unit.
"^DD",58.811,58.81125,10,21,0)
^^2^2^2961107^
"^DD",58.811,58.81125,10,21,1,0)
The DISPENSE UNITS PER ORDER UNIT field contains the
"^DD",58.811,58.81125,10,21,2,0)
number of dispense units in one order unit.
"^DD",58.811,58.81125,10,"DT")
2970110
"^DD",58.811,58.81125,11,0)
REORDER LEVEL^NJ9,0^^2;2^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",58.811,58.81125,11,.1)
Reorder Level
"^DD",58.811,58.81125,11,3)
Enter the minimum number of dispense units you want to have in the pharmacy location.
"^DD",58.811,58.81125,11,21,0)
^^3^3^2970408^^^^
"^DD",58.811,58.81125,11,21,1,0)
The REORDER LEVEL field contains the minimum number of dispense 
"^DD",58.811,58.81125,11,21,2,0)
units to be retained in the pharmacy location for the line item's 
"^DD",58.811,58.81125,11,21,3,0)
drug.
"^DD",58.811,58.81125,11,"DT")
2970408
"^DD",58.811,58.81125,12,0)
CONTROLLED SUBSTANCE?^S^1:YES;0:NO;^0;10^Q
"^DD",58.811,58.81125,12,.1)
Controlled Substance?
"^DD",58.811,58.81125,12,3)
Enter "YES" if the item is marked as a controlled substance.
"^DD",58.811,58.81125,12,21,0)
^^4^4^2970923^
"^DD",58.811,58.81125,12,21,1,0)
The CONTROLLED SUBSTANCE? field contains a flag indicating if the drug is
"^DD",58.811,58.81125,12,21,2,0)
marked as a controlled substance in the DRUG file (#50). If there is an
"^DD",58.811,58.81125,12,21,3,0)
adjusted drug, the flag is set for that drug. If there is no adjusted
"^DD",58.811,58.81125,12,21,4,0)
drug, the flag is set for the invoiced drug.
"^DD",58.811,58.81125,12,"DT")
2961108
"^DD",58.811,58.81125,13,0)
NDC^F^^0;11^K:$L(X)>31!($L(X)<1) X
"^DD",58.811,58.81125,13,.1)
National Drug Code
"^DD",58.811,58.81125,13,3)
Enter the National Drug Code (NDC). If there is no NDC, enter "S" concatenated to the Universal Product Code (UPC).
"^DD",58.811,58.81125,13,21,0)
^^3^3^2970923^^^
"^DD",58.811,58.81125,13,21,1,0)
The NDC field contains the National Drug Code (NDC) for the received item.
"^DD",58.811,58.81125,13,21,2,0)
If the item was adjusted, the NDC is for the adjusted item. If the item
"^DD",58.811,58.81125,13,21,3,0)
was not adjusted, the NDC is for the invoiced item.
"^DD",58.811,58.81125,13,23,0)
^^3^3^2970923^
"^DD",58.811,58.81125,13,23,1,0)
If the item is a drug, the NDC is twelve numbers. If the item is a supply,
"^DD",58.811,58.81125,13,23,2,0)
the National Drug Code (NDC) is "S" concatenated to the Universal Product
"^DD",58.811,58.81125,13,23,3,0)
Code (UPC).
"^DD",58.811,58.81125,13,"DT")
2961114
"^DD",58.811,58.81125,14,0)
VSN^F^^0;12^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.81125,14,.1)
Vendor Stock Number
"^DD",58.811,58.81125,14,3)
Enter the vendor's stock number for the item.
"^DD",58.811,58.81125,14,21,0)
^^1^1^2961108^^
"^DD",58.811,58.81125,14,21,1,0)
The VSN field contains the Vendor Stock Number for the item received.
"^DD",58.811,58.81125,14,"DT")
2961108
"^DD",58.811,58.81125,15,0)
UPC^F^^0;13^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.81125,15,.1)
Universal Product Code
"^DD",58.811,58.81125,15,3)
Enter the item's Universal Product Code.
"^DD",58.811,58.81125,15,21,0)
^^2^2^2970922^^^
"^DD",58.811,58.81125,15,21,1,0)
The UPC field contains the Universal Product Code for the item
"^DD",58.811,58.81125,15,21,2,0)
received.
"^DD",58.811,58.81125,15,"DT")
2961108
"^DD",58.811,58.81125,16,0)
SYNONYM NODE^NJ6,0^^2;3^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",58.811,58.81125,16,.1)
Synonym Node
"^DD",58.811,58.81125,16,3)
Enter the DRUG file's SYNONYM multiple's internal entry number that contains the data for the invoiced item.
"^DD",58.811,58.81125,16,21,0)
^^2^2^2970923^
"^DD",58.811,58.81125,16,21,1,0)
The SYNONYM NODE field contains the DRUG file's (#50) SYNONYM multiple's 
"^DD",58.811,58.81125,16,21,2,0)
internal entry number that contains the data for the invoiced item.
"^DD",58.811,58.81125,16,23,0)
^^2^2^2970923^^
"^DD",58.811,58.81125,16,23,1,0)
This field will contain data until the invoice is verified. The 2 node
"^DD",58.811,58.81125,16,23,2,0)
will be deleted then.
"^DD",58.811,58.81125,16,"DT")
2970110
"^DD",58.811,58.81125,17,0)
STOCK LEVEL^NJ7,0^^2;4^K:+X'=X!(X>9999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",58.811,58.81125,17,.1)
Stock Level
"^DD",58.811,58.81125,17,3)
Enter the ideal number of dispense units to keep on the shelf.
"^DD",58.811,58.81125,17,21,0)
^^2^2^2970408^^^
"^DD",58.811,58.81125,17,21,1,0)
The STOCK LEVEL field contains the ideal number of dispense units to
"^DD",58.811,58.81125,17,21,2,0)
keep on the shelf.
"^DD",58.811,58.81125,17,"DT")
2970201
"^DD",58.811,58.81125,18,0)
GENERIC DESCRIPTION^F^^3;1^K:$L(X)>40!($L(X)<3) X
"^DD",58.811,58.81125,18,3)
Answer must be 3-40 characters in length.
"^DD",58.811,58.81125,18,21,0)
^^1^1^3071120^
"^DD",58.811,58.81125,18,21,1,0)
This is a generic description of the item provided by the vendor.
"^DD",58.811,58.81125,18,"DT")
3071120
"^DD",58.811,58.81125,19,0)
ITEM DESCRIPTION^F^^3;2^K:$L(X)>40!($L(X)<3) X
"^DD",58.811,58.81125,19,3)
Answer must be 3-40 characters in length.
"^DD",58.811,58.81125,19,21,0)
^^1^1^3071120^
"^DD",58.811,58.81125,19,21,1,0)
This is a detailed description of the line item.
"^DD",58.811,58.81125,19,"DT")
3071120
"^DD",58.811,58.81125,20,0)
PRIME VENDOR UNITS^NJ8,2^^3;3^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."3N.N) X
"^DD",58.811,58.81125,20,3)
Type a Number between 0 and 99999, 2 Decimal Digits
"^DD",58.811,58.81125,20,21,0)
^^2^2^3071120^
"^DD",58.811,58.81125,20,21,1,0)
This is the number of units in the vendor sell unit (i.e. number of 
"^DD",58.811,58.81125,20,21,2,0)
bottles in sell unit.
"^DD",58.811,58.81125,20,"DT")
3071120
"^DD",58.811,58.81125,21,0)
INNER PACK^NJ8,2^^3;4^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."3N.N) X
"^DD",58.811,58.81125,21,3)
Type a Number between 0 and 99999, 2 Decimal Digits
"^DD",58.811,58.81125,21,21,0)
^^2^2^3071120^
"^DD",58.811,58.81125,21,21,1,0)
This is the vendor's dispense units per order unit (i.e. number of pills
"^DD",58.811,58.81125,21,21,2,0)
in bottle).
"^DD",58.811,58.81125,21,"DT")
3071120
"^DD",58.811,58.811259,0)
ADJUSTMENTS SUB-FIELD^^8^9
"^DD",58.811,58.811259,0,"DT")
2961220
"^DD",58.811,58.811259,0,"IX","B",58.811259,.01)

"^DD",58.811,58.811259,0,"NM","ADJUSTMENTS")

"^DD",58.811,58.811259,0,"UP")
58.81125
"^DD",58.811,58.811259,.01,0)
ADJUSTED FIELD^S^D:DRUG;Q:QUANTITY INVOICED;O:ORDER UNIT;P:PRICE PER ORDER UNIT;^0;1^Q
"^DD",58.811,58.811259,.01,.1)
Adjusted Field
"^DD",58.811,58.811259,.01,1,0)
^.1
"^DD",58.811,58.811259,.01,1,1,0)
58.811259^B
"^DD",58.811,58.811259,.01,1,1,1)
S ^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",58.811,58.811259,.01,1,1,2)
K ^PSD(58.811,DA(3),1,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",58.811,58.811259,.01,3)
Enter the field that was adjusted.
"^DD",58.811,58.811259,.01,21,0)
^^2^2^2961107^^
"^DD",58.811,58.811259,.01,21,1,0)
The ADJUSTED FIELD field contains the name of the field that 
"^DD",58.811,58.811259,.01,21,2,0)
was adjusted.
"^DD",58.811,58.811259,.01,"DT")
2961107
"^DD",58.811,58.811259,1,0)
PROCESSOR ADJUSTMENT^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.811259,1,.1)
Processor Adjustment
"^DD",58.811,58.811259,1,3)
Enter the adjustment made by the processor.
"^DD",58.811,58.811259,1,21,0)
^^8^8^2970923^
"^DD",58.811,58.811259,1,21,1,0)
The PROCESSOR ADJUSTMENT field contains the processor's adjustment. If the
"^DD",58.811,58.811259,1,21,2,0)
ADJUSTED FIELD field (.01) is "DRUG", the adjustment is the drug received
"^DD",58.811,58.811259,1,21,3,0)
or a description of supply item. If the ADJUSTED FIELD field is "QUANTITY
"^DD",58.811,58.811259,1,21,4,0)
INVOICED", the adjustment is the positive or negative number to be added
"^DD",58.811,58.811259,1,21,5,0)
to the QUANTITY INVOICED field (#2). If the ADJUSTED FIELD field is "ORDER
"^DD",58.811,58.811259,1,21,6,0)
UNIT", the adjustment is the abbreviation of the unit of order received.
"^DD",58.811,58.811259,1,21,7,0)
If the ADJUSTED FIELD field is "PRICE PER ORDER UNIT", the adjustment is
"^DD",58.811,58.811259,1,21,8,0)
the dollar amount charged for each order unit.
"^DD",58.811,58.811259,1,23,0)
^^6^6^2970923^
"^DD",58.811,58.811259,1,23,1,0)
A "DRUG" adjustment is the internal entry number of the drug in the DRUG
"^DD",58.811,58.811259,1,23,2,0)
file (#50) or a description of supply item. A "QUANTITY INVOICED"
"^DD",58.811,58.811259,1,23,3,0)
adjustment is the positive or negative number to be added to the QUANTITY
"^DD",58.811,58.811259,1,23,4,0)
INVOICED field (#2). An "ORDER UNIT" adjustment is the internal entry
"^DD",58.811,58.811259,1,23,5,0)
number of the unit of measure in the ORDER UNIT file (#51.5). A "PRICE PER
"^DD",58.811,58.811259,1,23,6,0)
ORDER UNIT" adjustment is the dollar amount to be paid for one order unit.
"^DD",58.811,58.811259,1,"DT")
2961220
"^DD",58.811,58.811259,2,0)
PROCESSOR'S REASON^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.811259,2,.1)
Processor's Reason
"^DD",58.811,58.811259,2,3)
Enter the reason the processor made the adjustment.
"^DD",58.811,58.811259,2,21,0)
^^1^1^2961107^^^
"^DD",58.811,58.811259,2,21,1,0)
The PROCESSOR'S REASON field contains reason the adjustment was made.
"^DD",58.811,58.811259,2,"DT")
2961107
"^DD",58.811,58.811259,3,0)
PROCESS DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.811259,3,.1)
Process Date
"^DD",58.811,58.811259,3,3)
Enter the date the processor entered the adjustment.
"^DD",58.811,58.811259,3,21,0)
^^2^2^2961107^^
"^DD",58.811,58.811259,3,21,1,0)
The PROCESS DATE field contains the date the processor made 
"^DD",58.811,58.811259,3,21,2,0)
the adjustment.
"^DD",58.811,58.811259,3,"DT")
2961107
"^DD",58.811,58.811259,4,0)
PROCESSOR^*P200'^VA(200,^0;5^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.811259,4,.1)
Processor
"^DD",58.811,58.811259,4,3)
Enter the name of the processor who entered the adjustment.
"^DD",58.811,58.811259,4,12)
The processor must hold the PSA ORDERS key.
"^DD",58.811,58.811259,4,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.811259,4,21,0)
^^2^2^2961107^^
"^DD",58.811,58.811259,4,21,1,0)
The PROCESSOR field contains the name of the person who entered 
"^DD",58.811,58.811259,4,21,2,0)
the adjustment.
"^DD",58.811,58.811259,4,"DT")
2961107
"^DD",58.811,58.811259,5,0)
VERIFIER ADJUSTMENT^F^^0;6^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.811259,5,.1)
Verifier Adjustment
"^DD",58.811,58.811259,5,3)
Enter the adjustment made by the verifier.
"^DD",58.811,58.811259,5,21,0)
^^9^9^2970923^
"^DD",58.811,58.811259,5,21,1,0)
The VERIFIER ADJUSTMENT field contains the adjustment that the verifier
"^DD",58.811,58.811259,5,21,2,0)
made to the line item. If the ADJUSTED FIELD field (#.01) is "DRUG", the
"^DD",58.811,58.811259,5,21,3,0)
adjustment is the drug received or a description of supply item. If the
"^DD",58.811,58.811259,5,21,4,0)
ADJUSTED FIELD field is "QUANTITY INVOICED", the adjustment is the
"^DD",58.811,58.811259,5,21,5,0)
positive or negative number to be added to the QUANTITY INVOICED field
"^DD",58.811,58.811259,5,21,6,0)
(#2). If the ADJUSTED FIELD field is "ORDER UNIT", the adjustment is the
"^DD",58.811,58.811259,5,21,7,0)
abbreviation of the unit of order received. If the ADJUSTED FIELD field is
"^DD",58.811,58.811259,5,21,8,0)
"PRICE PER ORDER UNIT", the adjustment is the dollar amount charged for
"^DD",58.811,58.811259,5,21,9,0)
each order unit.
"^DD",58.811,58.811259,5,23,0)
^^6^6^2970923^
"^DD",58.811,58.811259,5,23,1,0)
A "DRUG" adjustment is the internal entry number of the drug in the DRUG
"^DD",58.811,58.811259,5,23,2,0)
file (#50) or a description of supply item. A "QUANTITY INVOICED"
"^DD",58.811,58.811259,5,23,3,0)
adjustment is the positive or negative number to be added to the QUANTITY
"^DD",58.811,58.811259,5,23,4,0)
INVOICED field (#2). An "ORDER UNIT" adjustment is the internal entry
"^DD",58.811,58.811259,5,23,5,0)
number of the unit of measure in the ORDER UNIT file (#51.5). A "PRICE PER
"^DD",58.811,58.811259,5,23,6,0)
ORDER UNIT" adjustment is the dollar amount to be paid for one order unit.
"^DD",58.811,58.811259,5,"DT")
2961220
"^DD",58.811,58.811259,6,0)
VERIFIER'S REASON^F^^0;7^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.811259,6,.1)
Verifier's Reason
"^DD",58.811,58.811259,6,3)
Enter the reason the verifier made the adjustment.
"^DD",58.811,58.811259,6,21,0)
^^2^2^2970922^
"^DD",58.811,58.811259,6,21,1,0)
The VERIFIER'S REASON field contains the reason the verifier made the
"^DD",58.811,58.811259,6,21,2,0)
adjustment.
"^DD",58.811,58.811259,6,"DT")
2961107
"^DD",58.811,58.811259,7,0)
VERIFICATION DATE^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.811259,7,.1)
Verification Date
"^DD",58.811,58.811259,7,3)
Enter the date the verifier made the adjustment.
"^DD",58.811,58.811259,7,21,0)
^^2^2^2961107^^
"^DD",58.811,58.811259,7,21,1,0)
The VERIFICATION DATE field contains the date the verifier 
"^DD",58.811,58.811259,7,21,2,0)
made the adjustment.
"^DD",58.811,58.811259,7,"DT")
2961107
"^DD",58.811,58.811259,8,0)
VERIFIER^*P200'^VA(200,^0;9^I $D(^XUSEC("PSA ORDERS",DUZ)) D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",58.811,58.811259,8,.1)
Verifier
"^DD",58.811,58.811259,8,3)
Enter the name of the verifier who made the adjustment.
"^DD",58.811,58.811259,8,12)
The verifier must hold the PSA ORDERS key.
"^DD",58.811,58.811259,8,12.1)
I $D(^XUSEC("PSA ORDERS",DUZ))
"^DD",58.811,58.811259,8,21,0)
^^2^2^2961107^^
"^DD",58.811,58.811259,8,21,1,0)
The VERIFIER field contains the name of the verifier who entered 
"^DD",58.811,58.811259,8,21,2,0)
the adjustment.
"^DD",58.811,58.811259,8,"DT")
2961107
"^DD",58.811,58.81126,0)
CREDITS SUB-FIELD^^3^4
"^DD",58.811,58.81126,0,"DT")
2970228
"^DD",58.811,58.81126,0,"IX","B",58.81126,.01)

"^DD",58.811,58.81126,0,"NM","CREDITS")

"^DD",58.811,58.81126,0,"UP")
58.8112
"^DD",58.811,58.81126,.01,0)
CREDIT MEMO^F^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",58.811,58.81126,.01,.1)
Credit Memo
"^DD",58.811,58.81126,.01,1,0)
^.1
"^DD",58.811,58.81126,.01,1,1,0)
58.81126^B
"^DD",58.811,58.81126,.01,1,1,1)
S ^PSD(58.811,DA(2),1,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",58.811,58.81126,.01,1,1,2)
K ^PSD(58.811,DA(2),1,DA(1),2,"B",$E(X,1,30),DA)
"^DD",58.811,58.81126,.01,1,1,3)
DO NOT DELETE!
"^DD",58.811,58.81126,.01,1,1,"%D",0)
^^1^1^2970522^
"^DD",58.811,58.81126,.01,1,1,"%D",1,0)
This cross-reference is used to locate a credit memo number.
"^DD",58.811,58.81126,.01,3)
Enter the credit memo number. If there is no credit memo number, enter "None".
"^DD",58.811,58.81126,.01,21,0)
^^2^2^2970923^
"^DD",58.811,58.81126,.01,21,1,0)
The CREDIT MEMO field contains the credit memo number issued against the
"^DD",58.811,58.81126,.01,21,2,0)
invoice.
"^DD",58.811,58.81126,.01,"DT")
2961107
"^DD",58.811,58.81126,1,0)
CREDIT DATE^D^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",58.811,58.81126,1,.1)
Credit Date
"^DD",58.811,58.81126,1,3)
Enter the date the credit memo was issued.
"^DD",58.811,58.81126,1,21,0)
^^2^2^2961107^^
"^DD",58.811,58.81126,1,21,1,0)
The CREDIT DATE field contains the date the credit memo
"^DD",58.811,58.81126,1,21,2,0)
was issued.
"^DD",58.811,58.81126,1,"DT")
2961107
"^DD",58.811,58.81126,2,0)
AMOUNT^NJ12,2^^0;3^S:X["$" X=$P(X,"$",2) K:X'?."-".N.1".".2N!(X>999999999)!(X<-999999999) X
"^DD",58.811,58.81126,2,.1)
Amount
"^DD",58.811,58.81126,2,3)
Enter the credit memo amount.
"^DD",58.811,58.81126,2,21,0)
^^1^1^2961107^^
"^DD",58.811,58.81126,2,21,1,0)
The AMOUNT field contains the dollar value of the credit issued.
"^DD",58.811,58.81126,2,"DT")
2970226
"^DD",58.811,58.81126,3,0)
REASON^F^^0;4^K:$L(X)>40!($L(X)<1) X
"^DD",58.811,58.81126,3,.1)
Reason
"^DD",58.811,58.81126,3,3)
Enter the reason the credit was issued. Enter 1-40 characters.
"^DD",58.811,58.81126,3,21,0)
^^2^2^2970227^^^
"^DD",58.811,58.81126,3,21,1,0)
The REASON field contains the explanation why the credit memo was
"^DD",58.811,58.81126,3,21,2,0)
issued.
"^DD",58.811,58.81126,3,"DT")
2970228
"^DIC",58.811,58.811,0)
DRUG ACCOUNTABILITY ORDER^58.811I
"^DIC",58.811,58.811,0,"GL")
^PSD(58.811,
"^DIC",58.811,58.811,"%",0)
^1.005^^0
"^DIC",58.811,58.811,"%D",0)
^^5^5^2970922^
"^DIC",58.811,58.811,"%D",1,0)
The DRUG ACCOUNTABILITY ORDER file contains prime vendor pharmacy 
"^DIC",58.811,58.811,"%D",2,0)
orders with all adjustments. The prime vendor invoice data is 
"^DIC",58.811,58.811,"%D",3,0)
uploaded from the prime vendor. All data is processed and verified
"^DIC",58.811,58.811,"%D",4,0)
before it increments the drug balances in Drug Accountability 
"^DIC",58.811,58.811,"%D",5,0)
pharmacy locations and master vaults.
"^DIC",58.811,"B","DRUG ACCOUNTABILITY ORDER",58.811)

"BLD",6427,6)
^51
**END**
**END**
