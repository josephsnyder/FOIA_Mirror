Released DG*5.3*788 SEQ #708
Extracted from mail message
**KIDS**:DG*5.3*788^

**INSTALL NAME**
DG*5.3*788
"BLD",7654,0)
DG*5.3*788^REGISTRATION^0^3090506^y
"BLD",7654,4,0)
^9.64PA^^
"BLD",7654,6)
1^
"BLD",7654,6.3)
18
"BLD",7654,"KRN",0)
^9.67PA^8989.52^19
"BLD",7654,"KRN",.4,0)
.4
"BLD",7654,"KRN",.401,0)
.401
"BLD",7654,"KRN",.402,0)
.402
"BLD",7654,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",7654,"KRN",.402,"NM",1,0)
DGEN NEACL    FILE #2^2^0
"BLD",7654,"KRN",.402,"NM","B","DGEN NEACL    FILE #2",1)

"BLD",7654,"KRN",.403,0)
.403
"BLD",7654,"KRN",.5,0)
.5
"BLD",7654,"KRN",.84,0)
.84
"BLD",7654,"KRN",3.6,0)
3.6
"BLD",7654,"KRN",3.8,0)
3.8
"BLD",7654,"KRN",9.2,0)
9.2
"BLD",7654,"KRN",9.8,0)
9.8
"BLD",7654,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",7654,"KRN",9.8,"NM",1,0)
DGENA2^^0^B45947101
"BLD",7654,"KRN",9.8,"NM",2,0)
DGENACL^^0^B18382293
"BLD",7654,"KRN",9.8,"NM",3,0)
DGENACL1^^0^B43383479
"BLD",7654,"KRN",9.8,"NM",4,0)
DGENACL2^^0^B18670558
"BLD",7654,"KRN",9.8,"NM",5,0)
DPTLK5^^0^B3881793
"BLD",7654,"KRN",9.8,"NM","B","DGENA2",1)

"BLD",7654,"KRN",9.8,"NM","B","DGENACL",2)

"BLD",7654,"KRN",9.8,"NM","B","DGENACL1",3)

"BLD",7654,"KRN",9.8,"NM","B","DGENACL2",4)

"BLD",7654,"KRN",9.8,"NM","B","DPTLK5",5)

"BLD",7654,"KRN",19,0)
19
"BLD",7654,"KRN",19.1,0)
19.1
"BLD",7654,"KRN",101,0)
101
"BLD",7654,"KRN",409.61,0)
409.61
"BLD",7654,"KRN",771,0)
771
"BLD",7654,"KRN",870,0)
870
"BLD",7654,"KRN",8989.51,0)
8989.51
"BLD",7654,"KRN",8989.52,0)
8989.52
"BLD",7654,"KRN",8994,0)
8994
"BLD",7654,"KRN","B",.4,.4)

"BLD",7654,"KRN","B",.401,.401)

"BLD",7654,"KRN","B",.402,.402)

"BLD",7654,"KRN","B",.403,.403)

"BLD",7654,"KRN","B",.5,.5)

"BLD",7654,"KRN","B",.84,.84)

"BLD",7654,"KRN","B",3.6,3.6)

"BLD",7654,"KRN","B",3.8,3.8)

"BLD",7654,"KRN","B",9.2,9.2)

"BLD",7654,"KRN","B",9.8,9.8)

"BLD",7654,"KRN","B",19,19)

"BLD",7654,"KRN","B",19.1,19.1)

"BLD",7654,"KRN","B",101,101)

"BLD",7654,"KRN","B",409.61,409.61)

"BLD",7654,"KRN","B",771,771)

"BLD",7654,"KRN","B",870,870)

"BLD",7654,"KRN","B",8989.51,8989.51)

"BLD",7654,"KRN","B",8989.52,8989.52)

"BLD",7654,"KRN","B",8994,8994)

"BLD",7654,"QUES",0)
^9.62^^
"BLD",7654,"REQB",0)
^9.611^2^2
"BLD",7654,"REQB",1,0)
DG*5.3*779^2
"BLD",7654,"REQB",2,0)
DG*5.3*675^2
"BLD",7654,"REQB","B","DG*5.3*675",2)

"BLD",7654,"REQB","B","DG*5.3*779",1)

"KRN",.402,2784,-1)
0^1
"KRN",.402,2784,0)
DGEN NEACL^3080814.1041^^2^^^3090209
"KRN",.402,2784,"DIAB",2,0,2,4)
1010.163;"COMMENT"
"KRN",.402,2784,"DIAB",3,0,2,2)
1010.161;"STATUS"
"KRN",.402,2784,"DR",1,2)
N DGFLAG,DGBD,DGAD,DGBC,DGBS,DGAC,DIERR,ZERR,DFNIEN S DIE("NO^")="";S DFNIEN=DA D APPTCK^DGENACL2 S DGFLAG=$$GET1^DIQ(2,DA,1010.159,"I",,"ZERR");I DGFLAG'=1 D EN^DDIOL(">>> NO APPOINTMENT REQUEST ON 1010EZ!!","","!!") S Y="@100";
"KRN",.402,2784,"DR",1,2,1)
D EN^DDIOL("APPOINTMENT REQUEST ON 1010EZ:"_$$GET1^DIQ(2,DA,1010.159)) D EN^DDIOL("//  (no editing)","","?0");D EN^DDIOL("APPOINTMENT REQUEST DATE:"_$$GET1^DIQ(2,DA,1010.1511)) D EN^DDIOL("//  (no editing)","","?0");
"KRN",.402,2784,"DR",1,2,2)
S DGFLAG=$$GET1^DIQ(2,DA,1010.161,,,"ZERR"),DGBS=$$GET1^DIQ(2,DA,1010.161,"I",,"ZERR");I DGFLAG'="" D EN^DDIOL("STATUS: "_DGFLAG) D EN^DDIOL("//  (last edited: "_$$GET1^DIQ(2,DA,1010.162)_")","","?0");1010.161STATUS~;@80;
"KRN",.402,2784,"DR",1,2,3)
S DGFLAG=$$GET1^DIQ(2,DA,1010.163,,,"ZERR"),DGBC=DGFLAG,DGSTA=$$GET1^DIQ(2,DA,1010.161,"I",,"ZERR"),DGBD=$$GET1^DIQ(2,DA,1010.164,"I",,"ZERR");
"KRN",.402,2784,"DR",1,2,4)
I DGFLAG'="" D EN^DDIOL("COMMENT: "_DGFLAG) D EN^DDIOL("//  (last edited: "_$$GET1^DIQ(2,DA,1010.164)_")","","?0");1010.163COMMENT~;S DGAC=$$GET1^DIQ(2,DA,1010.163,,,"ZERR"),DGAD=$$GET1^DIQ(2,DA,1010.164,"I",,"ZERR");
"KRN",.402,2784,"DR",1,2,5)
I (DGSTA="C")&(DGAC="") S Y="@80";I (DGSTA="C")&(DGBS'=DGSTA)&(DGBC=DGAC) S Y="@80";@100;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
788^3090506^100884
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","DGENA2")
0^1^B45947101^B30778847
"RTN","DGENA2",1,0)
DGENA2 ;ALB/CJM,RTK,TDM - Enrollment API - Automatic Update; 9/19/2002 ; 1/31/03 11:54am
"RTN","DGENA2",2,0)
 ;;5.3;Registration;**121,122,147,232,327,469,491,779,788**;Aug 13,1993;Build 18
"RTN","DGENA2",3,0)
 ;
"RTN","DGENA2",4,0)
AUTOUPD(DFN,EVENT) ;
"RTN","DGENA2",5,0)
 ;Description: If the patient meets the criteria for transmission to HEC,
"RTN","DGENA2",6,0)
 ;   he is entered to the IVM PATIENT file for future transmission.
"RTN","DGENA2",7,0)
 ;   This procedure checks for changes in enrollment priority,
"RTN","DGENA2",8,0)
 ;   status and fields in the eligibility sub-record. If any changes are
"RTN","DGENA2",9,0)
 ;   found, the current enrollment record is automatically updated.
"RTN","DGENA2",10,0)
 ;Input:
"RTN","DGENA2",11,0)
 ;  DFN - Patient IEN
"RTN","DGENA2",12,0)
 ;  EVENT - Event Type (optional)
"RTN","DGENA2",13,0)
 ;          EVENT 1 : Date of Death Deleted
"RTN","DGENA2",14,0)
 ;          EVENT 2 : Ineligible Date Deleted
"RTN","DGENA2",15,0)
 ;Output: None
"RTN","DGENA2",16,0)
 ;
"RTN","DGENA2",17,0)
 ;if the eligibility/enrollment upload is in progess, do not do anything
"RTN","DGENA2",18,0)
 Q:($G(DGENUPLD)="ENROLLMENT/ELIGIBILITY UPLOAD IN PROGRESS")
"RTN","DGENA2",19,0)
 ;
"RTN","DGENA2",20,0)
 ; If the INCOME TEST DATA (Z10) upload is in progess, do not do anything
"RTN","DGENA2",21,0)
 Q:($G(IVMZ10)="UPLOAD IN PROGRESS")
"RTN","DGENA2",22,0)
 ;
"RTN","DGENA2",23,0)
 N DGENRIEN,DGENR1,DGENR2,STATUS,EFFDATE,OK,DEATH
"RTN","DGENA2",24,0)
 ;
"RTN","DGENA2",25,0)
 ;try to prevent problems rsulting from calling FM within FM
"RTN","DGENA2",26,0)
 N DS,D0,DO,D1,DA,DD,DS,DG,DIC,DICR,DIE,DIG,DIH,DIV,DIW,DIX,DQ,DR
"RTN","DGENA2",27,0)
 ;
"RTN","DGENA2",28,0)
 S EVENT=+$G(EVENT)
"RTN","DGENA2",29,0)
 ;
"RTN","DGENA2",30,0)
 D EVENT^IVMPLOG(DFN)
"RTN","DGENA2",31,0)
 ;
"RTN","DGENA2",32,0)
 D:$$LOCK^DGENA1($G(DFN))  ;may drop out of block
"RTN","DGENA2",33,0)
 .S DGENRIEN=$$FINDCUR^DGENA(DFN)
"RTN","DGENA2",34,0)
 .Q:'DGENRIEN
"RTN","DGENA2",35,0)
 .Q:'$$GET^DGENA(DGENRIEN,.DGENR1)
"RTN","DGENA2",36,0)
 .S STATUS=$$EXT^DGENU("STATUS",DGENR1("STATUS"))
"RTN","DGENA2",37,0)
 .S (DEATH,EFFDATE)=$$DEATH^DGENPTA(DFN)
"RTN","DGENA2",38,0)
 .I STATUS'="VERIFIED",STATUS'="UNVERIFIED",STATUS'="DECEASED",STATUS'["NOT ELIGIBLE",STATUS'["PENDING",STATUS'["REJECTED" Q
"RTN","DGENA2",39,0)
 .I STATUS="DECEASED",((EVENT'=1)!(DEATH)) Q
"RTN","DGENA2",40,0)
 .I STATUS["NOT ELIGIBLE",((EVENT'=2)!('$$VET^DGENPTA(DFN))) Q
"RTN","DGENA2",41,0)
 .S:'EFFDATE EFFDATE=DT
"RTN","DGENA2",42,0)
 .Q:'$$CREATE^DGENA6(DFN,DGENR1("APP"),EFFDATE,DGENR1("REASON"),DGENR1("REMARKS"),.DGENR2,DGENR1("DATE"),DGENR1("END"))
"RTN","DGENA2",43,0)
 .S OK=1
"RTN","DGENA2",44,0)
 .S:(DGENR1("PRIORITY")'=DGENR2("PRIORITY"))!(DGENR2("STATUS")'=DGENR1("STATUS")) OK=0
"RTN","DGENA2",45,0)
 .I OK D
"RTN","DGENA2",46,0)
 ..N SUB
"RTN","DGENA2",47,0)
 ..S SUB=""
"RTN","DGENA2",48,0)
 ..F  S SUB=$O(DGENR2("ELIG",SUB)) Q:SUB=""  S:(DGENR1("ELIG",SUB)'=DGENR2("ELIG",SUB)) OK=0
"RTN","DGENA2",49,0)
 .I 'OK D
"RTN","DGENA2",50,0)
 ..I (DGENR1("EFFDATE")=DGENR2("EFFDATE")),(DGENR1("SOURCE")=DGENR2("SOURCE")),(DGENR1("USER")=DGENR2("USER")),(DGENR1("DATETIME")\1)=(DGENR2("DATETIME")\1) D
"RTN","DGENA2",51,0)
 ...;in this case it's an overlay
"RTN","DGENA2",52,0)
 ...S DGENR2("PRIORREC")=DGENR1("PRIORREC")
"RTN","DGENA2",53,0)
 ...I $$EDITCUR^DGENA1(.DGENR2)
"RTN","DGENA2",54,0)
 ..E  D
"RTN","DGENA2",55,0)
 ...;in this case create a new record, to preserve the audit trail
"RTN","DGENA2",56,0)
 ...I $$STORECUR^DGENA1(.DGENR2)
"RTN","DGENA2",57,0)
 D UNLOCK^DGENA1($G(DFN))
"RTN","DGENA2",58,0)
 Q
"RTN","DGENA2",59,0)
MTUPD ;
"RTN","DGENA2",60,0)
 ;Description - entry point for Means Test Event Driver for Enrollment
"RTN","DGENA2",61,0)
 ;
"RTN","DGENA2",62,0)
 D AUTOUPD($G(DFN))
"RTN","DGENA2",63,0)
 Q
"RTN","DGENA2",64,0)
 ;
"RTN","DGENA2",65,0)
SDDIS ;Entry point for the DGEN SD DISPLAY CURRENT ENROLLMENT protocol,
"RTN","DGENA2",66,0)
 ;which hangs of the Scheduling Event Driver
"RTN","DGENA2",67,0)
 ;
"RTN","DGENA2",68,0)
 N DFN S DFN=$P($G(SDATA),"^",2)
"RTN","DGENA2",69,0)
 ;
"RTN","DGENA2",70,0)
 ;don't display if running in the background
"RTN","DGENA2",71,0)
 Q:$D(ZTQUEUED)
"RTN","DGENA2",72,0)
 ;
"RTN","DGENA2",73,0)
 ;don't want to display enrollment for non-vets with no enrollment status
"RTN","DGENA2",74,0)
 Q:('$$VET^DGENPTA(DFN))&('$$STATUS^DGENA(DFN))
"RTN","DGENA2",75,0)
 ;
"RTN","DGENA2",76,0)
 ;if making an appt., & in interactive mode, display enrollment status
"RTN","DGENA2",77,0)
 I ($G(SDAMEVT)=1),$G(SDMODE)=0 D
"RTN","DGENA2",78,0)
 .D DISPLAY^DGENU($P($G(SDATA),"^",2))
"RTN","DGENA2",79,0)
 .D PAUSE^VALM1
"RTN","DGENA2",80,0)
 ;
"RTN","DGENA2",81,0)
 ;want to do the same thing for check-in, unless appt just made
"RTN","DGENA2",82,0)
 I ($G(SDAMEVT)=4),$G(SDMODE)=0 D
"RTN","DGENA2",83,0)
 .;want to try avoiding giving display if it was done already
"RTN","DGENA2",84,0)
 .;so, if it is an unscheduled appt made today, skip
"RTN","DGENA2",85,0)
 .N PTNODE,SCNODE
"RTN","DGENA2",86,0)
 .S SCNODE=$G(^TMP("SDAMEVT",$J,"AFTER","SC"))
"RTN","DGENA2",87,0)
 .S PTNODE=$G(^TMP("SDAMEVT",$J,"AFTER","DPT"))
"RTN","DGENA2",88,0)
 .I +$P(SCNODE,"^",7)=$G(DT),$P(PTNODE,"^",7)=4 Q  ;unscheduled appt made today
"RTN","DGENA2",89,0)
 .D DISPLAY^DGENU($P($G(SDATA),"^",2))
"RTN","DGENA2",90,0)
 .D PAUSE^VALM1
"RTN","DGENA2",91,0)
 Q
"RTN","DGENA2",92,0)
 ;
"RTN","DGENA2",93,0)
ENROLL ;Entry point for the DGEN SD ENROLL PATIENT protocol, which hangs of
"RTN","DGENA2",94,0)
 ;the Scheduling Event Driver. This event enrolls patients upon check-out
"RTN","DGENA2",95,0)
 ;if there is no prior enrollment record.
"RTN","DGENA2",96,0)
 ;
"RTN","DGENA2",97,0)
 ; Input  -- SDATA & SDAMEVT defined by the scheduling event driver
"RTN","DGENA2",98,0)
 ; Output -- none
"RTN","DGENA2",99,0)
 ;
"RTN","DGENA2",100,0)
 N DGENR,DFN
"RTN","DGENA2",101,0)
 ;
"RTN","DGENA2",102,0)
 ;NOTE - it appears from testing that means test status REQUIRED is set
"RTN","DGENA2",103,0)
 ;within scheduling, obviating the need to do it here.  This is why
"RTN","DGENA2",104,0)
 ;several lines are commented out.
"RTN","DGENA2",105,0)
 ;
"RTN","DGENA2",106,0)
 ;N DGENR,DGOKF,DGREQF,DFN,DGMSGF,DG,DGMT,DGMTCOR,DGMTE,DGRGAUTO,DGWRT,XMZ,DIG,DIH
"RTN","DGENA2",107,0)
 ;
"RTN","DGENA2",108,0)
 ;appointment made, check if enrollment appointment request needs reset.
"RTN","DGENA2",109,0)
 ;if appointment cancelled, or no-show put back on call list if no appts.
"RTN","DGENA2",110,0)
 I ($G(SDAMEVT)=1)!($G(SDAMEVT)=2)!($G(SDAMEVT)=3) D REQUST(SDAMEVT,SDATA)
"RTN","DGENA2",111,0)
 ;check-out?
"RTN","DGENA2",112,0)
 Q:($G(SDAMEVT)'=5)
"RTN","DGENA2",113,0)
 ;
"RTN","DGENA2",114,0)
 S DFN=$P($G(SDATA),"^",2)
"RTN","DGENA2",115,0)
 ;
"RTN","DGENA2",116,0)
 ;don't enroll if the patient has an enrollment record
"RTN","DGENA2",117,0)
 I $$FINDCUR^DGENA(DFN) Q
"RTN","DGENA2",118,0)
 ;
"RTN","DGENA2",119,0)
 ;non-vet?
"RTN","DGENA2",120,0)
 Q:'$$VET^DGENPTA(DFN)
"RTN","DGENA2",121,0)
 ;
"RTN","DGENA2",122,0)
 ;dead?
"RTN","DGENA2",123,0)
 Q:$$DEATH^DGENPTA(DFN)
"RTN","DGENA2",124,0)
 ;
"RTN","DGENA2",125,0)
 ;Does patient require a Means Test?
"RTN","DGENA2",126,0)
 ;S DGMSGF=1
"RTN","DGENA2",127,0)
 ;D EN^DGMTR
"RTN","DGENA2",128,0)
 ;
"RTN","DGENA2",129,0)
 ;Create local enrollment array
"RTN","DGENA2",130,0)
 I $$CREATE^DGENA6(DFN,DT,,,,.DGENR) D
"RTN","DGENA2",131,0)
 . ;
"RTN","DGENA2",132,0)
 . ;Store local enrollment as current
"RTN","DGENA2",133,0)
 . I $$STORECUR^DGENA1(.DGENR) D
"RTN","DGENA2",134,0)
 . . ;
"RTN","DGENA2",135,0)
 . . ;If patient's means test status is required, send bulletin
"RTN","DGENA2",136,0)
 . . ;I $$MTREQ^DGEN(DFN) D MTBULL^DGEN(DFN,.DGENR)
"RTN","DGENA2",137,0)
 Q
"RTN","DGENA2",138,0)
 ;
"RTN","DGENA2",139,0)
REQUST(SDAMEVT,SDATA) ;
"RTN","DGENA2",140,0)
 ;1. Check if cancelled appt. If no appts found put back on call list.
"RTN","DGENA2",141,0)
 ;2. Automatic collection of Appointment Request Date and Appointment
"RTN","DGENA2",142,0)
 ;Request Response
"RTN","DGENA2",143,0)
 ;- Set when Enrollment Application Date >= 8/1/2005 AND
"RTN","DGENA2",144,0)
 ;-     Appointment Request Date is null. 
"RTN","DGENA2",145,0)
 ;
"RTN","DGENA2",146,0)
 ; Input  -- SDATA and SDAMEVT defined by scheduling event driver
"RTN","DGENA2",147,0)
 ; Output -- none
"RTN","DGENA2",148,0)
 ;
"RTN","DGENA2",149,0)
 N DGENRIEN,DGENR,DPTERR,DGCOM,DGADT,DFN,DGCLN
"RTN","DGENA2",150,0)
 I ($G(SDAMEVT)=2)!($G(SDAMEVT)=3) G CANNS
"RTN","DGENA2",151,0)
 ;apointment made?
"RTN","DGENA2",152,0)
 Q:($G(SDAMEVT)'=1)
"RTN","DGENA2",153,0)
 ;
"RTN","DGENA2",154,0)
 S DFN=$P($G(SDATA),"^",2)
"RTN","DGENA2",155,0)
 S DGADT=$P($G(SDATA),"^",3)
"RTN","DGENA2",156,0)
 S DGCLN=$P($G(SDATA),"^",4)
"RTN","DGENA2",157,0)
 ;get enrollment ien
"RTN","DGENA2",158,0)
 S DGENRIEN=$$FINDCUR^DGENA(DFN)
"RTN","DGENA2",159,0)
 I DGENRIEN,$$GET^DGENA(DGENRIEN,.DGENR) ;set-up enrollment array
"RTN","DGENA2",160,0)
 I $G(DGENR("APP"))>3050731 D
"RTN","DGENA2",161,0)
 . ;and, no appointment request date. Set request="yes", request date 
"RTN","DGENA2",162,0)
 . I '$$GET1^DIQ(2,DFN,1010.1511,"I") D
"RTN","DGENA2",163,0)
 . . ;quit if 'no-count' clinic
"RTN","DGENA2",164,0)
 . . I ($$GET1^DIQ(44,DGCLN,2502,"I")="Y") Q
"RTN","DGENA2",165,0)
 . . ;quit if appt. date/time < date notified of request for appointment
"RTN","DGENA2",166,0)
 . . I DGADT<DT Q
"RTN","DGENA2",167,0)
 . . ;set fields
"RTN","DGENA2",168,0)
 . . N FDATA
"RTN","DGENA2",169,0)
 . . S FDATA(2,DFN_",",1010.159)=1
"RTN","DGENA2",170,0)
 . . S FDATA(2,DFN_",",1010.1511)=DT
"RTN","DGENA2",171,0)
 . . D FILE^DIE("","FDATA","DPTERR")
"RTN","DGENA2",172,0)
 . ;if appointment made, appt. request="yes", request status'="filled"
"RTN","DGENA2",173,0)
 . ;- set request status='filled' w comment
"RTN","DGENA2",174,0)
 . I ($$GET1^DIQ(2,DFN,1010.159,"I")),($$GET1^DIQ(2,DFN,1010.161,"I")'="F") D
"RTN","DGENA2",175,0)
 . . ;set fields
"RTN","DGENA2",176,0)
 . . N FDATA
"RTN","DGENA2",177,0)
 . . S FDATA(2,DFN_",",1010.161)="F"
"RTN","DGENA2",178,0)
 . . S DGCOM=$$GET1^DIQ(2,DFN,1010.163)
"RTN","DGENA2",179,0)
 . . S DGCOM=DGCOM_$S(DGCOM'="":"<>",1:"")_"AutoComm:"_$S($$GET1^DIQ(2,DFN,1010.161,"I")="":"null",1:$S($$GET1^DIQ(2,DFN,1010.161,"I")="I":"IN PROGRESS",1:$$GET1^DIQ(2,DFN,1010.161)))_"|FILLED by Scheduling"
"RTN","DGENA2",180,0)
 . . S FDATA(2,DFN_",",1010.163)=DGCOM
"RTN","DGENA2",181,0)
 . . D FILE^DIE("","FDATA","DPTERR")
"RTN","DGENA2",182,0)
 Q
"RTN","DGENA2",183,0)
 ;
"RTN","DGENA2",184,0)
CANNS ;If appointment cancelled or no-show, no appts made, put back on call list
"RTN","DGENA2",185,0)
 N DGRDTI,SDARRY,SDCNT,FDATA
"RTN","DGENA2",186,0)
 ;
"RTN","DGENA2",187,0)
 S DFN=$P($G(SDATA),"^",2)
"RTN","DGENA2",188,0)
 ;
"RTN","DGENA2",189,0)
 S DGRDTI=$$GET1^DIQ(2,DFN,1010.1511,"I")
"RTN","DGENA2",190,0)
 I 'DGRDTI Q
"RTN","DGENA2",191,0)
 S SDARRY(1)=DGRDTI_";" ;Look out from 'notify of request date' to future.
"RTN","DGENA2",192,0)
 S SDARRY(3)="R;I;NT" ;appointments made
"RTN","DGENA2",193,0)
 S SDARRY(4)=DFN
"RTN","DGENA2",194,0)
 S SDARRY("FLDS")=1
"RTN","DGENA2",195,0)
 S SDCNT=$$SDAPI^SDAMA301(.SDARRY)
"RTN","DGENA2",196,0)
 I SDCNT>0 D  ;If only no-count clinic appts. put on call list
"RTN","DGENA2",197,0)
 . N SDCOUNT,SDCL
"RTN","DGENA2",198,0)
 . S SDCOUNT=0 ; count clinic
"RTN","DGENA2",199,0)
 . S SDCL=0 F  S SDCL=$O(^TMP($J,"SDAMA301",DFN,SDCL)) Q:'SDCL  D  Q:SDCOUNT
"RTN","DGENA2",200,0)
 .. I $$GET1^DIQ(44,SDCL,2502,"I")="Y" Q
"RTN","DGENA2",201,0)
 .. S SDCOUNT=SDCOUNT+1
"RTN","DGENA2",202,0)
 . I SDCOUNT=0 S SDCNT=0  ;if only no-count clinic appts., put on call list
"RTN","DGENA2",203,0)
 I SDCNT=0 D
"RTN","DGENA2",204,0)
 . S FDATA(2,DFN_",",1010.161)="@" ;delete status
"RTN","DGENA2",205,0)
 . S FDATA(2,DFN_",",1010.163)="@" ;delete comment
"RTN","DGENA2",206,0)
 . D FILE^DIE("","FDATA","DPTERR")
"RTN","DGENA2",207,0)
 Q
"RTN","DGENACL")
0^2^B18382293^B29975193
"RTN","DGENACL",1,0)
DGENACL ;ALB/MRY - NEW ENROLLEE APPOINTMENT CALL LIST - UPDATE ;02/15/2008
"RTN","DGENACL",2,0)
 ;;5.3;Registration;**779,788**;08/13/93;Build 18
"RTN","DGENACL",3,0)
 ;
"RTN","DGENACL",4,0)
EDIT ;-Entry point - Edit Appointment Request Status and Comment option
"RTN","DGENACL",5,0)
 N DIC,DIE,DA,DR,Y,DFN
"RTN","DGENACL",6,0)
 S DIC="^DPT(",DIC(0)="AEQMZ" D ^DIC G Q:Y'>0 S DFN=+Y
"RTN","DGENACL",7,0)
 S DIE=DIC,DA=+Y,DR="[DGEN NEACL]" D ^DIE W !!
"RTN","DGENACL",8,0)
 G EDIT
"RTN","DGENACL",9,0)
Q Q
"RTN","DGENACL",10,0)
 ;
"RTN","DGENACL",11,0)
REPORT(DGRPT) ;-Entry point - Call List/Tracking reports
"RTN","DGENACL",12,0)
 ;
"RTN","DGENACL",13,0)
 ; DGRPT: 1 = Call List: New enrollee appt. request/no appt. assigned.
"RTN","DGENACL",14,0)
 ;        2 = Tracking Report: New enrollee appt. request/by date range
"RTN","DGENACL",15,0)
 ;
"RTN","DGENACL",16,0)
 N DGBEG,DGEND,DTOUT,DUOUT,DIRUT,DGFMT1,DGFMT2,DGERROR,DGPFTF,DGPFTFLG,DGSITE
"RTN","DGENACL",17,0)
 S (DGBEG,DGEND,DGERROR)="",DGSITE=+$$SITE^VASITE()
"RTN","DGENACL",18,0)
 I $G(DGRPT)'=1&($G(DGRPT)'=2) G Q
"RTN","DGENACL",19,0)
 I DGRPT=1 D FMT1 I $D(DTOUT)!($D(DUOUT)) G Q
"RTN","DGENACL",20,0)
 I DGRPT=2 D FMT2 I $D(DTOUT)!($D(DUOUT)) G Q
"RTN","DGENACL",21,0)
 D PFTF I $D(DTOUT)!($D(DUOUT)) G Q
"RTN","DGENACL",22,0)
 I DGPFTFLG,'$O(DGPFTF("")) G Q
"RTN","DGENACL",23,0)
 N ZTDESC,ZTRTN,ZTSAVE,ZTSK,ZUSR,ZTDTH,POP,X,ERR,V
"RTN","DGENACL",24,0)
 K IOP,%ZIS
"RTN","DGENACL",25,0)
 S %ZIS="Q" D ^%ZIS G:POP EXIT
"RTN","DGENACL",26,0)
 I $D(IO("Q")) D  Q
"RTN","DGENACL",27,0)
 . F V="DGSITE","DGRPT","DGFMT1","DGFMT2","DGBEG","DGEND","DGPFTF(","DGERROR","DGPFTFLG" S ZTSAVE(V)=""
"RTN","DGENACL",28,0)
 . S ZTRTN="BUILD^DGENACL",ZTDESC="NEW ENROLLEE APPT. CALL LIST REPORT",ZTDTH=$H
"RTN","DGENACL",29,0)
 . D ^%ZTLOAD
"RTN","DGENACL",30,0)
 . D ^%ZISC,HOME^%ZIS
"RTN","DGENACL",31,0)
 . W !,$S($D(ZTSK):"REQUEST QUEUED!",1:"REQUEST CANCELLED!")
"RTN","DGENACL",32,0)
 D BUILD
"RTN","DGENACL",33,0)
EXIT D ^%ZISC,HOME^%ZIS
"RTN","DGENACL",34,0)
 Q
"RTN","DGENACL",35,0)
 ;
"RTN","DGENACL",36,0)
BUILD ;-Build temp global
"RTN","DGENACL",37,0)
 K ^TMP($J,"DGEN NEACL")
"RTN","DGENACL",38,0)
 N DFNIEN,DGDT,DGEDT
"RTN","DGENACL",39,0)
 I DGRPT=1 S DFNIEN=0 F  S DFNIEN=$O(^DPT("AEAR",1,DFNIEN)) Q:'DFNIEN  D  Q:+DGERROR
"RTN","DGENACL",40,0)
 . I $$GET1^DIQ(2,DFNIEN,1010.159,"I") D EXTRACT
"RTN","DGENACL",41,0)
 I DGRPT=2 D
"RTN","DGENACL",42,0)
 . S DGDT=DGBEG-.01,DGEDT=DGEND_.999
"RTN","DGENACL",43,0)
 . F  S DGDT=$O(^DPT("AEACL",DGDT)) Q:'DGDT!(DGDT>DGEDT)  D  Q:+DGERROR
"RTN","DGENACL",44,0)
 .. S DFNIEN=0 F  S DFNIEN=$O(^DPT("AEACL",DGDT,DFNIEN)) Q:'DFNIEN  D  Q:+DGERROR
"RTN","DGENACL",45,0)
 ... I $$GET1^DIQ(2,DFNIEN,1010.159,"I") D EXTRACT
"RTN","DGENACL",46,0)
 D PRINT^DGENACL1
"RTN","DGENACL",47,0)
 Q
"RTN","DGENACL",48,0)
 ;
"RTN","DGENACL",49,0)
EXTRACT ;
"RTN","DGENACL",50,0)
 D EXTRACT^DGENACL2
"RTN","DGENACL",51,0)
 Q
"RTN","DGENACL",52,0)
 ;
"RTN","DGENACL",53,0)
DATE N X1,X2
"RTN","DGENACL",54,0)
 S DIR(0)="DAO^,"_DT_",::EX"
"RTN","DGENACL",55,0)
 S X1=DT,X2=-7 D C^%DTC
"RTN","DGENACL",56,0)
 S Y=X D DD^%DT
"RTN","DGENACL",57,0)
 S DIR("A")="APPOINTMENT REQUEST ON 1010EZ START DATE: "
"RTN","DGENACL",58,0)
 S DIR("B")=Y
"RTN","DGENACL",59,0)
 S DIR("?")="Enter a date that an enrollee was asked question."
"RTN","DGENACL",60,0)
 D ^DIR K DIR
"RTN","DGENACL",61,0)
 I $D(DIRUT) S DTOUT=1
"RTN","DGENACL",62,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGENACL",63,0)
 S DGBEG=Y
"RTN","DGENACL",64,0)
 S DIR(0)="DAO^"_DGBEG_","_DT_"::EX"
"RTN","DGENACL",65,0)
 S Y=DT D DD^%DT S DGDT=Y
"RTN","DGENACL",66,0)
 S DIR("B")=DGDT
"RTN","DGENACL",67,0)
 S DIR("A")="APPOINTMENT REQUEST ON 1010EZ END DATE: "
"RTN","DGENACL",68,0)
 S DIR("?")="Enter a date that an enrollee was asked question."
"RTN","DGENACL",69,0)
 D ^DIR K DIR
"RTN","DGENACL",70,0)
 I $D(DIRUT) S DTOUT=1
"RTN","DGENACL",71,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGENACL",72,0)
 S DGEND=Y
"RTN","DGENACL",73,0)
 I $G(DGBEG)']""!($G(DGEND)']"") W !!,"DATE RANGE NOT SET.  EXITING"  S DUOUT=1
"RTN","DGENACL",74,0)
 Q
"RTN","DGENACL",75,0)
FMT1 ;Call List D/S
"RTN","DGENACL",76,0)
 N DIR
"RTN","DGENACL",77,0)
 K DIR S DIR("A")="Select report format",DIR(0)="S^D:DETAILED;S:SHORT"
"RTN","DGENACL",78,0)
 S DIR("?",1)="SHORT format lists enrollee appointment requests w/o an appointment."
"RTN","DGENACL",79,0)
 S DIR("?")="DETAILED format, in addition, lists patient lookup information."
"RTN","DGENACL",80,0)
 S DIR("B")="SHORT" D ^DIR K DIR
"RTN","DGENACL",81,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGENACL",82,0)
 S DGFMT1=Y
"RTN","DGENACL",83,0)
 Q
"RTN","DGENACL",84,0)
FMT2 ;Tracking Report D/S
"RTN","DGENACL",85,0)
 N DIR
"RTN","DGENACL",86,0)
 K DIR S DIR("A")="Select report format",DIR(0)="S^D:DETAILED;S:SUMMARY"
"RTN","DGENACL",87,0)
 S DIR("?",1)="SUMMARY format lists totals of enrollee appointment requests."
"RTN","DGENACL",88,0)
 S DIR("?")="DETAILED format, lists individual enrollee appointment requests."
"RTN","DGENACL",89,0)
 S DIR("B")="SUMMARY" D ^DIR K DIR
"RTN","DGENACL",90,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGENACL",91,0)
 S DGFMT2=Y
"RTN","DGENACL",92,0)
 D DATE
"RTN","DGENACL",93,0)
 Q
"RTN","DGENACL",94,0)
PFTF ;Ask Preferred Facility?
"RTN","DGENACL",95,0)
 S DGPFTFLG=0
"RTN","DGENACL",96,0)
 S DIR("A")="Select individual Preferred Facilities",DIR(0)="Y",DIR("B")="NO"
"RTN","DGENACL",97,0)
 D ^DIR K DIR
"RTN","DGENACL",98,0)
 I $D(DTOUT)!($D(DUOUT)) Q
"RTN","DGENACL",99,0)
 I Y=1 S DGPFTFLG=1
"RTN","DGENACL",100,0)
 I DGPFTFLG D
"RTN","DGENACL",101,0)
 . K DGPFTF
"RTN","DGENACL",102,0)
 . S DIR("A")="Preferred Facility",DIR(0)="PO^4:EMZ",DIR("S")="I $$PFTF^DGREGDD(Y),(+DGSITE=+$$GET1^DIQ(4,Y,99))"
"RTN","DGENACL",103,0)
 . F  D ^DIR Q:(+Y<0)!($D(DTOUT))!($D(DUOUT))  S DGPFTF(+Y)=""
"RTN","DGENACL",104,0)
 Q
"RTN","DGENACL",105,0)
BCKJOB(DGRPT) ;Queued entry point
"RTN","DGENACL",106,0)
 N DGERROR,DGPFTFLG,DGFMT1,DGSITE
"RTN","DGENACL",107,0)
 S DGRPT=$G(DGRPT) I DGRPT'=1 Q
"RTN","DGENACL",108,0)
 S DGFMT1="D"
"RTN","DGENACL",109,0)
 S (DGERROR,DGPFTFLG)="",DGSITE=+$$SITE^VASITE()
"RTN","DGENACL",110,0)
 D BUILD
"RTN","DGENACL",111,0)
 Q
"RTN","DGENACL",112,0)
 ;
"RTN","DGENACL1")
0^3^B43383479^B36626109
"RTN","DGENACL1",1,0)
DGENACL1 ;ALB/MRY - NEW ENROLLEE APPOINTMENT CALL LIST - UPDATE ;02/15/2008
"RTN","DGENACL1",2,0)
 ;;5.3;Registration;**779,788**;08/13/93;Build 18
"RTN","DGENACL1",3,0)
 ;
"RTN","DGENACL1",4,0)
PRINT N DGLN,PAGE,QUIT,DGTOTAL
"RTN","DGENACL1",5,0)
 S QUIT=""
"RTN","DGENACL1",6,0)
 U IO
"RTN","DGENACL1",7,0)
 I $E(IOST,1,2)="C-" D EN^DDIOL("","","@IOF")
"RTN","DGENACL1",8,0)
 S DGLN=0
"RTN","DGENACL1",9,0)
 S PAGE=1
"RTN","DGENACL1",10,0)
 D HEADER:'DGPFTFLG
"RTN","DGENACL1",11,0)
 D DATA
"RTN","DGENACL1",12,0)
 I DGLN=0 D
"RTN","DGENACL1",13,0)
 . D EN^DDIOL("No data to report.","","!!!?30")
"RTN","DGENACL1",14,0)
 . I $E(IOST,1,2)="C-" D PAUSE
"RTN","DGENACL1",15,0)
 I ('DGPFTFLG),(DGLN>0),('QUIT) D SUMARY
"RTN","DGENACL1",16,0)
 Q
"RTN","DGENACL1",17,0)
 ;
"RTN","DGENACL1",18,0)
HEADER ;
"RTN","DGENACL1",19,0)
 N DG1,DG2,Y
"RTN","DGENACL1",20,0)
 I DGRPT=1 D
"RTN","DGENACL1",21,0)
 . D EN^DDIOL("NEW ENROLLEE APPOINTMENT REQUEST CALL LIST","","!?15")
"RTN","DGENACL1",22,0)
 . S Y=DT D DD^%DT D EN^DDIOL("Date: "_Y,"","?60")
"RTN","DGENACL1",23,0)
 . D EN^DDIOL("Page: "_PAGE,"","!?60")
"RTN","DGENACL1",24,0)
 . D:DGPFTFLG EN^DDIOL("PREFERRED FACILITY: "_DGPFTF,"","!!") D EN^DDIOL("","","!!")
"RTN","DGENACL1",25,0)
 . I ($G(DGFMT1)="S") D
"RTN","DGENACL1",26,0)
 . . D EN^DDIOL("1010EZ APPT.","","?30"),EN^DDIOL("REQ","","?45"),EN^DDIOL("RESIDENCE","","?52"),EN^DDIOL("CELLULAR","","?67")
"RTN","DGENACL1",27,0)
 . . D EN^DDIOL("NAME(SSN)"),EN^DDIOL("REQUEST DATE","","?30"),EN^DDIOL("STA","","?45"),EN^DDIOL("PHONE","","?54"),EN^DDIOL("PHONE","","?68")
"RTN","DGENACL1",28,0)
 . . D EN^DDIOL("","","!")
"RTN","DGENACL1",29,0)
 I DGRPT=2 D
"RTN","DGENACL1",30,0)
 . S Y=DGBEG D DD^%DT S DG1=Y
"RTN","DGENACL1",31,0)
 . S Y=DGEND D DD^%DT S DG2=Y
"RTN","DGENACL1",32,0)
 . D EN^DDIOL("NEW ENROLLEE APPOINTMENT REQUEST TRACKING REPORT","","!?10")
"RTN","DGENACL1",33,0)
 . S Y=DT D DD^%DT D EN^DDIOL("Date: "_Y,"","?60")
"RTN","DGENACL1",34,0)
 . D EN^DDIOL(DG1_" TO "_DG2,"","!?20"),EN^DDIOL("Page: "_PAGE,"","?60")
"RTN","DGENACL1",35,0)
 . D:DGPFTFLG EN^DDIOL("PREFERRED FACILITY: "_DGPFTF,"","!!")
"RTN","DGENACL1",36,0)
 . I ($G(DGFMT2)="D") D
"RTN","DGENACL1",37,0)
 . . D EN^DDIOL("1010EZ APPT.","","!!?37"),EN^DDIOL("SCHEDULED","","?54"),EN^DDIOL("#","","?71"),EN^DDIOL("REQ","","?76")
"RTN","DGENACL1",38,0)
 . . D EN^DDIOL("NAME"),EN^DDIOL("EP/CV","","?31"),EN^DDIOL("REQUEST DATE","","?37"),EN^DDIOL("APPOINTMENT DATE","","?51"),EN^DDIOL("DAYS","","?70"),EN^DDIOL("STA","","?76")
"RTN","DGENACL1",39,0)
 . . D EN^DDIOL("============================"),EN^DDIOL("=====","","?31"),EN^DDIOL("============","","?37"),EN^DDIOL("==================","","?51"),EN^DDIOL("====","","?70"),EN^DDIOL("===","","?76")
"RTN","DGENACL1",40,0)
 I +DGERROR D  Q
"RTN","DGENACL1",41,0)
 . D EN^DDIOL($P(DGERROR,"^",2),"","!!!")
"RTN","DGENACL1",42,0)
 . I $E(IOST,1,2)="C-" D PAUSE
"RTN","DGENACL1",43,0)
 S PAGE=PAGE+1
"RTN","DGENACL1",44,0)
 Q
"RTN","DGENACL1",45,0)
DATA ;
"RTN","DGENACL1",46,0)
 N DFN,DGNAM,DGSSN,DGI,DATAEP,DGFLG,DGRDTI,DGDAYS,DFNIEN,SDADTI,SDADT,DGDAYS,DGENPRI,DGENCVEL,DATA3,DGSTA
"RTN","DGENACL1",47,0)
 F DGI="C","E","F","I","NULL" S DGTOTAL(DGI)=0
"RTN","DGENACL1",48,0)
 S DGPFTF=""
"RTN","DGENACL1",49,0)
 F  S DGPFTF=$O(^TMP($J,"DGEN NEACL",DGPFTF)) Q:(DGPFTF="")  D  Q:QUIT
"RTN","DGENACL1",50,0)
 . I DGPFTFLG F DGI="C","E","F","I","NULL" S DGTOTAL(DGI)=0
"RTN","DGENACL1",51,0)
 . D TOP:((DGPFTFLG)&(PAGE>1)) D HEADER:((DGPFTFLG)&(PAGE=1))
"RTN","DGENACL1",52,0)
 . S DGI=0
"RTN","DGENACL1",53,0)
 . F  S DGI=$O(^TMP($J,"DGEN NEACL",DGPFTF,DGI)) Q:(DGI="")  D  Q:QUIT
"RTN","DGENACL1",54,0)
 .. S DGRDTI=0 F  S DGRDTI=$O(^TMP($J,"DGEN NEACL",DGPFTF,DGI,DGRDTI)) Q:'DGRDTI  D  Q:QUIT
"RTN","DGENACL1",55,0)
 ... S DGNAM="" F  S DGNAM=$O(^TMP($J,"DGEN NEACL",DGPFTF,DGI,DGRDTI,DGNAM)) Q:DGNAM=""  D  Q:QUIT
"RTN","DGENACL1",56,0)
 .... S DFNIEN="" F  S DFNIEN=$O(^TMP($J,"DGEN NEACL",DGPFTF,DGI,DGRDTI,DGNAM,DFNIEN)) Q:DFNIEN=""  D  Q:QUIT
"RTN","DGENACL1",57,0)
 ..... S SDADTI=$G(^TMP($J,"DGEN NEACL",DGPFTF,DGI,DGRDTI,DGNAM,DFNIEN))
"RTN","DGENACL1",58,0)
 ..... S DGSTA=$$GET1^DIQ(2,DFNIEN,1010.161,"I") I DGSTA="" S DGSTA="NULL"
"RTN","DGENACL1",59,0)
 ..... I DGSTA="C" S SDADTI=$$GET1^DIQ(2,DFNIEN,1010.162,"I")
"RTN","DGENACL1",60,0)
 ..... S DGDAYS=$$DAYS(SDADTI,DGRDTI) S Y=SDADTI X ^DD("DD") S SDADT=Y
"RTN","DGENACL1",61,0)
 ..... S DGFLG=0 I 'SDADTI S DGFLG=1
"RTN","DGENACL1",62,0)
 ..... S DATAEP=$G(^TMP($J,"DGEN NEACL",DGPFTF,DGI,DGRDTI,DGNAM,DFNIEN,"PRIORITY"))
"RTN","DGENACL1",63,0)
 ..... S DGENPRI=$P(DATAEP,"^",3),DGENCVEL=$P(DATAEP,"^",4)
"RTN","DGENACL1",64,0)
 ..... S DATA3="/" S:+DGENPRI $P(DATA3,"/")=$E("  ",$L(+DGENPRI)+1,2)_+DGENPRI S:DGENCVEL $P(DATA3,"/",2)="EL" I DATA3="/" S DATA3=""
"RTN","DGENACL1",65,0)
 ..... S DGTOTAL(DGSTA)=DGTOTAL(DGSTA)+1
"RTN","DGENACL1",66,0)
 ..... D ADD I '(QUIT) D LINE
"RTN","DGENACL1",67,0)
 . I DGPFTFLG D SUMARY I $E(IOST,1,2)="C-" D PAUSE
"RTN","DGENACL1",68,0)
 Q
"RTN","DGENACL1",69,0)
PAUSE ;
"RTN","DGENACL1",70,0)
 N DIR,DIRUT,X,Y
"RTN","DGENACL1",71,0)
 F  Q:$Y>(IOSL-3)  W !
"RTN","DGENACL1",72,0)
 S DIR(0)="E"
"RTN","DGENACL1",73,0)
 D ^DIR
"RTN","DGENACL1",74,0)
 I ('(+Y))!($D(DIRUT)) S QUIT=1
"RTN","DGENACL1",75,0)
 Q
"RTN","DGENACL1",76,0)
TOP ;
"RTN","DGENACL1",77,0)
 D EN^DDIOL("","","@IOF")
"RTN","DGENACL1",78,0)
 D HEADER
"RTN","DGENACL1",79,0)
 Q
"RTN","DGENACL1",80,0)
ADD ;
"RTN","DGENACL1",81,0)
 I $E(IOST,1,2)="C-",($Y>(IOSL-3)) D
"RTN","DGENACL1",82,0)
 . D PAUSE
"RTN","DGENACL1",83,0)
 . Q:QUIT
"RTN","DGENACL1",84,0)
 . D TOP
"RTN","DGENACL1",85,0)
 I $E(IOST,1,2)'="C-",($Y>(IOSL-3)) D TOP
"RTN","DGENACL1",86,0)
 Q
"RTN","DGENACL1",87,0)
LINE ;add a line to the report
"RTN","DGENACL1",88,0)
 N DGNAMX,DPTDFN,DGCMT
"RTN","DGENACL1",89,0)
 I DGRPT=2 S DGNAMX=$P(DGNAM,",")
"RTN","DGENACL1",90,0)
 E  S DGNAMX=DGNAM
"RTN","DGENACL1",91,0)
 S DGNAMX=DGNAMX_"("_$E($$GET1^DIQ(2,DFNIEN,.09),6,9)_")"
"RTN","DGENACL1",92,0)
 I DGRPT=1,($G(DGFMT1)="D") D
"RTN","DGENACL1",93,0)
 . D EN^DDIOL(DGNAMX,"","!") D ADD Q:QUIT
"RTN","DGENACL1",94,0)
 . S (Y,DPTDFN)=DFNIEN
"RTN","DGENACL1",95,0)
 . I $$TESTPAT^VADPT(+Y) D EN^DDIOL("WARNING : You have selected a test patient."),ADD Q:QUIT
"RTN","DGENACL1",96,0)
 . I $$BADADR^DGUTL3(+Y) D EN^DDIOL("WARNING : ** This patient has been flagged with a Bad Address Indicator."),ADD Q:QUIT
"RTN","DGENACL1",97,0)
 . I $D(^DPT("AXFFP",1,+Y)) S DGCLIST=1 D FFP^DPTLK5 K DGCLIST D ADD Q:QUIT
"RTN","DGENACL1",98,0)
 . D ENR^DPTLK,ADD Q:QUIT
"RTN","DGENACL1",99,0)
 . D CV^DPTLK,ADD Q:QUIT
"RTN","DGENACL1",100,0)
 . D EN^DDIOL("1010EZ APPT. REQUEST DATE: ") D EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.1511),"","?28") D ADD Q:QUIT
"RTN","DGENACL1",101,0)
 . D EN^DDIOL("REQUEST STATUS: ") D EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.161),"","?18") D ADD Q:QUIT
"RTN","DGENACL1",102,0)
 . D EN^DDIOL("COMMENT: "_$$GET1^DIQ(2,DFNIEN,1010.163)) D ADD Q:QUIT
"RTN","DGENACL1",103,0)
 . D EN^DDIOL("PHONE [RESIDENCE]: "_$$GET1^DIQ(2,DFNIEN,.131))
"RTN","DGENACL1",104,0)
 . D EN^DDIOL("PHONE [CELLULAR]: "_$$GET1^DIQ(2,DFNIEN,.134),"","?44") D ADD Q:QUIT
"RTN","DGENACL1",105,0)
 . D EN^DDIOL("PREFERRED FACILITY: "_DGPFTF) D ADD Q:QUIT
"RTN","DGENACL1",106,0)
 . ;D EN^DDIOL("PREFERRED FACILITY: "_$$GET1^DIQ(2,DFNIEN,27.02)) D ADD Q:QUIT
"RTN","DGENACL1",107,0)
 . D EN^DDIOL("---------------------------------------------------------------","","!?4") D ADD Q:QUIT
"RTN","DGENACL1",108,0)
 I DGRPT=1,($G(DGFMT1)="S") D  Q:QUIT
"RTN","DGENACL1",109,0)
 . D EN^DDIOL(DGNAMX) I $L(DGNAMX)>29 D EN^DDIOL("","","!") D ADD Q:QUIT
"RTN","DGENACL1",110,0)
 . D EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.1511),"","?30")
"RTN","DGENACL1",111,0)
 . D EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.161,"I"),"","?46")
"RTN","DGENACL1",112,0)
 . D EN^DDIOL($$GET1^DIQ(2,DFNIEN,.131),"","?51")
"RTN","DGENACL1",113,0)
 . D EN^DDIOL($$GET1^DIQ(2,DFNIEN,.134),"","?66")
"RTN","DGENACL1",114,0)
 . D ADD Q:QUIT
"RTN","DGENACL1",115,0)
 I DGRPT=2,($G(DGFMT2)="D") D
"RTN","DGENACL1",116,0)
 . D EN^DDIOL(DGNAMX) I $L(DGNAMX)>29 D EN^DDIOL("","","!") D ADD Q:QUIT
"RTN","DGENACL1",117,0)
 . D EN^DDIOL(DATA3,"","?31"),EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.1511),"","?37"),EN^DDIOL(SDADT,"","?51"),EN^DDIOL($J(DGDAYS,3)_$S(DGFLG:"*",1:""),"","?71"),EN^DDIOL($$GET1^DIQ(2,DFNIEN,1010.161,"I"),"","?77") D ADD Q:QUIT
"RTN","DGENACL1",118,0)
 . S DGCMT=$$GET1^DIQ(2,DFNIEN,1010.163) I $G(DGCMT)'="" D EN^DDIOL("COMMENT: "_DGCMT,"","!?3") D ADD Q:QUIT
"RTN","DGENACL1",119,0)
 S DGLN=1
"RTN","DGENACL1",120,0)
 Q
"RTN","DGENACL1",121,0)
 ;
"RTN","DGENACL1",122,0)
SUMARY ;display totals
"RTN","DGENACL1",123,0)
 ;K DGFMT1 S DGFMT2="S"
"RTN","DGENACL1",124,0)
 D ADD2 Q:QUIT
"RTN","DGENACL1",125,0)
 D EN^DDIOL("SUMMARY","","!!!")
"RTN","DGENACL1",126,0)
 D EN^DDIOL("==============================================================================")
"RTN","DGENACL1",127,0)
 S DGI="" F  S DGI=$O(DGTOTAL(DGI)) Q:DGI=""  D
"RTN","DGENACL1",128,0)
 . I (DGRPT=1)&((DGI="C")!(DGI="F")) Q
"RTN","DGENACL1",129,0)
 . D EN^DDIOL("Total number of veteran's "_$S(DGI="NULL":"",1:"with ")_$S(DGI="C":"CANCELLED",DGI="E":"EWL",DGI="F":"FILLED",DGI="I":"CONTACTED - IN PROCESS",1:"PENDING ACTION")_$S(DGI="NULL":"",1:" request status"))
"RTN","DGENACL1",130,0)
 . D EN^DDIOL($J(DGTOTAL(DGI),4),"","?73")
"RTN","DGENACL1",131,0)
 Q
"RTN","DGENACL1",132,0)
 ;
"RTN","DGENACL1",133,0)
ADD2 ;
"RTN","DGENACL1",134,0)
 I $E(IOST,1,2)="C-",($Y>(IOSL-8)) D
"RTN","DGENACL1",135,0)
 . D PAUSE
"RTN","DGENACL1",136,0)
 . Q:QUIT
"RTN","DGENACL1",137,0)
 . D TOP
"RTN","DGENACL1",138,0)
 I $E(IOST,1,2)'="C-",($Y>(IOSL-8)) D TOP
"RTN","DGENACL1",139,0)
 Q
"RTN","DGENACL1",140,0)
DAYS(X1,X2) ;Compute # of days
"RTN","DGENACL1",141,0)
 S X1=$G(X1),X2=$G(X2)
"RTN","DGENACL1",142,0)
 I X1="" S X1=DT
"RTN","DGENACL1",143,0)
 D ^%DTC
"RTN","DGENACL1",144,0)
 Q X
"RTN","DGENACL1",145,0)
Q Q
"RTN","DGENACL2")
0^4^B18670558^n/a
"RTN","DGENACL2",1,0)
DGENACL2 ;ALB/MRY - NEW ENROLLEE APPOINTMENT CALL LIST - UPDATE ;08/14/2008
"RTN","DGENACL2",2,0)
 ;;5.3;Registration;**788**;08/13/93;Build 18
"RTN","DGENACL2",3,0)
 ;
"RTN","DGENACL2",4,0)
EXTRACT ;
"RTN","DGENACL2",5,0)
 N DGNAM,DGSSN,DGENRIEN,DGENR,DGENCAT,DGENSTA,DGSTA1,DGENPRI,DGENCV,DGENCVDT,DGENCVEL,DGCOM,DGPFSITE
"RTN","DGENACL2",6,0)
 N SDCNT,SDADT,SDARRY,SDCL,Y,FDATA,SDEXIT,DGRDTI,DGSTA
"RTN","DGENACL2",7,0)
 ;get preferred facility
"RTN","DGENACL2",8,0)
 S DGPFSITE=$$GET1^DIQ(4,+$$GET1^DIQ(2,DFNIEN,27.02,"I"),99)
"RTN","DGENACL2",9,0)
 S DGPFTF=$S(+$$GET1^DIQ(2,DFNIEN,27.02,"I"):$$GET1^DIQ(2,DFNIEN,27.02,"I"),1:"NULL")
"RTN","DGENACL2",10,0)
 I +DGSITE'=+DGPFSITE Q  ;if not same division skip
"RTN","DGENACL2",11,0)
 I DGPFTFLG=1,'$D(DGPFTF(DGPFTF)) Q  ;selection of preferred facilities
"RTN","DGENACL2",12,0)
 ;get enrollment information
"RTN","DGENACL2",13,0)
 S DGENRIEN=$$FINDCUR^DGENA(DFNIEN)
"RTN","DGENACL2",14,0)
 I DGENRIEN,$$GET^DGENA(DGENRIEN,.DGENR) ;set-up enrollment arry
"RTN","DGENACL2",15,0)
 I $G(DGENR("APP"))<3050801 Q
"RTN","DGENACL2",16,0)
 S DGENCAT=$$CATEGORY^DGENA4(,$G(DGENR("STATUS"))) ;enrollment category
"RTN","DGENACL2",17,0)
 I DGENCAT'="E" Q
"RTN","DGENACL2",18,0)
 S DGENCAT=$$EXTERNAL^DILFD(27.15,.02,"",DGENCAT)
"RTN","DGENACL2",19,0)
 S DGENSTA=$S($G(DGENR("STATUS")):$$EXT^DGENU("STATUS",DGENR("STATUS")),1:"")
"RTN","DGENACL2",20,0)
 S DGENPRI=$S($G(DGENR("PRIORITY")):DGENR("PRIORITY"),1:"")_$S($G(DGENR("SUBGRP")):$$EXT^DGENU("SUBGRP",DGENR("SUBGRP")),1:"")
"RTN","DGENACL2",21,0)
 D APPTCK ;check appts.
"RTN","DGENACL2",22,0)
 I +DGERROR Q  ;RSA API error
"RTN","DGENACL2",23,0)
 I SDEXIT Q  ;quit if appointment < 'date notified of request date'.
"RTN","DGENACL2",24,0)
 ;if call list, quit if request status 'filled' or 'completed'.
"RTN","DGENACL2",25,0)
 I DGRPT=1 Q:(SDCNT>0)!(DGSTA="C")!(DGSTA="F")
"RTN","DGENACL2",26,0)
 S SDADT=$G(SDADT)
"RTN","DGENACL2",27,0)
 S DGNAM=$$GET1^DIQ(2,DFNIEN,.01),DGSSN=$E($$GET1^DIQ(2,DFNIEN,.09),6,9)
"RTN","DGENACL2",28,0)
 S DGENCV=$$CVEDT^DGCV(DFNIEN),DGENCVDT=$P($G(DGENCV),"^",2),DGENCVEL=$P($G(DGENCV),"^",3)
"RTN","DGENACL2",29,0)
 ;build temp file
"RTN","DGENACL2",30,0)
 S DGPFTF=$S(+DGPFTF:$$GET1^DIQ(4,DGPFTF,.01)_"("_DGPFSITE_")",1:"ZZZZZ")
"RTN","DGENACL2",31,0)
 S DGSTA1=$S(DGSTA="":1,DGSTA="I":2,DGSTA="E":3,DGSTA="F":4,1:DGSTA)
"RTN","DGENACL2",32,0)
 S ^TMP($J,"DGEN NEACL",DGPFTF,DGSTA1,DGRDTI,DGNAM,DFNIEN)=SDADT
"RTN","DGENACL2",33,0)
 I $G(DGENCAT)'=""!($G(DGENSTA)'="")!($G(DGENPRI)'="")!($G(DGENCVEL)'="") D
"RTN","DGENACL2",34,0)
 . S ^TMP($J,"DGEN NEACL",DGPFTF,DGSTA1,DGRDTI,DGNAM,DFNIEN,"PRIORITY")=DGENCAT_"^"_DGENSTA_"^"_DGENPRI_"^"_DGENCVEL
"RTN","DGENACL2",35,0)
 Q
"RTN","DGENACL2",36,0)
 ;
"RTN","DGENACL2",37,0)
APPTCK ;
"RTN","DGENACL2",38,0)
 ;quit, if no appointment questioned asked?
"RTN","DGENACL2",39,0)
 S DGRDTI=$$GET1^DIQ(2,DFNIEN,1010.1511,"I") I 'DGRDTI S SDEXIT=1 Q
"RTN","DGENACL2",40,0)
 ;get request status
"RTN","DGENACL2",41,0)
 S DGSTA=$$GET1^DIQ(2,DFNIEN,1010.161,"I")
"RTN","DGENACL2",42,0)
 ;look for any appointments made (quit if none, or appt. date < 'notify of request date'
"RTN","DGENACL2",43,0)
 K ^TMP($J,"SDAMA301")
"RTN","DGENACL2",44,0)
 S SDARRY(4)=DFNIEN
"RTN","DGENACL2",45,0)
 S SDARRY("FLDS")=1
"RTN","DGENACL2",46,0)
 S SDARRY("MAX")=1
"RTN","DGENACL2",47,0)
 S SDEXIT=0
"RTN","DGENACL2",48,0)
 S SDCNT=$$SDAPI^SDAMA301(.SDARRY) I SDCNT<0 S DGERROR=$$ERR() Q
"RTN","DGENACL2",49,0)
 Q:(SDCNT'>0)  ;no appointment
"RTN","DGENACL2",50,0)
 ;quit if appointment < 'notify of request date'
"RTN","DGENACL2",51,0)
 S SDCL=0 F  S SDCL=$O(^TMP($J,"SDAMA301",DFNIEN,SDCL)) Q:'SDCL  D  I SDEXIT=1 Q
"RTN","DGENACL2",52,0)
 . I $O(^TMP($J,"SDAMA301",DFNIEN,SDCL,0))<DGRDTI S SDEXIT=1
"RTN","DGENACL2",53,0)
 ;
"RTN","DGENACL2",54,0)
 K ^TMP($J,"SDAMA301")
"RTN","DGENACL2",55,0)
 ;Check appointments (scheduled/kept, inpatient, no action)
"RTN","DGENACL2",56,0)
 S SDARRY(1)=DGRDTI_";" ;look out from 'notify of request date' to future.
"RTN","DGENACL2",57,0)
 S SDARRY(3)="R;I;NT"
"RTN","DGENACL2",58,0)
 S SDARRY(4)=DFNIEN,SDARRY("FLDS")=1
"RTN","DGENACL2",59,0)
 S SDCNT=$$SDAPI^SDAMA301(.SDARRY) Q:(SDCNT'>0)
"RTN","DGENACL2",60,0)
 ;Exclude no count clinic appointments from appointment count
"RTN","DGENACL2",61,0)
 N SDCOUNT
"RTN","DGENACL2",62,0)
 S SDCOUNT=0 ;count clinic
"RTN","DGENACL2",63,0)
 S SDCL=0 F  S SDCL=$O(^TMP($J,"SDAMA301",DFNIEN,SDCL)) Q:'SDCL  D  Q:SDCOUNT
"RTN","DGENACL2",64,0)
 . I $$GET1^DIQ(44,SDCL,2502,"I")="Y" Q  ;don't include no-count
"RTN","DGENACL2",65,0)
 . S SDADT=$O(^TMP($J,"SDAMA301",DFNIEN,SDCL,0)) ;get appointment date of count clinic
"RTN","DGENACL2",66,0)
 . S SDCOUNT=SDCOUNT+1
"RTN","DGENACL2",67,0)
 I SDCOUNT=0 S SDCNT=0 Q  ;if no-count clinics was only one found, keep on call list.
"RTN","DGENACL2",68,0)
 ;if appointment found and status '="filled", set status to 'filled'
"RTN","DGENACL2",69,0)
 I DGSTA'="F" D
"RTN","DGENACL2",70,0)
 . S DGCOM=$$GET1^DIQ(2,DFNIEN,1010.163)
"RTN","DGENACL2",71,0)
 . S DGCOM=DGCOM_$S(DGCOM'="":"<>",1:"")_"AutoComm:"_$S(DGSTA="":"null",1:$S($$GET1^DIQ(2,DFNIEN,1010.161,"I")="I":"IN PROGRESS",1:$$GET1^DIQ(2,DFNIEN,1010.161)))_"|FILLED"
"RTN","DGENACL2",72,0)
 . S FDATA(2,DFNIEN_",",1010.161)="F"
"RTN","DGENACL2",73,0)
 . S FDATA(2,DFNIEN_",",1010.163)=DGCOM
"RTN","DGENACL2",74,0)
 . D FILE^DIE("","FDATA","DPTERR")
"RTN","DGENACL2",75,0)
 . S DGSTA=$$GET1^DIQ(2,DFNIEN,1010.161,"I")
"RTN","DGENACL2",76,0)
 Q
"RTN","DGENACL2",77,0)
ERR() ; Process error message.
"RTN","DGENACL2",78,0)
 N DGERR
"RTN","DGENACL2",79,0)
 S DGERR=0
"RTN","DGENACL2",80,0)
 I $D(^TMP($J,"SDAMA301",101)) D
"RTN","DGENACL2",81,0)
 . S DGERR=101_"^"_"  *** RSA: Process DATABASE IS UNAVAILABLE ***"
"RTN","DGENACL2",82,0)
 I $D(^TMP($J,"SDAMA301",115)) D
"RTN","DGENACL2",83,0)
 . S DGERR=115_"^"_"  *** RSA: Appointment request filter contains invalid values ***"
"RTN","DGENACL2",84,0)
 I $D(^TMP($J,"SDAMA301",116)) D
"RTN","DGENACL2",85,0)
 . S DGERR=116_"^"_"  *** RSA: Data doesn't exist error has occurred ***"
"RTN","DGENACL2",86,0)
 I $D(^TMP($J,"SDAMA301",117)) D
"RTN","DGENACL2",87,0)
 . S DGERR=117_"^"_"  *** RSA: Other undefined error has occurred ***"
"RTN","DGENACL2",88,0)
 Q DGERR
"RTN","DPTLK5")
0^5^B3881793^B3796452
"RTN","DPTLK5",1,0)
DPTLK5 ;BAY/JAT,EG - Patient lookup APIs for patient safety issues ; 11 Aug 2005 8:20 AM
"RTN","DPTLK5",2,0)
 ;;5.3;Registration;**265,276,277,485,675,788**;Aug 13, 1993;Build 18
"RTN","DPTLK5",3,0)
 Q
"RTN","DPTLK5",4,0)
BS5(DPTDFN) ;function checks if other patients on "BS5" xref
"RTN","DPTLK5",5,0)
 ; with same last name
"RTN","DPTLK5",6,0)
 ; returns 1 if other patients exist
"RTN","DPTLK5",7,0)
 ; input: ien of Patient file
"RTN","DPTLK5",8,0)
 I '$G(DPTDFN) Q 0
"RTN","DPTLK5",9,0)
 I '$D(^DPT(DPTDFN,0)) Q 0
"RTN","DPTLK5",10,0)
 N DPT0,DPTNME,DPTSSN,DPTBS5,DPTLAST,DPTIEN,DPTFLAG
"RTN","DPTLK5",11,0)
 S DPT0=^DPT(DPTDFN,0)
"RTN","DPTLK5",12,0)
 S DPTNME=$E(DPT0,1),DPTSSN=$E($P(DPT0,U,9),6,9)
"RTN","DPTLK5",13,0)
 S DPTBS5=DPTNME_DPTSSN
"RTN","DPTLK5",14,0)
 S DPTLAST=$P($P(DPT0,U),",")
"RTN","DPTLK5",15,0)
 S (DPTIEN,DPTFLAG)=0
"RTN","DPTLK5",16,0)
 F  S DPTIEN=$O(^DPT("BS5",DPTBS5,DPTIEN)) Q:'DPTIEN!(DPTFLAG=1)  D
"RTN","DPTLK5",17,0)
 .Q:DPTDFN=DPTIEN
"RTN","DPTLK5",18,0)
 .S DPTNME=$P($P($G(^DPT(DPTIEN,0)),U),",")
"RTN","DPTLK5",19,0)
 .I DPTNME=DPTLAST S DPTFLAG=1
"RTN","DPTLK5",20,0)
 Q DPTFLAG
"RTN","DPTLK5",21,0)
 ;
"RTN","DPTLK5",22,0)
DMT(DPTDFN,DPTUSER) ; function checks if the 'Display Means Test Required'
"RTN","DPTLK5",23,0)
 ; message is to be displayed for this Division
"RTN","DPTLK5",24,0)
 ; returns Division ien if message is to be displayed
"RTN","DPTLK5",25,0)
 ; input:  a) ien of Patient file 
"RTN","DPTLK5",26,0)
 ;         b) user's Institution for current session (DUZ(2))
"RTN","DPTLK5",27,0)
 ;             DD(200.02,.01)<==>DD(4,DINUM)<==>DD(40.8,.07)
"RTN","DPTLK5",28,0)
 I '$G(DPTDFN)!('$G(DPTUSER)) Q 0
"RTN","DPTLK5",29,0)
 N Y,DFN,DGREQF,DGMTLST,DPTDIV
"RTN","DPTLK5",30,0)
 ; verifies that Means Test required for this patient
"RTN","DPTLK5",31,0)
 ;
"RTN","DPTLK5",32,0)
 S DFN=DPTDFN
"RTN","DPTLK5",33,0)
 S DGMTLST=$$CMTS^DGMTU(DFN)
"RTN","DPTLK5",34,0)
 ;only display division message if means test is required
"RTN","DPTLK5",35,0)
 I '$$MFLG^DGMTU(DGMTLST) Q 0
"RTN","DPTLK5",36,0)
 S DPTDIV=0
"RTN","DPTLK5",37,0)
 S DPTDIV=$O(^DG(40.8,"AD",DPTUSER,DPTDIV))
"RTN","DPTLK5",38,0)
 I DPTDIV,$P($G(^DG(40.8,DPTDIV,"MT")),U)="Y" Q DPTDIV
"RTN","DPTLK5",39,0)
 Q 0
"RTN","DPTLK5",40,0)
 ;
"RTN","DPTLK5",41,0)
FFP ; This function checks if the 'Display Fugitive Felon Message'
"RTN","DPTLK5",42,0)
 ; message is to be displayed.  Message displays only for DG and SD
"RTN","DPTLK5",43,0)
 ; menu options
"RTN","DPTLK5",44,0)
 ;
"RTN","DPTLK5",45,0)
 Q:'$D(XQY0)
"RTN","DPTLK5",46,0)
 Q:$E(XQY0,1,2)'="SD"&($E(XQY0,1,2)'="DG")
"RTN","DPTLK5",47,0)
 ;
"RTN","DPTLK5",48,0)
 N X,Y,IORVON,IORVOFF,DIR,DIRUT
"RTN","DPTLK5",49,0)
 S X="IORVON;IORVOFF"
"RTN","DPTLK5",50,0)
 D ENDR^%ZISS
"RTN","DPTLK5",51,0)
 W !?17,$CHAR(7) W:$D(IORVON) IORVON W "*** WARNING - FFP FLAG ACTIVE ***" W:$D(IORVOFF) IORVOFF
"RTN","DPTLK5",52,0)
 W !?19,$CHAR(7) W:$D(IORVON) IORVON W "PLEASE NOTIFY YOUR SUPERVISOR" W:$D(IORVOFF) IORVOFF
"RTN","DPTLK5",53,0)
 W !
"RTN","DPTLK5",54,0)
 I '$D(DGCLIST) D
"RTN","DPTLK5",55,0)
 . S DIR(0)="FAO",DIR("A")="Enter <RETURN> to continue."
"RTN","DPTLK5",56,0)
 . D ^DIR K DIR
"RTN","DPTLK5",57,0)
 Q
"VER")
8.0^22.0
"BLD",7654,6)
^708
**END**
**END**
