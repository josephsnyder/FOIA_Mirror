$TXT Created by HUA,PATRICK at MNTVLL.FO-ALBANY.MED.VA.GOV  (KIDS) on Thursday, 04/16/09 at 16:10
=============================================================================
Run Date: JUN 23, 2009                     Designation: DG*5.3*809
Package : DG - REGISTRATION                   Priority: EMERGENCY
Version : 5.3       SEQ #712                    Status: Released
                  Compliance Date: JUN 25, 2009
=============================================================================

Associated patches: (v)DG*5.3*647  <<= must be installed BEFORE `DG*5.3*809'

Subject: FIX MISSING COUNTY ERROR

Category: 
  - Routine

Description:
============

 NOTE:  Due to widespread errors when registering new patients at VistA 
 sites, this Emergency patch should be installed by the requested 
 Compliance Date.
  
 During registration of a new patient at a VistA site, the Register Once 
 Messaging (ROM) software sends a query to the Last Site Treated (LST).  
 A Query for Results of Observation (ORF~R01) message is sent back to VistA
 from the Last Site Treated in response to that query.  When VistA
 processes the ORF~R01 message, a check for existing data in the local
 PATIENT file (#2) is done.  If such data exists, processing quits out of
 the receiver subroutine prematurely without correctly setting the DGROAYI
 array for uploading.  Later, in an effort to file the county data, a
 reference is made to an array that does not exist.  This causes an error
 to be generated.
  
 This patch, DG*5.3*809, will update the ORF~R01 message receiver to check 
 for the existence of the array prior to uploading the county data.  If 
 the array is not correctly defined, processing will bypass the county 
 update to prevent the error during upload.
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 There is no NSR associated with this patch.
  
 This patch addresses the following Remedy Ticket(s):
 ----------------------------------------------------
 HD0000000312720 - UNDEFINED>FILECNTY+11^DGROHLR1--- possible  EVC 2
 HD0000000312750 - Possible EVC Error: <UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000312836 - <UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000312879 - Facility is receiving <UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000313328 - FILECNTY+11^DGROHLR1
 HD0000000313556 - UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000314870 - ERROR -  <UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000314921 - <UNDEFINED>FILECNTY+11^DGROHLR1
 HD0000000315569 - $ZE= <UNDEFINED>FILECNTY+11^DGROHLR1
  
 Overview of Remedy Ticket(s):
 -----------------------------
 Problem:
 --------
 An <UNDEFINED>FILECNTY+11^DGROHLR1 error occurs during processing of an 
 incoming HL7 message response to a query for data on a new patient.
  
 Resolution:
 -----------
 A check will be added inside FILECNTY^DGROHLR1 to ensure that the array 
 containing the COUNTY data exists prior to attempting an upload of the 
 data.  If the array is not correctly defined, processing will bypass the 
 COUNTY update process in order to prevent the error.
  
 Test Sites:
 -----------
 Ann Arbor, MI (Large)
 Palo Alto HCS (Integrated)
 Tampa, FL (Large)
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday, it is recommended that the 
 following selection in the OPTION (#19) file be disabled to prevent 
 possible conflicts while running the KIDS Install. Other VISTA users will 
 not be affected.
  
    [DG REGISTER PATIENT]             REGISTER A PATIENT
  
 Install Time - less than 5 minutes
       
 1.  LOAD TRANSPORT GLOBAL 
     ---------------------
     Choose the PackMan message containing this patch and invoke the 
     INSTALL/CHECK MESSAGE PackMan option.  
              
 2.  START UP KIDS 
     -------------
     Start up the Kernel Installation and Distribution System Menu 
     [XPD MAIN]: 
    
          Edits and Distribution ...  
          Utilities ...  
          Installation ...  
    
 Select Kernel Installation & Distribution System Option: INStallation 
                                                          ---
          Load a Distribution 
          Print Transport Global 
          Compare Transport Global to Current System 
          Verify Checksums in Transport Global 
          Install Package(s) 
          Restart Install of Package(s) 
          Unload a Distribution 
          Backup a Transport Global 
    
 Select Installation Option: 
    
 3.  Select Installation Option: 
     ---------------------------
     NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
            NAME, enter DG*5.3*809):
       
     a.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
     b.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this patch
         is installed.  It compares all components of this patch
         (routines, DD's, templates, etc.).
     c.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
      
 4.  Select Installation Option: Install Package(s) 
                                 ------------------
     **This is the step to start the installation of this KIDS patch: 
    
     a.  Choose the Install Package(s) option to start the patch
         install.
     b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
         NO//' press <Enter>.
     c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
         Options, and Protocols? NO//' answer YES.
     d.  When prompted 'Enter options you wish to mark as 'Out Of
         Order':'  enter the following option:
   
           REGISTER A PATIENT       [DG REGISTER PATIENT]
  
     e.  When prompted 'Enter protocols you wish to mark as 'Out Of
         Order':' press <Enter>.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.3;Registration;**[Patch List]**;Aug 13, 1993;Build 1

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGROHLR1
    Before: B30562150   After: B30908131  **572,622,647,809**
 Description of Changes:
  Original Code:
   
           I $G(STATEIEN)="" G NOCNTY
           S DIC="^DIC(5,"_STATEIEN_",1,"
           S DIC(0)="XS"
   
   
  Modified Code:
   
           I $G(STATEIEN)="" G NOCNTY
           I '$D(@DGROAR@(F,DFNC,FIELD)) G NOCNTY
           S DIC="^DIC(5,"_STATEIEN_",1,"
           S DIC(0)="XS"

 
Routine list of preceding patches: 647

=============================================================================
User Information:
Entered By  : HUA,PATRICK                   Date Entered  : APR 08, 2009
Completed By: RUDINGER,NANCY L.             Date Completed: JUN 12, 2009
Released By : GROOMS,ANTHONY E              Date Released : JUN 23, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
