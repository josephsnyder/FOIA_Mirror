Released PRS*4*100 SEQ #107
Extracted from mail message
**KIDS**:PRS*4.0*100^

**INSTALL NAME**
PRS*4.0*100
"BLD",7623,0)
PRS*4.0*100^PAID^0^3080708^y
"BLD",7623,1,0)
^^7^7^3080708^
"BLD",7623,1,1,0)
This patch addresses three issues:
"BLD",7623,1,2,0)
1. A Cache error is generated when a number greater than
"BLD",7623,1,3,0)
   142 characters is entered into the time fields on the 
"BLD",7623,1,4,0)
   Leave Request screen.
"BLD",7623,1,5,0)
2. HRIS Bulletin 07-08 has mandated an increase in the 
"BLD",7623,1,6,0)
   length of the Duty Station field.
"BLD",7623,1,7,0)
3. An electronic signature is not recognized.
"BLD",7623,4,0)
^9.64PA^454^1
"BLD",7623,4,454,0)
454
"BLD",7623,4,454,2,0)
^9.641^454.0128^1
"BLD",7623,4,454,2,454.0128,0)
DUTY STATION  (sub-file)
"BLD",7623,4,454,2,454.0128,1,0)
^9.6411^.01^1
"BLD",7623,4,454,2,454.0128,1,.01,0)
DUTY STATION
"BLD",7623,4,454,222)
y^y^p^^^^n^^n
"BLD",7623,4,454,224)

"BLD",7623,4,"APDD",454,454.0128)

"BLD",7623,4,"APDD",454,454.0128,.01)

"BLD",7623,4,"B",454,454)

"BLD",7623,6.3)
3
"BLD",7623,"ABPKG")
n
"BLD",7623,"KRN",0)
^9.67PA^8989.52^19
"BLD",7623,"KRN",.4,0)
.4
"BLD",7623,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7623,"KRN",.401,0)
.401
"BLD",7623,"KRN",.402,0)
.402
"BLD",7623,"KRN",.403,0)
.403
"BLD",7623,"KRN",.5,0)
.5
"BLD",7623,"KRN",.84,0)
.84
"BLD",7623,"KRN",3.6,0)
3.6
"BLD",7623,"KRN",3.8,0)
3.8
"BLD",7623,"KRN",9.2,0)
9.2
"BLD",7623,"KRN",9.8,0)
9.8
"BLD",7623,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",7623,"KRN",9.8,"NM",1,0)
PRSAES^^0^B1863414
"BLD",7623,"KRN",9.8,"NM",2,0)
PRSATIM^^0^B4139617
"BLD",7623,"KRN",9.8,"NM",3,0)
PRSD1150^^0^B13678268
"BLD",7623,"KRN",9.8,"NM",4,0)
PRSDSRS^^0^B20527768
"BLD",7623,"KRN",9.8,"NM",5,0)
PRSDV450^^0^B24678213
"BLD",7623,"KRN",9.8,"NM",6,0)
PRSDV459^^0^B36198175
"BLD",7623,"KRN",9.8,"NM","B","PRSAES",1)

"BLD",7623,"KRN",9.8,"NM","B","PRSATIM",2)

"BLD",7623,"KRN",9.8,"NM","B","PRSD1150",3)

"BLD",7623,"KRN",9.8,"NM","B","PRSDSRS",4)

"BLD",7623,"KRN",9.8,"NM","B","PRSDV450",5)

"BLD",7623,"KRN",9.8,"NM","B","PRSDV459",6)

"BLD",7623,"KRN",19,0)
19
"BLD",7623,"KRN",19,"NM",0)
^9.68A^^0
"BLD",7623,"KRN",19.1,0)
19.1
"BLD",7623,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",7623,"KRN",101,0)
101
"BLD",7623,"KRN",409.61,0)
409.61
"BLD",7623,"KRN",771,0)
771
"BLD",7623,"KRN",870,0)
870
"BLD",7623,"KRN",8989.51,0)
8989.51
"BLD",7623,"KRN",8989.52,0)
8989.52
"BLD",7623,"KRN",8994,0)
8994
"BLD",7623,"KRN","B",.4,.4)

"BLD",7623,"KRN","B",.401,.401)

"BLD",7623,"KRN","B",.402,.402)

"BLD",7623,"KRN","B",.403,.403)

"BLD",7623,"KRN","B",.5,.5)

"BLD",7623,"KRN","B",.84,.84)

"BLD",7623,"KRN","B",3.6,3.6)

"BLD",7623,"KRN","B",3.8,3.8)

"BLD",7623,"KRN","B",9.2,9.2)

"BLD",7623,"KRN","B",9.8,9.8)

"BLD",7623,"KRN","B",19,19)

"BLD",7623,"KRN","B",19.1,19.1)

"BLD",7623,"KRN","B",101,101)

"BLD",7623,"KRN","B",409.61,409.61)

"BLD",7623,"KRN","B",771,771)

"BLD",7623,"KRN","B",870,870)

"BLD",7623,"KRN","B",8989.51,8989.51)

"BLD",7623,"KRN","B",8989.52,8989.52)

"BLD",7623,"KRN","B",8994,8994)

"BLD",7623,"QDEF")
^^^^^^^^^^NO
"BLD",7623,"QUES",0)
^9.62^^
"BLD",7623,"REQB",0)
^9.611^4^4
"BLD",7623,"REQB",1,0)
PRS*4.0*93^2
"BLD",7623,"REQB",2,0)
PRS*4.0*35^2
"BLD",7623,"REQB",3,0)
PRS*4.0*114^2
"BLD",7623,"REQB",4,0)
PRS*4.0*97^2
"BLD",7623,"REQB","B","PRS*4.0*114",3)

"BLD",7623,"REQB","B","PRS*4.0*35",2)

"BLD",7623,"REQB","B","PRS*4.0*93",1)

"BLD",7623,"REQB","B","PRS*4.0*97",4)

"FIA",454)
PAID CODE FILES
"FIA",454,0)
^PRSP(454,
"FIA",454,0,0)
454
"FIA",454,0,1)
y^y^p^^^^n^^n
"FIA",454,0,10)

"FIA",454,0,11)

"FIA",454,0,"RLRO")

"FIA",454,0,"VR")
4.0^PRS
"FIA",454,454)
1
"FIA",454,454,128)

"FIA",454,454.0128)
1
"FIA",454,454.0128,.01)

"MBREQ")
0
"PKG",408,-1)
1^1
"PKG",408,0)
PAID^PRS^PAID
"PKG",408,20,0)
^9.402P^^
"PKG",408,22,0)
^9.49I^1^1
"PKG",408,22,1,0)
4.0^2950912^2960130
"PKG",408,22,1,"PAH",1,0)
100^3080708
"PKG",408,22,1,"PAH",1,1,0)
^^7^7^3080708
"PKG",408,22,1,"PAH",1,1,1,0)
This patch addresses three issues:
"PKG",408,22,1,"PAH",1,1,2,0)
1. A Cache error is generated when a number greater than
"PKG",408,22,1,"PAH",1,1,3,0)
   142 characters is entered into the time fields on the 
"PKG",408,22,1,"PAH",1,1,4,0)
   Leave Request screen.
"PKG",408,22,1,"PAH",1,1,5,0)
2. HRIS Bulletin 07-08 has mandated an increase in the 
"PKG",408,22,1,"PAH",1,1,6,0)
   length of the Duty Station field.
"PKG",408,22,1,"PAH",1,1,7,0)
3. An electronic signature is not recognized.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PRSAES")
0^1^B1863414^B1544187
"RTN","PRSAES",1,0)
PRSAES ; HISC/REL-Electronic Signature ;3/20/92  15:54
"RTN","PRSAES",2,0)
 ;;4.0;PAID;**100**;Sep 21, 1995;Build 3
"RTN","PRSAES",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSAES",4,0)
 S ES=$P($G(^VA(200,DUZ,20)),"^",4),ESNAM=$P($G(^(20)),"^",2),ESCNT=0
"RTN","PRSAES",5,0)
 I ES="" W !!,"No electronic signature on file!" G E2
"RTN","PRSAES",6,0)
 I ESNAM="" W !!,"No electronic signature block on file!" G E2
"RTN","PRSAES",7,0)
E1 W !!,"Enter Signature Code: " X ^%ZOSF("EOFF") R X:60 X ^%ZOSF("EON") S:'$T X="^" I X=""!(X="^") G E2
"RTN","PRSAES",8,0)
 I X="?"!(X="??") W !,"Enter your Electronic Signature code to verify this action." G E1
"RTN","PRSAES",9,0)
 S ESCNT=ESCNT+1 D HASH^XUSHSHP I ES'=X W "  ??",*7 S X="" G E1:ESCNT<3,E2
"RTN","PRSAES",10,0)
 W "  ... signed." S ESOK=1 K X,ES,ESCNT Q
"RTN","PRSAES",11,0)
E2 S ESOK=0 W *7,"  ... Not Signed." K X,ES,ESCNT Q
"RTN","PRSATIM")
0^2^B4139617^B4060707
"RTN","PRSATIM",1,0)
PRSATIM ;HISC/REL - Time Input Conversion ;01/21/05
"RTN","PRSATIM",2,0)
 ;;4.0;PAID;**69,70,71,93,100**;Sep 21, 1995;Build 3
"RTN","PRSATIM",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSATIM",4,0)
 S X=$TR(X,"adimnop","ADIMNOP")
"RTN","PRSATIM",5,0)
 S X=$S(X="M":"MID",X="N":"NOON",1:X)
"RTN","PRSATIM",6,0)
 I X?1"12".A S X=$S(X="12M":"MID",X="12N":"NOON",1:X)
"RTN","PRSATIM",7,0)
 I X?1.A S X=$S(X["MID":2400,X["NOON":1200,1:"")
"RTN","PRSATIM",8,0)
 S:$E(X,$L(X))="M" X=$E(X,1,$L(X)-1) S X1=$E(X,$L(X)) I X1?1U,"AP"'[X1 G ERR
"RTN","PRSATIM",9,0)
 S X1=$P(X,":",2) I X1'="",X1'?2N1.2U G ERR
"RTN","PRSATIM",10,0)
 I $L(X)>7 G ERR
"RTN","PRSATIM",11,0)
 I X'?4N,$S($L(+X)<3:+X,1:+X\100)>12 G ERR
"RTN","PRSATIM",12,0)
 S X=$P(X,":",1)_$P(X,":",2),X1=X
"RTN","PRSATIM",13,0)
 G:X?4N A I X'?1.4N1.2U G ERR
"RTN","PRSATIM",14,0)
 S:X<13 X=X*100 I X1["A" G:X>1259 ERR S X=$S(X=1200:2400,X>1159:X-1200,1:X)
"RTN","PRSATIM",15,0)
 E  I X<1200,X1["P"!(X<600) S X=X+1200 I X<1300 G ERR
"RTN","PRSATIM",16,0)
A I X>2400!('X&(X'="0000"))!(X#100>59) G ERR
"RTN","PRSATIM",17,0)
 S X1=+X I 'X1!(X1=1200)!(X1=2400) S X=$S(X1=1200:"NOON",1:"MID") G DNE
"RTN","PRSATIM",18,0)
 S X1=$S(X1>1259:X1-1200,1:X1),X1=$E("000",0,4-$L(X1))_X1_$S(X=2400:"A",X>1159:"P",1:"A")
"RTN","PRSATIM",19,0)
 I "00^15^30^45"'[$E(X1,3,4) G ERR
"RTN","PRSATIM",20,0)
 S X=$E(X1,1,2)_":"_$E(X1,3,5)
"RTN","PRSATIM",21,0)
DNE K X1 Q
"RTN","PRSATIM",22,0)
ERR K X,X1 Q
"RTN","PRSATIM",23,0)
CNV ; Convert Start/Stop to minutes
"RTN","PRSATIM",24,0)
 ; X=start_"^"_stop  Output: Y=start(min)_"^"_stop(min)
"RTN","PRSATIM",25,0)
 S CNX=X,X=$P(CNX,"^",1),Y=0 D MIL S Y=Y\100*60+(Y#100),$P(CNX,"^",1)=Y
"RTN","PRSATIM",26,0)
 S X=$P(CNX,"^",2),Y=1 D MIL S Y=Y\100*60+(Y#100)
"RTN","PRSATIM",27,0)
 S Y=$P(CNX,"^",1)_"^"_Y K CNX Q
"RTN","PRSATIM",28,0)
MIL ; Convert from AM/PM to 2400
"RTN","PRSATIM",29,0)
 ; X=time Y: 0=Mid=0,1=Mid=2400 Output: Y=time in 2400
"RTN","PRSATIM",30,0)
 I X="MID"!(X="NOON") S Y=$S(X="NOON":1200,Y:2400,1:0) Q
"RTN","PRSATIM",31,0)
 S Y=$P(X,":",1)_$P(X,":",2),Y=+Y Q:X["A"
"RTN","PRSATIM",32,0)
 S:Y<1200 Y=Y+1200 Q
"RTN","PRSATIM",33,0)
HLP ; Time Help
"RTN","PRSATIM",34,0)
 W !?5,"Time may be entered as 8A or 8a, 8:00A, 8:15A, 8:15AM or military"
"RTN","PRSATIM",35,0)
 W !?5,"time: 0800, 1300; or MID or 12M for midnight; NOON or 12N for noon."
"RTN","PRSATIM",36,0)
 W !?5,"Time must be in quarter hours; e.g., 8A or 8:15A or 8:30A or 8:45A.",!
"RTN","PRSATIM",37,0)
 Q
"RTN","PRSD1150")
0^3^B13678268^B13279228
"RTN","PRSD1150",1,0)
PRSD1150 ;HISC/GWB-RECORD OF LEAVE DATA ;2/5/1998
"RTN","PRSD1150",2,0)
 ;;4.0;PAID;**35,100**;Sep 21, 1995;Build 3
"RTN","PRSD1150",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSD1150",4,0)
EMP K DIC S DIC="^PRSPC(",DIC(0)="AEMQZ"
"RTN","PRSD1150",5,0)
 S DIC("A")="Select SEPARATED EMPLOYEE: " D ^DIC K DIC
"RTN","PRSD1150",6,0)
 I Y'>0 G EX
"RTN","PRSD1150",7,0)
 S DA=+Y
"RTN","PRSD1150",8,0)
 I $P($G(^PRSPC(DA,1)),U,33)'="Y" D  G EMP
"RTN","PRSD1150",9,0)
 .W !!,*7,"This is not a separated employee.  "
"RTN","PRSD1150",10,0)
 .W "The SEPARATION IND does not equal Y.",!
"RTN","PRSD1150",11,0)
START ;
"RTN","PRSD1150",12,0)
 K DASHES S $P(DASHES,"-",80)="-"
"RTN","PRSD1150",13,0)
 S ZERO=^PRSPC(DA,0)
"RTN","PRSD1150",14,0)
 S NAME=$P(ZERO,U,1),STATION=$P(ZERO,U,7),TLU=$P(ZERO,U,8)
"RTN","PRSD1150",15,0)
 S SSN=$P(ZERO,U,9),SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9)
"RTN","PRSD1150",16,0)
 S SAL=$P(ZERO,U,29),HR=$S(SAL>99:SAL/2087,1:SAL),HR=$J(HR,0,2)
"RTN","PRSD1150",17,0)
 S Y=$P(ZERO,U,49) X ^DD(450,458,2.1) S CCORG=Y
"RTN","PRSD1150",18,0)
 S DS=$P($G(^PRSPC(DA,1)),U,42),LPP=$P($G(^PRSPC(DA,"MISC4")),U,16)
"RTN","PRSD1150",19,0)
 S SCD=$P(ZERO,U,31)
"RTN","PRSD1150",20,0)
 S SCDYR=$E(SCD,1,3),SCDMO=+$E(SCD,4,5),SCDDY=+$E(SCD,6,7)
"RTN","PRSD1150",21,0)
 S DOS=$P($G(^PRSPC(DA,1)),U,2)
"RTN","PRSD1150",22,0)
 S DOS1=$$FMADD^XLFDT(DOS,1) ; add 1 day so empl.  credited for DOS
"RTN","PRSD1150",23,0)
 S DOS1YR=$E(DOS1,1,3),DOS1MO=+$E(DOS1,4,5),DOS1DY=+$E(DOS1,6,7)
"RTN","PRSD1150",24,0)
 ;
"RTN","PRSD1150",25,0)
 ; calculate difference between DOS1 and SCD
"RTN","PRSD1150",26,0)
 S TOTDY=DOS1DY-SCDDY
"RTN","PRSD1150",27,0)
 S TOTMO=DOS1MO-SCDMO
"RTN","PRSD1150",28,0)
 S TOTYR=DOS1YR-SCDYR
"RTN","PRSD1150",29,0)
 ; if negative days then recalc. Subtract 1 from month and get days by
"RTN","PRSD1150",30,0)
 ; adding the days from first and last month together.
"RTN","PRSD1150",31,0)
 I TOTDY<0 D
"RTN","PRSD1150",32,0)
 . S SCDDIM=$P("31^28^31^30^31^30^31^31^30^31^30^31",U,SCDMO)
"RTN","PRSD1150",33,0)
 . I SCDDIM=28 S SCDDIM=SCDDIM+$$LEAPYR^PRSLIB00(SCDYR+1700)
"RTN","PRSD1150",34,0)
 . S TOTDY=SCDDIM-SCDDY+DOS1DY
"RTN","PRSD1150",35,0)
 . S TOTMO=TOTMO-1
"RTN","PRSD1150",36,0)
 I TOTMO<0 S TOTMO=TOTMO+12,TOTYR=TOTYR-1
"RTN","PRSD1150",37,0)
 ;
"RTN","PRSD1150",38,0)
ROLD S CATEGORY="RECORD OF LEAVE DATA",PAGE=0
"RTN","PRSD1150",39,0)
 K ^UTILITY("DIQ1",$J) S DIC="^PRSPC("
"RTN","PRSD1150",40,0)
 S DR="30;49;50",DIQ(0)="IE" D EN^DIQ1 W @IOF D HDR S PRTC=1
"RTN","PRSD1150",41,0)
 F F=30,49,50 D WR G:'PRTC EX
"RTN","PRSD1150",42,0)
 W !,"TOTAL SERVICE FOR LEAVE.........",TOTYR," YEARS"
"RTN","PRSD1150",43,0)
 W !,"                                ",TOTMO," MONTHS"
"RTN","PRSD1150",44,0)
 W !,"                                ",TOTDY," DAYS"
"RTN","PRSD1150",45,0)
 K ^UTILITY("DIQ1",$J) S DIC="^PRSPC("
"RTN","PRSD1150",46,0)
 S DR="462;510",DIQ(0)="IE" D EN^DIQ1
"RTN","PRSD1150",47,0)
 F F=462,510 D WR G:'PRTC EX
"RTN","PRSD1150",48,0)
 W !,"HOURLY RATE.....................",HR
"RTN","PRSD1150",49,0)
 S END="" D PRTC
"RTN","PRSD1150",50,0)
EX K ^UTILITY("DIQ1",$J)
"RTN","PRSD1150",51,0)
 N PRSTLV D KILL^XUSCLEAN W @IOF
"RTN","PRSD1150",52,0)
 Q
"RTN","PRSD1150",53,0)
WR S NODEDD=^DD(450,F,0),NODEUTIL=$G(^UTILITY("DIQ1",$J,450,DA,F,"E"))
"RTN","PRSD1150",54,0)
 I (NODEUTIL="")!(NODEUTIL="NA") K NODEDD,NODEUTIL Q
"RTN","PRSD1150",55,0)
 S FLDNAM=$P(NODEDD,U,1)
"RTN","PRSD1150",56,0)
 S INT=^UTILITY("DIQ1",$J,450,DA,F,"I")
"RTN","PRSD1150",57,0)
EXT S EXT=^UTILITY("DIQ1",$J,450,DA,F,"E")
"RTN","PRSD1150",58,0)
 S IL=$L(INT)
"RTN","PRSD1150",59,0)
 I $P(NODEDD,U,2)["NJ",+INT=0 K NODEDD,NODEUTIL Q
"RTN","PRSD1150",60,0)
 I $P(NODEDD,U,5)["""$""" S VAL=$FN(INT,",",2) G IOSL
"RTN","PRSD1150",61,0)
 I $P(NODEDD,U,2)["D" S VAL=EXT G IOSL
"RTN","PRSD1150",62,0)
 I $P(NODEDD,U,2)["NJ" S VAL=$J(INT,IL,2) G IOSL
"RTN","PRSD1150",63,0)
 S VAL=EXT
"RTN","PRSD1150",64,0)
IOSL K DOTS S NOD=32-$L(FLDNAM),$P(DOTS,".",NOD)="."
"RTN","PRSD1150",65,0)
 I $Y>(IOSL-4) D PRTC Q:'PRTC
"RTN","PRSD1150",66,0)
 W !,FLDNAM,DOTS
"RTN","PRSD1150",67,0)
 D VAL Q
"RTN","PRSD1150",68,0)
VAL I $L(VAL)<48 W ?32,VAL Q
"RTN","PRSD1150",69,0)
 S COLUMN=32,LGTH=0
"RTN","PRSD1150",70,0)
 F LOOP=1:1 Q:LGTH=$L(VAL)!(LGTH>($L(VAL)))  W:$L($P(VAL," ",LOOP))>(80-COLUMN) ! S:$L($P(VAL," ",LOOP))>(80-COLUMN) COLUMN=32 W ?COLUMN,$P(VAL," ",LOOP) S COLUMN=COLUMN+$L($P(VAL," ",LOOP))+1,LGTH=LGTH+$L($P(VAL," ",LOOP))+1
"RTN","PRSD1150",71,0)
 Q
"RTN","PRSD1150",72,0)
HDR W:$Y>0 @IOF S PAGE=PAGE+1
"RTN","PRSD1150",73,0)
 S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSD1150",74,0)
 W !,NAME,?TAB,CCORG,?61,"DUTY STATION: ",STATION_DS
"RTN","PRSD1150",75,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES
"RTN","PRSD1150",76,0)
 S CLNGTH=$L(CATEGORY),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSD1150",77,0)
 W !,"LAST PP: ",LPP,?TAB,CATEGORY,?73,"PAGE ",PAGE
"RTN","PRSD1150",78,0)
 W !,DASHES
"RTN","PRSD1150",79,0)
 K CLNGTH,TAB Q
"RTN","PRSD1150",80,0)
PRTC W:$Y<22 ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSD1150",81,0)
 S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR
"RTN","PRSD1150",82,0)
 I $D(DIRUT) S PRTC=0 Q
"RTN","PRSD1150",83,0)
 D:'$D(END) HDR Q
"RTN","PRSD1150",84,0)
 Q
"RTN","PRSDSRS")
0^4^B20527768^B20527859
"RTN","PRSDSRS",1,0)
PRSDSRS ;HISC/GWB-SERVICE RECORD SCREEN ;2/8/95  14:14
"RTN","PRSDSRS",2,0)
 ;;4.0;PAID;**114,100**;Sep 21, 1995;Build 3
"RTN","PRSDSRS",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSDSRS",4,0)
 ;
"RTN","PRSDSRS",5,0)
EMP S DA="",SSN=$P($G(^VA(200,DUZ,1)),"^",9)
"RTN","PRSDSRS",6,0)
 I SSN'="" S DA=$O(^PRSPC("SSN",SSN,0))
"RTN","PRSDSRS",7,0)
 I 'DA W !!,*7,"Your SSN was not found in both the New Person & Employee File!" G EX
"RTN","PRSDSRS",8,0)
START D WAIT^DICD
"RTN","PRSDSRS",9,0)
 K DASHES S $P(DASHES,"-",80)="-"
"RTN","PRSDSRS",10,0)
 S ZERO=^PRSPC(DA,0)
"RTN","PRSDSRS",11,0)
 S NAME=$P(ZERO,U,1),STATION=$P(ZERO,U,7),TLU=$P(ZERO,U,8)
"RTN","PRSDSRS",12,0)
 S SSN=$P(ZERO,U,9),SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9)
"RTN","PRSDSRS",13,0)
 S Y=$P(ZERO,U,49) X ^DD(450,458,2.1) S CCORG=Y
"RTN","PRSDSRS",14,0)
 S DS=$P($G(^PRSPC(DA,1)),U,42),LPP=$P($G(^PRSPC(DA,"MISC4")),U,16)
"RTN","PRSDSRS",15,0)
 D ^PRSDYTD
"RTN","PRSDSRS",16,0)
SRS S CATEGORY="SERVICE RECORD SCREEN",PAGE=0
"RTN","PRSDSRS",17,0)
 K ^UTILITY("DIQ1",$J) S DIC="^PRSPC("
"RTN","PRSDSRS",18,0)
 S DR="2:5;9:11;13;15;15.5;16;19:23;26;28;30:32;37:39;42;43;47;52;53;64;82;83;89:116.2;139;120;132;142;143;144;226;231;395:427;458;538;600"
"RTN","PRSDSRS",19,0)
 S DIQ(0)="IE" D EN^DIQ1
"RTN","PRSDSRS",20,0)
 W @IOF D HDR S PRTC=1
"RTN","PRSDSRS",21,0)
 F F=16,20,15.5,13,38,28,82,83,142:1:144,23,3,37,9,15,19,21,11,458,42,39,53,52,32,31,4,43,10,5,47,139,120,132,226,231,26,64,538,22,30,2,600 D WR G:'PRTC EX
"RTN","PRSDSRS",22,0)
 S END="" D PRTC G:'PRTC EX
"RTN","PRSDSRS",23,0)
FU S FUFLD=89 K FUYES
"RTN","PRSDSRS",24,0)
 F  S FUFLD=$O(^UTILITY("DIQ1",$J,450,DA,FUFLD)) Q:(FUFLD>116.2)!(FUFLD="")  I ^UTILITY("DIQ1",$J,450,DA,FUFLD,"I")'="" S FUYES=""
"RTN","PRSDSRS",25,0)
 G:'$D(FUYES) TSP K END S CATEGORY="FOLLOWUPS"
"RTN","PRSDSRS",26,0)
 W @IOF D HDR S PRTC=1
"RTN","PRSDSRS",27,0)
 F F=115.17,89:1:97,97.1,98,98.1,98.2,98.3,98.4,99,99.1,100:1:114,114.1,114.2,115.01:.01:115.14,115.18,115.19,115.2,115.21,115.15,115.16,115.17,116.01:.01:116.2 D WR G:'PRTC EX
"RTN","PRSDSRS",28,0)
 S END="" D PRTC G:'PRTC EX
"RTN","PRSDSRS",29,0)
TSP K END S CATEGORY="THRIFT SAVINGS PLAN"
"RTN","PRSDSRS",30,0)
 W @IOF D HDR S PRTC=1
"RTN","PRSDSRS",31,0)
 F F=409,410,406,399,396,404,412,403,395,397,398,414,413,415,417,419,418,420,422,424,423,425,427,400,401,402,405,407,408 D WR G:'PRTC EX
"RTN","PRSDSRS",32,0)
 W:TSPYTD'=0 !!,"TSP EMP DED YTD.................",$FN(TSPYTD,",",2)
"RTN","PRSDSRS",33,0)
 S END="" D PRTC G:'PRTC EX
"RTN","PRSDSRS",34,0)
EX K ^UTILITY("DIQ1",$J)
"RTN","PRSDSRS",35,0)
 N PRSTLV D KILL^XUSCLEAN W @IOF
"RTN","PRSDSRS",36,0)
 Q
"RTN","PRSDSRS",37,0)
WR S NODEDD=^DD(450,F,0),NODEUTIL=$G(^UTILITY("DIQ1",$J,450,DA,F,"E"))
"RTN","PRSDSRS",38,0)
 I F=26 W:HBDYTD'=0 !,"HEALTH BENEFITS DEDUCTION YTD...",$FN(HBDYTD,",",2)
"RTN","PRSDSRS",39,0)
 I (NODEUTIL="")!(NODEUTIL="NA") K NODEDD,NODEUTIL Q
"RTN","PRSDSRS",40,0)
 S FLDNAM=$P(NODEDD,U,1)
"RTN","PRSDSRS",41,0)
 I F=15.5 S INT=^UTILITY("DIQ1",$J,450,DA,F,"E") G EXT
"RTN","PRSDSRS",42,0)
 S INT=^UTILITY("DIQ1",$J,450,DA,F,"I")
"RTN","PRSDSRS",43,0)
EXT S EXT=^UTILITY("DIQ1",$J,450,DA,F,"E")
"RTN","PRSDSRS",44,0)
 S IL=$L(INT)
"RTN","PRSDSRS",45,0)
 I $P(NODEDD,U,2)["NJ",+INT=0 K NODEDD,NODEUTIL Q
"RTN","PRSDSRS",46,0)
 S:F=15 FLDNAM="NORMAL HOURS" S:F=458 INT=$E(INT,1,4)_":"_$E(INT,5,8)
"RTN","PRSDSRS",47,0)
 S:F=414 FLDNAM="TSP CSF DIST PCT" S:F=419 FLDNAM="TSP FIF DIST PCT"
"RTN","PRSDSRS",48,0)
 S:F=424 FLDNAM="TSP GSF DIST PCT"
"RTN","PRSDSRS",49,0)
 I $P(NODEDD,U,5)["""$""" S VAL=$FN(INT,",",2) G IOSL
"RTN","PRSDSRS",50,0)
 I F>88,F<116.3 S VAL=EXT I $D(^PRSP(454,1,"PUC","C",FLDNAM)) S FUIEN=$O(^PRSP(454,1,"PUC","C",FLDNAM,0)) I $P(^PRSP(454,1,"PUC",FUIEN,0),U,3)'="" S VAL=VAL_"  "_$P(^PRSP(454,1,"PUC",FUIEN,0),U,3) G IOSL
"RTN","PRSDSRS",51,0)
 I (F=404)!(F=414)!(F=419)!(F=424) S VAL=EXT G IOSL
"RTN","PRSDSRS",52,0)
 I $P(NODEDD,U,2)["D" S VAL=EXT G IOSL
"RTN","PRSDSRS",53,0)
 I $P(NODEDD,U,2)["NJ" S VAL=$J(INT,IL,2) G IOSL
"RTN","PRSDSRS",54,0)
 S VAL=EXT
"RTN","PRSDSRS",55,0)
 S:F=458 VAL=INT
"RTN","PRSDSRS",56,0)
IOSL K DOTS S NOD=32-$L(FLDNAM),$P(DOTS,".",NOD)="."
"RTN","PRSDSRS",57,0)
 I $Y>(IOSL-4) D PRTC Q:'PRTC
"RTN","PRSDSRS",58,0)
 I (F=400)!(F=407)!(F=414)!(F=419)!(F=424) W !
"RTN","PRSDSRS",59,0)
 W !,FLDNAM,DOTS
"RTN","PRSDSRS",60,0)
 D VAL Q
"RTN","PRSDSRS",61,0)
VAL I $L(VAL)<48 W ?32,VAL Q
"RTN","PRSDSRS",62,0)
 S COLUMN=32,LGTH=0
"RTN","PRSDSRS",63,0)
 F LOOP=1:1 Q:LGTH=$L(VAL)!(LGTH>($L(VAL)))  W:$L($P(VAL," ",LOOP))>(80-COLUMN) ! S:$L($P(VAL," ",LOOP))>(80-COLUMN) COLUMN=32 W ?COLUMN,$P(VAL," ",LOOP) S COLUMN=COLUMN+$L($P(VAL," ",LOOP))+1,LGTH=LGTH+$L($P(VAL," ",LOOP))+1
"RTN","PRSDSRS",64,0)
 Q
"RTN","PRSDSRS",65,0)
HDR W:$Y>0 @IOF S PAGE=PAGE+1
"RTN","PRSDSRS",66,0)
 S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDSRS",67,0)
 W !,NAME,?TAB,CCORG,?61,"DUTY STATION: ",STATION_DS
"RTN","PRSDSRS",68,0)
 I '$G(PRSTLV) W !,"XXX-XX-",$E(SSN,8,11),?71,"T&L: ",TLU,!,DASHES
"RTN","PRSDSRS",69,0)
 I $G(PRSTLV)=7 W !,SSN,?71,"T&L: ",TLU,!,DASHES
"RTN","PRSDSRS",70,0)
 S CLNGTH=$L(CATEGORY),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDSRS",71,0)
 W !,"LAST PP: ",LPP,?TAB,CATEGORY,?73,"PAGE ",PAGE
"RTN","PRSDSRS",72,0)
 W !,DASHES
"RTN","PRSDSRS",73,0)
 K CLNGTH,TAB Q
"RTN","PRSDSRS",74,0)
PRTC W:$Y<22 ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSDSRS",75,0)
 S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR
"RTN","PRSDSRS",76,0)
 I $D(DIRUT) S PRTC=0 Q
"RTN","PRSDSRS",77,0)
 D:'$D(END) HDR Q
"RTN","PRSDSRS",78,0)
 Q
"RTN","PRSDSRS",79,0)
SVC S Y=$P(^PRSPC(DA,0),U,49),C=$P(^DD(450,458,0),U,2) D Y^DIQ S USRSVC=Y
"RTN","PRSDSRS",80,0)
 S DIC="^PRSPC(",DIC(0)="AEQ",DIC("A")="Select EMPLOYEE: "
"RTN","PRSDSRS",81,0)
 S DIC("S")="S YSAV=Y,Y=$P(^PRSPC(YSAV,0),U,49),C=$P(^DD(450,458,0),U,2) D Y^DIQ S EMPSVC=Y,Y=YSAV I USRSVC=EMPSVC"
"RTN","PRSDSRS",82,0)
 D ^DIC I Y=-1 G EX
"RTN","PRSDSRS",83,0)
 S DA=+Y D START G SVC
"RTN","PRSDSRS",84,0)
 ;S %ZIS="QM" D ^%ZIS G EX:POP
"RTN","PRSDSRS",85,0)
 ;I $D(IO("Q")) D  G EX
"RTN","PRSDSRS",86,0)
 ;.S ZTRTN="START^PRSDSRS",ZTDESC="PRS SERVICE RECORD SCREEN"
"RTN","PRSDSRS",87,0)
 ;.S ZTSAVE("DA")=""
"RTN","PRSDSRS",88,0)
 ;.D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued!" D HOME^%ZIS K IO("Q") Q
"RTN","PRSDV450")
0^5^B24678213^B24678259
"RTN","PRSDV450",1,0)
PRSDV450 ;HISC/MGD-VIEW PAID EMPLOYEE DATA ;09/05/2003
"RTN","PRSDV450",2,0)
 ;;4.0;PAID;**2,82,114,100**;Sep 21, 1995;Build 3
"RTN","PRSDV450",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSDV450",4,0)
EN1 ;HRM entry
"RTN","PRSDV450",5,0)
 S LIMIT=10,PRSTLV=7 D PTBL^PRSDVTBL G EMP
"RTN","PRSDV450",6,0)
EN2 ;Fiscal entry
"RTN","PRSDV450",7,0)
 S LIMIT=12,PRSTLV=7 D FTBL^PRSDVTBL
"RTN","PRSDV450",8,0)
EMP K DASHES S $P(DASHES,"-",80)="-",FIRST=""
"RTN","PRSDV450",9,0)
 K DIC,^UTILITY("DIQ1",$J)
"RTN","PRSDV450",10,0)
 S DIC="^PRSPC(",DIC(0)="AEMQZ",DIC("A")="Select EMPLOYEE: " D ^DIC
"RTN","PRSDV450",11,0)
 K DIC I Y'>0 D KILL1,KILL2 Q
"RTN","PRSDV450",12,0)
 S DA=+Y,ZERO=^PRSPC(DA,0),NAME=$P(ZERO,U,1),SSN=$P(ZERO,U,9)
"RTN","PRSDV450",13,0)
 S SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9),TLU=$P(ZERO,U,8)
"RTN","PRSDV450",14,0)
 S STATION=$P(ZERO,U,7),Y=$P(ZERO,U,49) X ^DD(450,458,2.1) S CCORG=Y
"RTN","PRSDV450",15,0)
 S DS=$P($G(^PRSPC(DA,1)),U,42),LPP=$P($G(^PRSPC(DA,"MISC4")),U,16)
"RTN","PRSDV450",16,0)
CAT S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV450",17,0)
 W @IOF,!,NAME,?TAB,CCORG,?61,"DUTY STATION: ",STATION_DS
"RTN","PRSDV450",18,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES
"RTN","PRSDV450",19,0)
 W ! F L=1:1:LIMIT W !,?20,$P(CHOICE(L),";",3),?23,$P(CHOICE(L),";",4)
"RTN","PRSDV450",20,0)
SAN W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSDV450",21,0)
 S DIR(0)="NAO^1:"_LIMIT_":0",DIR("A")="Select a number: "
"RTN","PRSDV450",22,0)
 S DIR("?")="Type a number between 1 and "_LIMIT S:$D(FIRST) DIR("B")=3
"RTN","PRSDV450",23,0)
 D ^DIR I ($D(DTOUT))!($D(DUOUT))!($D(DIROUT)) D KILL1 G EMP
"RTN","PRSDV450",24,0)
 I X="@" W !!,*7,DIR("?")_"." G SAN
"RTN","PRSDV450",25,0)
 G:X="" EMP
"RTN","PRSDV450",26,0)
 I CHOICE(+Y)["NURSING" S PP=$P(^PRSPC(DA,0),U,21) I (PP'="K")&(PP'="M")&(PP'="X") W !!,*7,"This employee is not a nurse.  Pay Plan code not K, M or X.",! K PP G SAN
"RTN","PRSDV450",27,0)
 I CHOICE(+Y)["SEPARATED" I $P($G(^PRSPC(DA,1)),U,33)'="Y" W !!,*7,"This is not a separated employee.  Separation Ind not equal Y.",! G SAN
"RTN","PRSDV450",28,0)
 S PAGE=0,CATEGORY=$P(CHOICE(+Y),";",4),LAB=$P(CHOICE(+Y),";",5)
"RTN","PRSDV450",29,0)
 S NOL=$P(CHOICE(+Y),";",6)
"RTN","PRSDV450",30,0)
 F L=1:1:NOL S (VAL(L),PRNTORDR(L))=$P($T(@LAB+L^PRSDVTBL),";",3) D
"RTN","PRSDV450",31,0)
 .F  Q:VAL(L)'[","  S VAL(L)=$P(VAL(L),",")_";"_$P(VAL(L),",",2,999)
"RTN","PRSDV450",32,0)
 .F  Q:VAL(L)'[":1:"  S VAL(L)=$P(VAL(L),":1:")_":"_$P(VAL(L),":1:",2,999)
"RTN","PRSDV450",33,0)
 .F  Q:VAL(L)'[":.01:"  S VAL(L)=$P(VAL(L),":.01:")_":"_$P(VAL(L),":.01:",2,999)
"RTN","PRSDV450",34,0)
 S IOFSAV=IOF
"RTN","PRSDV450",35,0)
 K %ZIS,IOP S %ZIS="MQ",%ZIS("B")="" D ^%ZIS I POP D KILL1,KILL2 Q
"RTN","PRSDV450",36,0)
 S IOF=IOFSAV
"RTN","PRSDV450",37,0)
 F L="CATEGORY","CCORG","CLNGTH","DA","DASHES","DATETIME","VAL(","DS","LPP","NAME","PAGE","PRNTORDR(","SSN","STATION","TAB","TLU","PRSTLV" S ZTSAVE(L)=""
"RTN","PRSDV450",38,0)
 I $D(IO("Q")) S ZTIO=ION,ZTDESC="DISPLAY EMPLOYEE DATA",ZTRTN="DISPLAY^PRSDV450",ZTREQ="@",ZTSAVE("ZTREQ")="" D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued!" D KILL1 K FIRST G CAT
"RTN","PRSDV450",39,0)
 D:$E(IOST,1)="C" WAIT^DICD
"RTN","PRSDV450",40,0)
 U IO D DISPLAY K FIRST G:PRTC=0 CAT
"RTN","PRSDV450",41,0)
 I $E(IOST,1)="C" D:PRTC="" PRTC G:PRTC=0 CAT
"RTN","PRSDV450",42,0)
 D:$E(IOST,1)'="C" ^%ZISC
"RTN","PRSDV450",43,0)
 W @IOF K FIRST G CAT
"RTN","PRSDV450",44,0)
DISPLAY S DRIEN=0 F  S DRIEN=$O(VAL(DRIEN)) Q:DRIEN=""  S DIQ(0)="EI",DIC="^PRSPC(",DR=VAL(DRIEN) D EN^DIQ1
"RTN","PRSDV450",45,0)
 W:$E(IOST,1)="C" @IOF D HDR^PRSDSRS
"RTN","PRSDV450",46,0)
 D ^PRSDYTD
"RTN","PRSDV450",47,0)
 I CATEGORY="LABOR DISTRIBUTION" D
"RTN","PRSDV450",48,0)
 . S PRTC=0
"RTN","PRSDV450",49,0)
 . D LD
"RTN","PRSDV450",50,0)
 . I $E(IOST,1)="C" D CHECK
"RTN","PRSDV450",51,0)
 . I $E(IOST,1)'="C" D ^%ZISC
"RTN","PRSDV450",52,0)
 I CATEGORY'="LABOR DISTRIBUTION" D
"RTN","PRSDV450",53,0)
 . S PRIEN=0,PRTC="" F  S PRIEN=$O(PRNTORDR(PRIEN)) Q:PRIEN=""  S PRNTVALS="F FIELDN="_PRNTORDR(PRIEN)_" D WRITE^PRSDW450 Q:PRTC=0" X PRNTVALS
"RTN","PRSDV450",54,0)
KILL1 K D0,DIC,DIQ,DIQ2,DIR,DIRUT,DIROUT,DR,DRIEN,VAL,DTOUT,DUOUT,FIELDN
"RTN","PRSDV450",55,0)
 K IOFSAV,IOP,L,POP,PRIEN,PRNTORDR,PRNTVALS,X,Y,ZERO,ZTDESC,ZTIO,ZTRTN
"RTN","PRSDV450",56,0)
 K ZTSAVE,ZTSK,%ZIS,^UTILITY("DIQ1",$J)
"RTN","PRSDV450",57,0)
 D YTDEX^PRSDYTD
"RTN","PRSDV450",58,0)
 Q
"RTN","PRSDV450",59,0)
KILL2 K CATEGORY,CCORG,CHOICE,CLNGTH,DA,DASHES,DATETIME,DS,FIRST,LAB,LIMIT,LPP
"RTN","PRSDV450",60,0)
 K NAME,NOL,PAGE,PRSTLV,PRTC,SSN,STATION,TAB,TLU,LOOP,ZTREQ,%,%I
"RTN","PRSDV450",61,0)
 Q
"RTN","PRSDV450",62,0)
CHECK I $E(IOST,1)="C",$Y>(IOSL-4) D PRTC
"RTN","PRSDV450",63,0)
 Q
"RTN","PRSDV450",64,0)
PRTC W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSDV450",65,0)
 S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR S PRTC=Y
"RTN","PRSDV450",66,0)
 S:$D(DIRUT) PRTC=0
"RTN","PRSDV450",67,0)
 Q
"RTN","PRSDV450",68,0)
LD ; Display Labor Distribution codes 
"RTN","PRSDV450",69,0)
 Q:'$G(DA)
"RTN","PRSDV450",70,0)
 N DESC,INTERNAL,LDCNT,LDDATA,NODEDD,PRSLD,Y
"RTN","PRSDV450",71,0)
 S DIC=450,DIQ(0)="IE",DIQ="LDDATA"
"RTN","PRSDV450",72,0)
 F PRSLD=756,755,755.1 D
"RTN","PRSDV450",73,0)
 . S DR=PRSLD
"RTN","PRSDV450",74,0)
 . D EN^DIQ1
"RTN","PRSDV450",75,0)
 . S NODEDD=^DD(450,PRSLD,0)
"RTN","PRSDV450",76,0)
 . S INTERNAL=$G(LDDATA(450,DA,PRSLD,"I"))
"RTN","PRSDV450",77,0)
 . S DESC=$G(LDDATA(450,DA,PRSLD,"E"))
"RTN","PRSDV450",78,0)
 . W !,$P(NODEDD,U,1)
"RTN","PRSDV450",79,0)
 . W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV450",80,0)
 . I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC^PRSDW450
"RTN","PRSDV450",81,0)
 ;
"RTN","PRSDV450",82,0)
 F PRSLD=1:1:4 D
"RTN","PRSDV450",83,0)
 . S DIC=450,DR=757 ; Specify LD multiple
"RTN","PRSDV450",84,0)
 . S DR(450.0757)="1;2;3;4",DA(450.0757)=PRSLD ; Specify fields w/in mult
"RTN","PRSDV450",85,0)
 . S DIQ(0)="IE",DIQ="LDDATA"
"RTN","PRSDV450",86,0)
 . D EN^DIQ1
"RTN","PRSDV450",87,0)
 . F LDCNT=1:1:4 D
"RTN","PRSDV450",88,0)
 . . S NODEDD=^DD(450.0757,LDCNT,0)
"RTN","PRSDV450",89,0)
 . . S INTERNAL=$G(LDDATA(450.0757,PRSLD,LDCNT,"I"))
"RTN","PRSDV450",90,0)
 . . I LDCNT'=3 S DESC=$G(LDDATA(450.0757,PRSLD,LDCNT,"E"))
"RTN","PRSDV450",91,0)
 . . I LDCNT=3 D
"RTN","PRSDV450",92,0)
 . . . S Y=INTERNAL,SUB454="CC"
"RTN","PRSDV450",93,0)
 . . . D OT^PRSDUTIL K SUB454
"RTN","PRSDV450",94,0)
 . . . S DESC=Y
"RTN","PRSDV450",95,0)
 . . W !,"LABOR DIST CODE-",PRSLD," ",$P(NODEDD,U,1)
"RTN","PRSDV450",96,0)
 . . W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV450",97,0)
 . . I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC^PRSDW450
"RTN","PRSDV450",98,0)
 . . D CHECK
"RTN","PRSDV450",99,0)
 . . I PRTC W @IOF D HDR^PRSDSRS S PRTC=0
"RTN","PRSDV450",100,0)
 I $E(IOST,1)="C" D PRTC
"RTN","PRSDV450",101,0)
 Q
"RTN","PRSDV459")
0^6^B36198175^B35641317
"RTN","PRSDV459",1,0)
PRSDV459 ;HISC/MGD-VIEW PAID PAYRUN DATA ;09/09/04
"RTN","PRSDV459",2,0)
 ;;4.0;PAID;**78,83,82,86,73,97,100**;Sep 21, 1995;Build 3
"RTN","PRSDV459",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRSDV459",4,0)
 K CHOICE F LOOP=1:1:5 S CHOICE(LOOP)=$T(TABLE+LOOP)
"RTN","PRSDV459",5,0)
PP ;select pay period
"RTN","PRSDV459",6,0)
 K DIC S DIC="^PRST(459,",DIC(0)="AEMQZ" D ^DIC I Y'>0 D KILL1,KILL2 Q
"RTN","PRSDV459",7,0)
 S PP=+Y,PPNAME=$P(^PRST(459,PP,0),U,1)
"RTN","PRSDV459",8,0)
EMP K DASHES S $P(DASHES,"-",80)="-"
"RTN","PRSDV459",9,0)
 K DIC,^UTILITY("DIQ1",$J) S DIC="^PRST(459,"_PP_",""P"",",DIC(0)="AEMQZ" D ^DIC K DIC G:Y'>0 PP
"RTN","PRSDV459",10,0)
 S EMP=+Y,ZERO=^PRST(459,PP,"P",EMP,0),NAME=$P(^PRSPC(EMP,0),U,1)
"RTN","PRSDV459",11,0)
 S SSN=$P(ZERO,U,2),SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9)
"RTN","PRSDV459",12,0)
 S TLU=$P(ZERO,U,13),STATION=$P(^PRSPC(EMP,0),U,7)
"RTN","PRSDV459",13,0)
 S Y=$P(^PRSPC(EMP,0),U,49) X ^DD(450,458,2.1) S CCORG=Y
"RTN","PRSDV459",14,0)
 S DS=$P($G(^PRSPC(EMP,1)),U,42)
"RTN","PRSDV459",15,0)
CAT S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",16,0)
 W @IOF,!,NAME,?TAB,CCORG,?61,"DUTY STATION: ",STATION_DS
"RTN","PRSDV459",17,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES,!,"PAY PERIOD: ",PPNAME
"RTN","PRSDV459",18,0)
 W !! F LOOP=1:1:5 W !,?20,$P(CHOICE(LOOP),";",3),?23,$P(CHOICE(LOOP),";",4)
"RTN","PRSDV459",19,0)
SAN W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSDV459",20,0)
 S DIR(0)="NAO^1:5:0",DIR("A")="Select a number: "
"RTN","PRSDV459",21,0)
 S DIR("?")="Type a number between 1 and 5"
"RTN","PRSDV459",22,0)
 D ^DIR I $D(DTOUT)!($D(DUOUT))!($D(DIROUT)) D KILL1 G EMP
"RTN","PRSDV459",23,0)
 I X="@" W !!,*7,DIR("?")_"." G SAN
"RTN","PRSDV459",24,0)
 G:X="" EMP
"RTN","PRSDV459",25,0)
 N L,LAB,NOL
"RTN","PRSDV459",26,0)
 S CATEGORY=$P(CHOICE(+Y),";",4),LAB=$P(CHOICE(+Y),";",5)
"RTN","PRSDV459",27,0)
 S NOL=$P(CHOICE(+Y),";",6),PAGE=0
"RTN","PRSDV459",28,0)
 F L=1:1:NOL S (DRSUB(L),PRNTORDR(L))=$P($T(@LAB+L^PRSDV459),";",3) D
"RTN","PRSDV459",29,0)
 . F  Q:DRSUB(L)'[","  D
"RTN","PRSDV459",30,0)
 . . S DRSUB(L)=$P(DRSUB(L),",")_";"_$P(DRSUB(L),",",2,999)
"RTN","PRSDV459",31,0)
 . F  Q:DRSUB(L)'[":1:"  D
"RTN","PRSDV459",32,0)
 . . S DRSUB(L)=$P(DRSUB(L),":1:")_":"_$P(DRSUB(L),":1:",2,999)
"RTN","PRSDV459",33,0)
 . F  Q:DRSUB(L)'[":.01:"  D
"RTN","PRSDV459",34,0)
 . . S DRSUB(L)=$P(DRSUB(L),":.01:")_":"_$P(DRSUB(L),":.01:",2,999)
"RTN","PRSDV459",35,0)
 S IOFSAV=IOF
"RTN","PRSDV459",36,0)
 K %ZIS,IOP S %ZIS="MQ",%ZIS("B")="" D ^%ZIS I POP D KILL1,KILL2 Q
"RTN","PRSDV459",37,0)
 S IOF=IOFSAV
"RTN","PRSDV459",38,0)
 F LOOP="CATEGORY","CCORG","CLNGTH","DASHES","DS","EMP","DRSUB(","NAME","PAGE","PP","PPNAME","PRNTORDR(","SSN","STATION","TAB","TLU" S ZTSAVE(LOOP)=""
"RTN","PRSDV459",39,0)
 I $D(IO("Q")) S ZTIO=ION,ZTDESC="DISPLAY PAYRUN DATA",ZTRTN="DISPLAY^PRSDV459",ZTREQ="@",ZTSAVE("ZTREQ")="" D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued!" D KILL1 G CAT
"RTN","PRSDV459",40,0)
 D:$E(IOST,1)="C" WAIT^DICD
"RTN","PRSDV459",41,0)
 U IO D DISPLAY G:PRTC=0 CAT
"RTN","PRSDV459",42,0)
 I $E(IOST,1)="C" D:PRTC="" PRTC G:PRTC=0 CAT
"RTN","PRSDV459",43,0)
 D:$E(IOST,1)'="C" ^%ZISC
"RTN","PRSDV459",44,0)
 W @IOF G CAT
"RTN","PRSDV459",45,0)
DISPLAY ;display payrun data
"RTN","PRSDV459",46,0)
 N DRIEN
"RTN","PRSDV459",47,0)
 S DRIEN=0
"RTN","PRSDV459",48,0)
 F  S DRIEN=$O(DRSUB(DRIEN)) Q:DRIEN=""  D
"RTN","PRSDV459",49,0)
 . S DIQ(0)="EIN",DIC=459,DR=1,DR(459.01)=DRSUB(DRIEN),DA(459.01)=EMP,DA=PP
"RTN","PRSDV459",50,0)
 . D EN^DIQ1
"RTN","PRSDV459",51,0)
 W:$E(IOST,1)="C" @IOF D HEADER S FIELDN=0
"RTN","PRSDV459",52,0)
 I CATEGORY="LABOR DISTRIBUTION" D
"RTN","PRSDV459",53,0)
 . S PRTC=0
"RTN","PRSDV459",54,0)
 . D LD
"RTN","PRSDV459",55,0)
 . I $E(IOST,1)="C" D CHECK
"RTN","PRSDV459",56,0)
 . I $E(IOST,1)'="C" D ^%ZISC
"RTN","PRSDV459",57,0)
 I CATEGORY'="LABOR DISTRIBUTION" D
"RTN","PRSDV459",58,0)
 . S PRTC="",DRIEN=0
"RTN","PRSDV459",59,0)
 . F  S DRIEN=$O(PRNTORDR(DRIEN)) Q:DRIEN=""  D
"RTN","PRSDV459",60,0)
 . . S PRNTVALS="F FIELDN="_PRNTORDR(DRIEN)_" D WRITE^PRSDV459 Q:PRTC=0"
"RTN","PRSDV459",61,0)
 . . X PRNTVALS
"RTN","PRSDV459",62,0)
KILL1 ;kill most variables and close the device
"RTN","PRSDV459",63,0)
 K D0,DIC,DIQ,DIQ2,DIR,DIRUT,DIROUT,DR,DRSUB,DTOUT,DUOUT,FIELDN,IOFSAV,IOP,LOOP,POP,PRNTORDR,PRNTVALS,X,Y,ZERO,ZTDESC,ZTIO,ZTRTN,ZTSAVE,ZTSK,%ZIS,^UTILITY("DIQ1",$J)
"RTN","PRSDV459",64,0)
 Q
"RTN","PRSDV459",65,0)
KILL2 ;kill the remaining variables
"RTN","PRSDV459",66,0)
 K CATEGORY,CCORG,CHOICE,CLNGTH,DA,DS,DASHES,EMP,NAME,PAGE,PP,PPNAME,PRTC,SSN,STATION,TAB,TLU,ZTREQ Q
"RTN","PRSDV459",67,0)
WRITE ;write the data
"RTN","PRSDV459",68,0)
 S NODEDD=^DD(459.01,FIELDN,0),DESC=$G(^UTILITY("DIQ1",$J,459.01,EMP,FIELDN,"E"))
"RTN","PRSDV459",69,0)
 I (DESC="")!(DESC="NA") K NODEDD,DESC Q
"RTN","PRSDV459",70,0)
 S INTERNAL=^UTILITY("DIQ1",$J,459.01,EMP,FIELDN,"I")
"RTN","PRSDV459",71,0)
 I $P(NODEDD,U,2)["NJ",+INTERNAL=0 K NODEDD,DESC Q
"RTN","PRSDV459",72,0)
 I PRTC=1 D HEADER S PRTC=""
"RTN","PRSDV459",73,0)
 W !,$P(NODEDD,U,1)
"RTN","PRSDV459",74,0)
 W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV459",75,0)
 I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC
"RTN","PRSDV459",76,0)
 K DESC,INTERNAL,NODEDD
"RTN","PRSDV459",77,0)
 D CHECK
"RTN","PRSDV459",78,0)
 Q
"RTN","PRSDV459",79,0)
CHECK I $E(IOST,1)="C",$Y>(IOSL-4) D PRTC
"RTN","PRSDV459",80,0)
 Q
"RTN","PRSDV459",81,0)
PRTC ;press return to continue
"RTN","PRSDV459",82,0)
 W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR S PRTC=Y S:$D(DIRUT) PRTC=0
"RTN","PRSDV459",83,0)
 Q
"RTN","PRSDV459",84,0)
HEADER ;print header
"RTN","PRSDV459",85,0)
 W:$Y>0 @IOF S PAGE=PAGE+1
"RTN","PRSDV459",86,0)
 S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",87,0)
 W !,NAME,?TAB,CCORG,?61,"DUTY STATION: ",STATION_DS
"RTN","PRSDV459",88,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES
"RTN","PRSDV459",89,0)
 S CLNGTH=$L(CATEGORY),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",90,0)
 W !,"PAY PERIOD: ",PPNAME,?TAB,CATEGORY,?73,"PAGE ",PAGE
"RTN","PRSDV459",91,0)
 W !,DASHES
"RTN","PRSDV459",92,0)
 K CLNGTH,TAB
"RTN","PRSDV459",93,0)
 Q
"RTN","PRSDV459",94,0)
LD ; Display Labor Distribution codes
"RTN","PRSDV459",95,0)
 Q:'$G(DA)
"RTN","PRSDV459",96,0)
 N PRSLD,LDCNT,LDDATA,Y
"RTN","PRSDV459",97,0)
 F PRSLD=1:1:4 D
"RTN","PRSDV459",98,0)
 . S DIC=459,DR=1,DA=PP ; Specify Pay Period 
"RTN","PRSDV459",99,0)
 . S DR(459.01)=173,DA(459.01)=EMP ; Specify Employee
"RTN","PRSDV459",100,0)
 . S DR(459.1173)="1;2;3;4",DA(459.1173)=PRSLD ; Specify LD multiple
"RTN","PRSDV459",101,0)
 . S DIQ(0)="IE",DIQ="LDDATA"
"RTN","PRSDV459",102,0)
 . D EN^DIQ1
"RTN","PRSDV459",103,0)
 . F LDCNT=1:1:4 D
"RTN","PRSDV459",104,0)
 . . S NODEDD=^DD(459.1173,LDCNT,0)
"RTN","PRSDV459",105,0)
 . . S INTERNAL=$G(LDDATA(459.1173,PRSLD,LDCNT,"I"))
"RTN","PRSDV459",106,0)
 . . I LDCNT'=3 S DESC=$G(LDDATA(459.1173,PRSLD,LDCNT,"E"))
"RTN","PRSDV459",107,0)
 . . I LDCNT=3 D
"RTN","PRSDV459",108,0)
 . . . S Y=INTERNAL,SUB454="CC"
"RTN","PRSDV459",109,0)
 . . . D OT^PRSDUTIL K SUB454
"RTN","PRSDV459",110,0)
 . . . S DESC=Y
"RTN","PRSDV459",111,0)
 . . W !,"LABOR DIST CODE-",PRSLD," ",$P(NODEDD,U,1)
"RTN","PRSDV459",112,0)
 . . W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV459",113,0)
 . . I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC^PRSDW450
"RTN","PRSDV459",114,0)
 Q
"RTN","PRSDV459",115,0)
 ;
"RTN","PRSDV459",116,0)
DESC ;write description
"RTN","PRSDV459",117,0)
 I $L(DESC)<33 W ?47,DESC Q
"RTN","PRSDV459",118,0)
 S COLUMN=47,LGTH=0
"RTN","PRSDV459",119,0)
 F LOOP1=1:1 Q:LGTH=$L(DESC)!(LGTH>($L(DESC)))  W:$L($P(DESC," ",LOOP1))>(80-COLUMN) ! S:$L($P(DESC," ",LOOP1))>(80-COLUMN) COLUMN=47 W ?COLUMN,$P(DESC," ",LOOP1) S COLUMN=COLUMN+$L($P(DESC," ",LOOP1))+1,LGTH=LGTH+$L($P(DESC," ",LOOP1))+1
"RTN","PRSDV459",120,0)
 K COLUMN,LGTH,LOOP1 Q
"RTN","PRSDV459",121,0)
TABLE ;set subfile dr variable
"RTN","PRSDV459",122,0)
 ;;1;GENERAL INFORMATION;P1;1
"RTN","PRSDV459",123,0)
 ;;2;EARNINGS;P2;2
"RTN","PRSDV459",124,0)
 ;;3;DEDUCTIONS;P3;4
"RTN","PRSDV459",125,0)
 ;;4;LEAVE;P4;1
"RTN","PRSDV459",126,0)
 ;;5;LABOR DISTRIBUTION;
"RTN","PRSDV459",127,0)
 ;
"RTN","PRSDV459",128,0)
P1 ;;1;GENERAL INFORMATION;P1;1
"RTN","PRSDV459",129,0)
 ;;2,3,4,5,6,11,13,110,122,123,112,118,111,7,8,9,10,115,116,117,171,160
"RTN","PRSDV459",130,0)
P2 ;;2;EARNINGS;P2;2
"RTN","PRSDV459",131,0)
 ;;81,82,83,73,85,124,149,86,87,94,95,101,90,91,97,99,100,88,89,92
"RTN","PRSDV459",132,0)
 ;;93,98,96,102,103,104,104.1,172,105,109,113,114,108,106,107,74
"RTN","PRSDV459",133,0)
P3 ;;3;DEDUCTIONS;P3;4
"RTN","PRSDV459",134,0)
 ;;20,21,22,23,24,27,28,29,25,26,39,40,56,57,60,63,66,59,62,65,58,61
"RTN","PRSDV459",135,0)
 ;;64,33,34,35,30,31,32,36,37,41:1:48,55,53,54,67.1,67,68.1,68,68.3
"RTN","PRSDV459",136,0)
 ;;68.2,68.5,68.4,69,70,71,72,38,84,49,50,51,52,150,151,178,179
"RTN","PRSDV459",137,0)
 ;;152,153,180,181,167,168,175,174,177,176,159
"RTN","PRSDV459",138,0)
P4 ;;4;LEAVE;P4;1
"RTN","PRSDV459",139,0)
 ;;75,76,77,78,79,80,80.1,80.2,106,107,154,155,156,157,158
"RTN","PRSDV459",140,0)
P5 ;;5;LABOR DISTRIBUTION;
"UP",454,454.0128,-1)
454^DTY
"UP",454,454.0128,0)
454.0128
"VER")
8.0^22.0
"^DD",454,454,128,0)
DUTY STATION^454.0128I^^DTY;0
"^DD",454,454,128,21,0)
^.001^1^1^3080623^^
"^DD",454,454,128,21,1,0)
Duty Station codes and descriptions.
"^DD",454,454.0128,0)
DUTY STATION SUB-FIELD^^1^2
"^DD",454,454.0128,0,"NM","DUTY STATION")

"^DD",454,454.0128,.01,0)
DUTY STATION^MF^^0;1^K:$L(X)>2!($L(X)<1) X
"^DD",454,454.0128,.01,1,0)
^.1
"^DD",454,454.0128,.01,1,1,0)
454.0128^B
"^DD",454,454.0128,.01,1,1,1)
S ^PRSP(454,DA(1),"DTY","B",$E(X,1,30),DA)=""
"^DD",454,454.0128,.01,1,1,2)
K ^PRSP(454,DA(1),"DTY","B",$E(X,1,30),DA)
"^DD",454,454.0128,.01,3)
Answer must be 1-2 characters in length.
"^DD",454,454.0128,.01,21,0)
^.001^1^1^3080623^^^
"^DD",454,454.0128,.01,21,1,0)
Duty Station code.
"^DD",454,454.0128,.01,"DT")
3080623
"BLD",7623,6)
^107
**END**
**END**
