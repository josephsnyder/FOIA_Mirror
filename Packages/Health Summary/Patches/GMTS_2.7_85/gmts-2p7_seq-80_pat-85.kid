Released GMTS*2.7*85 SEQ #80
Extracted from mail message
**KIDS**:GMTS*2.7*85^

**INSTALL NAME**
GMTS*2.7*85
"BLD",18197,0)
GMTS*2.7*85^HEALTH SUMMARY^0^3070925^y
"BLD",18197,4,0)
^9.64PA^142^1
"BLD",18197,4,142,0)
142
"BLD",18197,4,142,2,0)
^9.641^142^1
"BLD",18197,4,142,2,142,0)
HEALTH SUMMARY TYPE  (File-top level)
"BLD",18197,4,142,2,142,1,0)
^9.6411^100^1
"BLD",18197,4,142,2,142,1,100,0)
SUPPRESS SENSITIVE PRINT DATA
"BLD",18197,4,142,222)
y^n^p^^^^n^^n
"BLD",18197,4,142,224)

"BLD",18197,4,"APDD",142,142)

"BLD",18197,4,"APDD",142,142,100)

"BLD",18197,4,"B",142,142)

"BLD",18197,6)
10^
"BLD",18197,6.3)
24
"BLD",18197,"KRN",0)
^9.67PA^8989.52^19
"BLD",18197,"KRN",.4,0)
.4
"BLD",18197,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",18197,"KRN",.4,"NM",1,0)
GMTS TYPE INQ HEADER    FILE #142^142^0
"BLD",18197,"KRN",.4,"NM","B","GMTS TYPE INQ HEADER    FILE #142",1)

"BLD",18197,"KRN",.401,0)
.401
"BLD",18197,"KRN",.402,0)
.402
"BLD",18197,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",18197,"KRN",.402,"NM",1,0)
GMTS EDIT HLTH SUM TYPE    FILE #142^142^0
"BLD",18197,"KRN",.402,"NM","B","GMTS EDIT HLTH SUM TYPE    FILE #142",1)

"BLD",18197,"KRN",.403,0)
.403
"BLD",18197,"KRN",.5,0)
.5
"BLD",18197,"KRN",.84,0)
.84
"BLD",18197,"KRN",3.6,0)
3.6
"BLD",18197,"KRN",3.8,0)
3.8
"BLD",18197,"KRN",9.2,0)
9.2
"BLD",18197,"KRN",9.8,0)
9.8
"BLD",18197,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",18197,"KRN",9.8,"NM",1,0)
GMTSUP^^0^B48447273
"BLD",18197,"KRN",9.8,"NM",2,0)
GMTSHCPR^^0^B11365118
"BLD",18197,"KRN",9.8,"NM","B","GMTSHCPR",2)

"BLD",18197,"KRN",9.8,"NM","B","GMTSUP",1)

"BLD",18197,"KRN",19,0)
19
"BLD",18197,"KRN",19.1,0)
19.1
"BLD",18197,"KRN",101,0)
101
"BLD",18197,"KRN",409.61,0)
409.61
"BLD",18197,"KRN",771,0)
771
"BLD",18197,"KRN",870,0)
870
"BLD",18197,"KRN",8989.51,0)
8989.51
"BLD",18197,"KRN",8989.52,0)
8989.52
"BLD",18197,"KRN",8994,0)
8994
"BLD",18197,"KRN","B",.4,.4)

"BLD",18197,"KRN","B",.401,.401)

"BLD",18197,"KRN","B",.402,.402)

"BLD",18197,"KRN","B",.403,.403)

"BLD",18197,"KRN","B",.5,.5)

"BLD",18197,"KRN","B",.84,.84)

"BLD",18197,"KRN","B",3.6,3.6)

"BLD",18197,"KRN","B",3.8,3.8)

"BLD",18197,"KRN","B",9.2,9.2)

"BLD",18197,"KRN","B",9.8,9.8)

"BLD",18197,"KRN","B",19,19)

"BLD",18197,"KRN","B",19.1,19.1)

"BLD",18197,"KRN","B",101,101)

"BLD",18197,"KRN","B",409.61,409.61)

"BLD",18197,"KRN","B",771,771)

"BLD",18197,"KRN","B",870,870)

"BLD",18197,"KRN","B",8989.51,8989.51)

"BLD",18197,"KRN","B",8989.52,8989.52)

"BLD",18197,"KRN","B",8994,8994)

"BLD",18197,"QUES",0)
^9.62^^
"BLD",18197,"REQB",0)
^9.611^1^1
"BLD",18197,"REQB",1,0)
GMTS*2.7*58^2
"BLD",18197,"REQB","B","GMTS*2.7*58",1)

"FIA",142)
HEALTH SUMMARY TYPE
"FIA",142,0)
^GMT(142,
"FIA",142,0,0)
142
"FIA",142,0,1)
y^n^p^^^^n^^n
"FIA",142,0,10)

"FIA",142,0,11)

"FIA",142,0,"RLRO")

"FIA",142,0,"VR")
2.7^GMTS
"FIA",142,142)
1
"FIA",142,142,100)

"KRN",.4,508,-1)
0^1
"KRN",.4,508,0)
GMTS TYPE INQ HEADER^3070327.1348^^142^^^3070925
"KRN",.4,508,"F",1)
"HEALTH SUMMARY TYPE INQUIRY";C24~"         Type Name:";C1;S1~.01~"             Title:";C1~.02~"             Owner:";C1~.06~"";C44~
"KRN",.4,508,"F",2)
W:$P($G(^GMT(142,D0,0)),"^",2)'="" "LOCK: ";Z;"W:$P($G(^GMT(142,D0,0)),"^",2)'="" "LOCK: ""~.05;C53;L25~
"KRN",.4,508,"F",3)
"SUPPRESS PRINT OF COMPONENTS WITHOUT DATA:";C1~.08~"SUPPRESS SENSITIVE PRINT DATA:";C1~100~
"KRN",.4,508,"F",4)
"                                   Max        Hos  ICD   Pro  CPT";C1;S1~
"KRN",.4,508,"F",5)
"Abb   Ord    Component Name        Occ  Time  Loc  Text  Nar  Mod  Selection";C1~
"KRN",.4,508,"F",6)
"------------------------------------------------------------------------------";C1~
"KRN",.4,508,"H")
@
"KRN",.4,508,"SUB")
1
"KRN",.402,632,-1)
0^1
"KRN",.402,632,0)
GMTS EDIT HLTH SUM TYPE^3070327.1407^^142^^^3070925
"KRN",.402,632,"DIAB",5,0,142,0)
SUPPRESS COMP WITHOUT DATA;T
"KRN",.402,632,"DR",1,142)
I '$D(GMTSNEW) S GMTSNEW=0;I GMTSNEW,'GMTSMGR S Y="@1";.01;.02;.08T~;100;I 'GMTSMGR S Y=0;.05;.06;S Y=0;@1;.06////^S X=DUZ;S Y=.01;
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",56,-1)
1^1
"PKG",56,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
"PKG",56,22,0)
^9.49I^1^1
"PKG",56,22,1,0)
2.7^2951020^2960605
"PKG",56,22,1,"PAH",1,0)
85^3070925^1392
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMTSHCPR")
0^2^B11365118^n/a
"RTN","GMTSHCPR",1,0)
GMTSHCPR ;BP/WAT - Sensitive Data in HS Type Hard Copies ; 3/29/07
"RTN","GMTSHCPR",2,0)
 ;;2.7; Health Summary; **85**; Oct 20, 1995;Build 24
"RTN","GMTSHCPR",3,0)
 ;
"RTN","GMTSHCPR",4,0)
 ;EXTERNAL REFERENCES
"RTN","GMTSHCPR",5,0)
 ; ICR 2198 $$BROKER^XWBLIB
"RTN","GMTSHCPR",6,0)
 ; ICR 10078 OP^XQCHK
"RTN","GMTSHCPR",7,0)
 ; $$HF^GMTSU
"RTN","GMTSHCPR",8,0)
 ; DEM^GMTSU
"RTN","GMTSHCPR",9,0)
 ; 
"RTN","GMTSHCPR",10,0)
 ; DFN, GMTSSN, GMTSPNM, GMTSPHDR, GMTSTYP, OBJ and VADM variables are set elsewhere in GMTS* code and therefore are not Newed here
"RTN","GMTSHCPR",11,0)
 ; DFN - of the current pt - will only be used here if VADM and GMTSSN/GMTSPNM are all null
"RTN","GMTSHCPR",12,0)
 ; GMTSSN - SSN of current pt
"RTN","GMTSHCPR",13,0)
 ; GMTSPNM - name of patient: LAST,FIRST
"RTN","GMTSHCPR",14,0)
 ;GMTSPHDR - array that is expected to hold pt name, ssn, dob, etc for the report header.  Values are set in DEM^GMTSU and should exist
"RTN","GMTSHCPR",15,0)
 ;at the time this routine is called.
"RTN","GMTSHCPR",16,0)
 ;GMTSTYP - IEN of health summary type and is set prior to this routine
"RTN","GMTSHCPR",17,0)
 ;;OBJ - set when dealing with a HS object and should exist at the time this routine is called
"RTN","GMTSHCPR",18,0)
 ;VADM - pt data array set in DEM^GMTSU - should exist at the time of execution.
"RTN","GMTSHCPR",19,0)
 ;GMTSSN85 = SSN value from pt data array VADM(2)
"RTN","GMTSHCPR",20,0)
 ;GMTSNM85 =  pt name from pt data array VADM(1)
"RTN","GMTSHCPR",21,0)
 ;GMTSUPRT - internal value of SUPPRESS SENSITIVE DATA PRINT field in file 142
"RTN","GMTSHCPR",22,0)
 ;set of codes
"RTN","GMTSHCPR",23,0)
 ;0 or null = do nothing
"RTN","GMTSHCPR",24,0)
 ;1 = 4 digit ssn/no dob
"RTN","GMTSHCPR",25,0)
 ;2 = no ssn/no dob
"RTN","GMTSHCPR",26,0)
 ;GMTSGUI - result of $$BROKER^XWBLIB - 1 = Broker or VistALink GUI; 0 = not
"RTN","GMTSHCPR",27,0)
 ;GMTSUHF - result of $$HF^GMTSU - 0=gui printing; 1=not
"RTN","GMTSHCPR",28,0)
 ;GMTS4DIG - local variable for 4-digit ssn
"RTN","GMTSHCPR",29,0)
EN ;;
"RTN","GMTSHCPR",30,0)
 N GMTSUPRT,GMTSGUI,GMTSUHF,GMTS4DIG,GMTSSN85,GMTSNM85
"RTN","GMTSHCPR",31,0)
 ;abort if current option is Network Health Exchange-related
"RTN","GMTSHCPR",32,0)
 N XQOPT D OP^XQCHK Q:$P($G(XQOPT),U)["AFJX"
"RTN","GMTSHCPR",33,0)
 Q:$G(GMTSTYP)=""  S GMTSUPRT=$G(^GMT(142,GMTSTYP,2))
"RTN","GMTSHCPR",34,0)
 S GMTSGUI=$$BROKER^XWBLIB
"RTN","GMTSHCPR",35,0)
 S GMTSUHF=$$HF^GMTSU
"RTN","GMTSHCPR",36,0)
 ; store SSN and Name into local variables
"RTN","GMTSHCPR",37,0)
 S GMTSSN85=$S($L($G(VADM(2)))>0:$P($G(VADM(2)),U,2),1:$G(GMTSSN))
"RTN","GMTSHCPR",38,0)
 S GMTSNM85=$S($L($G(VADM(1)))>0:$G(VADM(1)),1:$G(GMTSPNM))
"RTN","GMTSHCPR",39,0)
 ;VADM can be killed by processing some clinical reminder components so make sure we have SSN and Name values
"RTN","GMTSHCPR",40,0)
 ;If GMTSSN or GMTSPNM are still undefined, refresh VADM
"RTN","GMTSHCPR",41,0)
 I $G(GMTSSN85)=""!($G(GMTSNM85)="") D
"RTN","GMTSHCPR",42,0)
 .Q:$G(DFN)=""  D DEM^GMTSU ;if you get here and DFN is somehow null, there won't be any pt name or ssn in the report header
"RTN","GMTSHCPR",43,0)
 .I $L($G(VADM(2)))>0 S GMTSSN85=$P($G(VADM(2)),U,2)
"RTN","GMTSHCPR",44,0)
 .I $L($G(VADM(1)))>0 S GMTSNM85=$G(VADM(1))
"RTN","GMTSHCPR",45,0)
 ;if either is null by here, artifically suppress DOB, put info message in Name/SSN variable, and QUIT
"RTN","GMTSHCPR",46,0)
 I $G(GMTSSN85)=""!($G(GMTSNM85)="") S GMTSPHDR("NMSSN")="SENSITIVE DATA SUPPRESSION FAILED, CONTACT IRM IF PERSISTENT",GMTSPHDR("DOB")=$JUSTIFY(" ",$L($G(GMTSPHDR("DOB")))) Q
"RTN","GMTSHCPR",47,0)
 D:$G(GMTSGUI)=1 GUISTRP
"RTN","GMTSHCPR",48,0)
 I $G(GMTSGUI)=0&($E(IOST,1,2)'="C-")&$G(GMTSUPRT)>0 D
"RTN","GMTSHCPR",49,0)
 .D:+$G(GMTSUPRT)=1 FOURDIG
"RTN","GMTSHCPR",50,0)
 .D:+$G(GMTSUPRT)=2 NOSSN
"RTN","GMTSHCPR",51,0)
 E  D:$G(OBJ)'=""
"RTN","GMTSHCPR",52,0)
 .D:+$G(GMTSUPRT)=1 FOURDIG
"RTN","GMTSHCPR",53,0)
 .D:+$G(GMTSUPRT)=2 NOSSN
"RTN","GMTSHCPR",54,0)
 Q
"RTN","GMTSHCPR",55,0)
GUISTRP ;if GUI is printing remove dob and adjust ssn as needed
"RTN","GMTSHCPR",56,0)
 I '$D(GMTSUHF)!(+$G(GMTSUHF)'=0) Q
"RTN","GMTSHCPR",57,0)
 D:+$G(GMTSUPRT)=1 FOURDIG
"RTN","GMTSHCPR",58,0)
 D:+$G(GMTSUPRT)=2 NOSSN
"RTN","GMTSHCPR",59,0)
 Q
"RTN","GMTSHCPR",60,0)
FOURDIG ;create 4 digit ssn
"RTN","GMTSHCPR",61,0)
 S GMTSPHDR("DOB")=$JUSTIFY(" ",$L($G(GMTSPHDR("DOB")))) ;replace data w/15 spaces to maintain formatting
"RTN","GMTSHCPR",62,0)
 D GT4SSN
"RTN","GMTSHCPR",63,0)
 S GMTSPHDR("NMSSN")=$G(GMTSNM85)_$JUSTIFY(" ",$L($G(GMTSSN85))-5)_$G(GMTS4DIG) ;concat name, 4 dig ssn, and spaces for formatting
"RTN","GMTSHCPR",64,0)
 Q
"RTN","GMTSHCPR",65,0)
NOSSN ;remove ssn
"RTN","GMTSHCPR",66,0)
 S GMTSPHDR("DOB")=$JUSTIFY(" ",$L($G(GMTSPHDR("DOB")))) ;replace data w/15 spaces to maintain formatting
"RTN","GMTSHCPR",67,0)
 S GMTSPHDR("NMSSN")=$G(GMTSNM85)
"RTN","GMTSHCPR",68,0)
 Q
"RTN","GMTSHCPR",69,0)
GT4SSN ;; get 4 digit ssn
"RTN","GMTSHCPR",70,0)
 I $G(GMTSSN85)'["P" D
"RTN","GMTSHCPR",71,0)
 .S GMTS4DIG=$E($G(GMTSSN85),($L($G(GMTSSN85))-3),$L($G(GMTSSN85))) ;create 4 dig ssn
"RTN","GMTSHCPR",72,0)
 E  S GMTS4DIG=$E($G(GMTSSN85),($L($G(GMTSSN85))-4),$L($G(GMTSSN85))) ;create 4 dig pseudo ssn
"RTN","GMTSHCPR",73,0)
 Q
"RTN","GMTSUP")
0^1^B48447273^B46571135
"RTN","GMTSUP",1,0)
GMTSUP ; SLC/KER - Utilities for Paging HS           ; 01/06/2003
"RTN","GMTSUP",2,0)
 ;;2.7;Health Summary;**2,7,21,27,28,30,35,47,56,58,85**;Oct 20, 1995;Build 24
"RTN","GMTSUP",3,0)
 ;
"RTN","GMTSUP",4,0)
 ; External References
"RTN","GMTSUP",5,0)
 ;   DBIA 10026  ^DIR
"RTN","GMTSUP",6,0)
 ;   DBIA    82  EN^XQORM
"RTN","GMTSUP",7,0)
 ;                       
"RTN","GMTSUP",8,0)
CKP ; Check page position, pause and prompt
"RTN","GMTSUP",9,0)
 Q:$D(GMTSQIT)  S GMTSNPG=0
"RTN","GMTSUP",10,0)
 K:$L($G(GMTSOBJ("LABEL"))) GMTSOBJ("REPORT HEADER")
"RTN","GMTSUP",11,0)
 I $G(GMTSWRIT)=1 D BREAK S GMTSWRIT=0
"RTN","GMTSUP",12,0)
 I +($$HF^GMTSU) D BREAK:(GMTSEGN'=$G(GMTSLCMP)) Q
"RTN","GMTSUP",13,0)
 Q:+$G(GMTSLPG)'>0&($Y'>(IOSL-GMTSLO))
"RTN","GMTSUP",14,0)
 I $E(IOST,1)="C" S:'$D(GMTSTOF) GMTSTOF=1 D CKP1
"RTN","GMTSUP",15,0)
 I '$D(GMTSQIT) W @IOF D HEADER,BREAK S GMTSNPG=1,GMTSTOF=GMTSEGN
"RTN","GMTSUP",16,0)
 I $D(GMTSQIT),(GMTSQIT]""),($D(GMTSTYP)) W @IOF D HEADER S GMTSTOF=GMTSEGN
"RTN","GMTSUP",17,0)
 Q
"RTN","GMTSUP",18,0)
CKP1 ; Help Display of Optional Components for Navigation
"RTN","GMTSUP",19,0)
 N DA,I,J,K,L,X,XQORM,Y,GMTSY,TYP,DIC
"RTN","GMTSUP",20,0)
 I $S('$D(GMTSTYP):1,$D(GMTOPT):1,1:0) N DIR S DIR(0)="E" D ^DIR K DIR S:$D(DUOUT)!(GMTSLPG) GMTSQIT="" Q
"RTN","GMTSUP",21,0)
 S TYP=GMTSTYP
"RTN","GMTSUP",22,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT
"RTN","GMTSUP",23,0)
 S GMTSTYP=+Y K DIC,X,Y
"RTN","GMTSUP",24,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="1AF\+",XQORM("A")="Press <RET> to continue, ^ to exit, or select component: "
"RTN","GMTSUP",25,0)
 S XQORM("??")="D HELP^GMTSUP1" I GMTSLPG,'$D(GMTSOBJ) W:'$D(GMTSOBJE) "* END * "
"RTN","GMTSUP",26,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")"
"RTN","GMTSUP",27,0)
 D EN^XQORM W ! D @$S(Y=1:"BRNCH",1:"EVAL")
"RTN","GMTSUP",28,0)
 I $D(GMTSY),(GMTSY=0) K GMTSY G CKP1
"RTN","GMTSUP",29,0)
 S GMTSTYP=TYP
"RTN","GMTSUP",30,0)
 Q
"RTN","GMTSUP",31,0)
BREAK ; Writes the Component Header
"RTN","GMTSUP",32,0)
 ;           
"RTN","GMTSUP",33,0)
 ;   If the variable GMTSOBJ exist, then the 
"RTN","GMTSUP",34,0)
 ;   Component Headers are suppressed with the
"RTN","GMTSUP",35,0)
 ;   following exceptions:
"RTN","GMTSUP",36,0)
 ;           
"RTN","GMTSUP",37,0)
 ;       If GMTSOBJ("COMPONENT HEADER") exist,
"RTN","GMTSUP",38,0)
 ;       then the Component Header will NOT be
"RTN","GMTSUP",39,0)
 ;       suppressed
"RTN","GMTSUP",40,0)
 ;           
"RTN","GMTSUP",41,0)
 ;       If GMTSOBJ("BLANK LINE") exist, a blank
"RTN","GMTSUP",42,0)
 ;       line will be written after the Component
"RTN","GMTSUP",43,0)
 ;       Header
"RTN","GMTSUP",44,0)
 ;              
"RTN","GMTSUP",45,0)
 N GMTSM,GMTSF S GMTSM=$$MUL,GMTSF=$$FST
"RTN","GMTSUP",46,0)
 I +GMTSM=0,$D(GMTSOBJ),'$D(GMTSOBJ("COMPONENT HEADER")),'$D(GMTSOBJ("BLANK LINE")) Q
"RTN","GMTSUP",47,0)
 N GMTS,GMTSUL,GMTSL S:'$D(GMTSLCMP) GMTSLCMP=0
"RTN","GMTSUP",48,0)
 S GMTSUL="",GMTSNPG=1,GMTS=$$CHDR,GMTSL=+($L($G(GMTS))),$P(GMTSUL,"-",+GMTSL)="-"
"RTN","GMTSUP",49,0)
 I $Y'>(IOSL-GMTSLO)!(+($$HF^GMTSU)) D
"RTN","GMTSUP",50,0)
 . I $D(GMTSOBJ) D  Q
"RTN","GMTSUP",51,0)
 . . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",52,0)
 . . I +($G(GMTSM))>0!($D(GMTSOBJ("COMPONENT HEADER"))) D
"RTN","GMTSUP",53,0)
 . . . W:+GMTSF=0 ! W !,GMTS W:$D(GMTSOBJ("UNDERLINE")) !,GMTSUL
"RTN","GMTSUP",54,0)
 . . . W ! W:$D(GMTSOBJ("BLANK LINE")) !
"RTN","GMTSUP",55,0)
 . W !,GMTS,!
"RTN","GMTSUP",56,0)
 . W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),!
"RTN","GMTSUP",57,0)
 . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",58,0)
 Q
"RTN","GMTSUP",59,0)
OLDB ;
"RTN","GMTSUP",60,0)
 S:'$D(GMTSLCMP) GMTSLCMP=0
"RTN","GMTSUP",61,0)
 S GMTS="",GMTSNPG=1
"RTN","GMTSUP",62,0)
 S $P(GMTS,"-",79-$L(GMTSEGH_GMTSEGL)/2)=""
"RTN","GMTSUP",63,0)
 S GMTS=GMTS_" "_GMTSEGH_GMTSEGL_" "_GMTS
"RTN","GMTSUP",64,0)
 I $Y'>(IOSL-GMTSLO)!(+($$HF^GMTSU)) D
"RTN","GMTSUP",65,0)
 . W !,GMTS,!
"RTN","GMTSUP",66,0)
 . W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),!
"RTN","GMTSUP",67,0)
 . S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",68,0)
        Q
"RTN","GMTSUP",69,0)
HEADER ; Print Running Header
"RTN","GMTSUP",70,0)
 ;           
"RTN","GMTSUP",71,0)
 ;   If the variable GMTSOBJ exist, then the 
"RTN","GMTSUP",72,0)
 ;   Report Headers are suppressed with the 
"RTN","GMTSUP",73,0)
 ;   following exceptions:
"RTN","GMTSUP",74,0)
 ;           
"RTN","GMTSUP",75,0)
 ;       If GMTSOBJ("DATE LINE") exist, then the
"RTN","GMTSUP",76,0)
 ;       Location/Report Date line will NOT be
"RTN","GMTSUP",77,0)
 ;       suppressed.
"RTN","GMTSUP",78,0)
 ;           
"RTN","GMTSUP",79,0)
 ;       If GMTSOBJ("CONFIDENTIAL") exist, then
"RTN","GMTSUP",80,0)
 ;       the Confidential Header Name line will
"RTN","GMTSUP",81,0)
 ;       NOT be suppressed.
"RTN","GMTSUP",82,0)
 ;           
"RTN","GMTSUP",83,0)
 ;       If GMTSOBJ("REPORT HEADER") exist, then
"RTN","GMTSUP",84,0)
 ;       the Report Header containing the patient's
"RTN","GMTSUP",85,0)
 ;       name, SSAN, ward and DOB will NOT be
"RTN","GMTSUP",86,0)
 ;       suppressed.
"RTN","GMTSUP",87,0)
 ;              
"RTN","GMTSUP",88,0)
 ;       If the variable GMTSOBJ("LABEL") contains
"RTN","GMTSUP",89,0)
 ;       text, and the variable GMTSOBJ("USE LABEL")
"RTN","GMTSUP",90,0)
 ;       exist, then this text will be printed before
"RTN","GMTSUP",91,0)
 ;       the object text.
"RTN","GMTSUP",92,0)
 ;                 
"RTN","GMTSUP",93,0)
 ;       If GMTSOBJ("REPORT DECEASED") exist, then
"RTN","GMTSUP",94,0)
 ;       the optional line that displays for Deceased
"RTN","GMTSUP",95,0)
 ;       patients will NOT be suppressed.
"RTN","GMTSUP",96,0)
 ;                 
"RTN","GMTSUP",97,0)
 ;   Header Lines:
"RTN","GMTSUP",98,0)
 N GMTSVDT,DATA S DATA="" I +$G(GMTSPXD1)&+$G(GMTSPXD2) D
"RTN","GMTSUP",99,0)
 . Q:$G(GMTSOBJ)  S:'$D(GMTSOBJE) DATA="Printed for data "  S:$D(GMTSOBJE) DATA="Include data "
"RTN","GMTSUP",100,0)
 . I GMTSPXD1=GMTSPXD2 S DATA=DATA_"on "_GMTSPXD1 Q
"RTN","GMTSUP",101,0)
 . S DATA=DATA_"from "_GMTSPXD2_" to "_GMTSPXD1
"RTN","GMTSUP",102,0)
 I $D(GMTSCDT(0)),'$D(GMTSOBJ) S GMTSVDT=GMTSCDT(0) S:GMTSDTM'["Printed:" GMTSDTM="Printed: "_GMTSDTM
"RTN","GMTSUP",103,0)
 ;     Location and Date of Report
"RTN","GMTSUP",104,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("DATE LINE"))) D
"RTN","GMTSUP",105,0)
 . N GMTSLOC S GMTSLOC=$S('$D(GMTSOBJ("DATE LINE")):$P($G(GMTSSC),U,2),1:"")
"RTN","GMTSUP",106,0)
 . W !,$S($L(GMTSLOC):"Location: "_GMTSLOC_" ",1:"")
"RTN","GMTSUP",107,0)
 . W $S($D(GMTSVDT):GMTSVDT,1:"")
"RTN","GMTSUP",108,0)
 . W:'$D(GMTSOBJ("DATE LINE")) DATA,?(79-$L(GMTSDTM)),GMTSDTM
"RTN","GMTSUP",109,0)
 . W:$D(GMTSOBJ("DATE LINE")) DATA,?(74-$L(GMTSDTM)),GMTSDTM
"RTN","GMTSUP",110,0)
 ;     Confidential Header Name
"RTN","GMTSUP",111,0)
 S:'$D(GMTSPG) GMTSPG=0
"RTN","GMTSUP",112,0)
 S GMTSPG=GMTSPG+1,GMTSHDR=" CONFIDENTIAL "_GMTSTITL_" SUMMARY "
"RTN","GMTSUP",113,0)
 S GMTSHDR=GMTSHDR_$S($E(IOST,1)="C":"",1:"  pg. "_GMTSPG)
"RTN","GMTSUP",114,0)
 S GMTS="" S:'$D(GMTSOBJ) $P(GMTS,"*",(77-$L(GMTSHDR))\2)="*"
"RTN","GMTSUP",115,0)
 S:$D(GMTSOBJ) $P(GMTS,"*",(72-$L(GMTSHDR))\2)="*"
"RTN","GMTSUP",116,0)
 S GMTSHDR=GMTS_" "_GMTSHDR_" "_GMTS
"RTN","GMTSUP",117,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("CONFIDENTIAL"))) W !,GMTSHDR,"*"
"RTN","GMTSUP",118,0)
 ;     Name, SSAN, Ward, DOB
"RTN","GMTSUP",119,0)
 I '$D(GMTSLFG) D
"RTN","GMTSUP",120,0)
 .I $G(GMTSTITL)'["AD HOC",($G(GMTSTITL)'["PDX"),($G(HSTAG)="") D EN^GMTSHCPR  ;GMTS,85 restrict ssn/dob on HS Type hard copies 
"RTN","GMTSUP",121,0)
 . I $G(GMTSPHDR("TWO")) D
"RTN","GMTSUP",122,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")),$L($G(GMTSOBJ("LABEL"))) D LABEL
"RTN","GMTSUP",123,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")) Q
"RTN","GMTSUP",124,0)
 . . W !,GMTSPHDR("NMSSN"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB")
"RTN","GMTSUP",125,0)
 . . W !,?GMTSPHDR("WARDRBS"),GMTSPHDR("WARDRB")
"RTN","GMTSUP",126,0)
 . E  D
"RTN","GMTSUP",127,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")),$L($G(GMTSOBJ("LABEL"))) D LABEL
"RTN","GMTSUP",128,0)
 . . I $D(GMTSOBJ),'$D(GMTSOBJ("REPORT HEADER")) Q
"RTN","GMTSUP",129,0)
 . . W !,GMTSPHDR("NMSSN"),?GMTSPHDR("WARDRBS")
"RTN","GMTSUP",130,0)
 . . W GMTSPHDR("WARDRB"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB")
"RTN","GMTSUP",131,0)
 ;     Deceased
"RTN","GMTSUP",132,0)
 ;                    
"RTN","GMTSUP",133,0)
 I '$D(GMTSOBJ)!($D(GMTSOBJ("DECEASED"))) D
"RTN","GMTSUP",134,0)
 . W:+$G(VADM(6)) !,?26,"** DECEASED   "_$P(VADM(6),U,2)_" **"
"RTN","GMTSUP",135,0)
 W:'$D(GMTSOBJ) !
"RTN","GMTSUP",136,0)
 Q
"RTN","GMTSUP",137,0)
BRNCH ; Checks abbreviation to branch to a different component
"RTN","GMTSUP",138,0)
 N GMTINX,LIM,CREC,SBS
"RTN","GMTSUP",139,0)
 I Y,("+-"[X) S:X="-" GMTSEGN=GMTSTOF-1 S (GMTSY,GMTSQIT)=1,GMTSLPG=0 Q
"RTN","GMTSUP",140,0)
 I X="^^" S DIROUT=1,GMTSQIT="" Q
"RTN","GMTSUP",141,0)
 I Y,(X?1"^^".E) Q
"RTN","GMTSUP",142,0)
 S GMTINX=$S($D(^GMT(142,GMTSTYP,1,+Y(1),0)):$P(^(0),U,2),1:"")
"RTN","GMTSUP",143,0)
 I 'GMTINX S GMTSY=0 Q
"RTN","GMTSUP",144,0)
 I '$D(GMTSEGI(GMTINX)) N GMI,GMJ,GMTSDFLT S GMI=1,GMJ=GMTSEGC,GMTSDFLT=1 D LOAD^GMTSADH S GMTSEGC=GMTSEGC+1
"RTN","GMTSUP",145,0)
 I '$D(GMTSEGI(GMTINX)) S GMTINX="",GMTSY=0 Q
"RTN","GMTSUP",146,0)
 S LIM=$P(Y(1),U,4) I LIM'["=" G NOLIM
"RTN","GMTSUP",147,0)
 S CREC=^GMT(142.1,GMTINX,0),SBS=GMTSEGI(GMTINX) D CMPLIM^GMTSADH2
"RTN","GMTSUP",148,0)
 I $D(DIROUT) S GMTSQIT="" Q
"RTN","GMTSUP",149,0)
NOLIM ; No limits
"RTN","GMTSUP",150,0)
 S GMTSEGN=GMTSEGI(GMTINX)-1,(GMTSY,GMTSQIT)=1,GMTSLPG=0
"RTN","GMTSUP",151,0)
 Q
"RTN","GMTSUP",152,0)
 ;
"RTN","GMTSUP",153,0)
EVAL ; Evaluate input to determine quit or continue
"RTN","GMTSUP",154,0)
 Q:'$D(X)
"RTN","GMTSUP",155,0)
 S:$D(GMTSEXIT) GMTSEXIT=$G(X)
"RTN","GMTSUP",156,0)
 S:$D(DTOUT) DIROUT=1 I $S(X="^^":1,GMTSLPG:1,$D(DIROUT):1,X="^":1,1:0) S GMTSQIT=""
"RTN","GMTSUP",157,0)
 I +$G(GMPSAP),(X="^") S GMDUOUT=1
"RTN","GMTSUP",158,0)
 Q
"RTN","GMTSUP",159,0)
MUL(X) ; Multiple Components in Type
"RTN","GMTSUP",160,0)
 N GMTSF,GMTSL S GMTSF=$O(GMTSEG(0)),GMTSL=$O(GMTSEG(" "),-1)
"RTN","GMTSUP",161,0)
 Q:+GMTSF=+GMTSL 0  Q 1
"RTN","GMTSUP",162,0)
FST(X) ; First Component in Type
"RTN","GMTSUP",163,0)
 N GMTSF,GMTSL S GMTSF=$O(GMTSEG(0)),GMTSL=+($G(GMTSEGN))
"RTN","GMTSUP",164,0)
 Q:+GMTSF=+GMTSL 1  Q 0
"RTN","GMTSUP",165,0)
CHDR(X) ; Component Header
"RTN","GMTSUP",166,0)
 N GMTSN,GMTSH,GMTSL,GMTS S GMTSN=$$CNAM,GMTSH=$G(GMTSEGH)
"RTN","GMTSUP",167,0)
 S GMTSL=$G(GMTSEGL),GMTS="",$P(GMTS,"-",79-$L(GMTSH_GMTSL)/2)=""
"RTN","GMTSUP",168,0)
 S X=GMTS_" "_GMTSH_GMTSL_" "_GMTS Q:'$D(GMTSOBJ) X
"RTN","GMTSUP",169,0)
 S:$L(GMTSH)&($D(GMTSOBJ("COMPONENT HEADER"))) GMTSN=GMTSH
"RTN","GMTSUP",170,0)
 S:$L(GMTSL)&($L(GMTSN))&($D(GMTSOBJ("LIMITS"))) GMTSN=GMTSN_" "_GMTSL
"RTN","GMTSUP",171,0)
 S X=GMTSN Q X
"RTN","GMTSUP",172,0)
CNAM(X) ; Component Name
"RTN","GMTSUP",173,0)
 N GMTSH S GMTSH=+($P($G(GMTSEG(+($G(GMTSEGN)))),"^",2))
"RTN","GMTSUP",174,0)
 S X=$P($G(^GMT(142.1,+GMTSH,0)),"^",1) Q X
"RTN","GMTSUP",175,0)
LABEL ; Label
"RTN","GMTSUP",176,0)
 Q:'$D(GMTSOBJ("USE LABEL"))  N LABEL S LABEL=$G(GMTSOBJ("LABEL"))
"RTN","GMTSUP",177,0)
 W !,LABEL W:$L(LABEL) ! W:$D(GMTSOBJ("LABEL BLANK LINE")) !
"RTN","GMTSUP",178,0)
 Q
"RTN","GMTSUP",179,0)
LABDAT ; Label/Date
"RTN","GMTSUP",180,0)
 Q:'$D(GMTSOBJ("USE LABEL"))  N LABEL S LABEL=$G(GMTSOBJ("LABEL"))
"RTN","GMTSUP",181,0)
 I '$D(GMTSOBJ("DATE LINE")),$D(GMTSOBJ("LABEL")),$L(LABEL),$L($G(GMTSDTM)) S LABEL=LABEL_$J("",((79-$L(GMTSDTM))-$L(LABEL)))_GMTSDTM
"RTN","GMTSUP",182,0)
 I '$D(GMTSOBJ("DATE LINE")),$D(GMTSOBJ("LABEL")),'$L(LABEL),$L($G(GMTSDTM)) S LABEL="Information as of "_$G(GMTSDTM)
"RTN","GMTSUP",183,0)
 W !,LABEL W:$L(LABEL) ! W:$D(GMTSOBJ("LABEL BLANK LINE")) !
"RTN","GMTSUP",184,0)
 Q
"VER")
8.0^22.0
"^DD",142,142,100,0)
SUPPRESS SENSITIVE PRINT DATA^S^0:9 DIGIT SSN;1:4 DIGIT SSN;2:NO SSN;^2;1^Q
"^DD",142,142,100,3)
Answer with '9 DIGIT SSN', '4 DIGIT SSN', or, 'NO SSN'
"^DD",142,142,100,21,0)
^^13^13^3070725^
"^DD",142,142,100,21,1,0)
This field allows control over the display of patient SSN and DOB in the
"^DD",142,142,100,21,2,0)
report header of a given health summary type. Hard copy prints from
"^DD",142,142,100,21,3,0)
the Reports tab of CPRS, List Manager, and the GMTS print options are 
"^DD",142,142,100,21,4,0)
affected. The DOB can be removed and the SSN restricted based on the 
"^DD",142,142,100,21,5,0)
value of this field.
"^DD",142,142,100,21,6,0)
 
"^DD",142,142,100,21,7,0)
A value of '0' or null allows the full 9-digit SSN to display along
"^DD",142,142,100,21,8,0)
with the DOB; flag value of '1' removes the DOB and only displays 
"^DD",142,142,100,21,9,0)
the last four of the SSN; and '2' will remove both the SSN and DOB
"^DD",142,142,100,21,10,0)
from the report header.
"^DD",142,142,100,21,11,0)
 
"^DD",142,142,100,21,12,0)
Viewing predefined health summary reports on screen via GMTS print 
"^DD",142,142,100,21,13,0)
options or CPRS GUI windows are NOT affected by this flag.
"^DD",142,142,100,"DT")
3070725
"BLD",18197,6)
^80
**END**
**END**
