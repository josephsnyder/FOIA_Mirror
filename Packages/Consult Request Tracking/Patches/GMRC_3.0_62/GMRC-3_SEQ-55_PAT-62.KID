Released GMRC*3*62 SEQ #55
Extracted from mail message
**KIDS**:GMRC*3.0*62^

**INSTALL NAME**
GMRC*3.0*62
"BLD",7673,0)
GMRC*3.0*62^CONSULT/REQUEST TRACKING^0^3081205^y
"BLD",7673,1,0)
^^4^4^3080423^
"BLD",7673,1,1,0)
This patch corrects the Service Consults Schedule-Management 
"BLD",7673,1,2,0)
Report to allow printing of all services under the Service/Specialty
"BLD",7673,1,3,0)
entered regardless of where it falls in the hierarchy.  Help text
"BLD",7673,1,4,0)
is also added to menu OPTION - GMRC RPT SD SCH-MGT CONSULTS.
"BLD",7673,4,0)
^9.64PA^^
"BLD",7673,6.3)
10
"BLD",7673,"KRN",0)
^9.67PA^8989.52^19
"BLD",7673,"KRN",.4,0)
.4
"BLD",7673,"KRN",.401,0)
.401
"BLD",7673,"KRN",.402,0)
.402
"BLD",7673,"KRN",.403,0)
.403
"BLD",7673,"KRN",.5,0)
.5
"BLD",7673,"KRN",.84,0)
.84
"BLD",7673,"KRN",3.6,0)
3.6
"BLD",7673,"KRN",3.8,0)
3.8
"BLD",7673,"KRN",9.2,0)
9.2
"BLD",7673,"KRN",9.8,0)
9.8
"BLD",7673,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7673,"KRN",9.8,"NM",1,0)
GMRCONS1^^0^B61760870
"BLD",7673,"KRN",9.8,"NM","B","GMRCONS1",1)

"BLD",7673,"KRN",19,0)
19
"BLD",7673,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",7673,"KRN",19,"NM",1,0)
GMRC RPT SD SCH-MGT CONSULTS^^0
"BLD",7673,"KRN",19,"NM","B","GMRC RPT SD SCH-MGT CONSULTS",1)

"BLD",7673,"KRN",19.1,0)
19.1
"BLD",7673,"KRN",101,0)
101
"BLD",7673,"KRN",409.61,0)
409.61
"BLD",7673,"KRN",771,0)
771
"BLD",7673,"KRN",870,0)
870
"BLD",7673,"KRN",8989.51,0)
8989.51
"BLD",7673,"KRN",8989.52,0)
8989.52
"BLD",7673,"KRN",8994,0)
8994
"BLD",7673,"KRN","B",.4,.4)

"BLD",7673,"KRN","B",.401,.401)

"BLD",7673,"KRN","B",.402,.402)

"BLD",7673,"KRN","B",.403,.403)

"BLD",7673,"KRN","B",.5,.5)

"BLD",7673,"KRN","B",.84,.84)

"BLD",7673,"KRN","B",3.6,3.6)

"BLD",7673,"KRN","B",3.8,3.8)

"BLD",7673,"KRN","B",9.2,9.2)

"BLD",7673,"KRN","B",9.8,9.8)

"BLD",7673,"KRN","B",19,19)

"BLD",7673,"KRN","B",19.1,19.1)

"BLD",7673,"KRN","B",101,101)

"BLD",7673,"KRN","B",409.61,409.61)

"BLD",7673,"KRN","B",771,771)

"BLD",7673,"KRN","B",870,870)

"BLD",7673,"KRN","B",8989.51,8989.51)

"BLD",7673,"KRN","B",8989.52,8989.52)

"BLD",7673,"KRN","B",8994,8994)

"BLD",7673,"QUES",0)
^9.62^^
"BLD",7673,"REQB",0)
^9.611^1^1
"BLD",7673,"REQB",1,0)
GMRC*3.0*52^1
"BLD",7673,"REQB","B","GMRC*3.0*52",1)

"KRN",19,17410,-1)
0^1
"KRN",19,17410,0)
GMRC RPT SD SCH-MGT CONSULTS^Service Consults Schedule-Management Report^^R^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",19,17410,1,0)
^19.06^5^5^3080304^^^^
"KRN",19,17410,1,1,0)
The SERVICE CONSULTS SCHEDULE-MANAGEMENT REPORT will provide individual 
"KRN",19,17410,1,2,0)
listings of all consults within a time frame and/or a summary listing.
"KRN",19,17410,1,3,0)
The report will identify patients placed on the Electronic Wait List
"KRN",19,17410,1,4,0)
after the initializing date/time of the consult for a SERVICE with the
"KRN",19,17410,1,5,0)
same Stop Code as the consult.
"KRN",19,17410,25)
EN^GMRCONS1
"KRN",19,17410,"U")
SERVICE CONSULTS SCHEDULE-MANA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",300,-1)
1^1
"PKG",300,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",300,22,0)
^9.49I^1^1
"PKG",300,22,1,0)
3.0^2980101^2980417^1271
"PKG",300,22,1,"PAH",1,0)
62^3081205
"PKG",300,22,1,"PAH",1,1,0)
^^4^4^3081205
"PKG",300,22,1,"PAH",1,1,1,0)
This patch corrects the Service Consults Schedule-Management 
"PKG",300,22,1,"PAH",1,1,2,0)
Report to allow printing of all services under the Service/Specialty
"PKG",300,22,1,"PAH",1,1,3,0)
entered regardless of where it falls in the hierarchy.  Help text
"PKG",300,22,1,"PAH",1,1,4,0)
is also added to menu OPTION - GMRC RPT SD SCH-MGT CONSULTS.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMRCONS1")
0^1^B61760870^B53960049
"RTN","GMRCONS1",1,0)
GMRCONS1 ;ALB/MRY - Consult/Scheduling link report ;4/10/06  14:21
"RTN","GMRCONS1",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**52,62**;DEC 27, 1997;Build 10
"RTN","GMRCONS1",3,0)
EN ;
"RTN","GMRCONS1",4,0)
 K GMRNOSRV D SERV Q:$D(GMRNOSRV)
"RTN","GMRCONS1",5,0)
 D EN^VALM("GMRC SD PENDING CONSULTS")
"RTN","GMRCONS1",6,0)
 Q
"RTN","GMRCONS1",7,0)
SERV I $D(IOTM),$D(IOBM),$D(IOSTBM) D FULL^VALM1
"RTN","GMRCONS1",8,0)
 N XSERV
"RTN","GMRCONS1",9,0)
 K STAT,DIC,TOT,TOTAL
"RTN","GMRCONS1",10,0)
 K ^TMP("GMRCCS",$J)
"RTN","GMRCONS1",11,0)
 S CNT=0
"RTN","GMRCONS1",12,0)
 S TOTAL=0,DIC=123.5,DIC(0)="QAEMZ",DIC("A")="Select Service/Specialty: ",D="B^D" D MIX^DIC1 K DIC S:Y=-1 GMRNOSRV="" Q:Y=-1
"RTN","GMRCONS1",13,0)
 K ST,STAT S SRVNM=Y(0,0),RS=+Y,ST="",ORD=0 F  S ORD=$O(^ORD(100.01,ORD)) Q:'+ORD  S STAT(ORD)=$P(^ORD(100.01,ORD,0),U)
"RTN","GMRCONS1",14,0)
SD S %DT="EAT",%DT("A")="Enter Starting Date: " D ^%DT S:Y=-1 GMRNOSRV="" Q:Y=-1  S PSD=Y,SD=Y-.01
"RTN","GMRCONS1",15,0)
 S %DT="EAT",%DT("A")="Enter  Ending  Date: " D ^%DT S:Y=-1 GMRNOSRV="" Q:Y=-1  S ED=Y_.24
"RTN","GMRCONS1",16,0)
 I ED<SD W !!,$C(7),"Ending Date Can Not Be Before Starting Date.",! G SD
"RTN","GMRCONS1",17,0)
 Q
"RTN","GMRCONS1",18,0)
START D WAIT^DICD K ^TMP($J),^TMP("GMRCR",$J)  S CS=RS,CNT=CNT+1,^TMP("GMRCCS",$J,CNT)=CS,^TMP("GMRCCS",$J,"B",CS)="" D SERVICE
"RTN","GMRCONS1",19,0)
 S GRP=0 F  S GRP=$O(^GMR(123.5,RS,10,GRP)) Q:'+GRP  S CS=$P(^GMR(123.5,RS,10,GRP,0),U) D
"RTN","GMRCONS1",20,0)
 .I $P(^GMR(123.5,CS,0),U,2)'=9 S CNT=CNT+1,^TMP("GMRCCS",$J,CNT)=CS,^TMP("GMRCCS",$J,"B",CS)="" D SERVICE
"RTN","GMRCONS1",21,0)
 S ICNT=0 F  S ICNT=$O(^TMP("GMRCCS",$J,ICNT)) Q:+ICNT=0  S XSERV=$G(^TMP("GMRCCS",$J,ICNT)) D SUBSERV2
"RTN","GMRCONS1",22,0)
 K ST F I="COMPLETE","DISCONTINUED","PENDING","ACTIVE","SCHEDULED","PARTIAL RESULTS","DISCONTINUED/EDIT","CANCELLED" S TOT(I)=0
"RTN","GMRCONS1",23,0)
 S SDI=SD F  S SDI=$O(^GMR(123,"E",SDI)) Q:'+SDI!(SDI>ED)  S GIEN=0 F  S GIEN=$O(^GMR(123,"E",SDI,GIEN)) Q:'+GIEN  S ND=^GMR(123,GIEN,0),SERV=$P(ND,U,5),STATUS=$P(ND,U,12) I SERV'="",$D(^TMP("GMRCCS",$J,"B",SERV)),$D(STAT(STATUS)) D
"RTN","GMRCONS1",24,0)
 .S LSTACT=$P($G(^GMR(123.1,$P(ND,U,13),0)),U),PTIEN=$P(ND,U,2),ATDPT=$G(^DPT(PTIEN,0)),PTNM=$P(ATDPT,U),L4=$E($P(ATDPT,U,9),6,9),SRVCON=$P($G(^DPT(PTIEN,.3)),U,2),SRVCON=$S(SRVCON="":"",1:SRVCON_"%")
"RTN","GMRCONS1",25,0)
 .S AWAS1=$S($D(^SC("AWAS1",GIEN)):"LINKED",1:"NOT LINKED"),AHST1=$S($D(^SC("AHST1",GIEN)):"HAS HISTORY",1:"NO HISTORY"),STATS=$P(STAT(STATUS),U)
"RTN","GMRCONS1",26,0)
 .S ^TMP($J,"S",STATS,SDI,GIEN)=PTNM_U_PTIEN_U_LSTACT_U_AWAS1_U_AHST1_U_SERV_U_STATS_U_SDI_U_L4_U_SRVCON
"RTN","GMRCONS1",27,0)
 .S:$D(TOT(STATS)) TOT(STATS)=TOT(STATS)+1 S:'$D(TOT(STATS)) TOT(STATS)=1 S TOTAL=TOTAL+1
"RTN","GMRCONS1",28,0)
 D ^GMRCONS2
"RTN","GMRCONS1",29,0)
EXIT2 K A,ACT,AD,AHST1,ATDPT,AW,AWAS1,B,CHKOT,CLNC,CMMT,CS,CSS,ED,EN,EN2,GIEN,GMRND,GRP,GXHEC,H2,HEC,HECA,HEX,I,L4,LC,LGTH,LGTH1,LSTACT,ND,ORD,ORDATE,P3,P8,P9,PTIEN,PTNM,RS,S,SC,SCDT,SCLNC,SD,SDI,SDWL,SDWLND,SERV
"RTN","GMRCONS1",30,0)
 K SIEN,ST,STAT,STATUS,STOPCD,STPCOD,SUM,SUM2,TEXT,TND,TOT,TOTALTX,TYPE
"RTN","GMRCONS1",31,0)
 K BB,C,CLNCNM,D,SRV,SRVNM,STATS,SUBTOT,TOTAL,TX
"RTN","GMRCONS1",32,0)
 K PD,PSD
"RTN","GMRCONS1",33,0)
 K ASP8,ASP9,CMHD,CNSDT,CNSLT,CNSLTND,DIC,P4,POP,PRTCNDT,SRVCON,STCD,X,Y
"RTN","GMRCONS1",34,0)
 K CNT,ICNT,XCS,XGRP,XSERV
"RTN","GMRCONS1",35,0)
 K ^TMP("GMRCCS",$J)
"RTN","GMRCONS1",36,0)
 Q
"RTN","GMRCONS1",37,0)
SUBSERV2 ;
"RTN","GMRCONS1",38,0)
 N CS,XCS,XGRP
"RTN","GMRCONS1",39,0)
 S XGRP=0
"RTN","GMRCONS1",40,0)
 F  S XGRP=$O(^GMR(123.5,XSERV,10,XGRP)) Q:'+XGRP  D
"RTN","GMRCONS1",41,0)
 .S XCS=$P(^GMR(123.5,XSERV,10,XGRP,0),U)
"RTN","GMRCONS1",42,0)
 .I $P(^GMR(123.5,XCS,0),U,2)'=9&('$D(^TMP("GMRCCS",$J,"B",XCS))) S CNT=CNT+1,^TMP("GMRCCS",$J,CNT)=XCS,^TMP("GMRCCS",$J,"B",XCS)="",CS=XCS D SERVICE
"RTN","GMRCONS1",43,0)
 Q
"RTN","GMRCONS1",44,0)
SERVICE ;
"RTN","GMRCONS1",45,0)
 S STPCLNC="",SC=0 F  S SC=$O(^GMR(123.5,CS,688,SC)) Q:'+SC  S STPCOD=$P(^GMR(123.5,CS,688,SC,0),U) I STPCOD'="" S STPCLNC=$P(^DIC(40.7,STPCOD,0),U)_","_STPCLNC
"RTN","GMRCONS1",46,0)
 S SC=0 F  S SC=$O(^GMR(123.5,CS,688,SC)) Q:'+SC  S STPCOD=$P(^GMR(123.5,CS,688,SC,0),U) I STPCOD'="" D
"RTN","GMRCONS1",47,0)
 .S STPCOD=$P(^DIC(40.7,STPCOD,0),U,2) S:$D(^TMP($J,"SC",STPCOD)) ^TMP($J,"SC",STPCOD)=STPCLNC_^TMP($J,"SC",STPCOD) S:'$D(^TMP($J,"SC",STPCOD)) ^TMP($J,"SC",STPCOD)=STPCLNC
"RTN","GMRCONS1",48,0)
 Q
"RTN","GMRCONS1",49,0)
CLINIC ;
"RTN","GMRCONS1",50,0)
 S CLNC=$P(^GMR(123.5,A,0),U) W @IOF,CLNC," (",A,")",!
"RTN","GMRCONS1",51,0)
 Q
"RTN","GMRCONS1",52,0)
ACTIVE I '$D(^SC("AHST1",CS)) D ASP D  Q
"RTN","GMRCONS1",53,0)
 .I ASP9 S ^TMP($J,"A","ACTWOLHWL")=^TMP($J,"A","ACTWOLHWL")+1,^TMP($J,"A","ACTWOLHWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",54,0)
 .I ASP8 S ^TMP($J,"A","ACTWOLHWL")=^TMP($J,"A","ACTWOLHWL")+1,^TMP($J,"A","ACTWOLHWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",55,0)
 .I '$D(WL) D
"RTN","GMRCONS1",56,0)
 ..I $P($G(^GMR(123,CS,12)),U,5)="P" D
"RTN","GMRCONS1",57,0)
 ...S ^TMP($J,"A","ACTWOLHIFC")=^TMP($J,"A","ACTWOLHIFC")+1,^TMP($J,"A","ACTWOLHIFC",SRV,AD,CS)=TND
"RTN","GMRCONS1",58,0)
 ..E  D
"RTN","GMRCONS1",59,0)
 ...S ^TMP($J,"A","ACTWOLHNWL",SRV,AD,CS)=TND,^TMP($J,"A","ACTWOLHNWL")=^TMP($J,"A","ACTWOLHNWL")+1
"RTN","GMRCONS1",60,0)
 ..D KILNODE Q
"RTN","GMRCONS1",61,0)
 I LSTACT="EDIT/RESUBMITTED"!(LSTACT="ADDED COMMENT")!(LSTACT="STATUS CHANGE") K FND S EN2=$O(^GMR(123,CS,40,":"),-1),EN=":" F  S EN=$O(^GMR(123,CS,40,EN),-1) Q:'+EN!($D(FND))  D EDITRSB
"RTN","GMRCONS1",62,0)
 Q
"RTN","GMRCONS1",63,0)
SCHEDULE I '$D(^SC("AHST1",CS)) D ASP D  Q
"RTN","GMRCONS1",64,0)
 .I ASP9 S ^TMP($J,"A","SCHWOLHWL")=^TMP($J,"A","SCHWOLHWL")+1,^TMP($J,"A","SCHWOLHWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",65,0)
 .I ASP8 S ^TMP($J,"A","SCHWOLHWL")=^TMP($J,"A","SCHWOLHWL")+1,^TMP($J,"A","SCHWOLHWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",66,0)
 .I '$D(WL) D
"RTN","GMRCONS1",67,0)
 ..I $P($G(^GMR(123,CS,12)),U,5)="P" D
"RTN","GMRCONS1",68,0)
 ...S ^TMP($J,"A","SCHWOLHIFC")=^TMP($J,"A","SCHWOLHIFC")+1,^TMP($J,"A","SCHWOLHIFC",SRV,AD,CS)=TND
"RTN","GMRCONS1",69,0)
 ..E  D
"RTN","GMRCONS1",70,0)
 ...S ^TMP($J,"A","SCHWOLHNWL",SRV,AD,CS)=TND,^TMP($J,"A","SCHWOLHNWL")=^TMP($J,"A","SCHWOLHNWL")+1
"RTN","GMRCONS1",71,0)
 ..D KILNODE Q
"RTN","GMRCONS1",72,0)
 I $D(^SC("AWAS1",CS)) S AW="AWAS1" K FND S SCLNC=$O(^SC(AW,CS,":"),-1),SCDT=$O(^SC(AW,CS,SCLNC,":"),-1),SIEN=$O(^SC(AW,CS,SCLNC,SCDT,":"),-1),CSS=$P($G(^SC(SCLNC,"S",SCDT,1,SIEN,"CONS")),U) D  Q
"RTN","GMRCONS1",73,0)
 .I CSS=CS S CHKOT=$P($G(^SC(SCLNC,"S",SCDT,1,SIEN,"C")),U,3) D
"RTN","GMRCONS1",74,0)
 ..I CHKOT'="" S ^TMP($J,"A","SCHWALCO")=^TMP($J,"A","SCHWALCO")+1,^TMP($J,"A","SCHWALCO",SRV,AD,CS)=TND D KILNODE Q
"RTN","GMRCONS1",75,0)
 ..I CHKOT="" S ^TMP($J,"A","SCHWALNCO")=^TMP($J,"A","SCHWALNCO")+1,^TMP($J,"A","SCHWALNCO",SRV,AD,CS)=TND D KILNODE Q
"RTN","GMRCONS1",76,0)
 I $D(^SC("AHST1",CS))&('$D(^SC("AWAS1",CS))) S ^TMP($J,"A","SCHWHNAL")=^TMP($J,"A","SCHWHNAL")+1,^TMP($J,"A","SCHWHNAL",SRV,AD,CS)=TND D KILNODE
"RTN","GMRCONS1",77,0)
 Q
"RTN","GMRCONS1",78,0)
PENDING D ASP D
"RTN","GMRCONS1",79,0)
 .I ASP9 S ^TMP($J,"A","PENWL")=^TMP($J,"A","PENWL")+1,^TMP($J,"A","PENWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",80,0)
 .I ASP8 S ^TMP($J,"A","PENWL")=^TMP($J,"A","PENWL")+1,^TMP($J,"A","PENWL",SRV,AD,CS)=TND,WL="" D KILNODE Q
"RTN","GMRCONS1",81,0)
 I '$D(WL) S ^TMP($J,"A","PENNWL")=^TMP($J,"A","PENNWL")+1,^TMP($J,"A","PENNWL",SRV,AD,CS)=TND D KILNODE
"RTN","GMRCONS1",82,0)
 Q
"RTN","GMRCONS1",83,0)
ASP ;
"RTN","GMRCONS1",84,0)
 S ASP9=0,ASP8=0,STAT="",SDWL=0 F  S SDWL=$O(^SDWL(409.3,"B",PTIEN,SDWL)) Q:'+SDWL  S SDWLND=$G(^SDWL(409.3,SDWL,0)),STAT=$P(SDWLND,U,17),ORDATE=$P(SDWLND,U,2) D  Q:$D(WL)
"RTN","GMRCONS1",85,0)
 .S P9=$P(SDWLND,U,9),P8=$P(SDWLND,U,8)
"RTN","GMRCONS1",86,0)
 .I P9'="" S CLNC=$P(^SDWL(409.32,P9,0),U) I CLNC'="" S STCD=$P(^SC(CLNC,0),U,7) I STCD'="" S STOPCD=$P(^DIC(40.7,STCD,0),U,2),CLNC2=$P(^DIC(40.7,STCD,0),U) D:$D(^TMP($J,"SC",STOPCD))  Q
"RTN","GMRCONS1",87,0)
 ..I STAT="O"&(ORDATE=$P(AD,".")!(ORDATE>AD))&(STPCLNC[CLNC2) S ASP9=1 Q
"RTN","GMRCONS1",88,0)
 .I P8'="" S CLNC=$P(^SDWL(409.31,P8,0),U) I CLNC'="" S STOPCD=$P(^DIC(40.7,CLNC,0),U,2),CLNC2=$P(^DIC(40.7,CLNC,0),U) I STOPCD'="" D:$D(^TMP($J,"SC",STOPCD))  Q
"RTN","GMRCONS1",89,0)
 ..I STAT="O"&(ORDATE=$P(AD,".")!(ORDATE>AD))&(STPCLNC[CLNC2) S ASP8=1 Q
"RTN","GMRCONS1",90,0)
 Q
"RTN","GMRCONS1",91,0)
INCMPLTE S ^TMP($J,"A","INCMPLTE")=^TMP($J,"A","INCMPLTE")+1,^TMP($J,"A","INCMPLTE",SRV,AD,CS)=TND
"RTN","GMRCONS1",92,0)
 Q
"RTN","GMRCONS1",93,0)
CANCELED S ^TMP($J,"A","CANCELED")=^TMP($J,"A","CANCELED")+1,^TMP($J,"A","CANCELED",SRV,AD,CS)=TND
"RTN","GMRCONS1",94,0)
 Q
"RTN","GMRCONS1",95,0)
DSCNTUED S ^TMP($J,"A","DSCNTUED")=^TMP($J,"A","DSCNTUED")+1,^TMP($J,"A","DSCNTUED",SRV,AD,CS)=TND
"RTN","GMRCONS1",96,0)
 Q
"RTN","GMRCONS1",97,0)
COMPLETE S ^TMP($J,"A","COMPLETE")=^TMP($J,"A","COMPLETE")+1,^TMP($J,"A","COMPLETE",SRV,AD,CS)=TND
"RTN","GMRCONS1",98,0)
 Q
"RTN","GMRCONS1",99,0)
CLOSE S ^TMP($J,"A","CLOSE")=^TMP($J,"A","CLOSE")+1,^TMP($J,"A","CLOSE",SRV,AD,CS)=TND
"RTN","GMRCONS1",100,0)
 Q
"RTN","GMRCONS1",101,0)
TOC S ^TMP($J,"A","TOC")=^TMP($J,"A","TOC")+1,^TMP($J,"A","TOC",SRV,AD,CS)=TND
"RTN","GMRCONS1",102,0)
 Q
"RTN","GMRCONS1",103,0)
TCC S ^TMP($J,"A","TCC")=^TMP($J,"A","TCC")+1,^TMP($J,"A","TCC",SRV,AD,CS)=TND
"RTN","GMRCONS1",104,0)
 Q
"RTN","GMRCONS1",105,0)
EDITRSB S GMRND=^GMR(123,CS,40,EN,0),ACT=$P(GMRND,U,2),ACT=$P(^GMR(123.1,ACT,0),U)
"RTN","GMRCONS1",106,0)
 S:(ACT'="EDIT/RESUBMITTED")!(ACT'="STATUS CHANGE") EN2=EN I (ACT="EDIT/RESUBMITTED")!(ACT="STATUS CHANGE") D
"RTN","GMRCONS1",107,0)
 .S CMMT=$G(^GMR(123,CS,40,EN2,1,1,0))
"RTN","GMRCONS1",108,0)
ACTERNS .I CMMT["was a no-show" S ^TMP($J,"A","ACTERNS")=^TMP($J,"A","ACTERNS")+1,^TMP($J,"A","ACTERNS",SRV,AD,CS)=TND,FND="" D KILNODE Q
"RTN","GMRCONS1",109,0)
ACTERCP .I CMMT["was cancelled by the Patient" S ^TMP($J,"A","ACTERCP")=^TMP($J,"A","ACTERCP")+1,^TMP($J,"A","ACTERCP",SRV,AD,CS)=TND,FND="" D KILNODE Q
"RTN","GMRCONS1",110,0)
ACTERCC .I CMMT["was cancelled by the Clinic"!(CMMT["was cancelled, whole clinic") S ^TMP($J,"A","ACTERCC")=^TMP($J,"A","ACTERCC")+1,^TMP($J,"A","ACTERCC",SRV,AD,CS)=TND,FND="" D KILNODE Q
"RTN","GMRCONS1",111,0)
ACTERAP .I CMMT["was cancelled for" S ^TMP($J,"A","ACTERAP")=^TMP($J,"A","ACTERAP")+1,^TMP($J,"A","ACTERAP",SRV,AD,CS)=TND,FND="" D KILNODE Q
"RTN","GMRCONS1",112,0)
ACTEROW .S ^TMP($J,"A","ACTEROW")=^TMP($J,"A","ACTEROW")+1,^TMP($J,"A","ACTEROW",SRV,AD,CS)=TND,FND="" D KILNODE Q
"RTN","GMRCONS1",113,0)
 Q
"RTN","GMRCONS1",114,0)
KILNODE K ^TMP($J,"S",ST,AD,CS)
"RTN","GMRCONS1",115,0)
 Q
"RTN","GMRCONS1",116,0)
CHKLIN I ($Y>(IOSL-4)) S HLD="" D PROMPT Q:HLD[U  X CMHD S PG=PG+1
"RTN","GMRCONS1",117,0)
 Q
"RTN","GMRCONS1",118,0)
IOSL Q:($Y>(IOSL-3))
"RTN","GMRCONS1",119,0)
PROMPT I IOST["C-" R !!,"Press enter to continue or '^' to exit. ",HLD:DTIME S PROMPT="" I HLD[" " S HLD=U
"RTN","GMRCONS1",120,0)
 Q
"VER")
8.0^22.0
"BLD",7673,6)
^55
**END**
**END**
