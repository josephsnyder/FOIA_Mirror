Released GMRC*3*65 SEQ #57
Extracted from mail message
**KIDS**:GMRC*3.0*65^

**INSTALL NAME**
GMRC*3.0*65
"BLD",7090,0)
GMRC*3.0*65^CONSULT/REQUEST TRACKING^0^3090730^y
"BLD",7090,4,0)
^9.64PA^^
"BLD",7090,6.3)
7
"BLD",7090,"ABPKG")
n
"BLD",7090,"KRN",0)
^9.67PA^8989.52^19
"BLD",7090,"KRN",.4,0)
.4
"BLD",7090,"KRN",.401,0)
.401
"BLD",7090,"KRN",.402,0)
.402
"BLD",7090,"KRN",.403,0)
.403
"BLD",7090,"KRN",.5,0)
.5
"BLD",7090,"KRN",.84,0)
.84
"BLD",7090,"KRN",3.6,0)
3.6
"BLD",7090,"KRN",3.8,0)
3.8
"BLD",7090,"KRN",9.2,0)
9.2
"BLD",7090,"KRN",9.8,0)
9.8
"BLD",7090,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7090,"KRN",9.8,"NM",1,0)
GMRCSLM2^^0^B58776847
"BLD",7090,"KRN",9.8,"NM",2,0)
GMRCP5B^^0^B36120106
"BLD",7090,"KRN",9.8,"NM",3,0)
GMRCP5D^^0^B67046922
"BLD",7090,"KRN",9.8,"NM","B","GMRCP5B",2)

"BLD",7090,"KRN",9.8,"NM","B","GMRCP5D",3)

"BLD",7090,"KRN",9.8,"NM","B","GMRCSLM2",1)

"BLD",7090,"KRN",19,0)
19
"BLD",7090,"KRN",19.1,0)
19.1
"BLD",7090,"KRN",101,0)
101
"BLD",7090,"KRN",409.61,0)
409.61
"BLD",7090,"KRN",771,0)
771
"BLD",7090,"KRN",870,0)
870
"BLD",7090,"KRN",8989.51,0)
8989.51
"BLD",7090,"KRN",8989.52,0)
8989.52
"BLD",7090,"KRN",8994,0)
8994
"BLD",7090,"KRN","B",.4,.4)

"BLD",7090,"KRN","B",.401,.401)

"BLD",7090,"KRN","B",.402,.402)

"BLD",7090,"KRN","B",.403,.403)

"BLD",7090,"KRN","B",.5,.5)

"BLD",7090,"KRN","B",.84,.84)

"BLD",7090,"KRN","B",3.6,3.6)

"BLD",7090,"KRN","B",3.8,3.8)

"BLD",7090,"KRN","B",9.2,9.2)

"BLD",7090,"KRN","B",9.8,9.8)

"BLD",7090,"KRN","B",19,19)

"BLD",7090,"KRN","B",19.1,19.1)

"BLD",7090,"KRN","B",101,101)

"BLD",7090,"KRN","B",409.61,409.61)

"BLD",7090,"KRN","B",771,771)

"BLD",7090,"KRN","B",870,870)

"BLD",7090,"KRN","B",8989.51,8989.51)

"BLD",7090,"KRN","B",8989.52,8989.52)

"BLD",7090,"KRN","B",8994,8994)

"BLD",7090,"QUES",0)
^9.62^^
"BLD",7090,"REQB",0)
^9.611^2^2
"BLD",7090,"REQB",1,0)
GMRC*3.0*29^2
"BLD",7090,"REQB",2,0)
GMRC*3.0*61^2
"BLD",7090,"REQB","B","GMRC*3.0*29",1)

"BLD",7090,"REQB","B","GMRC*3.0*61",2)

"MBREQ")
0
"PKG",128,-1)
1^1
"PKG",128,0)
CONSULT/REQUEST TRACKING^GMRC^13
"PKG",128,20,0)
^9.402P^^
"PKG",128,22,0)
^9.49I^1^1
"PKG",128,22,1,0)
3.0^2980101
"PKG",128,22,1,"PAH",1,0)
65^3090730
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","GMRCP5B")
0^2^B36120106^B40317988
"RTN","GMRCP5B",1,0)
GMRCP5B ;SLC/DCM,RJS,WAT - Print Consult form 513 (Gather Data - Footers, Provisional Diagnosis and Reason For Request) ;09/10/08
"RTN","GMRCP5B",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**4,13,12,15,24,23,22,29,65**;Dec 27, 1997;Build 7
"RTN","GMRCP5B",3,0)
 ;
"RTN","GMRCP5B",4,0)
 ; Patch #23 add "SERVICE RENDERED AS:" to SF513
"RTN","GMRCP5B",5,0)
 ; This routine invokes IA #1252 (SDUTL3),#10112 (VASITE)
"RTN","GMRCP5B",6,0)
 ; DBIA 10035      ;PATIENT FILE
"RTN","GMRCP5B",7,0)
 ; DBIA 2849       ;PROTOCOL
"RTN","GMRCP5B",8,0)
 ; DBIA 10060      ;NEW PERSON
"RTN","GMRCP5B",9,0)
 ; DBIA 10061      ;VADPT
"RTN","GMRCP5B",10,0)
 ; 10103                ;FMTE^XLFDT
"RTN","GMRCP5B",11,0)
 ; 10003                ;%DT
"RTN","GMRCP5B",12,0)
 ; 2056                  ;$$GET1^DIQ
"RTN","GMRCP5B",13,0)
 ; ICR 4156           ;REGISTRATION, COMBAT VETERAN STATUS
"RTN","GMRCP5B",14,0)
 Q
"RTN","GMRCP5B",15,0)
 ;
"RTN","GMRCP5B",16,0)
INIT(GMRCSG) ; Initialize the form
"RTN","GMRCP5B",17,0)
 ;
"RTN","GMRCP5B",18,0)
 D HDR^GMRCP5D,FTR(.GMRCSG),REQUEST,PDIAG Q
"RTN","GMRCP5B",19,0)
 ;
"RTN","GMRCP5B",20,0)
REQUEST ;
"RTN","GMRCP5B",21,0)
 N GMRCX
"RTN","GMRCP5B",22,0)
 ;
"RTN","GMRCP5B",23,0)
 I $L($T(OUTPTPR^SDUTL3)) D
"RTN","GMRCP5B",24,0)
 .S GMRCX=$P($$OUTPTPR^SDUTL3(DFN),U,2)
"RTN","GMRCP5B",25,0)
 .D:$L(GMRCX) BLD("REQ",1,1,0,"Current Primary Care Provider: "_GMRCX)
"RTN","GMRCP5B",26,0)
 I $L($T(OUTPTTM^SDUTL3)) D
"RTN","GMRCP5B",27,0)
 .S GMRCX=$P($$OUTPTTM^SDUTL3(DFN),U,2)
"RTN","GMRCP5B",28,0)
 .D:$L(GMRCX) BLD("REQ",1,1,0,"    Current Primary Care Team: "_GMRCX)
"RTN","GMRCP5B",29,0)
 ;
"RTN","GMRCP5B",30,0)
 I $O(^TMP("GMRC",$J,"OUTPUT","REQ",0)) D BLD("REQ",1,1,0,"")
"RTN","GMRCP5B",31,0)
 ;
"RTN","GMRCP5B",32,0)
 D SUB("H","REQ",1,"Reason For Request continued.")
"RTN","GMRCP5B",33,0)
 D SUB("H","REQ",1," ")
"RTN","GMRCP5B",34,0)
 ;
"RTN","GMRCP5B",35,0)
 D BLD("REQ",1,1,0,"REASON FOR REQUEST: (Complaints and findings)")
"RTN","GMRCP5B",36,0)
 I '$O(^GMR(123,GMRCIFN,20,0)) D BLD("REQ",1,1,0,"") I 1
"RTN","GMRCP5B",37,0)
 E  D
"RTN","GMRCP5B",38,0)
 .N LN S LN=0 F  S LN=$O(^GMR(123,GMRCIFN,20,LN)) Q:LN=""  D
"RTN","GMRCP5B",39,0)
 ..D BLD("REQ",1,1,0,^GMR(123,GMRCIFN,20,LN,0))
"RTN","GMRCP5B",40,0)
 ;
"RTN","GMRCP5B",41,0)
 Q
"RTN","GMRCP5B",42,0)
PDIAG ;
"RTN","GMRCP5B",43,0)
 ;
"RTN","GMRCP5B",44,0)
 D BLD("PDIAG",1,1,0,"PROVISIONAL DIAG: "_$G(^GMR(123,GMRCIFN,30)))
"RTN","GMRCP5B",45,0)
 D BLD("PDIAG",1,1,0,GMRCDVL)
"RTN","GMRCP5B",46,0)
 ;
"RTN","GMRCP5B",47,0)
 S (GMRCQSTR,GMRCPGR,GMRCIPH,GMRCQSTT)=""
"RTN","GMRCP5B",48,0)
 ;
"RTN","GMRCP5B",49,0)
 I $S('$P(GMRCRD,U,23):1,$P(GMRCRD(12),U,5)="P":1,1:0) D
"RTN","GMRCP5B",50,0)
 .S GMRCQSTR=$P(GMRCRD,U,14)
"RTN","GMRCP5B",51,0)
 .S:'GMRCQSTR GMRCQSTR=$$GET1^DIQ(100,+$P(GMRCRD,U,3),1)
"RTN","GMRCP5B",52,0)
 .S GMRCPGR=$$GET1^DIQ(200,+$G(GMRCQSTR),.137) S:'$L(GMRCPGR) GMRCPGR=$$GET1^DIQ(200,+$G(GMRCQSTR),.138)
"RTN","GMRCP5B",53,0)
 .S GMRCIPH=$$GET1^DIQ(200,+$G(GMRCQSTR),.132)
"RTN","GMRCP5B",54,0)
 .;
"RTN","GMRCP5B",55,0)
 .S GMRCQSTT=$$GET1^DIQ(200,+$G(GMRCQSTR),20.3)
"RTN","GMRCP5B",56,0)
 .S:'$L(GMRCQSTT) GMRCQSTT=$$GET1^DIQ(200,+$G(GMRCQSTR),8)
"RTN","GMRCP5B",57,0)
 .S GMRCQSTR=$$GET1^DIQ(200,+$G(GMRCQSTR),.01)
"RTN","GMRCP5B",58,0)
 ;
"RTN","GMRCP5B",59,0)
 I $P(GMRCRD,U,23),$P(GMRCRD(12),U,5)="F" D
"RTN","GMRCP5B",60,0)
 .S GMRCQSTR=$P(GMRCRD(12),U,6)
"RTN","GMRCP5B",61,0)
 .S GMRCIPH=$P(GMRCRD(13),U,2)
"RTN","GMRCP5B",62,0)
 .S GMRCPGR=$P(GMRCRD(13),U,3)
"RTN","GMRCP5B",63,0)
 ;
"RTN","GMRCP5B",64,0)
 S GMRCIPH="(Phone: "_GMRCIPH_")"
"RTN","GMRCP5B",65,0)
 S GMRCPGR="(Pager: "_GMRCPGR_")"
"RTN","GMRCP5B",66,0)
 ;
"RTN","GMRCP5B",67,0)
 D BLD("PDIAG",1,1,0,"REQUESTED BY: ")
"RTN","GMRCP5B",68,0)
 D BLD("PDIAG",1,0,35,"|PLACE:")
"RTN","GMRCP5B",69,0)
 D BLD("PDIAG",1,0,59,"|URGENCY:")
"RTN","GMRCP5B",70,0)
 ;
"RTN","GMRCP5B",71,0)
 D BLD("PDIAG",1,1,0,$E(GMRCQSTR,1,37))
"RTN","GMRCP5B",72,0)
 D BLD("PDIAG",1,0,35,"|"_$E($P($G(^ORD(101,+$P(GMRCRD,U,10),0)),U,2),1,20))
"RTN","GMRCP5B",73,0)
 D BLD("PDIAG",1,0,59,"|"_$E($P($G(^ORD(101,+$P(GMRCRD,U,9),0)),U,2),1,18))
"RTN","GMRCP5B",74,0)
 ;
"RTN","GMRCP5B",75,0)
 I $L(GMRCQSTT) D
"RTN","GMRCP5B",76,0)
 .D BLD("PDIAG",1,1,0,GMRCQSTT)
"RTN","GMRCP5B",77,0)
 .D BLD("PDIAG",1,0,35,"|")
"RTN","GMRCP5B",78,0)
 .D BLD("PDIAG",1,0,59,"|")
"RTN","GMRCP5B",79,0)
 D BLD("PDIAG",1,1,0,GMRCPGR)
"RTN","GMRCP5B",80,0)
 D BLD("PDIAG",1,0,35,"|SERVICE RENDERED AS:")
"RTN","GMRCP5B",81,0)
 D BLD("PDIAG",1,0,59,"|")
"RTN","GMRCP5B",82,0)
 S GMRCINOU=$S($P(GMRCRD,U,18)="O":"Outpatient",1:"Inpatient")
"RTN","GMRCP5B",83,0)
 I $D(GMRCIPH)>0 D
"RTN","GMRCP5B",84,0)
 .D BLD("PDIAG",1,1,0,GMRCIPH)
"RTN","GMRCP5B",85,0)
 .D BLD("PDIAG",1,0,35,"|"_GMRCINOU)
"RTN","GMRCP5B",86,0)
 E  D
"RTN","GMRCP5B",87,0)
 .D BLD("PDIAG",1,1,35,"|"_GMRCINOU)
"RTN","GMRCP5B",88,0)
 D BLD("PDIAG",1,0,59,"|")
"RTN","GMRCP5B",89,0)
 K GMRCINOU
"RTN","GMRCP5B",90,0)
 ;***************************************************************
"RTN","GMRCP5B",91,0)
 D BLD("PDIAG",1,1,0,GMRCDVL)
"RTN","GMRCP5B",92,0)
 ;
"RTN","GMRCP5B",93,0)
 Q
"RTN","GMRCP5B",94,0)
 ;
"RTN","GMRCP5B",95,0)
FTR(GMRCSG) ;Footer of form 513
"RTN","GMRCP5B",96,0)
 ;
"RTN","GMRCP5B",97,0)
 N GMRCRMBD,GMRCFAC1,GMRCLOC,GMRCX,SUB,VAIN,VAPA,VAERR
"RTN","GMRCP5B",98,0)
 ;
"RTN","GMRCP5B",99,0)
 D ADD^VADPT,INP^VADPT
"RTN","GMRCP5B",100,0)
 ;
"RTN","GMRCP5B",101,0)
 S (GMRCLOC,GMRCRMBD)=""
"RTN","GMRCP5B",102,0)
 S GMRCLOC=$P($G(VAIN(4)),U,2)
"RTN","GMRCP5B",103,0)
 S GMRCRMBD=$G(VAIN(5))
"RTN","GMRCP5B",104,0)
 S:'$L(GMRCLOC) GMRCLOC=$P($G(^SC(+$P($G(^GMR(123,+GMRCIFN,0)),U,4),0)),U,1)
"RTN","GMRCP5B",105,0)
 ;No location, IFC - consulting site
"RTN","GMRCP5B",106,0)
 I '$L(GMRCLOC),$P(GMRCRD,U,23),$P($G(GMRCRD(12)),U,5)="F" D
"RTN","GMRCP5B",107,0)
 .I $P(GMRCRD,U,21) S GMRCLOC=$$GET1^DIQ(4,$P(GMRCRD,U,21),.01)
"RTN","GMRCP5B",108,0)
 .E  S GMRCLOC=$$GET1^DIQ(4,$P(GMRCRD,U,23),.01)
"RTN","GMRCP5B",109,0)
 S:'$L(GMRCLOC) GMRCLOC=GMRCUL
"RTN","GMRCP5B",110,0)
 ;
"RTN","GMRCP5B",111,0)
 D BLD("FTR",0,1,0,GMRCEQL)
"RTN","GMRCP5B",112,0)
 D BLD("FTR",1,1,0,GMRCEQL)
"RTN","GMRCP5B",113,0)
 ;
"RTN","GMRCP5B",114,0)
 I ($G(GMRCSG("GMRCSIGM"))="electronic") D  I 1
"RTN","GMRCP5B",115,0)
 .D BLD("FTR",0,1,0,"SIGNATURE & TITLE: ")
"RTN","GMRCP5B",116,0)
 .D BLD("FTR",0,0,20,$G(GMRCSG("GMRCSIG"))_" /es/")
"RTN","GMRCP5B",117,0)
 .D BLD("FTR",0,0,54,"|")
"RTN","GMRCP5B",118,0)
 .D BLD("FTR",0,1,20,$G(GMRCSG("GMRCSIGT")))
"RTN","GMRCP5B",119,0)
 .D BLD("FTR",0,0,54,"|DATE: "_$$EXDT($G(GMRCSG("GMRCSDT"))))
"RTN","GMRCP5B",120,0)
 E  D
"RTN","GMRCP5B",121,0)
 .D BLD("FTR",0,1,0,"AUTHOR & TITLE: ")
"RTN","GMRCP5B",122,0)
 .D BLD("FTR",0,0,20,$G(GMRCSG("GMRCSIG")))
"RTN","GMRCP5B",123,0)
 .D BLD("FTR",0,0,54,"|")
"RTN","GMRCP5B",124,0)
 .D BLD("FTR",0,1,20,$G(GMRCSG("GMRCSIGT")))
"RTN","GMRCP5B",125,0)
 .D BLD("FTR",0,0,54,"|DATE: "_$$EXDT($G(GMRCSG("GMRCSDT"))))
"RTN","GMRCP5B",126,0)
 ;
"RTN","GMRCP5B",127,0)
 S GMRCFAC1=+$G(DUZ(2))
"RTN","GMRCP5B",128,0)
 S:'GMRCFAC1 GMRCFAC1=+$$SITE^VASITE()
"RTN","GMRCP5B",129,0)
 S GMRCFAC1=$$GET1^DIQ(4,+GMRCFAC1,.01)
"RTN","GMRCP5B",130,0)
 ;
"RTN","GMRCP5B",131,0)
 D BLD("FTR",0,1,0,GMRCDVL)
"RTN","GMRCP5B",132,0)
 D BLD("FTR",0,1,0,"ID #:"_$E(GMRCUL,1,8))
"RTN","GMRCP5B",133,0)
 D BLD("FTR",0,0,12,"|ORGANIZATION:"_$J($E(GMRCFAC1,1,17),17))
"RTN","GMRCP5B",134,0)
 D BLD("FTR",0,0,45,"|REG #:"_$E(GMRCUL,1,4))
"RTN","GMRCP5B",135,0)
 D BLD("FTR",0,0,58,"|LOC: "_$E($G(GMRCLOC),1,11))
"RTN","GMRCP5B",136,0)
 ;
"RTN","GMRCP5B",137,0)
 I $L(GMRCRMBD) D  I 1
"RTN","GMRCP5B",138,0)
 .D BLD("FTR",0,1,12,"|")
"RTN","GMRCP5B",139,0)
 .D BLD("FTR",0,0,45,"|")
"RTN","GMRCP5B",140,0)
 .D BLD("FTR",0,0,58,"|RM/BD: "_GMRCRMBD)
"RTN","GMRCP5B",141,0)
 ;
"RTN","GMRCP5B",142,0)
 D BLD("FTR",0,1,0,GMRCDVL)
"RTN","GMRCP5B",143,0)
 ;
"RTN","GMRCP5B",144,0)
 F SUB=0,1 D
"RTN","GMRCP5B",145,0)
 .I SUB D BLD("FTR",SUB,1,33,"Page ","GMRCPG,38"_" FIRST ONE") I 1
"RTN","GMRCP5B",146,0)
 .E  I '$G(GMRCGUI) D BLD("FTR",SUB,1,33,"Page ","GMRCPG,38"_" SECOND ONE")
"RTN","GMRCP5B",147,0)
 I $G(GMRCPG)=0 D BLD("FTR",0,1,51,"Standard Form 513 (Rev 9-77)")
"RTN","GMRCP5B",148,0)
 Q
"RTN","GMRCP5B",149,0)
 ;
"RTN","GMRCP5B",150,0)
CONSRQ(GMRCRQ) ;
"RTN","GMRCP5B",151,0)
 ;
"RTN","GMRCP5B",152,0)
 N ORND,ORFL,REF
"RTN","GMRCP5B",153,0)
 I '$L(GMRCRQ) Q "Consult"
"RTN","GMRCP5B",154,0)
 S ORND=$P(GMRCRQ,";",1),ORFL=$P(GMRCRQ,";",2),REF=U_ORFL_ORND_",0)"
"RTN","GMRCP5B",155,0)
 S GMRCRQ=$P($G(@(REF)),U,2)
"RTN","GMRCP5B",156,0)
 Q:$L(GMRCRQ) GMRCRQ Q "Consult"
"RTN","GMRCP5B",157,0)
 ;
"RTN","GMRCP5B",158,0)
EXDT(X) ;EXTERNAL DATE FORMAT
"RTN","GMRCP5B",159,0)
 ;
"RTN","GMRCP5B",160,0)
 N DATE,TIME,HR,MN,PD,Y,%DT
"RTN","GMRCP5B",161,0)
 Q:'$L(X) ""
"RTN","GMRCP5B",162,0)
 I '(X?7N.1".".6N) S %DT="PTS" D ^%DT S X=Y
"RTN","GMRCP5B",163,0)
 Q $$FMTE^XLFDT(X,"5PMZ")
"RTN","GMRCP5B",164,0)
 ;
"RTN","GMRCP5B",165,0)
PRCMT(CMT) ;
"RTN","GMRCP5B",166,0)
 ;
"RTN","GMRCP5B",167,0)
 Q $P($G(^GMR(123.1,+CMT,0)),U,8)
"RTN","GMRCP5B",168,0)
 ;
"RTN","GMRCP5B",169,0)
 ;
"RTN","GMRCP5B",170,0)
BLD(SUB,NDX,LINE,TAB,TEXT,RUNTIME) ;
"RTN","GMRCP5B",171,0)
 ;
"RTN","GMRCP5B",172,0)
 Q:'$L($G(SUB))
"RTN","GMRCP5B",173,0)
 N LINECNT
"RTN","GMRCP5B",174,0)
 ;
"RTN","GMRCP5B",175,0)
 F LINECNT=1:1:+LINE S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX)+1,0)=""
"RTN","GMRCP5B",176,0)
 ;
"RTN","GMRCP5B",177,0)
 S $E(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),0),TAB+1)=TEXT
"RTN","GMRCP5B",178,0)
 I $L($G(RUNTIME)) S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),1)=RUNTIME
"RTN","GMRCP5B",179,0)
 ;
"RTN","GMRCP5B",180,0)
 S GMRCLAST=SUB
"RTN","GMRCP5B",181,0)
 Q
"RTN","GMRCP5B",182,0)
 ;
"RTN","GMRCP5B",183,0)
SUB(ZONE,SUB,NDX,TEXT) ;
"RTN","GMRCP5B",184,0)
 ;
"RTN","GMRCP5B",185,0)
 N NEXT
"RTN","GMRCP5B",186,0)
 S NEXT=$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE," "),-1)+1
"RTN","GMRCP5B",187,0)
 S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE,NEXT,0)=TEXT
"RTN","GMRCP5B",188,0)
 Q
"RTN","GMRCP5B",189,0)
 ;
"RTN","GMRCP5B",190,0)
LASTLN(SUB,NDX) ;
"RTN","GMRCP5B",191,0)
 Q +$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX," "),-1)
"RTN","GMRCP5B",192,0)
 ;
"RTN","GMRCP5D")
0^3^B67046922^B55767674
"RTN","GMRCP5D",1,0)
GMRCP5D ;SLC/DCM,RJS,JFR,WAT - Print Consult form 513 (Gather Data - Addendums, Headers, Service reports and Comments) ;09/10/08
"RTN","GMRCP5D",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**4,12,15,22,29,35,38,61,65**;Dec 27, 1997;Build 7
"RTN","GMRCP5D",3,0)
 ;
"RTN","GMRCP5D",4,0)
 ;This routine invokes the following ICR(s):
"RTN","GMRCP5D",5,0)
 ;2056 $$GET1^DIQ, 2541 $$KSP^XUPARAM, 10103 $$FMTE^XLFDT, 10104 $$UP^XLFSTR, 10061 VADPT API
"RTN","GMRCP5D",6,0)
 ;10040 ^SC(, 4156 $$CVEDT^DGCV, 10060 ^VA(200
"RTN","GMRCP5D",7,0)
 ;
"RTN","GMRCP5D",8,0)
FORMAT(GMRCIFN,GMRCRD,PAGEWID) ;
"RTN","GMRCP5D",9,0)
 ;
"RTN","GMRCP5D",10,0)
 I $L($P(GMRCRD,U,15)) D
"RTN","GMRCP5D",11,0)
 .I $O(^TMP("GMRCR",$J,"MCAR",0)) D
"RTN","GMRCP5D",12,0)
 ..N GMRCSVC
"RTN","GMRCP5D",13,0)
 ..S GMRCSVC=$P($G(^GMR(123.5,+$P(GMRCRD,U,5),0)),U,1)
"RTN","GMRCP5D",14,0)
 ..S:$L(GMRCSVC) GMRCSVC=GMRCSVC_" "
"RTN","GMRCP5D",15,0)
 ..;
"RTN","GMRCP5D",16,0)
 ..; Medicine Results?
"RTN","GMRCP5D",17,0)
 ..S GMRCR0=0 F  S GMRCR0=$O(^TMP("GMRCR",$J,"MCAR",GMRCR0)) Q:'GMRCR0  D
"RTN","GMRCP5D",18,0)
 ...D SUB("H","SREP",GMRCR0,$$CENTER(GMRCSVC_"Service Report #"_GMRCR0_" continued."))
"RTN","GMRCP5D",19,0)
 ...D SUB("H","SREP",GMRCR0," ")
"RTN","GMRCP5D",20,0)
 ...D BLD("SREP",GMRCR0,1,0,$$CENTER("Medicine Package Report"))
"RTN","GMRCP5D",21,0)
 ...D BLD("SREP",GMRCR0,1,0,"")
"RTN","GMRCP5D",22,0)
 ...N LN
"RTN","GMRCP5D",23,0)
 ...S LN=0 F  S LN=$O(^TMP("GMRCR",$J,"MCAR",GMRCR0,LN)) Q:'LN  D
"RTN","GMRCP5D",24,0)
 ....D BLD("SREP",GMRCR0,1,0,$G(^TMP("GMRCR",$J,"MCAR",GMRCR0,LN,0)))
"RTN","GMRCP5D",25,0)
 ;
"RTN","GMRCP5D",26,0)
 ; Build Processing Activities
"RTN","GMRCP5D",27,0)
 S GMRCR0=0 F  S GMRCR0=$O(^GMR(123,GMRCIFN,40,GMRCR0)) Q:'GMRCR0  D
"RTN","GMRCP5D",28,0)
 .N GMRCR1,GMRC400,CMT,USER,GMRCDT,RPRV,GMRC402,GMRCISIT
"RTN","GMRCP5D",29,0)
 .S GMRCR1=+$O(^GMR(123,GMRCIFN,40,GMRCR0,0)) Q:GMRCR1'=1
"RTN","GMRCP5D",30,0)
 .S GMRC400=$G(^GMR(123,GMRCIFN,40,GMRCR0,0))
"RTN","GMRCP5D",31,0)
 .S GMRC402=$G(^GMR(123,GMRCIFN,40,GMRCR0,2))
"RTN","GMRCP5D",32,0)
 .S CMT=$$PRCMT^GMRCP5B(+$P(GMRC400,U,2)) Q:'$L(CMT)
"RTN","GMRCP5D",33,0)
 .S GMRCDT=$P(GMRC400,U,3) S:'GMRCDT GMRCDT=$P(GMRC400,U,1)
"RTN","GMRCP5D",34,0)
 .S GMRCDT=$$EXDT(GMRCDT)_" "_$P(GMRC402,U,3)
"RTN","GMRCP5D",35,0)
 .;Following lines modified in patch *38
"RTN","GMRCP5D",36,0)
 .;I $P(^GMR(123,GMRCIFN,0),U,23) D  ;commented out
"RTN","GMRCP5D",37,0)
 .;.S GMRCISIT=$$GET1^DIQ(4,$P(^GMR(123,GMRCIFN,0),U,23),.01)  ;commented out
"RTN","GMRCP5D",38,0)
 .;.S GMRCISIT="Entered at: "_GMRCISIT  ;commented out
"RTN","GMRCP5D",39,0)
 .I $L(GMRC402) D  ;ADDED
"RTN","GMRCP5D",40,0)
 ..S GMRCISIT=$$GET1^DIQ(123,GMRCIFN,.07)  ;ADDED
"RTN","GMRCP5D",41,0)
 .I '$D(GMRCISIT) D  ;ADDED
"RTN","GMRCP5D",42,0)
 ..S GMRCISIT=$$KSP^XUPARAM("INST")  ;ADDED
"RTN","GMRCP5D",43,0)
 ..I GMRCISIT'="" S GMRCISIT=$$GET1^DIQ(4,GMRCISIT,.01)  ;ADDED
"RTN","GMRCP5D",44,0)
 ..I GMRCISIT="" S GMRCISIT=$$GET1^DIQ(123,GMRCIFN,.05)  ;ADDED
"RTN","GMRCP5D",45,0)
 .S GMRCISIT="Entered at: "_GMRCISIT  ;ADDED
"RTN","GMRCP5D",46,0)
 .;End of modifications for patch *38
"RTN","GMRCP5D",47,0)
 .S RPRV=$$GET1^DIQ(200,+$P(GMRC400,U,4),.01)
"RTN","GMRCP5D",48,0)
 .I '$L(RPRV) S RPRV=$P(GMRC402,U,2)
"RTN","GMRCP5D",49,0)
 .S:($L(RPRV)) RPRV="Responsible Person: "_RPRV
"RTN","GMRCP5D",50,0)
 .S USER=$$GET1^DIQ(200,+$P(GMRC400,U,5),.01)
"RTN","GMRCP5D",51,0)
 .I '$L(USER) S USER=$P(GMRC402,U)
"RTN","GMRCP5D",52,0)
 .S USER="Entered by: "_USER_" - "_GMRCDT
"RTN","GMRCP5D",53,0)
 .D SUB("H","COM",GMRCR0,CMT_" Comment ("_USER_") continued.")
"RTN","GMRCP5D",54,0)
 .D SUB("H","COM",GMRCR0," ")
"RTN","GMRCP5D",55,0)
 .D BLD("COM",GMRCR0,1,0,"")
"RTN","GMRCP5D",56,0)
 .D BLD("COM",GMRCR0,1,0,$$CENTER("("_CMT_" Comment)"))
"RTN","GMRCP5D",57,0)
 .I $P(GMRC400,U,2)=17!($P(GMRC400,U,2)=25) D
"RTN","GMRCP5D",58,0)
 .. N FWDLN,FWDRS
"RTN","GMRCP5D",59,0)
 .. S FWDLN="Forwarded from: "
"RTN","GMRCP5D",60,0)
 .. S FWDRS=$P($G(^GMR(123,GMRCIFN,40,GMRCR0,3)),U)
"RTN","GMRCP5D",61,0)
 .. I $L(FWDRS) S FWDLN=FWDLN_FWDRS
"RTN","GMRCP5D",62,0)
 .. I '$L(FWDRS) S FWDLN=FWDLN_$$GET1^DIQ(123.5,+$P(GMRC400,U,6),.01)
"RTN","GMRCP5D",63,0)
 .. D BLD("COM",GMRCR0,1,5,FWDLN)
"RTN","GMRCP5D",64,0)
 .D BLD("COM",GMRCR0,1,5,USER)
"RTN","GMRCP5D",65,0)
 .D:($L(RPRV)) BLD("COM",GMRCR0,1,5,RPRV)
"RTN","GMRCP5D",66,0)
 .D:($L($G(GMRCISIT))) BLD("COM",GMRCR0,1,5,GMRCISIT)
"RTN","GMRCP5D",67,0)
 .;
"RTN","GMRCP5D",68,0)
 .N GMRCR2 S GMRCR2=0
"RTN","GMRCP5D",69,0)
 .F  S GMRCR2=$O(^GMR(123,GMRCIFN,40,GMRCR0,GMRCR1,GMRCR2)) Q:'GMRCR2  D
"RTN","GMRCP5D",70,0)
 ..D BLD("COM",GMRCR0,1,0,$G(^GMR(123,GMRCIFN,40,GMRCR0,GMRCR1,GMRCR2,0)))
"RTN","GMRCP5D",71,0)
 ;
"RTN","GMRCP5D",72,0)
 Q
"RTN","GMRCP5D",73,0)
 ;
"RTN","GMRCP5D",74,0)
ADDEND(GMRCIFN,GMRCR0,GMRCNDX,GMRCRD,PAGEWID) ;
"RTN","GMRCP5D",75,0)
 ;
"RTN","GMRCP5D",76,0)
 N GMRCADD,GMRCNDX,GMRCR1,GMRCV,TEXT,GMRCX
"RTN","GMRCP5D",77,0)
 ;
"RTN","GMRCP5D",78,0)
 S GMRCADD=0 F  S GMRCADD=$O(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD)) Q:'GMRCADD  D
"RTN","GMRCP5D",79,0)
 .N GMRCSGNM,GMRCNMDT,GMRCTIT,GMRCMODE,GMRCCSDT,GMRCCTIT,GMRCCSGM
"RTN","GMRCP5D",80,0)
 .;
"RTN","GMRCP5D",81,0)
 .F GMRCV="GMRCSGNM","GMRCNMDT","GMRCTIT","GMRCMODE" D
"RTN","GMRCP5D",82,0)
 ..S @GMRCV=$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCV))
"RTN","GMRCP5D",83,0)
 .;
"RTN","GMRCP5D",84,0)
 . F GMRCV="GMRCCSDT","GMRCCTIT","GMRCCSGM","GMRCCSIG" D
"RTN","GMRCP5D",85,0)
 .. S @GMRCV=$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCV))
"RTN","GMRCP5D",86,0)
 .S GMRCNDX=$O(^TMP("GMRC",$J,"OUTPUT","RES"," "),-1)+1
"RTN","GMRCP5D",87,0)
 .I $L($G(GMRCRPT)) D SUB("H","RES",GMRCNDX,"Addendum #"_GMRCADD_" To Consult Note #"_GMRCR0_" for "_GMRCRPT_" continued.")
"RTN","GMRCP5D",88,0)
 .I '$L($G(GMRCRPT)) D SUB("H","RES",GMRCNDX,"Addendum #"_GMRCADD_" To Consult Note #"_GMRCR0_" continued.")
"RTN","GMRCP5D",89,0)
 .D SUB("H","RES",GMRCNDX," ")
"RTN","GMRCP5D",90,0)
 .I $L($G(GMRCSGNM)) D
"RTN","GMRCP5D",91,0)
 ..D SUB("F","RES",GMRCNDX," ")
"RTN","GMRCP5D",92,0)
 ..I (GMRCMODE="electronic") S GMRCX=" Addendum Signature: "_GMRCSGNM_" /es/ "_$$EXDT($G(GMRCNMDT))
"RTN","GMRCP5D",93,0)
 ..I '(GMRCMODE="electronic") S GMRCX=" Addendum Author: "_GMRCSGNM S:$L($G(GMRCNMDT)) GMRCX=GMRCX_" Last edited: "_$$EXDT(GMRCNMDT)
"RTN","GMRCP5D",94,0)
 ..D SUB("F","RES",GMRCNDX,GMRCX)
"RTN","GMRCP5D",95,0)
 ..D:$L($G(GMRCTIT)) SUB("F","RES",GMRCNDX,"                     "_GMRCTIT)
"RTN","GMRCP5D",96,0)
 .I $L($G(GMRCCSDT)) D
"RTN","GMRCP5D",97,0)
 ..D SUB("F","RES",GMRCNDX," ")
"RTN","GMRCP5D",98,0)
 ..I (GMRCCSGM="electronic") S GMRCX=" Addendum CoSignature: "_GMRCCSIG_" /es/ "_$$EXDT(GMRCCSDT)
"RTN","GMRCP5D",99,0)
 ..I '(GMRCCSGM="electronic") S GMRCX=" Addendum CoSignature: "_GMRCCSIG_" /chart/ "_$$EXDT(GMRCCSDT)
"RTN","GMRCP5D",100,0)
 ..D SUB("F","RES",GMRCNDX,GMRCX)
"RTN","GMRCP5D",101,0)
 ..D:$L($G(GMRCCTIT)) SUB("F","RES",GMRCNDX,"                       "_GMRCCTIT)
"RTN","GMRCP5D",102,0)
 .D BLD("RES",GMRCNDX,1,0," ")
"RTN","GMRCP5D",103,0)
 .I $L($G(GMRCRPT)) D BLD("RES",GMRCNDX,1,0,$$CENTER("ADDENDUM #"_GMRCADD_" TO CONSULT NOTE #"_GMRCR0_" FOR "_GMRCRPT))
"RTN","GMRCP5D",104,0)
 .I '$L($G(GMRCRPT)) D BLD("RES",GMRCNDX,1,0,$$CENTER("ADDENDUM #"_GMRCADD_" TO CONSULT NOTE #"_GMRCR0))
"RTN","GMRCP5D",105,0)
 .D BLD("RES",GMRCNDX,1,0," ")
"RTN","GMRCP5D",106,0)
 .S GMRCR1=0 F  S GMRCR1=$O(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCR1)) Q:'GMRCR1  D
"RTN","GMRCP5D",107,0)
 ..D BLD("RES",GMRCNDX,1,0,$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCR1,0)))
"RTN","GMRCP5D",108,0)
 Q
"RTN","GMRCP5D",109,0)
 ;
"RTN","GMRCP5D",110,0)
HDR ; Header code for form 513
"RTN","GMRCP5D",111,0)
 ;
"RTN","GMRCP5D",112,0)
 ;get and format eligibility info
"RTN","GMRCP5D",113,0)
 N VAEL,VAPA,GMRCPEL,SUB,GMRCFROM
"RTN","GMRCP5D",114,0)
 N CVELIG,CVMARKER ;WAT
"RTN","GMRCP5D",115,0)
 D ELIG^VADPT
"RTN","GMRCP5D",116,0)
 D ADD^VADPT
"RTN","GMRCP5D",117,0)
 S GMRCPEL=$P(VAEL(1),U,2)
"RTN","GMRCP5D",118,0)
 ;
"RTN","GMRCP5D",119,0)
 F SUB=0,1 D
"RTN","GMRCP5D",120,0)
 .N GMRCFLN
"RTN","GMRCP5D",121,0)
 .S GMRCFLN=$P($G(^DPT(GMRCDFN,0)),U,1)
"RTN","GMRCP5D",122,0)
 .S CVELIG=$$CVEDT^DGCV(GMRCDFN) S:$P($G(CVELIG),U,3) CVELIG="CV ELIGIBLE" ;WAT
"RTN","GMRCP5D",123,0)
 .D BLD("HDR",SUB,1,0,GMRCDVL)
"RTN","GMRCP5D",124,0)
 .D BLD("HDR",SUB,1,6,"MEDICAL RECORD")
"RTN","GMRCP5D",125,0)
 .D BLD("HDR",SUB,0,39,"|")
"RTN","GMRCP5D",126,0)
 .D BLD("HDR",SUB,0,45,"CONSULTATION SHEET")
"RTN","GMRCP5D",127,0)
 .D BLD("HDR",SUB,1,0,GMRCDVL)
"RTN","GMRCP5D",128,0)
 .D BLD("HDR",SUB,1,0,GMRCFLN)
"RTN","GMRCP5D",129,0)
 .D BLD("HDR",SUB,0,45,GMRCPEL)
"RTN","GMRCP5D",130,0)
 .D BLD("HDR",SUB,1,0,GMRCSN)
"RTN","GMRCP5D",131,0)
 .D BLD("HDR",SUB,0,16,$$EXDT(GMRCDOB))
"RTN","GMRCP5D",132,0)
 .D BLD("HDR",SUB,0,45,GMRCELIG)
"RTN","GMRCP5D",133,0)
 .D:$G(CVELIG)["CV" BLD("HDR",SUB,1,45,CVELIG)
"RTN","GMRCP5D",134,0)
 ;
"RTN","GMRCP5D",135,0)
 ;                                  ADDRESS LINES 1-3
"RTN","GMRCP5D",136,0)
 F GMRCX=1,2,3 D:$L(VAPA(GMRCX))
"RTN","GMRCP5D",137,0)
 .D BLD("HDR",0,1,0,VAPA(GMRCX))
"RTN","GMRCP5D",138,0)
 .;I GMRCX=1 D BLD("HDR",0,0,51,"Standard Form 513 (Rev 9-77)")
"RTN","GMRCP5D",139,0)
 ;
"RTN","GMRCP5D",140,0)
 ;         CITY              STATE                ZIP CODE
"RTN","GMRCP5D",141,0)
 S GMRCX=VAPA(4)_"   "_$P(VAPA(5),U,2)_"      "_VAPA(6)
"RTN","GMRCP5D",142,0)
 ;
"RTN","GMRCP5D",143,0)
 I $L(VAPA(8)) S GMRCX=GMRCX_"      Phone: "_VAPA(8)   ; TELEPHONE (IF AVAILABLE)
"RTN","GMRCP5D",144,0)
 ;
"RTN","GMRCP5D",145,0)
 D BLD("HDR",0,1,0,GMRCX)
"RTN","GMRCP5D",146,0)
 D BLD("HDR",0,1,0,GMRCDVL)
"RTN","GMRCP5D",147,0)
 D BLD("HDR",0,1,0,"Consult Request: "_$$CONSRQ(GMRCIFN))
"RTN","GMRCP5D",148,0)
 D BLD("HDR",0,1,55,"|Consult No.: "_GMRCIFN)
"RTN","GMRCP5D",149,0)
 ;
"RTN","GMRCP5D",150,0)
 D BLD("HDR",1,1,0,GMRCEQL)
"RTN","GMRCP5D",151,0)
 D BLD("HDR",0,1,0,GMRCDVL)
"RTN","GMRCP5D",152,0)
 ;
"RTN","GMRCP5D",153,0)
 I $G(CMT) D BLD("HDR",0,1,27,"("_$$PRCMT^GMRCP5B(CMT)_")") Q
"RTN","GMRCP5D",154,0)
 ;
"RTN","GMRCP5D",155,0)
 S GMRCFROM=$P($G(^SC(+$P(GMRCRD,U,6),0)),U,1)
"RTN","GMRCP5D",156,0)
 ;
"RTN","GMRCP5D",157,0)
 I '$L(GMRCFROM) D
"RTN","GMRCP5D",158,0)
 .N VAIN
"RTN","GMRCP5D",159,0)
 .D INP^VADPT
"RTN","GMRCP5D",160,0)
 .S GMRCFROM=$P($G(VAIN(4)),U,2)
"RTN","GMRCP5D",161,0)
 .I $L($G(VAIN(5))) S GMRCFROM=GMRCFROM_" (Rm/Bd: "_$G(VAIN(5))_" )"
"RTN","GMRCP5D",162,0)
 ;No location, IFC - consulting site
"RTN","GMRCP5D",163,0)
 I '$L(GMRCFROM),$P(GMRCRD,U,23),$P($G(GMRCRD(12)),U,5)="F" D
"RTN","GMRCP5D",164,0)
 .I $P(GMRCRD,U,21) S GMRCFROM=$$GET1^DIQ(4,$P(GMRCRD,U,21),.01)
"RTN","GMRCP5D",165,0)
 .E  S GMRCFROM=$$GET1^DIQ(4,$P(GMRCRD,U,23),.01)
"RTN","GMRCP5D",166,0)
 ;
"RTN","GMRCP5D",167,0)
 D BLD("HDR",0,1,0,"To: "_$P($G(^GMR(123.5,+$P(GMRCRD,U,5),0)),U,1))
"RTN","GMRCP5D",168,0)
 D BLD("HDR",0,1,5,"From: "_GMRCFROM)
"RTN","GMRCP5D",169,0)
 D BLD("HDR",0,0,49,"|Requested: "_$$EXDT($P(GMRCRD,U,7)))
"RTN","GMRCP5D",170,0)
 ;
"RTN","GMRCP5D",171,0)
 D BLD("HDR",0,1,0,GMRCDVL)
"RTN","GMRCP5D",172,0)
 D BLD("HDR",0,1,0,"Requesting Facility: "_$E(GMRCFAC,1,22))
"RTN","GMRCP5D",173,0)
 I $P(GMRCRD,U,11) D BLD("HDR",0,0,45,"|ATTENTION: "_$E($$GET1^DIQ(200,+$P(GMRCRD,U,11),.01),1,21))
"RTN","GMRCP5D",174,0)
 I $P(GMRCRD,U,23) D
"RTN","GMRCP5D",175,0)
 . D BLD("HDR",0,1,0,"Remote Consult No.: "_GMRCINO)
"RTN","GMRCP5D",176,0)
 . D BLD("HDR",0,1,0,"Role: "_GMRCIRL)
"RTN","GMRCP5D",177,0)
 D BLD("HDR",0,1,0,GMRCEQL)
"RTN","GMRCP5D",178,0)
 ;
"RTN","GMRCP5D",179,0)
 Q
"RTN","GMRCP5D",180,0)
 ;
"RTN","GMRCP5D",181,0)
CENTER(X) ;
"RTN","GMRCP5D",182,0)
 ;
"RTN","GMRCP5D",183,0)
 N TEXT,COL
"RTN","GMRCP5D",184,0)
 S COL=35-($L(X)\2) Q:(COL<1) X
"RTN","GMRCP5D",185,0)
 S $E(TEXT,COL)=X
"RTN","GMRCP5D",186,0)
 Q TEXT
"RTN","GMRCP5D",187,0)
 ;
"RTN","GMRCP5D",188,0)
BLD(SUB,NDX,LINE,TAB,TEXT,RUNTIME) ;
"RTN","GMRCP5D",189,0)
 ;
"RTN","GMRCP5D",190,0)
 Q:'$L($G(SUB))
"RTN","GMRCP5D",191,0)
 N LINECNT
"RTN","GMRCP5D",192,0)
 ;
"RTN","GMRCP5D",193,0)
 F LINECNT=1:1:+LINE S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX)+1,0)=""
"RTN","GMRCP5D",194,0)
 ;
"RTN","GMRCP5D",195,0)
 S $E(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),0),TAB+1)=TEXT
"RTN","GMRCP5D",196,0)
 I $L($G(RUNTIME)) S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),1)=RUNTIME
"RTN","GMRCP5D",197,0)
 ;
"RTN","GMRCP5D",198,0)
 S GMRCLAST=SUB
"RTN","GMRCP5D",199,0)
 Q
"RTN","GMRCP5D",200,0)
 ;
"RTN","GMRCP5D",201,0)
SUB(ZONE,SUB,NDX,TEXT) ;
"RTN","GMRCP5D",202,0)
 ;
"RTN","GMRCP5D",203,0)
 N NEXT
"RTN","GMRCP5D",204,0)
 S NEXT=$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE," "),-1)+1
"RTN","GMRCP5D",205,0)
 S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE,NEXT,0)=TEXT
"RTN","GMRCP5D",206,0)
 Q
"RTN","GMRCP5D",207,0)
 ;
"RTN","GMRCP5D",208,0)
LASTLN(SUB,NDX) ;
"RTN","GMRCP5D",209,0)
 Q +$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX," "),-1)
"RTN","GMRCP5D",210,0)
 ;
"RTN","GMRCP5D",211,0)
CONSRQ(IFN) ;
"RTN","GMRCP5D",212,0)
 ;
"RTN","GMRCP5D",213,0)
 N PTR,LINK,REF,GMRCRQ
"RTN","GMRCP5D",214,0)
 I +$P(^GMR(123,+IFN,0),U,8) D
"RTN","GMRCP5D",215,0)
 . S GMRCRQ=$P(^GMR(123,+IFN,0),U,8)
"RTN","GMRCP5D",216,0)
 . S GMRCRQ=$$GET1^DIQ(123.3,+GMRCRQ,.01)
"RTN","GMRCP5D",217,0)
 . I '$L(GMRCRQ) S GMRCRQ="Procedure"
"RTN","GMRCP5D",218,0)
 I $L($G(GMRCRQ)) Q GMRCRQ
"RTN","GMRCP5D",219,0)
 I $L($G(^GMR(123,IFN,1.11))) D
"RTN","GMRCP5D",220,0)
 . N SERV,TYPE
"RTN","GMRCP5D",221,0)
 . S SERV=$$UP^XLFSTR($$GET1^DIQ(123.5,$P(^GMR(123,IFN,0),U,5),.01))
"RTN","GMRCP5D",222,0)
 . S TYPE=$$UP^XLFSTR(^GMR(123,IFN,1.11)) I TYPE'=SERV D
"RTN","GMRCP5D",223,0)
 . I TYPE'=SERV S GMRCRQ=$E(^GMR(123,IFN,1.11),1,36)
"RTN","GMRCP5D",224,0)
 Q:$L($G(GMRCRQ)) GMRCRQ Q "Consult"
"RTN","GMRCP5D",225,0)
 ;
"RTN","GMRCP5D",226,0)
EXDT(X) ;EXTERNAL DATE FORMAT
"RTN","GMRCP5D",227,0)
 ;
"RTN","GMRCP5D",228,0)
 N DATE,TIME,HR,MN,PD,Y,%DT
"RTN","GMRCP5D",229,0)
 Q:'$L(X) ""
"RTN","GMRCP5D",230,0)
 I '(X?7N.1".".6N) S %DT="PTS" D ^%DT S X=Y
"RTN","GMRCP5D",231,0)
 Q $$FMTE^XLFDT(X,"5PMZ")
"RTN","GMRCP5D",232,0)
 ;
"RTN","GMRCSLM2")
0^1^B58776847^B58749629
"RTN","GMRCSLM2",1,0)
GMRCSLM2 ;SLC/DCM,WAT - LM Detailed  display and printing ;09/10/08
"RTN","GMRCSLM2",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,4,18,15,17,23,22,65**;DEC 27,1997;Build 7
"RTN","GMRCSLM2",3,0)
 ;
"RTN","GMRCSLM2",4,0)
 ; This routine invokes IA #872 ^ORD(101   #875 ORDER STATUS file point   #2467 $$OI^ORX8   #2638 ORDER STATUS file access
"RTN","GMRCSLM2",5,0)
 ;#2056 $$GET1^DIQ   #10104 XLFSTR   #4156 $$CVEDT^DGCV   #10117  ^VALM10   #2849 ORDERS file   
"RTN","GMRCSLM2",6,0)
 ;#10040 HOSPITAL LOCATION file   #10060 NEW PERSON file
"RTN","GMRCSLM2",7,0)
 ;
"RTN","GMRCSLM2",8,0)
DT(GMRCO,GMRCIERR) ;;Entry point to set-up detailed display.
"RTN","GMRCSLM2",9,0)
 ;;Pass in GMRCO as +GMRCO - a number only. GMRCO=IEN from of consult from file 123
"RTN","GMRCSLM2",10,0)
 ;;Results are placed in ^TMP("GMRCR",$J,"DT",
"RTN","GMRCSLM2",11,0)
 ;;Pass in variable GMRCOER=2 if calling from the GUI, GMRCOER=1 if call is from CPRS consults tab
"RTN","GMRCSLM2",12,0)
 ;;Pass in variable GMRCOER=0 (or as <UNDEFINED>) if call is from consults routines
"RTN","GMRCSLM2",13,0)
 K GMRCQUT
"RTN","GMRCSLM2",14,0)
 N DFN,GMRCD,GMRCDA,ORIFN,GMRCSF S GMRCDVDL="",$P(GMRCDVDL,"-",80)=""
"RTN","GMRCSLM2",15,0)
 I $S('GMRCO:1,'$D(^GMR(123,+GMRCO,0)):1,1:0) D:$S('$D(GMRCOER):1,'GMRCOER:1,1:0)  S GMRCQUT=1 Q
"RTN","GMRCSLM2",16,0)
 .S GMRCMSG="The consult entry selected for the Detailed Display is unknown." D EXAC^GMRCADC(GMRCMSG) K GMRCMSG
"RTN","GMRCSLM2",17,0)
 .Q
"RTN","GMRCSLM2",18,0)
 K ^TMP("GMRCR",$J,"DT") S TAB="",$P(TAB," ",30)="",GMRCCT=1
"RTN","GMRCSLM2",19,0)
 S GMRCO(0)=^GMR(123,+GMRCO,0),ORIFN=$P(GMRCO(0),"^",3),DFN=$P(GMRCO(0),"^",2)
"RTN","GMRCSLM2",20,0)
 S X="SDUTL3" X ^%ZOSF("TEST") I  D
"RTN","GMRCSLM2",21,0)
 .N PR S PR=$$OUTPTPR^SDUTL3(DFN) I $L(PR) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Current PC Provider:   "_$P(PR,"^",2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",22,0)
 .S PR=$$OUTPTTM^SDUTL3(DFN) I $L(PR) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Current PC Team:       "_$P(PR,"^",2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",23,0)
 .Q
"RTN","GMRCSLM2",24,0)
 N VAIN,VAEL,CVELIG
"RTN","GMRCSLM2",25,0)
 D INP^VADPT S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Current Pat. Status:   "_$S(+VAIN(8):"Inpatient",1:"Outpatient"),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",26,0)
 I $D(VAIN(4)),$L($P(VAIN(4),"^",2)) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Ward:"_$E(TAB,1,18)_$P(VAIN(4),"^",2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",27,0)
 D ELIG^VADPT
"RTN","GMRCSLM2",28,0)
 I $L($P(VAEL(1),"^",2)) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Primary Eligibility:"_$E(TAB,1,11)_$P(VAEL(1),"^",2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",29,0)
 S CVELIG=$$CVEDT^DGCV(DFN) S:$P($G(CVELIG),U,3) ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Combat Vet Eligible:"_$E(TAB,1,11)_"YES",GMRCCT=GMRCCT+1 ;WAT gmrc,65
"RTN","GMRCSLM2",30,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",31,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Order Information",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",32,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="To Service:"_$E(TAB,1,12)_$P($G(^GMR(123.5,+$P(GMRCO(0),"^",5),0)),"^"),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",33,0)
 I $P(GMRCO(0),"^",11) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Attention:"_$E(TAB,1,13)_$$GET1^DIQ(200,$P($G(GMRCO(0)),"^",11),.01),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",34,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="From Service:"_$E(TAB,1,10)_$P($G(^SC(+$P(GMRCO(0),"^",6),0)),"^"),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",35,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Requesting Provider: "_$E(TAB,1,2)_$S($P(GMRCO(0),"^",14)]"":$$GET1^DIQ(200,$P($G(GMRCO(0)),"^",14),.01),1:""),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",36,0)
 I $L($P(GMRCO(0),"^",18)) D
"RTN","GMRCSLM2",37,0)
 .S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Service is to be rendered on an "_$S($P(GMRCO(0),"^",18)="I":"INPATIENT",1:"OUTPATIENT")_" basis",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",38,0)
 .Q
"RTN","GMRCSLM2",39,0)
 I $P(GMRCO(0),"^",10) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Place:"_$E(TAB,1,17)_$P($G(^ORD(101,+$P(GMRCO(0),"^",10),0)),"^",2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",40,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Urgency:"_$E(TAB,1,15)_$S($L($P(GMRCO(0),"^",9)):$P($G(^ORD(101,+$P(GMRCO(0),"^",9),0)),"^",2),1:""),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",41,0)
 S X="ORX8" X ^%ZOSF("TEST") I  D
"RTN","GMRCSLM2",42,0)
 .N GMRCOITM S GMRCOITM=$$OI^ORX8(ORIFN)
"RTN","GMRCSLM2",43,0)
 .S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Orderable Item:"_$E(TAB,1,8)_$P(GMRCOITM,U,2),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",44,0)
 .Q
"RTN","GMRCSLM2",45,0)
 S GMRCPRNM=$P(GMRCO(0),"^",8),GMRCPROC=$S(+GMRCPRNM:$P($G(^GMR(123.3,+GMRCPRNM,0)),"^"),1:"Consult Request")
"RTN","GMRCSLM2",46,0)
 I $L(GMRCPROC) D
"RTN","GMRCSLM2",47,0)
 .N GMRCLN
"RTN","GMRCSLM2",48,0)
 .S GMRCTYPE=$S($P(GMRCO(0),U,17)="P":"Procedure",1:"Consult")
"RTN","GMRCSLM2",49,0)
 .S GMRCLN=GMRCTYPE_":"_$E(TAB,1,22-$L(GMRCTYPE))_GMRCPROC
"RTN","GMRCSLM2",50,0)
 .S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=GMRCLN
"RTN","GMRCSLM2",51,0)
 .S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",52,0)
 .I $G(^GMR(123,+GMRCO,1)) D
"RTN","GMRCSLM2",53,0)
 .. S GMRCLN=""
"RTN","GMRCSLM2",54,0)
 .. S GMRCLN="Clinical Procedure:"_$E(TAB,1,4)
"RTN","GMRCSLM2",55,0)
 .. S GMRCLN=GMRCLN_$$GET1^DIQ(123,+GMRCO,1.01,"E")
"RTN","GMRCSLM2",56,0)
 .. S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=GMRCLN
"RTN","GMRCSLM2",57,0)
 .. S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",58,0)
 .Q
"RTN","GMRCSLM2",59,0)
 S GMRCD=$G(^GMR(123,+GMRCO,30)) I $L(GMRCD) D
"RTN","GMRCSLM2",60,0)
 . I $L(GMRCD)>54 D
"RTN","GMRCSLM2",61,0)
 .. N SEG,I S I=2
"RTN","GMRCSLM2",62,0)
 .. F  S SEG=$P(GMRCD," ",1,I) Q:$L(SEG)>54  S I=I+1
"RTN","GMRCSLM2",63,0)
 .. S SEG=$P(GMRCD," ",1,(I-1))
"RTN","GMRCSLM2",64,0)
 .. S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Provisional Diagnosis: "_SEG
"RTN","GMRCSLM2",65,0)
 .. S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",66,0)
 .. S SEG=$$REPEAT^XLFSTR(" ",22)_$E(GMRCD,$L(SEG)+1,80)
"RTN","GMRCSLM2",67,0)
 .. S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=SEG S GMRCD=""
"RTN","GMRCSLM2",68,0)
 .. S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",69,0)
 I GMRCD'="" D
"RTN","GMRCSLM2",70,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Provisional Diagnosis: "_GMRCD
"RTN","GMRCSLM2",71,0)
 . S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",72,0)
 I $D(^GMR(123,+GMRCO,20,0)) D
"RTN","GMRCSLM2",73,0)
 .I $O(^GMR(123,+GMRCO,20,0)) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Reason For Request:",GMRCCT=GMRCCT+1 D  Q
"RTN","GMRCSLM2",74,0)
 .. S LN=0
"RTN","GMRCSLM2",75,0)
 .. F  S LN=$O(^GMR(123,+GMRCO,20,LN)) Q:LN=""  D
"RTN","GMRCSLM2",76,0)
 ... S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=^GMR(123,+GMRCO,20,LN,0)
"RTN","GMRCSLM2",77,0)
 ... I $G(GMRCIERR) D
"RTN","GMRCSLM2",78,0)
 .... N TXT S TXT=^TMP("GMRCR",$J,"DT",GMRCCT,0)_"..."
"RTN","GMRCSLM2",79,0)
 .... S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=TXT
"RTN","GMRCSLM2",80,0)
 .... S LN=9999 ;quit with just one line
"RTN","GMRCSLM2",81,0)
 ... S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",82,0)
 .. Q
"RTN","GMRCSLM2",83,0)
 . Q
"RTN","GMRCSLM2",84,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=" ",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",85,0)
 ; get inter-facility consult info
"RTN","GMRCSLM2",86,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Inter-facility Information",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",87,0)
 I '$P(GMRCO(0),"^",23) D
"RTN","GMRCSLM2",88,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="This is not an inter-facility consult request.",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",89,0)
 E  D
"RTN","GMRCSLM2",90,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=$$REPEAT^XLFSTR("-",27)
"RTN","GMRCSLM2",91,0)
 . S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",92,0)
 . N GMRCOP
"RTN","GMRCSLM2",93,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Remote Facility:"_$E(TAB,1,6)_$P($G(^DIC(4,+$P(GMRCO(0),"^",23),0)),"^"),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",94,0)
 . S GMRCO(12)=$G(^GMR(123,+GMRCO,12))
"RTN","GMRCSLM2",95,0)
 . I $L($P(GMRCO(12),U,6)) D
"RTN","GMRCSLM2",96,0)
 .. S GMRCOP=$P(GMRCO(12),U,6)
"RTN","GMRCSLM2",97,0)
 . I '$D(GMRCOP) S GMRCOP=$$GET1^DIQ(200,+$P(GMRCO(0),U,14),.01)
"RTN","GMRCSLM2",98,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Ordering Provider:"_$E(TAB,1,5)_GMRCOP,GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",99,0)
 . S GMRCO(13)=$G(^GMR(123,+GMRCO,13)) I $L($P(GMRCO(13),U,2,3))>1 D
"RTN","GMRCSLM2",100,0)
 .. N LINE
"RTN","GMRCSLM2",101,0)
 .. S LINE=$P(GMRCO(13),U,2) I $L(LINE) S LINE=LINE_$E(TAB,1,5) D 
"RTN","GMRCSLM2",102,0)
 ... S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Ordering Provider phone: "_LINE
"RTN","GMRCSLM2",103,0)
 ... S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",104,0)
 .. S LINE=$P(GMRCO(13),U,3) I $L(LINE) S LINE=LINE_$E(TAB,1,5) D
"RTN","GMRCSLM2",105,0)
 ... S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Ordering Provider pager: "_LINE
"RTN","GMRCSLM2",106,0)
 ... S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",107,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Remote Consult #"_$E(TAB)_$P(GMRCO(0),"^",22),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",108,0)
 . I $L($P(GMRCO(13),U)) S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Remote Service name: "_$E(TAB)_$P(GMRCO(13),U),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",109,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Role: "_$E(TAB,1,10)_$S($P(GMRCO(12),U,5)="P":"Requesting facility",1:"Consulting facility"),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",110,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",111,0)
 ;get status, last action, and significant findings
"RTN","GMRCSLM2",112,0)
 S STS=$P(GMRCO(0),"^",12),^TMP("GMRCR",$J,"DT",GMRCCT,0)="Status:  "_$E(TAB,1,14)_$S($D(^ORD(100.01,+STS,0)):$P(^(0),"^",1),1:$P(^ORD(100.01,6,0),"^",1)),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",113,0)
 S GMRCA=$P(^GMR(123,+GMRCO,0),"^",13),^TMP("GMRCR",$J,"DT",GMRCCT,0)="Last Action:"_$E(TAB,1,11)_$S(+GMRCA:$P($G(^GMR(123.1,GMRCA,0)),"^",1),1:""),GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",114,0)
 I $L($P(GMRCO(0),"^",19)) D
"RTN","GMRCSLM2",115,0)
 .S GMRCSF=$P(GMRCO(0),"^",19)
"RTN","GMRCSLM2",116,0)
 .S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Significant Findings:  "_$S(GMRCSF="Y":"YES",GMRCSF="N":"NO",1:"Unknown")
"RTN","GMRCSLM2",117,0)
 .S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",118,0)
 .Q
"RTN","GMRCSLM2",119,0)
 I $G(GMRCIERR) Q  ;don't need results or activities on IFC errors
"RTN","GMRCSLM2",120,0)
 D ACTLOG^GMRCSLM4(+GMRCO)
"RTN","GMRCSLM2",121,0)
 ; any inter-facility results?
"RTN","GMRCSLM2",122,0)
 I $P(GMRCO(0),"^",23) D
"RTN","GMRCSLM2",123,0)
 . N GMRCIFRS,X S GMRCIFRS=0,X=""
"RTN","GMRCSLM2",124,0)
 . F  S X=$O(^GMR(123,GMRCO,51,"B",X)) Q:X=""  S GMRCIFRS=GMRCIFRS+1
"RTN","GMRCSLM2",125,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="",GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",126,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="Inter-facility Results: "_$S(GMRCIFRS>0:"Results are available via Display Results action.",1:"No results available for this consult request."),GMRCCT=GMRCCT+2
"RTN","GMRCSLM2",127,0)
 ;get local results
"RTN","GMRCSLM2",128,0)
 D GETRSLT^GMRCART($NA(^TMP("GMRCRT",$J)),1)
"RTN","GMRCSLM2",129,0)
 N NXT S NXT=0
"RTN","GMRCSLM2",130,0)
 F  S NXT=$O(^TMP("GMRCRT",$J,NXT)) Q:'NXT  D
"RTN","GMRCSLM2",131,0)
 . S ^TMP("GMRCR",$J,"DT",GMRCCT,0)=$G(^TMP("GMRCRT",$J,NXT,0))
"RTN","GMRCSLM2",132,0)
 . S GMRCCT=GMRCCT+1
"RTN","GMRCSLM2",133,0)
 . Q
"RTN","GMRCSLM2",134,0)
 K ^TMP("GMRCRT",$J)
"RTN","GMRCSLM2",135,0)
 I $S('$D(GMRCOER):1,'GMRCOER:1,1:0),$D(VALMAR) D CLEAN^VALM10
"RTN","GMRCSLM2",136,0)
 S ^TMP("GMRCR",$J,"DT",GMRCCT,0)="",$P(^(0),"=",80)="",^(0)=$E(^(0),1,36)_" END "_$E(^(0),43,80)
"RTN","GMRCSLM2",137,0)
DTQ K X,LN,PL,TO,WP,FLG,SEX,STS,URG,WRD,BKLN,DATA,WRD,PROC,LINE,GMRC(0),GMRC(40),GMRCD,GMRCDVDL,GMRCO,GMRCAR,GMRCRB,GMRCLA,GMRCSR,GMRCTO,MCFILE,MCPROC,DSPLINE,GMRCLA1,GMRCPRNM,GMRCPROC,GMRCTYPE,GMRCWARD
"RTN","GMRCSLM2",138,0)
 I $D(GMRCOER),'GMRCOER D:$D(VALMEVL) KILL^VALM10() D:$D(VALMAR) CLEAN^VALM10
"RTN","GMRCSLM2",139,0)
 Q
"VER")
8.0^22.0
"BLD",7090,6)
^57
**END**
**END**
