Released GMRC*3*61 SEQ #52
Extracted from mail message
**KIDS**:GMRC*3.0*61^

**INSTALL NAME**
GMRC*3.0*61
"BLD",7662,0)
GMRC*3.0*61^CONSULT/REQUEST TRACKING^0^3080422^y
"BLD",7662,1,0)
^^4^4^3080422^
"BLD",7662,1,1,0)
This patch modifies the SF 513 report to allow for a longer 
"BLD",7662,1,2,0)
Consult Name than 38 characters to print, and the patch also corrects 
"BLD",7662,1,3,0)
the Completion Time Statistics and Print Completion Time Statistics to
"BLD",7662,1,4,0)
print for the actual date entered.
"BLD",7662,4,0)
^9.64PA^^
"BLD",7662,6.3)
2
"BLD",7662,"KRN",0)
^9.67PA^8989.52^19
"BLD",7662,"KRN",.4,0)
.4
"BLD",7662,"KRN",.401,0)
.401
"BLD",7662,"KRN",.402,0)
.402
"BLD",7662,"KRN",.403,0)
.403
"BLD",7662,"KRN",.5,0)
.5
"BLD",7662,"KRN",.84,0)
.84
"BLD",7662,"KRN",3.6,0)
3.6
"BLD",7662,"KRN",3.8,0)
3.8
"BLD",7662,"KRN",9.2,0)
9.2
"BLD",7662,"KRN",9.8,0)
9.8
"BLD",7662,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7662,"KRN",9.8,"NM",1,0)
GMRCP5D^^0^B55767674
"BLD",7662,"KRN",9.8,"NM",2,0)
GMRCSTU^^0^B66596978
"BLD",7662,"KRN",9.8,"NM","B","GMRCP5D",1)

"BLD",7662,"KRN",9.8,"NM","B","GMRCSTU",2)

"BLD",7662,"KRN",19,0)
19
"BLD",7662,"KRN",19.1,0)
19.1
"BLD",7662,"KRN",101,0)
101
"BLD",7662,"KRN",409.61,0)
409.61
"BLD",7662,"KRN",771,0)
771
"BLD",7662,"KRN",870,0)
870
"BLD",7662,"KRN",8989.51,0)
8989.51
"BLD",7662,"KRN",8989.52,0)
8989.52
"BLD",7662,"KRN",8994,0)
8994
"BLD",7662,"KRN","B",.4,.4)

"BLD",7662,"KRN","B",.401,.401)

"BLD",7662,"KRN","B",.402,.402)

"BLD",7662,"KRN","B",.403,.403)

"BLD",7662,"KRN","B",.5,.5)

"BLD",7662,"KRN","B",.84,.84)

"BLD",7662,"KRN","B",3.6,3.6)

"BLD",7662,"KRN","B",3.8,3.8)

"BLD",7662,"KRN","B",9.2,9.2)

"BLD",7662,"KRN","B",9.8,9.8)

"BLD",7662,"KRN","B",19,19)

"BLD",7662,"KRN","B",19.1,19.1)

"BLD",7662,"KRN","B",101,101)

"BLD",7662,"KRN","B",409.61,409.61)

"BLD",7662,"KRN","B",771,771)

"BLD",7662,"KRN","B",870,870)

"BLD",7662,"KRN","B",8989.51,8989.51)

"BLD",7662,"KRN","B",8989.52,8989.52)

"BLD",7662,"KRN","B",8994,8994)

"BLD",7662,"QUES",0)
^9.62^^
"BLD",7662,"REQB",0)
^9.611^2^2
"BLD",7662,"REQB",1,0)
GMRC*3.0*43^2
"BLD",7662,"REQB",2,0)
GMRC*3.0*38^2
"BLD",7662,"REQB","B","GMRC*3.0*38",2)

"BLD",7662,"REQB","B","GMRC*3.0*43",1)

"MBREQ")
0
"PKG",300,-1)
1^1
"PKG",300,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",300,22,0)
^9.49I^1^1
"PKG",300,22,1,0)
3.0^2980101^2980417^1271
"PKG",300,22,1,"PAH",1,0)
61^3080422
"PKG",300,22,1,"PAH",1,1,0)
^^4^4^3080422
"PKG",300,22,1,"PAH",1,1,1,0)
This patch modifies the SF 513 report to allow for a longer 
"PKG",300,22,1,"PAH",1,1,2,0)
Consult Name than 38 characters to print, and the patch also corrects 
"PKG",300,22,1,"PAH",1,1,3,0)
the Completion Time Statistics and Print Completion Time Statistics to
"PKG",300,22,1,"PAH",1,1,4,0)
print for the actual date entered.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMRCP5D")
0^1^B55767674^B55767536
"RTN","GMRCP5D",1,0)
GMRCP5D ;SLC/DCM,RJS,JFR - Print Consult form 513 (Gather Data - Addendums, Headers, Service reports and Comments) ;8/19/03 15:31
"RTN","GMRCP5D",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**4,12,15,22,29,35,38,61**;Dec 27, 1997;Build 2
"RTN","GMRCP5D",3,0)
 ;
"RTN","GMRCP5D",4,0)
FORMAT(GMRCIFN,GMRCRD,PAGEWID) ;
"RTN","GMRCP5D",5,0)
 ;
"RTN","GMRCP5D",6,0)
 I $L($P(GMRCRD,U,15)) D
"RTN","GMRCP5D",7,0)
 .I $O(^TMP("GMRCR",$J,"MCAR",0)) D
"RTN","GMRCP5D",8,0)
 ..N GMRCSVC
"RTN","GMRCP5D",9,0)
 ..S GMRCSVC=$P($G(^GMR(123.5,+$P(GMRCRD,U,5),0)),U,1)
"RTN","GMRCP5D",10,0)
 ..S:$L(GMRCSVC) GMRCSVC=GMRCSVC_" "
"RTN","GMRCP5D",11,0)
 ..;
"RTN","GMRCP5D",12,0)
 ..; Medicine Results?
"RTN","GMRCP5D",13,0)
 ..S GMRCR0=0 F  S GMRCR0=$O(^TMP("GMRCR",$J,"MCAR",GMRCR0)) Q:'GMRCR0  D
"RTN","GMRCP5D",14,0)
 ...D SUB("H","SREP",GMRCR0,$$CENTER(GMRCSVC_"Service Report #"_GMRCR0_" continued."))
"RTN","GMRCP5D",15,0)
 ...D SUB("H","SREP",GMRCR0," ")
"RTN","GMRCP5D",16,0)
 ...D BLD("SREP",GMRCR0,1,0,$$CENTER("Medicine Package Report"))
"RTN","GMRCP5D",17,0)
 ...D BLD("SREP",GMRCR0,1,0,"")
"RTN","GMRCP5D",18,0)
 ...N LN
"RTN","GMRCP5D",19,0)
 ...S LN=0 F  S LN=$O(^TMP("GMRCR",$J,"MCAR",GMRCR0,LN)) Q:'LN  D
"RTN","GMRCP5D",20,0)
 ....D BLD("SREP",GMRCR0,1,0,$G(^TMP("GMRCR",$J,"MCAR",GMRCR0,LN,0)))
"RTN","GMRCP5D",21,0)
 ;
"RTN","GMRCP5D",22,0)
 ; Build Processing Activities
"RTN","GMRCP5D",23,0)
 S GMRCR0=0 F  S GMRCR0=$O(^GMR(123,GMRCIFN,40,GMRCR0)) Q:'GMRCR0  D
"RTN","GMRCP5D",24,0)
 .N GMRCR1,GMRC400,CMT,USER,GMRCDT,RPRV,GMRC402,GMRCISIT
"RTN","GMRCP5D",25,0)
 .S GMRCR1=+$O(^GMR(123,GMRCIFN,40,GMRCR0,0)) Q:GMRCR1'=1
"RTN","GMRCP5D",26,0)
 .S GMRC400=$G(^GMR(123,GMRCIFN,40,GMRCR0,0))
"RTN","GMRCP5D",27,0)
 .S GMRC402=$G(^GMR(123,GMRCIFN,40,GMRCR0,2))
"RTN","GMRCP5D",28,0)
 .S CMT=$$PRCMT^GMRCP5B(+$P(GMRC400,U,2)) Q:'$L(CMT)
"RTN","GMRCP5D",29,0)
 .S GMRCDT=$P(GMRC400,U,3) S:'GMRCDT GMRCDT=$P(GMRC400,U,1)
"RTN","GMRCP5D",30,0)
 .S GMRCDT=$$EXDT(GMRCDT)_" "_$P(GMRC402,U,3)
"RTN","GMRCP5D",31,0)
 .;Following lines modified in patch *38
"RTN","GMRCP5D",32,0)
 .;I $P(^GMR(123,GMRCIFN,0),U,23) D  ;commented out
"RTN","GMRCP5D",33,0)
 .;.S GMRCISIT=$$GET1^DIQ(4,$P(^GMR(123,GMRCIFN,0),U,23),.01)  ;commented out
"RTN","GMRCP5D",34,0)
 .;.S GMRCISIT="Entered at: "_GMRCISIT  ;commented out
"RTN","GMRCP5D",35,0)
 .I $L(GMRC402) D  ;ADDED
"RTN","GMRCP5D",36,0)
 ..S GMRCISIT=$$GET1^DIQ(123,GMRCIFN,.07)  ;ADDED
"RTN","GMRCP5D",37,0)
 .I '$D(GMRCISIT) D  ;ADDED
"RTN","GMRCP5D",38,0)
 ..S GMRCISIT=$$KSP^XUPARAM("INST")  ;ADDED
"RTN","GMRCP5D",39,0)
 ..I GMRCISIT'="" S GMRCISIT=$$GET1^DIQ(4,GMRCISIT,.01)  ;ADDED
"RTN","GMRCP5D",40,0)
 ..I GMRCISIT="" S GMRCISIT=$$GET1^DIQ(123,GMRCIFN,.05)  ;ADDED
"RTN","GMRCP5D",41,0)
 .S GMRCISIT="Entered at: "_GMRCISIT  ;ADDED
"RTN","GMRCP5D",42,0)
 .;End of modifications for patch *38
"RTN","GMRCP5D",43,0)
 .S RPRV=$$GET1^DIQ(200,+$P(GMRC400,U,4),.01)
"RTN","GMRCP5D",44,0)
 .I '$L(RPRV) S RPRV=$P(GMRC402,U,2)
"RTN","GMRCP5D",45,0)
 .S:($L(RPRV)) RPRV="Responsible Person: "_RPRV
"RTN","GMRCP5D",46,0)
 .S USER=$$GET1^DIQ(200,+$P(GMRC400,U,5),.01)
"RTN","GMRCP5D",47,0)
 .I '$L(USER) S USER=$P(GMRC402,U)
"RTN","GMRCP5D",48,0)
 .S USER="Entered by: "_USER_" - "_GMRCDT
"RTN","GMRCP5D",49,0)
 .D SUB("H","COM",GMRCR0,CMT_" Comment ("_USER_") continued.")
"RTN","GMRCP5D",50,0)
 .D SUB("H","COM",GMRCR0," ")
"RTN","GMRCP5D",51,0)
 .D BLD("COM",GMRCR0,1,0,"")
"RTN","GMRCP5D",52,0)
 .D BLD("COM",GMRCR0,1,0,$$CENTER("("_CMT_" Comment)"))
"RTN","GMRCP5D",53,0)
 .I $P(GMRC400,U,2)=17!($P(GMRC400,U,2)=25) D
"RTN","GMRCP5D",54,0)
 .. N FWDLN,FWDRS
"RTN","GMRCP5D",55,0)
 .. S FWDLN="Forwarded from: "
"RTN","GMRCP5D",56,0)
 .. S FWDRS=$P($G(^GMR(123,GMRCIFN,40,GMRCR0,3)),U)
"RTN","GMRCP5D",57,0)
 .. I $L(FWDRS) S FWDLN=FWDLN_FWDRS
"RTN","GMRCP5D",58,0)
 .. I '$L(FWDRS) S FWDLN=FWDLN_$$GET1^DIQ(123.5,+$P(GMRC400,U,6),.01)
"RTN","GMRCP5D",59,0)
 .. D BLD("COM",GMRCR0,1,5,FWDLN)
"RTN","GMRCP5D",60,0)
 .D BLD("COM",GMRCR0,1,5,USER)
"RTN","GMRCP5D",61,0)
 .D:($L(RPRV)) BLD("COM",GMRCR0,1,5,RPRV)
"RTN","GMRCP5D",62,0)
 .D:($L($G(GMRCISIT))) BLD("COM",GMRCR0,1,5,GMRCISIT)
"RTN","GMRCP5D",63,0)
 .;
"RTN","GMRCP5D",64,0)
 .N GMRCR2 S GMRCR2=0
"RTN","GMRCP5D",65,0)
 .F  S GMRCR2=$O(^GMR(123,GMRCIFN,40,GMRCR0,GMRCR1,GMRCR2)) Q:'GMRCR2  D
"RTN","GMRCP5D",66,0)
 ..D BLD("COM",GMRCR0,1,0,$G(^GMR(123,GMRCIFN,40,GMRCR0,GMRCR1,GMRCR2,0)))
"RTN","GMRCP5D",67,0)
 ;
"RTN","GMRCP5D",68,0)
 Q
"RTN","GMRCP5D",69,0)
 ;
"RTN","GMRCP5D",70,0)
ADDEND(GMRCIFN,GMRCR0,GMRCNDX,GMRCRD,PAGEWID) ;
"RTN","GMRCP5D",71,0)
 ;
"RTN","GMRCP5D",72,0)
 N GMRCADD,GMRCNDX,GMRCR1,GMRCV,TEXT,GMRCX
"RTN","GMRCP5D",73,0)
 ;
"RTN","GMRCP5D",74,0)
 S GMRCADD=0 F  S GMRCADD=$O(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD)) Q:'GMRCADD  D
"RTN","GMRCP5D",75,0)
 .N GMRCSGNM,GMRCNMDT,GMRCTIT,GMRCMODE,GMRCCSDT,GMRCCTIT,GMRCCSGM
"RTN","GMRCP5D",76,0)
 .;
"RTN","GMRCP5D",77,0)
 .F GMRCV="GMRCSGNM","GMRCNMDT","GMRCTIT","GMRCMODE" D
"RTN","GMRCP5D",78,0)
 ..S @GMRCV=$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCV))
"RTN","GMRCP5D",79,0)
 .;
"RTN","GMRCP5D",80,0)
 . F GMRCV="GMRCCSDT","GMRCCTIT","GMRCCSGM","GMRCCSIG" D
"RTN","GMRCP5D",81,0)
 .. S @GMRCV=$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCV))
"RTN","GMRCP5D",82,0)
 .S GMRCNDX=$O(^TMP("GMRC",$J,"OUTPUT","RES"," "),-1)+1
"RTN","GMRCP5D",83,0)
 .I $L($G(GMRCRPT)) D SUB("H","RES",GMRCNDX,"Addendum #"_GMRCADD_" To Consult Note #"_GMRCR0_" for "_GMRCRPT_" continued.")
"RTN","GMRCP5D",84,0)
 .I '$L($G(GMRCRPT)) D SUB("H","RES",GMRCNDX,"Addendum #"_GMRCADD_" To Consult Note #"_GMRCR0_" continued.")
"RTN","GMRCP5D",85,0)
 .D SUB("H","RES",GMRCNDX," ")
"RTN","GMRCP5D",86,0)
 .I $L($G(GMRCSGNM)) D
"RTN","GMRCP5D",87,0)
 ..D SUB("F","RES",GMRCNDX," ")
"RTN","GMRCP5D",88,0)
 ..I (GMRCMODE="electronic") S GMRCX=" Addendum Signature: "_GMRCSGNM_" /es/ "_$$EXDT($G(GMRCNMDT))
"RTN","GMRCP5D",89,0)
 ..I '(GMRCMODE="electronic") S GMRCX=" Addendum Author: "_GMRCSGNM S:$L($G(GMRCNMDT)) GMRCX=GMRCX_" Last edited: "_$$EXDT(GMRCNMDT)
"RTN","GMRCP5D",90,0)
 ..D SUB("F","RES",GMRCNDX,GMRCX)
"RTN","GMRCP5D",91,0)
 ..D:$L($G(GMRCTIT)) SUB("F","RES",GMRCNDX,"                     "_GMRCTIT)
"RTN","GMRCP5D",92,0)
 .I $L($G(GMRCCSDT)) D
"RTN","GMRCP5D",93,0)
 ..D SUB("F","RES",GMRCNDX," ")
"RTN","GMRCP5D",94,0)
 ..I (GMRCCSGM="electronic") S GMRCX=" Addendum CoSignature: "_GMRCCSIG_" /es/ "_$$EXDT(GMRCCSDT)
"RTN","GMRCP5D",95,0)
 ..I '(GMRCCSGM="electronic") S GMRCX=" Addendum CoSignature: "_GMRCCSIG_" /chart/ "_$$EXDT(GMRCCSDT)
"RTN","GMRCP5D",96,0)
 ..D SUB("F","RES",GMRCNDX,GMRCX)
"RTN","GMRCP5D",97,0)
 ..D:$L($G(GMRCCTIT)) SUB("F","RES",GMRCNDX,"                       "_GMRCCTIT)
"RTN","GMRCP5D",98,0)
 .D BLD("RES",GMRCNDX,1,0," ")
"RTN","GMRCP5D",99,0)
 .I $L($G(GMRCRPT)) D BLD("RES",GMRCNDX,1,0,$$CENTER("ADDENDUM #"_GMRCADD_" TO CONSULT NOTE #"_GMRCR0_" FOR "_GMRCRPT))
"RTN","GMRCP5D",100,0)
 .I '$L($G(GMRCRPT)) D BLD("RES",GMRCNDX,1,0,$$CENTER("ADDENDUM #"_GMRCADD_" TO CONSULT NOTE #"_GMRCR0))
"RTN","GMRCP5D",101,0)
 .D BLD("RES",GMRCNDX,1,0," ")
"RTN","GMRCP5D",102,0)
 .S GMRCR1=0 F  S GMRCR1=$O(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCR1)) Q:'GMRCR1  D
"RTN","GMRCP5D",103,0)
 ..D BLD("RES",GMRCNDX,1,0,$G(^TMP("GMRCR",$J,"RES",GMRCR0,"ADD",GMRCADD,GMRCR1,0)))
"RTN","GMRCP5D",104,0)
 Q
"RTN","GMRCP5D",105,0)
 ;
"RTN","GMRCP5D",106,0)
HDR ; Header code for form 513
"RTN","GMRCP5D",107,0)
 ;
"RTN","GMRCP5D",108,0)
 N PG,GMRCFROM
"RTN","GMRCP5D",109,0)
 ;
"RTN","GMRCP5D",110,0)
 F PG=0,1 D
"RTN","GMRCP5D",111,0)
 .D BLD("HDR",PG,1,0,GMRCDVL)
"RTN","GMRCP5D",112,0)
 .D BLD("HDR",PG,1,6,"MEDICAL RECORD")
"RTN","GMRCP5D",113,0)
 .D BLD("HDR",PG,0,29,"|")
"RTN","GMRCP5D",114,0)
 .D BLD("HDR",PG,0,36,"CONSULTATION SHEET")
"RTN","GMRCP5D",115,0)
 .I PG D BLD("HDR",PG,0,60,"Page ","GMRCPG,65") I 1
"RTN","GMRCP5D",116,0)
 .E  I '$G(GMRCGUI) D BLD("HDR",PG,0,60,"Page ","GMRCPG,65")
"RTN","GMRCP5D",117,0)
 .;
"RTN","GMRCP5D",118,0)
 .D BLD("HDR",PG,1,0,GMRCDVL)
"RTN","GMRCP5D",119,0)
 .D BLD("HDR",PG,1,0,"Consult Request: "_$$CONSRQ(GMRCIFN))
"RTN","GMRCP5D",120,0)
 .D BLD("HDR",PG,1,55,"|Consult No.: "_GMRCIFN)
"RTN","GMRCP5D",121,0)
 .;
"RTN","GMRCP5D",122,0)
 D BLD("HDR",1,1,0,GMRCEQL)
"RTN","GMRCP5D",123,0)
 D BLD("HDR",0,1,0,GMRCDVL)
"RTN","GMRCP5D",124,0)
 ;
"RTN","GMRCP5D",125,0)
 I $G(CMT) D BLD("HDR",0,1,27,"("_$$PRCMT^GMRCP5B(CMT)_")") Q
"RTN","GMRCP5D",126,0)
 ;
"RTN","GMRCP5D",127,0)
 S GMRCFROM=$P($G(^SC(+$P(GMRCRD,U,6),0)),U,1)
"RTN","GMRCP5D",128,0)
 ;
"RTN","GMRCP5D",129,0)
 I '$L(GMRCFROM) D
"RTN","GMRCP5D",130,0)
 .N VAIN
"RTN","GMRCP5D",131,0)
 .D INP^VADPT
"RTN","GMRCP5D",132,0)
 .S GMRCFROM=$P($G(VAIN(4)),U,2)
"RTN","GMRCP5D",133,0)
 .I $L($G(VAIN(5))) S GMRCFROM=GMRCFROM_" (Rm/Bd: "_$G(VAIN(5))_" )"
"RTN","GMRCP5D",134,0)
 ;No location, IFC - consulting site
"RTN","GMRCP5D",135,0)
 I '$L(GMRCFROM),$P(GMRCRD,U,23),$P($G(GMRCRD(12)),U,5)="F" D
"RTN","GMRCP5D",136,0)
 .I $P(GMRCRD,U,21) S GMRCFROM=$$GET1^DIQ(4,$P(GMRCRD,U,21),.01)
"RTN","GMRCP5D",137,0)
 .E  S GMRCFROM=$$GET1^DIQ(4,$P(GMRCRD,U,23),.01)
"RTN","GMRCP5D",138,0)
 ;
"RTN","GMRCP5D",139,0)
 D BLD("HDR",0,1,0,"To: "_$P($G(^GMR(123.5,+$P(GMRCRD,U,5),0)),U,1))
"RTN","GMRCP5D",140,0)
 D BLD("HDR",0,1,5,"From: "_GMRCFROM)
"RTN","GMRCP5D",141,0)
 D BLD("HDR",0,0,49,"|Requested: "_$$EXDT($P(GMRCRD,U,7)))
"RTN","GMRCP5D",142,0)
 ;
"RTN","GMRCP5D",143,0)
 D BLD("HDR",0,1,0,GMRCDVL)
"RTN","GMRCP5D",144,0)
 D BLD("HDR",0,1,0,"Requesting Facility: "_$E(GMRCFAC,1,22))
"RTN","GMRCP5D",145,0)
 I $P(GMRCRD,U,11) D BLD("HDR",0,0,45,"|ATTENTION: "_$E($P($G(^VA(200,+$P(GMRCRD,U,11),0)),U,1),1,21))
"RTN","GMRCP5D",146,0)
 I $P(GMRCRD,U,23) D
"RTN","GMRCP5D",147,0)
 . D BLD("HDR",0,1,0,"Remote Consult No.: "_GMRCINO)
"RTN","GMRCP5D",148,0)
 . D BLD("HDR",0,1,0,"Role: "_GMRCIRL)
"RTN","GMRCP5D",149,0)
 D BLD("HDR",0,1,0,GMRCEQL)
"RTN","GMRCP5D",150,0)
 ;
"RTN","GMRCP5D",151,0)
 Q
"RTN","GMRCP5D",152,0)
 ;
"RTN","GMRCP5D",153,0)
CENTER(X) ;
"RTN","GMRCP5D",154,0)
 ;
"RTN","GMRCP5D",155,0)
 N TEXT,COL
"RTN","GMRCP5D",156,0)
 S COL=35-($L(X)\2) Q:(COL<1) X
"RTN","GMRCP5D",157,0)
 S $E(TEXT,COL)=X
"RTN","GMRCP5D",158,0)
 Q TEXT
"RTN","GMRCP5D",159,0)
 ;
"RTN","GMRCP5D",160,0)
BLD(SUB,NDX,LINE,TAB,TEXT,RUNTIME) ;
"RTN","GMRCP5D",161,0)
 ;
"RTN","GMRCP5D",162,0)
 Q:'$L($G(SUB))
"RTN","GMRCP5D",163,0)
 N LINECNT
"RTN","GMRCP5D",164,0)
 ;
"RTN","GMRCP5D",165,0)
 F LINECNT=1:1:+LINE S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX)+1,0)=""
"RTN","GMRCP5D",166,0)
 ;
"RTN","GMRCP5D",167,0)
 S $E(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),0),TAB+1)=TEXT
"RTN","GMRCP5D",168,0)
 I $L($G(RUNTIME)) S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,$$LASTLN(SUB,NDX),1)=RUNTIME
"RTN","GMRCP5D",169,0)
 ;
"RTN","GMRCP5D",170,0)
 S GMRCLAST=SUB
"RTN","GMRCP5D",171,0)
 Q
"RTN","GMRCP5D",172,0)
 ;
"RTN","GMRCP5D",173,0)
SUB(ZONE,SUB,NDX,TEXT) ;
"RTN","GMRCP5D",174,0)
 ;
"RTN","GMRCP5D",175,0)
 N NEXT
"RTN","GMRCP5D",176,0)
 S NEXT=$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE," "),-1)+1
"RTN","GMRCP5D",177,0)
 S ^TMP("GMRC",$J,"OUTPUT",SUB,NDX,ZONE,NEXT,0)=TEXT
"RTN","GMRCP5D",178,0)
 Q
"RTN","GMRCP5D",179,0)
 ;
"RTN","GMRCP5D",180,0)
LASTLN(SUB,NDX) ;
"RTN","GMRCP5D",181,0)
 Q +$O(^TMP("GMRC",$J,"OUTPUT",SUB,NDX," "),-1)
"RTN","GMRCP5D",182,0)
 ;
"RTN","GMRCP5D",183,0)
CONSRQ(IFN) ;
"RTN","GMRCP5D",184,0)
 ;
"RTN","GMRCP5D",185,0)
 N PTR,LINK,REF,GMRCRQ
"RTN","GMRCP5D",186,0)
 I +$P(^GMR(123,+IFN,0),U,8) D
"RTN","GMRCP5D",187,0)
 . S GMRCRQ=$P(^GMR(123,+IFN,0),U,8)
"RTN","GMRCP5D",188,0)
 . S GMRCRQ=$$GET1^DIQ(123.3,+GMRCRQ,.01)
"RTN","GMRCP5D",189,0)
 . I '$L(GMRCRQ) S GMRCRQ="Procedure"
"RTN","GMRCP5D",190,0)
 I $L($G(GMRCRQ)) Q GMRCRQ
"RTN","GMRCP5D",191,0)
 I $L($G(^GMR(123,IFN,1.11))) D
"RTN","GMRCP5D",192,0)
 . N SERV,TYPE
"RTN","GMRCP5D",193,0)
 . S SERV=$$UP^XLFSTR($$GET1^DIQ(123.5,$P(^GMR(123,IFN,0),U,5),.01))
"RTN","GMRCP5D",194,0)
 . S TYPE=$$UP^XLFSTR(^GMR(123,IFN,1.11)) I TYPE'=SERV D
"RTN","GMRCP5D",195,0)
 . I TYPE'=SERV S GMRCRQ=$E(^GMR(123,IFN,1.11),1,36)
"RTN","GMRCP5D",196,0)
 Q:$L($G(GMRCRQ)) GMRCRQ Q "Consult"
"RTN","GMRCP5D",197,0)
 ;
"RTN","GMRCP5D",198,0)
EXDT(X) ;EXTERNAL DATE FORMAT
"RTN","GMRCP5D",199,0)
 ;
"RTN","GMRCP5D",200,0)
 N DATE,TIME,HR,MN,PD,Y,%DT
"RTN","GMRCP5D",201,0)
 Q:'$L(X) ""
"RTN","GMRCP5D",202,0)
 I '(X?7N.1".".6N) S %DT="PTS" D ^%DT S X=Y
"RTN","GMRCP5D",203,0)
 Q $$FMTE^XLFDT(X,"5PMZ")
"RTN","GMRCP5D",204,0)
 ;
"RTN","GMRCSTU")
0^2^B66596978^B64607366
"RTN","GMRCSTU",1,0)
GMRCSTU ;SLC/DCM,dee - Statistic Utilities for C/RT ;09/26/02 10:16
"RTN","GMRCSTU",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7,29,30,43,61**;DEC 27, 1997;Build 2
"RTN","GMRCSTU",3,0)
 Q
"RTN","GMRCSTU",4,0)
 ;
"RTN","GMRCSTU",5,0)
GETDT(GMRCO) ;get the date that the consult/request was accepted by service
"RTN","GMRCSTU",6,0)
 N ND,GMRCDA
"RTN","GMRCSTU",7,0)
 S COMPLDT=9999999
"RTN","GMRCSTU",8,0)
 S ND=0 F  S ND=$O(^GMR(123,GMRCO,40,ND)) Q:ND?1A.E!(ND="")  D
"RTN","GMRCSTU",9,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=21 GMRCDA=$P(^(0),"^",1)
"RTN","GMRCSTU",10,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=1 GMRCDA(1)=$P(^(0),"^",1)
"RTN","GMRCSTU",11,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=15 GMRCDA(15)=$P(^(0),"^",3)
"RTN","GMRCSTU",12,0)
 .I $P(^GMR(123,GMRCO,40,ND,0),"^",2)=10,$P(^(0),"^",3)<COMPLDT S COMPLDT=$P(^(0),"^",3)
"RTN","GMRCSTU",13,0)
 S RCVDT=$S($D(GMRCDA)#2:GMRCDA,$D(GMRCDA(1)):GMRCDA(1),$D(GMRCDA(15)):GMRCDA(15),1:$P(^GMR(123,GMRCO,0),"^",1))
"RTN","GMRCSTU",14,0)
 Q
"RTN","GMRCSTU",15,0)
EN ;
"RTN","GMRCSTU",16,0)
 K ^TMP("GMRCSLIST",$J),GMRCQUT
"RTN","GMRCSTU",17,0)
 ;Get the service/grouper
"RTN","GMRCSTU",18,0)
 D ASRV^GMRCASV
"RTN","GMRCSTU",19,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",20,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",21,0)
 ;Get the date range
"RTN","GMRCSTU",22,0)
 D ^GMRCSPD
"RTN","GMRCSTU",23,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",24,0)
 Q
"RTN","GMRCSTU",25,0)
 ;
"RTN","GMRCSTU",26,0)
ENOR(RETURN,GMRCSRVC,GMRCDT1,GMRCDT2) ;Entry point for GUI interface.
"RTN","GMRCSTU",27,0)
 ;.RETURN:   This is the root to the returned temp array.
"RTN","GMRCSTU",28,0)
 ;GMRCSRVC:  Service for which consults are to be displayed.
"RTN","GMRCSTU",29,0)
 ;GMRCDT1:  Starting date or "ALL"
"RTN","GMRCSTU",30,0)
 ;GMRCDT2:  Ending date if not GMRCDT1="ALL"
"RTN","GMRCSTU",31,0)
 ;
"RTN","GMRCSTU",32,0)
 ;^TMP("GMRCSLIST",$J,n)=ien^name^parient ien^"+" if grouper^status
"RTN","GMRCSTU",33,0)
 ;  status is "" tracking and/or grouper
"RTN","GMRCSTU",34,0)
 ;            1  grouper only
"RTN","GMRCSTU",35,0)
 ;            2  tracking only
"RTN","GMRCSTU",36,0)
 ;            9  disabled
"RTN","GMRCSTU",37,0)
 ;
"RTN","GMRCSTU",38,0)
 N GMRCEDT1,GMRCEDT2,GMRCDG,GMRCHEAD,GMRCCT,GMRCGRP,VALMCNT,VALMBCK
"RTN","GMRCSTU",39,0)
 N GMRCWRIT
"RTN","GMRCSTU",40,0)
 S GMRCWRIT=0
"RTN","GMRCSTU",41,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",42,0)
 S RETURN="^TMP(""GMRCR"",$J,""PRL"")"
"RTN","GMRCSTU",43,0)
 I '($D(GMRCSRVC)#2) S GMRCSRVC=1
"RTN","GMRCSTU",44,0)
 Q:'$D(^GMR(123.5,$G(GMRCSRVC),0))
"RTN","GMRCSTU",45,0)
 ;Build service array
"RTN","GMRCSTU",46,0)
 S GMRCDG=GMRCSRVC
"RTN","GMRCSTU",47,0)
 D SERV1^GMRCASV
"RTN","GMRCSTU",48,0)
 ;Get external form of date range
"RTN","GMRCSTU",49,0)
 I '($D(GMRCDT1)#2) S GMRCDT1="ALL"
"RTN","GMRCSTU",50,0)
 S:GMRCDT1="ALL" GMRCDT2=0
"RTN","GMRCSTU",51,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,$G(GMRCDT2),.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",52,0)
 G ODTSTR
"RTN","GMRCSTU",53,0)
 ;
"RTN","GMRCSTU",54,0)
ODT ;List Manager entry point
"RTN","GMRCSTU",55,0)
 N GMRCWRIT
"RTN","GMRCSTU",56,0)
 S GMRCWRIT=1
"RTN","GMRCSTU",57,0)
 D WAIT^DICD
"RTN","GMRCSTU",58,0)
 ;
"RTN","GMRCSTU",59,0)
ODTSTR ;Find the mean, standard deviation of how long to complete a consult from when it is accepted in the service to when it is complete
"RTN","GMRCSTU",60,0)
 N RCVDT,COMPLDT,INDEX,TEMPTMP,GROUPER,TAB
"RTN","GMRCSTU",61,0)
 N GMRCDG,GMRCDGT,GMRCDT,GMRCDTP
"RTN","GMRCSTU",62,0)
 N GMRCGRP,GMRCND,GMRCO,ND,X,X1,X2,X3,X4
"RTN","GMRCSTU",63,0)
 S GMRCDTP=GMRCDT2
"RTN","GMRCSTU",64,0)
 S GMRCDT2=GMRCDT2+1
"RTN","GMRCSTU",65,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",66,0)
 S INDEX=0
"RTN","GMRCSTU",67,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",68,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",69,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",70,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",71,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",72,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",73,0)
 .S ^TMP("GMRCSVC",$J,1,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",74,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",75,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",76,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",77,0)
 .S ^TMP("GMRCSVC",$J,2,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",78,0)
 S GMRCND=0
"RTN","GMRCSTU",79,0)
 S INDEX=""
"RTN","GMRCSTU",80,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX),-1) Q:INDEX=""  D
"RTN","GMRCSTU",81,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",82,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",83,0)
 .Q:$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)>0
"RTN","GMRCSTU",84,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",5)'=1 D
"RTN","GMRCSTU",85,0)
 ..S GMRCDT=""
"RTN","GMRCSTU",86,0)
 ..F  S GMRCDT=$O(^GMR(123,"AE",ND,2,GMRCDT)) Q:GMRCDT=""  D
"RTN","GMRCSTU",87,0)
 ...S GMRCO=0
"RTN","GMRCSTU",88,0)
 ...F  S GMRCO=$O(^GMR(123,"AE",ND,2,GMRCDT,GMRCO)) Q:GMRCO=""  D  W:GMRCWRIT&'(GMRCND#25) "."
"RTN","GMRCSTU",89,0)
 ....D GETDT(GMRCO)
"RTN","GMRCSTU",90,0)
 ....I COMPLDT<9999999,$S(GMRCDT1="ALL":1,RCVDT'<GMRCDT1&(RCVDT'>GMRCDT2):1,1:0) D
"RTN","GMRCSTU",91,0)
 .....S X1=COMPLDT
"RTN","GMRCSTU",92,0)
 .....S X2=RCVDT
"RTN","GMRCSTU",93,0)
 .....D ^%DTC
"RTN","GMRCSTU",94,0)
 .....IF X=0 D
"RTN","GMRCSTU",95,0)
 ......S X=$$FMDIFF^XLFDT(COMPLDT,RCVDT,3)
"RTN","GMRCSTU",96,0)
 ......S X=+$P(X," ",2)/24
"RTN","GMRCSTU",97,0)
 ......S X3=$E(X,1,3)
"RTN","GMRCSTU",98,0)
 ......S X4=$E(X,4)
"RTN","GMRCSTU",99,0)
 ......S:X4>4 X3=X3+.01
"RTN","GMRCSTU",100,0)
 ......S X=X3
"RTN","GMRCSTU",101,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),U)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),U)+X
"RTN","GMRCSTU",102,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",2)+1
"RTN","GMRCSTU",103,0)
 .....S $P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"T"),"^",3)+(X*X)
"RTN","GMRCSTU",104,0)
 .....I $P(^GMR(123,GMRCO,0),"^",18)="I" D
"RTN","GMRCSTU",105,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",1)+X
"RTN","GMRCSTU",106,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",2)+1
"RTN","GMRCSTU",107,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"I"),"^",3)+(X*X)
"RTN","GMRCSTU",108,0)
 .....E  I $P(^GMR(123,GMRCO,0),"^",18)="O" D
"RTN","GMRCSTU",109,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",1)+X
"RTN","GMRCSTU",110,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",2)+1
"RTN","GMRCSTU",111,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"O"),"^",3)+(X*X)
"RTN","GMRCSTU",112,0)
 .....E  D
"RTN","GMRCSTU",113,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",1)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",1)+X
"RTN","GMRCSTU",114,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",2)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",2)+1
"RTN","GMRCSTU",115,0)
 ......S $P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",3)=$P(^TMP("GMRCSVC",$J,1,ND,"U"),"^",3)+(X*X)
"RTN","GMRCSTU",116,0)
 .....S GMRCND=GMRCND+1
"RTN","GMRCSTU",117,0)
 .D PARENTS^GMRCSTU1(ND,+$P(^TMP("GMRCSLIST",$J,INDEX),"^",3))
"RTN","GMRCSTU",118,0)
 S ND=0
"RTN","GMRCSTU",119,0)
STAT ;Do the statistics
"RTN","GMRCSTU",120,0)
 F  S ND=$O(^TMP("GMRCSVC",$J,2,ND)) Q:ND=""  D
"RTN","GMRCSTU",121,0)
 .I $P($G(^TMP("GMRCSVC",$J,1,ND,"T")),"^",1)>0 D DOSTAT^GMRCSTU1(1,ND)
"RTN","GMRCSTU",122,0)
 .I $P(^TMP("GMRCSVC",$J,2,ND,"T"),"^",1)>0 D DOSTAT^GMRCSTU1(2,ND)
"RTN","GMRCSTU",123,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",124,0)
 S GMRCCT=0
"RTN","GMRCSTU",125,0)
 S GMRCDT2=GMRCDTP  ;reset date value to print report heading
"RTN","GMRCSTU",126,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",127,0)
 S TAB=""
"RTN","GMRCSTU",128,0)
 S $P(TAB," ",40)=""
"RTN","GMRCSTU",129,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",130,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,19)_"Consult/Request Completion Time Statistics"
"RTN","GMRCSTU",131,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",132,0)
 S TEMPTMP="FROM: "_GMRCEDT1_"   TO: "_GMRCEDT2
"RTN","GMRCSTU",133,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-($L(TEMPTMP)/2))_TEMPTMP
"RTN","GMRCSTU",134,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",135,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",136,0)
 S INDEX=0
"RTN","GMRCSTU",137,0)
 S GROUPER=0
"RTN","GMRCSTU",138,0)
 S GROUPER(0)=0
"RTN","GMRCSTU",139,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",140,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",141,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9&'$D(^TMP("GMRCSVC",$J,2,ND))
"RTN","GMRCSTU",142,0)
 .F  Q:GROUPER(GROUPER)=$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)  D
"RTN","GMRCSTU",143,0)
 ..;End of a group so print the group totals
"RTN","GMRCSTU",144,0)
 ..D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",145,0)
 ..;pop grouper from stack
"RTN","GMRCSTU",146,0)
 ..S GROUPER=GROUPER-1
"RTN","GMRCSTU",147,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",4)="+" D
"RTN","GMRCSTU",148,0)
 ..;Start of a new group so print the group heading.
"RTN","GMRCSTU",149,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",150,0)
 ..S TEMPTMP="GROUPER: "_$P(^GMR(123.5,ND,0),"^",1)
"RTN","GMRCSTU",151,0)
 ..S:$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)>0 TEMPTMP=TEMPTMP_"  in Group: "_$P(^GMR(123.5,$P(^TMP("GMRCSLIST",$J,INDEX),"^",3),0),"^",1)
"RTN","GMRCSTU",152,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-(($L(TEMPTMP)/2)+.5))_TEMPTMP
"RTN","GMRCSTU",153,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",154,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",155,0)
 ..;push new grouper on stack
"RTN","GMRCSTU",156,0)
 ..S GROUPER=GROUPER+1
"RTN","GMRCSTU",157,0)
 ..S GROUPER(GROUPER)=ND
"RTN","GMRCSTU",158,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=1
"RTN","GMRCSTU",159,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",160,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,1,ND,GROUPER(GROUPER))
"RTN","GMRCSTU",161,0)
 ;Now list the group totals for the current groups.
"RTN","GMRCSTU",162,0)
 F GROUPER=GROUPER:-1:1 D
"RTN","GMRCSTU",163,0)
 .;End of a group so print the group totals
"RTN","GMRCSTU",164,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",165,0)
 ;Done building list.
"RTN","GMRCSTU",166,0)
 S VALMCNT=GMRCCT,VALMBCK="R"
"RTN","GMRCSTU",167,0)
KILL ;kill variables and exit
"RTN","GMRCSTU",168,0)
 S:$D(GMRCQUT) VALMBCK="Q"
"RTN","GMRCSTU",169,0)
 K ^TMP("GMRCS",$J),^TMP("GMRCSLIST",$J)
"RTN","GMRCSTU",170,0)
 Q
"RTN","GMRCSTU",171,0)
PRNT ;print statistics to a printer
"RTN","GMRCSTU",172,0)
 ;Called from a List Manager action
"RTN","GMRCSTU",173,0)
 Q:'$D(^TMP("GMRCR",$J,"PRL",2,0))
"RTN","GMRCSTU",174,0)
 I $D(IOTM),$D(IOBM),$D(IOSTBM) D FULL^VALM1
"RTN","GMRCSTU",175,0)
 D PRNTASK
"RTN","GMRCSTU",176,0)
 D PRNTIT("PRL","PRNTQ^GMRCSTU","CONSULT/REQUEST PACKAGE PRINT COMPLETION TIME STATISTICS FROM LIST MANAGER DISPLAY")
"RTN","GMRCSTU",177,0)
 Q
"RTN","GMRCSTU",178,0)
 ;
"RTN","GMRCSTU",179,0)
PRNTASK ;Ask for device
"RTN","GMRCSTU",180,0)
 N POP,%ZIS
"RTN","GMRCSTU",181,0)
 K GMRCQUT
"RTN","GMRCSTU",182,0)
 S POP=0
"RTN","GMRCSTU",183,0)
 S %ZIS="MQ"
"RTN","GMRCSTU",184,0)
 D ^%ZIS
"RTN","GMRCSTU",185,0)
 I POP D  Q
"RTN","GMRCSTU",186,0)
 .S GMRCMSG="Printer Busy. Try Again Later."
"RTN","GMRCSTU",187,0)
 .D EXAC^GMRCADC(GMRCMSG)
"RTN","GMRCSTU",188,0)
 .K GMRCMSG
"RTN","GMRCSTU",189,0)
 .S GMRCQUT=1
"RTN","GMRCSTU",190,0)
 Q
"RTN","GMRCSTU",191,0)
 ;
"RTN","GMRCSTU",192,0)
PRNTIT(TMPNAME,QUERTN,QUEDESC) ;Send list to printer
"RTN","GMRCSTU",193,0)
 N ANSWER,INDEX,DOLLARH,ZTRTN,ZTDESC
"RTN","GMRCSTU",194,0)
 I $D(IO("Q")) D  Q
"RTN","GMRCSTU",195,0)
 .S DOLLARH=$H
"RTN","GMRCSTU",196,0)
 .M ^XTMP("GMRCR","$"_$J,DOLLARH,"PRINT")=^TMP("GMRCR",$J,TMPNAME)
"RTN","GMRCSTU",197,0)
 .S ZTRTN=QUERTN
"RTN","GMRCSTU",198,0)
 .S ZTDESC=QUEDESC
"RTN","GMRCSTU",199,0)
 .S ZTSAVE("J")="$"_$J
"RTN","GMRCSTU",200,0)
 .S ZTSAVE("DOLLARH")=""
"RTN","GMRCSTU",201,0)
 .S ZTSAVE("TMPNAME")=""
"RTN","GMRCSTU",202,0)
 .S ZTSAVE("GMRCDG")=""
"RTN","GMRCSTU",203,0)
 .S ZTSAVE("GMRCDT1")=""
"RTN","GMRCSTU",204,0)
 .S ZTSAVE("GMRCDT2")=""
"RTN","GMRCSTU",205,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","GMRCSTU",206,0)
 .K ZTSAVE
"RTN","GMRCSTU",207,0)
 .S VALMBCK="R"
"RTN","GMRCSTU",208,0)
 U IO
"RTN","GMRCSTU",209,0)
 S ANSWER=""
"RTN","GMRCSTU",210,0)
 S INDEX=""
"RTN","GMRCSTU",211,0)
 F  S INDEX=$O(^TMP("GMRCR",$J,TMPNAME,INDEX)) Q:INDEX=""  W ^TMP("GMRCR",$J,TMPNAME,INDEX,0),! I IOST["C-",$S($D(IOSL)#2:$Y>(IOSL-2),1:$Y>22) R "Press <ENTER> To Continue, '^' To Quit: ",ANSWER:DTIME Q:'$T!(ANSWER["^")  W @IOF
"RTN","GMRCSTU",212,0)
 I ANSWER'["^",IOST["C-",$Y>1 R !,"Press <ENTER> To Continue: ",ANSWER:DTIME
"RTN","GMRCSTU",213,0)
 U IO(0)
"RTN","GMRCSTU",214,0)
 D ^%ZISC
"RTN","GMRCSTU",215,0)
 S VALMBCK="R"
"RTN","GMRCSTU",216,0)
 Q
"RTN","GMRCSTU",217,0)
 ;
"RTN","GMRCSTU",218,0)
PRNTQ ;Print Queued report from ^XTMP global then kill off ^XTMP
"RTN","GMRCSTU",219,0)
 N INDEX
"RTN","GMRCSTU",220,0)
 U IO
"RTN","GMRCSTU",221,0)
 S INDEX=""
"RTN","GMRCSTU",222,0)
 F  S INDEX=$O(^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX)) Q:INDEX=""  W ^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX,0),!
"RTN","GMRCSTU",223,0)
 K ^XTMP("GMRCR",J,DOLLARH,"PRINT"),J,DOLLARH
"RTN","GMRCSTU",224,0)
 D ^%ZISC
"RTN","GMRCSTU",225,0)
 Q
"VER")
8.0^22.0
"BLD",7662,6)
^52
**END**
**END**
