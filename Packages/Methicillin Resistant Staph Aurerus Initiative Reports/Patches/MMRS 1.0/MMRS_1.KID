KIDS Distribution saved on Oct 30, 2009@09:17:48
MMRS 1.0
**KIDS**:MMRS 1.0^

**INSTALL NAME**
MMRS 1.0
"BLD",8049,0)
MMRS 1.0^MRSA INITIATIVE REPORTS^0^3091030^y
"BLD",8049,4,0)
^9.64PA^104.3^4
"BLD",8049,4,104,0)
104
"BLD",8049,4,104,222)
y^y^f^^^^n
"BLD",8049,4,104.1,0)
104.1
"BLD",8049,4,104.1,222)
y^y^f^^^^n
"BLD",8049,4,104.2,0)
104.2
"BLD",8049,4,104.2,222)
y^y^f^^n^^y^o^n
"BLD",8049,4,104.2,224)

"BLD",8049,4,104.3,0)
104.3
"BLD",8049,4,104.3,222)
y^y^f^^^^n
"BLD",8049,4,"B",104,104)

"BLD",8049,4,"B",104.1,104.1)

"BLD",8049,4,"B",104.2,104.2)

"BLD",8049,4,"B",104.3,104.3)

"BLD",8049,6)
^
"BLD",8049,6.3)
35
"BLD",8049,"ABNS",0)
^9.66A^^
"BLD",8049,"ABPKG")
^^
"BLD",8049,"INI")

"BLD",8049,"INID")
^^
"BLD",8049,"INIT")

"BLD",8049,"KRN",0)
^9.67PA^779.2^20
"BLD",8049,"KRN",.4,0)
.4
"BLD",8049,"KRN",.401,0)
.401
"BLD",8049,"KRN",.402,0)
.402
"BLD",8049,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",8049,"KRN",.403,0)
.403
"BLD",8049,"KRN",.403,"NM",0)
^9.68A^3^3
"BLD",8049,"KRN",.403,"NM",1,0)
MMRSISLTORD    FILE #104^104^0
"BLD",8049,"KRN",.403,"NM",2,0)
MMRSLABPARAM    FILE #104.1^104.1^0
"BLD",8049,"KRN",.403,"NM",3,0)
MMRSMRSA WARD MAP    FILE #104.3^104.3^0
"BLD",8049,"KRN",.403,"NM","B","MMRSISLTORD    FILE #104",1)

"BLD",8049,"KRN",.403,"NM","B","MMRSLABPARAM    FILE #104.1",2)

"BLD",8049,"KRN",.403,"NM","B","MMRSMRSA WARD MAP    FILE #104.3",3)

"BLD",8049,"KRN",.5,0)
.5
"BLD",8049,"KRN",.84,0)
.84
"BLD",8049,"KRN",3.6,0)
3.6
"BLD",8049,"KRN",3.8,0)
3.8
"BLD",8049,"KRN",9.2,0)
9.2
"BLD",8049,"KRN",9.8,0)
9.8
"BLD",8049,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",8049,"KRN",9.8,"NM",1,0)
MMRSIPC^^0^B96473573
"BLD",8049,"KRN",9.8,"NM",2,0)
MMRSIPC2^^0^B34845828
"BLD",8049,"KRN",9.8,"NM",3,0)
MMRSIPC3^^0^B103482398
"BLD",8049,"KRN",9.8,"NM",4,0)
MMRSIPC4^^0^B58171274
"BLD",8049,"KRN",9.8,"NM",5,0)
MMRSIPCP^^0^B27513898
"BLD",8049,"KRN",9.8,"NM",6,0)
MMRSISL^^0^B59561295
"BLD",8049,"KRN",9.8,"NM",7,0)
MMRSORD^^0^B37424974
"BLD",8049,"KRN",9.8,"NM",8,0)
MMRSIPC5^^0^B24723912
"BLD",8049,"KRN",9.8,"NM","B","MMRSIPC",1)

"BLD",8049,"KRN",9.8,"NM","B","MMRSIPC2",2)

"BLD",8049,"KRN",9.8,"NM","B","MMRSIPC3",3)

"BLD",8049,"KRN",9.8,"NM","B","MMRSIPC4",4)

"BLD",8049,"KRN",9.8,"NM","B","MMRSIPC5",8)

"BLD",8049,"KRN",9.8,"NM","B","MMRSIPCP",5)

"BLD",8049,"KRN",9.8,"NM","B","MMRSISL",6)

"BLD",8049,"KRN",9.8,"NM","B","MMRSORD",7)

"BLD",8049,"KRN",19,0)
19
"BLD",8049,"KRN",19,"NM",0)
^9.68A^13^13
"BLD",8049,"KRN",19,"NM",1,0)
MMRS ISLT ORD EDIT^^0
"BLD",8049,"KRN",19,"NM",2,0)
MMRS ISOLATION REPORT^^0
"BLD",8049,"KRN",19,"NM",3,0)
MMRS ISOLATION REPORT (TASKED)^^0
"BLD",8049,"KRN",19,"NM",4,0)
MMRS MRSA IPEC REPORT^^0
"BLD",8049,"KRN",19,"NM",5,0)
MMRS MRSA LAB PARAMETER SETUP^^0
"BLD",8049,"KRN",19,"NM",6,0)
MMRS MRSA MDRO HIST DAYS EDIT^^0
"BLD",8049,"KRN",19,"NM",7,0)
MMRS MRSA PARAMETER SETUP^^0
"BLD",8049,"KRN",19,"NM",8,0)
MMRS MRSA TOOLS SETUP MENU^^0
"BLD",8049,"KRN",19,"NM",9,0)
MMRS MRSA WARD MAPPING SETUP^^0
"BLD",8049,"KRN",19,"NM",10,0)
MMRS NARES SWAB LIST^^0
"BLD",8049,"KRN",19,"NM",11,0)
MMRS NARES SWAB LIST (TASKED)^^0
"BLD",8049,"KRN",19,"NM",12,0)
MMRS REPORTS MENU^^0
"BLD",8049,"KRN",19,"NM",13,0)
MMRS MRSA IPEC AUTO-EXTRACT^^0
"BLD",8049,"KRN",19,"NM","B","MMRS ISLT ORD EDIT",1)

"BLD",8049,"KRN",19,"NM","B","MMRS ISOLATION REPORT",2)

"BLD",8049,"KRN",19,"NM","B","MMRS ISOLATION REPORT (TASKED)",3)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA IPEC AUTO-EXTRACT",13)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA IPEC REPORT",4)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA LAB PARAMETER SETUP",5)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA MDRO HIST DAYS EDIT",6)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA PARAMETER SETUP",7)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA TOOLS SETUP MENU",8)

"BLD",8049,"KRN",19,"NM","B","MMRS MRSA WARD MAPPING SETUP",9)

"BLD",8049,"KRN",19,"NM","B","MMRS NARES SWAB LIST",10)

"BLD",8049,"KRN",19,"NM","B","MMRS NARES SWAB LIST (TASKED)",11)

"BLD",8049,"KRN",19,"NM","B","MMRS REPORTS MENU",12)

"BLD",8049,"KRN",19.1,0)
19.1
"BLD",8049,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",8049,"KRN",19.1,"NM",1,0)
MMRS SETUP^^0
"BLD",8049,"KRN",19.1,"NM","B","MMRS SETUP",1)

"BLD",8049,"KRN",101,0)
101
"BLD",8049,"KRN",409.61,0)
409.61
"BLD",8049,"KRN",771,0)
771
"BLD",8049,"KRN",779.2,0)
779.2
"BLD",8049,"KRN",870,0)
870
"BLD",8049,"KRN",8989.51,0)
8989.51
"BLD",8049,"KRN",8989.52,0)
8989.52
"BLD",8049,"KRN",8994,0)
8994
"BLD",8049,"KRN","B",.4,.4)

"BLD",8049,"KRN","B",.401,.401)

"BLD",8049,"KRN","B",.402,.402)

"BLD",8049,"KRN","B",.403,.403)

"BLD",8049,"KRN","B",.5,.5)

"BLD",8049,"KRN","B",.84,.84)

"BLD",8049,"KRN","B",3.6,3.6)

"BLD",8049,"KRN","B",3.8,3.8)

"BLD",8049,"KRN","B",9.2,9.2)

"BLD",8049,"KRN","B",9.8,9.8)

"BLD",8049,"KRN","B",19,19)

"BLD",8049,"KRN","B",19.1,19.1)

"BLD",8049,"KRN","B",101,101)

"BLD",8049,"KRN","B",409.61,409.61)

"BLD",8049,"KRN","B",771,771)

"BLD",8049,"KRN","B",779.2,779.2)

"BLD",8049,"KRN","B",870,870)

"BLD",8049,"KRN","B",8989.51,8989.51)

"BLD",8049,"KRN","B",8989.52,8989.52)

"BLD",8049,"KRN","B",8994,8994)

"BLD",8049,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8049,"QUES",0)
^9.62^^
"BLD",8049,"REQB",0)
^9.611^^
"DATA",104.2,1,0)
MRSA^Methicillin-resistant Staphylococcus aureus
"DATA",104.2,1,2,0)
^^41^41^3090902^
"DATA",104.2,1,2,1,0)
Methicillin (or oxacillin)-resistant Staphylococcus aureus (MRSA) is a 
"DATA",104.2,1,2,2,0)
pathogen of continuing importance for healthcare facilities. It is a 
"DATA",104.2,1,2,3,0)
Gram-positive coccus that can be resistant to multiple antibiotics, causes
"DATA",104.2,1,2,4,0)
serious disease, and is often difficult to treat. It is the cause of
"DATA",104.2,1,2,5,0)
healthcare-associated infections (HAIs), and is an emerging pathogen from
"DATA",104.2,1,2,6,0)
community-associate sources. MRSA can be cultured from the nares and other
"DATA",104.2,1,2,7,0)
sites in patients who are colonized or infected with the organism. It is
"DATA",104.2,1,2,8,0)
transmitted, in general, by contact, with the hands of patients or health
"DATA",104.2,1,2,9,0)
care workers or inanimate objects contaminated with MRSA. Such
"DATA",104.2,1,2,10,0)
transmission amplifies the number of patients who may become colonized and
"DATA",104.2,1,2,11,0)
who are then at risk for clinical infection.
"DATA",104.2,1,2,12,0)
 
"DATA",104.2,1,2,13,0)
It is important to capture all positive tests for MRSA, both clinical 
"DATA",104.2,1,2,14,0)
cultures and surveillance screening tests (e.g., nares screens). Any 
"DATA",104.2,1,2,15,0)
Staphylococcus aureus isolate that is resistant to Methicillin (or 
"DATA",104.2,1,2,16,0)
oxacillin) should be captured for this. VHA Laboratory Service must record
"DATA",104.2,1,2,17,0)
results of MRSA tests performed using the following methodology:
"DATA",104.2,1,2,18,0)
 
"DATA",104.2,1,2,19,0)
   1. MI-subscripted tests will be used for clinical cultures (C&S) 
"DATA",104.2,1,2,20,0)
      only. STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT (MRSA) is the only
"DATA",104.2,1,2,21,0)
      etiology that will be used to report positive clinical cultures.  
"DATA",104.2,1,2,22,0)
 
"DATA",104.2,1,2,23,0)
   2. CH-subscripted tests will be used for MRSA nares screens or MRSA
"DATA",104.2,1,2,24,0)
      surveillance cultures. Laboratory is required to use the following
"DATA",104.2,1,2,25,0)
      test names: MRSA SURVL NARES DNA, MRSAL SURVL OTHER DNA, MRSA SURVL
"DATA",104.2,1,2,26,0)
      NARES AGAR, MRSA SURVL OTHER AGAR.
"DATA",104.2,1,2,27,0)
 
"DATA",104.2,1,2,28,0)
Please refer to the "Laboratory Reporting of MRSA Test" for information on
"DATA",104.2,1,2,29,0)
how to setup the standardized test names and etiology.
"DATA",104.2,1,2,30,0)
 
"DATA",104.2,1,2,31,0)
NOTE: Adding Methicillin-resistant Staphylococcus aureus to the MRSA Tools
"DATA",104.2,1,2,32,0)
Lab Parameter Setup is mandatory. The above standards for MRSA laboratory
"DATA",104.2,1,2,33,0)
reporting (clinical cultures and screening tests) have been hard coded
"DATA",104.2,1,2,34,0)
into the MRSA Program Tools software, and does not need to be entered into
"DATA",104.2,1,2,35,0)
the MRSA lab parameters setup. Only historical methods of reporting, that
"DATA",104.2,1,2,36,0)
were different from the national standards need to be entered. The purpose
"DATA",104.2,1,2,37,0)
of adding this pathogen to the parameter set-up is to identify prior
"DATA",104.2,1,2,38,0)
history of MRSA (either by clinical culture or nares screen) based on
"DATA",104.2,1,2,39,0)
laboratory reporting. If the facility fails to use the laboratory
"DATA",104.2,1,2,40,0)
standards set forth, the program will be unable to generate accurate
"DATA",104.2,1,2,41,0)
reports for data reporting.
"DATA",104.2,2,0)
CRB-R^Carbapenem-resistance
"DATA",104.2,2,2,0)
^^30^30^3090902^
"DATA",104.2,2,2,1,0)
Carbapenems are a class of beta-lactam antibiotics with a broad spectrum 
"DATA",104.2,2,2,2,0)
of antibacterial activity. These agents have the broadest antibacterial 
"DATA",104.2,2,2,3,0)
spectrum compared to other beta-lactam classes. They are active against 
"DATA",104.2,2,2,4,0)
both Gram positive and Gram negative bacteria, and can be used to treat 
"DATA",104.2,2,2,5,0)
nosocomial and mixed bacterial infections. Resistance to carbapenems is of
"DATA",104.2,2,2,6,0)
importance because it limits therapeutic options.  
"DATA",104.2,2,2,7,0)
 
"DATA",104.2,2,2,8,0)
NOTE: Adding Carbapenem-resistance to the MRSA Tools Lab Parameter Setup 
"DATA",104.2,2,2,9,0)
is optional. The purpose of adding this resistance marker for numerous 
"DATA",104.2,2,2,10,0)
pathogens is to identify a patient's current or prior history 
"DATA",104.2,2,2,11,0)
carbapenem-resistance based on laboratory reporting and the time frames 
"DATA",104.2,2,2,12,0)
that are entered to search for the patient's status. This information is 
"DATA",104.2,2,2,13,0)
displayed on the Isolation Report. To display this information, please 
"DATA",104.2,2,2,14,0)
enter the appropriate etiology (or etiologies) to search for and select 
"DATA",104.2,2,2,15,0)
the appropriate Antimicrobial Susceptibility for the organism and how to 
"DATA",104.2,2,2,16,0)
search for the results. Another option to search for Carbapenem-resistance
"DATA",104.2,2,2,17,0)
is to add the appropriate comments under the "BACT RPT REMARK" fields, if
"DATA",104.2,2,2,18,0)
this is appropriate for your facility. If you are using "BACT RPT REMARK"
"DATA",104.2,2,2,19,0)
to identify carbapenem-resistance, it is important that a consistent
"DATA",104.2,2,2,20,0)
method of reporting is used to identify results (i.e., canned comments).
"DATA",104.2,2,2,21,0)
If free-text is used, it is likely the report will not display accurate
"DATA",104.2,2,2,22,0)
information.  
"DATA",104.2,2,2,23,0)
 
"DATA",104.2,2,2,24,0)
You can add multiple etiologies with different antimicrobial 
"DATA",104.2,2,2,25,0)
susceptibilities to search for carbapenem-resistance. For example you can
"DATA",104.2,2,2,26,0)
add the etiology Klebsiella and set the antimicrobial susceptibility for
"DATA",104.2,2,2,27,0)
resistance to Meropenem. You can then add the etiology Pseudomonas and set
"DATA",104.2,2,2,28,0)
the antimicrobial susceptibility for resistance to Imipenem. You will need
"DATA",104.2,2,2,29,0)
to enter all etiologies to be searched for and the appropriate 
"DATA",104.2,2,2,30,0)
antimicrobial susceptibility.  
"DATA",104.2,3,0)
VRE^Vancomycin-Resistant Enterococcus
"DATA",104.2,3,2,0)
^^23^23^3090902^
"DATA",104.2,3,2,1,0)
Vancomycin-resistant Enterococcus (VRE) is a pathogen of increasing 
"DATA",104.2,3,2,2,0)
importance for healthcare facilities. Enterococcus is a bacterium that 
"DATA",104.2,3,2,3,0)
lives in the intestinal tract and in the female genital tract. Vancomycin
"DATA",104.2,3,2,4,0)
is an antibiotic that is often used to treat infections caused by
"DATA",104.2,3,2,5,0)
enterococci, and recently enterococci have become resistant to this drug.
"DATA",104.2,3,2,6,0)
Most VRE infections occur in the hospital.  
"DATA",104.2,3,2,7,0)
 
"DATA",104.2,3,2,8,0)
NOTE: Adding Vancomycin-resistant Enterococcus to the MRSA Tools Lab 
"DATA",104.2,3,2,9,0)
Parameter Setup is optional. The purpose of adding this pathogen to the 
"DATA",104.2,3,2,10,0)
parameter set-up is to identify a patient's current or prior history of 
"DATA",104.2,3,2,11,0)
VRE based on laboratory reporting and the time frames that are entered to 
"DATA",104.2,3,2,12,0)
search for the patient's status. This information can optionally be 
"DATA",104.2,3,2,13,0)
displayed on the Isolation Report. This includes cultures positive for 
"DATA",104.2,3,2,14,0)
prevalence and surveillance review, including specimens of stool and 
"DATA",104.2,3,2,15,0)
rectal swabs. It is important to search for all vancomycin resistant 
"DATA",104.2,3,2,16,0)
enterococci, whether speciated or not. It is important to be sure to list
"DATA",104.2,3,2,17,0)
all the places in the Microbiology Laboratory package where Enterococcus
"DATA",104.2,3,2,18,0)
are found, either as Enterococcus, E. (sp.), Group D-Streptococcus, E.
"DATA",104.2,3,2,19,0)
faecalis, E. faecium, E. durans, E. gallinarum, E. casseliflavus, etc.  
"DATA",104.2,3,2,20,0)
The laboratory parameter setup for the MRSA Program Tools should match the
"DATA",104.2,3,2,21,0)
same parameter setup for the EPI (Emerging Pathogens Initiative). If
"DATA",104.2,3,2,22,0)
changes are made to how Vancomycin-resistant Enterococcus is reported it
"DATA",104.2,3,2,23,0)
should also be changed in EPI parameter setup.
"DATA",104.2,4,0)
C. diff^Clostridium difficile
"DATA",104.2,4,2,0)
^^37^37^3090902^
"DATA",104.2,4,2,1,0)
Clostridium difficile is a species of gram-positive bacteria. The disease
"DATA",104.2,4,2,2,0)
is associated with the presence of Clostridium difficle enterotoxin, which
"DATA",104.2,4,2,3,0)
can cause significant morbidity, as well as mortality. It is of
"DATA",104.2,4,2,4,0)
importance, as its predominant acquisition appears to occur nosocomially
"DATA",104.2,4,2,5,0)
and is the most serious cause of antibiotic-associated diarrhea. Presence
"DATA",104.2,4,2,6,0)
of clostridial toxin (either enterotoxin or cytotoxin L) by assay (whether
"DATA",104.2,4,2,7,0)
it be EIA, latex agglutination, cytotoxicity of cell culture
"DATA",104.2,4,2,8,0)
+neutralization, or culture of organism with subsequent colony testing) is
"DATA",104.2,4,2,9,0)
the best indicator that an inflammatory diarrheal disease is due to
"DATA",104.2,4,2,10,0)
presence of Clostridium difficile.
"DATA",104.2,4,2,11,0)
 
"DATA",104.2,4,2,12,0)
Laboratory services are quite varied as to how they identify the presence 
"DATA",104.2,4,2,13,0)
of Clostridium difficile. Some labs are set up to identify C. difficile as
"DATA",104.2,4,2,14,0)
the final microbiological (bacterial) etiology of a culture, even if a 
"DATA",104.2,4,2,15,0)
culture method was not used. Other labs use a final etiology of "see 
"DATA",104.2,4,2,16,0)
comment" and then enter the results in a free text format. Still others 
"DATA",104.2,4,2,17,0)
enter the text under a hematology or chemistry format where a reference 
"DATA",104.2,4,2,18,0)
range and "positive" and "negative" result values can be entered.  
"DATA",104.2,4,2,19,0)
Wherever the VHA Laboratory Service places the results, which are used to 
"DATA",104.2,4,2,20,0)
demonstrate the presence of toxin-producing C. difficile, should be 
"DATA",104.2,4,2,21,0)
accessible as a standardized field in order to allow the MRSA Programs 
"DATA",104.2,4,2,22,0)
Tool software to capture its presence.  
"DATA",104.2,4,2,23,0)
 
"DATA",104.2,4,2,24,0)
NOTE: Adding Clostridium difficile to the MRSA Tools Lab Parameter Setup 
"DATA",104.2,4,2,25,0)
is optional.  The purpose of adding this pathogen to the parameter set-up 
"DATA",104.2,4,2,26,0)
is to identify a patient's current or prior history of Clostridium 
"DATA",104.2,4,2,27,0)
difficile based on laboratory reporting and the time frames that are 
"DATA",104.2,4,2,28,0)
entered to search for the patient's status. This information can 
"DATA",104.2,4,2,29,0)
optionally be displayed on the Isolation Report. The laboratory parameter
"DATA",104.2,4,2,30,0)
setup for the MRSA Program Tools should match the same parameter setup for
"DATA",104.2,4,2,31,0)
the EPI (Emerging Pathogens Initiative). If changes are made to how
"DATA",104.2,4,2,32,0)
Clostridium difficile is reported it should also be changed in EPI
"DATA",104.2,4,2,33,0)
parameter setup. The result must occur as a "bacterial etiology" or as a
"DATA",104.2,4,2,34,0)
retrievable positive result for a chemistry/serology laboratory test. Any
"DATA",104.2,4,2,35,0)
results contained in a "Free-Text" section will not allow incorporation of
"DATA",104.2,4,2,36,0)
Clostridium difficile into the MRSA Program Tools software Isolation
"DATA",104.2,4,2,37,0)
Report format.  
"DATA",104.2,5,0)
ESBL^Extended-spectrum beta-lactamase
"DATA",104.2,5,2,0)
^^28^28^3090902^
"DATA",104.2,5,2,1,0)
Extended-Spectrum Beta-Lactamases (ESBLs) are enzymes that mediate 
"DATA",104.2,5,2,2,0)
resistance to extended-spectrum (third generation) cephalosporins (e.g., 
"DATA",104.2,5,2,3,0)
ceftazidime, cefotaxime, and ceftriaxone) and monobactams (e.g, aztreonam)
"DATA",104.2,5,2,4,0)
but do not affect cephamycins (e.g., cefoxitin and cefotetan) or
"DATA",104.2,5,2,5,0)
carbapenems (e.g., imipenem or meropenem).  
"DATA",104.2,5,2,6,0)
 
"DATA",104.2,5,2,7,0)
ESBLs can be difficult to detect because they have different levels of 
"DATA",104.2,5,2,8,0)
activity against various cephalosporins. It is critical to test the 
"DATA",104.2,5,2,9,0)
appropriate antimicrobial agent. An appropriate Committee on Laboratory 
"DATA",104.2,5,2,10,0)
Standards Institute (CLSI) testing schema should be used. If an isolate is
"DATA",104.2,5,2,11,0)
confirmed as an ESBL-producer by the CLSI-recommended phenotypic 
"DATA",104.2,5,2,12,0)
confirmatory test procedure, then all penicillins, cephalosporins and 
"DATA",104.2,5,2,13,0)
aztreonams should be reported as resistant. Cephamycins should be reported
"DATA",104.2,5,2,14,0)
according to their routine test results.  
"DATA",104.2,5,2,15,0)
 
"DATA",104.2,5,2,16,0)
NOTE: Adding Extended-Spectrum Beta Lactamase to the MRSA Tools Lab 
"DATA",104.2,5,2,17,0)
Parameter Setup is optional. The purpose of adding pathogens containing 
"DATA",104.2,5,2,18,0)
this form of antimicrobial resistance to the parameter set-up is to 
"DATA",104.2,5,2,19,0)
identify a patient's current or prior history of ESBL based on laboratory 
"DATA",104.2,5,2,20,0)
reporting and the time frames that are entered to search for the patient's
"DATA",104.2,5,2,21,0)
status. This information can optionally be displayed on the Isolation
"DATA",104.2,5,2,22,0)
Report. If you would like to incorporate ESBL into the Isolation report,
"DATA",104.2,5,2,23,0)
the result must occur as a retrievable result as a "bacterial etiology" or
"DATA",104.2,5,2,24,0)
in the "BACT RPT REMARK" field. It is appropriate to used Canned Comments
"DATA",104.2,5,2,25,0)
versus Free Text to retrieve results. If free-text is used, it is likely
"DATA",104.2,5,2,26,0)
the report will not display accurate information. Any results contained in
"DATA",104.2,5,2,27,0)
the "Comments" section will not allow incorporation of ESBL into the MRSA
"DATA",104.2,5,2,28,0)
Program Tools software Isolation Report format.
"FIA",104)
MRSA SITE PARAMETERS
"FIA",104,0)
^MMRS(104,
"FIA",104,0,0)
104P
"FIA",104,0,1)
y^y^f^^^^n
"FIA",104,0,10)

"FIA",104,0,11)

"FIA",104,0,"RLRO")

"FIA",104,0,"VR")
1.0^MMRS
"FIA",104,104)
0
"FIA",104,104.05)
0
"FIA",104.1)
MRSA TOOLS LAB SEARCH/EXTRACT
"FIA",104.1,0)
^MMRS(104.1,
"FIA",104.1,0,0)
104.1IP
"FIA",104.1,0,1)
y^y^f^^^^n
"FIA",104.1,0,10)

"FIA",104.1,0,11)

"FIA",104.1,0,"RLRO")

"FIA",104.1,0,"VR")
1.0^MMRS
"FIA",104.1,104.1)
0
"FIA",104.1,104.103)
0
"FIA",104.1,104.104)
0
"FIA",104.1,104.107)
0
"FIA",104.1,104.108)
0
"FIA",104.1,104.109)
0
"FIA",104.1,104.15)
0
"FIA",104.1,104.191)
0
"FIA",104.2)
MDRO TYPES
"FIA",104.2,0)
^MMRS(104.2,
"FIA",104.2,0,0)
104.2I
"FIA",104.2,0,1)
y^y^f^^n^^y^o^n
"FIA",104.2,0,10)

"FIA",104.2,0,11)

"FIA",104.2,0,"RLRO")

"FIA",104.2,0,"VR")
1.0^MMRS
"FIA",104.2,104.2)
0
"FIA",104.2,104.22)
0
"FIA",104.2,104.23)
0
"FIA",104.3)
MRSA WARD MAPPINGS
"FIA",104.3,0)
^MMRS(104.3,
"FIA",104.3,0,0)
104.3I
"FIA",104.3,0,1)
y^y^f^^^^n
"FIA",104.3,0,10)

"FIA",104.3,0,11)

"FIA",104.3,0,"RLRO")

"FIA",104.3,0,"VR")
1.0^MMRS
"FIA",104.3,104.3)
0
"FIA",104.3,104.302)
0
"IX",104.1,104.1,"C",0)
104.1^C^This cross reference is used to look up records by Division and MDRO.^R^^R^IR^I^104.1^^^^^LS
"IX",104.1,104.1,"C",1)
S ^MMRS(104.1,"C",$E(X(1),1,30),$E(X(2),1,30),DA)=""
"IX",104.1,104.1,"C",2)
K ^MMRS(104.1,"C",$E(X(1),1,30),$E(X(2),1,30),DA)
"IX",104.1,104.1,"C",2.5)
K ^MMRS(104.1,"C")
"IX",104.1,104.1,"C",11.1,0)
^.114IA^2^2
"IX",104.1,104.1,"C",11.1,1,0)
1^F^104.1^1^30^1^F
"IX",104.1,104.1,"C",11.1,1,3)

"IX",104.1,104.1,"C",11.1,2,0)
2^F^104.1^.01^30^2^F
"IX",104.1,104.1,"C",11.1,2,3)

"KRN",.403,154,-1)
0^3
"KRN",.403,154,0)
MMRSMRSA WARD MAP^@^@^^3081125.1626^^^104.3^0^0^1
"KRN",.403,154,40,0)
^.4031I^1^1
"KRN",.403,154,40,1,0)
1^^1,1
"KRN",.403,154,40,1,1)
Page 1
"KRN",.403,154,40,1,40,0)
^.4032IP^583^3
"KRN",.403,154,40,1,40,581,0)
MMRSMRSA WARD MAP HEAD^1^1,1^d
"KRN",.403,154,40,1,40,582,0)
MMRSMRSA WARD MAP WARD HEAD^2^7,1^d
"KRN",.403,154,40,1,40,583,0)
MMRSMRSA WARD MAP WARDS^3^8,1^e
"KRN",.403,154,40,1,40,583,2)
8^^^^^
"KRN",.403,155,-1)
0^2
"KRN",.403,155,0)
MMRSLABPARAM^@^@^^3090226.1926^^^104.1^0^0^1
"KRN",.403,155,40,0)
^.4031I^3^3
"KRN",.403,155,40,1,0)
1^^1,1^2^2
"KRN",.403,155,40,1,1)
Page 1
"KRN",.403,155,40,1,40,0)
^.4032IP^585^5
"KRN",.403,155,40,1,40,569,0)
MMRSPARAMHEAD^1^1,1^e
"KRN",.403,155,40,1,40,574,0)
MMRSPARAM2ET^4^12,1^e
"KRN",.403,155,40,1,40,575,0)
MMRSPARAM2ET2^5^14,1^e
"KRN",.403,155,40,1,40,575,2)
4
"KRN",.403,155,40,1,40,584,0)
MMRSLABHDR^2^7,2^d
"KRN",.403,155,40,1,40,585,0)
MMRSCHLABTESTS^3^8,1^e
"KRN",.403,155,40,1,40,585,2)
4
"KRN",.403,155,40,2,0)
1.5^^9,5^^^1^17,69
"KRN",.403,155,40,2,1)
Page 1.5^1,MMRSPARAM2ET2,1
"KRN",.403,155,40,2,40,0)
^.4032IP^577^2
"KRN",.403,155,40,2,40,576,0)
MMRSPARAM2AS^1^2,2^e
"KRN",.403,155,40,2,40,577,0)
MMRSPARAM2AS2^2^3,2^e
"KRN",.403,155,40,2,40,577,2)
4
"KRN",.403,155,40,3,0)
2^^1,1^1^1
"KRN",.403,155,40,3,1)
Page 2
"KRN",.403,155,40,3,40,0)
^.4032IP^580^4
"KRN",.403,155,40,3,40,569,0)
MMRSPARAMHEAD^1^1,1^e
"KRN",.403,155,40,3,40,578,0)
MMRSPARAM2BRH^2^7,1^e
"KRN",.403,155,40,3,40,579,0)
MMRSPARAM2BRI^3^10,1^e
"KRN",.403,155,40,3,40,579,2)
5
"KRN",.403,155,40,3,40,580,0)
MMRSPARAM2BRE^4^10,38^e
"KRN",.403,155,40,3,40,580,2)
5
"KRN",.403,156,-1)
0^1
"KRN",.403,156,0)
MMRSISLTORD^@^@^^3090302.1109^^^104^0^0^1
"KRN",.403,156,40,0)
^.4031I^1^1
"KRN",.403,156,40,1,0)
1^^1,1
"KRN",.403,156,40,1,1)
Page 1
"KRN",.403,156,40,1,40,0)
^.4032IP^589^3
"KRN",.403,156,40,1,40,587,0)
MMRSISLTORDHDR^1^1,1^d
"KRN",.403,156,40,1,40,588,0)
MMRSISLTORDEDITHDR^2^6,1^d
"KRN",.403,156,40,1,40,589,0)
MMRSISLTORDEDIT2^3^8,1^e
"KRN",.403,156,40,1,40,589,2)
10
"KRN",.404,569,0)
MMRSPARAMHEAD^104.1^
"KRN",.404,569,40,0)
^.4044I^8^6
"KRN",.404,569,40,1,0)
1^MRSA TOOLS LAB SEARCH/EXTRACT PARAMETERS SETUP^1
"KRN",.404,569,40,1,2)
^^2,17
"KRN",.404,569,40,3,0)
3^DIVISION^3
"KRN",.404,569,40,3,1)
1
"KRN",.404,569,40,3,2)
4,11^35^4,1
"KRN",.404,569,40,3,4)
^^^1
"KRN",.404,569,40,4,0)
4^MDRO^3
"KRN",.404,569,40,4,1)
.01
"KRN",.404,569,40,4,2)
4,57^23^4,51
"KRN",.404,569,40,4,4)
^^^1
"KRN",.404,569,40,6,0)
6^________________________________________^1
"KRN",.404,569,40,6,2)
^^5,1
"KRN",.404,569,40,7,0)
7^________________________________________^1
"KRN",.404,569,40,7,2)
^^5,41
"KRN",.404,569,40,8,0)
8^!M^1
"KRN",.404,569,40,8,.1)
S Y="Page "_$S(DDSPG=1:1,DDSPG=3:2,1:"")_" of 2"
"KRN",.404,569,40,8,2)
^^2,67
"KRN",.404,574,0)
MMRSPARAM2ET^104.1
"KRN",.404,574,40,0)
^.4044I^1^1
"KRN",.404,574,40,1,0)
1^Selected Etiology^1
"KRN",.404,574,40,1,2)
^^2,1
"KRN",.404,575,0)
MMRSPARAM2ET2^104.109
"KRN",.404,575,40,0)
^.4044I^1^1
"KRN",.404,575,40,1,0)
1^^3
"KRN",.404,575,40,1,1)
.01
"KRN",.404,575,40,1,2)
1,1^69
"KRN",.404,576,0)
MMRSPARAM2AS^104.1^
"KRN",.404,576,40,0)
^.4044I^3^3
"KRN",.404,576,40,1,0)
1^ANTIMICROBIAL SUSCEPTIBILITY^1
"KRN",.404,576,40,1,2)
^^1,2
"KRN",.404,576,40,2,0)
2^INDICATOR^1
"KRN",.404,576,40,2,2)
^^1,34
"KRN",.404,576,40,3,0)
3^INDICATED VALUE^1
"KRN",.404,576,40,3,2)
^^1,46
"KRN",.404,577,0)
MMRSPARAM2AS2^104.191
"KRN",.404,577,40,0)
^.4044I^3^3
"KRN",.404,577,40,1,0)
1^^3
"KRN",.404,577,40,1,1)
.01
"KRN",.404,577,40,1,2)
1,2^30
"KRN",.404,577,40,2,0)
2^^3
"KRN",.404,577,40,2,1)
1
"KRN",.404,577,40,2,2)
1,34^9
"KRN",.404,577,40,3,0)
3^^3
"KRN",.404,577,40,3,1)
2
"KRN",.404,577,40,3,2)
1,46^17
"KRN",.404,578,0)
MMRSPARAM2BRH^104.1^
"KRN",.404,578,40,0)
^.4044I^3^3
"KRN",.404,578,40,1,0)
1^BACTERIOLOGY REPORT REMARKS^1
"KRN",.404,578,40,1,2)
^^1,25
"KRN",.404,578,40,2,0)
2^Include^1
"KRN",.404,578,40,2,2)
^^3,1
"KRN",.404,578,40,3,0)
3^Exclude^1
"KRN",.404,578,40,3,2)
^^3,38
"KRN",.404,579,0)
MMRSPARAM2BRI^104.107
"KRN",.404,579,40,0)
^.4044I^1^1
"KRN",.404,579,40,1,0)
1^^3
"KRN",.404,579,40,1,1)
.01
"KRN",.404,579,40,1,2)
1,1^30
"KRN",.404,580,0)
MMRSPARAM2BRE^104.108
"KRN",.404,580,40,0)
^.4044I^1^1
"KRN",.404,580,40,1,0)
1^^3
"KRN",.404,580,40,1,1)
.01
"KRN",.404,580,40,1,2)
1,1^30
"KRN",.404,581,0)
MMRSMRSA WARD MAP HEAD^104.3^
"KRN",.404,581,40,0)
^.4044I^5^5
"KRN",.404,581,40,1,0)
1^MRSA TOOLS WARD MAPPING SETUP^1
"KRN",.404,581,40,1,2)
^^2,25
"KRN",.404,581,40,2,0)
2^DIVISION^3
"KRN",.404,581,40,2,1)
1
"KRN",.404,581,40,2,2)
4,11^35^4,1
"KRN",.404,581,40,2,4)
^^^1
"KRN",.404,581,40,3,0)
3^________________________________________^1
"KRN",.404,581,40,3,2)
^^6,1
"KRN",.404,581,40,4,0)
4^________________________________________^1
"KRN",.404,581,40,4,2)
^^6,41
"KRN",.404,581,40,5,0)
5^GEOGRAPHICAL UNIT^3
"KRN",.404,581,40,5,1)
.01
"KRN",.404,581,40,5,2)
5,20^30^5,1
"KRN",.404,581,40,5,4)
^^^1
"KRN",.404,582,0)
MMRSMRSA WARD MAP WARD HEAD^104.3^
"KRN",.404,582,40,0)
^.4044I^1^1
"KRN",.404,582,40,1,0)
1^WARD LOCATIONS:^1
"KRN",.404,582,40,1,2)
^^2,1
"KRN",.404,583,0)
MMRSMRSA WARD MAP WARDS^104.302
"KRN",.404,583,40,0)
^.4044I^1^1
"KRN",.404,583,40,1,0)
1^^3
"KRN",.404,583,40,1,1)
.01
"KRN",.404,583,40,1,2)
3,1^30
"KRN",.404,584,0)
MMRSLABHDR^104.1^
"KRN",.404,584,40,0)
^.4044I^3^3
"KRN",.404,584,40,1,0)
1^Laboratory Test(s)^1
"KRN",.404,584,40,1,2)
^^1,1
"KRN",.404,584,40,2,0)
2^Indicator^1
"KRN",.404,584,40,2,2)
^^1,34
"KRN",.404,584,40,3,0)
3^Value^1
"KRN",.404,584,40,3,2)
^^1,60
"KRN",.404,585,0)
MMRSCHLABTESTS^104.15
"KRN",.404,585,40,0)
^.4044I^3^3
"KRN",.404,585,40,1,0)
1^^3
"KRN",.404,585,40,1,1)
.01
"KRN",.404,585,40,1,2)
1,2^30
"KRN",.404,585,40,2,0)
2^^3
"KRN",.404,585,40,2,1)
1
"KRN",.404,585,40,2,2)
1,35^20
"KRN",.404,585,40,3,0)
3^^3
"KRN",.404,585,40,3,1)
2
"KRN",.404,585,40,3,2)
1,61^15
"KRN",.404,587,0)
MMRSISLTORDHDR^104^
"KRN",.404,587,40,0)
^.4044I^4^4
"KRN",.404,587,40,1,0)
1^MRSA TOOLS ISOLATION ORDERS SETUP^1
"KRN",.404,587,40,1,2)
^^2,23
"KRN",.404,587,40,2,0)
2^DIVISION^3
"KRN",.404,587,40,2,1)
.01
"KRN",.404,587,40,2,2)
4,11^35^4,1
"KRN",.404,587,40,3,0)
3^________________________________________^1
"KRN",.404,587,40,3,2)
^^5,1
"KRN",.404,587,40,4,0)
4^________________________________________^1
"KRN",.404,587,40,4,2)
^^5,41
"KRN",.404,588,0)
MMRSISLTORDEDITHDR^104^
"KRN",.404,588,40,0)
^.4044I^2^2
"KRN",.404,588,40,1,0)
1^Isolation Orders^1
"KRN",.404,588,40,1,2)
^^2,2
"KRN",.404,588,40,2,0)
2^Expanded Precaution Type^1
"KRN",.404,588,40,2,2)
^^2,41
"KRN",.404,589,0)
MMRSISLTORDEDIT2^104.05
"KRN",.404,589,40,0)
^.4044I^2^2
"KRN",.404,589,40,1,0)
1^^3
"KRN",.404,589,40,1,1)
.01
"KRN",.404,589,40,1,2)
1,2^36
"KRN",.404,589,40,2,0)
2^^3
"KRN",.404,589,40,2,1)
1
"KRN",.404,589,40,2,2)
1,41^35
"KRN",19,20689,-1)
0^7
"KRN",19,20689,0)
MMRS MRSA PARAMETER SETUP^MRSA Tools Parameter Setup (Main)^^R^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20689,1,0)
^19.06^3^3^3090831^^
"KRN",19,20689,1,1,0)
This option is used to add/edit the parameters which will modify the 
"KRN",19,20689,1,2,0)
operation of the MRSA Program Tools application. This option defines the 
"KRN",19,20689,1,3,0)
division(s) and business rules for MRSA nares screening.
"KRN",19,20689,25)
DIV^MMRSIPCP
"KRN",19,20689,30)

"KRN",19,20689,31)

"KRN",19,20689,50)

"KRN",19,20689,51)

"KRN",19,20689,99.1)
61572,33678
"KRN",19,20689,"U")
MRSA TOOLS PARAMETER SETUP (MA
"KRN",19,20690,-1)
0^5
"KRN",19,20690,0)
MMRS MRSA LAB PARAMETER SETUP^MRSA Tools Lab Parameter Setup^^R^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20690,1,0)
^^4^4^3090304^
"KRN",19,20690,1,1,0)
This option allows the user to define parameters for the multi-drug 
"KRN",19,20690,1,2,0)
resistant organism (MDRO) that is to be searched for.  This information 
"KRN",19,20690,1,3,0)
is used to obtain prior history of MRSA and to display precaution 
"KRN",19,20690,1,4,0)
measures for the selected organism(s).
"KRN",19,20690,25)
LAB^MMRSIPCP
"KRN",19,20690,30)

"KRN",19,20690,31)

"KRN",19,20690,40)

"KRN",19,20690,41)

"KRN",19,20690,"U")
MRSA TOOLS LAB PARAMETER SETUP
"KRN",19,20691,-1)
0^8
"KRN",19,20691,0)
MMRS MRSA TOOLS SETUP MENU^MRSA Tools Setup Menu^^M^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20691,10,0)
^19.01IP^5^5
"KRN",19,20691,10,1,0)
20689^1^1
"KRN",19,20691,10,1,"^")
MMRS MRSA PARAMETER SETUP
"KRN",19,20691,10,2,0)
20690^2^2
"KRN",19,20691,10,2,"^")
MMRS MRSA LAB PARAMETER SETUP
"KRN",19,20691,10,3,0)
20692^3^3
"KRN",19,20691,10,3,"^")
MMRS MRSA WARD MAPPING SETUP
"KRN",19,20691,10,4,0)
20693^4^4
"KRN",19,20691,10,4,"^")
MMRS MRSA MDRO HIST DAYS EDIT
"KRN",19,20691,10,5,0)
20712^5^5
"KRN",19,20691,10,5,"^")
MMRS ISLT ORD EDIT
"KRN",19,20691,99)
61604,57635
"KRN",19,20691,99.1)
61662,79248
"KRN",19,20691,"U")
MRSA TOOLS SETUP MENU
"KRN",19,20692,-1)
0^9
"KRN",19,20692,0)
MMRS MRSA WARD MAPPING SETUP^MRSA Tools Ward Mapping Setup^^R^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20692,1,0)
^^2^2^3090304^
"KRN",19,20692,1,1,0)
This option allows the user to define geographical units for the 
"KRN",19,20692,1,2,0)
division(s). It will allow the user to map units together.
"KRN",19,20692,25)
WARDMAP^MMRSIPCP
"KRN",19,20692,"U")
MRSA TOOLS WARD MAPPING SETUP
"KRN",19,20693,-1)
0^6
"KRN",19,20693,0)
MMRS MRSA MDRO HIST DAYS EDIT^MDRO Historical Days Edit^^R^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20693,1,0)
^^2^2^3090304^
"KRN",19,20693,1,1,0)
This option allows the user to define the timeframe to search the history 
"KRN",19,20693,1,2,0)
of the selected MDRO for the MRSA Tools Isolation Report.
"KRN",19,20693,25)
HISTDAY^MMRSIPCP
"KRN",19,20693,30)

"KRN",19,20693,31)

"KRN",19,20693,50)

"KRN",19,20693,51)

"KRN",19,20693,"U")
MDRO HISTORICAL DAYS EDIT
"KRN",19,20712,-1)
0^1
"KRN",19,20712,0)
MMRS ISLT ORD EDIT^Isolation Orders Add/Edit^^R^^MMRS SETUP^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20712,1,0)
^^3^3^3090227^
"KRN",19,20712,1,1,0)
This option will allow you to enter the orders at your site that are used 
"KRN",19,20712,1,2,0)
for isolation purposes. This will be used to populate the MRSA Tools 
"KRN",19,20712,1,3,0)
Isolation Report.
"KRN",19,20712,25)
ISLTORD^MMRSIPCP
"KRN",19,20712,30)

"KRN",19,20712,31)

"KRN",19,20712,50)

"KRN",19,20712,51)

"KRN",19,20712,"U")
ISOLATION ORDERS ADD/EDIT
"KRN",19,20713,-1)
0^4
"KRN",19,20713,0)
MMRS MRSA IPEC REPORT^Print MRSA IPEC Report^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20713,1,0)
^^3^3^3090304^
"KRN",19,20713,1,1,0)
This option allows the user to print the MRSA IPEC report. The report can
"KRN",19,20713,1,2,0)
be run for the division or for a specific unit(s). It allows you to select
"KRN",19,20713,1,3,0)
either the Admission Report or the Discharge/Transmission report.
"KRN",19,20713,25)
MMRSIPC
"KRN",19,20713,"U")
PRINT MRSA IPEC REPORT
"KRN",19,20714,-1)
0^2
"KRN",19,20714,0)
MMRS ISOLATION REPORT^Print Isolation Report^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20714,1,0)
^^4^4^3090304^
"KRN",19,20714,1,1,0)
This option allows the user to print the Isolation Report for each unit.  
"KRN",19,20714,1,2,0)
The report includes MDROs selected in the initial setup and the historical
"KRN",19,20714,1,3,0)
timeframe to search for the last positive result.  Isolation Orders will
"KRN",19,20714,1,4,0)
print on the report, if they are utilized by the site.
"KRN",19,20714,25)
MMRSISL
"KRN",19,20714,99.1)
61663,44348
"KRN",19,20714,"U")
PRINT ISOLATION REPORT
"KRN",19,20715,-1)
0^10
"KRN",19,20715,0)
MMRS NARES SWAB LIST^Print Nares Screen Compliance List^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20715,1,0)
^^3^3^3090304^
"KRN",19,20715,1,1,0)
This option allows the user to print a report to capture the patient on a 
"KRN",19,20715,1,2,0)
unit at a given time and if a nares screen was ordered upon admission to 
"KRN",19,20715,1,3,0)
the unit.  This report prints real-time patient information for the unit.
"KRN",19,20715,25)
MMRSORD
"KRN",19,20715,"U")
PRINT NARES SCREEN COMPLIANCE 
"KRN",19,20716,-1)
0^12
"KRN",19,20716,0)
MMRS REPORTS MENU^MRSA Tools Reports Menu^^M^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20716,10,0)
^19.01IP^3^3
"KRN",19,20716,10,1,0)
20713^1^1
"KRN",19,20716,10,1,"^")
MMRS MRSA IPEC REPORT
"KRN",19,20716,10,2,0)
20714^2^2
"KRN",19,20716,10,2,"^")
MMRS ISOLATION REPORT
"KRN",19,20716,10,3,0)
20715^3^3
"KRN",19,20716,10,3,"^")
MMRS NARES SWAB LIST
"KRN",19,20716,99)
61569,34601
"KRN",19,20716,99.1)
61662,79248
"KRN",19,20716,"U")
MRSA TOOLS REPORTS MENU
"KRN",19,20719,-1)
0^3
"KRN",19,20719,0)
MMRS ISOLATION REPORT (TASKED)^Print Isolation Report (Tasked)^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20719,1,0)
^^15^15^3090304^
"KRN",19,20719,1,1,0)
This option should not be run interactively - it should only be tasked to 
"KRN",19,20719,1,2,0)
run via Taskman. This option will print the isolation report. In order for
"KRN",19,20719,1,3,0)
it to run correctly, when the option is scheduled to run in Taskman via
"KRN",19,20719,1,4,0)
the option 'Schedule/Unschedule Options' [XUTM SCHEDULE], some variables
"KRN",19,20719,1,5,0)
need to be setup on Page 2.
"KRN",19,20719,1,6,0)
 
"KRN",19,20719,1,7,0)
The Variable Name 'MMRSDIV' should be added and its Value should be set to
"KRN",19,20719,1,8,0)
the IEN in file 104 for the Division this option is running for.
"KRN",19,20719,1,9,0)
 
"KRN",19,20719,1,10,0)
If the option will print the report for all locations, then 'MMRSLOC'
"KRN",19,20719,1,11,0)
should be added as a Variable Name and its Value should be set to '"ALL"'.
"KRN",19,20719,1,12,0)
If the option will only print for a few locations, then for each location
"KRN",19,20719,1,13,0)
that will be printed, a Variable Name should be added as follows:
"KRN",19,20719,1,14,0)
MMRSLOC(LOCIEN) (where LOCIEN is the geographical unit IEN from file 
"KRN",19,20719,1,15,0)
104.3) and its Value should be set to '""'.
"KRN",19,20719,25)
MAIN2^MMRSISL
"KRN",19,20719,200.9)
y
"KRN",19,20719,"U")
PRINT ISOLATION REPORT (TASKED
"KRN",19,20720,-1)
0^11
"KRN",19,20720,0)
MMRS NARES SWAB LIST (TASKED)^Print Nares Screen Compliance List (Tasked)^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20720,1,0)
^^15^15^3090304^
"KRN",19,20720,1,1,0)
This option should not be run interactively - it should only be tasked to
"KRN",19,20720,1,2,0)
run via Taskman. This option will print the Nares Screen Compliance List.
"KRN",19,20720,1,3,0)
In order for it to run correctly, when the option is scheduled to run in
"KRN",19,20720,1,4,0)
Taskman via the option 'Schedule/Unschedule Options' [XUTM SCHEDULE], some
"KRN",19,20720,1,5,0)
variables need to be setup on Page 2.
"KRN",19,20720,1,6,0)
  
"KRN",19,20720,1,7,0)
The Variable Name 'MMRSDIV' should be added and its Value should be set to
"KRN",19,20720,1,8,0)
the IEN in file 104 for the Division this option is running for.
"KRN",19,20720,1,9,0)
  
"KRN",19,20720,1,10,0)
If the option will print the report for all locations, then 'MMRSLOC' 
"KRN",19,20720,1,11,0)
should be added as a Variable Name and its Value should be set to
"KRN",19,20720,1,12,0)
'"ALL"'.  If the option will only print for a few locations, then for each
"KRN",19,20720,1,13,0)
location that will be printed, a Variable Name should be added as follows:
"KRN",19,20720,1,14,0)
MMRSLOC(LOCIEN) (where LOCIEN is the geographical unit IEN from file
"KRN",19,20720,1,15,0)
104.3) and its Value should be set to '""'.
"KRN",19,20720,25)
MAIN2^MMRSORD
"KRN",19,20720,200.9)
y
"KRN",19,20720,"U")
PRINT NARES SCREEN COMPLIANCE 
"KRN",19,20842,-1)
0^13
"KRN",19,20842,0)
MMRS MRSA IPEC AUTO-EXTRACT^MRSA IPEC Auto-Extract (Tasked)^^R^^^^^^^^MRSA INITIATIVE REPORTS
"KRN",19,20842,1,0)
^^5^5^3090901^
"KRN",19,20842,1,1,0)
This option will auto-extract MRSA data for entry into the Inpatient 
"KRN",19,20842,1,2,0)
Evaluation Center (IPEC) for the previous month's MRSA prevalence and 
"KRN",19,20842,1,3,0)
transmission measures, via a MailMan message.  This option should be 
"KRN",19,20842,1,4,0)
scheduled to run once a month. This option should not be run
"KRN",19,20842,1,5,0)
interactively; it should only be tasked to run via TaskMan.
"KRN",19,20842,25)
TASK^MMRSIPC5
"KRN",19,20842,200.9)
y
"KRN",19,20842,"U")
MRSA IPEC AUTO-EXTRACT (TASKED
"KRN",19.1,835,-1)
0^1
"KRN",19.1,835,0)
MMRS SETUP^MRSA Tools Setup
"KRN",19.1,835,1,0)
^^2^2^3090302^
"KRN",19.1,835,1,1,0)
If a user has this key they are allowed to run the MRSA Tools Parameter 
"KRN",19.1,835,1,2,0)
Setup Menus and setup/change the system parameters.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",631,-1)
1^1
"PKG",631,0)
MRSA INITIATIVE REPORTS^MMRS^MRSA PREVENTION INITIATIVE
"PKG",631,1,0)
^^8^8^3090427^
"PKG",631,1,1,0)
VHA Directive 2007-002, MRSA Prevention Initiative, requires facilities to
"PKG",631,1,2,0)
screen patients on Admission, subsequent Transfer(s), and Discharge.
"PKG",631,1,3,0)
Facilities are required to report compliance rates with Nares Screening on
"PKG",631,1,4,0)
Admission to the Facility and Unit(s) and on Discharge.  This information
"PKG",631,1,5,0)
also determines the Prevalence and Transmission rates of MRSA.  Data is
"PKG",631,1,6,0)
reported monthly to the Inpatient Evaluation Center (IPEC). The purpose
"PKG",631,1,7,0)
ofthe software will allow facilities to extract MRSA data for reporting
"PKG",631,1,8,0)
purposes.
"PKG",631,5)
HPS PEO
"PKG",631,7)
^^I
"PKG",631,20,0)
^9.402P^^
"PKG",631,22,0)
^9.49I^1^1
"PKG",631,22,1,0)
1.0^3091030^3090727^41493
"PKG",631,"DEV")
TEITELBAUM/MIAMI
"PKG",631,"VERSION")
1.0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","MMRSIPC")
0^1^B96473573
"RTN","MMRSIPC",1,0)
MMRSIPC ;MIA/LMT - Print MRSA IPEC Report ;10-20-06
"RTN","MMRSIPC",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSIPC",3,0)
 ;
"RTN","MMRSIPC",4,0)
 ;This is the main routine to print the MRSA IPEC Report. 
"RTN","MMRSIPC",5,0)
 ;This routine uses functions contained in MMRSIPC2, MMRSIPC3, and MMRSIPC4.
"RTN","MMRSIPC",6,0)
MAIN ;
"RTN","MMRSIPC",7,0)
 N NUMDIV,MMRSDIV,MMRSLOC,EXTFLG,STRTDT,ENDDT,PRTSUM,BYADM
"RTN","MMRSIPC",8,0)
 D CHECK
"RTN","MMRSIPC",9,0)
 D CHECK2
"RTN","MMRSIPC",10,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPC",11,0)
 W !
"RTN","MMRSIPC",12,0)
 S MMRSDIV=$$GETDIV Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPC",13,0)
 D CHECK3
"RTN","MMRSIPC",14,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPC",15,0)
 D PROMPT Q:$D(EXTFLG)
"RTN","MMRSIPC",16,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSIPC",17,0)
 K MMRSSUM
"RTN","MMRSIPC",18,0)
 Q
"RTN","MMRSIPC",19,0)
CHECK ;Check if parameters are setup
"RTN","MMRSIPC",20,0)
 N NUMDIV,MMRSDIV
"RTN","MMRSIPC",21,0)
 S NUMDIV=0
"RTN","MMRSIPC",22,0)
 S MMRSDIV=0 F  S MMRSDIV=$O(^MMRS(104,MMRSDIV)) Q:'MMRSDIV  I $D(^MMRS(104,MMRSDIV,0)) S NUMDIV=NUMDIV+1
"RTN","MMRSIPC",23,0)
 I NUMDIV=0 D
"RTN","MMRSIPC",24,0)
 .W !!,"   >>> Make sure a division has been setup using option:"
"RTN","MMRSIPC",25,0)
 .W !,"          'MRSA Tools Parameter Setup (Main)'"
"RTN","MMRSIPC",26,0)
 .S EXTFLG=1
"RTN","MMRSIPC",27,0)
 Q
"RTN","MMRSIPC",28,0)
CHECK2 ;Check if lab tests and etiologies are setup
"RTN","MMRSIPC",29,0)
 N TSTSTP,MRSAETIO,MRSASTAP,ORG,ETIONAME,MMRSET,MMRSI
"RTN","MMRSIPC",30,0)
 S TSTSTP=0
"RTN","MMRSIPC",31,0)
 I $D(^LAB(60,"B","MRSA SURVL NARES DNA"))!($D(^LAB(60,"B","MRSA SURVL NARES AGAR"))) S TSTSTP=1
"RTN","MMRSIPC",32,0)
 I $O(^LAB(60,"B","MRSA SURVL NARES DNA"))["MRSA SURVL NARES DNA" S TSTSTP=1
"RTN","MMRSIPC",33,0)
 I $O(^LAB(60,"B","MRSA SURVL NARES AGAR"))["MRSA SURVL NARES AGAR" S TSTSTP=1
"RTN","MMRSIPC",34,0)
 I 'TSTSTP D
"RTN","MMRSIPC",35,0)
 .S EXTFLG=1
"RTN","MMRSIPC",36,0)
 .W !!,"   >>> Make sure the MRSA CH-subscripted tests have been setup according"
"RTN","MMRSIPC",37,0)
 .W !,"       to the National Guidelines. Laboratory needs to setup at least"
"RTN","MMRSIPC",38,0)
 .W !,"       one of these lab tests in the system before generating reports:"
"RTN","MMRSIPC",39,0)
 .W !,"          1. 'MRSA SURVL NARES DNA'"
"RTN","MMRSIPC",40,0)
 .W !,"          2. 'MRSA SURVL NARES AGAR'"
"RTN","MMRSIPC",41,0)
 S MRSAETIO=0
"RTN","MMRSIPC",42,0)
 ;S MRSASTAP="STAPHYLOCOCCUS AUREUS METH" F  S MRSASTAP=$O(^LAB(61.2,"B",MRSASTAP)) Q:MRSASTAP=""!(MRSASTAP]"STAPHYLOCOCCUS AUREUSZ")  D
"RTN","MMRSIPC",43,0)
 ;.S ORG=0 F  S ORG=$O(^LAB(61.2,"B",MRSASTAP,ORG)) Q:'ORG  D
"RTN","MMRSIPC",44,0)
 ;..S ETIONAME=$P($G(^LAB(61.2,ORG,0)),U,1)
"RTN","MMRSIPC",45,0)
 ;..I ETIONAME["STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT (MRSA)" S MRSAETIO=ORG
"RTN","MMRSIPC",46,0)
 D FIND^DIC(61.2,,".01E;@","PM","STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT",,"B",,,"MMRSET")
"RTN","MMRSIPC",47,0)
 S MMRSI="" F  S MMRSI=$O(MMRSET("DILIST",MMRSI)) Q:MMRSI=""  I +MMRSI>0  D
"RTN","MMRSIPC",48,0)
 .S ETIONAME=$P($G(MMRSET("DILIST",MMRSI,0)),U,2)
"RTN","MMRSIPC",49,0)
 .S ORG=$P($G(MMRSET("DILIST",MMRSI,0)),U,1)
"RTN","MMRSIPC",50,0)
 .I ETIONAME["STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT" S MRSAETIO=ORG
"RTN","MMRSIPC",51,0)
 I 'MRSAETIO D
"RTN","MMRSIPC",52,0)
 .S EXTFLG=1
"RTN","MMRSIPC",53,0)
 .W !!,"   >>> Make sure the Etiology has been setup according "
"RTN","MMRSIPC",54,0)
 .W !,"       to the National Guidelines. The following etiology "
"RTN","MMRSIPC",55,0)
 .W !,"       must be added to the Etiology Field file (#61.2):"
"RTN","MMRSIPC",56,0)
 .W !,"          'STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT (MRSA)' "
"RTN","MMRSIPC",57,0)
 Q
"RTN","MMRSIPC",58,0)
CHECK3 ;Check if Ward Mappings have been setup for this division
"RTN","MMRSIPC",59,0)
 N NUMLOC,MMRSLOC
"RTN","MMRSIPC",60,0)
 S NUMLOC=0
"RTN","MMRSIPC",61,0)
 S MMRSLOC=0 F  S MMRSLOC=$O(^MMRS(104.3,MMRSLOC)) Q:'MMRSLOC  I $P($G(^MMRS(104.3,MMRSLOC,0)),U,2)=MMRSDIV S NUMLOC=NUMLOC+1
"RTN","MMRSIPC",62,0)
 I NUMLOC=0 W !!,"   >>> Make sure the Ward Mappings for each Geographical Unit has been setup.",!! S EXTFLG=1
"RTN","MMRSIPC",63,0)
 Q
"RTN","MMRSIPC",64,0)
MAIN2 ; Entry for queuing
"RTN","MMRSIPC",65,0)
 D CLEAN ;Kill Temp Global
"RTN","MMRSIPC",66,0)
 D GETPARAM ; Load parameters in temp global
"RTN","MMRSIPC",67,0)
 D GETMOVE^MMRSIPC2 ;Get movements and store in temp global
"RTN","MMRSIPC",68,0)
 D GETLABS^MMRSIPC3 ;Get swabbing rates and MRSA history and store in temp global
"RTN","MMRSIPC",69,0)
 I 'BYADM D PATDAYS ;Get patient days of care
"RTN","MMRSIPC",70,0)
 D PRINT^MMRSIPC4 ;Print report
"RTN","MMRSIPC",71,0)
 D CLEAN ;Kill Temp Global
"RTN","MMRSIPC",72,0)
 Q
"RTN","MMRSIPC",73,0)
CLEAN ;
"RTN","MMRSIPC",74,0)
 K ^TMP($J,"MMRSIPC")
"RTN","MMRSIPC",75,0)
 Q
"RTN","MMRSIPC",76,0)
GETDIV() ;Prompt user to select Division
"RTN","MMRSIPC",77,0)
 N MMRSDIV,COUNT,DIV,DIC,Y,DLAYGO,X,DTOUT,DUOUT
"RTN","MMRSIPC",78,0)
 S MMRSDIV=""
"RTN","MMRSIPC",79,0)
 S COUNT=0,DIV=0 F  S DIV=$O(^MMRS(104,DIV)) Q:'DIV  S COUNT=COUNT+1
"RTN","MMRSIPC",80,0)
 I COUNT=1 S MMRSDIV=$O(^MMRS(104,0)) Q MMRSDIV
"RTN","MMRSIPC",81,0)
 S DIC="^DG(40.8,"
"RTN","MMRSIPC",82,0)
 S DIC(0)="AEMQ"
"RTN","MMRSIPC",83,0)
 S DIC("A")="Select the Division: "
"RTN","MMRSIPC",84,0)
 S DIC("S")="I $D(^MMRS(104,""B"",Y))"
"RTN","MMRSIPC",85,0)
 D ^DIC K DIC
"RTN","MMRSIPC",86,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q ""
"RTN","MMRSIPC",87,0)
 S MMRSDIV=+Y
"RTN","MMRSIPC",88,0)
 S MMRSDIV=$O(^MMRS(104,"B",MMRSDIV,0))
"RTN","MMRSIPC",89,0)
 Q MMRSDIV
"RTN","MMRSIPC",90,0)
PROMPT ;Prompts user for start date, end date, locations, and if user wants to only print the Summary Report.
"RTN","MMRSIPC",91,0)
 ;Prompt if should run report by Admission or Discharge
"RTN","MMRSIPC",92,0)
 N DIR,DIRUT,PRMPTTXT,Y
"RTN","MMRSIPC",93,0)
 S DIR(0)="S^A:Admission Report;D:Discharge/Transmission Report"
"RTN","MMRSIPC",94,0)
 S DIR("A")="Run (A)dmission Or (D)ischarge/Transmission Report"
"RTN","MMRSIPC",95,0)
 D ^DIR K DIR
"RTN","MMRSIPC",96,0)
 I $D(DIRUT) S EXTFLG=1 Q 
"RTN","MMRSIPC",97,0)
 I Y="A" S BYADM=1,PRMPTTXT="ward admission"
"RTN","MMRSIPC",98,0)
 I Y="D" S BYADM=0,PRMPTTXT="ward discharge"
"RTN","MMRSIPC",99,0)
DATE ;Prompts user for date range
"RTN","MMRSIPC",100,0)
 N %DT,X
"RTN","MMRSIPC",101,0)
 K Y
"RTN","MMRSIPC",102,0)
 W ! S %DT="AEPX",%DT("A")="Begin with "_PRMPTTXT_" date: " D ^%DT
"RTN","MMRSIPC",103,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSIPC",104,0)
 S STRTDT=Y
"RTN","MMRSIPC",105,0)
 S %DT("A")="End with "_PRMPTTXT_" date: " D ^%DT
"RTN","MMRSIPC",106,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSIPC",107,0)
 S ENDDT=Y
"RTN","MMRSIPC",108,0)
 I '$P(ENDDT,".",2) S ENDDT=Y+.24
"RTN","MMRSIPC",109,0)
 I ENDDT<STRTDT W !!,"The ending date of the range must be later than the starting date." G DATE
"RTN","MMRSIPC",110,0)
LOC ;Prompts user for locations
"RTN","MMRSIPC",111,0)
 W !
"RTN","MMRSIPC",112,0)
 S DIR(0)="YA",DIR("A")="Do you want to select all locations? ",DIR("B")="NO"
"RTN","MMRSIPC",113,0)
 D ^DIR K DIR
"RTN","MMRSIPC",114,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSIPC",115,0)
 I Y=1 D  G SUMRPT
"RTN","MMRSIPC",116,0)
 .S Y=0 F  S Y=$O(^MMRS(104.3,Y)) Q:'Y  I $P($G(^MMRS(104.3,Y,0)),U,2)=MMRSDIV S MMRSLOC(Y)=""
"RTN","MMRSIPC",117,0)
 ;PROMPT FOR WARDS
"RTN","MMRSIPC",118,0)
 N DIC,DLAYGO,DTOUT,DUOUT
"RTN","MMRSIPC",119,0)
 W !
"RTN","MMRSIPC",120,0)
 S DIC("A")="Select Geographical Location: "
"RTN","MMRSIPC",121,0)
 S DIC("S")="I $P($G(^MMRS(104.3,Y,0)),U,2)="_MMRSDIV
"RTN","MMRSIPC",122,0)
 S DIC="^MMRS(104.3,",DIC(0)="QEAM" D ^DIC
"RTN","MMRSIPC",123,0)
 I (Y=-1)!($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPC",124,0)
 S MMRSLOC(+Y)=""
"RTN","MMRSIPC",125,0)
 S DIC("A")="Select another Geographical Location: " F  D ^DIC Q:Y=-1  S MMRSLOC(+Y)=""
"RTN","MMRSIPC",126,0)
 K DIC
"RTN","MMRSIPC",127,0)
 I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPC",128,0)
SUMRPT ;Prompt user if should only run the summary report.
"RTN","MMRSIPC",129,0)
 I $G(MMRSSUM) S PRTSUM=1 Q  ; IF OPTION IS ONLY FOR SUMMARY REPORT...
"RTN","MMRSIPC",130,0)
 W !
"RTN","MMRSIPC",131,0)
 S DIR(0)="Y"
"RTN","MMRSIPC",132,0)
 S DIR("A")="Do you want to only print the summary report"
"RTN","MMRSIPC",133,0)
 S DIR("B")="NO"
"RTN","MMRSIPC",134,0)
 D ^DIR K DIR
"RTN","MMRSIPC",135,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSIPC",136,0)
 S PRTSUM=Y
"RTN","MMRSIPC",137,0)
 Q
"RTN","MMRSIPC",138,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSIPC",139,0)
 N MMRSVAR,ZTSK
"RTN","MMRSIPC",140,0)
 W !! W:'PRTSUM !,"This report is designed for a 176 column format (landscape).",!
"RTN","MMRSIPC",141,0)
 S MMRSVAR("STRTDT")="",MMRSVAR("ENDDT")="",MMRSVAR("MMRSLOC(")=""
"RTN","MMRSIPC",142,0)
 S MMRSVAR("PRTSUM")="",MMRSVAR("BYADM")="",MMRSVAR("MMRSDIV")=""
"RTN","MMRSIPC",143,0)
 D EN^XUTMDEVQ("MAIN2^MMRSIPC","PRINT MRSA IPEC REPORT",.MMRSVAR,"QM",1)
"RTN","MMRSIPC",144,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSIPC",145,0)
 Q
"RTN","MMRSIPC",146,0)
GETPARAM ;(MDRO) ; Loads lab search/extract parameters from file 104.1
"RTN","MMRSIPC",147,0)
 N MRSAMDRO,TSTNM,TST,MDRO,TEST,IEN,TIEN,ITOP,TOP,ETOP,IBACT,BACT,EBACT
"RTN","MMRSIPC",148,0)
 N ETIOL,ETIOLOGY,ANTI,ANTIM,INC,MRSASTAP,ETIONAME,MMRSI,MMRSET,ORG
"RTN","MMRSIPC",149,0)
 S MRSAMDRO=$O(^MMRS(104.2,"B","MRSA",0))
"RTN","MMRSIPC",150,0)
 S INC=0
"RTN","MMRSIPC",151,0)
 S TSTNM="MRSA SURVL NARES DN"
"RTN","MMRSIPC",152,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES DNA~zzz")  D
"RTN","MMRSIPC",153,0)
 .I TSTNM'["MRSA SURVL NARES DNA" Q
"RTN","MMRSIPC",154,0)
 .S TST=0 F  S TST=$O(^LAB(60,"B",TSTNM,TST)) Q:'TST  D
"RTN","MMRSIPC",155,0)
 ..S INC=INC+1
"RTN","MMRSIPC",156,0)
 ..S ^TMP($J,"MMRSIPC","T","MRSA_SCREEN",TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",157,0)
 ..S ^TMP($J,"MMRSIPC","T",MRSAMDRO,TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",158,0)
 S TSTNM="MRSA SURVL NARES AGA"
"RTN","MMRSIPC",159,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES AGAR~zzz")  D
"RTN","MMRSIPC",160,0)
 .I TSTNM'["MRSA SURVL NARES AGAR" Q
"RTN","MMRSIPC",161,0)
 .S TST=0 F  S TST=$O(^LAB(60,"B",TSTNM,TST)) Q:'TST  D
"RTN","MMRSIPC",162,0)
 ..S INC=INC+1
"RTN","MMRSIPC",163,0)
 ..S ^TMP($J,"MMRSIPC","T","MRSA_SCREEN",TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",164,0)
 ..S ^TMP($J,"MMRSIPC","T",MRSAMDRO,TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",165,0)
 S TSTNM="MRSA SURVL OTHER DN"
"RTN","MMRSIPC",166,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL OTHER DNA~zzz")  D
"RTN","MMRSIPC",167,0)
 .I TSTNM'["MRSA SURVL OTHER DNA" Q
"RTN","MMRSIPC",168,0)
 .S TST=0 F  S TST=$O(^LAB(60,"B",TSTNM,TST)) Q:'TST  D
"RTN","MMRSIPC",169,0)
 ..S INC=INC+1
"RTN","MMRSIPC",170,0)
 ..S ^TMP($J,"MMRSIPC","T","MRSA_SURV",TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",171,0)
 ..S ^TMP($J,"MMRSIPC","T",MRSAMDRO,TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",172,0)
 S TSTNM="MRSA SURVL OTHER AGA"
"RTN","MMRSIPC",173,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL OTHER AGAR~zzz")  D
"RTN","MMRSIPC",174,0)
 .I TSTNM'["MRSA SURVL OTHER AGAR" Q
"RTN","MMRSIPC",175,0)
 .S TST=0 F  S TST=$O(^LAB(60,"B",TSTNM,TST)) Q:'TST  D
"RTN","MMRSIPC",176,0)
 ..S INC=INC+1
"RTN","MMRSIPC",177,0)
 ..S ^TMP($J,"MMRSIPC","T","MRSA_SURV",TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",178,0)
 ..S ^TMP($J,"MMRSIPC","T",MRSAMDRO,TST_"_"_INC,0)="2^POS"
"RTN","MMRSIPC",179,0)
 S IEN="" F  S IEN=$O(^MMRS(104.1,"D",MMRSDIV,IEN)) Q:'IEN  D
"RTN","MMRSIPC",180,0)
 .S MDRO=$P($G(^MMRS(104.1,IEN,0)),U,1)
"RTN","MMRSIPC",181,0)
 .Q:'MDRO
"RTN","MMRSIPC",182,0)
 .S TIEN=0 F  S TIEN=$O(^MMRS(104.1,IEN,3,TIEN)) Q:'TIEN  D
"RTN","MMRSIPC",183,0)
 ..S TEST=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,1)
"RTN","MMRSIPC",184,0)
 ..Q:'TEST
"RTN","MMRSIPC",185,0)
 ..S INC=INC+1
"RTN","MMRSIPC",186,0)
 ..S ^TMP($J,"MMRSIPC","T",MDRO,TEST_"_"_INC,0)=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,2,3)
"RTN","MMRSIPC",187,0)
 .;S ITOP=0 F  S ITOP=$O(^MMRS(104.1,IEN,1,ITOP)) Q:'ITOP  D
"RTN","MMRSIPC",188,0)
 .;.S TOP=$G(^MMRS(104.1,IEN,1,ITOP,0))
"RTN","MMRSIPC",189,0)
 .;.I TOP S ^TMP($J,"MMRSIPC","TOP",MDRO,"INC_TOP",TOP)=""
"RTN","MMRSIPC",190,0)
 .;S ETOP=0 F  S ETOP=$O(^MMRS(104.1,IEN,2,ETOP)) Q:'ETOP  D
"RTN","MMRSIPC",191,0)
 .;.S TOP=$G(^MMRS(104.1,IEN,2,ETOP,0))
"RTN","MMRSIPC",192,0)
 .;.I TOP S ^TMP($J,"MMRSIPC","TOP",MDRO,"EXC_TOP",TOP)=""
"RTN","MMRSIPC",193,0)
 .S IBACT=0 F  S IBACT=$O(^MMRS(104.1,IEN,4,IBACT)) Q:'IBACT  D
"RTN","MMRSIPC",194,0)
 ..S BACT=$G(^MMRS(104.1,IEN,4,IBACT,0))
"RTN","MMRSIPC",195,0)
 ..I BACT'="" S ^TMP($J,"MMRSIPC","BACT",MDRO,"INC_REMARK",IBACT)=BACT
"RTN","MMRSIPC",196,0)
 .S EBACT=0 F  S EBACT=$O(^MMRS(104.1,IEN,5,EBACT)) Q:'EBACT  D
"RTN","MMRSIPC",197,0)
 ..S BACT=$G(^MMRS(104.1,IEN,5,EBACT,0))
"RTN","MMRSIPC",198,0)
 ..I BACT'="" S ^TMP($J,"MMRSIPC","BACT",MDRO,"EXC_REMARK",EBACT)=BACT
"RTN","MMRSIPC",199,0)
 .S ETIOL=0 F  S ETIOL=$O(^MMRS(104.1,IEN,6,ETIOL)) Q:'ETIOL  D
"RTN","MMRSIPC",200,0)
 ..S ETIOLOGY=$G(^MMRS(104.1,IEN,6,ETIOL,0))
"RTN","MMRSIPC",201,0)
 ..Q:'ETIOLOGY
"RTN","MMRSIPC",202,0)
 ..S ^TMP($J,"MMRSIPC","ETIOL",MDRO,+ETIOLOGY)=""
"RTN","MMRSIPC",203,0)
 ..S ANTI=0 F  S ANTI=$O(^MMRS(104.1,IEN,6,ETIOL,1,ANTI)) Q:'ANTI  D
"RTN","MMRSIPC",204,0)
 ...S ANTIM=$P($G(^MMRS(104.1,IEN,6,ETIOL,1,ANTI,0)),U)
"RTN","MMRSIPC",205,0)
 ...I ANTIM S ^TMP($J,"MMRSIPC","ETIOL",MDRO,ETIOLOGY,ANTIM)=$P($G(^MMRS(104.1,IEN,6,ETIOL,1,ANTI,0)),U,2,3)
"RTN","MMRSIPC",206,0)
 D FIND^DIC(61.2,,".01E;@","PM","STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT",,"B",,,"MMRSET")
"RTN","MMRSIPC",207,0)
 S MMRSI="" F  S MMRSI=$O(MMRSET("DILIST",MMRSI)) Q:MMRSI=""  I +MMRSI>0  D
"RTN","MMRSIPC",208,0)
 .S ETIONAME=$P($G(MMRSET("DILIST",MMRSI,0)),U,2)
"RTN","MMRSIPC",209,0)
 .S ORG=$P($G(MMRSET("DILIST",MMRSI,0)),U,1)
"RTN","MMRSIPC",210,0)
 .I ETIONAME'["STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT" Q
"RTN","MMRSIPC",211,0)
 .K ^TMP($J,"MMRSIPC","ETIOL",MRSAMDRO,ORG)
"RTN","MMRSIPC",212,0)
 .S ^TMP($J,"MMRSIPC","ETIOL","MRSA_CULTURE",ORG)=""
"RTN","MMRSIPC",213,0)
 .S ^TMP($J,"MMRSIPC","ETIOL",MRSAMDRO,ORG)=""
"RTN","MMRSIPC",214,0)
 Q
"RTN","MMRSIPC",215,0)
PATDAYS ;Gets 'PATIENT DAYS OF CARE'.
"RTN","MMRSIPC",216,0)
 N TTLRSLT,SDT,EDT,LOC,RSLT,WLOC,WARD,PATDAYS,LOCNAME
"RTN","MMRSIPC",217,0)
 S TTLRSLT=0
"RTN","MMRSIPC",218,0)
 S SDT=$P(STRTDT,".")
"RTN","MMRSIPC",219,0)
 S EDT=$P(ENDDT,".")
"RTN","MMRSIPC",220,0)
 S LOC=0 F  S LOC=$O(MMRSLOC(LOC)) Q:'LOC  D
"RTN","MMRSIPC",221,0)
 .S RSLT=0
"RTN","MMRSIPC",222,0)
 .S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOC,1,WLOC)) Q:'WLOC  D
"RTN","MMRSIPC",223,0)
 ..S WARD=$P($G(^MMRS(104.3,LOC,1,WLOC,0)),U,1) I 'WARD Q
"RTN","MMRSIPC",224,0)
 ..S PATDAYS=$$GETPATDY(WARD,SDT,EDT)
"RTN","MMRSIPC",225,0)
 ..S RSLT=RSLT+PATDAYS,TTLRSLT=TTLRSLT+PATDAYS
"RTN","MMRSIPC",226,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,LOC,0)),U)
"RTN","MMRSIPC",227,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOCNAME),U,1)=RSLT
"RTN","MMRSIPC",228,0)
 S $P(^TMP($J,"MMRSIPC","DSUM"),U,1)=TTLRSLT
"RTN","MMRSIPC",229,0)
 Q
"RTN","MMRSIPC",230,0)
GETPATDY(WARD,SDT,EDT) ;Helper function for PATDAYS() - Gets Patient Days of care for specific ward
"RTN","MMRSIPC",231,0)
 N CENSUS,SCUMPD,ECUMPD
"RTN","MMRSIPC",232,0)
 I SDT>EDT Q 0
"RTN","MMRSIPC",233,0)
 I SDT<($$FY(EDT)_"1001") Q ($$GETPATDY(WARD,SDT,($$FY(EDT)_"0930"))+$$GETPATDY(WARD,($$FY(EDT)_"1001"),EDT))
"RTN","MMRSIPC",234,0)
 S CENSUS=$O(^DG(41.9,"B",WARD,0)) I 'CENSUS Q 0
"RTN","MMRSIPC",235,0)
 S SDT=$$FMADD^XLFDT(SDT,-1,0,0,0)
"RTN","MMRSIPC",236,0)
 S SCUMPD=$P($G(^DG(41.9,CENSUS,"C",SDT,0)),U,3)
"RTN","MMRSIPC",237,0)
 I EDT=$$DT^XLFDT S EDT=$$FMADD^XLFDT(EDT,-1,0,0,0)
"RTN","MMRSIPC",238,0)
 S ECUMPD=$P($G(^DG(41.9,CENSUS,"C",EDT,0)),U,3)
"RTN","MMRSIPC",239,0)
 I $E(SDT,4,7)="0930" S SCUMPD=0 ; IF LAST DAY OF FY
"RTN","MMRSIPC",240,0)
 Q ECUMPD-SCUMPD
"RTN","MMRSIPC",241,0)
FY(DATE) ;Helper function for GETPATDY - Gets fiscal year for the specified date
"RTN","MMRSIPC",242,0)
 I $E(DATE,4,7)>("1000"),$E(DATE,4,7)<("1232") Q $E(DATE,1,3)
"RTN","MMRSIPC",243,0)
 Q ($E(DATE,1,3)-1)
"RTN","MMRSIPC2")
0^2^B34845828
"RTN","MMRSIPC2",1,0)
MMRSIPC2 ;MIA/LMT - Print MRSA IPEC Report Cont. (Contains functions to collect patient movements) ;10-20-06 
"RTN","MMRSIPC2",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSIPC2",3,0)
 ;
"RTN","MMRSIPC2",4,0)
GETMOVE ;Collects ward movements for patients that were admitted or discharged in date range.
"RTN","MMRSIPC2",5,0)
 N LOC,DUPLOC,MMRSLOC2
"RTN","MMRSIPC2",6,0)
 S LOC=0 F  S LOC=$O(MMRSLOC(LOC)) Q:'LOC  D
"RTN","MMRSIPC2",7,0)
 .S DUPLOC=$$DUPLOC(LOC,.MMRSLOC)
"RTN","MMRSIPC2",8,0)
 .I 'DUPLOC S MMRSLOC2(LOC)=""
"RTN","MMRSIPC2",9,0)
 .I DUPLOC D
"RTN","MMRSIPC2",10,0)
 ..I BYADM D GETADM(LOC)
"RTN","MMRSIPC2",11,0)
 ..I 'BYADM D GETDIS(LOC)
"RTN","MMRSIPC2",12,0)
 ..I 'BYADM D GETNODIS(LOC) ;For discharge\transmission report show list of patients that have not been discharged yet
"RTN","MMRSIPC2",13,0)
 I '$D(MMRSLOC2) Q
"RTN","MMRSIPC2",14,0)
 I BYADM D GETADM(0)
"RTN","MMRSIPC2",15,0)
 I 'BYADM D GETDIS(0)
"RTN","MMRSIPC2",16,0)
 I 'BYADM D GETNODIS(0) ;For discharge\transmission report show list of patients that have not been discharged yet
"RTN","MMRSIPC2",17,0)
 Q
"RTN","MMRSIPC2",18,0)
GETADM(LOC) ;
"RTN","MMRSIPC2",19,0)
 N TT,MOVDT,MOVIFN,DFN,TRANTYPE,INWARD,INDATE,INIFN,INTT,OUTDATE,OUTIFN,OUTTT,NEXTIEN,LOCNAME,VAIP,INLOC
"RTN","MMRSIPC2",20,0)
 F TT=1,2 S MOVDT=STRTDT-.0000001 F  S MOVDT=$O(^DGPM("ATT"_TT,MOVDT)) Q:(MOVDT>ENDDT)!('MOVDT)  D
"RTN","MMRSIPC2",21,0)
 .S MOVIFN="" F  S MOVIFN=$O(^DGPM("ATT"_TT,MOVDT,MOVIFN)) Q:'MOVIFN  D
"RTN","MMRSIPC2",22,0)
 ..D KVA^VADPT S DFN=$P($G(^DGPM(MOVIFN,0)),"^",3),VAIP("E")=MOVIFN D IN5^VADPT
"RTN","MMRSIPC2",23,0)
 ..S TRANTYPE=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",24,0)
 ..I TRANTYPE<1!(TRANTYPE=3) Q
"RTN","MMRSIPC2",25,0)
 ..S INWARD=+VAIP(5)
"RTN","MMRSIPC2",26,0)
 ..I TRANTYPE=2,'$$CNGWARD(LOC,+VAIP(15,4),INWARD) Q
"RTN","MMRSIPC2",27,0)
 ..Q:$$EXCWARD(LOC,INWARD)
"RTN","MMRSIPC2",28,0)
 ..;SET GLOBAL
"RTN","MMRSIPC2",29,0)
 ..S INDATE=+VAIP(3)
"RTN","MMRSIPC2",30,0)
 ..S INIFN=MOVIFN
"RTN","MMRSIPC2",31,0)
 ..S INTT=TRANTYPE
"RTN","MMRSIPC2",32,0)
 ..S (OUTDATE,OUTIFN,OUTTT)=" "
"RTN","MMRSIPC2",33,0)
 ..F  Q:(VAIP(16)="")!(OUTIFN)  D
"RTN","MMRSIPC2",34,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=3 S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=3
"RTN","MMRSIPC2",35,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=2,$$CNGWARD(LOC,INWARD,+VAIP(16,4)) S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=2
"RTN","MMRSIPC2",36,0)
 ...Q:OUTIFN
"RTN","MMRSIPC2",37,0)
 ...S NEXTIEN=VAIP(16)
"RTN","MMRSIPC2",38,0)
 ...D KVA^VADPT
"RTN","MMRSIPC2",39,0)
 ...S VAIP("E")=NEXTIEN
"RTN","MMRSIPC2",40,0)
 ...D IN5^VADPT
"RTN","MMRSIPC2",41,0)
 ..S INLOC=$G(LOC)
"RTN","MMRSIPC2",42,0)
 ..I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",43,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",44,0)
 ..S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_OUTDATE_U_OUTIFN_U_OUTTT
"RTN","MMRSIPC2",45,0)
 D KVA^VADPT
"RTN","MMRSIPC2",46,0)
 Q
"RTN","MMRSIPC2",47,0)
GETDIS(LOC) ;
"RTN","MMRSIPC2",48,0)
 N TT,MOVDT,MOVIFN,DFN,TRANTYPE,OUTDATE,OUTIFN,OUTTT,INWARD,INDATE,INIFN,INTT,PREVIEN,INLOC,LOCNAME,VAIP
"RTN","MMRSIPC2",49,0)
 F TT=2,3 S MOVDT=STRTDT-.0000001 F  S MOVDT=$O(^DGPM("ATT"_TT,MOVDT)) Q:(MOVDT>ENDDT)!('MOVDT)  D
"RTN","MMRSIPC2",50,0)
 .S MOVIFN="" F  S MOVIFN=$O(^DGPM("ATT"_TT,MOVDT,MOVIFN)) Q:'MOVIFN  D
"RTN","MMRSIPC2",51,0)
 ..D KVA^VADPT S DFN=$P($G(^DGPM(MOVIFN,0)),"^",3),VAIP("E")=MOVIFN D IN5^VADPT
"RTN","MMRSIPC2",52,0)
 ..I +VAIP(2)=3,+VAIP(15,3)=2 Q  ;Ignore discharges that are immediate following an Authorized Absence
"RTN","MMRSIPC2",53,0)
 ..S TRANTYPE=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",54,0)
 ..I TRANTYPE<2 Q
"RTN","MMRSIPC2",55,0)
 ..I TRANTYPE=2,'$$CNGWARD(LOC,+VAIP(15,4),+VAIP(5)) Q
"RTN","MMRSIPC2",56,0)
 ..I $$EXCWARD(LOC,+VAIP(15,4)) Q
"RTN","MMRSIPC2",57,0)
 ..S OUTDATE=+VAIP(3)
"RTN","MMRSIPC2",58,0)
 ..S OUTIFN=MOVIFN
"RTN","MMRSIPC2",59,0)
 ..S OUTTT=TRANTYPE
"RTN","MMRSIPC2",60,0)
 ..S INWARD=+VAIP(15,4)
"RTN","MMRSIPC2",61,0)
 ..S (INDATE,INIFN,INTT)=""
"RTN","MMRSIPC2",62,0)
 ..F  Q:(VAIP(15)="")!(INIFN)  D
"RTN","MMRSIPC2",63,0)
 ...S PREVIEN=VAIP(15)
"RTN","MMRSIPC2",64,0)
 ...I $$TRANTYPE(+VAIP(15,3),+VAIP(15,2))=1 S INDATE=+VAIP(15,1),INIFN=VAIP(15),INTT=1 ;,INWARD=+VAIP(15,4)
"RTN","MMRSIPC2",65,0)
 ...I $$TRANTYPE(+VAIP(15,3),+VAIP(15,2))=2 D
"RTN","MMRSIPC2",66,0)
 ....D KVA^VADPT S VAIP("E")=PREVIEN D IN5^VADPT
"RTN","MMRSIPC2",67,0)
 ....I $$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)) S INDATE=+VAIP(3),INIFN=VAIP(1),INTT=2 ;,INWARD=+VAIP(16,4)
"RTN","MMRSIPC2",68,0)
 ...Q:INIFN
"RTN","MMRSIPC2",69,0)
 ...D KVA^VADPT
"RTN","MMRSIPC2",70,0)
 ...S VAIP("E")=PREVIEN
"RTN","MMRSIPC2",71,0)
 ...D IN5^VADPT
"RTN","MMRSIPC2",72,0)
 ..I '$G(INIFN) Q
"RTN","MMRSIPC2",73,0)
 ..S INLOC=$G(LOC)
"RTN","MMRSIPC2",74,0)
 ..I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",75,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",76,0)
 ..S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_OUTDATE_U_OUTIFN_U_OUTTT
"RTN","MMRSIPC2",77,0)
 D KVA^VADPT
"RTN","MMRSIPC2",78,0)
 Q
"RTN","MMRSIPC2",79,0)
GETNODIS(LOC) ;For Discharge/Transmission report, it adds patients that have not been discharged from the wards to the report
"RTN","MMRSIPC2",80,0)
 N WARD,DFN,TMP,EDT,TT,SDT,INWARD,IEN,INDATE,INTT,INIFN,INLOC,LOCNAME,VAIP
"RTN","MMRSIPC2",81,0)
 S WARD="" F  S WARD=$O(^DPT("CN",WARD)) Q:WARD=""  D
"RTN","MMRSIPC2",82,0)
 .S DFN=0 F  S DFN=$O(^DPT("CN",WARD,DFN)) Q:'DFN  S TMP(DFN)=""
"RTN","MMRSIPC2",83,0)
 S EDT=$$NOW^XLFDT
"RTN","MMRSIPC2",84,0)
 F TT=1:1:3 S SDT=ENDDT F  S SDT=$O(^DGPM("AMV"_TT,SDT)) Q:'SDT!(SDT>EDT)  D
"RTN","MMRSIPC2",85,0)
 .S DFN=0 F  S DFN=$O(^DGPM("AMV"_TT,SDT,DFN)) Q:'DFN  S TMP(DFN)=""
"RTN","MMRSIPC2",86,0)
 S DFN=0 F  S DFN=$O(TMP(DFN)) Q:'DFN  D
"RTN","MMRSIPC2",87,0)
 .D KVA^VADPT
"RTN","MMRSIPC2",88,0)
 .S VAIP("D")=ENDDT
"RTN","MMRSIPC2",89,0)
 .D IN5^VADPT
"RTN","MMRSIPC2",90,0)
 .I 'VAIP(1) Q
"RTN","MMRSIPC2",91,0)
 .S INWARD=+VAIP(5)
"RTN","MMRSIPC2",92,0)
 .Q:$$EXCWARD(LOC,INWARD)
"RTN","MMRSIPC2",93,0)
 .S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",94,0)
 .;F  Q:((+VAIP(2)=1)!(VAIP(15)="")!(+VAIP(5)'=+VAIP(15,4)))  D
"RTN","MMRSIPC2",95,0)
 .;F  Q:(((INTT=1)!(INTT=2))&((+VAIP(2)=1)!(VAIP(15)="")!($$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)))))  D
"RTN","MMRSIPC2",96,0)
 .F  Q:(INTT=1)!(INTT=2&$$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)))!(VAIP(15)="")  D
"RTN","MMRSIPC2",97,0)
 ..S IEN=+VAIP(15)
"RTN","MMRSIPC2",98,0)
 ..D KVA^VADPT
"RTN","MMRSIPC2",99,0)
 ..S VAIP("E")=IEN
"RTN","MMRSIPC2",100,0)
 ..D IN5^VADPT
"RTN","MMRSIPC2",101,0)
 ..S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",102,0)
 .I INTT<1!(INTT>2) Q
"RTN","MMRSIPC2",103,0)
 .S INDATE=+VAIP(3)
"RTN","MMRSIPC2",104,0)
 .S INIFN=+VAIP(1)
"RTN","MMRSIPC2",105,0)
 .;S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",106,0)
 .I '$G(INIFN) Q
"RTN","MMRSIPC2",107,0)
 .S INLOC=$G(LOC)
"RTN","MMRSIPC2",108,0)
 .I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",109,0)
 .S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",110,0)
 .S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN," ")=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_" "_U_"0"_U_" "
"RTN","MMRSIPC2",111,0)
 D KVA^VADPT
"RTN","MMRSIPC2",112,0)
 Q
"RTN","MMRSIPC2",113,0)
CNGWARD(LOC,WARD1,WARD2) ;Did patient change wards?
"RTN","MMRSIPC2",114,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD1,.MMRSLOC2)
"RTN","MMRSIPC2",115,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD1)),$D(^MMRS(104.3,LOC,1,"B",WARD2)) Q 0
"RTN","MMRSIPC2",116,0)
 Q 1
"RTN","MMRSIPC2",117,0)
EXCWARD(LOC,WARD) ;Is this ward excluded from the reports?
"RTN","MMRSIPC2",118,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD,.MMRSLOC2)
"RTN","MMRSIPC2",119,0)
 I LOC=0 Q 1
"RTN","MMRSIPC2",120,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD)) Q 0
"RTN","MMRSIPC2",121,0)
 Q 1
"RTN","MMRSIPC2",122,0)
DUPLOC(LOC,LCTNS) ;
"RTN","MMRSIPC2",123,0)
 N RSLT,WARD,LOC2
"RTN","MMRSIPC2",124,0)
 S RSLT=0
"RTN","MMRSIPC2",125,0)
 S WARD=0 F  S WARD=$O(^MMRS(104.3,LOC,1,"B",WARD)) Q:'WARD  D
"RTN","MMRSIPC2",126,0)
 .S LOC2=0 F  S LOC2=$O(LCTNS(LOC2)) Q:'LOC2  D
"RTN","MMRSIPC2",127,0)
 ..Q:LOC2=LOC
"RTN","MMRSIPC2",128,0)
 ..I $D(^MMRS(104.3,LOC2,1,"B",WARD)) S RSLT=1
"RTN","MMRSIPC2",129,0)
 Q RSLT
"RTN","MMRSIPC2",130,0)
GETLOC(WARD,LCTNS) ;
"RTN","MMRSIPC2",131,0)
 N RSLT,LOC
"RTN","MMRSIPC2",132,0)
 S RSLT=0
"RTN","MMRSIPC2",133,0)
 S LOC=0 F  S LOC=$O(LCTNS(LOC)) Q:'LOC!(RSLT)  D
"RTN","MMRSIPC2",134,0)
 .I $D(^MMRS(104.3,LOC,1,"B",WARD)) S RSLT=LOC
"RTN","MMRSIPC2",135,0)
 Q RSLT
"RTN","MMRSIPC2",136,0)
TRANTYPE(MOVTYPE,TRANTYPE) ;
"RTN","MMRSIPC2",137,0)
 I MOVTYPE=29!(MOVTYPE=46)!(MOVTYPE=5)!(MOVTYPE=6)!(MOVTYPE=7)!(MOVTYPE=47)!(MOVTYPE=27)!(MOVTYPE=33)!(MOVTYPE=3)!(MOVTYPE=22) Q -1
"RTN","MMRSIPC2",138,0)
 I MOVTYPE=42!(MOVTYPE=20)!(MOVTYPE=1)!(MOVTYPE=45)!(MOVTYPE=23)!(MOVTYPE=25)!(MOVTYPE=26) Q -1
"RTN","MMRSIPC2",139,0)
 I MOVTYPE=2!(MOVTYPE=43)!(MOVTYPE=13) Q 3
"RTN","MMRSIPC2",140,0)
 I MOVTYPE=14!(MOVTYPE=24)!(MOVTYPE=44) Q 1
"RTN","MMRSIPC2",141,0)
 Q TRANTYPE
"RTN","MMRSIPC3")
0^3^B103482398
"RTN","MMRSIPC3",1,0)
MMRSIPC3 ;MIA/LMT - Print MRSA Report Cont. (Contains functions to collect patient labs and swabbing rate) ;10-20-06
"RTN","MMRSIPC3",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSIPC3",3,0)
 ;
"RTN","MMRSIPC3",4,0)
GETLABS ;Gets all lab data for the report.
"RTN","MMRSIPC3",5,0)
 N MRSAMDRO,LOC,INDT,DFN,OUTDT,NARES24,NARES48,SURV48,CULT48,MRSA365,CULT365,KNOWMRSA,KNOWCULT,NARES24A,NARES48ASURV48A,NARES48A
"RTN","MMRSIPC3",6,0)
 N MRSAFR,MRSATO,MRSA365A,CULT365A,SURV48A,NARES24D,NARES48D,SURV48D,MRSACPRD,TRANS
"RTN","MMRSIPC3",7,0)
 S MRSAMDRO=$O(^MMRS(104.2,"B","MRSA",0))
"RTN","MMRSIPC3",8,0)
 S ^TMP($J,"MMRSIPC","DSUM")="0^0^0^0^0^0^0^0^0"
"RTN","MMRSIPC3",9,0)
 S LOC="" F  S LOC=$O(^TMP($J,"MMRSIPC","D",LOC)) Q:LOC=""  D
"RTN","MMRSIPC3",10,0)
 .S ^TMP($J,"MMRSIPC","DSUM",LOC)="0^0^0^0^0^0^0^0^0"
"RTN","MMRSIPC3",11,0)
 .S INDT=0 F  S INDT=$O(^TMP($J,"MMRSIPC","D",LOC,INDT)) Q:'INDT  D
"RTN","MMRSIPC3",12,0)
 ..S DFN=0 F  S DFN=$O(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN)) Q:'DFN  D
"RTN","MMRSIPC3",13,0)
 ...S OUTDT=0 F  S OUTDT=$O(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)) Q:OUTDT=""  D
"RTN","MMRSIPC3",14,0)
 ....I BYADM D
"RTN","MMRSIPC3",15,0)
 .....S NARES24=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-24),$$FMADD^XLFDT(INDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",16,0)
 .....S NARES48=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",17,0)
 .....S SURV48=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",18,0)
 .....I NARES48'["POS",SURV48["POS" S NARES48=SURV48
"RTN","MMRSIPC3",19,0)
 .....S CULT48=$P($$GETLAB(DFN,"MRSA_CULTURE",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2) ;$$GETMCULT(DFN,$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD")
"RTN","MMRSIPC3",20,0)
 .....S MRSA365=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(INDT,-365),INDT,"CD"),U,2)
"RTN","MMRSIPC3",21,0)
 .....I $P($G(^MMRS(104,MMRSDIV,0)),U,4)=0 D
"RTN","MMRSIPC3",22,0)
 ......S KNOWMRSA=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(INDT,-365),INDT,"RAD"),U,2)
"RTN","MMRSIPC3",23,0)
 .....S ^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)=^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)_U_NARES24_U_NARES48_U_CULT48_U_MRSA365
"RTN","MMRSIPC3",24,0)
 ....I 'BYADM D
"RTN","MMRSIPC3",25,0)
 .....S NARES24A=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-24),$$FMADD^XLFDT(INDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",26,0)
 .....S NARES48A=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",27,0)
 .....S SURV48A=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",28,0)
 .....I NARES48A'["POS",SURV48A["POS" S NARES48A=SURV48A
"RTN","MMRSIPC3",29,0)
 .....S MRSAFR=(INDT-10000) I STRTDT>INDT S MRSAFR=(STRTDT-10000) ;(ADM - 1 year) or  (START DT - 1 year) - whichever is later
"RTN","MMRSIPC3",30,0)
 .....S MRSATO=$$FMADD^XLFDT(INDT,0,48,0,0) I STRTDT>MRSATO S MRSATO=STRTDT ;(ADM + 48 HRS) OR (START DT) - WHICHEVER IS GREATER
"RTN","MMRSIPC3",31,0)
 .....S MRSA365A=$P($$GETLAB(DFN,MRSAMDRO,MRSAFR,MRSATO,"CD"),U,2)
"RTN","MMRSIPC3",32,0)
 .....S (NARES24D,NARES48D,SURV48D)=""
"RTN","MMRSIPC3",33,0)
 .....I OUTDT D
"RTN","MMRSIPC3",34,0)
 ......S NARES24D=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(OUTDT,0,-24),$$FMADD^XLFDT(OUTDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",35,0)
 ......S NARES48D=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(OUTDT,0,-48),$$FMADD^XLFDT(OUTDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",36,0)
 ......S SURV48D=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(OUTDT,0,-48),$$FMADD^XLFDT(OUTDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",37,0)
 ......I NARES48D'["POS",SURV48D["POS" S NARES48D=SURV48D
"RTN","MMRSIPC3",38,0)
 .....S MRSAFR=$$FMADD^XLFDT(INDT,0,48,0,0) I STRTDT>MRSAFR S MRSAFR=STRTDT ;(ADM + 48 HRS) OR (START DT) - WHICHEVER IS LATER
"RTN","MMRSIPC3",39,0)
 .....S MRSATO=ENDDT I +OUTDT S MRSATO=$$FMADD^XLFDT(OUTDT,0,48,0,0) ;(DIS + 48 HRS) OR (END DT) - WHICHEVER IS EARLIER
"RTN","MMRSIPC3",40,0)
 .....S MRSACPRD=$P($$GETLAB(DFN,MRSAMDRO,MRSAFR,MRSATO,"CD"),U,2)
"RTN","MMRSIPC3",41,0)
 .....I $P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,OUTDT D
"RTN","MMRSIPC3",42,0)
 ......S KNOWMRSA=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(OUTDT,-365),OUTDT,"RAD"),U,2)
"RTN","MMRSIPC3",43,0)
 .....S TRANS=""
"RTN","MMRSIPC3",44,0)
 .....I NARES48A'["POS",MRSA365A'["POS",(($G(NARES48D)["POS")!(MRSACPRD["POS")) S TRANS="T"
"RTN","MMRSIPC3",45,0)
 .....S ^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)=^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)_U_NARES24A_U_NARES48A_U_MRSA365A_U_$G(NARES24D)_U_$G(NARES48D)_U_MRSACPRD_U_TRANS
"RTN","MMRSIPC3",46,0)
 ....D PREV ;Calculate prevalence measures
"RTN","MMRSIPC3",47,0)
 Q
"RTN","MMRSIPC3",48,0)
PREV ;Calculate prevalence measures (summary report)
"RTN","MMRSIPC3",49,0)
 N LOCSUM,SUM,DATA,IND
"RTN","MMRSIPC3",50,0)
 S LOCSUM=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC3",51,0)
 S SUM=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC3",52,0)
 S DATA=$G(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT))
"RTN","MMRSIPC3",53,0)
 I BYADM D
"RTN","MMRSIPC3",54,0)
 .I $P(DATA,U,5)=1 D
"RTN","MMRSIPC3",55,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,1)=$P(LOCSUM,U,1)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,1)=$P(SUM,U,1)+1
"RTN","MMRSIPC3",56,0)
 ..I NARES24["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,2)=$P(LOCSUM,U,2)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,2)=$P(SUM,U,2)+1
"RTN","MMRSIPC3",57,0)
 ..I (NARES48["POS"!(MRSA365["POS")),CULT48'["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,3)=$P(LOCSUM,U,3)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,3)=$P(SUM,U,3)+1
"RTN","MMRSIPC3",58,0)
 ..I CULT48["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,4)=$P(LOCSUM,U,4)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,4)=$P(SUM,U,4)+1
"RTN","MMRSIPC3",59,0)
 .S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,5)=$P(LOCSUM,U,5)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,5)=$P(SUM,U,5)+1
"RTN","MMRSIPC3",60,0)
 .S IND=0
"RTN","MMRSIPC3",61,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,4)=1 S IND=1
"RTN","MMRSIPC3",62,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,4)=0,($P(DATA,U,5)=1!(KNOWMRSA'["POS")) S IND=1
"RTN","MMRSIPC3",63,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=0,$P(DATA,U,5)=1 S IND=1
"RTN","MMRSIPC3",64,0)
 .I IND D
"RTN","MMRSIPC3",65,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,6)=$P(LOCSUM,U,6)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,6)=$P(SUM,U,6)+1
"RTN","MMRSIPC3",66,0)
 ..I NARES24["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,7)=$P(LOCSUM,U,7)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,7)=$P(SUM,U,7)+1
"RTN","MMRSIPC3",67,0)
 .I (NARES48["POS"!(MRSA365["POS")),CULT48'["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSIPC3",68,0)
 .I CULT48["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,9)=$P(LOCSUM,U,9)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,9)=$P(SUM,U,9)+1
"RTN","MMRSIPC3",69,0)
 I 'BYADM D
"RTN","MMRSIPC3",70,0)
 .I $P(DATA,U,8)=3!($P(DATA,U,8)=2) D
"RTN","MMRSIPC3",71,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,2)=$P(LOCSUM,U,2)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,2)=$P(SUM,U,2)+1
"RTN","MMRSIPC3",72,0)
 ..S IND=0
"RTN","MMRSIPC3",73,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=1 S IND=1
"RTN","MMRSIPC3",74,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,KNOWMRSA'["POS" S IND=1
"RTN","MMRSIPC3",75,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=0,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,$P(DATA,U,8)=3,KNOWMRSA'["POS" S IND=1
"RTN","MMRSIPC3",76,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=0,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=1,$P(DATA,U,8)=3 S IND=1
"RTN","MMRSIPC3",77,0)
 ..I IND=1 D
"RTN","MMRSIPC3",78,0)
 ...S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,3)=$P(LOCSUM,U,3)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,3)=$P(SUM,U,3)+1
"RTN","MMRSIPC3",79,0)
 ...I NARES24D["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,4)=$P(LOCSUM,U,4)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,4)=$P(SUM,U,4)+1
"RTN","MMRSIPC3",80,0)
 .I TRANS="T" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,5)=$P(LOCSUM,U,5)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,5)=$P(SUM,U,5)+1
"RTN","MMRSIPC3",81,0)
 Q
"RTN","MMRSIPC3",82,0)
GETLAB(DFN,LRMDRO,LRSTART,LREND,LRDTTYP) ;RETURN YES/NO^RESULT
"RTN","MMRSIPC3",83,0)
 N LRRSLT,LRTST,TMPRSLT
"RTN","MMRSIPC3",84,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",85,0)
 I $G(DFN)=""!($G(LRMDRO)="")!($G(LRSTART)="")!($G(LREND)="") Q LRRSLT
"RTN","MMRSIPC3",86,0)
 ;GET CH RSLTS
"RTN","MMRSIPC3",87,0)
 S LRTST=0 F  S LRTST=$O(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST)) Q:'LRTST  D
"RTN","MMRSIPC3",88,0)
 .S TMPRSLT=$$GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP)
"RTN","MMRSIPC3",89,0)
 .I $P(LRRSLT,U)'="Y" S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",90,0)
 .I $P(TMPRSLT,U,2)["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>$P($P(TMPRSLT,"^",2),";",3))) D
"RTN","MMRSIPC3",91,0)
 ..S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",92,0)
 ;GET MI RSLTS
"RTN","MMRSIPC3",93,0)
 S TMPRSLT=$$GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP)
"RTN","MMRSIPC3",94,0)
 I $P(LRRSLT,U)'="Y" S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",95,0)
 I $P(TMPRSLT,U,2)["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>$P($P(TMPRSLT,"^",2),";",3))) D
"RTN","MMRSIPC3",96,0)
 .S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",97,0)
 Q LRRSLT
"RTN","MMRSIPC3",98,0)
GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP) ;RETURN YES^RESULT
"RTN","MMRSIPC3",99,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD
"RTN","MMRSIPC3",100,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",101,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSIPC3",102,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSIPC3",103,0)
 S LRDATE=LRSTART-.0000001
"RTN","MMRSIPC3",104,0)
 I LRDTTYP="RAD" S LRDATE=0,LRRADEND=LREND,LREND=9999999
"RTN","MMRSIPC3",105,0)
 F  S LRDATE=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE)) Q:'LRDATE!(LRDATE>LREND)  D
"RTN","MMRSIPC3",106,0)
 .S DAS=0 F  S DAS=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE,DAS)) Q:'DAS  D
"RTN","MMRSIPC3",107,0)
 ..S LRIDT=$P(DAS,";",3)
"RTN","MMRSIPC3",108,0)
 ..I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LRRADEND) Q
"RTN","MMRSIPC3",109,0)
 ..Q:$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3)=""
"RTN","MMRSIPC3",110,0)
 ..S LRSITE=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5)
"RTN","MMRSIPC3",111,0)
 ..;Q:$$SCRNTOP(LRSITE,LRMDRO)
"RTN","MMRSIPC3",112,0)
 ..;I $D(^LR(LRDFN,"CH",LRIDT,0)),$P(^LR(LRDFN,"CH",LRIDT,0),U,3) D
"RTN","MMRSIPC3",113,0)
 ..S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSIPC3",114,0)
 ..S TSTRSLT=$$CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST)
"RTN","MMRSIPC3",115,0)
 ..I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSIPC3",116,0)
 ...S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";CH")
"RTN","MMRSIPC3",117,0)
 Q LRRSLT
"RTN","MMRSIPC3",118,0)
GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP) ;RETURN YES^RESULT
"RTN","MMRSIPC3",119,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD,LRIEND
"RTN","MMRSIPC3",120,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",121,0)
 I '$D(^TMP($J,"MMRSIPC","BACT",LRMDRO,"INC_REMARK")),'$D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO)) Q LRRSLT
"RTN","MMRSIPC3",122,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSIPC3",123,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSIPC3",124,0)
 S LRIDT=(9999999-LREND)-.0000001
"RTN","MMRSIPC3",125,0)
 S LRIEND=9999999-LRSTART
"RTN","MMRSIPC3",126,0)
 I LRDTTYP="RAD" S LRIDT=0,LRIEND=99999999
"RTN","MMRSIPC3",127,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:'LRIDT!(LRIDT>LRIEND)  D
"RTN","MMRSIPC3",128,0)
 .I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LREND) Q
"RTN","MMRSIPC3",129,0)
 .;Q:$P($G(^LR(LRDFN,"MI",LRIDT,1)),U,2)'="F"
"RTN","MMRSIPC3",130,0)
 .S LRSITE=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,5)
"RTN","MMRSIPC3",131,0)
 .;Q:$$SCRNTOP(LRSITE,LRMDRO)
"RTN","MMRSIPC3",132,0)
 .;I $D(^LR(LRDFN,"MI",LRIDT,0)),$P(^LR(LRDFN,"MI",LRIDT,1),U) D
"RTN","MMRSIPC3",133,0)
 .S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSIPC3",134,0)
 .S TSTRSLT=$$MIRSLT(LRDFN,LRIDT,LRMDRO)
"RTN","MMRSIPC3",135,0)
 .I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSIPC3",136,0)
 ..S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSIPC3",137,0)
 Q LRRSLT
"RTN","MMRSIPC3",138,0)
CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSIPC3",139,0)
 N RESULT,LRLOC,LRND,LRPC,LRRES,LRIND,LRINDVAL,LRSPEC,LRLOW,LRHIG
"RTN","MMRSIPC3",140,0)
 S RESULT=""
"RTN","MMRSIPC3",141,0)
 S LRLOC=$P($G(^LAB(60,+LRTST,0)),U,5)
"RTN","MMRSIPC3",142,0)
 S LRND=$P(LRLOC,";",2) Q:+LRND'>0 RESULT
"RTN","MMRSIPC3",143,0)
 S LRPC=$P(LRLOC,";",3) Q:+LRPC'>0 RESULT
"RTN","MMRSIPC3",144,0)
 S LRRES=$P($G(^LR(LRDFN,"CH",LRIDT,LRND)),U,LRPC) Q:LRRES="" RESULT
"RTN","MMRSIPC3",145,0)
 S LRIND=$P($G(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST,0)),U,1)
"RTN","MMRSIPC3",146,0)
 S LRINDVAL=$P($G(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST,0)),U,2)
"RTN","MMRSIPC3",147,0)
 Q:LRIND="" RESULT
"RTN","MMRSIPC3",148,0)
 I LRIND=1 D  Q RESULT
"RTN","MMRSIPC3",149,0)
 .Q:'LRRES
"RTN","MMRSIPC3",150,0)
 .S LRSPEC=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5) Q:LRSPEC=""
"RTN","MMRSIPC3",151,0)
 .Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","MMRSIPC3",152,0)
 .S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^LAB(60,LRTST,1,LRSPEC,0),U,3)
"RTN","MMRSIPC3",153,0)
 .Q:'LRLOW!('LRHIG)
"RTN","MMRSIPC3",154,0)
 .I LRRES<LRLOW!(LRRES>LRHIG) S RESULT="POS" Q
"RTN","MMRSIPC3",155,0)
 I LRINDVAL="" Q RESULT
"RTN","MMRSIPC3",156,0)
 S LRRES=$$UP^XLFSTR(LRRES),LRINDVAL=$$UP^XLFSTR(LRINDVAL)
"RTN","MMRSIPC3",157,0)
 I LRIND=2,(LRRES[LRINDVAL) Q "POS"
"RTN","MMRSIPC3",158,0)
 I LRIND=3,(LRRES>LRINDVAL) Q "POS"
"RTN","MMRSIPC3",159,0)
 I LRIND=4,(LRRES<LRINDVAL) Q "POS"
"RTN","MMRSIPC3",160,0)
 I LRIND=5,(LRRES=LRINDVAL) Q "POS"
"RTN","MMRSIPC3",161,0)
 Q RESULT
"RTN","MMRSIPC3",162,0)
MIRSLT(LRDFN,LRIDT,LRMDRO) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSIPC3",163,0)
 N RESULT,LRETND,LRETI,LRANTI,LRANTIND,LRANTINV,LRAND,LRRES,BACTRPT,RPTRMRK
"RTN","MMRSIPC3",164,0)
 S RESULT=""
"RTN","MMRSIPC3",165,0)
 ;Check Etiology
"RTN","MMRSIPC3",166,0)
 I $D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO)) D  Q:RESULT="POS" RESULT
"RTN","MMRSIPC3",167,0)
 .S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRIDT,3,LRETND)) Q:'LRETND!(RESULT="POS")  D
"RTN","MMRSIPC3",168,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,0)),U)
"RTN","MMRSIPC3",169,0)
 ..Q:+LRETI'>0
"RTN","MMRSIPC3",170,0)
 ..I ('$O(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,0))) D  Q
"RTN","MMRSIPC3",171,0)
 ...I $D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI)) S RESULT="POS"
"RTN","MMRSIPC3",172,0)
 ..S LRANTI=0 F  S LRANTI=$O(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI)) Q:'LRANTI  D
"RTN","MMRSIPC3",173,0)
 ...S LRANTIND=$P(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI),U,1)
"RTN","MMRSIPC3",174,0)
 ...S LRANTINV=$P(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI),U,2)
"RTN","MMRSIPC3",175,0)
 ...;S LRAND=$P($G(^LAB(62.06,LRANTI,0)),U,2) Q:LRAND=""
"RTN","MMRSIPC3",176,0)
 ...S LRAND=$$ABDN^LRPXAPIU(LRANTI) Q:'LRAND
"RTN","MMRSIPC3",177,0)
 ...Q:$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2)=""
"RTN","MMRSIPC3",178,0)
 ...Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))="S"
"RTN","MMRSIPC3",179,0)
 ...I LRANTIND=""!(LRANTINV="") Q
"RTN","MMRSIPC3",180,0)
 ...;S LRRES=$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))
"RTN","MMRSIPC3",181,0)
 ...S LRRES=$$UP^XLFSTR($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2))
"RTN","MMRSIPC3",182,0)
 ...S LRANTINV=$$UP^XLFSTR(LRANTINV)
"RTN","MMRSIPC3",183,0)
 ...S LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","MMRSIPC3",184,0)
 ...I LRANTIND=1,(LRRES[LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",185,0)
 ...I LRANTIND=2,(LRRES>LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",186,0)
 ...I LRANTIND=3,(LRRES<LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",187,0)
 ...I LRANTIND=4,(LRRES=LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",188,0)
 Q:RESULT="POS" "POS"
"RTN","MMRSIPC3",189,0)
 ;Check Bactriology Report Remarks
"RTN","MMRSIPC3",190,0)
 I '$D(^TMP($J,"MMRSIPC","BACT",LRMDRO,"INC_REMARK")) Q RESULT
"RTN","MMRSIPC3",191,0)
 S BACTRPT=0 F  S BACTRPT=$O(^LR(LRDFN,"MI",LRIDT,4,BACTRPT)) Q:'BACTRPT!(RESULT="POS")  D
"RTN","MMRSIPC3",192,0)
 .S RPTRMRK=$P($G(^LR(LRDFN,"MI",LRIDT,4,BACTRPT,0)),U,1)
"RTN","MMRSIPC3",193,0)
 .Q:RPTRMRK=""
"RTN","MMRSIPC3",194,0)
 .I $$BACTRPT(LRMDRO,"INC_REMARK",RPTRMRK)&('$$BACTRPT(LRMDRO,"EXC_REMARK",RPTRMRK)) S RESULT="POS"
"RTN","MMRSIPC3",195,0)
 Q RESULT
"RTN","MMRSIPC3",196,0)
SCRNTOP(LRSITE,LRMDRO) ;CHECK TO SEE IF SCREEN ON SITE
"RTN","MMRSIPC3",197,0)
 Q:+LRSITE'>0 0
"RTN","MMRSIPC3",198,0)
 I $D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP"))&$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSIPC3",199,0)
 I '$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP"))&'$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSIPC3",200,0)
 I ($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP")))&($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP",LRSITE))) Q 0
"RTN","MMRSIPC3",201,0)
 I ($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")))&('$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP",LRSITE))) Q 0
"RTN","MMRSIPC3",202,0)
 Q 1
"RTN","MMRSIPC3",203,0)
BACTRPT(LRMDRO,RPTTYPE,RPTRMRK) ;Is this comment contained in the parameters
"RTN","MMRSIPC3",204,0)
 N RESULT,MMRSI,LRINDVAL
"RTN","MMRSIPC3",205,0)
 S RESULT=0
"RTN","MMRSIPC3",206,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSIPC","BACT",LRMDRO,RPTTYPE,MMRSI)) Q:'MMRSI!(RESULT=1)  D
"RTN","MMRSIPC3",207,0)
 .S LRINDVAL=$G(^TMP($J,"MMRSIPC","BACT",LRMDRO,RPTTYPE,MMRSI))
"RTN","MMRSIPC3",208,0)
 .I ($$UP^XLFSTR(RPTRMRK))[($$UP^XLFSTR(LRINDVAL)) S RESULT=1
"RTN","MMRSIPC3",209,0)
 Q RESULT
"RTN","MMRSIPC4")
0^4^B58171274
"RTN","MMRSIPC4",1,0)
MMRSIPC4 ;MIA/LMT - Print MRSA Report Cont. (Contains functions to print report) ;10-20-06
"RTN","MMRSIPC4",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSIPC4",3,0)
 ;
"RTN","MMRSIPC4",4,0)
PRINT ;Prints report data
"RTN","MMRSIPC4",5,0)
 N PG,MMRSNOW,NUMLOCS,LOCNAME,LN,PREVLOC,INDATE,DFN,OUTDATE,DATA
"RTN","MMRSIPC4",6,0)
 S PG=1
"RTN","MMRSIPC4",7,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSIPC4",8,0)
 S NUMLOCS=0
"RTN","MMRSIPC4",9,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  S NUMLOCS=NUMLOCS+1
"RTN","MMRSIPC4",10,0)
 I PRTSUM D  Q
"RTN","MMRSIPC4",11,0)
 .S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSIPC4",12,0)
 ..D:BYADM PRTSUMA(LOCNAME) D:'BYADM PRTSUMD(LOCNAME)
"RTN","MMRSIPC4",13,0)
 .I NUMLOCS>1 D:BYADM PRTSUMA() D:'BYADM PRTSUMD()
"RTN","MMRSIPC4",14,0)
 I BYADM S $P(LN,"-",120)=""
"RTN","MMRSIPC4",15,0)
 I 'BYADM S $P(LN,"-",171)=""
"RTN","MMRSIPC4",16,0)
 S PREVLOC=""
"RTN","MMRSIPC4",17,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSIPC4",18,0)
 .I PREVLOC'="" D:BYADM PRTSUMA(PREVLOC) D:'BYADM PRTSUMD(PREVLOC)
"RTN","MMRSIPC4",19,0)
 .S PREVLOC=LOCNAME
"RTN","MMRSIPC4",20,0)
 .I BYADM D PRTHDRA
"RTN","MMRSIPC4",21,0)
 .I 'BYADM D PRTHDRD
"RTN","MMRSIPC4",22,0)
 .S INDATE="" F  S INDATE=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE)) Q:INDATE=""  D
"RTN","MMRSIPC4",23,0)
 ..S DFN="" F  S DFN=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN)) Q:DFN=""  D
"RTN","MMRSIPC4",24,0)
 ...S OUTDATE="" F  S OUTDATE=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)) Q:OUTDATE=""  D
"RTN","MMRSIPC4",25,0)
 ....S DATA=$G(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE))
"RTN","MMRSIPC4",26,0)
 ....I BYADM D PRINTADM(DATA)
"RTN","MMRSIPC4",27,0)
 ....I 'BYADM D PRINTDIS(DATA)
"RTN","MMRSIPC4",28,0)
 I BYADM D PRTSUMA(PREVLOC) I NUMLOCS>1 D PRTSUMA()
"RTN","MMRSIPC4",29,0)
 I 'BYADM D PRTSUMD(PREVLOC) I NUMLOCS>1 D PRTSUMD()
"RTN","MMRSIPC4",30,0)
 Q
"RTN","MMRSIPC4",31,0)
PRINTADM(DATA) ; Print cont.
"RTN","MMRSIPC4",32,0)
 N PATIENT,LAST4,INDATEE,INTT,ADT,MOVTYPE,NARES24,NARES48,CULT48,MRSA365,VADM,VAIP,WARD
"RTN","MMRSIPC4",33,0)
 D KVA^VADPT
"RTN","MMRSIPC4",34,0)
 D DEM^VADPT
"RTN","MMRSIPC4",35,0)
 S PATIENT=VADM(1)
"RTN","MMRSIPC4",36,0)
 S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSIPC4",37,0)
 D KVA^VADPT
"RTN","MMRSIPC4",38,0)
 S INDATEE=$$FMTE^XLFDT(INDATE,"2M")
"RTN","MMRSIPC4",39,0)
 S INTT=$P(DATA,U,5)
"RTN","MMRSIPC4",40,0)
 S ADT=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSIPC4",41,0)
 D KVA^VADPT S VAIP("E")=$P(DATA,U,4) D IN5^VADPT
"RTN","MMRSIPC4",42,0)
 S MOVTYPE=$E($P(VAIP(4),U,2),1,13)
"RTN","MMRSIPC4",43,0)
 S WARD=$E($P(VAIP(5),U,2),1,13)
"RTN","MMRSIPC4",44,0)
 D KVA^VADPT
"RTN","MMRSIPC4",45,0)
 S NARES24=$P(DATA,U,9)
"RTN","MMRSIPC4",46,0)
 S NARES48=$P($P(DATA,U,10),";")
"RTN","MMRSIPC4",47,0)
 S CULT48=$P($P(DATA,U,11),";")
"RTN","MMRSIPC4",48,0)
 S MRSA365=$P($P(DATA,U,12),";")
"RTN","MMRSIPC4",49,0)
 W !,WARD,?15,$E(PATIENT,1,20),?38,LAST4,?45,INDATEE,?61,ADT,?66,MOVTYPE,?81,NARES24,?90,NARES48,?99,CULT48,?108,MRSA365
"RTN","MMRSIPC4",50,0)
 I $Y+1>IOSL D PRTHDRA
"RTN","MMRSIPC4",51,0)
 Q
"RTN","MMRSIPC4",52,0)
PRINTDIS(DATA) ; Print cont.
"RTN","MMRSIPC4",53,0)
 N PATIENT,LAST4,INDATEE,INTT,ADTA,MOVTYPEA,NARES24A,NARES48A,MRSA365,OUTIFN,OUTDATEE
"RTN","MMRSIPC4",54,0)
 N OUTTT,ADTD,MOVTYPED,NARES24D,NARES48D,MRSACPRD,TRANS,VADM,VAIP,WARD
"RTN","MMRSIPC4",55,0)
 D KVA^VADPT
"RTN","MMRSIPC4",56,0)
 D DEM^VADPT
"RTN","MMRSIPC4",57,0)
 S PATIENT=VADM(1)
"RTN","MMRSIPC4",58,0)
 S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSIPC4",59,0)
 D KVA^VADPT
"RTN","MMRSIPC4",60,0)
 S INDATEE=$$FMTE^XLFDT(INDATE,"2M")
"RTN","MMRSIPC4",61,0)
 S INTT=$P(DATA,U,5)
"RTN","MMRSIPC4",62,0)
 S ADTA=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSIPC4",63,0)
 D KVA^VADPT S VAIP("E")=$P(DATA,U,4) D IN5^VADPT
"RTN","MMRSIPC4",64,0)
 S MOVTYPEA=$E($P(VAIP(4),U,2),1,13)
"RTN","MMRSIPC4",65,0)
 S WARD=$E($P(VAIP(5),U,2),1,6)
"RTN","MMRSIPC4",66,0)
 D KVA^VADPT
"RTN","MMRSIPC4",67,0)
 S NARES24A=$P(DATA,U,9)
"RTN","MMRSIPC4",68,0)
 S NARES48A=$P($P(DATA,U,10),";")
"RTN","MMRSIPC4",69,0)
 S MRSA365=$P($P(DATA,U,11),";")
"RTN","MMRSIPC4",70,0)
 S (OUTDATEE,OUTTT,ADTD,MOVTYPED,NARES24D,NARES48D)=""
"RTN","MMRSIPC4",71,0)
 S OUTIFN=$P(DATA,U,7)
"RTN","MMRSIPC4",72,0)
 I OUTIFN D
"RTN","MMRSIPC4",73,0)
 .S OUTDATEE=$$FMTE^XLFDT(OUTDATE,"2M")
"RTN","MMRSIPC4",74,0)
 .S OUTTT=$P(DATA,U,8)
"RTN","MMRSIPC4",75,0)
 .S ADTD=$S(OUTTT=2:"T",OUTTT=3:"D",1:"")
"RTN","MMRSIPC4",76,0)
 .D KVA^VADPT S VAIP("E")=OUTIFN D IN5^VADPT S MOVTYPED=$E($P(VAIP(4),U,2),1,13) D KVA^VADPT
"RTN","MMRSIPC4",77,0)
 .S NARES24D=$P(DATA,U,12)
"RTN","MMRSIPC4",78,0)
 .S NARES48D=$P($P(DATA,U,13),";")
"RTN","MMRSIPC4",79,0)
 S MRSACPRD=$P($P(DATA,U,14),";")
"RTN","MMRSIPC4",80,0)
 S TRANS=$P(DATA,U,15)
"RTN","MMRSIPC4",81,0)
 W !,WARD,?8,$E(PATIENT,1,20),?31,LAST4,?38,INDATEE,?54,ADTA,?59,MOVTYPEA,?74,NARES24A,?83,NARES48A,?92,MRSA365
"RTN","MMRSIPC4",82,0)
 W ?101,OUTDATEE,?117,ADTD,?122,MOVTYPED,?137,NARES24D,?146,NARES48D,?155,MRSACPRD,?165,TRANS
"RTN","MMRSIPC4",83,0)
 I $Y+1>IOSL D PRTHDRD
"RTN","MMRSIPC4",84,0)
 Q
"RTN","MMRSIPC4",85,0)
PRTHDRA ;
"RTN","MMRSIPC4",86,0)
 W @IOF
"RTN","MMRSIPC4",87,0)
 W ?13,"MRSA IPEC ADMISSION REPORT"
"RTN","MMRSIPC4",88,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSIPC4",89,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",90,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",91,0)
 W !!,?81,"NARES",?90,"NARES",?99,"CULTURE"
"RTN","MMRSIPC4",92,0)
 W !,"VISTA",?45,"DATE",?66,"MAS MOVE",?81,"SCREEN",?90,"RESULT",?99,"RESULT",?108,"MRSA IN"
"RTN","MMRSIPC4",93,0)
 W !,"WARD",?15,"PATIENT",?38,"SSN",?45,"ENTERED WARD",?61,"ADT",?66,"TYPE",?81,"24H",?90,"48H",?99,"48H",?108,"PAST YEAR"
"RTN","MMRSIPC4",94,0)
 W !,LN
"RTN","MMRSIPC4",95,0)
 S PG=PG+1
"RTN","MMRSIPC4",96,0)
 Q
"RTN","MMRSIPC4",97,0)
PRTHDRD ;
"RTN","MMRSIPC4",98,0)
 W @IOF
"RTN","MMRSIPC4",99,0)
 W ?13,"MRSA IPEC DISCHARGE/TRANSMISSION REPORT"
"RTN","MMRSIPC4",100,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSIPC4",101,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",102,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",103,0)
 W !!,?59,"ADM",?74,"NARES",?83,"NARES",?122,"DIS",?137,"NARES",?146,"NARES",?155,"MRSA"
"RTN","MMRSIPC4",104,0)
 W !,"VISTA",?38,"DATE",?54,"ADM",?59,"MAS MOVE",?74,"SCREEN",?83,"RESULT",?92,"MRSA IN"
"RTN","MMRSIPC4",105,0)
 W ?101,"DATE",?117,"DIS",?122,"MAS MOVE",?137,"SCREEN",?146,"RESULT",?155,"IN CURR"
"RTN","MMRSIPC4",106,0)
 W !,"WARD",?8,"PATIENT",?31,"SSN",?38,"ENTERED WARD",?54,"ADT",?59,"TYPE",?74,"24H",?83,"48H",?92,"PAST YR"
"RTN","MMRSIPC4",107,0)
 W ?101,"LEFT WARD",?117,"ADT",?122,"TYPE",?137,"24H",?146,"48H",?155,"PRD",?165,"TRANS"
"RTN","MMRSIPC4",108,0)
 W !,LN
"RTN","MMRSIPC4",109,0)
 S PG=PG+1
"RTN","MMRSIPC4",110,0)
 Q
"RTN","MMRSIPC4",111,0)
PRTSUMA(LOC) ;
"RTN","MMRSIPC4",112,0)
 N II,L,DATA
"RTN","MMRSIPC4",113,0)
 W @IOF
"RTN","MMRSIPC4",114,0)
 W ?13,"MRSA IPEC ADMISSION SUMMARY REPORT"
"RTN","MMRSIPC4",115,0)
 I $G(LOC)'="" W !,?13,"Geographical Location: ",LOC
"RTN","MMRSIPC4",116,0)
 I $G(LOC)="" W !,?13,"Geographical Locations: " D
"RTN","MMRSIPC4",117,0)
 .S II=1 S L="" F  S L=$O(^TMP($J,"MMRSIPC","DSUM",L)) Q:L=""  W:II>1&($X>37) ", " W L S II=II+1 I $X>110 W !,?37
"RTN","MMRSIPC4",118,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",119,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",120,0)
 I $G(LOC)'="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC4",121,0)
 I $G(LOC)="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC4",122,0)
 W !!,"Prevalence Measures (Facility Wide)"
"RTN","MMRSIPC4",123,0)
 W !,?3,"1. Number of admissions to the facility: ",$P(DATA,U,1)
"RTN","MMRSIPC4",124,0)
 W !,?3,"2. Number of (1) who received MRSA nasal screening upon admission to facility: ",$P(DATA,U,2)
"RTN","MMRSIPC4",125,0)
 W !,?3,"3. Number of (1) positive for MRSA based on nasal screening upon admission to facility: ",$P(DATA,U,3)
"RTN","MMRSIPC4",126,0)
 W !,?3,"4. Number of those in (1) positive for MRSA based on clinical cultures upon admission to facility: ",$P(DATA,U,4)
"RTN","MMRSIPC4",127,0)
 W !!,"Prevalence Measures (Unit Specific)"
"RTN","MMRSIPC4",128,0)
 W !,?3,"1. Number of admissions (admissions + transfers in) to the unit for the month: ",$P(DATA,U,5)
"RTN","MMRSIPC4",129,0)
 W !,?3,"2. Number of (1) for whom nasal screening was indicated: ",$P(DATA,U,6)
"RTN","MMRSIPC4",130,0)
 W !,?3,"3. Number of (2) who received MRSA nasal screening upon admission to unit (within 24 hours): ",$P(DATA,U,7)
"RTN","MMRSIPC4",131,0)
 W !,?3,"4. Number of (1) positive for MRSA based on nasal screening upon admission to unit: ",$P(DATA,U,8)
"RTN","MMRSIPC4",132,0)
 W !,?3,"5. Number of (1) positive for MRSA based on clinical cultures upon admission to unit: ",$P(DATA,U,9)
"RTN","MMRSIPC4",133,0)
 S PG=PG+1
"RTN","MMRSIPC4",134,0)
 Q
"RTN","MMRSIPC4",135,0)
PRTSUMD(LOC) ;
"RTN","MMRSIPC4",136,0)
 N II,L,DATA
"RTN","MMRSIPC4",137,0)
 W @IOF
"RTN","MMRSIPC4",138,0)
 W ?13,"MRSA IPEC DISCHARGE/TRANSMISSION SUMMARY REPORT"
"RTN","MMRSIPC4",139,0)
 I $G(LOC)'="" W !,?13,"Geographical Location: ",LOC
"RTN","MMRSIPC4",140,0)
 I $G(LOC)="" W !,?13,"Geographical Locations: " D
"RTN","MMRSIPC4",141,0)
 .S II=1 S L="" F  S L=$O(^TMP($J,"MMRSIPC","DSUM",L)) Q:L=""  W:II>1&($X>37) ", " W L S II=II+1 I $X>110 W !,?37
"RTN","MMRSIPC4",142,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",143,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",144,0)
 I $G(LOC)'="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC4",145,0)
 I $G(LOC)="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC4",146,0)
 W !!,"Transmission Measures (Unit Specific)"
"RTN","MMRSIPC4",147,0)
 W !,?3,"10. Number of bed days of care for the unit: ",$P(DATA,U,1)
"RTN","MMRSIPC4",148,0)
 W !,?3,"11. Number of exits (discharges + deaths + transfers out) from the unit: ",$P(DATA,U,2)
"RTN","MMRSIPC4",149,0)
 W !,?3,"12. Number of (11) from whom a discharge/transfer swab was indicated: ",$P(DATA,U,3)
"RTN","MMRSIPC4",150,0)
 W !,?3,"13. Number of (12) who received MRSA nasal screening upon exit from unit: ",$P(DATA,U,4)
"RTN","MMRSIPC4",151,0)
 W !,?3,"14. Number of MRSA transmissions on unit based on MRSA nasal screenings or clinical cultures: ",$P(DATA,U,5)
"RTN","MMRSIPC4",152,0)
 S PG=PG+1
"RTN","MMRSIPC4",153,0)
 Q
"RTN","MMRSIPC5")
0^8^B24723912
"RTN","MMRSIPC5",1,0)
MMRSIPC5 ;MIA/LMT - Auto-Extract MRSA IPEC Report ;08-20-09
"RTN","MMRSIPC5",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Aug 22, 2009;Build 35
"RTN","MMRSIPC5",3,0)
 ;
"RTN","MMRSIPC5",4,0)
 ;This routine will run the auto-extract for the MRSA IPEC Report.
"RTN","MMRSIPC5",5,0)
 ;This routine uses functions contained in MMRSIPC, MMRSIPC2, MMRSIPC3, and MMRSIPC4.
"RTN","MMRSIPC5",6,0)
TASK ;Entry for auto-extract to IPEC
"RTN","MMRSIPC5",7,0)
 ;Extract prevalence and transmission data for all Acute Care and CLC units
"RTN","MMRSIPC5",8,0)
 Q:'$$PROD^XUPROD
"RTN","MMRSIPC5",9,0)
 N NOW,FIRST,STRTDT,ENDDT,MMRSDIV,TYPE,MMRSLOC,BYADM,PRTSUM,LOC,DATA,MMRSMSG
"RTN","MMRSIPC5",10,0)
 N MAILTO,MONTH,YEAR,DIV,DIVNUM,SUBJECT,LOCIEN,IPECUID
"RTN","MMRSIPC5",11,0)
 S NOW=$$NOW^XLFDT()
"RTN","MMRSIPC5",12,0)
 S FIRST=$E(NOW,1,5)_"01"
"RTN","MMRSIPC5",13,0)
 S ENDDT=$$FMADD^XLFDT(FIRST,-1,0,0,0)_".24"
"RTN","MMRSIPC5",14,0)
 S STRTDT=$E(ENDDT,1,5)_"01"
"RTN","MMRSIPC5",15,0)
 S MMRSDIV=0 F  S MMRSDIV=$O(^MMRS(104,MMRSDIV)) Q:'MMRSDIV  D
"RTN","MMRSIPC5",16,0)
 .F TYPE="AC","CLC" D
"RTN","MMRSIPC5",17,0)
 ..N MMRSLOC,BYADM
"RTN","MMRSIPC5",18,0)
 ..S LOC=0 F  S LOC=$O(^MMRS(104.3,LOC)) Q:'LOC  D
"RTN","MMRSIPC5",19,0)
 ...I $P($G(^MMRS(104.3,LOC,0)),U,2)=MMRSDIV,$P($G(^MMRS(104.3,LOC,0)),U,3)=TYPE S MMRSLOC(LOC)=""
"RTN","MMRSIPC5",20,0)
 ..I '$O(MMRSLOC(0)) Q
"RTN","MMRSIPC5",21,0)
 ..F BYADM=0,1 D
"RTN","MMRSIPC5",22,0)
 ...D CLEAN^MMRSIPC ;Kill Temp Global
"RTN","MMRSIPC5",23,0)
 ...D GETPARAM^MMRSIPC ; Load parameters in temp global
"RTN","MMRSIPC5",24,0)
 ...D GETMOVE^MMRSIPC2 ;Get movements and store in temp global
"RTN","MMRSIPC5",25,0)
 ...D GETLABS^MMRSIPC3 ;Get swabbing rates and MRSA history and store in temp global
"RTN","MMRSIPC5",26,0)
 ...I 'BYADM D PATDAYS^MMRSIPC ;Get patient days of care
"RTN","MMRSIPC5",27,0)
 ...I BYADM D
"RTN","MMRSIPC5",28,0)
 ....S LOC="" F  S LOC=$O(^TMP($J,"MMRSIPC","DSUM",LOC)) Q:LOC=""  D
"RTN","MMRSIPC5",29,0)
 .....S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC5",30,0)
 .....S $P(MMRSMSG(MMRSDIV,TYPE_"U",LOC),"~",1,5)=$TR($P(DATA,U,5,9),U,"~")
"RTN","MMRSIPC5",31,0)
 ....S DATA=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC5",32,0)
 ....S MMRSMSG(MMRSDIV,TYPE_"S","FACILITY")=$TR($P(DATA,U,1,4),U,"~")
"RTN","MMRSIPC5",33,0)
 ...I 'BYADM D
"RTN","MMRSIPC5",34,0)
 ....S LOC="" F  S LOC=$O(^TMP($J,"MMRSIPC","DSUM",LOC)) Q:LOC=""  D
"RTN","MMRSIPC5",35,0)
 .....S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC5",36,0)
 .....S $P(MMRSMSG(MMRSDIV,TYPE_"U",LOC),"~",6,10)=$TR($P(DATA,U,1,5),U,"~")
"RTN","MMRSIPC5",37,0)
 ...D CLEAN^MMRSIPC ;Kill Temp Global
"RTN","MMRSIPC5",38,0)
MAIL ;Mail prevalence and transmission measures to IPEC
"RTN","MMRSIPC5",39,0)
 S MAILTO="G.IPEC ACK MESSAGE@KANSAS-CITY.MED.VA.GOV"
"RTN","MMRSIPC5",40,0)
 S MONTH=$E(STRTDT,4,5)
"RTN","MMRSIPC5",41,0)
 S YEAR=$E(STRTDT,1,3)+1700
"RTN","MMRSIPC5",42,0)
 S MMRSDIV=0 F  S MMRSDIV=$O(MMRSMSG(MMRSDIV)) Q:'MMRSDIV  D
"RTN","MMRSIPC5",43,0)
 .S DIV=$P($G(^MMRS(104,MMRSDIV,0)),U,1)
"RTN","MMRSIPC5",44,0)
 .S DIVNUM=$P($$SITE^VASITE(,DIV),U,3)
"RTN","MMRSIPC5",45,0)
 .S SUBJECT=$S($$PROD^XUPROD:"",1:"TEST")_"MRSA~"_DIVNUM_"~"_MONTH_"-"_YEAR
"RTN","MMRSIPC5",46,0)
 .I $D(MMRSMSG(MMRSDIV,"ACU")) D
"RTN","MMRSIPC5",47,0)
 ..N TEXT,XMTEXT,XMDUZ,XMY,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB,LINE,XMDUN,XMZ,XMSUB
"RTN","MMRSIPC5",48,0)
 ..S XMSUB=SUBJECT_"~DU"
"RTN","MMRSIPC5",49,0)
 ..S TEXT(1)="Type~VISN~Station~Unit~UnitID~Year~Month~PrevAdmissions~PrevScreensInd~PrevScreens~PrevScreensPos~PrevCulturesPos~TransBedDays~TransExits~TransSwabsInd~TransScreens~TransTrans"
"RTN","MMRSIPC5",50,0)
 ..S LINE=2
"RTN","MMRSIPC5",51,0)
 ..S LOC="" F  S LOC=$O(MMRSMSG(MMRSDIV,"ACU",LOC)) Q:LOC=""  D
"RTN","MMRSIPC5",52,0)
 ...S LOCIEN=$O(^MMRS(104.3,"B",LOC,0))
"RTN","MMRSIPC5",53,0)
 ...S IPECUID=$P($G(^MMRS(104.3,LOCIEN,0)),U,4)
"RTN","MMRSIPC5",54,0)
 ...S TEXT(LINE)="DU~~"_DIVNUM_"~"_LOC_"~"_IPECUID_"~"_YEAR_"~"_+MONTH_"~"_$G(MMRSMSG(MMRSDIV,"ACU",LOC))
"RTN","MMRSIPC5",55,0)
 ...S LINE=LINE+1
"RTN","MMRSIPC5",56,0)
 ..S XMTEXT="TEXT("
"RTN","MMRSIPC5",57,0)
 ..S XMY(MAILTO)=""
"RTN","MMRSIPC5",58,0)
 ..D ^XMD
"RTN","MMRSIPC5",59,0)
 .I $D(MMRSMSG(MMRSDIV,"ACS","FACILITY")) D
"RTN","MMRSIPC5",60,0)
 ..N TEXT,XMTEXT,XMDUZ,XMY,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB,LINE,XMDUN,XMZ,XMSUB
"RTN","MMRSIPC5",61,0)
 ..S XMSUB=SUBJECT_"~DS"
"RTN","MMRSIPC5",62,0)
 ..S TEXT(1)="Type~VISN~Station~Year~Month~PrevAdmissions~PrevScreens~PrevScreensPos~PrevCulturesPos"
"RTN","MMRSIPC5",63,0)
 ..S TEXT(2)="DS~~"_DIVNUM_"~"_YEAR_"~"_+MONTH_"~"_$G(MMRSMSG(MMRSDIV,"ACS","FACILITY"))
"RTN","MMRSIPC5",64,0)
 ..S XMTEXT="TEXT("
"RTN","MMRSIPC5",65,0)
 ..S XMY(MAILTO)=""
"RTN","MMRSIPC5",66,0)
 ..D ^XMD
"RTN","MMRSIPC5",67,0)
 .I $D(MMRSMSG(MMRSDIV,"CLCU")) D
"RTN","MMRSIPC5",68,0)
 ..N TEXT,XMTEXT,XMDUZ,XMY,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB,LINE,XMDUN,XMZ,XMSUB
"RTN","MMRSIPC5",69,0)
 ..S XMSUB=SUBJECT_"~CU"
"RTN","MMRSIPC5",70,0)
 ..S TEXT(1)="Type~VISN~Station~Unit~UnitID~Year~Month~PrevAdmissions~PrevScreensInd~PrevScreens~PrevScreensPos~PrevCulturesPos~TransBedDays~TransExits~TransSwabsInd~TransScreens~TransTrans"
"RTN","MMRSIPC5",71,0)
 ..S LINE=2
"RTN","MMRSIPC5",72,0)
 ..S LOC="" F  S LOC=$O(MMRSMSG(MMRSDIV,"CLCU",LOC)) Q:LOC=""  D
"RTN","MMRSIPC5",73,0)
 ...S LOCIEN=$O(^MMRS(104.3,"B",LOC,0))
"RTN","MMRSIPC5",74,0)
 ...S IPECUID=$P($G(^MMRS(104.3,LOCIEN,0)),U,4)
"RTN","MMRSIPC5",75,0)
 ...S TEXT(LINE)="CU~~"_DIVNUM_"~"_LOC_"~"_IPECUID_"~"_YEAR_"~"_+MONTH_"~"_$G(MMRSMSG(MMRSDIV,"CLCU",LOC))
"RTN","MMRSIPC5",76,0)
 ...S LINE=LINE+1
"RTN","MMRSIPC5",77,0)
 ..S XMTEXT="TEXT("
"RTN","MMRSIPC5",78,0)
 ..S XMY(MAILTO)=""
"RTN","MMRSIPC5",79,0)
 ..D ^XMD
"RTN","MMRSIPC5",80,0)
 .I $D(MMRSMSG(MMRSDIV,"CLCS","FACILITY")) D
"RTN","MMRSIPC5",81,0)
 ..N TEXT,XMTEXT,XMDUZ,XMY,XMMG,XMSTRIP,XMROU,DIFROM,XMYBLOB,LINE,XMDUN,XMZ,XMSUB
"RTN","MMRSIPC5",82,0)
 ..S XMSUB=SUBJECT_"~CS"
"RTN","MMRSIPC5",83,0)
 ..S TEXT(1)="Type~VISN~Station~Year~Month~PrevAdmissions~PrevScreens~PrevScreensPos~PrevCulturesPos"
"RTN","MMRSIPC5",84,0)
 ..S TEXT(2)="CS~~"_DIVNUM_"~"_YEAR_"~"_+MONTH_"~"_$G(MMRSMSG(MMRSDIV,"CLCS","FACILITY"))
"RTN","MMRSIPC5",85,0)
 ..S XMTEXT="TEXT("
"RTN","MMRSIPC5",86,0)
 ..S XMY(MAILTO)=""
"RTN","MMRSIPC5",87,0)
 ..D ^XMD
"RTN","MMRSIPC5",88,0)
 Q
"RTN","MMRSIPCP")
0^5^B27513898
"RTN","MMRSIPCP",1,0)
MMRSIPCP ;MIA/LMT - SETUP MRSA TOOLS SOFTWARE PARAMETERS ;11-18-08
"RTN","MMRSIPCP",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSIPCP",3,0)
 ;
"RTN","MMRSIPCP",4,0)
DIV ;Add a division and setup business rules
"RTN","MMRSIPCP",5,0)
 N DIC,X,DINUM,DLAYGO,MMRSDIV,DIR,DIE,DA,DR,DIDEL,Y
"RTN","MMRSIPCP",6,0)
 S DIC="^MMRS(104,"
"RTN","MMRSIPCP",7,0)
 S DIC(0)="AELMQ"
"RTN","MMRSIPCP",8,0)
 S DIC("A")="Select MRSA Site Parameters Division: "
"RTN","MMRSIPCP",9,0)
 S DLAYGO=104
"RTN","MMRSIPCP",10,0)
 D ^DIC
"RTN","MMRSIPCP",11,0)
 K DLAYGO
"RTN","MMRSIPCP",12,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q
"RTN","MMRSIPCP",13,0)
 S MMRSDIV=+Y
"RTN","MMRSIPCP",14,0)
 W !!
"RTN","MMRSIPCP",15,0)
 ;RECEIVING UNIT SCREEN
"RTN","MMRSIPCP",16,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",17,0)
 S DIR("A")="1. Receiving unit screen on unit-to-unit transfers"
"RTN","MMRSIPCP",18,0)
 S DIR(0)="104,1"
"RTN","MMRSIPCP",19,0)
 D ^DIR
"RTN","MMRSIPCP",20,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",21,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",22,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",23,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",24,0)
 S DR="1////"_Y
"RTN","MMRSIPCP",25,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",26,0)
 ;DISCHARGING UNIT SCREEN
"RTN","MMRSIPCP",27,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",28,0)
 S DIR("A")="2. Discharging unit screen on unit-to-unit transfers"
"RTN","MMRSIPCP",29,0)
 S DIR(0)="104,2"
"RTN","MMRSIPCP",30,0)
 D ^DIR
"RTN","MMRSIPCP",31,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",32,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",33,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",34,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",35,0)
 S DR="2////"_Y
"RTN","MMRSIPCP",36,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",37,0)
 ;SCREEN POS ON TRANSFER IN
"RTN","MMRSIPCP",38,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",39,0)
 S DIR("A")="3. Screen patients with MRSA history on transfer-in"
"RTN","MMRSIPCP",40,0)
 S DIR(0)="104,3"
"RTN","MMRSIPCP",41,0)
 D ^DIR
"RTN","MMRSIPCP",42,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",43,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",44,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",45,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",46,0)
 S DR="3////"_Y
"RTN","MMRSIPCP",47,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",48,0)
 ;SCREEN POS ON DISCHARGE
"RTN","MMRSIPCP",49,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",50,0)
 S DIR("A")="4. Screen patients with MRSA history on discharge/death/transfer-out"
"RTN","MMRSIPCP",51,0)
 S DIR(0)="104,4"
"RTN","MMRSIPCP",52,0)
 D ^DIR
"RTN","MMRSIPCP",53,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",54,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",55,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",56,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",57,0)
 S DR="4////"_Y
"RTN","MMRSIPCP",58,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",59,0)
 Q
"RTN","MMRSIPCP",60,0)
LAB ;Entry to setup the Lab Search/Extract Parameters
"RTN","MMRSIPCP",61,0)
 N EXTFLG,MMRSDIV,MDRO,DA,DO,DIC,DINUM,X,Y,DDSFILE,DR,DDSPAGE,DDSPARAM,DIR
"RTN","MMRSIPCP",62,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",63,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",64,0)
 W !
"RTN","MMRSIPCP",65,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",66,0)
 W !
"RTN","MMRSIPCP",67,0)
 S MDRO=$$GETMDRO Q:$D(EXTFLG)
"RTN","MMRSIPCP",68,0)
 W !
"RTN","MMRSIPCP",69,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("A")="Do you want to see a description for "_$$GET1^DIQ(104.2,MDRO,.01)
"RTN","MMRSIPCP",70,0)
 D ^DIR
"RTN","MMRSIPCP",71,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",72,0)
 I Y=1 D
"RTN","MMRSIPCP",73,0)
 .N DIC,DA,DR,DIQ,DIR
"RTN","MMRSIPCP",74,0)
 .W @IOF
"RTN","MMRSIPCP",75,0)
 .S DIC="^MMRS(104.2,"
"RTN","MMRSIPCP",76,0)
 .S DA=MDRO
"RTN","MMRSIPCP",77,0)
 .S DR=2
"RTN","MMRSIPCP",78,0)
 .D EN^DIQ
"RTN","MMRSIPCP",79,0)
 .S DIR(0)="E",DIR("A")="Enter RETURN to continue" D ^DIR
"RTN","MMRSIPCP",80,0)
 W !
"RTN","MMRSIPCP",81,0)
 S DA=$O(^MMRS(104.1,"C",MMRSDIV,MDRO,0))
"RTN","MMRSIPCP",82,0)
 I 'DA D  Q:$D(EXTFLG)!('DA)
"RTN","MMRSIPCP",83,0)
 .K DA
"RTN","MMRSIPCP",84,0)
 .S DIC="^MMRS(104.1,"
"RTN","MMRSIPCP",85,0)
 .S DIC(0)="F"
"RTN","MMRSIPCP",86,0)
 .S X=MDRO
"RTN","MMRSIPCP",87,0)
 .S DIC("DR")="1////"_MMRSDIV
"RTN","MMRSIPCP",88,0)
 .D FILE^DICN
"RTN","MMRSIPCP",89,0)
 .I Y=-1 S EXTFLG=1 Q
"RTN","MMRSIPCP",90,0)
 .S DA=+Y
"RTN","MMRSIPCP",91,0)
 S DDSFILE="^MMRS(104.1,"
"RTN","MMRSIPCP",92,0)
 S DR="[MMRSLABPARAM]"
"RTN","MMRSIPCP",93,0)
 D ^DDS
"RTN","MMRSIPCP",94,0)
 Q
"RTN","MMRSIPCP",95,0)
GETMDRO() ;
"RTN","MMRSIPCP",96,0)
 N MDRO,DIC,DLAYGO,DINUM,Y,DLAYGO,X,DTOUT,DUOUT
"RTN","MMRSIPCP",97,0)
 S MDRO=""
"RTN","MMRSIPCP",98,0)
 S DIC="^MMRS(104.2,"
"RTN","MMRSIPCP",99,0)
 S DIC(0)="AEMNQ"
"RTN","MMRSIPCP",100,0)
 S DIC("A")="Select the MDRO: "
"RTN","MMRSIPCP",101,0)
 D ^DIC K DIC
"RTN","MMRSIPCP",102,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q ""
"RTN","MMRSIPCP",103,0)
 S MDRO=+Y
"RTN","MMRSIPCP",104,0)
 Q MDRO
"RTN","MMRSIPCP",105,0)
WARDMAP ;Entry to setup the Ward Mappings
"RTN","MMRSIPCP",106,0)
 N MMRSDIV,DIC,Y,DLAYGO,DINUM,X,DTOUT,DUOUT,DDSFILE,DR,DA,DDSPAGE,DDSPARAM,EXTFLG,DIE,DIDEL,MMRSDA
"RTN","MMRSIPCP",107,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",108,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",109,0)
 W !
"RTN","MMRSIPCP",110,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",111,0)
 F  Q:$D(EXTFLG)  D
"RTN","MMRSIPCP",112,0)
 .S DIC="^MMRS(104.3,"
"RTN","MMRSIPCP",113,0)
 .S DIC(0)="AELMQ"
"RTN","MMRSIPCP",114,0)
 .S DIC("A")="Select Geographical Unit: "
"RTN","MMRSIPCP",115,0)
 .S DIC("DR")="1////"_MMRSDIV_";3;4"
"RTN","MMRSIPCP",116,0)
 .S DLAYGO=104.3
"RTN","MMRSIPCP",117,0)
 .W !! D ^DIC
"RTN","MMRSIPCP",118,0)
 .K DLAYGO
"RTN","MMRSIPCP",119,0)
 .I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q
"RTN","MMRSIPCP",120,0)
 .S MMRSDA=+Y
"RTN","MMRSIPCP",121,0)
 .I '$P(Y,U,3) D
"RTN","MMRSIPCP",122,0)
 ..S DIE="^MMRS(104.3,"
"RTN","MMRSIPCP",123,0)
 ..S DA=MMRSDA
"RTN","MMRSIPCP",124,0)
 ..S DR=".01;3;4"
"RTN","MMRSIPCP",125,0)
 ..S DIDEL=104.3
"RTN","MMRSIPCP",126,0)
 ..W !
"RTN","MMRSIPCP",127,0)
 ..D ^DIE
"RTN","MMRSIPCP",128,0)
 ..I $D(DTOUT)!('$D(DA)) S EXTFLG=1 Q
"RTN","MMRSIPCP",129,0)
 .Q:$D(EXTFLG)
"RTN","MMRSIPCP",130,0)
 .S DDSFILE="^MMRS(104.3,"
"RTN","MMRSIPCP",131,0)
 .S DR="[MMRSMRSA WARD MAP]"
"RTN","MMRSIPCP",132,0)
 .S DA=MMRSDA
"RTN","MMRSIPCP",133,0)
 .D ^DDS
"RTN","MMRSIPCP",134,0)
 .W @IOF
"RTN","MMRSIPCP",135,0)
 Q
"RTN","MMRSIPCP",136,0)
HISTDAY ;Historical Days Edit
"RTN","MMRSIPCP",137,0)
 N EXTFLG,MMRSDIV,MDRO,DA,DO,DIC,DINUM,X,Y,DIR,NUMDAY,MMRSX,DIE,DR,DIDEL,DIRUT,DTOUT,DUOUT
"RTN","MMRSIPCP",138,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",139,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",140,0)
 W ! S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",141,0)
 W !
"RTN","MMRSIPCP",142,0)
 S MDRO=0 F  S MDRO=$O(^MMRS(104.2,MDRO)) Q:'MDRO  D  Q:$D(EXTFLG)
"RTN","MMRSIPCP",143,0)
 .S DA=$O(^MMRS(104.2,MDRO,1,"B",MMRSDIV,0))
"RTN","MMRSIPCP",144,0)
 .I 'DA D  Q:$D(EXTFLG)!('DA)
"RTN","MMRSIPCP",145,0)
 ..K DA
"RTN","MMRSIPCP",146,0)
 ..S DIC="^MMRS(104.2,"_MDRO_",1,"
"RTN","MMRSIPCP",147,0)
 ..S DIC(0)="F"
"RTN","MMRSIPCP",148,0)
 ..S DA(1)=MDRO
"RTN","MMRSIPCP",149,0)
 ..S X=MMRSDIV
"RTN","MMRSIPCP",150,0)
 ..D FILE^DICN
"RTN","MMRSIPCP",151,0)
 ..I Y=-1 S EXTFLG=1 Q
"RTN","MMRSIPCP",152,0)
 ..S DA=+Y
"RTN","MMRSIPCP",153,0)
 .S DA(1)=MDRO
"RTN","MMRSIPCP",154,0)
 .S DIR(0)="104.22,1^AO"
"RTN","MMRSIPCP",155,0)
 .S DIR("PRE")="I X=""@"" S X=9876 S MMRSX=9876"
"RTN","MMRSIPCP",156,0)
 .S DIR("A")="Enter the number of days to search for "_$P($G(^MMRS(104.2,MDRO,0)),U,1)
"RTN","MMRSIPCP",157,0)
 .D ^DIR
"RTN","MMRSIPCP",158,0)
 .I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",159,0)
 .I Y D
"RTN","MMRSIPCP",160,0)
 ..S DIE="^MMRS(104.2,"_MDRO_",1,"
"RTN","MMRSIPCP",161,0)
 ..I $G(MMRSX)'=9876 S DR="1////"_+Y
"RTN","MMRSIPCP",162,0)
 ..I Y=9876,($G(MMRSX)=9876) S DR="1////@"
"RTN","MMRSIPCP",163,0)
 ..K MMRSX
"RTN","MMRSIPCP",164,0)
 ..D ^DIE
"RTN","MMRSIPCP",165,0)
 W !
"RTN","MMRSIPCP",166,0)
 Q
"RTN","MMRSIPCP",167,0)
ISLTORD ;Entry to setup the Isolation Orders Parameters
"RTN","MMRSIPCP",168,0)
 N EXTFLG,MMRSDIV,DA,DDSFILE,DR,DDSPAGE,DDSPARAM
"RTN","MMRSIPCP",169,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",170,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",171,0)
 W !
"RTN","MMRSIPCP",172,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",173,0)
 W !
"RTN","MMRSIPCP",174,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",175,0)
 S DDSFILE="^MMRS(104,"
"RTN","MMRSIPCP",176,0)
 S DR="[MMRSISLTORD]"
"RTN","MMRSIPCP",177,0)
 D ^DDS
"RTN","MMRSIPCP",178,0)
 Q
"RTN","MMRSISL")
0^6^B59561295
"RTN","MMRSISL",1,0)
MMRSISL ;MIA/LMT - Print census list and MDRO history ;02-01-07 
"RTN","MMRSISL",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSISL",3,0)
 ;
"RTN","MMRSISL",4,0)
MAIN ;
"RTN","MMRSISL",5,0)
 N EXTFLG,MMRSLOC,MMRSDIV
"RTN","MMRSISL",6,0)
 D CHECK^MMRSIPC
"RTN","MMRSISL",7,0)
 D CHECK2^MMRSIPC
"RTN","MMRSISL",8,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSISL",9,0)
 W !
"RTN","MMRSISL",10,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSISL",11,0)
 W !
"RTN","MMRSISL",12,0)
 D CHECK3^MMRSIPC
"RTN","MMRSISL",13,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSISL",14,0)
 D PROMPT Q:$D(EXTFLG)
"RTN","MMRSISL",15,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSISL",16,0)
 Q
"RTN","MMRSISL",17,0)
MAIN2 ; Entry for queuing
"RTN","MMRSISL",18,0)
 N USEISLT,MRSAMDRO,MRSADIV,MRSADAYS,IMPMDRO,IMPDIV,IMPDAYS,VREMDRO,VREDIV,VREDAYS,CDIFMDRO,CDIFDIV,CDIFDAYS
"RTN","MMRSISL",19,0)
 N ESBLMDRO,ESBLDIV,ESBLDAYS
"RTN","MMRSISL",20,0)
 D CLEAN
"RTN","MMRSISL",21,0)
 Q:'$D(MMRSDIV)!('$D(MMRSLOC))
"RTN","MMRSISL",22,0)
 D GETPARAM^MMRSIPC ; Load parameters in temp global
"RTN","MMRSISL",23,0)
 S USEISLT=+$O(^MMRS(104,MMRSDIV,1,0))
"RTN","MMRSISL",24,0)
 S MRSAMDRO=1
"RTN","MMRSISL",25,0)
 S MRSADIV=$O(^MMRS(104.2,MRSAMDRO,1,"B",MMRSDIV,0))
"RTN","MMRSISL",26,0)
 S MRSADAYS=$P($G(^MMRS(104.2,MRSAMDRO,1,+MRSADIV,0)),U,2)
"RTN","MMRSISL",27,0)
 S IMPMDRO=2
"RTN","MMRSISL",28,0)
 S IMPDIV=$O(^MMRS(104.2,IMPMDRO,1,"B",MMRSDIV,0))
"RTN","MMRSISL",29,0)
 S IMPDAYS=$P($G(^MMRS(104.2,IMPMDRO,1,+IMPDIV,0)),U,2)
"RTN","MMRSISL",30,0)
 S VREMDRO=3
"RTN","MMRSISL",31,0)
 S VREDIV=$O(^MMRS(104.2,VREMDRO,1,"B",MMRSDIV,0))
"RTN","MMRSISL",32,0)
 S VREDAYS=$P($G(^MMRS(104.2,VREMDRO,1,+VREDIV,0)),U,2)
"RTN","MMRSISL",33,0)
 S CDIFMDRO=4
"RTN","MMRSISL",34,0)
 S CDIFDIV=$O(^MMRS(104.2,CDIFMDRO,1,"B",MMRSDIV,0))
"RTN","MMRSISL",35,0)
 S CDIFDAYS=$P($G(^MMRS(104.2,CDIFMDRO,1,+CDIFDIV,0)),U,2)
"RTN","MMRSISL",36,0)
 S ESBLMDRO=5
"RTN","MMRSISL",37,0)
 S ESBLDIV=$O(^MMRS(104.2,ESBLMDRO,1,"B",MMRSDIV,0))
"RTN","MMRSISL",38,0)
 S ESBLDAYS=$P($G(^MMRS(104.2,ESBLMDRO,1,+ESBLDIV,0)),U,2)
"RTN","MMRSISL",39,0)
 D SETDATA
"RTN","MMRSISL",40,0)
 D PRT
"RTN","MMRSISL",41,0)
 D CLEAN
"RTN","MMRSISL",42,0)
 Q
"RTN","MMRSISL",43,0)
CLEAN ;
"RTN","MMRSISL",44,0)
 K ^TMP($J,"MMRSIPC")
"RTN","MMRSISL",45,0)
 K ^TMP($J,"MMRSISL")
"RTN","MMRSISL",46,0)
 Q
"RTN","MMRSISL",47,0)
PROMPT ;
"RTN","MMRSISL",48,0)
 N DIR,Y,DIRUT
"RTN","MMRSISL",49,0)
 S DIR(0)="YA",DIR("A")="Do you want to select all locations? ",DIR("B")="NO"
"RTN","MMRSISL",50,0)
 D ^DIR
"RTN","MMRSISL",51,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSISL",52,0)
 I Y=1 S MMRSLOC="ALL" Q
"RTN","MMRSISL",53,0)
 ;PROMPT FOR WARDS
"RTN","MMRSISL",54,0)
 N DIC,DLAYGO,Y,DTOUT,DUOUT
"RTN","MMRSISL",55,0)
 W !
"RTN","MMRSISL",56,0)
 S DIC("A")="Select Geographical Location: "
"RTN","MMRSISL",57,0)
 S DIC("S")="I $P($G(^MMRS(104.3,Y,0)),U,2)="_MMRSDIV
"RTN","MMRSISL",58,0)
 S DIC="^MMRS(104.3,",DIC(0)="QEAM" D ^DIC
"RTN","MMRSISL",59,0)
 I (Y=-1)!($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSISL",60,0)
 S MMRSLOC(+Y)=""
"RTN","MMRSISL",61,0)
 S DIC("A")="Select another Location: " F  D ^DIC Q:Y=-1  S MMRSLOC(+Y)=""
"RTN","MMRSISL",62,0)
 K DIC
"RTN","MMRSISL",63,0)
 I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSISL",64,0)
 Q
"RTN","MMRSISL",65,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSISL",66,0)
 N MMRSVAR,ZTSK
"RTN","MMRSISL",67,0)
 W !!!,"This report is designed for a 176 column format (landscape).",!
"RTN","MMRSISL",68,0)
 S MMRSVAR("MMRSLOC")="",MMRSVAR("MMRSLOC(")="",MMRSVAR("MMRSDIV")=""
"RTN","MMRSISL",69,0)
 D EN^XUTMDEVQ("MAIN2^MMRSISL","Print isolation report (MMRSISL)",.MMRSVAR,"QM",1)
"RTN","MMRSISL",70,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSISL",71,0)
 Q
"RTN","MMRSISL",72,0)
SETDATA ;
"RTN","MMRSISL",73,0)
 N LOCATION,LOCNAME,DFN,LOCTYPE,MMRSI,SDRESULT,Y,WLOC,WARD,WARDNAME
"RTN","MMRSISL",74,0)
 I $G(MMRSLOC)="ALL" D  Q
"RTN","MMRSISL",75,0)
 .S LOCATION=0 F  S LOCATION=$O(^MMRS(104.3,LOCATION)) Q:'LOCATION  I $P($G(^MMRS(104.3,LOCATION,0)),U,2)=MMRSDIV D
"RTN","MMRSISL",76,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1)
"RTN","MMRSISL",77,0)
 ..S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSISL",78,0)
 ...S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSISL",79,0)
 ...Q:'WARD
"RTN","MMRSISL",80,0)
 ...;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSISL",81,0)
 ...;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSISL",82,0)
 ...S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSISL",83,0)
 ...Q:WARDNAME=""
"RTN","MMRSISL",84,0)
 ...;S LOCNAME="" F  S LOCNAME=$O(^DPT("CN",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSISL",85,0)
 ...S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCNAME)
"RTN","MMRSISL",86,0)
 S LOCATION=0 F  S LOCATION=$O(MMRSLOC(LOCATION)) Q:'LOCATION  D
"RTN","MMRSISL",87,0)
 .S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1) ;$P($G(^SC(LOCATION,0)),U,1)
"RTN","MMRSISL",88,0)
 .;S LOCTYPE=$P($G(^SC(LOCATION,0)),U,3)
"RTN","MMRSISL",89,0)
 .;I LOCTYPE="W" D
"RTN","MMRSISL",90,0)
 .S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSISL",91,0)
 ..S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSISL",92,0)
 ..Q:'WARD
"RTN","MMRSISL",93,0)
 ..;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSISL",94,0)
 ..;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSISL",95,0)
 ..S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSISL",96,0)
 ..Q:WARDNAME=""
"RTN","MMRSISL",97,0)
 ..S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCNAME)
"RTN","MMRSISL",98,0)
 .;I LOCTYPE'="W" D
"RTN","MMRSISL",99,0)
 .;.K ^TMP($J,"SDAMA202")
"RTN","MMRSISL",100,0)
 .;.D GETPLIST^SDAMA202(LOCATION,"4",,DT,DT_".24",.SDRESULT)
"RTN","MMRSISL",101,0)
 .;.S MMRSI=0 F  S MMRSI=$O(^TMP($J,"SDAMA202","GETPLIST",MMRSI)) Q:'MMRSI  D
"RTN","MMRSISL",102,0)
 .;..S DFN=+$G(^TMP($J,"SDAMA202","GETPLIST",MMRSI,4))
"RTN","MMRSISL",103,0)
 .;..I DFN D SETDATA2(DFN,LOCNAME)
"RTN","MMRSISL",104,0)
 .;.K ^TMP($J,"SDAMA202")
"RTN","MMRSISL",105,0)
 Q
"RTN","MMRSISL",106,0)
SETDATA2(DFN,LOCNAME) ;
"RTN","MMRSISL",107,0)
 N NOW,PATNM,MRSA,MRSACULT,IMP,VRE,CDIF,ESBL,VADM,LAST4
"RTN","MMRSISL",108,0)
 S NOW=$$NOW^XLFDT
"RTN","MMRSISL",109,0)
 D KVA^VADPT
"RTN","MMRSISL",110,0)
 D DEM^VADPT
"RTN","MMRSISL",111,0)
 S PATNM=VADM(1)
"RTN","MMRSISL",112,0)
 S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSISL",113,0)
 D KVA^VADPT
"RTN","MMRSISL",114,0)
 S (MRSA,IMP,VRE,CDIF,ESBL)=""
"RTN","MMRSISL",115,0)
 I MRSADAYS D
"RTN","MMRSISL",116,0)
 .S MRSA=$P($$GETLAB^MMRSIPC3(DFN,MRSAMDRO,$$FMADD^XLFDT(NOW,-MRSADAYS),NOW,"CD"),U,2)
"RTN","MMRSISL",117,0)
 I IMPDAYS S IMP=$P($$GETLAB^MMRSIPC3(DFN,IMPMDRO,$$FMADD^XLFDT(NOW,-IMPDAYS),NOW,"CD"),U,2)
"RTN","MMRSISL",118,0)
 I VREDAYS S VRE=$P($$GETLAB^MMRSIPC3(DFN,VREMDRO,$$FMADD^XLFDT(NOW,-VREDAYS),NOW,"CD"),U,2)
"RTN","MMRSISL",119,0)
 I CDIFDAYS S CDIF=$P($$GETLAB^MMRSIPC3(DFN,CDIFMDRO,$$FMADD^XLFDT(NOW,-CDIFDAYS),NOW,"CD"),U,2)
"RTN","MMRSISL",120,0)
 I ESBLDAYS S ESBL=$P($$GETLAB^MMRSIPC3(DFN,ESBLMDRO,$$FMADD^XLFDT(NOW,-ESBLDAYS),NOW,"CD"),U,2)
"RTN","MMRSISL",121,0)
 S ^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN)=MRSA_"^"_LAST4_"^"_IMP_"^"_ESBL_"^"_VRE_"^"_CDIF
"RTN","MMRSISL",122,0)
 I USEISLT D SETISLT(DFN) ;GET ISOLATION ORDERS
"RTN","MMRSISL",123,0)
 Q
"RTN","MMRSISL",124,0)
PRT ;
"RTN","MMRSISL",125,0)
 N LN,PG,LOCNAME,PATNM,DFN,NODE,MRSA,IMP,ESBL,VRE,CDIFF,MMRSNOW
"RTN","MMRSISL",126,0)
 S $P(LN,"-",158)=""
"RTN","MMRSISL",127,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSISL",128,0)
 S PG=1
"RTN","MMRSISL",129,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSISL",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSISL",130,0)
 .D PRTHDRS S PATNM="" F  S PATNM=$O(^TMP($J,"MMRSISL",LOCNAME,PATNM)) Q:PATNM=""  D
"RTN","MMRSISL",131,0)
 ..S DFN=0 F  S DFN=$O(^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN)) Q:'DFN  D
"RTN","MMRSISL",132,0)
 ...S NODE=$G(^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN))
"RTN","MMRSISL",133,0)
 ...S MRSA=$S($P($P(NODE,"^",1),";",1)["POS":$$FMTE^XLFDT(9999999-$P($P(NODE,"^",1),";",3),"2M"),1:"")
"RTN","MMRSISL",134,0)
 ...S IMP=$S($P($P(NODE,"^",3),";",1)["POS":$$FMTE^XLFDT(9999999-$P($P(NODE,"^",3),";",3),"2M"),1:"")
"RTN","MMRSISL",135,0)
 ...S ESBL=$S($P($P(NODE,"^",4),";",1)["POS":$$FMTE^XLFDT(9999999-$P($P(NODE,"^",4),";",3),"2M"),1:"")
"RTN","MMRSISL",136,0)
 ...S VRE=$S($P($P(NODE,"^",5),";",1)["POS":$$FMTE^XLFDT(9999999-$P($P(NODE,"^",5),";",3),"2M"),1:"")
"RTN","MMRSISL",137,0)
 ...S CDIFF=$S($P($P(NODE,"^",6),";",1)["POS":$$FMTE^XLFDT(9999999-$P($P(NODE,"^",6),";",3),"2M"),1:"")
"RTN","MMRSISL",138,0)
 ...W !,$E(PATNM,1,24),?25,$P(NODE,"^",2),?32,MRSA,?48,IMP,?64,ESBL,?80,VRE,?96,CDIFF
"RTN","MMRSISL",139,0)
 ...I $Y+2>IOSL D PRTHDRS
"RTN","MMRSISL",140,0)
 ...I USEISLT D PRTISLT
"RTN","MMRSISL",141,0)
 Q
"RTN","MMRSISL",142,0)
PRTISLT ;Print report
"RTN","MMRSISL",143,0)
 N MMRSI,ISLTNODE
"RTN","MMRSISL",144,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN,MMRSI)) Q:'MMRSI  D
"RTN","MMRSISL",145,0)
 .I MMRSI>1 W !,$E(PATNM,1,24),?25,$P(NODE,"^",2),?32,MRSA,?48,IMP,?64,ESBL,?80,VRE,?96,CDIFF
"RTN","MMRSISL",146,0)
 .S ISLTNODE=$G(^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN,MMRSI))
"RTN","MMRSISL",147,0)
 .W ?112,$P(ISLTNODE,U,1),?142,$P(ISLTNODE,U,2)
"RTN","MMRSISL",148,0)
 .I $Y+2>IOSL D PRTHDRS
"RTN","MMRSISL",149,0)
 Q
"RTN","MMRSISL",150,0)
PRTHDRS ; Helper Function for PRT - Prints report headers
"RTN","MMRSISL",151,0)
 W @IOF
"RTN","MMRSISL",152,0)
 W ?13,"CENSUS LIST AND MDRO HISTORY"
"RTN","MMRSISL",153,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSISL",154,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?110,"PAGE: ",PG
"RTN","MMRSISL",155,0)
 W !!
"RTN","MMRSISL",156,0)
 W:MRSADAYS ?32,"LAST MRSA POS"
"RTN","MMRSISL",157,0)
 W:IMPDAYS ?48,"LAST CRB-R POS"
"RTN","MMRSISL",158,0)
 W:ESBLDAYS ?64,"LAST ESBL POS"
"RTN","MMRSISL",159,0)
 W:VREDAYS ?80,"LAST VRE POS"
"RTN","MMRSISL",160,0)
 W:CDIFDAYS ?96,"LAST CDF POS"
"RTN","MMRSISL",161,0)
 W !,"PATIENT",?25,"SSN"
"RTN","MMRSISL",162,0)
 W:MRSADAYS ?32,"IN "_MRSADAYS_" DAYS"
"RTN","MMRSISL",163,0)
 W:IMPDAYS ?48,"IN "_IMPDAYS_" DAYS"
"RTN","MMRSISL",164,0)
 W:ESBLDAYS ?64,"IN "_ESBLDAYS_" DAYS"
"RTN","MMRSISL",165,0)
 W:VREDAYS ?80,"IN "_VREDAYS_" DAYS"
"RTN","MMRSISL",166,0)
 W:CDIFDAYS ?96,"IN "_CDIFDAYS_" DAYS"
"RTN","MMRSISL",167,0)
 W:USEISLT ?112,"ISOLATION ORDER",?142,"START DATE"
"RTN","MMRSISL",168,0)
 W !,LN
"RTN","MMRSISL",169,0)
 S PG=PG+1
"RTN","MMRSISL",170,0)
 Q
"RTN","MMRSISL",171,0)
SETISLT(DFN) ;
"RTN","MMRSISL",172,0)
 N MMRSI,ISLTIEN,ISLTORD,PRECTYPE
"RTN","MMRSISL",173,0)
 S MMRSI=1
"RTN","MMRSISL",174,0)
 S ISLTIEN=0 F  S ISLTIEN=$O(^MMRS(104,MMRSDIV,1,ISLTIEN)) Q:'ISLTIEN  D
"RTN","MMRSISL",175,0)
 .S ISLTORD=$P($G(^MMRS(104,MMRSDIV,1,ISLTIEN,0)),U,1)
"RTN","MMRSISL",176,0)
 .S PRECTYPE=$P($G(^MMRS(104,MMRSDIV,1,ISLTIEN,0)),U,2)
"RTN","MMRSISL",177,0)
 .S PRECTYPE=$$EXTERNAL^DILFD("104.05","1",,PRECTYPE)
"RTN","MMRSISL",178,0)
 .D SETISLT2(DFN,ISLTORD,PRECTYPE)
"RTN","MMRSISL",179,0)
 Q
"RTN","MMRSISL",180,0)
SETISLT2(DFN,ISLTORD,PRECTYPE) ;
"RTN","MMRSISL",181,0)
 N ODATE,ORDNUM
"RTN","MMRSISL",182,0)
 Q:'$D(^OR(100,"AOI",ISLTORD,DFN_";DPT("))
"RTN","MMRSISL",183,0)
 S ODATE="" F  S ODATE=$O(^OR(100,"AOI",ISLTORD,DFN_";DPT(",ODATE)) Q:ODATE=""  D
"RTN","MMRSISL",184,0)
 .S ORDNUM="" F  S ORDNUM=$O(^OR(100,"AOI",ISLTORD,DFN_";DPT(",ODATE,ORDNUM)) Q:ORDNUM=""  D
"RTN","MMRSISL",185,0)
 ..I $P($G(^OR(100,ORDNUM,3)),"^",3)=6  D
"RTN","MMRSISL",186,0)
 ...S ^TMP($J,"MMRSISL",LOCNAME,PATNM,DFN,MMRSI)=PRECTYPE_U_$$FMTE^XLFDT($P($G(^OR(100,ORDNUM,0)),"^",8),"2D")
"RTN","MMRSISL",187,0)
 ...S MMRSI=MMRSI+1
"RTN","MMRSISL",188,0)
 Q
"RTN","MMRSORD")
0^7^B37424974
"RTN","MMRSORD",1,0)
MMRSORD ;MIA/LMT - Print ward census showing which patients need a nares swab ;02-22-09
"RTN","MMRSORD",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;;Mar 22, 2009;Build 35
"RTN","MMRSORD",3,0)
 ;
"RTN","MMRSORD",4,0)
MAIN ;
"RTN","MMRSORD",5,0)
 N EXTFLG,MMRSDIV,MMRSLOC
"RTN","MMRSORD",6,0)
 D CHECK^MMRSIPC
"RTN","MMRSORD",7,0)
 D CHECK2^MMRSIPC
"RTN","MMRSORD",8,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSORD",9,0)
 W !
"RTN","MMRSORD",10,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSORD",11,0)
 W !
"RTN","MMRSORD",12,0)
 D CHECK3^MMRSIPC
"RTN","MMRSORD",13,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSORD",14,0)
 D PROMPT^MMRSISL Q:$D(EXTFLG)
"RTN","MMRSORD",15,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSORD",16,0)
 Q
"RTN","MMRSORD",17,0)
MAIN2 ;
"RTN","MMRSORD",18,0)
 N MMRSNOW
"RTN","MMRSORD",19,0)
 D CLEAN
"RTN","MMRSORD",20,0)
 Q:'$D(MMRSDIV)!('$D(MMRSLOC))
"RTN","MMRSORD",21,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSORD",22,0)
 D GETPARAM^MMRSIPC ; Load parameters in temp global
"RTN","MMRSORD",23,0)
 D SETDATA
"RTN","MMRSORD",24,0)
 D PRT
"RTN","MMRSORD",25,0)
 D CLEAN
"RTN","MMRSORD",26,0)
 Q
"RTN","MMRSORD",27,0)
CLEAN ;
"RTN","MMRSORD",28,0)
 K ^TMP($J,"MMRSIPC")
"RTN","MMRSORD",29,0)
 K ^TMP($J,"MMRSORD")
"RTN","MMRSORD",30,0)
 Q
"RTN","MMRSORD",31,0)
SETDATA ;
"RTN","MMRSORD",32,0)
 N LOCATION,LOCNAME,DFN,LOCTYPE,MMRSI,SDRESULT,Y,WLOC,WARD,WARDNAME,VAIP
"RTN","MMRSORD",33,0)
 I $G(MMRSLOC)="ALL" D  Q
"RTN","MMRSORD",34,0)
 .S LOCATION=0 F  S LOCATION=$O(^MMRS(104.3,LOCATION)) Q:'LOCATION  I $P($G(^MMRS(104.3,LOCATION,0)),U,2)=MMRSDIV D
"RTN","MMRSORD",35,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1)
"RTN","MMRSORD",36,0)
 ..S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSORD",37,0)
 ...S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSORD",38,0)
 ...Q:'WARD
"RTN","MMRSORD",39,0)
 ...;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSORD",40,0)
 ...;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSORD",41,0)
 ...S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSORD",42,0)
 ...Q:WARDNAME=""
"RTN","MMRSORD",43,0)
 ...S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCATION,LOCNAME)
"RTN","MMRSORD",44,0)
 S LOCATION=0 F  S LOCATION=$O(MMRSLOC(LOCATION)) Q:'LOCATION  D
"RTN","MMRSORD",45,0)
 .S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1)
"RTN","MMRSORD",46,0)
 .S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSORD",47,0)
 ..S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSORD",48,0)
 ..Q:'WARD
"RTN","MMRSORD",49,0)
 ..;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSORD",50,0)
 ..;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSORD",51,0)
 ..S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSORD",52,0)
 ..Q:WARDNAME=""
"RTN","MMRSORD",53,0)
 ..S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCATION,LOCNAME)
"RTN","MMRSORD",54,0)
 Q
"RTN","MMRSORD",55,0)
SETDATA2(DFN,LOC,LOCNAME) ;
"RTN","MMRSORD",56,0)
 N INTT,IEN,INDATE,INIFN,MRSAMDRO,MRSA,MRSACULT,LABORDER,TSTNM,LABTEST,ORDITM,ORDTEMP,PATNM,VADM
"RTN","MMRSORD",57,0)
 ;Get unit admission date and Transaction Type
"RTN","MMRSORD",58,0)
 D KVA^VADPT
"RTN","MMRSORD",59,0)
 S VAIP("D")=MMRSNOW
"RTN","MMRSORD",60,0)
 D IN5^VADPT
"RTN","MMRSORD",61,0)
 I 'VAIP(1) Q
"RTN","MMRSORD",62,0)
 S INTT=$$TRANTYPE^MMRSIPC2(+VAIP(4),+VAIP(2))
"RTN","MMRSORD",63,0)
 F  Q:(INTT=1)!(INTT=2&$$CNGWARD^MMRSIPC2(LOC,+VAIP(5),+VAIP(15,4)))!(VAIP(15)="")  D
"RTN","MMRSORD",64,0)
 .S IEN=+VAIP(15)
"RTN","MMRSORD",65,0)
 .D KVA^VADPT
"RTN","MMRSORD",66,0)
 .S VAIP("E")=IEN
"RTN","MMRSORD",67,0)
 .D IN5^VADPT
"RTN","MMRSORD",68,0)
 .S INTT=$$TRANTYPE^MMRSIPC2(+VAIP(4),+VAIP(2))
"RTN","MMRSORD",69,0)
 I INTT<1!(INTT>2) Q
"RTN","MMRSORD",70,0)
 S INDATE=+VAIP(3)
"RTN","MMRSORD",71,0)
 S INIFN=+VAIP(1)
"RTN","MMRSORD",72,0)
 I '$G(INIFN) Q
"RTN","MMRSORD",73,0)
 ;Get MRSA history
"RTN","MMRSORD",74,0)
 S MRSAMDRO=1
"RTN","MMRSORD",75,0)
 S MRSA=$P($$GETLAB^MMRSIPC3(DFN,MRSAMDRO,$$FMADD^XLFDT(MMRSNOW,-365),MMRSNOW,"CD"),U,2)
"RTN","MMRSORD",76,0)
 ;Get Order info
"RTN","MMRSORD",77,0)
 S LABORDER="^^"
"RTN","MMRSORD",78,0)
 S TSTNM="MRSA SURVL NARES DN"
"RTN","MMRSORD",79,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES DNA~zzz")  D
"RTN","MMRSORD",80,0)
 .I TSTNM'["MRSA SURVL NARES DNA" Q
"RTN","MMRSORD",81,0)
 .S LABTEST=0 F  S LABTEST=$O(^LAB(60,"B",TSTNM,LABTEST)) Q:'LABTEST  D
"RTN","MMRSORD",82,0)
 ..S ORDITM=0 F  S ORDITM=$O(^ORD(101.43,"ID",LABTEST_";99LRT",ORDITM)) Q:'ORDITM  D
"RTN","MMRSORD",83,0)
 ...S ORDTEMP=$$GETORD(DFN,ORDITM,INDATE)
"RTN","MMRSORD",84,0)
 ...I $P(LABORDER,U,1)'="YES"!(($P(LABORDER,U,3)'="YES")&($P(ORDTEMP,U,3)="YES")) S LABORDER=ORDTEMP
"RTN","MMRSORD",85,0)
 S TSTNM="MRSA SURVL NARES AGA"
"RTN","MMRSORD",86,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES AGAR~zzz")  D
"RTN","MMRSORD",87,0)
 .I TSTNM'["MRSA SURVL NARES AGAR" Q
"RTN","MMRSORD",88,0)
 .S LABTEST=0 F  S LABTEST=$O(^LAB(60,"B",TSTNM,LABTEST)) Q:'LABTEST  D
"RTN","MMRSORD",89,0)
 ..S ORDITM=0 F  S ORDITM=$O(^ORD(101.43,"ID",LABTEST_";99LRT",ORDITM)) Q:'ORDITM  D
"RTN","MMRSORD",90,0)
 ...S ORDTEMP=$$GETORD(DFN,ORDITM,INDATE)
"RTN","MMRSORD",91,0)
 ...I $P(LABORDER,U,1)'="YES"!(($P(LABORDER,U,3)'="YES")&($P(ORDTEMP,U,3)="YES")) S LABORDER=ORDTEMP
"RTN","MMRSORD",92,0)
 D KVA^VADPT
"RTN","MMRSORD",93,0)
 D DEM^VADPT
"RTN","MMRSORD",94,0)
 S PATNM=VADM(1)
"RTN","MMRSORD",95,0)
 D KVA^VADPT
"RTN","MMRSORD",96,0)
 S ^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)=INDATE_U_INTT_U_MRSA_U_LABORDER
"RTN","MMRSORD",97,0)
 Q
"RTN","MMRSORD",98,0)
GETORD(DFN,ORDITM,INDATE) ;
"RTN","MMRSORD",99,0)
 N RESULT,START,STOP,DAS,STATUS,ORUPCHUK,LABREC
"RTN","MMRSORD",100,0)
 S RESULT="^^"
"RTN","MMRSORD",101,0)
 S START=$$FMADD^XLFDT(INDATE,-1)-.0000001
"RTN","MMRSORD",102,0)
 F  S START=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START)) Q:'START  D
"RTN","MMRSORD",103,0)
 .S STOP="" F  S STOP=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP)) Q:STOP=""  D
"RTN","MMRSORD",104,0)
 ..S DAS="" F  S DAS=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP,DAS)) Q:DAS=""  D
"RTN","MMRSORD",105,0)
 ...D EN^ORX8(+DAS)
"RTN","MMRSORD",106,0)
 ...S STATUS=$P(ORUPCHUK("ORSTS"),U,1)
"RTN","MMRSORD",107,0)
 ...I STATUS'=2,STATUS'=5,STATUS'=6 Q
"RTN","MMRSORD",108,0)
 ...S LABREC="NO"
"RTN","MMRSORD",109,0)
 ...I STATUS=6!(STATUS=2) S LABREC="YES"
"RTN","MMRSORD",110,0)
 ...I $P(RESULT,U,3)'="YES" S RESULT="YES^"_START_U_LABREC
"RTN","MMRSORD",111,0)
 Q RESULT
"RTN","MMRSORD",112,0)
PRT ;
"RTN","MMRSORD",113,0)
 N LN,PG,LOCNAME,PATNM,DFN,NODE,LAST4,INTT,ADT,ORDDATE,VADM
"RTN","MMRSORD",114,0)
 ;^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)=INDATE_U_INTT_U_MRSA_U_LAB
"RTN","MMRSORD",115,0)
 S $P(LN,"-",101)=""
"RTN","MMRSORD",116,0)
 S PG=1
"RTN","MMRSORD",117,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSORD",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSORD",118,0)
 .D PRTHDRS S PATNM="" F  S PATNM=$O(^TMP($J,"MMRSORD",LOCNAME,PATNM)) Q:PATNM=""  D
"RTN","MMRSORD",119,0)
 ..S DFN=0 F  S DFN=$O(^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)) Q:'DFN  D
"RTN","MMRSORD",120,0)
 ...S NODE=$G(^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN))
"RTN","MMRSORD",121,0)
 ...D KVA^VADPT
"RTN","MMRSORD",122,0)
 ...D DEM^VADPT
"RTN","MMRSORD",123,0)
 ...S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSORD",124,0)
 ...D KVA^VADPT
"RTN","MMRSORD",125,0)
 ...S INTT=$P(NODE,U,2)
"RTN","MMRSORD",126,0)
 ...S ADT=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSORD",127,0)
 ...S ORDDATE=$P(NODE,"^",5)
"RTN","MMRSORD",128,0)
 ...I ORDDATE S ORDDATE=$$FMTE^XLFDT(ORDDATE,"2M")
"RTN","MMRSORD",129,0)
 ...W !,$E(PATNM,1,23),?25,LAST4,?32,$$FMTE^XLFDT($P(NODE,"^",1),"2M"),?48,ADT,?53,$P($P(NODE,"^",3),";",1),?65,$P(NODE,"^",4)
"RTN","MMRSORD",130,0)
 ...W ?75,ORDDATE,?91,$P(NODE,"^",6)
"RTN","MMRSORD",131,0)
 ...I $Y+2>IOSL D PRTHDRS
"RTN","MMRSORD",132,0)
 Q
"RTN","MMRSORD",133,0)
PRTHDRS ; Helper Function for PRT - Prints report headers
"RTN","MMRSORD",134,0)
 W @IOF
"RTN","MMRSORD",135,0)
 W ?13,"NARES SWAB ORDER LIST"
"RTN","MMRSORD",136,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSORD",137,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?75,"PAGE: ",PG
"RTN","MMRSORD",138,0)
 W !!,?32,"DATE",?53,"MRSA IN",?65,"NARES",?91,"LAB"
"RTN","MMRSORD",139,0)
 W !,"PATIENT",?25,"SSN",?32,"ENTERED WARD",?48,"ADT",?53,"PAST YEAR",?65,"ORDERED",?75,"ORDER DATE",?91,"RECEIVED"
"RTN","MMRSORD",140,0)
 W !,LN
"RTN","MMRSORD",141,0)
 S PG=PG+1
"RTN","MMRSORD",142,0)
 Q
"RTN","MMRSORD",143,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSORD",144,0)
 N MMRSVAR,ZTSK
"RTN","MMRSORD",145,0)
 W !!!,"This report is designed for a 132 column format (compressed).",!
"RTN","MMRSORD",146,0)
 S MMRSVAR("MMRSLOC")="",MMRSVAR("MMRSLOC(")="",MMRSVAR("MMRSDIV")=""
"RTN","MMRSORD",147,0)
 D EN^XUTMDEVQ("MAIN2^MMRSORD","Print nares swab order list (MMRSORD)",.MMRSVAR,"QM",1)
"RTN","MMRSORD",148,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSORD",149,0)
 Q
"SEC","^DIC",104,104,0,"AUDIT")
@
"SEC","^DIC",104,104,0,"DD")
@
"SEC","^DIC",104,104,0,"DEL")
@
"SEC","^DIC",104,104,0,"LAYGO")
@
"SEC","^DIC",104,104,0,"RD")
@
"SEC","^DIC",104,104,0,"WR")
@
"SEC","^DIC",104.2,104.2,0,"AUDIT")
@
"SEC","^DIC",104.2,104.2,0,"DD")
@
"SEC","^DIC",104.2,104.2,0,"DEL")
@
"SEC","^DIC",104.2,104.2,0,"LAYGO")
@
"SEC","^DIC",104.2,104.2,0,"RD")
@
"SEC","^DIC",104.2,104.2,0,"WR")
@
"SEC","^DIC",104.3,104.3,0,"AUDIT")

"SEC","^DIC",104.3,104.3,0,"DD")

"SEC","^DIC",104.3,104.3,0,"DEL")

"SEC","^DIC",104.3,104.3,0,"LAYGO")

"SEC","^DIC",104.3,104.3,0,"RD")

"SEC","^DIC",104.3,104.3,0,"WR")

"VER")
8.0^22.0
"^DD",104,104,0)
FIELD^^5^6
"^DD",104,104,0,"DDA")
N
"^DD",104,104,0,"DT")
3090817
"^DD",104,104,0,"IX","B",104,.01)

"^DD",104,104,0,"NM","MRSA SITE PARAMETERS")

"^DD",104,104,0,"PT",104.1,1)

"^DD",104,104,0,"PT",104.22,.01)

"^DD",104,104,0,"PT",104.3,1)

"^DD",104,104,0,"VRPK")
MMRS
"^DD",104,104,.01,0)
DIVISION^RP40.8'^DG(40.8,^0;1^Q
"^DD",104,104,.01,1,0)
^.1
"^DD",104,104,.01,1,1,0)
104^B
"^DD",104,104,.01,1,1,1)
S ^MMRS(104,"B",$E(X,1,30),DA)=""
"^DD",104,104,.01,1,1,2)
K ^MMRS(104,"B",$E(X,1,30),DA)
"^DD",104,104,.01,3)
Enter the division the parameters are for.
"^DD",104,104,.01,21,0)
^^1^1^3081028^
"^DD",104,104,.01,21,1,0)
This field contains the division the parameters are defined for.
"^DD",104,104,.01,"DT")
3081028
"^DD",104,104,1,0)
RECEIVING UNIT SCREEN^S^0:NO;1:YES;^0;2^Q
"^DD",104,104,1,3)
Enter 'Yes' if at your site the admitting (or receiving) unit screens patients on unit-to-unit transfers.
"^DD",104,104,1,21,0)
^^2^2^3090304^
"^DD",104,104,1,21,1,0)
This field should be set to 'Yes' if at your site the admitting (or 
"^DD",104,104,1,21,2,0)
receiving) unit screens patients on unit-to-unit transfers.
"^DD",104,104,1,"DT")
3090304
"^DD",104,104,2,0)
DISCHARGING UNIT SCREEN^S^0:NO;1:YES;^0;3^Q
"^DD",104,104,2,3)
Enter 'Yes' if at your site the discharging unit screens patients on unit-to-unit transfers.
"^DD",104,104,2,21,0)
^^2^2^3081028^
"^DD",104,104,2,21,1,0)
This field should be set to 'Yes' if at your site the discharging unit 
"^DD",104,104,2,21,2,0)
screens patients on unit-to-unit transfers.
"^DD",104,104,2,"DT")
3081028
"^DD",104,104,3,0)
SCREEN POS ON TRANSFER IN^S^0:NO;1:YES;^0;4^Q
"^DD",104,104,3,3)
Enter 'Yes' if at your site you are screening all patients on transfers into the unit, regardless of MRSA status.
"^DD",104,104,3,21,0)
^^4^4^3090304^
"^DD",104,104,3,21,1,0)
This field should be set to 'Yes' if at your site you are screening all 
"^DD",104,104,3,21,2,0)
patients on transfers into the unit, regardless of MRSA status. This field
"^DD",104,104,3,21,3,0)
should be set to 'No' if you only screen patients not known to be infected
"^DD",104,104,3,21,4,0)
and/or colonized with MRSA on transfers into the unit.
"^DD",104,104,3,"DT")
3090304
"^DD",104,104,4,0)
SCREEN POS ON DISCHARGE^S^0:NO;1:YES;^0;5^Q
"^DD",104,104,4,3)
Enter 'Yes' if at your site you are screening patients on discharge, death, or transfer out from the unit, regardless of MRSA status.
"^DD",104,104,4,21,0)
^^7^7^3090316^
"^DD",104,104,4,21,1,0)
This field should be set to 'Yes' if at your site you are screening 
"^DD",104,104,4,21,2,0)
patients on discharge, death, or transfer out from the unit, regardless of
"^DD",104,104,4,21,3,0)
MRSA status.
"^DD",104,104,4,21,4,0)
 
"^DD",104,104,4,21,5,0)
This field should be set to 'No' if you only screen patients not known to
"^DD",104,104,4,21,6,0)
be infected and/or colonized with MRSA on discharge, death, or transfer
"^DD",104,104,4,21,7,0)
out from the unit.
"^DD",104,104,4,"DT")
3090316
"^DD",104,104,5,0)
ISOLATION ORDERS^104.05PA^^1;0
"^DD",104,104.05,0)
ISOLATION ORDERS SUB-FIELD^^1^2
"^DD",104,104.05,0,"DT")
3090817
"^DD",104,104.05,0,"IX","B",104.05,.01)

"^DD",104,104.05,0,"NM","ISOLATION ORDERS")

"^DD",104,104.05,0,"UP")
104
"^DD",104,104.05,.01,0)
ISOLATION ORDER^MRP101.43'^ORD(101.43,^0;1^Q
"^DD",104,104.05,.01,1,0)
^.1
"^DD",104,104.05,.01,1,1,0)
104.05^B
"^DD",104,104.05,.01,1,1,1)
S ^MMRS(104,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104,104.05,.01,1,1,2)
K ^MMRS(104,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104,104.05,.01,3)
Enter the isolation orderable item.
"^DD",104,104.05,.01,21,0)
^^1^1^3090304^
"^DD",104,104.05,.01,21,1,0)
The orderable item that is used at your facility for isolation purposes.
"^DD",104,104.05,.01,"DT")
3090304
"^DD",104,104.05,1,0)
EXPANDED PRECAUTION TYPE^S^1:CONTACT PRECAUTIONS;2:CONTACT PRECAUTIONS SPECIAL;3:AIRBORNE INFECTION;4:DROPLET;5:PROTECTIVE ENVIRONMENT;6:ISOLATION ORDER;^0;2^Q
"^DD",104,104.05,1,3)
Enter the expanded precaution type this order is used for.
"^DD",104,104.05,1,21,0)
^.001^1^1^3090302^^^
"^DD",104,104.05,1,21,1,0)
The expanded precaution type this order is used for.
"^DD",104,104.05,1,"DT")
3090817
"^DD",104.1,104.1,0)
FIELD^^5^8
"^DD",104.1,104.1,0,"DDA")
N
"^DD",104.1,104.1,0,"DT")
3090813
"^DD",104.1,104.1,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^MMRS(104,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(104,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",104.1,104.1,0,"IX","B",104.1,.01)

"^DD",104.1,104.1,0,"IX","D",104.1,1)

"^DD",104.1,104.1,0,"NM","MRSA TOOLS LAB SEARCH/EXTRACT")

"^DD",104.1,104.1,0,"VRPK")
MMRS
"^DD",104.1,104.1,.01,0)
MDRO^RP104.2'^MMRS(104.2,^0;1^Q
"^DD",104.1,104.1,.01,1,0)
^.1
"^DD",104.1,104.1,.01,1,1,0)
104.1^B
"^DD",104.1,104.1,.01,1,1,1)
S ^MMRS(104.1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.1,.01,1,1,2)
K ^MMRS(104.1,"B",$E(X,1,30),DA)
"^DD",104.1,104.1,.01,3)
Enter the MDRO for the parameters you are defining.
"^DD",104.1,104.1,.01,21,0)
^^2^2^3090226^
"^DD",104.1,104.1,.01,21,1,0)
This is the multi-drug resistant organism (MDRO) for the parameters you 
"^DD",104.1,104.1,.01,21,2,0)
are defining.
"^DD",104.1,104.1,.01,"DT")
3090226
"^DD",104.1,104.1,1,0)
DIVISION^P104'^MMRS(104,^0;2^Q
"^DD",104.1,104.1,1,1,0)
^.1
"^DD",104.1,104.1,1,1,1,0)
104.1^D
"^DD",104.1,104.1,1,1,1,1)
S ^MMRS(104.1,"D",$E(X,1,30),DA)=""
"^DD",104.1,104.1,1,1,1,2)
K ^MMRS(104.1,"D",$E(X,1,30),DA)
"^DD",104.1,104.1,1,1,1,"DT")
3090226
"^DD",104.1,104.1,1,3)
Enter the site that this lab test is defined for.
"^DD",104.1,104.1,1,21,0)
^^1^1^3081028^
"^DD",104.1,104.1,1,21,1,0)
This is the site that this lab test is defined for.
"^DD",104.1,104.1,1,"DT")
3090226
"^DD",104.1,104.1,3,0)
INCLUDED SITES^104.103PA^^1;0
"^DD",104.1,104.1,4,0)
EXCLUDED SITES^104.104PA^^2;0
"^DD",104.1,104.1,5,0)
LAB TEST^104.15PA^^3;0
"^DD",104.1,104.1,7,0)
INCLUDED BACT RPT REMARKS^104.107A^^4;0
"^DD",104.1,104.1,8,0)
EXCLUDED BACT RPT REMARKS^104.108A^^5;0
"^DD",104.1,104.1,9,0)
ETIOLOGY^104.109PA^^6;0
"^DD",104.1,104.103,0)
INCLUDED SITES SUB-FIELD^^.01^1
"^DD",104.1,104.103,0,"DT")
3081028
"^DD",104.1,104.103,0,"IX","B",104.103,.01)

"^DD",104.1,104.103,0,"NM","INCLUDED SITES")

"^DD",104.1,104.103,0,"UP")
104.1
"^DD",104.1,104.103,.01,0)
INCLUDED TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",104.1,104.103,.01,1,0)
^.1
"^DD",104.1,104.103,.01,1,1,0)
104.103^B
"^DD",104.1,104.103,.01,1,1,1)
S ^MMRS(104.1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.103,.01,1,1,2)
K ^MMRS(104.1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.1,104.103,.01,3)
Selection of a Topography screens all others out except the ones selected. For "ALL" leave blank. Not to be used in conjunction with the exclude Topography selection.
"^DD",104.1,104.103,.01,21,0)
^.001^2^2^3090227^^
"^DD",104.1,104.103,.01,21,1,0)
This determines what Topography to screen for. Select the appropriate 
"^DD",104.1,104.103,.01,21,2,0)
Topography to include in the extract.
"^DD",104.1,104.103,.01,"DT")
3081124
"^DD",104.1,104.104,0)
EXCLUDED SITES SUB-FIELD^^.01^1
"^DD",104.1,104.104,0,"DT")
3081028
"^DD",104.1,104.104,0,"IX","B",104.104,.01)

"^DD",104.1,104.104,0,"NM","EXCLUDED SITES")

"^DD",104.1,104.104,0,"UP")
104.1
"^DD",104.1,104.104,.01,0)
EXCLUDED TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",104.1,104.104,.01,1,0)
^.1
"^DD",104.1,104.104,.01,1,1,0)
104.104^B
"^DD",104.1,104.104,.01,1,1,1)
S ^MMRS(104.1,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.104,.01,1,1,2)
K ^MMRS(104.1,DA(1),2,"B",$E(X,1,30),DA)
"^DD",104.1,104.104,.01,3)
Select the Topography to screen out. Not to be used in conjunction with the Include Topography selection.
"^DD",104.1,104.104,.01,21,0)
^.001^2^2^3090227^^
"^DD",104.1,104.104,.01,21,1,0)
This determines what Topography to screen out. Select the appropriate 
"^DD",104.1,104.104,.01,21,2,0)
Topography to be excluded from the extract.
"^DD",104.1,104.104,.01,"DT")
3081124
"^DD",104.1,104.107,0)
INCLUDED BACT RPT REMARKS SUB-FIELD^^.01^1
"^DD",104.1,104.107,0,"DT")
3090813
"^DD",104.1,104.107,0,"IX","B",104.107,.01)

"^DD",104.1,104.107,0,"NM","INCLUDED BACT RPT REMARKS")

"^DD",104.1,104.107,0,"UP")
104.1
"^DD",104.1,104.107,.01,0)
INCLUDED BACT RPT REMARK^MF^^0;1^K:$L(X)>68!($L(X)<1) X
"^DD",104.1,104.107,.01,1,0)
^.1
"^DD",104.1,104.107,.01,1,1,0)
104.107^B
"^DD",104.1,104.107,.01,1,1,1)
S ^MMRS(104.1,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.107,.01,1,1,2)
K ^MMRS(104.1,DA(1),4,"B",$E(X,1,30),DA)
"^DD",104.1,104.107,.01,3)
For MI-subscripted tests, enter the text that would denote a positive result, if contained in the Bact Rpt Remarks. Answer must be 1-68 characters in length.
"^DD",104.1,104.107,.01,21,0)
^.001^2^2^3090813^^
"^DD",104.1,104.107,.01,21,1,0)
For MI-subscripted tests, this will be used to determine the criteria that
"^DD",104.1,104.107,.01,21,2,0)
must be contained in the report remarks.
"^DD",104.1,104.107,.01,"DT")
3090813
"^DD",104.1,104.108,0)
EXCLUDED BACT RPT REMARKS SUB-FIELD^^.01^1
"^DD",104.1,104.108,0,"DT")
3090813
"^DD",104.1,104.108,0,"IX","B",104.108,.01)

"^DD",104.1,104.108,0,"NM","EXCLUDED BACT RPT REMARKS")

"^DD",104.1,104.108,0,"UP")
104.1
"^DD",104.1,104.108,.01,0)
EXCLUDED BACT RPT REMARK^MF^^0;1^K:$L(X)>68!($L(X)<1) X
"^DD",104.1,104.108,.01,1,0)
^.1
"^DD",104.1,104.108,.01,1,1,0)
104.108^B
"^DD",104.1,104.108,.01,1,1,1)
S ^MMRS(104.1,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.108,.01,1,1,2)
K ^MMRS(104.1,DA(1),5,"B",$E(X,1,30),DA)
"^DD",104.1,104.108,.01,3)
For MI-subscripted tests, select the comments that must not be contained in the report remarks. Answer must be 1-68 characters in length.
"^DD",104.1,104.108,.01,21,0)
^^9^9^3090304^
"^DD",104.1,104.108,.01,21,1,0)
For MI-subscripted tests, this determines what comments must not be
"^DD",104.1,104.108,.01,21,2,0)
contained in the report remarks.
"^DD",104.1,104.108,.01,21,3,0)
 
"^DD",104.1,104.108,.01,21,4,0)
This field only needs to be used in cases where the comments used to 
"^DD",104.1,104.108,.01,21,5,0)
denote a positive are also contained in the comments used to denote a 
"^DD",104.1,104.108,.01,21,6,0)
negative. For example, if your site uses 'No MRSA DNA detected' to denote 
"^DD",104.1,104.108,.01,21,7,0)
a MRSA negative, and 'MRSA DNA detected' to denote a MRSA positive. You 
"^DD",104.1,104.108,.01,21,8,0)
would enter 'MRSA DNA detected' in the field Included Bact rpt remark, and
"^DD",104.1,104.108,.01,21,9,0)
'No MRSA DNA detected' in this field.
"^DD",104.1,104.108,.01,"DT")
3090813
"^DD",104.1,104.109,0)
ETIOLOGY SUB-FIELD^^1^2
"^DD",104.1,104.109,0,"DT")
3090108
"^DD",104.1,104.109,0,"IX","B",104.109,.01)

"^DD",104.1,104.109,0,"NM","ETIOLOGY")

"^DD",104.1,104.109,0,"UP")
104.1
"^DD",104.1,104.109,.01,0)
ETIOLOGY^MP61.2'^LAB(61.2,^0;1^Q
"^DD",104.1,104.109,.01,1,0)
^.1
"^DD",104.1,104.109,.01,1,1,0)
104.109^B
"^DD",104.1,104.109,.01,1,1,1)
S ^MMRS(104.1,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.109,.01,1,1,2)
K ^MMRS(104.1,DA(1),6,"B",$E(X,1,30),DA)
"^DD",104.1,104.109,.01,3)
For MI-subscripted tests, select the Etiology to search for.
"^DD",104.1,104.109,.01,21,0)
^^1^1^3090304^
"^DD",104.1,104.109,.01,21,1,0)
For MI-subscripted tests, this defines the Etiology to search for.
"^DD",104.1,104.109,.01,"DT")
3090304
"^DD",104.1,104.109,1,0)
ANTIMICROBIAL SUSCEPTIBILITY^104.191PA^^1;0
"^DD",104.1,104.15,0)
LAB TEST SUB-FIELD^^2^3
"^DD",104.1,104.15,0,"DT")
3090226
"^DD",104.1,104.15,0,"IX","B",104.15,.01)

"^DD",104.1,104.15,0,"NM","LAB TEST")

"^DD",104.1,104.15,0,"UP")
104.1
"^DD",104.1,104.15,.01,0)
LAB TEST^MR*P60'^LAB(60,^0;1^S DIC("S")="I $P($G(^(0)),U,4)=""CH""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",104.1,104.15,.01,1,0)
^.1
"^DD",104.1,104.15,.01,1,1,0)
104.15^B
"^DD",104.1,104.15,.01,1,1,1)
S ^MMRS(104.1,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.15,.01,1,1,2)
K ^MMRS(104.1,DA(1),3,"B",$E(X,1,30),DA)
"^DD",104.1,104.15,.01,3)
Enter the lab test that is to be searched for and retrieved. Only CH subscripted tests should be selected.
"^DD",104.1,104.15,.01,12)
Only CH subscripts are selectable.
"^DD",104.1,104.15,.01,12.1)
S DIC("S")="I $P($G(^(0)),U,4)=""CH"""
"^DD",104.1,104.15,.01,21,0)
^^2^2^3090304^
"^DD",104.1,104.15,.01,21,1,0)
This is the CH-subscripted lab test that is to be searched for and
"^DD",104.1,104.15,.01,21,2,0)
retrieved.
"^DD",104.1,104.15,.01,"DT")
3090304
"^DD",104.1,104.15,1,0)
INDICATOR^RS^1:Use Reference Ranges;2:Contains;3:Greater Than;4:Less Than;5:Equal To;^0;2^Q
"^DD",104.1,104.15,1,3)
For CH tests, select the code that will determine how to match lab results.
"^DD",104.1,104.15,1,21,0)
^^1^1^3090226^
"^DD",104.1,104.15,1,21,1,0)
For CH tests, this will determine how to match lab results.
"^DD",104.1,104.15,1,"DT")
3090226
"^DD",104.1,104.15,2,0)
INDICATOR VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",104.1,104.15,2,3)
For CH tests, enter the data to be compared using the INDICATOR field. Answer must be 1-30 characters in length.
"^DD",104.1,104.15,2,21,0)
^^1^1^3090226^
"^DD",104.1,104.15,2,21,1,0)
For CH tests, if the search is conditional this defines the criteria.
"^DD",104.1,104.15,2,"DT")
3090226
"^DD",104.1,104.191,0)
ANTIMICROBIAL SUSCEPTIBILITY SUB-FIELD^^2^3
"^DD",104.1,104.191,0,"DT")
3090108
"^DD",104.1,104.191,0,"IX","B",104.191,.01)

"^DD",104.1,104.191,0,"NM","ANTIMICROBIAL SUSCEPTIBILITY")

"^DD",104.1,104.191,0,"UP")
104.109
"^DD",104.1,104.191,.01,0)
ANTIMICROBIAL SUSCEPTIBILITY^MP62.06'^LAB(62.06,^0;1^Q
"^DD",104.1,104.191,.01,1,0)
^.1
"^DD",104.1,104.191,.01,1,1,0)
104.191^B
"^DD",104.1,104.191,.01,1,1,1)
S ^MMRS(104.1,DA(2),6,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.191,.01,1,1,2)
K ^MMRS(104.1,DA(2),6,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.1,104.191,.01,3)
For MI-subscripted tests, enter the Antimicrobial that will be used in screening out sensitive Etiologies.
"^DD",104.1,104.191,.01,21,0)
^^5^5^3090304^
"^DD",104.1,104.191,.01,21,1,0)
This defines which antimicrobials will be searched for to see if the
"^DD",104.1,104.191,.01,21,2,0)
etiology is resistant to them. If no antimicrobials are specified, then
"^DD",104.1,104.191,.01,21,3,0)
the program will just search for the presence of the etiology, without  
"^DD",104.1,104.191,.01,21,4,0)
searching to see if the etiology is resistant to any of the 
"^DD",104.1,104.191,.01,21,5,0)
antimicrobials.
"^DD",104.1,104.191,.01,"DT")
3090304
"^DD",104.1,104.191,1,0)
INDICATOR^S^1:Contains;2:Greater Than;3:Less Than;4:Equal To;^0;2^Q
"^DD",104.1,104.191,1,3)
Select the code that will determine how to match lab results.
"^DD",104.1,104.191,1,21,0)
^^1^1^3090108^
"^DD",104.1,104.191,1,21,1,0)
This will determine how to match lab results.
"^DD",104.1,104.191,1,"DT")
3090108
"^DD",104.1,104.191,2,0)
INDICATED VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",104.1,104.191,2,3)
Enter the data to be compared using the INDICATOR field. Answer must be 1-30 characters in length.
"^DD",104.1,104.191,2,21,0)
^^1^1^3090108^
"^DD",104.1,104.191,2,21,1,0)
If the search is conditional this defines the criteria.
"^DD",104.1,104.191,2,"DT")
3090108
"^DD",104.2,104.2,0)
FIELD^^3^4
"^DD",104.2,104.2,0,"DDA")
N
"^DD",104.2,104.2,0,"DT")
3090814
"^DD",104.2,104.2,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",104.2,104.2,0,"IX","B",104.2,.01)

"^DD",104.2,104.2,0,"NM","MDRO TYPES")

"^DD",104.2,104.2,0,"PT",104.1,.01)

"^DD",104.2,104.2,0,"VRPK")
MMRS
"^DD",104.2,104.2,.01,0)
ABBREVIATION^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",104.2,104.2,.01,1,0)
^.1
"^DD",104.2,104.2,.01,1,1,0)
104.2^B
"^DD",104.2,104.2,.01,1,1,1)
S ^MMRS(104.2,"B",$E(X,1,30),DA)=""
"^DD",104.2,104.2,.01,1,1,2)
K ^MMRS(104.2,"B",$E(X,1,30),DA)
"^DD",104.2,104.2,.01,3)
Enter the abbreviation for this multi-drug resistant organism. Entries In this file should not be edited. This file will be maintained by the support team. Answer must be 3-30 characters in length.
"^DD",104.2,104.2,.01,21,0)
^^1^1^3081028^
"^DD",104.2,104.2,.01,21,1,0)
This is the abbreviation for the MDRO.
"^DD",104.2,104.2,.01,"DT")
3081028
"^DD",104.2,104.2,1,0)
NAME^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",104.2,104.2,1,3)
Enter the full name of the multi-drug resistant organism. Answer must be 3-80 characters in length.
"^DD",104.2,104.2,1,21,0)
^^1^1^3081028^
"^DD",104.2,104.2,1,21,1,0)
This is the full name of the MDRO.
"^DD",104.2,104.2,1,"DT")
3081028
"^DD",104.2,104.2,2,0)
DIVISION^104.22PA^^1;0
"^DD",104.2,104.2,3,0)
DESCRIPTION^104.23^^2;0
"^DD",104.2,104.22,0)
DIVISION SUB-FIELD^^1^2
"^DD",104.2,104.22,0,"DT")
3090227
"^DD",104.2,104.22,0,"IX","B",104.22,.01)

"^DD",104.2,104.22,0,"NM","DIVISION")

"^DD",104.2,104.22,0,"UP")
104.2
"^DD",104.2,104.22,.01,0)
DIVISION^RP104'^MMRS(104,^0;1^Q
"^DD",104.2,104.22,.01,1,0)
^.1
"^DD",104.2,104.22,.01,1,1,0)
104.22^B
"^DD",104.2,104.22,.01,1,1,1)
S ^MMRS(104.2,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.2,104.22,.01,1,1,2)
K ^MMRS(104.2,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.2,104.22,.01,3)
Enter the site that these parameters are defined for.
"^DD",104.2,104.22,.01,21,0)
^.001^1^1^3090227^^^^
"^DD",104.2,104.22,.01,21,1,0)
This is the site the parameters are defined for.
"^DD",104.2,104.22,.01,"DT")
3090227
"^DD",104.2,104.22,1,0)
HISTORICAL DAYS^NJ5,0^^0;2^K:+X'=X!(X>10000)!(X<1)!(X?.E1"."1N.N) X
"^DD",104.2,104.22,1,3)
Enter the number of historical days to display on the isolation report. Type a Number between 1 and 10000, 0 Decimal Digits.
"^DD",104.2,104.22,1,21,0)
^^2^2^3090304^
"^DD",104.2,104.22,1,21,1,0)
The number of historical days to display on the isolation report. Answer 
"^DD",104.2,104.22,1,21,2,0)
must be in days (365 = 12 mos or 1 year; 28 = 4 weeks; 90 = quarter).
"^DD",104.2,104.22,1,"DT")
3090304
"^DD",104.2,104.23,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",104.2,104.23,0,"DT")
3090814
"^DD",104.2,104.23,0,"NM","DESCRIPTION")

"^DD",104.2,104.23,0,"UP")
104.2
"^DD",104.2,104.23,.01,0)
DESCRIPTION^Wx^^0;1
"^DD",104.2,104.23,.01,3)
Enter the general description for this MDRO.
"^DD",104.2,104.23,.01,21,0)
^^1^1^3090831^
"^DD",104.2,104.23,.01,21,1,0)
This is the general description for this MDRO.
"^DD",104.2,104.23,.01,"DT")
3090831
"^DD",104.3,104.3,0)
FIELD^^4^5
"^DD",104.3,104.3,0,"DDA")
N
"^DD",104.3,104.3,0,"DT")
3090831
"^DD",104.3,104.3,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^MMRS(104,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(104,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",104.3,104.3,0,"ID",3)
W "   ",@("$P($P($C(59)_$S($D(^DD(104.3,3,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,3)_"":"",2),$C(59),1)")
"^DD",104.3,104.3,0,"IX","B",104.3,.01)

"^DD",104.3,104.3,0,"NM","MRSA WARD MAPPINGS")

"^DD",104.3,104.3,0,"VRPK")
MMRS
"^DD",104.3,104.3,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X
"^DD",104.3,104.3,.01,1,0)
^.1
"^DD",104.3,104.3,.01,1,1,0)
104.3^B
"^DD",104.3,104.3,.01,1,1,1)
S ^MMRS(104.3,"B",$E(X,1,30),DA)=""
"^DD",104.3,104.3,.01,1,1,2)
K ^MMRS(104.3,"B",$E(X,1,30),DA)
"^DD",104.3,104.3,.01,3)
Enter the name of the Geographical Unit you would like to create. Answer must be 2-30 characters in length.
"^DD",104.3,104.3,.01,21,0)
^^2^2^3090304^
"^DD",104.3,104.3,.01,21,1,0)
This is the name of the Geographical Unit. This name will be displayed on 
"^DD",104.3,104.3,.01,21,2,0)
all reports that are run.
"^DD",104.3,104.3,.01,"DT")
3090304
"^DD",104.3,104.3,1,0)
DIVISION^P104'^MMRS(104,^0;2^Q
"^DD",104.3,104.3,1,3)
Enter the site that this mapping is defined for.
"^DD",104.3,104.3,1,21,0)
^^1^1^3081028^
"^DD",104.3,104.3,1,21,1,0)
This is the site that this mapping is defined for.
"^DD",104.3,104.3,1,"DT")
3081028
"^DD",104.3,104.3,2,0)
WARD LOCATIONS^104.302PA^^1;0
"^DD",104.3,104.3,3,0)
TYPE^RS^AC:ACUTE CARE;CLC:CLC;OBS:OBS;OT:OTHER;^0;3^Q
"^DD",104.3,104.3,3,3)
Enter the type of care provided to patients on this unit.
"^DD",104.3,104.3,3,21,0)
^^1^1^3090831^
"^DD",104.3,104.3,3,21,1,0)
This is the type of care provided to patients on this unit.
"^DD",104.3,104.3,3,"DT")
3090831
"^DD",104.3,104.3,4,0)
IPEC UNIT ID^NJ7,0^^0;4^K:+X'=X!(X>1000000)!(X<1)!(X?.E1"."1.N) X
"^DD",104.3,104.3,4,3)
Enter the ID number that identifies this unit in IPEC. This is only for Acute Care and CLC units reported to IPEC. Do NOT assign a Unit ID to any unit that is considered OBS or Other.
"^DD",104.3,104.3,4,21,0)
^^3^3^3090831^
"^DD",104.3,104.3,4,21,1,0)
This is the ID number that identifies this unit in IPEC.  This is only for
"^DD",104.3,104.3,4,21,2,0)
Acute Care and CLC units reported to IPEC. Do NOT assign a Unit ID to any
"^DD",104.3,104.3,4,21,3,0)
unit that is considered OBS or Other.
"^DD",104.3,104.3,4,"DT")
3090831
"^DD",104.3,104.302,0)
WARD LOCATIONS SUB-FIELD^^.01^1
"^DD",104.3,104.302,0,"DT")
3090302
"^DD",104.3,104.302,0,"IX","B",104.302,.01)

"^DD",104.3,104.302,0,"NM","WARD LOCATIONS")

"^DD",104.3,104.302,0,"UP")
104.3
"^DD",104.3,104.302,.01,0)
WARD LOCATION^MRP42'^DIC(42,^0;1^Q
"^DD",104.3,104.302,.01,1,0)
^.1
"^DD",104.3,104.302,.01,1,1,0)
104.302^B
"^DD",104.3,104.302,.01,1,1,1)
S ^MMRS(104.3,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.3,104.302,.01,1,1,2)
K ^MMRS(104.3,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.3,104.302,.01,3)
Enter the ward to be added to this geographical location.
"^DD",104.3,104.302,.01,21,0)
^.001^1^1^3090302^^
"^DD",104.3,104.302,.01,21,1,0)
This is the ward that belongs to this geographical location.
"^DD",104.3,104.302,.01,"DT")
3090302
"^DIC",104,104,0)
MRSA SITE PARAMETERS^104
"^DIC",104,104,0,"GL")
^MMRS(104,
"^DIC",104,104,"%",0)
^1.005^^0
"^DIC",104,104,"%D",0)
^1.001^3^3^3090304^^
"^DIC",104,104,"%D",1,0)
This file holds the set of parameters which modify the operation of the 
"^DIC",104,104,"%D",2,0)
MRSA Program Tools to suit the needs of your site. For multi-divisional 
"^DIC",104,104,"%D",3,0)
facilities, each division should have a separate entry in this file.
"^DIC",104,"B","MRSA SITE PARAMETERS",104)

"^DIC",104.1,104.1,0)
MRSA TOOLS LAB SEARCH/EXTRACT^104.1
"^DIC",104.1,104.1,0,"GL")
^MMRS(104.1,
"^DIC",104.1,104.1,"%",0)
^1.005^^0
"^DIC",104.1,104.1,"%D",0)
^1.001^3^3^3090106^^
"^DIC",104.1,104.1,"%D",1,0)
This file contains search criteria used by the MRSA Program Tools 
"^DIC",104.1,104.1,"%D",2,0)
software. This file should only be edited using the MRSA Tools Lab 
"^DIC",104.1,104.1,"%D",3,0)
Parameter Setup option provided with this software.
"^DIC",104.1,"B","MRSA TOOLS LAB SEARCH/EXTRACT",104.1)

"^DIC",104.2,104.2,0)
MDRO TYPES^104.2
"^DIC",104.2,104.2,0,"GL")
^MMRS(104.2,
"^DIC",104.2,104.2,"%",0)
^1.005^^0
"^DIC",104.2,104.2,"%D",0)
^^3^3^3090304^
"^DIC",104.2,104.2,"%D",1,0)
This file contains the different multi-drug resistant organisms (MDROs)
"^DIC",104.2,104.2,"%D",2,0)
that are needed for the MRSA Program Tools software. Entries in this file
"^DIC",104.2,104.2,"%D",3,0)
should not be edited. This file will be maintained by the support team.
"^DIC",104.2,"B","MDRO TYPES",104.2)

"^DIC",104.3,104.3,0)
MRSA WARD MAPPINGS^104.3
"^DIC",104.3,104.3,0,"GL")
^MMRS(104.3,
"^DIC",104.3,104.3,"%",0)
^1.005^^0
"^DIC",104.3,104.3,"%D",0)
^^6^6^3090304^
"^DIC",104.3,104.3,"%D",1,0)
This file contains the Ward Mappings for the MRSA Program Tools software. 
"^DIC",104.3,104.3,"%D",2,0)
Here you will create 'Geographical Units' which consist of one or more 
"^DIC",104.3,104.3,"%D",3,0)
Ward Locations (from file 42). For purposes of the MRSA Program Tools 
"^DIC",104.3,104.3,"%D",4,0)
software all Ward Locations belonging to the same Geographical unit are 
"^DIC",104.3,104.3,"%D",5,0)
one - and any interward transfers between wards belonging to the same 
"^DIC",104.3,104.3,"%D",6,0)
geographical unit will be ignored.
"^DIC",104.3,"B","MRSA WARD MAPPINGS",104.3)

**END**
**END**
