Released MMRS*1*1 SEQ #1
Extracted from mail message
**KIDS**:MMRS*1.0*1^

**INSTALL NAME**
MMRS*1.0*1
"BLD",8025,0)
MMRS*1.0*1^MRSA INITIATIVE REPORTS^0^3100503^y
"BLD",8025,1,0)
^9.61A^2^2^3100420^^
"BLD",8025,1,1,0)
See patch MMRS*1*1 in the National Patch Module on FORUM for complete   
"BLD",8025,1,2,0)
information on this patch.
"BLD",8025,4,0)
^9.64PA^^
"BLD",8025,6)
1^1
"BLD",8025,6.3)
3
"BLD",8025,"ABNS",0)
^9.66A^^
"BLD",8025,"ABPKG")
^
"BLD",8025,"KRN",0)
^9.67PA^779.2^20
"BLD",8025,"KRN",.4,0)
.4
"BLD",8025,"KRN",.401,0)
.401
"BLD",8025,"KRN",.402,0)
.402
"BLD",8025,"KRN",.403,0)
.403
"BLD",8025,"KRN",.5,0)
.5
"BLD",8025,"KRN",.84,0)
.84
"BLD",8025,"KRN",3.6,0)
3.6
"BLD",8025,"KRN",3.8,0)
3.8
"BLD",8025,"KRN",9.2,0)
9.2
"BLD",8025,"KRN",9.8,0)
9.8
"BLD",8025,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",8025,"KRN",9.8,"NM",1,0)
MMRSIPC2^^0^B35335432
"BLD",8025,"KRN",9.8,"NM",2,0)
MMRSIPC3^^0^B106251374
"BLD",8025,"KRN",9.8,"NM",3,0)
MMRSIPC4^^0^B60492862
"BLD",8025,"KRN",9.8,"NM",4,0)
MMRSORD^^0^B42758961
"BLD",8025,"KRN",9.8,"NM","B","MMRSIPC2",1)

"BLD",8025,"KRN",9.8,"NM","B","MMRSIPC3",2)

"BLD",8025,"KRN",9.8,"NM","B","MMRSIPC4",3)

"BLD",8025,"KRN",9.8,"NM","B","MMRSORD",4)

"BLD",8025,"KRN",19,0)
19
"BLD",8025,"KRN",19.1,0)
19.1
"BLD",8025,"KRN",101,0)
101
"BLD",8025,"KRN",409.61,0)
409.61
"BLD",8025,"KRN",771,0)
771
"BLD",8025,"KRN",779.2,0)
779.2
"BLD",8025,"KRN",870,0)
870
"BLD",8025,"KRN",8989.51,0)
8989.51
"BLD",8025,"KRN",8989.52,0)
8989.52
"BLD",8025,"KRN",8994,0)
8994
"BLD",8025,"KRN","B",.4,.4)

"BLD",8025,"KRN","B",.401,.401)

"BLD",8025,"KRN","B",.402,.402)

"BLD",8025,"KRN","B",.403,.403)

"BLD",8025,"KRN","B",.5,.5)

"BLD",8025,"KRN","B",.84,.84)

"BLD",8025,"KRN","B",3.6,3.6)

"BLD",8025,"KRN","B",3.8,3.8)

"BLD",8025,"KRN","B",9.2,9.2)

"BLD",8025,"KRN","B",9.8,9.8)

"BLD",8025,"KRN","B",19,19)

"BLD",8025,"KRN","B",19.1,19.1)

"BLD",8025,"KRN","B",101,101)

"BLD",8025,"KRN","B",409.61,409.61)

"BLD",8025,"KRN","B",771,771)

"BLD",8025,"KRN","B",779.2,779.2)

"BLD",8025,"KRN","B",870,870)

"BLD",8025,"KRN","B",8989.51,8989.51)

"BLD",8025,"KRN","B",8989.52,8989.52)

"BLD",8025,"KRN","B",8994,8994)

"BLD",8025,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",8025,"QUES",0)
^9.62^^
"BLD",8025,"REQB",0)
^9.611^1^1
"BLD",8025,"REQB",1,0)
MMRS 1.0^2
"BLD",8025,"REQB","B","MMRS 1.0",1)

"MBREQ")
0
"PKG",631,-1)
1^1
"PKG",631,0)
MRSA INITIATIVE REPORTS^MMRS^MRSA PREVENTION INITIATIVE
"PKG",631,20,0)
^9.402P^^
"PKG",631,22,0)
^9.49I^1^1
"PKG",631,22,1,0)
1.0^3091030^3100128^41493
"PKG",631,22,1,"PAH",1,0)
1^3100503^41493
"PKG",631,22,1,"PAH",1,1,0)
^^2^2^3100503
"PKG",631,22,1,"PAH",1,1,1,0)
See patch MMRS*1*1 in the National Patch Module on FORUM for complete   
"PKG",631,22,1,"PAH",1,1,2,0)
information on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","MMRSIPC2")
0^1^B35335432^B34845828
"RTN","MMRSIPC2",1,0)
MMRSIPC2 ;MIA/LMT - Print MRSA IPEC Report Cont. (Contains functions to collect patient movements) ;10-20-06
"RTN","MMRSIPC2",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;**1**;Mar 22, 2009;Build 3
"RTN","MMRSIPC2",3,0)
 ;
"RTN","MMRSIPC2",4,0)
GETMOVE ;Collects ward movements for patients that were admitted or discharged in date range.
"RTN","MMRSIPC2",5,0)
 N LOC,DUPLOC,MMRSLOC2
"RTN","MMRSIPC2",6,0)
 S LOC=0 F  S LOC=$O(MMRSLOC(LOC)) Q:'LOC  D
"RTN","MMRSIPC2",7,0)
 .S DUPLOC=$$DUPLOC(LOC,.MMRSLOC)
"RTN","MMRSIPC2",8,0)
 .I 'DUPLOC S MMRSLOC2(LOC)=""
"RTN","MMRSIPC2",9,0)
 .I DUPLOC D
"RTN","MMRSIPC2",10,0)
 ..I BYADM D GETADM(LOC)
"RTN","MMRSIPC2",11,0)
 ..I 'BYADM D GETDIS(LOC)
"RTN","MMRSIPC2",12,0)
 ..I 'BYADM D GETNODIS(LOC) ;For discharge\transmission report show list of patients that have not been discharged yet
"RTN","MMRSIPC2",13,0)
 I '$D(MMRSLOC2) Q
"RTN","MMRSIPC2",14,0)
 I BYADM D GETADM(0)
"RTN","MMRSIPC2",15,0)
 I 'BYADM D GETDIS(0)
"RTN","MMRSIPC2",16,0)
 I 'BYADM D GETNODIS(0) ;For discharge\transmission report show list of patients that have not been discharged yet
"RTN","MMRSIPC2",17,0)
 Q
"RTN","MMRSIPC2",18,0)
GETADM(LOC) ;
"RTN","MMRSIPC2",19,0)
 N TT,MOVDT,MOVIFN,DFN,TRANTYPE,INWARD,INDATE,INIFN,INTT,OUTDATE,OUTIFN,OUTTT,NEXTIEN,LOCNAME,VAIP,INLOC
"RTN","MMRSIPC2",20,0)
 F TT=1,2 S MOVDT=STRTDT-.0000001 F  S MOVDT=$O(^DGPM("ATT"_TT,MOVDT)) Q:(MOVDT>ENDDT)!('MOVDT)  D
"RTN","MMRSIPC2",21,0)
 .S MOVIFN="" F  S MOVIFN=$O(^DGPM("ATT"_TT,MOVDT,MOVIFN)) Q:'MOVIFN  D
"RTN","MMRSIPC2",22,0)
 ..D KVA^VADPT S DFN=$P($G(^DGPM(MOVIFN,0)),"^",3),VAIP("E")=MOVIFN D IN5^VADPT
"RTN","MMRSIPC2",23,0)
 ..S TRANTYPE=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",24,0)
 ..I TRANTYPE<1!(TRANTYPE=3) Q
"RTN","MMRSIPC2",25,0)
 ..S INWARD=+VAIP(5)
"RTN","MMRSIPC2",26,0)
 ..I TRANTYPE=2,'$$CNGWARD(LOC,+VAIP(15,4),INWARD) Q
"RTN","MMRSIPC2",27,0)
 ..Q:$$EXCWARD(LOC,INWARD)
"RTN","MMRSIPC2",28,0)
 ..;SET GLOBAL
"RTN","MMRSIPC2",29,0)
 ..S INDATE=+VAIP(3)
"RTN","MMRSIPC2",30,0)
 ..S INIFN=MOVIFN
"RTN","MMRSIPC2",31,0)
 ..S INTT=TRANTYPE
"RTN","MMRSIPC2",32,0)
 ..S (OUTDATE,OUTIFN,OUTTT)=" "
"RTN","MMRSIPC2",33,0)
 ..F  Q:(VAIP(16)="")!(OUTIFN)  D
"RTN","MMRSIPC2",34,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=3 S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=3
"RTN","MMRSIPC2",35,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=2,$$CNGWARD(LOC,INWARD,+VAIP(16,4)) S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=2
"RTN","MMRSIPC2",36,0)
 ...Q:OUTIFN
"RTN","MMRSIPC2",37,0)
 ...S NEXTIEN=VAIP(16)
"RTN","MMRSIPC2",38,0)
 ...D KVA^VADPT
"RTN","MMRSIPC2",39,0)
 ...S VAIP("E")=NEXTIEN
"RTN","MMRSIPC2",40,0)
 ...D IN5^VADPT
"RTN","MMRSIPC2",41,0)
 ..S INLOC=$G(LOC)
"RTN","MMRSIPC2",42,0)
 ..I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",43,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",44,0)
 ..S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_OUTDATE_U_OUTIFN_U_OUTTT
"RTN","MMRSIPC2",45,0)
 D KVA^VADPT
"RTN","MMRSIPC2",46,0)
 Q
"RTN","MMRSIPC2",47,0)
GETDIS(LOC) ;
"RTN","MMRSIPC2",48,0)
 N TT,MOVDT,MOVIFN,DFN,TRANTYPE,OUTDATE,OUTIFN,OUTTT,INWARD,INDATE,INIFN,INTT,PREVIEN,INLOC,LOCNAME,VAIP
"RTN","MMRSIPC2",49,0)
 F TT=2,3 S MOVDT=STRTDT-.0000001 F  S MOVDT=$O(^DGPM("ATT"_TT,MOVDT)) Q:(MOVDT>ENDDT)!('MOVDT)  D
"RTN","MMRSIPC2",50,0)
 .S MOVIFN="" F  S MOVIFN=$O(^DGPM("ATT"_TT,MOVDT,MOVIFN)) Q:'MOVIFN  D
"RTN","MMRSIPC2",51,0)
 ..D KVA^VADPT S DFN=$P($G(^DGPM(MOVIFN,0)),"^",3),VAIP("E")=MOVIFN D IN5^VADPT
"RTN","MMRSIPC2",52,0)
 ..I +VAIP(2)=3,+VAIP(15,3)=2 Q  ;Ignore discharges that are immediate following an Authorized Absence
"RTN","MMRSIPC2",53,0)
 ..S TRANTYPE=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",54,0)
 ..I TRANTYPE<2 Q
"RTN","MMRSIPC2",55,0)
 ..I TRANTYPE=2,'$$CNGWARD(LOC,+VAIP(15,4),+VAIP(5)) Q
"RTN","MMRSIPC2",56,0)
 ..I $$EXCWARD(LOC,+VAIP(15,4)) Q
"RTN","MMRSIPC2",57,0)
 ..S OUTDATE=+VAIP(3)
"RTN","MMRSIPC2",58,0)
 ..S OUTIFN=MOVIFN
"RTN","MMRSIPC2",59,0)
 ..S OUTTT=TRANTYPE
"RTN","MMRSIPC2",60,0)
 ..S INWARD=+VAIP(15,4)
"RTN","MMRSIPC2",61,0)
 ..S (INDATE,INIFN,INTT)=""
"RTN","MMRSIPC2",62,0)
 ..F  Q:(VAIP(15)="")!(INIFN)  D
"RTN","MMRSIPC2",63,0)
 ...S PREVIEN=VAIP(15)
"RTN","MMRSIPC2",64,0)
 ...I $$TRANTYPE(+VAIP(15,3),+VAIP(15,2))=1 S INDATE=+VAIP(15,1),INIFN=VAIP(15),INTT=1 ;,INWARD=+VAIP(15,4)
"RTN","MMRSIPC2",65,0)
 ...I $$TRANTYPE(+VAIP(15,3),+VAIP(15,2))=2 D
"RTN","MMRSIPC2",66,0)
 ....D KVA^VADPT S VAIP("E")=PREVIEN D IN5^VADPT
"RTN","MMRSIPC2",67,0)
 ....I $$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)) S INDATE=+VAIP(3),INIFN=VAIP(1),INTT=2 ;,INWARD=+VAIP(16,4)
"RTN","MMRSIPC2",68,0)
 ...Q:INIFN
"RTN","MMRSIPC2",69,0)
 ...D KVA^VADPT
"RTN","MMRSIPC2",70,0)
 ...S VAIP("E")=PREVIEN
"RTN","MMRSIPC2",71,0)
 ...D IN5^VADPT
"RTN","MMRSIPC2",72,0)
 ..I '$G(INIFN) Q
"RTN","MMRSIPC2",73,0)
 ..S INLOC=$G(LOC)
"RTN","MMRSIPC2",74,0)
 ..I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",75,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",76,0)
 ..S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_OUTDATE_U_OUTIFN_U_OUTTT
"RTN","MMRSIPC2",77,0)
 D KVA^VADPT
"RTN","MMRSIPC2",78,0)
 Q
"RTN","MMRSIPC2",79,0)
GETNODIS(LOC) ;For Discharge/Transmission report, it adds patients that have not been discharged from the wards to the report
"RTN","MMRSIPC2",80,0)
 N WARD,DFN,TMP,EDT,TT,SDT,INWARD,IEN,INDATE,INTT,INIFN,INLOC,LOCNAME,VAIP
"RTN","MMRSIPC2",81,0)
 S WARD="" F  S WARD=$O(^DPT("CN",WARD)) Q:WARD=""  D
"RTN","MMRSIPC2",82,0)
 .S DFN=0 F  S DFN=$O(^DPT("CN",WARD,DFN)) Q:'DFN  S TMP(DFN)=""
"RTN","MMRSIPC2",83,0)
 S EDT=$$NOW^XLFDT
"RTN","MMRSIPC2",84,0)
 F TT=1:1:3 S SDT=ENDDT F  S SDT=$O(^DGPM("AMV"_TT,SDT)) Q:'SDT!(SDT>EDT)  D
"RTN","MMRSIPC2",85,0)
 .S DFN=0 F  S DFN=$O(^DGPM("AMV"_TT,SDT,DFN)) Q:'DFN  S TMP(DFN)=""
"RTN","MMRSIPC2",86,0)
 S DFN=0 F  S DFN=$O(TMP(DFN)) Q:'DFN  D
"RTN","MMRSIPC2",87,0)
 .D KVA^VADPT
"RTN","MMRSIPC2",88,0)
 .S VAIP("D")=ENDDT
"RTN","MMRSIPC2",89,0)
 .D IN5^VADPT
"RTN","MMRSIPC2",90,0)
 .I 'VAIP(1) Q
"RTN","MMRSIPC2",91,0)
 .S INWARD=+VAIP(5)
"RTN","MMRSIPC2",92,0)
 .Q:$$EXCWARD(LOC,INWARD)
"RTN","MMRSIPC2",93,0)
 .S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",94,0)
 .;F  Q:((+VAIP(2)=1)!(VAIP(15)="")!(+VAIP(5)'=+VAIP(15,4)))  D
"RTN","MMRSIPC2",95,0)
 .;F  Q:(((INTT=1)!(INTT=2))&((+VAIP(2)=1)!(VAIP(15)="")!($$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)))))  D
"RTN","MMRSIPC2",96,0)
 .F  Q:(INTT=1)!(INTT=2&$$CNGWARD(LOC,+VAIP(5),+VAIP(15,4)))!(VAIP(15)="")  D
"RTN","MMRSIPC2",97,0)
 ..S IEN=+VAIP(15)
"RTN","MMRSIPC2",98,0)
 ..D KVA^VADPT
"RTN","MMRSIPC2",99,0)
 ..S VAIP("E")=IEN
"RTN","MMRSIPC2",100,0)
 ..D IN5^VADPT
"RTN","MMRSIPC2",101,0)
 ..S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",102,0)
 .I INTT<1!(INTT>2) Q
"RTN","MMRSIPC2",103,0)
 .S INDATE=+VAIP(3)
"RTN","MMRSIPC2",104,0)
 .S INIFN=+VAIP(1)
"RTN","MMRSIPC2",105,0)
 .;S INTT=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSIPC2",106,0)
 .I '$G(INIFN) Q
"RTN","MMRSIPC2",107,0)
 .S INLOC=$G(LOC)
"RTN","MMRSIPC2",108,0)
 .I +INLOC=0 S INLOC=$$GETLOC(INWARD,.MMRSLOC2)
"RTN","MMRSIPC2",109,0)
 .S LOCNAME=$P($G(^MMRS(104.3,INLOC,0)),U)
"RTN","MMRSIPC2",110,0)
 .S ^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN," ")=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_" "_U_"0"_U_" "
"RTN","MMRSIPC2",111,0)
 D KVA^VADPT
"RTN","MMRSIPC2",112,0)
 Q
"RTN","MMRSIPC2",113,0)
CNGWARD(LOC,WARD1,WARD2) ;Did patient change wards?
"RTN","MMRSIPC2",114,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD1,.MMRSLOC2)
"RTN","MMRSIPC2",115,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD1)),$D(^MMRS(104.3,LOC,1,"B",WARD2)) Q 0
"RTN","MMRSIPC2",116,0)
 Q 1
"RTN","MMRSIPC2",117,0)
EXCWARD(LOC,WARD) ;Is this ward excluded from the reports?
"RTN","MMRSIPC2",118,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD,.MMRSLOC2)
"RTN","MMRSIPC2",119,0)
 I LOC=0 Q 1
"RTN","MMRSIPC2",120,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD)) Q 0
"RTN","MMRSIPC2",121,0)
 Q 1
"RTN","MMRSIPC2",122,0)
DUPLOC(LOC,LCTNS) ;
"RTN","MMRSIPC2",123,0)
 N RSLT,WARD,LOC2
"RTN","MMRSIPC2",124,0)
 S RSLT=0
"RTN","MMRSIPC2",125,0)
 S WARD=0 F  S WARD=$O(^MMRS(104.3,LOC,1,"B",WARD)) Q:'WARD  D
"RTN","MMRSIPC2",126,0)
 .S LOC2=0 F  S LOC2=$O(LCTNS(LOC2)) Q:'LOC2  D
"RTN","MMRSIPC2",127,0)
 ..Q:LOC2=LOC
"RTN","MMRSIPC2",128,0)
 ..I $D(^MMRS(104.3,LOC2,1,"B",WARD)) S RSLT=1
"RTN","MMRSIPC2",129,0)
 Q RSLT
"RTN","MMRSIPC2",130,0)
GETLOC(WARD,LCTNS) ;
"RTN","MMRSIPC2",131,0)
 N RSLT,LOC
"RTN","MMRSIPC2",132,0)
 S RSLT=0
"RTN","MMRSIPC2",133,0)
 S LOC=0 F  S LOC=$O(LCTNS(LOC)) Q:'LOC!(RSLT)  D
"RTN","MMRSIPC2",134,0)
 .I $D(^MMRS(104.3,LOC,1,"B",WARD)) S RSLT=LOC
"RTN","MMRSIPC2",135,0)
 Q RSLT
"RTN","MMRSIPC2",136,0)
TRANTYPE(MOVTYPE,TRANTYPE) ;
"RTN","MMRSIPC2",137,0)
 I MOVTYPE=46!(MOVTYPE=5)!(MOVTYPE=6)!(MOVTYPE=7)!(MOVTYPE=47)!(MOVTYPE=27)!(MOVTYPE=33)!(MOVTYPE=3)!(MOVTYPE=22) Q -1 ;MIA/LMT - Removed MOVTYPE 29 ;4/15/10
"RTN","MMRSIPC2",138,0)
 I MOVTYPE=42!(MOVTYPE=20)!(MOVTYPE=1)!(MOVTYPE=45)!(MOVTYPE=23)!(MOVTYPE=25)!(MOVTYPE=26) Q -1
"RTN","MMRSIPC2",139,0)
 I MOVTYPE=2!(MOVTYPE=43)!(MOVTYPE=13) Q 3
"RTN","MMRSIPC2",140,0)
 I MOVTYPE=14!(MOVTYPE=24)!(MOVTYPE=44) Q 1
"RTN","MMRSIPC2",141,0)
 Q TRANTYPE
"RTN","MMRSIPC3")
0^2^B106251374^B103482398
"RTN","MMRSIPC3",1,0)
MMRSIPC3 ;MIA/LMT - Print MRSA Report Cont. (Contains functions to collect patient labs and swabbing rate) ;10-20-06
"RTN","MMRSIPC3",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;**1**;Mar 22, 2009;Build 3
"RTN","MMRSIPC3",3,0)
 ;
"RTN","MMRSIPC3",4,0)
GETLABS ;Gets all lab data for the report.
"RTN","MMRSIPC3",5,0)
 N MRSAMDRO,LOC,INDT,DFN,OUTDT,NARES24,NARES48,SURV48,CULT48,MRSA365,CULT365,KNOWMRSA,KNOWCULT,NARES24A,NARES48ASURV48A,NARES48A
"RTN","MMRSIPC3",6,0)
 N MRSAFR,MRSATO,MRSA365A,CULT365A,SURV48A,NARES24D,NARES48D,SURV48D,MRSACPRD,TRANS
"RTN","MMRSIPC3",7,0)
 S MRSAMDRO=$O(^MMRS(104.2,"B","MRSA",0))
"RTN","MMRSIPC3",8,0)
 S ^TMP($J,"MMRSIPC","DSUM")="0^0^0^0^0^0^0^0^0"
"RTN","MMRSIPC3",9,0)
 S LOC="" F  S LOC=$O(^TMP($J,"MMRSIPC","D",LOC)) Q:LOC=""  D
"RTN","MMRSIPC3",10,0)
 .S ^TMP($J,"MMRSIPC","DSUM",LOC)="0^0^0^0^0^0^0^0^0"
"RTN","MMRSIPC3",11,0)
 .S INDT=0 F  S INDT=$O(^TMP($J,"MMRSIPC","D",LOC,INDT)) Q:'INDT  D
"RTN","MMRSIPC3",12,0)
 ..S DFN=0 F  S DFN=$O(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN)) Q:'DFN  D
"RTN","MMRSIPC3",13,0)
 ...S OUTDT=0 F  S OUTDT=$O(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)) Q:OUTDT=""  D
"RTN","MMRSIPC3",14,0)
 ....I BYADM D
"RTN","MMRSIPC3",15,0)
 .....S NARES24=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-24),$$FMADD^XLFDT(INDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",16,0)
 .....S NARES48=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",17,0)
 .....S SURV48=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",18,0)
 .....I NARES48'["POS",SURV48["POS" S NARES48=SURV48
"RTN","MMRSIPC3",19,0)
 .....S CULT48=$P($$GETLAB(DFN,"MRSA_CULTURE",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2) ;$$GETMCULT(DFN,$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD")
"RTN","MMRSIPC3",20,0)
 .....S MRSA365=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(INDT,-365),INDT,"CD"),U,2)
"RTN","MMRSIPC3",21,0)
 .....I $P($G(^MMRS(104,MMRSDIV,0)),U,4)=0 D
"RTN","MMRSIPC3",22,0)
 ......S KNOWMRSA=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(INDT,-365),INDT,"RAD"),U,2)
"RTN","MMRSIPC3",23,0)
 .....S ^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)=^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)_U_NARES24_U_NARES48_U_CULT48_U_MRSA365
"RTN","MMRSIPC3",24,0)
 ....I 'BYADM D
"RTN","MMRSIPC3",25,0)
 .....S NARES24A=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-24),$$FMADD^XLFDT(INDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",26,0)
 .....S NARES48A=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",27,0)
 .....S SURV48A=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(INDT,0,-48),$$FMADD^XLFDT(INDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",28,0)
 .....I NARES48A'["POS",SURV48A["POS" S NARES48A=SURV48A
"RTN","MMRSIPC3",29,0)
 .....S MRSAFR=(INDT-10000) I STRTDT>INDT S MRSAFR=(STRTDT-10000) ;(ADM - 1 year) or  (START DT - 1 year) - whichever is later
"RTN","MMRSIPC3",30,0)
 .....S MRSATO=$$FMADD^XLFDT(INDT,0,48,0,0) I STRTDT>MRSATO S MRSATO=STRTDT ;(ADM + 48 HRS) OR (START DT) - WHICHEVER IS GREATER
"RTN","MMRSIPC3",31,0)
 .....S MRSA365A=$P($$GETLAB(DFN,MRSAMDRO,MRSAFR,MRSATO,"CD"),U,2)
"RTN","MMRSIPC3",32,0)
 .....S (NARES24D,NARES48D,SURV48D)=""
"RTN","MMRSIPC3",33,0)
 .....I OUTDT D
"RTN","MMRSIPC3",34,0)
 ......S NARES24D=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(OUTDT,0,-24),$$FMADD^XLFDT(OUTDT,0,24),"CD"),U,1)
"RTN","MMRSIPC3",35,0)
 ......S NARES48D=$P($$GETLAB(DFN,"MRSA_SCREEN",$$FMADD^XLFDT(OUTDT,0,-48),$$FMADD^XLFDT(OUTDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",36,0)
 ......S SURV48D=$P($$GETLAB(DFN,"MRSA_SURV",$$FMADD^XLFDT(OUTDT,0,-48),$$FMADD^XLFDT(OUTDT,0,48),"CD"),U,2)
"RTN","MMRSIPC3",37,0)
 ......I NARES48D'["POS",SURV48D["POS" S NARES48D=SURV48D
"RTN","MMRSIPC3",38,0)
 .....S MRSAFR=$$FMADD^XLFDT(INDT,0,48,0,0) I STRTDT>MRSAFR S MRSAFR=STRTDT ;(ADM + 48 HRS) OR (START DT) - WHICHEVER IS LATER
"RTN","MMRSIPC3",39,0)
 .....S MRSATO=ENDDT I +OUTDT S MRSATO=$$FMADD^XLFDT(OUTDT,0,48,0,0) ;(DIS + 48 HRS) OR (END DT) - WHICHEVER IS EARLIER
"RTN","MMRSIPC3",40,0)
 .....S MRSACPRD=$P($$GETLAB(DFN,MRSAMDRO,MRSAFR,MRSATO,"CD"),U,2)
"RTN","MMRSIPC3",41,0)
 .....I $P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,OUTDT D
"RTN","MMRSIPC3",42,0)
 ......S KNOWMRSA=$P($$GETLAB(DFN,MRSAMDRO,$$FMADD^XLFDT(OUTDT,-365),OUTDT,"RAD"),U,2)
"RTN","MMRSIPC3",43,0)
 .....S TRANS=""
"RTN","MMRSIPC3",44,0)
 .....I NARES48A'["POS",MRSA365A'["POS",(($G(NARES48D)["POS")!(MRSACPRD["POS")) S TRANS="T"
"RTN","MMRSIPC3",45,0)
 .....S ^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)=^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT)_U_NARES24A_U_NARES48A_U_MRSA365A_U_$G(NARES24D)_U_$G(NARES48D)_U_MRSACPRD_U_TRANS
"RTN","MMRSIPC3",46,0)
 ....D PREV ;Calculate prevalence measures
"RTN","MMRSIPC3",47,0)
 Q
"RTN","MMRSIPC3",48,0)
PREV ;Calculate prevalence measures (summary report)
"RTN","MMRSIPC3",49,0)
 N LOCSUM,SUM,DATA,IND
"RTN","MMRSIPC3",50,0)
 S LOCSUM=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC3",51,0)
 S SUM=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC3",52,0)
 S DATA=$G(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT))
"RTN","MMRSIPC3",53,0)
 I BYADM D
"RTN","MMRSIPC3",54,0)
 .I $P(DATA,U,5)=1 D
"RTN","MMRSIPC3",55,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,1)=$P(LOCSUM,U,1)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,1)=$P(SUM,U,1)+1
"RTN","MMRSIPC3",56,0)
 ..I NARES24["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,2)=$P(LOCSUM,U,2)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,2)=$P(SUM,U,2)+1
"RTN","MMRSIPC3",57,0)
 ..I (NARES48["POS"!(MRSA365["POS")),CULT48'["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,3)=$P(LOCSUM,U,3)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,3)=$P(SUM,U,3)+1
"RTN","MMRSIPC3",58,0)
 ..I CULT48["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,4)=$P(LOCSUM,U,4)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,4)=$P(SUM,U,4)+1
"RTN","MMRSIPC3",59,0)
 .S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,5)=$P(LOCSUM,U,5)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,5)=$P(SUM,U,5)+1
"RTN","MMRSIPC3",60,0)
 .S IND=0
"RTN","MMRSIPC3",61,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,4)=1 S IND=1
"RTN","MMRSIPC3",62,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,4)=0,($P(DATA,U,5)=1!(KNOWMRSA'["POS")) S IND=1
"RTN","MMRSIPC3",63,0)
 .I $P($G(^MMRS(104,MMRSDIV,0)),U,2)=0,$P(DATA,U,5)=1 S IND=1
"RTN","MMRSIPC3",64,0)
 .S $P(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT),U,13)=IND ;MIA/LMT - Add if patient was indicated ;3/16/10
"RTN","MMRSIPC3",65,0)
 .I IND D
"RTN","MMRSIPC3",66,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,6)=$P(LOCSUM,U,6)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,6)=$P(SUM,U,6)+1
"RTN","MMRSIPC3",67,0)
 ..I NARES24["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,7)=$P(LOCSUM,U,7)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,7)=$P(SUM,U,7)+1
"RTN","MMRSIPC3",68,0)
 .I (NARES48["POS"!(MRSA365["POS")),CULT48'["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSIPC3",69,0)
 .I CULT48["POS" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,9)=$P(LOCSUM,U,9)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,9)=$P(SUM,U,9)+1
"RTN","MMRSIPC3",70,0)
 I 'BYADM D
"RTN","MMRSIPC3",71,0)
 .I $P(DATA,U,8)=3!($P(DATA,U,8)=2) D
"RTN","MMRSIPC3",72,0)
 ..S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,2)=$P(LOCSUM,U,2)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,2)=$P(SUM,U,2)+1
"RTN","MMRSIPC3",73,0)
 ..S IND=0
"RTN","MMRSIPC3",74,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=1 S IND=1
"RTN","MMRSIPC3",75,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=1,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,KNOWMRSA'["POS" S IND=1
"RTN","MMRSIPC3",76,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=0,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=0,$P(DATA,U,8)=3,KNOWMRSA'["POS" S IND=1
"RTN","MMRSIPC3",77,0)
 ..I $P($G(^MMRS(104,MMRSDIV,0)),U,3)=0,$P($G(^MMRS(104,MMRSDIV,0)),U,5)=1,$P(DATA,U,8)=3 S IND=1
"RTN","MMRSIPC3",78,0)
 ..S $P(^TMP($J,"MMRSIPC","D",LOC,INDT,DFN,OUTDT),U,16)=IND ;MIA/LMT - Add if patient was indicated ;3/16/10
"RTN","MMRSIPC3",79,0)
 ..I IND=1 D
"RTN","MMRSIPC3",80,0)
 ...S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,3)=$P(LOCSUM,U,3)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,3)=$P(SUM,U,3)+1
"RTN","MMRSIPC3",81,0)
 ...I NARES24D["Y" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,4)=$P(LOCSUM,U,4)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,4)=$P(SUM,U,4)+1
"RTN","MMRSIPC3",82,0)
 .I TRANS="T" S $P(^TMP($J,"MMRSIPC","DSUM",LOC),U,5)=$P(LOCSUM,U,5)+1,$P(^TMP($J,"MMRSIPC","DSUM"),U,5)=$P(SUM,U,5)+1
"RTN","MMRSIPC3",83,0)
 Q
"RTN","MMRSIPC3",84,0)
GETLAB(DFN,LRMDRO,LRSTART,LREND,LRDTTYP) ;RETURN YES/NO^RESULT
"RTN","MMRSIPC3",85,0)
 N LRRSLT,LRTST,TMPRSLT
"RTN","MMRSIPC3",86,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",87,0)
 I $G(DFN)=""!($G(LRMDRO)="")!($G(LRSTART)="")!($G(LREND)="") Q LRRSLT
"RTN","MMRSIPC3",88,0)
 ;GET CH RSLTS
"RTN","MMRSIPC3",89,0)
 S LRTST=0 F  S LRTST=$O(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST)) Q:'LRTST  D
"RTN","MMRSIPC3",90,0)
 .S TMPRSLT=$$GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP)
"RTN","MMRSIPC3",91,0)
 .I $P(LRRSLT,U)'="Y" S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",92,0)
 .I $P(TMPRSLT,U,2)["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>$P($P(TMPRSLT,"^",2),";",3))) D
"RTN","MMRSIPC3",93,0)
 ..S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",94,0)
 ;GET MI RSLTS
"RTN","MMRSIPC3",95,0)
 S TMPRSLT=$$GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP)
"RTN","MMRSIPC3",96,0)
 I $P(LRRSLT,U)'="Y" S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",97,0)
 I $P(TMPRSLT,U,2)["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>$P($P(TMPRSLT,"^",2),";",3))) D
"RTN","MMRSIPC3",98,0)
 .S LRRSLT=TMPRSLT
"RTN","MMRSIPC3",99,0)
 Q LRRSLT
"RTN","MMRSIPC3",100,0)
GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP) ;RETURN YES^RESULT
"RTN","MMRSIPC3",101,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD
"RTN","MMRSIPC3",102,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",103,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSIPC3",104,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSIPC3",105,0)
 S LRDATE=LRSTART-.0000001
"RTN","MMRSIPC3",106,0)
 I LRDTTYP="RAD" S LRDATE=0,LRRADEND=LREND,LREND=9999999
"RTN","MMRSIPC3",107,0)
 F  S LRDATE=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE)) Q:'LRDATE!(LRDATE>LREND)  D
"RTN","MMRSIPC3",108,0)
 .S DAS=0 F  S DAS=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE,DAS)) Q:'DAS  D
"RTN","MMRSIPC3",109,0)
 ..S LRIDT=$P(DAS,";",3)
"RTN","MMRSIPC3",110,0)
 ..I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LRRADEND) Q
"RTN","MMRSIPC3",111,0)
 ..Q:$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3)=""
"RTN","MMRSIPC3",112,0)
 ..S LRSITE=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5)
"RTN","MMRSIPC3",113,0)
 ..;Q:$$SCRNTOP(LRSITE,LRMDRO)
"RTN","MMRSIPC3",114,0)
 ..;I $D(^LR(LRDFN,"CH",LRIDT,0)),$P(^LR(LRDFN,"CH",LRIDT,0),U,3) D
"RTN","MMRSIPC3",115,0)
 ..S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSIPC3",116,0)
 ..S TSTRSLT=$$CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST)
"RTN","MMRSIPC3",117,0)
 ..I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSIPC3",118,0)
 ...S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";CH")
"RTN","MMRSIPC3",119,0)
 Q LRRSLT
"RTN","MMRSIPC3",120,0)
GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP) ;RETURN YES^RESULT
"RTN","MMRSIPC3",121,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD,LRIEND
"RTN","MMRSIPC3",122,0)
 S LRRSLT="^"
"RTN","MMRSIPC3",123,0)
 I '$D(^TMP($J,"MMRSIPC","BACT",LRMDRO,"INC_REMARK")),'$D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO)) Q LRRSLT
"RTN","MMRSIPC3",124,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSIPC3",125,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSIPC3",126,0)
 S LRIDT=(9999999-LREND)-.0000001
"RTN","MMRSIPC3",127,0)
 S LRIEND=9999999-LRSTART
"RTN","MMRSIPC3",128,0)
 I LRDTTYP="RAD" S LRIDT=0,LRIEND=99999999
"RTN","MMRSIPC3",129,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:'LRIDT!(LRIDT>LRIEND)  D
"RTN","MMRSIPC3",130,0)
 .I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LREND) Q
"RTN","MMRSIPC3",131,0)
 .;Q:$P($G(^LR(LRDFN,"MI",LRIDT,1)),U,2)'="F"
"RTN","MMRSIPC3",132,0)
 .S LRSITE=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,5)
"RTN","MMRSIPC3",133,0)
 .;Q:$$SCRNTOP(LRSITE,LRMDRO)
"RTN","MMRSIPC3",134,0)
 .;I $D(^LR(LRDFN,"MI",LRIDT,0)),$P(^LR(LRDFN,"MI",LRIDT,1),U) D
"RTN","MMRSIPC3",135,0)
 .S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSIPC3",136,0)
 .S TSTRSLT=$$MIRSLT(LRDFN,LRIDT,LRMDRO)
"RTN","MMRSIPC3",137,0)
 .I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSIPC3",138,0)
 ..S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSIPC3",139,0)
 Q LRRSLT
"RTN","MMRSIPC3",140,0)
CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSIPC3",141,0)
 N RESULT,LRLOC,LRND,LRPC,LRRES,LRIND,LRINDVAL,LRSPEC,LRLOW,LRHIG
"RTN","MMRSIPC3",142,0)
 S RESULT=""
"RTN","MMRSIPC3",143,0)
 S LRLOC=$P($G(^LAB(60,+LRTST,0)),U,5)
"RTN","MMRSIPC3",144,0)
 S LRND=$P(LRLOC,";",2) Q:+LRND'>0 RESULT
"RTN","MMRSIPC3",145,0)
 S LRPC=$P(LRLOC,";",3) Q:+LRPC'>0 RESULT
"RTN","MMRSIPC3",146,0)
 S LRRES=$P($G(^LR(LRDFN,"CH",LRIDT,LRND)),U,LRPC) Q:LRRES="" RESULT
"RTN","MMRSIPC3",147,0)
 S LRIND=$P($G(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST,0)),U,1)
"RTN","MMRSIPC3",148,0)
 S LRINDVAL=$P($G(^TMP($J,"MMRSIPC","T",LRMDRO,LRTST,0)),U,2)
"RTN","MMRSIPC3",149,0)
 Q:LRIND="" RESULT
"RTN","MMRSIPC3",150,0)
 I LRIND=1 D  Q RESULT
"RTN","MMRSIPC3",151,0)
 .Q:'LRRES
"RTN","MMRSIPC3",152,0)
 .S LRSPEC=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5) Q:LRSPEC=""
"RTN","MMRSIPC3",153,0)
 .Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","MMRSIPC3",154,0)
 .S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^LAB(60,LRTST,1,LRSPEC,0),U,3)
"RTN","MMRSIPC3",155,0)
 .Q:'LRLOW!('LRHIG)
"RTN","MMRSIPC3",156,0)
 .I LRRES<LRLOW!(LRRES>LRHIG) S RESULT="POS" Q
"RTN","MMRSIPC3",157,0)
 I LRINDVAL="" Q RESULT
"RTN","MMRSIPC3",158,0)
 S LRRES=$$UP^XLFSTR(LRRES),LRINDVAL=$$UP^XLFSTR(LRINDVAL)
"RTN","MMRSIPC3",159,0)
 I LRIND=2,(LRRES[LRINDVAL) Q "POS"
"RTN","MMRSIPC3",160,0)
 I LRIND=3,(LRRES>LRINDVAL) Q "POS"
"RTN","MMRSIPC3",161,0)
 I LRIND=4,(LRRES<LRINDVAL) Q "POS"
"RTN","MMRSIPC3",162,0)
 I LRIND=5,(LRRES=LRINDVAL) Q "POS"
"RTN","MMRSIPC3",163,0)
 Q RESULT
"RTN","MMRSIPC3",164,0)
MIRSLT(LRDFN,LRIDT,LRMDRO) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSIPC3",165,0)
 N RESULT,LRETND,LRETI,LRANTI,LRANTIND,LRANTINV,LRAND,LRRES,BACTRPT,RPTRMRK
"RTN","MMRSIPC3",166,0)
 S RESULT=""
"RTN","MMRSIPC3",167,0)
 ;Check Etiology
"RTN","MMRSIPC3",168,0)
 I $D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO)) D  Q:RESULT="POS" RESULT
"RTN","MMRSIPC3",169,0)
 .S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRIDT,3,LRETND)) Q:'LRETND!(RESULT="POS")  D
"RTN","MMRSIPC3",170,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,0)),U)
"RTN","MMRSIPC3",171,0)
 ..Q:+LRETI'>0
"RTN","MMRSIPC3",172,0)
 ..I ('$O(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,0))) D  Q
"RTN","MMRSIPC3",173,0)
 ...I $D(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI)) S RESULT="POS"
"RTN","MMRSIPC3",174,0)
 ..S LRANTI=0 F  S LRANTI=$O(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI)) Q:'LRANTI  D
"RTN","MMRSIPC3",175,0)
 ...S LRANTIND=$P(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI),U,1)
"RTN","MMRSIPC3",176,0)
 ...S LRANTINV=$P(^TMP($J,"MMRSIPC","ETIOL",LRMDRO,LRETI,LRANTI),U,2)
"RTN","MMRSIPC3",177,0)
 ...;S LRAND=$P($G(^LAB(62.06,LRANTI,0)),U,2) Q:LRAND=""
"RTN","MMRSIPC3",178,0)
 ...S LRAND=$$ABDN^LRPXAPIU(LRANTI) Q:'LRAND
"RTN","MMRSIPC3",179,0)
 ...Q:$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2)=""
"RTN","MMRSIPC3",180,0)
 ...Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))="S"
"RTN","MMRSIPC3",181,0)
 ...I LRANTIND=""!(LRANTINV="") Q
"RTN","MMRSIPC3",182,0)
 ...;S LRRES=$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))
"RTN","MMRSIPC3",183,0)
 ...S LRRES=$$UP^XLFSTR($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2))
"RTN","MMRSIPC3",184,0)
 ...S LRANTINV=$$UP^XLFSTR(LRANTINV)
"RTN","MMRSIPC3",185,0)
 ...S LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","MMRSIPC3",186,0)
 ...I LRANTIND=1,(LRRES[LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",187,0)
 ...I LRANTIND=2,(LRRES>LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",188,0)
 ...I LRANTIND=3,(LRRES<LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",189,0)
 ...I LRANTIND=4,(LRRES=LRANTINV) S RESULT="POS" Q
"RTN","MMRSIPC3",190,0)
 Q:RESULT="POS" "POS"
"RTN","MMRSIPC3",191,0)
 ;Check Bacteriology Report Remarks
"RTN","MMRSIPC3",192,0)
 I '$D(^TMP($J,"MMRSIPC","BACT",LRMDRO,"INC_REMARK")) Q RESULT
"RTN","MMRSIPC3",193,0)
 S BACTRPT=0 F  S BACTRPT=$O(^LR(LRDFN,"MI",LRIDT,4,BACTRPT)) Q:'BACTRPT!(RESULT="POS")  D
"RTN","MMRSIPC3",194,0)
 .S RPTRMRK=$P($G(^LR(LRDFN,"MI",LRIDT,4,BACTRPT,0)),U,1)
"RTN","MMRSIPC3",195,0)
 .Q:RPTRMRK=""
"RTN","MMRSIPC3",196,0)
 .I $$BACTRPT(LRMDRO,"INC_REMARK",RPTRMRK)&('$$BACTRPT(LRMDRO,"EXC_REMARK",RPTRMRK)) S RESULT="POS"
"RTN","MMRSIPC3",197,0)
 Q RESULT
"RTN","MMRSIPC3",198,0)
SCRNTOP(LRSITE,LRMDRO) ;CHECK TO SEE IF SCREEN ON SITE
"RTN","MMRSIPC3",199,0)
 Q:+LRSITE'>0 0
"RTN","MMRSIPC3",200,0)
 I $D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP"))&$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSIPC3",201,0)
 I '$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP"))&'$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSIPC3",202,0)
 I ($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP")))&($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"INC_TOP",LRSITE))) Q 0
"RTN","MMRSIPC3",203,0)
 I ($D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP")))&('$D(^TMP($J,"MMRSIPC","TOP",LRMDRO,"EXC_TOP",LRSITE))) Q 0
"RTN","MMRSIPC3",204,0)
 Q 1
"RTN","MMRSIPC3",205,0)
BACTRPT(LRMDRO,RPTTYPE,RPTRMRK) ;Is this comment contained in the parameters
"RTN","MMRSIPC3",206,0)
 N RESULT,MMRSI,LRINDVAL
"RTN","MMRSIPC3",207,0)
 S RESULT=0
"RTN","MMRSIPC3",208,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSIPC","BACT",LRMDRO,RPTTYPE,MMRSI)) Q:'MMRSI!(RESULT=1)  D
"RTN","MMRSIPC3",209,0)
 .S LRINDVAL=$G(^TMP($J,"MMRSIPC","BACT",LRMDRO,RPTTYPE,MMRSI))
"RTN","MMRSIPC3",210,0)
 .I ($$UP^XLFSTR(RPTRMRK))[($$UP^XLFSTR(LRINDVAL)) S RESULT=1
"RTN","MMRSIPC3",211,0)
 Q RESULT
"RTN","MMRSIPC4")
0^3^B60492862^B58171274
"RTN","MMRSIPC4",1,0)
MMRSIPC4 ;MIA/LMT - Print MRSA Report Cont. (Contains functions to print report) ;10-20-06
"RTN","MMRSIPC4",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;**1**;Mar 22, 2009;Build 3
"RTN","MMRSIPC4",3,0)
 ;
"RTN","MMRSIPC4",4,0)
PRINT ;Prints report data
"RTN","MMRSIPC4",5,0)
 N PG,MMRSNOW,NUMLOCS,LOCNAME,LN,PREVLOC,INDATE,DFN,OUTDATE,DATA
"RTN","MMRSIPC4",6,0)
 S PG=1
"RTN","MMRSIPC4",7,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSIPC4",8,0)
 S NUMLOCS=0
"RTN","MMRSIPC4",9,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  S NUMLOCS=NUMLOCS+1
"RTN","MMRSIPC4",10,0)
 I PRTSUM D  Q
"RTN","MMRSIPC4",11,0)
 .S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSIPC4",12,0)
 ..D:BYADM PRTSUMA(LOCNAME) D:'BYADM PRTSUMD(LOCNAME)
"RTN","MMRSIPC4",13,0)
 .I NUMLOCS>1 D:BYADM PRTSUMA() D:'BYADM PRTSUMD()
"RTN","MMRSIPC4",14,0)
 I BYADM S $P(LN,"-",120)=""
"RTN","MMRSIPC4",15,0)
 I 'BYADM S $P(LN,"-",171)=""
"RTN","MMRSIPC4",16,0)
 S PREVLOC=""
"RTN","MMRSIPC4",17,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSIPC","D",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSIPC4",18,0)
 .I PREVLOC'="" D:BYADM PRTSUMA(PREVLOC) D:'BYADM PRTSUMD(PREVLOC)
"RTN","MMRSIPC4",19,0)
 .S PREVLOC=LOCNAME
"RTN","MMRSIPC4",20,0)
 .I BYADM D PRTHDRA
"RTN","MMRSIPC4",21,0)
 .I 'BYADM D PRTHDRD
"RTN","MMRSIPC4",22,0)
 .S INDATE="" F  S INDATE=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE)) Q:INDATE=""  D
"RTN","MMRSIPC4",23,0)
 ..S DFN="" F  S DFN=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN)) Q:DFN=""  D
"RTN","MMRSIPC4",24,0)
 ...S OUTDATE="" F  S OUTDATE=$O(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE)) Q:OUTDATE=""  D
"RTN","MMRSIPC4",25,0)
 ....S DATA=$G(^TMP($J,"MMRSIPC","D",LOCNAME,INDATE,DFN,OUTDATE))
"RTN","MMRSIPC4",26,0)
 ....I BYADM D PRINTADM(DATA)
"RTN","MMRSIPC4",27,0)
 ....I 'BYADM D PRINTDIS(DATA)
"RTN","MMRSIPC4",28,0)
 I BYADM D PRTSUMA(PREVLOC) I NUMLOCS>1 D PRTSUMA()
"RTN","MMRSIPC4",29,0)
 I 'BYADM D PRTSUMD(PREVLOC) I NUMLOCS>1 D PRTSUMD()
"RTN","MMRSIPC4",30,0)
 Q
"RTN","MMRSIPC4",31,0)
PRINTADM(DATA) ; Print cont.
"RTN","MMRSIPC4",32,0)
 N PATIENT,LAST4,INDATEE,INTT,ADT,MOVTYPE,NARES24,NARES48,CULT48,MRSA365,VADM,VAIP,WARD,IND
"RTN","MMRSIPC4",33,0)
 D KVA^VADPT
"RTN","MMRSIPC4",34,0)
 D DEM^VADPT
"RTN","MMRSIPC4",35,0)
 S PATIENT=VADM(1)
"RTN","MMRSIPC4",36,0)
 S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSIPC4",37,0)
 D KVA^VADPT
"RTN","MMRSIPC4",38,0)
 S INDATEE=$$FMTE^XLFDT(INDATE,"2M")
"RTN","MMRSIPC4",39,0)
 S INTT=$P(DATA,U,5)
"RTN","MMRSIPC4",40,0)
 S ADT=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSIPC4",41,0)
 D KVA^VADPT S VAIP("E")=$P(DATA,U,4) D IN5^VADPT
"RTN","MMRSIPC4",42,0)
 S MOVTYPE=$E($P(VAIP(4),U,2),1,13)
"RTN","MMRSIPC4",43,0)
 S WARD=$E($P(VAIP(5),U,2),1,13)
"RTN","MMRSIPC4",44,0)
 D KVA^VADPT
"RTN","MMRSIPC4",45,0)
 S NARES24=$P(DATA,U,9)
"RTN","MMRSIPC4",46,0)
 S NARES48=$P($P(DATA,U,10),";")
"RTN","MMRSIPC4",47,0)
 S CULT48=$P($P(DATA,U,11),";")
"RTN","MMRSIPC4",48,0)
 S MRSA365=$P($P(DATA,U,12),";")
"RTN","MMRSIPC4",49,0)
 ;MIA/LMT - Add a '*' if patient was indicated for a swab ;3/16/10
"RTN","MMRSIPC4",50,0)
 S IND=$P(DATA,U,13)
"RTN","MMRSIPC4",51,0)
 ;W !,WARD,?15,$E(PATIENT,1,20),?38,LAST4,?45,INDATEE,?61,ADT,?66,MOVTYPE,?81,NARES24,?90,NARES48,?99,CULT48,?108,MRSA365
"RTN","MMRSIPC4",52,0)
 W !,WARD,?15,$S(IND=1:"*",1:" ")_$E(PATIENT,1,20),?38,LAST4,?45,INDATEE,?61,ADT,?66,MOVTYPE,?81,NARES24,?90,NARES48,?99,CULT48,?108,MRSA365
"RTN","MMRSIPC4",53,0)
 I $Y+1>IOSL D PRTHDRA
"RTN","MMRSIPC4",54,0)
 Q
"RTN","MMRSIPC4",55,0)
PRINTDIS(DATA) ; Print cont.
"RTN","MMRSIPC4",56,0)
 N PATIENT,LAST4,INDATEE,INTT,ADTA,MOVTYPEA,NARES24A,NARES48A,MRSA365,OUTIFN,OUTDATEE
"RTN","MMRSIPC4",57,0)
 N OUTTT,ADTD,MOVTYPED,NARES24D,NARES48D,MRSACPRD,TRANS,VADM,VAIP,WARD,IND
"RTN","MMRSIPC4",58,0)
 D KVA^VADPT
"RTN","MMRSIPC4",59,0)
 D DEM^VADPT
"RTN","MMRSIPC4",60,0)
 S PATIENT=VADM(1)
"RTN","MMRSIPC4",61,0)
 S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSIPC4",62,0)
 D KVA^VADPT
"RTN","MMRSIPC4",63,0)
 S INDATEE=$$FMTE^XLFDT(INDATE,"2M")
"RTN","MMRSIPC4",64,0)
 S INTT=$P(DATA,U,5)
"RTN","MMRSIPC4",65,0)
 S ADTA=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSIPC4",66,0)
 D KVA^VADPT S VAIP("E")=$P(DATA,U,4) D IN5^VADPT
"RTN","MMRSIPC4",67,0)
 S MOVTYPEA=$E($P(VAIP(4),U,2),1,13)
"RTN","MMRSIPC4",68,0)
 S WARD=$E($P(VAIP(5),U,2),1,6)
"RTN","MMRSIPC4",69,0)
 D KVA^VADPT
"RTN","MMRSIPC4",70,0)
 S NARES24A=$P(DATA,U,9)
"RTN","MMRSIPC4",71,0)
 S NARES48A=$P($P(DATA,U,10),";")
"RTN","MMRSIPC4",72,0)
 S MRSA365=$P($P(DATA,U,11),";")
"RTN","MMRSIPC4",73,0)
 S (OUTDATEE,OUTTT,ADTD,MOVTYPED,NARES24D,NARES48D)=""
"RTN","MMRSIPC4",74,0)
 S OUTIFN=$P(DATA,U,7)
"RTN","MMRSIPC4",75,0)
 I OUTIFN D
"RTN","MMRSIPC4",76,0)
 .S OUTDATEE=$$FMTE^XLFDT(OUTDATE,"2M")
"RTN","MMRSIPC4",77,0)
 .S OUTTT=$P(DATA,U,8)
"RTN","MMRSIPC4",78,0)
 .S ADTD=$S(OUTTT=2:"T",OUTTT=3:"D",1:"")
"RTN","MMRSIPC4",79,0)
 .D KVA^VADPT S VAIP("E")=OUTIFN D IN5^VADPT S MOVTYPED=$E($P(VAIP(4),U,2),1,13) D KVA^VADPT
"RTN","MMRSIPC4",80,0)
 .S NARES24D=$P(DATA,U,12)
"RTN","MMRSIPC4",81,0)
 .S NARES48D=$P($P(DATA,U,13),";")
"RTN","MMRSIPC4",82,0)
 S MRSACPRD=$P($P(DATA,U,14),";")
"RTN","MMRSIPC4",83,0)
 S TRANS=$P(DATA,U,15)
"RTN","MMRSIPC4",84,0)
 ;MIA/LMT - Add a '*' if patient was indicated for a swab ;3/16/10
"RTN","MMRSIPC4",85,0)
 S IND=$P(DATA,U,16)
"RTN","MMRSIPC4",86,0)
 W !,WARD,?8,$S(IND=1:"*",1:" ")_$E(PATIENT,1,20),?31,LAST4,?38,INDATEE,?54,ADTA,?59,MOVTYPEA,?74,NARES24A,?83,NARES48A,?92,MRSA365
"RTN","MMRSIPC4",87,0)
 W ?101,OUTDATEE,?117,ADTD,?122,MOVTYPED,?137,NARES24D,?146,NARES48D,?155,MRSACPRD,?165,TRANS
"RTN","MMRSIPC4",88,0)
 I $Y+1>IOSL D PRTHDRD
"RTN","MMRSIPC4",89,0)
 Q
"RTN","MMRSIPC4",90,0)
PRTHDRA ;
"RTN","MMRSIPC4",91,0)
 W @IOF
"RTN","MMRSIPC4",92,0)
 W ?13,"MRSA IPEC ADMISSION REPORT"
"RTN","MMRSIPC4",93,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSIPC4",94,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",95,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",96,0)
 W !!,?81,"NARES",?90,"NARES",?99,"CULTURE"
"RTN","MMRSIPC4",97,0)
 W !,"VISTA",?45,"DATE",?66,"MAS MOVE",?81,"SCREEN",?90,"RESULT",?99,"RESULT",?108,"MRSA IN"
"RTN","MMRSIPC4",98,0)
 W !,"WARD",?15,"PATIENT",?38,"SSN",?45,"ENTERED WARD",?61,"ADT",?66,"TYPE",?81,"24H",?90,"48H",?99,"48H",?108,"PAST YEAR"
"RTN","MMRSIPC4",99,0)
 W !,LN
"RTN","MMRSIPC4",100,0)
 S PG=PG+1
"RTN","MMRSIPC4",101,0)
 Q
"RTN","MMRSIPC4",102,0)
PRTHDRD ;
"RTN","MMRSIPC4",103,0)
 W @IOF
"RTN","MMRSIPC4",104,0)
 W ?13,"MRSA IPEC DISCHARGE/TRANSMISSION REPORT"
"RTN","MMRSIPC4",105,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSIPC4",106,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",107,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",108,0)
 W !!,?59,"ADM",?74,"NARES",?83,"NARES",?122,"DIS",?137,"NARES",?146,"NARES",?155,"MRSA"
"RTN","MMRSIPC4",109,0)
 W !,"VISTA",?38,"DATE",?54,"ADM",?59,"MAS MOVE",?74,"SCREEN",?83,"RESULT",?92,"MRSA IN"
"RTN","MMRSIPC4",110,0)
 W ?101,"DATE",?117,"DIS",?122,"MAS MOVE",?137,"SCREEN",?146,"RESULT",?155,"IN CURR"
"RTN","MMRSIPC4",111,0)
 W !,"WARD",?8,"PATIENT",?31,"SSN",?38,"ENTERED WARD",?54,"ADT",?59,"TYPE",?74,"24H",?83,"48H",?92,"PAST YR"
"RTN","MMRSIPC4",112,0)
 W ?101,"LEFT WARD",?117,"ADT",?122,"TYPE",?137,"24H",?146,"48H",?155,"PRD",?165,"TRANS"
"RTN","MMRSIPC4",113,0)
 W !,LN
"RTN","MMRSIPC4",114,0)
 S PG=PG+1
"RTN","MMRSIPC4",115,0)
 Q
"RTN","MMRSIPC4",116,0)
PRTSUMA(LOC) ;
"RTN","MMRSIPC4",117,0)
 N II,L,DATA
"RTN","MMRSIPC4",118,0)
 W @IOF
"RTN","MMRSIPC4",119,0)
 W ?13,"MRSA IPEC ADMISSION SUMMARY REPORT"
"RTN","MMRSIPC4",120,0)
 I $G(LOC)'="" W !,?13,"Geographical Location: ",LOC
"RTN","MMRSIPC4",121,0)
 I $G(LOC)="" W !,?13,"Geographical Locations: " D
"RTN","MMRSIPC4",122,0)
 .S II=1 S L="" F  S L=$O(^TMP($J,"MMRSIPC","DSUM",L)) Q:L=""  W:II>1&($X>37) ", " W L S II=II+1 I $X>110 W !,?37
"RTN","MMRSIPC4",123,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",124,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",125,0)
 I $G(LOC)'="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC4",126,0)
 I $G(LOC)="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC4",127,0)
 W !!,"Prevalence Measures (Facility Wide)"
"RTN","MMRSIPC4",128,0)
 W !,?3,"1. Number of admissions to the facility: ",$P(DATA,U,1)
"RTN","MMRSIPC4",129,0)
 W !,?3,"2. Number of (1) who received MRSA nasal screening upon admission to facility: ",$P(DATA,U,2)
"RTN","MMRSIPC4",130,0)
 W !,?3,"3. Number of (1) positive for MRSA based on nasal screening upon admission to facility: ",$P(DATA,U,3)
"RTN","MMRSIPC4",131,0)
 W !,?3,"4. Number of those in (1) positive for MRSA based on clinical cultures upon admission to facility: ",$P(DATA,U,4)
"RTN","MMRSIPC4",132,0)
 W !!,"Prevalence Measures (Unit Specific)"
"RTN","MMRSIPC4",133,0)
 W !,?3,"1. Number of admissions (admissions + transfers in) to the unit for the month: ",$P(DATA,U,5)
"RTN","MMRSIPC4",134,0)
 W !,?3,"2. Number of (1) for whom nasal screening was indicated: ",$P(DATA,U,6)
"RTN","MMRSIPC4",135,0)
 W !,?3,"3. Number of (2) who received MRSA nasal screening upon admission to unit (within 24 hours): ",$P(DATA,U,7)
"RTN","MMRSIPC4",136,0)
 W !,?3,"4. Number of (1) positive for MRSA based on nasal screening upon admission to unit: ",$P(DATA,U,8)
"RTN","MMRSIPC4",137,0)
 W !,?3,"5. Number of (1) positive for MRSA based on clinical cultures upon admission to unit: ",$P(DATA,U,9)
"RTN","MMRSIPC4",138,0)
 S PG=PG+1
"RTN","MMRSIPC4",139,0)
 Q
"RTN","MMRSIPC4",140,0)
PRTSUMD(LOC) ;
"RTN","MMRSIPC4",141,0)
 N II,L,DATA
"RTN","MMRSIPC4",142,0)
 W @IOF
"RTN","MMRSIPC4",143,0)
 W ?13,"MRSA IPEC DISCHARGE/TRANSMISSION SUMMARY REPORT"
"RTN","MMRSIPC4",144,0)
 I $G(LOC)'="" W !,?13,"Geographical Location: ",LOC
"RTN","MMRSIPC4",145,0)
 I $G(LOC)="" W !,?13,"Geographical Locations: " D
"RTN","MMRSIPC4",146,0)
 .S II=1 S L="" F  S L=$O(^TMP($J,"MMRSIPC","DSUM",L)) Q:L=""  W:II>1&($X>37) ", " W L S II=II+1 I $X>110 W !,?37
"RTN","MMRSIPC4",147,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSIPC4",148,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSIPC4",149,0)
 I $G(LOC)'="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM",LOC))
"RTN","MMRSIPC4",150,0)
 I $G(LOC)="" S DATA=$G(^TMP($J,"MMRSIPC","DSUM"))
"RTN","MMRSIPC4",151,0)
 W !!,"Transmission Measures (Unit Specific)"
"RTN","MMRSIPC4",152,0)
 W !,?3,"10. Number of bed days of care for the unit: ",$P(DATA,U,1)
"RTN","MMRSIPC4",153,0)
 W !,?3,"11. Number of exits (discharges + deaths + transfers out) from the unit: ",$P(DATA,U,2)
"RTN","MMRSIPC4",154,0)
 W !,?3,"12. Number of (11) from whom a discharge/transfer swab was indicated: ",$P(DATA,U,3)
"RTN","MMRSIPC4",155,0)
 W !,?3,"13. Number of (12) who received MRSA nasal screening upon exit from unit: ",$P(DATA,U,4)
"RTN","MMRSIPC4",156,0)
 W !,?3,"14. Number of MRSA transmissions on unit based on MRSA nasal screenings or clinical cultures: ",$P(DATA,U,5)
"RTN","MMRSIPC4",157,0)
 S PG=PG+1
"RTN","MMRSIPC4",158,0)
 Q
"RTN","MMRSORD")
0^4^B42758961^B37424974
"RTN","MMRSORD",1,0)
MMRSORD ;MIA/LMT - Print ward census showing which patients need a nares swab ;02-22-09
"RTN","MMRSORD",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;**1**;Mar 22, 2009;Build 3
"RTN","MMRSORD",3,0)
 ;
"RTN","MMRSORD",4,0)
MAIN ;
"RTN","MMRSORD",5,0)
 N EXTFLG,MMRSDIV,MMRSLOC
"RTN","MMRSORD",6,0)
 D CHECK^MMRSIPC
"RTN","MMRSORD",7,0)
 D CHECK2^MMRSIPC
"RTN","MMRSORD",8,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSORD",9,0)
 W !
"RTN","MMRSORD",10,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSORD",11,0)
 W !
"RTN","MMRSORD",12,0)
 D CHECK3^MMRSIPC
"RTN","MMRSORD",13,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSORD",14,0)
 D PROMPT^MMRSISL Q:$D(EXTFLG)
"RTN","MMRSORD",15,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSORD",16,0)
 Q
"RTN","MMRSORD",17,0)
MAIN2 ;
"RTN","MMRSORD",18,0)
 N MMRSNOW
"RTN","MMRSORD",19,0)
 D CLEAN
"RTN","MMRSORD",20,0)
 Q:'$D(MMRSDIV)!('$D(MMRSLOC))
"RTN","MMRSORD",21,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSORD",22,0)
 D GETPARAM^MMRSIPC ; Load parameters in temp global
"RTN","MMRSORD",23,0)
 D SETDATA
"RTN","MMRSORD",24,0)
 D PRT
"RTN","MMRSORD",25,0)
 D CLEAN
"RTN","MMRSORD",26,0)
 Q
"RTN","MMRSORD",27,0)
CLEAN ;
"RTN","MMRSORD",28,0)
 K ^TMP($J,"MMRSIPC")
"RTN","MMRSORD",29,0)
 K ^TMP($J,"MMRSORD")
"RTN","MMRSORD",30,0)
 Q
"RTN","MMRSORD",31,0)
SETDATA ;
"RTN","MMRSORD",32,0)
 N LOCATION,LOCNAME,DFN,LOCTYPE,MMRSI,SDRESULT,Y,WLOC,WARD,WARDNAME,VAIP
"RTN","MMRSORD",33,0)
 I $G(MMRSLOC)="ALL" D  Q
"RTN","MMRSORD",34,0)
 .S LOCATION=0 F  S LOCATION=$O(^MMRS(104.3,LOCATION)) Q:'LOCATION  I $P($G(^MMRS(104.3,LOCATION,0)),U,2)=MMRSDIV D
"RTN","MMRSORD",35,0)
 ..S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1)
"RTN","MMRSORD",36,0)
 ..S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSORD",37,0)
 ...S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSORD",38,0)
 ...Q:'WARD
"RTN","MMRSORD",39,0)
 ...;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSORD",40,0)
 ...;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSORD",41,0)
 ...S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSORD",42,0)
 ...Q:WARDNAME=""
"RTN","MMRSORD",43,0)
 ...S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCATION,LOCNAME)
"RTN","MMRSORD",44,0)
 S LOCATION=0 F  S LOCATION=$O(MMRSLOC(LOCATION)) Q:'LOCATION  D
"RTN","MMRSORD",45,0)
 .S LOCNAME=$P($G(^MMRS(104.3,LOCATION,0)),U,1)
"RTN","MMRSORD",46,0)
 .S WLOC=0 F  S WLOC=$O(^MMRS(104.3,LOCATION,1,WLOC)) Q:'WLOC  D
"RTN","MMRSORD",47,0)
 ..S WARD=$P($G(^MMRS(104.3,LOCATION,1,WLOC,0)),U,1)
"RTN","MMRSORD",48,0)
 ..Q:'WARD
"RTN","MMRSORD",49,0)
 ..;S WARDNAME=$P($G(^DIC(42,WARD,44)),U,1)
"RTN","MMRSORD",50,0)
 ..;S WARDNAME=$P($G(^SC(+WARDNAME,0)),U,1)
"RTN","MMRSORD",51,0)
 ..S WARDNAME=$P($G(^DIC(42,WARD,0)),U,1)
"RTN","MMRSORD",52,0)
 ..Q:WARDNAME=""
"RTN","MMRSORD",53,0)
 ..S DFN=0 F  S DFN=$O(^DPT("CN",WARDNAME,DFN)) Q:'DFN  D SETDATA2(DFN,LOCATION,LOCNAME)
"RTN","MMRSORD",54,0)
 Q
"RTN","MMRSORD",55,0)
SETDATA2(DFN,LOC,LOCNAME) ;
"RTN","MMRSORD",56,0)
 N INTT,IEN,INDATE,INIFN,MRSAMDRO,MRSA,MRSACULT,LABORDER,TSTNM,LABTEST,ORDITM,ORDTEMP,PATNM,VADM
"RTN","MMRSORD",57,0)
 ;Get unit admission date and Transaction Type
"RTN","MMRSORD",58,0)
 D KVA^VADPT
"RTN","MMRSORD",59,0)
 S VAIP("D")=MMRSNOW
"RTN","MMRSORD",60,0)
 D IN5^VADPT
"RTN","MMRSORD",61,0)
 I 'VAIP(1) Q
"RTN","MMRSORD",62,0)
 S INTT=$$TRANTYPE^MMRSIPC2(+VAIP(4),+VAIP(2))
"RTN","MMRSORD",63,0)
 F  Q:(INTT=1)!(INTT=2&$$CNGWARD^MMRSIPC2(LOC,+VAIP(5),+VAIP(15,4)))!(VAIP(15)="")  D
"RTN","MMRSORD",64,0)
 .S IEN=+VAIP(15)
"RTN","MMRSORD",65,0)
 .D KVA^VADPT
"RTN","MMRSORD",66,0)
 .S VAIP("E")=IEN
"RTN","MMRSORD",67,0)
 .D IN5^VADPT
"RTN","MMRSORD",68,0)
 .S INTT=$$TRANTYPE^MMRSIPC2(+VAIP(4),+VAIP(2))
"RTN","MMRSORD",69,0)
 I INTT<1!(INTT>2) Q
"RTN","MMRSORD",70,0)
 S INDATE=+VAIP(3)
"RTN","MMRSORD",71,0)
 S INIFN=+VAIP(1)
"RTN","MMRSORD",72,0)
 I '$G(INIFN) Q
"RTN","MMRSORD",73,0)
 ;Get MRSA history
"RTN","MMRSORD",74,0)
 S MRSAMDRO=1
"RTN","MMRSORD",75,0)
 S MRSA=$P($$GETLAB^MMRSIPC3(DFN,MRSAMDRO,$$FMADD^XLFDT(MMRSNOW,-365),MMRSNOW,"CD"),U,2)
"RTN","MMRSORD",76,0)
 ;Get Order info
"RTN","MMRSORD",77,0)
 S LABORDER="^^"
"RTN","MMRSORD",78,0)
 S TSTNM="MRSA SURVL NARES DN"
"RTN","MMRSORD",79,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES DNA~zzz")  D
"RTN","MMRSORD",80,0)
 .I TSTNM'["MRSA SURVL NARES DNA" Q
"RTN","MMRSORD",81,0)
 .S LABTEST=0 F  S LABTEST=$O(^LAB(60,"B",TSTNM,LABTEST)) Q:'LABTEST  D
"RTN","MMRSORD",82,0)
 ..N TESTS D GORDITM(LABTEST,.LABORDER,.TESTS) ;MIA/LMT - Added with patch MMRS*1*1
"RTN","MMRSORD",83,0)
 S TSTNM="MRSA SURVL NARES AGA"
"RTN","MMRSORD",84,0)
 F  S TSTNM=$O(^LAB(60,"B",TSTNM)) Q:TSTNM=""!(TSTNM]"MRSA SURVL NARES AGAR~zzz")  D
"RTN","MMRSORD",85,0)
 .I TSTNM'["MRSA SURVL NARES AGAR" Q
"RTN","MMRSORD",86,0)
 .S LABTEST=0 F  S LABTEST=$O(^LAB(60,"B",TSTNM,LABTEST)) Q:'LABTEST  D
"RTN","MMRSORD",87,0)
 ..N TESTS D GORDITM(LABTEST,.LABORDER,.TESTS) ;MIA/LMT - Added with patch MMRS*1*1
"RTN","MMRSORD",88,0)
 D KVA^VADPT
"RTN","MMRSORD",89,0)
 D DEM^VADPT
"RTN","MMRSORD",90,0)
 S PATNM=VADM(1)
"RTN","MMRSORD",91,0)
 D KVA^VADPT
"RTN","MMRSORD",92,0)
 S ^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)=INDATE_U_INTT_U_MRSA_U_LABORDER
"RTN","MMRSORD",93,0)
 Q
"RTN","MMRSORD",94,0)
GORDITM(LABTEST,LABORDER,TESTS) ;MIA/LMT - Added with patch MMRS*1*1 - Include panels in search
"RTN","MMRSORD",95,0)
 N ORDITM,ORDTEMP,LABPANEL
"RTN","MMRSORD",96,0)
 I $D(TESTS(LABTEST)) Q  ;prevent infinite recursion; if site has Panel A within Panel B, and Panel B within Panel A
"RTN","MMRSORD",97,0)
 S TESTS(LABTEST)=1 ;mark that we have searched this test (to prevent infinite recursion)
"RTN","MMRSORD",98,0)
 S ORDITM=0 F  S ORDITM=$O(^ORD(101.43,"ID",LABTEST_";99LRT",ORDITM)) Q:'ORDITM  D
"RTN","MMRSORD",99,0)
 .S ORDTEMP=$$GETORD(DFN,ORDITM,INDATE)
"RTN","MMRSORD",100,0)
 .I $P(LABORDER,U,1)'="YES"!(($P(LABORDER,U,3)'="YES")&($P(ORDTEMP,U,3)="YES")) S LABORDER=ORDTEMP
"RTN","MMRSORD",101,0)
 S LABPANEL=0 F  S LABPANEL=$O(^LAB(60,"AB",LABTEST,LABPANEL)) Q:'LABPANEL  D
"RTN","MMRSORD",102,0)
 .D GORDITM(LABPANEL,.LABORDER,.TESTS) ;Recursive call to check for tests within panels
"RTN","MMRSORD",103,0)
 Q
"RTN","MMRSORD",104,0)
GETORD(DFN,ORDITM,INDATE) ;
"RTN","MMRSORD",105,0)
 N RESULT,START,STOP,DAS,STATUS,ORUPCHUK,LABREC
"RTN","MMRSORD",106,0)
 S RESULT="^^"
"RTN","MMRSORD",107,0)
 S START=$$FMADD^XLFDT(INDATE,-1)-.0000001
"RTN","MMRSORD",108,0)
 F  S START=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START)) Q:'START  D
"RTN","MMRSORD",109,0)
 .S STOP="" F  S STOP=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP)) Q:STOP=""  D
"RTN","MMRSORD",110,0)
 ..S DAS="" F  S DAS=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP,DAS)) Q:DAS=""  D
"RTN","MMRSORD",111,0)
 ...D EN^ORX8(+DAS)
"RTN","MMRSORD",112,0)
 ...S STATUS=$P(ORUPCHUK("ORSTS"),U,1)
"RTN","MMRSORD",113,0)
 ...I STATUS'=2,STATUS'=5,STATUS'=6 Q
"RTN","MMRSORD",114,0)
 ...S LABREC="NO"
"RTN","MMRSORD",115,0)
 ...I STATUS=6!(STATUS=2) S LABREC="YES"
"RTN","MMRSORD",116,0)
 ...I $P(RESULT,U,3)'="YES" S RESULT="YES^"_START_U_LABREC
"RTN","MMRSORD",117,0)
 Q RESULT
"RTN","MMRSORD",118,0)
PRT ;
"RTN","MMRSORD",119,0)
 N LN,PG,LOCNAME,PATNM,DFN,NODE,LAST4,INTT,ADT,ORDDATE,VADM
"RTN","MMRSORD",120,0)
 ;^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)=INDATE_U_INTT_U_MRSA_U_LAB
"RTN","MMRSORD",121,0)
 S $P(LN,"-",101)=""
"RTN","MMRSORD",122,0)
 S PG=1
"RTN","MMRSORD",123,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSORD",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSORD",124,0)
 .D PRTHDRS S PATNM="" F  S PATNM=$O(^TMP($J,"MMRSORD",LOCNAME,PATNM)) Q:PATNM=""  D
"RTN","MMRSORD",125,0)
 ..S DFN=0 F  S DFN=$O(^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN)) Q:'DFN  D
"RTN","MMRSORD",126,0)
 ...S NODE=$G(^TMP($J,"MMRSORD",LOCNAME,PATNM,DFN))
"RTN","MMRSORD",127,0)
 ...D KVA^VADPT
"RTN","MMRSORD",128,0)
 ...D DEM^VADPT
"RTN","MMRSORD",129,0)
 ...S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSORD",130,0)
 ...D KVA^VADPT
"RTN","MMRSORD",131,0)
 ...S INTT=$P(NODE,U,2)
"RTN","MMRSORD",132,0)
 ...S ADT=$S(INTT=1:"A",INTT=2:"T",1:"")
"RTN","MMRSORD",133,0)
 ...S ORDDATE=$P(NODE,"^",5)
"RTN","MMRSORD",134,0)
 ...I ORDDATE S ORDDATE=$$FMTE^XLFDT(ORDDATE,"2M")
"RTN","MMRSORD",135,0)
 ...W !,$E(PATNM,1,23),?25,LAST4,?32,$$FMTE^XLFDT($P(NODE,"^",1),"2M"),?48,ADT,?53,$P($P(NODE,"^",3),";",1),?65,$P(NODE,"^",4)
"RTN","MMRSORD",136,0)
 ...W ?75,ORDDATE,?91,$P(NODE,"^",6)
"RTN","MMRSORD",137,0)
 ...I $Y+2>IOSL D PRTHDRS
"RTN","MMRSORD",138,0)
 Q
"RTN","MMRSORD",139,0)
PRTHDRS ; Helper Function for PRT - Prints report headers
"RTN","MMRSORD",140,0)
 W @IOF
"RTN","MMRSORD",141,0)
 W ?13,"NARES SWAB ORDER LIST"
"RTN","MMRSORD",142,0)
 W !,?13,"Geographical Location: ",LOCNAME
"RTN","MMRSORD",143,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?75,"PAGE: ",PG
"RTN","MMRSORD",144,0)
 W !!,?32,"DATE",?53,"MRSA IN",?65,"NARES",?91,"LAB"
"RTN","MMRSORD",145,0)
 W !,"PATIENT",?25,"SSN",?32,"ENTERED WARD",?48,"ADT",?53,"PAST YEAR",?65,"ORDERED",?75,"ORDER DATE",?91,"RECEIVED"
"RTN","MMRSORD",146,0)
 W !,LN
"RTN","MMRSORD",147,0)
 S PG=PG+1
"RTN","MMRSORD",148,0)
 Q
"RTN","MMRSORD",149,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSORD",150,0)
 N MMRSVAR,ZTSK
"RTN","MMRSORD",151,0)
 W !!!,"This report is designed for a 132 column format (compressed).",!
"RTN","MMRSORD",152,0)
 S MMRSVAR("MMRSLOC")="",MMRSVAR("MMRSLOC(")="",MMRSVAR("MMRSDIV")=""
"RTN","MMRSORD",153,0)
 D EN^XUTMDEVQ("MAIN2^MMRSORD","Print nares swab order list (MMRSORD)",.MMRSVAR,"QM",1)
"RTN","MMRSORD",154,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSORD",155,0)
 Q
"VER")
8.0^22.0
"BLD",8025,6)
^1
**END**
**END**
