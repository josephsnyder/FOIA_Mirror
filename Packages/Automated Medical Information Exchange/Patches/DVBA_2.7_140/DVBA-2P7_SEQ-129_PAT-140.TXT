$TXT Created by LOUCK,KEVIN C at DEVFEX.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 05/12/09 at 13:43
=============================================================================
Run Date: SEP 17, 2009                     Designation: DVBA*2.7*140
Package : DVBA - AUTOMATED MED INFO EXCHANGE  Priority: Mandatory
Version : 2.7       SEQ #129                    Status: Released
                  Compliance Date: OCT 18, 2009
=============================================================================

Associated patches: (v)DVBA*2.7*123<<= must be installed BEFORE `DVBA*2.7*140'
                    (v)DVBA*2.7*137<<= must be installed BEFORE `DVBA*2.7*140'

Subject: CAPRI DEFECTS & BROKER SECURITY ENHANCEMENTS (BSE) MODIFICATIONS

Category: 
  - Enhancement (Mandatory)
  - Routine
  - Informational

Description:
============

 I. OVERVIEW
  
   This patch is to announce the release of a new version of the
   Compensation & Pension Record Interchange (CAPRI) Graphical User
   Interface (GUI) v140. 
   
   Additionally, this patch (DVBA*2.7*140) contains VistA server
   modifications that support the release of the new CAPRI GUI v140.  
  
    *********************  I M P O R T A N T  ***************************
    *                                                                   * 
    * This patch (DVBA*2.7*140) and the new CAPRI GUI v140 software     *
    * must be installed prior to installing the Kernel ACTIVATE BROKER  *
    * SECURITY ENHANCEMENT (XU*8*522) patch.                            *
    *                                                                   *
    * This patch (DVBA*2.7*140) may be installed while CAPRI users are  *
    * are still using the previous CAPRI GUI version (v123). Once       *
    * the installation of this patch has been completed, CAPRI users    *
    * should be upgraded to the new version of the CAPRI GUI v140.      * 
    *                                                                   *
    * Please refer to the SOFTWARE AND DOCUMENTATION RETRIEVAL section  *
    * of this patch message for specific instructions regarding the     *
    * retrieval of the CAPRI GUI v140 software and user documentation.  *
    *                                                                   *
    *********************************************************************
  
  
  
 II. ASSOCIATED REMEDY TICKETS & NEW SERVICE REQUESTS
  
   The following section lists the Remedy tickets and/or New Service 
   Requests associated with this patch.
  
   1. Associated Remedy Ticket(s):
      ----------------------------
      HD0000000288686 - Message received: RPC DVBAB RESTRICTED LIST 
                        PATIENTS could not be accessed!
         Duplicates:
            HD0000000288775
          
  
      HD0000000291946 - Can't print appointments in v123
  
         Duplicates: 
            HD0000000274354
            HD0000000321587
  
      HD0000000295128 - Patient Record at Tampa VAMC Returns Error
  
         Duplicate:
            HD0000000332334
  
      HD0000000318791 - CAPRI/VistAWeb Patient Discrepancy
  
          Duplicates:
             HD0000000318812  
  
  
   2. Associated New Service Request(s):
      ----------------------------------
      NONE
  
  
  
 III. FUNCTIONAL OVERVIEW
  
   The following is an overview of the changes and primary functionality
   that will be delivered in CAPRI GUI v140 and this patch (DVBA*2.7*140).
   The primary purpose of this software release is to address defects
   reported for the CAPRI GUI and ensure CAPRI will function with the
   Kernel ACTIVATE BROKER SECURITY ENHANCEMENT (XU*8*522) patch being
   released.
   
   1. The following Remedy tickets are being addressed:
  
      a. HD0000000288686 - Message received: RPC DVBAB RESTRICTED 
                           LIST PATIENTS could not be accessed!
  
      Problem
      -------
      The VistA server patch (DVBA*2.7*123) associated with the release of
      CAPRI GUI v123 exported the 'B' type option Capri GUI (Broker) [DVBA
      CAPRI GUI] without the remote procedure [DVBAB RESTRICTED LIST
      PATIENTS] attached.  This was preventing CAPRI remote users from
      accessing their restricted patient list.    
  
      Additionally, when a CAPRI remote user was not able to access their
      restricted patient list, CAPRI warned the user that the 'DVBAB
      RESTRICTED LIST PATIENTS RPC could not be accessed' and allowed them
      to continue on and potentially access an unauthorized patient record.
  
      Solution
      --------
      The option Capri GUI (Broker) [DVBA CAPRI GUI] option is being
      exported with the remote procedure [DVBAB RESTRICTED LIST PATIENTS]
      attached.      
  
      Per the Health Information Access (HIA) Office, the CAPRI application
      will be shut down if the CAPRI remote user is not able to access
      their restricted patient list on the CLAIMS system.  This will
      prevent the user from continuing and potentially accessing an
      unauthorized patient record. Prior to shutting the CAPRI application
      down, the user will receive a warning dialog notifying them that
      their restricted patient list could not be accessed and provide HIA
      contact information (i.e. HIA@va.gov mail group) for resolving the
      problem. Additionally, the status bar (lower left) of the CAPRI main
      form will read 'Restricted patient list could not be accessed!' After
      the user clicks the 'OK' button acknowledging the warning dialog, the
      CAPRI application will be terminated.
  
      b. HD0000000291946 - Can't print appointments in v123
  
      Problem
      -------
      On the CAPRI Admin Tab, sub-tab 'Appointments', the four reports
      listed below no longer allow printing and the error message "Printing
      has not yet been coded for this page" is displayed.
  
       * All Appointment
       * Future Appointments
       * Past Appointments
       * Admissions
  
      Solution
      --------
      When a user selects 'Print' from the CAPRI 'File' menu, it configures
      the print job based on which tab is currently displaying.  In the
      case of 'Appointments', CAPRI looked for the 'Admin' tab and then
      tried to determine whether the 'Address' or the 'Appointments'
      sub-tab was selected. The code looked for the string 'Appointments',
      but the actual caption on the tab is 'W)  Appointments'. The code now
      tries to match 'W)  Appointments' and 'V)  Address' when determining
      the selected sub-tab.
  
      c. HD0000000295128 - Patient Record at Tampa VAMC Returns Error
  
      Problem
      -------
      The internal FileMan date to external date conversion code in CAPRI
      generates software exceptions when attempting to convert a date that
      contains a year without a month and day.  
      This error may be generated in the following scenarios:
         *  When CAPRI attempts to display a patient with an imprecise date
            of birth in the Patient File Matches dialog box during new
            patient entry.
         *  When CAPRI attempts to populate the Clinical Documents/Problem
            List tab with a problem that contains a year-only date.
   
      Solution
      --------
      The internal FileMan to external date conversion code was modified to
      allow imprecise (year-only) dates to convert without error.
  
      d. HD0000000318791 - CAPRI/VistAWeb Patient Discrepancy
  
      Problem
      -------
      When using the VistAWeb tab in CAPRI, incorrect patient information
      is sometimes being returned due to incorrect values in the Medical
      Center Division (#40.8) file. CAPRI retrieves the incorrect division
      when the Medical Center Division (#40.8) file contains sites other
      than the local divisions. 
  
      Solution
      --------
      CAPRI currently performs a search on the Medical Center Division
      (#40.8) file to determine the current division. CAPRI has been
      modified to no longer perform a search directly on the Medical Center
      Division (#40.8) file. Instead, CAPRI now retrieves the current
      division from the 'User.Division' property of the RPCBroker for
      remote (CLAIMS) users and retrieves the division from the supported
      API ($$SITE^VASITE) for local users. This eliminates any potential
      problems caused by bad data in the Medical Center Division (#40.8)
      file. 
  
  
   2. The following defects that were reported directly to the CAPRI
      development team are being addressed:
  
      a. Defect - Multiple sign-on for CAPRI remote users.
  
      Problem
      ------- 
      When a user is assigned multiple sign-on divisions on the CLAIMS
      server, CAPRI generates the division selection dialog box multiple
      times during connection to a remote site.
       
      Solution
      --------
      CAPRI has been modified to display the division selection dialog box
      only during the initial CLAIMS system login.
      
      b. Defect - Provider can open any exam 'Review Pending' by any author
                  and edit the exam 
  
      Problem
      -------
      Currently, the CAPRI GUI allows a provider to open another provider's
      exam that has a state of 'Review Pending' and allows editing of that
      exam. The original author of the exam is retained instead of the
      author making any edits.
   
      Solution
      --------
      There were two areas of functionality in CAPRI that did not enforce 
      the DVBAB CPWM REVIEWER security key. When on the C&P Worksheets tab,
      if the user double-clicked on an exam that had a status of REVIEW
      PENDING, the security key was enforced and the provider was not
      allowed to edit the exam. If the provider single-clicked on the same
      exam, then clicked on the 'Display Template' button, the security key
      was not enforced and the provider was allowed to open and edit the
      exam.
   
      The second failure to enforce the DVBAB CPWM REVIEWER security key
      occurred when a provider viewed the Unsigned Templates list from the
      C&P Worksheets tab, then clicked on the 'Review Pending' button. On
      the screen that displayed all the exams in a REVIEW PENDING state,
      both double-clicking on an exam, or single-clicking an exam and then
      using the 'Display Form' button, failed to enforce the DVBAB CPWM
      REVIEWER security key.
  
      The functionality described has been corrected and the DVBAB CPWM
      REVIEWER security key will be enforced.
  
      c. Defect - Rich Text Format characters appearing in exam reports
      
      Problem
      -------
      CAPRI displays Rich Text Formatting (RTF) control characters
      (ex. \tab\tab) within an exam report generated by the  Preview
      button. The RTF control characters appear to only display in reports
      containing large amounts of text.  
       
      Solution
      --------
      When an exam report is initially displayed by clicking the 'Preview'
      button, CAPRI positions the scrollbar at the top of the report by
      disabling and re-enabling the scrollbar.  It was determined that
      re-enabling the scrollbar caused the RTF control characters to
      display in large reports. CAPRI has been modified to directly set the
      scrollbar position.
  
      d. Defect - List out of bounds error for 'Reprint 21 Day Certificate'
                  report
  
      Problem
      -------
      When a user selects 'File|Reports' from the main menu and then
      selects the 'Reprint 21 Day certificate', a 'List out of bounds'
      error was occurring when selecting the 'OK' button if there are no
      certificates to print in the list.
  
      Solution
      --------
      When selecting the 'Reprint 21 Day Certificate' report, the user will
      no longer get the 'List out of bounds error when selecting the 'OK'
      button to print the report where no certificates appear in the list.
      Additionally, when a user attempts to run the report by 'Patient'
      (which is also the default), the 'Which one?' listbox will now be
      populated with '< No data found for the patient. >' if no
      certificates are found in Vista for the patient.
  
      e. Defect - Incorrect Electronic Signature Code entered
  
      Problem
      -------
      When a user enters an incorrect Electronic Signature Code, CAPRI
      generates a dialog box containing the text 'You have entered an
      incorrect Electronic Signature Code...Try again!'. When the user
      clicks  OK  to acknowledge the warning, CAPRI closes the Signature
      Validation screen and returns the user to the exam template display
      with no opportunity to correct the electronic signature code.
      
      Solution
      --------
      When a user enters an incorrect Electronic Signature Code, CAPRI will
      generate a dialog box containing the text 'You have entered an
      invalid electronic signature code.'. When the users clicks 'OK' to
      acknowledge the warning, CAPRI will return the user to the
      'ELECTRONIC SIG. CODE' field on the Signature Validation form.
  
      f. Defect - CAPRI creates duplicate 'Unsigned' progress notes
  
      Problem
      -------
      After completing and signing a C&P exam, CAPRI would infrequently
      create duplicate progress notes.  The status of the initial progress
      note was 'Unsigned' .
  
      Solution
      --------
      It was determined that the initial 'Unsigned' progress note was
      created before CAPRI validated the electronic signature code.  CAPRI
      will now validate the electronic signature code before creating any
      progress note records.  CAPRI will abort the progress note creation
      process when an invalid electronic signature code is entered,
      preventing  Unsigned  progress notes.
  
      g. Defect - Inpatient Unit Dose History By Date Range
   
      Problem
      -------
      When selecting the Clinical Documents tab|Meds tab|Inpatient Unit
      Dose History By Date Range, the following errors were being 
      generated.
          * RPC ORWORR AGET could not be accessed!
          * CAPRI Application Exception - List index out of bounds (0)
  
      Solution
      --------  
      Both errors are caused by an internal timer overwriting and 
      corrupting the remote procedure call (RPC) parameters used to
      retrieve the report data.  The report data retrieval process has been
      modified to isolate the RPC parameters and prevent them from being
      overwritten.
  
      h. Defect - Timer-driven method of updating the exam template review
                  status produces unpredictable results.
  
      Problem
      -------
      CAPRI uses an internal timer to update the review status of an exam
      template after closing the 'Send Reviewer a Message' dialog box.  If
      the review status changes before the timer event triggers, then an
      incorrect value may be filed.
  
      Solution
      --------
      All Review Events/Send for Review actions are now processed
      immediately upon closing the 'Send Reviewer a Message' dialog box 
      without the use of the timer procedures.
  
      i. Defect - CAPRI not returning *SENSITIVE* in DOB and SSN fields for
                  sensitive records
  
      Problem
      -------
      CAPRI is not returning *SENSITIVE* in the DOB and SSN fields for
      sensitive records in the 'Patient File Matches' window when entering
      a new patient.
  
      Solution
      --------
      The remote procedure call [DVBAB FIND DUPS] returns a list of
      potential Patient (#2) file duplicates when a new patient is added in
      CAPRI. The results of the RPC populate the 'Patient File Matches'
      list in CAPRI displaying the patient name, gender, DOB and SSN. The M
      routine DVBAB84 has been modified to return *SENSITIVE* in the DOB
      and SSN fields when the Patient (#2) file record is sensitive.
  
      j. Defect - Report output not wrapping correctly within CPRS View 
                  window
  
      Problem
      -------
      On the C&P Worksheets tab, when displaying an exam with a status of 
      'Complete' using the 'Display template' button, the report output was
      not wrapping correctly within the CPRS View window.
  
      Solution
      --------
      The main form has been widened so the report should wrap correctly
      within the CPRS View window.
  
      k. Defect - Replication of common data across merged templates not 
                  functioning properly
  
      Problem
      -------
      User entered data values for common questions/objects were not always
      being replicated correctly across merged templates.
  
      Solution
      --------
      The timestamp method of determining if an object should be replicated
      has been changed to use a list (TList).  When an object is updated
      with a replicated value, the object is added to the list.   Each
      updated object is added until all objects with the same object number
      are replicated. The list is checked to prevent updating the same
      object more than once. The final step deletes the list.
  
      l. Defect - Cannot focus a disabled or invisible window exception
                  error
  
      Problem
      -------
      An application exception error 'Cannot focus a disabled or invisible 
      window' was occurring when a user quickly clicked between the
      Clinical Documents tab and the C&P Worksheets tab from the CAPRI main
      window.
  
      Solution
      --------
      This defect was occurring when CAPRI attempted to set focus on the
      tabs at the bottom of the Clinical documents tab (i.e. Consults tab)
      after the C&P Worksheets tab activates. A check was added to verify
      that the Clinical Documents tab is first visible and enabled before 
      allowing focus to be set on the tabs at the bottom of the Clinical
      Documents tab.
  
      m. Defect - Disable DoD Records tab for local CAPRI users
  
      Problem
      -------
      The upcoming Broker Security Enhancements (BSE) release (XU*8*522)
      does not support local CAPRI users connecting to the FHIE/BHIE
      server. Local users of the CAPRI application (primarily just VHA C&P
      staff) are presented with a VistA Sign-on screen prompting them to
      enter Access/Verify codes for the FHIE/BHIE server, which they do not
      have. However, CAPRI remote users (those logging in through the
      Claims server) are not be impacted.
  
      Solution
      --------
      Since the VistAWeb tab in CAPRI allows local users to retrieve DoD 
      patient data, a dialog box will display when a local user clicks on
      the DoD Records tab.  The dialog box will contain the following text:
        * The 'DoD Records' tab cannot provide DoD data for local users.  
          Please use the 'VistAWeb' tab to access DoD data.
      The Kernel team is currently working on a solution to support local
      CAPRI users connecting to the FHIE/BHIE server.
  
      n. Defect - Replication of combobox data across merged templates not 
                  functioning properly
  
      Problem
      -------
      When a template is initially created or modified using the Manage 
      Templates option, replication of data in comboboxes functions
      correctly.  However, when loading a template after saving, the
      replication of data fails when changing text in the combobox.
  
      Solution
      --------
      When saved templates loaded into CAPRI, the combobox components were
      not being completely initialized with the event procedure that
      processes data replication between common objects.  Only an OnClick
      event was being defined. Combobox components are now initialized with
      both an OnClick and an OnChange event procedure to force data
      replication when the text portion of a combobox is changed.
  
      o. Defect - 'Preview' report displays combobox data even after user 
                  deletes text on template
  
      Problem
      -------
      When a user selects an item from a template combobox dropdown list
      that replicates to a common object on another template and the user
      deletes the text from the first template, the selected item on the
      replicated template continues to display on the report generated
      using the 'Preview' button.
  
      Solution
      --------
      The reporting functions were modified to determine the combobox value
      from the text field rather than the selected item, except in the case
      of the combobox being defined as a dropdown list only.
  
      p. Defect - List index out of bounds error (Clinical 
                  Documents/Vitals tab)
  
      Problem
      -------
      CAPRI was generating an application exception error 'List index out 
      of bounds' when a user performed the following steps:
       - Select patient
       - Click on the Clinical Documents tab (CAPRI defaults to the 'Notes'
         tab at bottom of screen)
       - Click on 'Current View' button
       - Select Start and Stop Date Range
       - Click 'Ok' button
       - Click on 'Search by Date' button
       - Click on 'Vitals' tab List
      
      Solution
      --------
      The Vitals report range list is populated with 9 selections 
      (ItemIndex 0 through 8). If a date range is selected using the
      'Current View' button on the 'Notes' tab, then CAPRI forces the
      Vitals report range ItemIndex to '9'. ItemIndex '9' exceeds the
      possible selections, causing the listbox to change the ItemIndex to 
      '-1'. CAPRI errors when it uses the invalid '-1' to check the
      selected item for the word 'DATE'. The code has been modified which
      forces the Vitals report range ItemIndex to '9' and checks for the
      word 'DATE'. Additionally, the code that uses a date range when the
      ItemIndex is '9' has been modified and the 'List index out of bounds'
      error no longer occurs.
  
      q. Defect - Unsigned Text Integrated Utility (TIU) note not deleted
      if signature failed.
  
      Problem
      -------
      Sites using the Class III Abbreviation Checker software have reported
      providers cannot sign or complete a CAPRI template if the TIU note 
      contains an abbreviation not allowed by the Abbreviation Checker 
      application. The TIU note is not deleted resulting in a duplicate TIU
      note for each unsuccessful attempt to complete the CAPRI template. 
  
      Solution
      --------
      CAPRI should be deleting the TIU note when the signature fails.  This
      defect is corrected in this patch to delete the TIU note when the 
      signature fails.
  
  
   3. ACTIVATE BROKER SECURITY ENHANCEMENT (XU*8*522) patch
    
      Technical enhancements have been made to the CAPRI application to
      ensure that CAPRI will function with the final activation of the
      Broker Security Enhancement (BSE) which closes what was previously
      known as the CAPRI visitor access. The final activation of the Broker
      Security Enhancement (BSE) is imminent with the release of the Kernel
      ACTIVATE BROKER SECURITY ENHANCEMENT (XU*8*522) patch.
  
      The 'working' animation indicator notifying CAPRI users a report is 
      processing in the background will be changing as a result of the BSE 
      activation. Modifications to the animation in CAPRI will be included
      in this patch to indicate a report is processing and repaint the
      screen when a user switches to another application and returns to
      CAPRI. Additionally, the list of reports will be disabled while a
      report is running to prevent a user from clicking a second report
      before the first report finished.
  
  
  4. FHIE VistA Server - Synchronization of CAPRI Remote Procedure Calls
  
     The following (4) remote procedure calls (RPC's) and a supporting M 
     routine (DVBABDOD) are being exported with this patch:
       - RPC: DVBAB DOD REPORT TYPES 
       - RPC: DVBAB DOD INFO 
       - RPC: DVBAB DOD REPORT 
       - RPC: DVBAB FIND DFN BY ICN 
  
     These RPC's are used by CAPRI to return Department of Defense report
     data from the Federal Health Information Exchange (FHIE) framework
     (i.e. Station 200) on the DoD Records tab. The RPC's are designed
     specifically for the FHIE VistA server and not local VAMC facilities.
     They are being distributed nationally with the CAPRI application to
     keep the remote procedures and the Capri GUI (Broker) [DVBA CAPRI GUI]
     option consistent on all systems using CAPRI.
      
  
  
 IV. TECHNICAL COMPONENTS
  
   The following section describes the technical components being exported
   with this patch. 
  
   1. The following Option has been modified:
       
       a.        NAME: DVBA CAPRI GUI                    
            MENU TEXT: Capri GUI (Broker)
                 TYPE: Broker (Client/Server)
          DESCRIPTION: This is the 'B' type option used by CAPRI GUI client
                       application. It contains all the RPCs used by the
                       CAPRI GUI application.
  
          Description: The following RPC's are being added to the option:
                         RPC: DVBAB RESTRICTED LIST PATIENTS
                         RPC: DVBAB DOD REPORT TYPES 
                         RPC: DVBAB DOD INFO 
                         RPC: DVBAB DOD REPORT
                         RPC: DVBAB FIND DFN BY ICN        
                         RPC: XUS GET VISITOR
                         RPC: XUS SET VISITOR   
                         RPC: DVBAB CCOW
  
    2. The following Remote Procedure Calls are being added:
       
       a.              NAME: DVBAB RESTRICTED LIST PATIENTS  
                        TAG: RSTLIST
                    ROUTINE: DVBABFRM                
          RETURN VALUE TYPE: GLOBAL ARRAY
            INPUT PARAMETER: DUZ
             PARAMETER TYPE: LITERAL
                DESCRIPTION: Returns a list of restricted patients for
                             CAPRI when in remote mode.
  
       b.              NAME: DVBAB DOD REPORT TYPES  
                        TAG: RPTTYPS
                    ROUTINE: DVBABDOD      
          RETURN VALUE TYPE: ARRAY
               AVAILABILITY: RESTRICTED
                DESCRIPTION: This remote procedure call returns a list of
                             available report types.  The RPC is designed
                             specifically for the FHIE VistA server not the
                             local VAMC facilities.  It is distributed
                             nationally with the CAPRI application to keep
                             the remote procedures and the DVBA CAPRI GUI
                             option consistent on all systems using
                             CAPRI.  Please do not use.
  
  
       c.             NAME: DVBAB DOD INFO               
                       TAG: INFOMSG
                   ROUTINE: DVBABDOD   
         RETURN VALUE TYPE: SINGLE VALUE
              AVAILABILITY: RESTRICTED
               DESCRIPTION: This remote procedure call returns a message to
                            be displayed in CAPRI.  The RPC is designed
                            specifically for the FHIE VistA server not the
                            local VAMC facilities.  It is distributed
                            nationally with the CAPRI application to keep
                            the remote procedures and the DVBA CAPRI GUI
                            option consistent on all systems using CAPRI.  
                            Please do not use.
  
       d.             NAME: DVBAB DOD REPORT 
                       TAG: SENDRPT
                   ROUTINE: DVBABDOD 
         RETURN VALUE TYPE: GLOBAL ARRAY
              AVAILABILITY: RESTRICTED 
              WORD WRAP ON: TRUE
               DESCRIPTION: This remote procedure call returns a DOD report
                            from the FHIE framework. The RPC is designed
                            specifically for the FHIE VistA server not the
                            local VAMC facilities.  It is distributed
                            nationally with the CAPRI application to keep
                            the remote procedures and the DVBA CAPRI GUI
                            option consistent on all systems using CAPRI.  
                            Please do not use.
   
                    Input:  IEN       = Patient's DFN
                            DATATYPE  = Type of data being requested
                            BEGDATE   = Beginning search date
                            ENDDATE   = Ending search date
                            ORMAX     = Max number of entries for report 
          INPUT PARAMETER: IEN       PARAMETER TYPE: LITERAL
          INPUT PARAMETER: DATATYPE  PARAMETER TYPE: LITERAL
          INPUT PARAMETER: BEGDATE   PARAMETER TYPE: LITERAL
          INPUT PARAMETER: ENDDATE   PARAMETER TYPE: LITERAL
          INPUT PARAMETER: ORMAX     PARAMETER TYPE: LITERAL
  
       e.            NAME: DVBAB FIND DFN BY ICN 
                      TAG: ICN
                  ROUTINE: DVBABDOD
        RETURN VALUE TYPE: GLOBAL ARRAY
             AVAILABILITY: PUBLIC
              DESCRIPTION: This remote procedure call returns the patient's
                           DFN associated with the ICN passed to the RPC.  
                           The DFN is the internal entry number in the 
                           Patient (#2) file.  The RPC is designed
                           specifically for the FHIE VistA server not the
                           local VAMC facilities.  It is distributed
                           nationally with the CAPRI application to keep
                           the remote procedures and the DVBA CAPRI GUI
                           option consistent on all systems using CAPRI.  
                           Please do not use.
          INPUT PARAMETER: ICN   PARAMETER TYPE: LITERAL
  
       f.            NAME: DVBAB CCOW
                      TAG: CCOW
                  ROUTINE: DVBABFRM                     
        RETURN VALUE TYPE: SINGLE VALUE
             AVAILABILITY: SUBSCRIPTION
              DESCRIPTION: This remote procedure encapsulates the supported
                           calls $$SITE^VASITE and $$PROD^XUPROD.
                             Parameter TYPE
                              1 = Pass back local station number
                                  ($$SITE^VASITE)
                              2 = Pass back whether production account or
                                  not ($$PROD^XUPROD)
          INPUT PARAMETER: INFOTYPE   PARAMETER TYPE: LITERAL
  
  
    3. The following routines are being added/modified:
  
       a. Modify: DVBAB84
          Description: M code changes were made to convert the DOB and SSN
                       to *SENSITIVE* for sensitive patient records in the
                       results returned by the DVBAB FIND DUPS Remote
                       Procedure Call.
  
       b. Add: DVBABDOD
          Description: The following routine is being exported to 
                       support the following remote procedure calls 
                       (RPC's):
                         - RPC: DVBAB DOD REPORT TYPES 
                         - RPC: DVBAB DOD INFO 
                         - RPC: DVBAB DOD REPORT 
                         - RPC: DVBAB FIND DFN BY ICN 
                       The routine is designed specifically for the Federal
                       Health Information Exchange (FHIE) server (i.e 
                       Station 200). It is being distributed nationally
                       with the CAPRI application so the RPC's and the 
                       supporting routine are consistent on all systems
                       using CAPRI.
  
  
  
 V. SOFTWARE AND DOCUMENTATION RETRIEVAL
     
   1. VistA Patch DVBA*2.7*140
    
      a. The VistA server software is being distributed as a PackMan patch
         message through the National Patch Module (NPM). The KIDS build
         for this patch is DVBA*2.7*140.
  
   2. CAPRI GUI v140 Client Software & User Documentation
  
      a.  The CAPRI GUI v140 client software is being distributed as
          executable DVBA_27_140.EXE. The installed executable for this
          patch is client version 2.7.140.15 with a size of 12,594 KB.
  
          The CAPRI GUI v140 client software and documentation for this
          patch may be retrieved directly using FTP. The preferred method
          is to FTP the files from:
  
             download.vista.med.va.gov
  
         This transmits the files from the first available FTP server.
         Sites may also elect to retrieve software directly from a specific
         server as follows:
  
         OI FIELD OFFICE       FTP ADDRESS                DIRECTORY
         ---------------       -----------                ---------
         Albany           ftp.fo-albany.med.va.gov  [anonymous.software]
         Hines            ftp.fo-hines.med.va.gov   [anonymous.software]
         Salt Lake City   ftp.fo-slc.med.va.gov     [anonymous.software]
  
  
        The following files will be available:
  
        File Name             Format    Description
        ---------             ------    -----------
        DVBA_27_140.ZIP       BINARY    ZIP archive containing the CAPRI
                                        GUI v140 Client Application
                                        executable: DVBA_27_140.EXE
  
        DVBA_27_P140_UM.PDF   BINARY    Updated CAPRI User Manual
  
        DVBA_27_P140_RN.PDF   BINARY    Release Notes     
  
       The VistA Documentation Library (VDL) web site will also contain the
       updated 'CAPRI User Manual'. This web site is usually updated within
       1-3 days of the patch release date.
  
       The VDL web address for CAPRI documentation is:
      
          http://www.va.gov/vdl/application.asp?appid=133
  
  
  
 VI. INSTALLATION REQUIREMENTS/NOTES:
  
  1. Users On the System
  
     a. This VistA server patch (DVBA*2.7*140) may be installed while CAPRI
        GUI users are still using the previous released CAPRI GUI version
        (v123). Since this patch modifies routines used by the CAPRI GUI
        application, it should be loaded during non-peak hours to minimize
        disruption to users and to reduce the possibility of errors when
        the routines are updated.
  
     b. Once the installation of this patch has been completed, CAPRI GUI
        users should be upgraded to the new version of the CAPRI GUI v140
        (DVBA_27_140.EXE).
  
     c. There are no VistA options to disable while installing this patch.
  
  
  2. Software Installation Time
  
     a. The estimated installation time is less than 5 minutes during off
        peak hours.
  
  
  3. Required Builds
  
     a. The following is a list of REQUIRED builds for this KIDS
        distribution (DVBA*2.7*140). KIDS will not allow the installation
        of this patch without their prior installation.
  
        Required Builds:
        ----------------
        DVBA*2.7*123
        DVBA*2.7*137
  
  
  
 VII. INSTALLATION INSTRUCTIONS:
  
    1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
       the KIDS distribution included with this message.
  
    2. From the 'Kernel Installation & Distribution System' menu, select
       the Installation menu.
  
    3. From this menu, you may now elect to use the following options (when
       prompted for INSTALL NAME, enter DVBA*2.7*140).
  
       a. Backup a Transport Global - This option will create a backup
          message of any routines exported with the patch. It will NOT
          backup any changes such as DDs or templates.
       b. Compare Transport Global to Current System - This option will
          allow you to view all changes that will be made when the patch
          is installed.  It compares all components of the patch (routines,
          DDs, templates, etc.).
       c. Verify Checksums in Transport Global - This option will allow you
          to ensure the integrity of the routines that are in the transport
          global.
       d. Print Transport Global - this option will allow you to view the
          components of the KIDS build.
  
    4. Use the Install Package(s) option and select package DVBA*2.7*140.
  
    5. When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
       Install? NO//', respond NO.
  
    6. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
       NO//', it is recommended you answer NO.
  
    7. When prompted to 'Want to DISABLE Scheduled Options, Menu Options,
       and Protocols? NO//', answer NO.
  
    8. Once the installation of this VistA server patch (DVBA*2.7*140)
       has been completed, CAPRI users should be upgraded to the new
       version of the CAPRI GUI v140 (DVBA_27_140.EXE).
  
  
  
 VIII. TEST SITES
  
   The following sites participated in the testing of the CAPRI GUI v140 
   and DVBA*2.7*140 server software.
  
    Test Site:
    ---------- 
     * Alexandria, LA
     * Upstate NY HCS, Albany
     * Saginaw, MI
     * Denver VA Medical Center, Eastern Colorado HCS(ECHCS)

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;2.7;AMIE;**[Patch List]**;Apr 10, 1995;Build 16

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DVBAB84
    Before: B31846335   After: B36589482  **90,137,140**
Routine Name: DVBABDOD
    Before:       n/a   After:  B8507285  **140**
 
Routine list of preceding patches: 137

=============================================================================
User Information:                          Hold Date     : SEP 17, 2009
Entered By  : LOUCK,KEVIN                   Date Entered  : DEC 04, 2008
Completed By: DELACRUZ,KRISTINA             Date Completed: SEP 03, 2009
Released By : FRANCE,KATHI                  Date Released : SEP 17, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
