Released LEX*2*62 SEQ #59
Extracted from mail message
**KIDS**:LEX*2.0*62^

**INSTALL NAME**
LEX*2.0*62
"BLD",6888,0)
LEX*2.0*62^LEXICON UTILITY^0^3081105^y
"BLD",6888,1,0)
^^2^2^3080924^
"BLD",6888,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",6888,1,2,0)
included in this patch.
"BLD",6888,4,0)
^9.64PA^^
"BLD",6888,6.3)
16
"BLD",6888,"INIT")
POST^LEX2062P
"BLD",6888,"KRN",0)
^9.67PA^779.2^20
"BLD",6888,"KRN",.4,0)
.4
"BLD",6888,"KRN",.401,0)
.401
"BLD",6888,"KRN",.402,0)
.402
"BLD",6888,"KRN",.403,0)
.403
"BLD",6888,"KRN",.5,0)
.5
"BLD",6888,"KRN",.84,0)
.84
"BLD",6888,"KRN",3.6,0)
3.6
"BLD",6888,"KRN",3.8,0)
3.8
"BLD",6888,"KRN",9.2,0)
9.2
"BLD",6888,"KRN",9.8,0)
9.8
"BLD",6888,"KRN",9.8,"NM",0)
^9.68A^32^32
"BLD",6888,"KRN",9.8,"NM",1,0)
LEXQCP^^0^B77088041
"BLD",6888,"KRN",9.8,"NM",2,0)
LEXQCP2^^0^B56468860
"BLD",6888,"KRN",9.8,"NM",3,0)
LEXQO^^0^B10990063
"BLD",6888,"KRN",9.8,"NM",4,0)
LEXQM^^0^B27832557
"BLD",6888,"KRN",9.8,"NM",5,0)
LEXQD^^0^B9797548
"BLD",6888,"KRN",9.8,"NM",6,0)
LEXQC^^0^B101390114
"BLD",6888,"KRN",9.8,"NM",7,0)
LEXQC2^^0^B14109806
"BLD",6888,"KRN",9.8,"NM",8,0)
LEXQCM^^0^B66900998
"BLD",6888,"KRN",9.8,"NM",9,0)
LEXQCM2^^0^B58451026
"BLD",6888,"KRN",9.8,"NM",10,0)
LEXQCMA^^0^B41379623
"BLD",6888,"KRN",9.8,"NM",11,0)
LEXQCPA^^0^B9847253
"BLD",6888,"KRN",9.8,"NM",12,0)
LEXQID^^0^B46810138
"BLD",6888,"KRN",9.8,"NM",13,0)
LEXQID2^^0^B36269039
"BLD",6888,"KRN",9.8,"NM",14,0)
LEXQID3^^0^B61299678
"BLD",6888,"KRN",9.8,"NM",15,0)
LEXQID4^^0^B62471424
"BLD",6888,"KRN",9.8,"NM",16,0)
LEXQIDA^^0^B55078060
"BLD",6888,"KRN",9.8,"NM",17,0)
LEXQIP^^0^B67652599
"BLD",6888,"KRN",9.8,"NM",18,0)
LEXQIP2^^0^B18474806
"BLD",6888,"KRN",9.8,"NM",19,0)
LEXQIP3^^0^B28551473
"BLD",6888,"KRN",9.8,"NM",20,0)
LEXQIPA^^0^B3508695
"BLD",6888,"KRN",9.8,"NM",21,0)
LEX2062P^^0^B45118026
"BLD",6888,"KRN",9.8,"NM",22,0)
LEXQL^^0^B49347251
"BLD",6888,"KRN",9.8,"NM",23,0)
LEXQL2^^0^B36280170
"BLD",6888,"KRN",9.8,"NM",24,0)
LEXQL3^^0^B34226328
"BLD",6888,"KRN",9.8,"NM",25,0)
LEXQH^^0^B19745844
"BLD",6888,"KRN",9.8,"NM",26,0)
LEXQHL1^^0^B94982465
"BLD",6888,"KRN",9.8,"NM",27,0)
LEXQHL2^^0^B92433013
"BLD",6888,"KRN",9.8,"NM",28,0)
LEXQHL3^^0^B40808701
"BLD",6888,"KRN",9.8,"NM",29,0)
LEXQHL4^^0^B101257381
"BLD",6888,"KRN",9.8,"NM",30,0)
LEXQHL5^^0^B13324910
"BLD",6888,"KRN",9.8,"NM",31,0)
LEXQHLM^^0^B8941107
"BLD",6888,"KRN",9.8,"NM",32,0)
LEXQHA^^0^B11807617
"BLD",6888,"KRN",9.8,"NM","B","LEX2062P",21)

"BLD",6888,"KRN",9.8,"NM","B","LEXQC",6)

"BLD",6888,"KRN",9.8,"NM","B","LEXQC2",7)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCM",8)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCM2",9)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCMA",10)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCP",1)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCP2",2)

"BLD",6888,"KRN",9.8,"NM","B","LEXQCPA",11)

"BLD",6888,"KRN",9.8,"NM","B","LEXQD",5)

"BLD",6888,"KRN",9.8,"NM","B","LEXQH",25)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHA",32)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHL1",26)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHL2",27)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHL3",28)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHL4",29)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHL5",30)

"BLD",6888,"KRN",9.8,"NM","B","LEXQHLM",31)

"BLD",6888,"KRN",9.8,"NM","B","LEXQID",12)

"BLD",6888,"KRN",9.8,"NM","B","LEXQID2",13)

"BLD",6888,"KRN",9.8,"NM","B","LEXQID3",14)

"BLD",6888,"KRN",9.8,"NM","B","LEXQID4",15)

"BLD",6888,"KRN",9.8,"NM","B","LEXQIDA",16)

"BLD",6888,"KRN",9.8,"NM","B","LEXQIP",17)

"BLD",6888,"KRN",9.8,"NM","B","LEXQIP2",18)

"BLD",6888,"KRN",9.8,"NM","B","LEXQIP3",19)

"BLD",6888,"KRN",9.8,"NM","B","LEXQIPA",20)

"BLD",6888,"KRN",9.8,"NM","B","LEXQL",22)

"BLD",6888,"KRN",9.8,"NM","B","LEXQL2",23)

"BLD",6888,"KRN",9.8,"NM","B","LEXQL3",24)

"BLD",6888,"KRN",9.8,"NM","B","LEXQM",4)

"BLD",6888,"KRN",9.8,"NM","B","LEXQO",3)

"BLD",6888,"KRN",19,0)
19
"BLD",6888,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",6888,"KRN",19,"NM",1,0)
LEX CSV^^0
"BLD",6888,"KRN",19,"NM",2,0)
LEX CSV CPT QUERY^^0
"BLD",6888,"KRN",19,"NM",3,0)
LEX CSV ICD QUERY^^0
"BLD",6888,"KRN",19,"NM",4,0)
LEX CSV ICP QUERY^^0
"BLD",6888,"KRN",19,"NM",5,0)
LEX CSV MOD QUERY^^0
"BLD",6888,"KRN",19,"NM",6,0)
LEX CSV ICD/CPT CHANGE LIST^^0
"BLD",6888,"KRN",19,"NM",7,0)
LEX CSV HISTORY^^0
"BLD",6888,"KRN",19,"NM","B","LEX CSV",1)

"BLD",6888,"KRN",19,"NM","B","LEX CSV CPT QUERY",2)

"BLD",6888,"KRN",19,"NM","B","LEX CSV HISTORY",7)

"BLD",6888,"KRN",19,"NM","B","LEX CSV ICD QUERY",3)

"BLD",6888,"KRN",19,"NM","B","LEX CSV ICD/CPT CHANGE LIST",6)

"BLD",6888,"KRN",19,"NM","B","LEX CSV ICP QUERY",4)

"BLD",6888,"KRN",19,"NM","B","LEX CSV MOD QUERY",5)

"BLD",6888,"KRN",19.1,0)
19.1
"BLD",6888,"KRN",101,0)
101
"BLD",6888,"KRN",409.61,0)
409.61
"BLD",6888,"KRN",771,0)
771
"BLD",6888,"KRN",779.2,0)
779.2
"BLD",6888,"KRN",870,0)
870
"BLD",6888,"KRN",8989.51,0)
8989.51
"BLD",6888,"KRN",8989.52,0)
8989.52
"BLD",6888,"KRN",8994,0)
8994
"BLD",6888,"KRN","B",.4,.4)

"BLD",6888,"KRN","B",.401,.401)

"BLD",6888,"KRN","B",.402,.402)

"BLD",6888,"KRN","B",.403,.403)

"BLD",6888,"KRN","B",.5,.5)

"BLD",6888,"KRN","B",.84,.84)

"BLD",6888,"KRN","B",3.6,3.6)

"BLD",6888,"KRN","B",3.8,3.8)

"BLD",6888,"KRN","B",9.2,9.2)

"BLD",6888,"KRN","B",9.8,9.8)

"BLD",6888,"KRN","B",19,19)

"BLD",6888,"KRN","B",19.1,19.1)

"BLD",6888,"KRN","B",101,101)

"BLD",6888,"KRN","B",409.61,409.61)

"BLD",6888,"KRN","B",771,771)

"BLD",6888,"KRN","B",779.2,779.2)

"BLD",6888,"KRN","B",870,870)

"BLD",6888,"KRN","B",8989.51,8989.51)

"BLD",6888,"KRN","B",8989.52,8989.52)

"BLD",6888,"KRN","B",8994,8994)

"BLD",6888,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",6888,"QUES",0)
^9.62^^
"BLD",6888,"REQB",0)
^9.611^1^1
"BLD",6888,"REQB",1,0)
LEX*2.0*30^2
"BLD",6888,"REQB","B","LEX*2.0*30",1)

"INIT")
POST^LEX2062P
"KRN",19,10334,-1)
0^6
"KRN",19,10334,0)
LEX CSV ICD/CPT CHANGE LIST^ICD/CPT Code Set Change List^^R^^^^^^^^^^1^1
"KRN",19,10334,1,0)
^19.06^2^2^3080924^^^
"KRN",19,10334,1,1,0)
This option produces a listing of ICD/CPT changes effective
"KRN",19,10334,1,2,0)
on the date provided by the user.
"KRN",19,10334,15)
K ^TMP("LEXQC",$J),^TMP("LEXQCO",$J)
"KRN",19,10334,20)
K ^TMP("LEXQC",$J),^TMP("LEXQCO",$J)
"KRN",19,10334,25)
EN^LEXQC
"KRN",19,10334,"U")
ICD/CPT CODE SET CHANGE LIST
"KRN",19,10335,-1)
0^3
"KRN",19,10335,0)
LEX CSV ICD QUERY^ICD-9 Diagnosis Code Set Query^^R^^^^^^^^^^1^1
"KRN",19,10335,1,0)
^^3^3^3080924^
"KRN",19,10335,1,1,0)
This option displays a single versioned entry from the ICD 
"KRN",19,10335,1,2,0)
Diagnosis file #80 based on a date provided by the user.  
"KRN",19,10335,1,3,0)
The date may be a future date.
"KRN",19,10335,15)
K ^TMP("LEXQID",$J),^TMP("LEXQIDA",$J),^TMP("LEXQIDO",$J)
"KRN",19,10335,20)
K ^TMP("LEXQID",$J),^TMP("LEXQIDA",$J),^TMP("LEXQIDO",$J)
"KRN",19,10335,25)
EN^LEXQID
"KRN",19,10335,"U")
ICD-9 DIAGNOSIS CODE SET QUERY
"KRN",19,10336,-1)
0^4
"KRN",19,10336,0)
LEX CSV ICP QUERY^ICD-9 Procedure Code Set Query^^R^^^^^^^^^^1^1
"KRN",19,10336,1,0)
^^3^3^3080924^
"KRN",19,10336,1,1,0)
This option displays a single versioned entry from the ICD 
"KRN",19,10336,1,2,0)
Operations/Procedure file #80.1 based on a date provided 
"KRN",19,10336,1,3,0)
by the user.  The date may be a future date.
"KRN",19,10336,15)
K ^TMP("LEXQIP",$J),^TMP("LEXQIPA",$J),^TMP("LEXQIPO",$J)
"KRN",19,10336,20)
K ^TMP("LEXQIP",$J),^TMP("LEXQIPA",$J),^TMP("LEXQIPO",$J)
"KRN",19,10336,25)
EN^LEXQIP
"KRN",19,10336,"U")
ICD-9 PROCEDURE CODE SET QUERY
"KRN",19,10337,-1)
0^2
"KRN",19,10337,0)
LEX CSV CPT QUERY^CPT/HCPCS Procedure Code Set Query^^R^^^^^^^^^^1^1
"KRN",19,10337,1,0)
^^3^3^3080926^
"KRN",19,10337,1,1,0)
This option displays a single versioned entry from the CPT/HCPCS
"KRN",19,10337,1,2,0)
file #81 based on a date provided by the user.  The date may
"KRN",19,10337,1,3,0)
be a future date.
"KRN",19,10337,15)
K ^TMP("LEXQCPO",$J)
"KRN",19,10337,20)
K ^TMP("LEXQCPO",$J)
"KRN",19,10337,25)
EN^LEXQCP
"KRN",19,10337,"U")
CPT/HCPCS PROCEDURE CODE SET Q
"KRN",19,10338,-1)
0^5
"KRN",19,10338,0)
LEX CSV MOD QUERY^CPT Modifier Code Set Query^^R^^^^^^^^^^1^1
"KRN",19,10338,1,0)
^^3^3^3080924^
"KRN",19,10338,1,1,0)
This option displays a single versioned entry from the CPT
"KRN",19,10338,1,2,0)
Modifier file #81.3 based on a date provided by the user. 
"KRN",19,10338,1,3,0)
The date may be a future date.
"KRN",19,10338,15)
K ^TMP("LEXQCM",$J),^TMP("LEXQCMO",$J)
"KRN",19,10338,20)
K ^TMP("LEXQCM",$J),^TMP("LEXQCMO",$J)
"KRN",19,10338,25)
EN^LEXQCM
"KRN",19,10338,"U")
CPT MODIFIER CODE SET QUERY
"KRN",19,10339,-1)
0^1
"KRN",19,10339,0)
LEX CSV^Code Sets^^M^^^^^^^^
"KRN",19,10339,10,0)
^19.01IP^6^6
"KRN",19,10339,10,1,0)
10335^ICD^1
"KRN",19,10339,10,1,"^")
LEX CSV ICD QUERY
"KRN",19,10339,10,2,0)
10336^ICP^2
"KRN",19,10339,10,2,"^")
LEX CSV ICP QUERY
"KRN",19,10339,10,3,0)
10337^CPT^3
"KRN",19,10339,10,3,"^")
LEX CSV CPT QUERY
"KRN",19,10339,10,4,0)
10338^MOD^4
"KRN",19,10339,10,4,"^")
LEX CSV MOD QUERY
"KRN",19,10339,10,5,0)
10334^LIST^5
"KRN",19,10339,10,5,"^")
LEX CSV ICD/CPT CHANGE LIST
"KRN",19,10339,10,6,0)
10342^HIS^6
"KRN",19,10339,10,6,"^")
LEX CSV HISTORY
"KRN",19,10339,99)
61296,37997
"KRN",19,10339,"U")
CODE SETS
"KRN",19,10342,-1)
0^7
"KRN",19,10342,0)
LEX CSV HISTORY^Code History^^R^^^^^^^^^^1^1
"KRN",19,10342,1,0)
^19.06^2^2^3081028^^^
"KRN",19,10342,1,1,0)
This option produces a historical display of the versioned data
"KRN",19,10342,1,2,0)
for a selected code.
"KRN",19,10342,15)
K ^TMP("LEXQH",$J),^TMP("LEXQHL",$J),^TMP("LEXQHLA"),^TMP("LEXQHO",$J)
"KRN",19,10342,20)
K ^TMP("LEXQH",$J),^TMP("LEXQHL",$J),^TMP("LEXQHLA"),^TMP("LEXQHO",$J)
"KRN",19,10342,25)
EN^LEXQH
"KRN",19,10342,"U")
CODE HISTORY
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",167,-1)
1^1
"PKG",167,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.^^^3011030
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
2.0^2960915
"PKG",167,22,1,"PAH",1,0)
62^3081105
"PKG",167,22,1,"PAH",1,1,0)
^^2^2^3081105
"PKG",167,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",167,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
32
"RTN","LEX2062P")
0^21^B45118026^n/a
"RTN","LEX2062P",1,0)
LEX2062P ;ISL/KER - LEX*2.0*62 Pre/Post Install ;10/30/2008
"RTN","LEX2062P",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEX2062P",3,0)
 ;               
"RTN","LEX2062P",4,0)
 ; Global Variables
"RTN","LEX2062P",5,0)
 ;    ^%ZOSF("TEST")      ICR  10096
"RTN","LEX2062P",6,0)
 ;    ^TMP("LEXKID")      SACC 2.3.2.5.1
"RTN","LEX2062P",7,0)
 ;               
"RTN","LEX2062P",8,0)
 ; External References
"RTN","LEX2062P",9,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEX2062P",10,0)
 ;    ^%ZISC              ICR  10089
"RTN","LEX2062P",11,0)
 ;    ^%ZTLOAD            ICR  10063
"RTN","LEX2062P",12,0)
 ;    MIX^DIC1            ICR  10007
"RTN","LEX2062P",13,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEX2062P",14,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2062P",15,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEX2062P",16,0)
 ;    $$DTIME^XUP         ICR   4409
"RTN","LEX2062P",17,0)
 ;               
"RTN","LEX2062P",18,0)
 Q
"RTN","LEX2062P",19,0)
POST ; LEX*2.0*62 Post-Install
"RTN","LEX2062P",20,0)
 N LEX,LEXA,LEXACCT,LEXB,LEXBB,LEXBLD,LEXBUILD,LEXC,LEXCRE,LEXD,LEXDESC,LEXE,LEXEDT,LEXENV,LEXEX,LEXID,LEXIGHF,LEXL,LEXLREV,LEXM3,LEXMSG
"RTN","LEX2062P",21,0)
 N LEXN,LEXNM,LEXP,LEXPOST,LEXPRO,LEXPRON,LEXPTYPE,LEXREQP,LEXRES,LEXRTN,LEXSEND,LEXSHORT,LEXSTART,LEXSTR,LEXSUB,LEXSUBJ,LEXT,LEXT1,LEXT2,LEXT3
"RTN","LEX2062P",22,0)
 N LEXU,XPDA,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK,X,Y S LEXBB=$$NOW^XLFDT D IMP Q:LEXBUILD=""  S (LEXB,LEXBLD,LEXBUILD)=$G(LEXBUILD)
"RTN","LEX2062P",23,0)
 S U="^",LEXEDT="",LEXSHORT="",LEXMSG="",LEXSTR=$G(LEXPTYPE) D MSG
"RTN","LEX2062P",24,0)
 Q
"RTN","LEX2062P",25,0)
 ;            
"RTN","LEX2062P",26,0)
MSG ; Install Message
"RTN","LEX2062P",27,0)
 N LEXA,LEXACT,LEXB,LEXBUILD,LEXCD,LEXD,LEXDA,LEXE,LEXEDT,LEXEX,LEXFY,LEXIGHF,LEXL,LEXLAST,LEXLREV,LEXID,LEXN,LEXMSG,LEXT,LEXP,LEXPTYPE,LEXQTR
"RTN","LEX2062P",28,0)
 N LEXREQP,LEXRTN,LEXSHORT,LEXSTR,LEXSUB,LEXSUBJ,LEXU,X,Y D IMP Q:LEXBUILD=""  S (LEXSUB,LEXID)="LEXKID",(LEXB,LEXBLD,LEXBUILD)=$G(LEXBUILD)
"RTN","LEX2062P",29,0)
 S LEXEDT="",LEXSHORT="",LEXMSG="",LEXSTR=$G(LEXPTYPE) K ^TMP(LEXID,$J) H 2 S LEXT="" D HDR S LEXB=$$SS^LEXXII($G(LEXBUILD))
"RTN","LEX2062P",30,0)
 S LEXE=$P(LEXB,"^",2),LEXL=$P(LEXB,"^",3),LEXB=$P(LEXB,"^",1) D BOD,TRL,BL^LEXXII,SND
"RTN","LEX2062P",31,0)
HDR ;   Message Header
"RTN","LEX2062P",32,0)
 S (LEXMSG,LEXSHORT,LEXA)="" S LEXACT=$G(LEXACT)
"RTN","LEX2062P",33,0)
 S (LEXSUBJ,LEXT)="Code Sets Query Options" D TL^LEXXII(LEXT) S LEXT="=======================" D TL^LEXXII(LEXT),BL^LEXXII
"RTN","LEX2062P",34,0)
 S LEXD=$$ASOF^LEXXII,LEXA=$$UCI^LEXXII,LEXU=$$USR^LEXXII,LEXN=$P(LEXU,"^",1) S:$L($P(LEXACT,"^",1))&($L($P(LEXACT,"^",1))) LEXA=LEXACT
"RTN","LEX2062P",35,0)
 S LEXP=$P(LEXU,"^",2),LEXN=$$PM^LEXXFI7(LEXN) S:$L(LEXD) LEXT="  As of:       "_LEXD D:$L(LEXD) TL^LEXXII(LEXT)
"RTN","LEX2062P",36,0)
 S LEXT="" S:$L(LEXA) LEXT="  In Account:  "_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEX2062P",37,0)
 S:$L(LEXT)&($L($P(LEXA,"^",2))) LEXT=LEXT_"  "_$P(LEXA,"^",2) D:$L(LEXA) TL^LEXXII(LEXT) S LEXT="" S:$L(LEXU) LEXT="  Maint By:    "
"RTN","LEX2062P",38,0)
 S:$L(LEXN) LEXT=LEXT_LEXN S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP D:$L(LEXT)&(LEXT'["UNKNOWN") TL^LEXXII(LEXT)
"RTN","LEX2062P",39,0)
 S LEXT="" S:$L($G(LEXBUILD)) LEXT="  Build:       "_$G(LEXBUILD) D:$L(LEXT) TL^LEXXII(LEXT)
"RTN","LEX2062P",40,0)
 S LEXT="" S:$L($G(LEXIGHF)) LEXT="  Host File:   "_$G(LEXIGHF)
"RTN","LEX2062P",41,0)
 S:$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT=LEXT_" (Created "_$$ED^LEXXII($G(LEXCRE))_")"
"RTN","LEX2062P",42,0)
 S:'$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT="  Created:     "_$$ED^LEXXII($G(LEXCRE))
"RTN","LEX2062P",43,0)
 D:$L(LEXT) TL^LEXXII(LEXT)
"RTN","LEX2062P",44,0)
 Q
"RTN","LEX2062P",45,0)
BOD ;   Message Body
"RTN","LEX2062P",46,0)
 N LEXOP,LEXOK,LEXRES,LEXT
"RTN","LEX2062P",47,0)
 S LEXOP="LEX CSV",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="  Code Sets Menu ..."
"RTN","LEX2062P",48,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",49,0)
 S LEXOP="LEX CSV ICD QUERY",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    ICD-9 Diagnosis Query"
"RTN","LEX2062P",50,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",51,0)
 S LEXOP="LEX CSV ICP QUERY",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    ICD-9 Procedure Query"
"RTN","LEX2062P",52,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",53,0)
 S LEXOP="LEX CSV CPT QUERY",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    CPT/HCPCS Procedure Query"
"RTN","LEX2062P",54,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",55,0)
 S LEXOP="LEX CSV MOD QUERY",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    CPT Modifier Query"
"RTN","LEX2062P",56,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",57,0)
 S LEXOP="LEX CSV ICD/CPT CHANGE LIST",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    ICD/CPT Change List"
"RTN","LEX2062P",58,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",59,0)
 S LEXOP="LEX CSV HISTORY",LEXOK=$$OPT(LEXOP),LEXRES=$S(+LEXOK>0:"installed",1:"not installed"),LEXC=+($G(LEXC))+1,LEXT="    Code History"
"RTN","LEX2062P",60,0)
 S LEXT=LEXT_$J(" ",(31-$L(LEXT)))_"["_LEXOP_"]",LEXT=LEXT_$J(" ",(62-$L(LEXT)))_LEXRES D:LEXC=1 BL^LEXXII D TL^LEXXII(LEXT)
"RTN","LEX2062P",61,0)
 Q
"RTN","LEX2062P",62,0)
TRL ;   Message Trailer
"RTN","LEX2062P",63,0)
 S LEXB=$G(LEXB),LEXE=$G(LEXE),LEXL=$G(LEXL) Q:'$L(LEXB)  N LEXT
"RTN","LEX2062P",64,0)
 I $D(LEXTIME) I $P(LEXB,".",1)?7N!($P(LEXB,".",2)?7N)!($P(LEXB,".",3)[":") D
"RTN","LEX2062P",65,0)
 . D BL^LEXXII I $P(LEXB,".",1)?7N S LEXT="" S LEXT="  Started:     "_$$ED^LEXXII($G(LEXB)) D TL^LEXXII(LEXT)
"RTN","LEX2062P",66,0)
 . I $P(LEXE,".",1)?7N S LEXT="" S LEXT="  Finished:    "_$$ED^LEXXII($G(LEXE)) D TL^LEXXII(LEXT)
"RTN","LEX2062P",67,0)
 . I $L(LEXL) S LEXT="" S LEXT="  Elapsed:     "_$$ED^LEXXII($G(LEXL)) D TL^LEXXII(LEXT)
"RTN","LEX2062P",68,0)
 Q
"RTN","LEX2062P",69,0)
SND ;   Send Message
"RTN","LEX2062P",70,0)
 N LEXDESC,LEXENV,LEXID,LEXP,LEXACCT,LEXPRO,LEXPRON,LEXSEND,LEXSUB,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZTQUEUED,ZTREQ
"RTN","LEX2062P",71,0)
 S LEXP=0,LEXENV=$$ENV Q:+LEXENV'>0  S (LEXMSG,LEXSEND,LEXPOST)="",(LEXSUB,LEXID)="LEXKID",LEXACCT=$$U^LEXXFI7 S ZTSAVE("LEXACCT")=""
"RTN","LEX2062P",72,0)
 S ZTRTN="MAIL^LEXXFI",ZTSAVE("LEXSEND")="",ZTSAVE("LEXPOST")="" S:$D(LEXLREV) ZTSAVE("LEXLREV")="" S:$D(LEXREQP) ZTSAVE("LEXREQP")=""
"RTN","LEX2062P",73,0)
 S:$D(LEXBUILD) ZTSAVE("LEXBUILD")="" S:$D(LEXPOST) ZTSAVE("LEXPOST")="" S:$D(LEXSHORT) ZTSAVE("LEXSHORT")="" S:$D(LEXSTART) ZTSAVE("LEXSTART")=""
"RTN","LEX2062P",74,0)
 S:$D(^TMP("LEXKID",$J)) ZTSAVE("^TMP(""LEXKID"",$J,")="" S:$D(LEXID) ZTSAVE("LEXID")="" S:$D(LEXRES) ZTSAVE("LEXRES")=""
"RTN","LEX2062P",75,0)
 S:$D(XPDA) ZTSAVE("XPDA")="" S (LEXDESC,ZTDESC)="Post-Install CSV" S ZTDTH=$H S ZTIO="" S ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","LEX2062P",76,0)
 D ^%ZTLOAD W:+($G(ZTSK))>0 !!,"  ",LEXDESC,!,"  Queued Task #",+($G(ZTSK)) W ! D ^%ZISC
"RTN","LEX2062P",77,0)
 Q
"RTN","LEX2062P",78,0)
 ;            
"RTN","LEX2062P",79,0)
 ; Miscellaneous
"RTN","LEX2062P",80,0)
IMP ;   Import names
"RTN","LEX2062P",81,0)
 K LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXSUBJ S LEXPTYPE="Lexicon CSV Query Utilities",LEXLREV=62
"RTN","LEX2062P",82,0)
 S LEXREQP="LEX*2.0*30",LEXBUILD="LEX*2.0*62",(LEXIGHF,LEXFY,LEXQTR)="",LEXSUBJ=$G(LEXPTYPE)
"RTN","LEX2062P",83,0)
 Q
"RTN","LEX2062P",84,0)
OPT(X) ;   Option Found
"RTN","LEX2062P",85,0)
 N DIC,DTOUT,DUOUT,D,Y S DIC="^DIC(19,",DIC(0)="O",D="B",X=$G(X) Q:'$L(X) 0  D MIX^DIC1 Q:+Y'>0 0
"RTN","LEX2062P",86,0)
 Q 1
"RTN","LEX2062P",87,0)
ROK(X) ;   Routine OK
"RTN","LEX2062P",88,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1
"RTN","LEX2062P",89,0)
 Q 0
"RTN","LEX2062P",90,0)
CLR ;   Clear
"RTN","LEX2062P",91,0)
 K LEXTIME
"RTN","LEX2062P",92,0)
 Q
"RTN","LEX2062P",93,0)
ENV(X) ;   Environment check
"RTN","LEX2062P",94,0)
 N LEXNM D HOME^%ZIS S:$G(DT)'?7N DT=$$DT^XLFDT I +($G(DUZ))'>0 W !!,"    User (DUZ) not defined",! Q 0
"RTN","LEX2062P",95,0)
 S LEXNM=$$GET1^DIQ(200,+($G(DUZ)),.01) I '$L(LEXNM) W !!,"    Invalid User (DUZ) defined",! Q 0
"RTN","LEX2062P",96,0)
 S DTIME=$$DTIME^XUP(+($G(DUZ)))
"RTN","LEX2062P",97,0)
 Q 1
"RTN","LEXQC")
0^6^B101390114^n/a
"RTN","LEXQC",1,0)
LEXQC ;ISL/KER - Query - Code Set (CSV) - Extract ;10/30/2008
"RTN","LEXQC",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQC",3,0)
 ;               
"RTN","LEXQC",4,0)
 ; Global Variables
"RTN","LEXQC",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQC",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQC",7,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQC",8,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQC",9,0)
 ;    ^TMP("LEXQC")       SACC 2.3.2.5.1
"RTN","LEXQC",10,0)
 ;    ^TMP("LEXQCO")      SACC 2.3.2.5.1
"RTN","LEXQC",11,0)
 ;               
"RTN","LEXQC",12,0)
 ; External References
"RTN","LEXQC",13,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXQC",14,0)
 ;    $$FMADD^XLFDT       ICR  10103
"RTN","LEXQC",15,0)
 ;               
"RTN","LEXQC",16,0)
EN ; Main Entry Point
"RTN","LEXQC",17,0)
 N LEXENV S LEXENV=$$EV^LEXQM Q:+LEXENV'>0  K ^TMP("LEXQCO",$J),^TMP("LEXQC",$J) N LEXCDT,LEXEDT,LEXEXIT S LEXCDT=$$CSD^LEXQM Q:'$L(LEXCDT)
"RTN","LEXQC",18,0)
 Q:+($G(LEXEXIT))>0  S LEXEDT=$P(LEXCDT,"^",1),LEXCDT=$P(LEXCDT,"^",2) Q:LEXCDT'?7N  D TASK
"RTN","LEXQC",19,0)
 Q
"RTN","LEXQC",20,0)
TASK ; Task Re-indexing
"RTN","LEXQC",21,0)
 N X,Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTQUEUED,ZTREQ S LEXCDT=+($G(LEXCDT)) Q:LEXCDT'?7N  S LEXEDT=$G(LEXEDT) Q:'$L(LEXEDT)
"RTN","LEXQC",22,0)
 S ZTRTN="SEARCH^LEXQC",ZTDESC="Search for CSV Changes on "_LEXEDT,ZTSAVE("LEXCDT")="",ZTIO="",ZTDTH=$H
"RTN","LEXQC",23,0)
 D @ZTRTN D HOME^%ZIS S X=+($G(ZTSK)) W:+X>0 !!,"   A search for CSV changes on ",LEXEDT," has been queued (task ",+X,")",!
"RTN","LEXQC",24,0)
 K Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN
"RTN","LEXQC",25,0)
 Q
"RTN","LEXQC",26,0)
SEARCH ; Search for CSV changes
"RTN","LEXQC",27,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXQC",28,0)
 S LEXCDT=$G(LEXCDT) Q:LEXCDT'?7N  N LEXBDT,LEXADT,LEXQTOT,LEXQLEN,LEXQSTR S LEXBDT=$$FMADD^XLFDT(LEXCDT,-1),LEXADT=$$FMADD^XLFDT(DT,+1) Q:LEXBDT'?7N  Q:LEXADT'?7N
"RTN","LEXQC",29,0)
 K ^TMP("LEXQC",$J) S LEXQTOT=$P($G(^ICPT(0)),"^",4)+$P($G(^ICD9(0)),"^",4)+$P($G(^ICD0(0)),"^",4)+$P($G(^DIC(81.3,0)),"^",4)
"RTN","LEXQC",30,0)
 S LEXQLEN=68,LEXQSTR=+(LEXQTOT\LEXQLEN) S:LEXQSTR=0 LEXQSTR=1
"RTN","LEXQC",31,0)
 W !!,"   " D ICD,ICP,CPT,MOD
"RTN","LEXQC",32,0)
 D EN^LEXQC2 D:$D(^TMP("LEXQCO",$J)) DSP^LEXQO("LEXQCO")
"RTN","LEXQC",33,0)
 Q
"RTN","LEXQC",34,0)
ICD ; ICD Changes
"RTN","LEXQC",35,0)
 K ^TMP("LEXQC",$J,"ICD") N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCNT,LEXCST,LEXH,LEXIEN,LEXLC,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID
"RTN","LEXQC",36,0)
 S LEXQLEN=+($G(LEXQLEN)),LEXQTOT=+($G(LEXQTOT)),LEXQSTR=+($G(LEXQSTR)),LEXCNT=0,LEXLC=0
"RTN","LEXQC",37,0)
 S LEXIEN=0 F  S LEXIEN=$O(^ICD9(LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQC",38,0)
 . N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCST,LEXH,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID S LEXCNT=LEXCNT+1
"RTN","LEXQC",39,0)
 . I LEXCNT'<+($G(LEXQSTR)) S LEXLC=+($G(LEXLC))+1 W:LEXLC'>+($G(LEXQLEN)) "." S LEXCNT=0
"RTN","LEXQC",40,0)
 . S LEXSO=$P($G(^ICD9(LEXIEN,0)),"^",1) Q:'$L(LEXSO)
"RTN","LEXQC",41,0)
 . S LEXH=$O(^ICD9(+LEXIEN,66,"B",LEXCDT," "),-1),LEXND=$G(^ICD9(+LEXIEN,66,+LEXH,0)),LEXCEF=$P(LEXND,"^",1),LEXCST=$P(LEXND,"^",2)
"RTN","LEXQC",42,0)
 . S LEXH=$O(^ICD9(+LEXIEN,66,"B",LEXBDT," "),-1),LEXND=$G(^ICD9(+LEXIEN,66,+LEXH,0)),LEXBEF=$P(LEXND,"^",1),LEXBST=$P(LEXND,"^",2)
"RTN","LEXQC",43,0)
 . S LEXH=$O(^ICD9(+LEXIEN,66,"B",LEXADT," "),-1),LEXND=$G(^ICD9(+LEXIEN,66,+LEXH,0)),LEXAEF=$P(LEXND,"^",1),LEXAST=$P(LEXND,"^",2)
"RTN","LEXQC",44,0)
 . S LEXH=$O(^ICD9(+LEXIEN,66,"B",LEXCDT),-1),LEXH=$O(^ICD9(+LEXIEN,66,"B",+LEXH," "),-1),LEXND=$G(^ICD9(+LEXIEN,66,+LEXH,0)),LEXPEF=$P(LEXND,"^",1),LEXPST=$P(LEXND,"^",2)
"RTN","LEXQC",45,0)
 . S LEX1=$D(^ICD9(+LEXIEN,67,"B",LEXCDT))>0,LEX2=$D(^ICD9(+LEXIEN,68,"B",LEXCDT))>0
"RTN","LEXQC",46,0)
 . S LEX3=$O(^ICD9(+LEXIEN,67,"B",LEXCDT),-1),LEX4=$O(^ICD9(+LEXIEN,68,"B",LEXCDT),-1)
"RTN","LEXQC",47,0)
 . S LEXQL=0 I $L(LEXCST),$L(LEXCEF) D
"RTN","LEXQC",48,0)
 . . Q:$L(LEXBEF)&($L(LEXBST))&(LEXBST'=LEXCST)  Q:$L(LEXAEF)&($L(LEXAST))&(LEXAST'=LEXCST)  Q:(LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))
"RTN","LEXQC",49,0)
 . . N LEXSTID Q:'$L($G(LEXSO))  S LEXSTID=$S(+LEXCST>0:"ACT",1:"INA")
"RTN","LEXQC",50,0)
 . . I LEXSTID="ACT",$G(LEXPEF)?7N,+($G(LEXPST))'>0,'$L(LEX3),'$L(LEX4) S LEXSTID="REA"
"RTN","LEXQC",51,0)
 . . S LEXQL=1,^TMP("LEXQC",$J,"ICD",LEXSTID,1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",52,0)
 . . S ^TMP("LEXQC",$J,"ICD",LEXSTID,0)=+($G(^TMP("LEXQC",$J,"ICD",LEXSTID,0)))+1
"RTN","LEXQC",53,0)
 . I 'LEXQL I +LEXPST>0,((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D
"RTN","LEXQC",54,0)
 . . Q:'$L($G(LEXSO))  S LEXQL=1 S ^TMP("LEXQC",$J,"ICD","REV",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",55,0)
 . . S ^TMP("LEXQC",$J,"ICD","REV",0)=+($G(^TMP("LEXQC",$J,"ICD","REV",0)))+1
"RTN","LEXQC",56,0)
 . I 'LEXQL S LEXQL=0 I ((LEXCEF?7N&(LEXCST>0))!(LEXPEF?7N&(LEXPST>0))),((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D
"RTN","LEXQC",57,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,"ICD","REU",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",58,0)
 . . S ^TMP("LEXQC",$J,"ICD","REU",0)=+($G(^TMP("LEXQC",$J,"ICD","REU",0)))+1
"RTN","LEXQC",59,0)
 . I 'LEXQL I $D(^ICD9(+($G(LEXIEN)),69,"B",+($G(LEXCDT)))) D
"RTN","LEXQC",60,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,"ICC","UPD",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",61,0)
 . . S ^TMP("LEXQC",$J,"ICC","UPD",0)=+($G(^TMP("LEXQC",$J,"ICC","UPD",0)))+1
"RTN","LEXQC",62,0)
 Q
"RTN","LEXQC",63,0)
ICP ;
"RTN","LEXQC",64,0)
 K ^TMP("LEXQC",$J,"ICP") N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCNT,LEXCST,LEXH,LEXIEN,LEXLC,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID
"RTN","LEXQC",65,0)
 S LEXQLEN=+($G(LEXQLEN)),LEXQTOT=+($G(LEXQTOT)),LEXQSTR=+($G(LEXQSTR)),LEXCNT=0,LEXLC=0
"RTN","LEXQC",66,0)
 S LEXIEN=0 F  S LEXIEN=$O(^ICD0(LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQC",67,0)
 . N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCST,LEXH,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID S LEXCNT=LEXCNT+1
"RTN","LEXQC",68,0)
 . I LEXCNT'<+($G(LEXQSTR)) S LEXLC=+($G(LEXLC))+1 W:LEXLC'>+($G(LEXQLEN)) "." S LEXCNT=0
"RTN","LEXQC",69,0)
 . S LEXSO=$P($G(^ICD0(LEXIEN,0)),"^",1) Q:'$L(LEXSO)
"RTN","LEXQC",70,0)
 . S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXCDT," "),-1),LEXND=$G(^ICD0(+LEXIEN,66,+LEXH,0)),LEXCEF=$P(LEXND,"^",1),LEXCST=$P(LEXND,"^",2)
"RTN","LEXQC",71,0)
 . S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXBDT," "),-1),LEXND=$G(^ICD0(+LEXIEN,66,+LEXH,0)),LEXBEF=$P(LEXND,"^",1),LEXBST=$P(LEXND,"^",2)
"RTN","LEXQC",72,0)
 . S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXADT," "),-1),LEXND=$G(^ICD0(+LEXIEN,66,+LEXH,0)),LEXAEF=$P(LEXND,"^",1),LEXAST=$P(LEXND,"^",2)
"RTN","LEXQC",73,0)
 . S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXCDT),-1),LEXH=$O(^ICD0(+LEXIEN,66,"B",+LEXH," "),-1),LEXND=$G(^ICD0(+LEXIEN,66,+LEXH,0)),LEXPEF=$P(LEXND,"^",1),LEXPST=$P(LEXND,"^",2)
"RTN","LEXQC",74,0)
 . S LEX1=$D(^ICD0(+LEXIEN,67,"B",LEXCDT))>0,LEX2=$D(^ICD0(+LEXIEN,68,"B",LEXCDT))>0
"RTN","LEXQC",75,0)
 . S LEX3=$O(^ICD0(+LEXIEN,67,"B",LEXCDT),-1),LEX4=$O(^ICD0(+LEXIEN,68,"B",LEXCDT),-1)
"RTN","LEXQC",76,0)
 . S LEXQL=0 I $L(LEXCST),$L(LEXCEF) D  Q:LEXQL
"RTN","LEXQC",77,0)
 . . Q:$L(LEXBEF)&($L(LEXBST))&(LEXBST'=LEXCST)  Q:$L(LEXAEF)&($L(LEXAST))&(LEXAST'=LEXCST)    Q:(LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))
"RTN","LEXQC",78,0)
 . . N LEXSTID Q:'$L($G(LEXSO))  S LEXSTID=$S(+LEXCST>0:"ACT",1:"INA")
"RTN","LEXQC",79,0)
 . . I LEXSTID="ACT",$G(LEXPEF)?7N,+($G(LEXPST))'>0,'$L(LEX3),'$L(LEX4) S LEXSTID="REA"
"RTN","LEXQC",80,0)
 . . S LEXQL=1,^TMP("LEXQC",$J,"ICP",LEXSTID,1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",81,0)
 . . S ^TMP("LEXQC",$J,"ICP",LEXSTID,0)=+($G(^TMP("LEXQC",$J,"ICP",LEXSTID,0)))+1
"RTN","LEXQC",82,0)
 . S LEXQL=0 I +LEXPST>0,((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D  Q:LEXQL
"RTN","LEXQC",83,0)
 . . Q:'$L($G(LEXSO))
"RTN","LEXQC",84,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,"ICP","REV",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",85,0)
 . . S ^TMP("LEXQC",$J,"ICP","REV",0)=+($G(^TMP("LEXQC",$J,"ICP","REV",0)))+1
"RTN","LEXQC",86,0)
 . S LEXQL=0 I ((LEXCEF?7N&(LEXCST>0))!(LEXPEF?7N&(LEXPST>0))),((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D
"RTN","LEXQC",87,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,"ICP","REU",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",88,0)
 . . S ^TMP("LEXQC",$J,"ICP","REU",0)=+($G(^TMP("LEXQC",$J,"ICP","REU",0)))+1
"RTN","LEXQC",89,0)
 Q
"RTN","LEXQC",90,0)
CPT ;
"RTN","LEXQC",91,0)
 K ^TMP("LEXQC",$J,"CPT"),^TMP("LEXQC",$J,"CPC") N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCNT,LEXCST,LEXH,LEXIEN,LEXLC,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID
"RTN","LEXQC",92,0)
 S LEXQLEN=+($G(LEXQLEN)),LEXQTOT=+($G(LEXQTOT)),LEXQSTR=+($G(LEXQSTR)),LEXCNT=0,LEXLC=0
"RTN","LEXQC",93,0)
 S LEXIEN=0 F  S LEXIEN=$O(^ICPT(LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQC",94,0)
 . N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCST,LEXH,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID,LEXSID S LEXCNT=LEXCNT+1
"RTN","LEXQC",95,0)
 . I LEXCNT'<+($G(LEXQSTR)) S LEXLC=+($G(LEXLC))+1 W:LEXLC'>+($G(LEXQLEN)) "." S LEXCNT=0
"RTN","LEXQC",96,0)
 . S LEXSID="CPT",LEXSO=$P($G(^ICPT(LEXIEN,0)),"^",1) Q:'$L(LEXSO)  S:$E(LEXSO,1)?1U LEXSID="CPC"
"RTN","LEXQC",97,0)
 . S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXCDT," "),-1),LEXND=$G(^ICPT(+LEXIEN,60,+LEXH,0)),LEXCEF=$P(LEXND,"^",1),LEXCST=$P(LEXND,"^",2)
"RTN","LEXQC",98,0)
 . S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXBDT," "),-1),LEXND=$G(^ICPT(+LEXIEN,60,+LEXH,0)),LEXBEF=$P(LEXND,"^",1),LEXBST=$P(LEXND,"^",2)
"RTN","LEXQC",99,0)
 . S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXADT," "),-1),LEXND=$G(^ICPT(+LEXIEN,60,+LEXH,0)),LEXAEF=$P(LEXND,"^",1),LEXAST=$P(LEXND,"^",2)
"RTN","LEXQC",100,0)
 . S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXCDT),-1),LEXH=$O(^ICPT(+LEXIEN,60,"B",+LEXH," "),-1),LEXND=$G(^ICPT(+LEXIEN,60,+LEXH,0)),LEXPEF=$P(LEXND,"^",1),LEXPST=$P(LEXND,"^",2)
"RTN","LEXQC",101,0)
 . S LEX1=$D(^ICPT(+LEXIEN,61,"B",LEXCDT))>0,LEX2=$D(^ICPT(+LEXIEN,62,"B",LEXCDT))>0
"RTN","LEXQC",102,0)
 . S LEX3=$O(^ICPT(+LEXIEN,61,"B",LEXCDT),-1),LEX4=$O(^ICPT(+LEXIEN,62,"B",LEXCDT),-1)
"RTN","LEXQC",103,0)
 . S LEXQL=0 I $L(LEXCST),$L(LEXCEF) D  Q:LEXQL
"RTN","LEXQC",104,0)
 . . Q:$L(LEXBEF)&($L(LEXBST))&(LEXBST'=LEXCST)  Q:$L(LEXAEF)&($L(LEXAST))&(LEXAST'=LEXCST)    Q:(LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))
"RTN","LEXQC",105,0)
 . . N LEXSTID Q:'$L($G(LEXSO))  S LEXSTID=$S(+LEXCST>0:"ACT",1:"INA")
"RTN","LEXQC",106,0)
 . . I LEXSTID="ACT",$G(LEXPEF)?7N,+($G(LEXPST))'>0,'$L(LEX3),'$L(LEX4) S LEXSTID="REA"
"RTN","LEXQC",107,0)
 . . S LEXQL=1,^TMP("LEXQC",$J,LEXSID,LEXSTID,1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",108,0)
 . . S ^TMP("LEXQC",$J,LEXSID,LEXSTID,0)=+($G(^TMP("LEXQC",$J,LEXSID,LEXSTID,0)))+1
"RTN","LEXQC",109,0)
 . S LEXQL=0 I +LEXPST>0,((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D  Q:LEXQL
"RTN","LEXQC",110,0)
 . . Q:'$L($G(LEXSO))
"RTN","LEXQC",111,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,LEXSID,"REV",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",112,0)
 . . S ^TMP("LEXQC",$J,LEXSID,"REV",0)=+($G(^TMP("LEXQC",$J,LEXSID,"REV",0)))+1
"RTN","LEXQC",113,0)
 . S LEXQL=0 I ((LEXCEF?7N&(LEXCST>0))!(LEXPEF?7N&(LEXPST>0))),((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D
"RTN","LEXQC",114,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,LEXSID,"REU",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",115,0)
 . . S ^TMP("LEXQC",$J,LEXSID,"REU",0)=+($G(^TMP("LEXQC",$J,LEXSID,"REU",0)))+1
"RTN","LEXQC",116,0)
 Q
"RTN","LEXQC",117,0)
MOD ;
"RTN","LEXQC",118,0)
 K ^TMP("LEXQC",$J,"MOD") N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAST,LEXBEF,LEXBST,LEXCEF,LEXCNT,LEXCST,LEXH,LEXIEN,LEXLC,LEXND,LEXPEF,LEXPST,LEXQL,LEXSO,LEXSTID
"RTN","LEXQC",119,0)
 S LEXQLEN=+($G(LEXQLEN)),LEXQTOT=+($G(LEXQTOT)),LEXQSTR=+($G(LEXQSTR)),LEXCNT=0,LEXLC=0
"RTN","LEXQC",120,0)
 S LEXIEN=0 F  S LEXIEN=$O(^DIC(81.3,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQC",121,0)
 . N LEX1,LEX2,LEX3,LEX4,LEXAEF,LEXAF,LEXAST,LEXACT,LEXBEF,LEXBST,LEXCEF,LEXCST,LEXH,LEXIF,LEXINA,LEXND,LEXPEF,LEXPST,LEXQL,LEXRI,LEXSO,LEXSTID,LEXSID S LEXCNT=LEXCNT+1
"RTN","LEXQC",122,0)
 . I LEXCNT'<+($G(LEXQSTR)) S LEXLC=+($G(LEXLC))+1 W:LEXLC'>+($G(LEXQLEN)) "." S LEXCNT=0
"RTN","LEXQC",123,0)
 . S LEXSID="MOD" S LEXSO=$P($G(^DIC(81.3,LEXIEN,0)),"^",1) Q:'$L(LEXSO)
"RTN","LEXQC",124,0)
 . S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXCDT," "),-1),LEXND=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)),LEXCEF=$P(LEXND,"^",1),LEXCST=$P(LEXND,"^",2)
"RTN","LEXQC",125,0)
 . S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXBDT," "),-1),LEXND=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)),LEXBEF=$P(LEXND,"^",1),LEXBST=$P(LEXND,"^",2)
"RTN","LEXQC",126,0)
 . S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXADT," "),-1),LEXND=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)),LEXAEF=$P(LEXND,"^",1),LEXAST=$P(LEXND,"^",2)
"RTN","LEXQC",127,0)
 . S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXCDT),-1),LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",+LEXH," "),-1),LEXND=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)),LEXPEF=$P(LEXND,"^",1),LEXPST=$P(LEXND,"^",2)
"RTN","LEXQC",128,0)
 . S LEX1=$D(^DIC(81.3,+LEXIEN,61,"B",LEXCDT))>0,LEX2=$D(^DIC(81.3,+LEXIEN,62,"B",LEXCDT))>0
"RTN","LEXQC",129,0)
 . S LEX3=$O(^DIC(81.3,+LEXIEN,61,"B",LEXCDT),-1),LEX4=$O(^DIC(81.3,+LEXIEN,62,"B",LEXCDT),-1)
"RTN","LEXQC",130,0)
 . S LEXQL=0 I $L(LEXCST),$L(LEXCEF) D
"RTN","LEXQC",131,0)
 . . Q:$L(LEXBEF)&($L(LEXBST))&(LEXBST'=LEXCST)  Q:$L(LEXAEF)&($L(LEXAST))&(LEXAST'=LEXCST)    Q:(LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))
"RTN","LEXQC",132,0)
 . . N LEXSTID Q:'$L($G(LEXSO))  S LEXSTID=$S(+LEXCST>0:"ACT",1:"INA")
"RTN","LEXQC",133,0)
 . . I LEXSTID="ACT",$G(LEXPEF)?7N,+($G(LEXPST))'>0,'$L(LEX3),'$L(LEX4) S LEXSTID="REA"
"RTN","LEXQC",134,0)
 . . S LEXQL=1,^TMP("LEXQC",$J,LEXSID,LEXSTID,1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",135,0)
 . . S ^TMP("LEXQC",$J,LEXSID,LEXSTID,0)=+($G(^TMP("LEXQC",$J,LEXSID,LEXSTID,0)))+1
"RTN","LEXQC",136,0)
 . I 'LEXQL I +LEXPST>0,((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D  Q:LEXQL
"RTN","LEXQC",137,0)
 . . Q:'$L($G(LEXSO))
"RTN","LEXQC",138,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,LEXSID,"REV",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",139,0)
 . . S ^TMP("LEXQC",$J,LEXSID,"REV",0)=+($G(^TMP("LEXQC",$J,LEXSID,"REV",0)))+1
"RTN","LEXQC",140,0)
 . I 'LEXQL S LEXQL=0 I ((LEXCEF?7N&(LEXCST>0))!(LEXPEF?7N&(LEXPST>0))),((LEX1>0&(LEX3?7N))!(LEX2>0&(LEX4?7N))) D
"RTN","LEXQC",141,0)
 . . S LEXQL=1 S ^TMP("LEXQC",$J,LEXSID,"REU",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",142,0)
 . . S ^TMP("LEXQC",$J,LEXSID,"REU",0)=+($G(^TMP("LEXQC",$J,LEXSID,"REU",0)))+1
"RTN","LEXQC",143,0)
 . S (LEXAF,LEXIF,LEXRI)=0,LEXSID="RAN" F  S LEXRI=$O(^DIC(81.3,+LEXIEN,10,LEXRI)) Q:+LEXRI'>0  D  Q:(+LEXAF+LEXIF)>1
"RTN","LEXQC",144,0)
 . . S LEXND=$G(^DIC(81.3,+LEXIEN,10,LEXRI,0)) S LEXACT=$P(LEXND,"^",3),LEXINA=$P(LEXND,"^",4)
"RTN","LEXQC",145,0)
 . . I LEXACT=LEXCDT,'$L(LEXINA) D
"RTN","LEXQC",146,0)
 . . . Q:$D(^TMP("LEXQC",$J,LEXSID,"ACT",1,(LEXSO_" ")))
"RTN","LEXQC",147,0)
 . . . S ^TMP("LEXQC",$J,LEXSID,"ACT",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",148,0)
 . . . S ^TMP("LEXQC",$J,LEXSID,"ACT",0)=+($G(^TMP("LEXQC",$J,LEXSID,"ACT",0)))+1,LEXAF=1
"RTN","LEXQC",149,0)
 . . I LEXINA=LEXCDT,$L(LEXACT),LEXINA>LEXACT,(LEXINA-LEXACT)>1 D
"RTN","LEXQC",150,0)
 . . . Q:$D(^TMP("LEXQC",$J,LEXSID,"INA",1,(LEXSO_" ")))
"RTN","LEXQC",151,0)
 . . . S ^TMP("LEXQC",$J,LEXSID,"INA",1,(LEXSO_" "))=LEXIEN_"^"_LEXSO_"^"_LEXCDT
"RTN","LEXQC",152,0)
 . . . S ^TMP("LEXQC",$J,LEXSID,"INA",0)=+($G(^TMP("LEXQC",$J,LEXSID,"INA",0)))+1,LEXIF=1
"RTN","LEXQC",153,0)
 Q
"RTN","LEXQC2")
0^7^B14109806^n/a
"RTN","LEXQC2",1,0)
LEXQC2 ;ISL/KER - Query - Code Set (CSV) - Save ;10/30/2008
"RTN","LEXQC2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQC2",3,0)
 ;               
"RTN","LEXQC2",4,0)
 ; Global Variables
"RTN","LEXQC2",5,0)
 ;    ^TMP("LEXQC"        SACC 2.3.2.5.1
"RTN","LEXQC2",6,0)
 ;    ^TMP("LEXQCO"       SACC 2.3.2.5.1
"RTN","LEXQC2",7,0)
 ;               
"RTN","LEXQC2",8,0)
 ; External References
"RTN","LEXQC2",9,0)
 ;    None
"RTN","LEXQC2",10,0)
 ;               
"RTN","LEXQC2",11,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQC2",12,0)
 ;    LEXCDT              Code Set Date
"RTN","LEXQC2",13,0)
 ;               
"RTN","LEXQC2",14,0)
EN ; Code Set Changes Main Entry Point
"RTN","LEXQC2",15,0)
 Q:'$D(^TMP("LEXQC",$J))  N LEXTC S LEXTC=$$TC Q:+LEXTC'>0  Q:$G(LEXCDT)'?7N
"RTN","LEXQC2",16,0)
 N LEXSID,LEXT
"RTN","LEXQC2",17,0)
 S LEXT=" "_LEXTC_" Code Set changes found for "_$$SD^LEXQM($G(LEXCDT)) D BL,TL(LEXT)
"RTN","LEXQC2",18,0)
 F LEXSID="ICD","ICC","ICP","CPT","CPC","MOD","RAN" D SRC
"RTN","LEXQC2",19,0)
 Q
"RTN","LEXQC2",20,0)
SRC ;   By Source - ICD/ICC/ICP/CPT/CPC/MOD/RAN
"RTN","LEXQC2",21,0)
 Q:'$L($G(LEXSID))  Q:"^ICD^ICC^ICP^CPT^CPC^MOD^RAN^"'[("^"_$G(LEXSID)_"^")  Q:'$D(^TMP("LEXQC",$J,LEXSID))
"RTN","LEXQC2",22,0)
 N LEXCHG S LEXCHG="" F  S LEXCHG=$O(^TMP("LEXQC",$J,LEXSID,LEXCHG)) Q:'$L(LEXCHG)  D CHG
"RTN","LEXQC2",23,0)
 Q
"RTN","LEXQC2",24,0)
CHG ;   By Change - ACT/INA/REV/REU/REA
"RTN","LEXQC2",25,0)
 Q:'$L($G(LEXSID))  Q:"^ICD^ICP^CPT^CPC^MOD^RAN^"'[("^"_$G(LEXSID)_"^")  Q:'$L($G(LEXCHG))  N LEXCNAM,LEXSCT,LEXSNAM S LEXSNAM=""
"RTN","LEXQC2",26,0)
 I $E(LEXSID,1,2)="IC" D
"RTN","LEXQC2",27,0)
 . S LEXSNAM=$S(LEXSID="ICD":"ICD Diagnosis Code",LEXSID="ICC":"ICD Complication/Comorbidity (CC) Flag",LEXSID="ICP":"ICD Procedure Code",1:"")
"RTN","LEXQC2",28,0)
 I '$L(LEXSNAM),$E(LEXSID,1,2)'="IC" D
"RTN","LEXQC2",29,0)
 . S LEXSNAM=$S(LEXSID="CPT":"CPT Procedure Code",LEXSID="CPC":"HCPCS Procedure Code",LEXSID="MOD":"CPT Modifier Code",LEXSID="RAN":"CPT Modifier Range",1:"")
"RTN","LEXQC2",30,0)
 Q:'$L($G(LEXSNAM))  S LEXCNAM=$S(LEXCHG="ACT":"Added",LEXCHG="INA":"Inactivated",LEXCHG="REV":"Revised",LEXCHG="UPD":"Updated",LEXCHG="REU":"Re-used",LEXCHG="REA":"Re-Activated",1:"")
"RTN","LEXQC2",31,0)
 Q:'$L(LEXCNAM)  S LEXSCT=+($G(^TMP("LEXQC",$J,LEXSID,LEXCHG,0))) Q:LEXSCT'>0  S:LEXSCT>1 LEXSNAM=LEXSNAM_"s"
"RTN","LEXQC2",32,0)
 S LEXT=LEXSNAM_" "_LEXCNAM,LEXT=LEXT_$J(" ",(67-$L(LEXT)))_$J(LEXSCT,5) D BL,TL(("   "_LEXT)) D LST
"RTN","LEXQC2",33,0)
 Q
"RTN","LEXQC2",34,0)
LST ;   List Codes
"RTN","LEXQC2",35,0)
 Q:'$L($G(LEXSID))  Q:'$L($G(LEXCHG))  Q:'$D(^TMP("LEXQC",$J,LEXSID,LEXCHG,1))
"RTN","LEXQC2",36,0)
 N LEXS,LEXSC,LEXSO,LEXSOE,LEXLC,LEXSTR,LEXMAX S (LEXLC,LEXSC)=0,(LEXS,LEXSTR)="",LEXMAX=10
"RTN","LEXQC2",37,0)
 F  S LEXS=$O(^TMP("LEXQC",$J,LEXSID,LEXCHG,1,LEXS))  Q:'$L(LEXS)  D
"RTN","LEXQC2",38,0)
 . N LEXN S LEXN=$G(^TMP("LEXQC",$J,LEXSID,LEXCHG,1,LEXS)),LEXSO=$$TM^LEXQM($P(LEXN,"^",2)) Q:'$L(LEXSO)  S LEXSOE=$$FM(LEXSO)
"RTN","LEXQC2",39,0)
 . S LEXSC=LEXSC+1 I LEXSC<LEXMAX S LEXSTR=LEXSTR_LEXSOE Q
"RTN","LEXQC2",40,0)
 . I LEXSC'<LEXMAX S LEXSTR=$$TM^LEXQM(LEXSTR) S LEXLC=+LEXLC+1 D:LEXLC=1 BL D TL(("      "_LEXSTR)) S LEXSC=1,LEXSTR=LEXSOE Q
"RTN","LEXQC2",41,0)
 S LEXSTR=$$TM^LEXQM(LEXSTR) I $L(LEXSTR) S LEXLC=+LEXLC+1 D:LEXLC=1 BL D TL(("      "_LEXSTR))
"RTN","LEXQC2",42,0)
 Q
"RTN","LEXQC2",43,0)
 ;
"RTN","LEXQC2",44,0)
 ; Miscellaneous
"RTN","LEXQC2",45,0)
FM(X) ;   Format
"RTN","LEXQC2",46,0)
 S X=$G(X) S X=X_$J(" ",8-$L(X))
"RTN","LEXQC2",47,0)
 Q X
"RTN","LEXQC2",48,0)
BL ;   Blank Line
"RTN","LEXQC2",49,0)
 D TL(" ") Q
"RTN","LEXQC2",50,0)
TL(X) ;   Text Line
"RTN","LEXQC2",51,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQC2",52,0)
 N LEXI S LEXI=+($O(^TMP("LEXQCO",$J," "),-1))+1 S ^TMP("LEXQCO",$J,LEXI)=$G(X),^TMP("LEXQCO",$J,0)=LEXI
"RTN","LEXQC2",53,0)
 Q
"RTN","LEXQC2",54,0)
CLR ;   Clear
"RTN","LEXQC2",55,0)
 N LEXTEST,LEXCDT
"RTN","LEXQC2",56,0)
 Q
"RTN","LEXQC2",57,0)
TC(X) ;   Total Changes Found
"RTN","LEXQC2",58,0)
 N LEXNN,LEXNC,LEXT S LEXT=0 S LEXNN="^TMP(""LEXQC"","_$J_")",LEXNC="^TMP(""LEXQC"","_$J_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  I LEXNN[",0)" S LEXT=LEXT+($G(@LEXNN))
"RTN","LEXQC2",59,0)
 S X=LEXT
"RTN","LEXQC2",60,0)
 Q X
"RTN","LEXQCM")
0^8^B66900998^n/a
"RTN","LEXQCM",1,0)
LEXQCM ;ISL/KER - Query - CPT Modifiers - Extract ;10/30/2008
"RTN","LEXQCM",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCM",3,0)
 ;               
"RTN","LEXQCM",4,0)
 ; Global Variables
"RTN","LEXQCM",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQCM",6,0)
 ;               
"RTN","LEXQCM",7,0)
 ; External References
"RTN","LEXQCM",8,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXQCM",9,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXQCM",10,0)
 ;    GETS^DIQ            ICR   2056
"RTN","LEXQCM",11,0)
 ;    HIST^ICPTAPIU       ICR   1997
"RTN","LEXQCM",12,0)
 ;    $$MOD^ICPTMOD       ICR   1996
"RTN","LEXQCM",13,0)
 ;    MODD^ICPTMOD        ICR   1996
"RTN","LEXQCM",14,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCM",15,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCM",16,0)
 ;               
"RTN","LEXQCM",17,0)
EN ; Main Entry Point
"RTN","LEXQCM",18,0)
 N LEXENV S LEXENV=$$EV Q:+LEXENV'>0
"RTN","LEXQCM",19,0)
 N LEXAD,LEXEDT,LEXCDT,LEXEXIT,LEXTEST S LEXEXIT=0,LEXCDT=""
"RTN","LEXQCM",20,0)
 F  S LEXCDT=$$AD^LEXQM,LEXAD=LEXCDT Q:'$L(LEXCDT)  S LEXEDT=$P(LEXCDT,"^",1),LEXCDT=$P(LEXCDT,"^",2) Q:LEXCDT'?7N  D LOOK Q:LEXCDT'?7N  Q:+LEXEXIT>0
"RTN","LEXQCM",21,0)
 Q
"RTN","LEXQCM",22,0)
LOOK ; CPT Modifier Lookup Loop
"RTN","LEXQCM",23,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S LEXCDT="" Q
"RTN","LEXQCM",24,0)
 N LEXMOD,LEXMODC S LEXLEN=62
"RTN","LEXQCM",25,0)
 F  S LEXMOD=$$MOD^LEXQCMA S:LEXMOD="^^" LEXEXIT=1 Q:LEXMOD="^"!(LEXMOD="^^")  D  Q:LEXMOD="^"!(LEXMOD="^^")
"RTN","LEXQCM",26,0)
 . K LEXGET,LEXST,LEXSD,LEXLD,LEXMD,LEXRAN,LEXLX,LEXWN N LEXIEN,LEXLDT,LEXELDT,LEXINC,LEXINCI,LEXINCF S (LEXINC,LEXINCI,LEXINCF)=0
"RTN","LEXQCM",27,0)
 . S LEXIEN=+($G(LEXMOD)),LEXLDT=+($G(LEXCDT)) Q:+LEXIEN'>0  Q:LEXLDT'?7N  S LEXELDT=$$SD^LEXQM(LEXLDT) Q:'$L(LEXELDT)
"RTN","LEXQCM",28,0)
 . S LEXINC=$$INC^LEXQCMA Q:LEXINC["^"  S:+LEXINC>0 LEXINCI=$$INCI^LEXQCMA S:+LEXINC>0 LEXINCF=$$INCF^LEXQCMA
"RTN","LEXQCM",29,0)
 . D CSV,EN^LEXQCM2
"RTN","LEXQCM",30,0)
 Q
"RTN","LEXQCM",31,0)
CSV ; Code Set Versioning Display
"RTN","LEXQCM",32,0)
 ; Needs LEXCDT Date 
"RTN","LEXQCM",33,0)
 ;       LEXMOD CPT Modifier Internal Entry Number
"RTN","LEXQCM",34,0)
 N LEXEDT,LEXIEN,LEXIENS,LEXLTXT,LEXSO,LEXSTA
"RTN","LEXQCM",35,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S (LEXMOD,LEXCDT)="" Q
"RTN","LEXQCM",36,0)
 S LEXINC=+($G(LEXINC)),LEXINCI=+($G(LEXINCI)),LEXIEN=+($G(LEXMOD)),LEXSO=$P($G(LEXMOD),"^",2),LEXLTXT=$P($G(LEXMOD),"^",3)
"RTN","LEXQCM",37,0)
 Q:+LEXIEN'>0  Q:'$L(LEXSO)
"RTN","LEXQCM",38,0)
 ;
"RTN","LEXQCM",39,0)
 ; Get the "Unversioned" Fields
"RTN","LEXQCM",40,0)
 ;   Modifier                    Field .01
"RTN","LEXQCM",41,0)
 S LEXIENS=LEXIEN_"," D GETS^DIQ(81.3,LEXIENS,".01","IE","LEXGET","LEXMSG")
"RTN","LEXQCM",42,0)
 ; Get the "Versioned" Fields
"RTN","LEXQCM",43,0)
 ;   Effective Date and Status   Sub-File 81.33   (60)
"RTN","LEXQCM",44,0)
 S LEXST=$$EF(+($G(LEXIEN)),+LEXCDT),LEXSTA=+($P(LEXST,"^",2))
"RTN","LEXQCM",45,0)
 ;   Modifier Name               Sub-File 81.361  (61)
"RTN","LEXQCM",46,0)
 D SDS(+($G(LEXIEN)),+LEXCDT,.LEXSD,62,LEXSTA)
"RTN","LEXQCM",47,0)
 ;   Description                 Sub-File 81.362  (62)
"RTN","LEXQCM",48,0)
 D LDS(+($G(LEXIEN)),+LEXCDT,.LEXLD,62)
"RTN","LEXQCM",49,0)
 D WN(+LEXCDT,.LEXWN,62)
"RTN","LEXQCM",50,0)
 D:+($G(LEXINC))>0 CCR^LEXQCM2(+($G(LEXIEN)),+LEXCDT,.LEXRAN,62,+($G(LEXINCI)),+($G(LEXINCF)))
"RTN","LEXQCM",51,0)
 Q
"RTN","LEXQCM",52,0)
 ;            
"RTN","LEXQCM",53,0)
EF(X,LEXCDT) ; Effective Dates
"RTN","LEXQCM",54,0)
 N LEX,LEXAD,LEXBRD,LEXBRW,LEXEE,LEXEF,LEXES,LEXFA,LEXH,LEXI,LEXID,LEXIEN,LEXLS,LEXPE,LEXPH,LEXPI,LEXP0,LEXPS,LEXSO,LEXST
"RTN","LEXQCM",55,0)
 S LEXIEN=+($G(X)),LEXCDT=+($G(LEXCDT)),LEXBRD=2890101,LEXBRW=""
"RTN","LEXQCM",56,0)
 Q:+LEXIEN'>0 "^^"  Q:'$L($G(^DIC(81.3,+LEXIEN,0))) "^^"  Q:LEXCDT'?7N "^^"  S LEXSO=$P($G(^DIC(81.3,+LEXIEN,0)),"^",1)
"RTN","LEXQCM",57,0)
 S LEXFA=$$FA(+LEXIEN),LEXPI=$O(^DIC(81.3,+LEXIEN,60,"B",(LEXCDT+.999999)),-1),LEXPH=$O(^DIC(81.3,+LEXIEN,60,"B",+LEXPI," "),-1)
"RTN","LEXQCM",58,0)
 S LEXP0=$G(^DIC(81.3,+LEXIEN,60,+LEXPH,0)),LEXPS=$P(LEXP0,"^",2),LEXPE=$P(LEXP0,"^",1)
"RTN","LEXQCM",59,0)
 S:LEXCDT<LEXBRD&(+LEXFA=LEXBRD) LEXBRW="Warning:  The 'Based on Date' provided precedes the initial Code Set Business Rule date of "_$$SD^LEXQM(LEXBRD)_", the Effective date may be inaccurate."
"RTN","LEXQCM",60,0)
 S:LEXFA?7N&('$L(LEXPE))&('$L(LEXPS))&(LEXFA=LEXBRD) LEXPE=LEXFA,LEXPS=1
"RTN","LEXQCM",61,0)
 I '$L(LEXPE),'$L(LEXPS) D  Q X
"RTN","LEXQCM",62,0)
 . N LEXFA S LEXFA=$$FA(+LEXIEN)
"RTN","LEXQCM",63,0)
 . S LEXST="",LEXEF="",LEXES="Not Applicable",LEXLS=-1
"RTN","LEXQCM",64,0)
 . S LEXEE="" S:LEXFA?7N LEXEE="(future activation of "_$$SD^LEXQM(LEXFA)_")"
"RTN","LEXQCM",65,0)
 . S X=LEXLS_"^"_LEXST_"^"_LEXEF_"^"_LEXES_"^"_LEXEE S:$L(LEXBRW) $P(X,"^",6)=LEXBRW
"RTN","LEXQCM",66,0)
 S (LEXLS,LEXST)=LEXPS,LEXEF=LEXPE,LEXES=$S(+LEXST>0:"Active",1:"Inactive"),LEXEE=$$SD^LEXQM(LEXEF)
"RTN","LEXQCM",67,0)
 S X=LEXLS_"^"_LEXST_"^"_LEXEF_"^"_LEXES_"^"_LEXEE S:$L(LEXBRW) $P(X,"^",6)=LEXBRW
"RTN","LEXQCM",68,0)
 Q X
"RTN","LEXQCM",69,0)
 ;            
"RTN","LEXQCM",70,0)
SDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Modifier Name (short description)
"RTN","LEXQCM",71,0)
 ;            
"RTN","LEXQCM",72,0)
 ; LEX=# of Lines
"RTN","LEXQCM",73,0)
 ; LEX(0)=External Date of Modifier Name
"RTN","LEXQCM",74,0)
 ; LEX(#)=Modifier Name
"RTN","LEXQCM",75,0)
 ;            
"RTN","LEXQCM",76,0)
 N LEXD,LEXBRD,LEXBRW,LEXDDT,LEXE,LEXEE,LEXEFF,LEXFA,LEXHIS,LEXI,LEXIA,LEXIEN,LEXL,LEXLAST,LEXLEF,LEXLHI,LEXM,LEXR,LEXSDT,LEXSO,LEXLSD,LEXT
"RTN","LEXQCM",77,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^DIC(81.3,+LEXIEN,61))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQCM",78,0)
 S LEXSO=$P($G(^DIC(81.3,+LEXIEN,0)),"^",1),LEXLAST=$$MOD^ICPTMOD(+LEXIEN,"I",LEXVDT),LEXLSD=$P(LEXLAST,"^",3),LEXBRD=2890101
"RTN","LEXQCM",79,0)
 S:$D(LEXGET)&($L(LEXLSD)) LEXGET(81.3,(+LEXIEN_","),"B")=LEXLSD
"RTN","LEXQCM",80,0)
 S LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 S LEXFA=$$FA(+LEXIEN),LEXM=""
"RTN","LEXQCM",81,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="CPT Modifier Short Name is not available.  The date provided precedes the initial activation of the code"
"RTN","LEXQCM",82,0)
 I $L(LEXM) D  Q
"RTN","LEXQCM",83,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQCM",84,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQCM",85,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCM",86,0)
 S LEXM="" S LEXEFF=$O(^DIC(81.3,LEXIEN,61,"B",(LEXVDT+.001)),-1),LEXHIS=$O(^DIC(81.3,LEXIEN,61,"B",+LEXEFF," "),-1),LEXSDT=$P($G(^DIC(81.3,+LEXIEN,61,+LEXHIS,0)),"^",2)
"RTN","LEXQCM",87,0)
 S LEXLEF=$O(^DIC(81.3,LEXIEN,61,"B",(9999999+.001)),-1),LEXLHI=$O(^DIC(81.3,LEXIEN,61,"B",+LEXLEF," "),-1),LEXDDT=$P($G(^DIC(81.3,+LEXIEN,61,+LEXLHI,0)),"^",2)
"RTN","LEXQCM",88,0)
 S (LEXD,LEXE,LEXR)="" S:$L(LEXSDT)&(LEXEFF?7N) LEXD=LEXSDT,LEXE=LEXEFF
"RTN","LEXQCM",89,0)
 S:$L(LEXDDT)&(LEXLEF?7N)&('$L(LEXD))&('$L(LEXE)) LEXD=LEXDDT,LEXE=LEXLEF,LEXR="No Text Available for Date Provided"
"RTN","LEXQCM",90,0)
 K LEX S LEX(1)=LEXD S:$L(LEXD) LEXGET(81.3,(+LEXIEN_","),"B")=LEXD S LEXEE=$$SD^LEXQM(LEXE)
"RTN","LEXQCM",91,0)
 S:$D(LEXTEST)&(+($G(LEXSTA))'>0) LEXEE="--/--/----" S:$L(LEX(1)) LEX(0)=LEXEE
"RTN","LEXQCM",92,0)
 S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCM",93,0)
 Q
"RTN","LEXQCM",94,0)
LDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Long Description
"RTN","LEXQCM",95,0)
 ;            
"RTN","LEXQCM",96,0)
 ; LEX=# of Lines
"RTN","LEXQCM",97,0)
 ; LEX(0)=External Date of Description
"RTN","LEXQCM",98,0)
 ; LEX(#)=Description
"RTN","LEXQCM",99,0)
 ; LEX(#)=Description continued
"RTN","LEXQCM",100,0)
 ;            
"RTN","LEXQCM",101,0)
 N LEXC,LEXBRD,LEXDDT,LEXEVDT,LEXFA,LEXI,LEXIEN,LEXL,LEXLT,LEXLN,LEXM,LEXT,LEXSO,LEXTL,LEXTMP S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^DIC(81.3,+LEXIEN,62))
"RTN","LEXQCM",102,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62
"RTN","LEXQCM",103,0)
 S LEXSO=$P($G(^DIC(81.3,+LEXIEN,0)),"^",1) S LEXFA=$$FA(+LEXIEN),LEXM=""  S LEXSTA=+($G(LEXSTA)),LEXBRD=2890101
"RTN","LEXQCM",104,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM=" Modifier description is not available.  The date provided precedes the initial activation of the code" I $L(LEXM) D  Q
"RTN","LEXQCM",105,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7)) S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQCM",106,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCM",107,0)
 K LEXTMP S LEXLT=$$MODD^ICPTMOD(LEXIEN,"LEXTMP",,LEXVDT) S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$G(LEXTMP(+LEXL))
"RTN","LEXQCM",108,0)
 S LEXM="" K:LEXL>0&(LEXLN["CODE TEXT MAY BE INACCURATE") LEXTMP(+LEXL)
"RTN","LEXQCM",109,0)
 F LEXI=1:1:2 S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$$TM^LEXQM($G(LEXTMP(+LEXL))) K:LEXL>0&('$L(LEXLN)) LEXTMP(+LEXL)
"RTN","LEXQCM",110,0)
 S LEXDDT=$O(^DIC(81.3,+LEXIEN,62,"B",(LEXVDT+.999999)),-1) S:LEXDDT'?7N LEXDDT=$O(^DIC(81.3,+LEXIEN,62,"B",0)) S:LEXDDT?7N LEXEVDT=$$SD^LEXQM(LEXDDT)
"RTN","LEXQCM",111,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX F LEXI=1:1:13 D
"RTN","LEXQCM",112,0)
 . Q:'$D(LEXTMP(LEXI))  S LEXT=$$TM^LEXQM($G(LEXTMP(LEXI))),LEX(LEXI)=$$UP^XLFSTR(LEXT)
"RTN","LEXQCM",113,0)
 I $L(LEXM) D
"RTN","LEXQCM",114,0)
 . N LEXT,LEXI,LEXL,LEXC S LEXL=+($O(LEX(" "),-1)),LEXC=0 S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQCM",115,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCM",116,0)
 . . S LEXT=$G(LEXT(LEXI)) S:$L(LEXT) LEXC=LEXC+1 S LEXL=LEXL+1,LEX(LEXL)=LEXT
"RTN","LEXQCM",117,0)
 S:$D(LEXTEST)&(+($G(LEXSTA))'>0) LEXEVDT="--/--/----" S:$D(LEX(1)) LEX(0)=LEXEVDT S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCM",118,0)
 Q
"RTN","LEXQCM",119,0)
WN(X,LEX,LEXLEN) ;   Warning
"RTN","LEXQCM",120,0)
 ;            
"RTN","LEXQCM",121,0)
 ; LEX=# of Lines
"RTN","LEXQCM",122,0)
 ; LEX(0)=External Date
"RTN","LEXQCM",123,0)
 ; LEX(#)=Warning
"RTN","LEXQCM",124,0)
 ;            
"RTN","LEXQCM",125,0)
 N LEXVDT,LEXIA,LEXTMP K LEX S LEXVDT=$G(X) Q:LEXVDT'?7N  S LEXIA=$$IA(LEXVDT) Q:+LEXIA'>0  S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQCM",126,0)
 S LEXTMP(1)="Warning:  The 'Based on Date' provided precedes Code Set Versioning.  The Modifier Name and Description may be inaccurate for "_$$SD^LEXQM(LEXVDT)
"RTN","LEXQCM",127,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX S LEXI=0 F  S LEXI=$O(LEXTMP(LEXI)) Q:+LEXI'>0  S LEX(LEXI)=$G(LEXTMP(LEXI))
"RTN","LEXQCM",128,0)
 S LEX=$O(LEX(" "),-1),LEX(0)=$$SD^LEXQM(LEXVDT)
"RTN","LEXQCM",129,0)
 Q
"RTN","LEXQCM",130,0)
 ; Miscellaneous
"RTN","LEXQCM",131,0)
FA(X) ;   First Activation
"RTN","LEXQCM",132,0)
 N LEXFA,LEXH,LEXI,LEXIEN,LEXSO S LEXIEN=+($G(X)) S X="",LEXSO=$P($G(^DIC(81.3,+LEXIEN,0)),"^",1) D HIST^ICPTAPIU(LEXSO,.LEXH) S LEXFA="",LEXI=0
"RTN","LEXQCM",133,0)
 F  S LEXI=$O(LEXH(LEXI)) Q:+LEXI'>0!($L(LEXFA))  S:+($G(LEXH(LEXI)))>0&(LEXI?7N) LEXFA=LEXI Q:$L(LEXFA)
"RTN","LEXQCM",134,0)
 S X=LEXFA
"RTN","LEXQCM",135,0)
 Q X
"RTN","LEXQCM",136,0)
IA(X) ;   Inaccurate
"RTN","LEXQCM",137,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQCM",138,0)
 Q X
"RTN","LEXQCM",139,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQCM",140,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQCM",141,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2890101:2890101,1:LEXVDT)
"RTN","LEXQCM",142,0)
 Q X
"RTN","LEXQCM",143,0)
EV(X) ;   Check environment
"RTN","LEXQCM",144,0)
 N LEX S DT=$$DT^XLFDT D HOME^%ZIS S U="^" I +($G(DUZ))=0 W !!,?5,"DUZ not defined" Q 0
"RTN","LEXQCM",145,0)
 S LEX=$$GET1^DIQ(200,(DUZ_","),.01) I '$L(LEX) W !!,?5,"DUZ not valid" Q 0
"RTN","LEXQCM",146,0)
 Q 1
"RTN","LEXQCM2")
0^9^B58451026^n/a
"RTN","LEXQCM2",1,0)
LEXQCM2 ;ISL/KER - Query - CPT Modifiers - Save ;10/30/2008
"RTN","LEXQCM2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCM2",3,0)
 ;               
"RTN","LEXQCM2",4,0)
 ; Global Variables
"RTN","LEXQCM2",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQCM2",6,0)
 ;    ^TMP("LEXQCM"       SACC 2.3.2.5.1
"RTN","LEXQCM2",7,0)
 ;    ^TMP("LEXQCMO"      SACC 2.3.2.5.1
"RTN","LEXQCM2",8,0)
 ;               
"RTN","LEXQCM2",9,0)
 ; External References
"RTN","LEXQCM2",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCM2",11,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCM2",12,0)
 ;               
"RTN","LEXQCM2",13,0)
 ; Variables NEWed or KILLed Elsewhere
"RTN","LEXQCM2",14,0)
 ;    LEXIEN              Modifier IEN
"RTN","LEXQCM2",15,0)
 ;    LEXELDT             External Last Date
"RTN","LEXQCM2",16,0)
 ;    LEXLEN              Offset Length
"RTN","LEXQCM2",17,0)
 ;    LEXINC              Include Modifier Ranges flag
"RTN","LEXQCM2",18,0)
 ;    LEXINCI             Include Inactive Modifier Ranges flag
"RTN","LEXQCM2",19,0)
 ;    LEXINCF             Include Future Modifier Ranges flag
"RTN","LEXQCM2",20,0)
 ;    LEXGET              Array of Non-Versioned Data
"RTN","LEXQCM2",21,0)
 ;    LEXST               CPT Status and Effective Dates
"RTN","LEXQCM2",22,0)
 ;    LEXSD               Versioned Short Description
"RTN","LEXQCM2",23,0)
 ;    LEXLD               Versioned Long Description
"RTN","LEXQCM2",24,0)
 ;    LEXRAN              Number of Ranges/Comment
"RTN","LEXQCM2",25,0)
 ;    ^TMP("LEXQCM",$J,"RANGES",#)  List of Ranges
"RTN","LEXQCM2",26,0)
 ;               
"RTN","LEXQCM2",27,0)
EN ; Main Entry Point
"RTN","LEXQCM2",28,0)
 ;            
"RTN","LEXQCM2",29,0)
 K ^TMP("LEXQCMO",$J) Q:'$L($G(LEXELDT))
"RTN","LEXQCM2",30,0)
 I +($G(LEXST))<0 D FUT D:$D(^TMP("LEXQCMO",$J)) DSP^LEXQO("LEXQCMO") Q
"RTN","LEXQCM2",31,0)
 D FUL D:$D(^TMP("LEXQCMO",$J)) DSP^LEXQO("LEXQCMO")
"RTN","LEXQCM2",32,0)
 Q
"RTN","LEXQCM2",33,0)
FUT ; Future Activation
"RTN","LEXQCM2",34,0)
 N LEX1,LEX2,LEX3,LEXEFF,LEXI,LEXL,LEXNAM,LEXSO,LEXSTA S LEXI=+($G(LEXIEN)) Q:+LEXI'>0  Q:'$D(^DIC(81.3,+LEXI,0))  S LEXL=+($G(LEXLEN)) Q:+LEXL'>0
"RTN","LEXQCM2",35,0)
 S:LEXL>62 LEXL=62 S LEXSO=$G(LEXGET(81.3,(+LEXI_","),.01,"E")) Q:'$L(LEXSO)  S LEXNAM=$G(LEXGET(81.3,(+LEXI_","),"B")) Q:'$L(LEXNAM)
"RTN","LEXQCM2",36,0)
 S LEXSTA=$G(LEXST),LEXEFF=$P(LEXSTA,"^",5),LEXSTA=$P(LEXSTA,"^",4) Q:'$L(LEXSTA)  Q:'$L(LEXEFF)  S (LEX1,LEX2,LEX3)=""
"RTN","LEXQCM2",37,0)
 D BOD(LEXELDT),COD(LEXSO,LEXNAM,+($G(LEXL))),STA(.LEXST,+($G(LEXL)))
"RTN","LEXQCM2",38,0)
 Q
"RTN","LEXQCM2",39,0)
BOD(X) ;   Based on Date
"RTN","LEXQCM2",40,0)
 N LEXBOD S LEXBOD=$G(X) Q:'$L(LEXBOD)  Q:LEXBOD'["/"  S X="Display based on date:  "_LEXBOD D BL,TL(X)
"RTN","LEXQCM2",41,0)
 Q
"RTN","LEXQCM2",42,0)
COD(X,Y,LEXLEN) ;   Code Line
"RTN","LEXQCM2",43,0)
 N LEXC,LEXN,LEXT S LEXC=$G(X),LEXN=$G(Y) S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCM2",44,0)
 Q
"RTN","LEXQCM2",45,0)
STA(X,LEXLEN) ;   Status Line
"RTN","LEXQCM2",46,0)
 N LEX,LEXC,LEXI,LEXN,LEXX,LEXE,LEXS,LEXT,LEXW,LEXEFF,LEXSTA S LEXX=$G(X),LEXEFF=$P(LEXX,"^",5),LEXSTA=$P(LEXX,"^",4),LEXEFF=$TR(LEXEFF,"()","")
"RTN","LEXQCM2",47,0)
 S LEXW=$P(LEXX,"^",6),LEXT="  Status:  ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT))),LEXT=LEXT_LEXSTA
"RTN","LEXQCM2",48,0)
 S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Effective:  "_$$UP^XLFSTR($E(LEXEFF,1))_$E(LEXEFF,2,$L(LEXEFF)) D BL,TL(LEXT)
"RTN","LEXQCM2",49,0)
 I $L(LEXW) D
"RTN","LEXQCM2",50,0)
 . N LEX,LEXT,LEXC,LEXI,LEXN S LEX(1)=LEXW D PR^LEXQM(.LEX,(+($G(LEXLEN))-7)) Q:+($O(LEX(" "),-1))'>0
"RTN","LEXQCM2",51,0)
 . S LEXT=$J(" ",((79-+($G(LEXLEN)))))
"RTN","LEXQCM2",52,0)
 . S (LEXC,LEXI)=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCM2",53,0)
 . . N LEXN S LEXN=$$TM^LEXQM($G(LEX(LEXI))) S:$L(LEXN) LEXC=LEXC+1 D:LEXC=1 BL D TL((LEXT_LEXN))
"RTN","LEXQCM2",54,0)
 Q
"RTN","LEXQCM2",55,0)
 ;            
"RTN","LEXQCM2",56,0)
FUL ; Full Display
"RTN","LEXQCM2",57,0)
 N LEXFUL,LEX,LEXL S LEXL=+($G(LEXLEN)) S:LEXL>62 LEXL=62
"RTN","LEXQCM2",58,0)
 S LEXFUL=""  D FUT
"RTN","LEXQCM2",59,0)
 D SD(.LEXSD,+($G(LEXL))),LD(.LEXLD,+($G(LEXL))),WN(.LEXWN,+($G(LEXL)))
"RTN","LEXQCM2",60,0)
 D:+($G(LEXRAN))>0&($L($P($G(LEXRAN),"^",2)))&($O(^TMP("LEXQCM",$J,"RANGES",0))>0) RAN(.LEXRAN,+($G(LEXL)))
"RTN","LEXQCM2",61,0)
 Q
"RTN","LEXQCM2",62,0)
SD(X,LEXLEN) ;   Short Description
"RTN","LEXQCM2",63,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Short Name: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCM2",64,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCM2",65,0)
 Q
"RTN","LEXQCM2",66,0)
LD(X,LEXLEN) ;   Long Description
"RTN","LEXQCM2",67,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Description: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCM2",68,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCM2",69,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))) S LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCM2",70,0)
 Q
"RTN","LEXQCM2",71,0)
WN(X,LEXLEN) ;   Warning
"RTN","LEXQCM2",72,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT,LEXC Q:'$D(X(1))  S LEXC=0,LEXN=$G(X(1)),LEXT="",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCM2",73,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=1 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCM2",74,0)
 Q
"RTN","LEXQCM2",75,0)
RAN(X,LEXLEN) ;   Code Ranges
"RTN","LEXQCM2",76,0)
 N LEXC,LEXH,LEXI,LEXN,LEXS,LEXT S LEXH=$G(X),LEXN=+LEXH,LEXH=$P(LEXH,"^",2) Q:+LEXN'>0  Q:'$L(LEXH)
"RTN","LEXQCM2",77,0)
 S LEXT="  Code Ranges: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXH,LEXN=$J(" ",((79-+($G(LEXLEN))))) D BL,TL(LEXT)
"RTN","LEXQCM2",78,0)
 S (LEXC,LEXI)=0 F  S LEXI=$O(^TMP("LEXQCM",$J,"RANGES",LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCM2",79,0)
 . S LEXC=LEXC+1 D:LEXC=1 BL S LEXT=$G(^TMP("LEXQCM",$J,"RANGES",LEXI)) Q:'$L(LEXT)  D TL((LEXN_LEXT))
"RTN","LEXQCM2",80,0)
 Q
"RTN","LEXQCM2",81,0)
CCR(X,LEXVDT,LEX,LEXLEN,LEXINCI,LEXINCF) ;   CPT Code Ranges
"RTN","LEXQCM2",82,0)
 ;            
"RTN","LEXQCM2",83,0)
 ; LEX=# of Ranges
"RTN","LEXQCM2",84,0)
 ; ^TMP("LEXQCM",$J,"RANGES",#)=Begin_End_Act_Inact
"RTN","LEXQCM2",85,0)
 ;            
"RTN","LEXQCM2",86,0)
 K ^TMP("LEXQCM",$J,"RAN"),^TMP("LEXQCM",$J,"RANGES")
"RTN","LEXQCM2",87,0)
 N LEXC,LEXEVDT,LEXFD,LEXFN,LEXH1,LEXH2,LEXH3,LEXIEN,LEXL,LEXN,LEXP,LEXR0,LEXRA,LEXRA1,LEXRA2,LEXRB,LEXRDA,LEXRDI,LEXRE,LEXRI,LEXRI1,LEXRI2,LEXRN,LEXRT,LEXRX,LEXT
"RTN","LEXQCM2",88,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^DIC(81.3,+LEXIEN,0))  Q:$O(^DIC(81.3,+LEXIEN,10,0))'>0  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN))
"RTN","LEXQCM2",89,0)
 S:+LEXLEN'>0 LEXLEN=62 Q:'$L(LEXEVDT)  S LEXINCI=+($G(LEXINCI)),LEXINCF=+($G(LEXINCF)) S (LEXFD,LEXRX)=0 F  S LEXRX=$O(^DIC(81.3,+LEXIEN,10,LEXRX)) Q:+LEXRX'>0  D
"RTN","LEXQCM2",90,0)
 . S LEXR0=$G(^DIC(81.3,+LEXIEN,10,LEXRX,0)),LEXRB=$P(LEXR0,"^",1) Q:$L(LEXRB)'=5  S LEXRE=$P(LEXR0,"^",2) S:$L(LEXRB)&('$L(LEXRE)) LEXRE=LEXRB Q:$L(LEXRE)'=5
"RTN","LEXQCM2",91,0)
 . S LEXRA=$P(LEXR0,"^",3) Q:LEXRA'?7N  S LEXRI=$P(LEXR0,"^",4) Q:+LEXRA>0&(LEXVDT<+($G(LEXRA)))&(+($G(LEXINCF))'>0)  Q:+LEXRI>0&(LEXVDT>+($G(LEXRI)))&(+($G(LEXINCI))'>0)
"RTN","LEXQCM2",92,0)
 . S LEXRN=$$NUM(LEXRB),LEXRT=LEXRB_"^"_LEXRE_"^"_LEXRA_"^"_LEXRI,LEXRA1=$S(LEXVDT<LEXRA:"<",1:" "),LEXRA2=$S(LEXVDT<LEXRA:">",1:" ")
"RTN","LEXQCM2",93,0)
 . S LEXRI1=$S(LEXVDT<LEXRI:"<",1:" "),LEXRI2=$S(LEXVDT<LEXRI:">",1:" ") S:LEXRA1["<"!(LEXRA2[">")!(LEXRI1["<")!(LEXRI2[">") LEXFD=1
"RTN","LEXQCM2",94,0)
 . S LEXRDA=$S($L(LEXRA):(LEXRA1_$$SD^LEXQM(LEXRA)_LEXRA2),1:""),LEXRDI=$S($L(LEXRI):(LEXRI1_$$SD^LEXQM(LEXRI)_LEXRI2),1:"")
"RTN","LEXQCM2",95,0)
 . S ^TMP("LEXQCM",$J,"RAN",LEXRN,LEXRT)=LEXRB_"    "_LEXRE_"   "_LEXRDA_"  "_LEXRDI
"RTN","LEXQCM2",96,0)
 S LEXH1="CPT Code Range         Effective Dates",LEXH2="Begin     End       Active       Inactive",LEXH3="-----    -----    ----------    ----------"
"RTN","LEXQCM2",97,0)
 K LEX S (LEX,LEXL,LEXC,LEXRN)=0 S LEXFN="" S:+($G(LEXFD))>0 LEXFN="   Future dates indicated as  '<mm/dd/yyyy>'"
"RTN","LEXQCM2",98,0)
 S LEXC=0 F  S LEXRN=$O(^TMP("LEXQCM",$J,"RAN",LEXRN)) Q:+LEXRN'>0  S LEXRT="" F  S LEXRT=$O(^TMP("LEXQCM",$J,"RAN",LEXRN,LEXRT)) Q:'$L(LEXRT)  D
"RTN","LEXQCM2",99,0)
 . S LEXT=$G(^TMP("LEXQCM",$J,"RAN",LEXRN,LEXRT)) Q:'$L(LEXT)  S LEXC=LEXC+1 I LEXC=1 D
"RTN","LEXQCM2",100,0)
 . . S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)=LEXH1 S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)=LEXH2
"RTN","LEXQCM2",101,0)
 . . S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)=LEXH3 S ^TMP("LEXQCM",$J,"RANGES",0)=LEXN
"RTN","LEXQCM2",102,0)
 . S LEX=+($G(LEX))+1 S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)=LEXT,^TMP("LEXQCM",$J,"RANGES",0)=LEXN
"RTN","LEXQCM2",103,0)
 I $L(LEXFN) D
"RTN","LEXQCM2",104,0)
 . S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)="      ",^TMP("LEXQCM",$J,"RANGES",0)=LEXN
"RTN","LEXQCM2",105,0)
 . S LEXN=$O(^TMP("LEXQCM",$J,"RANGES"," "),-1)+1,^TMP("LEXQCM",$J,"RANGES",LEXN)=LEXFN,^TMP("LEXQCM",$J,"RANGES",0)=LEXN
"RTN","LEXQCM2",106,0)
 K ^TMP("LEXQCM",$J,"RAN") S LEXT="" I +LEX>0 D
"RTN","LEXQCM2",107,0)
 . N LEXP,LEXT S LEXP=$S(+LEX>1:"s",1:""),LEXT="" S:+($G(LEXINCI))>0&(+($G(LEXINCF))>0) LEXT=+LEX_" Current and future Active or Inactive range"_LEXP_" found"
"RTN","LEXQCM2",108,0)
 . S:+($G(LEXINCI))>0&(+($G(LEXINCF))'>0) LEXT=+LEX_" Currently Active or Inactive range"_LEXP_" found" S:+($G(LEXINCI))'>0&(+($G(LEXINCF))>0) LEXT=+LEX_" Current and future Active range"_LEXP_" found"
"RTN","LEXQCM2",109,0)
 . S:+($G(LEXINCI))'>0&(+($G(LEXINCF))'>0) LEXT=+LEX_" Currently Active range"_LEXP_" found" S:$L(LEXT) LEX=LEX_"^"_LEXT
"RTN","LEXQCM2",110,0)
 Q
"RTN","LEXQCM2",111,0)
 ;
"RTN","LEXQCM2",112,0)
 ; Miscellaneous
"RTN","LEXQCM2",113,0)
BL ;   Blank Line
"RTN","LEXQCM2",114,0)
 D TL(" ") Q
"RTN","LEXQCM2",115,0)
TL(X) ;   Text Line
"RTN","LEXQCM2",116,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQCM2",117,0)
 N LEXI S LEXI=+($O(^TMP("LEXQCMO",$J," "),-1))+1 S ^TMP("LEXQCMO",$J,LEXI)=$G(X),^TMP("LEXQCMO",$J,0)=LEXI
"RTN","LEXQCM2",118,0)
 Q
"RTN","LEXQCM2",119,0)
NUM(X) ;   Convert Code to Numeric
"RTN","LEXQCM2",120,0)
 Q $S(X?1.N:+X,X?4N1A:$A($E(X,5))*10_$E(X,1,4),1:$A(X)_$E(X,2,5))
"RTN","LEXQCM2",121,0)
CLR ;   Clear
"RTN","LEXQCM2",122,0)
 N LEXELDT,LEXGET,LEXLD,LEXRAN,LEXSD,LEXST,LEXTEST,LEXWN
"RTN","LEXQCM2",123,0)
 Q
"RTN","LEXQCMA")
0^10^B41379623^n/a
"RTN","LEXQCMA",1,0)
LEXQCMA ;ISL/KER - Query - CPT Modifiers - Ask ;10/30/2008
"RTN","LEXQCMA",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCMA",3,0)
 ;               
"RTN","LEXQCMA",4,0)
 ; Global Variables
"RTN","LEXQCMA",5,0)
 ;    ^DIC(81.3           ICR   4492
"RTN","LEXQCMA",6,0)
 ;               
"RTN","LEXQCMA",7,0)
 ; External References
"RTN","LEXQCMA",8,0)
 ;    ^DIC                ICR  10006
"RTN","LEXQCMA",9,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQCMA",10,0)
 ;    $$MOD^ICPTMOD       ICR   1996
"RTN","LEXQCMA",11,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCMA",12,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQCMA",13,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCMA",14,0)
 ;               
"RTN","LEXQCMA",15,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQCMA",16,0)
 ;    LEXCDT              Code Set Date
"RTN","LEXQCMA",17,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQCMA",18,0)
 ;    LEXMOD              CPT Modifier IEN^Text
"RTN","LEXQCMA",19,0)
 ;               
"RTN","LEXQCMA",20,0)
 Q
"RTN","LEXQCMA",21,0)
MOD(X) ; CPT Modifier Code
"RTN","LEXQCMA",22,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIC,DTOUT,DUOUT,LEXMD,LEXSO,LEXDTXT,LEXVTXT,LEXVDT,Y,ICPTVDT S:$G(LEXCDT)?7N ICPTVDT=$G(LEXCDT)
"RTN","LEXQCMA",23,0)
 S DIC(0)="AEQMZ",DIC="^DIC(81.3,",DIC("A")=" Select a CPT Modifier code:  ",DIC("S")="I +($$OK^LEXQCMA(+($G(Y))))>0" W !
"RTN","LEXQCMA",24,0)
 D ^DIC  S:$G(X)["^^"!($D(DTOUT)) LEXEXIT=1 Q:$G(X)["^^"!(+($G(LEXEXIT))>0) "^^"
"RTN","LEXQCMA",25,0)
 Q:$G(X)="^" "^"  Q:$G(X)["^^" "^^"  Q:$D(DTOUT)!($D(DUOUT)) "^"  S LEXSO=$P($G(Y),"^",2) S X="" I +Y>0,$L(LEXSO) D
"RTN","LEXQCMA",26,0)
 . S LEXVDT=$G(LEXCDT) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S X=Y,LEXDTXT=$P($G(Y(0)),"^",2),LEXMD=$$MOD^ICPTMOD(+Y,"I",LEXVDT)
"RTN","LEXQCMA",27,0)
 . S:$L($G(LEXDTXT)) LEXDTXT=LEXDTXT_" (Text not Versioned)" S LEXVTXT=$P(LEXMD,"^",3) S:'$L(LEXVTXT) LEXVTXT=LEXDTXT
"RTN","LEXQCMA",28,0)
 . S X=+Y_"^"_LEXSO S:$L(LEXVTXT) X=X_"^"_LEXVTXT
"RTN","LEXQCMA",29,0)
 S X=$$UP^XLFSTR(X) Q:'$L(X) "^"
"RTN","LEXQCMA",30,0)
 Q X
"RTN","LEXQCMA",31,0)
OK(X) ;   Screen for Modifier Lookup
"RTN","LEXQCMA",32,0)
 N LEXE,LEXH,LEXI,LEXIEN,LEXLA,LEXLAI,LEXLE,LEXLI,LEXM,LEXR,LEXS,LEXX S LEXIEN=+($G(X)),LEXM=$P($G(^DIC(81.3,+LEXIEN,0)),"^",1) Q:'$L(LEXM) 0
"RTN","LEXQCMA",33,0)
 N LEXX,LEXI K LEXX S LEXI=0  F  S LEXI=$O(^DIC(81.3,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCMA",34,0)
 . Q:$P($G(^DIC(81.3,+LEXI,0)),"^",4)="V"  N LEXR,LEXH,LEXE,LEXS S LEXR=$S($O(^DIC(81.3,+LEXI,10,0))>0:1,1:0)
"RTN","LEXQCMA",35,0)
 . S:'$D(LEXX(+LEXI)) LEXX(0)=+($G(LEXX(0)))+1 S LEXX(+LEXI)=LEXM_"^"_LEXR
"RTN","LEXQCMA",36,0)
 . M LEXX(LEXI,60)=^DIC(81.3,+LEXI,60) K LEXX(LEXI,60,"B") S LEXH=0 F  S LEXH=$O(LEXX(LEXI,60,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQCMA",37,0)
 . . N LEXE,LEXS S LEXE=$G(LEXX(LEXI,60,LEXH,0)),LEXS=$P(LEXE,"^",2),LEXE=$P(LEXE,"^",1) Q:'$L(LEXS)  Q:'$L(LEXE)
"RTN","LEXQCMA",38,0)
 . . S:+LEXS>0 LEXX("A",LEXE,LEXI)=LEXI,LEXX("S",LEXI,1)="" S:+LEXS'>0 LEXX("I",LEXE,LEXI)=LEXI,LEXX("S",LEXI,0)=""
"RTN","LEXQCMA",39,0)
 S LEXE=0 F  S LEXE=$O(LEXX("S",LEXE)) Q:+LEXE'>0  S:$D(LEXX("S",LEXE,1))&('$D(LEXX("S",LEXE,0))) LEXX("SA",LEXE)=""
"RTN","LEXQCMA",40,0)
 Q:+($G(LEXX(0)))'>1&($D(LEXX(+LEXIEN))) 1  Q:$L($O(LEXX("SA",0)))&($O(LEXX("SA",0))=$O(LEXX("SA"," "),-1))&($D(LEXX("SA",+LEXIEN))) 1
"RTN","LEXQCMA",41,0)
 Q:$L($O(LEXX("SA",0)))&($O(LEXX("SA",0))=$O(LEXX("SA"," "),-1))&('$D(LEXX("SA",+LEXIEN))) 0  S LEXLA=$O(LEXX("A"," "),-1)
"RTN","LEXQCMA",42,0)
 S LEXLAI=$O(LEXX("A",+LEXLA," "),-1),LEXLI=$O(LEXX("I"," "),-1),LEXLE="" S:LEXLA>0&(LEXLA=LEXLI) LEXLE=$O(LEXX("A",LEXLA," "),-1)
"RTN","LEXQCMA",43,0)
 S:LEXLI>0&(LEXLA<LEXLI) LEXLE=$O(LEXX("I",LEXLI," "),-1) S:LEXLA>0&(LEXLA>LEXLI) LEXLE=$O(LEXX("A",LEXLA," "),-1)
"RTN","LEXQCMA",44,0)
 Q:+LEXLE'=+LEXIEN 0
"RTN","LEXQCMA",45,0)
 Q 1
"RTN","LEXQCMA",46,0)
 ;               
"RTN","LEXQCMA",47,0)
INC(X) ; Include CPT Modifier Ranges
"RTN","LEXQCMA",48,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQCMA","INC",+($G(DUZ)),"Include Modifier Ranges") S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQCMA",49,0)
 S DIR(0)="YAO",DIR("A")=" Include Modifier CPT Code Ranges?  (Y/N)  " S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQCMA",50,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D INCH^LEXQCMA"
"RTN","LEXQCMA",51,0)
 W ! D ^DIR S:X["^^"!($D(DIROUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQCMA",52,0)
 D:$L(DIRB) SAV^LEXQD("LEXQCMA","INC",+($G(DUZ)),"Include Modifier Ranges",$G(DIRB)) S X=+Y
"RTN","LEXQCMA",53,0)
 Q X
"RTN","LEXQCMA",54,0)
INCH ;   Include CPT Modifier Ranges Help
"RTN","LEXQCMA",55,0)
 I $L($P($G(LEXMOD),"^",2)),$L($G(LEXCDT)) D  Q
"RTN","LEXQCMA",56,0)
 . W !,?5,"Answer 'Yes' to include the CPT Code Ranges for for CPT"
"RTN","LEXQCMA",57,0)
 . W !,?5,"Modifier code ",$P($G(LEXMOD),"^",2),".  Answer 'No' to exlcude CPT Code Ranges"
"RTN","LEXQCMA",58,0)
 . W !,?5,"from the display."
"RTN","LEXQCMA",59,0)
 W !,?5,"Answer 'Yes' to include the CPT Code Ranges for the CPT"
"RTN","LEXQCMA",60,0)
 W !,?5,"Modifier.  Answer 'No' to exclude CPT Code Ranges from the"
"RTN","LEXQCMA",61,0)
 W !,?5,"display."
"RTN","LEXQCMA",62,0)
 Q
"RTN","LEXQCMA",63,0)
 ;               
"RTN","LEXQCMA",64,0)
INCI(X) ; Include Inactive CPT Modifier Ranges
"RTN","LEXQCMA",65,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQCMA","INCI",+($G(DUZ)),"Include Inactive Modifier Ranges") S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQCMA",66,0)
 S DIR(0)="YAO",DIR("A")=" Include 'Inactive' Modifier CPT Code Ranges?  (Y/N)  " S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQCMA",67,0)
 S DIR("B")="No" S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D INCIH^LEXQCMA"
"RTN","LEXQCMA",68,0)
 W ! D ^DIR S:X["^^" LEXEXIT=1!($D(DTOUT)) Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQCMA",69,0)
 D:$L(DIRB) SAV^LEXQD("LEXQCMA","INCI",+($G(DUZ)),"Include Inactive Modifier Ranges",$G(DIRB)) S X=+Y
"RTN","LEXQCMA",70,0)
 Q X
"RTN","LEXQCMA",71,0)
INCIH ;   Include Inactive CPT Modifier Ranges Help
"RTN","LEXQCMA",72,0)
 I $L($P($G(LEXMOD),"^",2)),$G(LEXCDT)?7N D  Q
"RTN","LEXQCMA",73,0)
 . W !,?5,"Answer 'Yes' to include both Active and Inactive CPT Code"
"RTN","LEXQCMA",74,0)
 . W !,?5,"Ranges for the CPT Modifier ",$P($G(LEXMOD),"^",2),".  Answer 'No' to include"
"RTN","LEXQCMA",75,0)
 . W !,?5,"only the Active CPT Code Ranges that were active for the "
"RTN","LEXQCMA",76,0)
 . W !,?5,"CPT Modifier ",$P($G(LEXMOD),"^",2)," on ",$$SD($G(LEXCDT)),"."
"RTN","LEXQCMA",77,0)
 W !,?5,"Answer 'Yes' to include both Active and Inactive CPT Code "
"RTN","LEXQCMA",78,0)
 W !,?5,"Ranges for the selected CPT Modifier.  Answer 'No' to "
"RTN","LEXQCMA",79,0)
 W !,?5,"include only the Active CPT Code Ranges for the selected"
"RTN","LEXQCMA",80,0)
 W !,?5,"CPT Modifier."
"RTN","LEXQCMA",81,0)
 Q
"RTN","LEXQCMA",82,0)
 ;               
"RTN","LEXQCMA",83,0)
INCF(X) ; Include Future CPT Modifier Ranges
"RTN","LEXQCMA",84,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQCMA","INCF",+($G(DUZ)),"Include Future Modifier Ranges") S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQCMA",85,0)
 S DIR(0)="YAO",DIR("A")=" Include 'Future Active' Modifier CPT Code Ranges?  (Y/N)  " S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQCMA",86,0)
 S DIR("B")="No" S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D INCFH^LEXQCMA"
"RTN","LEXQCMA",87,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQCMA",88,0)
 D:$L(DIRB) SAV^LEXQD("LEXQCMA","INCF",+($G(DUZ)),"Include Future Modifier Ranges",$G(DIRB)) S X=+Y
"RTN","LEXQCMA",89,0)
 Q X
"RTN","LEXQCMA",90,0)
INCFH ;   Include Future CPT Modifier Ranges Help
"RTN","LEXQCMA",91,0)
 I $G(LEXCDT)?7N D  Q
"RTN","LEXQCMA",92,0)
 . W !,?5,"Answer 'Yes' to include CPT Code Ranges that become Active"
"RTN","LEXQCMA",93,0)
 . W !,?5,"on or after ",$$SD($G(LEXCDT)),".  Answer 'No' to exclude CPT Code"
"RTN","LEXQCMA",94,0)
 . W !,?5,"Ranges activated in the future."
"RTN","LEXQCMA",95,0)
 W !,?5,"Answer 'Yes' to include CPT Code Ranges that become Active"
"RTN","LEXQCMA",96,0)
 W !,?5,"in the future.  Answer 'No' to to exclude CPT Code Ranges"
"RTN","LEXQCMA",97,0)
 W !,?5,"activated in the future."
"RTN","LEXQCMA",98,0)
 Q
"RTN","LEXQCMA",99,0)
 ;               
"RTN","LEXQCMA",100,0)
SD(X) ; Short Date
"RTN","LEXQCMA",101,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQCMA",102,0)
CLR ; Clear
"RTN","LEXQCMA",103,0)
 N LEXCDT,LEXEXIT,LEXMOD
"RTN","LEXQCMA",104,0)
 Q
"RTN","LEXQCP")
0^1^B77088041^n/a
"RTN","LEXQCP",1,0)
LEXQCP ;ISL/KER - Query - CPT Procedures - Extract ;10/30/2008
"RTN","LEXQCP",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCP",3,0)
 ;               
"RTN","LEXQCP",4,0)
 ; Global Variables
"RTN","LEXQCP",5,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQCP",6,0)
 ;               
"RTN","LEXQCP",7,0)
 ; External References
"RTN","LEXQCP",8,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXQCP",9,0)
 ;    GETS^DIQ            ICR   2056
"RTN","LEXQCP",10,0)
 ;    $$CPT^ICPTCOD       ICR   1995
"RTN","LEXQCP",11,0)
 ;    CPTD^ICPTCOD        ICR   1995
"RTN","LEXQCP",12,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCP",13,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCP",14,0)
 ;               
"RTN","LEXQCP",15,0)
EN ; Main Entry Point
"RTN","LEXQCP",16,0)
 N LEXENV S LEXENV=$$EV^LEXQM Q:+LEXENV'>0
"RTN","LEXQCP",17,0)
 N LEXAD,LEXEDT,LEXCDT,LEXEXIT,LEXTEST S LEXEXIT=0,LEXCDT=""
"RTN","LEXQCP",18,0)
 F  S LEXCDT=$$AD^LEXQM,LEXAD=LEXCDT Q:'$L(LEXCDT)  S LEXEDT=$P(LEXCDT,"^",1),LEXCDT=$P(LEXCDT,"^",2) Q:LEXCDT'?7N  D LOOK Q:LEXCDT'?7N  Q:+LEXEXIT>0
"RTN","LEXQCP",19,0)
 Q
"RTN","LEXQCP",20,0)
LOOK ; CPT Lookup Loop
"RTN","LEXQCP",21,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S LEXCDT="" Q
"RTN","LEXQCP",22,0)
 N LEXCPT,LEXCPTC S LEXLEN=62
"RTN","LEXQCP",23,0)
 F  S LEXCPT=$$CPT^LEXQCPA S:LEXCPT="^^" LEXEXIT=1 Q:LEXCPT="^"!(LEXCPT="^^")  D  Q:LEXCPT="^"!(LEXCPT="^^")
"RTN","LEXQCP",24,0)
 . K LEXGET,LEXST,LEXSD,LEXLD,LEXMD,LEXLX,LEXWN N LEXIEN,LEXLDT,LEXELDT,LEXINC
"RTN","LEXQCP",25,0)
 . S LEXIEN=+($G(LEXCPT)),LEXLDT=+($G(LEXCDT)) Q:+LEXIEN'>0  Q:LEXLDT'?7N  S LEXELDT=$$SD^LEXQM(LEXLDT) Q:'$L(LEXELDT)
"RTN","LEXQCP",26,0)
 . S LEXINC=$$INC^LEXQCPA Q:LEXINC["^"
"RTN","LEXQCP",27,0)
 . D CSV,EN^LEXQCP2
"RTN","LEXQCP",28,0)
 Q
"RTN","LEXQCP",29,0)
CSV ; Code Set Versioning Display
"RTN","LEXQCP",30,0)
 N LEXEDT,LEXIEN,LEXIENS,LEXLTXT,LEXSO,LEXSTAT
"RTN","LEXQCP",31,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S (LEXCPT,LEXCDT)="" Q
"RTN","LEXQCP",32,0)
 S LEXIEN=+($G(LEXCPT)),LEXSO=$P($G(LEXCPT),"^",2),LEXLTXT=$P($G(LEXCPT),"^",3) Q:+LEXIEN'>0  Q:'$L(LEXSO)
"RTN","LEXQCP",33,0)
 ;
"RTN","LEXQCP",34,0)
 ; Get the "Unversioned" Fields
"RTN","LEXQCP",35,0)
 ;   
"RTN","LEXQCP",36,0)
 ;   CPT Code                    Field .01
"RTN","LEXQCP",37,0)
 ;   CPT Major Category          Field 3
"RTN","LEXQCP",38,0)
 ;   CPT Sub-Category            Field 3
"RTN","LEXQCP",39,0)
 ;   Age Low                     Field 10.01
"RTN","LEXQCP",40,0)
 ;   Age High                    Field 10.02
"RTN","LEXQCP",41,0)
 ;   Sex                         Field 10.03
"RTN","LEXQCP",42,0)
 ;
"RTN","LEXQCP",43,0)
 S LEXIENS=LEXIEN_"," D GETS^DIQ(81,LEXIENS,".01;3;10.01;10.02;10.03","IE","LEXGET","LEXMSG")
"RTN","LEXQCP",44,0)
 I $G(LEXGET(81,LEXIENS,3,"I"))>0,$L($G(LEXGET(81,LEXIENS,3,"I"))) D
"RTN","LEXQCP",45,0)
 . S LEXGET(81,LEXIENS,3,2)=$$GET1^DIQ(81.1,(+($G(LEXGET(81,LEXIENS,3,"I")))_","),.01)
"RTN","LEXQCP",46,0)
 . S LEXGET(81,LEXIENS,3,1)=$$GET1^DIQ(81.1,(+($G(LEXGET(81,LEXIENS,3,"I")))_","),3)
"RTN","LEXQCP",47,0)
 . I $L($G(LEXGET(81,LEXIENS,3,2))),'$L($G(LEXGET(81,LEXIENS,3,1))) S LEXGET(81,LEXIENS,3,1)=$G(LEXGET(81,LEXIENS,3,2)) K LEXGET(81,LEXIENS,3,2)
"RTN","LEXQCP",48,0)
 . I $G(LEXGET(81,LEXIENS,3,2))=$G(LEXGET(81,LEXIENS,3,1)) K LEXGET(81,LEXIENS,3,2)
"RTN","LEXQCP",49,0)
 . I '$L($G(LEXGET(81,LEXIENS,3,2))),'$L($G(LEXGET(81,LEXIENS,3,1))) K LEXGET(81,LEXIENS,3,1),LEXGET(81,LEXIENS,3,2)
"RTN","LEXQCP",50,0)
 ; Get the "Versioned" Fields
"RTN","LEXQCP",51,0)
 ;                
"RTN","LEXQCP",52,0)
 ;   Effective Date and Status   Sub-File 81.02   (60)
"RTN","LEXQCP",53,0)
 S LEXST=$$EF(+($G(LEXIEN)),+LEXCDT),LEXSTAT=+($P(LEXST,"^",2))
"RTN","LEXQCP",54,0)
 ;   Procedure Name              Sub-File 81.061  (61)
"RTN","LEXQCP",55,0)
 D SDS(+($G(LEXIEN)),+LEXCDT,.LEXSD,62,LEXSTAT)
"RTN","LEXQCP",56,0)
 ;   Description                 Sub-File 81.062  (62)
"RTN","LEXQCP",57,0)
 D LDS(+($G(LEXIEN)),+LEXCDT,.LEXLD,62,LEXSTAT)
"RTN","LEXQCP",58,0)
 ;   Lexicon Expression          
"RTN","LEXQCP",59,0)
 D LX(+($G(LEXIEN)),+LEXCDT,.LEXLX,62,LEXSTAT)
"RTN","LEXQCP",60,0)
 D WN^LEXQCP2(+LEXCDT,.LEXWN,62)
"RTN","LEXQCP",61,0)
 D MOD^LEXQCP2(+($G(LEXIEN)),+LEXCDT,.LEXMD,62,LEXSTAT)
"RTN","LEXQCP",62,0)
 Q
"RTN","LEXQCP",63,0)
 ;            
"RTN","LEXQCP",64,0)
EF(X,LEXCDT) ; Effective Dates
"RTN","LEXQCP",65,0)
 N LEX,LEXBRD,LEXBRW,LEXAD,LEXEE,LEXEF,LEXES,LEXFA,LEXH,LEXI,LEXID,LEXIEN,LEXLS,LEXSO,LEXST S LEXIEN=+($G(X)),LEXCDT=+($G(LEXCDT))
"RTN","LEXQCP",66,0)
 Q:+LEXIEN'>0 "^^"  Q:'$L(^ICPT(+LEXIEN,0)) "^^"  Q:LEXCDT'?7N "^^"  S LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1),LEXBRD=2890101,LEXBRW=""
"RTN","LEXQCP",67,0)
 S LEX=$$CPT^ICPTCOD(LEXSO,LEXCDT) S LEXFA=$$FA^LEXQCP2(+LEXIEN) S (LEXLS,LEXST)=$P(LEX,"^",7),LEXID=$P(LEX,"^",8)
"RTN","LEXQCP",68,0)
 S:LEXCDT<LEXBRD&(+LEXFA=LEXBRD) LEXBRW="Warning:  The 'Based on Date' provided precedes the initial Code Set Business Rule date of "_$$SD^LEXQM(LEXBRD)_", the Effective date may be inaccurate."
"RTN","LEXQCP",69,0)
 S LEXAD=$P(LEX,"^",9),LEXES=$S(+LEXST>0:"Active",1:"Inactive")
"RTN","LEXQCP",70,0)
 S:+LEXST'>0&(+LEXAD'>0) LEXES="Not Applicable",LEXLS=-1 S:LEXST>0 LEXEF=LEXAD S:LEXST'>0 LEXEF=LEXID
"RTN","LEXQCP",71,0)
 S:LEXST'>0&(+LEXID'>0) LEXEF=LEXFA S LEXEE=$$SD^LEXQM(LEXEF)
"RTN","LEXQCP",72,0)
 I LEXST'>0,+LEXID'>0,$L(LEXEE),+LEXEF>LEXCDT S LEXEE="(future activation of "_LEXEE_")",LEXEF=""
"RTN","LEXQCP",73,0)
 S X=LEXLS_"^"_LEXST_"^"_LEXEF_"^"_LEXES_"^"_LEXEE S:$L(LEXBRW) $P(X,"^",6)=LEXBRW
"RTN","LEXQCP",74,0)
 Q X
"RTN","LEXQCP",75,0)
 ;            
"RTN","LEXQCP",76,0)
SDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Procedure Name (short description)
"RTN","LEXQCP",77,0)
 ;            
"RTN","LEXQCP",78,0)
 ; LEX=# of Lines
"RTN","LEXQCP",79,0)
 ; LEX(0)=External Date of Procedure Name
"RTN","LEXQCP",80,0)
 ; LEX(#)=Procedure Name
"RTN","LEXQCP",81,0)
 ;            
"RTN","LEXQCP",82,0)
 N LEXD,LEXBRD,LEXBRW,LEXDDT,LEXE,LEXEE,LEXEFF,LEXFA,LEXHIS,LEXI,LEXIA,LEXIEN,LEXL,LEXLAST,LEXLEF,LEXLHI,LEXM,LEXR,LEXSDT,LEXSO,LEXLSD,LEXT
"RTN","LEXQCP",83,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICPT(+LEXIEN,61))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQCP",84,0)
 S LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1),LEXLAST=$$CPT^ICPTCOD(LEXSO),LEXLSD=$P(LEXLAST,"^",3),LEXBRD=2890101,LEXBRW=""
"RTN","LEXQCP",85,0)
 S:$D(LEXGET)&($L(LEXLSD)) LEXGET(81,(+LEXIEN_","),"B")=LEXLSD
"RTN","LEXQCP",86,0)
 S LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 S LEXFA=$$FA^LEXQCP2(+LEXIEN),LEXM=""
"RTN","LEXQCP",87,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Procedure Short Name is not available.  The date provided precedes the initial activation of the code"
"RTN","LEXQCP",88,0)
 I $L(LEXM) D  Q
"RTN","LEXQCP",89,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQCP",90,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQCP",91,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCP",92,0)
 S LEXM="" S LEXEFF=$O(^ICPT(LEXIEN,61,"B",(LEXVDT+.001)),-1),LEXHIS=$O(^ICPT(LEXIEN,61,"B",+LEXEFF," "),-1),LEXSDT=$P($G(^ICPT(+LEXIEN,61,+LEXHIS,0)),"^",2)
"RTN","LEXQCP",93,0)
 S LEXLEF=$O(^ICPT(LEXIEN,61,"B",(9999999+.001)),-1),LEXLHI=$O(^ICPT(LEXIEN,61,"B",+LEXLEF," "),-1),LEXDDT=$P($G(^ICPT(+LEXIEN,61,+LEXLHI,0)),"^",2)
"RTN","LEXQCP",94,0)
 S (LEXD,LEXE,LEXR)="" S:$L(LEXSDT)&(LEXEFF?7N) LEXD=LEXSDT,LEXE=LEXEFF
"RTN","LEXQCP",95,0)
 S:$L(LEXDDT)&(LEXLEF?7N)&('$L(LEXD))&('$L(LEXE)) LEXD=LEXDDT,LEXE=LEXLEF,LEXR="No Text Available for Date Provided"
"RTN","LEXQCP",96,0)
 K LEX S LEX(1)=LEXD S:$L(LEXD) LEXGET(81,(+LEXIEN_","),"B")=LEXD
"RTN","LEXQCP",97,0)
 S LEXEE=$$SD^LEXQM(LEXE) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEE="--/--/----" S:$L(LEX(1)) LEX(0)=LEXEE
"RTN","LEXQCP",98,0)
 S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCP",99,0)
 Q
"RTN","LEXQCP",100,0)
LDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Long Description
"RTN","LEXQCP",101,0)
 ;            
"RTN","LEXQCP",102,0)
 ; LEX=# of Lines
"RTN","LEXQCP",103,0)
 ; LEX(0)=External Date of Description
"RTN","LEXQCP",104,0)
 ; LEX(#)=Description
"RTN","LEXQCP",105,0)
 ; LEX(#)=Description continued
"RTN","LEXQCP",106,0)
 ;            
"RTN","LEXQCP",107,0)
 N LEXC,LEXBRD,LEXBRW,LEXDDT,LEXEVDT,LEXFA,LEXI,LEXIEN,LEXL,LEXLN,LEXM,LEXT,LEXSO,LEXTL,LEXTMP S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICPT(+LEXIEN,62))
"RTN","LEXQCP",108,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62
"RTN","LEXQCP",109,0)
 S LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1) S LEXFA=$$FA^LEXQCP2(+LEXIEN),LEXM="" S LEXSTA=+($G(LEXSTA)),LEXBRD=2890101,LEXBRW=""
"RTN","LEXQCP",110,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Description is not available.  The date provided precedes the initial activation of the code"
"RTN","LEXQCP",111,0)
 I $L(LEXM) D  Q
"RTN","LEXQCP",112,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7)) S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQCP",113,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCP",114,0)
 K LEXTMP S LEXTL=$$CPTD^ICPTCOD(LEXSO,"LEXTMP",,LEXVDT) S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$G(LEXTMP(+LEXL))
"RTN","LEXQCP",115,0)
 S LEXM="" K:LEXL>0&(LEXLN["CODE TEXT MAY BE INACCURATE") LEXTMP(+LEXL)
"RTN","LEXQCP",116,0)
 F LEXI=1:1:2 S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$$TM^LEXQM($G(LEXTMP(+LEXL))) K:LEXL>0&('$L(LEXLN)) LEXTMP(+LEXL)
"RTN","LEXQCP",117,0)
 S LEXDDT=$O(^ICPT(+LEXIEN,62,"B",(LEXVDT+.999999)),-1) S:LEXDDT'?7N LEXDDT=$O(^ICPT(+LEXIEN,62,"B",0)) S:LEXDDT?7N LEXEVDT=$$SD^LEXQM(LEXDDT)
"RTN","LEXQCP",118,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX F LEXI=1:1:13 D
"RTN","LEXQCP",119,0)
 . Q:'$D(LEXTMP(LEXI))  S LEXT=$$TM^LEXQM($G(LEXTMP(LEXI))),LEX(LEXI)=$$UP^XLFSTR(LEXT)
"RTN","LEXQCP",120,0)
 I $L(LEXM) D
"RTN","LEXQCP",121,0)
 . N LEXT,LEXI,LEXL,LEXC S LEXL=+($O(LEX(" "),-1)),LEXC=0 S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQCP",122,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCP",123,0)
 . . S LEXT=$G(LEXT(LEXI)) S:$L(LEXT) LEXC=LEXC+1 S LEXL=LEXL+1,LEX(LEXL)=LEXT
"RTN","LEXQCP",124,0)
 S:$D(LEXTEST)&(+LEXSTA'>0) LEXEVDT="--/--/----" S:$D(LEX(1)) LEX(0)=LEXEVDT S LEX=+($O(LEX(" "),-1))
"RTN","LEXQCP",125,0)
 Q
"RTN","LEXQCP",126,0)
LX(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Lexicon Expression
"RTN","LEXQCP",127,0)
 ;            
"RTN","LEXQCP",128,0)
 ; LEX=# of Lines
"RTN","LEXQCP",129,0)
 ; LEX(0)=External Date of Expression
"RTN","LEXQCP",130,0)
 ; LEX(#)=Expression
"RTN","LEXQCP",131,0)
 ; LEX(#)=Expression continued
"RTN","LEXQCP",132,0)
 ;            
"RTN","LEXQCP",133,0)
 N LEXEF,LEXEVDT,LEXEX,LEXEE,LEXFA,LEXI,LEXIA,LEXIEN,LEXLEF,LEXLHS,LEXLST,LEXM,LEXN0,LEXPF,LEXSAB,LEXSIEN,LEXSO,LEXT,LEXVTMP
"RTN","LEXQCP",134,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICPT(+LEXIEN,0))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQCP",135,0)
 S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62  Q:'$L(LEXEVDT)
"RTN","LEXQCP",136,0)
 S LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1) Q:'$L(LEXSO)  S LEXFA=$$FA^LEXQCP2(+LEXIEN),LEXM="",LEXIA=$$IA(LEXVDT)
"RTN","LEXQCP",137,0)
 S LEXSIEN=0 F  S LEXSIEN=$O(^LEX(757.02,"CODE",(LEXSO_" "),LEXSIEN)) Q:+LEXSIEN'>0  D
"RTN","LEXQCP",138,0)
 . N LEXN0 S LEXN0=$G(^LEX(757.02,+LEXSIEN,0)),LEXSAB=$P(LEXN0,"^",3)
"RTN","LEXQCP",139,0)
 . Q:"^3^4^"'[("^"_LEXSAB_"^")  S LEXPF=+($P(LEXN0,"^",5)) S LEXLEF=$O(^LEX(757.02,+LEXSIEN,4,"B",(LEXVDT+.99999)),-1) I LEXLEF?7N D
"RTN","LEXQCP",140,0)
 . . S LEXLHS=$O(^LEX(757.02,+LEXSIEN,4,"B",+LEXLEF," "),-1) I +LEXLHS>0 D
"RTN","LEXQCP",141,0)
 . . . S LEXLST=$G(^LEX(757.02,+LEXSIEN,4,+LEXLHS,0)),LEXLST=$P(LEXLST,"^",2)
"RTN","LEXQCP",142,0)
 . . . S:LEXLST>0 LEXVTMP(+LEXPF,LEXSIEN)=+LEXN0_"^"_LEXLEF
"RTN","LEXQCP",143,0)
 S (LEXEX,LEXEF)="",LEXSIEN=$O(LEXVTMP(1,0)),LEXEX=+($G(LEXVTMP(1,+LEXSIEN))),LEXEF=$P($G(LEXVTMP(1,+LEXSIEN)),"^",2)
"RTN","LEXQCP",144,0)
 S:+LEXSIEN'>0!(+LEXEX'>0) LEXSIEN=$O(LEXVTMP(0,0)),LEXEX=+($G(LEXVTMP(0,+LEXSIEN))),LEXEF=$P($G(LEXVTMP(0,+LEXSIEN)),"^",2)
"RTN","LEXQCP",145,0)
 K LEX I +LEXEX>0,$L($G(^LEX(757.01,+LEXEX,0))),$L(LEXEF),LEXEF?7N  D  Q
"RTN","LEXQCP",146,0)
 . K LEX N LEXT,LEXM,LEXI S LEXT(1)=$G(^LEX(757.01,+LEXEX,0)) D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQCP",147,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S:$L($G(LEXT(LEXI))) LEX(+LEXI)=$G(LEXT(LEXI))
"RTN","LEXQCP",148,0)
 . S LEX=+($O(LEX(" "),-1)) S LEXEE=$$SD^LEXQM(LEXEF) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEE="--/--/----" S LEX(0)=LEXEE
"RTN","LEXQCP",149,0)
 Q
"RTN","LEXQCP",150,0)
 ; Miscellaneous
"RTN","LEXQCP",151,0)
IA(X) ;   Inaccurate
"RTN","LEXQCP",152,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQCP",153,0)
 Q X
"RTN","LEXQCP",154,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQCP",155,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQCP",156,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2890101:2890101,1:LEXVDT)
"RTN","LEXQCP",157,0)
 Q X
"RTN","LEXQCP2")
0^2^B56468860^n/a
"RTN","LEXQCP2",1,0)
LEXQCP2 ;ISL/KER - Query - CPT Procedures - Save ;10/30/2008
"RTN","LEXQCP2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCP2",3,0)
 ;               
"RTN","LEXQCP2",4,0)
 ; Global Variables
"RTN","LEXQCP2",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQCP2",6,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQCP2",7,0)
 ;    ^TMP("LEXQCPO")     SACC 2.3.2.5.1
"RTN","LEXQCP2",8,0)
 ;               
"RTN","LEXQCP2",9,0)
 ; External References
"RTN","LEXQCP2",10,0)
 ;    HIST^ICPTAPIU       ICR   1997
"RTN","LEXQCP2",11,0)
 ;    $$MODA^ICPTMOD      ICR   1996
"RTN","LEXQCP2",12,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCP2",13,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCP2",14,0)
 ;               
"RTN","LEXQCP2",15,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQCP2",16,0)
 ;     LEXIEN             CPT Internal Entry Number
"RTN","LEXQCP2",17,0)
 ;     LEXLEN             Offset Length
"RTN","LEXQCP2",18,0)
 ;     LEXGET             Array of Non-Versioned Data
"RTN","LEXQCP2",19,0)
 ;     LEXST              CPT Status and Effective Dates
"RTN","LEXQCP2",20,0)
 ;     LEXSD              Versioned Short Description
"RTN","LEXQCP2",21,0)
 ;     LEXLD              Versioned Long Description
"RTN","LEXQCP2",22,0)
 ;     LEXMD              Versioned Modifiers
"RTN","LEXQCP2",23,0)
 ;     LEXLX              Versioned Lexicon Term
"RTN","LEXQCP2",24,0)
 ;     LEXWN              Warning
"RTN","LEXQCP2",25,0)
 ;     LEXINC             Flag to Display Modifiers
"RTN","LEXQCP2",26,0)
 ;     LEXELDT            External Last Date
"RTN","LEXQCP2",27,0)
 ;               
"RTN","LEXQCP2",28,0)
EN ; Main Entry Point
"RTN","LEXQCP2",29,0)
 K ^TMP("LEXQCPO",$J) Q:'$L($G(LEXELDT))  I +($G(LEXST))<0 D FUT D:$D(^TMP("LEXQCPO",$J)) DSP^LEXQO("LEXQCPO") Q
"RTN","LEXQCP2",30,0)
 D FUL D:$D(^TMP("LEXQCPO",$J)) DSP^LEXQO("LEXQCPO")
"RTN","LEXQCP2",31,0)
 Q
"RTN","LEXQCP2",32,0)
FUT ; Future Activation
"RTN","LEXQCP2",33,0)
 N LEX1,LEX2,LEX3,LEXEFF,LEXI,LEXL,LEXNAM,LEXSO,LEXSTA S LEXI=+($G(LEXIEN)) Q:+LEXI'>0  Q:'$D(^ICPT(+LEXI,0))  S LEXL=+($G(LEXLEN)) Q:+LEXL'>0
"RTN","LEXQCP2",34,0)
 S:LEXL>62 LEXL=62 S LEXSO=$G(LEXGET(81,(+LEXI_","),.01,"E")) Q:'$L(LEXSO)  S LEXNAM=$G(LEXGET(81,(+LEXI_","),"B")) Q:'$L(LEXNAM)
"RTN","LEXQCP2",35,0)
 S LEXSTA=$G(LEXST),LEXEFF=$P(LEXSTA,"^",5),LEXSTA=$P(LEXSTA,"^",4) Q:'$L(LEXSTA)  Q:'$L(LEXEFF)  S (LEX1,LEX2,LEX3)=""
"RTN","LEXQCP2",36,0)
 D BOD(LEXELDT),COD(LEXSO,LEXNAM,+($G(LEXL))),STA(.LEXST,+($G(LEXL)))
"RTN","LEXQCP2",37,0)
 Q
"RTN","LEXQCP2",38,0)
BOD(X) ;   Based on Date
"RTN","LEXQCP2",39,0)
 N LEXBOD,LEXT S LEXBOD=$G(X),LEXT="Display based on date:  "_LEXBOD D BL,TL(LEXT)
"RTN","LEXQCP2",40,0)
 Q
"RTN","LEXQCP2",41,0)
COD(X,Y,LEXLEN) ;   Code Line
"RTN","LEXQCP2",42,0)
 N LEXC,LEXN,LEXT S LEXC=$G(X),LEXN=$G(Y),LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",43,0)
 Q
"RTN","LEXQCP2",44,0)
STA(X,LEXLEN) ;   Status Line
"RTN","LEXQCP2",45,0)
 N LEX,LEXC,LEXI,LEXN,LEXX,LEXE,LEXS,LEXT,LEXW,LEXEFF,LEXSTA S LEXX=$G(X),LEXEFF=$P(LEXX,"^",5),LEXSTA=$P(LEXX,"^",4),LEXEFF=$TR(LEXEFF,"()","")
"RTN","LEXQCP2",46,0)
 S LEXW=$P(LEXX,"^",6),LEXT="  Status:  ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT))),LEXT=LEXT_LEXSTA
"RTN","LEXQCP2",47,0)
 S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Effective:  "_$$UP^XLFSTR($E(LEXEFF,1))_$E(LEXEFF,2,$L(LEXEFF)) D BL,TL(LEXT)
"RTN","LEXQCP2",48,0)
 I $L(LEXW) D
"RTN","LEXQCP2",49,0)
 . N LEX,LEXT,LEXC,LEXI,LEXN S LEX(1)=LEXW D PR^LEXQM(.LEX,(+($G(LEXLEN))-7)) Q:+($O(LEX(" "),-1))'>0
"RTN","LEXQCP2",50,0)
 . S LEXT=$J(" ",((79-+($G(LEXLEN)))))
"RTN","LEXQCP2",51,0)
 . S (LEXC,LEXI)=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCP2",52,0)
 . . N LEXN S LEXN=$$TM^LEXQM($G(LEX(LEXI))) S:$L(LEXN) LEXC=LEXC+1 D:LEXC=1 BL D TL((LEXT_LEXN))
"RTN","LEXQCP2",53,0)
 Q
"RTN","LEXQCP2",54,0)
FUL ; Full Display
"RTN","LEXQCP2",55,0)
 N LEXFUL,LEX,LEXL S LEXL=+($G(LEXLEN)) S:LEXL>62 LEXL=62
"RTN","LEXQCP2",56,0)
 S LEXFUL=""  D FUT,CAT(+($G(LEXIEN)),+($G(LEXL))),LIM(+($G(LEXIEN)),+($G(LEXL)))
"RTN","LEXQCP2",57,0)
 D SD(.LEXSD,+($G(LEXL))),LD(.LEXLD,+($G(LEXL))),LX(.LEXLX,+($G(LEXL))),WR(.LEXWN,+($G(LEXL)))
"RTN","LEXQCP2",58,0)
 D:+($G(LEXINC))>0 MD(.LEXMD,+($G(LEXL)))
"RTN","LEXQCP2",59,0)
 Q
"RTN","LEXQCP2",60,0)
CAT(X,LEXLEN) ;   CPT Categories
"RTN","LEXQCP2",61,0)
 N LEXI,LEX1,LEX2,LEXT,LEXH1,LEXH2,LEXV1,LEXV2,LEXT,LEXTC S LEXI=+($G(X)),LEX1=$G(LEXGET(81,(+LEXI_","),3,1)),LEX2=$G(LEXGET(81,(+LEXI_","),3,2)) Q:'$L((LEX1_LEX2))
"RTN","LEXQCP2",62,0)
 S LEXT="  Categories: " S:$L(LEX1)&('$L(LEX2)) LEXT="  Category: " S:'$L(LEX1)&($L(LEX2)) LEXT="  Category: " S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))
"RTN","LEXQCP2",63,0)
 S:$L(LEX1)&($L(LEX2)) LEXH1="Major Category:   "_LEX1,LEXH2="Sub-Category:     "_LEX2 S LEXH2=$J(" ",(79-+($G(LEXLEN))))_$G(LEXH2) S:$L(LEX1)&('$L(LEX2)) LEXH1=LEX1,LEXH2=""
"RTN","LEXQCP2",64,0)
 S:'$L(LEX1)&('$L(LEX2)) LEXH1="",LEXH2="" S LEX=LEXT_LEXH1_"^"_LEXH2
"RTN","LEXQCP2",65,0)
 D:$L($P(LEX,"^",1))!($L($P(LEX,"^",2))) BL D:$L($P(LEX,"^",1)) TL($P(LEX,"^",1)) D:$L($P(LEX,"^",2)) TL($P(LEX,"^",2))
"RTN","LEXQCP2",66,0)
 Q
"RTN","LEXQCP2",67,0)
LIM(X,LEXLEN) ;   Limitations
"RTN","LEXQCP2",68,0)
 N LEXI,LEXH,LEXL,LEXS,LEXT S LEXI=+($G(X)),LEXL=$G(LEXGET(81,(+LEXI_","),10.01,"E")) S:'$L(LEXL) LEXL="N/A"
"RTN","LEXQCP2",69,0)
 S LEXH=$G(LEXGET(81,(+LEXI_","),10.02,"E")) S:'$L(LEXH) LEXH="N/A" S LEXS=$G(LEXGET(81,(+LEXI_","),10.03,"E")) S:'$L(LEXS) LEXS="N/A"
"RTN","LEXQCP2",70,0)
 Q:(LEXH_LEXL_LEXS)="N/AN/AN/A"  S LEXT="  Limitations: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_"Age Low:  "_LEXL
"RTN","LEXQCP2",71,0)
 S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Age High:  "_LEXH,LEXT=LEXT_$J(" ",(56-$L(LEXT)))_"Sex:  "_LEXS D BL,TL(LEXT)
"RTN","LEXQCP2",72,0)
 Q
"RTN","LEXQCP2",73,0)
SD(X,LEXLEN) ;   Short Description
"RTN","LEXQCP2",74,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Short Name: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",75,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCP2",76,0)
 Q
"RTN","LEXQCP2",77,0)
LD(X,LEXLEN) ;   Long Description
"RTN","LEXQCP2",78,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Description: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",79,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCP2",80,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))) S LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCP2",81,0)
 Q
"RTN","LEXQCP2",82,0)
LX(X,LEXLEN) ;   Lexicon Expression
"RTN","LEXQCP2",83,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Lexicon Term:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",84,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCP2",85,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCP2",86,0)
 Q
"RTN","LEXQCP2",87,0)
WR(X,LEXLEN) ;   Warning
"RTN","LEXQCP2",88,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT,LEXC Q:'$D(X(1))  S LEXC=0,LEXN=$G(X(1)),LEXT="",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",89,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=1 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCP2",90,0)
 Q
"RTN","LEXQCP2",91,0)
MD(X,LEXLEN) ;   CPT Modifiers
"RTN","LEXQCP2",92,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXE=$G(X(0)),LEXN=$G(X(1)),LEXT="  Modifiers:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQCP2",93,0)
 S LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQCP2",94,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQCP2",95,0)
 . S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQCP2",96,0)
 Q
"RTN","LEXQCP2",97,0)
MOD(X,LEXVDT,LEX,LEXLEN,LEXSTA) ;   CPT Modifiers
"RTN","LEXQCP2",98,0)
 ;            
"RTN","LEXQCP2",99,0)
 ; LEX=# of Lines
"RTN","LEXQCP2",100,0)
 ; LEX(0)=External Date
"RTN","LEXQCP2",101,0)
 ; LEX(#)=Modifier List
"RTN","LEXQCP2",102,0)
 ;            
"RTN","LEXQCP2",103,0)
 N LEXA,LEXEVDT,LEXFA,LEXI,LEXIEN,LEXM,LEXS,LEXSO S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICPT(+LEXIEN,0))  S LEXSTA=+($G(LEXSTA))
"RTN","LEXQCP2",104,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62  Q:'$L(LEXEVDT)
"RTN","LEXQCP2",105,0)
 S LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1) Q:'$L(LEXSO)  S LEXFA=$$FA(+LEXIEN) Q:LEXVDT<LEXFA
"RTN","LEXQCP2",106,0)
 K LEX D MODA^ICPTMOD(LEXSO,LEXVDT,.LEXA) S (LEXS,LEXM)="" F  S LEXM=$O(LEXA("A",LEXM)) Q:'$L(LEXM)  D
"RTN","LEXQCP2",107,0)
 . Q:'$D(^DIC(81.3,"B",LEXM))  I ($L(LEXS)+$L(LEXM)+3)'>62 S LEXS=LEXS_LEXM_"   " Q
"RTN","LEXQCP2",108,0)
 . I ($L(LEXS)+$L(LEXM)+3)>62 S LEXI=$O(LEX(" "),-1)+1,LEX(LEXI)=$$TM^LEXQM(LEXS),LEXS=LEXM_"   " Q
"RTN","LEXQCP2",109,0)
 I $L(LEXS) S LEXI=$O(LEX(" "),-1)+1,LEX(LEXI)=$$TM^LEXQM(LEXS)
"RTN","LEXQCP2",110,0)
 S LEX=$O(LEX(" "),-1) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEVDT="--/--/----" S LEX(0)=LEXEVDT
"RTN","LEXQCP2",111,0)
 Q
"RTN","LEXQCP2",112,0)
WN(X,LEX,LEXLEN) ;   Warning
"RTN","LEXQCP2",113,0)
 ;            
"RTN","LEXQCP2",114,0)
 ; LEX=# of Lines
"RTN","LEXQCP2",115,0)
 ; LEX(0)=External Date
"RTN","LEXQCP2",116,0)
 ; LEX(#)=Warning
"RTN","LEXQCP2",117,0)
 ;            
"RTN","LEXQCP2",118,0)
 N LEXVDT,LEXIA,LEXTMP,LEXREF K LEX S LEXVDT=$G(X) Q:LEXVDT'?7N  S LEXIA=$$IA^LEXQCP(LEXVDT) Q:+LEXIA'>0
"RTN","LEXQCP2",119,0)
 S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62 S LEXREF="Short Name and Description" S:$D(LEXLX) LEXREF="Short Name, Description and Lexicon Term"
"RTN","LEXQCP2",120,0)
 S LEXTMP(1)="Warning:  The 'Based on Date' provided precedes Code Set Versioning.  The "_LEXREF_" may be inaccurate for "_$$SD^LEXQM(LEXVDT)
"RTN","LEXQCP2",121,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX S LEXI=0 F  S LEXI=$O(LEXTMP(LEXI)) Q:+LEXI'>0  S LEX(LEXI)=$G(LEXTMP(LEXI))
"RTN","LEXQCP2",122,0)
 S LEX=$O(LEX(" "),-1),LEX(0)=$$SD^LEXQM(LEXVDT)
"RTN","LEXQCP2",123,0)
 Q
"RTN","LEXQCP2",124,0)
 ;
"RTN","LEXQCP2",125,0)
 ; Miscellaneous
"RTN","LEXQCP2",126,0)
FA(X) ;   First Activation
"RTN","LEXQCP2",127,0)
 N LEXFA,LEXH,LEXI,LEXIEN,LEXSO
"RTN","LEXQCP2",128,0)
 S LEXIEN=+($G(X)) S X="",LEXSO=$P($G(^ICPT(+LEXIEN,0)),"^",1) D HIST^ICPTAPIU(LEXSO,.LEXH) S LEXFA="",LEXI=0
"RTN","LEXQCP2",129,0)
 F  S LEXI=$O(LEXH(LEXI)) Q:+LEXI'>0!($L(LEXFA))  S:+($G(LEXH(LEXI)))>0&(LEXI?7N) LEXFA=LEXI Q:$L(LEXFA)
"RTN","LEXQCP2",130,0)
 S X=LEXFA
"RTN","LEXQCP2",131,0)
 Q X
"RTN","LEXQCP2",132,0)
BL ;   Blank Line
"RTN","LEXQCP2",133,0)
 D TL(" ") Q
"RTN","LEXQCP2",134,0)
TL(X) ;   Text Line
"RTN","LEXQCP2",135,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQCP2",136,0)
 N LEXI S LEXI=+($O(^TMP("LEXQCPO",$J," "),-1))+1 S ^TMP("LEXQCPO",$J,LEXI)=$G(X),^TMP("LEXQCPO",$J,0)=LEXI
"RTN","LEXQCP2",137,0)
 Q
"RTN","LEXQCP2",138,0)
CLR ;   Clear
"RTN","LEXQCP2",139,0)
 N LEXIEN,LEXLEN,LEXGET,LEXSD,LEXLD,LEXMD,LEXLX,LEXINC,LEXELDT,LEXST,LEXTEST,LEXWN
"RTN","LEXQCP2",140,0)
 Q
"RTN","LEXQCPA")
0^11^B9847253^n/a
"RTN","LEXQCPA",1,0)
LEXQCPA ;ISL/KER - Query - CPT Procedures - Ask ;10/30/2008
"RTN","LEXQCPA",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQCPA",3,0)
 ;               
"RTN","LEXQCPA",4,0)
 ; Global Variables
"RTN","LEXQCPA",5,0)
 ;    None
"RTN","LEXQCPA",6,0)
 ;               
"RTN","LEXQCPA",7,0)
 ; External References
"RTN","LEXQCPA",8,0)
 ;    ^DIC                ICR  10006
"RTN","LEXQCPA",9,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQCPA",10,0)
 ;    $$CPT^ICPTCOD       ICR   1995
"RTN","LEXQCPA",11,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQCPA",12,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQCPA",13,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQCPA",14,0)
 ;               
"RTN","LEXQCPA",15,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQCPA",16,0)
 ;    LEXCDT              Code Set Date
"RTN","LEXQCPA",17,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQCPA",18,0)
 ;    LEXCPT              CPT Code IEN^Text
"RTN","LEXQCPA",19,0)
 ;           
"RTN","LEXQCPA",20,0)
 Q
"RTN","LEXQCPA",21,0)
CPT(X) ; CPT Code
"RTN","LEXQCPA",22,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIC,DTOUT,DUOUT,LEXCP,LEXSO,LEXDTXT,LEXVTXT,LEXVDT,Y,ICPTVDT S:$G(LEXCDT)?7N ICPTVDT=$G(LEXCDT)
"RTN","LEXQCPA",23,0)
 S DIC(0)="AEQMZ",DIC="^ICPT(",DIC("A")=" Select a CPT/HCPCS Procedure code:  " W !
"RTN","LEXQCPA",24,0)
 D ^DIC  S:$G(X)["^^"!($D(DTOUT)) LEXEXIT=1 Q:$G(X)["^^"!(+($G(LEXEXIT))>0) "^^"
"RTN","LEXQCPA",25,0)
 Q:$G(X)="^" "^"  Q:$G(X)["^^" "^^"  Q:$D(DTOUT)!($D(DUOUT)) "^"  S LEXSO=$P($G(Y),"^",2) S X="" I +Y>0,$L(LEXSO) D
"RTN","LEXQCPA",26,0)
 . S LEXVDT=$G(LEXCDT) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S X=Y,LEXDTXT=$P($G(Y(0)),"^",2),LEXCP=$$CPT^ICPTCOD(LEXSO,LEXVDT)
"RTN","LEXQCPA",27,0)
 . S:$L($G(LEXDTXT)) LEXDTXT=LEXDTXT_" (Text not Versioned)" S LEXVTXT=$P(LEXCP,"^",3) S:'$L(LEXVTXT) LEXVTXT=LEXDTXT
"RTN","LEXQCPA",28,0)
 . S X=+Y_"^"_LEXSO S:$L(LEXVTXT) X=X_"^"_LEXVTXT
"RTN","LEXQCPA",29,0)
 S X=$$UP^XLFSTR(X) Q:'$L(X) "^"
"RTN","LEXQCPA",30,0)
 Q X
"RTN","LEXQCPA",31,0)
INC(X) ; Include CPT Modifiers
"RTN","LEXQCPA",32,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQCPA","INC",+($G(DUZ)),"Include Modifiers") S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQCPA",33,0)
 S DIR(0)="YAO",DIR("A")=" Include CPT Modifiers?  (Y/N)  " S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQCPA",34,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D INCH^LEXQCPA"
"RTN","LEXQCPA",35,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQCPA",36,0)
 D:$L(DIRB) SAV^LEXQD("LEXQCPA","INC",+($G(DUZ)),"Include Modifiers",$G(DIRB)) S X=+Y
"RTN","LEXQCPA",37,0)
 Q X
"RTN","LEXQCPA",38,0)
INCH ;   Include Help
"RTN","LEXQCPA",39,0)
 I $L($P($G(LEXCPT),"^",2)),$G(LEXCDT)?7N D  Q
"RTN","LEXQCPA",40,0)
 . W !,?5,"Answer 'Yes' to include active CPT Modifiers that are appropriate for"
"RTN","LEXQCPA",41,0)
 . W !,?5,"CPT code ",$P($G(LEXCPT),"^",2)," on ",$$SD($G(LEXCDT))
"RTN","LEXQCPA",42,0)
 W !,?5,"Answer 'Yes' to include active CPT Modifiers that are appropriate"
"RTN","LEXQCPA",43,0)
 W !,?5,"for the CPT code, 'No' to exclude CPT Modifiers from the display"
"RTN","LEXQCPA",44,0)
 Q
"RTN","LEXQCPA",45,0)
SD(X) ; Short Date
"RTN","LEXQCPA",46,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQCPA",47,0)
CLR ; Clear
"RTN","LEXQCPA",48,0)
 N LEXCDT,LEXCPT,LEXEXIT
"RTN","LEXQCPA",49,0)
 Q
"RTN","LEXQD")
0^5^B9797548^n/a
"RTN","LEXQD",1,0)
LEXQD ;ISL/KER - Query - Defaults ;10/30/2008
"RTN","LEXQD",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQD",3,0)
 ;               
"RTN","LEXQD",4,0)
 ; Global Variables
"RTN","LEXQD",5,0)
 ;    ^%ZOSF("TEST")      ICR  10096
"RTN","LEXQD",6,0)
 ;    ^XTMP(              SACC 2.3.2.5.2
"RTN","LEXQD",7,0)
 ;               
"RTN","LEXQD",8,0)
 ; External References
"RTN","LEXQD",9,0)
 ;    ^DIM                ICR  10016
"RTN","LEXQD",10,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXQD",11,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQD",12,0)
 ;    $$FMADD^XLFDT       ICR  10103
"RTN","LEXQD",13,0)
 ;               
"RTN","LEXQD",14,0)
 ; Save/Retrieve Defaults
"RTN","LEXQD",15,0)
 ;               
"RTN","LEXQD",16,0)
 ;    X       Routine Name
"RTN","LEXQD",17,0)
 ;    Y       Routine Tag
"RTN","LEXQD",18,0)
 ;    LEXN    Number (DUZ)
"RTN","LEXQD",19,0)
 ;    LEXC    Comment
"RTN","LEXQD",20,0)
 ;    LEXV    Value (default to save)
"RTN","LEXQD",21,0)
 ;    LEXRTN  Routine Name (X)
"RTN","LEXQD",22,0)
 ;    LEXTAG  Routine Tag (Y)
"RTN","LEXQD",23,0)
 ;    LEXKEY  $E(COM,1,13)
"RTN","LEXQD",24,0)
 ;    LEXID   LEXRTN_LEXN_LEXKEY
"RTN","LEXQD",25,0)
 ;    
"RTN","LEXQD",26,0)
 ;    ^XTMP(LEXID,0)=FUTURE DATE^TODAY'S DATE^LEXC
"RTN","LEXQD",27,0)
 ;    ^XTMP(LEXID,LEXTAG)=LEXV
"RTN","LEXQD",28,0)
 ;               
"RTN","LEXQD",29,0)
SAV(X,Y,LEXN,LEXC,LEXV) ; Save Defaults
"RTN","LEXQD",30,0)
 N LEXRTN,LEXTAG,LEXUSR,LEXCOM,LEXVAL,LEXNM,LEXID,LEXTD,LEXFD,LEXKEY S LEXRTN=$G(X) Q:+($$ROK(LEXRTN))'>0  S LEXTAG=$G(Y) Q:+($$TAG((LEXTAG_"^"_LEXRTN)))'>0
"RTN","LEXQD",31,0)
 S LEXUSR=+($G(LEXN)),LEXVAL=$G(LEXV) Q:LEXUSR'>0  Q:'$L(LEXVAL)  S LEXCOM=$G(LEXC) Q:'$L(LEXCOM)  S LEXKEY=$E(LEXCOM,1,13) F  Q:$L(LEXKEY)>12  S LEXKEY=LEXKEY_" "
"RTN","LEXQD",32,0)
 S LEXNM=$$GET1^DIQ(200,(LEXUSR_","),.01) Q:'$L(LEXNM)  S LEXTD=$$DT^XLFDT,LEXFD=$$FMADD^XLFDT(LEXTD,30),LEXID=LEXRTN_" "_LEXUSR_" "_LEXKEY
"RTN","LEXQD",33,0)
 S ^XTMP(LEXID,0)=LEXFD_"^"_LEXTD_"^"_LEXCOM,^XTMP(LEXID,LEXTAG)=LEXVAL
"RTN","LEXQD",34,0)
 Q
"RTN","LEXQD",35,0)
RET(X,Y,LEXN,LEXC) ; Retrieve Defaults
"RTN","LEXQD",36,0)
 N LEXRTN,LEXTAG,LEXUSR,LEXCOM,LEXNM,LEXID,LEXTD,LEXFD,LEXKEY S LEXRTN=$G(X) Q:+($$ROK(LEXRTN))'>0 ""
"RTN","LEXQD",37,0)
 S LEXTAG=$G(Y) Q:+($$TAG((LEXTAG_"^"_LEXRTN)))'>0 ""  S LEXUSR=+($G(LEXN)) Q:LEXUSR'>0 ""
"RTN","LEXQD",38,0)
 S LEXCOM=$G(LEXC) Q:'$L(LEXCOM) ""  S LEXKEY=$E(LEXCOM,1,13) F  Q:$L(LEXKEY)>12  S LEXKEY=LEXKEY_" "
"RTN","LEXQD",39,0)
 S LEXNM=$$GET1^DIQ(200,(LEXUSR_","),.01) Q:'$L(LEXNM) ""  S LEXTD=$$DT^XLFDT,LEXFD=$$FMADD^XLFDT(LEXTD,30),LEXID=LEXRTN_" "_LEXUSR_" "_LEXKEY
"RTN","LEXQD",40,0)
 S X=$G(^XTMP(LEXID,LEXTAG))
"RTN","LEXQD",41,0)
 Q X
"RTN","LEXQD",42,0)
 ;               
"RTN","LEXQD",43,0)
 ; Miscellaneous
"RTN","LEXQD",44,0)
PUR ;   Purge Defaults
"RTN","LEXQD",45,0)
 N LEXID S LEXID="LEXP~" F  S LEXID=$O(^XTMP(LEXID)) Q:'$L(LEXID)  Q:$E(LEXID,1,4)'="LEXQ"  K:$E(LEXID,1,4)="LEXQ" ^XTMP(LEXID)
"RTN","LEXQD",46,0)
 Q
"RTN","LEXQD",47,0)
SDF ;   Show Defaults
"RTN","LEXQD",48,0)
 N LEXN,LEXC S LEXN="^XTMP(""LEXQ"")",LEXC="^XTMP(""LEXQ" F  S LEXN=$Q(@LEXN) Q:'$L(LEXN)!(LEXN'[LEXC)  W !,LEXN,"=",@LEXN
"RTN","LEXQD",49,0)
 Q
"RTN","LEXQD",50,0)
ROK(X) ;   Routine OK
"RTN","LEXQD",51,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1  Q 0
"RTN","LEXQD",52,0)
TAG(X) ;   Sub-Routine OK
"RTN","LEXQD",53,0)
 N LEXT,LEXE,LEXL S X=$G(X) Q:'$L(X) 0  Q:X'["^" 0
"RTN","LEXQD",54,0)
 Q:'$L($P(X,"^",1)) 0  Q:$L($P(X,"^",1))>8 0  Q:$E($P(X,"^",1),1)'?1U 0
"RTN","LEXQD",55,0)
 Q:'$L($P(X,"^",2)) 0  Q:$L($P(X,"^",2))>8 0  Q:$E($P(X,"^",2),1)'?1U 0
"RTN","LEXQD",56,0)
 S LEXL=0,LEXT=X,(LEXE,X)="S LEXL=$L($T("_X_"))" D ^DIM X:$D(X) LEXE
"RTN","LEXQD",57,0)
 S X=$S(LEXL>0:1,1:0)
"RTN","LEXQD",58,0)
 Q X
"RTN","LEXQH")
0^25^B19745844^n/a
"RTN","LEXQH",1,0)
LEXQH ;ISL/KER - Query History - Main ;10/30/2008
"RTN","LEXQH",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQH",3,0)
 ;;
"RTN","LEXQH",4,0)
 ;               
"RTN","LEXQH",5,0)
 ; Global Variables
"RTN","LEXQH",6,0)
 ;    ^TMP("LEXQH")       SACC 2.3.2.5.1
"RTN","LEXQH",7,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQH",8,0)
 ;    ^TMP("LEXQHLA")     SACC 2.3.2.5.1
"RTN","LEXQH",9,0)
 ;    ^TMP("LEXQHO")      SACC 2.3.2.5.1
"RTN","LEXQH",10,0)
 ;               
"RTN","LEXQH",11,0)
 ; External References
"RTN","LEXQH",12,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXQH",13,0)
 ;    ^DIM                ICR  10016
"RTN","LEXQH",14,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXQH",15,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQH",16,0)
 ;               
"RTN","LEXQH",17,0)
EN ; Main Entry Point
"RTN","LEXQH",18,0)
 N DIR,DIRB,DIROUT,DIRUT,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,DTOUT,DUOUT,LEX,LEX1,LEX2,LEX3,LEXACT,LEXAT,LEXATD,LEXB,LEXC,LEXC1,LEXC2,LEXCMD
"RTN","LEXQH",19,0)
 N LEXCODE,LEXCOM,LEXCT,LEXCTY,LEXD,LEXDC,LEXDG,LEXDI,LEXDISP,LEXDR,LEXDRG,LEXDS,LEXDT,LEXE,LEXEC,LEXEF,LEXEIEN,LEXENT,LEXEX,LEXFD,LEXEXIT,LEXFI
"RTN","LEXQH",20,0)
 N LEXFILE,LEXFIRST,LEXG,LEXH,LEXHD,LEXHDR,LEXI,LEXIA,LEXIAD,LEXICT,LEXID,LEXIEN,LEXIN,LEXIT,LEXIX,LEXKEY,LEXL,LEXL1,LEXL2,LEXL3,LEXLAST,LEXLEN
"RTN","LEXQH",21,0)
 N LEXM,LEXMAX,LEXMC,LEXMCI,LEXMCT,LEXMD,LEXMDG,LEXMDRG,LEXMOD,LEXMS,LEXN,LEXN1,LEXN2,LEXN3,LEXNAME,LEXNC,LEXNM,LEXNMD,LEXNN,LEXNODE,LEXO,LEXO1
"RTN","LEXQH",22,0)
 N LEXO2,LEXO3,LEXOC,LEXOMD,LEXP,LEXRAN,LEXROOT,LEXRTN,LEXS,LEXSAB,LEXSEL,LEXSIEN,LEXSO,LEXSS,LEXSTR,LEXT,LEXT1,LEXT2,LEXT3,LEXTAG,LEXTD,LEXTN
"RTN","LEXQH",23,0)
 N LEXTOT,LEXTQ,LEXTS,LEXTTT,LEXTY,LEXTYPE,LEXUN,LEXUND,LEXUSR,LEXV,LEXVAL,LEXVDT,LEXVT,LEXX,X,Y
"RTN","LEXQH",24,0)
 K ^TMP("LEXQH",$J),^TMP("LEXQHL",$J),^TMP("LEXQHLA"),^TMP("LEXQHO",$J)
"RTN","LEXQH",25,0)
 S LEXEXIT=0,LEXTD=$$DT^XLFDT W ! S LEXSO=$$SO^LEXQL K ^TMP("LEXQH",$J) I +LEXEXIT>0!('$L(LEXSO)) W !!,?4,"Code not selected" G ABT
"RTN","LEXQH",26,0)
 S LEXIEN=+LEXSO,LEXCODE=$P(LEXSO,U,4),LEXNAME=$P(LEXSO,U,5),LEXFILE=$P(LEXSO,U,3),LEXTYPE=$$TY(LEXFILE),LEXROOT=$P(LEXSO,U,2)
"RTN","LEXQH",27,0)
 I '$L(LEXCODE)!('$L(LEXFILE))!('$L(LEXNAME))!('$L(LEXIEN))!('$L(LEXTYPE))!('$L(LEXROOT))!(+LEXIEN'>0) W !!,?4,"Valid Code not selected" G ABT
"RTN","LEXQH",28,0)
 S LEXROOT="^"_LEXROOT S LEXNODE=@(LEXROOT_LEXIEN_",0)") I '$L(LEXNODE) W !!,?4,"Record for code not found" G ABT
"RTN","LEXQH",29,0)
 S LEXDISP=$$DIS^LEXQHA I +($G(LEXEXIT))>0!("^CH^SB^"'[("^"_LEXDISP_"^")) W !!,?4,"Display not selected" G ABT
"RTN","LEXQH",30,0)
 S (LEXTAG,LEXRTN,LEXENT)="" S:LEXFILE=80 LEXENT="D EN^LEXQHL1("_+LEXIEN_",$G(LEXDISP))" S:LEXFILE=80.1 LEXENT="D EN^LEXQHL2("_+LEXIEN_",$G(LEXDISP))"
"RTN","LEXQH",31,0)
 S:LEXFILE=81 LEXENT="D EN^LEXQHL3("_+LEXIEN_",$G(LEXDISP))" S LEXEXIT=0
"RTN","LEXQH",32,0)
 S:LEXFILE=81.3 LEXENT="D EN^LEXQHL4("_+LEXIEN_",$G(LEXDISP),$G(LEXRAN))",LEXRAN=$$RAN^LEXQHA
"RTN","LEXQH",33,0)
 I +($G(LEXEXIT))>0!(LEXFILE=81.3&($G(LEXRAN)["^")) W !!,?4,"Range not selected" G ABT
"RTN","LEXQH",34,0)
 S LEXT=$S(LEXDISP="CH":"Chronological ",LEXDISP="SB":"Subjective ",1:"")
"RTN","LEXQH",35,0)
 S LEXT=LEXT_"Display of "_LEXTYPE_" "_LEXCODE
"RTN","LEXQH",36,0)
 S:$L(LEXNAME) LEXT=LEXT_", """_LEXNAME
"RTN","LEXQH",37,0)
 S:$L(LEXNAME)&((LEXFILE'=81.3)!(LEXFILE=81.3&(+($G(LEXRAN))'>0))) LEXT=LEXT_""""
"RTN","LEXQH",38,0)
 S:$L(LEXNAME)&(LEXFILE=81.3&(+($G(LEXRAN))>0)) LEXT=LEXT_","""
"RTN","LEXQH",39,0)
 S:LEXFILE=81.3&(+($G(LEXRAN))>0) LEXT=LEXT_" with CPT Code Ranges"
"RTN","LEXQH",40,0)
 W !!,?2,"Display a ",$S(LEXDISP="CH":"Chronological ",LEXDISP="SB":"Subjective ",1:""),"History of ",LEXTYPE," ",LEXCODE
"RTN","LEXQH",41,0)
 W !,?4,LEXNAME W:LEXFILE=81.3&(+($G(LEXRAN))>0) !,?6,"with CPT Code Ranges" W !
"RTN","LEXQH",42,0)
 S LEXTAG=$P(LEXENT,U,1) S:LEXTAG[" " LEXTAG=$P(LEXTAG," ",2) S LEXRTN=$P(LEXENT,U,2) S:LEXRTN["(" LEXRTN=$P(LEXRTN,"(",1)
"RTN","LEXQH",43,0)
 K ^TMP("LEXQHO",$J) S X=LEXENT D ^DIM S:'$D(X) LEXEXIT=1
"RTN","LEXQH",44,0)
 I +($$TAG^LEXQD((LEXTAG_"^"_LEXRTN)))'>0!(+($G(LEXEXIT))>0) W !!,?4,"Invalid Code or Display selected" G ABT
"RTN","LEXQH",45,0)
 X LEXENT I '$D(^TMP("LEXQHO",$J)) W !!,?4,"No history to display" G ABT
"RTN","LEXQH",46,0)
 D:$D(^TMP("LEXQHO",$J)) DSP^LEXQO("LEXQHO") K ^TMP("LEXQH",$J),^TMP("LEXQHL",$J),^TMP("LEXQHLA",$J)
"RTN","LEXQH",47,0)
 Q
"RTN","LEXQH",48,0)
ABT ;   Abort
"RTN","LEXQH",49,0)
 K ^TMP("LEXQH",$J),^TMP("LEXQHL",$J),^TMP("LEXQHLA",$J),^TMP("LEXQHO",$J)
"RTN","LEXQH",50,0)
 Q
"RTN","LEXQH",51,0)
TY(X) ;   Code Type
"RTN","LEXQH",52,0)
 Q:+($G(X))=80 "ICD Diagnostic Code"
"RTN","LEXQH",53,0)
 Q:+($G(X))=80.1 "ICD Procedural Code"
"RTN","LEXQH",54,0)
 Q:+($G(X))=81 "CPT/HCPCS Procedural Code"
"RTN","LEXQH",55,0)
 Q:+($G(X))=81.3 "CPT Modifier Code"
"RTN","LEXQH",56,0)
 Q ""
"RTN","LEXQH",57,0)
EV(X) ;   Check environment
"RTN","LEXQH",58,0)
 N LEX S DT=$$DT^XLFDT D HOME^%ZIS S U="^" I +($G(DUZ))=0 W !!,?5,"DUZ not defined" Q 0
"RTN","LEXQH",59,0)
 S LEX=$$GET1^DIQ(200,(DUZ_","),.01) I '$L(LEX) W !!,?5,"DUZ not valid" Q 0
"RTN","LEXQH",60,0)
 Q 1
"RTN","LEXQHA")
0^32^B11807617^n/a
"RTN","LEXQHA",1,0)
LEXQHA ;ISL/KER - Query History - Ask ;10/30/2008
"RTN","LEXQHA",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHA",3,0)
 ;               
"RTN","LEXQHA",4,0)
 ; Global Variables
"RTN","LEXQHA",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQHA",6,0)
 ;               
"RTN","LEXQHA",7,0)
 ; External References
"RTN","LEXQHA",8,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQHA",9,0)
 ;               
"RTN","LEXQHA",10,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQHA",11,0)
 ;     LEXEXIT            Exit Flag
"RTN","LEXQHA",12,0)
 ;     LEXIEN             IEN for file 81.3
"RTN","LEXQHA",13,0)
 ;     LEXMOD             CPT Modifier
"RTN","LEXQHA",14,0)
 ;     LEXSO              Source
"RTN","LEXQHA",15,0)
 ;               
"RTN","LEXQHA",16,0)
 Q
"RTN","LEXQHA",17,0)
RAN(X) ; Include CPT Modifier Ranges
"RTN","LEXQHA",18,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQHA","RAN",+($G(DUZ)),"Modifier Ranges")
"RTN","LEXQHA",19,0)
 S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQHA",20,0)
 S DIR(0)="YAO",DIR("A")=" Include Modifier CPT Code Ranges?  (Y/N)  " S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQHA",21,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D RANH^LEXQHA"
"RTN","LEXQHA",22,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQHA",23,0)
 D:$L(DIRB) SAV^LEXQD("LEXQHA","RAN",+($G(DUZ)),"Modifier Ranges",$G(DIRB)) S X=+Y
"RTN","LEXQHA",24,0)
 Q X
"RTN","LEXQHA",25,0)
RANH ;   Include CPT Modifier Ranges Help
"RTN","LEXQHA",26,0)
 N LEXM S LEXM=$P($G(LEXMOD),U,2) S:'$L(LEXM)&($L($G(LEXSO))) LEXM=$P($G(LEXSO),U,4) S:'$L(LEXM)&($L($G(LEXSO))) LEXM=$G(LEXSO)
"RTN","LEXQHA",27,0)
 S:'$L(LEXM)&(+($G(LEXIEN))>0)&($D(^DIC(81.3,+($G(LEXIEN)),0))) LEXM=$P($G(^DIC(81.3,+($G(LEXIEN)),0)),U,1)
"RTN","LEXQHA",28,0)
 I $L($G(LEXM)) D  Q
"RTN","LEXQHA",29,0)
 . W !,?5,"Answer 'Yes' to include the CPT Code Ranges for for CPT"
"RTN","LEXQHA",30,0)
 . W !,?5,"Modifier code ",$G(LEXM),".  Answer 'No' to exlcude CPT Code Ranges"
"RTN","LEXQHA",31,0)
 . W !,?5,"from the display."
"RTN","LEXQHA",32,0)
 W !,?5,"Answer 'Yes' to include the CPT Code Ranges for the CPT"
"RTN","LEXQHA",33,0)
 W !,?5,"Modifier.  Answer 'No' to exclude CPT Code Ranges from the"
"RTN","LEXQHA",34,0)
 W !,?5,"display."
"RTN","LEXQHA",35,0)
 Q
"RTN","LEXQHA",36,0)
 ;     
"RTN","LEXQHA",37,0)
DIS(X) ; Display
"RTN","LEXQHA",38,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB S DIRB=$$RET^LEXQD("LEXQHA","DIS",+($G(DUZ)),"Display")
"RTN","LEXQHA",39,0)
 S:'$L(DIRB) DIRB="Yes"
"RTN","LEXQHA",40,0)
 S DIR(0)="SAO^C:Chronological History;S:Subjective History",DIR("A")=" Display Chronological or Subjective History?  (C/S)  "
"RTN","LEXQHA",41,0)
 S:"^CHRONOLOGICAL^SUBJECTIVE^Chronological^Subjective^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQHA",42,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D DISH^LEXQHA"
"RTN","LEXQHA",43,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^"
"RTN","LEXQHA",44,0)
 S DIRB=$S(Y="C":"Chronological",Y="S":"Subjective",X["^":"",1:"")
"RTN","LEXQHA",45,0)
 D:$L(DIRB) SAV^LEXQD("LEXQHA","DIS",+($G(DUZ)),"Display",$G(DIRB))
"RTN","LEXQHA",46,0)
 S X=$S(Y="C":"CH",Y="S":"SB",X["^":"",1:"")
"RTN","LEXQHA",47,0)
 Q X
"RTN","LEXQHA",48,0)
DISH ;   Display Help
"RTN","LEXQHA",49,0)
 W !,?5,"C = Chronological"
"RTN","LEXQHA",50,0)
 W ?25,"MM/DD/YYYY     Event",!
"RTN","LEXQHA",51,0)
 W ?25,"               Data",!
"RTN","LEXQHA",52,0)
 W ?25,"MM/DD/YYYY     Event",!
"RTN","LEXQHA",53,0)
 W ?25,"               Data",!
"RTN","LEXQHA",54,0)
 W !,?5,"S = Subjective"
"RTN","LEXQHA",55,0)
 W ?25,"Event",!
"RTN","LEXQHA",56,0)
 W ?25,"  MM/DD/YYYY   Data",!
"RTN","LEXQHA",57,0)
 W ?25,"  MM/DD/YYYY   Data"
"RTN","LEXQHA",58,0)
 Q
"RTN","LEXQHA",59,0)
 ;
"RTN","LEXQHA",60,0)
 ; Miscellaneous
"RTN","LEXQHA",61,0)
CL ;   Clear
"RTN","LEXQHA",62,0)
 K LEXEXIT,LEXIEN,LEXMOD,LEXSO
"RTN","LEXQHA",63,0)
 Q
"RTN","LEXQHL1")
0^26^B94982465^n/a
"RTN","LEXQHL1",1,0)
LEXQHL1 ;ISL/KER - Query History - ICD Dx Extract ;10/30/2008
"RTN","LEXQHL1",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHL1",3,0)
 ;;
"RTN","LEXQHL1",4,0)
 ;               
"RTN","LEXQHL1",5,0)
 ; Global Variables
"RTN","LEXQHL1",6,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQHL1",7,0)
 ;    ^ICM(               ICR   4488
"RTN","LEXQHL1",8,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQHL1",9,0)
 ;               
"RTN","LEXQHL1",10,0)
 ; External References
"RTN","LEXQHL1",11,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQHL1",12,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQHL1",13,0)
 ;               
"RTN","LEXQHL1",14,0)
 Q
"RTN","LEXQHL1",15,0)
EN(X,Y) ; ICD Diagnosis File
"RTN","LEXQHL1",16,0)
 N LEXIEN,LEXDISP,LEXIA,LEXEF,LEXCT,LEXC S LEXIEN=$G(X),LEXDISP=$G(Y),LEXIA="" Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,0))  S LEXC=$P($G(^ICD9(+LEXIEN,0)),U,1)
"RTN","LEXQHL1",17,0)
 K ^TMP("LEXQHL",$J) S ^TMP("LEXQHL",$J,"IEN")=LEXIEN,^TMP("LEXQHL",$J,"CODE")=LEXC,^TMP("LEXQHL",$J,"NAME")=$P($$ICDDX^ICDCODE(LEXC),U,4)
"RTN","LEXQHL1",18,0)
 S:'$L(LEXDISP) LEXDISP="SB" D ST,DX,DS,ID^LEXQHL5(LEXC),DG,MC,CC D:$L($G(LEXDISP)) DP K ^TMP("LEXQHL",$J)
"RTN","LEXQHL1",19,0)
 Q
"RTN","LEXQHL1",20,0)
ST ;   1  Status
"RTN","LEXQHL1",21,0)
 N LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXMS,LEXN,LEXS,LEXT
"RTN","LEXQHL1",22,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,66,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",23,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,66,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",24,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEXMS S LEXN=$G(^ICD9(+LEXIEN,66,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL1",25,0)
 . . Q:+LEXS'>0&(LEXCT'>0)  S LEXCT=LEXCT+1,LEXMS=$$MS^LEXQHLM(LEXE,0),LEXT=$S(+LEXS>0:"Activation",1:"Inactivation")
"RTN","LEXQHL1",26,0)
 . . S:+LEXS>0&(LEXCT=1) LEXT="Initial Activation"_LEXMS,LEXIA=LEXE
"RTN","LEXQHL1",27,0)
 . . S:$O(^ICD9(+LEXIEN,66,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final status change)"
"RTN","LEXQHL1",28,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,1,1)=LEXD_U_LEXT
"RTN","LEXQHL1",29,0)
 Q
"RTN","LEXQHL1",30,0)
DX ;   2  Diagnosis
"RTN","LEXQHL1",31,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL1",32,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,67,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",33,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,67,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",34,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD9(+LEXIEN,67,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($P(LEXN,U,2))
"RTN","LEXQHL1",35,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL1",36,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Diagnosis",+LEXCT>1:"Updated Diagnosis",1:"Diagnosis")
"RTN","LEXQHL1",37,0)
 . . S:$O(^ICD9(+LEXIEN,67,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final diagnosis change)"
"RTN","LEXQHL1",38,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,2,1)=LEXD_U_LEXS
"RTN","LEXQHL1",39,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",40,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,2," "),-1)+1
"RTN","LEXQHL1",41,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,2,LEXC)=U_LEXT
"RTN","LEXQHL1",42,0)
 Q
"RTN","LEXQHL1",43,0)
DS ;   3  Description
"RTN","LEXQHL1",44,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL1",45,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,68,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",46,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,68,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",47,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD9(+LEXIEN,68,+LEXH,0))
"RTN","LEXQHL1",48,0)
 . . S LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($G(^ICD9(+LEXIEN,68,+LEXH,1)))
"RTN","LEXQHL1",49,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL1",50,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Description",+LEXCT>1:"Updated Description",1:"Description")
"RTN","LEXQHL1",51,0)
 . . S:$O(^ICD9(+LEXIEN,68,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final description change)"
"RTN","LEXQHL1",52,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,3,1)=LEXD_U_LEXS
"RTN","LEXQHL1",53,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",54,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,3," "),-1)+1
"RTN","LEXQHL1",55,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,3,LEXC)=U_LEXT
"RTN","LEXQHL1",56,0)
 Q
"RTN","LEXQHL1",57,0)
DG ;   5  DRG Groups
"RTN","LEXQHL1",58,0)
 N LEX,LEXCT,LEXD,LEXDI,LEXDR,LEXDRG,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT,LEXUN,LEXUND
"RTN","LEXQHL1",59,0)
 S LEXUND="",LEXUN=1,LEXN=$G(^ICD9(+LEXIEN,"DRG")) F LEXI=1:1:6 D
"RTN","LEXQHL1",60,0)
 . N LEXD S LEXD=$P(LEXN,U,LEXI) S:$L(LEXD) LEXUND=LEXUND_", "_LEXD
"RTN","LEXQHL1",61,0)
 S LEXUND=$$CS^LEXQHLM(LEXUND),LEXUND=$$AND^LEXQHLM(LEXUND) S:$L(LEXUND) LEXUND="DRG "_LEXUND
"RTN","LEXQHL1",62,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,3,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",63,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,3,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",64,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD9(+LEXIEN,3,+LEXH,0))
"RTN","LEXQHL1",65,0)
 . . S LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($G(^ICD9(+LEXIEN,3,+LEXH,1)))
"RTN","LEXQHL1",66,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63) S:LEXE=$G(LEXIA) LEXUN=0
"RTN","LEXQHL1",67,0)
 . . S LEXS=$S(+LEXCT=1&(LEXE'=$G(LEXIA)):"Initial Versioned DRG Groups",+LEXCT=1&(LEXE=$G(LEXIA)):"Initial DRG Groups",+LEXCT>1:"Updated DRG Groups",1:"DRG Groups")
"RTN","LEXQHL1",68,0)
 . . S:$O(^ICD9(+LEXIEN,3,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final DRG change)"
"RTN","LEXQHL1",69,0)
 . . N LEXDRG,LEXDR,LEXDI
"RTN","LEXQHL1",70,0)
 . . S LEXDRG="",LEXDR="" F  S LEXDR=$O(^ICD9(+LEXIEN,3,+LEXH,1,"B",LEXDR)) Q:'$L(LEXDR)  D
"RTN","LEXQHL1",71,0)
 . . . S LEXDI=0 F  S LEXDI=$O(^ICD9(+LEXIEN,3,+LEXH,1,"B",LEXDR,LEXDI)) Q:+LEXDI'>0  D
"RTN","LEXQHL1",72,0)
 . . . . N LEXN,LEXD S LEXN=+($G(^ICD9(+LEXIEN,3,+LEXH,1,+LEXDI,0)))
"RTN","LEXQHL1",73,0)
 . . . . S LEXDRG=LEXDRG_", "_LEXN S:$E(LEXDRG,1,2)=", " LEXDRG=$E(LEXDRG,3,$L(LEXDRG))
"RTN","LEXQHL1",74,0)
 . . S LEXDRG=$$CS^LEXQHLM(LEXDRG),LEXDRG=$$AND^LEXQHLM(LEXDRG) S:$L(LEXDRG) LEXDRG="DRG "_LEXDRG Q:'$L(LEXDRG)
"RTN","LEXQHL1",75,0)
 . . K LEX S LEX(1)=LEXDRG D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL1",76,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,5,1)=LEXD_U_LEXS
"RTN","LEXQHL1",77,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",78,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,5," "),-1)+1
"RTN","LEXQHL1",79,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,5,LEXC)=U_LEXT
"RTN","LEXQHL1",80,0)
 I +($G(LEXUN))>0,$L($G(LEXUND)),+($G(LEXIA))?7N D
"RTN","LEXQHL1",81,0)
 . N LEXI,LEXD,LEXS,LEX S LEXD=$$SD^LEXQHLM(+($G(LEXIA))),LEXS="Initial Unversioned DRG Groups"
"RTN","LEXQHL1",82,0)
 . K LEX S LEX(1)=LEXUND D PR^LEXQHLM(.LEX,63) S ^TMP("LEXQHL",$J,LEXIA,5,1)=LEXD_U_LEXS
"RTN","LEXQHL1",83,0)
 . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",84,0)
 . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXIA,5," "),-1)+1
"RTN","LEXQHL1",85,0)
 . . S ^TMP("LEXQHL",$J,LEXIA,5,LEXC)=U_LEXT
"RTN","LEXQHL1",86,0)
 Q
"RTN","LEXQHL1",87,0)
MC ;   6  Major Diagnostic Category
"RTN","LEXQHL1",88,0)
 N LEX,LEXB,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXM,LEXN,LEXS,LEXT,LEXUN,LEXUND
"RTN","LEXQHL1",89,0)
 S LEXUND=$P($G(^ICD9(+LEXIEN,0)),U,5),LEXUND=$$UP^XLFSTR($P($G(^ICM(+LEXUND,0)),U,1)),LEXUN=1
"RTN","LEXQHL1",90,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,4,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",91,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,4,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",92,0)
 . . N LEXB,LEXN,LEXS,LEXE,LEXT,LEXD,LEXM S LEXN=$G(^ICD9(+LEXIEN,4,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL1",93,0)
 . . S LEXM=$$UP^XLFSTR($P($G(^ICM(+LEXS,0)),U,1)) Q:'$L(LEXM)  Q:+LEXS'>0&(LEXCT'>0)  S LEXCT=LEXCT+1
"RTN","LEXQHL1",94,0)
 . . S:LEXE=$G(LEXIA) LEXUN=0
"RTN","LEXQHL1",95,0)
 . . S LEXT=$S(+LEXCT=1&(LEXE'=$G(LEXIA)):"Initial Versioned Major Diagnostic Category",+LEXCT=1&(LEXE=$G(LEXIA)):"Initial Major Diagnostic Category",+LEXCT>1:"Updated Major Diagnostic Category",1:"Major Diagnostic Category")
"RTN","LEXQHL1",96,0)
 . . S:$O(^ICD9(+LEXIEN,4,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final category change)"
"RTN","LEXQHL1",97,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,6,1)=LEXD_U_LEXT
"RTN","LEXQHL1",98,0)
 . .  S ^TMP("LEXQHL",$J,LEXEF,6,2)=U_LEXM
"RTN","LEXQHL1",99,0)
 I +($G(LEXUN))>0,$L($G(LEXUND)),+($G(LEXIA))?7N D
"RTN","LEXQHL1",100,0)
 . N LEXI,LEXD,LEXS,LEX S LEXD=$$SD^LEXQHLM(+($G(LEXIA))),LEXS="Initial Unversioned Major Diagnostic Category"
"RTN","LEXQHL1",101,0)
 . K LEX S LEX(1)=LEXUND D PR^LEXQHLM(.LEX,63) S ^TMP("LEXQHL",$J,LEXIA,6,1)=LEXD_U_LEXS
"RTN","LEXQHL1",102,0)
 . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",103,0)
 . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXIA,6," "),-1)+1
"RTN","LEXQHL1",104,0)
 . . S ^TMP("LEXQHL",$J,LEXIA,6,LEXC)=U_LEXT
"RTN","LEXQHL1",105,0)
 Q
"RTN","LEXQHL1",106,0)
CC ;   7  Complication/Comorbidity
"RTN","LEXQHL1",107,0)
 N LEX,LEXB,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXM,LEXN,LEXS,LEXT,LEXUN,LEXUND
"RTN","LEXQHL1",108,0)
 S LEXUND=$P($G(^ICD9(+LEXIEN,0)),U,7),LEXUND=$S(LEXUND=1:"COMPLICATION/COMORBIDITY",1:""),LEXUN=1
"RTN","LEXQHL1",109,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD9(+LEXIEN,69,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL1",110,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD9(+LEXIEN,69,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL1",111,0)
 . . N LEXB,LEXN,LEXS,LEXE,LEXT,LEXD,LEXM S LEXN=$G(^ICD9(+LEXIEN,69,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL1",112,0)
 . . S LEXM=$S(LEXS=1:"COMPLICATION/COMORBIDITY",LEXS=2:"MAJOR COMPLICATION/COMORBIDITY",LEXS="0":"NON-COMPLICATION/COMORBIDITY",1:"") Q:'$L(LEXM)
"RTN","LEXQHL1",113,0)
 . . Q:'$L(LEXS)&(LEXCT'>0)  S LEXCT=LEXCT+1
"RTN","LEXQHL1",114,0)
 . . S:LEXE=$G(LEXIA) LEXUN=0
"RTN","LEXQHL1",115,0)
 . . S LEXT=$S(+LEXCT=1&(LEXE'=$G(LEXIA)):"Initial Versioned Complication/Comorbidity",+LEXCT=1&(LEXE=$G(LEXIA)):"Initial Complication/Comorbidity",+LEXCT>1:"Updated Complication/Comorbidity",1:"Complication/Comorbidity")
"RTN","LEXQHL1",116,0)
 . . S:$O(^ICD9(+LEXIEN,69,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final CC change)"
"RTN","LEXQHL1",117,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,7,1)=LEXD_U_LEXT
"RTN","LEXQHL1",118,0)
 . .  S ^TMP("LEXQHL",$J,LEXEF,7,2)=U_LEXM
"RTN","LEXQHL1",119,0)
 I +($G(LEXUN))>0,$L($G(LEXUND)),+($G(LEXIA))?7N D
"RTN","LEXQHL1",120,0)
 . N LEXI,LEXD,LEXS,LEX S LEXD=$$SD^LEXQHLM(+($G(LEXIA))),LEXS="Initial Unversioned Complication/Comorbidity"
"RTN","LEXQHL1",121,0)
 . K LEX S LEX(1)=LEXUND D PR^LEXQHLM(.LEX,63) S ^TMP("LEXQHL",$J,LEXIA,7,1)=LEXD_U_LEXS
"RTN","LEXQHL1",122,0)
 . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL1",123,0)
 . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXIA,7," "),-1)+1
"RTN","LEXQHL1",124,0)
 . . S ^TMP("LEXQHL",$J,LEXIA,7,LEXC)=U_LEXT
"RTN","LEXQHL1",125,0)
 Q
"RTN","LEXQHL1",126,0)
 ; 
"RTN","LEXQHL1",127,0)
DP ; Display
"RTN","LEXQHL1",128,0)
 S LEXDISP=$G(LEXDISP) Q:$L(LEXDISP)>8  Q:$L(LEXDISP)<2  Q:LEXDISP["^"  N LEXL S LEXL=$T(@LEXDISP+0) Q:'$L(LEXL)  D @LEXDISP
"RTN","LEXQHL1",129,0)
 Q
"RTN","LEXQHL1",130,0)
SB ;   Subjective
"RTN","LEXQHL1",131,0)
 N LEX1,LEX2,LEX3,LEXC,LEXCT,LEXE,LEXHDR,LEXI,LEXID,LEXN,LEXP,LEXS,LEXT
"RTN","LEXQHL1",132,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL1",133,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL1",134,0)
 F LEXID=1:1:7 D
"RTN","LEXQHL1",135,0)
 . N LEXHDR,LEXCT S LEXCT=0,LEXHDR=$$HD(LEXID) Q:'$L(LEXHDR)  S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL1",136,0)
 . . I LEXID=1 D  Q
"RTN","LEXQHL1",137,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,1)) Q:'$L(LEXN)  S LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2) Q:'$L(LEXE)  Q:'$L(LEXS)  S LEXCT=LEXCT+1
"RTN","LEXQHL1",138,0)
 . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) S LEXT=LEXE,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL1",139,0)
 . . N LEX2 S LEX2=0,LEXE="" F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL1",140,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) S:LEX2=1 LEXE=$P(LEXN,U,1) Q:LEX2=1  Q:'$L(LEXE)
"RTN","LEXQHL1",141,0)
 . . . I LEX2=2 D  Q
"RTN","LEXQHL1",142,0)
 . . . . S LEXCT=LEXCT+1,LEXT=$G(LEXE),LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="    "_LEXT
"RTN","LEXQHL1",143,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL1",144,0)
 . . . I LEX2>2 D  Q
"RTN","LEXQHL1",145,0)
 . . . . S LEXCT=LEXCT+1,LEXT="",LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="    "_LEXT
"RTN","LEXQHL1",146,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL1",147,0)
 Q
"RTN","LEXQHL1",148,0)
CH ;   Chronological
"RTN","LEXQHL1",149,0)
 N LEX1,LEX2,LEX3,LEXC,LEXD,LEXI,LEXN,LEXP,LEXS,LEXT
"RTN","LEXQHL1",150,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL1",151,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL1",152,0)
 S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL1",153,0)
 . D BL^LEXQHLM N LEX2 S LEX2=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL1",154,0)
 . . N LEX3 S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL1",155,0)
 . . . N LEXN,LEXD,LEXS S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)),LEXD=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL1",156,0)
 . . . S LEXT=$S(LEXD'=LEXP:LEXD,1:""),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_$S($L(LEXD):"- ",1:"  ")_LEXS S LEXT="   "_LEXT D TL^LEXQHLM(LEXT) S:LEXD'="" LEXP=LEXD
"RTN","LEXQHL1",157,0)
 Q
"RTN","LEXQHL1",158,0)
 ; 
"RTN","LEXQHL1",159,0)
 ; Miscellaneous
"RTN","LEXQHL1",160,0)
HD(X) ;   Header
"RTN","LEXQHL1",161,0)
 Q:+($G(X))=1 "Status"  Q:+($G(X))=2 "Diagnosis"  Q:+($G(X))=3 "Description"  Q:+($G(X))=4 "Lexicon Expression"  Q:+($G(X))=5 "DRG Groups"
"RTN","LEXQHL1",162,0)
 Q:+($G(X))=6 "Major Diagnostic Category"  Q:+($G(X))=7 "Complication/Comorbidity"
"RTN","LEXQHL1",163,0)
 Q ""
"RTN","LEXQHL2")
0^27^B92433013^n/a
"RTN","LEXQHL2",1,0)
LEXQHL2 ;ISL/KER - Query History - ICD Op Extract ;10/30/2008
"RTN","LEXQHL2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHL2",3,0)
 ;;
"RTN","LEXQHL2",4,0)
 ;               
"RTN","LEXQHL2",5,0)
 ; Global Variables
"RTN","LEXQHL2",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQHL2",7,0)
 ;    ^ICM(               ICR   4488
"RTN","LEXQHL2",8,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQHL2",9,0)
 ;               
"RTN","LEXQHL2",10,0)
 ; External References
"RTN","LEXQHL2",11,0)
 ;    $$ICDOP^ICDCODE     ICR   3990
"RTN","LEXQHL2",12,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQHL2",13,0)
 ;               
"RTN","LEXQHL2",14,0)
 Q
"RTN","LEXQHL2",15,0)
EN(X,Y) ; ICD Procedure File
"RTN","LEXQHL2",16,0)
 N LEXIEN,LEXDISP,LEXIA,LEXEF,LEXCT,LEXC S LEXIEN=$G(X),LEXDISP=$G(Y),LEXIA="" Q:+LEXIEN'>0  Q:'$D(^ICD0(+LEXIEN,0))  S LEXC=$P($G(^ICD0(+LEXIEN,0)),U,1)
"RTN","LEXQHL2",17,0)
 K ^TMP("LEXQHL",$J) S ^TMP("LEXQHL",$J,"IEN")=LEXIEN,^TMP("LEXQHL",$J,"CODE")=LEXC,^TMP("LEXQHL",$J,"NAME")=$P($$ICDOP^ICDCODE(LEXC),U,5)
"RTN","LEXQHL2",18,0)
 S:'$L(LEXDISP) LEXDISP="SB" D ST,OP,DS,MD D:$L($G(LEXDISP)) DP K ^TMP("LEXQHL",$J)
"RTN","LEXQHL2",19,0)
 Q
"RTN","LEXQHL2",20,0)
ST ;   1  Status
"RTN","LEXQHL2",21,0)
 N LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXMS,LEXN,LEXS,LEXT
"RTN","LEXQHL2",22,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD0(+LEXIEN,66,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",23,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL2",24,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEXMS S LEXN=$G(^ICD0(+LEXIEN,66,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL2",25,0)
 . . Q:+LEXS'>0&(LEXCT'>0)  S LEXCT=LEXCT+1,LEXMS=$$MS^LEXQHLM(LEXE,0),LEXT=$S(+LEXS>0:"Activation",1:"Inactivation")
"RTN","LEXQHL2",26,0)
 . . S:+LEXS>0&(LEXCT=1) LEXT="Initial Activation"_LEXMS,LEXIA=LEXE
"RTN","LEXQHL2",27,0)
 . . S:$O(^ICD0(+LEXIEN,66,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final status change)"
"RTN","LEXQHL2",28,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,1,1)=LEXD_U_LEXT
"RTN","LEXQHL2",29,0)
 Q
"RTN","LEXQHL2",30,0)
OP ;   2  Operation/Procedure
"RTN","LEXQHL2",31,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL2",32,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD0(+LEXIEN,67,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",33,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,67,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL2",34,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD0(+LEXIEN,67,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($P(LEXN,U,2))
"RTN","LEXQHL2",35,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL2",36,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Operation/Procedure",+LEXCT>1:"Updated Operation/Procedure",1:"Operation/Procedure")
"RTN","LEXQHL2",37,0)
 . . S:$O(^ICD0(+LEXIEN,67,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final operation/procedure change)"
"RTN","LEXQHL2",38,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,2,1)=LEXD_U_LEXS
"RTN","LEXQHL2",39,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL2",40,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,2," "),-1)+1
"RTN","LEXQHL2",41,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,2,LEXC)=U_LEXT
"RTN","LEXQHL2",42,0)
 Q
"RTN","LEXQHL2",43,0)
DS ;   3  Description
"RTN","LEXQHL2",44,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL2",45,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICD0(+LEXIEN,68,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",46,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,68,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL2",47,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD0(+LEXIEN,68,+LEXH,0))
"RTN","LEXQHL2",48,0)
 . . S LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($G(^ICD0(+LEXIEN,68,+LEXH,1)))
"RTN","LEXQHL2",49,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL2",50,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Description",+LEXCT>1:"Updated Description",1:"Description")
"RTN","LEXQHL2",51,0)
 . . S:$O(^ICD0(+LEXIEN,68,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final description change)"
"RTN","LEXQHL2",52,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,3,1)=LEXD_U_LEXS
"RTN","LEXQHL2",53,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL2",54,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,3," "),-1)+1
"RTN","LEXQHL2",55,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,3,LEXC)=U_LEXT
"RTN","LEXQHL2",56,0)
 Q
"RTN","LEXQHL2",57,0)
MD ;   4  MDC/DRG Groups
"RTN","LEXQHL2",58,0)
 N LEX1,LEX2,LEX,LEXC1,LEXC2,LEXCMD,LEXCT,LEXD,LEXDG,LEXDI,LEXDR,LEXDRG,LEXE,LEXEF,LEXG,LEXH,LEXI,LEXM,LEXMC,LEXMCI,LEXMCT,LEXMD,LEXMDG,LEXMDRG
"RTN","LEXQHL2",59,0)
 N LEXN,LEXNMD,LEXOMD,LEXP,LEXS,LEXT,LEXUN,LEXUND,LEXVT S:$G(LEXIA)'?7N LEXIA=$$IA(+LEXIEN) S LEXUND="",LEXUN=1,(LEXMCT,LEXMC)=0 K LEXMCI
"RTN","LEXQHL2",60,0)
 F  S LEXMC=$O(^ICD0(+LEXIEN,"MDC",LEXMC)) Q:+LEXMC'>0  D
"RTN","LEXQHL2",61,0)
 . N LEXM,LEXMDG,LEXMDG,LEXMDRG,LEXI S LEXM=$G(^ICD0(+LEXIEN,"MDC",+LEXMC,0)) Q:+LEXM'>0  S LEXM=$$UP^XLFSTR($P($G(^ICM(+LEXM,0)),U,1)) Q:'$L(LEXM)
"RTN","LEXQHL2",62,0)
 . S LEXMD=$G(^ICD0(+LEXIEN,"MDC",+LEXMC,"DRG")),LEXMDRG="" F LEXI=1:1:6 S LEXMDG=$P(LEXMD,"^",LEXI) S:$L(LEXMDG) LEXMDRG=$G(LEXMDRG)_", "_LEXMDG
"RTN","LEXQHL2",63,0)
 . S LEXMDRG=$$AND^LEXQHLM($$CS^LEXQHLM(LEXMDRG)) S:$L(LEXMDRG) LEXMDRG="DRG "_LEXMDRG
"RTN","LEXQHL2",64,0)
 . I LEXIA?7N S LEXMCT=LEXMCT+1,LEXOMD(LEXIA,LEXMCT,1)=LEXM,LEXOMD(LEXIA,LEXMCT,2)=LEXMDRG
"RTN","LEXQHL2",65,0)
 S (LEXMCT,LEXCT)=0,(LEXP,LEXEF)="" F  S LEXEF=$O(^ICD0(+LEXIEN,2,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",66,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,2,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL2",67,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICD0(+LEXIEN,2,+LEXH,0)),LEXE=$P(LEXN,U,1) Q:LEXE'?7N  S:LEXE=$G(LEXIA) LEXUN=0
"RTN","LEXQHL2",68,0)
 . . S LEXMC=0 F  S LEXMC=$O(^ICD0(+LEXIEN,2,+LEXH,1,LEXMC))  Q:+LEXMC'>0  D
"RTN","LEXQHL2",69,0)
 . . . N LEXDG,LEXDRG,LEXN,LEXM S LEXN=$G(^ICD0(+LEXIEN,2,+LEXH,1,LEXMC,0)),LEXM=$P(LEXN,U,1)
"RTN","LEXQHL2",70,0)
 . . . Q:+LEXM'>0  S LEXM=$$UP^XLFSTR($P($G(^ICM(+LEXM,0)),U,1)) Q:'$L(LEXM)
"RTN","LEXQHL2",71,0)
 . . . S LEXDRG="",LEXDG=0 F  S LEXDG=$O(^ICD0(+LEXIEN,2,+LEXH,1,LEXMC,1,LEXDG))  Q:+LEXDG'>0  D
"RTN","LEXQHL2",72,0)
 . . . . S LEXN=$G(^ICD0(+LEXIEN,2,+LEXH,1,LEXMC,1,LEXDG,0)),LEXD=$P(LEXN,U,1) Q:'$L(LEXD)
"RTN","LEXQHL2",73,0)
 . . . . S:$E(LEXDRG,1,$L(LEXD))'=LEXD&(LEXDRG'[(" "_LEXD)) LEXDRG=$G(LEXDRG)_", "_LEXD
"RTN","LEXQHL2",74,0)
 . . . S LEXDRG=$$TM^LEXQHLM($$AND^LEXQHLM($$CS^LEXQHLM(LEXDRG))) S:$L(LEXDRG) LEXDRG="DRG "_LEXDRG Q:'$L(LEXDRG)
"RTN","LEXQHL2",75,0)
 . . . S LEXMCT=+($G(LEXMCT))+1 S LEXNMD(LEXE,LEXMCT,1)=LEXM,LEXNMD(LEXE,LEXMCT,2)=LEXDRG
"RTN","LEXQHL2",76,0)
 K LEXCMD S LEXEF="",(LEXC1,LEXC2)=0 I LEXIA?7N,+($G(LEXUN))>0 F  S LEXEF=$O(LEXOMD(LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",77,0)
 . K LEXNMD(LEXEF) S LEX1=0 F  S LEX1=$O(LEXOMD(LEXEF,LEX1)) Q:+LEX1'>0  S LEXC1=LEXC1+1,LEX2=0 F  S LEX2=$O(LEXOMD(LEXEF,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL2",78,0)
 . . S LEXC2=LEXC2+1 S:LEX2=1 LEXCMD(+LEXC1,1)=LEXEF_U_$G(LEXOMD(LEXEF,LEX1,LEX2)) S:LEX2=2 LEXCMD(+LEXC1,2)=$G(LEXOMD(LEXEF,LEX1,LEX2))
"RTN","LEXQHL2",79,0)
 S LEXEF="" F  S LEXEF=$O(LEXNMD(LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL2",80,0)
 . S LEX1=0 F  S LEX1=$O(LEXNMD(LEXEF,LEX1)) Q:+LEX1'>0  S LEXC1=LEXC1+1,LEX2=0,LEXC2=0 F  S LEX2=$O(LEXNMD(LEXEF,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL2",81,0)
 . . S LEXC2=LEXC2+1 S:LEX2=1 LEXCMD(+LEXC1,1)=LEXEF_U_$G(LEXNMD(LEXEF,LEX1,LEX2)) S:LEX2=2 LEXCMD(+LEXC1,2)=$G(LEXNMD(LEXEF,LEX1,LEX2))
"RTN","LEXQHL2",82,0)
 S (LEXCT,LEXVT,LEXMC,LEX1)=0,LEXP="" F  S LEX1=$O(LEXCMD(LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL2",83,0)
 . S LEXN=$G(LEXCMD(LEX1,1)) S LEXE=$P(LEXN,U,1),LEXM=$P(LEXN,U,2) Q:LEXE'?7N  Q:'$L(LEXM)  S LEXG=$G(LEXCMD(LEX1,2)) Q:'$L(LEXG)
"RTN","LEXQHL2",84,0)
 . I LEXE'=LEXP S LEXCT=LEXCT+1 S:LEXE'=LEXIA LEXVT=LEXVT+1
"RTN","LEXQHL2",85,0)
 . S LEXMC=0,LEXMC=LEXMC+1 I +($G(LEXUN))>0,LEXE=LEXIA S LEXS="Initial Unversioned Major Diagnostic Category/DRG Groups"
"RTN","LEXQHL2",86,0)
 . I +($G(LEXUN))>0,LEXE'=LEXIA,LEXVT=1 S LEXS="Initial Versioned Major Diagnostic Category/DRG Groups"
"RTN","LEXQHL2",87,0)
 . I LEXCT>1,LEXVT>1 S LEXS="Updated Major Diagnostic Category/DRG Groups"
"RTN","LEXQHL2",88,0)
 . S LEXD=$$SD^LEXQHLM(LEXE),^TMP("LEXQHL",$J,LEXE,4,LEX1,1)=LEXD_U_LEXS,^TMP("LEXQHL",$J,LEXE,4,LEX1,2)=U_LEXM,^TMP("LEXQHL",$J,LEXE,4,LEX1,3)=U_("  "_LEXG)
"RTN","LEXQHL2",89,0)
 . S LEXP=LEXE
"RTN","LEXQHL2",90,0)
 Q
"RTN","LEXQHL2",91,0)
 ;     
"RTN","LEXQHL2",92,0)
DP ; Display
"RTN","LEXQHL2",93,0)
 S LEXDISP=$G(LEXDISP) Q:$L(LEXDISP)>8  Q:$L(LEXDISP)<2  Q:LEXDISP["^"  N LEXL S LEXL=$T(@LEXDISP+0) Q:'$L(LEXL)
"RTN","LEXQHL2",94,0)
 D @LEXDISP
"RTN","LEXQHL2",95,0)
 Q
"RTN","LEXQHL2",96,0)
SB ;   Subjective
"RTN","LEXQHL2",97,0)
 N LEX1,LEX2,LEX3,LEXC,LEXCT,LEXD,LEXE,LEXEC,LEXG,LEXHDR,LEXI,LEXID,LEXM,LEXN,LEXN1,LEXN2,LEXN3,LEXO1,LEXO2,LEXO3,LEXP,LEXS,LEXT
"RTN","LEXQHL2",98,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL2",99,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",100,0)
 F LEXID=1:1:4 D
"RTN","LEXQHL2",101,0)
 . N LEXHDR,LEXCT,LEXEC S (LEXEC,LEXCT)=0,LEXHDR=$$HD(LEXID) Q:'$L(LEXHDR)  S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL2",102,0)
 . . S LEXEC=LEXEC+1 I LEXID=1 D  Q
"RTN","LEXQHL2",103,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,1)) Q:'$L(LEXN)  S LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2) Q:'$L(LEXE)  Q:'$L(LEXS)  S LEXCT=LEXCT+1
"RTN","LEXQHL2",104,0)
 . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) S LEXT=LEXE,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",105,0)
 . . I LEXID=4 D  Q
"RTN","LEXQHL2",106,0)
 . . . N LEX2,LEXHDR,LEXC,LEXP,LEXO1,LEXO2,LEXO3 S LEXHDR=$$HD(4),(LEXC,LEX2)=0,LEXP="" F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,4,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL2",107,0)
 . . . . N LEXN1,LEXN2,LEXN3,LEXD,LEXS,LEXM,LEXG
"RTN","LEXQHL2",108,0)
 . . . . S LEXN1=$G(^TMP("LEXQHL",$J,LEX1,4,LEX2,1)) S LEXD=$P(LEXN1,U,1),LEXS=$P(LEXN1,U,2) Q:'$L(LEXD)  Q:'$L(LEXS)
"RTN","LEXQHL2",109,0)
 . . . . S LEXN2=$G(^TMP("LEXQHL",$J,LEX1,4,LEX2,2)) S LEXM=$P(LEXN2,U,2) Q:'$L(LEXM)
"RTN","LEXQHL2",110,0)
 . . . . S LEXN3=$G(^TMP("LEXQHL",$J,LEX1,4,LEX2,3)) S LEXG=$P(LEXN3,U,2) Q:'$L(LEXG)
"RTN","LEXQHL2",111,0)
 . . . . S LEXO1=$G(LEXD),LEXO1=LEXO1_$J(" ",(11-$L(LEXO1)))_"  "_LEXS,LEXO1="   "_LEXO1
"RTN","LEXQHL2",112,0)
 . . . . S LEXO2=$J(" ",11)_"  "_LEXM,LEXO2="   "_LEXO2
"RTN","LEXQHL2",113,0)
 . . . . S LEXO3=$J(" ",11)_"  "_LEXG,LEXO3="   "_LEXO3
"RTN","LEXQHL2",114,0)
 . . . . S LEXC=LEXC+1 I LEXEC=1,LEXC=1 D BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR))
"RTN","LEXQHL2",115,0)
 . . . . D:LEXP'=LEXD TL^LEXQHLM(LEXO1) D TL^LEXQHLM(LEXO2),TL^LEXQHLM(LEXO3)
"RTN","LEXQHL2",116,0)
 . . . . S LEXP=LEXD
"RTN","LEXQHL2",117,0)
 . . N LEX2 S LEX2=0,LEXE="" F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL2",118,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) S:LEX2=1 LEXE=$P(LEXN,U,1) Q:LEX2=1  Q:'$L(LEXE)
"RTN","LEXQHL2",119,0)
 . . . I LEX2=2 D  Q
"RTN","LEXQHL2",120,0)
 . . . . S LEXCT=LEXCT+1,LEXT=$G(LEXE),LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL2",121,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",122,0)
 . . . I LEX2>2 D  Q
"RTN","LEXQHL2",123,0)
 . . . . S LEXCT=LEXCT+1,LEXT="",LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL2",124,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",125,0)
 Q
"RTN","LEXQHL2",126,0)
CH ;   Chronological
"RTN","LEXQHL2",127,0)
 N LEX1,LEX2,LEX3,LEXC,LEXD,LEXDC,LEXI,LEXL1,LEXL2,LEXL3,LEXN,LEXP,LEXS,LEXT,LEXT1,LEXT2,LEXT3
"RTN","LEXQHL2",128,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL2",129,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",130,0)
 S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL2",131,0)
 . D BL^LEXQHLM N LEX2,LEXDC S (LEXDC,LEX2)=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL2",132,0)
 . . I LEX2=4 D  Q
"RTN","LEXQHL2",133,0)
 . . . N LEX3 S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL2",134,0)
 . . . . S LEXL1=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3,1))
"RTN","LEXQHL2",135,0)
 . . . . S LEXD=$P(LEXL1,U,1),LEXS=$P(LEXL1,U,2) Q:'$L(LEXD)  Q:'$L(LEXS)
"RTN","LEXQHL2",136,0)
 . . . . S LEXL2=$P($G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3,2)),U,2) Q:'$L(LEXL2)
"RTN","LEXQHL2",137,0)
 . . . . S LEXL3=$P($G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3,3)),U,2) Q:'$L(LEXL3)
"RTN","LEXQHL2",138,0)
 . . . . S LEXT1=$S(LEXD'=LEXP:LEXD,1:""),LEXT1=LEXT1_$J(" ",(11-$L(LEXT1)))_$S($L(LEXD):"- ",1:"  ")_LEXS
"RTN","LEXQHL2",139,0)
 . . . . S LEXDC=LEXDC+1,LEXT1="   "_LEXT1 D:LEXDC=1 TL^LEXQHLM(LEXT1)
"RTN","LEXQHL2",140,0)
 . . . . S LEXT2=$J(" ",16)_LEXL2 D TL^LEXQHLM(LEXT2)
"RTN","LEXQHL2",141,0)
 . . . . S LEXT3=$J(" ",16)_LEXL3 D TL^LEXQHLM(LEXT3)
"RTN","LEXQHL2",142,0)
 . . . . S:LEXD'="" LEXP=LEXD
"RTN","LEXQHL2",143,0)
 . . N LEX3 S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL2",144,0)
 . . . N LEXN,LEXD,LEXS S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)),LEXD=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL2",145,0)
 . . . S LEXT=$S(LEXD'=LEXP:LEXD,1:""),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_$S($L(LEXD):"- ",1:"  ")_LEXS S LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL2",146,0)
 . . . S:LEXD'="" LEXP=LEXD
"RTN","LEXQHL2",147,0)
 Q
"RTN","LEXQHL2",148,0)
 ; 
"RTN","LEXQHL2",149,0)
 ; Miscellaneous
"RTN","LEXQHL2",150,0)
IA(X) ;   Initial Activation
"RTN","LEXQHL2",151,0)
 N LEXEF,LEXH,LEXN,LEXS,LEXE,LEXIEN S LEXIEN=+($G(X)),LEXE="" Q:+LEXIEN'>0 ""  Q:'$D(^ICD0(+LEXIEN,66,0)) ""  S LEXEF="" F  S LEXEF=$O(^ICD0(+LEXIEN,66,"B",LEXEF)) Q:'$L(LEXEF)  D  Q:$G(LEXE)?7N
"RTN","LEXQHL2",152,0)
 . S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXEF,LEXH)) Q:+LEXH'>0  S LEXN=$G(^ICD0(+LEXIEN,66,+LEXH,0)) S:+($P(LEXN,U,2))>0 LEXE=$P(LEXN,U,1) Q:$G(LEXE)?7N
"RTN","LEXQHL2",153,0)
 S X="" S:$G(LEXE)?7N X=$G(LEXE)
"RTN","LEXQHL2",154,0)
 Q X
"RTN","LEXQHL2",155,0)
HD(X) ;   Header
"RTN","LEXQHL2",156,0)
 Q:+($G(X))=1 "Status"  Q:+($G(X))=2 "Operation/Procedure"  Q:+($G(X))=3 "Description"  Q:+($G(X))=4 "Major Diagnostic Category/DRG Groups"
"RTN","LEXQHL2",157,0)
 Q ""
"RTN","LEXQHL3")
0^28^B40808701^n/a
"RTN","LEXQHL3",1,0)
LEXQHL3 ;ISL/KER - Query History - CPT/HCPCS Extract ;10/30/2008
"RTN","LEXQHL3",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHL3",3,0)
 ;;
"RTN","LEXQHL3",4,0)
 ;               
"RTN","LEXQHL3",5,0)
 ; Global Variables
"RTN","LEXQHL3",6,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQHL3",7,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQHL3",8,0)
 ;               
"RTN","LEXQHL3",9,0)
 ; External References
"RTN","LEXQHL3",10,0)
 ;    $$CPT^ICPTCOD       ICR   1995
"RTN","LEXQHL3",11,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQHL3",12,0)
 ;               
"RTN","LEXQHL3",13,0)
 Q
"RTN","LEXQHL3",14,0)
EN(X,Y) ; CPT/HCPCS Procedure File
"RTN","LEXQHL3",15,0)
 N LEXIEN,LEXDISP,LEXIA,LEXEF,LEXCT,LEXC S LEXIEN=$G(X),LEXDISP=$G(Y),LEXIA="" Q:+LEXIEN'>0  Q:'$D(^ICPT(+LEXIEN,0))  S LEXC=$P($G(^ICPT(+LEXIEN,0)),U,1)
"RTN","LEXQHL3",16,0)
 K ^TMP("LEXQHL",$J) S ^TMP("LEXQHL",$J,"IEN")=LEXIEN,^TMP("LEXQHL",$J,"CODE")=LEXC,^TMP("LEXQHL",$J,"NAME")=$P($$CPT^ICPTCOD(LEXC),U,3)
"RTN","LEXQHL3",17,0)
 S:'$L(LEXDISP) LEXDISP="SB" D ST,NM,DS,CP^LEXQHL5(LEXC) D:$L($G(LEXDISP)) DP K ^TMP("LEXQHL",$J)
"RTN","LEXQHL3",18,0)
 Q
"RTN","LEXQHL3",19,0)
ST ;   1  Status
"RTN","LEXQHL3",20,0)
 N LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXMS,LEXN,LEXS,LEXT
"RTN","LEXQHL3",21,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICPT(+LEXIEN,60,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL3",22,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL3",23,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEXMS S LEXN=$G(^ICPT(+LEXIEN,60,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL3",24,0)
 . . Q:+LEXS'>0&(LEXCT'>0)  S LEXCT=LEXCT+1,LEXMS=$$MS^LEXQHLM(LEXE,1),LEXT=$S(+LEXS>0:"Activation",1:"Inactivation")
"RTN","LEXQHL3",25,0)
 . . S:+LEXS>0&(LEXCT=1) LEXT="Initial Activation"_LEXMS,LEXIA=LEXE
"RTN","LEXQHL3",26,0)
 . . S:$O(^ICPT(+LEXIEN,60,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final status change)"
"RTN","LEXQHL3",27,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,1,1)=LEXD_U_LEXT
"RTN","LEXQHL3",28,0)
 Q
"RTN","LEXQHL3",29,0)
NM ;   2  Procedure Name
"RTN","LEXQHL3",30,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL3",31,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICPT(+LEXIEN,61,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL3",32,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICPT(+LEXIEN,61,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL3",33,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICPT(+LEXIEN,61,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($P(LEXN,U,2))
"RTN","LEXQHL3",34,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL3",35,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Procedure Name",+LEXCT>1:"Updated Procedure Name",1:"Procedure Name")
"RTN","LEXQHL3",36,0)
 . . S:$O(^ICPT(+LEXIEN,61,"B",LEXEF))=""&(LEXCT>1) LEXS=LEXS_" (final change)"
"RTN","LEXQHL3",37,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,2,1)=LEXD_U_LEXS
"RTN","LEXQHL3",38,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL3",39,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,2," "),-1)+1
"RTN","LEXQHL3",40,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,2,LEXC)=U_LEXT
"RTN","LEXQHL3",41,0)
 Q
"RTN","LEXQHL3",42,0)
DS ;   3  Description
"RTN","LEXQHL3",43,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL3",44,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^ICPT(+LEXIEN,62,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL3",45,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICPT(+LEXIEN,62,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL3",46,0)
 . . N LEXC,LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^ICPT(+LEXIEN,62,+LEXH,0))
"RTN","LEXQHL3",47,0)
 . . S LEXE=$P(LEXN,U,1) S (LEXC,LEXI)=0 F  S LEXI=$O(^ICPT(+LEXIEN,62,+LEXH,1,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL3",48,0)
 . . . S LEXT=$$TM^LEXQHLM($$UP^XLFSTR($G(^ICPT(+LEXIEN,62,+LEXH,1,LEXI,0)))) Q:'$L(LEXT)  S LEXC=LEXC+1,LEX(LEXC)=LEXT
"RTN","LEXQHL3",49,0)
 . . S LEXCT=LEXCT+1 D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL3",50,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Description",+LEXCT>1:"Updated Description",1:"Description")
"RTN","LEXQHL3",51,0)
 . . S:$O(^ICPT(+LEXIEN,62,"B",LEXEF))=""&(LEXCT>1) LEXS=LEXS_" (final change)"
"RTN","LEXQHL3",52,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,3,1)=LEXD_U_LEXS
"RTN","LEXQHL3",53,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL3",54,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,3," "),-1)+1
"RTN","LEXQHL3",55,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,3,LEXC)=U_LEXT
"RTN","LEXQHL3",56,0)
 Q
"RTN","LEXQHL3",57,0)
 ;     
"RTN","LEXQHL3",58,0)
DP ; Display
"RTN","LEXQHL3",59,0)
 S LEXDISP=$G(LEXDISP) Q:$L(LEXDISP)>8  Q:$L(LEXDISP)<2  Q:LEXDISP["^"  N LEXL S LEXL=$T(@LEXDISP+0) Q:'$L(LEXL)
"RTN","LEXQHL3",60,0)
 D @LEXDISP
"RTN","LEXQHL3",61,0)
 Q
"RTN","LEXQHL3",62,0)
SB ;   Subjective
"RTN","LEXQHL3",63,0)
 N LEX1,LEX2,LEX3,LEXC,LEXCT,LEXD,LEXE,LEXEC,LEXG,LEXHDR,LEXI,LEXID,LEXM,LEXN,LEXN1,LEXN2,LEXN3,LEXO1,LEXO2,LEXO3,LEXP,LEXS,LEXT
"RTN","LEXQHL3",64,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL3",65,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",66,0)
 F LEXID=1:1:4 D
"RTN","LEXQHL3",67,0)
 . N LEXHDR,LEXCT,LEXEC S (LEXEC,LEXCT)=0,LEXHDR=$$HD(LEXID) Q:'$L(LEXHDR)  S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL3",68,0)
 . . S LEXEC=LEXEC+1 I LEXID=1 D  Q
"RTN","LEXQHL3",69,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,1)) Q:'$L(LEXN)  S LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2) Q:'$L(LEXE)  Q:'$L(LEXS)  S LEXCT=LEXCT+1
"RTN","LEXQHL3",70,0)
 . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) S LEXT=LEXE,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",71,0)
 . . N LEX2 S LEX2=0,LEXE="" F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL3",72,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) S:LEX2=1 LEXE=$P(LEXN,U,1) Q:LEX2=1  Q:'$L(LEXE)
"RTN","LEXQHL3",73,0)
 . . . I LEX2=2 D  Q
"RTN","LEXQHL3",74,0)
 . . . . S LEXCT=LEXCT+1,LEXT=$G(LEXE),LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL3",75,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",76,0)
 . . . I LEX2>2 D  Q
"RTN","LEXQHL3",77,0)
 . . . . S LEXCT=LEXCT+1,LEXT="",LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL3",78,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHDR)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",79,0)
 Q
"RTN","LEXQHL3",80,0)
CH ;   Chronological
"RTN","LEXQHL3",81,0)
 N LEX1,LEX2,LEX3,LEXC,LEXD,LEXDC,LEXI,LEXL1,LEXL2,LEXL3,LEXN,LEXP,LEXS,LEXT,LEXT1,LEXT2,LEXT3
"RTN","LEXQHL3",82,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL3",83,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",84,0)
 S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL3",85,0)
 . D BL^LEXQHLM N LEX2,LEXDC S (LEXDC,LEX2)=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL3",86,0)
 . . N LEX3 S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL3",87,0)
 . . . N LEXN,LEXD,LEXS S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)),LEXD=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL3",88,0)
 . . . S LEXT=$S(LEXD'=LEXP:LEXD,1:""),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_$S($L(LEXD):"- ",1:"  ")_LEXS S LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL3",89,0)
 . . . S:LEXD'="" LEXP=LEXD
"RTN","LEXQHL3",90,0)
 Q
"RTN","LEXQHL3",91,0)
 ; 
"RTN","LEXQHL3",92,0)
 ; Miscellaneous
"RTN","LEXQHL3",93,0)
IA(X) ;   Initial Activation
"RTN","LEXQHL3",94,0)
 N LEXEF,LEXH,LEXN,LEXS,LEXE,LEXIEN S LEXIEN=+($G(X)),LEXE="" Q:+LEXIEN'>0 ""  Q:'$D(^ICPT(+LEXIEN,60,0)) ""  S LEXEF="" F  S LEXEF=$O(^ICPT(+LEXIEN,60,"B",LEXEF)) Q:'$L(LEXEF)  D  Q:$G(LEXE)?7N
"RTN","LEXQHL3",95,0)
 . S LEXH=0 F  S LEXH=$O(^ICPT(+LEXIEN,60,"B",LEXEF,LEXH)) Q:+LEXH'>0  S LEXN=$G(^ICPT(+LEXIEN,60,+LEXH,0)) S:+($P(LEXN,U,2))>0 LEXE=$P(LEXN,U,1) Q:$G(LEXE)?7N
"RTN","LEXQHL3",96,0)
 S X="" S:$G(LEXE)?7N X=$G(LEXE)
"RTN","LEXQHL3",97,0)
 Q X
"RTN","LEXQHL3",98,0)
HD(X) ;   Header
"RTN","LEXQHL3",99,0)
 Q:+($G(X))=1 "Status"  Q:+($G(X))=2 "Procedure Name"  Q:+($G(X))=3 "Description"  Q:+($G(X))=4 "Lexicon Expression"
"RTN","LEXQHL3",100,0)
 Q ""
"RTN","LEXQHL4")
0^29^B101257381^n/a
"RTN","LEXQHL4",1,0)
LEXQHL4 ;ISL/KER - Query History - CPT Modifier Extract ;10/30/2008
"RTN","LEXQHL4",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHL4",3,0)
 ;;
"RTN","LEXQHL4",4,0)
 ;               
"RTN","LEXQHL4",5,0)
 ; Global Variables
"RTN","LEXQHL4",6,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQHL4",7,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQHL4",8,0)
 ;    ^TMP("LEXQHLA")     SACC 2.3.2.5.1
"RTN","LEXQHL4",9,0)
 ;               
"RTN","LEXQHL4",10,0)
 ; External References
"RTN","LEXQHL4",11,0)
 ;    $$MOD^ICPTMOD       ICR   1996
"RTN","LEXQHL4",12,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQHL4",13,0)
 ;               
"RTN","LEXQHL4",14,0)
 Q
"RTN","LEXQHL4",15,0)
EN(X,Y,LEX) ; CPT Modifier File
"RTN","LEXQHL4",16,0)
 N LEXDISP,LEXRAN,LEXIEN,LEXIA,LEXEF,LEXCT,LEXC S LEXIEN=$G(X),LEXDISP=$G(Y),LEXRAN=$G(LEX),LEXIA="" Q:+LEXIEN'>0  Q:'$D(^DIC(81.3,+LEXIEN,0))
"RTN","LEXQHL4",17,0)
 S LEXC=$P($G(^DIC(81.3,+LEXIEN,0)),U,1) K ^TMP("LEXQHL",$J) S ^TMP("LEXQHL",$J,"IEN")=LEXIEN,^TMP("LEXQHL",$J,"CODE")=LEXC
"RTN","LEXQHL4",18,0)
 S ^TMP("LEXQHL",$J,"NAME")=$P($$MOD^ICPTMOD(LEXIEN,"I"),U,3) S:'$L(LEXDISP) LEXDISP="SB" D ST,NM,DS,AR,IR D:$L($G(LEXDISP)) DP
"RTN","LEXQHL4",19,0)
 Q
"RTN","LEXQHL4",20,0)
ST ;   1  Status
"RTN","LEXQHL4",21,0)
 N LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXMS,LEXN,LEXS,LEXT
"RTN","LEXQHL4",22,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^DIC(81.3,+LEXIEN,60,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL4",23,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL4",24,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEXMS S LEXN=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL4",25,0)
 . . Q:+LEXS'>0&(LEXCT'>0)  S LEXCT=LEXCT+1,LEXMS=$$MS^LEXQHLM(LEXE,1),LEXT=$S(+LEXS>0:"Activation",1:"Inactivation")
"RTN","LEXQHL4",26,0)
 . . S:+LEXS>0&(LEXCT=1) LEXT="Initial Activation"_LEXMS,LEXIA=LEXE
"RTN","LEXQHL4",27,0)
 . . S:$O(^DIC(81.3,+LEXIEN,60,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final status change)"
"RTN","LEXQHL4",28,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,1,1)=LEXD_U_LEXT
"RTN","LEXQHL4",29,0)
 Q
"RTN","LEXQHL4",30,0)
NM ;   2  Modifier Name
"RTN","LEXQHL4",31,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL4",32,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^DIC(81.3,+LEXIEN,61,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL4",33,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^DIC(81.3,+LEXIEN,61,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL4",34,0)
 . . N LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^DIC(81.3,+LEXIEN,61,+LEXH,0)),LEXE=$P(LEXN,U,1),LEXT=$$UP^XLFSTR($P(LEXN,U,2))
"RTN","LEXQHL4",35,0)
 . . S LEXCT=LEXCT+1,LEX(1)=LEXT D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL4",36,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Modifier Name",+LEXCT>1:"Updated Modifier Name",1:"Modifier Name")
"RTN","LEXQHL4",37,0)
 . . S:$O(^DIC(81.3,+LEXIEN,61,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final Modifier Name change)"
"RTN","LEXQHL4",38,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,2,1)=LEXD_U_LEXS
"RTN","LEXQHL4",39,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL4",40,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,2," "),-1)+1
"RTN","LEXQHL4",41,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,2,LEXC)=U_LEXT
"RTN","LEXQHL4",42,0)
 Q
"RTN","LEXQHL4",43,0)
DS ;   3  Description
"RTN","LEXQHL4",44,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEF,LEXH,LEXI,LEXN,LEXS,LEXT
"RTN","LEXQHL4",45,0)
 S LEXCT=0,LEXEF="" F  S LEXEF=$O(^DIC(81.3,+LEXIEN,62,"B",LEXEF)) Q:'$L(LEXEF)  D
"RTN","LEXQHL4",46,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^DIC(81.3,+LEXIEN,62,"B",LEXEF,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL4",47,0)
 . . N LEXC,LEXN,LEXS,LEXE,LEXT,LEXD,LEX,LEXI S LEXN=$G(^DIC(81.3,+LEXIEN,62,+LEXH,0))
"RTN","LEXQHL4",48,0)
 . . S LEXE=$P(LEXN,U,1) S (LEXC,LEXI)=0 F  S LEXI=$O(^DIC(81.3,+LEXIEN,62,+LEXH,1,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL4",49,0)
 . . . S LEXT=$$TM^LEXQHLM($$UP^XLFSTR($G(^DIC(81.3,+LEXIEN,62,+LEXH,1,LEXI,0)))) Q:'$L(LEXT)  S LEXC=LEXC+1,LEX(LEXC)=LEXT
"RTN","LEXQHL4",50,0)
 . . S LEXCT=LEXCT+1 D PR^LEXQHLM(.LEX,63)
"RTN","LEXQHL4",51,0)
 . . S LEXS=$S(+LEXCT=1:"Initial Description",+LEXCT>1:"Updated Description",1:"Description")
"RTN","LEXQHL4",52,0)
 . . S:$O(^DIC(81.3,+LEXIEN,62,"B",LEXEF))=""&(LEXCT>1) LEXT=LEXT_" (final description change)"
"RTN","LEXQHL4",53,0)
 . . S LEXD=$$SD^LEXQHLM(LEXE) S ^TMP("LEXQHL",$J,LEXEF,3,1)=LEXD_U_LEXS
"RTN","LEXQHL4",54,0)
 . . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL4",55,0)
 . . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXEF,3," "),-1)+1
"RTN","LEXQHL4",56,0)
 . . . S ^TMP("LEXQHL",$J,LEXEF,3,LEXC)=U_LEXT
"RTN","LEXQHL4",57,0)
 Q
"RTN","LEXQHL4",58,0)
AR ;   4  Active Ranges
"RTN","LEXQHL4",59,0)
 K ^TMP("LEXQHLA",$J) N LEXACT,LEXAT,LEXATD,LEXB,LEXC,LEXD,LEXE,LEXI,LEXIA,LEXIAD,LEXICT,LEXN,LEXR
"RTN","LEXQHL4",60,0)
 S (LEXACT,LEXICT)=0,LEXI=0 F  S LEXI=$O(^DIC(81.3,+LEXIEN,10,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL4",61,0)
 . N LEXN,LEXAT,LEXATD,LEXIA,LEXIAD,LEXB,LEXE,LEXR S LEXN=$G(^DIC(81.3,+LEXIEN,10,+LEXI,0)),LEXB=$P(LEXN,U,1) Q:$L(LEXB)'=5
"RTN","LEXQHL4",62,0)
 . S LEXE=$P(LEXN,U,2) S:'$L(LEXE) LEXE=LEXB S LEXAT=$P(LEXN,U,3) Q:'$L(LEXAT)  Q:LEXAT'?7N  S LEXATD=$$SD^LEXQHLM(LEXAT) Q:'$L(LEXATD)
"RTN","LEXQHL4",63,0)
 . S LEXIA=$P(LEXN,U,4) S:$L(LEXIA) LEXIAD=$$SD^LEXQHLM(LEXIA) Q:$L($G(LEXIA))&('$L($G(LEXIAD)))  S LEXR=LEXB_" - "_LEXE Q:LEXIA?7N
"RTN","LEXQHL4",64,0)
 . S LEXACT=LEXACT+1,^TMP("LEXQHLA",$J,LEXAT,LEXACT)=LEXATD_U_LEXR,^TMP("LEXQHLA",$J,"B",LEXR,LEXAT,LEXACT)=""
"RTN","LEXQHL4",65,0)
 S LEXC=0,LEXB="" F  S LEXB=$O(^TMP("LEXQHLA",$J,"B",LEXB)) Q:'$L(LEXB)  D
"RTN","LEXQHL4",66,0)
 . N LEXAT S LEXAT="" F  S LEXAT=$O(^TMP("LEXQHLA",$J,"B",LEXB,LEXAT)) Q:'$L(LEXAT)  D
"RTN","LEXQHL4",67,0)
 . . N LEXACT S LEXACT=0 F  S LEXACT=$O(^TMP("LEXQHLA",$J,"B",LEXB,LEXAT,LEXACT)) Q:+LEXACT'>0  D
"RTN","LEXQHL4",68,0)
 . . . N LEXN,LEXD,LEXR S LEXN=$G(^TMP("LEXQHLA",$J,LEXAT,LEXACT)),LEXD=$P(LEXN,U,1),LEXR=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXR)
"RTN","LEXQHL4",69,0)
 . . . S LEXC=LEXC+1,^TMP("LEXQHL",$J,LEXAT,4,LEXC)=LEXN
"RTN","LEXQHL4",70,0)
 K ^TMP("LEXQHLA",$J)
"RTN","LEXQHL4",71,0)
 Q
"RTN","LEXQHL4",72,0)
IR ;   5  Inactive Ranges
"RTN","LEXQHL4",73,0)
 K ^TMP("LEXQHLA",$J) N LEXACT,LEXAT,LEXATD,LEXB,LEXC,LEXD,LEXE,LEXI,LEXIA,LEXIAD,LEXICT,LEXN,LEXR
"RTN","LEXQHL4",74,0)
 S (LEXACT,LEXICT)=0,LEXI=0 F  S LEXI=$O(^DIC(81.3,+LEXIEN,10,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL4",75,0)
 . N LEXN,LEXAT,LEXATD,LEXIA,LEXIAD,LEXB,LEXE,LEXR S LEXN=$G(^DIC(81.3,+LEXIEN,10,+LEXI,0)),LEXB=$P(LEXN,U,1) Q:$L(LEXB)'=5
"RTN","LEXQHL4",76,0)
 . S LEXE=$P(LEXN,U,2) S:'$L(LEXE) LEXE=LEXB S LEXAT=$P(LEXN,U,3) Q:'$L(LEXAT)  Q:LEXAT'?7N  S LEXATD=$$SD^LEXQHLM(LEXAT) Q:'$L(LEXATD)
"RTN","LEXQHL4",77,0)
 . S LEXIA=$P(LEXN,U,4) S:$L(LEXIA) LEXIAD=$$SD^LEXQHLM(LEXIA) Q:$L($G(LEXIA))&('$L($G(LEXIAD)))  S LEXR=LEXB_" - "_LEXE Q:LEXIA'?7N
"RTN","LEXQHL4",78,0)
 . S LEXACT=LEXACT+1,^TMP("LEXQHLA",$J,LEXAT,LEXACT)=LEXATD_U_LEXR,^TMP("LEXQHLA",$J,"B",LEXR,LEXAT,LEXACT)=""
"RTN","LEXQHL4",79,0)
 S LEXC=0,LEXB="" F  S LEXB=$O(^TMP("LEXQHLA",$J,"B",LEXB)) Q:'$L(LEXB)  D
"RTN","LEXQHL4",80,0)
 . N LEXAT S LEXAT="" F  S LEXAT=$O(^TMP("LEXQHLA",$J,"B",LEXB,LEXAT)) Q:'$L(LEXAT)  D
"RTN","LEXQHL4",81,0)
 . . N LEXACT S LEXACT=0 F  S LEXACT=$O(^TMP("LEXQHLA",$J,"B",LEXB,LEXAT,LEXACT)) Q:+LEXACT'>0  D
"RTN","LEXQHL4",82,0)
 . . . N LEXN,LEXD,LEXR S LEXN=$G(^TMP("LEXQHLA",$J,LEXAT,LEXACT)),LEXD=$P(LEXN,U,1),LEXR=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXR)
"RTN","LEXQHL4",83,0)
 . . . S LEXC=LEXC+1,^TMP("LEXQHL",$J,LEXAT,5,LEXC)=LEXN
"RTN","LEXQHL4",84,0)
 K ^TMP("LEXQHLA",$J)
"RTN","LEXQHL4",85,0)
 Q
"RTN","LEXQHL4",86,0)
 ;     
"RTN","LEXQHL4",87,0)
DP ; Display
"RTN","LEXQHL4",88,0)
 S LEXDISP=$G(LEXDISP) Q:$L(LEXDISP)>8  Q:$L(LEXDISP)<2  Q:LEXDISP["^"  N LEXL S LEXL=$T(@LEXDISP+0) Q:'$L(LEXL)
"RTN","LEXQHL4",89,0)
 D @LEXDISP
"RTN","LEXQHL4",90,0)
 Q
"RTN","LEXQHL4",91,0)
SB ;   Subjective
"RTN","LEXQHL4",92,0)
 N LEX1,LEX2,LEX3,LEXC,LEXCT,LEXD,LEXE,LEXEC,LEXG,LEXHD,LEXI,LEXID,LEXM,LEXN,LEXN1,LEXN2,LEXN3,LEXO1,LEXO2,LEXO3,LEXP,LEXS,LEXT
"RTN","LEXQHL4",93,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL4",94,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",95,0)
 F LEXID=1:1:5 D
"RTN","LEXQHL4",96,0)
 . N LEXHD,LEXCT,LEXEC S (LEXEC,LEXCT)=0,LEXHD=$$HD(LEXID) Q:'$L(LEXHD)  S LEXP=""
"RTN","LEXQHL4",97,0)
 . S LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL4",98,0)
 . . S LEXEC=LEXEC+1 I LEXID=1 D  Q
"RTN","LEXQHL4",99,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,1)) Q:'$L(LEXN)  S LEXE=$P(LEXN,U,1),LEXS=$P(LEXN,U,2) Q:'$L(LEXE)  Q:'$L(LEXS)  S LEXCT=LEXCT+1
"RTN","LEXQHL4",100,0)
 . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) S LEXT=LEXE,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",101,0)
 . . I LEXID=4 D  Q
"RTN","LEXQHL4",102,0)
 . . . Q:+($G(LEXRAN))'>0  N LEXP,LEX2,LEXSTR,LEXL S LEXSTR="",(LEXL,LEXP)="",LEX2=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,4,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL4",103,0)
 . . . . N LEXN,LEXD,LEXE,LEXM,LEXT S LEXN=$G(^TMP("LEXQHL",$J,LEX1,4,LEX2)) S (LEXE,LEXD,LEXL)=$P(LEXN,U,1),LEXM=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXM)
"RTN","LEXQHL4",104,0)
 . . . . I ($L(LEXSTR)+$L(LEXM)+3)'>63 S LEXSTR=$$TM^LEXQHLM(LEXSTR_"   "_LEXM) Q
"RTN","LEXQHL4",105,0)
 . . . . I ($L(LEXSTR)+$L(LEXM)+3)>63 D
"RTN","LEXQHL4",106,0)
 . . . . . S LEXSTR=$$TM^LEXQHLM(LEXSTR) S:LEXD=LEXP LEXD="" S:$L(LEXE) LEXP=LEXE S LEXT=LEXD,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXSTR,LEXT="   "_LEXT
"RTN","LEXQHL4",107,0)
 . . . . . S LEXCT=LEXCT+1 D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT) S LEXSTR=LEXM
"RTN","LEXQHL4",108,0)
 . . . S LEXSTR=$$TM^LEXQHLM(LEXSTR) I $L(LEXSTR) D
"RTN","LEXQHL4",109,0)
 . . . . S:$G(LEXL)=$G(LEXP)&($L(LEXP)) LEXL="" S:$L(LEXL) LEXP=LEXL S LEXT=LEXL,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXSTR,LEXT="   "_LEXT
"RTN","LEXQHL4",110,0)
 . . . . S LEXCT=LEXCT+1 D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",111,0)
 . . I LEXID=5 D  Q
"RTN","LEXQHL4",112,0)
 . . . Q:+($G(LEXRAN))'>0  N LEXP,LEX2,LEXSTR,LEXL S LEXSTR="",(LEXL,LEXP)="",LEX2=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,5,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL4",113,0)
 . . . . N LEXN,LEXD,LEXE,LEXM,LEXT S LEXN=$G(^TMP("LEXQHL",$J,LEX1,5,LEX2))
"RTN","LEXQHL4",114,0)
 . . . . S (LEXE,LEXD,LEXL)=$P(LEXN,U,1),LEXM=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXM)
"RTN","LEXQHL4",115,0)
 . . . . I ($L(LEXSTR)+$L(LEXM)+3)'>63 S LEXSTR=$$TM^LEXQHLM(LEXSTR_"   "_LEXM) Q
"RTN","LEXQHL4",116,0)
 . . . . I ($L(LEXSTR)+$L(LEXM)+3)>63 D
"RTN","LEXQHL4",117,0)
 . . . . . S LEXSTR=$$TM^LEXQHLM(LEXSTR) S:LEXD=LEXP LEXD="" S:$L(LEXE) LEXP=LEXE S LEXT=LEXD,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXSTR,LEXT="   "_LEXT
"RTN","LEXQHL4",118,0)
 . . . . . S LEXCT=LEXCT+1 D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT) S LEXSTR=LEXM
"RTN","LEXQHL4",119,0)
 . . . S LEXSTR=$$TM^LEXQHLM(LEXSTR) I $L(LEXSTR) D
"RTN","LEXQHL4",120,0)
 . . . . S:$G(LEXL)=$G(LEXP)&($L(LEXP)) LEXL="" S:$L(LEXL) LEXP=LEXL S LEXT=LEXL,LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXSTR,LEXT="   "_LEXT
"RTN","LEXQHL4",121,0)
 . . . . S LEXCT=LEXCT+1 D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",122,0)
 . . N LEX2 S LEX2=0,LEXE="" F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL4",123,0)
 . . . S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEXID,LEX2)) S:LEX2=1 LEXE=$P(LEXN,U,1) Q:LEX2=1  Q:'$L(LEXE)
"RTN","LEXQHL4",124,0)
 . . . I LEX2=2 D  Q
"RTN","LEXQHL4",125,0)
 . . . . S LEXCT=LEXCT+1,LEXT=$G(LEXE),LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL4",126,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",127,0)
 . . . I LEX2>2 D  Q
"RTN","LEXQHL4",128,0)
 . . . . S LEXCT=LEXCT+1,LEXT="",LEXS=$P(LEXN,U,2),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_"  "_LEXS,LEXT="   "_LEXT
"RTN","LEXQHL4",129,0)
 . . . . D:LEXCT=1 BL^LEXQHLM,TL^LEXQHLM((" "_LEXHD)) D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",130,0)
 Q
"RTN","LEXQHL4",131,0)
CH ;   Chronological
"RTN","LEXQHL4",132,0)
 N LEX1,LEX2,LEX3,LEXC,LEXD,LEXDC,LEXI,LEXL1,LEXL2,LEXL3,LEXN,LEXP,LEXS,LEXT,LEXT1,LEXT2,LEXT3
"RTN","LEXQHL4",133,0)
 S LEXC=$G(^TMP("LEXQHL",$J,"CODE")),LEXI=$G(^TMP("LEXQHL",$J,"IEN")),LEXN=$G(^TMP("LEXQHL",$J,"NAME"))
"RTN","LEXQHL4",134,0)
 S LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",(16-$L(LEXT)))_LEXN D TL^LEXQHLM(LEXT) S LEXT="",LEXT=LEXT_$J(" ",(16-$L(LEXT)))_"IEN:  "_LEXI D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",135,0)
 S LEXP="",LEX1=0 F  S LEX1=$O(^TMP("LEXQHL",$J,LEX1)) Q:+LEX1'>0  D
"RTN","LEXQHL4",136,0)
 . D BL^LEXQHLM N LEX2,LEXDC S (LEXDC,LEX2)=0 F  S LEX2=$O(^TMP("LEXQHL",$J,LEX1,LEX2)) Q:+LEX2'>0  D
"RTN","LEXQHL4",137,0)
 . . I LEX2=4!(LEX2=5) D  Q
"RTN","LEXQHL4",138,0)
 . . . Q:+($G(LEXRAN))'>0  N LEXHD,LEXEC,LEXSTR,LEXCT S LEXHD=$$HD(LEX2),(LEXCT,LEXEC)=0,LEXSTR=""
"RTN","LEXQHL4",139,0)
 . . . S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL4",140,0)
 . . . . N LEXN,LEXD,LEXM S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)),LEXD=$P(LEXN,U,1),LEXM=$P(LEXN,U,2)
"RTN","LEXQHL4",141,0)
 . . . . S LEXEC=LEXEC+1 I LEXEC=1 D
"RTN","LEXQHL4",142,0)
 . . . . . S LEXT=$S(LEXD'=LEXP:LEXD,1:""),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_$S($L(LEXD):"- ",1:"  ")_LEXHD,LEXT="   "_LEXT D TL^LEXQHLM(LEXT) S LEXCT=LEXCT+1
"RTN","LEXQHL4",143,0)
 . . . . S:LEXD'="" LEXP=LEXD I ($L(LEXSTR)+$L(LEXM)+3)'>63 S LEXSTR=$$TM^LEXQHLM(LEXSTR_"   "_LEXM) Q
"RTN","LEXQHL4",144,0)
 . . . . I ($L(LEXSTR)+$L(LEXM)+3)>63 S LEXSTR=$$TM^LEXQHLM(LEXSTR),LEXT=$J(" ",11)_"  "_LEXSTR,LEXT="   "_LEXT D TL^LEXQHLM(LEXT) S LEXCT=LEXCT+1 S LEXSTR=LEXM
"RTN","LEXQHL4",145,0)
 . . . S LEXSTR=$$TM^LEXQHLM(LEXSTR) I $L(LEXSTR) D
"RTN","LEXQHL4",146,0)
 . . . . S:$G(LEXL)=$G(LEXP)&($L(LEXP)) LEXL="" S:$L(LEXL) LEXP=LEXL S LEXT=$J(" ",11)_"  "_LEXSTR,LEXT="   "_LEXT S LEXCT=LEXCT+1 D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",147,0)
 . . N LEX3 S LEX3=0 F  S LEX3=$O(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)) Q:+LEX3'>0  D
"RTN","LEXQHL4",148,0)
 . . . N LEXN,LEXD,LEXS S LEXN=$G(^TMP("LEXQHL",$J,LEX1,LEX2,LEX3)),LEXD=$P(LEXN,U,1),LEXS=$P(LEXN,U,2)
"RTN","LEXQHL4",149,0)
 . . . S LEXT=$S(LEXD'=LEXP:LEXD,1:""),LEXT=LEXT_$J(" ",(11-$L(LEXT)))_$S($L(LEXD):"- ",1:"  ")_LEXS S LEXT="   "_LEXT D TL^LEXQHLM(LEXT)
"RTN","LEXQHL4",150,0)
 . . . S:LEXD'="" LEXP=LEXD
"RTN","LEXQHL4",151,0)
 Q
"RTN","LEXQHL4",152,0)
 ; 
"RTN","LEXQHL4",153,0)
 ; Miscellaneous
"RTN","LEXQHL4",154,0)
IA(X) ;   Initial Activation
"RTN","LEXQHL4",155,0)
 N LEXEF,LEXH,LEXN,LEXS,LEXE,LEXIEN S LEXIEN=+($G(X)),LEXE="" Q:+LEXIEN'>0 ""  Q:'$D(^DIC(81.3,+LEXIEN,60,0)) ""  S LEXEF="" F  S LEXEF=$O(^DIC(81.3,+LEXIEN,60,"B",LEXEF)) Q:'$L(LEXEF)  D  Q:$G(LEXE)?7N
"RTN","LEXQHL4",156,0)
 . S LEXH=0 F  S LEXH=$O(^DIC(81.3,+LEXIEN,60,"B",LEXEF,LEXH)) Q:+LEXH'>0  S LEXN=$G(^DIC(81.3,+LEXIEN,60,+LEXH,0)) S:+($P(LEXN,U,2))>0 LEXE=$P(LEXN,U,1) Q:$G(LEXE)?7N
"RTN","LEXQHL4",157,0)
 S X="" S:$G(LEXE)?7N X=$G(LEXE)
"RTN","LEXQHL4",158,0)
 Q X
"RTN","LEXQHL4",159,0)
HD(X) ;   Header
"RTN","LEXQHL4",160,0)
 Q:+($G(X))=1 "Status"  Q:+($G(X))=2 "Modifier Name"  Q:+($G(X))=3 "Description"  Q:+($G(X))=4 "Activated Ranges"  Q:+($G(X))=5 "Inactivated Ranges"
"RTN","LEXQHL4",161,0)
 Q ""
"RTN","LEXQHL5")
0^30^B13324910^n/a
"RTN","LEXQHL5",1,0)
LEXQHL5 ;ISL/KER - Query History - Lexicon ICD/CPT Extract ;10/30/2008
"RTN","LEXQHL5",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHL5",3,0)
 ;;
"RTN","LEXQHL5",4,0)
 ;               
"RTN","LEXQHL5",5,0)
 ; Global Variables
"RTN","LEXQHL5",6,0)
 ;    ^TMP("LEXQHL")      SACC 2.3.2.5.1
"RTN","LEXQHL5",7,0)
 ;    ^LEX(757.01,        N/A
"RTN","LEXQHL5",8,0)
 ;    ^LEX(757.02,        N/A
"RTN","LEXQHL5",9,0)
 ;               
"RTN","LEXQHL5",10,0)
 ; External References
"RTN","LEXQHL5",11,0)
 ;    None
"RTN","LEXQHL5",12,0)
 ;               
"RTN","LEXQHL5",13,0)
 Q
"RTN","LEXQHL5",14,0)
CP(X) ;    4  Lexicon CPT
"RTN","LEXQHL5",15,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEIEN,LEXEX,LEXH,LEXI,LEXN,LEXS,LEXSAB,LEXSIEN,LEXSO,LEXT,LEXX S LEXSO=X,(LEXCT,LEXSIEN)=0
"RTN","LEXQHL5",16,0)
 F  S LEXSIEN=$O(^LEX(757.02,"CODE",(LEXSO_" "),LEXSIEN)) Q:+LEXSIEN'>0  D
"RTN","LEXQHL5",17,0)
 . N LEXN,LEXEIEN,LEXSAB,LEXEX,LEXH,LEXD,LEXE S LEXN=$G(^LEX(757.02,+LEXSIEN,0)),LEXEIEN=+LEXN,LEXSAB=$P(LEXN,U,3) Q:"^3^4^"'[("^"_+LEXSAB_"^")
"RTN","LEXQHL5",18,0)
 . Q:+$P(LEXN,U,5)'>0  S LEXEX=$P($G(^LEX(757.01,+LEXEIEN,0)),U,1),LEXH=0 F  S LEXH=$O(^LEX(757.02,+LEXSIEN,4,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL5",19,0)
 . . N LEXN S LEXN=$G(^LEX(757.02,+LEXSIEN,4,LEXH,0))  Q:+($P(LEXN,U,2))'>0
"RTN","LEXQHL5",20,0)
 . . S LEXE=$P(LEXN,U,1) Q:LEXE'?7N  S LEXD=$$SD^LEXQHLM(LEXE),LEXX(LEXE)=LEXD_U_LEXEX
"RTN","LEXQHL5",21,0)
 S LEXCT=0,LEXE="" F  S LEXE=$O(LEXX(LEXE)) Q:'$L(LEXE)  D
"RTN","LEXQHL5",22,0)
 . N LEXN,LEXD,LEXT,LEXS,LEX S LEXN=$G(LEXX(LEXE)),LEXD=$P(LEXN,U,1),LEXT=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXT)
"RTN","LEXQHL5",23,0)
 . S LEX(1)=LEXT D PR^LEXQHLM(.LEX,63) Q:'$L($G(LEX(1)))  S LEXCT=LEXCT+1
"RTN","LEXQHL5",24,0)
 . S LEXS=$S(+LEXCT=1:"Initial Lexicon Expression",+LEXCT>1:"Updated Lexicon Expression",1:"Lexicon Expression")
"RTN","LEXQHL5",25,0)
 . S:$O(LEXX(LEXE))=""&(LEXCT>1) LEXS=LEXS_" (final change)"
"RTN","LEXQHL5",26,0)
 . S ^TMP("LEXQHL",$J,LEXE,4,1)=LEXD_U_LEXS
"RTN","LEXQHL5",27,0)
 . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL5",28,0)
 . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXE,4," "),-1)+1 S ^TMP("LEXQHL",$J,LEXE,4,LEXC)=U_LEXT
"RTN","LEXQHL5",29,0)
 Q
"RTN","LEXQHL5",30,0)
ID(X) ;    4  Lexicon ICD
"RTN","LEXQHL5",31,0)
 N LEX,LEXC,LEXCT,LEXD,LEXE,LEXEIEN,LEXEX,LEXH,LEXI,LEXN,LEXS,LEXSAB,LEXSIEN,LEXSO,LEXT,LEXX S LEXSO=X,(LEXCT,LEXSIEN)=0
"RTN","LEXQHL5",32,0)
 F  S LEXSIEN=$O(^LEX(757.02,"CODE",(LEXSO_" "),LEXSIEN)) Q:+LEXSIEN'>0  D
"RTN","LEXQHL5",33,0)
 . N LEXN,LEXEIEN,LEXSAB,LEXEX,LEXH,LEXD,LEXE S LEXN=$G(^LEX(757.02,+LEXSIEN,0)),LEXEIEN=+LEXN,LEXSAB=$P(LEXN,U,3) Q:"^1^"'[("^"_+LEXSAB_"^")
"RTN","LEXQHL5",34,0)
 . Q:+$P(LEXN,U,5)'>0  S LEXEX=$P($G(^LEX(757.01,+LEXEIEN,0)),U,1),LEXH=0 F  S LEXH=$O(^LEX(757.02,+LEXSIEN,4,LEXH)) Q:+LEXH'>0  D
"RTN","LEXQHL5",35,0)
 . . N LEXN S LEXN=$G(^LEX(757.02,+LEXSIEN,4,LEXH,0))  Q:+($P(LEXN,U,2))'>0
"RTN","LEXQHL5",36,0)
 . . S LEXE=$P(LEXN,U,1) Q:LEXE'?7N  S LEXD=$$SD^LEXQHLM(LEXE),LEXX(LEXE)=LEXD_U_LEXEX
"RTN","LEXQHL5",37,0)
 S LEXCT=0,LEXE="" F  S LEXE=$O(LEXX(LEXE)) Q:'$L(LEXE)  D
"RTN","LEXQHL5",38,0)
 . N LEXN,LEXD,LEXT,LEXS,LEX S LEXN=$G(LEXX(LEXE)),LEXD=$P(LEXN,U,1),LEXT=$P(LEXN,U,2) Q:'$L(LEXD)  Q:'$L(LEXT)
"RTN","LEXQHL5",39,0)
 . S LEX(1)=LEXT D PR^LEXQHLM(.LEX,63) Q:'$L($G(LEX(1)))  S LEXCT=LEXCT+1
"RTN","LEXQHL5",40,0)
 . S LEXS=$S(+LEXCT=1:"Initial Lexicon Expression",+LEXCT>1:"Updated Lexicon Expression",1:"Lexicon Expression")
"RTN","LEXQHL5",41,0)
 . S:$O(LEXX(LEXE))=""&(LEXCT>1) LEXS=LEXS_" (final change)"
"RTN","LEXQHL5",42,0)
 . S ^TMP("LEXQHL",$J,LEXE,4,1)=LEXD_U_LEXS
"RTN","LEXQHL5",43,0)
 . S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQHL5",44,0)
 . . N LEXC S LEXT=$G(LEX(LEXI)) Q:'$L(LEXT)  S LEXC=$O(^TMP("LEXQHL",$J,LEXE,4," "),-1)+1 S ^TMP("LEXQHL",$J,LEXE,4,LEXC)=U_LEXT
"RTN","LEXQHL5",45,0)
 Q
"RTN","LEXQHLM")
0^31^B8941107^n/a
"RTN","LEXQHLM",1,0)
LEXQHLM ;ISL/KER - Query History - Extract Misc ;10/30/2008
"RTN","LEXQHLM",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQHLM",3,0)
 ;;
"RTN","LEXQHLM",4,0)
 ;               
"RTN","LEXQHLM",5,0)
 ; Global Variables
"RTN","LEXQHLM",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQHLM",7,0)
 ;    ^TMP("LEXQHO")      SACC 2.3.2.5.1
"RTN","LEXQHLM",8,0)
 ;    ^UTILITY($J         ICR  10011
"RTN","LEXQHLM",9,0)
 ;               
"RTN","LEXQHLM",10,0)
 ; External References
"RTN","LEXQHLM",11,0)
 ;    ^DIWP               ICR  10011
"RTN","LEXQHLM",12,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQHLM",13,0)
 ;               
"RTN","LEXQHLM",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQHLM",15,0)
 ;     LEXTEST
"RTN","LEXQHLM",16,0)
 ;               
"RTN","LEXQHLM",17,0)
 Q
"RTN","LEXQHLM",18,0)
 ; Miscellaneous
"RTN","LEXQHLM",19,0)
BL ;   Blank Line
"RTN","LEXQHLM",20,0)
 D TL(" ")
"RTN","LEXQHLM",21,0)
 Q
"RTN","LEXQHLM",22,0)
TL(X) ;   Text Line
"RTN","LEXQHLM",23,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQHLM",24,0)
 N LEXI S LEXI=$O(^TMP("LEXQHO",$J," "),-1)+1,^TMP("LEXQHO",$J,LEXI)=$G(X),^TMP("LEXQHO",$J,0)=LEXI
"RTN","LEXQHLM",25,0)
 Q
"RTN","LEXQHLM",26,0)
SD(X) ;   Short Date
"RTN","LEXQHLM",27,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQHLM",28,0)
IA(X) ;   Initial Activation
"RTN","LEXQHLM",29,0)
 N LEXEF,LEXH,LEXN,LEXS,LEXE,LEXIEN S LEXIEN=+($G(X)),LEXE="" Q:+LEXIEN'>0 ""  Q:'$D(^ICD0(+LEXIEN,66,0)) ""  S LEXEF="" F  S LEXEF=$O(^ICD0(+LEXIEN,66,"B",LEXEF)) Q:'$L(LEXEF)  D  Q:$G(LEXE)?7N
"RTN","LEXQHLM",30,0)
 . S LEXH=0 F  S LEXH=$O(^ICD0(+LEXIEN,66,"B",LEXEF,LEXH)) Q:+LEXH'>0  S LEXN=$G(^ICD0(+LEXIEN,66,+LEXH,0)) S:+($P(LEXN,U,2))>0 LEXE=$P(LEXN,U,1) Q:$G(LEXE)?7N
"RTN","LEXQHLM",31,0)
 S X="" S:$G(LEXE)?7N X=$G(LEXE)
"RTN","LEXQHLM",32,0)
 Q X
"RTN","LEXQHLM",33,0)
MS(X,Y) ;   Date Message
"RTN","LEXQHLM",34,0)
 Q:$G(X)'>2781001&($G(Y)=0) " (business rule date used)"
"RTN","LEXQHLM",35,0)
 Q:$G(X)'>2890101&($G(Y)=1) " (business rule date used)"
"RTN","LEXQHLM",36,0)
 Q ""
"RTN","LEXQHLM",37,0)
PR(LEX,X) ;   Parse Array
"RTN","LEXQHLM",38,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,LEXI,LEXLEN,LEXC K ^UTILITY($J,"W") Q:'$D(LEX)
"RTN","LEXQHLM",39,0)
 S LEXLEN=+($G(X)) S:+LEXLEN'>0 LEXLEN=79 S LEXC=+($G(LEX)) S:+($G(LEXC))'>0 LEXC=$O(LEX(" "),-1) Q:+LEXC'>0
"RTN","LEXQHLM",40,0)
 S DIWL=1,DIWF="C"_+LEXLEN S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI=0  S X=$G(LEX(LEXI)) D ^DIWP
"RTN","LEXQHLM",41,0)
 K LEX S (LEXC,LEXI)=0 F  S LEXI=$O(^UTILITY($J,"W",1,LEXI)) Q:+LEXI=0  D
"RTN","LEXQHLM",42,0)
 . S LEX(LEXI)=$$TM($G(^UTILITY($J,"W",1,LEXI,0))," "),LEXC=LEXC+1
"RTN","LEXQHLM",43,0)
 S:$L(LEXC) LEX=LEXC K ^UTILITY($J,"W")
"RTN","LEXQHLM",44,0)
 Q
"RTN","LEXQHLM",45,0)
HD(X) ;   Header
"RTN","LEXQHLM",46,0)
 Q:+($G(X))=1 "Status"  Q:+($G(X))=2 "Operation/Procedure"  Q:+($G(X))=3 "Description"  Q:+($G(X))=4 "Major Diagnostic Category/DRG Groups"
"RTN","LEXQHLM",47,0)
 Q ""
"RTN","LEXQHLM",48,0)
AND(X) ;   Substitute 'and'
"RTN","LEXQHLM",49,0)
 S X=$G(X) Q:$L(X,", ")'>1 X
"RTN","LEXQHLM",50,0)
 S X=$P(X,", ",1,($L(X,", ")-1))_" and "_$P(X,", ",$L(X,", "))
"RTN","LEXQHLM",51,0)
 Q X
"RTN","LEXQHLM",52,0)
CS(X) ;   Trim Comma/Space
"RTN","LEXQHLM",53,0)
 S X=$$TM($G(X),","),X=$$TM($G(X)," "),X=$$TM($G(X),","),X=$$TM($G(X)," ")
"RTN","LEXQHLM",54,0)
 Q X
"RTN","LEXQHLM",55,0)
CL ;   Clear
"RTN","LEXQHLM",56,0)
 K LEXTEST
"RTN","LEXQHLM",57,0)
 Q X
"RTN","LEXQHLM",58,0)
TM(X,Y) ;   Trim Character Y - Default " "
"RTN","LEXQHLM",59,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LEXQHLM",60,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXQHLM",61,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXQHLM",62,0)
 Q X
"RTN","LEXQID")
0^12^B46810138^n/a
"RTN","LEXQID",1,0)
LEXQID ;ISL/KER - Query - ICD Diagnosis - Extract ;10/30/2008
"RTN","LEXQID",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQID",3,0)
 ;               
"RTN","LEXQID",4,0)
 ; Global Variables
"RTN","LEXQID",5,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQID",6,0)
 ;    ^TMP("LEXQID")      SACC 2.3.2.5.1
"RTN","LEXQID",7,0)
 ;    ^TMP("LEXQIDA")     SACC 2.3.2.5.1
"RTN","LEXQID",8,0)
 ;    ^TMP("LEXQIDO")     SACC 2.3.2.5.1
"RTN","LEXQID",9,0)
 ;               
"RTN","LEXQID",10,0)
 ; External References
"RTN","LEXQID",11,0)
 ;    GETS^DIQ            ICR   2056
"RTN","LEXQID",12,0)
 ;    HIST^ICDAPIU        ICR   3991
"RTN","LEXQID",13,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQID",14,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQID",15,0)
 ;               
"RTN","LEXQID",16,0)
EN ; Main Entry Point
"RTN","LEXQID",17,0)
 N LEXENV S LEXENV=$$EV^LEXQM Q:+LEXENV'>0
"RTN","LEXQID",18,0)
 N LEXAD,LEXEDT,LEXCDT,LEXEXIT,LEXTEST S LEXEXIT=0,LEXCDT="" K ^TMP("LEXQID",$J),^TMP("LEXQIDO",$J),^TMP("LEXQIDA",$J)
"RTN","LEXQID",19,0)
 F  S LEXCDT=$$AD^LEXQM,LEXAD=LEXCDT Q:'$L(LEXCDT)  Q:+($G(LEXEXIT))>0  S LEXEDT=$P(LEXCDT,"^",1),LEXCDT=$P(LEXCDT,"^",2) Q:LEXCDT'?7N  D LOOK Q:LEXCDT'?7N  Q:+LEXEXIT>0
"RTN","LEXQID",20,0)
 K ^TMP("LEXQID",$J),^TMP("LEXQIDO",$J),^TMP("LEXQIDA",$J)
"RTN","LEXQID",21,0)
 Q
"RTN","LEXQID",22,0)
LOOK ; ICD Lookup Loop
"RTN","LEXQID",23,0)
 N LEXGET,LEXST,LEXSD,LEXLD,LEXMD,LEXLX,LEXWN,LEXCC,LEXMC,LEXICD,LEXICDC S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S LEXCDT="" Q
"RTN","LEXQID",24,0)
 S LEXLEN=62 F  S LEXICD=$$ICD^LEXQIDA S:LEXICD="^^" LEXEXIT=1 Q:+($G(LEXEXIT))>0  Q:LEXICD="^"!(LEXICD="^^")  D  Q:LEXICD="^"!(LEXICD="^^")
"RTN","LEXQID",25,0)
 . K LEXGET,LEXST,LEXSD,LEXLD,LEXMD,LEXLX,LEXWN,LEXCC,LEXMC,^TMP("LEXQID",$J) N LEXIEN,LEXLDT,LEXELDT,LEXINC,LEXINOT,LEXIREQ,LEXINCC
"RTN","LEXQID",26,0)
 . S LEXIEN=+($G(LEXICD)),LEXLDT=+($G(LEXCDT)) Q:+LEXIEN'>0  Q:LEXLDT'?7N  S LEXELDT=$$SD^LEXQM(LEXLDT) Q:'$L(LEXELDT)
"RTN","LEXQID",27,0)
 . S LEXINOT=$$NOT^LEXQIDA(+($G(LEXIEN))) S:LEXINOT["^^" LEXEXIT=1 Q:LEXINOT["^"
"RTN","LEXQID",28,0)
 . S LEXIREQ=$$REQ^LEXQIDA(+($G(LEXIEN))) S:LEXIREQ["^^" LEXEXIT=1 Q:LEXIREQ["^"
"RTN","LEXQID",29,0)
 . S LEXINCC=$$NCC^LEXQIDA(+($G(LEXIEN))) S:LEXINCC["^^" LEXEXIT=1 Q:LEXINCC["^"
"RTN","LEXQID",30,0)
 . D CSV,EN^LEXQID4
"RTN","LEXQID",31,0)
 Q
"RTN","LEXQID",32,0)
CSV ; Code Set Versioning Display
"RTN","LEXQID",33,0)
 N LEXEDT,LEXIEN,LEXIENS,LEXLTXT,LEXSO,LEXSTAT,LEXNAM
"RTN","LEXQID",34,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S (LEXICD,LEXCDT)="" Q
"RTN","LEXQID",35,0)
 S LEXIEN=+($G(LEXICD)),LEXSO=$P($G(LEXICD),"^",2),LEXLTXT=$P($G(LEXICD),"^",3) Q:+LEXIEN'>0  Q:'$L(LEXSO)
"RTN","LEXQID",36,0)
 S LEXNAM=$P($$ICDDX^ICDCODE(LEXSO,LEXCDT),"^",4) I '$L(LEXNAM) D
"RTN","LEXQID",37,0)
 . S LEXNAM=$O(^ICD9(+LEXIEN,67,"B"," "),-1)
"RTN","LEXQID",38,0)
 . S LEXNAM=$O(^ICD9(+LEXIEN,67,"B",+LEXNAM," "),-1)
"RTN","LEXQID",39,0)
 . S LEXNAM=$P($G(^ICD9(+LEXIEN,67,+LEXNAM,0)),"^",2)
"RTN","LEXQID",40,0)
 . S:'$L(LEXNAM) LEXNAM=$P($G(^ICD9(+LEXIEN,0)),"^",3)
"RTN","LEXQID",41,0)
 Q:'$L($G(LEXNAM))
"RTN","LEXQID",42,0)
 ;
"RTN","LEXQID",43,0)
 ; Get the "Unversioned" Fields
"RTN","LEXQID",44,0)
 ; 
"RTN","LEXQID",45,0)
 ;   ICD Code             Field .01
"RTN","LEXQID",46,0)
 ;   Age Low              Field 14
"RTN","LEXQID",47,0)
 ;   Age High             Field 15
"RTN","LEXQID",48,0)
 ;   Sex                  Field 9.5
"RTN","LEXQID",49,0)
 ;   Unacc as Princ. DX   Field 101
"RTN","LEXQID",50,0)
 S LEXIENS=LEXIEN_"," D GETS^DIQ(80,LEXIENS,".01;9.5;14;15;101","IE","LEXGET","LEXMSG")
"RTN","LEXQID",51,0)
 S LEXGET(80,(+LEXIEN_","),"B")=$G(LEXNAM)
"RTN","LEXQID",52,0)
 ;            
"RTN","LEXQID",53,0)
 ; Get the "Versioned" Fields
"RTN","LEXQID",54,0)
 ;            
"RTN","LEXQID",55,0)
 ;   Date/Status          80.066  (66)
"RTN","LEXQID",56,0)
 S LEXST=$$EF(+($G(LEXIEN)),+LEXCDT),LEXSTAT=+($P(LEXST,"^",2))
"RTN","LEXQID",57,0)
 ;   Diagnosis Name       80.067  (67)
"RTN","LEXQID",58,0)
 D SDS(+($G(LEXIEN)),+LEXCDT,.LEXSD,62,LEXSTAT)
"RTN","LEXQID",59,0)
 ;   Description          80.068  (68)
"RTN","LEXQID",60,0)
 D LDS^LEXQID2(+($G(LEXIEN)),+LEXCDT,.LEXLD,62,LEXSTAT)
"RTN","LEXQID",61,0)
 ;   Lexicon Expression          
"RTN","LEXQID",62,0)
 D LX^LEXQID2(+($G(LEXIEN)),+LEXCDT,.LEXLX,62,LEXSTAT)
"RTN","LEXQID",63,0)
 ;   Warning Message
"RTN","LEXQID",64,0)
 D WN^LEXQID2(+LEXCDT,.LEXWN,62)
"RTN","LEXQID",65,0)
 ;   DRG Groups           80.071  (71)
"RTN","LEXQID",66,0)
 D DRG^LEXQID3(+LEXIEN,+LEXCDT,LEXLEN)
"RTN","LEXQID",67,0)
 ;   CC                   80.0103 (103)
"RTN","LEXQID",68,0)
 D CC^LEXQID3(+($G(LEXIEN)),+LEXCDT,.LEXCC)
"RTN","LEXQID",69,0)
 ;   MDC                  80.072  (72)
"RTN","LEXQID",70,0)
 D MDC^LEXQID2(+($G(LEXIEN)),LEXCDT,.LEXMC)
"RTN","LEXQID",71,0)
 ;            
"RTN","LEXQID",72,0)
 ; Get the "Asked for" Fields
"RTN","LEXQID",73,0)
 ;            
"RTN","LEXQID",74,0)
 ;   Codes not to use     80.01   (20) 
"RTN","LEXQID",75,0)
 D:+($G(LEXINOT))>0 NOT^LEXQID3(+LEXIEN,+LEXCDT,LEXLEN)
"RTN","LEXQID",76,0)
 ;   Codes required with  80.02   (30) 
"RTN","LEXQID",77,0)
 D:+($G(LEXIREQ))>0 REQ^LEXQID3(+LEXIEN,+LEXCDT,LEXLEN)
"RTN","LEXQID",78,0)
 ;   Codes not CC with    80.03   (40)
"RTN","LEXQID",79,0)
 D:+($G(LEXINCC))>0 NCC^LEXQID3(+LEXIEN,+LEXCDT,LEXLEN)
"RTN","LEXQID",80,0)
 Q
"RTN","LEXQID",81,0)
 ; 
"RTN","LEXQID",82,0)
EF(X,LEXCDT) ; Effective Dates
"RTN","LEXQID",83,0)
 N LEX,LEXAD,LEXBRD,LEXBRW,LEXEE,LEXEF,LEXES,LEXFA,LEXH,LEXI,LEXID,LEXIEN,LEXLS,LEXSO,LEXST S LEXIEN=+($G(X)),LEXCDT=+($G(LEXCDT))
"RTN","LEXQID",84,0)
 Q:+LEXIEN'>0 "^^"  Q:'$L(^ICD9(+LEXIEN,0)) "^^"  Q:LEXCDT'?7N "^^"  S LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1)
"RTN","LEXQID",85,0)
 S LEX=$$ICDDX^ICDCODE(LEXSO,LEXCDT) S LEXFA=$$FA(+LEXIEN),(LEXLS,LEXST)=$P(LEX,"^",10),LEXID=$P(LEX,"^",12),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQID",86,0)
 S:LEXCDT<LEXBRD&(+LEXFA=LEXBRD) LEXBRW="Warning:  The 'Based on Date' provided precedes the initial Code Set Business Rule date of "_$$SD^LEXQM(LEXBRD)_", the Effective date may be inaccurate."
"RTN","LEXQID",87,0)
 S LEXAD=$P(LEX,"^",17),LEXES=$S(+LEXST>0:"Active",1:"Inactive")
"RTN","LEXQID",88,0)
 S:+LEXST'>0&(+LEXAD'>0) LEXES="Not Applicable",LEXLS=-1 S:LEXST>0 LEXEF=LEXAD S:LEXST'>0 LEXEF=LEXID
"RTN","LEXQID",89,0)
 S:LEXST'>0&(+LEXID'>0) LEXEF=LEXFA S LEXEE=$$SD^LEXQM(LEXEF)
"RTN","LEXQID",90,0)
 I LEXST'>0,+LEXID'>0,$L(LEXEE),+LEXEF>LEXCDT S LEXEE="(future activation of "_LEXEE_")",LEXEF=""
"RTN","LEXQID",91,0)
 S X=LEXLS_"^"_LEXST_"^"_LEXEF_"^"_LEXES_"^"_LEXEE S:$L(LEXBRW) $P(X,"^",6)=LEXBRW
"RTN","LEXQID",92,0)
 Q X
"RTN","LEXQID",93,0)
 ; 
"RTN","LEXQID",94,0)
SDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Diagnosis (short description)
"RTN","LEXQID",95,0)
 ; 
"RTN","LEXQID",96,0)
 ; LEX=# of Lines
"RTN","LEXQID",97,0)
 ; LEX(0)=External Date of Diagnosis Name
"RTN","LEXQID",98,0)
 ; LEX(#)=Diagnosis Name
"RTN","LEXQID",99,0)
 ; 
"RTN","LEXQID",100,0)
 N LEXD,LEXBRD,LEXBRW,LEXDDT,LEXE,LEXEE,LEXEFF,LEXFA,LEXHIS,LEXI,LEXIA,LEXIEN,LEXL,LEXLAST,LEXLEF,LEXLHI,LEXM,LEXR,LEXSDT,LEXSO,LEXLSD,LEXT
"RTN","LEXQID",101,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,67))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQID",102,0)
 S LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1),LEXLAST=$$ICDDX^ICDCODE(LEXSO),LEXLSD=$P(LEXLAST,"^",4),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQID",103,0)
 S:$D(LEXGET)&($L(LEXLSD)) LEXGET(80,(+LEXIEN_","),"B")=LEXLSD
"RTN","LEXQID",104,0)
 S LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 S LEXFA=$$FA(+LEXIEN),LEXM=""
"RTN","LEXQID",105,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Diagnosis Short Name is not available.  The date provided precedes the initial activation of the code" I $L(LEXM) D  Q
"RTN","LEXQID",106,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQID",107,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQID",108,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQID",109,0)
 S LEXM="" S LEXEFF=$O(^ICD9(LEXIEN,67,"B",(LEXVDT+.001)),-1),LEXHIS=$O(^ICD9(LEXIEN,67,"B",+LEXEFF," "),-1),LEXSDT=$P($G(^ICD9(+LEXIEN,67,+LEXHIS,0)),"^",2)
"RTN","LEXQID",110,0)
 S LEXLEF=$O(^ICD9(LEXIEN,67,"B",(9999999+.001)),-1),LEXLHI=$O(^ICD9(LEXIEN,67,"B",+LEXLEF," "),-1),LEXDDT=$P($G(^ICD9(+LEXIEN,67,+LEXLHI,0)),"^",2)
"RTN","LEXQID",111,0)
 S (LEXD,LEXE,LEXR)="" S:$L(LEXSDT)&(LEXEFF?7N) LEXD=LEXSDT,LEXE=LEXEFF
"RTN","LEXQID",112,0)
 S:$L(LEXDDT)&(LEXLEF?7N)&('$L(LEXD))&('$L(LEXE)) LEXD=LEXDDT,LEXE=LEXLEF,LEXR="No Text Available for Date Provided"
"RTN","LEXQID",113,0)
 K LEX S LEX(1)=LEXD S:$L(LEXD) LEXGET(80,(+LEXIEN_","),"B")=LEXD
"RTN","LEXQID",114,0)
 S LEXEE=$$SD^LEXQM(LEXE) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEE="--/--/----" S:$L(LEX(1)) LEX(0)=LEXEE
"RTN","LEXQID",115,0)
 S LEX=+($O(LEX(" "),-1))
"RTN","LEXQID",116,0)
 Q
"RTN","LEXQID",117,0)
 ; Miscellaneous
"RTN","LEXQID",118,0)
FA(X) ;   First Activation
"RTN","LEXQID",119,0)
 N LEXFA,LEXH,LEXI,LEXIEN,LEXSO
"RTN","LEXQID",120,0)
 S LEXIEN=+($G(X)) S X="",LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) D HIST^ICDAPIU(LEXSO,.LEXH) S LEXFA="",LEXI=0
"RTN","LEXQID",121,0)
 F  S LEXI=$O(LEXH(LEXI)) Q:+LEXI'>0!($L(LEXFA))  S:+($G(LEXH(LEXI)))>0&(LEXI?7N) LEXFA=LEXI Q:$L(LEXFA)
"RTN","LEXQID",122,0)
 S X=LEXFA
"RTN","LEXQID",123,0)
 Q X
"RTN","LEXQID",124,0)
IA(X) ;   Inaccurate
"RTN","LEXQID",125,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQID",126,0)
 Q X
"RTN","LEXQID",127,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQID",128,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQID",129,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2781001:2781001,1:LEXVDT)
"RTN","LEXQID",130,0)
 Q X
"RTN","LEXQID2")
0^13^B36269039^n/a
"RTN","LEXQID2",1,0)
LEXQID2 ;ISL/KER - Query - ICD Diagnosis - Extract (cont) ;10/30/2008
"RTN","LEXQID2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQID2",3,0)
 ;               
"RTN","LEXQID2",4,0)
 ; Global Variables
"RTN","LEXQID2",5,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQID2",6,0)
 ;    ^ICM(               ICR   4488
"RTN","LEXQID2",7,0)
 ;               
"RTN","LEXQID2",8,0)
 ; External References
"RTN","LEXQID2",9,0)
 ;    HIST^ICDAPIU        ICR   3991
"RTN","LEXQID2",10,0)
 ;    $$ICDD^ICDCODE      ICR   3990
"RTN","LEXQID2",11,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQID2",12,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQID2",13,0)
 ;               
"RTN","LEXQID2",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQID2",15,0)
 ;    LEXLX               Local Array containing Lexicon term
"RTN","LEXQID2",16,0)
 ;               
"RTN","LEXQID2",17,0)
 Q
"RTN","LEXQID2",18,0)
LDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Long Description
"RTN","LEXQID2",19,0)
 ; 
"RTN","LEXQID2",20,0)
 ; LEX=# of Lines
"RTN","LEXQID2",21,0)
 ; LEX(0)=External Date of Description
"RTN","LEXQID2",22,0)
 ; LEX(#)=Description
"RTN","LEXQID2",23,0)
 ; 
"RTN","LEXQID2",24,0)
 N LEXC,LEXBRD,LEXBRW,LEXDDT,LEXEVDT,LEXFA,LEXI,LEXIEN,LEXL,LEXLN,LEXM,LEXT,LEXSO,LEXTL,LEXTMP S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,68))
"RTN","LEXQID2",25,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62
"RTN","LEXQID2",26,0)
 S LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) S LEXFA=$$FA(+LEXIEN),LEXM="" S LEXSTA=+($G(LEXSTA)),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQID2",27,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Description is not available.  The date provided precedes the initial activation of the code" I $L(LEXM) D  Q
"RTN","LEXQID2",28,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7)) S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQID2",29,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQID2",30,0)
 K LEXTMP S LEXTL=$$ICDD^ICDCODE(LEXSO,"LEXTMP",LEXVDT) S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$G(LEXTMP(+LEXL))
"RTN","LEXQID2",31,0)
 S LEXM="" K:LEXL>0&(LEXLN["CODE TEXT MAY BE INACCURATE") LEXTMP(+LEXL)
"RTN","LEXQID2",32,0)
 F LEXI=1:1:2 S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$$TM^LEXQM($G(LEXTMP(+LEXL))) K:LEXL>0&('$L(LEXLN)) LEXTMP(+LEXL)
"RTN","LEXQID2",33,0)
 S LEXDDT=$O(^ICD9(+LEXIEN,68,"B",(LEXVDT+.999999)),-1) S:LEXDDT'?7N LEXDDT=$O(^ICD9(+LEXIEN,68,"B",0)) S:LEXDDT?7N LEXEVDT=$$SD^LEXQM(LEXDDT)
"RTN","LEXQID2",34,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX F LEXI=1:1:13 D
"RTN","LEXQID2",35,0)
 . Q:'$D(LEXTMP(LEXI))  S LEXT=$$TM^LEXQM($G(LEXTMP(LEXI))),LEX(LEXI)=$$UP^XLFSTR(LEXT)
"RTN","LEXQID2",36,0)
 I $L(LEXM) D
"RTN","LEXQID2",37,0)
 . N LEXT,LEXI,LEXL,LEXC S LEXL=+($O(LEX(" "),-1)),LEXC=0 S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQID2",38,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID2",39,0)
 . . S LEXT=$G(LEXT(LEXI)) S:$L(LEXT) LEXC=LEXC+1 S LEXL=LEXL+1,LEX(LEXL)=LEXT
"RTN","LEXQID2",40,0)
 S:$D(LEXTEST)&(+LEXSTA'>0) LEXEVDT="--/--/----" S:$D(LEX(1)) LEX(0)=LEXEVDT S LEX=+($O(LEX(" "),-1))
"RTN","LEXQID2",41,0)
 Q
"RTN","LEXQID2",42,0)
LX(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Lexicon Expression
"RTN","LEXQID2",43,0)
 ; 
"RTN","LEXQID2",44,0)
 ; LEX=# of Lines
"RTN","LEXQID2",45,0)
 ; LEX(0)=External Date of Expression
"RTN","LEXQID2",46,0)
 ; LEX(#)=Expression
"RTN","LEXQID2",47,0)
 ; 
"RTN","LEXQID2",48,0)
 N LEXEF,LEXEVDT,LEXEX,LEXEE,LEXFA,LEXI,LEXIA,LEXIEN,LEXLEF,LEXLHS,LEXLST,LEXM,LEXN0,LEXPF,LEXSAB,LEXSIEN,LEXSO,LEXT,LEXVTMP
"RTN","LEXQID2",49,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,0))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQID2",50,0)
 S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 Q:'$L(LEXEVDT)  S LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1)
"RTN","LEXQID2",51,0)
 Q:'$L(LEXSO)  S LEXFA=$$FA(+LEXIEN),LEXM="",LEXIA=$$IA(LEXVDT) S LEXSIEN=0
"RTN","LEXQID2",52,0)
 F  S LEXSIEN=$O(^LEX(757.02,"CODE",(LEXSO_" "),LEXSIEN)) Q:+LEXSIEN'>0  D
"RTN","LEXQID2",53,0)
 . N LEXN0 S LEXN0=$G(^LEX(757.02,+LEXSIEN,0)),LEXSAB=$P(LEXN0,"^",3)
"RTN","LEXQID2",54,0)
 . Q:"^1^"'[("^"_LEXSAB_"^")  S LEXPF=+($P(LEXN0,"^",5)) S LEXLEF=$O(^LEX(757.02,+LEXSIEN,4,"B",(LEXVDT+.99999)),-1) I LEXLEF?7N D
"RTN","LEXQID2",55,0)
 . . S LEXLHS=$O(^LEX(757.02,+LEXSIEN,4,"B",+LEXLEF," "),-1) I +LEXLHS>0 D
"RTN","LEXQID2",56,0)
 . . . S LEXLST=$G(^LEX(757.02,+LEXSIEN,4,+LEXLHS,0)),LEXLST=$P(LEXLST,"^",2)
"RTN","LEXQID2",57,0)
 . . . S:LEXLST>0 LEXVTMP(+LEXPF,LEXSIEN)=+LEXN0_"^"_LEXLEF
"RTN","LEXQID2",58,0)
 S (LEXEX,LEXEF)="",LEXSIEN=$O(LEXVTMP(1,0)),LEXEX=+($G(LEXVTMP(1,+LEXSIEN))),LEXEF=$P($G(LEXVTMP(1,+LEXSIEN)),"^",2)
"RTN","LEXQID2",59,0)
 S:+LEXSIEN'>0!(+LEXEX'>0) LEXSIEN=$O(LEXVTMP(0,0)),LEXEX=+($G(LEXVTMP(0,+LEXSIEN))),LEXEF=$P($G(LEXVTMP(0,+LEXSIEN)),"^",2)
"RTN","LEXQID2",60,0)
 K LEX I +LEXEX>0,$L($G(^LEX(757.01,+LEXEX,0))),$L(LEXEF),LEXEF?7N  D  Q
"RTN","LEXQID2",61,0)
 . K LEX N LEXT,LEXM,LEXI S LEXT(1)=$G(^LEX(757.01,+LEXEX,0)) D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQID2",62,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S:$L($G(LEXT(LEXI))) LEX(+LEXI)=$G(LEXT(LEXI))
"RTN","LEXQID2",63,0)
 . S LEX=+($O(LEX(" "),-1)) S LEXEE=$$SD^LEXQM(LEXEF) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEE="--/--/----" S LEX(0)=LEXEE
"RTN","LEXQID2",64,0)
 Q
"RTN","LEXQID2",65,0)
WN(X,LEX,LEXLEN) ; Warning
"RTN","LEXQID2",66,0)
 ;            
"RTN","LEXQID2",67,0)
 ; LEX=# of Lines
"RTN","LEXQID2",68,0)
 ; LEX(0)=External Date
"RTN","LEXQID2",69,0)
 ; LEX(#)=Warning
"RTN","LEXQID2",70,0)
 ;            
"RTN","LEXQID2",71,0)
 N LEXVDT,LEXREF,LEXIA,LEXTMP K LEX S LEXVDT=$G(X) Q:LEXVDT'?7N  S LEXIA=$$IA(LEXVDT) Q:+LEXIA'>0  S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQID2",72,0)
 S LEXREF="Diagnosis (Short Name) and Description" S:$D(LEXLX) LEXREF="Diagnosis (Short Name), Description and Lexicon Term"
"RTN","LEXQID2",73,0)
 S LEXTMP(1)="Warning:  The 'Based on Date' provided precedes Code Set Versioning.  The "_LEXREF_" may be inaccurate for "_$$SD^LEXQM(LEXVDT)
"RTN","LEXQID2",74,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX S LEXI=0 F  S LEXI=$O(LEXTMP(LEXI)) Q:+LEXI'>0  S LEX(LEXI)=$G(LEXTMP(LEXI))
"RTN","LEXQID2",75,0)
 S LEX=$O(LEX(" "),-1),LEX(0)=$$SD^LEXQM(LEXVDT)
"RTN","LEXQID2",76,0)
 Q
"RTN","LEXQID2",77,0)
MDC(X,LEXVDT,LEX) ; Major Diagnostic Category
"RTN","LEXQID2",78,0)
 ; 
"RTN","LEXQID2",79,0)
 ; LEX=# of Lines
"RTN","LEXQID2",80,0)
 ; LEX(0)=External Date of MDC
"RTN","LEXQID2",81,0)
 ; LEX(#)=MDC
"RTN","LEXQID2",82,0)
 ; 
"RTN","LEXQID2",83,0)
 N LEXEF,LEXMDC,LEXMH,LEXN0,LEXNAM K LEX S LEX=0,LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,3))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT
"RTN","LEXQID2",84,0)
 S LEXEF=$O(^ICD9(+LEXIEN,4,"B",(LEXVDT+.99999)),-1),LEXMH=$O(^ICD9(+LEXIEN,4,"B",+LEXEF," "),-1),LEXN0=$G(^ICD9(+LEXIEN,4,+LEXMH,0)),LEXMDC=$P(LEXN0,"^",2)
"RTN","LEXQID2",85,0)
 Q:LEXEF'?7N  Q:+LEXMDC'>0  Q:'$D(^ICM(+LEXMDC,0))  S LEXNAM=$P($G(^ICM(+LEXMDC,0)),"^",1) Q:'$L(LEXNAM)
"RTN","LEXQID2",86,0)
 S LEX=1,LEX(0)=$$SD^LEXQM(LEXEF),LEX(1)=$$UP^XLFSTR(LEXNAM)
"RTN","LEXQID2",87,0)
 Q
"RTN","LEXQID2",88,0)
 ; Miscellaneous
"RTN","LEXQID2",89,0)
FA(X) ;   First Activation
"RTN","LEXQID2",90,0)
 N LEXFA,LEXH,LEXI,LEXIEN,LEXSO
"RTN","LEXQID2",91,0)
 S LEXIEN=+($G(X)) S X="",LEXSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) D HIST^ICDAPIU(LEXSO,.LEXH) S LEXFA="",LEXI=0
"RTN","LEXQID2",92,0)
 F  S LEXI=$O(LEXH(LEXI)) Q:+LEXI'>0!($L(LEXFA))  S:+($G(LEXH(LEXI)))>0&(LEXI?7N) LEXFA=LEXI Q:$L(LEXFA)
"RTN","LEXQID2",93,0)
 S X=LEXFA
"RTN","LEXQID2",94,0)
 Q X
"RTN","LEXQID2",95,0)
IA(X) ;   Inaccurate
"RTN","LEXQID2",96,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQID2",97,0)
 Q X
"RTN","LEXQID2",98,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQID2",99,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQID2",100,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2781001:2781001,1:LEXVDT)
"RTN","LEXQID2",101,0)
 Q X
"RTN","LEXQID2",102,0)
CLR ;   Clear
"RTN","LEXQID2",103,0)
 K LEXLX,LEXTEST
"RTN","LEXQID2",104,0)
 Q
"RTN","LEXQID3")
0^14^B61299678^n/a
"RTN","LEXQID3",1,0)
LEXQID3 ;ISL/KER - Query - ICD Diagnosis - Extract (cont) ;10/30/2008
"RTN","LEXQID3",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQID3",3,0)
 ;               
"RTN","LEXQID3",4,0)
 ; Global Variables
"RTN","LEXQID3",5,0)
 ;    ^ICD(               ICR   4487
"RTN","LEXQID3",6,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQID3",7,0)
 ;    ^TMP("LEXQID")      SACC 2.3.2.5.1
"RTN","LEXQID3",8,0)
 ;               
"RTN","LEXQID3",9,0)
 ; External References
"RTN","LEXQID3",10,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQID3",11,0)
 ;    DRGD^ICDGTDRG       ICR   4052
"RTN","LEXQID3",12,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQID3",13,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQID3",14,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQID3",15,0)
 ;               
"RTN","LEXQID3",16,0)
 Q
"RTN","LEXQID3",17,0)
NOT(X,LEXVDT,LEXLEN) ; Include ICD Codes not to use with ***.**
"RTN","LEXQID3",18,0)
 ; 
"RTN","LEXQID3",19,0)
 ; ^TMP("LEXQID",$J,"NOT",0)=<total>
"RTN","LEXQID3",20,0)
 ; ^TMP("LEXQID",$J,"NOT",1,1)=<header>
"RTN","LEXQID3",21,0)
 ; ^TMP("LEXQID",$J,"NOT",2,#)=<header text>
"RTN","LEXQID3",22,0)
 ; ^TMP("LEXQID",$J,"NOT",3,<code >)=<code>_"  "_<diagnosis>
"RTN","LEXQID3",23,0)
 ; 
"RTN","LEXQID3",24,0)
 K ^TMP("LEXQID",$J,"NOT") N LEX,LEXI,LEXC,LEXICD,LEXIEN,LEXISO,LEXSO,LEXSD,LEXD,LEXT,LEXSTR S LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,0))
"RTN","LEXQID3",25,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQID3",26,0)
 S LEXISO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXISO)  S LEXI=0 F  S LEXI=$O(^ICD9(+LEXIEN,"N",LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID3",27,0)
 . S LEXICD=+($G(^ICD9(+LEXIEN,"N",+LEXI,0))),LEXD=$$ICDDX^ICDCODE(+LEXICD,LEXVDT)
"RTN","LEXQID3",28,0)
 . S LEXSO=$P(LEXD,"^",2),LEXSD=$$UP^XLFSTR($P(LEXD,"^",4)) Q:'$L(LEXSO)  Q:'$L(LEXSD)
"RTN","LEXQID3",29,0)
 . S LEXT=LEXSO,LEXT=LEXT_$J(" ",(9-$L(LEXT)))_LEXSD
"RTN","LEXQID3",30,0)
 . S ^TMP("LEXQID",$J,"NOT",3,(LEXSO_" "))=LEXT
"RTN","LEXQID3",31,0)
 S LEXC=0,LEXI="" F  S LEXI=$O(^TMP("LEXQID",$J,"NOT",3,LEXI)) Q:'$L(LEXI)  S LEXC=LEXC+1
"RTN","LEXQID3",32,0)
 S ^TMP("LEXQID",$J,"NOT",0)=+($G(LEXC))
"RTN","LEXQID3",33,0)
 S LEXI=+($G(^TMP("LEXQID",$J,"NOT",0))) I LEXI>0 D
"RTN","LEXQID3",34,0)
 . N LEX,LEXC,LEXSTR,LEXT S LEXSTR="The following code"_$S(LEXI>1:"s ",1:" ")_"cannot be used in conjunction with "
"RTN","LEXQID3",35,0)
 . S:$L($G(LEXISO)) LEXSTR=LEXSTR_"ICD Code "_LEXISO S:'$L($G(LEXISO)) LEXSTR=LEXSTR_"this ICD Code"
"RTN","LEXQID3",36,0)
 . S LEX(1)=LEXSTR D PR^LEXQM(.LEX,(LEXLEN-7)) S (LEXC,LEXT)=0 F  S LEXT=$O(LEX(LEXT)) Q:+LEXT'>0  D
"RTN","LEXQID3",37,0)
 . . S LEXSTR=$$TM^LEXQM($G(LEX(LEXT))) S:$L(LEXSTR) LEXC=LEXC+1,^TMP("LEXQID",$J,"NOT",2,LEXC)=LEXSTR
"RTN","LEXQID3",38,0)
 S:$D(^TMP("LEXQID",$J,"NOT",2)) ^TMP("LEXQID",$J,"NOT",1,1)="Not used"
"RTN","LEXQID3",39,0)
 Q
"RTN","LEXQID3",40,0)
REQ(X,LEXVDT,LEXLEN) ; Include ICD Codes required with ***.**
"RTN","LEXQID3",41,0)
 ; 
"RTN","LEXQID3",42,0)
 ; ^TMP("LEXQID",$J,"REQ",0)=<total>
"RTN","LEXQID3",43,0)
 ; ^TMP("LEXQID",$J,"REQ",1,1)=<header>
"RTN","LEXQID3",44,0)
 ; ^TMP("LEXQID",$J,"REQ",2,#)=<header text>
"RTN","LEXQID3",45,0)
 ; ^TMP("LEXQID",$J,"REQ",3,<code >)=<code>_"  "_<diagnosis>
"RTN","LEXQID3",46,0)
 ; 
"RTN","LEXQID3",47,0)
 K ^TMP("LEXQID",$J,"REQ") N LEX,LEXC,LEXI,LEXICD,LEXIEN,LEXISO,LEXSO,LEXSD,LEXD,LEXSTR,LEXT S LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,0))
"RTN","LEXQID3",48,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQID3",49,0)
 S LEXISO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXISO)  S LEXI=0 F  S LEXI=$O(^ICD9(+LEXIEN,"R",LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID3",50,0)
 . S LEXICD=+($G(^ICD9(+LEXIEN,"R",+LEXI,0))),LEXD=$$ICDDX^ICDCODE(+LEXICD,LEXVDT)
"RTN","LEXQID3",51,0)
 . S LEXSO=$P(LEXD,"^",2),LEXSD=$$UP^XLFSTR($P(LEXD,"^",4)) Q:'$L(LEXSO)  Q:'$L(LEXSD)
"RTN","LEXQID3",52,0)
 . S LEXT=LEXSO,LEXT=LEXT_$J(" ",(9-$L(LEXT)))_LEXSD
"RTN","LEXQID3",53,0)
 . S ^TMP("LEXQID",$J,"REQ",3,(LEXSO_" "))=LEXT
"RTN","LEXQID3",54,0)
 S LEXC=0,LEXI="" F  S LEXI=$O(^TMP("LEXQID",$J,"REQ",3,LEXI)) Q:'$L(LEXI)  S LEXC=LEXC+1
"RTN","LEXQID3",55,0)
 S ^TMP("LEXQID",$J,"REQ",0)=+($G(LEXC))
"RTN","LEXQID3",56,0)
 S LEXI=+($G(^TMP("LEXQID",$J,"REQ",0))) I LEXI>0 D
"RTN","LEXQID3",57,0)
 . N LEX,LEXC,LEXSTR,LEXT S:LEXI>1 LEXSTR="One of the following codes is required when "
"RTN","LEXQID3",58,0)
 . S:LEXI>1 LEXSTR="One of the following codes is required when " S:LEXI'>1 LEXSTR="The following code is required when "
"RTN","LEXQID3",59,0)
 . S:$L($G(LEXISO)) LEXSTR=LEXSTR_"ICD Code "_LEXISO_" "
"RTN","LEXQID3",60,0)
 . S:'$L($G(LEXISO)) LEXSTR=LEXSTR_"this ICD Code " S LEXSTR=LEXSTR_"is used"
"RTN","LEXQID3",61,0)
 . S LEX(1)=LEXSTR D PR^LEXQM(.LEX,(LEXLEN-7)) S (LEXC,LEXT)=0 F  S LEXT=$O(LEX(LEXT)) Q:+LEXT'>0  D
"RTN","LEXQID3",62,0)
 . . S LEXSTR=$$TM^LEXQM($G(LEX(LEXT))) S:$L(LEXSTR) LEXC=LEXC+1,^TMP("LEXQID",$J,"REQ",2,LEXC)=LEXSTR
"RTN","LEXQID3",63,0)
 S:$D(^TMP("LEXQID",$J,"REQ",2)) ^TMP("LEXQID",$J,"REQ",1,1)="Required with"
"RTN","LEXQID3",64,0)
 Q
"RTN","LEXQID3",65,0)
NCC(X,LEXVDT,LEXLEN) ; Include the codes that ***.** is not CC with
"RTN","LEXQID3",66,0)
 ; 
"RTN","LEXQID3",67,0)
 ; ^TMP("LEXQID",$J,"NCC",0)=<total>
"RTN","LEXQID3",68,0)
 ; ^TMP("LEXQID",$J,"NCC",1,1)=<header>
"RTN","LEXQID3",69,0)
 ; ^TMP("LEXQID",$J,"NCC",2,#)=<header text>
"RTN","LEXQID3",70,0)
 ; ^TMP("LEXQID",$J,"NCC",3,<code >)=<code>_"  "_<diagnosis>
"RTN","LEXQID3",71,0)
 ; 
"RTN","LEXQID3",72,0)
 K ^TMP("LEXQID",$J,"NCC") N LEX,LEXI,LEXC,LEXICD,LEXIEN,LEXISO,LEXSO,LEXSD,LEXD,LEXSTR,LEXT S LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,0))
"RTN","LEXQID3",73,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQID3",74,0)
 S LEXISO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXISO)  S LEXI=0 F  S LEXI=$O(^ICD9(+LEXIEN,2,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID3",75,0)
 . S LEXICD=+($G(^ICD9(+LEXIEN,2,+LEXI,0))),LEXD=$$ICDDX^ICDCODE(+LEXICD,LEXVDT)
"RTN","LEXQID3",76,0)
 . S LEXSO=$P(LEXD,"^",2),LEXSD=$$UP^XLFSTR($P(LEXD,"^",4)) Q:'$L(LEXSO)  Q:'$L(LEXSD)
"RTN","LEXQID3",77,0)
 . S LEXT=LEXSO,LEXT=LEXT_$J(" ",(9-$L(LEXT)))_LEXSD
"RTN","LEXQID3",78,0)
 . S ^TMP("LEXQID",$J,"NCC",3,(LEXSO_" "))=LEXT
"RTN","LEXQID3",79,0)
 S LEXC=0,LEXI="" F  S LEXI=$O(^TMP("LEXQID",$J,"NCC",3,LEXI)) Q:'$L(LEXI)  S LEXC=LEXC+1
"RTN","LEXQID3",80,0)
 S ^TMP("LEXQID",$J,"NCC",0)=+($G(LEXC))
"RTN","LEXQID3",81,0)
 S LEXI=+($G(^TMP("LEXQID",$J,"NCC",0))) I LEXI>0 D
"RTN","LEXQID3",82,0)
 . N LEX,LEXC,LEXSTR,LEXT S LEXSTR="ICD Code " S:$L($G(LEXISO)) LEXSTR=LEXSTR_LEXISO_" "
"RTN","LEXQID3",83,0)
 . S LEXSTR=LEXSTR_"is not considered as Complication Comorbidity (CC) with the following code"_$S(LEXI>1:"s",1:"")
"RTN","LEXQID3",84,0)
 . S LEX(1)=LEXSTR D PR^LEXQM(.LEX,(LEXLEN-7)) S (LEXC,LEXT)=0 F  S LEXT=$O(LEX(LEXT)) Q:+LEXT'>0  D
"RTN","LEXQID3",85,0)
 . . S LEXSTR=$$TM^LEXQM($G(LEX(LEXT))) S:$L(LEXSTR) LEXC=LEXC+1,^TMP("LEXQID",$J,"NCC",2,LEXC)=LEXSTR
"RTN","LEXQID3",86,0)
 S:$D(^TMP("LEXQID",$J,"NCC",2)) ^TMP("LEXQID",$J,"NCC",1,1)="Not CC with"
"RTN","LEXQID3",87,0)
 Q
"RTN","LEXQID3",88,0)
DRG(X,LEXVDT,LEXLEN) ; Diagnosis Related Group
"RTN","LEXQID3",89,0)
 ;               
"RTN","LEXQID3",90,0)
 ; ^TMP("LEXQID",$J,"DRG",0)=<total>
"RTN","LEXQID3",91,0)
 ; ^TMP("LEXQID",$J,"DRG",1,1)=<header>
"RTN","LEXQID3",92,0)
 ; ^TMP("LEXQID",$J,"DRG",1,2)=<effective date>
"RTN","LEXQID3",93,0)
 ; ^TMP("LEXQID",$J,"DRG",2,1)=<header text>
"RTN","LEXQID3",94,0)
 ; ^TMP("LEXQID",$J,"DRG",3,#)=<DRG list>
"RTN","LEXQID3",95,0)
 ;               
"RTN","LEXQID3",96,0)
 N LEXC,LEXDDD,LEXDDE,LEXDEF,LEXDDI,LEXDDT,LEXDRG,LEXDRG1,LEXDRG2,LEXDRGC,LEXDRGD,LEXDRP,LEXI,LEXIEN,LEXL,LEXN,LEXN0,LEXT S LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,3))
"RTN","LEXQID3",97,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62 S (LEXDEF,LEXDDT)=$O(^ICD9(+LEXIEN,3,"B",(LEXVDT+.99999)),-1)
"RTN","LEXQID3",98,0)
 S LEXDDI=$O(^ICD9(+LEXIEN,3,"B",+LEXDDT," "),-1) I $O(^ICD9(+LEXIEN,3,+LEXDDI,1,0))'>0 D  Q
"RTN","LEXQID3",99,0)
 . S ^TMP("LEXQID",$J,"DRG",0)=0,^TMP("LEXQID",$J,"DRG",1,1)="DRG Groups"
"RTN","LEXQID3",100,0)
 . S ^TMP("LEXQID",$J,"DRG",2,1)="No DRG Groups found to be active for the date provided"
"RTN","LEXQID3",101,0)
 . S:LEXVDT?7N ^TMP("LEXQID",$J,"DRG",2,1)="No DRG Groups found to be active on "_$$SD^LEXQM(LEXVDT)
"RTN","LEXQID3",102,0)
 S LEXDRGC=0,LEXDDE="" F  S LEXDDE=$O(^ICD9(+LEXIEN,3,+LEXDDI,1,"B",LEXDDE)) Q:'$L(LEXDDE)  D
"RTN","LEXQID3",103,0)
 . N LEXDDD S LEXDDD=0 F  S LEXDDD=$O(^ICD9(+LEXIEN,3,+LEXDDI,1,"B",LEXDDE,LEXDDD)) Q:+LEXDDD'>0  D
"RTN","LEXQID3",104,0)
 . . N LEXNO,LEXDRP,LEXDRG,LEXDRGD,LEXI,LEXT,LEXDRG1,LEXDRG2,LEXC S LEXN0=$G(^ICD9(+LEXIEN,3,+LEXDDI,1,+LEXDDD,0)) S LEXDRP=$P(LEXN0,"^",1)
"RTN","LEXQID3",105,0)
 . . S LEXDRG=$P($G(^ICD(+LEXDRP,0)),"^",1) K LEXDRGD D DRGD^ICDGTDRG(LEXDRG,"LEXDRGD",,+LEXVDT) S LEXDRG=$TR(LEXDRG,"DRG",""),LEXDRG=+LEXDRG Q:+LEXDRG'>0
"RTN","LEXQID3",106,0)
 . . S LEXI=0 F  S LEXI=$O(LEXDRGD(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID3",107,0)
 . . . N LEXT S LEXT=$$TM^LEXQM($G(LEXDRGD(LEXI))) I '$L(LEXT)!(LEXT["CODE TEXT MAY BE INACCURATE") K LEXDRGD(LEXI) Q
"RTN","LEXQID3",108,0)
 . . . S LEXDRGD(LEXI)=LEXT
"RTN","LEXQID3",109,0)
 . . S LEXDRG1=LEXDRG,LEXDRG1=LEXDRG1_$J(" ",(6-$L(LEXDRG1))),LEXDRG2=$J(" ",6) D PR^LEXQM(.LEXDRGD,(LEXLEN-8))
"RTN","LEXQID3",110,0)
 . . S (LEXC,LEXI)=0 F  S LEXI=$O(LEXDRGD(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID3",111,0)
 . . . N LEXT,LEXL,LEXN S LEXT=$$TM^LEXQM($G(LEXDRGD(LEXI))) Q:'$L(LEXT)  S LEXC=LEXC+1 S:LEXC=1 LEXL=LEXDRG1_LEXT,LEXDRGC=+($G(LEXDRGC))+1
"RTN","LEXQID3",112,0)
 . . . S:LEXC>1 LEXL=LEXDRG2_LEXT S LEXN=$O(^TMP("LEXQID",$J,"DRG",3," "),-1)+1 S ^TMP("LEXQID",$J,"DRG",3,LEXN)=LEXL
"RTN","LEXQID3",113,0)
 S ^TMP("LEXQID",$J,"DRG",0)=+($G(LEXDRGC)),^TMP("LEXQID",$J,"DRG",1,1)="DRG Groups"
"RTN","LEXQID3",114,0)
 S:$G(LEXDEF)?7N ^TMP("LEXQID",$J,"DRG",1,2)=$$SD^LEXQM(LEXDEF)
"RTN","LEXQID3",115,0)
 S:+($G(LEXDRGC))>0 ^TMP("LEXQID",$J,"DRG",2,1)=+($G(LEXDRGC))_" Diagnosis Related Group"_$S(+($G(LEXDRGC))>1:"s",1:"")_" (DRG)"
"RTN","LEXQID3",116,0)
 Q
"RTN","LEXQID3",117,0)
CC(X,LEXVDT,LEX) ; Complication/Comorbidity
"RTN","LEXQID3",118,0)
 N LEXCCE,LEXCCI,LEXCH,LEXEF,LEXN0 K LEX S LEX=0,LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD9(+LEXIEN,3))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT
"RTN","LEXQID3",119,0)
 S LEXEF=$O(^ICD9(+LEXIEN,69,"B",(LEXVDT+.9999)),-1),LEXCH=$O(^ICD9(+LEXIEN,69,"B",+LEXEF," "),-1),LEXN0=$G(^ICD9(+LEXIEN,69,+LEXCH,0)),LEXCCI=$P(LEXN0,"^",2)
"RTN","LEXQID3",120,0)
 Q:LEXEF'?7N  Q:+LEXCCI'?1N  S LEXCCE=$S(+LEXCCI=0:"Non-Complication/Comorbidity (Non-CC)",+LEXCCI=1:"Complication/Comorbidity (CC)",+LEXCCI=2:"Major Complication/Comorbidity (MCC)",1:"")
"RTN","LEXQID3",121,0)
 Q:'$L(LEXCCE)  S LEX=1,LEX(0)=$$SD^LEXQM(LEXEF),LEX(1)=LEXCCE
"RTN","LEXQID3",122,0)
 Q
"RTN","LEXQID3",123,0)
 ; 
"RTN","LEXQID3",124,0)
 ; Miscellaneous            
"RTN","LEXQID3",125,0)
SD(X) ;   Short Date
"RTN","LEXQID3",126,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQID3",127,0)
IA(X) ;   Inaccurate
"RTN","LEXQID3",128,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQID3",129,0)
 Q X
"RTN","LEXQID3",130,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQID3",131,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQID3",132,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2781001:2781001,1:LEXVDT)
"RTN","LEXQID3",133,0)
 Q X
"RTN","LEXQID4")
0^15^B62471424^n/a
"RTN","LEXQID4",1,0)
LEXQID4 ;ISL/KER - Query - ICD Diagnosis - Save ;10/30/2008
"RTN","LEXQID4",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQID4",3,0)
 ;               
"RTN","LEXQID4",4,0)
 ; Global Variables
"RTN","LEXQID4",5,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQID4",6,0)
 ;    ^TMP("LEXQID")      SACC 2.3.2.5.1
"RTN","LEXQID4",7,0)
 ;    ^TMP("LEXQIDO")     SACC 2.3.2.5.1
"RTN","LEXQID4",8,0)
 ;               
"RTN","LEXQID4",9,0)
 ; External References
"RTN","LEXQID4",10,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQID4",11,0)
 ;               
"RTN","LEXQID4",12,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQID4",13,0)
 ;     LEXIEN             CPT Internal Entry Number
"RTN","LEXQID4",14,0)
 ;     LEXLEN             Offset Length
"RTN","LEXQID4",15,0)
 ;     LEXGET             Array of Non-Versioned Data
"RTN","LEXQID4",16,0)
 ;     LEXST              CPT Status and Effective Dates
"RTN","LEXQID4",17,0)
 ;     LEXSD              Versioned Short Description
"RTN","LEXQID4",18,0)
 ;     LEXLD              Versioned Long Description
"RTN","LEXQID4",19,0)
 ;     LEXLX              Versioned Lexicon Term
"RTN","LEXQID4",20,0)
 ;     LEXWN              Warning
"RTN","LEXQID4",21,0)
 ;     LEXCC              Code CC Status
"RTN","LEXQID4",22,0)
 ;     LEXMC              Major Diagnostic Category
"RTN","LEXQID4",23,0)
 ;     LEXELDT            External Last Date
"RTN","LEXQID4",24,0)
 ;              
"RTN","LEXQID4",25,0)
EN ; Main Entry Point
"RTN","LEXQID4",26,0)
 K ^TMP("LEXQIDO",$J) Q:'$L($G(LEXELDT))  I +($G(LEXST))<0 D FUT D:$D(^TMP("LEXQIDO",$J)) DSP^LEXQO("LEXQIDO") Q
"RTN","LEXQID4",27,0)
 D FUL D:$D(^TMP("LEXQIDO",$J)) DSP^LEXQO("LEXQIDO")
"RTN","LEXQID4",28,0)
 Q
"RTN","LEXQID4",29,0)
FUT ; Future Activation
"RTN","LEXQID4",30,0)
 N LEX1,LEX2,LEX3,LEXEFF,LEXI,LEXL,LEXNAM,LEXSO,LEXSTA S LEXI=+($G(LEXIEN)) Q:+LEXI'>0  Q:'$D(^ICD9(+LEXI,0))  S LEXL=+($G(LEXLEN)) Q:+LEXL'>0
"RTN","LEXQID4",31,0)
 S:LEXL>62 LEXL=62 S LEXSO=$G(LEXGET(80,(+LEXI_","),.01,"E")) Q:'$L(LEXSO)  S LEXNAM=$G(LEXGET(80,(+LEXI_","),"B")) Q:'$L(LEXNAM)
"RTN","LEXQID4",32,0)
 S LEXSTA=$G(LEXST),LEXEFF=$P(LEXSTA,"^",5),LEXSTA=$P(LEXSTA,"^",4) Q:'$L(LEXSTA)  Q:'$L(LEXEFF)  S (LEX1,LEX2,LEX3)=""
"RTN","LEXQID4",33,0)
 D BOD(LEXELDT),COD(LEXSO,LEXNAM,+($G(LEXL))),STA(.LEXST,+($G(LEXL)))
"RTN","LEXQID4",34,0)
 Q
"RTN","LEXQID4",35,0)
BOD(X) ;   Based on Date
"RTN","LEXQID4",36,0)
 N LEXBOD S LEXBOD=$G(X),X="Display based on date:  "_LEXBOD D BL,TL(X)
"RTN","LEXQID4",37,0)
 Q
"RTN","LEXQID4",38,0)
COD(X,Y,LEXLEN) ;   Code Line
"RTN","LEXQID4",39,0)
 N LEXC,LEXN,LEXT S LEXC=$G(X),LEXN=$G(Y),LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",40,0)
 Q
"RTN","LEXQID4",41,0)
STA(X,LEXLEN) ;   Status Line
"RTN","LEXQID4",42,0)
 N LEX,LEXC,LEXX,LEXE,LEXI,LEXN,LEXS,LEXT,LEXW,LEXEFF,LEXSTA
"RTN","LEXQID4",43,0)
 S LEXX=$G(X),LEXSTA=$P(LEXX,"^",4),LEXEFF=$P(LEXX,"^",5),LEXEFF=$TR(LEXEFF,"()",""),LEXW=$P(LEXX,"^",6)
"RTN","LEXQID4",44,0)
 S LEXT="  Status:  ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXSTA
"RTN","LEXQID4",45,0)
 S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Effective:  "_$$UP^XLFSTR($E(LEXEFF,1))_$E(LEXEFF,2,$L(LEXEFF)) D BL,TL(LEXT)
"RTN","LEXQID4",46,0)
 I $L(LEXW) D
"RTN","LEXQID4",47,0)
 . N LEX,LEXT,LEXC,LEXI,LEXN S LEX(1)=LEXW D PR^LEXQM(.LEX,(LEXLEN-7)) Q:+($O(LEX(" "),-1))'>0
"RTN","LEXQID4",48,0)
 . S LEXT=$J(" ",((79-+($G(LEXLEN)))))
"RTN","LEXQID4",49,0)
 . S (LEXC,LEXI)=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID4",50,0)
 . . N LEXN S LEXN=$$TM^LEXQM($G(LEX(LEXI))) S:$L(LEXN) LEXC=LEXC+1 D:LEXC=1 BL D TL((LEXT_LEXN))
"RTN","LEXQID4",51,0)
 Q
"RTN","LEXQID4",52,0)
FUL ; Full Display
"RTN","LEXQID4",53,0)
 N LEXFUL,LEX,LEXL S LEXL=+($G(LEXLEN)) S:LEXL>62 LEXL=62
"RTN","LEXQID4",54,0)
 S LEXFUL=""  D FUT
"RTN","LEXQID4",55,0)
 D LIM(+($G(LEXIEN)),+($G(LEXL))),SD(.LEXSD,+($G(LEXL))),LD(.LEXLD,+($G(LEXL))),LX(.LEXLX,+($G(LEXL))),WN(.LEXWN,+($G(LEXL)))
"RTN","LEXQID4",56,0)
 D:$L($G(LEXCC(1)))!($L($G(LEXMC(1)))) BL D CC(.LEXCC,+($G(LEXL))),MC(.LEXMC,+($G(LEXL))),DRG(+($G(LEXL)))
"RTN","LEXQID4",57,0)
 D NOT(+($G(LEXL))),REQ(+($G(LEXL))),NCC(+($G(LEXL)))
"RTN","LEXQID4",58,0)
 Q
"RTN","LEXQID4",59,0)
LIM(X,LEXLEN) ;   Limitations - Age Low, Age High and Sex
"RTN","LEXQID4",60,0)
 N LEXC,LEXI,LEXH,LEXL,LEXS,LEXT,LEXU,LEXP S LEXC=0,LEXI=+($G(X)),LEXL=$G(LEXGET(80,(+LEXI_","),14,"E")) S:'$L(LEXL) LEXL="N/A"
"RTN","LEXQID4",61,0)
 S LEXH=$G(LEXGET(80,(+LEXI_","),15,"E")) S:'$L(LEXH) LEXH="N/A" S LEXS=$G(LEXGET(80,(+LEXI_","),9.5,"E")) S:'$L(LEXS) LEXS="N/A"
"RTN","LEXQID4",62,0)
 I (LEXH_LEXL_LEXS)'="N/AN/AN/A" D
"RTN","LEXQID4",63,0)
 . S LEXT="  Limitations: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_"Age Low:  "_LEXL
"RTN","LEXQID4",64,0)
 . S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Age High:  "_LEXH,LEXT=LEXT_$J(" ",(56-$L(LEXT)))_"Sex:  "_LEXS D BL,TL(LEXT) S LEXC=1
"RTN","LEXQID4",65,0)
 S LEXU=$G(LEXGET(80,(+LEXI_","),101,"E")),LEXP=$G(LEXGET(80,(+LEXI_","),101,"I"))
"RTN","LEXQID4",66,0)
 I LEXU="YES",+LEXP>0 D
"RTN","LEXQID4",67,0)
 . S LEXT="  Limitations: " S:(LEXH_LEXL_LEXS)'="N/AN/AN/A" LEXT=""
"RTN","LEXQID4",68,0)
 . S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_"Principal DX:     Code is unacceptable as a principal DX" D:+LEXC'>0 BL D TL(LEXT)
"RTN","LEXQID4",69,0)
 Q
"RTN","LEXQID4",70,0)
SD(X,LEXLEN) ;   Short Description
"RTN","LEXQID4",71,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Short Name: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",72,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQID4",73,0)
 Q
"RTN","LEXQID4",74,0)
LD(X,LEXLEN) ;   Long Description
"RTN","LEXQID4",75,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Description: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",76,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQID4",77,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))) S LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQID4",78,0)
 Q
"RTN","LEXQID4",79,0)
LX(X,LEXLEN) ;   Lexicon Expression
"RTN","LEXQID4",80,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Lexicon Term:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",81,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQID4",82,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQID4",83,0)
 Q
"RTN","LEXQID4",84,0)
WN(X,LEXLEN) ;   Warning
"RTN","LEXQID4",85,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT,LEXC Q:'$D(X(1))  S LEXC=0,LEXN=$G(X(1)),LEXT="",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",86,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=1 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQID4",87,0)
 Q
"RTN","LEXQID4",88,0)
CC(X,LEXLEN) ;   Complication/Comorbidity
"RTN","LEXQID4",89,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXE=$G(X(0)),LEXT="  CC:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN
"RTN","LEXQID4",90,0)
 S LEXT=LEXT_$J(" ",(66-$L(LEXT)))_LEXE D TL(LEXT)
"RTN","LEXQID4",91,0)
 Q
"RTN","LEXQID4",92,0)
MC(X,LEXLEN) ;   Major Diagnostic Category
"RTN","LEXQID4",93,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXE=$G(X(0)),LEXT="  MDC:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN
"RTN","LEXQID4",94,0)
 S LEXT=LEXT_$J(" ",(66-$L(LEXT)))_LEXE D TL(LEXT)
"RTN","LEXQID4",95,0)
 Q
"RTN","LEXQID4",96,0)
MD(X,LEXLEN) ;   CPT Modifiers
"RTN","LEXQID4",97,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXE=$G(X(0)),LEXN=$G(X(1)),LEXT="  Modifiers:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",98,0)
 S LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQID4",99,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID4",100,0)
 . S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQID4",101,0)
 Q
"RTN","LEXQID4",102,0)
DRG(LEXLEN) ;   Diagnosis Related Groups
"RTN","LEXQID4",103,0)
 Q:$O(^TMP("LEXQID",$J,"DRG",3,0))'>0  Q:'$D(^TMP("LEXQID",$J,"DRG",3,1))  Q:'$D(^TMP("LEXQID",$J,"DRG",1,1))
"RTN","LEXQID4",104,0)
 Q:'$D(^TMP("LEXQID",$J,"DRG",1,2))  Q:'$D(^TMP("LEXQID",$J,"DRG",2,1))  N LEXI,LEXH,LEXE,LEXN,LEXT
"RTN","LEXQID4",105,0)
 S LEXT="  "_$G(^TMP("LEXQID",$J,"DRG",1,1))_":",LEXN=$G(^TMP("LEXQID",$J,"DRG",2,1)) S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",106,0)
 S LEXE=$G(^TMP("LEXQID",$J,"DRG",1,2)),LEXT="    "_LEXE,LEXN=$G(^TMP("LEXQID",$J,"DRG",3,1)) S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQID4",107,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=2 F  S LEXI=$O(^TMP("LEXQID",$J,"DRG",3,LEXI)) Q:+LEXI'>0  D
"RTN","LEXQID4",108,0)
 . S LEXN=LEXT_$G(^TMP("LEXQID",$J,"DRG",3,LEXI)) D TL(LEXN)
"RTN","LEXQID4",109,0)
 K ^TMP("LEXQID",$J,"DRG")
"RTN","LEXQID4",110,0)
 Q
"RTN","LEXQID4",111,0)
NOT(LEXLEN) ;   ICD codes not used with
"RTN","LEXQID4",112,0)
 Q:'$L($O(^TMP("LEXQID",$J,"NOT",3,"")))  Q:'$D(^TMP("LEXQID",$J,"NOT",1,1))  Q:'$D(^TMP("LEXQID",$J,"NOT",2,1))
"RTN","LEXQID4",113,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT S LEXT="  "_$G(^TMP("LEXQID",$J,"NOT",1,1))_":",LEXN=$G(^TMP("LEXQID",$J,"NOT",2,1))
"RTN","LEXQID4",114,0)
 S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",115,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXN=$$TM^LEXQM($G(^TMP("LEXQID",$J,"NOT",2,2))) I $L(LEXN) D TL((LEXT_LEXN))
"RTN","LEXQID4",116,0)
 S LEXI=" " F  S LEXI=$O(^TMP("LEXQID",$J,"NOT",3,LEXI)) Q:'$L(LEXI)  D
"RTN","LEXQID4",117,0)
 . S LEXN=$G(^TMP("LEXQID",$J,"NOT",3,LEXI)) D TL((LEXT_LEXN))
"RTN","LEXQID4",118,0)
 K ^TMP("LEXQID",$J,"NOT")
"RTN","LEXQID4",119,0)
 Q
"RTN","LEXQID4",120,0)
REQ(LEXLEN) ;   ICD codes requried with
"RTN","LEXQID4",121,0)
 Q:'$L($O(^TMP("LEXQID",$J,"REQ",3,"")))  Q:'$D(^TMP("LEXQID",$J,"REQ",1,1))  Q:'$D(^TMP("LEXQID",$J,"REQ",2,1))
"RTN","LEXQID4",122,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT S LEXT="  "_$G(^TMP("LEXQID",$J,"REQ",1,1))_":",LEXN=$G(^TMP("LEXQID",$J,"REQ",2,1))
"RTN","LEXQID4",123,0)
 S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",124,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXN=$$TM^LEXQM($G(^TMP("LEXQID",$J,"REQ",2,2))) I $L(LEXN) D TL((LEXT_LEXN))
"RTN","LEXQID4",125,0)
 S LEXI=" " F  S LEXI=$O(^TMP("LEXQID",$J,"REQ",3,LEXI)) Q:'$L(LEXI)  D
"RTN","LEXQID4",126,0)
 . S LEXN=$G(^TMP("LEXQID",$J,"REQ",3,LEXI)) D TL((LEXT_LEXN))
"RTN","LEXQID4",127,0)
 K ^TMP("LEXQID",$J,"REQ")
"RTN","LEXQID4",128,0)
 Q
"RTN","LEXQID4",129,0)
NCC(LEXLEN) ;   Not CC with
"RTN","LEXQID4",130,0)
 Q:'$L($O(^TMP("LEXQID",$J,"NCC",3,"")))  Q:'$D(^TMP("LEXQID",$J,"NCC",1,1))  Q:'$D(^TMP("LEXQID",$J,"NCC",2,1))
"RTN","LEXQID4",131,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT S LEXT="  "_$G(^TMP("LEXQID",$J,"NCC",1,1))_":",LEXN=$G(^TMP("LEXQID",$J,"NCC",2,1))
"RTN","LEXQID4",132,0)
 S LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQID4",133,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXN=$$TM^LEXQM($G(^TMP("LEXQID",$J,"NCC",2,2))) I $L(LEXN) D TL((LEXT_LEXN))
"RTN","LEXQID4",134,0)
 S LEXI=" " F  S LEXI=$O(^TMP("LEXQID",$J,"NCC",3,LEXI)) Q:'$L(LEXI)  D
"RTN","LEXQID4",135,0)
 . S LEXN=$G(^TMP("LEXQID",$J,"NCC",3,LEXI)) D TL((LEXT_LEXN))
"RTN","LEXQID4",136,0)
 K ^TMP("LEXQID",$J,"NCC")
"RTN","LEXQID4",137,0)
 Q
"RTN","LEXQID4",138,0)
 ;
"RTN","LEXQID4",139,0)
 ; Miscellaneous
"RTN","LEXQID4",140,0)
BL ;   Blank Line
"RTN","LEXQID4",141,0)
 D TL(" ") Q
"RTN","LEXQID4",142,0)
TL(X) ;   Text Line
"RTN","LEXQID4",143,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQID4",144,0)
 N LEXI S LEXI=+($O(^TMP("LEXQIDO",$J," "),-1))+1 S ^TMP("LEXQIDO",$J,LEXI)=$G(X),^TMP("LEXQIDO",$J,0)=LEXI
"RTN","LEXQID4",145,0)
 Q
"RTN","LEXQID4",146,0)
CLR ;   Clear
"RTN","LEXQID4",147,0)
 K LEXCC,LEXELDT,LEXGET,LEXIEN,LEXLD,LEXLX,LEXMC,LEXSD,LEXST,LEXTEST,LEXWN
"RTN","LEXQID4",148,0)
 Q
"RTN","LEXQIDA")
0^16^B55078060^n/a
"RTN","LEXQIDA",1,0)
LEXQIDA ;ISL/KER - Query - ICD Diagnosis - Ask ;10/30/2008
"RTN","LEXQIDA",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQIDA",3,0)
 ;               
"RTN","LEXQIDA",4,0)
 ; Global Variables
"RTN","LEXQIDA",5,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQIDA",6,0)
 ;    ^TMP("LEXQIDA")     SACC 2.3.2.5.1
"RTN","LEXQIDA",7,0)
 ;               
"RTN","LEXQIDA",8,0)
 ; External References
"RTN","LEXQIDA",9,0)
 ;    ^DIC                ICR  10006
"RTN","LEXQIDA",10,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQIDA",11,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQIDA",12,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQIDA",13,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQIDA",14,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQIDA",15,0)
 ;               
"RTN","LEXQIDA",16,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQIDA",17,0)
 ;    LEXCDT              Code Set Date
"RTN","LEXQIDA",18,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQIDA",19,0)
 ;               
"RTN","LEXQIDA",20,0)
 Q
"RTN","LEXQIDA",21,0)
ICD(X) ; ICD DX Code
"RTN","LEXQIDA",22,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIC,DTOUT,DUOUT,LEXDX,LEXSO,LEXDTXT,LEXVTXT,LEXVDT,Y,ICDVDT S:$G(LEXCDT)?7N ICDVDT=$G(LEXCDT)
"RTN","LEXQIDA",23,0)
 S DIC(0)="AEQMZ",DIC="^ICD9(",DIC("A")=" Select an ICD Diagnosis code:  " W !
"RTN","LEXQIDA",24,0)
 D ^DIC S:$G(X)["^^"!($D(DTOUT)) LEXEXIT=1 Q:$G(X)["^^"!(+($G(LEXEXIT))>0) "^^"
"RTN","LEXQIDA",25,0)
 Q:$G(X)="^" "^"  Q:$G(X)["^^" "^^"  Q:$D(DTOUT)!($D(DUOUT)) "^"  S LEXSO=$P($G(Y),"^",2) S X="" I +Y>0,$L(LEXSO) D
"RTN","LEXQIDA",26,0)
 . S LEXVDT=$G(LEXCDT) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S X=Y,LEXDTXT=$P($G(Y(0)),"^",2),LEXDX=$$ICDDX^ICDCODE(LEXSO,LEXVDT)
"RTN","LEXQIDA",27,0)
 . S:$L($G(LEXDTXT)) LEXDTXT=LEXDTXT_" (Text not Versioned)" S LEXVTXT=$P(LEXDX,"^",4) S:'$L(LEXVTXT) LEXVTXT=LEXDTXT
"RTN","LEXQIDA",28,0)
 . S X=+Y_"^"_LEXSO S:$L(LEXVTXT) X=X_"^"_LEXVTXT
"RTN","LEXQIDA",29,0)
 S X=$$UP^XLFSTR(X) Q:'$L(X) "^"
"RTN","LEXQIDA",30,0)
 Q X
"RTN","LEXQIDA",31,0)
 ;          
"RTN","LEXQIDA",32,0)
NOT(X) ; Include ICD Codes not to use with ***.**
"RTN","LEXQIDA",33,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB,LEXIEN,LEXLSO,LEXCT,LEXCTE,LEXI S LEXIEN=+($G(X)) Q:'$D(^ICD9(+LEXIEN,0)) 0  Q:+($O(^ICD9(+LEXIEN,"N",0)))'>0 0
"RTN","LEXQIDA",34,0)
 S LEXLSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXLSO) 0  S LEXI="",LEXCT=0 F  S LEXI=$O(^ICD9(+LEXIEN,"N","B",LEXI)) Q:'$L(LEXI)  S LEXCT=LEXCT+1
"RTN","LEXQIDA",35,0)
 Q:+($G(LEXCT))'>0 0  S LEXCTE=$S(LEXCT=1:"one",LEXCT=2:"two",LEXCT=3:"three",LEXCT=4:"four",LEXCT=5:"five",LEXCT=6:"six",LEXCT=7:"seven",LEXCT=8:"eight",LEXCT=9:"nine",1:LEXCT)
"RTN","LEXQIDA",36,0)
 S DIRB=$$RET^LEXQD("LEXQIDA","NOT",+($G(DUZ)),"Include ICD Codes not to use with") S:'$L(DIRB) DIRB="No"
"RTN","LEXQIDA",37,0)
 S DIR(0)="YAO" S:LEXCT=1 DIR("A")=" Include the single ICD Code that can not be used with "_LEXLSO_"?  (Y/N)  "
"RTN","LEXQIDA",38,0)
 S:LEXCT>1 DIR("A")=" Include the "_LEXCTE_" ICD Codes that can not be used with "_LEXLSO_"?  (Y/N)  "
"RTN","LEXQIDA",39,0)
 S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQIDA",40,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D NOTH^LEXQIDA"
"RTN","LEXQIDA",41,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQIDA",42,0)
 D:$L(DIRB) SAV^LEXQD("LEXQIDA","NOT",+($G(DUZ)),"Include ICD Codes not to use with",$G(DIRB)) S X=+Y
"RTN","LEXQIDA",43,0)
 Q X
"RTN","LEXQIDA",44,0)
NOTH ;   Include NOT Help
"RTN","LEXQIDA",45,0)
 W:'$L($G(LEXLSO)) !,?5,"Answer 'Yes' to include in the display all ICD Code(s) that can",!,?5,"not be used with the selected ICD code.  Answer 'No' to exclude",!,?5,"codes that can not not be used with the selected ICD code."
"RTN","LEXQIDA",46,0)
 W:$L($G(LEXLSO)) !,?5,"Answer 'Yes' to include all ICD Code(s) that can not be used with",!,?5,"ICD Code "_$G(LEXLSO)_".  Answer 'No' to exclude codes that can not be",!,?5,"used with ICD code "_$G(LEXLSO)_"."
"RTN","LEXQIDA",47,0)
 Q
"RTN","LEXQIDA",48,0)
 ;          
"RTN","LEXQIDA",49,0)
REQ(X) ; Include ICD Codes required with ***.**
"RTN","LEXQIDA",50,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB,LEXIEN,LEXLSO,LEXCT,LEXCTE,LEXI S LEXIEN=+($G(X)) Q:'$D(^ICD9(+LEXIEN,0)) 0  Q:+($O(^ICD9(+LEXIEN,"R",0)))'>0 0
"RTN","LEXQIDA",51,0)
 S LEXLSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXLSO) 0  S LEXI="",LEXCT=0 F  S LEXI=$O(^ICD9(+LEXIEN,"R","B",LEXI)) Q:'$L(LEXI)  S LEXCT=LEXCT+1
"RTN","LEXQIDA",52,0)
 Q:+($G(LEXCT))'>0 0  S LEXCTE=$S(LEXCT=1:"one",LEXCT=2:"two",LEXCT=3:"three",LEXCT=4:"four",LEXCT=5:"five",LEXCT=6:"six",LEXCT=7:"seven",LEXCT=8:"eight",LEXCT=9:"nine",1:LEXCT)
"RTN","LEXQIDA",53,0)
 S DIRB=$$RET^LEXQD("LEXQIDA","REQ",+($G(DUZ)),"Include ICD Required with") S:'$L(DIRB) DIRB="No"
"RTN","LEXQIDA",54,0)
 S DIR(0)="YAO" S:LEXCT=1 DIR("A")=" Include the one ICD Code that is required with "_LEXLSO_"?  (Y/N)  "
"RTN","LEXQIDA",55,0)
 S:LEXCT>1 DIR("A")=" Include the "_LEXCTE_" ICD Codes that are required with "_LEXLSO_"?  (Y/N)  "
"RTN","LEXQIDA",56,0)
 S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQIDA",57,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D REQH^LEXQIDA"
"RTN","LEXQIDA",58,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQIDA",59,0)
 D:$L(DIRB) SAV^LEXQD("LEXQIDA","REQ",+($G(DUZ)),"Include ICD Required with",$G(DIRB)) S X=+Y
"RTN","LEXQIDA",60,0)
 Q X
"RTN","LEXQIDA",61,0)
REQH ;   Include REQ Help
"RTN","LEXQIDA",62,0)
 W:'$L($G(LEXLSO)) !,?5,"Answer 'Yes' to include in the display all ICD Code(s) that are",!,?5,"required with the selected ICD code.  Answer 'No' to exclude",!,?5,"codes that are required with the selected ICD code."
"RTN","LEXQIDA",63,0)
 W:$L($G(LEXLSO)) !,?5,"Answer 'Yes' to include all ICD Code(s) that are required with",!,?5,"ICD Code "_$G(LEXLSO)_".  Answer 'No' to exclude codes that are requried",!,?5,"with ICD code "_$G(LEXLSO)_"."
"RTN","LEXQIDA",64,0)
 Q
"RTN","LEXQIDA",65,0)
 Q
"RTN","LEXQIDA",66,0)
 ;          
"RTN","LEXQIDA",67,0)
NCC(X) ; Include the codes that ***.** is not CC with
"RTN","LEXQIDA",68,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,Y,DIRB,LEXIEN,LEXLSO,LEXCT,LEXCTE,LEXI,LEXNCC S LEXIEN=+($G(X)) Q:'$D(^ICD9(+LEXIEN,0)) 0  Q:+($O(^ICD9(+LEXIEN,"2",0)))'>0 0
"RTN","LEXQIDA",69,0)
 S LEXLSO=$P($G(^ICD9(+LEXIEN,0)),"^",1) Q:'$L(LEXLSO) 0  K ^TMP("LEXQIDA",$J,"NCC") S (LEXI,LEXCT)=0 F  S LEXI=$O(^ICD9(+LEXIEN,"2",LEXI)) Q:+LEXI'>0  D
"RTN","LEXQIDA",70,0)
 . S LEXNCC=$G(^ICD9(+LEXIEN,"2",LEXI,0)) Q:'$L(LEXNCC)  S:'$D(^TMP("LEXQIDA",$J,"NCC",LEXNCC)) LEXCT=LEXCT+1 S ^TMP("LEXQIDA",$J,"NCC",LEXNCC)=""
"RTN","LEXQIDA",71,0)
 K ^TMP("LEXQIDA",$J,"NCC") Q:+($G(LEXCT))'>0 0
"RTN","LEXQIDA",72,0)
 S LEXCTE=$S(LEXCT=1:"one",LEXCT=2:"two",LEXCT=3:"three",LEXCT=4:"four",LEXCT=5:"five",LEXCT=6:"six",LEXCT=7:"seven",LEXCT=8:"eight",LEXCT=9:"nine",1:LEXCT)
"RTN","LEXQIDA",73,0)
 S DIRB=$$RET^LEXQD("LEXQIDA","NCC",+($G(DUZ)),"Include Codes not CC with") S:'$L(DIRB) DIRB="No"
"RTN","LEXQIDA",74,0)
 S DIR(0)="YAO" S:LEXCT=1 DIR("A")=" Include the one ICD Code that "_LEXLSO_" is not CC with?  (Y/N)  "
"RTN","LEXQIDA",75,0)
 S:LEXCT>1 DIR("A")=" Include the "_LEXCTE_" ICD Codes that "_LEXLSO_" are not CC with?  (Y/N)  "
"RTN","LEXQIDA",76,0)
 S:"^YES^NO^Yes^No^"[("^"_DIRB_"^") DIR("B")=DIRB
"RTN","LEXQIDA",77,0)
 S DIR("PRE")="S:X[""?"" X=""??""" S (DIR("?"),DIR("??"))="^D NCCH^LEXQIDA"
"RTN","LEXQIDA",78,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIRUT)!($D(DIROUT))!($D(DTOUT))!($D(DUOUT)) "^" S DIRB=$S(Y=1:"Yes",Y=0:"No",X["^":"",1:"")
"RTN","LEXQIDA",79,0)
 D:$L(DIRB) SAV^LEXQD("LEXQIDA","NCC",+($G(DUZ)),"Include Codes not CC with",$G(DIRB)) S X=+Y
"RTN","LEXQIDA",80,0)
 Q X
"RTN","LEXQIDA",81,0)
NCCH ;   Include NCC Help
"RTN","LEXQIDA",82,0)
 I $L($G(LEXLSO)),$L($G(LEXCT)) D
"RTN","LEXQIDA",83,0)
 . W !,?5,"Code ",LEXLSO," is not considered as Complication/Comorbidity (CC)"
"RTN","LEXQIDA",84,0)
 . W !,?5,"with ",$S(+($G(LEXCT))>1:"some codes.",1:"one code."),"  Answer 'Yes' to include "
"RTN","LEXQIDA",85,0)
 . I +($G(LEXCT))>1 W "these codes.  Answer",!,?5,"'No' to exclude these codes."
"RTN","LEXQIDA",86,0)
 . I +($G(LEXCT))'>1 W "this code.  Answer 'No'",!,?5,"to exclude this code."
"RTN","LEXQIDA",87,0)
 . Q
"RTN","LEXQIDA",88,0)
 . W $S(+($G(LEXCT))>1:"these codes.  Answer 'No'",1:"this code.  Answer 'No'")
"RTN","LEXQIDA",89,0)
 . W $S(+($G(LEXCT))>1:"these codes.  Answer 'No'",1:"this code.  Answer 'No'")
"RTN","LEXQIDA",90,0)
 I $L($G(LEXLSO)),'$L($G(LEXCT)) D
"RTN","LEXQIDA",91,0)
 . W !,?5,"Code "_LEXLSO_" is not considered as Complication/Comorbidity (CC)"
"RTN","LEXQIDA",92,0)
 . W !,?5,"with some codes.  Answer 'Yes' to include these codes.  Answer",!,?5,"'No' to exclude these codes."
"RTN","LEXQIDA",93,0)
 I '$L($G(LEXLSO)),'$L($G(LEXCT)) D
"RTN","LEXQIDA",94,0)
 . W !,?5,"This code is not considered as Complication/Comorbidity (CC)"
"RTN","LEXQIDA",95,0)
 . W !,?5,"with some codes.  Answer 'Yes' to include these codes.  Answer ",!,?5,"'No' to exclude these codes."
"RTN","LEXQIDA",96,0)
 Q
"RTN","LEXQIDA",97,0)
 ;          
"RTN","LEXQIDA",98,0)
SD(X) ; Short Date
"RTN","LEXQIDA",99,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQIDA",100,0)
CLR ; Clear
"RTN","LEXQIDA",101,0)
 N LEXCDT,LEXEXIT
"RTN","LEXQIDA",102,0)
 Q
"RTN","LEXQIP")
0^17^B67652599^n/a
"RTN","LEXQIP",1,0)
LEXQIP ;ISL/KER - Query - ICD Procedure - Extract ;10/30/2008
"RTN","LEXQIP",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQIP",3,0)
 ;               
"RTN","LEXQIP",4,0)
 ; Global Variables
"RTN","LEXQIP",5,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQIP",6,0)
 ;    ^TMP("LEXQIP")      SACC 2.3.2.5.1
"RTN","LEXQIP",7,0)
 ;    ^TMP("LEXQIPA")     SACC 2.3.2.5.1
"RTN","LEXQIP",8,0)
 ;    ^TMP("LEXQIPO")     SACC 2.3.2.5.1
"RTN","LEXQIP",9,0)
 ;               
"RTN","LEXQIP",10,0)
 ; External References
"RTN","LEXQIP",11,0)
 ;    GETS^DIQ            ICR   2056
"RTN","LEXQIP",12,0)
 ;    HIST^ICDAPIU        ICR   3991
"RTN","LEXQIP",13,0)
 ;    $$ICDD^ICDCODE      ICR   3990
"RTN","LEXQIP",14,0)
 ;    $$ICDOP^ICDCODE     ICR   3990
"RTN","LEXQIP",15,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQIP",16,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQIP",17,0)
 ;               
"RTN","LEXQIP",18,0)
EN ; Main Entry Point
"RTN","LEXQIP",19,0)
 N LEXENV S LEXENV=$$EV^LEXQM Q:+LEXENV'>0
"RTN","LEXQIP",20,0)
 N LEXAD,LEXEDT,LEXCDT,LEXEXIT,LEXTEST S LEXEXIT=0,LEXCDT="" K ^TMP("LEXQIP",$J),^TMP("LEXQIPO",$J),^TMP("LEXQIPA",$J)
"RTN","LEXQIP",21,0)
 F  S LEXCDT=$$AD^LEXQM,LEXAD=LEXCDT Q:'$L(LEXCDT)  S LEXEDT=$P(LEXCDT,"^",1),LEXCDT=$P(LEXCDT,"^",2) Q:LEXCDT'?7N  D LOOK Q:LEXCDT'?7N  Q:+LEXEXIT>0
"RTN","LEXQIP",22,0)
 K ^TMP("LEXQIP",$J),^TMP("LEXQIPO",$J),^TMP("LEXQIPA",$J)
"RTN","LEXQIP",23,0)
 Q
"RTN","LEXQIP",24,0)
LOOK ; ICD Lookup Loop
"RTN","LEXQIP",25,0)
 N LEXGET,LEXDG,LEXST,LEXSD,LEXLD,LEXMOR,LEXWN,LEXCC,LEXMC,LEXICP,LEXICPC S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S LEXCDT="" Q
"RTN","LEXQIP",26,0)
 S LEXLEN=62 F  S LEXICP=$$ICP^LEXQIPA S:LEXICP="^^" LEXEXIT=1 Q:LEXICP="^"!(LEXICP="^^")  D  Q:LEXICP="^"!(LEXICP="^^")
"RTN","LEXQIP",27,0)
 . K LEXGET,LEXST,LEXSD,LEXLD,LEXWN,LEXCC,LEXMOR,LEXMC,^TMP("LEXQIP",$J) N LEXIEN,LEXLDT,LEXELDT,LEXINC,LEXINOT,LEXIREQ,LEXINCC
"RTN","LEXQIP",28,0)
 . S LEXIEN=+($G(LEXICP)),LEXLDT=+($G(LEXCDT)) Q:+LEXIEN'>0  Q:LEXLDT'?7N  S LEXELDT=$$SD^LEXQM(LEXLDT) Q:'$L(LEXELDT)
"RTN","LEXQIP",29,0)
 . D CSV,EN^LEXQIP3
"RTN","LEXQIP",30,0)
 Q
"RTN","LEXQIP",31,0)
CSV ; Code Set Versioning Display
"RTN","LEXQIP",32,0)
 N LEXEDT,LEXIEN,LEXIENS,LEXLTXT,LEXSO,LEXSTAT,LEXNAM
"RTN","LEXQIP",33,0)
 S LEXCDT=$G(LEXCDT),LEXEDT=$$ED^LEXQM(LEXCDT) I LEXCDT'?7N S (LEXICP,LEXCDT)="" Q
"RTN","LEXQIP",34,0)
 S LEXIEN=+($G(LEXICP)),LEXSO=$P($G(LEXICP),"^",2),LEXLTXT=$P($G(LEXICP),"^",3) Q:+LEXIEN'>0  Q:'$L(LEXSO)
"RTN","LEXQIP",35,0)
 S LEXNAM=$P($$ICDOP^ICDCODE(LEXSO,LEXCDT),"^",5) I '$L(LEXNAM) D
"RTN","LEXQIP",36,0)
 . S LEXNAM=$O(^ICD0(+LEXIEN,67,"B"," "),-1)
"RTN","LEXQIP",37,0)
 . S LEXNAM=$O(^ICD0(+LEXIEN,67,"B",+LEXNAM," "),-1)
"RTN","LEXQIP",38,0)
 . S LEXNAM=$P($G(^ICD0(+LEXIEN,67,+LEXNAM,0)),"^",2)
"RTN","LEXQIP",39,0)
 . S:'$L(LEXNAM) LEXNAM=$P($G(^ICD0(+LEXIEN,0)),"^",3)
"RTN","LEXQIP",40,0)
 Q:'$L($G(LEXNAM))
"RTN","LEXQIP",41,0)
 ;
"RTN","LEXQIP",42,0)
 ; Get the "Unversioned" Fields
"RTN","LEXQIP",43,0)
 ; 
"RTN","LEXQIP",44,0)
 ;   ICD Code             Field .01
"RTN","LEXQIP",45,0)
 ;   Sex                  Field 9.5
"RTN","LEXQIP",46,0)
 ;   Major O.R. Proc      Field 20
"RTN","LEXQIP",47,0)
 S LEXIENS=LEXIEN_"," D GETS^DIQ(80.1,LEXIENS,".01;9.5;20","IE","LEXGET","LEXMSG")
"RTN","LEXQIP",48,0)
 S LEXGET(80.1,(+LEXIEN_","),"B")=$G(LEXNAM)
"RTN","LEXQIP",49,0)
 S LEXTMP=$G(LEXGET(80.1,(+LEXIEN_","),20,"E")) D:$L(LEXTMP) OR^LEXQIP2(LEXTMP,.LEXMOR)
"RTN","LEXQIP",50,0)
 ;            
"RTN","LEXQIP",51,0)
 ; Get the "Versioned" Fields
"RTN","LEXQIP",52,0)
 ;            
"RTN","LEXQIP",53,0)
 ;   Date/Status          80.166  (66)
"RTN","LEXQIP",54,0)
 S LEXST=$$EF(+($G(LEXIEN)),+LEXCDT),LEXSTAT=+($P(LEXST,"^",2))
"RTN","LEXQIP",55,0)
 ;   Procedure Name       80.167  (67)
"RTN","LEXQIP",56,0)
 D SDS(+($G(LEXIEN)),+LEXCDT,.LEXSD,62,LEXSTAT)
"RTN","LEXQIP",57,0)
 ;   Description          80.168  (68)
"RTN","LEXQIP",58,0)
 D LDS(+($G(LEXIEN)),+LEXCDT,.LEXLD,62,LEXSTAT)
"RTN","LEXQIP",59,0)
 ;   Warning Message
"RTN","LEXQIP",60,0)
 D WN(+LEXCDT,.LEXWN,62)
"RTN","LEXQIP",61,0)
 ;   MDC/DRG Groups       80.171  (71)
"RTN","LEXQIP",62,0)
 D MDCDRG^LEXQIP2(+LEXIEN,+LEXCDT,.LEXDG,LEXLEN)
"RTN","LEXQIP",63,0)
 Q
"RTN","LEXQIP",64,0)
 ;      
"RTN","LEXQIP",65,0)
EF(X,LEXCDT) ; Effective Dates
"RTN","LEXQIP",66,0)
 N LEX,LEXAD,LEXBRD,LEXBRW,LEXEE,LEXEF,LEXES,LEXFA,LEXH,LEXI,LEXID,LEXIEN,LEXLS,LEXSO,LEXST S LEXIEN=+($G(X)),LEXCDT=+($G(LEXCDT))
"RTN","LEXQIP",67,0)
 Q:+LEXIEN'>0 "^^"  Q:'$L(^ICD0(+LEXIEN,0)) "^^"  Q:LEXCDT'?7N "^^"  S LEXSO=$P($G(^ICD0(+LEXIEN,0)),"^",1)
"RTN","LEXQIP",68,0)
 S LEX=$$ICDOP^ICDCODE(LEXSO,LEXCDT) S LEXFA=$$FA(+LEXIEN),(LEXLS,LEXST)=$P(LEX,"^",10),LEXID=$P(LEX,"^",12),LEXAD=$P(LEX,"^",13),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQIP",69,0)
 S:LEXCDT<LEXBRD&(+LEXFA=LEXBRD) LEXBRW="Warning:  The 'Based on Date' provided precedes the initial Code Set Business Rule date of "_$$SD^LEXQM(LEXBRD)_", the Effective date may be inaccurate."
"RTN","LEXQIP",70,0)
 S LEXES=$S(+LEXST>0:"Active",1:"Inactive")
"RTN","LEXQIP",71,0)
 S:+LEXST'>0&(+LEXAD'>0) LEXES="Not Applicable",LEXLS=-1 S:LEXST>0 LEXEF=LEXAD S:LEXST'>0 LEXEF=LEXID
"RTN","LEXQIP",72,0)
 S:LEXST'>0&(+LEXID'>0) LEXEF=LEXFA S LEXEE=$$SD^LEXQM(LEXEF)
"RTN","LEXQIP",73,0)
 I LEXST'>0,+LEXID'>0,$L(LEXEE),+LEXEF>LEXCDT S LEXEE="(future activation of "_LEXEE_")",LEXEF=""
"RTN","LEXQIP",74,0)
 S X=LEXLS_"^"_LEXST_"^"_LEXEF_"^"_LEXES_"^"_LEXEE S:$L(LEXBRW) $P(X,"^",6)=LEXBRW
"RTN","LEXQIP",75,0)
 Q X
"RTN","LEXQIP",76,0)
 ; 
"RTN","LEXQIP",77,0)
SDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Diagnosis (short description)
"RTN","LEXQIP",78,0)
 ; 
"RTN","LEXQIP",79,0)
 ; LEX=# of Lines
"RTN","LEXQIP",80,0)
 ; LEX(0)=External Date of Diagnosis Name
"RTN","LEXQIP",81,0)
 ; LEX(#)=Diagnosis Name
"RTN","LEXQIP",82,0)
 ; 
"RTN","LEXQIP",83,0)
 N LEXD,LEXBRD,LEXBRW,LEXDDT,LEXE,LEXEE,LEXEFF,LEXFA,LEXHIS,LEXI,LEXIA,LEXIEN,LEXL,LEXLAST,LEXLEF,LEXLHI,LEXM,LEXR,LEXSDT,LEXSO,LEXLSD,LEXT
"RTN","LEXQIP",84,0)
 S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICD0(+LEXIEN,67))  S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXSTA=+($G(LEXSTA))
"RTN","LEXQIP",85,0)
 S LEXSO=$P($G(^ICD0(+LEXIEN,0)),"^",1),LEXLAST=$$ICDOP^ICDCODE(LEXSO),LEXLSD=$P(LEXLAST,"^",5),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQIP",86,0)
 S:$D(LEXGET)&($L(LEXLSD)) LEXGET(80.1,(+LEXIEN_","),"B")=LEXLSD
"RTN","LEXQIP",87,0)
 S LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 S LEXFA=$$FA(+LEXIEN),LEXM=""
"RTN","LEXQIP",88,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Diagnosis Short Name is not available.  The date provided precedes the initial activation of the code" I $L(LEXM) D  Q
"RTN","LEXQIP",89,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQIP",90,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQIP",91,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQIP",92,0)
 S LEXM="" S LEXEFF=$O(^ICD0(LEXIEN,67,"B",(LEXVDT+.001)),-1),LEXHIS=$O(^ICD0(LEXIEN,67,"B",+LEXEFF," "),-1),LEXSDT=$P($G(^ICD0(+LEXIEN,67,+LEXHIS,0)),"^",2)
"RTN","LEXQIP",93,0)
 S LEXLEF=$O(^ICD0(LEXIEN,67,"B",(9999999+.001)),-1),LEXLHI=$O(^ICD0(LEXIEN,67,"B",+LEXLEF," "),-1),LEXDDT=$P($G(^ICD0(+LEXIEN,67,+LEXLHI,0)),"^",2)
"RTN","LEXQIP",94,0)
 S (LEXD,LEXE,LEXR)="" S:$L(LEXSDT)&(LEXEFF?7N) LEXD=LEXSDT,LEXE=LEXEFF
"RTN","LEXQIP",95,0)
 S:$L(LEXDDT)&(LEXLEF?7N)&('$L(LEXD))&('$L(LEXE)) LEXD=LEXDDT,LEXE=LEXLEF,LEXR="No Text Available for Date Provided"
"RTN","LEXQIP",96,0)
 K LEX S LEX(1)=LEXD S:$L(LEXD) LEXGET(80.1,(+LEXIEN_","),"B")=LEXD
"RTN","LEXQIP",97,0)
 S LEXEE=$$SD^LEXQM(LEXE) S:$D(LEXTEST)&(+LEXSTA'>0) LEXEE="--/--/----" S:$L(LEX(1)) LEX(0)=LEXEE
"RTN","LEXQIP",98,0)
 S LEX=+($O(LEX(" "),-1))
"RTN","LEXQIP",99,0)
 Q
"RTN","LEXQIP",100,0)
LDS(X,LEXVDT,LEX,LEXLEN,LEXSTA) ; Long Description
"RTN","LEXQIP",101,0)
 ; 
"RTN","LEXQIP",102,0)
 ; LEX=# of Lines
"RTN","LEXQIP",103,0)
 ; LEX(0)=External Date of Description
"RTN","LEXQIP",104,0)
 ; LEX(#)=Description
"RTN","LEXQIP",105,0)
 ; 
"RTN","LEXQIP",106,0)
 N LEXC,LEXBRD,LEXBRW,LEXDDT,LEXEVDT,LEXFA,LEXI,LEXIEN,LEXL,LEXLN,LEXM,LEXT,LEXSO,LEXTL,LEXTMP S LEXIEN=$G(X) Q:+LEXIEN'>0  Q:'$D(^ICD0(+LEXIEN,68))
"RTN","LEXQIP",107,0)
 S LEXVDT=+($G(LEXVDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S LEXEVDT=$$SD^LEXQM(LEXVDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62
"RTN","LEXQIP",108,0)
 S LEXSO=$P($G(^ICD0(+LEXIEN,0)),"^",1) S LEXFA=$$FA(+LEXIEN),LEXM="" S LEXSTA=+($G(LEXSTA)),LEXBRD=2781001,LEXBRW=""
"RTN","LEXQIP",109,0)
 S LEXM="" S:+LEXVDT<LEXFA&(LEXFA'=LEXBRD) LEXM="Description is not available.  The date provided precedes the initial activation of the code" I $L(LEXM) D  Q
"RTN","LEXQIP",110,0)
 . K LEX N LEXT,LEXI S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7)) S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  S LEXT=$G(LEXT(LEXI)) S LEX(LEXI)=LEXT
"RTN","LEXQIP",111,0)
 . S:$D(LEX(1)) LEX(0)="--/--/----" S LEX=+($O(LEX(" "),-1))
"RTN","LEXQIP",112,0)
 K LEXTMP S LEXTL=$$ICDD^ICDCODE(LEXSO,"LEXTMP",LEXVDT) S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$G(LEXTMP(+LEXL))
"RTN","LEXQIP",113,0)
 S LEXM="" K:LEXL>0&(LEXLN["CODE TEXT MAY BE INACCURATE") LEXTMP(+LEXL)
"RTN","LEXQIP",114,0)
 F LEXI=1:1:2 S LEXL=+($O(LEXTMP(" "),-1)),LEXLN=$$TM^LEXQM($G(LEXTMP(+LEXL))) K:LEXL>0&('$L(LEXLN)) LEXTMP(+LEXL)
"RTN","LEXQIP",115,0)
 S LEXDDT=$O(^ICD0(+LEXIEN,68,"B",(LEXVDT+.999999)),-1) S:LEXDDT'?7N LEXDDT=$O(^ICD0(+LEXIEN,68,"B",0)) S:LEXDDT?7N LEXEVDT=$$SD^LEXQM(LEXDDT)
"RTN","LEXQIP",116,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX F LEXI=1:1:13 D
"RTN","LEXQIP",117,0)
 . Q:'$D(LEXTMP(LEXI))  S LEXT=$$TM^LEXQM($G(LEXTMP(LEXI))),LEX(LEXI)=$$UP^XLFSTR(LEXT)
"RTN","LEXQIP",118,0)
 I $L(LEXM) D
"RTN","LEXQIP",119,0)
 . N LEXT,LEXI,LEXL,LEXC S LEXL=+($O(LEX(" "),-1)),LEXC=0 S LEXT(1)=LEXM D PR^LEXQM(.LEXT,(LEXLEN-7))
"RTN","LEXQIP",120,0)
 . S LEXI=0 F  S LEXI=$O(LEXT(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQIP",121,0)
 . . S LEXT=$G(LEXT(LEXI)) S:$L(LEXT) LEXC=LEXC+1 S LEXL=LEXL+1,LEX(LEXL)=LEXT
"RTN","LEXQIP",122,0)
 S:$D(LEXTEST)&(+LEXSTA'>0) LEXEVDT="--/--/----" S:$D(LEX(1)) LEX(0)=LEXEVDT S LEX=+($O(LEX(" "),-1))
"RTN","LEXQIP",123,0)
 Q
"RTN","LEXQIP",124,0)
WN(X,LEX,LEXLEN) ; Warning
"RTN","LEXQIP",125,0)
 ;            
"RTN","LEXQIP",126,0)
 ; LEX=# of Lines
"RTN","LEXQIP",127,0)
 ; LEX(0)=External Date
"RTN","LEXQIP",128,0)
 ; LEX(#)=Warning
"RTN","LEXQIP",129,0)
 ;            
"RTN","LEXQIP",130,0)
 N LEXVDT,LEXREF,LEXIA,LEXTMP K LEX S LEXVDT=$G(X) Q:LEXVDT'?7N  S LEXIA=$$IA(LEXVDT) Q:+LEXIA'>0  S LEXLEN=+$G(LEXLEN) S:+LEXLEN>62 LEXLEN=62
"RTN","LEXQIP",131,0)
 S LEXTMP(1)="Warning:  The 'Based on Date' provided precedes Code Set Versioning.  The Operation/Procedure (Short Name) and Description may be inaccurate for "_$$SD^LEXQM(LEXVDT)
"RTN","LEXQIP",132,0)
 D PR^LEXQM(.LEXTMP,LEXLEN) K LEX S LEXI=0 F  S LEXI=$O(LEXTMP(LEXI)) Q:+LEXI'>0  S LEX(LEXI)=$G(LEXTMP(LEXI))
"RTN","LEXQIP",133,0)
 S LEX=$O(LEX(" "),-1),LEX(0)=$$SD^LEXQM(LEXVDT)
"RTN","LEXQIP",134,0)
 Q
"RTN","LEXQIP",135,0)
 ; Miscellaneous
"RTN","LEXQIP",136,0)
FA(X) ;   First Activation
"RTN","LEXQIP",137,0)
 N LEXFA,LEXH,LEXI,LEXIEN,LEXSO
"RTN","LEXQIP",138,0)
 S LEXIEN=+($G(X)) S X="",LEXSO=$P($G(^ICD0(+LEXIEN,0)),"^",1) D HIST^ICDAPIU(LEXSO,.LEXH) S LEXFA="",LEXI=0
"RTN","LEXQIP",139,0)
 F  S LEXI=$O(LEXH(LEXI)) Q:+LEXI'>0!($L(LEXFA))  S:+($G(LEXH(LEXI)))>0&(LEXI?7N) LEXFA=LEXI Q:$L(LEXFA)
"RTN","LEXQIP",140,0)
 S X=LEXFA
"RTN","LEXQIP",141,0)
 Q X
"RTN","LEXQIP",142,0)
IA(X) ;   Inaccurate
"RTN","LEXQIP",143,0)
 N LEXBRD,LEXVDT,LEXSYS S LEXVDT=+($G(X)),LEXSYS=1,LEXVDT=$S($G(LEXVDT)="":$$DT^XLFDT,1:$$DBR(LEXVDT)),LEXBRD=3021001,X=$S(LEXVDT<LEXBRD:1,1:0)
"RTN","LEXQIP",144,0)
 Q X
"RTN","LEXQIP",145,0)
DBR(X) ;   Date Business Rules
"RTN","LEXQIP",146,0)
 N LEXVDT S LEXVDT=$G(X) Q:'$G(LEXVDT)!($P(LEXVDT,".")'?7N) $$DT^XLFDT
"RTN","LEXQIP",147,0)
 S:LEXVDT#10000=0 LEXVDT=LEXVDT+101 S:LEXVDT#100=0 LEXVDT=LEXVDT+1 S X=$S(LEXVDT<2781001:2781001,1:LEXVDT)
"RTN","LEXQIP",148,0)
 Q X
"RTN","LEXQIP2")
0^18^B18474806^n/a
"RTN","LEXQIP2",1,0)
LEXQIP2 ;ISL/KER - Query - ICD Procedure - Extract ;10/30/2008
"RTN","LEXQIP2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQIP2",3,0)
 ;               
"RTN","LEXQIP2",4,0)
 ; Global Variables
"RTN","LEXQIP2",5,0)
 ;    ^ICD(               ICR   4487
"RTN","LEXQIP2",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQIP2",7,0)
 ;    ^ICM(               ICR   4488
"RTN","LEXQIP2",8,0)
 ;               
"RTN","LEXQIP2",9,0)
 ; External References
"RTN","LEXQIP2",10,0)
 ;    DRGD^ICDGTDRG       ICR   4052
"RTN","LEXQIP2",11,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQIP2",12,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQIP2",13,0)
 ;               
"RTN","LEXQIP2",14,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQIP2",15,0)
 ;    LEXINT              Internal value for O.R. Procedures
"RTN","LEXQIP2",16,0)
 ;               
"RTN","LEXQIP2",17,0)
 Q
"RTN","LEXQIP2",18,0)
MDCDRG(X,LEXCDT,LEX,LEXLEN) ; Major Diagnostic Category/DRG
"RTN","LEXQIP2",19,0)
 N LEXC,LEXDI,LEXDR,LEXDRG,LEXDRG1,LEXDRG2,LEXDRGI,LEXDRGC,LEXDRGD,LEXDRI,LEXEF,LEXHR,LEXI,LEXIEN,LEXL,LEXLC,LEXN,LEXMDCC,LEXMDCE
"RTN","LEXQIP2",20,0)
 N LEXMDCI,LEXMI,LEXMR,LEXT,LEXUD,LEXUM,LEXVDT S LEXVDT=+($G(LEXCDT)) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT K LEXUM,LEXUD,LEX
"RTN","LEXQIP2",21,0)
 S LEXLC=0,LEXIEN=+($G(X)),LEXCDT=$G(LEXCDT),LEXLEN=+($G(LEXLEN)) S:+LEXLEN'>0 LEXLEN=62 Q:LEXCDT'?7N
"RTN","LEXQIP2",22,0)
 S LEXEF=$O(^ICD0(+LEXIEN,2,"B",(LEXCDT+.9999)),-1),LEXHR=$O(^ICD0(+LEXIEN,2,"B",+LEXEF," "),-1) Q:+LEXHR'>0
"RTN","LEXQIP2",23,0)
 S LEXMDCC=0,LEXMI="" F  S LEXMI=$O(^ICD0(+LEXIEN,2,+LEXHR,1,"B",LEXMI)) Q:'$L(LEXMI)  D
"RTN","LEXQIP2",24,0)
 . S LEXMR=$O(^ICD0(+LEXIEN,2,+LEXHR,1,"B",LEXMI," "),-1) Q:+LEXMR'>0
"RTN","LEXQIP2",25,0)
 . Q:'$D(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,0))  S LEXMDCI=$G(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,0)) Q:+LEXMDCI'>0
"RTN","LEXQIP2",26,0)
 . S LEXMDCE=$P($G(^ICM(+LEXMDCI,0)),"^",1) Q:'$L(LEXMDCE)  Q:$D(LEXUM(LEXMDCE))
"RTN","LEXQIP2",27,0)
 . S LEXMDCC=+($G(LEXMDCC))+1 S LEXLC=LEXLC+1,LEX(LEXLC)=LEXMDCE
"RTN","LEXQIP2",28,0)
 . S LEXDRGC=0  S LEXDI="" F  S LEXDI=$O(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,1,"B",LEXDI)) Q:'$L(LEXDI)  D
"RTN","LEXQIP2",29,0)
 . . S LEXDR=$O(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,1,"B",LEXDI," "),-1) Q:+LEXDR'>0
"RTN","LEXQIP2",30,0)
 . . Q:'$D(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,1,+LEXDR,0))  S LEXDRGI=$G(^ICD0(+LEXIEN,2,+LEXHR,1,+LEXMR,1,+LEXDR,0)) Q:+LEXDRGI'>0
"RTN","LEXQIP2",31,0)
 . . N LEXC,LEXDRG,LEXDRG1,LEXDRG2,LEXDRGC,LEXI,LEXDRGD,LEXL,LEXN,LEXT S LEXDRG=$P($G(^ICD(+LEXDRGI,0)),"^",1) K LEXDRGD
"RTN","LEXQIP2",32,0)
 . . D DRGD^ICDGTDRG(LEXDRG,"LEXDRGD",,+LEXVDT) S LEXDRG=$TR(LEXDRG,"DRG",""),LEXDRG=+LEXDRG Q:+LEXDRG'>0  S LEXI=0
"RTN","LEXQIP2",33,0)
 . . F  S LEXI=$O(LEXDRGD(LEXI)) Q:+LEXI'>0  S LEXT=$$TM^LEXQM($G(LEXDRGD(LEXI))) I '$L(LEXT)!(LEXT["CODE TEXT MAY BE INACCURATE") K LEXDRGD(LEXI)
"RTN","LEXQIP2",34,0)
 . . S LEXDRGD=+($O(LEXDRGD(" "),-1)) D PR^LEXQM(.LEXDRGD,(LEXLEN-14)) S LEXDRG1="DRG "_LEXDRG,LEXDRG1=LEXDRG1_$J(" ",(10-$L(LEXDRG1))),LEXDRG2=$J(" ",10)
"RTN","LEXQIP2",35,0)
 . . S (LEXC,LEXI)=0 F  S LEXI=$O(LEXDRGD(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQIP2",36,0)
 . . . N LEXT,LEXL,LEXN S LEXT=$$TM^LEXQM($G(LEXDRGD(LEXI))) Q:'$L(LEXT)  S LEXC=LEXC+1 S:LEXC=1 LEXL=LEXDRG1_LEXT,LEXDRGC=+($G(LEXDRGC))+1
"RTN","LEXQIP2",37,0)
 . . . S:LEXC>1 LEXL=LEXDRG2_LEXT S LEXDRGD(LEXI)=LEXL
"RTN","LEXQIP2",38,0)
 . . S:+LEXDRGD>0 LEXDRGC=+($G(LEXDRGC))+1
"RTN","LEXQIP2",39,0)
 . . S (LEXC,LEXI)=0 F  S LEXI=$O(LEXDRGD(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQIP2",40,0)
 . . . N LEXT S LEXT=$G(LEXDRGD(LEXI)) Q:'$L(LEXT)  S LEXC=LEXC+1
"RTN","LEXQIP2",41,0)
 . . . S LEXLC=LEXLC+1,LEX(LEXLC)="    "_LEXT
"RTN","LEXQIP2",42,0)
 S:LEXEF?7N&($L(LEX(1))) LEX(0)=$$SD^LEXQM(LEXEF) S LEX=+($O(LEX(" "),-1))
"RTN","LEXQIP2",43,0)
 Q
"RTN","LEXQIP2",44,0)
MAJ(X,LEX) ; Major O.R. Procedures
"RTN","LEXQIP2",45,0)
 N LEXC,LEXCHR,LEXHDR,LEXI,LEXI1,LEXI2,LEXIDI,LEXIEN,LEXPC,LEXSTR,LEXT S LEXIEN=+($G(X)) Q:+LEXIEN'>0  Q:'$D(^ICD0(+LEXIEN,0))
"RTN","LEXQIP2",46,0)
 S LEXSTR=$P($G(^ICD0(+LEXIEN,"M")),"^",1) Q:'$L(LEXSTR)  D OR(LEXSTR,.LEX)
"RTN","LEXQIP2",47,0)
 Q
"RTN","LEXQIP2",48,0)
OR(X,LEX) ; O.R. Procedures
"RTN","LEXQIP2",49,0)
 K LEX N LEXC,LEXCHR,LEXHDR,LEXI,LEXI1,LEXI2,LEXIDI,LEXPC,LEXSTR,LEXT S LEXSTR=$G(X) Q:'$L(LEXSTR)
"RTN","LEXQIP2",50,0)
 S LEXHDR="Major O.R. ID",LEXPC=0,LEXCHR="" F LEXC=1:1  Q:'$L($E(LEXSTR,LEXC))  D
"RTN","LEXQIP2",51,0)
 . S LEXCHR=$E(LEXSTR,LEXC) Q:LEXCHR=""  F LEXI=1:1 S LEXIDI=$T(MID+LEXI),LEXIDI=$P(LEXIDI,";;",2) Q:LEXIDI="EXIT"  D
"RTN","LEXQIP2",52,0)
 . . S LEXI1=$$TM^LEXQM($P(LEXIDI,"=")),LEXI2=$$TM^LEXQM($P(LEXIDI,"=",2)) Q:$L(LEXI1)'=1  Q:LEXI1'=LEXCHR  Q:'$L(LEXI2)
"RTN","LEXQIP2",53,0)
 . . S LEXT=LEXI2 S:$D(LEXINT) LEXT=LEXT_$J(" ",(22-$L(LEXT)))_"("_LEXI1_")" S LEXPC=LEXPC+1,LEX(1,LEXPC)=$$UP^XLFSTR(LEXT)
"RTN","LEXQIP2",54,0)
 S:+($O(LEX(1," "),-1))>0 LEX(0)=$$UP^XLFSTR(LEXHDR),LEX(1)=$$UP^XLFSTR(LEXSTR),LEX=+($O(LEX(1," "),-1))
"RTN","LEXQIP2",55,0)
 Q
"RTN","LEXQIP2",56,0)
MID ; Major O.R. Procedures Text
"RTN","LEXQIP2",57,0)
 ;;1=Bowel
"RTN","LEXQIP2",58,0)
 ;;2=Chest
"RTN","LEXQIP2",59,0)
 ;;3=Lymphoma/Leukemia
"RTN","LEXQIP2",60,0)
 ;;4=Joint
"RTN","LEXQIP2",61,0)
 ;;5=Pancreas/Liver
"RTN","LEXQIP2",62,0)
 ;;6=Pelvic
"RTN","LEXQIP2",63,0)
 ;;7=Shoulder/Elbow
"RTN","LEXQIP2",64,0)
 ;;8=Thumb/Joint
"RTN","LEXQIP2",65,0)
 ;;9=Head/Neck
"RTN","LEXQIP2",66,0)
 ;;A=Cardio
"RTN","LEXQIP2",67,0)
 ;;M=Musculoskeletal
"RTN","LEXQIP2",68,0)
 ;;EXIT
"RTN","LEXQIP2",69,0)
 Q
"RTN","LEXQIP2",70,0)
CLR ; Clear
"RTN","LEXQIP2",71,0)
 N LEXINT
"RTN","LEXQIP2",72,0)
 Q
"RTN","LEXQIP3")
0^19^B28551473^n/a
"RTN","LEXQIP3",1,0)
LEXQIP3 ;ISL/KER - Query - ICD Procedure - Save ;10/30/2008
"RTN","LEXQIP3",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQIP3",3,0)
 ;               
"RTN","LEXQIP3",4,0)
 ; Global Variables
"RTN","LEXQIP3",5,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQIP3",6,0)
 ;    ^TMP("LEXQIDO")     SACC 2.3.2.5.1
"RTN","LEXQIP3",7,0)
 ;               
"RTN","LEXQIP3",8,0)
 ; External References
"RTN","LEXQIP3",9,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQIP3",10,0)
 ;               
"RTN","LEXQIP3",11,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQIP3",12,0)
 ;     LEXIEN             CPT Internal Entry Number
"RTN","LEXQIP3",13,0)
 ;     LEXLEN             Offset Length
"RTN","LEXQIP3",14,0)
 ;     LEXGET             Array of Non-Versioned Data
"RTN","LEXQIP3",15,0)
 ;     LEXST              CPT Status and Effective Dates
"RTN","LEXQIP3",16,0)
 ;     LEXSD              Versioned Short Description
"RTN","LEXQIP3",17,0)
 ;     LEXLD              Versioned Long Description
"RTN","LEXQIP3",18,0)
 ;     LEXWN              Warning
"RTN","LEXQIP3",19,0)
 ;     LEXMOR             Major O.R. Procedure
"RTN","LEXQIP3",20,0)
 ;     LEXDG              MDC/DRG
"RTN","LEXQIP3",21,0)
 ;     LEXELDT            External Last Date
"RTN","LEXQIP3",22,0)
 ;              
"RTN","LEXQIP3",23,0)
EN ; Main Entry Point
"RTN","LEXQIP3",24,0)
 K ^TMP("LEXQIDO",$J) Q:'$L($G(LEXELDT))  I +($G(LEXST))<0 D FUT D:$D(^TMP("LEXQIDO",$J)) DSP^LEXQO("LEXQIDO") Q
"RTN","LEXQIP3",25,0)
 D FUL D:$D(^TMP("LEXQIDO",$J)) DSP^LEXQO("LEXQIDO")
"RTN","LEXQIP3",26,0)
 Q
"RTN","LEXQIP3",27,0)
FUT ; Future Activation
"RTN","LEXQIP3",28,0)
 N LEX1,LEX2,LEX3,LEXEFF,LEXI,LEXL,LEXNAM,LEXSO,LEXSTA S LEXI=+($G(LEXIEN)) Q:+LEXI'>0  Q:'$D(^ICD9(+LEXI,0))  S LEXL=+($G(LEXLEN)) Q:+LEXL'>0
"RTN","LEXQIP3",29,0)
 S:LEXL>62 LEXL=62 S LEXSO=$G(LEXGET(80.1,(+LEXI_","),.01,"E")) Q:'$L(LEXSO)  S LEXNAM=$G(LEXGET(80.1,(+LEXI_","),"B")) Q:'$L(LEXNAM)
"RTN","LEXQIP3",30,0)
 S LEXSTA=$G(LEXST),LEXEFF=$P(LEXSTA,"^",5),LEXSTA=$P(LEXSTA,"^",4) Q:'$L(LEXSTA)  Q:'$L(LEXEFF)  S (LEX1,LEX2,LEX3)=""
"RTN","LEXQIP3",31,0)
 D BOD(LEXELDT),COD(LEXSO,LEXNAM,+($G(LEXL))),STA(.LEXST,+($G(LEXL)))
"RTN","LEXQIP3",32,0)
 Q
"RTN","LEXQIP3",33,0)
BOD(X) ;   Based on Date
"RTN","LEXQIP3",34,0)
 N LEXBOD S LEXBOD=$G(X),X="Display based on date:  "_LEXBOD D BL,TL(X)
"RTN","LEXQIP3",35,0)
 Q
"RTN","LEXQIP3",36,0)
COD(X,Y,LEXLEN) ;   Code Line
"RTN","LEXQIP3",37,0)
 N LEXC,LEXN,LEXT S LEXC=$G(X),LEXN=$G(Y),LEXT="Code:  "_LEXC,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQIP3",38,0)
 Q
"RTN","LEXQIP3",39,0)
STA(X,LEXLEN) ;   Status Line
"RTN","LEXQIP3",40,0)
 N LEX,LEXC,LEXX,LEXE,LEXI,LEXN,LEXS,LEXT,LEXW,LEXEFF,LEXSTA
"RTN","LEXQIP3",41,0)
 S LEXX=$G(X),LEXSTA=$P(LEXX,"^",4),LEXEFF=$P(LEXX,"^",5),LEXEFF=$TR(LEXEFF,"()",""),LEXW=$P(LEXX,"^",6)
"RTN","LEXQIP3",42,0)
 S LEXT="  Status:  ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXSTA
"RTN","LEXQIP3",43,0)
 S LEXT=LEXT_$J(" ",(35-$L(LEXT)))_"Effective:  "_$$UP^XLFSTR($E(LEXEFF,1))_$E(LEXEFF,2,$L(LEXEFF)) D BL,TL(LEXT)
"RTN","LEXQIP3",44,0)
 I $L(LEXW) D
"RTN","LEXQIP3",45,0)
 . N LEX,LEXT,LEXC,LEXI,LEXN S LEX(1)=LEXW D PR^LEXQM(.LEX,(LEXLEN-7)) Q:+($O(LEX(" "),-1))'>0
"RTN","LEXQIP3",46,0)
 . S LEXT=$J(" ",((79-+($G(LEXLEN)))))
"RTN","LEXQIP3",47,0)
 . S (LEXC,LEXI)=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI'>0  D
"RTN","LEXQIP3",48,0)
 . . N LEXN S LEXN=$$TM^LEXQM($G(LEX(LEXI))) S:$L(LEXN) LEXC=LEXC+1 D:LEXC=1 BL D TL((LEXT_LEXN))
"RTN","LEXQIP3",49,0)
 Q
"RTN","LEXQIP3",50,0)
FUL ; Full Display
"RTN","LEXQIP3",51,0)
 N LEXFUL,LEX,LEXL S LEXL=+($G(LEXLEN)) S:LEXL>62 LEXL=62
"RTN","LEXQIP3",52,0)
 S LEXFUL=""  D FUT
"RTN","LEXQIP3",53,0)
 D LIM(+($G(LEXIEN)),+($G(LEXL)))
"RTN","LEXQIP3",54,0)
 D SD(.LEXSD,+($G(LEXL)))
"RTN","LEXQIP3",55,0)
 D LD(.LEXLD,+($G(LEXL)))
"RTN","LEXQIP3",56,0)
 D WN(.LEXWN,+($G(LEXL)))
"RTN","LEXQIP3",57,0)
 D MOR(.LEXMOR,+($G(LEXL)))
"RTN","LEXQIP3",58,0)
 D DRG(.LEXDG,+($G(LEXL)))
"RTN","LEXQIP3",59,0)
 Q
"RTN","LEXQIP3",60,0)
LIM(X,LEXLEN) ;   Limitations - Sex
"RTN","LEXQIP3",61,0)
 N LEXC,LEXGET,LEXH,LEXI,LEXS,LEXT S LEXC=0,LEXI=+($G(X)) S LEXS=$G(LEXGET(80.1,(+LEXI_","),9.5,"E")) Q:'$L(LEXS)
"RTN","LEXQIP3",62,0)
 S LEXH="Use only with the " S:LEXS="FEMALE" LEXH=LEXH_"female sex" S:LEXS="MALE" LEXH=LEXH_"male sex" Q:LEXS'="FEMALE"&(LEXS'="MALE")
"RTN","LEXQIP3",63,0)
 S LEXT="  Limitations: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXH
"RTN","LEXQIP3",64,0)
 D BL,TL(LEXT) S LEXC=1
"RTN","LEXQIP3",65,0)
 Q
"RTN","LEXQIP3",66,0)
SD(X,LEXLEN) ;   Short Description
"RTN","LEXQIP3",67,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Short Name: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQIP3",68,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQIP3",69,0)
 Q
"RTN","LEXQIP3",70,0)
LD(X,LEXLEN) ;   Long Description
"RTN","LEXQIP3",71,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)),LEXT="  Description: ",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT)
"RTN","LEXQIP3",72,0)
 S LEXE=$G(X(0)),LEXT="    "_LEXE,LEXN=$G(X(2)),LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D TL(LEXT)
"RTN","LEXQIP3",73,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))) S LEXI=2 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQIP3",74,0)
 Q
"RTN","LEXQIP3",75,0)
WN(X,LEXLEN) ;   Warning
"RTN","LEXQIP3",76,0)
 N LEXI,LEXH,LEXE,LEXN,LEXT,LEXC Q:'$D(X(1))  S LEXC=0,LEXN=$G(X(1)),LEXT="",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN
"RTN","LEXQIP3",77,0)
 D:$L($G(LEXLD(2))) BL D TL(LEXT)
"RTN","LEXQIP3",78,0)
 S LEXT=$J(" ",((79-+($G(LEXLEN))))),LEXI=1 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=LEXT_$G(X(LEXI)) D TL(LEXN)
"RTN","LEXQIP3",79,0)
 Q
"RTN","LEXQIP3",80,0)
MOR(X,LEXLEN) ;   Major OR Procedure
"RTN","LEXQIP3",81,0)
 N LEXE,LEXH,LEXI,LEXID,LEXN,LEXT Q:'$D(X(1))  Q:'$D(X(1,1))  S LEXID=$G(X(1)) Q:'$L(LEXID)  S LEXN=$G(X(1,1)) Q:'$L(LEXN)
"RTN","LEXQIP3",82,0)
 S LEXT="  Major OR Proc",LEXE="Major O.R. Procedure",LEXE=LEXN,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXE D BL,TL(LEXT)
"RTN","LEXQIP3",83,0)
 S LEXI=1 F  S LEXI=$O(X(1,LEXI)) Q:+LEXI'>0  S LEXE=$G(X(1,LEXI)) I $L(LEXE) S LEXT=$J(" ",((79-+($G(LEXLEN)))))_LEXE D TL(LEXT)
"RTN","LEXQIP3",84,0)
 Q
"RTN","LEXQIP3",85,0)
DRG(X,LEXLEN) ;   Major Diagnostic Category/DRG
"RTN","LEXQIP3",86,0)
 N LEXE,LEXH,LEXI,LEXN,LEXT Q:'$D(X(1))  S LEXN=$G(X(1)) Q:'$L(LEXN)  S LEXE=$G(X(0)) S:$L(LEXE,"/")'=3 LEXE=""
"RTN","LEXQIP3",87,0)
 S LEXT="  MDC/DRG:",LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT)))_LEXN D BL,TL(LEXT) S LEXN=$G(X(2))
"RTN","LEXQIP3",88,0)
 S LEXT="    "_LEXE,LEXT=LEXT_$J(" ",((79-+($G(LEXLEN)))-$L(LEXT))) D TL((LEXT_LEXN)) S LEXT=$J(" ",(79-+($G(LEXLEN)))),LEXI=2
"RTN","LEXQIP3",89,0)
 F  S LEXI=$O(X(LEXI)) Q:+LEXI'>0  S LEXN=$G(X(LEXI)) D:$L(LEXN) TL((LEXT_LEXN))
"RTN","LEXQIP3",90,0)
 Q
"RTN","LEXQIP3",91,0)
 ;
"RTN","LEXQIP3",92,0)
 ; Miscellaneous
"RTN","LEXQIP3",93,0)
BL ;   Blank Line
"RTN","LEXQIP3",94,0)
 D TL(" ") Q
"RTN","LEXQIP3",95,0)
TL(X) ;   Text Line
"RTN","LEXQIP3",96,0)
 I $D(LEXTEST) W !,$G(X) Q
"RTN","LEXQIP3",97,0)
 N LEXI S LEXI=+($O(^TMP("LEXQIDO",$J," "),-1))+1 S ^TMP("LEXQIDO",$J,LEXI)=$G(X),^TMP("LEXQIDO",$J,0)=LEXI
"RTN","LEXQIP3",98,0)
 Q
"RTN","LEXQIP3",99,0)
CLR ;   Clear
"RTN","LEXQIP3",100,0)
 N LEXDG,LEXELDT,LEXIEN,LEXLD,LEXMOR,LEXSD,LEXST,LEXTEST,LEXWN
"RTN","LEXQIP3",101,0)
 Q
"RTN","LEXQIPA")
0^20^B3508695^n/a
"RTN","LEXQIPA",1,0)
LEXQIPA ;ISL/KER - Query - ICD Procedure - Ask ;10/30/2008
"RTN","LEXQIPA",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQIPA",3,0)
 ;               
"RTN","LEXQIPA",4,0)
 ; Global Variables
"RTN","LEXQIPA",5,0)
 ;    None
"RTN","LEXQIPA",6,0)
 ;               
"RTN","LEXQIPA",7,0)
 ; External References
"RTN","LEXQIPA",8,0)
 ;    ^DIC                ICR  10006
"RTN","LEXQIPA",9,0)
 ;    $$ICDOP^ICDCODE     ICR   3990
"RTN","LEXQIPA",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQIPA",11,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQIPA",12,0)
 ;               
"RTN","LEXQIPA",13,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQIPA",14,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQIPA",15,0)
 ;    LEXCDT              Code Set Date
"RTN","LEXQIPA",16,0)
 ;               
"RTN","LEXQIPA",17,0)
 Q
"RTN","LEXQIPA",18,0)
ICP(X) ; ICD DX Code
"RTN","LEXQIPA",19,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIC,DTOUT,DUOUT,LEXDX,LEXSO,LEXDTXT,LEXVTXT,LEXVDT,Y,ICDVDT S:$G(LEXCDT)?7N ICDVDT=$G(LEXCDT)
"RTN","LEXQIPA",20,0)
 S DIC(0)="AEQMZ",DIC="^ICD0(",DIC("A")=" Select an ICD Procedure code:  " W !
"RTN","LEXQIPA",21,0)
 D ^DIC  S:$G(X)["^^"!($D(DTOUT)) LEXEXIT=1 Q:$G(X)["^^"!(+($G(LEXEXIT))>0) "^^"
"RTN","LEXQIPA",22,0)
 Q:$G(X)="^" "^"  Q:$G(X)["^^" "^^"  Q:$D(DTOUT)!($D(DUOUT)) "^"  S LEXSO=$P($G(Y),"^",2) S X="" I +Y>0,$L(LEXSO) D
"RTN","LEXQIPA",23,0)
 . S LEXVDT=$G(LEXCDT) S:LEXVDT'?7N LEXVDT=$$DT^XLFDT S X=Y,LEXDTXT=$P($G(Y(0)),"^",2),LEXDX=$$ICDOP^ICDCODE(LEXSO,LEXVDT)
"RTN","LEXQIPA",24,0)
 . S:$L($G(LEXDTXT)) LEXDTXT=LEXDTXT_" (Text not Versioned)" S LEXVTXT=$P(LEXDX,"^",5) S:'$L(LEXVTXT) LEXVTXT=LEXDTXT
"RTN","LEXQIPA",25,0)
 . S X=+Y_"^"_LEXSO S:$L(LEXVTXT) X=X_"^"_LEXVTXT
"RTN","LEXQIPA",26,0)
 S X=$$UP^XLFSTR(X) Q:'$L(X) "^"
"RTN","LEXQIPA",27,0)
 Q X
"RTN","LEXQIPA",28,0)
CLR ; Clear
"RTN","LEXQIPA",29,0)
 N LEXCDT,LEXEXIT
"RTN","LEXQIPA",30,0)
 Q
"RTN","LEXQL")
0^22^B49347251^n/a
"RTN","LEXQL",1,0)
LEXQL ;ISL/KER - Query - Lookup Code ;10/30/2008
"RTN","LEXQL",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQL",3,0)
 ;;
"RTN","LEXQL",4,0)
 ;               
"RTN","LEXQL",5,0)
 ; Global Variables
"RTN","LEXQL",6,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQL",7,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQL",8,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQL",9,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQL",10,0)
 ;    ^TMP("LEXQL")       SACC 2.3.2.5.1
"RTN","LEXQL",11,0)
 ;    ^UTILITY(           ICR  10011
"RTN","LEXQL",12,0)
 ;               
"RTN","LEXQL",13,0)
 ; External References
"RTN","LEXQL",14,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQL",15,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQL",16,0)
 ;    $$ICDOP^ICDCODE     ICR   3990
"RTN","LEXQL",17,0)
 ;    $$CPT^ICPTCOD       ICR   1995
"RTN","LEXQL",18,0)
 ;    $$MOD^ICPTMOD       ICR   1996
"RTN","LEXQL",19,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQL",20,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQL",21,0)
 ;               
"RTN","LEXQL",22,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQL",23,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQL",24,0)
 ;    LEXVDT              Versioning Date - If it does not exist
"RTN","LEXQL",25,0)
 ;                        in the environment, TODAY is used
"RTN","LEXQL",26,0)
 N DIR,DIRB,DIROUT,DIRUT,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,DTOUT,DUOUT,LEX,LEXC,LEXCOM,LEXCT,LEXCTY,LEXD,LEXDS,LEXDT,LEXE,LEXENT,LEXFD
"RTN","LEXQL",27,0)
 N LEXFI,LEXI,LEXIEN,LEXIN,LEXIT,LEXIX,LEXKEY,LEXL,LEXLAST,LEXLEN,LEXMAX,LEXN,LEXNM,LEXO,LEXOC,LEXRTN,LEXS,LEXSEL,LEXSO,LEXSS,LEXSTR,LEXT
"RTN","LEXQL",28,0)
 N LEXT1,LEXT2,LEXT3,LEXTAG,LEXTD,LEXTMP,LEXTN,LEXTOT,LEXTQ,LEXTS,LEXTTT,LEXTY,LEXUSR,LEXV,LEXVAL,LEXX,Y
"RTN","LEXQL",29,0)
 K ^TMP("LEXQL",$J),^UTILITY($J) S X=$$SO K ^TMP("LEXQL",$J),^UTILITY($J)
"RTN","LEXQL",30,0)
 Q
"RTN","LEXQL",31,0)
SO(X) ; Select a Code
"RTN","LEXQL",32,0)
 ;               
"RTN","LEXQL",33,0)
 ; Input    None
"RTN","LEXQL",34,0)
 ;             
"RTN","LEXQL",35,0)
 ; Output   X - "^" delimited string
"RTN","LEXQL",36,0)
 ;              1 - IEN
"RTN","LEXQL",37,0)
 ;              2 - Global Root
"RTN","LEXQL",38,0)
 ;              3 - File #
"RTN","LEXQL",39,0)
 ;              4 - Code
"RTN","LEXQL",40,0)
 ;              5 - Short Name
"RTN","LEXQL",41,0)
 ;            
"RTN","LEXQL",42,0)
 ;            or "^" if no code is found/selected
"RTN","LEXQL",43,0)
 ;            
"RTN","LEXQL",44,0)
 ;               
"RTN","LEXQL",45,0)
 K ^TMP("LEXQL",$J) Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIROUT,DIRUT,DTOUT,DUOUT,DIRB,LEXTD,Y,LEX S LEXTD=$G(LEXVDT) S:LEXTD'?7N LEXTD=$$DT^XLFDT
"RTN","LEXQL",46,0)
 S DIR(0)="FAO^2:30",DIR("A")=" Select a Code:  "
"RTN","LEXQL",47,0)
 S DIRB=$$RET^LEXQD("LEXQL","SO",+($G(DUZ)),"Select a Code") S:$L($P(DIRB,U,4)) DIR("B")=$P(DIRB,U,4)
"RTN","LEXQL",48,0)
 S DIR("PRE")="S X=$$SEL^LEXQL(X)"
"RTN","LEXQL",49,0)
 S (DIR("?"),DIR("??"))="^D SOH^LEXQL" D ^DIR
"RTN","LEXQL",50,0)
 I X["^^"!($D(DTOUT))!(+($G(LEXEXIT))) K ^TMP("LEXQL",$J) Q "^^"
"RTN","LEXQL",51,0)
 I '$D(^TMP("LEXQL",$J,"X")) S:$L(Y)&(Y=$P(DIRB,U,4)) ^TMP("LEXQL",$J,"X")=DIRB
"RTN","LEXQL",52,0)
 S:$D(DIROUT)!($D(DIRUT))!($D(DTOUT))!($D(DUOUT)) X="^" Q:$E(X,1)="^" X
"RTN","LEXQL",53,0)
 S X="" S:$L($G(^TMP("LEXQL",$J,"X"))) X=$G(^TMP("LEXQL",$J,"X"))
"RTN","LEXQL",54,0)
 S LEX=$P(X,U,4) D:$L(LEX) SAV^LEXQD("LEXQL","SO",+($G(DUZ)),"Select a Code",X) K ^TMP("LEXQL",$J)
"RTN","LEXQL",55,0)
 Q X
"RTN","LEXQL",56,0)
SOH ;   Select a Code Help
"RTN","LEXQL",57,0)
 W !,"     Enter a code from either:",!
"RTN","LEXQL",58,0)
 W !,"       ICD-9 Diagnosis file       #80       4-7 Characters"
"RTN","LEXQL",59,0)
 W !,"       ICD-9 Procedure file       #80.1     3-5 Characters"
"RTN","LEXQL",60,0)
 W !,"       CPT/HCPCS Procedure file   #81       5 Characters"
"RTN","LEXQL",61,0)
 W !,"       CPT Modifier file          #81.3     2 Characters",!
"RTN","LEXQL",62,0)
 W !,"     Or enter a keyword, 2-30 characters, to search for in"
"RTN","LEXQL",63,0)
 W !,"     the above files.",!
"RTN","LEXQL",64,0)
 Q
"RTN","LEXQL",65,0)
SOGD(X) ;   Select a Code Global/Data
"RTN","LEXQL",66,0)
 N LEX S LEX=$G(X) Q:'$L(LEX) "^"
"RTN","LEXQL",67,0)
 Q:$D(^ICD9("BA",(X_" "))) ("ICD9("_"^"_$$ICDDX^ICDCODE(X,$G(LEXTD)))
"RTN","LEXQL",68,0)
 Q:$D(^ICD0("BA",(X_" "))) ("ICD0("_"^"_$$ICDOP^ICDCODE(X,$G(LEXTD)))
"RTN","LEXQL",69,0)
 Q:$D(^ICPT("BA",(X_" "))) ("ICPT("_"^"_$$CPT^ICPTCOD(X,$G(LEXTD)))
"RTN","LEXQL",70,0)
 Q:$D(^DIC(81.3,"BA",(X_" "))) ("DIC(81.3,"_"^"_$$MOD^ICPTMOD(X,"E",$G(LEXTD)))
"RTN","LEXQL",71,0)
 Q ""
"RTN","LEXQL",72,0)
 ;            
"RTN","LEXQL",73,0)
SEL(X) ; Select from List
"RTN","LEXQL",74,0)
 Q:'$L($G(X)) ""  Q:$G(X)["^" $G(X)  Q:$G(X)["?" "??"  K ^TMP("LEXQL",$J) D ADD^LEXQL2($G(X)) Q:'$D(^TMP("LEXQL",$J)) "??"  D ASK
"RTN","LEXQL",75,0)
 K ^TMP("LEXQL",$J) Q:+X'>0 "??" S:+($G(X))>0 ^TMP("LEXQL",$J,"X")=X S:+($G(X))>0 X=$P($G(X),"^",4)
"RTN","LEXQL",76,0)
 Q X
"RTN","LEXQL",77,0)
ASK ;   Ask for Selection
"RTN","LEXQL",78,0)
 K X N LEXTOT S LEXTOT=+($G(^TMP("LEXQL",$J,0))) S:+LEXTOT'>0 X="^" Q:+LEXTOT'>0  K X S:+LEXTOT=1 X=$$ONE Q:+LEXTOT=1  S:+LEXTOT>1 X=$$MUL
"RTN","LEXQL",79,0)
 Q
"RTN","LEXQL",80,0)
ONE(X) ;     One Entry Found
"RTN","LEXQL",81,0)
 Q:+($G(LEXEXIT))>0 "^^"  N LEXT1,LEXT2,LEXT3,LEX,LEXC,LEXCT,LEXIEN,LEXX,DIR,Y,DTOUT,DUOUT,DIROUT,DIRUT
"RTN","LEXQL",82,0)
 S LEXT1=$G(^TMP("LEXQL",$J,1)),LEXCT=$$CT(LEXT1),LEXIEN=+LEXT1,LEXT1=$P(LEXT1,U,2),LEXT2=$G(^TMP("LEXQL",$J,1,2))
"RTN","LEXQL",83,0)
 S:$L(LEXT1)&($L(LEXT2)) LEXT1=LEXT1_" "_LEXT2 S (LEXT3,LEX(1))=LEXT1,LEXX=LEXIEN_U_$$FI(LEXT3)_U_LEXCT D PR^LEXQL3(.LEX,64)
"RTN","LEXQL",84,0)
 S DIR("A",1)=" One code found",DIR("A",2)=" ",DIR("A",3)="     "_$G(LEX(1)),LEXC=3
"RTN","LEXQL",85,0)
 S:$L($G(LEX(2))) LEXC=LEXC+1,DIR("A",LEXC)="                     "_$G(LEX(2))
"RTN","LEXQL",86,0)
 S LEXC=LEXC+1,DIR("A",LEXC)=" ",LEXC=LEXC+1,DIR("A")="   OK?  (Yes/No)  ",DIR("B")="Yes",DIR(0)="YAO" W !
"RTN","LEXQL",87,0)
 D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1,X="^^" I X["^^"!(+($G(LEXEXIT))>0) K ^TMP("LEXQL",$J) Q "^^"
"RTN","LEXQL",88,0)
 S X=$S(+Y>0:$$X(1),1:-1)
"RTN","LEXQL",89,0)
 Q X
"RTN","LEXQL",90,0)
MUL(X) ;     Multiple Entries Foudn
"RTN","LEXQL",91,0)
 Q:+($G(LEXEXIT))>0 "^^"  N LEXIEN,LEXENT,LEXT1,LEXTTT,LEXMAX,LEXI,LEXSS,LEXIT,LEXSTR,Y S (LEXMAX,LEXI,LEXSS,LEXIT)=0 S U="^"
"RTN","LEXQL",92,0)
 S LEXTTT=$G(^TMP("LEXQL",$J,0)),LEXSS=0 G:+LEXTTT=0 MULQ W ! W:+LEXTTT>1 !," ",LEXTTT," matches found"
"RTN","LEXQL",93,0)
 F LEXI=1:1:LEXTTT Q:((LEXSS>0)&(LEXSS<LEXI+1))  Q:LEXIT  D  Q:LEXIT
"RTN","LEXQL",94,0)
 . S LEXENT=$G(^TMP("LEXQL",$J,LEXI)) S LEXSTR=$P(LEXENT,U,1) Q:'$L(LEXSTR)  S LEXMAX=LEXI W:LEXI#5=1 ! D MULW
"RTN","LEXQL",95,0)
 . W:LEXI#5=0 ! S:LEXI#5=0 LEXSS=$$MULS(LEXMAX,LEXI) S:LEXSS["^" LEXIT=1
"RTN","LEXQL",96,0)
 I LEXI#5'=0,+LEXSS=0 W ! S LEXSS=$$MULS(LEXMAX,LEXI) S:LEXSS["^" LEXIT=1
"RTN","LEXQL",97,0)
 G MULQ
"RTN","LEXQL",98,0)
 Q X
"RTN","LEXQL",99,0)
MULW ;       Write Multiple
"RTN","LEXQL",100,0)
 N LEXT1,LEXT2,LEXT3,LEXIEN,LEX S LEXT1=$P(LEXENT,U,2),LEXT2=$G(^TMP("LEXQL",$J,LEXI,2)),LEXCT=$$CT(LEXT1),LEXIEN=+LEXENT
"RTN","LEXQL",101,0)
 K LEX S:$L(LEXT1)&($L(LEXT2)) LEXT1=LEXT1_" "_LEXT2 S (LEXT3,LEX(1))=LEXT1 D PR^LEXQL3(.LEX,64)
"RTN","LEXQL",102,0)
 W !,$J(LEXI,5),".  ",$G(LEX(1)) W:$L($G(LEX(2))) !,"                        ",$G(LEX(2))
"RTN","LEXQL",103,0)
 Q
"RTN","LEXQL",104,0)
MULS(LEXS,LEXI) ;       Select Multiple
"RTN","LEXQL",105,0)
 Q:+($G(LEXEXIT))>0 "^^"  N X,Y,LEXMAX,LEXLAST,DIR,DIRB,DTOUT,DUOUT,DIRUT,DIROUT,LEXTQ S LEXMAX=+($G(LEXS)),LEXLAST=+($G(LEXI)) Q:LEXMAX=0 -1
"RTN","LEXQL",106,0)
 S:+($O(^TMP("LEXQL",$J,+LEXLAST)))>0 DIR("A")=" Press <RETURN> for more, '^' to exit, or Select 1-"_LEXMAX_":  "
"RTN","LEXQL",107,0)
 S:+($O(^TMP("LEXQL",$J,+LEXLAST)))'>0 DIR("A")=" Select 1-"_LEXMAX_":  "
"RTN","LEXQL",108,0)
 S LEXTQ="    Answer must be from 1 to "_LEXMAX_", or <Return> to continue"
"RTN","LEXQL",109,0)
 S DIR("PRE")="S:X[""?"" X=""??""",(DIR("?"),DIR("??"))="^D MULSH^LEXQL"
"RTN","LEXQL",110,0)
 S DIR(0)="NAO^1:"_LEXMAX_":0" D ^DIR S:X["^^"!($D(DTOUT)) LEXEXIT=1,X="^^" I X["^^"!(+($G(LEXEXIT))>0) K ^TMP("LEXQL",$J) Q "^^"
"RTN","LEXQL",111,0)
 S LEXS=+Y S:$D(DTOUT)!(X[U) LEXS=U K DIR
"RTN","LEXQL",112,0)
 Q LEXS
"RTN","LEXQL",113,0)
MULSH ;       Select Multiple Help
"RTN","LEXQL",114,0)
 I $L($G(LEXTQ)) W !,$G(LEXTQ) Q
"RTN","LEXQL",115,0)
 Q
"RTN","LEXQL",116,0)
MULQ ;       Quit Multiple
"RTN","LEXQL",117,0)
 Q:+LEXSS'>0 -1  S X=-1 S:+($G(LEXIT))'>0 X=$$X(+LEXSS)
"RTN","LEXQL",118,0)
 Q X
"RTN","LEXQL",119,0)
 ; 
"RTN","LEXQL",120,0)
 ; Miscellaneous
"RTN","LEXQL",121,0)
X(X) ;   Set X
"RTN","LEXQL",122,0)
 N LEXCT,LEXFI,LEXIEN,LEXSEL,LEXT1,LEXT2,LEXT3 S LEXSEL=+($G(X)),LEXT1=$G(^TMP("LEXQL",$J,+($G(LEXSEL)))),LEXT2=$G(^TMP("LEXQL",$J,+($G(LEXSEL)),2))
"RTN","LEXQL",123,0)
 S LEXT3=LEXT1 S:$L(LEXT2) LEXT3=LEXT3_" "_LEXT2 S LEXCT=$$CT(LEXT3),LEXFI=$$FI(LEXT3),LEXIEN=+LEXT1,X=$$UP^XLFSTR((LEXIEN_U_LEXFI_U_LEXCT))
"RTN","LEXQL",124,0)
 Q X
"RTN","LEXQL",125,0)
CT(X) ;   Code and Text
"RTN","LEXQL",126,0)
 S X=$G(X) N LEXIEN,LEXC,LEXN,LEXT S LEXIEN=+X Q:+LEXIEN'>0 ""  S LEXT=$P(X,U,2) Q:'$L(LEXT) ""
"RTN","LEXQL",127,0)
 I LEXT["ICD Dx"!(LEXT["ICD Diag") S LEXC=$P($G(^ICD9(+LEXIEN,0)),U,1),LEXN=$P($$ICDDX^ICDCODE(LEXC,$G(LEXVDT)),U,4)
"RTN","LEXQL",128,0)
 I LEXT["ICD Op"!(LEXT["ICD Proc") S LEXC=$P($G(^ICD0(+LEXIEN,0)),U,1),LEXN=$P($$ICDOP^ICDCODE(LEXC,$G(LEXVDT)),U,5)
"RTN","LEXQL",129,0)
 I LEXT["CPT-4"!(LEXT["CPT P")!(LEXT["HCPCS") S LEXC=$P($G(^ICPT(+LEXIEN,0)),U,1),LEXN=$P($$CPT^ICPTCOD(LEXC,$G(LEXVDT)),U,3)
"RTN","LEXQL",130,0)
 I LEXT["CPT Mod" S LEXC=$P($G(^DIC(81.3,+LEXIEN,0)),U,1),LEXN=$P($$MOD^ICPTMOD(LEXIEN,"I",$G(LEXVDT)),U,3)
"RTN","LEXQL",131,0)
 S X="" S:$L($G(LEXC))&($L($G(LEXN))) X=LEXC_U_LEXN
"RTN","LEXQL",132,0)
 Q X
"RTN","LEXQL",133,0)
FI(X) ;   File
"RTN","LEXQL",134,0)
 S X=$G(X)
"RTN","LEXQL",135,0)
 Q:X["ICD Dx"!(X["ICD Diag") "ICD9(^80"
"RTN","LEXQL",136,0)
 Q:X["ICD Op"!(X["ICD Proc") "ICD0(^80.1"
"RTN","LEXQL",137,0)
 Q:X["CPT-4"!(X["CPT Proc")!(X["HCPCS") "ICPT(^81"
"RTN","LEXQL",138,0)
 Q:X["CPT Mod" "DIC(81.3,^81.3"
"RTN","LEXQL",139,0)
 Q ""
"RTN","LEXQL",140,0)
 ;
"RTN","LEXQL",141,0)
 ; Miscellaneous
"RTN","LEXQL",142,0)
CL ;   Clear
"RTN","LEXQL",143,0)
 K LEXVDT,LEXEXIT
"RTN","LEXQL",144,0)
 Q
"RTN","LEXQL2")
0^23^B36280170^n/a
"RTN","LEXQL2",1,0)
LEXQL2 ;ISL/KER - Query - Lookup Code (ICD/ICP) ;10/30/2008
"RTN","LEXQL2",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQL2",3,0)
 ;               
"RTN","LEXQL2",4,0)
 ; Global Variables
"RTN","LEXQL2",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQL2",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQL2",7,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQL2",8,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQL2",9,0)
 ;    ^TMP("LEXQL")       SACC 2.3.2.5.1
"RTN","LEXQL2",10,0)
 ;               
"RTN","LEXQL2",11,0)
 ; External References
"RTN","LEXQL2",12,0)
 ;    $$ICDDX^ICDCODE     ICR   3990
"RTN","LEXQL2",13,0)
 ;    $$ICDOP^ICDCODE     ICR   3990
"RTN","LEXQL2",14,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQL2",15,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQL2",16,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQL2",17,0)
 ;               
"RTN","LEXQL2",18,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQL2",19,0)
 ;    LEXVDT              Versioning Date - If it does not exist
"RTN","LEXQL2",20,0)
 ;                        in the environment, TODAY is used
"RTN","LEXQL2",21,0)
 ;               
"RTN","LEXQL2",22,0)
 Q
"RTN","LEXQL2",23,0)
ADD(X) ; Add to List
"RTN","LEXQL2",24,0)
 N LEXIN,LEXO,LEXOC,LEXCT,LEXTY,LEXTD,LEXTMP S LEXTD=$$DT^XLFDT,U="^"
"RTN","LEXQL2",25,0)
 S LEXIN=$$UP^XLFSTR($$TM($G(X)))
"RTN","LEXQL2",26,0)
 I LEXIN["DIAGNOSIS"!(LEXIN["DX")!(LEXIN["ICDDX")  D  Q
"RTN","LEXQL2",27,0)
 . S LEXTY=1 N LEXTMP F LEXTMP="DIAGNOSIS","ICDDX","DX" F  Q:LEXIN'[LEXTMP  S LEXIN=$P(LEXIN,LEXTMP,1)_$P(LEXIN,LEXTMP,2,299)
"RTN","LEXQL2",28,0)
 . S LEXIN=$$TM($$DS(LEXIN)),LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D ID,RE
"RTN","LEXQL2",29,0)
 I LEXIN["OPERATION"!(LEXIN["OP")!(LEXIN["ICDOP")  D  Q
"RTN","LEXQL2",30,0)
 . S LEXTY=2 N LEXTMP F LEXTMP="OPERATION","ICDOP","OP" F  Q:LEXIN'[LEXTMP  S LEXIN=$P(LEXIN,LEXTMP,1)_$P(LEXIN,LEXTMP,2,299)
"RTN","LEXQL2",31,0)
 . S LEXIN=$$TM($$DS(LEXIN)),LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D IP,RE
"RTN","LEXQL2",32,0)
 I LEXIN["PROCEDURE"!(LEXIN["CPT-4")!(LEXIN["CPT")!(LEXIN["HCPCS")  D  Q
"RTN","LEXQL2",33,0)
 . S LEXTY=3 S:LEXIN["HCPCS" LEXTY=4 N LEXTMP F LEXTMP="OPERATION","ICDOP","OP" F  Q:LEXIN'[LEXTMP  S LEXIN=$P(LEXIN,LEXTMP,1)_$P(LEXIN,LEXTMP,2,299)
"RTN","LEXQL2",34,0)
 . S LEXIN=$$TM($$DS(LEXIN)),LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D CP^LEXQL3,RE
"RTN","LEXQL2",35,0)
 I $L(LEXIN)=2,$D(^DIC(81.3,"BA",(LEXIN_" "))),$O(^DIC(81.3,"BA",(LEXIN_" "),0))>0  D  Q
"RTN","LEXQL2",36,0)
 . S LEXTY=5,LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D CM^LEXQL3,RE
"RTN","LEXQL2",37,0)
 I $L(LEXIN)=5,LEXIN'[".",$D(^ICPT("BA",(LEXIN_" "))),$O(^ICPT("BA",(LEXIN_" "),0))>0  D  Q
"RTN","LEXQL2",38,0)
 . S LEXTY=3 S:LEXIN'?5N LEXTY=4
"RTN","LEXQL2",39,0)
 . S LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D CP^LEXQL3,RE
"RTN","LEXQL2",40,0)
 I $L(LEXIN)[".",$L($P(LEXIN,"."))>2,($P(LEXIN,".")?3N!($P(LEXIN,".")?1"E"3N)!($P(LEXIN,".")?1"V"2N))  D  Q
"RTN","LEXQL2",41,0)
 . S LEXTY=1 S LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D ID,RE
"RTN","LEXQL2",42,0)
 I $L(LEXIN)[".",$L($P(LEXIN,"."))=2,$P(LEXIN,".")?2N  D  Q
"RTN","LEXQL2",43,0)
 . S LEXTY=1 S LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~" S LEXCT=LEXIN D IP,RE
"RTN","LEXQL2",44,0)
 Q:$L(LEXIN)'>1
"RTN","LEXQL2",45,0)
 S LEXOC=$E(LEXIN,1,($L(LEXIN)-1))_$C(($A($E(LEXIN,$L(LEXIN)))-1))_"~",LEXCT=LEXIN
"RTN","LEXQL2",46,0)
 D ID,IP,CP^LEXQL3,CM^LEXQL3,RE
"RTN","LEXQL2",47,0)
 Q
"RTN","LEXQL2",48,0)
RE ;   Re-Order List
"RTN","LEXQL2",49,0)
 N LEXCT,LEXO,LEXT1,LEXT2,LEX S LEXO="" F  S LEXO=$O(^TMP("LEXQL",$J,"ADDLIST",LEXO)) Q:'$L(LEXO)  D
"RTN","LEXQL2",50,0)
 . N LEXT1,LEXT2 S LEXT1=$$TM($G(^TMP("LEXQL",$J,"ADDLIST",LEXO)))
"RTN","LEXQL2",51,0)
 . S LEXT2=$$TM($G(^TMP("LEXQL",$J,"ADDLIST",LEXO,2))) Q:'$L(LEXT2)
"RTN","LEXQL2",52,0)
 . I $L(LEXT2) S LEX(1)=LEXT2 D PR^LEXQL3(.LEX,70) Q:'$L($G(LEX(1)))
"RTN","LEXQL2",53,0)
 . S LEXCT=+($G(LEXCT))+1,^TMP("LEXQL",$J,+LEXCT)=$G(LEX(1)),^TMP("LEXQL",$J,0)=+LEXCT
"RTN","LEXQL2",54,0)
 . S:$L($G(LEX(2))) ^TMP("LEXQL",$J,+LEXCT,2)=$G(LEX(2))
"RTN","LEXQL2",55,0)
 K ^TMP("LEXQL",$J,"ADDLIST")
"RTN","LEXQL2",56,0)
 Q
"RTN","LEXQL2",57,0)
 ;    
"RTN","LEXQL2",58,0)
ID ; $$ICDDX^ICDCODE(CODE,DATE)
"RTN","LEXQL2",59,0)
 ;
"RTN","LEXQL2",60,0)
 ;     1  IEN of code in ^ICD9(        1-5
"RTN","LEXQL2",61,0)
 ;     2  ICD-9 Dx Code (#.01)         4-7
"RTN","LEXQL2",62,0)
 ;     4  Versioned Dx (67)            2-30
"RTN","LEXQL2",63,0)
 ;    10  Status (66)                  6-8 (external)
"RTN","LEXQL2",64,0)
 ;    12  Inactive Date (66)           10 (external)
"RTN","LEXQL2",65,0)
 ;    17  Activation Date (66)         10 (external)
"RTN","LEXQL2",66,0)
 ;           
"RTN","LEXQL2",67,0)
 S LEXO=LEXOC Q:'$L(LEXO)  Q:'$L($G(LEXCT))  N LEXIX F LEXIX="BA","D" D
"RTN","LEXQL2",68,0)
 . Q:LEXIX="D"&(LEXOC?1N.NP)  S LEXO=LEXOC S:LEXIX="BA" LEXO=LEXO_" "
"RTN","LEXQL2",69,0)
 . F  S LEXO=$O(^ICD9(LEXIX,LEXO)) Q:'$L(LEXO)  Q:$E(LEXO,1,$L(LEXCT))'=LEXCT  D
"RTN","LEXQL2",70,0)
 . . N LEXIEN S LEXIEN=0  F  S LEXIEN=$O(^ICD9(LEXIX,LEXO,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQL2",71,0)
 . . . S LEXIEN=+($G(LEXIEN)) Q:+LEXIEN'>0  N LEXT,LEXD,LEXC,LEXD,LEXN,LEXS,LEXE,LEXDS,LEXTN,LEXTS,LEXSS,LEXDT
"RTN","LEXQL2",72,0)
 . . . S LEXC=$P($G(^ICD9(+LEXIEN,0)),U,1) Q:'$L(LEXC)  S LEXD=$G(LEXVDT) S:LEXD'?7N LEXD=$G(LEXTD) S LEXT=$$ICDDX^ICDCODE(LEXC,LEXD)
"RTN","LEXQL2",73,0)
 . . . S LEXC=$P(LEXT,U,2),LEXN=$$UP^XLFSTR($P(LEXT,U,4)),LEXS=$P(LEXT,U,10) Q:'$L(LEXC)  Q:'$L(LEXN)  Q:'$L(LEXS)
"RTN","LEXQL2",74,0)
 . . . S:+LEXS'>0 LEXE=$P(LEXT,U,12) S:+LEXS>0 LEXE=$P(LEXT,U,17) S LEXTS=$$STY^LEXQL3(LEXC),LEXTN=+LEXTS,LEXTS=$P(LEXTS,U,2) Q:'$L(LEXTS)
"RTN","LEXQL2",75,0)
 . . . S LEXSS="" S:+LEXS'>0&($L($G(LEXE))) LEXSS="(Inactive)" S LEXDS=LEXN S:$L(LEXSS) LEXDS=LEXDS_" "_LEXSS
"RTN","LEXQL2",76,0)
 . . . S LEXDT=LEXC,LEXDT=LEXDT_$J(" ",(8-$L(LEXDT)))_LEXDS S:$L(LEXTS) LEXDT=LEXDT_" ("_LEXTS_")"
"RTN","LEXQL2",77,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "))=LEXIEN_U_$$FT^LEXQL3(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL2",78,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "),2)=LEXIEN_U_$$FC^LEXQL3(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL2",79,0)
 Q
"RTN","LEXQL2",80,0)
IP ; $$ICDOP^ICDCODE(CODE,DATE)
"RTN","LEXQL2",81,0)
 ; 
"RTN","LEXQL2",82,0)
 ;     1  IEN of code in ^ICDO(        1-4
"RTN","LEXQL2",83,0)
 ;     2  ICD-9 code (.01)             3-5
"RTN","LEXQL2",84,0)
 ;     5  Versioned Oper/Proc (67)     2-50
"RTN","LEXQL2",85,0)
 ;    10  Status (66)                  6-8 (external)
"RTN","LEXQL2",86,0)
 ;    12  Inactive Date (66)           10 (external)
"RTN","LEXQL2",87,0)
 ;    13  Activation Date (66)         10 (external)
"RTN","LEXQL2",88,0)
 ;
"RTN","LEXQL2",89,0)
 S LEXO=LEXOC Q:'$L(LEXO)  Q:'$L($G(LEXCT))  N LEXIX F LEXIX="BA","D" D
"RTN","LEXQL2",90,0)
 . Q:LEXIX="D"&(LEXOC?1N.NP)  S LEXO=LEXOC S:LEXIX="BA" LEXO=LEXO_" "
"RTN","LEXQL2",91,0)
 . F  S LEXO=$O(^ICD0(LEXIX,LEXO)) Q:'$L(LEXO)  Q:$E(LEXO,1,$L(LEXCT))'=LEXCT  D
"RTN","LEXQL2",92,0)
 . . N LEXIEN S LEXIEN=0  F  S LEXIEN=$O(^ICD0(LEXIX,LEXO,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQL2",93,0)
 . . . S LEXIEN=+($G(LEXIEN)) Q:+LEXIEN'>0  N LEXT,LEXD,LEXC,LEXD,LEXN,LEXS,LEXE,LEXDS,LEXTN,LEXTS,LEXSS,LEXDT
"RTN","LEXQL2",94,0)
 . . . S LEXC=$P($G(^ICD0(+LEXIEN,0)),U,1) Q:'$L(LEXC)  S LEXD=$G(LEXVDT) S:LEXD'?7N LEXD=$G(LEXTD) S LEXT=$$ICDOP^ICDCODE(LEXC,LEXD)
"RTN","LEXQL2",95,0)
 . . . S LEXC=$P(LEXT,U,2),LEXN=$$UP^XLFSTR($P(LEXT,U,5)),LEXS=$P(LEXT,U,10) Q:'$L(LEXC)  Q:'$L(LEXN)  Q:'$L(LEXS)
"RTN","LEXQL2",96,0)
 . . . S:+LEXS'>0 LEXE=$P(LEXT,U,12) S:+LEXS>0 LEXE=$P(LEXT,U,13) S LEXTS=$$STY^LEXQL3(LEXC),LEXTN=+LEXTS,LEXTS=$P(LEXTS,U,2) Q:'$L(LEXTS)
"RTN","LEXQL2",97,0)
 . . . S LEXSS="" S:+LEXS'>0&($L($G(LEXE))) LEXSS="(Inactive)" S LEXDS=LEXN S:$L(LEXSS) LEXDS=LEXDS_" "_LEXSS
"RTN","LEXQL2",98,0)
 . . . S LEXDT=LEXC,LEXDT=LEXDT_$J(" ",(8-$L(LEXDT)))_LEXDS S:$L(LEXTS) LEXDT=LEXDT_" ("_LEXTS_")"
"RTN","LEXQL2",99,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "))=LEXIEN_U_$$FT^LEXQL3(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL2",100,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "),2)=LEXIEN_U_$$FC^LEXQL3(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL2",101,0)
 Q
"RTN","LEXQL2",102,0)
 ; Miscellaneous
"RTN","LEXQL2",103,0)
SD(X) ;   Short Date
"RTN","LEXQL2",104,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQL2",105,0)
DS(X) ;   Trim Dubble Space Character
"RTN","LEXQL2",106,0)
 S X=$G(X) Q:X'["  " X  F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,299)
"RTN","LEXQL2",107,0)
 Q X
"RTN","LEXQL2",108,0)
CL ;   Clear
"RTN","LEXQL2",109,0)
 K LEXVDT
"RTN","LEXQL2",110,0)
 Q
"RTN","LEXQL2",111,0)
TM(X,Y) ;   Trim Character Y - Default " "
"RTN","LEXQL2",112,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LEXQL2",113,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXQL2",114,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXQL2",115,0)
 Q X
"RTN","LEXQL3")
0^24^B34226328^n/a
"RTN","LEXQL3",1,0)
LEXQL3 ;ISL/KER - Query - Lookup Code (CPT/MOD) ;10/30/2008
"RTN","LEXQL3",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQL3",3,0)
 ;               
"RTN","LEXQL3",4,0)
 ; Global Variables
"RTN","LEXQL3",5,0)
 ;    ^DIC(81.3,          ICR   4492
"RTN","LEXQL3",6,0)
 ;    ^ICD0(              ICR   4485
"RTN","LEXQL3",7,0)
 ;    ^ICD9(              ICR   4485
"RTN","LEXQL3",8,0)
 ;    ^ICPT(              ICR   4489
"RTN","LEXQL3",9,0)
 ;    ^TMP("LEXQL")       SACC 2.3.2.5.1
"RTN","LEXQL3",10,0)
 ;    ^UTILITY($J         ICR  10011
"RTN","LEXQL3",11,0)
 ;               
"RTN","LEXQL3",12,0)
 ; External References
"RTN","LEXQL3",13,0)
 ;    ^DIWP               ICR  10011
"RTN","LEXQL3",14,0)
 ;    $$CPT^ICPTCOD       ICR   1995
"RTN","LEXQL3",15,0)
 ;    $$MOD^ICPTMOD       ICR   1996
"RTN","LEXQL3",16,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQL3",17,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQL3",18,0)
 ;               
"RTN","LEXQL3",19,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQL3",20,0)
 ;    LEXVDT              Versioning Date - If it does not exist
"RTN","LEXQL3",21,0)
 ;                        in the environment, TODAY is used
"RTN","LEXQL3",22,0)
 ;    LEXOC               Control $Order Variable
"RTN","LEXQL3",23,0)
 ;    LEXTD               TODAY's Date
"RTN","LEXQL3",24,0)
 Q
"RTN","LEXQL3",25,0)
CP ; $$CPT^ICPTCOD(CODE,DATE)
"RTN","LEXQL3",26,0)
 ; 
"RTN","LEXQL3",27,0)
 ;     1  IEN of code in ^ICPT         1-6
"RTN","LEXQL3",28,0)
 ;     2  CPT Code (.01)               5
"RTN","LEXQL3",29,0)
 ;     3  Versioned Short Name (#61)   1-28
"RTN","LEXQL3",30,0)
 ;     6  Effective Date (#60)         10 (external)
"RTN","LEXQL3",31,0)
 ;     7  Status (#60)                 6-8 (external)
"RTN","LEXQL3",32,0)
 ;     8  Inactivation Date (#60)      10 (external)
"RTN","LEXQL3",33,0)
 ;     9  Activation Date (#60)        10 (external)
"RTN","LEXQL3",34,0)
 ;
"RTN","LEXQL3",35,0)
 S LEXO=LEXOC Q:'$L(LEXO)  Q:'$L($G(LEXCT))  N LEXIX F LEXIX="BA","C" D
"RTN","LEXQL3",36,0)
 . Q:LEXIX="C"&(LEXOC?1N.NA)  S LEXO=LEXOC S:LEXIX="BA" LEXO=LEXO_" "
"RTN","LEXQL3",37,0)
 . F  S LEXO=$O(^ICPT(LEXIX,LEXO)) Q:'$L(LEXO)  Q:$E(LEXO,1,$L(LEXCT))'=LEXCT  D
"RTN","LEXQL3",38,0)
 . . N LEXIEN S LEXIEN=0  F  S LEXIEN=$O(^ICPT(LEXIX,LEXO,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQL3",39,0)
 . . . S LEXIEN=+($G(LEXIEN)) Q:+LEXIEN'>0  N LEXT,LEXD,LEXC,LEXD,LEXN,LEXS,LEXE,LEXDS,LEXTN,LEXTS,LEXSS,LEXDT,LEXCTY
"RTN","LEXQL3",40,0)
 . . . S LEXC=$P($G(^ICPT(+LEXIEN,0)),U,1) Q:'$L(LEXC)  S LEXD=$G(LEXVDT) S:LEXD'?7N LEXD=$G(LEXTD) S LEXT=$$CPT^ICPTCOD(LEXC,LEXD)
"RTN","LEXQL3",41,0)
 . . . S LEXC=$P(LEXT,U,2),LEXN=$$UP^XLFSTR($P(LEXT,U,3)),LEXS=$P(LEXT,U,7) Q:'$L(LEXC)  Q:'$L(LEXN)  Q:'$L(LEXS)
"RTN","LEXQL3",42,0)
 . . . S LEXE=$P(LEXT,U,6) I LEXE'?7N S:+LEXS'>0 LEXE=$P(LEXT,U,8) S:+LEXS>0 LEXE=$P(LEXT,U,9)
"RTN","LEXQL3",43,0)
 . . . S LEXTS=$$STY(LEXC),LEXTN=+LEXTS,LEXTS=$P(LEXTS,U,2) Q:'$L(LEXTS)  S:LEXC?5N LEXCTY=3 S:LEXC'?5N LEXCTY=4
"RTN","LEXQL3",44,0)
 . . . S LEXSS="" S:+LEXS'>0&($L($G(LEXE))) LEXSS="Inactive" S LEXDS=LEXN S:$L(LEXSS) LEXDS=LEXDS_" "_LEXSS
"RTN","LEXQL3",45,0)
 . . . S LEXDT=LEXC,LEXDT=LEXDT_$J(" ",(8-$L(LEXDT)))_LEXDS S:$L(LEXTS) LEXDT=LEXDT_" ("_LEXTS_")"
"RTN","LEXQL3",46,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "))=LEXIEN_U_$$FT(LEXC,LEXN,LEXSS)
"RTN","LEXQL3",47,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_" "),2)=LEXIEN_U_$$FC(LEXC,LEXN,LEXSS)
"RTN","LEXQL3",48,0)
 Q
"RTN","LEXQL3",49,0)
CM ; $$MOD(CODE,FORMAT,DATE)
"RTN","LEXQL3",50,0)
 ;
"RTN","LEXQL3",51,0)
 ;     1  IEN of code in ^DIC(81.3,    1-3
"RTN","LEXQL3",52,0)
 ;     2  Modifier (.01)               2
"RTN","LEXQL3",53,0)
 ;     3  Versioned Name (61)          1-60
"RTN","LEXQL3",54,0)
 ;     6  Effective Date (60)          10 (external)
"RTN","LEXQL3",55,0)
 ;     7  Status (60)                  6-8 (external)
"RTN","LEXQL3",56,0)
 ;     8  Inactivation Date (60)       10 (external)
"RTN","LEXQL3",57,0)
 ;     9  Activation Date (60)         10 (external)
"RTN","LEXQL3",58,0)
 ;            
"RTN","LEXQL3",59,0)
 S LEXO=LEXOC Q:'$L(LEXO)  Q:'$L($G(LEXCT))  N LEXIX F LEXIX="BA","C" D
"RTN","LEXQL3",60,0)
 . Q:LEXIX="C"&(LEXOC?1N.NA)  S LEXO=LEXOC S:LEXIX="BA" LEXO=LEXO_" "
"RTN","LEXQL3",61,0)
 . F  S LEXO=$O(^DIC(81.3,LEXIX,LEXO)) Q:'$L(LEXO)  Q:$E(LEXO,1,$L(LEXCT))'=LEXCT  D
"RTN","LEXQL3",62,0)
 . . N LEXIEN,LEXCT S (LEXCT,LEXIEN)=0  F  S LEXIEN=$O(^DIC(81.3,LEXIX,LEXO,LEXIEN)) Q:+LEXIEN'>0  D
"RTN","LEXQL3",63,0)
 . . . S LEXIEN=+($G(LEXIEN)) Q:+LEXIEN'>0  N LEXT,LEXD,LEXC,LEXD,LEXN,LEXS,LEXE,LEXDS,LEXTN,LEXTS,LEXSS,LEXDT
"RTN","LEXQL3",64,0)
 . . . S LEXC=$P($G(^DIC(81.3,+LEXIEN,0)),U,1) Q:'$L(LEXC)  S LEXD=$G(LEXVDT) S:LEXD'?7N LEXD=$G(LEXTD) S LEXT=$$MOD^ICPTMOD(LEXIEN,"I",LEXD)
"RTN","LEXQL3",65,0)
 . . . S LEXC=$P(LEXT,U,2),LEXN=$$UP^XLFSTR($P(LEXT,U,3)),LEXS=$P(LEXT,U,7) Q:'$L(LEXC)  Q:'$L(LEXN)  Q:'$L(LEXS)
"RTN","LEXQL3",66,0)
 . . . S LEXE=$P(LEXT,U,6) I LEXE'?7N S:+LEXS'>0 LEXE=$P(LEXT,U,8) S:+LEXS>0 LEXE=$P(LEXT,U,9)
"RTN","LEXQL3",67,0)
 . . . S LEXTS=$$STY(LEXC),LEXTN=+LEXTS,LEXTS=$P(LEXTS,U,2) Q:'$L(LEXTS)  S LEXSS="" S:+LEXS'>0&($L($G(LEXE))) LEXSS="(Inactive)"
"RTN","LEXQL3",68,0)
 . . . S LEXDS=LEXN S:$L(LEXSS) LEXDS=LEXDS_" "_LEXSS S LEXDT=LEXC,LEXDT=LEXDT_$J(" ",(8-$L(LEXDT)))_LEXDS S:$L(LEXTS) LEXDT=LEXDT_" ("_LEXTS_")"
"RTN","LEXQL3",69,0)
 . . . S LEXCT=LEXCT+1 S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_LEXCT_" "))=LEXIEN_U_$$FT(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL3",70,0)
 . . . S ^TMP("LEXQL",$J,"ADDLIST",(LEXTN_" "_LEXC_LEXCT_" "),2)=LEXIEN_U_$$FC(LEXC,LEXN,$TR(LEXSS,"()",""))
"RTN","LEXQL3",71,0)
 Q
"RTN","LEXQL3",72,0)
 ; Miscellaneous
"RTN","LEXQL3",73,0)
SD(X) ;   Short Date
"RTN","LEXQL3",74,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQL3",75,0)
FT(X,Y,LEX) ;   Format Text First
"RTN","LEXQL3",76,0)
 N LEXT,LEXC,LEXD,LEXS S LEXC=$G(X),LEXD=$G(Y),LEXS=$G(LEX) S LEXC=$G(LEXC) Q:'$L(LEXC) ""  S LEXT=$P($$STY(LEXC),U,2) Q:'$L(LEXT)  S LEXD=$G(LEXD) Q:'$L(LEXD) ""
"RTN","LEXQL3",77,0)
 S LEXS=$G(LEXS),LEXT=$G(LEXT) S:$L(LEXD)&($L(LEXS)) LEXD=LEXD_" ("_LEXS_")" N LEXO S LEXO=LEXC
"RTN","LEXQL3",78,0)
 S LEXO=LEXO_$J(" ",(8-$L(LEXO)))_$E(LEXD,1,54),LEXO=LEXO_$J(" ",(63-$L(LEXO)))_LEXT S X=LEXO
"RTN","LEXQL3",79,0)
 Q X
"RTN","LEXQL3",80,0)
FC(X,Y,LEX) ;   Format Code First
"RTN","LEXQL3",81,0)
 N LEXO,LEXT,LEXC,LEXD,LEXS S LEXC=$G(X),LEXD=$G(Y),LEXS=$G(LEX) Q:'$L(LEXC) ""  S LEXT=$P($$STY(LEXC),"^",2)
"RTN","LEXQL3",82,0)
 Q:'$L(LEXT) ""  Q:'$L(LEXD) ""  S LEXS=$G(LEXS),LEXO=LEXT_" "_LEXC_" " S LEXO=LEXO_$J(" ",(15-$L(LEXO))),LEXO=LEXO_" "_LEXD
"RTN","LEXQL3",83,0)
 S:$L(LEXS) LEXO=$E(LEXO,1,59)_" ("_LEXS_")" S X=LEXO
"RTN","LEXQL3",84,0)
 Q X
"RTN","LEXQL3",85,0)
STY(X) ;   Short Type
"RTN","LEXQL3",86,0)
 N LEXSO S LEXSO=$G(X) Q:$L(LEXSO)'>1 ""
"RTN","LEXQL3",87,0)
 Q:$D(^ICD9("BA",(LEXSO_" "))) "1^ICD Dx"
"RTN","LEXQL3",88,0)
 Q:$D(^ICD0("BA",(LEXSO_" "))) "2^ICD Op"
"RTN","LEXQL3",89,0)
 Q:$D(^ICPT("BA",(LEXSO_" ")))&(LEXSO?5N) "3^CPT-4"
"RTN","LEXQL3",90,0)
 Q:$D(^ICPT("BA",(LEXSO_" ")))&(LEXSO'?5N) "4^HCPCS"
"RTN","LEXQL3",91,0)
 Q:$D(^DIC(81.3,"BA",(LEXSO_" "))) "5^CPT Mod"
"RTN","LEXQL3",92,0)
 Q ""
"RTN","LEXQL3",93,0)
LTY(X) ;   Long Type
"RTN","LEXQL3",94,0)
 N LEXSO S LEXSO=$G(X) Q:$L(LEXSO)'>1 ""
"RTN","LEXQL3",95,0)
 Q:$D(^ICD9("BA",(LEXSO_" "))) "1^ICD Diagnosis Code"
"RTN","LEXQL3",96,0)
 Q:$D(^ICD0("BA",(LEXSO_" "))) "2^ICD Procedure Code"
"RTN","LEXQL3",97,0)
 Q:$D(^ICPT("BA",(LEXSO_" ")))&(LEXSO?5N) "3^CPT Procedure Code"
"RTN","LEXQL3",98,0)
 Q:$D(^ICPT("BA",(LEXSO_" ")))&(LEXSO'?5N) "4^HCPCS Procedure Code"
"RTN","LEXQL3",99,0)
 Q:$D(^DIC(81.3,"BA",(LEXSO_" "))) "5^CPT Modifier Code"
"RTN","LEXQL3",100,0)
 Q ""
"RTN","LEXQL3",101,0)
DS(X) ;   Trim Dubble Space Character
"RTN","LEXQL3",102,0)
 S X=$G(X) Q:X'["  " X  F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,299)
"RTN","LEXQL3",103,0)
 Q X
"RTN","LEXQL3",104,0)
CL ;   Clear
"RTN","LEXQL3",105,0)
 K LEXVDT,LEXOC,LEXTD
"RTN","LEXQL3",106,0)
 Q
"RTN","LEXQL3",107,0)
TM(X,Y) ;   Trim Character Y - Default " "
"RTN","LEXQL3",108,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LEXQL3",109,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXQL3",110,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXQL3",111,0)
 Q X
"RTN","LEXQL3",112,0)
PR(LEX,X) ;   Parse Array
"RTN","LEXQL3",113,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,LEXI,LEXLEN,LEXC K ^UTILITY($J,"W") Q:'$D(LEX)
"RTN","LEXQL3",114,0)
 S LEXLEN=+($G(X)) S:+LEXLEN'>0 LEXLEN=79 S LEXC=+($G(LEX)) S:+($G(LEXC))'>0 LEXC=$O(LEX(" "),-1) Q:+LEXC'>0
"RTN","LEXQL3",115,0)
 S DIWL=1,DIWF="C"_+LEXLEN S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI=0  S X=$G(LEX(LEXI)) D ^DIWP
"RTN","LEXQL3",116,0)
 K LEX S (LEXC,LEXI)=0 F  S LEXI=$O(^UTILITY($J,"W",1,LEXI)) Q:+LEXI=0  D
"RTN","LEXQL3",117,0)
 . S LEX(LEXI)=$$TM($G(^UTILITY($J,"W",1,LEXI,0))," "),LEXC=LEXC+1
"RTN","LEXQL3",118,0)
 S:$L(LEXC) LEX=LEXC K ^UTILITY($J,"W")
"RTN","LEXQL3",119,0)
 Q
"RTN","LEXQM")
0^4^B27832557^n/a
"RTN","LEXQM",1,0)
LEXQM ;ISL/KER - Query - Miscellaneous ;10/30/2008
"RTN","LEXQM",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQM",3,0)
 ;               
"RTN","LEXQM",4,0)
 ; Global Variables
"RTN","LEXQM",5,0)
 ;    ^UTILITY(           ICR  10011
"RTN","LEXQM",6,0)
 ;               
"RTN","LEXQM",7,0)
 ; External References
"RTN","LEXQM",8,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXQM",9,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEXQM",10,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQM",11,0)
 ;    ^DIWP               ICR  10011
"RTN","LEXQM",12,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEXQM",13,0)
 ;    $$FMADD^XLFDT       ICR  10103
"RTN","LEXQM",14,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEXQM",15,0)
 ;    $$UP^XLFSTR         ICR  10104
"RTN","LEXQM",16,0)
 ;               
"RTN","LEXQM",17,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEXQM",18,0)
 ;    LEXEXIT             Exit Flag
"RTN","LEXQM",19,0)
 ;               
"RTN","LEXQM",20,0)
AD(X) ; Assumed Date
"RTN","LEXQM",21,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,DIRB,LEXPAS,LEXNOW,LEXFUT,Y
"RTN","LEXQM",22,0)
 S LEXNOW=$$UP^XLFSTR($$FMTE^XLFDT($$DT^XLFDT)),LEXPAS=2760101,LEXFUT=$$FMADD^XLFDT($$DT^XLFDT,(365*2))
"RTN","LEXQM",23,0)
 S DIRB=$$RET^LEXQD("LEXQM","AD",+($G(DUZ)),"Assumed Date") S:'$L(DIRB) DIRB=LEXNOW S:$L($G(LEXAD)) DIRB=""
"RTN","LEXQM",24,0)
 S:$L(DIRB) DIR("B")=DIRB S DIR("A")=" Assumed Date of Service:  "
"RTN","LEXQM",25,0)
 S DIR(0)="DAO^"_LEXPAS_":"_LEXFUT_":EX",(DIR("?"),DIR("??"))="^D ADH^LEXQM"
"RTN","LEXQM",26,0)
 S DIR("PRE")="S:X[""?"" X=""??"""
"RTN","LEXQM",27,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) X="^^",LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:X["^" "^"
"RTN","LEXQM",28,0)
 S X="" S:$E(Y,1,7)?7N X=$$UP^XLFSTR($$FMTE^XLFDT($E(Y,1,7)))_"^"_$E(Y,1,7)
"RTN","LEXQM",29,0)
 D:$L($P(X,"^",1)) SAV^LEXQD("LEXQM","AD",+($G(DUZ)),"Assumed Date",$P(X,"^",1))
"RTN","LEXQM",30,0)
 Q X
"RTN","LEXQM",31,0)
ADH ;   Assumed Date Help
"RTN","LEXQM",32,0)
 W !,?5,"This is the date of a fictitious healthcare transaction.  It is the"
"RTN","LEXQM",33,0)
 W !,?5,"date that service was provided to a patient and the date that will  "
"RTN","LEXQM",34,0)
 W !,?5,"be used during the lookup of a code (ICD/CPT/CPT Modifier)."
"RTN","LEXQM",35,0)
 I $L($G(LEXFUT)),$G(LEXFUT)?7N D
"RTN","LEXQM",36,0)
 . W !!,?5,"Enter a date from  ",$$UP^XLFSTR($$FMTE^XLFDT(LEXPAS)),"  to  ",$$UP^XLFSTR($$FMTE^XLFDT(LEXFUT))," or"
"RTN","LEXQM",37,0)
 . W !,?5,"T   (for TODAY),  T+1 (for TOMORROW),  T+2,  T+7, etc.",!,?5,"T-1 (for YESTERDAY),  T-3W (for 3 WEEKS AGO), etc."
"RTN","LEXQM",38,0)
 Q
"RTN","LEXQM",39,0)
 ;            
"RTN","LEXQM",40,0)
CSD(X) ; Code Set Date
"RTN","LEXQM",41,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIRUT,DIROUT,DTOUT,DUOUT,DIRB,LEXPAS,LEXNOW,LEXFUT,Y
"RTN","LEXQM",42,0)
 S LEXNOW=$$UP^XLFSTR($$FMTE^XLFDT($$DT^XLFDT)),LEXPAS=2760101,LEXFUT=$$FMADD^XLFDT($$DT^XLFDT,(365*2)) S:LEXFUT?7N LEXFUT=$E(LEXFUT,1,3)_"1001"
"RTN","LEXQM",43,0)
 S DIRB=$$RET^LEXQD("LEXQM","CSD",+($G(DUZ)),"Code Set Date") S:'$L(DIRB) DIRB=LEXNOW S:$L($G(LEXAD)) DIRB=""
"RTN","LEXQM",44,0)
 S:$L(DIRB) DIR("B")=DIRB S DIR("A")=" Enter Code Set Update Date:  "
"RTN","LEXQM",45,0)
 S DIR(0)="DAO^"_LEXPAS_":"_LEXFUT_":EX",(DIR("?"),DIR("??"))="^D CSDH^LEXQM",DIR("PRE")="S X=$$CSDX^LEXQM(X)"
"RTN","LEXQM",46,0)
 W ! D ^DIR S:X["^^"!($D(DTOUT)) X="^^",LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:X["^" "^"
"RTN","LEXQM",47,0)
 S X="" S:$E(Y,1,7)?7N X=$$UP^XLFSTR($$FMTE^XLFDT($E(Y,1,7)))_"^"_$E(Y,1,7)
"RTN","LEXQM",48,0)
 D:$L($P(X,"^",1)) SAV^LEXQD("LEXQM","CSD",+($G(DUZ)),"Code Set Date",$P(X,"^",1))
"RTN","LEXQM",49,0)
 Q X
"RTN","LEXQM",50,0)
CSDH ;   Code Set Date Help
"RTN","LEXQM",51,0)
 W !,?3,"This is a date to used to search for Code Set changes in the ICD and CPT"
"RTN","LEXQM",52,0)
 W !,?3,"files.  A future date may be used to search for changes in the Code Sets"
"RTN","LEXQM",53,0)
 W !,?3,"with future effective dates.  (HINT:  Most Code Set effective dates are"
"RTN","LEXQM",54,0)
 W !,?3,"quarterly, the first of January, April, July or October)"
"RTN","LEXQM",55,0)
 I $L($G(LEXFUT)),$G(LEXFUT)?7N D
"RTN","LEXQM",56,0)
 . W !!,?5,"Enter a date from  ",$$UP^XLFSTR($$FMTE^XLFDT(LEXPAS)),"  to  ",$$UP^XLFSTR($$FMTE^XLFDT(LEXFUT))," or"
"RTN","LEXQM",57,0)
 . W !,?5,"T   (for TODAY),  T+1 (for TOMORROW),  T+2,  T+7, etc."
"RTN","LEXQM",58,0)
 . W !,?5,"T-1 (for YESTERDAY),  T-3W (for 3 WEEKS AGO), etc."
"RTN","LEXQM",59,0)
 . W !,?5,"Q1 (for first quarter),  Q109 (for first quarter of FY09), etc."
"RTN","LEXQM",60,0)
 Q
"RTN","LEXQM",61,0)
CSDX(X) ;   Code Set Date Pre-Processing
"RTN","LEXQM",62,0)
 Q:$G(X)["?" "??"  N LEXN,LEXY,LEXT,LEXX,LEXQ,LEXF S LEXN=$$DT^XLFDT,LEXY=$E(LEXN,1,3),LEXT=LEXY+1700 S:+($E(LEXN,4,5))>9 LEXY=LEXY+1
"RTN","LEXQM",63,0)
 Q:X="Q2" (LEXY_"0101") Q:X="Q3" (LEXY_"0401") Q:X="Q4" (LEXY_"0701") Q:X="Q1" ((LEXY-1)_"1001")
"RTN","LEXQM",64,0)
 S LEXX="" I $E(X,1)="Q",$E(X,2,4)?3N D
"RTN","LEXQM",65,0)
 . N LEXQ,LEXF S LEXQ=$E(X,2),LEXF=$E(X,3,4) S:LEXF>70 LEXF="19"_LEXF S:LEXF'>70 LEXF="20"_LEXF S:LEXQ=1 LEXF=LEXF-1
"RTN","LEXQM",66,0)
 . S LEXQ=$S(+LEXQ=1:"1001",+LEXQ=2:"0101",+LEXQ=3:"0401",+LEXQ=4:"0701",1:"") Q:'$L(LEXQ)
"RTN","LEXQM",67,0)
 . S:LEXF?4N&(LEXF>1976)&(LEXF<(+($G(LEXT))+3))&(LEXQ?4N) LEXX=(LEXF-1700)_LEXQ
"RTN","LEXQM",68,0)
 S:$L(LEXX) X=LEXX
"RTN","LEXQM",69,0)
 Q X
"RTN","LEXQM",70,0)
 ;            
"RTN","LEXQM",71,0)
PR(LEX,X) ; Parse Array
"RTN","LEXQM",72,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,LEXI,LEXLEN,LEXC K ^UTILITY($J,"W") Q:'$D(LEX)
"RTN","LEXQM",73,0)
 S LEXLEN=+($G(X)) S:+LEXLEN'>0 LEXLEN=79 S LEXC=+($G(LEX)) S:+($G(LEXC))'>0 LEXC=$O(LEX(" "),-1) Q:+LEXC'>0
"RTN","LEXQM",74,0)
 S DIWL=1,DIWF="C"_+LEXLEN S LEXI=0 F  S LEXI=$O(LEX(LEXI)) Q:+LEXI=0  S X=$G(LEX(LEXI)) D ^DIWP
"RTN","LEXQM",75,0)
 K LEX S (LEXC,LEXI)=0 F  S LEXI=$O(^UTILITY($J,"W",1,LEXI)) Q:+LEXI=0  D
"RTN","LEXQM",76,0)
 . S LEX(LEXI)=$$TM($G(^UTILITY($J,"W",1,LEXI,0))," "),LEXC=LEXC+1
"RTN","LEXQM",77,0)
 S:$L(LEXC) LEX=LEXC K ^UTILITY($J,"W")
"RTN","LEXQM",78,0)
 Q
"RTN","LEXQM",79,0)
 ;            
"RTN","LEXQM",80,0)
 ; Miscellaneous
"RTN","LEXQM",81,0)
AND(X) ;   Substitute 'and'
"RTN","LEXQM",82,0)
 S X=$G(X) Q:$L(X,", ")'>1 X
"RTN","LEXQM",83,0)
 S X=$P(X,", ",1,($L(X,", ")-1))_" and "_$P(X,", ",$L(X,", "))
"RTN","LEXQM",84,0)
 Q X
"RTN","LEXQM",85,0)
CS(X) ;   Trim Comma/Space
"RTN","LEXQM",86,0)
 S X=$$TM($G(X),","),X=$$TM($G(X)," "),X=$$TM($G(X),","),X=$$TM($G(X)," ")
"RTN","LEXQM",87,0)
 Q X
"RTN","LEXQM",88,0)
TM(X,Y) ;   Trim Character Y - Default " "
"RTN","LEXQM",89,0)
 S X=$G(X) Q:X="" X  S Y=$G(Y) S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEXQM",90,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEXQM",91,0)
 Q X
"RTN","LEXQM",92,0)
SD(X) ;   Short Date
"RTN","LEXQM",93,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQM",94,0)
ED(X) ;   External Date
"RTN","LEXQM",95,0)
 Q:+($G(X))'>0 "--/--/----"
"RTN","LEXQM",96,0)
 Q $TR($$FMTE^XLFDT(+($G(X)),"5DZ"),"@"," ")
"RTN","LEXQM",97,0)
ES(X) ;   External Status
"RTN","LEXQM",98,0)
 Q $S(+($G(X))="1":"Active",$G(X)="0":"Inactive",1:"")
"RTN","LEXQM",99,0)
CLR ;   Clear
"RTN","LEXQM",100,0)
 N LEXAD,LEXEXIT
"RTN","LEXQM",101,0)
 Q
"RTN","LEXQM",102,0)
EV(X) ;   Check environment
"RTN","LEXQM",103,0)
 N LEX S DT=$$DT^XLFDT D HOME^%ZIS S U="^" I +($G(DUZ))=0 W !!,?5,"DUZ not defined" Q 0
"RTN","LEXQM",104,0)
 S LEX=$$GET1^DIQ(200,(DUZ_","),.01) I '$L(LEX) W !!,?5,"DUZ not valid" Q 0
"RTN","LEXQM",105,0)
 Q 1
"RTN","LEXQO")
0^3^B10990063^n/a
"RTN","LEXQO",1,0)
LEXQO ;ISL/KER - Query - Output ;10/30/2008
"RTN","LEXQO",2,0)
 ;;2.0;LEXICON UTILITY;**62**;Sep 23, 1996;Build 16
"RTN","LEXQO",3,0)
 ;               
"RTN","LEXQO",4,0)
 ; Global Variables
"RTN","LEXQO",5,0)
 ;    ^TMP(               SACC 2.3.2.5.1
"RTN","LEXQO",6,0)
 ;               
"RTN","LEXQO",7,0)
 ; External References
"RTN","LEXQO",8,0)
 ;    ^%ZIS               ICR  10086
"RTN","LEXQO",9,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEXQO",10,0)
 ;    ^%ZISC              ICR  10089
"RTN","LEXQO",11,0)
 ;    ^%ZTLOAD            ICR  10063
"RTN","LEXQO",12,0)
 ;    ^DIR                ICR  10026
"RTN","LEXQO",13,0)
 ;               
"RTN","LEXQO",14,0)
 Q
"RTN","LEXQO",15,0)
DSP(X) ; Display ^TMP(X,$J)
"RTN","LEXQO",16,0)
 N %ZIS,LEXCF,LEXCONT,LEXDNC,LEXEOP,LEXI,LEXID,LEXLC,POP,ZTDESC,ZTDTH,ZTIO,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE,ZTSK S LEXID=$G(X) Q:'$L(LEXID)
"RTN","LEXQO",17,0)
 D HOME^%ZIS,DEV Q
"RTN","LEXQO",18,0)
 ;            
"RTN","LEXQO",19,0)
 ; Device
"RTN","LEXQO",20,0)
DEV ;   Select a device
"RTN","LEXQO",21,0)
 N %ZIS,LEXE,LEXCF,LEXCONT,LEXDNC,LEXEOP,LEXI,LEXLC,ZTDESC,ZTDTH,ZTIO,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE,ZTSK
"RTN","LEXQO",22,0)
 S LEXID=$G(LEXID) Q:'$L(LEXID)  S %ZIS("A")=" Device:  ",ZTRTN="DSPI^LEXQO",ZTDESC="Display/Print Code Lookup"
"RTN","LEXQO",23,0)
 S ZTIO=ION,ZTDTH=$H,%ZIS="Q",ZTSAVE("^TMP("""_LEXID_""",$J,")="",ZTSAVE("LEXID")="" W ! D ^%ZIS I POP S LEXEXIT=1 Q
"RTN","LEXQO",24,0)
 S ZTIO=ION I $D(IO("Q")) D QUE,^%ZISC,HOME^%ZIS Q
"RTN","LEXQO",25,0)
 D NOQUE Q
"RTN","LEXQO",26,0)
NOQUE ;   Do not que task
"RTN","LEXQO",27,0)
 W @IOF W:IOST["P-" !,"< Not queued, printing code lookup >",! H 2 U:IOST["P-" IO D @ZTRTN,^%ZISC,HOME^%ZIS Q
"RTN","LEXQO",28,0)
QUE ;   Task queued to print user defaults
"RTN","LEXQO",29,0)
 K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued",1:"Request Cancelled"),! H 2 Q
"RTN","LEXQO",30,0)
 Q
"RTN","LEXQO",31,0)
 ;            
"RTN","LEXQO",32,0)
DSPI ; Display
"RTN","LEXQO",33,0)
 N LEXEXIT S LEXEXIT=0,LEXID=$G(LEXID) Q:'$L(LEXID)  I '$D(ZTQUEUED),$G(IOST)'["P-" W:'$D(LEXDNC) # I '$D(^TMP(LEXID,$J)) W !,"Text not Found"
"RTN","LEXQO",34,0)
 U:IOST["P-" IO G:'$D(^TMP(LEXID,$J)) DSPQ N LEXCONT,LEXI,LEXLC,LEXEOP,LEXCF S LEXCF=0,LEXCONT="",(LEXLC,LEXI)=0,LEXEOP=+($G(IOSL))
"RTN","LEXQO",35,0)
 S:LEXEOP=0 LEXEOP=24 F  S LEXI=$O(^TMP(LEXID,$J,LEXI)) Q:+LEXI=0!(LEXCONT["^")  Q:+($G(LEXEXIT))>0  D  Q:+($G(LEXEXIT))>0
"RTN","LEXQO",36,0)
 . W !,^TMP(LEXID,$J,LEXI) S LEXCF=0 D LF Q:+($G(LEXEXIT))>0  Q:LEXCONT["^"
"RTN","LEXQO",37,0)
 S:$D(ZTQUEUED) ZTREQ="@" I +($G(LEXEXIT))>0 K ^TMP(LEXID,$J) Q
"RTN","LEXQO",38,0)
 D:'LEXCF EOP  K ^TMP(LEXID,$J) W:$G(IOST)["P-" @IOF
"RTN","LEXQO",39,0)
DSPQ ; Quit Display
"RTN","LEXQO",40,0)
 Q
"RTN","LEXQO",41,0)
 ;            
"RTN","LEXQO",42,0)
 ; Miscellaneous
"RTN","LEXQO",43,0)
LF ;   Line Feed
"RTN","LEXQO",44,0)
 S LEXLC=LEXLC+1 D:IOST["P-"&(LEXLC>(LEXEOP-7)) EOP D:IOST'["P-"&(LEXLC>(LEXEOP-4)) EOP
"RTN","LEXQO",45,0)
 Q
"RTN","LEXQO",46,0)
EOP ;   End of Page
"RTN","LEXQO",47,0)
 S LEXCF=1 S LEXLC=0 W:IOST["P-" @IOF Q:IOST["P-"  W !! S LEXCONT=$$CONT
"RTN","LEXQO",48,0)
 Q
"RTN","LEXQO",49,0)
CONT(X) ;   Ask to Continue
"RTN","LEXQO",50,0)
 Q:+($G(LEXEXIT))>0 "^^"  N DIR,DIROUT,DIRUT,DUOUT,DTOUT,Y S DIR(0)="EAO",DIR("A")=" Enter RETURN to continue or '^' to exit: "
"RTN","LEXQO",51,0)
 S DIR("PRE")="S:X[""?"" X=""??"" S:X[""^"" X=""^""",(DIR("?"),DIR("??"))="^D CONTH^LEXQO"
"RTN","LEXQO",52,0)
 D ^DIR S:X["^^"!($D(DTOUT)) X="^^",LEXEXIT=1 Q:X["^^"!(+($G(LEXEXIT))>0) "^^"  Q:$D(DIROUT)!($D(DIRUT))!($D(DUOUT))!($D(DTOUT)) "^"
"RTN","LEXQO",53,0)
 Q:X["^^" "^^"  Q:X["^" "^"
"RTN","LEXQO",54,0)
 Q ""
"RTN","LEXQO",55,0)
CONTH ;      Ask to Continue Help
"RTN","LEXQO",56,0)
 W !,"     Enter either RETURN or '^'."
"RTN","LEXQO",57,0)
 Q
"VER")
8.0^22.0
"BLD",6888,6)
^59
**END**
**END**
