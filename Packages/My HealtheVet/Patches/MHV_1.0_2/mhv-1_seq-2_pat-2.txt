$TXT Created by MONGER,GARY at CHEY44.FO-BAYPINES.MED.VA.GOV  (KIDS) on Monday, 04/21/08 at 10:00
=============================================================================
Run Date: JUL 03, 2008                     Designation: MHV*1*2
Package : MHV - MYHEALTHEVET                  Priority: Mandatory
Version : 1         SEQ #2                      Status: Released
                  Compliance Date: AUG 03, 2008
=============================================================================

Associated patches: (v)HL*1.6*126  <<= must be installed BEFORE `MHV*1*2'
                    (v)MHV*1*1     <<= must be installed BEFORE `MHV*1*2'

Subject: MHV PHR INFRASTRUCTURE

Category: 
  - Routine
  - Other
  - Enhancement (Mandatory)
  - Data Dictionary

Description:
============

 MHV*1*2 PHR Infrastructure
  
 Summary
 -------
 MHV*1*2 delivers infrastructure changes in support of upcoming Personal 
 Health Record (PHR) HL7 interfaces. It also consolidates features common 
 to message receivers and builders, and encapsulates interaction with the 
 HL7 v1.6 package to ease transition to HLO based interfaces should that 
 become necessary.  Most routines were modified to take advantage of the 
 logging features released with MHV*1*1.
  
  
 Detailed Description
 --------------------
 MHV*1*2 releases a number of infrastructure changes to improve interface 
 development and support.  Processing common to many interfaces such as 
 validating patient identifiers, and common segment builders has been 
 consolidated into centralized functions.  Use of HL7 package APIs and 
 variables has been moved from individual interfaces and encapsulated in 
 centralized functions.  If a move from HL7 v1.6 to the new HLO engine 
 becomes necessary, the impact will be minimized.  All interfaces and 
 extractors have been updated to use the logging utility introduced with 
 MHV*1*1.  The message transmitter now provides support for extractors 
 that need to use a local array to hold extracted data.  
  
 The MHV Rx refill interfaces introduced with MHV 1.0 use original mode 
 acknowledgements, a synchronous call into VistA, and do not require a 
 logical link to respond to the MHV system.  The MHV HL7 interface 
 framework also supports enhanced mode acknowledgments, an asynchronous 
 call into VistA.  The PHR HL7 interfaces will use enhanced mode 
 acknowledgements, and require a logical link to define the connection to 
 the MHV system.  The new link is MHVVA and is distributed with this 
 patch.  This link references a new domain, MHV.MED.VA.GOV, but does not 
 require this domain to be entered in the DOMAIN file (#4.2).
  
 Event driver and subscriber protocols for the RTB^K13 query response 
 message and the ORP^O10 order response message are being released to 
 support a future change in Rx refill messaging from original mode 
 acknowledgements to enhanced mode acknowledgements.
  
 MHV*1*2 updates the MHV REQUEST TYPE file (#2275.3) with entries to 
 support the new PHR interfaces.  These entries are disabled by having the 
 BLOCKED field (#.03) set to YES.  A new field, ROUTINE BUILDER field 
 (#.06), holds the name of the query specific builder routine used by 
 RTB^K13 types.  A new field DESCRIPTION field (#2) provides a brief 
 description of the interface supported by that request type.
  
 The MHV RESPONSE MAP file (#2275.4) is new with this release.  It is used 
 to map inbound messages to the protocol and routine used to create the 
 response message, and the segment used to break messages on a whole 
 record boundary.
  
 PHR HL7 interfaces have the potential to carry very large messages.  
 MHV*1*2 introduces the ability to break those messages into multiple 
 smaller messages for a "bolus" style response.
  
 MHV*1*2 fixes a bug where the TX field formatter did not correctly 
 calculate the size of the data put in the field, and thus could not 
 enforce field size constraints.  This issue was not encountered in 
 production because existing interfaces do not require such constraints.  
 The TX field formatter was rewritten to use an improved algorithm and fix 
 this bug.
  
 MHV*1*2 also fixes a bug where an incorrect ACK code and segment 
 descriptor could be returned on negative acknowledgments triggered by the 
 request manager.  This issue was not encountered in production because 
 the conditions required to trigger it have not occurred.  These are 
 improper interface configuration, and catastrophic data integrity errors.
  
 The pre-init routine PRE^MHV1P2 turns on MHV Application Logging.  It 
 will log information about MHV HL7 messages received during the patch 
 install.  This is only a precaution as the MHV application is tolerant of 
 messaging failures that might be caused by loading the patch.  If a 
 message was received during the patch installation, you will be notified 
 and asked to check the error trap for errors in the MHV namespace.  If 
 any are found, you should log a remedy ticket.
 The post init routine POST^MHV1P2 will update the MHVVA logical link and 
 turn off MHV Application Logging.  For test systems, it will remove data 
 from the DNS DOMAIN (#.08), TCP/IP ADDRESS (#400.01), and TCP/IP PORT 
 (#400.02) fields and set AUTOSTART (#4.5) to Disabled.  For production 
 systems, it will ensure the correct values are in the DNS DOMAIN (#.08), 
 TCP/IP ADDRESS (#400.01), and TCP/IP PORT (#400.02) fields and set 
 AUTOSTART (#4.5) to Enabled.
  
  
 New Service Request (NSR):
 --------------------------
 There is no NSR associated with this patch.
  
  
 Remedy Ticket(s):
 -----------------
 There are no Remedy tickets associated with this patch.
  
  
 Components Sent With Patch 
 --------------------------
 File:
    MHV REQUEST TYPE      (#2275.3)
                 Update DD: YES
        Send Security Code: YES
      Date Comes With File: YES
                 Site Data: REPLACE
          Resolve Pointers: NO
  
    MHV RESPONSE MAP      (#2275.4)   - New file
                 Update DD: YES
        Send Security Code: YES
      Date Comes With File: YES
                 Site Data: REPLACE
          Resolve Pointers: NO
  
 Field:
    BUILDER ROUTINE (#.06)   File: MHV REQUEST TYPE (#2275.3)
    DESCRIPTION (#2)         File: MHV REQUEST TYPE (#2275.3)
    NAME (#.01)              File: MHV RESPONSE MAP (#2275.4)
    RESPONSE PROTOCOL (#.02) File: MHV RESPONSE MAP (#2275.4)
    BUILDER ROUTINE (#.03)   File: MHV RESPONSE MAP (#2275.4)
    BOUNDARY SEGMENT (#.04)  File: MHV RESPONSE MAP (#2275.4)
  
 Routine:
 MHV1P2          MHV7B0          MHV7B1         MHV7B1B         
 MHV7B2          MHV7BU          MHV7BUS        MHV7R1          
 MHV7R2          MHV7RU          MHV7RUS        MHV7T           
 MHV7TB          MHV7U           MHVRQI         MHVU1
 MHVU2           MHVUL2          MHVXRX         MHVXRXR  
  
 Protocol:
    MHV ORP-O10 Event Driver
    MHV ORP-O10 Subscriber  
    MHV RTB-K13 Event Driver
    MHV RTB-K13 Subscriber  
  
 HL Logical Link:
    MHVVA    
  
  
 Documentation Retrieval:
 ------------------------ 
 The software for this patch is distributed as KIDS build MHV*1.0*2.
 The My HealtheVet Technical Manual is available through the VistA 
 Documentation Library (VDL) at the following address:
   
    http://www.va.gov/vdl/HealtheVet.asp?appID=153
  
  
 Test Sites:
 -----------
 Detroit
 Long Beach
 Washington
 Boston
 Richmond
  
  
  
   ================INSTALLATION INSTRUCTIONS =================
  
 The patch is distributed in KIDS format in a PackMan message.
  
 This patch requires MHV*1*1
  
 Install time - less than 5 minutes. 
  
 This patch can be installed with users on the system, and should be 
 installed during off-peak hours.  No options need to be disabled to 
 install this patch.
  
  
 Pre/Post Installation Overview
 ------------------------------
 The pre-init routine PRE^MHV1P2 turns on MHV Application Logging.  It 
 will log information about MHV HL7 messages received during the patch 
 install.  This is only a precaution as the MHV application is tolerant of 
 messaging failures that might be caused by loading the patch.  If a 
 message was received during the patch installation, you will be notified 
 and asked to check the error trap for errors in the MHV namespace.  If 
 any are found, you should log a remedy ticket.
 The post init routine POST^MHV1P2 will update the MHVVA logical link and 
 turn off MHV Application Logging.  For test systems, it will remove data 
 from the DNS DOMAIN (#.08), TCP/IP ADDRESS (#400.01), and TCP/IP PORT 
 (#400.02) fields and set AUTOSTART (#4.5) to Disabled.  For production 
 systems, it will ensure the correct values are in the DNS DOMAIN (#.08), 
 TCP/IP ADDRESS (#400.01), and TCP/IP PORT (#400.02) fields and set 
 AUTOSTART (#4.5) to Enabled.
     
  
 1.  LOAD TRANSPORT GLOBAL 
     ---------------------
     Choose the PackMan message containing this patch and invoke the 
     INSTALL/CHECK MESSAGE PackMan option.  
              
 2.  START UP KIDS 
     -------------
     Start up the Kernel Installation and Distribution System Menu 
     [XPD MAIN]: 
    
          Edits and Distribution ...  
          Utilities ...  
          Installation ...  
    
 Select Kernel Installation & Distribution System Option: INStallation 
                                                          ---
          Load a Distribution 
          Print Transport Global 
          Compare Transport Global to Current System 
          Verify Checksums in Transport Global 
          Install Package(s) 
          Restart Install of Package(s) 
          Unload a Distribution 
          Backup a Transport Global 
    
 Select Installation Option: 
    
 3.  Select Installation Option: 
     ---------------------------
     NOTE:  The following are OPTIONAL - (When prompted for the
            INSTALL NAME, enter MHV*1.0*2):
       
     a.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
     b.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this
         patch is installed.  It compares all components of this patch
         (routines, DD's, templates, etc.).
     c.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
      
 4.  Select Installation Option: Install Package(s) 
     ----------------------------------------------
     **This is the step to start the installation of this KIDS patch: 
    
     a.  Choose the Install Package(s) option to start the patch
         install.
 b.      When prompted 'Want KIDS to INHIBIT LOGONs during the
         install? YES//' answer NO 
     c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
         Options, and Protocols? YES//' answer NO

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;1.0;My HealtheVet;**[Patch List]**;Aug 23, 2005;Build 22

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: MHV1P2
    Before:       n/a   After: B18970965  **2**
Routine Name: MHV7B0
    Before:  B2839283   After:  B3641283  **2**
Routine Name: MHV7B1
    Before: B10417792   After:  B4225319  **2**
Routine Name: MHV7B1B
    Before: B16923322   After: B18220688  **2**
Routine Name: MHV7B2
    Before: B19305881   After:  B7716178  **2**
Routine Name: MHV7BU
    Before:       n/a   After: B16434586  **2**
Routine Name: MHV7BUS
    Before:       n/a   After:  B8246464  **2**
Routine Name: MHV7R1
    Before: B39557430   After: B30948091  **1,2**
Routine Name: MHV7R2
    Before: B43834803   After: B21628890  **1,2**
Routine Name: MHV7RU
    Before:       n/a   After: B15519323  **2**
Routine Name: MHV7RUS
    Before:       n/a   After:  B5954572  **2**
Routine Name: MHV7T
    Before: B13277198   After: B16119739  **2**
Routine Name: MHV7TB
    Before:       n/a   After: B12991075  **2**
Routine Name: MHV7U
    Before: B80060951   After: B66469484  **1,2**
Routine Name: MHVRQI
    Before:  B5569720   After:  B8242102  **2**
Routine Name: MHVU1
    Before:  B3571161   After:  B3928615  **2**
Routine Name: MHVU2
    Before:       n/a   After: B17646805  **2**
Routine Name: MHVUL2
    Before: B24353171   After: B25052300  **1,2**
Routine Name: MHVXRX
    Before: B12216271   After: B12040228  **2**
Routine Name: MHVXRXR
    Before:  B1479238   After:  B1622789  **2**
 
Routine list of preceding patches: 1

=============================================================================
User Information:
Entered By  : MONGER,GARY                   Date Entered  : OCT 20, 2006
Completed By: FERGUSON,DAVID                Date Completed: JUN 27, 2008
Released By : BLACK,KATHLEEN                Date Released : JUL 03, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
