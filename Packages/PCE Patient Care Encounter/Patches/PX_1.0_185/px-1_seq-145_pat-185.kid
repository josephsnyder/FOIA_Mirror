Released PX*1*185 SEQ #145
Extracted from mail message
**KIDS**:PX*1.0*185^

**INSTALL NAME**
PX*1.0*185
"BLD",7146,0)
PX*1.0*185^PCE PATIENT CARE ENCOUNTER^0^3080623^y
"BLD",7146,1,0)
^^4^4^3080623^
"BLD",7146,1,1,0)
Change field #.08 in the Health Factors file (9999999.64) to a required 
"BLD",7146,1,2,0)
field.  Also, add a warning message for PCE Health Factors to let users 
"BLD",7146,1,3,0)
know when a Health Factor is not set up to display on a Health Summary
"BLD",7146,1,4,0)
report.
"BLD",7146,4,0)
^9.64PA^9999999.64^1
"BLD",7146,4,9999999.64,0)
9999999.64
"BLD",7146,4,9999999.64,2,0)
^9.641^9999999.64^1
"BLD",7146,4,9999999.64,2,9999999.64,0)
HEALTH FACTORS  (File-top level)
"BLD",7146,4,9999999.64,2,9999999.64,1,0)
^9.6411^.08^1
"BLD",7146,4,9999999.64,2,9999999.64,1,.08,0)
DISPLAY ON HEALTH SUMMARY
"BLD",7146,4,9999999.64,222)
y^y^p^^^^n^^n
"BLD",7146,4,9999999.64,224)

"BLD",7146,4,"APDD",9999999.64,9999999.64)

"BLD",7146,4,"APDD",9999999.64,9999999.64,.08)

"BLD",7146,4,"B",9999999.64,9999999.64)

"BLD",7146,6.3)
12
"BLD",7146,"ABPKG")
n
"BLD",7146,"INID")
^y
"BLD",7146,"INIT")
PX10P185
"BLD",7146,"KRN",0)
^9.67PA^8989.52^19
"BLD",7146,"KRN",.4,0)
.4
"BLD",7146,"KRN",.401,0)
.401
"BLD",7146,"KRN",.402,0)
.402
"BLD",7146,"KRN",.403,0)
.403
"BLD",7146,"KRN",.5,0)
.5
"BLD",7146,"KRN",.84,0)
.84
"BLD",7146,"KRN",3.6,0)
3.6
"BLD",7146,"KRN",3.8,0)
3.8
"BLD",7146,"KRN",9.2,0)
9.2
"BLD",7146,"KRN",9.8,0)
9.8
"BLD",7146,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7146,"KRN",9.8,"NM",1,0)
PXCEVFI1^^0^B20919668
"BLD",7146,"KRN",9.8,"NM","B","PXCEVFI1",1)

"BLD",7146,"KRN",19,0)
19
"BLD",7146,"KRN",19.1,0)
19.1
"BLD",7146,"KRN",101,0)
101
"BLD",7146,"KRN",409.61,0)
409.61
"BLD",7146,"KRN",771,0)
771
"BLD",7146,"KRN",870,0)
870
"BLD",7146,"KRN",8989.51,0)
8989.51
"BLD",7146,"KRN",8989.52,0)
8989.52
"BLD",7146,"KRN",8994,0)
8994
"BLD",7146,"KRN","B",.4,.4)

"BLD",7146,"KRN","B",.401,.401)

"BLD",7146,"KRN","B",.402,.402)

"BLD",7146,"KRN","B",.403,.403)

"BLD",7146,"KRN","B",.5,.5)

"BLD",7146,"KRN","B",.84,.84)

"BLD",7146,"KRN","B",3.6,3.6)

"BLD",7146,"KRN","B",3.8,3.8)

"BLD",7146,"KRN","B",9.2,9.2)

"BLD",7146,"KRN","B",9.8,9.8)

"BLD",7146,"KRN","B",19,19)

"BLD",7146,"KRN","B",19.1,19.1)

"BLD",7146,"KRN","B",101,101)

"BLD",7146,"KRN","B",409.61,409.61)

"BLD",7146,"KRN","B",771,771)

"BLD",7146,"KRN","B",870,870)

"BLD",7146,"KRN","B",8989.51,8989.51)

"BLD",7146,"KRN","B",8989.52,8989.52)

"BLD",7146,"KRN","B",8994,8994)

"BLD",7146,"QUES",0)
^9.62^^
"BLD",7146,"REQB",0)
^9.611^1^1
"BLD",7146,"REQB",1,0)
PX*1.0*184^2
"BLD",7146,"REQB","B","PX*1.0*184",1)

"FIA",9999999.64)
HEALTH FACTORS
"FIA",9999999.64,0)
^AUTTHF(
"FIA",9999999.64,0,0)
9999999.64I
"FIA",9999999.64,0,1)
y^y^p^^^^n^^n
"FIA",9999999.64,0,10)

"FIA",9999999.64,0,11)

"FIA",9999999.64,0,"RLRO")

"FIA",9999999.64,0,"VR")
1.0^PX
"FIA",9999999.64,9999999.64)
1
"FIA",9999999.64,9999999.64,.08)

"INIT")
PX10P185
"MBREQ")
0
"PKG",413,-1)
1^1
"PKG",413,0)
PCE PATIENT CARE ENCOUNTER^PX^Patient Care Encounter (VA Parent package)^
"PKG",413,20,0)
^9.402P^^
"PKG",413,22,0)
^9.49I^1^1
"PKG",413,22,1,0)
1.0^2960812^2960913^12537
"PKG",413,22,1,"PAH",1,0)
185^3080623
"PKG",413,22,1,"PAH",1,1,0)
^^4^4^3080623
"PKG",413,22,1,"PAH",1,1,1,0)
Change field #.08 in the Health Factors file (9999999.64) to a required 
"PKG",413,22,1,"PAH",1,1,2,0)
field.  Also, add a warning message for PCE Health Factors to let users 
"PKG",413,22,1,"PAH",1,1,3,0)
know when a Health Factor is not set up to display on a Health Summary
"PKG",413,22,1,"PAH",1,1,4,0)
report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PX10P185")
0^^B289879^n/a
"RTN","PX10P185",1,0)
PX10P185 ;ALB/RLC - PX*1.0*185 POST INIT INSTALL
"RTN","PX10P185",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**185**;Aug 12, 1996;Build 12
"RTN","PX10P185",3,0)
 ;
"RTN","PX10P185",4,0)
EN ;Update field .08 to "Y" for any records where the field is null
"RTN","PX10P185",5,0)
 S HFIEN=0
"RTN","PX10P185",6,0)
 F  S HFIEN=$O(^AUTTHF(HFIEN)) Q:'HFIEN  D
"RTN","PX10P185",7,0)
 .Q:'$D(^AUTTHF(HFIEN,0))  S NODE=^(0)
"RTN","PX10P185",8,0)
 .Q:$P(NODE,U,8)'=""
"RTN","PX10P185",9,0)
 .S DIE="^AUTTHF(",DA=HFIEN,DR=".08///Y" D ^DIE
"RTN","PX10P185",10,0)
 K HFIEN,NODE,DIE,DA,DR
"RTN","PX10P185",11,0)
 Q
"RTN","PXCEVFI1")
0^1^B20919668^B18122138
"RTN","PXCEVFI1",1,0)
PXCEVFI1 ;ISL/dee,esw - Routine to edit a visit or v-file entry ;8/3/04 10:32am
"RTN","PXCEVFI1",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**23,73,112,136,143,124,184,185**;Aug 12, 1996;Build 12
"RTN","PXCEVFI1",3,0)
 Q
"RTN","PXCEVFI1",4,0)
 ;
"RTN","PXCEVFI1",5,0)
EDIT ; -- edit the V-File stored in "AFTER"
"RTN","PXCEVFI1",6,0)
 N DIR,DA,X,Y,C,PXCEINP,PXCEIN01,PXCEEND,PXD
"RTN","PXCEVFI1",7,0)
 N PXCELINE,PXCETEXT,PXCEDIRB,PXCEMOD
"RTN","PXCEVFI1",8,0)
 N PXCEKEY,PXCEIKEY,PXCENKEY,PXMDCNT
"RTN","PXCEVFI1",9,0)
 W !
"RTN","PXCEVFI1",10,0)
 G:PXCECAT="VST"!(PXCECAT="APPM")!(PXCECAT="CSTP") REST
"RTN","PXCEVFI1",11,0)
 ;
"RTN","PXCEVFI1",12,0)
EDIT01 ;
"RTN","PXCEVFI1",13,0)
 I PXCECAT="CPT"!(PXCECAT="POV")!(PXCECAT="SK")!(PXCECAT="IMM") D SC^PXCEVFI2($P(^AUPNVSIT(PXCEVIEN,0),U,5))
"RTN","PXCEVFI1",14,0)
 S PXCETEXT=$P($T(FORMAT+1^@PXCECODE),";;",2)
"RTN","PXCEVFI1",15,0)
 K DIR,DA,X,Y,C,PXCEDIRB
"RTN","PXCEVFI1",16,0)
 I $P(PXCEAFTR(0),"^",1) D
"RTN","PXCEVFI1",17,0)
 . N DIEER,PXCEDILF,PXCEEXT
"RTN","PXCEVFI1",18,0)
 . S PXCEEXT=$$EXTERNAL^DILFD(PXCEFILE,.01,"",$P(PXCEAFTR(0),"^",1),"PXCEDILF")
"RTN","PXCEVFI1",19,0)
 . S PXCEDIRB=$S('$D(DIERR):PXCEEXT,1:$P(PXCEAFTR(0),"^",1))
"RTN","PXCEVFI1",20,0)
 E  S PXCEDIRB=""
"RTN","PXCEVFI1",21,0)
 I $P(PXCETEXT,"~",7)]"" D
"RTN","PXCEVFI1",22,0)
 . D @$P(PXCETEXT,"~",7)
"RTN","PXCEVFI1",23,0)
 E  D
"RTN","PXCEVFI1",24,0)
 . I PXCEDIRB'="" S DIR("B")=PXCEDIRB
"RTN","PXCEVFI1",25,0)
 . S DIR(0)=PXCEFILE_",.01OA"
"RTN","PXCEVFI1",26,0)
 . S DIR("A")=$P(PXCETEXT,"~",4)
"RTN","PXCEVFI1",27,0)
 . S:$P(PXCETEXT,"~",8)]"" DIR("?")=$P(PXCETEXT,"~",8)
"RTN","PXCEVFI1",28,0)
 . D ^DIR
"RTN","PXCEVFI1",29,0)
 I X="@" D  G ENDEDIT
"RTN","PXCEVFI1",30,0)
 . N DIRUT
"RTN","PXCEVFI1",31,0)
 . I $P(PXCEAFTR(0),"^",1)="" D
"RTN","PXCEVFI1",32,0)
 .. W !,"There is no entry to delete."
"RTN","PXCEVFI1",33,0)
 .. D WAIT^PXCEHELP
"RTN","PXCEVFI1",34,0)
 . E  D DEL^PXCEVFI2(PXCECAT)
"RTN","PXCEVFI1",35,0)
 I $D(DIRUT),$P(PXCEAFTR(0),"^",1)="" S PXCELOOP=1
"RTN","PXCEVFI1",36,0)
 I $D(DIRUT) S PXCEQUIT=1 Q
"RTN","PXCEVFI1",37,0)
 S (PXCEINP,PXD)=Y
"RTN","PXCEVFI1",38,0)
 S PXCEIN01=X
"RTN","PXCEVFI1",39,0)
 I $P(Y,"^",2)'=PXCEDIRB,$$DUP(PXCEINP) G EDIT01
"RTN","PXCEVFI1",40,0)
 ;--File new CPT code and retrieve IEN
"RTN","PXCEVFI1",41,0)
 I PXCECAT="CPT" D
"RTN","PXCEVFI1",42,0)
 . S PXMDCNT=$$CODM^ICPTCOD(+Y,"^TMP(""PXMODARR"",$J",PXCESOR,+^TMP("PXK",$J,"VST",1,0,"AFTER"))
"RTN","PXCEVFI1",43,0)
 . K ^TMP("PXMODARR",$J)
"RTN","PXCEVFI1",44,0)
 . I $P(PXCEAFTR(0),"^",1)'=""!(PXMDCNT'>0) Q
"RTN","PXCEVFI1",45,0)
 . N PXCEFIEN
"RTN","PXCEVFI1",46,0)
 . D NEWCODE^PXCECPT
"RTN","PXCEVFI1",47,0)
 . S ^TMP("PXK",$J,PXCECATS,1,"IEN")=PXCEFIEN
"RTN","PXCEVFI1",48,0)
 I PXCECAT="PRV",$P(PXCEAFTR(0),"^",1)>0,PXCEDIRB]"" S $P(PXCEAFTR(0),"^",6)=""
"RTN","PXCEVFI1",49,0)
 S $P(PXCEAFTR(0),"^",1)=$P(PXCEINP,"^")
"RTN","PXCEVFI1",50,0)
 K DIR,DA
"RTN","PXCEVFI1",51,0)
 ;following code added per PX*185
"RTN","PXCEVFI1",52,0)
 I $D(XQORNOD(0)) I $P(XQORNOD(0),U,4)="HF" D
"RTN","PXCEVFI1",53,0)
 .N HFIEN,NODE
"RTN","PXCEVFI1",54,0)
 .S HFIEN=$P(PXCEINP,U),NODE=$G(^AUTTHF(HFIEN,0))
"RTN","PXCEVFI1",55,0)
 .Q:'$D(NODE)
"RTN","PXCEVFI1",56,0)
 .I $P(NODE,U,8)'="Y" W !!,"WARNING:  This Health Factor is currently not set to",!?10,"display on a Health Summary report.",!!
"RTN","PXCEVFI1",57,0)
 .K HFIEN,NODE
"RTN","PXCEVFI1",58,0)
 .Q
"RTN","PXCEVFI1",59,0)
 ;
"RTN","PXCEVFI1",60,0)
 ;
"RTN","PXCEVFI1",61,0)
REST S PXCEEND=0
"RTN","PXCEVFI1",62,0)
 F PXCELINE=2:1 S PXCETEXT=$P($T(FORMAT+PXCELINE^@PXCECODE),";;",2) Q:PXCETEXT']""  D  Q:PXCEEND
"RTN","PXCEVFI1",63,0)
 . I $P(PXCETEXT,"~",9)]"",$P(PXCETEXT,"~",3)'=80201 S PXCEKEY="" D  Q:PXCEKEY'=1
"RTN","PXCEVFI1",64,0)
 .. S PXCENKEY=$L($P(PXCETEXT,"~",9))
"RTN","PXCEVFI1",65,0)
 .. F PXCEIKEY=1:1:PXCENKEY I PXCEKEYS[$E($P(PXCETEXT,"~",9),PXCEIKEY) S PXCEKEY=1 Q
"RTN","PXCEVFI1",66,0)
 . K DIR,DA,X,Y,C
"RTN","PXCEVFI1",67,0)
 . I $P(PXCETEXT,"~",7)]"" D
"RTN","PXCEVFI1",68,0)
 .. D @$P(PXCETEXT,"~",7)
"RTN","PXCEVFI1",69,0)
 . E  D
"RTN","PXCEVFI1",70,0)
 .. I $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))'="" D
"RTN","PXCEVFI1",71,0)
 ... N DIERR,PXCEDILF,PXCEINT,PXCEEXT
"RTN","PXCEVFI1",72,0)
 ... S PXCEINT=$P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))
"RTN","PXCEVFI1",73,0)
 ... S PXCEEXT=$$EXTERNAL^DILFD(PXCEFILE,$P(PXCETEXT,"~",3),"",PXCEINT,"PXCEDILF")
"RTN","PXCEVFI1",74,0)
 ... S DIR("B")=$S('$D(DIERR):PXCEEXT,1:PXCEINT)
"RTN","PXCEVFI1",75,0)
 .. S DIR(0)=PXCEFILE_","_$P(PXCETEXT,"~",3)_"A"
"RTN","PXCEVFI1",76,0)
 .. S DIR("A")=$P(PXCETEXT,"~",4)
"RTN","PXCEVFI1",77,0)
 .. S:$P(PXCETEXT,"~",8)]"" DIR("?")=$P(PXCETEXT,"~",8)
"RTN","PXCEVFI1",78,0)
 .. D ^DIR
"RTN","PXCEVFI1",79,0)
 .. K DIR,DA
"RTN","PXCEVFI1",80,0)
 .. I X="@" S Y="@"
"RTN","PXCEVFI1",81,0)
 .. E  I $D(DTOUT)!$D(DUOUT) S PXCEEND=1 S:PXCECAT="SIT"!(PXCECAT="APPM")!(PXCECAT="HIST")!(PXCECAT="CPT") PXCEQUIT=1 Q
"RTN","PXCEVFI1",82,0)
 .. S $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))=$P(Y,"^")
"RTN","PXCEVFI1",83,0)
 . I ($P(PXCETEXT,"~",3)=1202!($P(PXCETEXT,"~",3)=1204)) D:+Y>0 PROVIDER^PXCEVFI4(+Y)
"RTN","PXCEVFI1",84,0)
 ;
"RTN","PXCEVFI1",85,0)
ENDEDIT ;
"RTN","PXCEVFI1",86,0)
 Q
"RTN","PXCEVFI1",87,0)
 ;
"RTN","PXCEVFI1",88,0)
DUP(PXCEINP) ; -- Check for dup entries.
"RTN","PXCEVFI1",89,0)
 Q:PXCECAT="SIT"!(PXCECAT="APPM")!(PXCECAT="HIST") 0
"RTN","PXCEVFI1",90,0)
 ;
"RTN","PXCEVFI1",91,0)
 N PXCEDUP,PXCEINDX,X,Y
"RTN","PXCEVFI1",92,0)
 S PXCEDUP=0
"RTN","PXCEVFI1",93,0)
 S PXCEINDX=""
"RTN","PXCEVFI1",94,0)
 F  S PXCEINDX=$O(@(PXCEAUPN_"(""AD"",PXCEVIEN,PXCEINDX)")) Q:'PXCEINDX!PXCEDUP  S:+@(PXCEAUPN_"(PXCEINDX,0)")=+PXCEINP&(PXCEINDX'=PXCEFIEN) PXCEDUP=1
"RTN","PXCEVFI1",95,0)
 I PXCEDUP D
"RTN","PXCEVFI1",96,0)
 . I PXCEDUP
"RTN","PXCEVFI1",97,0)
 . W !,$P(PXCEINP,"^",2)," is already a "_PXCECATT_" for this Encounter."
"RTN","PXCEVFI1",98,0)
 . I PXCECAT="POV" W !!,"Duplicate Diagnosis Not Allowed." Q  ;PX/112
"RTN","PXCEVFI1",99,0)
 . I PXCECAT="CPT",$$GET1^DIQ(357.69,$P(PXCEINP,"^",2),.01)>0 D  Q
"RTN","PXCEVFI1",100,0)
 . . W !,"No duplicate E&M codes allowed."   ;PX/136
"RTN","PXCEVFI1",101,0)
 . I $P($T(FORMAT^@PXCECODE),"~",4) D
"RTN","PXCEVFI1",102,0)
 .. N DIR,DA
"RTN","PXCEVFI1",103,0)
 .. S DIR(0)="Y"
"RTN","PXCEVFI1",104,0)
 .. S DIR("A")="Do you want to add another "_$P(PXCEINP,"^",2)_""
"RTN","PXCEVFI1",105,0)
 .. S DIR("B")="NO"
"RTN","PXCEVFI1",106,0)
 .. D ^DIR
"RTN","PXCEVFI1",107,0)
 .. S PXCEDUP='+Y
"RTN","PXCEVFI1",108,0)
 Q PXCEDUP
"RTN","PXCEVFI1",109,0)
 ;
"VER")
8.0^22.0
"^DD",9999999.64,9999999.64,.08,0)
DISPLAY ON HEALTH SUMMARY^RS^Y:YES;N:NO;^0;8^Q
"^DD",9999999.64,9999999.64,.08,21,0)
^^4^4^2950718^^^
"^DD",9999999.64,9999999.64,.08,21,1,0)
(Optional)
"^DD",9999999.64,9999999.64,.08,21,2,0)
This allows the health factor to be displayed on Health Summaries.
"^DD",9999999.64,9999999.64,.08,21,3,0)
 
"^DD",9999999.64,9999999.64,.08,21,4,0)
Enter a yes to display or a no to not display.
"^DD",9999999.64,9999999.64,.08,"DT")
3070226
"BLD",7146,6)
^145
**END**
**END**
