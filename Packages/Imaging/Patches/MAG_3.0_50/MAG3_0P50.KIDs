KIDS Distribution saved on May 26, 2006@07:10:59
VistA Imaging V3.0 - Patch 50 -  05/26/2006 07:10AM
**KIDS**:MAG*3.0*50^

**INSTALL NAME**
MAG*3.0*50
"BLD",3463,0)
MAG*3.0*50^IMAGING^0^3060526^y
"BLD",3463,1,0)
^^75^75^3060526^
"BLD",3463,1,1,0)
Version 3.0 Patch 50 - DICOM Export I
"BLD",3463,1,2,0)
 
"BLD",3463,1,3,0)
 
"BLD",3463,1,4,0)
RPC definition for "MAG DICOM GET ICN".
"BLD",3463,1,5,0)
 
"BLD",3463,1,6,0)
This package contains a KIDS component
"BLD",3463,1,7,0)
for patch 50.
"BLD",3463,1,8,0)
 
"BLD",3463,1,9,0)
This package transports the remote procedure call named MAG DICOM GET 
"BLD",3463,1,10,0)
NEXT QUEUE ENTRY.
"BLD",3463,1,11,0)
 
"BLD",3463,1,12,0)
RPC definition for "MAG DICOM LOOKUP STUDY".
"BLD",3463,1,13,0)
 
"BLD",3463,1,14,0)
This package contains a KIDS component
"BLD",3463,1,15,0)
for patch 50.
"BLD",3463,1,16,0)
 
"BLD",3463,1,17,0)
This package transports the remote procedure call named MAG DICOM QUEUE 
"BLD",3463,1,18,0)
IMAGE.
"BLD",3463,1,19,0)
 
"BLD",3463,1,20,0)
This package contains a KIDS component
"BLD",3463,1,21,0)
for patch 50.
"BLD",3463,1,22,0)
 
"BLD",3463,1,23,0)
This package transports the remote procedure call named MAG NEW SOP 
"BLD",3463,1,24,0)
INSTANCE UID.
"BLD",3463,1,25,0)
 
"BLD",3463,1,26,0)
RPC definition for "MAG RAD GET NEXT RPT BY DATE".
"BLD",3463,1,27,0)
 
"BLD",3463,1,28,0)
RPC definition for "MAG RAD GET NEXT RPT BY PT".
"BLD",3463,1,29,0)
 
"BLD",3463,1,30,0)
This package contains a KIDS component
"BLD",3463,1,31,0)
for patch 50.
"BLD",3463,1,32,0)
 
"BLD",3463,1,33,0)
This package transports the FileMan data dictionary named 2005;252,253.
"BLD",3463,1,34,0)
 
"BLD",3463,1,35,0)
This package contains a KIDS component
"BLD",3463,1,36,0)
for patch 50.
"BLD",3463,1,37,0)
 
"BLD",3463,1,38,0)
This package transports the FileMan data dictionary named 2005.1;252,253.
"BLD",3463,1,39,0)
 
"BLD",3463,1,40,0)
This package contains a KIDS component
"BLD",3463,1,41,0)
for patch 50.
"BLD",3463,1,42,0)
 
"BLD",3463,1,43,0)
This package transports the FileMan data dictionary named 2006.563.
"BLD",3463,1,44,0)
 
"BLD",3463,1,45,0)
This package contains a KIDS component
"BLD",3463,1,46,0)
for patch 50.
"BLD",3463,1,47,0)
 
"BLD",3463,1,48,0)
This package transports the FileMan data dictionary named 2006.565.
"BLD",3463,1,49,0)
 
"BLD",3463,1,50,0)
This package contains a KIDS component
"BLD",3463,1,51,0)
for patch 50.
"BLD",3463,1,52,0)
 
"BLD",3463,1,53,0)
This package transports the FileMan data dictionary named 2006.574.
"BLD",3463,1,54,0)
 
"BLD",3463,1,55,0)
This package contains a KIDS component
"BLD",3463,1,56,0)
for patch 50.
"BLD",3463,1,57,0)
 
"BLD",3463,1,58,0)
This package transports the FileMan data dictionary named 2006.585.
"BLD",3463,1,59,0)
 
"BLD",3463,1,60,0)
Routines:
"BLD",3463,1,61,0)
MAGBRTUT    value = 6909436
"BLD",3463,1,62,0)
MAGDGMRC    value = 8627087
"BLD",3463,1,63,0)
MAGDHWA     value = 13381903
"BLD",3463,1,64,0)
MAGDIR81    value = 15986378
"BLD",3463,1,65,0)
MAGDIR9B    value = 6944410
"BLD",3463,1,66,0)
MAGDRPC1    value = 11246032
"BLD",3463,1,67,0)
MAGDRPC2    value = 13362997
"BLD",3463,1,68,0)
MAGDRPC3    value = 14213495
"BLD",3463,1,69,0)
MAGDRPC4    value = 17119065
"BLD",3463,1,70,0)
MAGDRPC9    value = 9264716
"BLD",3463,1,71,0)
MAGGTIA2    value = 7600790
"BLD",3463,1,72,0)
MAGIPS50    value = 7277874
"BLD",3463,1,73,0)
 
"BLD",3463,1,74,0)
Please note that routine MAGIPS50 is deleted after the KIDS Build is
"BLD",3463,1,75,0)
installed.
"BLD",3463,4,0)
^9.64PA^2006.585^6
"BLD",3463,4,2005,0)
2005
"BLD",3463,4,2005,2,0)
^9.641^2005^1
"BLD",3463,4,2005,2,2005,0)
IMAGE  (File-top level)
"BLD",3463,4,2005,2,2005,1,0)
^9.6411^253^2
"BLD",3463,4,2005,2,2005,1,252,0)
NEW SOP INSTANCE UID
"BLD",3463,4,2005,2,2005,1,253,0)
SERIES UID
"BLD",3463,4,2005,222)
y^y^p^^^^n^^n
"BLD",3463,4,2005,224)

"BLD",3463,4,2005.1,0)
2005.1
"BLD",3463,4,2005.1,2,0)
^9.641^2005.1^1
"BLD",3463,4,2005.1,2,2005.1,0)
IMAGE  (File-top level)
"BLD",3463,4,2005.1,2,2005.1,1,0)
^9.6411^253^2
"BLD",3463,4,2005.1,2,2005.1,1,252,0)
NEW SOP INSTANCE UID
"BLD",3463,4,2005.1,2,2005.1,1,253,0)
SERIES UID
"BLD",3463,4,2005.1,222)
y^y^p^^^^n^^n
"BLD",3463,4,2005.1,224)

"BLD",3463,4,2006.563,0)
2006.563
"BLD",3463,4,2006.563,222)
y^y^f^^^^n
"BLD",3463,4,2006.565,0)
2006.565
"BLD",3463,4,2006.565,222)
y^y^f^^^^n
"BLD",3463,4,2006.574,0)
2006.574
"BLD",3463,4,2006.574,222)
y^y^f^^^^n
"BLD",3463,4,2006.585,0)
2006.585
"BLD",3463,4,2006.585,222)
y^y^f^^^^n
"BLD",3463,4,"APDD",2005.1,2005.1)

"BLD",3463,4,"APDD",2005,2005)

"BLD",3463,4,"APDD",2005,2005,252)

"BLD",3463,4,"APDD",2005,2005,253)

"BLD",3463,4,"APDD",2005.1,2005.1)

"BLD",3463,4,"APDD",2005.1,2005.1,252)

"BLD",3463,4,"APDD",2005.1,2005.1,253)

"BLD",3463,4,"B",2005,2005)

"BLD",3463,4,"B",2005.1,2005.1)

"BLD",3463,4,"B",2006.563,2006.563)

"BLD",3463,4,"B",2006.565,2006.565)

"BLD",3463,4,"B",2006.574,2006.574)

"BLD",3463,4,"B",2006.585,2006.585)

"BLD",3463,"ABNS",0)
^9.66A^^
"BLD",3463,"ABPKG")
n^n^G.IMAGING DEVELOPMENT TEAM@DOMAIN.EXT
"BLD",3463,"INI")
PRE^MAGIPS50
"BLD",3463,"INID")
n^y^n
"BLD",3463,"INIT")
POST^MAGIPS50
"BLD",3463,"KRN",0)
^9.67PA^8994^19
"BLD",3463,"KRN",.4,0)
.4
"BLD",3463,"KRN",.401,0)
.401
"BLD",3463,"KRN",.402,0)
.402
"BLD",3463,"KRN",.403,0)
.403
"BLD",3463,"KRN",.5,0)
.5
"BLD",3463,"KRN",.84,0)
.84
"BLD",3463,"KRN",3.6,0)
3.6
"BLD",3463,"KRN",3.8,0)
3.8
"BLD",3463,"KRN",9.2,0)
9.2
"BLD",3463,"KRN",9.8,0)
9.8
"BLD",3463,"KRN",9.8,"NM",0)
^9.68A^11^11
"BLD",3463,"KRN",9.8,"NM",1,0)
MAGBRTUT^^0^B19755345
"BLD",3463,"KRN",9.8,"NM",2,0)
MAGDGMRC^^0^B32477984
"BLD",3463,"KRN",9.8,"NM",3,0)
MAGDHWA^^0^B58838393
"BLD",3463,"KRN",9.8,"NM",4,0)
MAGDIR81^^0^B74717291
"BLD",3463,"KRN",9.8,"NM",5,0)
MAGDIR9B^^0^B17634090
"BLD",3463,"KRN",9.8,"NM",6,0)
MAGDRPC1^^0^B57373178
"BLD",3463,"KRN",9.8,"NM",7,0)
MAGDRPC2^^0^B66416501
"BLD",3463,"KRN",9.8,"NM",8,0)
MAGDRPC3^^0^B62468863
"BLD",3463,"KRN",9.8,"NM",9,0)
MAGDRPC4^^0^B74521195
"BLD",3463,"KRN",9.8,"NM",10,0)
MAGDRPC9^^0^B29652420
"BLD",3463,"KRN",9.8,"NM",11,0)
MAGGTIA2^^0^B17645994
"BLD",3463,"KRN",9.8,"NM","B","MAGBRTUT",1)

"BLD",3463,"KRN",9.8,"NM","B","MAGDGMRC",2)

"BLD",3463,"KRN",9.8,"NM","B","MAGDHWA",3)

"BLD",3463,"KRN",9.8,"NM","B","MAGDIR81",4)

"BLD",3463,"KRN",9.8,"NM","B","MAGDIR9B",5)

"BLD",3463,"KRN",9.8,"NM","B","MAGDRPC1",6)

"BLD",3463,"KRN",9.8,"NM","B","MAGDRPC2",7)

"BLD",3463,"KRN",9.8,"NM","B","MAGDRPC3",8)

"BLD",3463,"KRN",9.8,"NM","B","MAGDRPC4",9)

"BLD",3463,"KRN",9.8,"NM","B","MAGDRPC9",10)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTIA2",11)

"BLD",3463,"KRN",19,0)
19
"BLD",3463,"KRN",19,"NM",0)
^9.68A^^
"BLD",3463,"KRN",19.1,0)
19.1
"BLD",3463,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3463,"KRN",101,0)
101
"BLD",3463,"KRN",101,"NM",0)
^9.68A^^
"BLD",3463,"KRN",409.61,0)
409.61
"BLD",3463,"KRN",771,0)
771
"BLD",3463,"KRN",870,0)
870
"BLD",3463,"KRN",8989.51,0)
8989.51
"BLD",3463,"KRN",8989.52,0)
8989.52
"BLD",3463,"KRN",8994,0)
8994
"BLD",3463,"KRN",8994,"NM",0)
^9.68A^7^7
"BLD",3463,"KRN",8994,"NM",1,0)
MAG DICOM GET ICN^^0
"BLD",3463,"KRN",8994,"NM",2,0)
MAG DICOM GET NEXT QUEUE ENTRY^^0
"BLD",3463,"KRN",8994,"NM",3,0)
MAG DICOM LOOKUP STUDY^^0
"BLD",3463,"KRN",8994,"NM",4,0)
MAG DICOM QUEUE IMAGE^^0
"BLD",3463,"KRN",8994,"NM",5,0)
MAG NEW SOP INSTANCE UID^^0
"BLD",3463,"KRN",8994,"NM",6,0)
MAG RAD GET NEXT RPT BY DATE^^0
"BLD",3463,"KRN",8994,"NM",7,0)
MAG RAD GET NEXT RPT BY PT^^0
"BLD",3463,"KRN",8994,"NM","B","MAG DICOM GET ICN",1)

"BLD",3463,"KRN",8994,"NM","B","MAG DICOM GET NEXT QUEUE ENTRY",2)

"BLD",3463,"KRN",8994,"NM","B","MAG DICOM LOOKUP STUDY",3)

"BLD",3463,"KRN",8994,"NM","B","MAG DICOM QUEUE IMAGE",4)

"BLD",3463,"KRN",8994,"NM","B","MAG NEW SOP INSTANCE UID",5)

"BLD",3463,"KRN",8994,"NM","B","MAG RAD GET NEXT RPT BY DATE",6)

"BLD",3463,"KRN",8994,"NM","B","MAG RAD GET NEXT RPT BY PT",7)

"BLD",3463,"KRN","B",.4,.4)

"BLD",3463,"KRN","B",.401,.401)

"BLD",3463,"KRN","B",.402,.402)

"BLD",3463,"KRN","B",.403,.403)

"BLD",3463,"KRN","B",.5,.5)

"BLD",3463,"KRN","B",.84,.84)

"BLD",3463,"KRN","B",3.6,3.6)

"BLD",3463,"KRN","B",3.8,3.8)

"BLD",3463,"KRN","B",9.2,9.2)

"BLD",3463,"KRN","B",9.8,9.8)

"BLD",3463,"KRN","B",19,19)

"BLD",3463,"KRN","B",19.1,19.1)

"BLD",3463,"KRN","B",101,101)

"BLD",3463,"KRN","B",409.61,409.61)

"BLD",3463,"KRN","B",771,771)

"BLD",3463,"KRN","B",870,870)

"BLD",3463,"KRN","B",8989.51,8989.51)

"BLD",3463,"KRN","B",8989.52,8989.52)

"BLD",3463,"KRN","B",8994,8994)

"BLD",3463,"REQB",0)
^9.611^1^1
"BLD",3463,"REQB",1,0)
MAG*3.0*51^2
"BLD",3463,"REQB","B","MAG*3.0*51",1)

"FIA",2005)
IMAGE
"FIA",2005,0)
^MAG(2005,
"FIA",2005,0,0)
2005I
"FIA",2005,0,1)
y^y^p^^^^n^^n
"FIA",2005,0,10)

"FIA",2005,0,11)

"FIA",2005,0,"RLRO")

"FIA",2005,2005)
1
"FIA",2005,2005,252)

"FIA",2005,2005,253)

"FIA",2005.1)
IMAGE
"FIA",2005.1,0)
^MAG(2005.1,
"FIA",2005.1,0,0)
2005.1I
"FIA",2005.1,0,1)
y^y^p^^^^n^^n
"FIA",2005.1,0,10)

"FIA",2005.1,0,11)

"FIA",2005.1,0,"RLRO")

"FIA",2005.1,2005.1)
1
"FIA",2005.1,2005.1,252)

"FIA",2005.1,2005.1,253)

"FIA",2006.563)
DICOM GATEWAY PARAMETER
"FIA",2006.563,0)
^MAGDICOM(2006.563,
"FIA",2006.563,0,0)
2006.563
"FIA",2006.563,0,1)
y^y^f^^^^n
"FIA",2006.563,0,10)

"FIA",2006.563,0,11)

"FIA",2006.563,0,"RLRO")

"FIA",2006.563,2006.563)
0
"FIA",2006.563,2006.5631)
0
"FIA",2006.563,2006.5632)
0
"FIA",2006.563,2006.5633)
0
"FIA",2006.563,2006.5634)
0
"FIA",2006.565)
EXPORT DICOM RUN
"FIA",2006.565,0)
^MAGDICOM(2006.565,
"FIA",2006.565,0,0)
2006.565D
"FIA",2006.565,0,1)
y^y^f^^^^n
"FIA",2006.565,0,10)

"FIA",2006.565,0,11)

"FIA",2006.565,0,"RLRO")

"FIA",2006.565,2006.565)
0
"FIA",2006.574)
DICOM IMAGE OUTPUT
"FIA",2006.574,0)
^MAGDOUTP(2006.574,
"FIA",2006.574,0,0)
2006.574
"FIA",2006.574,0,1)
y^y^f^^^^n
"FIA",2006.574,0,10)

"FIA",2006.574,0,11)

"FIA",2006.574,0,"RLRO")

"FIA",2006.574,2006.574)
0
"FIA",2006.574,2006.5744)
0
"FIA",2006.585)
USER APPLICATION
"FIA",2006.585,0)
^MAGDICOM(2006.585,
"FIA",2006.585,0,0)
2006.585
"FIA",2006.585,0,1)
y^y^f^^^^n
"FIA",2006.585,0,10)

"FIA",2006.585,0,11)

"FIA",2006.585,0,"RLRO")

"FIA",2006.585,2006.585)
0
"FIA",2006.585,2006.5852)
0
"FIA",2006.585,2006.58522)
0
"INI")
PRE^MAGIPS50
"INIT")
POST^MAGIPS50
"IX",2005,2005,"P",0)
2005^P^UID for corrected images^MU^^F^IR^I^2005^^^^^LS
"IX",2005,2005,"P",.1,0)
^^2^2^3041109^
"IX",2005,2005,"P",.1,1,0)
This cross-reference includes SOP Instance UIDs for corrected images
"IX",2005,2005,"P",.1,2,0)
in the cross-reference on the original SOP Instance UIDs.
"IX",2005,2005,"P",1)
S ^MAG(2005,"P",X,DA)=""
"IX",2005,2005,"P",2)
K ^MAG(2005,"P",X,DA)
"IX",2005,2005,"P",2.5)
K ^MAG(2005,"P")
"IX",2005,2005,"P",11.1,0)
^.114IA^1^1
"IX",2005,2005,"P",11.1,1,0)
1^F^2005^252^^1^F
"IX",2005,2005,"P",11.1,1,3)

"IX",2005,2005,"SERIESUID",0)
2005^SERIESUID^Images sorted by Series UID^R^^F^IR^I^2005^^^^^LS
"IX",2005,2005,"SERIESUID",.1,0)
^^2^2^3050803^
"IX",2005,2005,"SERIESUID",.1,1,0)
This cross-reference keeps track of which images have
"IX",2005,2005,"SERIESUID",.1,2,0)
which Series UID.
"IX",2005,2005,"SERIESUID",1)
S ^MAG(2005,"SERIESUID",X,DA)=""
"IX",2005,2005,"SERIESUID",2)
K ^MAG(2005,"SERIESUID",X,DA)
"IX",2005,2005,"SERIESUID",2.5)
K ^MAG(2005,"SERIESUID")
"IX",2005,2005,"SERIESUID",11.1,0)
^.114IA^1^1
"IX",2005,2005,"SERIESUID",11.1,1,0)
1^F^2005^253^^1^F
"IX",2005,2005,"SERIESUID",11.1,1,3)

"IX",2005.1,2005.1,"P",0)
2005.1^P^UID for corrected images^MU^^F^IR^I^2005.1^^^^^LS
"IX",2005.1,2005.1,"P",.1,0)
^^2^2^3041109^
"IX",2005.1,2005.1,"P",.1,1,0)
This cross-reference includes SOP Instance UIDs for corrected images
"IX",2005.1,2005.1,"P",.1,2,0)
in the cross-reference on the original SOP Instance UIDs.
"IX",2005.1,2005.1,"P",1)
S ^MAG(2005.1,"P",X,DA)=""
"IX",2005.1,2005.1,"P",2)
K ^MAG(2005.1,"P",X,DA)
"IX",2005.1,2005.1,"P",2.5)
K ^MAG(2005.1,"P")
"IX",2005.1,2005.1,"P",11.1,0)
^.114IA^1^1
"IX",2005.1,2005.1,"P",11.1,1,0)
1^F^2005.1^252^^1^F
"IX",2005.1,2005.1,"P",11.1,1,3)

"IX",2005.1,2005.1,"SERIESUID",0)
2005.1^SERIESUID^Images sorted by Series UID^R^^F^IR^I^2005.1^^^^^LS
"IX",2005.1,2005.1,"SERIESUID",.1,0)
^^2^2^3050803^
"IX",2005.1,2005.1,"SERIESUID",.1,1,0)
This cross-reference keeps track of which images have
"IX",2005.1,2005.1,"SERIESUID",.1,2,0)
which Series UID.
"IX",2005.1,2005.1,"SERIESUID",1)
S ^MAG(2005.1,"SERIESUID",X,DA)=""
"IX",2005.1,2005.1,"SERIESUID",2)
K ^MAG(2005.1,"SERIESUID",X,DA)
"IX",2005.1,2005.1,"SERIESUID",2.5)
K ^MAG(2005.1,"SERIESUID")
"IX",2005.1,2005.1,"SERIESUID",11.1,0)
^.114IA^1^1
"IX",2005.1,2005.1,"SERIESUID",11.1,1,0)
1^F^2005.1^253^^1^F
"IX",2005.1,2005.1,"SERIESUID",11.1,1,3)

"IX",2006.574,2006.574,"STS",0)
2006.574^STS^Origin and Status^R^^R^IR^W^2006.5744^^^^^LS
"IX",2006.574,2006.574,"STS",.1,0)
^^5^5^3041029^
"IX",2006.574,2006.574,"STS",.1,1,0)
 
"IX",2006.574,2006.574,"STS",.1,2,0)
 
"IX",2006.574,2006.574,"STS",.1,3,0)
This cross-reference keeps track of ORIGIN and STATUS.
"IX",2006.574,2006.574,"STS",.1,4,0)
The main purpose of this cross-reference is to make sure
"IX",2006.574,2006.574,"STS",.1,5,0)
that files are issued to only one transmission process.
"IX",2006.574,2006.574,"STS",1)
S ^MAGDOUTP(2006.574,"STS",X(1),X(2),DA(1),DA)=""
"IX",2006.574,2006.574,"STS",2)
K ^MAGDOUTP(2006.574,"STS",X(1),X(2),DA(1),DA)
"IX",2006.574,2006.574,"STS",2.5)
K ^MAGDOUTP(2006.574,"STS")
"IX",2006.574,2006.574,"STS",11.1,0)
^.114IA^3^2
"IX",2006.574,2006.574,"STS",11.1,2,0)
2^F^2006.5744^2^^2^F
"IX",2006.574,2006.574,"STS",11.1,2,3)

"IX",2006.574,2006.574,"STS",11.1,3,0)
1^C^^^^1^^Origin
"IX",2006.574,2006.574,"STS",11.1,3,1.5)
S X=$P(^MAGDOUTP(2006.574,DA(1),0),"^",4)
"KRN",8994,123457,-1)
0^1
"KRN",8994,123457,0)
MAG DICOM GET ICN^GETICN^MAGDRPC9^1^P
"KRN",8994,123457,1,0)
^8994.01^16^16^3021002^^
"KRN",8994,123457,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123457,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123457,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123457,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123457,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123457,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123457,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123457,1,8,0)
 |                                                               |
"KRN",8994,123457,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123457,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123457,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123457,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123457,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123457,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123457,1,15,0)
 
"KRN",8994,123457,1,16,0)
Returns the ICN (with checksum) for a given DFN, if it exists.
"KRN",8994,123457,2,0)
^8994.02A^1^1
"KRN",8994,123457,2,1,0)
DFN^1^^1^1
"KRN",8994,123457,2,1,1,0)
^^1^1^3041208^
"KRN",8994,123457,2,1,1,1,0)
Patient pointer.
"KRN",8994,123457,2,"B","DFN",1)

"KRN",8994,123457,2,"PARAMSEQ",1,1)

"KRN",8994,123457,3,0)
^^1^1^3041208^
"KRN",8994,123457,3,1,0)
Integration Control Number for the given DFN.
"KRN",8994,123458,-1)
0^2
"KRN",8994,123458,0)
MAG DICOM GET NEXT QUEUE ENTRY^NEXTIMG^MAGDRPC4^2^R^0^0^1^3^0
"KRN",8994,123458,1,0)
^8994.01^18^18^3050614^
"KRN",8994,123458,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123458,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123458,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123458,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123458,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123458,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123458,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123458,1,8,0)
 |                                                               |
"KRN",8994,123458,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123458,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123458,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123458,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123458,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123458,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123458,1,15,0)
 
"KRN",8994,123458,1,16,0)
This RPC will check if there are any new images to be transmitted,
"KRN",8994,123458,1,17,0)
and will return information about the first or next one (if any)
"KRN",8994,123458,1,18,0)
in the DICOM transmission queue.
"KRN",8994,123458,2,0)
^8994.02A^5^3
"KRN",8994,123458,2,1,0)
LOCATION^1^30^1^1
"KRN",8994,123458,2,1,1,0)
^8994.021^3^3
"KRN",8994,123458,2,1,1,1,0)
The value of this parameter is a pointer to ^DIC(4).
"KRN",8994,123458,2,1,1,2,0)
This pointer identifies the location at which images were acquired,
"KRN",8994,123458,2,1,1,3,0)
i.e., from where they are being transmitted.
"KRN",8994,123458,2,4,0)
SENT^2^10000^0^2
"KRN",8994,123458,2,4,1,0)
^8994.021^5^5^3050614^
"KRN",8994,123458,2,4,1,1,0)
This parameter is an array. Each element of this array
"KRN",8994,123458,2,4,1,2,0)
contains internal entry numbers that identify an entry
"KRN",8994,123458,2,4,1,3,0)
in the send-queue that has been transmitted successfully.
"KRN",8994,123458,2,4,1,4,0)
The RPC will use the contents of this array to remove
"KRN",8994,123458,2,4,1,5,0)
entries from the queue that have been transmitted.
"KRN",8994,123458,2,5,0)
CHECK^1^5^0^3
"KRN",8994,123458,2,5,1,0)
^8994.021^6^6^3050614^^
"KRN",8994,123458,2,5,1,1,0)
The value of this parameter is a boolean value.
"KRN",8994,123458,2,5,1,2,0)
When the value of this parameter is non-zero (true),
"KRN",8994,123458,2,5,1,3,0)
the RPC will not mark the queue entry as being "in transmission".
"KRN",8994,123458,2,5,1,4,0)
This feature is used when the RPC is being called for the
"KRN",8994,123458,2,5,1,5,0)
sole purpose of deternining whether or not there are
"KRN",8994,123458,2,5,1,6,0)
any entries in the queue.
"KRN",8994,123458,2,"B","CHECK",5)

"KRN",8994,123458,2,"B","LOCATION",1)

"KRN",8994,123458,2,"B","SENT",4)

"KRN",8994,123458,2,"PARAMSEQ",1,1)

"KRN",8994,123458,2,"PARAMSEQ",2,4)

"KRN",8994,123458,2,"PARAMSEQ",3,5)

"KRN",8994,123458,3,0)
^8994.03^18^18^3050614^
"KRN",8994,123458,3,1,0)
The first element of the output array indicates whether there
"KRN",8994,123458,3,2,0)
are any images to be transmitted.
"KRN",8994,123458,3,3,0)
If there are none, or if there is an error in one or more input parameters,
"KRN",8994,123458,3,4,0)
OUT(1) will reflect this. Otherwise:
"KRN",8994,123458,3,5,0)
 OUT(1) = 1
"KRN",8994,123458,3,6,0)
 OUT(2) = New value for D0
"KRN",8994,123458,3,7,0)
 OUT(3) = New value for D1
"KRN",8994,123458,3,8,0)
 OUT(4) = Destination Application
"KRN",8994,123458,3,9,0)
 OUT(5) = Group
"KRN",8994,123458,3,10,0)
 OUT(6) = Accession number
"KRN",8994,123458,3,11,0)
 OUT(7) = Image Number
"KRN",8994,123458,3,12,0)
 OUT(8) = Object Type
"KRN",8994,123458,3,13,0)
 OUT(9) = File Name (including directory path)
"KRN",8994,123458,3,14,0)
 OUT(10) = File Name (file name only)
"KRN",8994,123458,3,15,0)
Possible error messages:
"KRN",8994,123458,3,16,0)
  OUT(1)="-1,No Origin Specified"
"KRN",8994,123458,3,17,0)
  OUT(1)="-2,No studies to be transmitted"
"KRN",8994,123458,3,18,0)
  OUT(1)="-3,No files to be transmitted"
"KRN",8994,123459,-1)
0^3
"KRN",8994,123459,0)
MAG DICOM LOOKUP STUDY^LOOKUP^MAGDRPC4^2^R^0^0^1^3^0
"KRN",8994,123459,1,0)
^8994.01^17^17
"KRN",8994,123459,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123459,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123459,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123459,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123459,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123459,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123459,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123459,1,8,0)
 |                                                               |
"KRN",8994,123459,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123459,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123459,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123459,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123459,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123459,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123459,1,15,0)
 
"KRN",8994,123459,1,16,0)
This RPC looks up a study that might be a Radiology Study
"KRN",8994,123459,1,17,0)
or a Clinical Specialty, based on the specified (case) number.
"KRN",8994,123459,2,0)
^8994.02^1^1
"KRN",8994,123459,2,1,0)
NUMBER^1^30^1^1
"KRN",8994,123459,2,1,1,0)
^8994.021^6^6
"KRN",8994,123459,2,1,1,1,0)
The value of this parameter is a number that identifies a
"KRN",8994,123459,2,1,1,2,0)
study. Such a number would be a date-case number for a Radiology
"KRN",8994,123459,2,1,1,3,0)
study, or just a number for a Consult.
"KRN",8994,123459,2,1,1,4,0)
The value of this parameter may also be a string that consists of
"KRN",8994,123459,2,1,1,5,0)
a "tick-mark" (`), followed by the internal entry number of
"KRN",8994,123459,2,1,1,6,0)
an image.
"KRN",8994,123459,2,"B","NUMBER",1)

"KRN",8994,123459,2,"PARAMSEQ",1,1)

"KRN",8994,123459,3,0)
^8994.03^18^18
"KRN",8994,123459,3,1,0)
The output array of this RPC is a list of all studies that
"KRN",8994,123459,3,2,0)
match the specified number.
"KRN",8994,123459,3,3,0)
The first element of the output array indicates the number
"KRN",8994,123459,3,4,0)
of studies that were found. The other elements of the
"KRN",8994,123459,3,5,0)
output array each contain the following pieces of information,
"KRN",8994,123459,3,6,0)
separated by carets:
"KRN",8994,123459,3,7,0)
 1. File number
"KRN",8994,123459,3,8,0)
 2. Internal entry number
"KRN",8994,123459,3,9,0)
 3. Image number
"KRN",8994,123459,3,10,0)
 4. Accession number
"KRN",8994,123459,3,11,0)
Possible error messages:
"KRN",8994,123459,3,12,0)
  OUT(1)="-1,No Case or Consult Number Specified"
"KRN",8994,123459,3,13,0)
  OUT(1)="-2,No Study Date Specified"
"KRN",8994,123459,3,14,0)
  OUT(1)="-3,Invalid study date xxx."
"KRN",8994,123459,3,15,0)
  OUT(1)="-4,Consult is cancelled"
"KRN",8994,123459,3,16,0)
  OUT(1)="-5,Consult/procedure not on file"
"KRN",8994,123459,3,17,0)
  OUT(1)="-6,Invalid image (nnn)"
"KRN",8994,123459,3,18,0)
  OUT(1)="-7,Parent file xxx not yet supported."
"KRN",8994,123460,-1)
0^4
"KRN",8994,123460,0)
MAG DICOM QUEUE IMAGE^QUEUE^MAGDRPC3^1^R^0^0^1^3^0
"KRN",8994,123460,1,0)
^8994.01^22^22^3060214^^^
"KRN",8994,123460,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123460,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123460,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123460,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123460,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123460,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123460,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123460,1,8,0)
 |                                                               |
"KRN",8994,123460,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123460,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123460,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123460,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123460,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123460,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123460,1,15,0)
 
"KRN",8994,123460,1,16,0)
This RPC enters a study into the DICOM Transmission queue.
"KRN",8994,123460,1,17,0)
In the simplest case, a study contains only one image.
"KRN",8994,123460,1,18,0)
More normally, a study consists of several images.
"KRN",8994,123460,1,19,0)
For object types 3 (X-RAY) and 100 (DICOM image), a single image is entered
"KRN",8994,123460,1,20,0)
into the transmission queue.
"KRN",8994,123460,1,21,0)
For object type 11 (X-RAY group) , all images for the study are
"KRN",8994,123460,1,22,0)
entered into the transmission queue.
"KRN",8994,123460,2,0)
^8994.02A^8^8
"KRN",8994,123460,2,1,0)
IMAGE^1^30^1^1
"KRN",8994,123460,2,1,1,0)
^8994.021^2^2
"KRN",8994,123460,2,1,1,1,0)
The value of this parameter is a pointer to ^MAG(2005).
"KRN",8994,123460,2,1,1,2,0)
This pointer identifies the image that is to be transmitted.
"KRN",8994,123460,2,2,0)
DESTINAT^1^20^1^2
"KRN",8994,123460,2,2,1,0)
^8994.021^3^3
"KRN",8994,123460,2,2,1,1,0)
The value of this field is the name of the DICOM SOP Class Provider
"KRN",8994,123460,2,2,1,2,0)
to which the images are to be transmitted. This name must
"KRN",8994,123460,2,2,1,3,0)
occur in the User Application List file (#2006.585).
"KRN",8994,123460,2,3,0)
LOCATION^1^20^1^3
"KRN",8994,123460,2,3,1,0)
^8994.021^2^2
"KRN",8994,123460,2,3,1,1,0)
The value of this parameter is a pointer to ^DIC(4).
"KRN",8994,123460,2,3,1,2,0)
This pointer identifies the location at which images were acquired.
"KRN",8994,123460,2,4,0)
ACCESSIO^1^20^0^4
"KRN",8994,123460,2,4,1,0)
^8994.021^2^2
"KRN",8994,123460,2,4,1,1,0)
The value of this optional parameter is the accession number
"KRN",8994,123460,2,4,1,2,0)
for the study.
"KRN",8994,123460,2,5,0)
REASON^1^100^0^5
"KRN",8994,123460,2,5,1,0)
^8994.021^3^3^3050602^
"KRN",8994,123460,2,5,1,1,0)
The value of this optional parameter is a string that represents
"KRN",8994,123460,2,5,1,2,0)
the reason for the transmission of the image.
"KRN",8994,123460,2,5,1,3,0)
This reason will be stored in ^MAG(2006.95) (IMAGE ACCESS LOG).
"KRN",8994,123460,2,6,0)
EMAIL^1^100^0^6
"KRN",8994,123460,2,6,1,0)
^8994.021^3^3^3050602^^
"KRN",8994,123460,2,6,1,1,0)
The value of this optional parameter is a string that represents
"KRN",8994,123460,2,6,1,2,0)
an e-mail address. This e-mail address is used to transmit a
"KRN",8994,123460,2,6,1,3,0)
message when there are images that cannot be enqueued.
"KRN",8994,123460,2,7,0)
PRIORITY^1^10^0^7
"KRN",8994,123460,2,7,1,0)
^8994.021^4^4^3060214^^
"KRN",8994,123460,2,7,1,1,0)
The value of this parameter is a positive integer number.
"KRN",8994,123460,2,7,1,2,0)
This value indicates the relative priority of an entry in the
"KRN",8994,123460,2,7,1,3,0)
transmission queue. A higher number indicates a higher priority.
"KRN",8994,123460,2,7,1,4,0)
The default value of this optional parameter is 500.
"KRN",8994,123460,2,8,0)
JBTOHD^1^10^0^8
"KRN",8994,123460,2,8,1,0)
^^5^5^3060214^
"KRN",8994,123460,2,8,1,1,0)
The value of this parameter is a boolean switch that indicates
"KRN",8994,123460,2,8,1,2,0)
whether or not a copy of the image file(s) is to be made on
"KRN",8994,123460,2,8,1,3,0)
RAID. A true value indicates that a copy on magnetic storage
"KRN",8994,123460,2,8,1,4,0)
is to be made, a false value indicates that no such copy is
"KRN",8994,123460,2,8,1,5,0)
to be made.
"KRN",8994,123460,2,"B","ACCESSIO",4)

"KRN",8994,123460,2,"B","DESTINAT",2)

"KRN",8994,123460,2,"B","EMAIL",6)

"KRN",8994,123460,2,"B","IMAGE",1)

"KRN",8994,123460,2,"B","JBTOHD",8)

"KRN",8994,123460,2,"B","LOCATION",3)

"KRN",8994,123460,2,"B","PRIORITY",7)

"KRN",8994,123460,2,"B","REASON",5)

"KRN",8994,123460,2,"PARAMSEQ",1,1)

"KRN",8994,123460,2,"PARAMSEQ",2,2)

"KRN",8994,123460,2,"PARAMSEQ",3,3)

"KRN",8994,123460,2,"PARAMSEQ",4,4)

"KRN",8994,123460,2,"PARAMSEQ",5,5)

"KRN",8994,123460,2,"PARAMSEQ",6,6)

"KRN",8994,123460,2,"PARAMSEQ",7,7)

"KRN",8994,123460,2,"PARAMSEQ",8,8)

"KRN",8994,123460,3,0)
^8994.03^6^6^3060214^^^
"KRN",8994,123460,3,1,0)
The output value of this RPC indicates whether or not the
"KRN",8994,123460,3,2,0)
queuing of the image(s) was successful. If successful, the return
"KRN",8994,123460,3,3,0)
value is always equal to 1. Possible error messages:
"KRN",8994,123460,3,4,0)
  OUT="-1,No Image specified"
"KRN",8994,123460,3,5,0)
  OUT="-2,No Destination specified"
"KRN",8994,123460,3,6,0)
  OUT="-3,No Origin specified"
"KRN",8994,123461,-1)
0^5
"KRN",8994,123461,0)
MAG NEW SOP INSTANCE UID^NEWUID^MAGDRPC9^1^R^0^^0^3
"KRN",8994,123461,1,0)
^8994.01^20^20^3050706^^^
"KRN",8994,123461,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123461,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123461,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123461,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123461,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123461,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123461,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123461,1,8,0)
 |                                                               |
"KRN",8994,123461,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123461,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123461,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123461,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123461,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123461,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123461,1,15,0)
 
"KRN",8994,123461,1,16,0)
This RPC stores a new SOP Instance UID in the Image File (#2005)
"KRN",8994,123461,1,17,0)
for corrected images that are to be exported.
"KRN",8994,123461,1,18,0)
 
"KRN",8994,123461,1,19,0)
This RPC stores a new SOP Instance UID in the Image File (#2005)
"KRN",8994,123461,1,20,0)
for corrected images that are to be exported.
"KRN",8994,123461,2,0)
^8994.02A^3^3
"KRN",8994,123461,2,1,0)
OLD^1^64^1^1
"KRN",8994,123461,2,1,1,0)
^^3^3^3041109^
"KRN",8994,123461,2,1,1,1,0)
The value of this parameter is a string.
"KRN",8994,123461,2,1,1,2,0)
This value represents the original SOP Instance UID of an image
"KRN",8994,123461,2,1,1,3,0)
that is to be exported.
"KRN",8994,123461,2,2,0)
NEW^1^64^1^2
"KRN",8994,123461,2,2,1,0)
^8994.021^3^3^3050706^^
"KRN",8994,123461,2,2,1,1,0)
The value of this parameter is a string.
"KRN",8994,123461,2,2,1,2,0)
This value represents the new SOP Instance UID that is to
"KRN",8994,123461,2,2,1,3,0)
be assigned to the corrected image that is to be exported.
"KRN",8994,123461,2,3,0)
IMAGE^1^10^0^3
"KRN",8994,123461,2,3,1,0)
^^6^6^3050706^
"KRN",8994,123461,2,3,1,1,0)
The value of this parameter is a
"KRN",8994,123461,2,3,1,2,0)
number. This number is a pointer that identifies
"KRN",8994,123461,2,3,1,3,0)
an image (pointer to file # 2005).
"KRN",8994,123461,2,3,1,4,0)
 
"KRN",8994,123461,2,3,1,5,0)
When this parameter is specified, it identifies the
"KRN",8994,123461,2,3,1,6,0)
image to which the new UID is intended to be added.
"KRN",8994,123461,2,"B","IMAGE",3)

"KRN",8994,123461,2,"B","NEW",2)

"KRN",8994,123461,2,"B","OLD",1)

"KRN",8994,123461,2,"PARAMSEQ",1,1)

"KRN",8994,123461,2,"PARAMSEQ",2,2)

"KRN",8994,123461,2,"PARAMSEQ",3,3)

"KRN",8994,123461,3,0)
^8994.03^8^8^3050706^^
"KRN",8994,123461,3,1,0)
The value of this parameter is one of several possible strings:
"KRN",8994,123461,3,2,0)
A value >0 indicates the new SOP Instance UID that is assigned
"KRN",8994,123461,3,3,0)
to the image.
"KRN",8994,123461,3,4,0)
 
"KRN",8994,123461,3,5,0)
When no new SOP Instance UID can be assigned, the return value can be:
"KRN",8994,123461,3,6,0)
   -1, No UID specified
"KRN",8994,123461,3,7,0)
   -2, Cannot find image with UID xxx
"KRN",8994,123461,3,8,0)
   -3, Cannot use xxx to create valid UID
"KRN",8994,123462,-1)
0^6
"KRN",8994,123462,0)
MAG RAD GET NEXT RPT BY DATE^NEXT^MAGDRPC9^1^R^0^^0^3
"KRN",8994,123462,1,0)
^8994.01^22^22^3021002^^
"KRN",8994,123462,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123462,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123462,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123462,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123462,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123462,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123462,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123462,1,8,0)
 |                                                               |
"KRN",8994,123462,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123462,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123462,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123462,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123462,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123462,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123462,1,15,0)
 
"KRN",8994,123462,1,16,0)
This RPC looks for the next radiology report,
"KRN",8994,123462,1,17,0)
while traversing the "AR" cross-reference on
"KRN",8994,123462,1,18,0)
the Radiology Patient file.
"KRN",8994,123462,1,19,0)
 
"KRN",8994,123462,1,20,0)
This RPC looks for the next radiology report,
"KRN",8994,123462,1,21,0)
while traversing the "AR" cross-reference on
"KRN",8994,123462,1,22,0)
the Radiology Patient file.
"KRN",8994,123462,2,0)
^8994.02A^2^2
"KRN",8994,123462,2,1,0)
SEED^1^60^1^1
"KRN",8994,123462,2,1,1,0)
^^11^11^3041123^
"KRN",8994,123462,2,1,1,1,0)
The value of this parameter is a string that consists of three
"KRN",8994,123462,2,1,1,2,0)
pieces, separated by a caret.
"KRN",8994,123462,2,1,1,3,0)
 
"KRN",8994,123462,2,1,1,4,0)
The first piece represents the EXAM DATE, the second
"KRN",8994,123462,2,1,1,5,0)
piece represents the Patient Number (DFN) and  the third
"KRN",8994,123462,2,1,1,6,0)
piece represents the final internal entry number in the
"KRN",8994,123462,2,1,1,7,0)
Radiology Patient file (D2).
"KRN",8994,123462,2,1,1,8,0)
 
"KRN",8994,123462,2,1,1,9,0)
The RPC will start looking through the "AR" cross-reference,
"KRN",8994,123462,2,1,1,10,0)
based on the specified "seed" value, and will return the
"KRN",8994,123462,2,1,1,11,0)
first pointer to a Radiology report that it encounters.
"KRN",8994,123462,2,2,0)
DIR^1^20^0^2
"KRN",8994,123462,2,2,1,0)
^^8^8^3041123^
"KRN",8994,123462,2,2,1,1,0)
The value of this parameter is a string that indicates the direction
"KRN",8994,123462,2,2,1,2,0)
in which the RPC will traverse the "AR" cross-reference.
"KRN",8994,123462,2,2,1,3,0)
A value that starts with the letter "A" will cause an
"KRN",8994,123462,2,2,1,4,0)
"ascending" traversal.
"KRN",8994,123462,2,2,1,5,0)
A value that starts with the letter "D" will cause a
"KRN",8994,123462,2,2,1,6,0)
"descending" traversal.
"KRN",8994,123462,2,2,1,7,0)
 
"KRN",8994,123462,2,2,1,8,0)
When this parameter is not specified, "ascending" traversal will take place.
"KRN",8994,123462,2,"B","DIR",2)

"KRN",8994,123462,2,"B","SEED",1)

"KRN",8994,123462,2,"PARAMSEQ",1,1)

"KRN",8994,123462,2,"PARAMSEQ",2,2)

"KRN",8994,123462,3,0)
^^10^10^3041123^
"KRN",8994,123462,3,1,0)
The value of the output parameter is a string that consists of up
"KRN",8994,123462,3,2,0)
to four pieces, separated by carets.
"KRN",8994,123462,3,3,0)
 
"KRN",8994,123462,3,4,0)
The first piece is a value that is either equal to "-1" to indicate
"KRN",8994,123462,3,5,0)
that no further reports are to be found, or equal to a pointer value
"KRN",8994,123462,3,6,0)
that identifies a Radiology Report (file #74).
"KRN",8994,123462,3,7,0)
 
"KRN",8994,123462,3,8,0)
The other three pieces correspond to Exam Date, Patient Number (DFN)
"KRN",8994,123462,3,9,0)
and final IEN (D2) to be specified as the "seed" value in the
"KRN",8994,123462,3,10,0)
next call to this RPC.
"KRN",8994,123463,-1)
0^7
"KRN",8994,123463,0)
MAG RAD GET NEXT RPT BY PT^NXTPTRPT^MAGDRPC9^1^P
"KRN",8994,123463,1,0)
^8994.01^16^16^3021002^^
"KRN",8994,123463,1,1,0)
 +---------------------------------------------------------------+
"KRN",8994,123463,1,2,0)
 | Property of the US Government.                                |
"KRN",8994,123463,1,3,0)
 | No permission to copy or redistribute this software is given. |
"KRN",8994,123463,1,4,0)
 | Use of unreleased versions of this software requires the user |
"KRN",8994,123463,1,5,0)
 | to execute a written test agreement with the VistA Imaging    |
"KRN",8994,123463,1,6,0)
 | Development Office of the Department of Veterans Affairs,     |
"KRN",8994,123463,1,7,0)
 | telephone (301) 734-0100.                                     |
"KRN",8994,123463,1,8,0)
 |                                                               |
"KRN",8994,123463,1,9,0)
 | The Food and Drug Administration classifies this software as  |
"KRN",8994,123463,1,10,0)
 | a medical device.  As such, it may not be changed in any way. |
"KRN",8994,123463,1,11,0)
 | Modifications to this software may result in an adulterated   |
"KRN",8994,123463,1,12,0)
 | medical device under 21CFR820, the use of which is considered |
"KRN",8994,123463,1,13,0)
 | to be a violation of US Federal Statutes.                     |
"KRN",8994,123463,1,14,0)
 +---------------------------------------------------------------+
"KRN",8994,123463,1,15,0)
 
"KRN",8994,123463,1,16,0)
Returns the next ^RARPT entry for the patient.
"KRN",8994,123463,2,0)
^8994.02A^3^3
"KRN",8994,123463,2,1,0)
DFN^1^^1^1
"KRN",8994,123463,2,1,1,0)
^^1^1^3041208^
"KRN",8994,123463,2,1,1,1,0)
Patient pointer.
"KRN",8994,123463,2,2,0)
RARPT1^1^^1^2
"KRN",8994,123463,2,2,1,0)
^8994.021^1^1^3041208^^
"KRN",8994,123463,2,2,1,1,0)
^RARPT pointer - origin of search.  Next one is before it or after it.
"KRN",8994,123463,2,3,0)
DIR^1^^0^3
"KRN",8994,123463,2,3,1,0)
^8994.021^2^2^3041208^^
"KRN",8994,123463,2,3,1,1,0)
Direction to transverse ^RADPT (increasing or decreasing report number).
"KRN",8994,123463,2,3,1,2,0)
1 = increasing report number, -1 = decreasing report number.
"KRN",8994,123463,2,"B","DFN",1)

"KRN",8994,123463,2,"B","DIR",3)

"KRN",8994,123463,2,"B","RARPT1",2)

"KRN",8994,123463,2,"PARAMSEQ",1,1)

"KRN",8994,123463,2,"PARAMSEQ",2,2)

"KRN",8994,123463,2,"PARAMSEQ",3,3)

"KRN",8994,123463,3,0)
^8994.03^1^1^3041208^^
"KRN",8994,123463,3,1,0)
Returns the next or previous ^RARPT pointer for the patient.
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"PKG",454,-1)
1^1
"PKG",454,0)
IMAGING^MAG^Imaging Release History
"PKG",454,22,0)
^9.49I^1^1
"PKG",454,22,1,0)
3.0^3020328^3020328^.5
"PKG",454,22,1,"PAH",1,0)
50^3060526^.5
"PKG",454,22,1,"PAH",1,1,0)
^9.49011^18^18^3060526
"PKG",454,22,1,"PAH",1,1,1,0)
Routines for Patch 50, Test Build 31.
"PKG",454,22,1,"PAH",1,1,2,0)
 
"PKG",454,22,1,"PAH",1,1,3,0)
Routines:
"PKG",454,22,1,"PAH",1,1,4,0)
MAGBRTUT    value = 6909436
"PKG",454,22,1,"PAH",1,1,5,0)
MAGDGMRC    value = 8627087
"PKG",454,22,1,"PAH",1,1,6,0)
MAGDHWA     value = 13381903
"PKG",454,22,1,"PAH",1,1,7,0)
MAGDIR81    value = 15986378
"PKG",454,22,1,"PAH",1,1,8,0)
MAGDIR9B    value = 6944410
"PKG",454,22,1,"PAH",1,1,9,0)
MAGDRPC1    value = 11246032
"PKG",454,22,1,"PAH",1,1,10,0)
MAGDRPC2    value = 13362997
"PKG",454,22,1,"PAH",1,1,11,0)
MAGDRPC3    value = 14213495
"PKG",454,22,1,"PAH",1,1,12,0)
MAGDRPC4    value = 17119065
"PKG",454,22,1,"PAH",1,1,13,0)
MAGDRPC9    value = 9264716
"PKG",454,22,1,"PAH",1,1,14,0)
MAGGTIA2    value = 7600790
"PKG",454,22,1,"PAH",1,1,15,0)
MAGIPS50    value = 7277874
"PKG",454,22,1,"PAH",1,1,16,0)
 
"PKG",454,22,1,"PAH",1,1,17,0)
Please note that routine MAGIPS50 is deleted after the KIDS Build is
"PKG",454,22,1,"PAH",1,1,18,0)
installed.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
12
"RTN","MAGBRTUT")
0^1^B19755345
"RTN","MAGBRTUT",1,0)
MAGBRTUT ;WOIFO/EdM - Routing Utilities ; 08/18/2005  07:59
"RTN","MAGBRTUT",2,0)
 ;;3.0;IMAGING;**9,11,30,51,50**;26-May-2006
"RTN","MAGBRTUT",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGBRTUT",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGBRTUT",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGBRTUT",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGBRTUT",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGBRTUT",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGBRTUT",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGBRTUT",10,0)
 ;; |                                                               |
"RTN","MAGBRTUT",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGBRTUT",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGBRTUT",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGBRTUT",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGBRTUT",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGBRTUT",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGBRTUT",17,0)
 ;;
"RTN","MAGBRTUT",18,0)
 Q
"RTN","MAGBRTUT",19,0)
 ;
"RTN","MAGBRTUT",20,0)
SEND(IMAGE,LOC,PRI,MECH,FROM,ID) ; Enter image into Routing Queue
"RTN","MAGBRTUT",21,0)
 ; IMAGE ;---- Internal Entry Number in Image FIle
"RTN","MAGBRTUT",22,0)
 ; LOC ;------ Internal Entry Number in either Network Location file
"RTN","MAGBRTUT",23,0)
 ;             or SCU_List file
"RTN","MAGBRTUT",24,0)
 ; PRI ;------ Priority
"RTN","MAGBRTUT",25,0)
 ; MECHanism = 1: Send using MS-DOS-Copy
"RTN","MAGBRTUT",26,0)
 ;           = 2: Send using DICOM_Send
"RTN","MAGBRTUT",27,0)
 ; FROM ;----- Location from which request originates
"RTN","MAGBRTUT",28,0)
 ; ID ;------- Transaction ID
"RTN","MAGBRTUT",29,0)
 N D0 ;------- Internal Entry number
"RTN","MAGBRTUT",30,0)
 N FLAG ;----- List of file-types to transmit
"RTN","MAGBRTUT",31,0)
 N I ;-------- Scratch and loop counter
"RTN","MAGBRTUT",32,0)
 N ORIGIN ;--- Location from which image is being sent (IEN in Institution file)
"RTN","MAGBRTUT",33,0)
 N QQ ;------- List of queue-entries created
"RTN","MAGBRTUT",34,0)
 ;
"RTN","MAGBRTUT",35,0)
 S QQ="",MECH=$G(MECH) S:'MECH MECH=1
"RTN","MAGBRTUT",36,0)
 I '$D(^MAG(2005,+$G(IMAGE))) Q:$Q QQ Q
"RTN","MAGBRTUT",37,0)
 I MECH=1,'$D(^MAG(2005.2,+$G(LOC))) Q:$Q QQ Q
"RTN","MAGBRTUT",38,0)
 I MECH=2,'$D(^MAG(2006.587,+$G(LOC))) Q:$Q QQ Q
"RTN","MAGBRTUT",39,0)
 I MECH'=1,MECH'=2 Q:$Q QQ Q
"RTN","MAGBRTUT",40,0)
 S:MECH=1 LOC=(+LOC)_";MAG(2005.2,"
"RTN","MAGBRTUT",41,0)
 S:MECH=2 LOC=(+LOC)_";MAG(2006.587,"
"RTN","MAGBRTUT",42,0)
 ;
"RTN","MAGBRTUT",43,0)
 S ORIGIN=$G(FROM) D:'ORIGIN
"RTN","MAGBRTUT",44,0)
 . S ORIGIN=$P($G(^MAG(2005,IMAGE,100)),"^",3)
"RTN","MAGBRTUT",45,0)
 . S:'ORIGIN ORIGIN=$G(DUZ(2))
"RTN","MAGBRTUT",46,0)
 . S:'ORIGIN ORIGIN=$$KSP^XUPARAM("INST")
"RTN","MAGBRTUT",47,0)
 . Q
"RTN","MAGBRTUT",48,0)
 ;
"RTN","MAGBRTUT",49,0)
 S PRI=$G(PRI,500),ID=$G(ID)
"RTN","MAGBRTUT",50,0)
 S FLAG=$G(^MAG(2005.2,+LOC,1)) S:MECH=2 FLAG="^^^^5"
"RTN","MAGBRTUT",51,0)
 ;
"RTN","MAGBRTUT",52,0)
 I MECH=2 D  Q:$Q QQ Q
"RTN","MAGBRTUT",53,0)
 . ; Stopgap until "native DICOM" storage is supported
"RTN","MAGBRTUT",54,0)
 . N APPNAM
"RTN","MAGBRTUT",55,0)
 . S APPNAM=$P($G(^MAG(2006.587,+LOC,0)),"^",1)
"RTN","MAGBRTUT",56,0)
 . D QUEUE^MAGDRPC3(.QQ,IMAGE,APPNAM,ORIGIN,"","6: Copy to HIPAA Compliant Storage",,PRI)
"RTN","MAGBRTUT",57,0)
 . Q
"RTN","MAGBRTUT",58,0)
 ;
"RTN","MAGBRTUT",59,0)
 F I=1:1:5 D:$P(FLAG,"^",I)
"RTN","MAGBRTUT",60,0)
 . N D0,T,X
"RTN","MAGBRTUT",61,0)
 . S T=$P("ABSTRACT FULL BIG TEXT DICOM"," ",I)
"RTN","MAGBRTUT",62,0)
 . ;
"RTN","MAGBRTUT",63,0)
 . S D0=$O(^MAGQUEUE(2006.035,"DEST",LOC,"WAITING",IMAGE,T,"")) I D0 D  Q
"RTN","MAGBRTUT",64,0)
 . . N O,P,T,X0,X1
"RTN","MAGBRTUT",65,0)
 . . S X0=$G(^MAGQUEUE(2006.035,D0,0)),O=$P(X0,"^",5),T=$P(X0,"^",6)
"RTN","MAGBRTUT",66,0)
 . . S X1=$G(^MAGQUEUE(2006.035,D0,1)),P=$P(X1,"^",2)
"RTN","MAGBRTUT",67,0)
 . . ; Don't send multiple copies, but do increase priority if needed
"RTN","MAGBRTUT",68,0)
 . . Q:PRI'>P
"RTN","MAGBRTUT",69,0)
 . . S $P(X0,"^",5)=ORIGIN,^MAGQUEUE(2006.035,D0,0)=X0
"RTN","MAGBRTUT",70,0)
 . . I T'=ID,ID'="" D
"RTN","MAGBRTUT",71,0)
 . . . S $P(X0,"^",6)=ID
"RTN","MAGBRTUT",72,0)
 . . . S ^MAGQUEUE(2006.035,D0,0)=X0
"RTN","MAGBRTUT",73,0)
 . . . K:O'="" ^MAGQUEUE(2006.035,"ID",T,D0)
"RTN","MAGBRTUT",74,0)
 . . . S ^MAGQUEUE(2006.035,"ID",ID,D0)=""
"RTN","MAGBRTUT",75,0)
 . . . Q
"RTN","MAGBRTUT",76,0)
 . . S $P(X1,"^",2)=PRI,^MAGQUEUE(2006.035,D0,1)=X1
"RTN","MAGBRTUT",77,0)
 . . K:O ^MAGQUEUE(2006.035,"STS",O,"WAITING",P,LOC,D0)
"RTN","MAGBRTUT",78,0)
 . . S ^MAGQUEUE(2006.035,"STS",ORIGIN,"WAITING",PRI,LOC,D0)=""
"RTN","MAGBRTUT",79,0)
 . . Q
"RTN","MAGBRTUT",80,0)
 . ;
"RTN","MAGBRTUT",81,0)
 . L +^MAGQUEUE(2006.035,0)
"RTN","MAGBRTUT",82,0)
 . S D0=$O(^MAGQUEUE(2006.035," "),-1)+1
"RTN","MAGBRTUT",83,0)
 . S X=$G(^MAGQUEUE(2006.035,0))
"RTN","MAGBRTUT",84,0)
 . S $P(X,"^",1,2)="IMAGE ROUTING QUEUE^2006.035"
"RTN","MAGBRTUT",85,0)
 . S $P(X,"^",3)=D0
"RTN","MAGBRTUT",86,0)
 . S $P(X,"^",4)=$P(X,"^",4)+1
"RTN","MAGBRTUT",87,0)
 . S ^MAGQUEUE(2006.035,0)=X
"RTN","MAGBRTUT",88,0)
 . S X=IMAGE_"^"_LOC_"^"_T_"^"_MECH_"^"_ORIGIN_"^"_ID
"RTN","MAGBRTUT",89,0)
 . S:ID'="" ^MAGQUEUE(2006.035,"ID",ID,D0)=""
"RTN","MAGBRTUT",90,0)
 . S ^MAGQUEUE(2006.035,D0,0)=X
"RTN","MAGBRTUT",91,0)
 . D NOW^%DTC
"RTN","MAGBRTUT",92,0)
 . S ^MAGQUEUE(2006.035,D0,1)="WAITING^"_PRI_"^"_%
"RTN","MAGBRTUT",93,0)
 . S ^MAGQUEUE(2006.035,"STS",ORIGIN,"WAITING",PRI,LOC,D0)=""
"RTN","MAGBRTUT",94,0)
 . S ^MAGQUEUE(2006.035,"DEST",LOC,"WAITING",IMAGE,T,D0)=""
"RTN","MAGBRTUT",95,0)
 . L -^MAGQUEUE(2006.035,0)
"RTN","MAGBRTUT",96,0)
 . S QQ=QQ_D0_"^"
"RTN","MAGBRTUT",97,0)
 . Q
"RTN","MAGBRTUT",98,0)
 Q:$Q QQ Q
"RTN","MAGBRTUT",99,0)
 ;
"RTN","MAGBRTUT",100,0)
DCMLIST(OUT,LOCATION) N D0,LO,LST,N,NM,X
"RTN","MAGBRTUT",101,0)
 S LOCATION=+$G(LOCATION)
"RTN","MAGBRTUT",102,0)
 S D0=0 F  S D0=$O(^MAG(2006.587,D0)) Q:'D0  D
"RTN","MAGBRTUT",103,0)
 . S X=$G(^MAG(2006.587,D0,0))
"RTN","MAGBRTUT",104,0)
 . S NM=$P(X,"^",1),LO=$P(X,"^",7) Q:NM=""
"RTN","MAGBRTUT",105,0)
 . I LOCATION,LO,LO'=LOCATION Q
"RTN","MAGBRTUT",106,0)
 . S LST(NM,LO)=D0
"RTN","MAGBRTUT",107,0)
 . Q
"RTN","MAGBRTUT",108,0)
 S N=1,NM="" F  S NM=$O(LST(NM)) Q:NM=""  D
"RTN","MAGBRTUT",109,0)
 . S LO="",X=0 F  S LO=$O(LST(NM,LO)) Q:LO=""  S X=X+1,D0=LST(NM,LO)
"RTN","MAGBRTUT",110,0)
 . I X=1 S N=N+1,OUT(N)=NM_"^"_D0 Q
"RTN","MAGBRTUT",111,0)
 . S LO="" F  S LO=$O(LST(NM,LO)) Q:LO=""  S N=N+1,OUT(N)=NM_" ("_LO_")^"_LST(NM,LO)
"RTN","MAGBRTUT",112,0)
 . Q
"RTN","MAGBRTUT",113,0)
 S OUT(1)=N-1
"RTN","MAGBRTUT",114,0)
 Q
"RTN","MAGBRTUT",115,0)
 ;
"RTN","MAGDGMRC")
0^2^B32477984
"RTN","MAGDGMRC",1,0)
MAGDGMRC ;WOIFO/PMK - Read a DICOM image file ; 11/10/2005  08:24
"RTN","MAGDGMRC",2,0)
 ;;3.0;IMAGING;**10,51,50**;26-May-2006
"RTN","MAGDGMRC",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDGMRC",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDGMRC",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDGMRC",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDGMRC",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDGMRC",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDGMRC",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDGMRC",10,0)
 ;; |                                                               |
"RTN","MAGDGMRC",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDGMRC",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDGMRC",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDGMRC",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDGMRC",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDGMRC",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDGMRC",17,0)
 ;;
"RTN","MAGDGMRC",18,0)
 ; This is the set of GMRC APIs that are use by the VistA Imaging
"RTN","MAGDGMRC",19,0)
 ; DICOM Gateway
"RTN","MAGDGMRC",20,0)
 ;
"RTN","MAGDGMRC",21,0)
ANYREQ(DFN) ; check if any GMRC requests are present for the patient
"RTN","MAGDGMRC",22,0)
 N ADFN ; ---- array of DFNs to look up
"RTN","MAGDGMRC",23,0)
 N WRK ; ----- work array for our results
"RTN","MAGDGMRC",24,0)
 N IX ; ------ results lookup index
"RTN","MAGDGMRC",25,0)
 N FHIT ; ---- flag - any results for the pt?
"RTN","MAGDGMRC",26,0)
 ;
"RTN","MAGDGMRC",27,0)
 ; ask for requests for the patient
"RTN","MAGDGMRC",28,0)
 S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",29,0)
 S ADFN(1)=DFN
"RTN","MAGDGMRC",30,0)
 D FIND^DIC(123,,"@;.02I","Q",.ADFN,,"F",,,WRK,WRK)
"RTN","MAGDGMRC",31,0)
 ;
"RTN","MAGDGMRC",32,0)
 ; check returns to see if any are actually for this patient (see note
"RTN","MAGDGMRC",33,0)
 ; on SEARCH below)
"RTN","MAGDGMRC",34,0)
 S IX=0
"RTN","MAGDGMRC",35,0)
 F  S IX=$O(@WRK@("DILIST","ID",IX)) Q:'IX  D  Q:$G(FHIT)
"RTN","MAGDGMRC",36,0)
 . I $G(@WRK@("DILIST","ID",IX,.02))=DFN S FHIT=1
"RTN","MAGDGMRC",37,0)
 . Q
"RTN","MAGDGMRC",38,0)
 K @WRK
"RTN","MAGDGMRC",39,0)
 Q +$G(FHIT)
"RTN","MAGDGMRC",40,0)
 ;
"RTN","MAGDGMRC",41,0)
TIULAST(GMRCIEN) ; find the ien of the most recent TIU note for this request
"RTN","MAGDGMRC",42,0)
 N TIUIEN
"RTN","MAGDGMRC",43,0)
 N WRK ; root of work global
"RTN","MAGDGMRC",44,0)
 S TIUIEN=0
"RTN","MAGDGMRC",45,0)
 I GMRCIEN D  ; look for the most recent TIU note for this request
"RTN","MAGDGMRC",46,0)
 . ; set up the array to look through
"RTN","MAGDGMRC",47,0)
 . S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",48,0)
 . D LIST^DIC(123.03,","_GMRCIEN_",",".01I",,,,,,,,WRK,WRK)
"RTN","MAGDGMRC",49,0)
 . ; traverse the array
"RTN","MAGDGMRC",50,0)
 . N TIUPTR
"RTN","MAGDGMRC",51,0)
 . S TIUPTR=" " ; setup for reverse $o from space (" ")
"RTN","MAGDGMRC",52,0)
 . F  S TIUPTR=$O(@WRK@("DILIST","ID",TIUPTR),-1) Q:'TIUPTR  D  Q:TIUIEN
"RTN","MAGDGMRC",53,0)
 . . S TIUIEN=$P($G(@WRK@("DILIST","ID",TIUPTR,.01)),"^",1)
"RTN","MAGDGMRC",54,0)
 . . I $P(TIUIEN,";",2)'="TIU(8925," S TIUIEN=0 ; not a TIU document
"RTN","MAGDGMRC",55,0)
 . . Q
"RTN","MAGDGMRC",56,0)
 . Q
"RTN","MAGDGMRC",57,0)
 K @WRK
"RTN","MAGDGMRC",58,0)
 Q +TIUIEN
"RTN","MAGDGMRC",59,0)
 ;
"RTN","MAGDGMRC",60,0)
TIUALL(GMRCIEN,RESULT) ; find all IENs for the TIU notes for this request
"RTN","MAGDGMRC",61,0)
 N MAGIEN,TIUIEN,TIUPTR,TIUXIEN,Y
"RTN","MAGDGMRC",62,0)
 N WRK ; root of work global
"RTN","MAGDGMRC",63,0)
 K RESULT
"RTN","MAGDGMRC",64,0)
 ; set up the array to look through
"RTN","MAGDGMRC",65,0)
 S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",66,0)
 D LIST^DIC(123.03,","_GMRCIEN_",",".01I",,,,,,,,WRK,WRK)
"RTN","MAGDGMRC",67,0)
 ; traverse the array
"RTN","MAGDGMRC",68,0)
 S (RESULT,TIUPTR)=0
"RTN","MAGDGMRC",69,0)
 F  S TIUPTR=$O(@WRK@("DILIST","ID",TIUPTR)) Q:'TIUPTR  D
"RTN","MAGDGMRC",70,0)
 . S TIUIEN=$P($G(@WRK@("DILIST","ID",TIUPTR,.01)),"^",1)
"RTN","MAGDGMRC",71,0)
 . I $P(TIUIEN,";",2)'="TIU(8925," Q  ; not a TIU document
"RTN","MAGDGMRC",72,0)
 . S TIUIEN=+TIUIEN ; strip off variable pointer stuff
"RTN","MAGDGMRC",73,0)
 . S TIUXIEN=""
"RTN","MAGDGMRC",74,0)
 . F  S TIUXIEN=$O(^TIU(8925.91,"B",TIUIEN,TIUXIEN)) Q:'TIUXIEN  D
"RTN","MAGDGMRC",75,0)
 . . S Y=$G(^TIU(8925.91,TIUXIEN,0)) Q:'Y
"RTN","MAGDGMRC",76,0)
 . . S MAGIEN=$P(Y,"^",2)
"RTN","MAGDGMRC",77,0)
 . . S RESULT=RESULT+1
"RTN","MAGDGMRC",78,0)
 . . S RESULT(RESULT)=TIUIEN_"^GMRC-"_GMRCIEN_"^"_MAGIEN
"RTN","MAGDGMRC",79,0)
 . . Q
"RTN","MAGDGMRC",80,0)
 . Q
"RTN","MAGDGMRC",81,0)
 K @WRK
"RTN","MAGDGMRC",82,0)
 Q
"RTN","MAGDGMRC",83,0)
 ;
"RTN","MAGDGMRC",84,0)
FWDFROM(GMRCIEN) ; for a forwarded request, determine the FORWARD FROM service
"RTN","MAGDGMRC",85,0)
 N FWDFROM,I
"RTN","MAGDGMRC",86,0)
 N WRK ; root of work global
"RTN","MAGDGMRC",87,0)
 ; set up the array to look through
"RTN","MAGDGMRC",88,0)
 S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",89,0)
 D LIST^DIC(123.02,","_GMRCIEN_",",".01I;6I",,,,,,,,WRK,WRK)
"RTN","MAGDGMRC",90,0)
 ; traverse the array
"RTN","MAGDGMRC",91,0)
 S FWDFROM=0
"RTN","MAGDGMRC",92,0)
 I GMRCIEN D
"RTN","MAGDGMRC",93,0)
 . S I=$O(@WRK@("DILIST","ID"," "),-1)
"RTN","MAGDGMRC",94,0)
 . I I D  ; get the FORWARDED FROM service
"RTN","MAGDGMRC",95,0)
 . . S FWDFROM=$G(@WRK@("DILIST","ID",I,6))
"RTN","MAGDGMRC",96,0)
 . . Q
"RTN","MAGDGMRC",97,0)
 . Q
"RTN","MAGDGMRC",98,0)
 K @WRK
"RTN","MAGDGMRC",99,0)
 Q +FWDFROM
"RTN","MAGDGMRC",100,0)
 ;
"RTN","MAGDGMRC",101,0)
UNSIGNED(GMRCIEN) ; check if there are any unsigned TIU notes for the request
"RTN","MAGDGMRC",102,0)
 N TIUPTR,NRESULTS,TIUSTAT,UNSIGNED,X
"RTN","MAGDGMRC",103,0)
 N WRK ; root of work global
"RTN","MAGDGMRC",104,0)
 ; set up the array to look through
"RTN","MAGDGMRC",105,0)
 S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",106,0)
 D LIST^DIC(123.03,","_GMRCIEN_",",".01I",,,,,,,,WRK,WRK)
"RTN","MAGDGMRC",107,0)
 S UNSIGNED=0,TIUPTR=""
"RTN","MAGDGMRC",108,0)
 ; traverse the array, check all associated results, bail if any unsigned
"RTN","MAGDGMRC",109,0)
 F  S TIUPTR=$O(@WRK@("DILIST","ID",TIUPTR)) Q:'TIUPTR  D  Q:UNSIGNED
"RTN","MAGDGMRC",110,0)
 . S X=$P($G(@WRK@("DILIST","ID",TIUPTR,.01)),"^",1)
"RTN","MAGDGMRC",111,0)
 . ; if TIU note, check if unsigned
"RTN","MAGDGMRC",112,0)
 . I X?.N1";TIU(8925," D  ; check status of TIU note for completion
"RTN","MAGDGMRC",113,0)
 . . ; status in ^TIU(8925.6) - use first 5 "UNs" per Margy McClenanhan
"RTN","MAGDGMRC",114,0)
 . . S TIUSTAT=$$GET1^DIQ(8925,+X,.05,"I")
"RTN","MAGDGMRC",115,0)
 . . I TIUSTAT,TIUSTAT<6 S UNSIGNED=1 ; got one!
"RTN","MAGDGMRC",116,0)
 . . Q
"RTN","MAGDGMRC",117,0)
 . Q
"RTN","MAGDGMRC",118,0)
 K @WRK
"RTN","MAGDGMRC",119,0)
 Q UNSIGNED
"RTN","MAGDGMRC",120,0)
 ;
"RTN","MAGDGMRC",121,0)
SEARCH(DFN,CUTOFF,CLINIC,REQUEST) ; search for requests for a given clinic
"RTN","MAGDGMRC",122,0)
 ;
"RTN","MAGDGMRC",123,0)
 ; It is a bit of a trick to determine if a given appointment is for
"RTN","MAGDGMRC",124,0)
 ; an existing GMRC request.  This determination is performed by using
"RTN","MAGDGMRC",125,0)
 ; an association between the SERVICE for the request and the CLINIC
"RTN","MAGDGMRC",126,0)
 ; where the request is to be performed.
"RTN","MAGDGMRC",127,0)
 ;
"RTN","MAGDGMRC",128,0)
 ; This subroutine passes all of the (recent) requests for a patient and
"RTN","MAGDGMRC",129,0)
 ; builds a list of those that can be performed in the designated clinic.
"RTN","MAGDGMRC",130,0)
 ;
"RTN","MAGDGMRC",131,0)
 ; Maybe the replacement for Appointment Management and future versions
"RTN","MAGDGMRC",132,0)
 ; of CPRS Order Entry and Consult Request Tracking will capable of
"RTN","MAGDGMRC",133,0)
 ; correctly maintaining this essential association.
"RTN","MAGDGMRC",134,0)
 ;
"RTN","MAGDGMRC",135,0)
 N GMRIDX,GMRC0,GMRCDATE,GMRCIEN,SERVICE,STATUS
"RTN","MAGDGMRC",136,0)
 N WRK ; --- root of results global
"RTN","MAGDGMRC",137,0)
 N ADFN ; -- array for DFNs to look up
"RTN","MAGDGMRC",138,0)
 K REQUEST S REQUEST=0
"RTN","MAGDGMRC",139,0)
 I 'DFN Q  ; no patient number provided
"RTN","MAGDGMRC",140,0)
 ; build the array of results
"RTN","MAGDGMRC",141,0)
 ; Note the use of the "Q[uick]" flag to allow lookup by *internal* DFN.
"RTN","MAGDGMRC",142,0)
 ; However, even though we define ADFN(1) to force lookup on the *first*
"RTN","MAGDGMRC",143,0)
 ; level subscript of the F index only, FileMan also looks up on the IEN
"RTN","MAGDGMRC",144,0)
 ; directly (because there is a .001 field defined in the DD of File
"RTN","MAGDGMRC",145,0)
 ; #123).  So we grab the DFN in the .02 field for later double-
"RTN","MAGDGMRC",146,0)
 ; checking.
"RTN","MAGDGMRC",147,0)
 ;
"RTN","MAGDGMRC",148,0)
 S ADFN(1)=DFN
"RTN","MAGDGMRC",149,0)
 S WRK=$NA(^TMP("MAG",$J,$T(+0))) K @WRK
"RTN","MAGDGMRC",150,0)
 D FIND^DIC(123,,"@;.02I;1I;3I;5I;8I","Q",.ADFN,,"F",,,WRK,WRK)
"RTN","MAGDGMRC",151,0)
 ; traverse the results
"RTN","MAGDGMRC",152,0)
 S GMRIDX=""
"RTN","MAGDGMRC",153,0)
 F  S GMRIDX=$O(@WRK@("DILIST","ID",GMRIDX)) Q:'GMRIDX  D
"RTN","MAGDGMRC",154,0)
 . S GMRCIEN=+$G(@WRK@("DILIST",2,GMRIDX))
"RTN","MAGDGMRC",155,0)
 . I $G(@WRK@("DILIST","ID",GMRIDX,.02))'=DFN Q  ; not for this patient!
"RTN","MAGDGMRC",156,0)
 . I $G(@WRK@("DILIST","ID",GMRIDX,3))<CUTOFF Q  ; too far back
"RTN","MAGDGMRC",157,0)
 . S SERVICE=$G(@WRK@("DILIST","ID",GMRIDX,1)) Q:SERVICE=""
"RTN","MAGDGMRC",158,0)
 . I '$$ISCLINIC^MAGDGMRC(SERVICE,CLINIC) Q  ; not a service or clinic
"RTN","MAGDGMRC",159,0)
 . S STATUS=$G(@WRK@("DILIST","ID",GMRIDX,8)) ; CPRS status
"RTN","MAGDGMRC",160,0)
 . I STATUS S STATUS=$$GET1^DIQ(100.01,STATUS,.1) ; CPRS status abbrev
"RTN","MAGDGMRC",161,0)
 . S REQUEST=$G(REQUEST)+1
"RTN","MAGDGMRC",162,0)
 . S REQUEST(REQUEST)=GMRCIEN_"^"_SERVICE_"^"_STATUS
"RTN","MAGDGMRC",163,0)
 . Q
"RTN","MAGDGMRC",164,0)
 K @WRK
"RTN","MAGDGMRC",165,0)
 Q
"RTN","MAGDGMRC",166,0)
 ;
"RTN","MAGDGMRC",167,0)
ISCLINIC(SERVICE,CLINIC) ; is a particular clinic defined for a given service?
"RTN","MAGDGMRC",168,0)
 ; this entry point is called by ^MAGDGMRC as well as below
"RTN","MAGDGMRC",169,0)
 N ISCLINIC
"RTN","MAGDGMRC",170,0)
 S ISCLINIC=0
"RTN","MAGDGMRC",171,0)
 I SERVICE,CLINIC,$D(^MAG(2006.5831,SERVICE,1,"B",CLINIC)) S ISCLINIC=1
"RTN","MAGDGMRC",172,0)
 Q ISCLINIC
"RTN","MAGDHWA")
0^3^B58838393
"RTN","MAGDHWA",1,0)
MAGDHWA ;WOIFO/PMK - Capture Consult/Request data ; 12 Jul 2005  2:32 PM
"RTN","MAGDHWA",2,0)
 ;;3.0;IMAGING;**10,51,50**;26-May-2006
"RTN","MAGDHWA",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDHWA",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDHWA",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDHWA",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDHWA",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDHWA",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDHWA",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDHWA",10,0)
 ;; |                                                               |
"RTN","MAGDHWA",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDHWA",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDHWA",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDHWA",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDHWA",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDHWA",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDHWA",17,0)
 ;;
"RTN","MAGDHWA",18,0)
 Q
"RTN","MAGDHWA",19,0)
 ; entry points called by both ^MAGDHWC and ^MAGDHWS
"RTN","MAGDHWA",20,0)
 ;
"RTN","MAGDHWA",21,0)
MSH ; update MSH segment
"RTN","MAGDHWA",22,0)
 S $P(HL7(1),DEL,5)="VI-CONSULT" ; receiving application
"RTN","MAGDHWA",23,0)
 S $P(HL7(1),DEL,6)=$P(HL7(1),DEL,4) ; receiving facility
"RTN","MAGDHWA",24,0)
 S $P(HL7(1),DEL,7)=$$FMTHL7^XLFDT(FMDATETM)
"RTN","MAGDHWA",25,0)
 Q
"RTN","MAGDHWA",26,0)
 ;
"RTN","MAGDHWA",27,0)
PID ; update PID & PV1 segments
"RTN","MAGDHWA",28,0)
 N ADDRESS,FIRSTNAM,GEOLOC,I,J,LASTNAME,MIDNAME,PNAME
"RTN","MAGDHWA",29,0)
 N VA,VADM,VAIN,VAPA,VAERR,X,WARD,Z
"RTN","MAGDHWA",30,0)
 ; update PID segment
"RTN","MAGDHWA",31,0)
 S I=0 I $$FINDSEG^MAGDHW0(.HL7,"PID",.I,.X) D
"RTN","MAGDHWA",32,0)
 . S DFN=$P(X,DEL,3) D  ; protect I and X
"RTN","MAGDHWA",33,0)
 . . N %,DIQUIET,I,IO,X
"RTN","MAGDHWA",34,0)
 . . S DIQUIET=1 D DEM^VADPT,ADD^VADPT,INP^VADPT
"RTN","MAGDHWA",35,0)
 . . Q
"RTN","MAGDHWA",36,0)
 . S ADDRESS=VAPA(1) ; construct the patient's address string
"RTN","MAGDHWA",37,0)
 . F J=2:1:3 I VAPA(J)'="" S ADDRESS=ADDRESS_"^"_VAPA(J)
"RTN","MAGDHWA",38,0)
 . S GEOLOC=VAPA(4)_"^"_$P(VAPA(5),"^")_"^"_VAPA(6) ; city, state & zip
"RTN","MAGDHWA",39,0)
 . ; stuff the data into the segment
"RTN","MAGDHWA",40,0)
 . S $P(X,DEL,2)=VA("PID") ; patient id - ssn
"RTN","MAGDHWA",41,0)
 . S $P(X,DEL,4)=$E(VADM(1))_VA("BID") ; alt. patient id - quick pid
"RTN","MAGDHWA",42,0)
 . ; format patient name: last~first~middle
"RTN","MAGDHWA",43,0)
 . S LASTNAME=$P(VADM(1),","),Z=$P(VADM(1),",",2,999)
"RTN","MAGDHWA",44,0)
 . S FIRSTNAM=$P(Z," ",1),MIDNAME=$TR($P(Z," ",2,999),".")
"RTN","MAGDHWA",45,0)
 . S $P(X,DEL,5)=LASTNAME_DEL2_FIRSTNAM_DEL2_MIDNAME ; patient name
"RTN","MAGDHWA",46,0)
 . S $P(X,DEL,7)=17000000+VADM(3) ; dob
"RTN","MAGDHWA",47,0)
 . S $P(X,DEL,8)=$P(VADM(5),"^") ; sex
"RTN","MAGDHWA",48,0)
 . S $P(X,DEL,10)=DEL2_$P($G(VADM(12,1)),"^",2) ; race
"RTN","MAGDHWA",49,0)
 . S $P(X,DEL,11)=$$HLADDR^HLFNC(ADDRESS,GEOLOC,DEL2)
"RTN","MAGDHWA",50,0)
 . S $P(X,DEL,13)=VAPA(8)_DEL2_"PRN" ; primary phone number
"RTN","MAGDHWA",51,0)
 . S $P(X,DEL,19)=$P(VADM(2),"^") ; ssn (without dashes)
"RTN","MAGDHWA",52,0)
 . D SAVESEG^MAGDHW0(I,X)
"RTN","MAGDHWA",53,0)
 . Q
"RTN","MAGDHWA",54,0)
 ;
"RTN","MAGDHWA",55,0)
 ; update PV1 segment for inpatients only
"RTN","MAGDHWA",56,0)
 S I=0 I $$FINDSEG^MAGDHW0(.HL7,"PV1",.I,.X) D
"RTN","MAGDHWA",57,0)
 . ; get assigned patient location
"RTN","MAGDHWA",58,0)
 . I VAIN(1) D  ; inpatient code
"RTN","MAGDHWA",59,0)
 . . S $P(X,DEL,2)="I" ; inpatient flag
"RTN","MAGDHWA",60,0)
 . . ; assigned patient location
"RTN","MAGDHWA",61,0)
 . . S Z=$TR(VAIN(4),"^",DEL5)_DEL5_"VISTA42"
"RTN","MAGDHWA",62,0)
 . . S $P(X,DEL,3)=Z_DEL2_$TR(VAIN(5),"-",DEL2)
"RTN","MAGDHWA",63,0)
 . . ; attending physician
"RTN","MAGDHWA",64,0)
 . . S $P(X,DEL,7)=$TR(VAIN(2),"^, ",DEL2_DEL2_DEL2)
"RTN","MAGDHWA",65,0)
 . . ; referring (primary care) physician
"RTN","MAGDHWA",66,0)
 . . S $P(X,DEL,8)=$TR(VAIN(11),"^, ",DEL2_DEL2_DEL2)
"RTN","MAGDHWA",67,0)
 . . ; hospital service
"RTN","MAGDHWA",68,0)
 . . S $P(X,DEL,10)=$TR(VAIN(3),"^",DEL2)
"RTN","MAGDHWA",69,0)
 . . ; visit number
"RTN","MAGDHWA",70,0)
 . . S $P(X,DEL,19)=VAIN(1)
"RTN","MAGDHWA",71,0)
 . . Q
"RTN","MAGDHWA",72,0)
 . E  S $P(X,DEL,2)="O" ; outpatient flag
"RTN","MAGDHWA",73,0)
 . D SAVESEG^MAGDHW0(I,X)
"RTN","MAGDHWA",74,0)
 . Q
"RTN","MAGDHWA",75,0)
 Q
"RTN","MAGDHWA",76,0)
 ;
"RTN","MAGDHWA",77,0)
ORC ; update ORC segment
"RTN","MAGDHWA",78,0)
 N D0,I,J,NAME,X
"RTN","MAGDHWA",79,0)
 S CONSULT=DEL2 ; consult always contains DEL2
"RTN","MAGDHWA",80,0)
 S I=0 I $$FINDSEG^MAGDHW0(.HL7,"ORC",.I,.X) D
"RTN","MAGDHWA",81,0)
 . ; get consult ien for OBR segment
"RTN","MAGDHWA",82,0)
 . S CONSULT=$P(X,DEL,3)
"RTN","MAGDHWA",83,0)
 . ; add names of order enterer and ordering provider
"RTN","MAGDHWA",84,0)
 . F J=10,12 D
"RTN","MAGDHWA",85,0)
 . . S D0=$P(X,DEL,J),NAME=$S(D0:$$GET1^DIQ(200,D0,.01),1:"")
"RTN","MAGDHWA",86,0)
 . . S NAME=$TR(NAME,", ",DEL2_DEL2)
"RTN","MAGDHWA",87,0)
 . . S $P(X,DEL,J)=D0_DEL2_NAME
"RTN","MAGDHWA",88,0)
 . . Q
"RTN","MAGDHWA",89,0)
 . D SAVESEG^MAGDHW0(I,X)
"RTN","MAGDHWA",90,0)
 . Q
"RTN","MAGDHWA",91,0)
 Q
"RTN","MAGDHWA",92,0)
 ;
"RTN","MAGDHWA",93,0)
OBR ; update OBR segment
"RTN","MAGDHWA",94,0)
 N I,X,Z
"RTN","MAGDHWA",95,0)
 S I=0 I $$FINDSEG^MAGDHW0(.HL7,"OBR",.I,.X) D
"RTN","MAGDHWA",96,0)
 . S $P(X,DEL,3)=CONSULT_DEL2_"L",GMRCIEN=+CONSULT
"RTN","MAGDHWA",97,0)
 . S Z=$$GET1^DIQ(123,GMRCIEN,5,"I") ; urgency
"RTN","MAGDHWA",98,0)
 . I Z S $P(X,DEL,5)=$$GET1^DIQ(101,Z,1) ; priority
"RTN","MAGDHWA",99,0)
 . ;
"RTN","MAGDHWA",100,0)
 . S Z=$$GET1^DIQ(123,GMRCIEN,6,"I") ; place of consult
"RTN","MAGDHWA",101,0)
 . I Z S $P(X,DEL,18)=$$GET1^DIQ(101,Z,1) ; placer field #1
"RTN","MAGDHWA",102,0)
 . ;
"RTN","MAGDHWA",103,0)
 . S Z=$$GET1^DIQ(123,GMRCIEN,13,"I") ; request type
"RTN","MAGDHWA",104,0)
 . S Z=$S(Z="C":"CONSULT",Z="P":"PROCEDURE",1:"UNKNOWN")
"RTN","MAGDHWA",105,0)
 . S $P(X,DEL,19)=Z ; consult/procedure flag - placer field #2
"RTN","MAGDHWA",106,0)
 . ;
"RTN","MAGDHWA",107,0)
 . ; store the current CPRS GMRC or Appointment Scheduling status
"RTN","MAGDHWA",108,0)
 . ; FILLER1 is also set in ^MAGDHRS
"RTN","MAGDHWA",109,0)
 . I '$D(FILLER1) S FILLER1="GMRC-"_$$GET1^DIQ(123,GMRCIEN,8)
"RTN","MAGDHWA",110,0)
 . ; make linkage between the image group and the TIU note, if necessary
"RTN","MAGDHWA",111,0)
 . I MSGTYPE["RESULT",$$NEWTIU(GMRCIEN) S $P(FILLER1,DEL2,2)="LINKED"
"RTN","MAGDHWA",112,0)
 . S $P(X,DEL,20)=FILLER1
"RTN","MAGDHWA",113,0)
 . ;
"RTN","MAGDHWA",114,0)
 . ; store the clinic for the appointment in "filler field 2"
"RTN","MAGDHWA",115,0)
 . I $D(APTSCHED("CLINIC IEN")),$D(APTSCHED("CLINIC NAME")) D
"RTN","MAGDHWA",116,0)
 . . S $P(X,DEL,21)=APTSCHED("CLINIC IEN")_DEL2_APTSCHED("CLINIC NAME")
"RTN","MAGDHWA",117,0)
 . . Q
"RTN","MAGDHWA",118,0)
 . ;
"RTN","MAGDHWA",119,0)
 . ; CPRS Attention - HL7 "Result Copies To" field
"RTN","MAGDHWA",120,0)
 . S Z=$$GET1^DIQ(123,GMRCIEN,7,"I") ; pointer to ^VA(200)
"RTN","MAGDHWA",121,0)
 . I Z S $P(X,DEL,28)=Z_DEL2_$TR($$GET1^DIQ(200,Z,.01),", ",DEL2_DEL2)
"RTN","MAGDHWA",122,0)
 . ;
"RTN","MAGDHWA",123,0)
 . ; date and time of scheduled appointment
"RTN","MAGDHWA",124,0)
 . I $D(APTSCHED("FM DATETIME")) D
"RTN","MAGDHWA",125,0)
 . . S $P(X,DEL,36)=$$FMTHL7^XLFDT(APTSCHED("FM DATETIME"))
"RTN","MAGDHWA",126,0)
 . . Q
"RTN","MAGDHWA",127,0)
 . ;
"RTN","MAGDHWA",128,0)
 . ; from service (requesting service)
"RTN","MAGDHWA",129,0)
 . S Z=$$GET1^DIQ(123,GMRCIEN,2,"I") ; pointer to ^SC(Z)
"RTN","MAGDHWA",130,0)
 . I Z S $P(X,DEL,47)=Z_DEL2_$$GET1^DIQ(44,Z,.01)
"RTN","MAGDHWA",131,0)
 . D SAVESEG^MAGDHW0(I,X)
"RTN","MAGDHWA",132,0)
 . Q
"RTN","MAGDHWA",133,0)
 Q
"RTN","MAGDHWA",134,0)
 ;
"RTN","MAGDHWA",135,0)
ZSV ; find ZSV segment and add imaging type code
"RTN","MAGDHWA",136,0)
 N I,Z
"RTN","MAGDHWA",137,0)
 S I=0 I $$FINDSEG^MAGDHW0(.HL7,"ZSV",.I,.X) D
"RTN","MAGDHWA",138,0)
 . S $P(X,DEL,3)=ITYPCODE_DEL2_ITYPNAME_DEL2_DIVISION
"RTN","MAGDHWA",139,0)
 . S $P(X,DEL,4)=$G(ORIGSERV) ; original service for a FORWARD request
"RTN","MAGDHWA",140,0)
 . D SAVESEG^MAGDHW0(I,X)
"RTN","MAGDHWA",141,0)
 . Q
"RTN","MAGDHWA",142,0)
 Q
"RTN","MAGDHWA",143,0)
 ;
"RTN","MAGDHWA",144,0)
ALLERGY ; check to see if patient has any allergies
"RTN","MAGDHWA",145,0)
 N GMRA,GMRAL,I,X
"RTN","MAGDHWA",146,0)
 D EN1^GMRADPT
"RTN","MAGDHWA",147,0)
 S I=0 F  S I=$O(GMRAL(I)) Q:'I  D  ; include each allergy string as an HL7 OBX segment
"RTN","MAGDHWA",148,0)
 . S OBXSEGNO=OBXSEGNO+1
"RTN","MAGDHWA",149,0)
 . S X="OBX|"_OBXSEGNO_"|TX|A^ALLERGIES^L||",X=$TR(X,"|^",DEL_DEL2)
"RTN","MAGDHWA",150,0)
 . S X=X_$P(GMRAL(I),"^",2)
"RTN","MAGDHWA",151,0)
 . S X=X_DEL_DEL_DEL_DEL_DEL_DEL ; final six delimiters
"RTN","MAGDHWA",152,0)
 . D ADDSEG^MAGDHW0(X)
"RTN","MAGDHWA",153,0)
 . Q
"RTN","MAGDHWA",154,0)
 Q
"RTN","MAGDHWA",155,0)
 ;
"RTN","MAGDHWA",156,0)
POSTINGS ; check if the patient has any other postings
"RTN","MAGDHWA",157,0)
 N I,HIT,MSG
"RTN","MAGDHWA",158,0)
 D ENCOVER^TIUPP3(DFN) I MSG Q  ; MSG="0^Patient posting found"
"RTN","MAGDHWA",159,0)
 S (I,HIT)=0
"RTN","MAGDHWA",160,0)
 F  S I=$O(^TMP("TIUPPCV",$J,I)) Q:'I  I $P(^(I),"^",2)'="A" S HIT=1 Q
"RTN","MAGDHWA",161,0)
 I HIT D
"RTN","MAGDHWA",162,0)
 . S X="OBX|"_OBXSEGNO_"|TX|P^POSTINGS^L||"
"RTN","MAGDHWA",163,0)
 . S X=$TR(X,"|^",DEL_DEL2)
"RTN","MAGDHWA",164,0)
 . S X=X_"Please see CPRS for additional information about Postings."
"RTN","MAGDHWA",165,0)
 . S X=X_DEL_DEL_DEL_DEL_DEL_DEL ; final six delimiters
"RTN","MAGDHWA",166,0)
 . D ADDSEG^MAGDHW0(X)
"RTN","MAGDHWA",167,0)
 . Q
"RTN","MAGDHWA",168,0)
 Q
"RTN","MAGDHWA",169,0)
 ;
"RTN","MAGDHWA",170,0)
NEWTIU(GMRCIEN) ; check if this is a TIU note to be linked to an image group
"RTN","MAGDHWA",171,0)
 ; if so, create the cross-linkages now
"RTN","MAGDHWA",172,0)
 N CROSSREF,D0,FILEDATA,HIT,MAGGP,MAGIEN,NIMAGE,TIUIEN
"RTN","MAGDHWA",173,0)
 S HIT=0
"RTN","MAGDHWA",174,0)
 S D0=""
"RTN","MAGDHWA",175,0)
 F  S D0=$O(^MAG(2006.5839,"C",123,GMRCIEN,D0)) Q:'D0  D
"RTN","MAGDHWA",176,0)
 . S MAGGP=$P($G(^MAG(2006.5839,D0,0)),"^",3) Q:'MAGGP
"RTN","MAGDHWA",177,0)
 . S TIUIEN=$$TIULAST^MAGDGMRC(GMRCIEN) Q:'TIUIEN
"RTN","MAGDHWA",178,0)
 . S $P(^MAG(2005,MAGGP,2),"^",6,7)="8925^"_TIUIEN
"RTN","MAGDHWA",179,0)
 . D TIUXLINK ; create the cross-linkages to TIU
"RTN","MAGDHWA",180,0)
 . ; update the parent file pointers for all the images
"RTN","MAGDHWA",181,0)
 . S CROSSREF="8925^"_TIUIEN_"^"_FILEDATA("PARENT FILE PTR")
"RTN","MAGDHWA",182,0)
 . S NIMAGE=0 F  S NIMAGE=$O(^MAG(2005,MAGGP,1,NIMAGE)) Q:'NIMAGE  D
"RTN","MAGDHWA",183,0)
 . . S MAGIEN=$P(^MAG(2005,MAGGP,1,NIMAGE,0),"^")
"RTN","MAGDHWA",184,0)
 . . S $P(^MAG(2005,MAGIEN,2),"^",6,8)=CROSSREF
"RTN","MAGDHWA",185,0)
 . . Q
"RTN","MAGDHWA",186,0)
 . ; remove entries from ^MAG(2006.5839) & decrement the counter
"RTN","MAGDHWA",187,0)
 . K ^MAG(2006.5839,D0),^MAG(2006.5839,"C",123,GMRCIEN,D0)
"RTN","MAGDHWA",188,0)
 . L +^MAG(2006.5839)
"RTN","MAGDHWA",189,0)
 . S $P(^MAG(2006.5839,0),"^",4)=$P(^MAG(2006.5839,0),"^",4)-1
"RTN","MAGDHWA",190,0)
 . L -^MAG(2006.5839)
"RTN","MAGDHWA",191,0)
 . S HIT=1
"RTN","MAGDHWA",192,0)
 . Q
"RTN","MAGDHWA",193,0)
 Q HIT
"RTN","MAGDHWA",194,0)
 ;
"RTN","MAGDHWA",195,0)
TIUXLINK ; create the cross-linkages to TIU EXTERNAL DATA LINK file
"RTN","MAGDHWA",196,0)
 N TIUXDIEN
"RTN","MAGDHWA",197,0)
 D PUTIMAGE^TIUSRVPL(.TIUXDIEN,TIUIEN,MAGGP)
"RTN","MAGDHWA",198,0)
 I TIUXDIEN D
"RTN","MAGDHWA",199,0)
 . S FILEDATA("PARENT FILE PTR")=TIUXDIEN
"RTN","MAGDHWA",200,0)
 . S $P(^MAG(2005,MAGGP,2),"^",8)=TIUXDIEN
"RTN","MAGDHWA",201,0)
 . Q
"RTN","MAGDHWA",202,0)
 E  D  ; fatal error
"RTN","MAGDHWA",203,0)
 . N MSG
"RTN","MAGDHWA",204,0)
 . S MSG(1)="ERROR ASSOCIATING WITH TIU EXTERNAL DATA LINK (file 8925.91):"
"RTN","MAGDHWA",205,0)
 . S MSG(2)=$P(TIUXDIEN,"^",2,999)
"RTN","MAGDHWA",206,0)
 . S X="ERR^MAGGTERR",@^%ZOSF("TRAP")
"RTN","MAGDHWA",207,0)
 . Q
"RTN","MAGDHWA",208,0)
 Q
"RTN","MAGDIR81")
0^4^B74717291
"RTN","MAGDIR81",1,0)
MAGDIR81 ;WOIFO/PMK - Read a DICOM image file ; 13 Sep 2005  7:46 AM
"RTN","MAGDIR81",2,0)
 ;;3.0;IMAGING;**11,30,51,50**;26-May-2006
"RTN","MAGDIR81",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDIR81",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDIR81",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDIR81",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDIR81",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDIR81",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDIR81",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDIR81",10,0)
 ;; |                                                               |
"RTN","MAGDIR81",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDIR81",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDIR81",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDIR81",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDIR81",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDIR81",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDIR81",17,0)
 ;;
"RTN","MAGDIR81",18,0)
 ;
"RTN","MAGDIR81",19,0)
 ; M2MB server
"RTN","MAGDIR81",20,0)
 ;
"RTN","MAGDIR81",21,0)
 ; This routine is invoked by the ^MAGDIR8 for the "STORE1/STORE2"
"RTN","MAGDIR81",22,0)
 ; REQUEST items when there is an image to be stored into the database.
"RTN","MAGDIR81",23,0)
 ; It adds it to the ^MAG global with appropriate pointers to the
"RTN","MAGDIR81",24,0)
 ; "parent data files".
"RTN","MAGDIR81",25,0)
 ;
"RTN","MAGDIR81",26,0)
ENTRY ; process one image
"RTN","MAGDIR81",27,0)
 N MEDATA ;--- medicine pkg patient & study data (set in ^MAGDIR8A)
"RTN","MAGDIR81",28,0)
 N FILEDATA ;- array of data to be passed between routines
"RTN","MAGDIR81",29,0)
 N FIRSTDCM ;- patient first name from the image header (ie, PNAMEDCM)
"RTN","MAGDIR81",30,0)
 N GMRCIEN ;-- internal entry number of consult/procedure request
"RTN","MAGDIR81",31,0)
 N LASTDCM ;-- patient last name from the image header (ie, PNAMEDCM)
"RTN","MAGDIR81",32,0)
 N MAGGP ;---- image's group pointer in ^MAG(2005)
"RTN","MAGDIR81",33,0)
 N MAGIEN ;--- pointer to the entry for the image in ^MAG(2005)
"RTN","MAGDIR81",34,0)
 N MIDCM ;---- patient middle initial from the image header (PNAMEDCM)
"RTN","MAGDIR81",35,0)
 N PNAMEVAH ;- patient name from VADM(1)
"RTN","MAGDIR81",36,0)
 N PROCDESC ;- procedure description (VA's name)
"RTN","MAGDIR81",37,0)
 N RADATA ;--- radiology pkg patient & study data (set in ^MAGDIR8A)
"RTN","MAGDIR81",38,0)
 N VADM ;----- array of demographic variables filled in by DEM^VADPT
"RTN","MAGDIR81",39,0)
 N MAG0,MAG1,MAG2,QUIT,X
"RTN","MAGDIR81",40,0)
 ;
"RTN","MAGDIR81",41,0)
 N ACNUMB,CASENUMB,EMAIL,FROMPATH,IMAGEUID,IMAGNAME,IMAGNUMB,IMGSVC
"RTN","MAGDIR81",42,0)
 N INSTLOC,INSTNAME,LASTIMG,LOCATION,MACHID,MODALITY,MODPARMS
"RTN","MAGDIR81",43,0)
 N MULTFRAM,PID,PNAMEDCM,ROUTRULE,SERINUMB,SERIEUID,SOPCLASS,STATUS
"RTN","MAGDIR81",44,0)
 N STUDYDAT,STUDYTIM,STUDYDAT,STUDYTIM,STUDYUID,SYSTITLE
"RTN","MAGDIR81",45,0)
 ;
"RTN","MAGDIR81",46,0)
 S STATUS=$P(ARGS,"|",1),LOCATION=$P(ARGS,"|",2)
"RTN","MAGDIR81",47,0)
 S MACHID=$P(ARGS,"|",3),IMGSVC=$P(ARGS,"|",4)
"RTN","MAGDIR81",48,0)
 S INSTNAME=$P(ARGS,"|",5),FROMPATH=$P(ARGS,"|",6)
"RTN","MAGDIR81",49,0)
 S PID=$P(ARGS,"|",7),PNAMEDCM=$P(ARGS,"|",8)
"RTN","MAGDIR81",50,0)
 S CASENUMB=$P(ARGS,"|",9),ACNUMB=$P(ARGS,"|",10)
"RTN","MAGDIR81",51,0)
 S STUDYDAT=$P(ARGS,"|",11),STUDYTIM=$P(ARGS,"|",12)
"RTN","MAGDIR81",52,0)
 S MODALITY=$P(ARGS,"|",14)
"RTN","MAGDIR81",53,0)
 S IMAGNAME=$P(ARGS,"|",15),MODPARMS=$P(ARGS,"|",16)
"RTN","MAGDIR81",54,0)
 S SERINUMB=$P(ARGS,"|",17),IMAGNUMB=$P(ARGS,"|",18)
"RTN","MAGDIR81",55,0)
 S INSTLOC=$P(ARGS,"|",19),MULTFRAM=$P(ARGS,"|",20)
"RTN","MAGDIR81",56,0)
 S SYSTITLE=$P(ARGS,"|",21),EMAIL=$P(ARGS,"|",22)
"RTN","MAGDIR81",57,0)
 S IREQUEST=IREQUEST+1,OPCODE=$P(REQUEST(IREQUEST),"|")
"RTN","MAGDIR81",58,0)
 I OPCODE'="STORE2" D  Q
"RTN","MAGDIR81",59,0)
 . D RESULT^MAGDIR8("STORE","-101 Expecting STORE2, got """_OPCODE_"""")
"RTN","MAGDIR81",60,0)
 . Q
"RTN","MAGDIR81",61,0)
 S ARGS=$P(REQUEST(IREQUEST),"|",2,999)
"RTN","MAGDIR81",62,0)
 S STUDYUID=$P(ARGS,"|",1),SERIEUID=$P(ARGS,"|",2)
"RTN","MAGDIR81",63,0)
 S IMAGEUID=$P(ARGS,"|",3),SOPCLASS=$P(ARGS,"|",4)
"RTN","MAGDIR81",64,0)
 S LASTIMG=$P(ARGS,"|",5),ROUTRULE=$P(ARGS,"|",6)
"RTN","MAGDIR81",65,0)
 S MFGR=$P(ARGS,"|",7),MODEL=$P(ARGS,"|",8)
"RTN","MAGDIR81",66,0)
 ;
"RTN","MAGDIR81",67,0)
 ; get a pointer to the image, if it is already on file
"RTN","MAGDIR81",68,0)
 S MAGIEN=$O(^MAG(2005,"P",IMAGEUID,0))
"RTN","MAGDIR81",69,0)
 ;
"RTN","MAGDIR81",70,0)
 ; the following line will have to be adjusted for DICOM SR
"RTN","MAGDIR81",71,0)
 S FILEDATA("TYPE")=$O(^MAG(2005.83,"B","IMAGE",""))
"RTN","MAGDIR81",72,0)
 ;
"RTN","MAGDIR81",73,0)
 I MULTFRAM,MAGIEN D  ; subsequent image of a multiframe object
"RTN","MAGDIR81",74,0)
 . D MULTFRAM ; require both MULTFRAM and MAGIEN to be non-zero
"RTN","MAGDIR81",75,0)
 . Q
"RTN","MAGDIR81",76,0)
 E  D  Q:ERRCODE  ; new image
"RTN","MAGDIR81",77,0)
 . S ERRCODE=$$NEWIMAGE()
"RTN","MAGDIR81",78,0)
 . I ERRCODE D  ; error - abort image processing
"RTN","MAGDIR81",79,0)
 . . D ERROR^MAGDIR8("STORE",ERRCODE,.MSG,$T(+0))
"RTN","MAGDIR81",80,0)
 . . Q
"RTN","MAGDIR81",81,0)
 . Q
"RTN","MAGDIR81",82,0)
 ;
"RTN","MAGDIR81",83,0)
 ;create the image pointer
"RTN","MAGDIR81",84,0)
 I MODPARMS="<DICOM>" D  ; store DICOM image type in VistA
"RTN","MAGDIR81",85,0)
 . S FILEDATA("OBJECT TYPE")=100 ; DICOM image type
"RTN","MAGDIR81",86,0)
 . S FILEDATA("EXTENSION")="EXT^DCM" ; specify the DICOM file extension
"RTN","MAGDIR81",87,0)
 . Q
"RTN","MAGDIR81",88,0)
 E  D  ; convert DICOM image type to TGA and store it in VistA
"RTN","MAGDIR81",89,0)
 . S FILEDATA("OBJECT TYPE")=3 ; XRAY image type
"RTN","MAGDIR81",90,0)
 . S FILEDATA("EXTENSION")="EXT^TGA" ; specify the TGA file extension
"RTN","MAGDIR81",91,0)
 . Q
"RTN","MAGDIR81",92,0)
 S FILEDATA("ABSTRACT")="ABS^STUFFONLY" ; specify the abstract net loc
"RTN","MAGDIR81",93,0)
 ;
"RTN","MAGDIR81",94,0)
 S ERRCODE=$$IMAGE^MAGDIR9B ; create the ^MAG(2005) entry for the image
"RTN","MAGDIR81",95,0)
 I ERRCODE D  ; error - abort image processing
"RTN","MAGDIR81",96,0)
 . D ERROR^MAGDIR8("STORE",ERRCODE,.MSG,$T(+0))
"RTN","MAGDIR81",97,0)
 . Q
"RTN","MAGDIR81",98,0)
 E  D  ; no error
"RTN","MAGDIR81",99,0)
 . S X="0|"_RETURN
"RTN","MAGDIR81",100,0)
 . ; save pname, pid, dob, age, and sex from DEM^VADPT for gateway
"RTN","MAGDIR81",101,0)
 . F I=1:1:5 S X=X_"|"_VADM(I)
"RTN","MAGDIR81",102,0)
 . S X=X_"|"_$$GETICN^MPIF001(DFN) ; save ICN value
"RTN","MAGDIR81",103,0)
 . D RESULT^MAGDIR8("STORE",X)
"RTN","MAGDIR81",104,0)
 . Q
"RTN","MAGDIR81",105,0)
 Q
"RTN","MAGDIR81",106,0)
 ;
"RTN","MAGDIR81",107,0)
NEWIMAGE() ; processing for a new image
"RTN","MAGDIR81",108,0)
 N ERRORMSG ;- error message causing processing to stop
"RTN","MAGDIR81",109,0)
 N PIDCHECK ;- return value of from $$PIDCHECK^MAGDIR8A()
"RTN","MAGDIR81",110,0)
 ;
"RTN","MAGDIR81",111,0)
 I MAGIEN D  I $L(ERRORMSG) Q ERRORMSG
"RTN","MAGDIR81",112,0)
 . K MSG
"RTN","MAGDIR81",113,0)
 . I IMAGEUID=$$GETUID(MACHID) D  ; same image as last one
"RTN","MAGDIR81",114,0)
 . . ; process the image again, after software crash
"RTN","MAGDIR81",115,0)
 . . ; If the software crashed processing the first image, it might
"RTN","MAGDIR81",116,0)
 . . ; delete the image without ever writing it to the file server.
"RTN","MAGDIR81",117,0)
 . . ; Now, the image processing software has a second chance.
"RTN","MAGDIR81",118,0)
 . . S Y=$P($G(^MAG(2005,MAGIEN,2)),"^") I Y D DD^%DT
"RTN","MAGDIR81",119,0)
 . . S MSG(1)="Reprocessing image """_FROMPATH_""""
"RTN","MAGDIR81",120,0)
 . . S MSG(2)="which is partially in the database (#"_MAGIEN_") for"
"RTN","MAGDIR81",121,0)
 . . S MSG(3)=""""_$P($G(^MAG(2005,MAGIEN,0)),"^")_""""
"RTN","MAGDIR81",122,0)
 . . S MSG(4)="Acquired on "_Y
"RTN","MAGDIR81",123,0)
 . . S MSG(5)="UID = "_IMAGEUID
"RTN","MAGDIR81",124,0)
 . . D ERROR^MAGDIR8("STORE","1 Image partially in the database",.MSG,$T(+0))
"RTN","MAGDIR81",125,0)
 . . S ERRORMSG="" ; this is not an error!
"RTN","MAGDIR81",126,0)
 . . Q
"RTN","MAGDIR81",127,0)
 . E  D  ; don't accept images with duplicate UIDs
"RTN","MAGDIR81",128,0)
 . . S Y=$P($G(^MAG(2005,MAGIEN,2)),"^") I Y D DD^%DT
"RTN","MAGDIR81",129,0)
 . . S MSG(1)="Image """_FROMPATH_""""
"RTN","MAGDIR81",130,0)
 . . S MSG(2)="is already in the database (#"_MAGIEN_") for"
"RTN","MAGDIR81",131,0)
 . . S MSG(3)=""""_$P($G(^MAG(2005,MAGIEN,0)),"^")_""""
"RTN","MAGDIR81",132,0)
 . . S MSG(4)="Acquired on "_Y
"RTN","MAGDIR81",133,0)
 . . S MSG(5)="UID = "_IMAGEUID
"RTN","MAGDIR81",134,0)
 . . S ERRORMSG="-1 Image already in database"
"RTN","MAGDIR81",135,0)
 . . Q
"RTN","MAGDIR81",136,0)
 . Q
"RTN","MAGDIR81",137,0)
 ;
"RTN","MAGDIR81",138,0)
 D SAVEUID(MACHID,IMAGEUID) ; record the UID of the image being processed
"RTN","MAGDIR81",139,0)
 ;
"RTN","MAGDIR81",140,0)
 ; lookup the study by ACNUMB/CASENUMB, get DFN, and double-check PID
"RTN","MAGDIR81",141,0)
 S ERRCODE=$$LOOKUP Q:ERRCODE ERRCODE
"RTN","MAGDIR81",142,0)
 ;
"RTN","MAGDIR81",143,0)
 S PIDCHECK=$$PIDCHECK^MAGDIR8A()
"RTN","MAGDIR81",144,0)
 I PIDCHECK D  Q "-2 Image Association Problem" ; didn't find the study
"RTN","MAGDIR81",145,0)
 . N CASETEXT,COLUMNS,MFGR,MODEL,MODIEN,OFFSET,ROWS
"RTN","MAGDIR81",146,0)
 . ; formulate error message
"RTN","MAGDIR81",147,0)
 . K MSG
"RTN","MAGDIR81",148,0)
 . S MSG(1)=PIDCHECK
"RTN","MAGDIR81",149,0)
 . S (ROWS,COLUMNS,OFFSET,MODIEN,MFGR,MODEL,CASETEXT)=""
"RTN","MAGDIR81",150,0)
 . D MOVE^MAGDLBAA
"RTN","MAGDIR81",151,0)
 . Q
"RTN","MAGDIR81",152,0)
 ; create the group pointer
"RTN","MAGDIR81",153,0)
 I IMGSVC="RAD" D  Q:ERRCODE ERRCODE
"RTN","MAGDIR81",154,0)
 . S ERRCODE=$$GROUP^MAGDIR9A
"RTN","MAGDIR81",155,0)
 . Q
"RTN","MAGDIR81",156,0)
 E  I IMGSVC="CON" D  Q:ERRCODE ERRCODE
"RTN","MAGDIR81",157,0)
 . S ERRCODE=$$GROUP^MAGDIR9E
"RTN","MAGDIR81",158,0)
 . Q
"RTN","MAGDIR81",159,0)
 E  D  Q 3  ; undefined imaging service - same as error #4 in LOOKUP
"RTN","MAGDIR81",160,0)
 . K MSG
"RTN","MAGDIR81",161,0)
 . S MSG(1)="Undefined Imaging Service: "_IMGSVC
"RTN","MAGDIR81",162,0)
 . D ERROR^MAGDIRVE($T(+0),"DICOM IMAGE PROCESSING ERROR",.MSG)
"RTN","MAGDIR81",163,0)
 . Q
"RTN","MAGDIR81",164,0)
 Q 0
"RTN","MAGDIR81",165,0)
 ;
"RTN","MAGDIR81",166,0)
SAVEUID(MACHID,UID) ; record the UID of the image being processed
"RTN","MAGDIR81",167,0)
 N D0,X
"RTN","MAGDIR81",168,0)
 S D0=$O(^MAGD(2006.5715,"B",MACHID,"")) D:'D0
"RTN","MAGDIR81",169,0)
 . L +^MAGD(2006.5715):1E9 ; Background process MUST wait
"RTN","MAGDIR81",170,0)
 . S D0=$O(^MAGD(2006.5715," "),-1)+1
"RTN","MAGDIR81",171,0)
 . S X=$G(^MAGD(2006.5715,0))
"RTN","MAGDIR81",172,0)
 . S $P(X,"^",1,2)="CURRENT IMAGE^2006.5715"
"RTN","MAGDIR81",173,0)
 . S $P(X,"^",3)=D0
"RTN","MAGDIR81",174,0)
 . S $P(X,"^",4)=$P(X,"^",4)+1
"RTN","MAGDIR81",175,0)
 . S ^MAGD(2006.5715,0)=X
"RTN","MAGDIR81",176,0)
 . S ^MAGD(2006.5715,D0,0)=MACHID
"RTN","MAGDIR81",177,0)
 . S ^MAGD(2006.5715,"B",MACHID,D0)=""
"RTN","MAGDIR81",178,0)
 . L -^MAGD(2006.5715)
"RTN","MAGDIR81",179,0)
 . Q
"RTN","MAGDIR81",180,0)
 S $P(^MAGD(2006.5715,D0,0),"^",2)=UID
"RTN","MAGDIR81",181,0)
 Q
"RTN","MAGDIR81",182,0)
 ;
"RTN","MAGDIR81",183,0)
GETUID(MACHID) ; lookup the UID of the last image processed
"RTN","MAGDIR81",184,0)
 N D0
"RTN","MAGDIR81",185,0)
 S D0=+$O(^MAGD(2006.5715,"B",MACHID,""))
"RTN","MAGDIR81",186,0)
 Q $P($G(^MAGD(2006.5715,D0,0)),"^",2)
"RTN","MAGDIR81",187,0)
 ;
"RTN","MAGDIR81",188,0)
MULTFRAM ; Handle additional images in a multiframe object
"RTN","MAGDIR81",189,0)
 ; Get the information from the first image for the additional ones
"RTN","MAGDIR81",190,0)
 ;
"RTN","MAGDIR81",191,0)
 N DIQUIET,INAME,MAG0,MAG40,MAG100,MAGPACS
"RTN","MAGDIR81",192,0)
 N SOPCLASP ; pointer to SOP Class file (#2006.532)
"RTN","MAGDIR81",193,0)
 S MAG0=^MAG(2005,MAGIEN,0),MAG1=$G(^(1)),MAG2=$G(^(2))
"RTN","MAGDIR81",194,0)
 S MAG40=$G(^MAG(2005,MAGIEN,40)),MAG100=$G(^(100))
"RTN","MAGDIR81",195,0)
 S MAGPACS=$G(^MAG(2005,MAGIEN,"PACS"))
"RTN","MAGDIR81",196,0)
 S INAME=$P(MAG0,"^",1) ; field .01
"RTN","MAGDIR81",197,0)
 S PNAMEVAH=$P(INAME,"  ",1),DCMPID=$P(INAME,"  ",2)
"RTN","MAGDIR81",198,0)
 S DFN=$P(MAG0,"^",7) ; field 5
"RTN","MAGDIR81",199,0)
 S MAGGP=$P(MAG0,"^",10) ; field 14
"RTN","MAGDIR81",200,0)
 S DATETIME=$P(MAG2,"^",5) ; field 15
"RTN","MAGDIR81",201,0)
 S FILEDATA("MODALITY")=MODALITY
"RTN","MAGDIR81",202,0)
 S FILEDATA("PARENT FILE")=$P(MAG2,"^",6) ; field 16
"RTN","MAGDIR81",203,0)
 S FILEDATA("PARENT IEN")=$P(MAG2,"^",7) ; field 17
"RTN","MAGDIR81",204,0)
 S FILEDATA("PARENT FILE PTR")=$P(MAG2,"^",8) ; field 18
"RTN","MAGDIR81",205,0)
 S FILEDATA("RAD REPORT")=$P(MAGPACS,"^",2) ; field 61
"RTN","MAGDIR81",206,0)
 S FILEDATA("RAD PROC PTR")=$P(MAGPACS,"^",3) ; field 62
"RTN","MAGDIR81",207,0)
 S FILEDATA("PACKAGE")=$P(MAG40,"^",1) ; field 40
"RTN","MAGDIR81",208,0)
 ; field 41 is not needed
"RTN","MAGDIR81",209,0)
 S FILEDATA("TYPE")=$P(MAG40,"^",3) ; field 42
"RTN","MAGDIR81",210,0)
 S FILEDATA("PROC/EVENT")=$P(MAG40,"^",4) ; field 43
"RTN","MAGDIR81",211,0)
 S FILEDATA("SPEC/SUBSPEC")=$P(MAG40,"^",5) ; field 44
"RTN","MAGDIR81",212,0)
 S FILEDATA("ACQUISITION DEVICE")=$P(MAG100,"^",4) ; field 107
"RTN","MAGDIR81",213,0)
 ; get the SOP Class pointer (file 2005, field 251)
"RTN","MAGDIR81",214,0)
 S SOPCLASP=$O(^MAG(2006.532,"B",SOPCLASS,""))
"RTN","MAGDIR81",215,0)
 S FILEDATA("SOP CLASS POINTER")=SOPCLASP
"RTN","MAGDIR81",216,0)
 S PROCDESC=$P(MAG2,"^",4) ; field 10
"RTN","MAGDIR81",217,0)
 ; S X="" F  S X=$O(FILEDATA(X)) Q:X=""  I FILEDATA(X)="" K FILEDATA(X)
"RTN","MAGDIR81",218,0)
 I PROCDESC?.E1" (#".N1")" S PROCDESC=$P(PROCDESC," (#")
"RTN","MAGDIR81",219,0)
 ; lookup patient in VistA database - needed to build VADM array
"RTN","MAGDIR81",220,0)
 S DIQUIET=1 D DEM^VADPT
"RTN","MAGDIR81",221,0)
 Q
"RTN","MAGDIR81",222,0)
 ;
"RTN","MAGDIR81",223,0)
LOOKUP() ; lookup the patient/study using cross-reference
"RTN","MAGDIR81",224,0)
 I IMGSVC="RAD" D
"RTN","MAGDIR81",225,0)
 . D RADLKUP^MAGDIR8A
"RTN","MAGDIR81",226,0)
 . Q
"RTN","MAGDIR81",227,0)
 E  I IMGSVC="CON" D
"RTN","MAGDIR81",228,0)
 . S ACNUMB=CASENUMB
"RTN","MAGDIR81",229,0)
 . D CONLKUP^MAGDIR8A
"RTN","MAGDIR81",230,0)
 . Q
"RTN","MAGDIR81",231,0)
 E  D  Q 4 ; undefined imaging service - same as error #3 in NEWIMAGE
"RTN","MAGDIR81",232,0)
 . K MSG
"RTN","MAGDIR81",233,0)
 . S MSG(1)="Undefined Imaging Service: "_IMGSVC
"RTN","MAGDIR81",234,0)
 . D ERROR^MAGDIRVE($T(+0),"DICOM IMAGE PROCESSING ERROR",.MSG)
"RTN","MAGDIR81",235,0)
 . Q
"RTN","MAGDIR81",236,0)
 Q 0
"RTN","MAGDIR9B")
0^5^B17634090
"RTN","MAGDIR9B",1,0)
MAGDIR9B ;WOIFO/PMK - Read a DICOM image file ; 12 Oct 2005  8:21 AM
"RTN","MAGDIR9B",2,0)
 ;;3.0;IMAGING;**11,51,50**;26-May-2006
"RTN","MAGDIR9B",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDIR9B",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDIR9B",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDIR9B",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDIR9B",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDIR9B",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDIR9B",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDIR9B",10,0)
 ;; |                                                               |
"RTN","MAGDIR9B",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDIR9B",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDIR9B",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDIR9B",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDIR9B",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDIR9B",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDIR9B",17,0)
 ;;
"RTN","MAGDIR9B",18,0)
 ; M2MB server
"RTN","MAGDIR9B",19,0)
 ;
"RTN","MAGDIR9B",20,0)
 ; Create an image entry in ^MAG(2005)
"RTN","MAGDIR9B",21,0)
 ;
"RTN","MAGDIR9B",22,0)
IMAGE() ; entry point from ^MAGDIR81 to create an image entry in ^MAG(2005)
"RTN","MAGDIR9B",23,0)
 N IMAGE ;---- image array for ^MAGGTIA
"RTN","MAGDIR9B",24,0)
 N IMAGECNT ;- counter of image in the group
"RTN","MAGDIR9B",25,0)
 N IMAGEPTR ;- value returned by ^MAGGTIA
"RTN","MAGDIR9B",26,0)
 ;
"RTN","MAGDIR9B",27,0)
 ; check that the group has right object type and is for the same person
"RTN","MAGDIR9B",28,0)
 I $P($G(^MAG(2005,MAGGP,0)),"^",6)'=11 D  Q -101 ; fatal error
"RTN","MAGDIR9B",29,0)
 . D OBJECT^MAGDIRVE($T(+0),MAGGP)
"RTN","MAGDIR9B",30,0)
 . Q
"RTN","MAGDIR9B",31,0)
 ;
"RTN","MAGDIR9B",32,0)
 ; check that the group patient DFN matches the image patient DFN
"RTN","MAGDIR9B",33,0)
 I $P(^MAG(2005,MAGGP,0),"^",7)'=DFN D  Q -102 ; fatal error
"RTN","MAGDIR9B",34,0)
 . D MISMATCH^MAGDIRVE($T(+0),DFN,MAGGP)
"RTN","MAGDIR9B",35,0)
 . Q
"RTN","MAGDIR9B",36,0)
 ;
"RTN","MAGDIR9B",37,0)
 ; get the next file number and create the entry for this image
"RTN","MAGDIR9B",38,0)
 ;
"RTN","MAGDIR9B",39,0)
 S IMAGECNT=$P($G(^MAG(2005,MAGGP,1,0)),"^",4)+1 ; next image # in group
"RTN","MAGDIR9B",40,0)
 ;
"RTN","MAGDIR9B",41,0)
 K IMAGE
"RTN","MAGDIR9B",42,0)
 S IMAGE(1)=".01^"_PNAMEVAH_"  "_DCMPID_"  "_PROCDESC ; used in ^MAGDIR8
"RTN","MAGDIR9B",43,0)
 S IMAGE(2)="5^"_DFN
"RTN","MAGDIR9B",44,0)
 I $D(FILEDATA("SHORT DESCRIPTION")) D  ; set in ^MAGDIR7F
"RTN","MAGDIR9B",45,0)
 . S IMAGE(3)="10^"_FILEDATA("SHORT DESCRIPTION")
"RTN","MAGDIR9B",46,0)
 . Q
"RTN","MAGDIR9B",47,0)
 E  S IMAGE(3)="10^"_PROCDESC_" (#"_IMAGECNT_")" ; used in ^MAGDIR81
"RTN","MAGDIR9B",48,0)
 S IMAGE(4)="14^"_MAGGP
"RTN","MAGDIR9B",49,0)
 S IMAGE(5)="15^"_DATETIME
"RTN","MAGDIR9B",50,0)
 S IMAGE(6)="60^"_IMAGEUID
"RTN","MAGDIR9B",51,0)
 S IMAGE(7)=FILEDATA("EXTENSION") ; specify the image file extension
"RTN","MAGDIR9B",52,0)
 I $D(FILEDATA("ABSTRACT")) S IMAGE(8)=FILEDATA("ABSTRACT")
"RTN","MAGDIR9B",53,0)
 S IMAGE(9)="WRITE^PACS" ; select the PACS image write location
"RTN","MAGDIR9B",54,0)
 S IMAGE(10)="3^"_FILEDATA("OBJECT TYPE")
"RTN","MAGDIR9B",55,0)
 S IMAGE(11)="6^"_FILEDATA("MODALITY")
"RTN","MAGDIR9B",56,0)
 S IMAGE(12)="16^"_FILEDATA("PARENT FILE")
"RTN","MAGDIR9B",57,0)
 S IMAGE(13)="17^"_FILEDATA("PARENT IEN")
"RTN","MAGDIR9B",58,0)
 I $D(FILEDATA("PARENT FILE PTR")) S IMAGE(14)="18^"_FILEDATA("PARENT FILE PTR")
"RTN","MAGDIR9B",59,0)
 I $D(FILEDATA("RAD REPORT")) S IMAGE(15)="61^"_FILEDATA("RAD REPORT")
"RTN","MAGDIR9B",60,0)
 I $D(FILEDATA("RAD PROC PTR")) S IMAGE(16)="62^"_FILEDATA("RAD PROC PTR")
"RTN","MAGDIR9B",61,0)
 I MODPARMS["/" S IMAGE(17)="BIG^1" ; big file will be output
"RTN","MAGDIR9B",62,0)
 S IMAGE(18)="DICOMSN^"_SERINUMB ; series number
"RTN","MAGDIR9B",63,0)
 S IMAGE(19)="DICOMIN^"_IMAGNUMB ; image number
"RTN","MAGDIR9B",64,0)
 S IMAGE(20)=".05^"_INSTLOC
"RTN","MAGDIR9B",65,0)
 S IMAGE(21)="40^"_FILEDATA("PACKAGE")
"RTN","MAGDIR9B",66,0)
 S IMAGE(22)="41^"_$O(^MAG(2005.82,"B","CLIN",""))
"RTN","MAGDIR9B",67,0)
 S IMAGE(23)="42^"_FILEDATA("TYPE")
"RTN","MAGDIR9B",68,0)
 S IMAGE(24)="43^"_FILEDATA("PROC/EVENT")
"RTN","MAGDIR9B",69,0)
 S IMAGE(25)="44^"_FILEDATA("SPEC/SUBSPEC")
"RTN","MAGDIR9B",70,0)
 S IMAGE(26)="107^"_FILEDATA("ACQUISITION DEVICE")
"RTN","MAGDIR9B",71,0)
 S IMAGE(27)="251^"_FILEDATA("SOP CLASS POINTER")
"RTN","MAGDIR9B",72,0)
 S IMAGE(28)="253^"_SERIEUID
"RTN","MAGDIR9B",73,0)
 D ADD^MAGGTIA(.RETURN,.IMAGE)
"RTN","MAGDIR9B",74,0)
 ;
"RTN","MAGDIR9B",75,0)
 S IMAGEPTR=+RETURN
"RTN","MAGDIR9B",76,0)
 I 'IMAGEPTR D  Q -103 ; fatal error
"RTN","MAGDIR9B",77,0)
 . K MSG
"RTN","MAGDIR9B",78,0)
 . S MSG(1)="IMAGE FILE CREATION ERROR:"
"RTN","MAGDIR9B",79,0)
 . S MSG(2)=$P(RETURN,"^",2,999)
"RTN","MAGDIR9B",80,0)
 . D BADERROR^MAGDIRVE($T(+0),"DICOM IMAGE PROCESSING ERROR",.MSG)
"RTN","MAGDIR9B",81,0)
 . Q
"RTN","MAGDIR9B",82,0)
 ;
"RTN","MAGDIR9B",83,0)
 I IMAGEPTR<LASTIMG D  Q -104 ; fatal last image pointer error
"RTN","MAGDIR9B",84,0)
 . D IMAGEPTR^MAGDIRVE($T(+0),IMAGEPTR,LASTIMG)
"RTN","MAGDIR9B",85,0)
 . Q
"RTN","MAGDIR9B",86,0)
 ;
"RTN","MAGDIR9B",87,0)
 S $P(RETURN,"^",4)=$$CHKPATH() ; hierarchal file patch check
"RTN","MAGDIR9B",88,0)
 ;
"RTN","MAGDIR9B",89,0)
 Q 0
"RTN","MAGDIR9B",90,0)
 ;
"RTN","MAGDIR9B",91,0)
CHKPATH() ; determine if the path is hierarchal (true) or not (false)
"RTN","MAGDIR9B",92,0)
 N D0,PATH
"RTN","MAGDIR9B",93,0)
 S D0="",PATH=$P(RETURN,"^",2)
"RTN","MAGDIR9B",94,0)
 I $D(^MAG(2005.2,"AC")) S D0=$O(^MAG(2005.2,"AC",PATH,""))
"RTN","MAGDIR9B",95,0)
 E  D
"RTN","MAGDIR9B",96,0)
 . N PLACE
"RTN","MAGDIR9B",97,0)
 . S PLACE=""
"RTN","MAGDIR9B",98,0)
 . F  S PLACE=$O(^MAG(2005.2,"E",PLACE)) Q:PLACE=""  D  Q:D0
"RTN","MAGDIR9B",99,0)
 . . S D0=$O(^MAG(2005.2,"E",PLACE,PATH,""))
"RTN","MAGDIR9B",100,0)
 . . Q
"RTN","MAGDIR9B",101,0)
 . Q
"RTN","MAGDIR9B",102,0)
 Q 'D0 ; network location file
"RTN","MAGDIR9B",103,0)
 ;
"RTN","MAGDRPC1")
0^6^B57449728
"RTN","MAGDRPC1",1,0)
MAGDRPC1 ;WOIFO/EdM - Imaging RPCs ; 01/09/2006  07:41
"RTN","MAGDRPC1",2,0)
 ;;3.0;IMAGING;**11,30,51,50**;26-May-2006
"RTN","MAGDRPC1",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC1",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDRPC1",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDRPC1",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDRPC1",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDRPC1",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDRPC1",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDRPC1",10,0)
 ;; |                                                               |
"RTN","MAGDRPC1",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDRPC1",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDRPC1",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDRPC1",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDRPC1",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDRPC1",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC1",17,0)
 ;;
"RTN","MAGDRPC1",18,0)
 Q
"RTN","MAGDRPC1",19,0)
 ;
"RTN","MAGDRPC1",20,0)
CHECKID(OUT,ID,HOSTNAME) ; RPC = MAG DICOM CHECK MACHINE ID
"RTN","MAGDRPC1",21,0)
 N D0,H0,I0,N,NH,NI,S,X
"RTN","MAGDRPC1",22,0)
 S OUT=0,ID=$GET(ID)
"RTN","MAGDRPC1",23,0)
 I $G(HOSTNAME)="" S OUT="-1,No Hostname Specified" Q
"RTN","MAGDRPC1",24,0)
 I ID'?1U S OUT="-2,No valid ID specified ("""_ID_""")" Q
"RTN","MAGDRPC1",25,0)
 S (NH,NI)=0
"RTN","MAGDRPC1",26,0)
 S D0="" F  S D0=$O(^MAGDICOM(2006.5641,"B",ID,D0)) Q:D0=""  S NI=NI+1,I0=D0
"RTN","MAGDRPC1",27,0)
 S D0="" F  S D0=$O(^MAGDICOM(2006.5641,"C",HOSTNAME,D0)) Q:D0=""  S NH=NH+1,H0=D0
"RTN","MAGDRPC1",28,0)
 I NH=1,NI=1,I0=H0 S OUT=1 Q  ; This ID belongs to this hostname
"RTN","MAGDRPC1",29,0)
 I 'NI S OUT=1 Q  ; This ID is still unused
"RTN","MAGDRPC1",30,0)
 S OUT="-1,Machine ID """_ID_""" is already used by",S=" "
"RTN","MAGDRPC1",31,0)
 S D0="" F  S D0=$O(^MAGDICOM(2006.5641,"B",ID,D0)) Q:D0=""  D
"RTN","MAGDRPC1",32,0)
 . I S=", ",$O(^MAGDICOM(2006.5641,"B",ID,D0))="" S S=" and "
"RTN","MAGDRPC1",33,0)
 . S X=$P($G(^MAGDICOM(2006.5641,D0,0)),"^",2)
"RTN","MAGDRPC1",34,0)
 . S OUT=OUT_S_""""_X_"""",S=", "
"RTN","MAGDRPC1",35,0)
 . Q
"RTN","MAGDRPC1",36,0)
 S OUT=OUT_"."
"RTN","MAGDRPC1",37,0)
 Q
"RTN","MAGDRPC1",38,0)
 ;
"RTN","MAGDRPC1",39,0)
UPDTID(OUT,ID,HOSTNAME) ; RPC = MAG DICOM UPDATE MACHINE ID
"RTN","MAGDRPC1",40,0)
 N D0,I,N,X
"RTN","MAGDRPC1",41,0)
 I $G(HOSTNAME)="" S OUT="-1,No Hostname Specified" Q
"RTN","MAGDRPC1",42,0)
 I $G(ID)'?1U S OUT="-2,No valid ID specified ("""_$G(ID)_""")" Q
"RTN","MAGDRPC1",43,0)
 L +^MAGDICOM(2006.5641,0):1E9 ; Background process MUST wait
"RTN","MAGDRPC1",44,0)
 S N=0,D0="" F  S D0=$O(^MAGDICOM(2006.5641,"C",HOSTNAME,D0)) Q:D0=""  D
"RTN","MAGDRPC1",45,0)
 . S X=$G(^MAGDICOM(2006.5641,D0,0)),N=N+1
"RTN","MAGDRPC1",46,0)
 . D:N=1
"RTN","MAGDRPC1",47,0)
 . . S I=$P(X,"^",1) I I'="" K ^MAGDICOM(2006.5641,"B",I,D0)
"RTN","MAGDRPC1",48,0)
 . . S $P(X,"^",1)=ID,$P(X,"^",2)=HOSTNAME,$P(X,"^",3)=$H
"RTN","MAGDRPC1",49,0)
 . . S ^MAGDICOM(2006.5641,D0,0)=X
"RTN","MAGDRPC1",50,0)
 . . S ^MAGDICOM(2006.5641,"B",ID,D0)=""
"RTN","MAGDRPC1",51,0)
 . . S ^MAGDICOM(2006.5641,"C",HOSTNAME,D0)=""
"RTN","MAGDRPC1",52,0)
 . . Q
"RTN","MAGDRPC1",53,0)
 . D:N>1
"RTN","MAGDRPC1",54,0)
 . . S I=$P(X,"^",1) I I'="" K ^MAGDICOM(2006.5641,"B",I,D0)
"RTN","MAGDRPC1",55,0)
 . . K ^MAGDICOM(2006.5641,"C",HOSTNAME,D0)
"RTN","MAGDRPC1",56,0)
 . . K ^MAGDICOM(2006.5641,D0)
"RTN","MAGDRPC1",57,0)
 . . Q
"RTN","MAGDRPC1",58,0)
 . Q
"RTN","MAGDRPC1",59,0)
 D:'N
"RTN","MAGDRPC1",60,0)
 . S D0=$O(^MAGDICOM(2006.5641," "),-1)+1
"RTN","MAGDRPC1",61,0)
 . S ^MAGDICOM(2006.5641,D0,0)=ID_"^"_HOSTNAME_"^"_$H
"RTN","MAGDRPC1",62,0)
 . S ^MAGDICOM(2006.5641,"B",ID,D0)=""
"RTN","MAGDRPC1",63,0)
 . S ^MAGDICOM(2006.5641,"C",HOSTNAME,D0)=""
"RTN","MAGDRPC1",64,0)
 . Q
"RTN","MAGDRPC1",65,0)
 S (N,I,D0)=0 F  S D0=$O(^MAGDICOM(2006.5641,D0)) Q:'D0  S N=N+1,I=D0
"RTN","MAGDRPC1",66,0)
 S ^MAGDICOM(2006.5641,0)="DICOM GATEWAY MACHINE ID^2006.5641^"_I_"^"_N
"RTN","MAGDRPC1",67,0)
 L -^MAGDICOM(2006.5641,0)
"RTN","MAGDRPC1",68,0)
 S OUT=""
"RTN","MAGDRPC1",69,0)
 S N=0,D0="" F  S D0=$O(^MAGDICOM(2006.5641,"B",ID,D0)) Q:D0=""  D
"RTN","MAGDRPC1",70,0)
 . S N=N+1,X=$G(^MAGDICOM(2006.5641,D0,0)),I=$P(X,"^",2)
"RTN","MAGDRPC1",71,0)
 . I I'=HOSTNAME,I'="" S OUT=OUT_", """_I_""""
"RTN","MAGDRPC1",72,0)
 . Q
"RTN","MAGDRPC1",73,0)
 I N=1 S OUT=1 Q
"RTN","MAGDRPC1",74,0)
 S OUT=N_OUT
"RTN","MAGDRPC1",75,0)
 Q
"RTN","MAGDRPC1",76,0)
 ;
"RTN","MAGDRPC1",77,0)
DOMAIN(OUT) ; RPC = MAG DICOM GET DOMAIN
"RTN","MAGDRPC1",78,0)
 N X
"RTN","MAGDRPC1",79,0)
 I $T(WHERE^XUPARAM)'="" S OUT=$$KSP^XUPARAM("WHERE") Q
"RTN","MAGDRPC1",80,0)
 ; The coding standards frown upon the line below,
"RTN","MAGDRPC1",81,0)
 ; but it is the best we can do when the line above cannot be used.
"RTN","MAGDRPC1",82,0)
 S X=^DD("SITE") S:X'[".DOMAIN.EXT" X=X_".DOMAIN.EXT"
"RTN","MAGDRPC1",83,0)
 S OUT=X
"RTN","MAGDRPC1",84,0)
 Q
"RTN","MAGDRPC1",85,0)
 ;
"RTN","MAGDRPC1",86,0)
INFO(OUT,LOCATION) ; RPC = MAG DICOM ET PHONE HOME
"RTN","MAGDRPC1",87,0)
 N FST,N,X
"RTN","MAGDRPC1",88,0)
 K OUT
"RTN","MAGDRPC1",89,0)
 S X1=DT,X2=-25 D C^%DTC S FST=X
"RTN","MAGDRPC1",90,0)
 S N=2
"RTN","MAGDRPC1",91,0)
 ;
"RTN","MAGDRPC1",92,0)
 ; Site-ID
"RTN","MAGDRPC1",93,0)
 D DOMAIN(.X)
"RTN","MAGDRPC1",94,0)
 S OUT(N)=X
"RTN","MAGDRPC1",95,0)
 ;
"RTN","MAGDRPC1",96,0)
 D ROUTEDAY^MAGDRPC2 ; Get routing statistics
"RTN","MAGDRPC1",97,0)
 ;
"RTN","MAGDRPC1",98,0)
 D  ; Text Gateway Statistics
"RTN","MAGDRPC1",99,0)
 . N A,C,D0,D2,M,X
"RTN","MAGDRPC1",100,0)
 . S A=0,D0=FST F  S D0=$O(^MAGDAUDT(2006.5761,D0)) Q:'D0  D
"RTN","MAGDRPC1",101,0)
 . . S D2=0 F  S D2=$O(^MAGDAUDT(2006.5761,D0,1,LOCATION,1,D2)) Q:'D2  D
"RTN","MAGDRPC1",102,0)
 . . . S X=$G(^MAGDAUDT(2006.5761,D0,1,LOCATION,1,D2,0))
"RTN","MAGDRPC1",103,0)
 . . . S M=$P(X,"^",2) Q:'M
"RTN","MAGDRPC1",104,0)
 . . . S:'A N=N+1,OUT(N)="Audit",A=1
"RTN","MAGDRPC1",105,0)
 . . . S N=N+1,OUT(N)="STTX="_D0_"^"_$P(X,"^",1)_"^"_M
"RTN","MAGDRPC1",106,0)
 . . . Q
"RTN","MAGDRPC1",107,0)
 . . Q
"RTN","MAGDRPC1",108,0)
 . Q
"RTN","MAGDRPC1",109,0)
 ;
"RTN","MAGDRPC1",110,0)
 S OUT(1)=N-1
"RTN","MAGDRPC1",111,0)
 Q
"RTN","MAGDRPC1",112,0)
 ;
"RTN","MAGDRPC1",113,0)
STATION(OUT,STATION,VERSION) ; RPC = MAG DICOM WORKSTATION VERSION
"RTN","MAGDRPC1",114,0)
 N %,D0,%H,%I,X
"RTN","MAGDRPC1",115,0)
 I $G(STATION)="" S OUT="-1,No Station Identifier Specified" Q
"RTN","MAGDRPC1",116,0)
 ;
"RTN","MAGDRPC1",117,0)
 S D0=$O(^MAG(2006.83,"B",STATION,"")) D:'D0
"RTN","MAGDRPC1",118,0)
 . L +^MAG(2006.83,0):1E9 ; Background process must wait for LOCK
"RTN","MAGDRPC1",119,0)
 . S X=$G(^MAG(2006.83,0))
"RTN","MAGDRPC1",120,0)
 . S $P(X,"^",1,2)="DICOM WORKSTATION^2006.83"
"RTN","MAGDRPC1",121,0)
 . S D0=$O(^MAG(2006.83," "),-1)+1
"RTN","MAGDRPC1",122,0)
 . S $P(X,"^",3)=D0
"RTN","MAGDRPC1",123,0)
 . S $P(X,"^",4)=$P(X,"^",4)+1
"RTN","MAGDRPC1",124,0)
 . S ^MAG(2006.83,0)=X,^MAG(2006.83,D0,0)=STATION
"RTN","MAGDRPC1",125,0)
 . S ^MAG(2006.83,"B",STATION,D0)=""
"RTN","MAGDRPC1",126,0)
 . L -^MAG(2006.83,0)
"RTN","MAGDRPC1",127,0)
 . Q
"RTN","MAGDRPC1",128,0)
 S $P(^MAG(2006.83,D0,0),"^",3)=VERSION
"RTN","MAGDRPC1",129,0)
 S X=$P(^MAG(2006.83,D0,0),"^",2)
"RTN","MAGDRPC1",130,0)
 D NOW^%DTC
"RTN","MAGDRPC1",131,0)
 S $P(^MAG(2006.83,D0,0),"^",2)=%
"RTN","MAGDRPC1",132,0)
 S OUT=D0
"RTN","MAGDRPC1",133,0)
 Q
"RTN","MAGDRPC1",134,0)
 ;
"RTN","MAGDRPC1",135,0)
FMGET(OUT,FILE,D0,FIELD) ; RPC = MAG DICOM FILEMAN GET
"RTN","MAGDRPC1",136,0)
 ; Get the value of a data field
"RTN","MAGDRPC1",137,0)
 S OUT=$$GET1^DIQ(FILE,D0,FIELD)
"RTN","MAGDRPC1",138,0)
 Q
"RTN","MAGDRPC1",139,0)
 ;
"RTN","MAGDRPC1",140,0)
CUTOFF(OUT,D0) ; RPC = MAG DICOM PACS CUTOFF DATE
"RTN","MAGDRPC1",141,0)
 ; Retention Period for PACS
"RTN","MAGDRPC1",142,0)
 N X
"RTN","MAGDRPC1",143,0)
 I '$$CONSOLID^MAGBAPI() D  Q
"RTN","MAGDRPC1",144,0)
 . ; Non-consolidated site
"RTN","MAGDRPC1",145,0)
 . I '$D(^MAG(2006.1,"APACS")) S OUT="-2,No PACS Installed" Q
"RTN","MAGDRPC1",146,0)
 . ;
"RTN","MAGDRPC1",147,0)
 . S X=$G(^MAG(2006.1,"AIMDELPACS"))
"RTN","MAGDRPC1",148,0)
 . I X="" S OUT="-3,PACS Retention Parameter not defined" Q
"RTN","MAGDRPC1",149,0)
 . S OUT=X
"RTN","MAGDRPC1",150,0)
 . Q
"RTN","MAGDRPC1",151,0)
 ; Consolidated site:
"RTN","MAGDRPC1",152,0)
 I '$P($G(^MAG(2006.1,D0,"PACS")),"^",1) S OUT="-2,No PACS Installed" Q
"RTN","MAGDRPC1",153,0)
 ;
"RTN","MAGDRPC1",154,0)
 S X=$P($G(^MAG(2006.1,D0,1)),"^",5)
"RTN","MAGDRPC1",155,0)
 I X="" S OUT="-3,PACS Retention Parameter not defined" Q
"RTN","MAGDRPC1",156,0)
 S OUT=X
"RTN","MAGDRPC1",157,0)
 Q
"RTN","MAGDRPC1",158,0)
 ;
"RTN","MAGDRPC1",159,0)
MINSPACE(OUT,D0) ; RPC = MAG DICOM PACS MINIMUM SPACE
"RTN","MAGDRPC1",160,0)
 ; Minimum Percentage of Free Disk Space
"RTN","MAGDRPC1",161,0)
 N X
"RTN","MAGDRPC1",162,0)
 I '$$CONSOLID^MAGBAPI() D  Q
"RTN","MAGDRPC1",163,0)
 . ; Non-consolidated site
"RTN","MAGDRPC1",164,0)
 . I '$D(^MAG(2006.1,"APACS")) S OUT="-2,No PACS Installed" Q
"RTN","MAGDRPC1",165,0)
 . ;
"RTN","MAGDRPC1",166,0)
 . S X=$G(^MAG(2006.1,"AIMDELPACS2"))
"RTN","MAGDRPC1",167,0)
 . I X="" S OUT="-3,PACS Minimum Space Percentage Parameter not defined" Q
"RTN","MAGDRPC1",168,0)
 . S OUT=X
"RTN","MAGDRPC1",169,0)
 . Q
"RTN","MAGDRPC1",170,0)
 ; Consolidated site:
"RTN","MAGDRPC1",171,0)
 I '$P($G(^MAG(2006.1,D0,"PACS")),"^",1) S OUT="-2,No PACS Installed" Q
"RTN","MAGDRPC1",172,0)
 ;
"RTN","MAGDRPC1",173,0)
 S X=$P($G(^MAG(2006.1,D0,3)),"^",5)
"RTN","MAGDRPC1",174,0)
 I X="" S OUT="-3,PACS Minimum Space Percentage Parameter not defined" Q
"RTN","MAGDRPC1",175,0)
 S OUT=X
"RTN","MAGDRPC1",176,0)
 Q
"RTN","MAGDRPC1",177,0)
 ;
"RTN","MAGDRPC1",178,0)
HL7PURGE(OUT,CUTOFF) ; RPC = MAG DICOM PURGE HL7
"RTN","MAGDRPC1",179,0)
 ; Purge HL7 transactions
"RTN","MAGDRPC1",180,0)
 N D,D0,P,T,X
"RTN","MAGDRPC1",181,0)
 S OUT=0
"RTN","MAGDRPC1",182,0)
 S D="" F  S D=$O(^MAGDHL7(2006.5,"B",D)) Q:'D  Q:D'<CUTOFF  D
"RTN","MAGDRPC1",183,0)
 . S D0="" F  S D0=$O(^MAGDHL7(2006.5,"B",D,D0)) Q:'D0  D
"RTN","MAGDRPC1",184,0)
 . . S X=$G(^MAGDHL7(2006.5,D0,0)),P=$P(X,"^",4),T=$P(X,"^",3)
"RTN","MAGDRPC1",185,0)
 . . K ^MAGDHL7(2006.5,D0)
"RTN","MAGDRPC1",186,0)
 . . K ^MAGDHL7(2006.5,"B",D,D0)
"RTN","MAGDRPC1",187,0)
 . . K:T'="" ^MAGDHL7(2006.5,"C",T,D0)
"RTN","MAGDRPC1",188,0)
 . . K:P'="" ^MAGDHL7(2006.5,"D",P,D0)
"RTN","MAGDRPC1",189,0)
 . . S OUT=OUT+1
"RTN","MAGDRPC1",190,0)
 . . Q
"RTN","MAGDRPC1",191,0)
 . Q
"RTN","MAGDRPC1",192,0)
 D:OUT
"RTN","MAGDRPC1",193,0)
 . L +^MAGDHL7(2006.5,0):1E9
"RTN","MAGDRPC1",194,0)
 . S X=$G(^MAGDHL7(2006.5,0))
"RTN","MAGDRPC1",195,0)
 . S $P(X,"^",1,2)="PACS MESSAGES^2006.5D"
"RTN","MAGDRPC1",196,0)
 . S $P(X,"^",4)=$P(X,"^",4)-OUT
"RTN","MAGDRPC1",197,0)
 . S ^MAGDHL7(2006.5,0)=X
"RTN","MAGDRPC1",198,0)
 . L -^MAGDHL7(2006.5,0)
"RTN","MAGDRPC1",199,0)
 . Q
"RTN","MAGDRPC1",200,0)
 Q
"RTN","MAGDRPC1",201,0)
 ;
"RTN","MAGDRPC1",202,0)
VALDEST(OUT,NAME) ; RPC = MAG DICOM ROUTE VALID DEST
"RTN","MAGDRPC1",203,0)
 N D0,PLACE,X
"RTN","MAGDRPC1",204,0)
 ; This function is also called from various routines
"RTN","MAGDRPC1",205,0)
 ; that belong to automated routing.
"RTN","MAGDRPC1",206,0)
 ;
"RTN","MAGDRPC1",207,0)
 S OUT="-1,"""_NAME_""" is not a valid destination"
"RTN","MAGDRPC1",208,0)
 ;
"RTN","MAGDRPC1",209,0)
 I $D(^MAG(2005.2,"B")) D  Q
"RTN","MAGDRPC1",210,0)
 . S D0=$O(^MAG(2005.2,"B",NAME,"")) Q:'D0
"RTN","MAGDRPC1",211,0)
 . S:$P($G(^MAG(2005.2,D0,0)),"^",9) OUT=D0
"RTN","MAGDRPC1",212,0)
 . Q
"RTN","MAGDRPC1",213,0)
 ;
"RTN","MAGDRPC1",214,0)
 S D0=""
"RTN","MAGDRPC1",215,0)
 S PLACE="" F  S PLACE=$O(^MAG(2005.2,"D",PLACE)) Q:PLACE=""  D  Q:OUT>0
"RTN","MAGDRPC1",216,0)
 . S D0=$O(^MAG(2005.2,"D",PLACE,NAME,""))
"RTN","MAGDRPC1",217,0)
 . S:$P($G(^MAG(2005.2,D0,0)),"^",9) OUT=D0
"RTN","MAGDRPC1",218,0)
 . Q
"RTN","MAGDRPC1",219,0)
 Q
"RTN","MAGDRPC1",220,0)
 ;
"RTN","MAGDRPC1",221,0)
PAT(OUT,DFN) ; RPC = MAG DICOM GET PATIENT
"RTN","MAGDRPC1",222,0)
 N DIQUIET,I,N,VADM,VAIN,VAPA,VASD
"RTN","MAGDRPC1",223,0)
 K OUT
"RTN","MAGDRPC1",224,0)
 I '$G(DFN) S OUT(1)="-1,No Patient Identified" Q
"RTN","MAGDRPC1",225,0)
 S N=1,DIQUIET=1
"RTN","MAGDRPC1",226,0)
 D DEM^VADPT,VA("DEM","VADM","")
"RTN","MAGDRPC1",227,0)
 D ADD^VADPT,VA("ADD","VAPA","")
"RTN","MAGDRPC1",228,0)
 D INP^VADPT,VA("INP","VAIN","")
"RTN","MAGDRPC1",229,0)
 D SDA^VADPT,VA("SDA","VASD","")
"RTN","MAGDRPC1",230,0)
 S X=$$GETICN^MPIF001(DFN) S:X'<0 N=N+1,OUT(N)="ICN^1^"_X
"RTN","MAGDRPC1",231,0)
 S OUT(1)=N-1
"RTN","MAGDRPC1",232,0)
 Q
"RTN","MAGDRPC1",233,0)
 ;
"RTN","MAGDRPC1",234,0)
VA(PRE,ARR,SUB) N A,I,X
"RTN","MAGDRPC1",235,0)
 S I="" F  S I=$O(@ARR@(I)) Q:I=""  D
"RTN","MAGDRPC1",236,0)
 . S A=$NAME(@ARR@(I))
"RTN","MAGDRPC1",237,0)
 . S X=$G(@A) S:X'="" N=N+1,OUT(N)=PRE_"^"_SUB_I_"^"_X
"RTN","MAGDRPC1",238,0)
 . D:$D(@A)>9 VA(PRE,A,SUB_I_",")
"RTN","MAGDRPC1",239,0)
 . Q
"RTN","MAGDRPC1",240,0)
 Q
"RTN","MAGDRPC1",241,0)
 ;
"RTN","MAGDRPC1",242,0)
RARPTO(OUT,TYPE,D0,F,D1) ; RPC = MAG DICOM GET RAD RPT INFO
"RTN","MAGDRPC1",243,0)
 S TYPE=$G(TYPE),D0=$G(D0),F=$G(F,1),D1=+$G(D1)
"RTN","MAGDRPC1",244,0)
 I TYPE="O1" S OUT=+$O(^RARPT(D0),F) Q
"RTN","MAGDRPC1",245,0)
 I TYPE="O2" S OUT=+$O(^RARPT(D0,F,D1)) Q
"RTN","MAGDRPC1",246,0)
 I TYPE="G1" S OUT=$G(^RARPT(D0,0)) Q
"RTN","MAGDRPC1",247,0)
 I TYPE="G2" S OUT=$G(^RARPT(D0,F,D1,0)) Q
"RTN","MAGDRPC1",248,0)
 S OUT="-1,Invalid request type ("""_TYPE_""")"
"RTN","MAGDRPC1",249,0)
 Q
"RTN","MAGDRPC1",250,0)
 ;
"RTN","MAGDRPC2")
0^7^B66435517
"RTN","MAGDRPC2",1,0)
MAGDRPC2 ;WOIFO/EdM - Imaging RPCs ; 11/10/2005  08:19
"RTN","MAGDRPC2",2,0)
 ;;3.0;IMAGING;**11,30,51,50**;26-May-2006
"RTN","MAGDRPC2",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC2",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDRPC2",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDRPC2",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDRPC2",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDRPC2",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDRPC2",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDRPC2",10,0)
 ;; |                                                               |
"RTN","MAGDRPC2",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDRPC2",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDRPC2",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDRPC2",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDRPC2",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDRPC2",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC2",17,0)
 ;;
"RTN","MAGDRPC2",18,0)
 Q
"RTN","MAGDRPC2",19,0)
 ;
"RTN","MAGDRPC2",20,0)
SERVICE(OUT) ; RPC = MAG DICOM GET SERVICE INFO
"RTN","MAGDRPC2",21,0)
 N D0,X
"RTN","MAGDRPC2",22,0)
 S D0=$O(^MAG(2006.1,0)),OUT="-1,No Imaging Site Parameters defined" Q:'D0
"RTN","MAGDRPC2",23,0)
 S X=$G(^MAG(2006.1,D0,"GW"))
"RTN","MAGDRPC2",24,0)
 S OUT=$$ENCRYP^ROUTINE($$DECRYP($P(X,"^",1))_";"_$$DECRYP($P(X,"^",2)))
"RTN","MAGDRPC2",25,0)
 Q
"RTN","MAGDRPC2",26,0)
 ;
"RTN","MAGDRPC2",27,0)
SAME(SET,D0,NODE,PIECE,X) ; Called from FileMan ^DD
"RTN","MAGDRPC2",28,0)
 N L0
"RTN","MAGDRPC2",29,0)
 S L0=0 F  S L0=$O(^MAG(2006.1,L0)) Q:'L0  D:L0'=D0
"RTN","MAGDRPC2",30,0)
 . S $P(^MAG(2006.1,L0,NODE),"^",PIECE)=$S(SET:X,1:"")
"RTN","MAGDRPC2",31,0)
 . Q
"RTN","MAGDRPC2",32,0)
 Q
"RTN","MAGDRPC2",33,0)
 ;
"RTN","MAGDRPC2",34,0)
IMAGE(OUT,D0) ; RPC = MAG DICOM GET BASIC IMAGE
"RTN","MAGDRPC2",35,0)
 N I,MSG,TARGET,V,VE,VI,X
"RTN","MAGDRPC2",36,0)
 K OUT S I=1
"RTN","MAGDRPC2",37,0)
 I '$G(D0) S OUT(1)="-1,Invalid IEN ("_$G(D0)_")" Q
"RTN","MAGDRPC2",38,0)
 I $D(^MAG(2005.1,D0,0)) S OUT(1)="-3,Image #"_D0_" has been deleted." Q
"RTN","MAGDRPC2",39,0)
 I '$D(^MAG(2005,D0,0)) S OUT(1)="-2,No data for """_D0_"""." Q
"RTN","MAGDRPC2",40,0)
 ;
"RTN","MAGDRPC2",41,0)
 D GETS^DIQ(2005,D0_",","*","REIN","TARGET","MSG")
"RTN","MAGDRPC2",42,0)
 S X="" F  S X=$O(TARGET(2005,D0_",",X)) Q:X=""  D
"RTN","MAGDRPC2",43,0)
 . S VI=$G(TARGET(2005,D0_",",X,"I"))
"RTN","MAGDRPC2",44,0)
 . S VE=$G(TARGET(2005,D0_",",X,"E"))
"RTN","MAGDRPC2",45,0)
 . S I=I+1,OUT(I)=X_"^"_VI S:VI'=VE OUT(I)=OUT(I)_"^"_VE
"RTN","MAGDRPC2",46,0)
 . Q
"RTN","MAGDRPC2",47,0)
 ;
"RTN","MAGDRPC2",48,0)
 D FILEFIND^MAGDFB(D0,"FULL",0,0,.X,.V)
"RTN","MAGDRPC2",49,0)
 S:X'<0 I=I+1,OUT(I)="Full FileName^"_X
"RTN","MAGDRPC2",50,0)
 S:V'<0 I=I+1,OUT(I)="Full Path+FileName^"_V
"RTN","MAGDRPC2",51,0)
 ;
"RTN","MAGDRPC2",52,0)
 D FILEFIND^MAGDFB(D0,"BIG",0,0,.X,.V)
"RTN","MAGDRPC2",53,0)
 S:X'<0 I=I+1,OUT(I)="Big FileName^"_X
"RTN","MAGDRPC2",54,0)
 S:V'<0 I=I+1,OUT(I)="Big Path+FileName^"_V
"RTN","MAGDRPC2",55,0)
 ;
"RTN","MAGDRPC2",56,0)
 D FILEFIND^MAGDFB(D0,"ABSTRACT",0,0,.X,.V)
"RTN","MAGDRPC2",57,0)
 S:X'<0 I=I+1,OUT(I)="Abstract FileName^"_X
"RTN","MAGDRPC2",58,0)
 S:V'<0 I=I+1,OUT(I)="Abstract Path+FileName^"_V
"RTN","MAGDRPC2",59,0)
 ;
"RTN","MAGDRPC2",60,0)
 S (V,X)=0 F  S X=$O(^MAG(2005,D0,1,X)) Q:'X  S V=V+1
"RTN","MAGDRPC2",61,0)
 S:V I=I+1,OUT(I)="# Images^"_V
"RTN","MAGDRPC2",62,0)
 ;
"RTN","MAGDRPC2",63,0)
 S OUT(1)=I-1
"RTN","MAGDRPC2",64,0)
 Q
"RTN","MAGDRPC2",65,0)
 ;
"RTN","MAGDRPC2",66,0)
GRPIMG(OUT,D0) ; RPC = MAG DICOM GET IMAGE GROUP
"RTN","MAGDRPC2",67,0)
 N I,D1,X
"RTN","MAGDRPC2",68,0)
 D CHK^MAGGSQI(.OUT,D0) I +$G(OUT(0))'=1 Q  ; patient safety
"RTN","MAGDRPC2",69,0)
 K OUT S I=1
"RTN","MAGDRPC2",70,0)
 S D1=0 F  S D1=$O(^MAG(2005,D0,1,D1)) Q:'D1  D
"RTN","MAGDRPC2",71,0)
 . S X=$P($G(^MAG(2005,D0,1,D1,0)),"^",1) Q:'X
"RTN","MAGDRPC2",72,0)
 . S I=I+1,OUT(I)=X
"RTN","MAGDRPC2",73,0)
 . Q
"RTN","MAGDRPC2",74,0)
 S OUT(1)=I-1
"RTN","MAGDRPC2",75,0)
 Q
"RTN","MAGDRPC2",76,0)
 ;
"RTN","MAGDRPC2",77,0)
DECRYP(X) Q $S(X="":"",1:$$DECRYP^ROUTINE(X))
"RTN","MAGDRPC2",78,0)
 ;
"RTN","MAGDRPC2",79,0)
IMGVER(OUT) ; RPC = MAG DICOM GET VERSION
"RTN","MAGDRPC2",80,0)
 N D0,DATINS,FME,FML,I,L,N,P,PATCH,X
"RTN","MAGDRPC2",81,0)
 D FIND^DIC(9.7,"",".01;2I;51I","QU","MAG*3.0","*","B","","","FML","FME")
"RTN","MAGDRPC2",82,0)
 S I="" F  S I=$O(FML("DILIST","ID",I)) Q:I=""  D
"RTN","MAGDRPC2",83,0)
 . S N=$G(FML("DILIST","ID",I,.01)) Q:$P(N,"*",2)'="3.0"
"RTN","MAGDRPC2",84,0)
 . S PATCH=$P(N,"*",3) Q:'PATCH
"RTN","MAGDRPC2",85,0)
 . S PATCH(PATCH)=1
"RTN","MAGDRPC2",86,0)
 . S DATINS=$G(FML("DILIST","ID",I,2)) Q:DATINS=""
"RTN","MAGDRPC2",87,0)
 . S P=$G(FML("DILIST","ID",I,51)) Q:P=""
"RTN","MAGDRPC2",88,0)
 . S L(DATINS,PATCH_"-"_P)=""
"RTN","MAGDRPC2",89,0)
 . Q
"RTN","MAGDRPC2",90,0)
 ;
"RTN","MAGDRPC2",91,0)
 S (DATINS,L,OUT)="" F  S DATINS=$O(L(DATINS),-1) Q:DATINS=""  D
"RTN","MAGDRPC2",92,0)
 . S PATCH="" F  S PATCH=$O(L(DATINS,PATCH)) Q:PATCH=""  D
"RTN","MAGDRPC2",93,0)
 . . S:OUT="" OUT=PATCH
"RTN","MAGDRPC2",94,0)
 . . S:$G(PATCH(+PATCH)) PATCH(+PATCH)=0,L=(+PATCH)_","_L
"RTN","MAGDRPC2",95,0)
 . . Q
"RTN","MAGDRPC2",96,0)
 . Q
"RTN","MAGDRPC2",97,0)
 S OUT=L_OUT
"RTN","MAGDRPC2",98,0)
 Q
"RTN","MAGDRPC2",99,0)
 ;
"RTN","MAGDRPC2",100,0)
PLACE(LOCATION) N D0,FST,LST
"RTN","MAGDRPC2",101,0)
 S FST=+$O(^MAG(2006.1,0)),LST=+$O(^MAG(2006.1," "),-1) Q:LST=FST FST
"RTN","MAGDRPC2",102,0)
 S D0=$O(^MAG(2006.1,"B",+$G(LOCATION),"")) Q:D0 D0
"RTN","MAGDRPC2",103,0)
 Q FST
"RTN","MAGDRPC2",104,0)
 ;
"RTN","MAGDRPC2",105,0)
ROUTEDAY ; Scan for Routing Activity
"RTN","MAGDRPC2",106,0)
 N BUCKET ;- Daily tallies
"RTN","MAGDRPC2",107,0)
 N D0 ;----- Image pointer for child of current parent
"RTN","MAGDRPC2",108,0)
 N D1 ;----- Pointer to multiple in image file
"RTN","MAGDRPC2",109,0)
 N D4 ;----- Loop counter
"RTN","MAGDRPC2",110,0)
 N DAY ;---- Current FileMan date
"RTN","MAGDRPC2",111,0)
 N DAYTIM ;- Current FileMan timestamp
"RTN","MAGDRPC2",112,0)
 N DEST ;--- Destination
"RTN","MAGDRPC2",113,0)
 N FIRST ;-- First date for scan
"RTN","MAGDRPC2",114,0)
 N FSTX ;--- First transmission for current study
"RTN","MAGDRPC2",115,0)
 N %H ;----- $Horolog timestamp
"RTN","MAGDRPC2",116,0)
 N IMAGE ;-- Image Pointer for current image
"RTN","MAGDRPC2",117,0)
 N LAST ;--- Last date for scan
"RTN","MAGDRPC2",118,0)
 N LSTQ ;--- Timestamp for last queue entry in current study
"RTN","MAGDRPC2",119,0)
 N P3 ;----- Highest IEN in statistics file
"RTN","MAGDRPC2",120,0)
 N P4 ;----- Number of entries in statistics file
"RTN","MAGDRPC2",121,0)
 N PARENT ;- Image Pointer for parent of current image
"RTN","MAGDRPC2",122,0)
 N R ;------ Retention Period
"RTN","MAGDRPC2",123,0)
 N X ;------ Scratch
"RTN","MAGDRPC2",124,0)
 N XMIT ;--- Total duration of transmissions for current study
"RTN","MAGDRPC2",125,0)
 ;
"RTN","MAGDRPC2",126,0)
 K ^TMP("MAG",$J,"RTD1")
"RTN","MAGDRPC2",127,0)
 K ^TMP("MAG",$J,"RTD2")
"RTN","MAGDRPC2",128,0)
 K ^TMP("MAG",$J,"RTD3")
"RTN","MAGDRPC2",129,0)
 S %H=$H-4 D YMD^%DTC S FIRST=X
"RTN","MAGDRPC2",130,0)
 S %H=$H+2 D YMD^%DTC S LAST=X
"RTN","MAGDRPC2",131,0)
 ;
"RTN","MAGDRPC2",132,0)
 S DEST="" F  S DEST=$O(^MAG(2005,"ROUTE",DEST)) Q:DEST=""  D
"RTN","MAGDRPC2",133,0)
 . S NAME(DEST)=$P($G(^MAG(2005.2,DEST,0)," ? "_DEST),"^",1)
"RTN","MAGDRPC2",134,0)
 . S DAYTIM=FIRST F  D  S DAYTIM=$O(^MAG(2005,"ROUTE",DEST,DAYTIM)) Q:DAYTIM=""  Q:DAYTIM'<LAST
"RTN","MAGDRPC2",135,0)
 . . S DAY=DAYTIM\1
"RTN","MAGDRPC2",136,0)
 . . S IMAGE="" F  S IMAGE=$O(^MAG(2005,"ROUTE",DEST,DAYTIM,IMAGE)) Q:IMAGE=""  D
"RTN","MAGDRPC2",137,0)
 . . . S PARENT=$P($G(^MAG(2005,IMAGE,0)),"^",10)
"RTN","MAGDRPC2",138,0)
 . . . I PARENT,$G(^TMP("MAG",$J,"RTD3",PARENT)) S PARENT=0
"RTN","MAGDRPC2",139,0)
 . . . S:PARENT ^TMP("MAG",$J,"RTD3",PARENT)=1
"RTN","MAGDRPC2",140,0)
 . . . S (XMIT,LSTQ)=0,FSTX=1E9
"RTN","MAGDRPC2",141,0)
 . . . S D0=IMAGE,D1=0 D  I PARENT F  S D1=$O(^MAG(2005,PARENT,1,D1)) Q:'D1  S D0=+$P($G(^MAG(2005,PARENT,1,D1,0)),"^",1) D
"RTN","MAGDRPC2",142,0)
 . . . . Q:'D0
"RTN","MAGDRPC2",143,0)
 . . . . Q:$D(^TMP("MAG",$J,"RTD1",D0,D1))
"RTN","MAGDRPC2",144,0)
 . . . . S ^TMP("MAG",$J,"RTD1",D0,D1)=""
"RTN","MAGDRPC2",145,0)
 . . . . S D4=0 F  S D4=$O(^MAG(2005,D0,4,D4)) Q:'D4  D
"RTN","MAGDRPC2",146,0)
 . . . . . S X=$G(^MAG(2005,D0,4,D4,0))
"RTN","MAGDRPC2",147,0)
 . . . . . Q:$P($P(X,"^",1),".",1)'=DAY
"RTN","MAGDRPC2",148,0)
 . . . . . Q:$P(X,"^",2)'=DEST
"RTN","MAGDRPC2",149,0)
 . . . . . S:$P(X,"^",6)>LSTQ LSTQ=$P(X,"^",6)
"RTN","MAGDRPC2",150,0)
 . . . . . S:$P(X,"^",5)<FSTX FSTX=$P(X,"^",5)
"RTN","MAGDRPC2",151,0)
 . . . . . S XMIT=XMIT+$$DELTA($P(X,"^",5),$P(X,"^",1))
"RTN","MAGDRPC2",152,0)
 . . . . . Q
"RTN","MAGDRPC2",153,0)
 . . . . Q
"RTN","MAGDRPC2",154,0)
 . . . S X=$$DELTA(LSTQ,FSTX)
"RTN","MAGDRPC2",155,0)
 . . . S:X>$G(BUCKET(DAY,DEST,1)) BUCKET(DAY,DEST,1)=X
"RTN","MAGDRPC2",156,0)
 . . . S X=$S(X<300:1,X<900:2,X<3600:3,1:4)
"RTN","MAGDRPC2",157,0)
 . . . S BUCKET(DAY,DEST,1,X)=$G(BUCKET(DAY,DEST,1,X))+1
"RTN","MAGDRPC2",158,0)
 . . . S:XMIT>$G(BUCKET(DAY,DEST,2)) BUCKET(DAY,DEST,2)=XMIT
"RTN","MAGDRPC2",159,0)
 . . . S X=$S(XMIT<300:1,XMIT<900:2,XMIT<3600:3,1:4)
"RTN","MAGDRPC2",160,0)
 . . . S BUCKET(DAY,DEST,2,X)=$G(BUCKET(DAY,DEST,2,X))+1
"RTN","MAGDRPC2",161,0)
 . . . Q
"RTN","MAGDRPC2",162,0)
 . . Q
"RTN","MAGDRPC2",163,0)
 . Q
"RTN","MAGDRPC2",164,0)
 ;
"RTN","MAGDRPC2",165,0)
 S X=$G(^TMP("MAG",$J,"RTD2",0)),P3=+$P(X,"^",3),P4=+$P(X,"^",4)
"RTN","MAGDRPC2",166,0)
 S DAY="" F  S DAY=$O(BUCKET(DAY)) Q:DAY=""  D
"RTN","MAGDRPC2",167,0)
 . S:'$D(^TMP("MAG",$J,"RTD2",DAY)) P4=P4+1,^TMP("MAG",$J,"RTD2",DAY,0)=DAY
"RTN","MAGDRPC2",168,0)
 . S D1=0,DEST="" F  S DEST=$O(BUCKET(DAY,DEST)) Q:DEST=""  D
"RTN","MAGDRPC2",169,0)
 . . S D1=D1+1
"RTN","MAGDRPC2",170,0)
 . . S X=$G(BUCKET(DAY,DEST,2,1))       ; Less than 5 minutes
"RTN","MAGDRPC2",171,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,2,2)) ; Less than 15 minutes
"RTN","MAGDRPC2",172,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,2,3)) ; Less than 1 hour
"RTN","MAGDRPC2",173,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,2,4)) ; 1 hour or more
"RTN","MAGDRPC2",174,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,2))   ; Longest
"RTN","MAGDRPC2",175,0)
 . . S X=X_"^Duration ("_NAME(DEST)_")"
"RTN","MAGDRPC2",176,0)
 . . S ^TMP("MAG",$J,"RTD2",DAY,1,D1,0)=X
"RTN","MAGDRPC2",177,0)
 . . S D1=D1+1
"RTN","MAGDRPC2",178,0)
 . . S X=$G(BUCKET(DAY,DEST,1,1))       ; Less than 5 minutes
"RTN","MAGDRPC2",179,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,1,2)) ; Less than 15 minutes
"RTN","MAGDRPC2",180,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,1,3)) ; Less than 1 hour
"RTN","MAGDRPC2",181,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,1,4)) ; 1 hour or more
"RTN","MAGDRPC2",182,0)
 . . S X=X_"^"_$G(BUCKET(DAY,DEST,1))   ; Longest
"RTN","MAGDRPC2",183,0)
 . . S X=X_"^Lag ("_NAME(DEST)_")"
"RTN","MAGDRPC2",184,0)
 . . S ^TMP("MAG",$J,"RTD2",DAY,1,D1,0)=X
"RTN","MAGDRPC2",185,0)
 . . Q
"RTN","MAGDRPC2",186,0)
 . S:DAY>P3 P3=DAY
"RTN","MAGDRPC2",187,0)
 . Q
"RTN","MAGDRPC2",188,0)
 ; Purge old entries
"RTN","MAGDRPC2",189,0)
 S R=$G(^MAGDICOM(2006.563,1,"RETAIN ROUTING STATISTICS")) S:R<1 R=30
"RTN","MAGDRPC2",190,0)
 S %H=$H-R D YMD^%DTC S DAY=X
"RTN","MAGDRPC2",191,0)
 S D0=0 F  S D0=$O(^TMP("MAG",$J,"RTD2",D0)) Q:'D0  Q:D0'<DAY  D
"RTN","MAGDRPC2",192,0)
 . K ^TMP("MAG",$J,"RTD2",D0) S P4=P4-1
"RTN","MAGDRPC2",193,0)
 . Q
"RTN","MAGDRPC2",194,0)
 ;
"RTN","MAGDRPC2",195,0)
 D  ; Get routing statistics
"RTN","MAGDRPC2",196,0)
 . N A,W
"RTN","MAGDRPC2",197,0)
 . S (A,DAY)=0 F  S DAY=$O(^TMP("MAG",$J,"RTD2",DAY)) Q:'DAY  D
"RTN","MAGDRPC2",198,0)
 . . S:'A N=N+1,OUT(N)="Route",A=1
"RTN","MAGDRPC2",199,0)
 . . S N=N+1,OUT(N)="RDT="_DAY
"RTN","MAGDRPC2",200,0)
 . . S W=0 F  S W=$O(^TMP("MAG",$J,"RTD2",DAY,1,W)) Q:'W  D
"RTN","MAGDRPC2",201,0)
 . . . S X=$G(^TMP("MAG",$J,"RTD2",DAY,1,W,0))
"RTN","MAGDRPC2",202,0)
 . . . S N=N+1,OUT(N)="DST="_$P($P($P(X,"^",6),"(",2),")",1)
"RTN","MAGDRPC2",203,0)
 . . . S W=W+1,$P(X,"^",6,10)=$P($G(^TMP("MAG",$J,"RTD2",DAY,1,W,0)),"^",1,5)
"RTN","MAGDRPC2",204,0)
 . . . S N=N+1,OUT(N)="RST="_X
"RTN","MAGDRPC2",205,0)
 . . . Q
"RTN","MAGDRPC2",206,0)
 . . Q
"RTN","MAGDRPC2",207,0)
 . S:A N=N+1,OUT(N)="RouteEnd"
"RTN","MAGDRPC2",208,0)
 . Q
"RTN","MAGDRPC2",209,0)
 K ^TMP("MAG",$J,"RTD1")
"RTN","MAGDRPC2",210,0)
 K ^TMP("MAG",$J,"RTD2")
"RTN","MAGDRPC2",211,0)
 K ^TMP("MAG",$J,"RTD3")
"RTN","MAGDRPC2",212,0)
 Q
"RTN","MAGDRPC2",213,0)
 ;
"RTN","MAGDRPC2",214,0)
DELTA(START,STOP) N D,D1,D2,T1,T2
"RTN","MAGDRPC2",215,0)
 S D1=$P(START,".",1),D2=$P(STOP,".",1)
"RTN","MAGDRPC2",216,0)
 S T1=START*1E6#1E6,T2=STOP*1E6#1E6
"RTN","MAGDRPC2",217,0)
 S T1=T1\10000*60+(T1\100#100)*60+(T1#100)
"RTN","MAGDRPC2",218,0)
 S T2=T2\10000*60+(T2\100#100)*60+(T2#100)
"RTN","MAGDRPC2",219,0)
 S D=0 D:D1'=D2
"RTN","MAGDRPC2",220,0)
 . N %H,%T,%Y,X
"RTN","MAGDRPC2",221,0)
 . S X=D1 D H^%DTC S D1=%H
"RTN","MAGDRPC2",222,0)
 . S X=D2 D H^%DTC S D2=%H
"RTN","MAGDRPC2",223,0)
 . S D=D2-D1
"RTN","MAGDRPC2",224,0)
 . Q
"RTN","MAGDRPC2",225,0)
 Q D*86400+T2-T1
"RTN","MAGDRPC2",226,0)
 ;
"RTN","MAGDRPC3")
0^8^B62468863
"RTN","MAGDRPC3",1,0)
MAGDRPC3 ;WOIFO/EdM - Imaging RPCs ; 13 Feb 2006  1:30 PM
"RTN","MAGDRPC3",2,0)
 ;;3.0;IMAGING;**11,30,51,50**;26-May-2006
"RTN","MAGDRPC3",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC3",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDRPC3",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDRPC3",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDRPC3",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDRPC3",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDRPC3",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDRPC3",10,0)
 ;; |                                                               |
"RTN","MAGDRPC3",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDRPC3",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDRPC3",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDRPC3",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDRPC3",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDRPC3",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC3",17,0)
 ;;
"RTN","MAGDRPC3",18,0)
 Q
"RTN","MAGDRPC3",19,0)
 ;
"RTN","MAGDRPC3",20,0)
RADLKUP(OUT,CASENUMB,STUDYDAT) ; RPC = MAG DICOM LOOKUP RAD STUDY
"RTN","MAGDRPC3",21,0)
 ; Radiology patient/study lookup
"RTN","MAGDRPC3",22,0)
 N ACCNUM ;--- Accession Number
"RTN","MAGDRPC3",23,0)
 N CPTCODE ;-- CPT code for the procedure
"RTN","MAGDRPC3",24,0)
 N CPTNAME ;-- CPT name for the procedure
"RTN","MAGDRPC3",25,0)
 N DATETIME ;- Timestamp
"RTN","MAGDRPC3",26,0)
 N EXAMSTS ;-- Exam status (don't post images to CANCELLED exams)
"RTN","MAGDRPC3",27,0)
 N PROCDESC ;- Procedure description
"RTN","MAGDRPC3",28,0)
 N PROCIEN ;-- radiology procedure ien in ^RAMIS(71)
"RTN","MAGDRPC3",29,0)
 N RAIX ;----- cross reference subscript for case number lookup
"RTN","MAGDRPC3",30,0)
 N RADPT1 ;--- first level subscript in ^RADPT
"RTN","MAGDRPC3",31,0)
 N RADPT2 ;--- second level subscript in ^RADPT (after "DT")
"RTN","MAGDRPC3",32,0)
 N RADPT3 ;--- third level subscript in ^RADPT (after "P")
"RTN","MAGDRPC3",33,0)
 N D1,I,LIST,X,Z
"RTN","MAGDRPC3",34,0)
 ;
"RTN","MAGDRPC3",35,0)
 ; find the patient/study in ^RADPT using the Radiology Case Number
"RTN","MAGDRPC3",36,0)
 K OUT
"RTN","MAGDRPC3",37,0)
 D
"RTN","MAGDRPC3",38,0)
 . I $G(CASENUMB)="" S OUT(1)="-1,No Case Number Specified" Q
"RTN","MAGDRPC3",39,0)
 . S RAIX=$S($D(^RADPT("C")):"C",1:"AE") ; for Radiology Patch RA*5*7
"RTN","MAGDRPC3",40,0)
 . S RAIX=$S(CASENUMB["-":"ADC",1:RAIX) ; select the cross-reference
"RTN","MAGDRPC3",41,0)
 . S RADPT1=$O(^RADPT(RAIX,CASENUMB,"")) I 'RADPT1 D  Q:'RADPT1
"RTN","MAGDRPC3",42,0)
 . . I '$G(STUDYDAT) S OUT(1)="-2,No Study Date Specified",RADPT1=0 Q
"RTN","MAGDRPC3",43,0)
 . . ;
"RTN","MAGDRPC3",44,0)
 . . ; Search 1-3 days prior the study date OR a day in advance but only
"RTN","MAGDRPC3",45,0)
 . . ; if the study date is not equal to today or greater than today.
"RTN","MAGDRPC3",46,0)
 . . ; Has to be long case number or must have an image study date
"RTN","MAGDRPC3",47,0)
 . . ;
"RTN","MAGDRPC3",48,0)
 . . N II,RCASE,SDATE,TODAY,X,Y,%,%I
"RTN","MAGDRPC3",49,0)
 . . ;
"RTN","MAGDRPC3",50,0)
 . . S RCASE=$S(CASENUMB["-":$P(CASENUMB,"-",2),1:CASENUMB)
"RTN","MAGDRPC3",51,0)
 . . I 'RCASE S RADPT1=0 Q
"RTN","MAGDRPC3",52,0)
 . . ;
"RTN","MAGDRPC3",53,0)
 . . D NOW^%DTC S TODAY=X
"RTN","MAGDRPC3",54,0)
 . . S X=$P(STUDYDAT,"."),SDATE=$E(X,1,4)-1700_$E(X,5,8) ; FileMan date
"RTN","MAGDRPC3",55,0)
 . . ;
"RTN","MAGDRPC3",56,0)
 . . ; 1-3 days prior study date
"RTN","MAGDRPC3",57,0)
 . . F II=1:1:3 S RADPT1=$$FIND(SDATE,RCASE,-II) Q:RADPT1
"RTN","MAGDRPC3",58,0)
 . . Q:RADPT1
"RTN","MAGDRPC3",59,0)
 . . ;
"RTN","MAGDRPC3",60,0)
 . . ; Wild goose chase, but check for today's case
"RTN","MAGDRPC3",61,0)
 . . S RADPT1=$O(^RADPT("ADC",$$MMDDYY(TODAY)_"-"_RCASE,"")) Q:RADPT1
"RTN","MAGDRPC3",62,0)
 . . ;
"RTN","MAGDRPC3",63,0)
 . . I SDATE'<TODAY S RADPT1=0 Q
"RTN","MAGDRPC3",64,0)
 . . ;
"RTN","MAGDRPC3",65,0)
 . . ; One day in advance?
"RTN","MAGDRPC3",66,0)
 . . S RADPT1=$$FIND(SDATE,RCASE,1) Q:RADPT1
"RTN","MAGDRPC3",67,0)
 . . ;
"RTN","MAGDRPC3",68,0)
 . . ; Finally just check the "C" or "AE" x-reference for the case number
"RTN","MAGDRPC3",69,0)
 . . S X=$S($O(^RADPT("C","")):"C",1:"AE") ; RA*5*7 patch
"RTN","MAGDRPC3",70,0)
 . . S RADPT1=$O(^RADPT(X,RCASE,""))
"RTN","MAGDRPC3",71,0)
 . . Q
"RTN","MAGDRPC3",72,0)
 . S RADPT2=$O(^RADPT(RAIX,CASENUMB,RADPT1,"")) Q:'RADPT2
"RTN","MAGDRPC3",73,0)
 . S RADPT3=$O(^RADPT(RAIX,CASENUMB,RADPT1,RADPT2,"")) Q:'RADPT3
"RTN","MAGDRPC3",74,0)
 . Q:'$D(^RADPT(RADPT1,0))  ; no patient demographics file pointer
"RTN","MAGDRPC3",75,0)
 . ; get patient demographics file pointer
"RTN","MAGDRPC3",76,0)
 . S DFN=$P(^RADPT(RADPT1,0),"^",1)
"RTN","MAGDRPC3",77,0)
 . Q:'$D(^RADPT(RADPT1,"DT",RADPT2,0))  ; no datetime level
"RTN","MAGDRPC3",78,0)
 . ; get date and time of examination
"RTN","MAGDRPC3",79,0)
 . S DATETIME=$P($G(^RADPT(RADPT1,"DT",RADPT2,0)),"^",1)
"RTN","MAGDRPC3",80,0)
 . ; get case info
"RTN","MAGDRPC3",81,0)
 . S X=$G(^RADPT(RADPT1,"DT",RADPT2,"P",RADPT3,0))
"RTN","MAGDRPC3",82,0)
 . S Z=$P(X,"^",17) I Z S Z=$P($G(^RARPT(Z,0)),"^",1) S:Z'="" ACCNUM=Z
"RTN","MAGDRPC3",83,0)
 . S PROCIEN=$P(X,"^",2),EXAMSTS=$P(X,"^",3)
"RTN","MAGDRPC3",84,0)
 . S:EXAMSTS EXAMSTS=$$GET1^DIQ(72,EXAMSTS,.01)
"RTN","MAGDRPC3",85,0)
 . S (PROCDESC,CPTNAME,CPTCODE)=""
"RTN","MAGDRPC3",86,0)
 . Q:'PROCIEN  ; need PROCIEN to do lookup in ^RAMIS
"RTN","MAGDRPC3",87,0)
 . S Z=$G(^RAMIS(71,PROCIEN,0))
"RTN","MAGDRPC3",88,0)
 . S PROCDESC=$P(Z,"^",1),CPTCODE=$P(Z,"^",9)
"RTN","MAGDRPC3",89,0)
 . S CPTNAME=$P($$CPT^ICPTCOD(+CPTCODE),"^",3) ; IA 1995
"RTN","MAGDRPC3",90,0)
 . S:CPTNAME="" CPTNAME=PROCDESC
"RTN","MAGDRPC3",91,0)
 . Q
"RTN","MAGDRPC3",92,0)
 S OUT(2)=$G(RADPT1)
"RTN","MAGDRPC3",93,0)
 S OUT(3)=$G(RADPT2)
"RTN","MAGDRPC3",94,0)
 S OUT(4)=$G(RADPT3)
"RTN","MAGDRPC3",95,0)
 S OUT(5)=$G(PROCIEN)
"RTN","MAGDRPC3",96,0)
 S OUT(6)=$G(CPTCODE)
"RTN","MAGDRPC3",97,0)
 S OUT(7)=$G(CPTNAME)
"RTN","MAGDRPC3",98,0)
 S OUT(8)=$G(Z)
"RTN","MAGDRPC3",99,0)
 S OUT(9)=$G(EXAMSTS)
"RTN","MAGDRPC3",100,0)
 S OUT(10)=$G(DFN)
"RTN","MAGDRPC3",101,0)
 S OUT(11)=$G(DATETIME)
"RTN","MAGDRPC3",102,0)
 S OUT(12)=$G(PROCDESC)
"RTN","MAGDRPC3",103,0)
 S X=""
"RTN","MAGDRPC3",104,0)
 I $G(PROCIEN) S D1=0 F  S D1=$O(^RAMIS(71,PROCIEN,"MDL",D1)) Q:'D1  D
"RTN","MAGDRPC3",105,0)
 . S Z=+$P($G(^RAMIS(71,PROCIEN,"MDL",D1,0)),"^",1) Q:'Z
"RTN","MAGDRPC3",106,0)
 . S Z=$P($G(^RAMIS(73.1,Z,0)),"^",1) Q:Z=""
"RTN","MAGDRPC3",107,0)
 . S:X'="" X=X_"," S X=X_Z
"RTN","MAGDRPC3",108,0)
 . Q
"RTN","MAGDRPC3",109,0)
 S OUT(13)=X ; List of Modality-codes
"RTN","MAGDRPC3",110,0)
 S X="" I $G(RADPT1),$G(RADPT2) S X=$G(^RADPT(RADPT1,"DT",RADPT2,0))
"RTN","MAGDRPC3",111,0)
 S OUT(14)=$P(X,"^",3) ; Site
"RTN","MAGDRPC3",112,0)
 ; Patient's pregnancy status at the time of the exam
"RTN","MAGDRPC3",113,0)
 S X="" I $G(DFN),$G(RADPT2),$G(RADPT3) S X=$G(^RADPT(DFN,"DT",RADPT2,"P",RADPT3,0))
"RTN","MAGDRPC3",114,0)
 S OUT(15)=$P($G(^RAO(75.1,+$P(X,"^",11),0)),"^",13)
"RTN","MAGDRPC3",115,0)
 S OUT(16)=$G(ACCNUM)
"RTN","MAGDRPC3",116,0)
 S OUT(1)=1 ; OK
"RTN","MAGDRPC3",117,0)
 Q
"RTN","MAGDRPC3",118,0)
 ;
"RTN","MAGDRPC3",119,0)
QUEUE(OUT,IMAGE,APPNAM,LOCATION,ACCNUM,REASON,EMAIL,PRIOR,JBTOHD) ; RPC = MAG DICOM QUEUE IMAGE
"RTN","MAGDRPC3",120,0)
 ; Add the DICOM study send image request to the queue
"RTN","MAGDRPC3",121,0)
 N COUNT,D0,D1,DFN,LOG,OK,PROBLEM,TYPE,X
"RTN","MAGDRPC3",122,0)
 ;
"RTN","MAGDRPC3",123,0)
 I '$G(IMAGE) S OUT="-1,No Image specified" Q
"RTN","MAGDRPC3",124,0)
 I $G(APPNAM)="" S OUT="-2,No Destination specified" Q
"RTN","MAGDRPC3",125,0)
 I '$G(LOCATION) S OUT="-3,No Origin specified" Q
"RTN","MAGDRPC3",126,0)
 S PRIOR=+$G(PRIOR) S:'PRIOR PRIOR=500
"RTN","MAGDRPC3",127,0)
 S JBTOHD=$S($G(JBTOHD):1,1:0)
"RTN","MAGDRPC3",128,0)
 ;
"RTN","MAGDRPC3",129,0)
 S X=$G(^MAG(2005,IMAGE,0))
"RTN","MAGDRPC3",130,0)
 S TYPE=+$P(X,"^",6),DFN=$P(X,"^",7)
"RTN","MAGDRPC3",131,0)
 I " 0 11 3 100 "'[(" "_TYPE_" ") D  Q
"RTN","MAGDRPC3",132,0)
 . S OUT="-4,Cannot Queue Image Object Type """_TYPE_"""."
"RTN","MAGDRPC3",133,0)
 . Q
"RTN","MAGDRPC3",134,0)
 ;
"RTN","MAGDRPC3",135,0)
 L +^MAGDOUTP(2006.574,0):1E9 ; Background process MUST wait
"RTN","MAGDRPC3",136,0)
 S P=$P($G(^MAG(2005,IMAGE,0)),"^",10),P=$S(P:P,1:IMAGE)
"RTN","MAGDRPC3",137,0)
 S STUID=$P($G(^MAG(2005,P,"PACS")),"^",1) S:STUID="" STUID="?"
"RTN","MAGDRPC3",138,0)
 S OK=0,D0="" F  S D0=$O(^MAGDOUTP(2006.574,"STUDY",STUID,D0)) Q:'D0  D  Q:OK
"RTN","MAGDRPC3",139,0)
 . Q:'$D(^MAGDOUTP(2006.574,"STS",LOCATION,PRIOR,"WAITING",D0))
"RTN","MAGDRPC3",140,0)
 . Q:$P($G(^MAGDOUTP(2006.574,D0,0)),"^",1)'=APPNAM
"RTN","MAGDRPC3",141,0)
 . S OK=D0
"RTN","MAGDRPC3",142,0)
 . Q
"RTN","MAGDRPC3",143,0)
 S D0=OK D:'D0
"RTN","MAGDRPC3",144,0)
 . S X=$G(^MAGDOUTP(2006.574,0))
"RTN","MAGDRPC3",145,0)
 . S $P(X,"^",1,2)="DICOM IMAGE OUTPUT FILE^2006.574"
"RTN","MAGDRPC3",146,0)
 . S D0=$O(^MAGDOUTP(2006.574," "),-1)+1 ; Next number
"RTN","MAGDRPC3",147,0)
 . S $P(X,"^",3)=D0
"RTN","MAGDRPC3",148,0)
 . S $P(X,"^",4)=$P(X,"^",4)+1 ; Total count
"RTN","MAGDRPC3",149,0)
 . S ^MAGDOUTP(2006.574,0)=X
"RTN","MAGDRPC3",150,0)
 . ;
"RTN","MAGDRPC3",151,0)
 . S ^MAGDOUTP(2006.574,D0,0)=APPNAM_"^"_P_"^"_$G(ACCNUM)_"^"_LOCATION_"^"_PRIOR_"^"_JBTOHD
"RTN","MAGDRPC3",152,0)
 . S ^MAGDOUTP(2006.574,D0,2)=STUID
"RTN","MAGDRPC3",153,0)
 . S ^MAGDOUTP(2006.574,"STUDY",STUID,D0)=""
"RTN","MAGDRPC3",154,0)
 . Q
"RTN","MAGDRPC3",155,0)
 L -^MAGDOUTP(2006.574,0)
"RTN","MAGDRPC3",156,0)
 ;
"RTN","MAGDRPC3",157,0)
 S COUNT=0,PROBLEM=3
"RTN","MAGDRPC3",158,0)
 I (TYPE=3)!(TYPE=100) D  ; Single XRAY or DICOM image
"RTN","MAGDRPC3",159,0)
 . S COUNT=COUNT+$$ENQUEUE(IMAGE,D0,PRIOR)
"RTN","MAGDRPC3",160,0)
 . Q
"RTN","MAGDRPC3",161,0)
 I TYPE=11 D  ; Process all the images in an XRAY group
"RTN","MAGDRPC3",162,0)
 . S D1=0 F  S D1=$O(^MAG(2005,IMAGE,1,D1)) Q:'D1  D
"RTN","MAGDRPC3",163,0)
 . . S COUNT=COUNT+$$ENQUEUE($P($G(^MAG(2005,IMAGE,1,D1,0)),"^",1),D0,PRIOR)
"RTN","MAGDRPC3",164,0)
 . . Q
"RTN","MAGDRPC3",165,0)
 . Q
"RTN","MAGDRPC3",166,0)
 ;
"RTN","MAGDRPC3",167,0)
 S LOG="DICOM transmit to "_APPNAM_" for reason "_REASON
"RTN","MAGDRPC3",168,0)
 D:COUNT ENTRY^MAGLOG($C(REASON+64),DUZ,IMAGE,"DICOM Gateway",DFN,COUNT,LOG)
"RTN","MAGDRPC3",169,0)
 D:PROBLEM>3
"RTN","MAGDRPC3",170,0)
 . N XMERR,XMID,XMSUB,XMY
"RTN","MAGDRPC3",171,0)
 . S PROBLEM(1)="Error while queueing image for Transmission:"
"RTN","MAGDRPC3",172,0)
 . S PROBLEM(2)=LOG
"RTN","MAGDRPC3",173,0)
 . S PROBLEM(3)=" "
"RTN","MAGDRPC3",174,0)
 . ; --- send MailMan message...
"RTN","MAGDRPC3",175,0)
 . S XMID=$G(DUZ) S:'XMID XMID=.5
"RTN","MAGDRPC3",176,0)
 . S XMY(XMID)=""
"RTN","MAGDRPC3",177,0)
 . S:$G(EMAIL)'="" XMY(EMAIL)=""
"RTN","MAGDRPC3",178,0)
 . S XMSUB=$E("Cannot transmit image(s) to "_APPNAM,1,63)
"RTN","MAGDRPC3",179,0)
 . D SENDMSG^XMXAPI(XMID,XMSUB,"PROBLEM",.XMY,,.XMZ,)
"RTN","MAGDRPC3",180,0)
 . Q:'$G(XMERR)
"RTN","MAGDRPC3",181,0)
 . M XMERR=^TMP("XMERR",$J) S $EC=",U13-Cannot send MailMan message,"
"RTN","MAGDRPC3",182,0)
 . Q
"RTN","MAGDRPC3",183,0)
 S OUT=1
"RTN","MAGDRPC3",184,0)
 Q
"RTN","MAGDRPC3",185,0)
 ;
"RTN","MAGDRPC3",186,0)
ENQUEUE(IMAGE,D0,PRIOR) ; Add an image to the DICOM send image request queue sub-file
"RTN","MAGDRPC3",187,0)
 Q:'IMAGE 0
"RTN","MAGDRPC3",188,0)
 N D1,I,X
"RTN","MAGDRPC3",189,0)
 D CHK^MAGGSQI(.X,IMAGE) I +$G(X(0))'=1 D  Q 0
"RTN","MAGDRPC3",190,0)
 . S PROBLEM=PROBLEM+1,PROBLEM(PROBLEM)=" "
"RTN","MAGDRPC3",191,0)
 . S PROBLEM=PROBLEM+1,PROBLEM(PROBLEM)="Image # "_IMAGE_":"
"RTN","MAGDRPC3",192,0)
 . S I="" F  S I=$O(X(I)) Q:I=""  S PROBLEM=PROBLEM+1,PROBLEM(PROBLEM)=X(I)
"RTN","MAGDRPC3",193,0)
 . Q
"RTN","MAGDRPC3",194,0)
 ;
"RTN","MAGDRPC3",195,0)
 L +^MAGDOUTP(2006.574,D0,1,0):1E9 ; Background Process MUST wait
"RTN","MAGDRPC3",196,0)
 S X=$G(^MAGDOUTP(2006.574,D0,1,0))
"RTN","MAGDRPC3",197,0)
 S $P(X,"^",1,2)="^2006.5744"
"RTN","MAGDRPC3",198,0)
 S D1=$O(^MAGDOUTP(2006.574,D0,1," "),-1)+1,$P(X,"^",3)=D1
"RTN","MAGDRPC3",199,0)
 S $P(X,"^",4)=$P(X,"^",4)+1,OUT=$P(X,"^",4)
"RTN","MAGDRPC3",200,0)
 S ^MAGDOUTP(2006.574,D0,1,0)=X
"RTN","MAGDRPC3",201,0)
 S ^MAGDOUTP(2006.574,D0,1,D1,0)=IMAGE_"^WAITING^"_$H
"RTN","MAGDRPC3",202,0)
 S ^MAGDOUTP(2006.574,"STS",LOCATION,PRIOR,"WAITING",D0,D1)=""
"RTN","MAGDRPC3",203,0)
 L -^MAGDOUTP(2006.574,D0,1,0)
"RTN","MAGDRPC3",204,0)
 Q 1
"RTN","MAGDRPC3",205,0)
 ;
"RTN","MAGDRPC3",206,0)
FIND(DATE,CASE,NUM) ; ADC x-reference (Radiology patient file)
"RTN","MAGDRPC3",207,0)
 N X,X1,X2,Y
"RTN","MAGDRPC3",208,0)
 Q:'$G(DATE) 0
"RTN","MAGDRPC3",209,0)
 S (X,X1)=DATE,X2=NUM D:NUM C^%DTC Q:X<1 0
"RTN","MAGDRPC3",210,0)
 Q $O(^RADPT("ADC",$$MMDDYY(X)_"-"_CASE,""))
"RTN","MAGDRPC3",211,0)
 ;
"RTN","MAGDRPC3",212,0)
MMDDYY(DAY) ; YYYMMDD --> MMDDYY
"RTN","MAGDRPC3",213,0)
 I DAY'?7N Q 0
"RTN","MAGDRPC3",214,0)
 Q $E(DAY,4,7)_$E(DAY,2,3)
"RTN","MAGDRPC3",215,0)
 ;
"RTN","MAGDRPC4")
0^9^B74521195
"RTN","MAGDRPC4",1,0)
MAGDRPC4 ;WOIFO/EdM - Imaging RPCs ; 13 Feb 2006  1:42 PM
"RTN","MAGDRPC4",2,0)
 ;;3.0;IMAGING;**11,30,51,50**;26-May-2006
"RTN","MAGDRPC4",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC4",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDRPC4",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDRPC4",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDRPC4",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDRPC4",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDRPC4",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDRPC4",10,0)
 ;; |                                                               |
"RTN","MAGDRPC4",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDRPC4",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDRPC4",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDRPC4",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDRPC4",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDRPC4",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC4",17,0)
 ;;
"RTN","MAGDRPC4",18,0)
 Q
"RTN","MAGDRPC4",19,0)
 ;
"RTN","MAGDRPC4",20,0)
LOOKUP(OUT,NUMBER) ; RPC = MAG DICOM LOOKUP STUDY
"RTN","MAGDRPC4",21,0)
 ; Look Up for both Radiology and Consults
"RTN","MAGDRPC4",22,0)
 N ACCNUM ;--- Accession Number
"RTN","MAGDRPC4",23,0)
 N CPTCODE ;-- CPT code for the procedure
"RTN","MAGDRPC4",24,0)
 N CPTNAME ;-- CPT name for the procedure
"RTN","MAGDRPC4",25,0)
 N DFN ;------ Patient pointer
"RTN","MAGDRPC4",26,0)
 N EXAMSTS ;-- Exam status (don't post images to CANCELLED exams)
"RTN","MAGDRPC4",27,0)
 N EXAMTYP ;-- Type of exam (Rad or Con)
"RTN","MAGDRPC4",28,0)
 N GMRCIEN ;-- Pointer for GMRC
"RTN","MAGDRPC4",29,0)
 N PROCDESC ;- Procedure description
"RTN","MAGDRPC4",30,0)
 N PROCIEN ;-- Radiology procedure IEN in ^RAMIS(71)
"RTN","MAGDRPC4",31,0)
 N RAIX ;----- cross reference subscript for case number lookup
"RTN","MAGDRPC4",32,0)
 N RADFN ;---- first level subscript in ^RADPT
"RTN","MAGDRPC4",33,0)
 N RADTI ;---- second level subscript in ^RADPT (after "DT")
"RTN","MAGDRPC4",34,0)
 N RACNI ;---- third level subscript in ^RADPT (after "P")
"RTN","MAGDRPC4",35,0)
 N RARPT ;---- Radiology Report pointer
"RTN","MAGDRPC4",36,0)
 N I,LIST,NOUT,X,Z
"RTN","MAGDRPC4",37,0)
 ;
"RTN","MAGDRPC4",38,0)
 K OUT S NOUT=1
"RTN","MAGDRPC4",39,0)
 I $G(NUMBER)="" S OUT(1)="-1,No Case or Consult Number Specified" Q
"RTN","MAGDRPC4",40,0)
 I $E(NUMBER,2)="`" D  Q
"RTN","MAGDRPC4",41,0)
 . ; lookup the image by the IEN
"RTN","MAGDRPC4",42,0)
 . D IENLOOK^MAGDRPC9
"RTN","MAGDRPC4",43,0)
 . Q
"RTN","MAGDRPC4",44,0)
 ;
"RTN","MAGDRPC4",45,0)
 S EXAMTYP=$E(NUMBER,1)
"RTN","MAGDRPC4",46,0)
 I "RC"[EXAMTYP S NUMBER=$E(NUMBER,2,$L(NUMBER))
"RTN","MAGDRPC4",47,0)
 E  S EXAMTYP=""
"RTN","MAGDRPC4",48,0)
 K DFN
"RTN","MAGDRPC4",49,0)
 D  ; First try Radiology candidates
"RTN","MAGDRPC4",50,0)
 . I EXAMTYP'="",EXAMTYP'="R" Q
"RTN","MAGDRPC4",51,0)
 . D  ; Look for the patient/study in ^RADPT using the Radiology Case Number
"RTN","MAGDRPC4",52,0)
 . . N RAIX ;----- cross reference subscript for case number lookup
"RTN","MAGDRPC4",53,0)
 . . S RAIX=$S($D(^RADPT("C")):"C",1:"AE") ; for Radiology Patch RA*5*7
"RTN","MAGDRPC4",54,0)
 . . S RAIX=$S(NUMBER["-":"ADC",1:RAIX) ; select the cross-reference
"RTN","MAGDRPC4",55,0)
 . . S RADFN=$O(^RADPT(RAIX,NUMBER,"")) I 'RADFN D  Q:'RADFN
"RTN","MAGDRPC4",56,0)
 . . . I NUMBER'["-" S OUT(1)="-2,No Study Date Specified" Q
"RTN","MAGDRPC4",57,0)
 . . . S X=$P(NUMBER,"-",1)
"RTN","MAGDRPC4",58,0)
 . . . I $L(X)'=6 S OUT(1)="-3,Invalid study date """_X_"""." Q
"RTN","MAGDRPC4",59,0)
 . . . S SDATE=$S($E(X,5,6)<30:3,1:2)_$E(X,5,6)_$E(X,1,4)
"RTN","MAGDRPC4",60,0)
 . . . D:SDATE
"RTN","MAGDRPC4",61,0)
 . . . . ; Search 1-3 days prior the study date OR a day in advance but only
"RTN","MAGDRPC4",62,0)
 . . . . ; if the study date is not equal to today or greater than today.
"RTN","MAGDRPC4",63,0)
 . . . . ; Has to be long case number or must have an image study date
"RTN","MAGDRPC4",64,0)
 . . . . N %,%I,II,RCASE,TODAY,X,Y
"RTN","MAGDRPC4",65,0)
 . . . . S RCASE=$S(NUMBER["-":$P(NUMBER,"-",2),1:NUMBER) Q:'RCASE
"RTN","MAGDRPC4",66,0)
 . . . . D NOW^%DTC S TODAY=X
"RTN","MAGDRPC4",67,0)
 . . . . ;
"RTN","MAGDRPC4",68,0)
 . . . . ;  1-3 days prior study date
"RTN","MAGDRPC4",69,0)
 . . . . F II=1:1:3 S RADFN=$$FIND(SDATE,RCASE,-II) Q:RADFN
"RTN","MAGDRPC4",70,0)
 . . . . Q:RADFN
"RTN","MAGDRPC4",71,0)
 . . . . ;
"RTN","MAGDRPC4",72,0)
 . . . . ; Wild goose chase but check for today's case
"RTN","MAGDRPC4",73,0)
 . . . . S RADFN=$O(^RADPT("ADC",$$MMDDYY(TODAY)_"-"_RCASE,"")) Q:RADFN
"RTN","MAGDRPC4",74,0)
 . . . . ;
"RTN","MAGDRPC4",75,0)
 . . . . Q:SDATE'<TODAY
"RTN","MAGDRPC4",76,0)
 . . . . S RADFN=$$FIND(SDATE,RCASE,1) Q:RADFN  ; Advance a day
"RTN","MAGDRPC4",77,0)
 . . . . ;
"RTN","MAGDRPC4",78,0)
 . . . . ; Finally just check the "C" or "AE" x-reference for the case number
"RTN","MAGDRPC4",79,0)
 . . . . ; based on RA*5*7 patch
"RTN","MAGDRPC4",80,0)
 . . . . S RADFN=$O(^RADPT($S($O(^RADPT("C","")):"C",1:"AE"),RCASE,""))
"RTN","MAGDRPC4",81,0)
 . . . . Q
"RTN","MAGDRPC4",82,0)
 . . . Q
"RTN","MAGDRPC4",83,0)
 . . S RADTI=$O(^RADPT(RAIX,NUMBER,RADFN,"")) Q:'RADTI
"RTN","MAGDRPC4",84,0)
 . . S RACNI=$O(^RADPT(RAIX,NUMBER,RADFN,RADTI,"")) Q:'RACNI
"RTN","MAGDRPC4",85,0)
 . . Q:'$D(^RADPT(RADFN,0))  ; No patient demographics file pointer
"RTN","MAGDRPC4",86,0)
 . . S DFN=$P(^RADPT(RADFN,0),"^",1)
"RTN","MAGDRPC4",87,0)
 . . Q
"RTN","MAGDRPC4",88,0)
 . Q:'$G(DFN)
"RTN","MAGDRPC4",89,0)
 . Q:'$D(^RADPT(DFN,"DT",RADTI,0))
"RTN","MAGDRPC4",90,0)
 . S RARPT=$P($G(^RADPT(DFN,"DT",RADTI,"P",RACNI,0)),"^",17) Q:'RARPT
"RTN","MAGDRPC4",91,0)
 . S ACCNUM=$P($G(^RARPT(RARPT,0)),"^",1)
"RTN","MAGDRPC4",92,0)
 . S I=0 F  S I=$O(^RARPT(RARPT,2005,I)) Q:'I  D
"RTN","MAGDRPC4",93,0)
 . . S X="74^"_RARPT_"^"_$P($G(^RARPT(RARPT,2005,I,0)),"^",1)_"^"_ACCNUM
"RTN","MAGDRPC4",94,0)
 . . S NOUT=NOUT+1,OUT(NOUT)=X
"RTN","MAGDRPC4",95,0)
 . . Q
"RTN","MAGDRPC4",96,0)
 . Q
"RTN","MAGDRPC4",97,0)
 ;
"RTN","MAGDRPC4",98,0)
 K DFN
"RTN","MAGDRPC4",99,0)
 D  ; Now look for any consults that might qualify
"RTN","MAGDRPC4",100,0)
 . N ACCNUM,MAGIEN,MAGPTR,REPORTF,REPORTI,TIUIEN,TIUPTR,TIUXIEN
"RTN","MAGDRPC4",101,0)
 . I EXAMTYP'="",EXAMTYP'="C" Q
"RTN","MAGDRPC4",102,0)
 . S ACCNUM="GMRC-"_$S(NUMBER?1"GMRC-"1.N:$P(NUMBER,"GMRC-",2),1:NUMBER)
"RTN","MAGDRPC4",103,0)
 . S GMRCIEN=$P(ACCNUM,"-",2)
"RTN","MAGDRPC4",104,0)
 . D
"RTN","MAGDRPC4",105,0)
 . . N D0,Z
"RTN","MAGDRPC4",106,0)
 . . S D0=$P(ACCNUM,"-",2)
"RTN","MAGDRPC4",107,0)
 . . S DFN=$$GET1^DIQ(123,D0,.02,"I") Q:'DFN
"RTN","MAGDRPC4",108,0)
 . . S EXAMSTS=$$GET1^DIQ(123,D0,8) ; check for cancelled exam
"RTN","MAGDRPC4",109,0)
 . . I EXAMSTS="CANCELLED" S OUT(1)="-4,Consult is cancelled" Q
"RTN","MAGDRPC4",110,0)
 . . S PROCDESC=$$GET1^DIQ(123,D0,1)
"RTN","MAGDRPC4",111,0)
 . . S Z=$$GET1^DIQ(123,D0,13,"I") ; request type
"RTN","MAGDRPC4",112,0)
 . . Q
"RTN","MAGDRPC4",113,0)
 . I '$G(DFN) S OUT(1)="-5,Consult/procedure not on file" Q
"RTN","MAGDRPC4",114,0)
 . ; Find the images - they can be linked to TIU or imaging file 2006.5839
"RTN","MAGDRPC4",115,0)
 . S MAGPTR=$O(^MAG(2006.5839,"C",123,GMRCIEN,0))
"RTN","MAGDRPC4",116,0)
 . I MAGPTR D  Q  ; Found it in ^MAG(2006.5839 - not in ^TIU yet
"RTN","MAGDRPC4",117,0)
 . . S X=^MAG(2006.5839,MAGPTR,0)
"RTN","MAGDRPC4",118,0)
 . . S X=$P(X,"^",1)_"^"_$P(X,"^",2)_"^"_$P(X,"^",3)_"^"_ACCNUM
"RTN","MAGDRPC4",119,0)
 . . S NOUT=NOUT+1,OUT(NOUT)=X
"RTN","MAGDRPC4",120,0)
 . . Q
"RTN","MAGDRPC4",121,0)
 . D  ; Otherwise find images in ^TIU
"RTN","MAGDRPC4",122,0)
 . . N I,X
"RTN","MAGDRPC4",123,0)
 . . D TIUALL^MAGDGMRC(GMRCIEN,.RESULT)
"RTN","MAGDRPC4",124,0)
 . . S I="" F  S I=$O(RESULT(I)) Q:I=""  D
"RTN","MAGDRPC4",125,0)
 . . . S X="8925^"_$P(RESULT(I),"^",1)_"^"_$P(RESULT(I),"^",3)_"^"_$P(RESULT(I),"^",2)
"RTN","MAGDRPC4",126,0)
 . . . S NOUT=NOUT+1,OUT(NOUT)=X
"RTN","MAGDRPC4",127,0)
 . . . Q
"RTN","MAGDRPC4",128,0)
 . . Q
"RTN","MAGDRPC4",129,0)
 . Q
"RTN","MAGDRPC4",130,0)
 S OUT(1)=NOUT-1
"RTN","MAGDRPC4",131,0)
 Q
"RTN","MAGDRPC4",132,0)
 ;
"RTN","MAGDRPC4",133,0)
NEXTIMG(OUT,FROM,SENT,CHECK) ; RPC = MAG DICOM GET NEXT QUEUE ENTRY
"RTN","MAGDRPC4",134,0)
 ; Get next file to be DICOM transmitted
"RTN","MAGDRPC4",135,0)
 N H,F1,F2,F3,I,JBTOHD,LOC,N,PRI,S0,S1,STS,TYPE,X
"RTN","MAGDRPC4",136,0)
 I $G(FROM)="" S OUT(1)="-1,No Origin Specified"
"RTN","MAGDRPC4",137,0)
 ; First clean up transmitted queue entries
"RTN","MAGDRPC4",138,0)
 S I="" F  S I=$O(SENT(I)) Q:I=""  D CLEAN^MAGDRPC9
"RTN","MAGDRPC4",139,0)
 S H=$$SECOND($H)
"RTN","MAGDRPC4",140,0)
 L +^MAGDOUTP(2006.574,"STS"):1E9 ; Background process MUST wait
"RTN","MAGDRPC4",141,0)
 I '$G(CHECK) D  ; do only when called from a transmission process
"RTN","MAGDRPC4",142,0)
 . S PRI="" F  S PRI=$O(^MAGDOUTP(2006.574,"STS",FROM,PRI)) Q:PRI=""  D
"RTN","MAGDRPC4",143,0)
 . . S S0="" F  S S0=$O(^MAGDOUTP(2006.574,"STS",FROM,PRI,"XMIT",S0)) Q:S0=""  D
"RTN","MAGDRPC4",144,0)
 . . . S S1="" F  S S1=$O(^MAGDOUTP(2006.574,"STS",FROM,PRI,"XMIT",S0,S1)) Q:S1=""  D
"RTN","MAGDRPC4",145,0)
 . . . . S X=$$SECOND($P($G(^MAGDOUTP(2006.574,S0,1,S1,0),"^^"_$H),"^",3))
"RTN","MAGDRPC4",146,0)
 . . . . Q:H-X<300
"RTN","MAGDRPC4",147,0)
 . . . . S $P(^MAGDOUTP(2006.574,S0,1,S1,0),"^",2)="WAITING"
"RTN","MAGDRPC4",148,0)
 . . . . K ^MAGDOUTP(2006.574,"STS",FROM,PRI,"XMIT",S0,S1)
"RTN","MAGDRPC4",149,0)
 . . . . S ^MAGDOUTP(2006.574,"STS",FROM,PRI,"WAITING",S0,S1)=""
"RTN","MAGDRPC4",150,0)
 . . . . Q
"RTN","MAGDRPC4",151,0)
 . . . Q
"RTN","MAGDRPC4",152,0)
 . . Q
"RTN","MAGDRPC4",153,0)
 . Q
"RTN","MAGDRPC4",154,0)
 S OUT(1)="",PRI=$O(^MAGDOUTP(2006.574,"STS",FROM,""),-1)
"RTN","MAGDRPC4",155,0)
 D:PRI'=""
"RTN","MAGDRPC4",156,0)
 . S S0="" F  S S0=$O(^MAGDOUTP(2006.574,"STS",FROM,PRI,"WAITING",S0)) Q:S0=""  D  Q:OUT(1)'=""
"RTN","MAGDRPC4",157,0)
 . . S S1="" F  S S1=$O(^MAGDOUTP(2006.574,"STS",FROM,PRI,"WAITING",S0,S1)) Q:S1=""  D  Q:OUT(1)'=""
"RTN","MAGDRPC4",158,0)
 . . . I '$G(CHECK) D  ; do only when called from a transmission process
"RTN","MAGDRPC4",159,0)
 . . . . S $P(^MAGDOUTP(2006.574,S0,1,S1,0),"^",2,3)="XMIT^"_$H
"RTN","MAGDRPC4",160,0)
 . . . . K ^MAGDOUTP(2006.574,"STS",FROM,PRI,"WAITING",S0,S1)
"RTN","MAGDRPC4",161,0)
 . . . . S ^MAGDOUTP(2006.574,"STS",FROM,PRI,"XMIT",S0,S1)=""
"RTN","MAGDRPC4",162,0)
 . . . . Q
"RTN","MAGDRPC4",163,0)
 . . . S OUT(1)=1
"RTN","MAGDRPC4",164,0)
 . . . S OUT(2)=S0
"RTN","MAGDRPC4",165,0)
 . . . S OUT(3)=S1
"RTN","MAGDRPC4",166,0)
 . . . S X=$G(^MAGDOUTP(2006.574,S0,0))
"RTN","MAGDRPC4",167,0)
 . . . S OUT(4)=$P(X,"^",1) ; Application
"RTN","MAGDRPC4",168,0)
 . . . S OUT(5)=$P(X,"^",2) ; Group
"RTN","MAGDRPC4",169,0)
 . . . S OUT(6)=$P(X,"^",3) ; Accession Number
"RTN","MAGDRPC4",170,0)
 . . . S JBTOHD=+$P(X,"^",6)
"RTN","MAGDRPC4",171,0)
 . . . S OUT(7)=+$G(^MAGDOUTP(2006.574,S0,1,S1,0)) ; Image
"RTN","MAGDRPC4",172,0)
 . . . S OUT(8)=$P($G(^MAG(2005,+OUT(7),0)),"^",6)
"RTN","MAGDRPC4",173,0)
 . . . S TYPE=$S($G(^MAG(2005,+OUT(7),"FBIG"))'="":"BIG",1:"FULL")
"RTN","MAGDRPC4",174,0)
 . . . ; 3rd parameter set to 1 to allow retrieval from jukebox
"RTN","MAGDRPC4",175,0)
 . . . D FILEFIND^MAGDFB(+OUT(7),TYPE,1,0,.F1,.F2)
"RTN","MAGDRPC4",176,0)
 . . . S OUT(9)=F1
"RTN","MAGDRPC4",177,0)
 . . . S OUT(10)=F2
"RTN","MAGDRPC4",178,0)
 . . . S OUT(11)=$P($G(^MAG(2005,+OUT(5),0)),"^",7) ; get DFN
"RTN","MAGDRPC4",179,0)
 . . . ; get path for *.TXT, always the same as the FULL file
"RTN","MAGDRPC4",180,0)
 . . . D FILEFIND^MAGDFB(+OUT(7),"FULL",JBTOHD,0,.F1,.F3)
"RTN","MAGDRPC4",181,0)
 . . . S OUT(12)=F3
"RTN","MAGDRPC4",182,0)
 . . . Q
"RTN","MAGDRPC4",183,0)
 . . Q
"RTN","MAGDRPC4",184,0)
 . Q
"RTN","MAGDRPC4",185,0)
 S:OUT(1)="" OUT(1)="-2,Nothing to be transmitted."
"RTN","MAGDRPC4",186,0)
 L -^MAGDOUTP(2006.574,"STS")
"RTN","MAGDRPC4",187,0)
 Q
"RTN","MAGDRPC4",188,0)
 ;
"RTN","MAGDRPC4",189,0)
FIND(DATE,CASE,NUM) ;
"RTN","MAGDRPC4",190,0)
 ; Use the ADC x-reference in the radiology patient file
"RTN","MAGDRPC4",191,0)
 N NDATE,X,X1,X2,Y
"RTN","MAGDRPC4",192,0)
 S X1=DATE,X2=NUM D C^%DTC S NDATE=X
"RTN","MAGDRPC4",193,0)
 I NDATE<1 Q 0
"RTN","MAGDRPC4",194,0)
 S NDATE=$$MMDDYY(NDATE)
"RTN","MAGDRPC4",195,0)
 Q $O(^RADPT("ADC",NDATE_"-"_CASE,""))
"RTN","MAGDRPC4",196,0)
 ;
"RTN","MAGDRPC4",197,0)
MMDDYY(DAY) ; Convert Fileman date to mmddyy
"RTN","MAGDRPC4",198,0)
 I DAY'?7N Q 0
"RTN","MAGDRPC4",199,0)
 Q $E(DAY,4,7)_$E(DAY,2,3)
"RTN","MAGDRPC4",200,0)
 ;
"RTN","MAGDRPC4",201,0)
INIT(OUT,LOCATION) ; RPC = MAG DICOM QUEUE INIT
"RTN","MAGDRPC4",202,0)
 N D0,N,PRI,STS,STUID
"RTN","MAGDRPC4",203,0)
 I '$G(LOCATION) S OUT="-3,No origin specified." Q
"RTN","MAGDRPC4",204,0)
 I '$D(^MAGDOUTP(2006.574,0)) S OUT="-1,No entries at all in queue." Q
"RTN","MAGDRPC4",205,0)
 ;
"RTN","MAGDRPC4",206,0)
 S N=0
"RTN","MAGDRPC4",207,0)
 S PRI="" F  S PRI=$O(^MAGDOUTP(2006.574,"STS",LOCATION,PRI)) Q:PRI=""  D
"RTN","MAGDRPC4",208,0)
 . S STS="" F  S STS=$O(^MAGDOUTP(2006.574,"STS",LOCATION,PRI,STS)) Q:STS=""  D
"RTN","MAGDRPC4",209,0)
 . . S D0="" F  S D0=$O(^MAGDOUTP(2006.574,"STS",LOCATION,PRI,STS,D0)) Q:D0=""  D
"RTN","MAGDRPC4",210,0)
 . . . S STUID=$G(^MAGDOUTP(2006.574,D0,2))
"RTN","MAGDRPC4",211,0)
 . . . K ^MAGDOUTP(2006.574,D0)
"RTN","MAGDRPC4",212,0)
 . . . K:STUID'="" ^MAGDOUTP(2006.574,"STUDY",STUID,D0)
"RTN","MAGDRPC4",213,0)
 . . . K ^MAGDOUTP(2006.574,"STS",LOCATION,PRI,STS,D0)
"RTN","MAGDRPC4",214,0)
 . . . S N=N+1
"RTN","MAGDRPC4",215,0)
 . . . Q
"RTN","MAGDRPC4",216,0)
 . . Q
"RTN","MAGDRPC4",217,0)
 . Q
"RTN","MAGDRPC4",218,0)
 ;
"RTN","MAGDRPC4",219,0)
 I 'N S OUT="-2,No entries present for "_$$GET1^DIQ(4,LOCATION,.01)_"." Q
"RTN","MAGDRPC4",220,0)
 ;
"RTN","MAGDRPC4",221,0)
 S $P(^MAGDOUTP(2006.574,0),"^",4)=$P(^MAGDOUTP(2006.574,0),"^",4)-N
"RTN","MAGDRPC4",222,0)
 S OUT=N_" entr"_$S(N=1:"y",1:"ies")_" removed from Image Transmission Queue."
"RTN","MAGDRPC4",223,0)
 Q
"RTN","MAGDRPC4",224,0)
 ;
"RTN","MAGDRPC4",225,0)
SECOND(H) Q H*86400+$P(H,",",2)
"RTN","MAGDRPC4",226,0)
 ;
"RTN","MAGDRPC9")
0^10^B29652420
"RTN","MAGDRPC9",1,0)
MAGDRPC9 ;WOIFO/EdM - Imaging RPCs ; 11/03/2005  14:48
"RTN","MAGDRPC9",2,0)
 ;;3.0;IMAGING;**50**;26-May-2006
"RTN","MAGDRPC9",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC9",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDRPC9",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDRPC9",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDRPC9",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDRPC9",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDRPC9",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDRPC9",10,0)
 ;; |                                                               |
"RTN","MAGDRPC9",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDRPC9",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDRPC9",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDRPC9",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDRPC9",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDRPC9",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDRPC9",17,0)
 ;;
"RTN","MAGDRPC9",18,0)
 Q
"RTN","MAGDRPC9",19,0)
 ;
"RTN","MAGDRPC9",20,0)
NEWUID(OUT,OLD,NEW,IMAGE) ; RPC = MAG NEW SOP INSTANCE UID
"RTN","MAGDRPC9",21,0)
 N D0,L,X
"RTN","MAGDRPC9",22,0)
 S IMAGE=+$G(IMAGE),OLD=$G(OLD)
"RTN","MAGDRPC9",23,0)
 S:$G(NEW)="" NEW=OLD
"RTN","MAGDRPC9",24,0)
 S D0=0 S:OLD'="" D0=$O(^MAG(2005,"P",OLD,""))
"RTN","MAGDRPC9",25,0)
 I IMAGE,D0,IMAGE'=D0 S OUT="-1,UID cannot belong to multiple images ("_IMAGE_"/"_D0_")" Q
"RTN","MAGDRPC9",26,0)
 I IMAGE,'D0 S D0=IMAGE
"RTN","MAGDRPC9",27,0)
 I 'D0 S OUT="-2,Cannot find image with UID "_OLD Q
"RTN","MAGDRPC9",28,0)
 S OUT=$P($G(^MAG(2005,D0,"SOP")),"^",2) Q:OUT'=""
"RTN","MAGDRPC9",29,0)
 S L=$L(NEW,".")-1,X=$P(NEW,".",L+1),L=$P(NEW,".",1,L)_"."
"RTN","MAGDRPC9",30,0)
 L +^MAG(2005,"P"):1E9 ; Background process MUST wait
"RTN","MAGDRPC9",31,0)
 S OUT="" F  D  Q:OUT'=""
"RTN","MAGDRPC9",32,0)
 . S OUT=L_X
"RTN","MAGDRPC9",33,0)
 . I $L(OUT)>64 S OUT="-3,Cannot use "_NEW_" to create valid UID" Q
"RTN","MAGDRPC9",34,0)
 . I $D(^MAG(2005,"P",OUT)) S OUT="",X=X+1 Q
"RTN","MAGDRPC9",35,0)
 . S $P(^MAG(2005,D0,"SOP"),"^",2)=OUT
"RTN","MAGDRPC9",36,0)
 . S ^MAG(2005,"P",OUT,D0)=1
"RTN","MAGDRPC9",37,0)
 . Q
"RTN","MAGDRPC9",38,0)
 L -^MAG(2005,"P")
"RTN","MAGDRPC9",39,0)
 Q
"RTN","MAGDRPC9",40,0)
 ;
"RTN","MAGDRPC9",41,0)
NEXT(OUT,SEED,DIR) ; RPC = MAG RAD GET NEXT RPT BY DATE
"RTN","MAGDRPC9",42,0)
 N D2,DFN,EXAMDATE,NAME
"RTN","MAGDRPC9",43,0)
 ;
"RTN","MAGDRPC9",44,0)
 ; ^RADPT(DFN,"DT",D1,"P",D2,0) = Data, $P(17) = pointer to report
"RTN","MAGDRPC9",45,0)
 ; ^RADPT("AR",9999999.9999-D1,DFN,D1)="" ; IA # 65
"RTN","MAGDRPC9",46,0)
 ;
"RTN","MAGDRPC9",47,0)
 ; OUT = report_pointer ^ ExamDate ^ Patient ^ D2
"RTN","MAGDRPC9",48,0)
 ;
"RTN","MAGDRPC9",49,0)
 S SEED=$G(SEED),DIR=$S($G(DIR)<0:-1,1:1) ; default is ascending order
"RTN","MAGDRPC9",50,0)
 S EXAMDATE=$P(SEED,"^",1),DFN=$P(SEED,"^",2),D2=$P(SEED,"^",3)
"RTN","MAGDRPC9",51,0)
 S OUT=0 F  D  Q:OUT
"RTN","MAGDRPC9",52,0)
 . I EXAMDATE="" S EXAMDATE=$O(^RADPT("AR",""),DIR),DFN="" ; IA # 65
"RTN","MAGDRPC9",53,0)
 . I EXAMDATE="" S OUT=-1 Q
"RTN","MAGDRPC9",54,0)
 . I DFN="" S DFN=$O(^RADPT("AR",EXAMDATE,""),DIR) ; IA # 65
"RTN","MAGDRPC9",55,0)
 . I DFN="" S EXAMDATE=$O(^RADPT("AR",EXAMDATE),DIR),D2="" Q  ; IA # 65
"RTN","MAGDRPC9",56,0)
 . S:'D2 D2=$S(DIR>0:0,1:" ")
"RTN","MAGDRPC9",57,0)
 . S D2=$O(^RADPT(DFN,"DT",9999999.9999-EXAMDATE,"P",D2),DIR) ; IA # 1172
"RTN","MAGDRPC9",58,0)
 . I 'D2 D  Q
"RTN","MAGDRPC9",59,0)
 . . S DFN=$O(^RADPT("AR",EXAMDATE,DFN),DIR),D2="" ; IA # 65
"RTN","MAGDRPC9",60,0)
 . . I 'DFN D
"RTN","MAGDRPC9",61,0)
 . . . S EXAMDATE=$O(^RADPT("AR",EXAMDATE),DIR),DFN="" ; IA # 65
"RTN","MAGDRPC9",62,0)
 . . . I EXAMDATE="" S OUT=-1
"RTN","MAGDRPC9",63,0)
 . . . Q
"RTN","MAGDRPC9",64,0)
 . . Q
"RTN","MAGDRPC9",65,0)
 . S OUT=$P($G(^RADPT(DFN,"DT",9999999.9999-EXAMDATE,"P",D2,0)),"^",17) ; IA # 1172
"RTN","MAGDRPC9",66,0)
 . S:OUT OUT=OUT_"^"_EXAMDATE_"^"_DFN_"^"_D2
"RTN","MAGDRPC9",67,0)
 . Q
"RTN","MAGDRPC9",68,0)
 Q
"RTN","MAGDRPC9",69,0)
 ;
"RTN","MAGDRPC9",70,0)
NXTPTRPT(OUT,DFN,RARPT1,DIR) ; RPC = MAG RAD GET NEXT RPT BY PT
"RTN","MAGDRPC9",71,0)
 S DFN=$G(DFN)
"RTN","MAGDRPC9",72,0)
 I 'DFN S OUT="-1,Patient DFN not passed" Q
"RTN","MAGDRPC9",73,0)
 I '$D(^RARPT("C",DFN)) S OUT="-2,Patient does not have any radiology reports" Q  ; IA # 2442
"RTN","MAGDRPC9",74,0)
 S RARPT1=$G(RARPT1),DIR=$S($G(DIR)<0:-1,1:1) ; default is ascending order
"RTN","MAGDRPC9",75,0)
 S OUT=$O(^RARPT("C",DFN,RARPT1),DIR) ; IA # 2442
"RTN","MAGDRPC9",76,0)
 Q
"RTN","MAGDRPC9",77,0)
 ;
"RTN","MAGDRPC9",78,0)
GETICN(OUT,DFN) ; RPC = MAG DICOM GET ICN
"RTN","MAGDRPC9",79,0)
 S OUT=$$GETICN^MPIF001(DFN)
"RTN","MAGDRPC9",80,0)
 Q
"RTN","MAGDRPC9",81,0)
 ;
"RTN","MAGDRPC9",82,0)
CLEAN ; Overflow from MAGDRPC4
"RTN","MAGDRPC9",83,0)
 N STUID
"RTN","MAGDRPC9",84,0)
 S S0=$P(SENT(I),"^",1),S1=$P(SENT(I),"^",2)
"RTN","MAGDRPC9",85,0)
 Q:'$D(^MAGDOUTP(2006.574,S0,1,S1))
"RTN","MAGDRPC9",86,0)
 L +^MAGDOUTP(2006.574,S0,1,0):1E9 ; Background process MUST wait
"RTN","MAGDRPC9",87,0)
 S X=$G(^MAGDOUTP(2006.574,S0,0)),LOC=$P(X,"^",4),PRI=+$P(X,"^",5)
"RTN","MAGDRPC9",88,0)
 S STS=$P($G(^MAGDOUTP(2006.574,S0,1,S1,0)),"^",2)
"RTN","MAGDRPC9",89,0)
 K ^MAGDOUTP(2006.574,S0,1,S1)
"RTN","MAGDRPC9",90,0)
 I LOC'="",STS'="" K ^MAGDOUTP(2006.574,"STS",LOC,PRI,STS,S0,S1)
"RTN","MAGDRPC9",91,0)
 S X=$G(^MAGDOUTP(2006.574,S0,1,0))
"RTN","MAGDRPC9",92,0)
 S $P(X,"^",4)=$P(X,"^",4)-1
"RTN","MAGDRPC9",93,0)
 S ^MAGDOUTP(2006.574,S0,1,0)=X
"RTN","MAGDRPC9",94,0)
 L -^MAGDOUTP(2006.574,S0,1,0)
"RTN","MAGDRPC9",95,0)
 Q:$O(^MAGDOUTP(2006.574,S0,1,0))
"RTN","MAGDRPC9",96,0)
 L +^MAGDOUTP(2006.574,0):1E9 ; Background process MUST wait
"RTN","MAGDRPC9",97,0)
 S STUID=$G(^MAGDOUTP(2006.574,S0,2))
"RTN","MAGDRPC9",98,0)
 K ^MAGDOUTP(2006.574,S0)
"RTN","MAGDRPC9",99,0)
 K:STUID'="" ^MAGDOUTP(2006.574,"STUDY",STUID)
"RTN","MAGDRPC9",100,0)
 S X=$G(^MAGDOUTP(2006.574,0))
"RTN","MAGDRPC9",101,0)
 S $P(X,"^",4)=$P(X,"^",4)-1
"RTN","MAGDRPC9",102,0)
 S ^MAGDOUTP(2006.574,0)=X
"RTN","MAGDRPC9",103,0)
 L -^MAGDOUTP(2006.574,0)
"RTN","MAGDRPC9",104,0)
 Q
"RTN","MAGDRPC9",105,0)
 ;
"RTN","MAGDRPC9",106,0)
IENLOOK ; Overflow from MAGDRPC4
"RTN","MAGDRPC9",107,0)
 ; lookup image by the IEN
"RTN","MAGDRPC9",108,0)
 N D0,GROUPIEN,P,X
"RTN","MAGDRPC9",109,0)
 S NUMBER=+$P(NUMBER,"`",2)
"RTN","MAGDRPC9",110,0)
 ; patient safety checks
"RTN","MAGDRPC9",111,0)
 D CHK^MAGGSQI(.X,NUMBER) I +$G(X(0))'=1 D  Q
"RTN","MAGDRPC9",112,0)
 . S OUT(1)="-9,"_$P(X(0),"^",2,999)
"RTN","MAGDRPC9",113,0)
 . Q
"RTN","MAGDRPC9",114,0)
 S GROUPIEN=$P($G(^MAG(2005,NUMBER,0)),"^",10)
"RTN","MAGDRPC9",115,0)
 I GROUPIEN D CHK^MAGGSQI(.X,GROUPIEN) I +$G(X(0))'=1 D  Q
"RTN","MAGDRPC9",116,0)
 . S OUT(1)="-10,Group #"_GROUPIEN_": "_$P(X(0),"^",2,999)
"RTN","MAGDRPC9",117,0)
 . Q
"RTN","MAGDRPC9",118,0)
 ;
"RTN","MAGDRPC9",119,0)
 S X=$G(^MAG(2005,NUMBER,2)),P=$P(X,"^",6),D0=$P(X,"^",7)
"RTN","MAGDRPC9",120,0)
 I 'P!'D0 D  ; get parent from group
"RTN","MAGDRPC9",121,0)
 . S:GROUPIEN X=$G(^MAG(2005,GROUPIEN,2)),P=$P(X,"^",6),D0=$P(X,"^",7)
"RTN","MAGDRPC9",122,0)
 . Q
"RTN","MAGDRPC9",123,0)
 ;
"RTN","MAGDRPC9",124,0)
 S OUT(2)=P_"^"_D0_"^"_NUMBER_"^" ; result w/o Accession Number
"RTN","MAGDRPC9",125,0)
 I 'P!'D0 S OUT(1)="-6,Warning - Parent file entry is not present - no Accession Number."
"RTN","MAGDRPC9",126,0)
 E  I P=74 D
"RTN","MAGDRPC9",127,0)
 . S X=P_"^"_D0_"^"_NUMBER_"^"_$P($G(^RARPT(D0,0)),"^",1) ; IA # 1171
"RTN","MAGDRPC9",128,0)
 . S OUT(1)=1,OUT(2)=X
"RTN","MAGDRPC9",129,0)
 . Q
"RTN","MAGDRPC9",130,0)
 E  I P=8925 D
"RTN","MAGDRPC9",131,0)
 . ; get pointer from TIU to consult request
"RTN","MAGDRPC9",132,0)
 . S X=$$GET1^DIQ(8925,D0,1405,"I") ; IA ???
"RTN","MAGDRPC9",133,0)
 . I $P(X,";",2)="GMR(123," D
"RTN","MAGDRPC9",134,0)
 . . S X=P_"^"_D0_"^"_NUMBER_"^GMRC-"_$P(X,";")
"RTN","MAGDRPC9",135,0)
 . . S OUT(1)=1,OUT(2)=X
"RTN","MAGDRPC9",136,0)
 . . Q
"RTN","MAGDRPC9",137,0)
 . E  S OUT(1)="-8,Problem with parent file "_P_", internal entry number "_D0_" - no Accession Number."
"RTN","MAGDRPC9",138,0)
 . Q
"RTN","MAGDRPC9",139,0)
 E  S OUT(1)="-7,Parent file "_P_" not yet supported - no Accession Number."
"RTN","MAGDRPC9",140,0)
 Q
"RTN","MAGDRPC9",141,0)
 ;
"RTN","MAGGTIA2")
0^11^B17645994
"RTN","MAGGTIA2",1,0)
MAGGTIA2 ;WOIFO/GEK - Imaging Utilities for Add/Modify Image entry ; 11/10/2005  15:07
"RTN","MAGGTIA2",2,0)
 ;;3.0;IMAGING;**10,50**;26-May-2006
"RTN","MAGGTIA2",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTIA2",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTIA2",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTIA2",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTIA2",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTIA2",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTIA2",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTIA2",10,0)
 ;; |                                                               |
"RTN","MAGGTIA2",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTIA2",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTIA2",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTIA2",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTIA2",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTIA2",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTIA2",17,0)
 ;;
"RTN","MAGGTIA2",18,0)
 Q
"RTN","MAGGTIA2",19,0)
RSLVPLC ;VISN15  We are here to resolve the institution pointer 
"RTN","MAGGTIA2",20,0)
 ;  field .05  In consolidated sites, we need this field.
"RTN","MAGGTIA2",21,0)
 ;  But if workstation hasn't updated yet, we'll try DUZ(2) for
"RTN","MAGGTIA2",22,0)
 ;  Capture Workstations
"RTN","MAGGTIA2",23,0)
 N PLC
"RTN","MAGGTIA2",24,0)
 ; USE of MAGJOB("VERSION") for this purpose will have to change.
"RTN","MAGGTIA2",25,0)
 ; All calls will be setting it later.
"RTN","MAGGTIA2",26,0)
 I '$D(MAGJOB("VERSION")) D  ; Peter or Import API is calling;
"RTN","MAGGTIA2",27,0)
 . I '$D(MAGGFDA(2005,"+1,",.05)) S MAGERR="0^Required data missing: INSTITUTION.!" Q
"RTN","MAGGTIA2",28,0)
 . I '$D(DUZ(2)) S DUZ(2)=MAGGFDA(2005,"+1,",.05) ; Peter's change.
"RTN","MAGGTIA2",29,0)
 . Q
"RTN","MAGGTIA2",30,0)
 I $D(MAGJOB("VERSION")) D  ; Capture Workstation is calling;
"RTN","MAGGTIA2",31,0)
 . I '$D(MAGGFDA(2005,"+1,",.05)) D DUZ2INST I $L(MAGERR) Q
"RTN","MAGGTIA2",32,0)
 . Q
"RTN","MAGGTIA2",33,0)
 Q
"RTN","MAGGTIA2",34,0)
 ;
"RTN","MAGGTIA2",35,0)
DUZ2INST ;VISN15 Compute the Users Institution for older versions of Imaging Capture workstation.
"RTN","MAGGTIA2",36,0)
 ; Newer versions will have DUZ(2) defined.
"RTN","MAGGTIA2",37,0)
 ; Either from New Person, or default from Kernel System Parameter file.
"RTN","MAGGTIA2",38,0)
 N MAGINST
"RTN","MAGGTIA2",39,0)
 S MAGINST=+$G(DUZ(2))
"RTN","MAGGTIA2",40,0)
 I 'MAGINST D  ; If we don't have a DUZ(2) check the user's Divisions in New Person.
"RTN","MAGGTIA2",41,0)
 . I +$P($G(^VA(200,DUZ,2,0)),U,4)=0 Q
"RTN","MAGGTIA2",42,0)
 . I $P($G(^VA(200,DUZ,2,0)),U,4)=1 S MAGINST=$O(^VA(200,DUZ,2,0))
"RTN","MAGGTIA2",43,0)
 . I 'MAGINST S MAGINST=+$O(^VA(200,DUZ,2,"AX1",1,""))
"RTN","MAGGTIA2",44,0)
 . Q
"RTN","MAGGTIA2",45,0)
 I 'MAGINST S MAGERR="You must update your workstation to the latest Version of Imaging.  Call IRM." Q
"RTN","MAGGTIA2",46,0)
 S MAGGFDA(2005,"+1,",.05)=MAGINST
"RTN","MAGGTIA2",47,0)
 Q
"RTN","MAGGTIA2",48,0)
 ;
"RTN","MAGGTIA2",49,0)
QACHK(MAGY,MAGDFN,MAGPK,MAGPKDA) ; Check Patient of Parent Report against patient we 
"RTN","MAGGTIA2",50,0)
 ;   are saving image too.
"RTN","MAGGTIA2",51,0)
 ;
"RTN","MAGGTIA2",52,0)
 S MAGDFN=$G(MAGDFN),MAGPK=$G(MAGPK),MAGPKDA=$G(MAGPKDA)
"RTN","MAGGTIA2",53,0)
 S ^TMP("MAGFDA",$J,"DFN")=MAGDFN
"RTN","MAGGTIA2",54,0)
 S ^TMP("MAGFDA",$J,"PK")=MAGPK
"RTN","MAGGTIA2",55,0)
 S ^TMP("MAGFDA",$J,"PKDA")=MAGPKDA
"RTN","MAGGTIA2",56,0)
 S MAGY="0^Checking for Matching Patients..."
"RTN","MAGGTIA2",57,0)
 I 'MAGDFN S MAGY="0^Missing Patient ID." Q
"RTN","MAGGTIA2",58,0)
 I 'MAGPK,'MAGPKDA S MAGY="1^No Report associated with Image." Q
"RTN","MAGGTIA2",59,0)
 I MAGPK,'MAGPKDA S MAGY="0^Missing Parent root" Q
"RTN","MAGGTIA2",60,0)
 I 'MAGPK,MAGPKDA S MAGY="0^Parent root, but Missing Parent." Q
"RTN","MAGGTIA2",61,0)
 ; Here we have Parent and root and Patient DFN.
"RTN","MAGGTIA2",62,0)
 ; Surgery reports
"RTN","MAGGTIA2",63,0)
 I MAGPK=130 D  Q
"RTN","MAGGTIA2",64,0)
 . I MAGDFN'=$P(^SRF(MAGPKDA,0),U,1) S MAGY="0^Patient Mismatch (130)" Q
"RTN","MAGGTIA2",65,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",66,0)
 . Q
"RTN","MAGGTIA2",67,0)
 ; TIU documents
"RTN","MAGGTIA2",68,0)
 I MAGPK=8925 D  Q
"RTN","MAGGTIA2",69,0)
 . I MAGDFN'=$P($G(^TIU(8925,MAGPKDA,0)),U,2) S MAGY="0^Patient Mismatch (8925)" Q
"RTN","MAGGTIA2",70,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",71,0)
 . Q
"RTN","MAGGTIA2",72,0)
 ; Medicine reports
"RTN","MAGGTIA2",73,0)
 I MAGPK>689.999,MAGPK<703 D  Q
"RTN","MAGGTIA2",74,0)
 . I MAGDFN'=$P($G(^MCAR(MAGPK,MAGPKDA,0)),U,2) S MAGY="0^Patient Mismatch("_MAGPK_")" Q
"RTN","MAGGTIA2",75,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",76,0)
 . Q
"RTN","MAGGTIA2",77,0)
 ; Radiology reports
"RTN","MAGGTIA2",78,0)
 I MAGPK=74 D  Q
"RTN","MAGGTIA2",79,0)
 . I MAGDFN'=$P($G(^RARPT(MAGPKDA,0)),U,2) S MAGY="0^Patient Mismatch (74)" Q
"RTN","MAGGTIA2",80,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",81,0)
 . Q
"RTN","MAGGTIA2",82,0)
 ; Laboratory reports
"RTN","MAGGTIA2",83,0)
 I MAGPK'<63,MAGPK<64 D  Q
"RTN","MAGGTIA2",84,0)
 . S MAGY="1^Lab image not checked "
"RTN","MAGGTIA2",85,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",86,0)
 . Q
"RTN","MAGGTIA2",87,0)
 ; Temporary DICOM GMRC list (waiting for TIU notes for the association)
"RTN","MAGGTIA2",88,0)
 I MAGPK=2006.5839 D  Q
"RTN","MAGGTIA2",89,0)
 . I MAGDFN'=$$GET1^DIQ(123,MAGPKDA,.02,"I") S MAGY="0^Patient Mismatch (2006.5839)" Q
"RTN","MAGGTIA2",90,0)
 . S MAGY="1^Image and Report Package Patients are the same."
"RTN","MAGGTIA2",91,0)
 . Q
"RTN","MAGGTIA2",92,0)
 S MAGY="0^Invalid Parent Package Pointer: "_MAGPK
"RTN","MAGGTIA2",93,0)
 Q
"RTN","MAGIPS50")
0^^B19093218
"RTN","MAGIPS50",1,0)
MAGIPS50 ;Post init routine to queue site activity at install. ; 10/25/2005  10:01
"RTN","MAGIPS50",2,0)
 ;;3.0;IMAGING;**50**;26-May-2006
"RTN","MAGIPS50",3,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIPS50",4,0)
 ;; | Property of the US Government.                                |
"RTN","MAGIPS50",5,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGIPS50",6,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGIPS50",7,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGIPS50",8,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGIPS50",9,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGIPS50",10,0)
 ;; |                                                               |
"RTN","MAGIPS50",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGIPS50",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGIPS50",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGIPS50",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGIPS50",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGIPS50",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIPS50",17,0)
 ;;
"RTN","MAGIPS50",18,0)
 Q
"RTN","MAGIPS50",19,0)
 ;
"RTN","MAGIPS50",20,0)
PRE ;
"RTN","MAGIPS50",21,0)
 ; 1. Remove mis-numbered field from ^DD
"RTN","MAGIPS50",22,0)
 ;
"RTN","MAGIPS50",23,0)
 S DIK="^DD(2005,",DA=112,DA(1)=2005 D ^DIK
"RTN","MAGIPS50",24,0)
 Q
"RTN","MAGIPS50",25,0)
 ;
"RTN","MAGIPS50",26,0)
POST N CVT
"RTN","MAGIPS50",27,0)
 ; 1. Add RPCs to secondary menus
"RTN","MAGIPS50",28,0)
 ; 2. Re-cross-reference file # 2006.574
"RTN","MAGIPS50",29,0)
 ; 3. Send confirmation message
"RTN","MAGIPS50",30,0)
 ;
"RTN","MAGIPS50",31,0)
 ;
"RTN","MAGIPS50",32,0)
 D ADDRPC("MAG DICOM GET ICN","MAG DICOM GATEWAY FULL")
"RTN","MAGIPS50",33,0)
 D ADDRPC("MAG NEW SOP INSTANCE UID","MAG DICOM GATEWAY FULL")
"RTN","MAGIPS50",34,0)
 D ADDRPC("MAG RAD GET NEXT RPT BY DATE","MAG DICOM GATEWAY FULL")
"RTN","MAGIPS50",35,0)
 D ADDRPC("MAG RAD GET NEXT RPT BY PT","MAG DICOM GATEWAY FULL")
"RTN","MAGIPS50",36,0)
 ;
"RTN","MAGIPS50",37,0)
 D ADDRPC("MAG DICOM GET ICN","MAG DICOM GATEWAY VIEW")
"RTN","MAGIPS50",38,0)
 D ADDRPC("MAG NEW SOP INSTANCE UID","MAG DICOM GATEWAY VIEW")
"RTN","MAGIPS50",39,0)
 D ADDRPC("MAG RAD GET NEXT RPT BY DATE","MAG DICOM GATEWAY VIEW")
"RTN","MAGIPS50",40,0)
 D ADDRPC("MAG RAD GET NEXT RPT BY PT","MAG DICOM GATEWAY VIEW")
"RTN","MAGIPS50",41,0)
 ;
"RTN","MAGIPS50",42,0)
 D  ; Re-cross-reference
"RTN","MAGIPS50",43,0)
 . N D0,D1,LOC,PRI,STS,X
"RTN","MAGIPS50",44,0)
 . K ^MAGDOUTP(2006.574,"STS")
"RTN","MAGIPS50",45,0)
 . S D0=0 F  S D0=$O(^MAGDOUTP(2006.574,D0)) Q:'D0  D
"RTN","MAGIPS50",46,0)
 . . S X=$G(^MAGDOUTP(2006.574,D0,0)),LOC=$P(X,"^",4),PRI=$P(X,"^",5)
"RTN","MAGIPS50",47,0)
 . . S:'PRI PRI=500
"RTN","MAGIPS50",48,0)
 . . S D1=0 F  S D1=$O(^MAGDOUTP(2006.574,D0,1,D1)) Q:'D1  D
"RTN","MAGIPS50",49,0)
 . . . S STS=$P($G(^MAGDOUTP(2006.574,D0,1,D1,0)),"^",2)
"RTN","MAGIPS50",50,0)
 . . . I LOC'="",STS'="" S ^MAGDOUTP(2006.574,"STS",LOC,PRI,STS,D0,D1)=""
"RTN","MAGIPS50",51,0)
 . . . Q
"RTN","MAGIPS50",52,0)
 . . Q
"RTN","MAGIPS50",53,0)
 . Q
"RTN","MAGIPS50",54,0)
 ;
"RTN","MAGIPS50",55,0)
 D  ; Confirmation message
"RTN","MAGIPS50",56,0)
 . N CT,CNT,D,D0,D1,D2,DDATE,DG,DIC,DICR,DIW,MAGMSG,ST,XMID,XMY
"RTN","MAGIPS50",57,0)
 . ;
"RTN","MAGIPS50",58,0)
 . D GETENV^%ZOSV
"RTN","MAGIPS50",59,0)
 . S CNT=0
"RTN","MAGIPS50",60,0)
 . S CNT=CNT+1,MAGMSG(CNT)="PACKAGE INSTALL"
"RTN","MAGIPS50",61,0)
 . S CNT=CNT+1,MAGMSG(CNT)="SITE: "_$$KSP^XUPARAM("WHERE")
"RTN","MAGIPS50",62,0)
 . S CNT=CNT+1,MAGMSG(CNT)="PACKAGE: "_XPDNM
"RTN","MAGIPS50",63,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Version: "_$$VER^XPDUTL(XPDNM)
"RTN","MAGIPS50",64,0)
 . S ST=$$GET1^DIQ(9.7,XPDA,11,"I")
"RTN","MAGIPS50",65,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Start time: "_$$FMTE^XLFDT(ST)
"RTN","MAGIPS50",66,0)
 . S CT=$$GET1^DIQ(9.7,XPDA,17,"I") S:+CT'=CT CT=$$NOW^XLFDT()
"RTN","MAGIPS50",67,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Completion time: "_$$FMTE^XLFDT(CT)
"RTN","MAGIPS50",68,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Run time: "_$$FMDIFF^XLFDT(CT,ST,3)
"RTN","MAGIPS50",69,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Environment: "_Y
"RTN","MAGIPS50",70,0)
 . S CNT=CNT+1,MAGMSG(CNT)="FILE COMMENT: "_$$GET1^DIQ(9.7,XPDA,6,"I")
"RTN","MAGIPS50",71,0)
 . S CNT=CNT+1,MAGMSG(CNT)="DATE: "_$$NOW^XLFDT()
"RTN","MAGIPS50",72,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Installed by: "_$$GET1^DIQ(9.7,XPDA,9,"E")
"RTN","MAGIPS50",73,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Install Name: "_$$GET1^DIQ(9.7,XPDA,.01,"E")
"RTN","MAGIPS50",74,0)
 . S DDATE=$$GET1^DIQ(9.7,XPDA,51,"I")
"RTN","MAGIPS50",75,0)
 . S CNT=CNT+1,MAGMSG(CNT)="Distribution Date: "_$$FMTE^XLFDT(DDATE)
"RTN","MAGIPS50",76,0)
 . S:$G(CVT)'="" CNT=CNT+1,MAGMSG(CNT)="Conversion time: "_CVT
"RTN","MAGIPS50",77,0)
 . S XMSUB=XPDNM_" INSTALLATION"
"RTN","MAGIPS50",78,0)
 . S XMID=$G(DUZ) S:'XMID XMID=.5
"RTN","MAGIPS50",79,0)
 . S XMY(XMID)=""
"RTN","MAGIPS50",80,0)
 . S XMY("G.MAG SERVER")=""
"RTN","MAGIPS50",81,0)
 . S:$G(MAGDUZ) XMY(MAGDUZ)=""
"RTN","MAGIPS50",82,0)
 . S XMSUB=$E(XMSUB,1,63)
"RTN","MAGIPS50",83,0)
 . D SENDMSG^XMXAPI(XMID,XMSUB,"MAGMSG",.XMY,,.XMZ,)
"RTN","MAGIPS50",84,0)
 . I $G(XMERR) M XMERR=^TMP("XMERR",$J) S $EC=",U13-Cannot send MailMan message,"
"RTN","MAGIPS50",85,0)
 . Q
"RTN","MAGIPS50",86,0)
 Q
"RTN","MAGIPS50",87,0)
 ;
"RTN","MAGIPS50",88,0)
ADDRPC(RPCNAME,OPTNAME) N DA,DIC
"RTN","MAGIPS50",89,0)
 S DIC="^DIC(19,",DIC(0)="",X=OPTNAME D ^DIC
"RTN","MAGIPS50",90,0)
 I Y<0 D  Q
"RTN","MAGIPS50",91,0)
 . W !,"Cannot add """_RPCNAME_""" to """_OPTNAME_"""."
"RTN","MAGIPS50",92,0)
 . W !,"Cannot find """_OPTNAME_"""."
"RTN","MAGIPS50",93,0)
 . Q
"RTN","MAGIPS50",94,0)
 S DA(1)=+Y
"RTN","MAGIPS50",95,0)
 S DIC=DIC_DA(1)_",""RPC"","
"RTN","MAGIPS50",96,0)
 S DIC(0)="L" ; LAYGO should be allowed here
"RTN","MAGIPS50",97,0)
 S X=RPCNAME
"RTN","MAGIPS50",98,0)
 D ^DIC
"RTN","MAGIPS50",99,0)
 I Y<0 D  Q
"RTN","MAGIPS50",100,0)
 . W !,"Cannot add """_RPCNAME_""" to """_OPTNAME_"""."
"RTN","MAGIPS50",101,0)
 . W !,"Cannot find """_RPCNAME_"""."
"RTN","MAGIPS50",102,0)
 . Q
"RTN","MAGIPS50",103,0)
 Q
"RTN","MAGIPS50",104,0)
 ;
"SEC","^DIC",2006.563,2006.563,0,"AUDIT")
@
"SEC","^DIC",2006.563,2006.563,0,"DD")
@
"SEC","^DIC",2006.563,2006.563,0,"DEL")
@
"SEC","^DIC",2006.563,2006.563,0,"LAYGO")
@
"SEC","^DIC",2006.563,2006.563,0,"RD")
@
"SEC","^DIC",2006.563,2006.563,0,"WR")
@
"SEC","^DIC",2006.565,2006.565,0,"AUDIT")
@
"SEC","^DIC",2006.565,2006.565,0,"DD")
@
"SEC","^DIC",2006.565,2006.565,0,"DEL")
@
"SEC","^DIC",2006.565,2006.565,0,"LAYGO")
@
"SEC","^DIC",2006.565,2006.565,0,"RD")
@
"SEC","^DIC",2006.565,2006.565,0,"WR")
@
"SEC","^DIC",2006.574,2006.574,0,"AUDIT")
@
"SEC","^DIC",2006.574,2006.574,0,"DD")
@
"SEC","^DIC",2006.574,2006.574,0,"DEL")
@
"SEC","^DIC",2006.574,2006.574,0,"LAYGO")
@
"SEC","^DIC",2006.574,2006.574,0,"RD")
@
"SEC","^DIC",2006.574,2006.574,0,"WR")
@
"SEC","^DIC",2006.585,2006.585,0,"AUDIT")
@
"SEC","^DIC",2006.585,2006.585,0,"DD")
@
"SEC","^DIC",2006.585,2006.585,0,"DEL")
@
"SEC","^DIC",2006.585,2006.585,0,"LAYGO")
@
"SEC","^DIC",2006.585,2006.585,0,"RD")
@
"SEC","^DIC",2006.585,2006.585,0,"WR")
@
"VER")
8.0^22.0
"^DD",2005,2005,252,0)
NEW SOP INSTANCE UID^F^^SOP;2^K:$L(X)>64!($L(X)<1)!'($TR(X,"1234567890.")="") X
"^DD",2005,2005,252,3)
Enter the VA's new SOP instance UID for the corrected image.
"^DD",2005,2005,252,21,0)
^^8^8^3041109^
"^DD",2005,2005,252,21,1,0)
The value of this field is a string that represents a DICOM UID.
"^DD",2005,2005,252,21,2,0)
The DICOM standard defines the format of a UID: a string containing
"^DD",2005,2005,252,21,3,0)
only digits and periods that does not exceed a length of 64 characters.
"^DD",2005,2005,252,21,4,0)
This field is populated when a corrected version of an image
"^DD",2005,2005,252,21,5,0)
is exported, and the corrections are of such a nature that
"^DD",2005,2005,252,21,6,0)
the image cannot be exported with its original SOP Instance UID.
"^DD",2005,2005,252,21,7,0)
Note that this UID value is assigned by VA software, and thus
"^DD",2005,2005,252,21,8,0)
will always start with the characters "1.2.840.113754.".
"^DD",2005,2005,252,"DT")
3041109
"^DD",2005,2005,253,0)
SERIES UID^F^^SERIESUID;1^K:$L(X)>64!($L(X)<1)!'(X?1.64(1N,1".")) X
"^DD",2005,2005,253,1,0)
^.1^^0
"^DD",2005,2005,253,3)
Enter the Series UID for the current image.
"^DD",2005,2005,253,21,0)
^.001^5^5^3050712^^
"^DD",2005,2005,253,21,1,0)
The value of this field is a DICOM unique identifier for
"^DD",2005,2005,253,21,2,0)
the series to which an image belongs.
"^DD",2005,2005,253,21,3,0)
A DICOM UID looks like a series of digits and periods,
"^DD",2005,2005,253,21,4,0)
is not longer than 64 characters, starts and ends with a digit
"^DD",2005,2005,253,21,5,0)
and never has two consecutive periods.
"^DD",2005,2005,253,"DT")
3050803
"^DD",2005.1,2005.1,252,0)
NEW SOP INSTANCE UID^F^^SOP;2^K:$L(X)>64!($L(X)<1)!'($TR(X,"1234567890.")="") X
"^DD",2005.1,2005.1,252,3)
Enter the VA's new SOP instance UID for the corrected image.
"^DD",2005.1,2005.1,252,21,0)
^^8^8^3041109^
"^DD",2005.1,2005.1,252,21,1,0)
The value of this field is a string that represents a DICOM UID.
"^DD",2005.1,2005.1,252,21,2,0)
The DICOM standard defines the format of a UID: a string containing
"^DD",2005.1,2005.1,252,21,3,0)
only digits and periods that does not exceed a length of 64 characters.
"^DD",2005.1,2005.1,252,21,4,0)
This field is populated when a corrected version of an image
"^DD",2005.1,2005.1,252,21,5,0)
is exported, and the corrections are of such a nature that
"^DD",2005.1,2005.1,252,21,6,0)
the image cannot be exported with its original SOP Instance UID.
"^DD",2005.1,2005.1,252,21,7,0)
Note that this UID value is assigned by VA software, and thus
"^DD",2005.1,2005.1,252,21,8,0)
will always start with the characters "1.2.840.113754.".
"^DD",2005.1,2005.1,252,"DT")
3041109
"^DD",2005.1,2005.1,253,0)
SERIES UID^F^^SERIESUID;1^K:$L(X)>64!($L(X)<1)!'(X?1.64(1N,1".")) X
"^DD",2005.1,2005.1,253,1,0)
^.1^^0
"^DD",2005.1,2005.1,253,3)
Enter the Series UID for the current image.
"^DD",2005.1,2005.1,253,21,0)
^.001^5^5^3050712^^
"^DD",2005.1,2005.1,253,21,1,0)
The value of this field is a DICOM unique identifier for
"^DD",2005.1,2005.1,253,21,2,0)
the series to which an image belongs.
"^DD",2005.1,2005.1,253,21,3,0)
A DICOM UID looks like a series of digits and periods,
"^DD",2005.1,2005.1,253,21,4,0)
is not longer than 64 characters, starts and ends with a digit
"^DD",2005.1,2005.1,253,21,5,0)
and never has two consecutive periods.
"^DD",2005.1,2005.1,253,"DT")
3050803
"^DD",2006.563,2006.563,0)
FIELD^^104^96
"^DD",2006.563,2006.563,0,"DDA")
N
"^DD",2006.563,2006.563,0,"DT")
3051007
"^DD",2006.563,2006.563,0,"NM","DICOM GATEWAY PARAMETER")

"^DD",2006.563,2006.563,0,"VRPK")
IMAGING
"^DD",2006.563,2006.563,.01,0)
SYSTEM TITLE^RF^^SYSTEM TITLE;1^K:$L(X)>60!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.563,2006.563,.01,1,0)
^.1^^0
"^DD",2006.563,2006.563,.01,3)
Enter a descriptive text for this Gateway Station.
"^DD",2006.563,2006.563,.01,21,0)
^^6^6^3000218^^
"^DD",2006.563,2006.563,.01,21,1,0)
The value of this field is a text that identifies
"^DD",2006.563,2006.563,.01,21,2,0)
the computer on which this database is stored.
"^DD",2006.563,2006.563,.01,21,3,0)
 
"^DD",2006.563,2006.563,.01,21,4,0)
Note that each VistA DICOM Gateway computer has its
"^DD",2006.563,2006.563,.01,21,5,0)
own copy of ^MAGDICOM, in which these site-parameters
"^DD",2006.563,2006.563,.01,21,6,0)
are stored.
"^DD",2006.563,2006.563,2,0)
ASCII DICOM TEXT^F^^ASCII DICOM TEXT;1^K:$L(X)>10!($L(X)<1) X
"^DD",2006.563,2006.563,2,3)
Indicate whether or not ASCII Text files are to be produced.
"^DD",2006.563,2006.563,2,21,0)
^^16^16^3000218^^
"^DD",2006.563,2006.563,2,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,2,21,2,0)
whether or not files will be created that make the
"^DD",2006.563,2006.563,2,21,3,0)
data-streams that are exchanged according to the
"^DD",2006.563,2006.563,2,21,4,0)
DICOM protocol available in a human-readable form.
"^DD",2006.563,2006.563,2,21,5,0)
 
"^DD",2006.563,2006.563,2,21,6,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,2,21,7,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,2,21,8,0)
 
"^DD",2006.563,2006.563,2,21,9,0)
The human-readable files will have a file name
"^DD",2006.563,2006.563,2,21,10,0)
extension of '.TXT'.
"^DD",2006.563,2006.563,2,21,11,0)
 
"^DD",2006.563,2006.563,2,21,12,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,2,21,13,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,2,21,14,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,2,21,15,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,2,21,16,0)
system (DDP) is available.
"^DD",2006.563,2006.563,2,"DT")
2991018
"^DD",2006.563,2006.563,3,0)
COMMERCIAL PACS^F^^COMMERCIAL PACS;1^K:$L(X)>10!($L(X)<1) X
"^DD",2006.563,2006.563,3,3)
Indicate whether or not a commercial PACS is present.
"^DD",2006.563,2006.563,3,21,0)
^^13^13^3000218^^
"^DD",2006.563,2006.563,3,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,3,21,2,0)
if a PACS is present at the site, and, if so,
"^DD",2006.563,2006.563,3,21,3,0)
whether or not this PACS has a brand-name of
"^DD",2006.563,2006.563,3,21,4,0)
General Electric.
"^DD",2006.563,2006.563,3,21,5,0)
 
"^DD",2006.563,2006.563,3,21,6,0)
Possible values for this code are 'N/A',
"^DD",2006.563,2006.563,3,21,7,0)
'GE' and 'NON-GE'.
"^DD",2006.563,2006.563,3,21,8,0)
 
"^DD",2006.563,2006.563,3,21,9,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,3,21,10,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,3,21,11,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,3,21,12,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,3,21,13,0)
system (DDP) is available.
"^DD",2006.563,2006.563,3,"DT")
2991018
"^DD",2006.563,2006.563,4,0)
DATA PATH^2006.5631A^^DATA PATH;0
"^DD",2006.563,2006.563,4,3)
Enter the directory path name for the location where data is to be stored.
"^DD",2006.563,2006.563,4,"DT")
2991018
"^DD",2006.563,2006.563,5,0)
DICT PATH^F^^DICT PATH;1^K:$L(X)>10!($L(X)<1) X
"^DD",2006.563,2006.563,5,3)
Enter the directory path name for the location where master files are stored.
"^DD",2006.563,2006.563,5,21,0)
^^6^6^3000218^^
"^DD",2006.563,2006.563,5,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.563,5,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.563,5,21,3,0)
'dictionary' files (also known as 'master files).
"^DD",2006.563,2006.563,5,21,4,0)
 
"^DD",2006.563,2006.563,5,21,5,0)
These 'master files' contain the various tables
"^DD",2006.563,2006.563,5,21,6,0)
that drive the operation of the VistA DICOM Gateways.
"^DD",2006.563,2006.563,5,"DT")
2991018
"^DD",2006.563,2006.563,6,0)
HIS/RIS^F^^HIS/RIS;1^K:$L(X)>10!($L(X)<1) X
"^DD",2006.563,2006.563,6,3)
Enter the name of the HIS or RIS that is being used.
"^DD",2006.563,2006.563,6,21,0)
^^11^11^3000218^^
"^DD",2006.563,2006.563,6,21,1,0)
The value of this field is a code that identifies
"^DD",2006.563,2006.563,6,21,2,0)
the type of Hospital Information System that is being
"^DD",2006.563,2006.563,6,21,3,0)
used at the site.
"^DD",2006.563,2006.563,6,21,4,0)
 
"^DD",2006.563,2006.563,6,21,5,0)
Currently, this value is always equal to 'VISTA'.
"^DD",2006.563,2006.563,6,21,6,0)
 
"^DD",2006.563,2006.563,6,21,7,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,6,21,8,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,6,21,9,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,6,21,10,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,6,21,11,0)
system (DDP) is available.
"^DD",2006.563,2006.563,6,"DT")
2991018
"^DD",2006.563,2006.563,7,0)
IMAGE INPUT PATH^F^^IMAGE INPUT PATH;1^K:$L(X)>50!($L(X)<1) X
"^DD",2006.563,2006.563,7,3)
Enter the name of the directory where incoming images are stored.
"^DD",2006.563,2006.563,7,21,0)
^^4^4^3000218^^
"^DD",2006.563,2006.563,7,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.563,7,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.563,7,21,3,0)
files that are being used by the VistA DICOM Image
"^DD",2006.563,2006.563,7,21,4,0)
Gateway for newly created image files.
"^DD",2006.563,2006.563,7,"DT")
2991018
"^DD",2006.563,2006.563,8,0)
IMAGE OUTPUT PATH^F^^IMAGE OUTPUT PATH;1^K:$L(X)>50!($L(X)<1) X
"^DD",2006.563,2006.563,8,3)
Enter the name of the directory where outgoing images are stored.
"^DD",2006.563,2006.563,8,21,0)
^^5^5^3000218^^
"^DD",2006.563,2006.563,8,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.563,8,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.563,8,21,3,0)
files that are being used by the VistA DICOM Image
"^DD",2006.563,2006.563,8,21,4,0)
Gateway for image files that need to be copied
"^DD",2006.563,2006.563,8,21,5,0)
to other destinations.
"^DD",2006.563,2006.563,8,"DT")
2991018
"^DD",2006.563,2006.563,9,0)
MACHINE ID^F^^MACHINE ID;1^K:$L(X)>1!($L(X)<1) X
"^DD",2006.563,2006.563,9,.1)
Machine ID
"^DD",2006.563,2006.563,9,3)
Enter the letter for the current processor.
"^DD",2006.563,2006.563,9,21,0)
^^7^7^3000229^^
"^DD",2006.563,2006.563,9,21,1,0)
The value of this field is a single-character
"^DD",2006.563,2006.563,9,21,2,0)
code that identifies the computer on which this
"^DD",2006.563,2006.563,9,21,3,0)
database is stored.
"^DD",2006.563,2006.563,9,21,4,0)
 
"^DD",2006.563,2006.563,9,21,5,0)
This code will be used as a prefix for names
"^DD",2006.563,2006.563,9,21,6,0)
of image files that are created by the software
"^DD",2006.563,2006.563,9,21,7,0)
that runs on this computer.
"^DD",2006.563,2006.563,9,"DT")
2991018
"^DD",2006.563,2006.563,10,0)
MESSAGE LOG^S^YES:YES;NO:NO;^MESSAGE LOG;1^Q
"^DD",2006.563,2006.563,10,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,10,21,0)
^.001^15^15^3001004^^^
"^DD",2006.563,2006.563,10,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,10,21,2,0)
whether or not diagnostic messages will be kept in
"^DD",2006.563,2006.563,10,21,3,0)
a global variable after they have been displayed on
"^DD",2006.563,2006.563,10,21,4,0)
a monitor.
"^DD",2006.563,2006.563,10,21,5,0)
 
"^DD",2006.563,2006.563,10,21,6,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,10,21,7,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,10,21,8,0)
 
"^DD",2006.563,2006.563,10,21,9,0)
It is recommended that this value always be set to 'YES'.
"^DD",2006.563,2006.563,10,21,10,0)
 
"^DD",2006.563,2006.563,10,21,11,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,10,21,12,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,10,21,13,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,10,21,14,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,10,21,15,0)
system (DDP) is available.
"^DD",2006.563,2006.563,10,"DT")
3001004
"^DD",2006.563,2006.563,11,0)
INSTRUMENT PATH^F^^INSTRUMENT PATH;1^K:$L(X)>50!($L(X)<1) X
"^DD",2006.563,2006.563,11,3)
Enter the name of the directory where the ASCII Text files are stored.
"^DD",2006.563,2006.563,11,21,0)
^^5^5^3000218^^
"^DD",2006.563,2006.563,11,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.563,11,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.563,11,21,3,0)
files that are being used by the VistA DICOM Image
"^DD",2006.563,2006.563,11,21,4,0)
Gateway to store intermediate copies of image files
"^DD",2006.563,2006.563,11,21,5,0)
as they are received by the C-Store program.
"^DD",2006.563,2006.563,11,"DT")
3000218
"^DD",2006.563,2006.563,12,0)
MODALITY WORKLIST^S^YES:YES;NO:NO;^MODALITY WORKLIST;1^Q
"^DD",2006.563,2006.563,12,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,12,21,0)
^.001^7^7^3001004^^^^
"^DD",2006.563,2006.563,12,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,12,21,2,0)
whether or not the machine on which this table is
"^DD",2006.563,2006.563,12,21,3,0)
stored will be executing the tasks of a Modality
"^DD",2006.563,2006.563,12,21,4,0)
Worklist Provider.
"^DD",2006.563,2006.563,12,21,5,0)
 
"^DD",2006.563,2006.563,12,21,6,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,12,21,7,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,12,"DT")
3001004
"^DD",2006.563,2006.563,13,0)
PACS IMAGES^S^YES:YES;NO:NO;^PACS IMAGES;1^Q
"^DD",2006.563,2006.563,13,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,13,21,0)
^.001^12^12^3001004^^^
"^DD",2006.563,2006.563,13,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,13,21,2,0)
whether or not a PACS will be sending images to
"^DD",2006.563,2006.563,13,21,3,0)
the VistA Hospital Information System.
"^DD",2006.563,2006.563,13,21,4,0)
 
"^DD",2006.563,2006.563,13,21,5,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,13,21,6,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,13,21,7,0)
 
"^DD",2006.563,2006.563,13,21,8,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,13,21,9,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,13,21,10,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,13,21,11,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,13,21,12,0)
system (DDP) is available.
"^DD",2006.563,2006.563,13,"DT")
3001004
"^DD",2006.563,2006.563,14,0)
ROUTING RULES^S^YES:YES;NO:NO;^ROUTING RULES;1^Q
"^DD",2006.563,2006.563,14,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,14,21,0)
^.001^19^19^3021209^^^^
"^DD",2006.563,2006.563,14,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,14,21,2,0)
whether or not the site where this table is stored
"^DD",2006.563,2006.563,14,21,3,0)
is using the automated routing facility that is part
"^DD",2006.563,2006.563,14,21,4,0)
of the VistA DICOM Gateway.
"^DD",2006.563,2006.563,14,21,5,0)
 
"^DD",2006.563,2006.563,14,21,6,0)
Automated routing is not included in Version 2.5
"^DD",2006.563,2006.563,14,21,7,0)
of the VistA DICOM Gateway and only sites that are
"^DD",2006.563,2006.563,14,21,8,0)
executing an pre-alpha test of this functionality
"^DD",2006.563,2006.563,14,21,9,0)
should set this parameter to YES.
"^DD",2006.563,2006.563,14,21,10,0)
All other sites should set this parameter to NO.
"^DD",2006.563,2006.563,14,21,11,0)
 
"^DD",2006.563,2006.563,14,21,12,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,14,21,13,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,14,21,14,0)
 
"^DD",2006.563,2006.563,14,21,15,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,14,21,16,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,14,21,17,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,14,21,18,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,14,21,19,0)
system (DDP) is available.
"^DD",2006.563,2006.563,14,"DT")
3021209
"^DD",2006.563,2006.563,15,0)
SCRATCH^F^^SCRATCH;1^K:$L(X)>50!($L(X)<1) X
"^DD",2006.563,2006.563,15,3)
Enter the name of the directory where scratch files may be stored.
"^DD",2006.563,2006.563,15,21,0)
^^7^7^3000218^^
"^DD",2006.563,2006.563,15,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.563,15,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.563,15,21,3,0)
temporary files that are used by the VistA DICOM
"^DD",2006.563,2006.563,15,21,4,0)
Gateway.
"^DD",2006.563,2006.563,15,21,5,0)
 
"^DD",2006.563,2006.563,15,21,6,0)
Typically, the value of this field will be equal to
"^DD",2006.563,2006.563,15,21,7,0)
c:\temp\
"^DD",2006.563,2006.563,15,"DT")
2991018
"^DD",2006.563,2006.563,16,0)
SEND PACS TEXT^S^YES:YES;NO:NO;^SEND PACS TEXT;1^Q
"^DD",2006.563,2006.563,16,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,16,21,0)
^.001^7^7^3001004^^^
"^DD",2006.563,2006.563,16,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,16,21,2,0)
whether or not the VistA DICOM Gateway computer
"^DD",2006.563,2006.563,16,21,3,0)
on which this table is stored will be transmitting
"^DD",2006.563,2006.563,16,21,4,0)
text messages to a PACS.
"^DD",2006.563,2006.563,16,21,5,0)
 
"^DD",2006.563,2006.563,16,21,6,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,16,21,7,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,16,"DT")
3001004
"^DD",2006.563,2006.563,17,0)
PLACE^P4'^DIC(4,^LOCATION;1^Q
"^DD",2006.563,2006.563,17,3)
Enter the name of the institution where this gateway resides.
"^DD",2006.563,2006.563,17,21,0)
^^3^3^3010309^
"^DD",2006.563,2006.563,17,21,1,0)
The value of this field is a pointer to the Institution file (#4).
"^DD",2006.563,2006.563,17,21,2,0)
This value identifies the institution where this DICOM Gateway
"^DD",2006.563,2006.563,17,21,3,0)
computer resides.
"^DD",2006.563,2006.563,17,"DT")
3010309
"^DD",2006.563,2006.563,18,0)
UID ROOT^F^^UID ROOT;1^K:$L(X)>64!($L(X)<1) X
"^DD",2006.563,2006.563,18,3)
Enter the UID root for this installation.
"^DD",2006.563,2006.563,18,21,0)
^^14^14^3000218^^
"^DD",2006.563,2006.563,18,21,1,0)
The value of this field is a code that identifies
"^DD",2006.563,2006.563,18,21,2,0)
the 'root' for unique identifiers that are
"^DD",2006.563,2006.563,18,21,3,0)
created for the purpose of uniquely identifying
"^DD",2006.563,2006.563,18,21,4,0)
DICOM objects.
"^DD",2006.563,2006.563,18,21,5,0)
 
"^DD",2006.563,2006.563,18,21,6,0)
This value has been assigned to the Veterans Administration
"^DD",2006.563,2006.563,18,21,7,0)
by the American National Standards Institute and
"^DD",2006.563,2006.563,18,21,8,0)
may not be changed by any site.
"^DD",2006.563,2006.563,18,21,9,0)
 
"^DD",2006.563,2006.563,18,21,10,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,18,21,11,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,18,21,12,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,18,21,13,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,18,21,14,0)
system (DDP) is available.
"^DD",2006.563,2006.563,18,"DT")
2991018
"^DD",2006.563,2006.563,19,0)
VERSION^F^^VERSION;1^K:$L(X)>64!($L(X)<1) X
"^DD",2006.563,2006.563,19,3)
Answer must be 1-64 characters in length.
"^DD",2006.563,2006.563,19,21,0)
^^11^11^3000218^^
"^DD",2006.563,2006.563,19,21,1,0)
The value of this field is a code that identifies
"^DD",2006.563,2006.563,19,21,2,0)
the version of the implementation of the VA DICOM
"^DD",2006.563,2006.563,19,21,3,0)
SOP Classes.
"^DD",2006.563,2006.563,19,21,4,0)
 
"^DD",2006.563,2006.563,19,21,5,0)
This value should not be modified by any sites.
"^DD",2006.563,2006.563,19,21,6,0)
 
"^DD",2006.563,2006.563,19,21,7,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,19,21,8,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,19,21,9,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,19,21,10,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,19,21,11,0)
system (DDP) is available.
"^DD",2006.563,2006.563,19,"DT")
2991018
"^DD",2006.563,2006.563,20,0)
HL7 POINTER^P2006.5'^MAGDHL7(2006.5,^HL7_PTR;1^Q
"^DD",2006.563,2006.563,20,3)
Enter the internal entry number of a HL7 message.
"^DD",2006.563,2006.563,20,21,0)
^^11^11^3000218^^
"^DD",2006.563,2006.563,20,21,1,0)
The value of this field is a pointer to the table that
"^DD",2006.563,2006.563,20,21,2,0)
contains the HL7-messages that are to be processed by
"^DD",2006.563,2006.563,20,21,3,0)
a VistA DICOM Text Gateway.
"^DD",2006.563,2006.563,20,21,4,0)
This value corresponds to the internal entry number
"^DD",2006.563,2006.563,20,21,5,0)
of the last message that was processed.
"^DD",2006.563,2006.563,20,21,6,0)
 
"^DD",2006.563,2006.563,20,21,7,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,20,21,8,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,20,21,9,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,20,21,10,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,20,21,11,0)
system (DDP) is available.
"^DD",2006.563,2006.563,20,"DT")
3000222
"^DD",2006.563,2006.563,21,0)
FREE DISK SPACE^NJ3,0^^FREE DISK SPACE;1^K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,21,3)
Enter the percentage of free disk space required to allow C-Store.
"^DD",2006.563,2006.563,21,21,0)
^^5^5^3000218^^
"^DD",2006.563,2006.563,21,21,1,0)
The value of this field is an integer number that
"^DD",2006.563,2006.563,21,21,2,0)
indicates the percentage of disk space that needs to
"^DD",2006.563,2006.563,21,21,3,0)
be left as free space. The acquisition of image files
"^DD",2006.563,2006.563,21,21,4,0)
will be suspended when the amount of free disk space
"^DD",2006.563,2006.563,21,21,5,0)
drops below this threshold.
"^DD",2006.563,2006.563,21,"DT")
2991020
"^DD",2006.563,2006.563,22,0)
TEXT GATEWAY^S^YES:YES;NO:NO;^TEXT GATEWAY;1^Q
"^DD",2006.563,2006.563,22,3)
Enter 'YES' or 'NO'.
"^DD",2006.563,2006.563,22,21,0)
^.001^6^6^3001004^^^
"^DD",2006.563,2006.563,22,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,22,21,2,0)
whether or not the computer on which this table
"^DD",2006.563,2006.563,22,21,3,0)
is stored will operate as a Text Gateway.
"^DD",2006.563,2006.563,22,21,4,0)
 
"^DD",2006.563,2006.563,22,21,5,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,22,21,6,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,22,"DT")
3001004
"^DD",2006.563,2006.563,23,0)
LAST SYSTEM REPORT^NJ7,0^^DAILY REPORT;1^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,23,3)
Enter the $HOROLOG number of the date of the last site report.
"^DD",2006.563,2006.563,23,21,0)
^^7^7^3001004^^
"^DD",2006.563,2006.563,23,21,1,0)
The value of this field is a code for the date on which
"^DD",2006.563,2006.563,23,21,2,0)
the most recent system report was e-mailed to the VistA
"^DD",2006.563,2006.563,23,21,3,0)
central repository.
"^DD",2006.563,2006.563,23,21,4,0)
This value is encoded as a $HOROLOG date.
"^DD",2006.563,2006.563,23,21,5,0)
This value is calculated by the application as the
"^DD",2006.563,2006.563,23,21,6,0)
report in question is being produced, and never entered
"^DD",2006.563,2006.563,23,21,7,0)
by an end-user.
"^DD",2006.563,2006.563,23,"DT")
3000222
"^DD",2006.563,2006.563,24,0)
POST OFFICE^F^^POST OFFICE;1^K:$L(X)>64!($L(X)<1) X
"^DD",2006.563,2006.563,24,3)
Enter the IP address of the SMTP post office for this site.
"^DD",2006.563,2006.563,24,21,0)
^^9^9^3000218^^
"^DD",2006.563,2006.563,24,21,1,0)
The value of this field is the IP address of the
"^DD",2006.563,2006.563,24,21,2,0)
computer that will function as the SMTP post office
"^DD",2006.563,2006.563,24,21,3,0)
for sending e-mail from this site.
"^DD",2006.563,2006.563,24,21,4,0)
 
"^DD",2006.563,2006.563,24,21,5,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,24,21,6,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,24,21,7,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,24,21,8,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,24,21,9,0)
system (DDP) is available.
"^DD",2006.563,2006.563,24,"DT")
3000222
"^DD",2006.563,2006.563,25,0)
CONSOLIDATED IMAGING SOFTWARE^S^YES:Consolidated;NO:Non-Consolidated;^CONSOLIDATED;1^Q
"^DD",2006.563,2006.563,25,3)
Indicate whether or not this site is running the consolidated Imaging software.
"^DD",2006.563,2006.563,25,21,0)
^^6^6^3021212^
"^DD",2006.563,2006.563,25,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,25,21,2,0)
the current site is running the consolidated version of the Imaging
"^DD",2006.563,2006.563,25,21,3,0)
software.
"^DD",2006.563,2006.563,25,21,4,0)
 
"^DD",2006.563,2006.563,25,21,5,0)
A value of "YES" indicates that the consolidated software is in use.
"^DD",2006.563,2006.563,25,21,6,0)
A value of "NO" indicates that the non-consolidated software is in use.
"^DD",2006.563,2006.563,25,"DT")
3021212
"^DD",2006.563,2006.563,26,0)
CPT MODIFIER^S^YES:YES;NO:NO;^SEND CPT MODIFIERS;1^Q
"^DD",2006.563,2006.563,26,3)
Indicate whether or not this computer will include CPT modifier codes in messages.
"^DD",2006.563,2006.563,26,21,0)
^^7^7^3000218^^
"^DD",2006.563,2006.563,26,21,1,0)
The value of this field is a code that indicates
"^DD",2006.563,2006.563,26,21,2,0)
whether or not CPT modifier codes will be included in
"^DD",2006.563,2006.563,26,21,3,0)
messages that are transmitted by the computer on which
"^DD",2006.563,2006.563,26,21,4,0)
this table is stored.
"^DD",2006.563,2006.563,26,21,5,0)
 
"^DD",2006.563,2006.563,26,21,6,0)
Possible values for this code are 'YES' and 'NO'
"^DD",2006.563,2006.563,26,21,7,0)
(fully spelled, in capitals).
"^DD",2006.563,2006.563,26,"DT")
3000222
"^DD",2006.563,2006.563,27,0)
TIME ZONE OFFSET^NJ4,0^^TIME ZONE;1^K:+X'=X!(X>2500)!(X<-2500)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,27,3)
Enter the ISO code for the time zone offset for this computer.
"^DD",2006.563,2006.563,27,21,0)
^^17^17^3000218^^
"^DD",2006.563,2006.563,27,21,1,0)
The value of this field is an integer number that
"^DD",2006.563,2006.563,27,21,2,0)
indicates the time zone offset for the computer on
"^DD",2006.563,2006.563,27,21,3,0)
which this table is stored.
"^DD",2006.563,2006.563,27,21,4,0)
 
"^DD",2006.563,2006.563,27,21,5,0)
The time zone offset is encoded as 100*hours+minutes,
"^DD",2006.563,2006.563,27,21,6,0)
and is a positive number when the time is later than
"^DD",2006.563,2006.563,27,21,7,0)
GMT (Greenwich Mean Time), or a negative number when
"^DD",2006.563,2006.563,27,21,8,0)
the time is earlier than GMT.
"^DD",2006.563,2006.563,27,21,9,0)
 
"^DD",2006.563,2006.563,27,21,10,0)
E.g. EST in the USA corresponds to a time zone offset
"^DD",2006.563,2006.563,27,21,11,0)
of -500.
"^DD",2006.563,2006.563,27,21,12,0)
 
"^DD",2006.563,2006.563,27,21,13,0)
This value is stored in this table (^MAGDICOM(2006.563,...
"^DD",2006.563,2006.563,27,21,14,0)
rather than in ^MAG(2006.1,...), because the VistA
"^DD",2006.563,2006.563,27,21,15,0)
DICOM Gateway will need to be able to access this
"^DD",2006.563,2006.563,27,21,16,0)
value whether or not the network link with the VistA
"^DD",2006.563,2006.563,27,21,17,0)
system (DDP) is available.
"^DD",2006.563,2006.563,27,"DT")
3000222
"^DD",2006.563,2006.563,28,0)
LOCATION NAME^F^^LOCATION NAME;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,28,3)
Enter the name of the location to which this station belongs.
"^DD",2006.563,2006.563,28,21,0)
^^7^7^3011016^
"^DD",2006.563,2006.563,28,21,1,0)
The value of this field is a string that represents the name
"^DD",2006.563,2006.563,28,21,2,0)
of a site. Its value is copied from the INSTITUTION file when
"^DD",2006.563,2006.563,28,21,3,0)
a value is assigned to the field LOCATION in this table.
"^DD",2006.563,2006.563,28,21,4,0)
 
"^DD",2006.563,2006.563,28,21,5,0)
A DICOM Gateway stores a redundant copy of this name, so that
"^DD",2006.563,2006.563,28,21,6,0)
it will be able to display the name when DDP is not available,
"^DD",2006.563,2006.563,28,21,7,0)
and the value cannot be fetched from ^DIC.
"^DD",2006.563,2006.563,28,"DT")
3011016
"^DD",2006.563,2006.563,29,0)
ACCESS CODE^F^^LOGIN ACCESS;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,29,3)
Enter the access code for this gateway.
"^DD",2006.563,2006.563,29,21,0)
^^2^2^3010226^
"^DD",2006.563,2006.563,29,21,1,0)
The value of this field is a string that represents the access code that will be used
"^DD",2006.563,2006.563,29,21,2,0)
to operate this DICOM Gateway.
"^DD",2006.563,2006.563,29,"DT")
3010226
"^DD",2006.563,2006.563,30,0)
VERIFY CODE^F^^LOGIN VERIFY;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,30,3)
Enter the verify code for this gateway.
"^DD",2006.563,2006.563,30,21,0)
^^2^2^3010226^
"^DD",2006.563,2006.563,30,21,1,0)
The value of this field is a string that represents the verify
"^DD",2006.563,2006.563,30,21,2,0)
code that will be used to operate this DICOM Gateway.
"^DD",2006.563,2006.563,30,"DT")
3010226
"^DD",2006.563,2006.563,31,0)
READ ONLY ACCESS^F^^LOGIN PRINT/VIEW ONLY;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,31,3)
Enter the read-only access code for this gateway.
"^DD",2006.563,2006.563,31,21,0)
^^2^2^3010226^
"^DD",2006.563,2006.563,31,21,1,0)
The value of this field is a string that represents the access
"^DD",2006.563,2006.563,31,21,2,0)
code that will be used to operate this gateway in "read only" mode.
"^DD",2006.563,2006.563,31,"DT")
3010226
"^DD",2006.563,2006.563,32,0)
PROGRAMMER ACCESS^F^^LOGIN PROGRAMMER ACCESS;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,32,3)
Enter the programmer access code for this gateway.
"^DD",2006.563,2006.563,32,21,0)
^^2^2^3010226^
"^DD",2006.563,2006.563,32,21,1,0)
The value of this field is a string that represents the access
"^DD",2006.563,2006.563,32,21,2,0)
code that will be used to gain programmer access to this gateway.
"^DD",2006.563,2006.563,32,"DT")
3010226
"^DD",2006.563,2006.563,33,0)
EVALUATOR^S^0:No;1:Yes;^EVAL;1^Q
"^DD",2006.563,2006.563,33,3)
Indicate whether a Rule Evaluator may currently run on this computer.
"^DD",2006.563,2006.563,33,21,0)
^^7^7^3020809^
"^DD",2006.563,2006.563,33,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,33,21,2,0)
a Rule Evaluator may currently run on this computer.
"^DD",2006.563,2006.563,33,21,3,0)
 
"^DD",2006.563,2006.563,33,21,4,0)
This flag is automatically set to 1 (yes) when the menu option
"^DD",2006.563,2006.563,33,21,5,0)
is used to start a Rule Evaluator, and to 0 (no) when the
"^DD",2006.563,2006.563,33,21,6,0)
menu option is used to stop all Rule Evaluators.
"^DD",2006.563,2006.563,33,21,7,0)
 
"^DD",2006.563,2006.563,33,"DT")
3020809
"^DD",2006.563,2006.563,34,0)
CSTORE CONTROL PORT^NJ5,0^^CSTORE CONTROL PORT;1^K:+X'=X!(X>65535)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,34,3)
Enter a TCP/IP port number (between 1 and 65535).
"^DD",2006.563,2006.563,34,21,0)
^.001^6^6^3020828^^
"^DD",2006.563,2006.563,34,21,1,0)
The value of this field is an integer number that identifies
"^DD",2006.563,2006.563,34,21,2,0)
the TCP/IP port that will be used by each C-Store process to
"^DD",2006.563,2006.563,34,21,3,0)
obtain information from a DICOM Gateway.
"^DD",2006.563,2006.563,34,21,4,0)
 
"^DD",2006.563,2006.563,34,21,5,0)
The information provided is limited to known "modalities" and
"^DD",2006.563,2006.563,34,21,6,0)
which port numbers are assigned to these modalities.
"^DD",2006.563,2006.563,34,"DT")
3020828
"^DD",2006.563,2006.563,35,0)
WORKLIST PORT^NJ5,0^^WORKLIST PORT;1^K:+X'=X!(X>65535)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,35,3)
Enter a TCP/IP port number (between 1 and 65535).
"^DD",2006.563,2006.563,35,21,0)
^^3^3^3020828^
"^DD",2006.563,2006.563,35,21,1,0)
The value of this field is an integer number that identifies
"^DD",2006.563,2006.563,35,21,2,0)
the TCP/IP port that will be used by DICOM WorkList processes
"^DD",2006.563,2006.563,35,21,3,0)
to post their requests and obtain their results.
"^DD",2006.563,2006.563,35,"DT")
3020828
"^DD",2006.563,2006.563,36,0)
VISTA RPC PORT^NJ5,0^^M-to-M BROKER PORT;1^K:+X'=X!(X>65535)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,36,3)
Enter the port number for the MUMPS-to-MUMPS broker on the VistA system
"^DD",2006.563,2006.563,36,21,0)
^.001^3^3^3021107^^
"^DD",2006.563,2006.563,36,21,1,0)
The value of this field is an integer number between 0 and
"^DD",2006.563,2006.563,36,21,2,0)
65,535 that identifies the port number on which a
"^DD",2006.563,2006.563,36,21,3,0)
(MUMPS-to-MUMPS) RPC broker is "listening" on the VistA system.
"^DD",2006.563,2006.563,36,"DT")
3021002
"^DD",2006.563,2006.563,37,0)
VISTA RPC IP ADDRESS^F^^M-to-M BROKER ADDR;1^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.563,37,3)
Enter the IP address of the VistA system.
"^DD",2006.563,2006.563,37,21,0)
^^3^3^3021002^
"^DD",2006.563,2006.563,37,21,1,0)
The value of this field is a string that identifies the IP address
"^DD",2006.563,2006.563,37,21,2,0)
of the VistA system. This IP address is used to establish
"^DD",2006.563,2006.563,37,21,3,0)
a MUMPS-to-MUMPS RPC broker connection.
"^DD",2006.563,2006.563,37,"DT")
3021002
"^DD",2006.563,2006.563,38,0)
PROFILE^2006.5632A^^PROFILE;0
"^DD",2006.563,2006.563,40,0)
MAILGROUP^F^^MAILGROUP;1^K:$L(X)>240!($L(X)<5) X
"^DD",2006.563,2006.563,40,3)
Enter the name of a mailgroup for emergency messages.
"^DD",2006.563,2006.563,40,21,0)
^^6^6^3021118^
"^DD",2006.563,2006.563,40,21,1,0)
The value of this field is a string that identifies a (SMTP) mailgroup.
"^DD",2006.563,2006.563,40,21,2,0)
When emergencies arise, a DICOM Gateway will send an e-mail message
"^DD",2006.563,2006.563,40,21,3,0)
to this mailgroup.
"^DD",2006.563,2006.563,40,21,4,0)
Since the emergency might be that the connection with the VistA system
"^DD",2006.563,2006.563,40,21,5,0)
is temporarily not available, such messages are sent by SMTP mail,
"^DD",2006.563,2006.563,40,21,6,0)
not by FORUM mail.
"^DD",2006.563,2006.563,40,"DT")
3021118
"^DD",2006.563,2006.563,46,0)
DELAY FOR C-MOVE TO EMED^NJ5,0^^EMED_C_MOVE_DELAY;1^K:+X'=X!(X>36000)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,46,3)
Enter the waiting time (seconds) before a C-Move to an E-Med may occur.
"^DD",2006.563,2006.563,46,21,0)
^^4^4^3021212^
"^DD",2006.563,2006.563,46,21,1,0)
The value of this field is an integer number. This number indicates
"^DD",2006.563,2006.563,46,21,2,0)
the waiting time (in seconds) that has to elapse between the
"^DD",2006.563,2006.563,46,21,3,0)
acquisition of an image and the time when this image may be
"^DD",2006.563,2006.563,46,21,4,0)
relayed on to an E-Med picture archival system.
"^DD",2006.563,2006.563,46,"DT")
3021212
"^DD",2006.563,2006.563,47,0)
LAST IMAGE POINTER^P2005'^MAG(2005,^LAST IMAGE POINTER;1^Q
"^DD",2006.563,2006.563,47,3)
Indicate the highest-numbered image processed.
"^DD",2006.563,2006.563,47,21,0)
^^10^10^3021212^^
"^DD",2006.563,2006.563,47,21,1,0)
The value of this field is a pointer to the Image File (#2005).
"^DD",2006.563,2006.563,47,21,2,0)
The pointed-to image is the one with the highest IEN that has
"^DD",2006.563,2006.563,47,21,3,0)
been processed by a DICOM Gateway.
"^DD",2006.563,2006.563,47,21,4,0)
 
"^DD",2006.563,2006.563,47,21,5,0)
This value is being tracked for patient-safety reasons.
"^DD",2006.563,2006.563,47,21,6,0)
 
"^DD",2006.563,2006.563,47,21,7,0)
At a number of sites it has happened that procedural mistakes during
"^DD",2006.563,2006.563,47,21,8,0)
normal maintenance caused part of the Image File to "disappear".
"^DD",2006.563,2006.563,47,21,9,0)
Keeping track of this highest IEN allows the imaging software to
"^DD",2006.563,2006.563,47,21,10,0)
cause a "controlled shut-down" when such a situation occurs.
"^DD",2006.563,2006.563,47,"DT")
3021212
"^DD",2006.563,2006.563,48,0)
LAST RAD REPORT POINTER^P74'^RARPT(^LAST RAD REPORT POINTER;1^Q
"^DD",2006.563,2006.563,48,3)
Indicate the highest numbered Radiology Report processed.
"^DD",2006.563,2006.563,48,21,0)
^^10^10^3021212^^
"^DD",2006.563,2006.563,48,21,1,0)
The value of this field is a pointer to the Rad/Nuc Report File (#74).
"^DD",2006.563,2006.563,48,21,2,0)
The pointed-to report is the one with the highest IEN that has
"^DD",2006.563,2006.563,48,21,3,0)
been processed by a DICOM Gateway.
"^DD",2006.563,2006.563,48,21,4,0)
 
"^DD",2006.563,2006.563,48,21,5,0)
This value is being tracked for patient-safety reasons.
"^DD",2006.563,2006.563,48,21,6,0)
 
"^DD",2006.563,2006.563,48,21,7,0)
At a number of sites it has happened that procedural mistakes during
"^DD",2006.563,2006.563,48,21,8,0)
normal maintenance caused part of the Rad/Nuc Report to "disappear".
"^DD",2006.563,2006.563,48,21,9,0)
Keeping track of this highest IEN allows the imaging software to
"^DD",2006.563,2006.563,48,21,10,0)
cause a "controlled shut-down" when such a situation occurs.
"^DD",2006.563,2006.563,48,"DT")
3021212
"^DD",2006.563,2006.563,49,0)
SUPPORT ACCESS^F^^LOGIN SUPPORT;1^K:$L(X)>30!($L(X)<1) X
"^DD",2006.563,2006.563,49,3)
Enter the code that allows support staff local access to a DICOM Gateway.
"^DD",2006.563,2006.563,49,21,0)
^^2^2^3021212^^
"^DD",2006.563,2006.563,49,21,1,0)
The value of this field is a string that represents the access
"^DD",2006.563,2006.563,49,21,2,0)
code that will be used to gain 'support staff' access to this gateway.
"^DD",2006.563,2006.563,49,"DT")
3021212
"^DD",2006.563,2006.563,50,0)
ET PHONES HOME^S^YES:Yes;NO:No;^MAGDBB;1^Q
"^DD",2006.563,2006.563,50,3)
Indicate whether or not the ET-Phone Home service will be active.
"^DD",2006.563,2006.563,50,21,0)
^^8^8^3021212^
"^DD",2006.563,2006.563,50,21,1,0)
The value of this field is a code that indicates whether or
"^DD",2006.563,2006.563,50,21,2,0)
not the "ET-Phone Home" feature will be enabled.
"^DD",2006.563,2006.563,50,21,3,0)
 
"^DD",2006.563,2006.563,50,21,4,0)
When the value of this field is equal to "YES", the DICOM Gateway
"^DD",2006.563,2006.563,50,21,5,0)
will send a report to the support-organization in Silver Spring
"^DD",2006.563,2006.563,50,21,6,0)
each day. This report includes a summary of the entries in the
"^DD",2006.563,2006.563,50,21,7,0)
error trap, information of site-specific parameters and station-specific
"^DD",2006.563,2006.563,50,21,8,0)
parameters, checksums of routines, and usage statistics.
"^DD",2006.563,2006.563,50,"DT")
3021212
"^DD",2006.563,2006.563,51,0)
M-to-M BROKER MESSAGES^S^YES:Yes;NO:No;^M-to-M BROKER MSGS;1^Q
"^DD",2006.563,2006.563,51,3)
Indicate whether or not messages about the M-to-M broker will be logged.
"^DD",2006.563,2006.563,51,21,0)
^^6^6^3021212^
"^DD",2006.563,2006.563,51,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,51,21,2,0)
messages will be logged that report on the usage of the MUMPS-to-MUMPS
"^DD",2006.563,2006.563,51,21,3,0)
RPC Broker.
"^DD",2006.563,2006.563,51,21,4,0)
 
"^DD",2006.563,2006.563,51,21,5,0)
When the value of this field is equal to "YES", such
"^DD",2006.563,2006.563,51,21,6,0)
messages will be logged.
"^DD",2006.563,2006.563,51,"DT")
3021212
"^DD",2006.563,2006.563,52,0)
PACS EXAM COMPLETE^S^YES:Yes;NO:No;^PACS EXAM COMPLETE;1^Q
"^DD",2006.563,2006.563,52,3)
Indicate whether or not a PACS will be sending Exam Complete messages.
"^DD",2006.563,2006.563,52,21,0)
^^6^6^3021212^
"^DD",2006.563,2006.563,52,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,52,21,2,0)
this DICOM Gateway will be receiving "Exam Complete" messages
"^DD",2006.563,2006.563,52,21,3,0)
from a PACS.
"^DD",2006.563,2006.563,52,21,4,0)
 
"^DD",2006.563,2006.563,52,21,5,0)
When the value of this field is "YES", such messages will be
"^DD",2006.563,2006.563,52,21,6,0)
processed.
"^DD",2006.563,2006.563,52,"DT")
3021212
"^DD",2006.563,2006.563,54,0)
STOP ROUTING TRANSMITTER^S^1:Stop;0:Run;^ROUTE AQ EXIT;1^Q
"^DD",2006.563,2006.563,54,3)
Indicate whether routing transmitters may run.
"^DD",2006.563,2006.563,54,21,0)
^^13^13^3021212^
"^DD",2006.563,2006.563,54,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,54,21,2,0)
routing transmitters are currently allowed to run on a suite
"^DD",2006.563,2006.563,54,21,3,0)
of DICOM Gateways.
"^DD",2006.563,2006.563,54,21,4,0)
 
"^DD",2006.563,2006.563,54,21,5,0)
When a routing transmitter process is started, the value of this
"^DD",2006.563,2006.563,54,21,6,0)
field is set to 0 (run).
"^DD",2006.563,2006.563,54,21,7,0)
 
"^DD",2006.563,2006.563,54,21,8,0)
When the menu option "Stop Transmission Processors" is executed,
"^DD",2006.563,2006.563,54,21,9,0)
the value of this field is set to 1 (Stop).
"^DD",2006.563,2006.563,54,21,10,0)
 
"^DD",2006.563,2006.563,54,21,11,0)
The software of the transmission processor checks this value to
"^DD",2006.563,2006.563,54,21,12,0)
determine whether to stop gracefully, or to continue transmitting
"^DD",2006.563,2006.563,54,21,13,0)
the next file.
"^DD",2006.563,2006.563,54,"DT")
3021212
"^DD",2006.563,2006.563,55,0)
DASHES IN SSN FOR PACS^S^YES:Include dashes;NO:Omit dashes;^SSN DASHES FOR PACS;1^Q
"^DD",2006.563,2006.563,55,3)
Indicate whether or not the PACS wants dashes in SSNs.
"^DD",2006.563,2006.563,55,21,0)
^^8^8^3021212^
"^DD",2006.563,2006.563,55,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,55,21,2,0)
the PACS (Picture Archival and Communication System) that
"^DD",2006.563,2006.563,55,21,3,0)
is connected to this DICOM Gateway requires that SSNs are
"^DD",2006.563,2006.563,55,21,4,0)
transmitted with dashes included or not.
"^DD",2006.563,2006.563,55,21,5,0)
 
"^DD",2006.563,2006.563,55,21,6,0)
When the value of this field is equal to "YES", SSNs will be
"^DD",2006.563,2006.563,55,21,7,0)
transmitted to this PACS with dashed included; otherwise the
"^DD",2006.563,2006.563,55,21,8,0)
dashes will be omitted.
"^DD",2006.563,2006.563,55,"DT")
3021212
"^DD",2006.563,2006.563,56,0)
INSTALLATION^2006.5634A^^INSTALL;0
"^DD",2006.563,2006.563,56,"DT")
3021212
"^DD",2006.563,2006.563,58,0)
LAST CONFIGURATION CHANGE^D^^CONFIG DATE/TIME;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,58,3)
Enter the date and time the configuration was last changed.
"^DD",2006.563,2006.563,58,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,58,21,1,0)
The value of this field is a timestamp (VA-FileMan format)
"^DD",2006.563,2006.563,58,21,2,0)
that indicates the date and time when the most recent configuration
"^DD",2006.563,2006.563,58,21,3,0)
update occurred on this DICOM Gateway.
"^DD",2006.563,2006.563,58,"DT")
3040303
"^DD",2006.563,2006.563,59,0)
DICOM TRANSMITTER ACTIVE^S^RUN:Running;STOP:Inactive;^DICOM XMIT;1^Q
"^DD",2006.563,2006.563,59,3)
Indicate whether a DICOM transmitter is running or not.
"^DD",2006.563,2006.563,59,21,0)
^^6^6^3040303^
"^DD",2006.563,2006.563,59,21,1,0)
The value of this field is a code that indicates whether or
"^DD",2006.563,2006.563,59,21,2,0)
not a DICOM Transmitter is currently running.
"^DD",2006.563,2006.563,59,21,3,0)
Possible values are "RUN" and "STOP".
"^DD",2006.563,2006.563,59,21,4,0)
Each active DICOM Transmitter will periodically check the value of
"^DD",2006.563,2006.563,59,21,5,0)
this field, and gracefully terminate if the value of this field
"^DD",2006.563,2006.563,59,21,6,0)
has been set to "STOP".
"^DD",2006.563,2006.563,59,"DT")
3040303
"^DD",2006.563,2006.563,60,0)
DOMAIN^F^^DOMAIN;1^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.563,60,3)
Enter the site's domain name.
"^DD",2006.563,2006.563,60,21,0)
^^5^5^3040303^
"^DD",2006.563,2006.563,60,21,1,0)
The value of this field is a string that identifies the domain
"^DD",2006.563,2006.563,60,21,2,0)
to which the site belongs at which this DICOM Gateway is located.
"^DD",2006.563,2006.563,60,21,3,0)
This field is populated automatically, using an RPC to query
"^DD",2006.563,2006.563,60,21,4,0)
the VistA system for the current values of its Kernel Site Parameters
"^DD",2006.563,2006.563,60,21,5,0)
when the configuration of the DICOM Gateway is updated.
"^DD",2006.563,2006.563,60,"DT")
3040303
"^DD",2006.563,2006.563,61,0)
PACS QUERY^2006.5633A^^GE CONV #HRS;0
"^DD",2006.563,2006.563,62,0)
PACS QUERY ACTIVE^S^YES:Active;NO:Idle;STOP:Stop Requested;^GE CONV ACTIVE;1^Q
"^DD",2006.563,2006.563,62,3)
Indicate whether a PACS Query is currently running.
"^DD",2006.563,2006.563,62,21,0)
^^10^10^3040303^
"^DD",2006.563,2006.563,62,21,1,0)
The value of this field is a code that indicates whether
"^DD",2006.563,2006.563,62,21,2,0)
a PACS query process is currently active.
"^DD",2006.563,2006.563,62,21,3,0)
Possible values are "YES", "NO" and "STOP".
"^DD",2006.563,2006.563,62,21,4,0)
 
"^DD",2006.563,2006.563,62,21,5,0)
Each PACS Query process will periodically check the value of
"^DD",2006.563,2006.563,62,21,6,0)
this field, and gracefully terminate if the value of this field
"^DD",2006.563,2006.563,62,21,7,0)
has been set to "STOP".
"^DD",2006.563,2006.563,62,21,8,0)
 
"^DD",2006.563,2006.563,62,21,9,0)
When a PACS Query Process fully completed its activity, it
"^DD",2006.563,2006.563,62,21,10,0)
will set the value of this field to "NO".
"^DD",2006.563,2006.563,62,"DT")
3040303
"^DD",2006.563,2006.563,63,0)
PACS QUERY DIRECTION^S^ASCENDING:Ascending Order;DESCENDING:Descending Order;^GE CONV DIR;1^Q
"^DD",2006.563,2006.563,63,3)
Indicate the traversal direction.
"^DD",2006.563,2006.563,63,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,63,21,1,0)
The value of this field is a code that indicates in which direction
"^DD",2006.563,2006.563,63,21,2,0)
the PACS QUery process will traverse the database.
"^DD",2006.563,2006.563,63,21,3,0)
Possible values are "ASCENDING" and "DESCENDING".
"^DD",2006.563,2006.563,63,"DT")
3040303
"^DD",2006.563,2006.563,64,0)
PACS QUERY ERA 1 START^D^^GE CONV ERA1;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,64,3)
Indicate the start of the ACR/NEMA era.
"^DD",2006.563,2006.563,64,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,64,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,64,21,2,0)
date only) that indicates the start of the time-period during
"^DD",2006.563,2006.563,64,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,64,21,4,0)
ACR/NEMA protocol.
"^DD",2006.563,2006.563,64,21,5,0)
 
"^DD",2006.563,2006.563,64,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,64,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,64,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,64,21,9,0)
field (and the next).
"^DD",2006.563,2006.563,64,21,10,0)
 
"^DD",2006.563,2006.563,64,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,64,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,64,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,64,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,64,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,64,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,64,"DT")
3040303
"^DD",2006.563,2006.563,65,0)
PACS QUERY ERA 1 END^D^^GE CONV ERA1;2^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,65,3)
Indicate the end of the ACR/NEMA era.
"^DD",2006.563,2006.563,65,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,65,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,65,21,2,0)
date only) that indicates the end of the time-period during
"^DD",2006.563,2006.563,65,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,65,21,4,0)
ACR/NEMA protocol.
"^DD",2006.563,2006.563,65,21,5,0)
 
"^DD",2006.563,2006.563,65,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,65,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,65,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,65,21,9,0)
field (and the previous).
"^DD",2006.563,2006.563,65,21,10,0)
 
"^DD",2006.563,2006.563,65,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,65,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,65,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,65,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,65,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,65,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,65,"DT")
3040303
"^DD",2006.563,2006.563,66,0)
PACS QUERY ERA 2 START^D^^GE CONV ERA2;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,66,3)
Indicate the start of the Pre 12.1 era.
"^DD",2006.563,2006.563,66,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,66,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,66,21,2,0)
date only) that indicates the start of the time-period during
"^DD",2006.563,2006.563,66,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,66,21,4,0)
Pre Version 12.1 protocol.
"^DD",2006.563,2006.563,66,21,5,0)
 
"^DD",2006.563,2006.563,66,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,66,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,66,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,66,21,9,0)
field (and the next).
"^DD",2006.563,2006.563,66,21,10,0)
 
"^DD",2006.563,2006.563,66,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,66,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,66,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,66,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,66,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,66,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,66,"DT")
3040303
"^DD",2006.563,2006.563,67,0)
PACS QUERY ERA 2 END^D^^GE CONV ERA2;2^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,67,3)
Indicate the end of the Pre 12.1 era.
"^DD",2006.563,2006.563,67,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,67,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,67,21,2,0)
date only) that indicates the end of the time-period during
"^DD",2006.563,2006.563,67,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,67,21,4,0)
Pre Version 12.1 protocol.
"^DD",2006.563,2006.563,67,21,5,0)
 
"^DD",2006.563,2006.563,67,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,67,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,67,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,67,21,9,0)
field (and the previous).
"^DD",2006.563,2006.563,67,21,10,0)
 
"^DD",2006.563,2006.563,67,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,67,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,67,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,67,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,67,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,67,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,67,"DT")
3040303
"^DD",2006.563,2006.563,68,0)
PACS QUERY ERA 3 START^D^^GE CONV ERA3;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,68,3)
Indicate the start of the Post 12.1 era.
"^DD",2006.563,2006.563,68,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,68,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,68,21,2,0)
date only) that indicates the start of the time-period during
"^DD",2006.563,2006.563,68,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,68,21,4,0)
Post Version 12.1 protocol.
"^DD",2006.563,2006.563,68,21,5,0)
 
"^DD",2006.563,2006.563,68,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,68,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,68,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,68,21,9,0)
field (and the next).
"^DD",2006.563,2006.563,68,21,10,0)
 
"^DD",2006.563,2006.563,68,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,68,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,68,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,68,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,68,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,68,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,68,"DT")
3040303
"^DD",2006.563,2006.563,69,0)
PACS QUERY ERA 3 END^D^^GE CONV ERA3;2^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,69,3)
Indicate the end of the Post 12.1 era.
"^DD",2006.563,2006.563,69,21,0)
^^16^16^3040303^
"^DD",2006.563,2006.563,69,21,1,0)
The value of this field is a timestamp (VA FileMan format,
"^DD",2006.563,2006.563,69,21,2,0)
date only) that indicates the end of the time-period during
"^DD",2006.563,2006.563,69,21,3,0)
which communication with the PACS was conducted using the
"^DD",2006.563,2006.563,69,21,4,0)
Post Version 12.1 protocol.
"^DD",2006.563,2006.563,69,21,5,0)
 
"^DD",2006.563,2006.563,69,21,6,0)
When querying the PACS, the query process will issue its queries
"^DD",2006.563,2006.563,69,21,7,0)
according to this protocol for all studies that were conducted
"^DD",2006.563,2006.563,69,21,8,0)
between the start and end dates that are registered in this
"^DD",2006.563,2006.563,69,21,9,0)
field (and the previous).
"^DD",2006.563,2006.563,69,21,10,0)
 
"^DD",2006.563,2006.563,69,21,11,0)
Note that protocol-eras are allowed to overlap. The result
"^DD",2006.563,2006.563,69,21,12,0)
of registering overlapping protocol eras will be that the
"^DD",2006.563,2006.563,69,21,13,0)
query process will issues its requests according to all protocols
"^DD",2006.563,2006.563,69,21,14,0)
that could have been valid at the time. The PACS, on the other
"^DD",2006.563,2006.563,69,21,15,0)
hand, will only respond to requests that correspond to the
"^DD",2006.563,2006.563,69,21,16,0)
protocol that was actually active at the time.
"^DD",2006.563,2006.563,69,"DT")
3040303
"^DD",2006.563,2006.563,70,0)
PACS QUERY UPPER LIMIT^P74'^RARPT(^GE CONV HI;1^Q
"^DD",2006.563,2006.563,70,3)
Identify the most recent Radiology Report to be queried.
"^DD",2006.563,2006.563,70,21,0)
^^9^9^3040303^
"^DD",2006.563,2006.563,70,21,1,0)
The value of this field is a pointer to the Radiology Report Table
"^DD",2006.563,2006.563,70,21,2,0)
(#74). This pointer identifies the highest internal entry number of
"^DD",2006.563,2006.563,70,21,3,0)
a report that was scanned by the PACS Query Process.
"^DD",2006.563,2006.563,70,21,4,0)
 
"^DD",2006.563,2006.563,70,21,5,0)
When the "highest" and "lowest" pointer values "pass" one another,
"^DD",2006.563,2006.563,70,21,6,0)
the scanning process is complete.
"^DD",2006.563,2006.563,70,21,7,0)
 
"^DD",2006.563,2006.563,70,21,8,0)
Note that the end-user may decide to switch the scanning direction
"^DD",2006.563,2006.563,70,21,9,0)
from "ASCENDING" to "DESCENDING" (or the other way about) at any time.
"^DD",2006.563,2006.563,70,"DT")
3040303
"^DD",2006.563,2006.563,71,0)
PACS QUERY LOWER LIMIT^P74'^RARPT(^GE CONV LO;1^Q
"^DD",2006.563,2006.563,71,3)
Indicate the oldest Radiology Report to be queried.
"^DD",2006.563,2006.563,71,21,0)
^^9^9^3040303^
"^DD",2006.563,2006.563,71,21,1,0)
The value of this field is a pointer to the Radiology Report Table
"^DD",2006.563,2006.563,71,21,2,0)
(#74). This pointer identifies the lowest internal entry number of
"^DD",2006.563,2006.563,71,21,3,0)
a report that was scanned by the PACS Query Process.
"^DD",2006.563,2006.563,71,21,4,0)
 
"^DD",2006.563,2006.563,71,21,5,0)
When the "highest" and "lowest" pointer values "pass" one another,
"^DD",2006.563,2006.563,71,21,6,0)
the scanning process is complete.
"^DD",2006.563,2006.563,71,21,7,0)
 
"^DD",2006.563,2006.563,71,21,8,0)
Note that the end-user may decide to switch the scanning direction
"^DD",2006.563,2006.563,71,21,9,0)
from "ASCENDING" to "DESCENDING" (or the other way about) at any time.
"^DD",2006.563,2006.563,71,"DT")
3040303
"^DD",2006.563,2006.563,72,0)
PACS QUERY ALLOW ACTIVITY^F^^GE CONV HRS;1^K:$L(X)>24!($L(X)<24) X
"^DD",2006.563,2006.563,72,3)
Indicate when PACS Queries may be active.
"^DD",2006.563,2006.563,72,21,0)
^^10^10^3040303^
"^DD",2006.563,2006.563,72,21,1,0)
The value of this field is a string of exactly 24 characters.
"^DD",2006.563,2006.563,72,21,2,0)
Each of these characters is either a "Y" or an "N".
"^DD",2006.563,2006.563,72,21,3,0)
Each character in this string corresponds to an hour of the day,
"^DD",2006.563,2006.563,72,21,4,0)
and indicates whether or not a PACS Query Process is allowed to
"^DD",2006.563,2006.563,72,21,5,0)
be active during that hour of the day.
"^DD",2006.563,2006.563,72,21,6,0)
 
"^DD",2006.563,2006.563,72,21,7,0)
The first character corresponds to the hour between midnight and 1am,
"^DD",2006.563,2006.563,72,21,8,0)
the last one corresponds to the hour between 11pm and midnight.
"^DD",2006.563,2006.563,72,21,9,0)
 
"^DD",2006.563,2006.563,72,21,10,0)
The default value of this field is "YYYYYYYYYYYYYYYYYYYYYYYY".
"^DD",2006.563,2006.563,72,"DT")
3040303
"^DD",2006.563,2006.563,73,0)
CURRENT IMAGE POINTER^P2005'^MAG(2005,^CURRENT IMAGE POINTER;1^Q
"^DD",2006.563,2006.563,73,3)
Identify the image currently being processed.
"^DD",2006.563,2006.563,73,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,73,21,1,0)
The value of this field is a pointer to the Image Table
"^DD",2006.563,2006.563,73,21,2,0)
(#2005). This value identifies the image that is currently
"^DD",2006.563,2006.563,73,21,3,0)
being processed.
"^DD",2006.563,2006.563,73,"DT")
3040303
"^DD",2006.563,2006.563,74,0)
CURRENT IMAGE DESTINATION^F^^CURRENT IMAGE DESTINATION;1^K:$L(X)>250!($L(X)<1) X
"^DD",2006.563,2006.563,74,3)
Identify the directory and file name where this image will be stored.
"^DD",2006.563,2006.563,74,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,74,21,1,0)
The value of this field is a string that identifies the image file
"^DD",2006.563,2006.563,74,21,2,0)
(host system file name, including directory path) that is
"^DD",2006.563,2006.563,74,21,3,0)
currently being created.
"^DD",2006.563,2006.563,74,"DT")
3040303
"^DD",2006.563,2006.563,75,0)
CURRENT IMAGE FILE NAME^F^^CURRENT IMAGE FILE NAME;1^K:$L(X)>240!($L(X)<1) X
"^DD",2006.563,2006.563,75,3)
Identify the file (HSF) currently being processed.
"^DD",2006.563,2006.563,75,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,75,21,1,0)
The value of this field is a string that identifies the image file
"^DD",2006.563,2006.563,75,21,2,0)
(host system file name, no directory path) that is
"^DD",2006.563,2006.563,75,21,3,0)
currently being processed.
"^DD",2006.563,2006.563,75,"DT")
3040303
"^DD",2006.563,2006.563,76,0)
CURRENT IMAGE SOURCE^F^^CURRENT IMAGE SOURCE;1^K:$L(X)>240!($L(X)<1) X
"^DD",2006.563,2006.563,76,3)
Identify the directory where the current file resides.
"^DD",2006.563,2006.563,76,21,0)
^^2^2^3040303^
"^DD",2006.563,2006.563,76,21,1,0)
The value of this field is a string that identifies the image file
"^DD",2006.563,2006.563,76,21,2,0)
(directory path, no file name) that is currently being processed.
"^DD",2006.563,2006.563,76,"DT")
3040303
"^DD",2006.563,2006.563,77,0)
LAST UID^F^^LAST UID;1^K:$L(X)>64!($L(X)<1) X
"^DD",2006.563,2006.563,77,3)
Record the most recently issued UID for a new object.
"^DD",2006.563,2006.563,77,21,0)
^^6^6^3040303^
"^DD",2006.563,2006.563,77,21,1,0)
The value of this field is a string that meets the format
"^DD",2006.563,2006.563,77,21,2,0)
of a Unique Object Identifier as specified in the DICOM Standard
"^DD",2006.563,2006.563,77,21,3,0)
(maximum 64 characters, only digits and periods, leading characters
"^DD",2006.563,2006.563,77,21,4,0)
are the root-numbers that are assigned by ANSI to the VA).
"^DD",2006.563,2006.563,77,21,5,0)
The value of this field is the UID that was most recently assigned
"^DD",2006.563,2006.563,77,21,6,0)
by the DICOM Gateway.
"^DD",2006.563,2006.563,77,"DT")
3040303
"^DD",2006.563,2006.563,78,0)
BACKGROUND PROCESS ACCESS^F^^M-to-M BROKER BGND ACCESS;1^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.563,78,3)
Enter the access code for background processes.
"^DD",2006.563,2006.563,78,21,0)
^^8^8^3040303^
"^DD",2006.563,2006.563,78,21,1,0)
The value of this field is an (encrypted) string. This value will
"^DD",2006.563,2006.563,78,21,2,0)
be used as an access code by the DICOM Gateway when a "modality"
"^DD",2006.563,2006.563,78,21,3,0)
performs a Modality Worklist Query, in those special cases where
"^DD",2006.563,2006.563,78,21,4,0)
the DICOM Gateway needs to query the VistA system about details
"^DD",2006.563,2006.563,78,21,5,0)
about "old" Radiology studies. (Under normal circumstances, a
"^DD",2006.563,2006.563,78,21,6,0)
DICOM Gateway will be able to respond to a Modality Worklist
"^DD",2006.563,2006.563,78,21,7,0)
QUery using only information that is stored on the DICOM Gateway
"^DD",2006.563,2006.563,78,21,8,0)
itself.)
"^DD",2006.563,2006.563,78,"DT")
3040303
"^DD",2006.563,2006.563,79,0)
BACKGROUND PROCESS VERIFY^F^^M-to-M BROKER BGND VERIFY;1^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.563,79,3)
Enter the verify code for background processes.
"^DD",2006.563,2006.563,79,21,0)
^^8^8^3040303^
"^DD",2006.563,2006.563,79,21,1,0)
The value of this field is an (encrypted) string. This value will
"^DD",2006.563,2006.563,79,21,2,0)
be used as a verify code by the DICOM Gateway when a "modality"
"^DD",2006.563,2006.563,79,21,3,0)
performs a Modality Worklist Query, in those special cases where
"^DD",2006.563,2006.563,79,21,4,0)
the DICOM Gateway needs to query the VistA system about details
"^DD",2006.563,2006.563,79,21,5,0)
about "old" Radiology studies. (Under normal circumstances, a
"^DD",2006.563,2006.563,79,21,6,0)
DICOM Gateway will be able to respond to a Modality Worklist
"^DD",2006.563,2006.563,79,21,7,0)
QUery using only information that is stored on the DICOM Gateway
"^DD",2006.563,2006.563,79,21,8,0)
itself.)
"^DD",2006.563,2006.563,79,"DT")
3040303
"^DD",2006.563,2006.563,80,0)
M2M BROKER DEBUG^S^1:Yes;0:No;^M2M DEBUG;1^Q
"^DD",2006.563,2006.563,80,3)
Indicate whether or not debugging is active for M2M Broker sessions.
"^DD",2006.563,2006.563,80,21,0)
^^13^13^3040303^
"^DD",2006.563,2006.563,80,21,1,0)
The value of this field is a code that indicates whether
"^DD",2006.563,2006.563,80,21,2,0)
or not the client for the MUMPS-to-MUMPS Broker should record
"^DD",2006.563,2006.563,80,21,3,0)
any debugging information. Possible values are 1 (do record
"^DD",2006.563,2006.563,80,21,4,0)
information) and 0 (do NOT record any information).
"^DD",2006.563,2006.563,80,21,5,0)
 
"^DD",2006.563,2006.563,80,21,6,0)
When a DICOM Gateway is installed at a new site, the value of
"^DD",2006.563,2006.563,80,21,7,0)
this field is "false", and this field can only receive a "true"
"^DD",2006.563,2006.563,80,21,8,0)
value through a manual operation from "programmer mode".
"^DD",2006.563,2006.563,80,21,9,0)
 
"^DD",2006.563,2006.563,80,21,10,0)
Since the information that is recorded when this switch is turned
"^DD",2006.563,2006.563,80,21,11,0)
"on" is quite voluminous, this switch should only be used by
"^DD",2006.563,2006.563,80,21,12,0)
support personnel to diagnose a problem, and turned off 
"^DD",2006.563,2006.563,80,21,13,0)
immediately after the problem is diagnosed.
"^DD",2006.563,2006.563,80,"DT")
3040303
"^DD",2006.563,2006.563,81,0)
MULTIFRAME COUNTER^NJ9,0^^MULTIFRAME COUNTER;1^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,81,3)
Record the sequence number of the last-processed frame.
"^DD",2006.563,2006.563,81,21,0)
^^13^13^3040303^
"^DD",2006.563,2006.563,81,21,1,0)
The value of this field is an integer number that records the
"^DD",2006.563,2006.563,81,21,2,0)
progress through the various frames of a multi-frame image
"^DD",2006.563,2006.563,81,21,3,0)
as data for that image is being received.
"^DD",2006.563,2006.563,81,21,4,0)
 
"^DD",2006.563,2006.563,81,21,5,0)
Under normal circumstances, the various "frames" are converted
"^DD",2006.563,2006.563,81,21,6,0)
to individual images, and there is no need to know the number of
"^DD",2006.563,2006.563,81,21,7,0)
frames processed to any process process other than the one
"^DD",2006.563,2006.563,81,21,8,0)
receiving the image data.
"^DD",2006.563,2006.563,81,21,9,0)
 
"^DD",2006.563,2006.563,81,21,10,0)
However, if that process is interrupted (user interrupt, network
"^DD",2006.563,2006.563,81,21,11,0)
outage, power failure), a subsequent process will need to know
"^DD",2006.563,2006.563,81,21,12,0)
which sub-images have already been created when it starts processing
"^DD",2006.563,2006.563,81,21,13,0)
the re-transmission of the image data.
"^DD",2006.563,2006.563,81,"DT")
3040303
"^DD",2006.563,2006.563,82,0)
SHOW PATIENT IDENTIFIERS^S^YES:Yes;NO:No;^SHOW PATIENT NAME & ID;1^Q
"^DD",2006.563,2006.563,82,3)
Indicate whether or not Patient Identifiers will be displayed.
"^DD",2006.563,2006.563,82,21,0)
^^11^11^3040303^
"^DD",2006.563,2006.563,82,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,82,21,2,0)
an Image Gateway is to display patient identifying information
"^DD",2006.563,2006.563,82,21,3,0)
while processing images.
"^DD",2006.563,2006.563,82,21,4,0)
Possible values are "YES" and "NO".
"^DD",2006.563,2006.563,82,21,5,0)
 
"^DD",2006.563,2006.563,82,21,6,0)
When a DICOM Gateway is located in a well-protected area, it is
"^DD",2006.563,2006.563,82,21,7,0)
permissible to leave the value of this field equal to "YES".
"^DD",2006.563,2006.563,82,21,8,0)
When a DICOM Gateway is located in a publicly accessible area,
"^DD",2006.563,2006.563,82,21,9,0)
the value of this field may only be set to "YES" while an
"^DD",2006.563,2006.563,82,21,10,0)
adequately privileged user is diagnosing a problem, and should
"^DD",2006.563,2006.563,82,21,11,0)
be set to "NO" at all other times.
"^DD",2006.563,2006.563,82,"DT")
3040303
"^DD",2006.563,2006.563,83,0)
TEXT GATEWAY SERVICE^S^RAD:Radiology;CON:Consults;^TEXT GATEWAY SERVICE;1^Q
"^DD",2006.563,2006.563,83,3)
Identify the kind of Imaging Service that is processed by this Gateway.
"^DD",2006.563,2006.563,83,21,0)
^^3^3^3040303^
"^DD",2006.563,2006.563,83,21,1,0)
The value of this field is a code that indicates which imaging
"^DD",2006.563,2006.563,83,21,2,0)
service is being performed by this Text Gateway.
"^DD",2006.563,2006.563,83,21,3,0)
Possible values are "RAD" (Radiology) and "CON" (Consults).
"^DD",2006.563,2006.563,83,"DT")
3040303
"^DD",2006.563,2006.563,84,0)
ET ADDRESS^F^^ET ADDRESS;1^K:$L(X)>100!($L(X)<3) X
"^DD",2006.563,2006.563,84,3)
Enter the e-mail address for the ET Phone Home mailgroup.
"^DD",2006.563,2006.563,84,21,0)
^^5^5^3050224^
"^DD",2006.563,2006.563,84,21,1,0)
The value of this field is a string. This string identifies
"^DD",2006.563,2006.563,84,21,2,0)
the mail-group that is used to process messages containing
"^DD",2006.563,2006.563,84,21,3,0)
routine checksum information.
"^DD",2006.563,2006.563,84,21,4,0)
 
"^DD",2006.563,2006.563,84,21,5,0)
Typically, the value will look like: G.MAGDBB@DOMAIN.EXT
"^DD",2006.563,2006.563,84,"DT")
3050224
"^DD",2006.563,2006.563,85,0)
MAG VISTA CHECKSUMS^S^YES:Yes;NO:No;^MAG VISTA CHECKSUMS;1^Q
"^DD",2006.563,2006.563,85,3)
Indicate whether or not reports with VistA routine checksums are to be sent.
"^DD",2006.563,2006.563,85,21,0)
^^6^6^3050224^
"^DD",2006.563,2006.563,85,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.563,2006.563,85,21,2,0)
reports will be sent containing the checksums of all imaging
"^DD",2006.563,2006.563,85,21,3,0)
routines on the VistA system.
"^DD",2006.563,2006.563,85,21,4,0)
 
"^DD",2006.563,2006.563,85,21,5,0)
A value of YES indicates that reports are to be sent.
"^DD",2006.563,2006.563,85,21,6,0)
A value of NO indicates that no reports are to be sent.
"^DD",2006.563,2006.563,85,"DT")
3050224
"^DD",2006.563,2006.563,86,0)
EXPORT ACTIVE^S^YES:Yes;NO:No;^EXPORT ACTIVE;1^Q
"^DD",2006.563,2006.563,86,3)
Indicate whether or not an export batch run is active.
"^DD",2006.563,2006.563,86,21,0)
^^3^3^3051006^
"^DD",2006.563,2006.563,86,21,1,0)
The value of this field is a code that indicates whether or
"^DD",2006.563,2006.563,86,21,2,0)
not a batch export run is currently active.
"^DD",2006.563,2006.563,86,21,3,0)
Possible values are "YES" and "NO".
"^DD",2006.563,2006.563,86,"DT")
3051006
"^DD",2006.563,2006.563,87,0)
EXPORT BATCH IMAGES^NJ12,0^^EXPORT BATCH #IMAGES;1^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,87,3)
Indicate how many images are queued up for batch transmission.
"^DD",2006.563,2006.563,87,21,0)
^^3^3^3051006^
"^DD",2006.563,2006.563,87,21,1,0)
The value of this field is an integer number. This number
"^DD",2006.563,2006.563,87,21,2,0)
indicates the number of images that have been queued up for
"^DD",2006.563,2006.563,87,21,3,0)
batch transmission.
"^DD",2006.563,2006.563,87,"DT")
3051006
"^DD",2006.563,2006.563,88,0)
EXPORT BATCH GROUP COUNT^NJ12,0^^EXPORT BATCH COUNT;1^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,88,3)
Indicate how many groups have been queued up for transmission.
"^DD",2006.563,2006.563,88,21,0)
^^3^3^3051006^
"^DD",2006.563,2006.563,88,21,1,0)
The value of this field is an integer number. This number
"^DD",2006.563,2006.563,88,21,2,0)
indicates the number of image groups that have been queued up for
"^DD",2006.563,2006.563,88,21,3,0)
batch transmission.
"^DD",2006.563,2006.563,88,"DT")
3051006
"^DD",2006.563,2006.563,89,0)
EXPORT BATCH MAX GROUP^NJ12,0^^EXPORT BATCH SIZE;1^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.563,89,3)
Indicate the maximum number of image groups for a batch run.
"^DD",2006.563,2006.563,89,21,0)
^^2^2^3051006^
"^DD",2006.563,2006.563,89,21,1,0)
is the default value for the maximum number of image groups that may be
"^DD",2006.563,2006.563,89,21,2,0)
queued up in the next batch transmission.
"^DD",2006.563,2006.563,89,"DT")
3051006
"^DD",2006.563,2006.563,90,0)
EXPORT BEGIN DATE^D^^EXPORT BEGIN DATE;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,90,3)
Indicate the first date to include in scans of Radiology reports.
"^DD",2006.563,2006.563,90,21,0)
^^3^3^3051006^
"^DD",2006.563,2006.563,90,21,1,0)
The value of this field is a (VA-FileMan formatted) date.
"^DD",2006.563,2006.563,90,21,2,0)
This date is the default value for the first day of the period that is
"^DD",2006.563,2006.563,90,21,3,0)
intended to be included in the next DICOM export batch.
"^DD",2006.563,2006.563,90,"DT")
3051006
"^DD",2006.563,2006.563,91,0)
EXPORT FIRST REPORT NUMBER^P74'^RARPT(^EXPORT RADIOLOGY REPORT # START;1^Q
"^DD",2006.563,2006.563,91,3)
Identify the first report to be included in the next batch scan.
"^DD",2006.563,2006.563,91,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,91,21,1,0)
The value of this field is a pointer to the Radiology Report
"^DD",2006.563,2006.563,91,21,2,0)
table (FileMan file # 74).
"^DD",2006.563,2006.563,91,21,3,0)
This pointer is the default value for the first report for which images
"^DD",2006.563,2006.563,91,21,4,0)
will be included in the next DICOM batch transmission.
"^DD",2006.563,2006.563,91,"DT")
3051006
"^DD",2006.563,2006.563,92,0)
EXPORT LAST REPORT NUMBER^P74'^RARPT(^EXPORT RADIOLOGY REPORT # STOP;1^Q
"^DD",2006.563,2006.563,92,3)
Identify the last report to include in the next batch scan.
"^DD",2006.563,2006.563,92,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,92,21,1,0)
The value of this field is a pointer to the Radiology Report
"^DD",2006.563,2006.563,92,21,2,0)
table (FileMan file # 74).
"^DD",2006.563,2006.563,92,21,3,0)
This pointer is the default value for the last report for which images
"^DD",2006.563,2006.563,92,21,4,0)
will be included in a DICOM batch transmission.
"^DD",2006.563,2006.563,92,"DT")
3051006
"^DD",2006.563,2006.563,93,0)
DICOM EXPORT RUN NUMBER^P2006.565'^MAGDICOM(2006.565,^EXPORT DICOM RUN NUMBER;1^Q
"^DD",2006.563,2006.563,93,3)
Idenfify the latest DICOM export batch run.
"^DD",2006.563,2006.563,93,21,0)
^^3^3^3051007^
"^DD",2006.563,2006.563,93,21,1,0)
The value of this field is a pointer to the table that
"^DD",2006.563,2006.563,93,21,2,0)
keeps track of the various DICOM export batch runs (#2006.565).
"^DD",2006.563,2006.563,93,21,3,0)
This field identifies the most recently added entry to that table.
"^DD",2006.563,2006.563,93,"DT")
3051007
"^DD",2006.563,2006.563,94,0)
EXPORT DICOM STORAGE SCP^P2006.585'^MAGDICOM(2006.585,^EXPORT DICOM STORAGE SCP;1^Q
"^DD",2006.563,2006.563,94,3)
Identify the (default) destination of the next batch transmission.
"^DD",2006.563,2006.563,94,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,94,21,1,0)
The value of this field is a pointer to the User Application table
"^DD",2006.563,2006.563,94,21,2,0)
(FileMan file # 2006.585). This pointer is the default value for
"^DD",2006.563,2006.563,94,21,3,0)
the Storage SCP to which the images are to be transmitted in
"^DD",2006.563,2006.563,94,21,4,0)
the next batch run.
"^DD",2006.563,2006.563,94,"DT")
3051006
"^DD",2006.563,2006.563,95,0)
EXPORT DIRECTION^S^ASCENDING:Ascending;DESCENDING:Descending;^EXPORT DIRECTION;1^Q
"^DD",2006.563,2006.563,95,3)
Indicate the (default) scanning direction for the next batch run.
"^DD",2006.563,2006.563,95,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,95,21,1,0)
The value of this field is a code that indicates the direction
"^DD",2006.563,2006.563,95,21,2,0)
in which the Radiology Report table is to be scanned.
"^DD",2006.563,2006.563,95,21,3,0)
This value is the default code to be used in the next batch run.
"^DD",2006.563,2006.563,95,21,4,0)
Possible values are "ASCENDING" and "DESCENDING".
"^DD",2006.563,2006.563,95,"DT")
3051006
"^DD",2006.563,2006.563,96,0)
EXPORT HOURS OF OPERATION^F^^EXPORT HOURS OF OPERATION;1^K:$L(X)>24!($L(X)<24) X
"^DD",2006.563,2006.563,96,3)
Indicate when batch runs are allowed to be active.
"^DD",2006.563,2006.563,96,21,0)
^^12^12^3051006^
"^DD",2006.563,2006.563,96,21,1,0)
The value of this field is a string. This string consists of
"^DD",2006.563,2006.563,96,21,2,0)
the letters "Y" and "N". This value indicates during which hours
"^DD",2006.563,2006.563,96,21,3,0)
of the day this batch run may be active.
"^DD",2006.563,2006.563,96,21,4,0)
 
"^DD",2006.563,2006.563,96,21,5,0)
A string of 24 letters "Y" denotes a batch run that may run all day long.
"^DD",2006.563,2006.563,96,21,6,0)
 
"^DD",2006.563,2006.563,96,21,7,0)
A string like "YYYYYYYYNNNNNNNNNYYYYYYY" denotes a batch run
"^DD",2006.563,2006.563,96,21,8,0)
that may only run outside of regular office hours (midnight to 9am
"^DD",2006.563,2006.563,96,21,9,0)
and 6pm to midnight).
"^DD",2006.563,2006.563,96,21,10,0)
 
"^DD",2006.563,2006.563,96,21,11,0)
This value is the default for the setting to be used in the
"^DD",2006.563,2006.563,96,21,12,0)
next batch run.
"^DD",2006.563,2006.563,96,"DT")
3051006
"^DD",2006.563,2006.563,97,0)
EXPORT PATIENT^P2'^DPT(^EXPORT PATIENT;1^Q
"^DD",2006.563,2006.563,97,3)
Identify the patient for whom to scan reports in the next batch run.
"^DD",2006.563,2006.563,97,21,0)
^^1^1^3051006^
"^DD",2006.563,2006.563,97,21,1,0)
---???---
"^DD",2006.563,2006.563,97,"DT")
3051006
"^DD",2006.563,2006.563,98,0)
EXPORT RADIOLOGY REPORT^P74'^RARPT(^EXPORT RADIOLOGY REPORT #;1^Q
"^DD",2006.563,2006.563,98,3)
Identify the Radiology Report that was processed most recently.
"^DD",2006.563,2006.563,98,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,98,21,1,0)
The value of this field is a pointer to the Radiology Report
"^DD",2006.563,2006.563,98,21,2,0)
table (FileMan file # 74).
"^DD",2006.563,2006.563,98,21,3,0)
This pointer identifies the report that has been scanned most
"^DD",2006.563,2006.563,98,21,4,0)
recently in a batch run.
"^DD",2006.563,2006.563,98,"DT")
3051006
"^DD",2006.563,2006.563,99,0)
EXPORT SCAN MODE^S^DATE:Date;NUMBER:Report;PATIENT:Patient;^EXPORT SCAN MODE;1^Q
"^DD",2006.563,2006.563,99,3)
Identify the primary scanning criterium for the next batch run.
"^DD",2006.563,2006.563,99,21,0)
^^14^14^3051006^
"^DD",2006.563,2006.563,99,21,1,0)
Set of codes: DATE, NUMBER, PATIENT
"^DD",2006.563,2006.563,99,21,2,0)
The value of this field is a code that identifies the method
"^DD",2006.563,2006.563,99,21,3,0)
of scanning the Radiology Reports.
"^DD",2006.563,2006.563,99,21,4,0)
Possible values are "DATE", "NUMBER" and "PATIENT".
"^DD",2006.563,2006.563,99,21,5,0)
 
"^DD",2006.563,2006.563,99,21,6,0)
A value of "DATE" indicates that the reports are scanned by date.
"^DD",2006.563,2006.563,99,21,7,0)
 
"^DD",2006.563,2006.563,99,21,8,0)
A value of "PATIENT" indicates that the reports are scanned
"^DD",2006.563,2006.563,99,21,9,0)
by (internal entry number of) patient.
"^DD",2006.563,2006.563,99,21,10,0)
 
"^DD",2006.563,2006.563,99,21,11,0)
A value of "NUMBER" indicates that the reports are scanned
"^DD",2006.563,2006.563,99,21,12,0)
by (internal entry number of) report.
"^DD",2006.563,2006.563,99,21,13,0)
 
"^DD",2006.563,2006.563,99,21,14,0)
This value is the default to be used in the next batch run.
"^DD",2006.563,2006.563,99,"DT")
3051006
"^DD",2006.563,2006.563,100,0)
FUJI PACS START DATE^D^^GE CONV ERA4;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,100,3)
Indicate when the Fuji PACS became active.
"^DD",2006.563,2006.563,100,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,100,21,1,0)
The value of this field is a (VA-FileMan formatted) date
"^DD",2006.563,2006.563,100,21,2,0)
that indicates the first day of the period during which
"^DD",2006.563,2006.563,100,21,3,0)
information was stored according to the format for a
"^DD",2006.563,2006.563,100,21,4,0)
Fuji PACS.
"^DD",2006.563,2006.563,100,"DT")
3051006
"^DD",2006.563,2006.563,101,0)
FUJI PACS END DATE^D^^GE CONV ERA4;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,101,3)
Indicate when the Fuji PACS ceased to be active.
"^DD",2006.563,2006.563,101,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,101,21,1,0)
The value of this field is a (VA-FileMan formatted) date
"^DD",2006.563,2006.563,101,21,2,0)
that indicates the last day of the period during which
"^DD",2006.563,2006.563,101,21,3,0)
information was stored according to the format for a
"^DD",2006.563,2006.563,101,21,4,0)
Fuji PACS.
"^DD",2006.563,2006.563,101,"DT")
3051006
"^DD",2006.563,2006.563,102,0)
QUERY STUDY SELECTION^S^1:All Studies;2:Studies without images;3:Studies with images;^GE CONV IMGSTU;1^Q
"^DD",2006.563,2006.563,102,3)
Indicate for which studies queries should be issued.
"^DD",2006.563,2006.563,102,21,0)
^^5^5^3051006^
"^DD",2006.563,2006.563,102,21,1,0)
The value of this field is a code that indicates for
"^DD",2006.563,2006.563,102,21,2,0)
which studies queries will be issued:
"^DD",2006.563,2006.563,102,21,3,0)
  1 = for all studies
"^DD",2006.563,2006.563,102,21,4,0)
  2 = only for studies that don't currently have images
"^DD",2006.563,2006.563,102,21,5,0)
  3 = only for studies that already have images
"^DD",2006.563,2006.563,102,"DT")
3051006
"^DD",2006.563,2006.563,103,0)
DASHES FOR SSN IN PACS QUERY^S^YES:Yes;NO:No;^GE CONV SSNDASH;1^Q
"^DD",2006.563,2006.563,103,3)
Indicate whether or not to include dashes in SSNs for PACS queries.
"^DD",2006.563,2006.563,103,21,0)
^^4^4^3051006^
"^DD",2006.563,2006.563,103,21,1,0)
The value of this field is a code that indicates whether
"^DD",2006.563,2006.563,103,21,2,0)
or not dashes are to be included in values of SSNs that
"^DD",2006.563,2006.563,103,21,3,0)
are transmitted to the external PACS.
"^DD",2006.563,2006.563,103,21,4,0)
Possible values are "YES" and "NO".
"^DD",2006.563,2006.563,103,"DT")
3051006
"^DD",2006.563,2006.563,104,0)
EXPORT STOP DATE^D^^EXPORT STOP DATE;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.563,2006.563,104,3)
Indicate the last date to be scanned in the next batch run.
"^DD",2006.563,2006.563,104,21,0)
^^3^3^3051006^
"^DD",2006.563,2006.563,104,21,1,0)
The value of this field is a (VA-FileMan formatted) date.
"^DD",2006.563,2006.563,104,21,2,0)
This date is the default value for the last day of the period
"^DD",2006.563,2006.563,104,21,3,0)
that is intended to be included in the next DICOM export batch.
"^DD",2006.563,2006.563,104,"DT")
3051006
"^DD",2006.563,2006.5631,0)
DATA PATH SUB-FIELD^^2^3
"^DD",2006.563,2006.5631,0,"DT")
3010227
"^DD",2006.563,2006.5631,0,"IX","B",2006.5631,.01)

"^DD",2006.563,2006.5631,0,"NM","DATA PATH")

"^DD",2006.563,2006.5631,0,"UP")
2006.563
"^DD",2006.563,2006.5631,.001,0)
NUMBER^NJ3,0^^ ^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.5631,.001,3)
Enter the sequence number of this data channel.
"^DD",2006.563,2006.5631,.001,21,0)
^^2^2^3010227^^
"^DD",2006.563,2006.5631,.001,21,1,0)
The value of this field is an integer number that represents
"^DD",2006.563,2006.5631,.001,21,2,0)
the channel number of the data channel being described in this record.
"^DD",2006.563,2006.5631,.001,"DT")
3010227
"^DD",2006.563,2006.5631,.01,0)
CHANNEL^RNJ3,0X^^0;1^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X S:$D(X) DINUM=X
"^DD",2006.563,2006.5631,.01,1,0)
^.1
"^DD",2006.563,2006.5631,.01,1,1,0)
2006.5631^B
"^DD",2006.563,2006.5631,.01,1,1,1)
S ^MAGDICOM(2006.563,DA(1),"DATA PATH","B",$E(X,1,30),DA)=""
"^DD",2006.563,2006.5631,.01,1,1,2)
K ^MAGDICOM(2006.563,DA(1),"DATA PATH","B",$E(X,1,30),DA)
"^DD",2006.563,2006.5631,.01,3)
Enter the sequence number of this data channel.
"^DD",2006.563,2006.5631,.01,21,0)
^^2^2^3010227^^
"^DD",2006.563,2006.5631,.01,21,1,0)
The value of this field is an integer number that represents
"^DD",2006.563,2006.5631,.01,21,2,0)
the channel number of the data channel being described in this record.
"^DD",2006.563,2006.5631,.01,"DT")
3010227
"^DD",2006.563,2006.5631,2,0)
PATH^F^^0;2^K:$L(X)>50!($L(X)<1) X
"^DD",2006.563,2006.5631,2,3)
Enter the directory-prefix for this data channel.
"^DD",2006.563,2006.5631,2,21,0)
^^4^4^3010227^^
"^DD",2006.563,2006.5631,2,21,1,0)
The value of this field is the 'path-prefix'
"^DD",2006.563,2006.5631,2,21,2,0)
that needs to be applied to gain access to the
"^DD",2006.563,2006.5631,2,21,3,0)
files that are created to implement the FIFO
"^DD",2006.563,2006.5631,2,21,4,0)
queues.
"^DD",2006.563,2006.5631,2,"DT")
3010227
"^DD",2006.563,2006.5632,0)
PROFILE SUB-FIELD^^4^4
"^DD",2006.563,2006.5632,0,"DT")
3040303
"^DD",2006.563,2006.5632,0,"IX","B",2006.5632,.01)

"^DD",2006.563,2006.5632,0,"NM","PROFILE")

"^DD",2006.563,2006.5632,0,"UP")
2006.563
"^DD",2006.563,2006.5632,.01,0)
USER^NJ12,0^^0;1^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.563,2006.5632,.01,1,0)
^.1
"^DD",2006.563,2006.5632,.01,1,1,0)
2006.5632^B
"^DD",2006.563,2006.5632,.01,1,1,1)
S ^MAGDICOM(2006.563,DA(1),"PROFILE","B",$E(X,1,30),DA)=""
"^DD",2006.563,2006.5632,.01,1,1,2)
K ^MAGDICOM(2006.563,DA(1),"PROFILE","B",$E(X,1,30),DA)
"^DD",2006.563,2006.5632,.01,3)
Enter a number that uniquely identifies this user.
"^DD",2006.563,2006.5632,.01,21,0)
^.001^3^3^3021002^^
"^DD",2006.563,2006.5632,.01,21,1,0)
The value of this field is an integer number that identifies a user.
"^DD",2006.563,2006.5632,.01,21,2,0)
The value for this field is copied from the value of "DUZ" (user number)
"^DD",2006.563,2006.5632,.01,21,3,0)
on the VistA system where this number is registered.
"^DD",2006.563,2006.5632,.01,"DT")
3021002
"^DD",2006.563,2006.5632,1,0)
ACCESS LEVEL^S^1:Full Access;2:View Only Access;^0;2^Q
"^DD",2006.563,2006.5632,1,3)
Indicate the access level for this user.
"^DD",2006.563,2006.5632,1,21,0)
^^5^5^3021002^
"^DD",2006.563,2006.5632,1,21,1,0)
The value of this field is a code that identifies the
"^DD",2006.563,2006.5632,1,21,2,0)
access level (on the DICOM Gateway) for the current user.
"^DD",2006.563,2006.5632,1,21,3,0)
 
"^DD",2006.563,2006.5632,1,21,4,0)
On a DICOM Gateway, a user can have full access (value is 1)
"^DD",2006.563,2006.5632,1,21,5,0)
or view only access (value is 2).
"^DD",2006.563,2006.5632,1,"DT")
3021002
"^DD",2006.563,2006.5632,2,0)
VISTA ACCESS INFO^F^^0;3^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.5632,2,3)
Enter access information for this user.
"^DD",2006.563,2006.5632,2,21,0)
^^3^3^3021002^
"^DD",2006.563,2006.5632,2,21,1,0)
The value of this field, which is stored in an encrypted
"^DD",2006.563,2006.5632,2,21,2,0)
fashion, is a string that is passed to a VistA system as
"^DD",2006.563,2006.5632,2,21,3,0)
the access and verify codes for the current user.
"^DD",2006.563,2006.5632,2,"DT")
3021002
"^DD",2006.563,2006.5632,4,0)
VISTA SERVICE ACCOUNT^F^^0;4^K:$L(X)>63!($L(X)<1) X
"^DD",2006.563,2006.5632,4,3)
Enter the (encrypted) service credentials.
"^DD",2006.563,2006.5632,4,21,0)
^^11^11^3040303^
"^DD",2006.563,2006.5632,4,21,1,0)
The value of this field is a string containing encrypted data.
"^DD",2006.563,2006.5632,4,21,2,0)
This value contains the access and verify codes that the DICOM Gateway
"^DD",2006.563,2006.5632,4,21,3,0)
is allowed to use as a "service account" when the credentials that
"^DD",2006.563,2006.5632,4,21,4,0)
were provided by the end-user during login expire during the course
"^DD",2006.563,2006.5632,4,21,5,0)
of the session.
"^DD",2006.563,2006.5632,4,21,6,0)
 
"^DD",2006.563,2006.5632,4,21,7,0)
This field is automatically populated when an end-user successfully
"^DD",2006.563,2006.5632,4,21,8,0)
logs in on a DICOM Gateway.
"^DD",2006.563,2006.5632,4,21,9,0)
 
"^DD",2006.563,2006.5632,4,21,10,0)
When a site decides not to have such a service account, the value
"^DD",2006.563,2006.5632,4,21,11,0)
of this field will be an encrypted value for the string ";".
"^DD",2006.563,2006.5632,4,"DT")
3040303
"^DD",2006.563,2006.5633,0)
PACS QUERY SUB-FIELD^^2^2
"^DD",2006.563,2006.5633,0,"DT")
3040303
"^DD",2006.563,2006.5633,0,"IX","B",2006.5633,.01)

"^DD",2006.563,2006.5633,0,"NM","PACS QUERY")

"^DD",2006.563,2006.5633,0,"UP")
2006.563
"^DD",2006.563,2006.5633,.01,0)
PACS QUERY START^F^^0;1^K:$L(X)>20!($L(X)<1) X
"^DD",2006.563,2006.5633,.01,1,0)
^.1
"^DD",2006.563,2006.5633,.01,1,1,0)
2006.5633^B
"^DD",2006.563,2006.5633,.01,1,1,1)
S ^MAGDICOM(2006.563,DA(1),"GE CONV #HRS","B",$E(X,1,30),DA)=""
"^DD",2006.563,2006.5633,.01,1,1,2)
K ^MAGDICOM(2006.563,DA(1),"GE CONV #HRS","B",$E(X,1,30),DA)
"^DD",2006.563,2006.5633,.01,3)
Indicate when this query session started.
"^DD",2006.563,2006.5633,.01,21,0)
^.001^3^3^3040303^^
"^DD",2006.563,2006.5633,.01,21,1,0)
The value of this field is a timestamp ($HOROLOG) that
"^DD",2006.563,2006.5633,.01,21,2,0)
indicates the date and time when a PACS query process
"^DD",2006.563,2006.5633,.01,21,3,0)
was started.
"^DD",2006.563,2006.5633,.01,"DT")
3040303
"^DD",2006.563,2006.5633,2,0)
PACS QUERY END^F^^1;1^K:$L(X)>20!($L(X)<1) X
"^DD",2006.563,2006.5633,2,3)
Indicate when this query ended.
"^DD",2006.563,2006.5633,2,21,0)
^^7^7^3040303^
"^DD",2006.563,2006.5633,2,21,1,0)
The value of this field is a timestamp ($HOROLOG) that
"^DD",2006.563,2006.5633,2,21,2,0)
indicates the date and time when a PACS query process
"^DD",2006.563,2006.5633,2,21,3,0)
completed.
"^DD",2006.563,2006.5633,2,21,4,0)
  
"^DD",2006.563,2006.5633,2,21,5,0)
Note: when a PACS query process was terminated as a side-effect
"^DD",2006.563,2006.5633,2,21,6,0)
of a system-shut-down operation, no completion time
"^DD",2006.563,2006.5633,2,21,7,0)
will be recorded.
"^DD",2006.563,2006.5633,2,"DT")
3040303
"^DD",2006.563,2006.5634,0)
INSTALLATION SUB-FIELD^^1^2
"^DD",2006.563,2006.5634,0,"DT")
3021212
"^DD",2006.563,2006.5634,0,"NM","INSTALLATION")

"^DD",2006.563,2006.5634,0,"UP")
2006.563
"^DD",2006.563,2006.5634,.01,0)
INSTALLATION^F^^0;1^K:$L(X)>14!($L(X)<3)!'(X?1.N1"."1.5N) X
"^DD",2006.563,2006.5634,.01,1,0)
^.1^^0
"^DD",2006.563,2006.5634,.01,3)
Enter the time-stamp ($H-format) for this installation.
"^DD",2006.563,2006.5634,.01,21,0)
^.001^3^3^3021212^^
"^DD",2006.563,2006.5634,.01,21,1,0)
The value of this field is a time-stamp (in $Horolog-format) that
"^DD",2006.563,2006.5634,.01,21,2,0)
identifies the date and time when the current installation of
"^DD",2006.563,2006.5634,.01,21,3,0)
software on the current DICOM Gateway completed.
"^DD",2006.563,2006.5634,.01,"DT")
3021212
"^DD",2006.563,2006.5634,1,0)
COMMENT^F^^0;2^K:$L(X)>60!($L(X)<1) X
"^DD",2006.563,2006.5634,1,3)
Enter a comment that identifies this installation.
"^DD",2006.563,2006.5634,1,21,0)
^^2^2^3021212^
"^DD",2006.563,2006.5634,1,21,1,0)
The value of this field is a text that describes the
"^DD",2006.563,2006.5634,1,21,2,0)
software that was installed.
"^DD",2006.563,2006.5634,1,"DT")
3021212
"^DD",2006.565,2006.565,0)
FIELD^^15^15
"^DD",2006.565,2006.565,0,"DT")
3051115
"^DD",2006.565,2006.565,0,"IX","B",2006.565,.01)

"^DD",2006.565,2006.565,0,"NM","EXPORT DICOM RUN")

"^DD",2006.565,2006.565,0,"PT",2006.563,93)

"^DD",2006.565,2006.565,.01,0)
RUN DATE^RD^^0;1^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",2006.565,2006.565,.01,1,0)
^.1
"^DD",2006.565,2006.565,.01,1,1,0)
2006.565^B
"^DD",2006.565,2006.565,.01,1,1,1)
S ^MAGDICOM(2006.565,"B",X,DA)=""
"^DD",2006.565,2006.565,.01,1,1,2)
K ^MAGDICOM(2006.565,"B",X,DA)
"^DD",2006.565,2006.565,.01,3)
Indicate when this batch run started.
"^DD",2006.565,2006.565,.01,21,0)
^.001^3^3^3051006^^
"^DD",2006.565,2006.565,.01,21,1,0)
The value of this field is a (VA-FileMan formatted) date/time value.
"^DD",2006.565,2006.565,.01,21,2,0)
This value is the time-stamp that indicates the date and time
"^DD",2006.565,2006.565,.01,21,3,0)
when a batch-run was entered into the database.
"^DD",2006.565,2006.565,.01,"DT")
3051006
"^DD",2006.565,2006.565,2,0)
STORAGE SCP^P2006.585'^MAGDICOM(2006.585,^0;2^Q
"^DD",2006.565,2006.565,2,3)
Identify the destination for this transmission.
"^DD",2006.565,2006.565,2,21,0)
^^3^3^3051006^
"^DD",2006.565,2006.565,2,21,1,0)
The value of this field is a pointer to the User Application table
"^DD",2006.565,2006.565,2,21,2,0)
(FileMan file # 2006.585). This pointer identifies the Storage SCP
"^DD",2006.565,2006.565,2,21,3,0)
to which the images are to be transmitted in this batch run.
"^DD",2006.565,2006.565,2,"DT")
3051006
"^DD",2006.565,2006.565,3,0)
SORT ORDER^S^ASCENDING:Ascending;DESCENDING:Descending;^0;3^Q
"^DD",2006.565,2006.565,3,3)
Indicate the scanning direction for this batch run.
"^DD",2006.565,2006.565,3,21,0)
^^4^4^3051006^
"^DD",2006.565,2006.565,3,21,1,0)
The value of this field is a code that indicates the direction
"^DD",2006.565,2006.565,3,21,2,0)
in which the Radiology Report table is to be scanned in this
"^DD",2006.565,2006.565,3,21,3,0)
batch run.
"^DD",2006.565,2006.565,3,21,4,0)
Possible values are "ASCENDING" and "DESCENDING".
"^DD",2006.565,2006.565,3,"DT")
3051006
"^DD",2006.565,2006.565,4,0)
FIRST REPORT^P74'^RARPT(^0;4^Q
"^DD",2006.565,2006.565,4,3)
Identify the first report to include in this scan.
"^DD",2006.565,2006.565,4,21,0)
^^4^4^3051006^
"^DD",2006.565,2006.565,4,21,1,0)
The value of this field is a pointer to the Radiology Report
"^DD",2006.565,2006.565,4,21,2,0)
table (FileMan file # 74).
"^DD",2006.565,2006.565,4,21,3,0)
This pointer identifies the first report for which images
"^DD",2006.565,2006.565,4,21,4,0)
will be included in this batch run.
"^DD",2006.565,2006.565,4,"DT")
3051006
"^DD",2006.565,2006.565,5,0)
MAXIMUM NUMBER OF GROUPS^NJ12,0^^0;5^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.565,2006.565,5,3)
Indicate the maximum number of image groups to include in this scan.
"^DD",2006.565,2006.565,5,21,0)
^^3^3^3051006^
"^DD",2006.565,2006.565,5,21,1,0)
The value of this field is an integer number. This number identifies
"^DD",2006.565,2006.565,5,21,2,0)
the maximum number of image groups that may be included in this
"^DD",2006.565,2006.565,5,21,3,0)
batch run.
"^DD",2006.565,2006.565,5,"DT")
3051006
"^DD",2006.565,2006.565,6,0)
HOURS^F^^0;6^K:$L(X)>24!($L(X)<24) X
"^DD",2006.565,2006.565,6,3)
Indicate when this scan is allowed to be active.
"^DD",2006.565,2006.565,6,21,0)
^^9^9^3051006^
"^DD",2006.565,2006.565,6,21,1,0)
The value of this field is a string. This string consists of
"^DD",2006.565,2006.565,6,21,2,0)
the letters "Y" and "N". This value indicates during which hours
"^DD",2006.565,2006.565,6,21,3,0)
of the day this batch run may be active.
"^DD",2006.565,2006.565,6,21,4,0)
 
"^DD",2006.565,2006.565,6,21,5,0)
A string of 24 letters "Y" denotes a batch run that may run all day long.
"^DD",2006.565,2006.565,6,21,6,0)
 
"^DD",2006.565,2006.565,6,21,7,0)
A string like "YYYYYYYYNNNNNNNNNYYYYYYY" denotes a batch run
"^DD",2006.565,2006.565,6,21,8,0)
that may only run outside of regular office hours (midnight to 9am
"^DD",2006.565,2006.565,6,21,9,0)
and 6pm to midnight).
"^DD",2006.565,2006.565,6,"DT")
3051006
"^DD",2006.565,2006.565,7,0)
END DATE^D^^0;7^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",2006.565,2006.565,7,3)
Indicate date and time of last transmission.
"^DD",2006.565,2006.565,7,21,0)
^.001^3^3^3051115^^^
"^DD",2006.565,2006.565,7,21,1,0)
The value of this field is a (FileMan formatted) date/time..
"^DD",2006.565,2006.565,7,21,2,0)
This value represents the timestamp for the most recent
"^DD",2006.565,2006.565,7,21,3,0)
transmission of a study.
"^DD",2006.565,2006.565,7,"DT")
3051115
"^DD",2006.565,2006.565,8,0)
LAST REPORT^P74'^RARPT(^0;8^Q
"^DD",2006.565,2006.565,8,3)
Identify the last report for which images were transmitted.
"^DD",2006.565,2006.565,8,21,0)
^.001^3^3^3051115^^^
"^DD",2006.565,2006.565,8,21,1,0)
The value of this field is a pointer to the
"^DD",2006.565,2006.565,8,21,2,0)
Radiology Report table. This pointer identifies the
"^DD",2006.565,2006.565,8,21,3,0)
study that was transmitted most recently.
"^DD",2006.565,2006.565,8,"DT")
3051006
"^DD",2006.565,2006.565,9,0)
STUDIES^NJ11,0^^0;9^K:+X'=X!(X>99999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.565,2006.565,9,3)
Indicate how many studies have been processed in this batch run.
"^DD",2006.565,2006.565,9,21,0)
^.001^3^3^3051115^^^
"^DD",2006.565,2006.565,9,21,1,0)
The value of this field is an integer number.
"^DD",2006.565,2006.565,9,21,2,0)
This value identifies the number of studies that have been
"^DD",2006.565,2006.565,9,21,3,0)
processed in the current batch-run.
"^DD",2006.565,2006.565,9,"DT")
3051006
"^DD",2006.565,2006.565,10,0)
NUMBER OF IMAGES^NJ12,0^^0;10^K:+X'=X!(X>999999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.565,2006.565,10,3)
Indicate how many images have been transmitted in this batch run.
"^DD",2006.565,2006.565,10,21,0)
^.001^3^3^3051115^^
"^DD",2006.565,2006.565,10,21,1,0)
The value of this field is an integer number.
"^DD",2006.565,2006.565,10,21,2,0)
This value identifies the number of images that have been
"^DD",2006.565,2006.565,10,21,3,0)
transmitted in the current batch-run.
"^DD",2006.565,2006.565,10,"DT")
3051006
"^DD",2006.565,2006.565,11,0)
SCAN MODE^S^DATE:Date;NUMBER:Report;PATIENT:Patient;^0;11^Q
"^DD",2006.565,2006.565,11,3)
Identify the primary scanning criterium for this batch run.
"^DD",2006.565,2006.565,11,21,0)
^^11^11^3051006^
"^DD",2006.565,2006.565,11,21,1,0)
The value of this field is a code that identifies the method
"^DD",2006.565,2006.565,11,21,2,0)
of scanning the Radiology Reports.
"^DD",2006.565,2006.565,11,21,3,0)
Possible values are "DATE", "NUMBER" and "PATIENT".
"^DD",2006.565,2006.565,11,21,4,0)
 
"^DD",2006.565,2006.565,11,21,5,0)
A value of "DATE" indicates that the reports are scanned by date.
"^DD",2006.565,2006.565,11,21,6,0)
 
"^DD",2006.565,2006.565,11,21,7,0)
A value of "PATIENT" indicates that the reports are scanned
"^DD",2006.565,2006.565,11,21,8,0)
by (internal entry number of) patient.
"^DD",2006.565,2006.565,11,21,9,0)
 
"^DD",2006.565,2006.565,11,21,10,0)
A value of "NUMBER" indicates that the reports are scanned
"^DD",2006.565,2006.565,11,21,11,0)
by (internal entry number of) report.
"^DD",2006.565,2006.565,11,"DT")
3051006
"^DD",2006.565,2006.565,12,0)
START DATE^D^^0;12^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.565,2006.565,12,3)
Identify the first report date to include in this scan.
"^DD",2006.565,2006.565,12,21,0)
^^3^3^3051006^
"^DD",2006.565,2006.565,12,21,1,0)
The value of this field is a (VA-FileMan formatted) date.
"^DD",2006.565,2006.565,12,21,2,0)
This date identifies the first day of the period that is
"^DD",2006.565,2006.565,12,21,3,0)
intended to be included in this batch run.
"^DD",2006.565,2006.565,12,"DT")
3051006
"^DD",2006.565,2006.565,13,0)
END DATE^D^^0;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.565,2006.565,13,3)
Identify the last report date to include in this scan.
"^DD",2006.565,2006.565,13,21,0)
^^3^3^3051006^
"^DD",2006.565,2006.565,13,21,1,0)
The value of this field is a (VA-FileMan formatted) date.
"^DD",2006.565,2006.565,13,21,2,0)
This date identifies the last day of the period that is
"^DD",2006.565,2006.565,13,21,3,0)
intended to be included in this batch run.
"^DD",2006.565,2006.565,13,"DT")
3051006
"^DD",2006.565,2006.565,14,0)
LAST DATE^D^^0;14^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",2006.565,2006.565,14,3)
Indicate the date and time for the most recently processed report.
"^DD",2006.565,2006.565,14,21,0)
^^3^3^3051006^
"^DD",2006.565,2006.565,14,21,1,0)
The value of this field is a (VA-FileMan formatted) date/time value.
"^DD",2006.565,2006.565,14,21,2,0)
This value is the time-stamp that indicates when the Radiology
"^DD",2006.565,2006.565,14,21,3,0)
Report was created for the current study in this batch run.
"^DD",2006.565,2006.565,14,"DT")
3051006
"^DD",2006.565,2006.565,15,0)
PATIENT^P2'^DPT(^0;15^Q
"^DD",2006.565,2006.565,15,3)
Identify the patient to whom the current report applies.
"^DD",2006.565,2006.565,15,21,0)
^^1^1^3051006^
"^DD",2006.565,2006.565,15,21,1,0)
The patient to whom the current report applies.
"^DD",2006.565,2006.565,15,"DT")
3051007
"^DD",2006.574,2006.574,0)
FIELD^^8^8
"^DD",2006.574,2006.574,0,"DDA")
N
"^DD",2006.574,2006.574,0,"DT")
3060213
"^DD",2006.574,2006.574,0,"IX","STUDY",2006.574,7)

"^DD",2006.574,2006.574,0,"NM","DICOM IMAGE OUTPUT")

"^DD",2006.574,2006.574,0,"VRPK")
IMAGING
"^DD",2006.574,2006.574,.01,0)
APPLICATION^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.574,2006.574,.01,1,0)
^.1^^0
"^DD",2006.574,2006.574,.01,3)
Enter the name of the application that will receive the file(s).
"^DD",2006.574,2006.574,.01,21,0)
^^8^8^3000222^^
"^DD",2006.574,2006.574,.01,21,1,0)
The value of this field is a string that identifies
"^DD",2006.574,2006.574,.01,21,2,0)
the application that will receive the image files
"^DD",2006.574,2006.574,.01,21,3,0)
for which this entry describes the parameters.
"^DD",2006.574,2006.574,.01,21,4,0)
 
"^DD",2006.574,2006.574,.01,21,5,0)
The name that is entered here corresponds to the
"^DD",2006.574,2006.574,.01,21,6,0)
name (.01 field) in file 2006.585 (stored in ^MAGDICOM(2006.585,...)
"^DD",2006.574,2006.574,.01,21,7,0)
of the storage provider that will receive the image
"^DD",2006.574,2006.574,.01,21,8,0)
files.
"^DD",2006.574,2006.574,.01,"DT")
3000222
"^DD",2006.574,2006.574,2,0)
GROUP^P2005'^MAG(2005,^0;2^Q
"^DD",2006.574,2006.574,2,3)
Identify the group of images that is to be transported.
"^DD",2006.574,2006.574,2,21,0)
^^7^7^3000222^^
"^DD",2006.574,2006.574,2,21,1,0)
The value of this field is a pointer that identifies
"^DD",2006.574,2006.574,2,21,2,0)
the image that is the 'parent' of the group of images
"^DD",2006.574,2006.574,2,21,3,0)
for which this entry describes the transmission to
"^DD",2006.574,2006.574,2,21,4,0)
another storage provider.
"^DD",2006.574,2006.574,2,21,5,0)
 
"^DD",2006.574,2006.574,2,21,6,0)
The value of this field is a pointer to the Image File
"^DD",2006.574,2006.574,2,21,7,0)
(2005, stored in ^MAG(2005,...).
"^DD",2006.574,2006.574,2,"DT")
3000222
"^DD",2006.574,2006.574,3,0)
ACCESSION NUMBER^F^^0;3^K:$L(X)>20!($L(X)<1) X
"^DD",2006.574,2006.574,3,3)
Enter the accession number for the (group of) image(s) to be transported.
"^DD",2006.574,2006.574,3,21,0)
^^10^10^3000222^^
"^DD",2006.574,2006.574,3,21,1,0)
The value of this field is the (short) case number
"^DD",2006.574,2006.574,3,21,2,0)
for the study that is referenced in this entry.
"^DD",2006.574,2006.574,3,21,3,0)
 
"^DD",2006.574,2006.574,3,21,4,0)
A long case number consists of two groups of digits
"^DD",2006.574,2006.574,3,21,5,0)
separated by a dash. The first group is 6 digits,
"^DD",2006.574,2006.574,3,21,6,0)
and is derived from the date. The second group is
"^DD",2006.574,2006.574,3,21,7,0)
an integer number that uniquely identifies the study
"^DD",2006.574,2006.574,3,21,8,0)
for that date.
"^DD",2006.574,2006.574,3,21,9,0)
 
"^DD",2006.574,2006.574,3,21,10,0)
For this field, the whole accession number is entered.
"^DD",2006.574,2006.574,3,"DT")
3000222
"^DD",2006.574,2006.574,4,0)
IMAGE^2006.5744PA^^1;0
"^DD",2006.574,2006.574,5,0)
FROM^P4'^DIC(4,^0;4^Q
"^DD",2006.574,2006.574,5,1,0)
^.1^^0
"^DD",2006.574,2006.574,5,3)
Enter the name of the "place" from which the image originates.
"^DD",2006.574,2006.574,5,21,0)
^^3^3^3010308^
"^DD",2006.574,2006.574,5,21,1,0)
The value of this field is a pointer (to the Institution file, #4).
"^DD",2006.574,2006.574,5,21,2,0)
This pointer identifies the "place" where the image is permanently
"^DD",2006.574,2006.574,5,21,3,0)
stored.
"^DD",2006.574,2006.574,5,"DT")
3041029
"^DD",2006.574,2006.574,6,0)
PRIORITY^NJ9,0^^0;5^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.574,2006.574,6,3)
Enter an integer number to represent the priority of this queue entry.
"^DD",2006.574,2006.574,6,21,0)
^^6^6^3050602^
"^DD",2006.574,2006.574,6,21,1,0)
The value of this field is a positive integer number.
"^DD",2006.574,2006.574,6,21,2,0)
This number indicates the relative priority of an entry in the queue.
"^DD",2006.574,2006.574,6,21,3,0)
 
"^DD",2006.574,2006.574,6,21,4,0)
A higher number indicates a higher priority, i.e. when two entries
"^DD",2006.574,2006.574,6,21,5,0)
have different priorities, the entry with the higher priority
"^DD",2006.574,2006.574,6,21,6,0)
will be processed before the one with the lower priority.
"^DD",2006.574,2006.574,6,"DT")
3050602
"^DD",2006.574,2006.574,7,0)
STUDY UID^F^^2;1^K:$L(X)>64!($L(X)<1)!'(X?1.(1N,1".")) X
"^DD",2006.574,2006.574,7,1,0)
^.1
"^DD",2006.574,2006.574,7,1,1,0)
2006.574^STUDY
"^DD",2006.574,2006.574,7,1,1,1)
S ^MAGDOUTP(2006.574,"STUDY",$E(X,1,30),DA)=""
"^DD",2006.574,2006.574,7,1,1,2)
K ^MAGDOUTP(2006.574,"STUDY",$E(X,1,30),DA)
"^DD",2006.574,2006.574,7,1,1,"%D",0)
^^2^2^3050818^
"^DD",2006.574,2006.574,7,1,1,"%D",1,0)
This cross reference keeps track of which "studies" are currently
"^DD",2006.574,2006.574,7,1,1,"%D",2,0)
queued for transmission.
"^DD",2006.574,2006.574,7,1,1,"DT")
3050818
"^DD",2006.574,2006.574,7,3)
Enter the Study UID for this group of images.
"^DD",2006.574,2006.574,7,21,0)
^^9^9^3050818^
"^DD",2006.574,2006.574,7,21,1,0)
The value of this field is a string that represents a
"^DD",2006.574,2006.574,7,21,2,0)
DICOM Unique Object Identifier. A DICOM UID is a string
"^DD",2006.574,2006.574,7,21,3,0)
that consists of up to 64 characters, each character must
"^DD",2006.574,2006.574,7,21,4,0)
be either a digit or a period, no two consecutive periods
"^DD",2006.574,2006.574,7,21,5,0)
are allowed, none of the series of consecutive digits
"^DD",2006.574,2006.574,7,21,6,0)
may start with a zero.
"^DD",2006.574,2006.574,7,21,7,0)
 
"^DD",2006.574,2006.574,7,21,8,0)
This UID identifies the study to which the images
"^DD",2006.574,2006.574,7,21,9,0)
belong that are included in the current entry.
"^DD",2006.574,2006.574,7,"DT")
3050818
"^DD",2006.574,2006.574,8,0)
COPY TO RAID^S^0:Do not copy;1:Make a copy;^0;6^Q
"^DD",2006.574,2006.574,8,3)
Indicate whether or not a copy of the image is to be made on RAID.
"^DD",2006.574,2006.574,8,21,0)
^^4^4^3060213^
"^DD",2006.574,2006.574,8,21,1,0)
The value of this field is a code that indicates whether or not
"^DD",2006.574,2006.574,8,21,2,0)
a copy of the image file(s) is to be made on RAID.
"^DD",2006.574,2006.574,8,21,3,0)
A value of 0 indicates that no copy is to be made on RAID.
"^DD",2006.574,2006.574,8,21,4,0)
A value of 1 indicates that a copy should be made.
"^DD",2006.574,2006.574,8,"DT")
3060213
"^DD",2006.574,2006.5744,0)
IMAGE SUB-FIELD^^3^3
"^DD",2006.574,2006.5744,0,"DT")
3041029
"^DD",2006.574,2006.5744,0,"NM","IMAGE")

"^DD",2006.574,2006.5744,0,"UP")
2006.574
"^DD",2006.574,2006.5744,.01,0)
IMAGE^P2005'^MAG(2005,^0;1^Q
"^DD",2006.574,2006.5744,.01,1,0)
^.1^^0
"^DD",2006.574,2006.5744,.01,3)
Identify the image(s) in this transmission.
"^DD",2006.574,2006.5744,.01,21,0)
^^6^6^3000222^^
"^DD",2006.574,2006.5744,.01,21,1,0)
The value of this field is a pointer that identifies
"^DD",2006.574,2006.5744,.01,21,2,0)
one of the images that is to be transmitted to
"^DD",2006.574,2006.5744,.01,21,3,0)
another storage provider.
"^DD",2006.574,2006.5744,.01,21,4,0)
 
"^DD",2006.574,2006.5744,.01,21,5,0)
The value of this field is a pointer to the Image File
"^DD",2006.574,2006.5744,.01,21,6,0)
(2005, stored in ^MAG(2005,...).
"^DD",2006.574,2006.5744,.01,"DT")
3000222
"^DD",2006.574,2006.5744,2,0)
STATUS^S^WAITING:Waiting to be transmitted;XMIT:Transmission in progress;FAIL:Transmission failed;SUCCESS:Transmission successfully completed;^0;2^Q
"^DD",2006.574,2006.5744,2,3)
Indicate the current status of this entry.
"^DD",2006.574,2006.5744,2,21,0)
^^7^7^3041029^
"^DD",2006.574,2006.5744,2,21,1,0)
The value of this field is a code that indicates the current
"^DD",2006.574,2006.5744,2,21,2,0)
status of the entry in this table.
"^DD",2006.574,2006.5744,2,21,3,0)
Possible values are "waiting to be transmitted", "transmission
"^DD",2006.574,2006.5744,2,21,4,0)
in progress" and "successful transmission" or "failed transmission".
"^DD",2006.574,2006.5744,2,21,5,0)
 
"^DD",2006.574,2006.5744,2,21,6,0)
A cross-reference on this field is used to prevent issuing the
"^DD",2006.574,2006.5744,2,21,7,0)
same file to multiple transmission processes.
"^DD",2006.574,2006.5744,2,"DT")
3041029
"^DD",2006.574,2006.5744,3,0)
TIMESTAMP^F^^0;3^K:$L(X)>15!($L(X)<3)!'(X?1.N1","1.N) X
"^DD",2006.574,2006.5744,3,3)
Indicate the current time ($H format).
"^DD",2006.574,2006.5744,3,21,0)
^^10^10^3041029^
"^DD",2006.574,2006.5744,3,21,1,0)
The value of this field is a string ($Horolog format) that
"^DD",2006.574,2006.5744,3,21,2,0)
indicates the date and time that the current status was established.
"^DD",2006.574,2006.5744,3,21,3,0)
 
"^DD",2006.574,2006.5744,3,21,4,0)
This value is used when checking on files that are in a status
"^DD",2006.574,2006.5744,3,21,5,0)
of "transmission in progress". When a file is too long in this
"^DD",2006.574,2006.5744,3,21,6,0)
status, the current entry will be moved back to a status of
"^DD",2006.574,2006.5744,3,21,7,0)
"waiting for transmission".
"^DD",2006.574,2006.5744,3,21,8,0)
 
"^DD",2006.574,2006.5744,3,21,9,0)
See the RPC named "MAG DICOM GET NEXT QUEUE ENTRY" for the
"^DD",2006.574,2006.5744,3,21,10,0)
actual time-lag that decides on a change-back of the status.
"^DD",2006.574,2006.5744,3,"DT")
3041029
"^DD",2006.585,2006.585,0)
FIELD^^8^8
"^DD",2006.585,2006.585,0,"DDA")
N
"^DD",2006.585,2006.585,0,"DT")
3050603
"^DD",2006.585,2006.585,0,"IX","B",2006.585,.01)

"^DD",2006.585,2006.585,0,"NM","USER APPLICATION")

"^DD",2006.585,2006.585,0,"PT",2006.035,1)

"^DD",2006.585,2006.585,0,"VRPK")
IMAGING
"^DD",2006.585,2006.585,.01,0)
SERVICE^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.585,2006.585,.01,1,0)
^.1
"^DD",2006.585,2006.585,.01,1,1,0)
2006.585^B
"^DD",2006.585,2006.585,.01,1,1,1)
S ^MAGDICOM(2006.585,"B",$E(X,1,30),DA)=""
"^DD",2006.585,2006.585,.01,1,1,2)
K ^MAGDICOM(2006.585,"B",$E(X,1,30),DA)
"^DD",2006.585,2006.585,.01,3)
Enter the name of the service that is provided by this application.
"^DD",2006.585,2006.585,.01,21,0)
^^3^3^3000222^^
"^DD",2006.585,2006.585,.01,21,1,0)
The value of this field is a string that specifies
"^DD",2006.585,2006.585,.01,21,2,0)
the name of the service that is called for the application described in the
"^DD",2006.585,2006.585,.01,21,3,0)
current entry.
"^DD",2006.585,2006.585,.01,"DT")
2990830
"^DD",2006.585,2006.585,2,0)
SOP CLASS^2006.5852A^^1;0
"^DD",2006.585,2006.585,3,0)
CALLED AE^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",2006.585,2006.585,3,.1)
Called Application Entity
"^DD",2006.585,2006.585,3,3)
Enter the AE Title of the application being called.
"^DD",2006.585,2006.585,3,21,0)
^^3^3^3000302^^
"^DD",2006.585,2006.585,3,21,1,0)
The value of this field is a string that specifies
"^DD",2006.585,2006.585,3,21,2,0)
the Application Entity Title for the equipment being
"^DD",2006.585,2006.585,3,21,3,0)
called for the application that is described in the current entry.
"^DD",2006.585,2006.585,3,"DT")
2991118
"^DD",2006.585,2006.585,4,0)
CALLING AE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",2006.585,2006.585,4,3)
Enter the AE Title of the entity that calls for the application.
"^DD",2006.585,2006.585,4,21,0)
^^3^3^3000222^^
"^DD",2006.585,2006.585,4,21,1,0)
The value of this field is a string that specifies
"^DD",2006.585,2006.585,4,21,2,0)
the Application Entity Title for the equipment from which
"^DD",2006.585,2006.585,4,21,3,0)
the application is called that is described in the current entry.
"^DD",2006.585,2006.585,4,"DT")
2991118
"^DD",2006.585,2006.585,5,0)
DESTINATION^F^^0;4^K:$L(X)>16!($L(X)<1) X
"^DD",2006.585,2006.585,5,3)
Enter the TCP/IP address of the called application entity.
"^DD",2006.585,2006.585,5,21,0)
^^2^2^3000222^^
"^DD",2006.585,2006.585,5,21,1,0)
The value of this field is a string that specifies the TCP/IP address
"^DD",2006.585,2006.585,5,21,2,0)
of the called application entity.
"^DD",2006.585,2006.585,5,"DT")
2991118
"^DD",2006.585,2006.585,6,0)
PORT^NJ5,0^^0;5^K:+X'=X!(X>65536)!(X<0)!(X?.E1"."1N.N) X
"^DD",2006.585,2006.585,6,3)
Enter the TCP/IP port number for the called application entity.
"^DD",2006.585,2006.585,6,21,0)
^^5^5^3000222^^
"^DD",2006.585,2006.585,6,21,1,0)
The value of this field is an integer number that
"^DD",2006.585,2006.585,6,21,2,0)
identifies the TCP/IP port number to which the
"^DD",2006.585,2006.585,6,21,3,0)
equipment connects calls the application that is described in this entry.
"^DD",2006.585,2006.585,6,21,4,0)
 
"^DD",2006.585,2006.585,6,21,5,0)
TCP/IP port numbers are integers between 1 and 65535.
"^DD",2006.585,2006.585,6,"DT")
2991118
"^DD",2006.585,2006.585,7,0)
PACS^S^GE:General Electric;KODAK:Kodak;^0;6^Q
"^DD",2006.585,2006.585,7,3)
Enter the type of PACS.
"^DD",2006.585,2006.585,7,21,0)
^^6^6^3050603^
"^DD",2006.585,2006.585,7,21,1,0)
The value of this parameter is a string. This string can be
"^DD",2006.585,2006.585,7,21,2,0)
one of a limited number of values. This value identifies
"^DD",2006.585,2006.585,7,21,3,0)
the kind of PACS that hosts the current storage provider.
"^DD",2006.585,2006.585,7,21,4,0)
 
"^DD",2006.585,2006.585,7,21,5,0)
Supported types are currently: GE (General Electric)
"^DD",2006.585,2006.585,7,21,6,0)
and KODAK.
"^DD",2006.585,2006.585,7,"DT")
3050603
"^DD",2006.585,2006.585,8,0)
PRIORITY^NJ10,0^^0;7^K:+X'=X!(X>9999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.585,2006.585,8,3)
Enter the relative priority of transmissions to this SCP (default is 500).
"^DD",2006.585,2006.585,8,21,0)
^^6^6^3050603^
"^DD",2006.585,2006.585,8,21,1,0)
The value of this field is a positive integer number.
"^DD",2006.585,2006.585,8,21,2,0)
This number identifies the relative priority of transmissions
"^DD",2006.585,2006.585,8,21,3,0)
to the SCP that is described in this record.
"^DD",2006.585,2006.585,8,21,4,0)
 
"^DD",2006.585,2006.585,8,21,5,0)
This field is optional. If no value is specified, a default value
"^DD",2006.585,2006.585,8,21,6,0)
of 500 will be used.
"^DD",2006.585,2006.585,8,"DT")
3050603
"^DD",2006.585,2006.5852,0)
SOP CLASS SUB-FIELD^^2^2
"^DD",2006.585,2006.5852,0,"DT")
3000222
"^DD",2006.585,2006.5852,0,"NM","SOP CLASS")

"^DD",2006.585,2006.5852,0,"UP")
2006.585
"^DD",2006.585,2006.5852,.01,0)
SOP CLASS^F^^0;1^K:$L(X)>64!($L(X)<1) X
"^DD",2006.585,2006.5852,.01,1,0)
^.1^^0
"^DD",2006.585,2006.5852,.01,3)
Enter the name of the SOP Class.
"^DD",2006.585,2006.5852,.01,21,0)
^^4^4^3000222^^
"^DD",2006.585,2006.5852,.01,21,1,0)
The value of this field is a string that specifies
"^DD",2006.585,2006.5852,.01,21,2,0)
the name of the SOP class that is supported by the service
"^DD",2006.585,2006.5852,.01,21,3,0)
that is called for the application that is described
"^DD",2006.585,2006.5852,.01,21,4,0)
in the current entry.
"^DD",2006.585,2006.5852,.01,"DT")
3000222
"^DD",2006.585,2006.5852,2,0)
TRANSFER SYNTAX^2006.58522A^^1;0
"^DD",2006.585,2006.58522,0)
TRANSFER SYNTAX SUB-FIELD^^.01^1
"^DD",2006.585,2006.58522,0,"DT")
3000222
"^DD",2006.585,2006.58522,0,"IX","B",2006.58522,.01)

"^DD",2006.585,2006.58522,0,"NM","TRANSFER SYNTAX")

"^DD",2006.585,2006.58522,0,"UP")
2006.5852
"^DD",2006.585,2006.58522,.01,0)
TRANSFER SYNTAX^F^^0;1^K:$L(X)>50!($L(X)<1) X
"^DD",2006.585,2006.58522,.01,1,0)
^.1
"^DD",2006.585,2006.58522,.01,1,1,0)
2006.58522^B
"^DD",2006.585,2006.58522,.01,1,1,1)
S ^MAGDICOM(2006.585,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",2006.585,2006.58522,.01,1,1,2)
K ^MAGDICOM(2006.585,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",2006.585,2006.58522,.01,1,2,0)
2006.58522^B
"^DD",2006.585,2006.58522,.01,1,2,1)
S ^MAGDICOM(2006.585,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",2006.585,2006.58522,.01,1,2,2)
K ^MAGDICOM(2006.585,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",2006.585,2006.58522,.01,1,2,"DT")
3000222
"^DD",2006.585,2006.58522,.01,3)
Enter the name of the transfer syntax.
"^DD",2006.585,2006.58522,.01,21,0)
^^10^10^3000222^^
"^DD",2006.585,2006.58522,.01,21,1,0)
The value of this field is a string that specifies
"^DD",2006.585,2006.58522,.01,21,2,0)
a transfer syntax that may be used for the service
"^DD",2006.585,2006.58522,.01,21,3,0)
that is called for the application that is described
"^DD",2006.585,2006.58522,.01,21,4,0)
in the current entry.
"^DD",2006.585,2006.58522,.01,21,5,0)
 
"^DD",2006.585,2006.58522,.01,21,6,0)
Possible values for this field are:
"^DD",2006.585,2006.58522,.01,21,7,0)
   Implicit VR Little Endian
"^DD",2006.585,2006.58522,.01,21,8,0)
   Implicit VR Big Endian
"^DD",2006.585,2006.58522,.01,21,9,0)
   Explicit VR Little Endian
"^DD",2006.585,2006.58522,.01,21,10,0)
   Explicit VR Big Endian
"^DD",2006.585,2006.58522,.01,"DT")
3000222
"^DIC",2006.563,2006.563,0)
DICOM GATEWAY PARAMETER^2006.563
"^DIC",2006.563,2006.563,0,"GL")
^MAGDICOM(2006.563,
"^DIC",2006.563,2006.563,"%",0)
^1.005^^0
"^DIC",2006.563,2006.563,"%D",0)
^^24^24^3020815^
"^DIC",2006.563,2006.563,"%D",1,0)
 +---------------------------------------------------------------+
"^DIC",2006.563,2006.563,"%D",2,0)
 |                                                               |
"^DIC",2006.563,2006.563,"%D",3,0)
 | Property of the US Government.                                |
"^DIC",2006.563,2006.563,"%D",4,0)
 | No permission to copy or redistribute this software is given. |
"^DIC",2006.563,2006.563,"%D",5,0)
 | Use of unreleased versions of this software requires the user |
"^DIC",2006.563,2006.563,"%D",6,0)
 | to execute a written test agreement with the VistA Imaging    |
"^DIC",2006.563,2006.563,"%D",7,0)
 | Development Office of the Department of Veterans Affairs,     |
"^DIC",2006.563,2006.563,"%D",8,0)
 | telephone (301) 734-0100.                                     |
"^DIC",2006.563,2006.563,"%D",9,0)
 |                                                               |
"^DIC",2006.563,2006.563,"%D",10,0)
 | The Food and Drug Administration classifies this software as  |
"^DIC",2006.563,2006.563,"%D",11,0)
 | a medical device.  As such, it may not be changed in any way. |
"^DIC",2006.563,2006.563,"%D",12,0)
 | Modifications to this software may result in an adulterated   |
"^DIC",2006.563,2006.563,"%D",13,0)
 | medical device under 21CFR820, the use of which is considered |
"^DIC",2006.563,2006.563,"%D",14,0)
 | to be a violation of US Federal Statutes.                     |
"^DIC",2006.563,2006.563,"%D",15,0)
 |                                                               |
"^DIC",2006.563,2006.563,"%D",16,0)
 +---------------------------------------------------------------+
"^DIC",2006.563,2006.563,"%D",17,0)
 
"^DIC",2006.563,2006.563,"%D",18,0)
This table contains only one entry.
"^DIC",2006.563,2006.563,"%D",19,0)
The information in this entry defines the customization for the DICOM
"^DIC",2006.563,2006.563,"%D",20,0)
Gateway Processor on which this table is stored.
"^DIC",2006.563,2006.563,"%D",21,0)
Note that some site-specific parameters apply to the whole site, those
"^DIC",2006.563,2006.563,"%D",22,0)
parameters are stored in the table "IMAGING SITE PARAMETERS", and other
"^DIC",2006.563,2006.563,"%D",23,0)
parameters apply to the individual PCs. The latter parameters are stored
"^DIC",2006.563,2006.563,"%D",24,0)
in this table.
"^DIC",2006.563,"B","DICOM GATEWAY PARAMETER",2006.563)

"^DIC",2006.565,2006.565,0)
EXPORT DICOM RUN^2006.565
"^DIC",2006.565,2006.565,0,"GL")
^MAGDICOM(2006.565,
"^DIC",2006.565,2006.565,"%D",0)
^^20^20^3050907^
"^DIC",2006.565,2006.565,"%D",1,0)
 +---------------------------------------------------------------+
"^DIC",2006.565,2006.565,"%D",2,0)
 |                                                               |
"^DIC",2006.565,2006.565,"%D",3,0)
 | Property of the US Government.                                |
"^DIC",2006.565,2006.565,"%D",4,0)
 | No permission to copy or redistribute this software is given. |
"^DIC",2006.565,2006.565,"%D",5,0)
 | Use of unreleased versions of this software requires the user |
"^DIC",2006.565,2006.565,"%D",6,0)
 | to execute a written test agreement with the VistA Imaging    |
"^DIC",2006.565,2006.565,"%D",7,0)
 | Development Office of the Department of Veterans Affairs,     |
"^DIC",2006.565,2006.565,"%D",8,0)
 | telephone (301) 734-0100.                                     |
"^DIC",2006.565,2006.565,"%D",9,0)
 |                                                               |
"^DIC",2006.565,2006.565,"%D",10,0)
 | The Food and Drug Administration classifies this software as  |
"^DIC",2006.565,2006.565,"%D",11,0)
 | a medical device.  As such, it may not be changed in any way. |
"^DIC",2006.565,2006.565,"%D",12,0)
 | Modifications to this software may result in an adulterated   |
"^DIC",2006.565,2006.565,"%D",13,0)
 | medical device under 21CFR820, the use of which is considered |
"^DIC",2006.565,2006.565,"%D",14,0)
 | to be a violation of US Federal Statutes.                     |
"^DIC",2006.565,2006.565,"%D",15,0)
 |                                                               |
"^DIC",2006.565,2006.565,"%D",16,0)
 +---------------------------------------------------------------+
"^DIC",2006.565,2006.565,"%D",17,0)
 
"^DIC",2006.565,2006.565,"%D",18,0)
This table contains information about batch runs that export DICOM data.
"^DIC",2006.565,2006.565,"%D",19,0)
Each record in this table keeps track of the actual parameters of
"^DIC",2006.565,2006.565,"%D",20,0)
one single batch run.
"^DIC",2006.565,"B","EXPORT DICOM RUN",2006.565)

"^DIC",2006.574,2006.574,0)
DICOM IMAGE OUTPUT^2006.574
"^DIC",2006.574,2006.574,0,"GL")
^MAGDOUTP(2006.574,
"^DIC",2006.574,2006.574,"%",0)
^1.005^^0
"^DIC",2006.574,2006.574,"%D",0)
^^21^21^3010619^
"^DIC",2006.574,2006.574,"%D",1,0)
 +---------------------------------------------------------------+
"^DIC",2006.574,2006.574,"%D",2,0)
 |                                                               |
"^DIC",2006.574,2006.574,"%D",3,0)
 | Property of the US Government.                                |
"^DIC",2006.574,2006.574,"%D",4,0)
 | No permission to copy or redistribute this software is given. |
"^DIC",2006.574,2006.574,"%D",5,0)
 | Use of unreleased versions of this software requires the user |
"^DIC",2006.574,2006.574,"%D",6,0)
 | to execute a written test agreement with the VistA Imaging    |
"^DIC",2006.574,2006.574,"%D",7,0)
 | Development Office of the Department of Veterans Affairs,     |
"^DIC",2006.574,2006.574,"%D",8,0)
 | telephone (301) 734-0100.                                     |
"^DIC",2006.574,2006.574,"%D",9,0)
 |                                                               |
"^DIC",2006.574,2006.574,"%D",10,0)
 | The Food and Drug Administration classifies this software as  |
"^DIC",2006.574,2006.574,"%D",11,0)
 | a medical device.  As such, it may not be changed in any way. |
"^DIC",2006.574,2006.574,"%D",12,0)
 | Modifications to this software may result in an adulterated   |
"^DIC",2006.574,2006.574,"%D",13,0)
 | medical device under 21CFR820, the use of which is considered |
"^DIC",2006.574,2006.574,"%D",14,0)
 | to be a violation of US Federal Statutes.                     |
"^DIC",2006.574,2006.574,"%D",15,0)
 |                                                               |
"^DIC",2006.574,2006.574,"%D",16,0)
 +---------------------------------------------------------------+
"^DIC",2006.574,2006.574,"%D",17,0)
 
"^DIC",2006.574,2006.574,"%D",18,0)
The entries in this table describe requests to transmit image files
"^DIC",2006.574,2006.574,"%D",19,0)
to an alternate storage provider.
"^DIC",2006.574,2006.574,"%D",20,0)
The top-level of this table identifies the storage provider, the next
"^DIC",2006.574,2006.574,"%D",21,0)
level identifies the images for which files are to be transmitted.
"^DIC",2006.574,"B","DICOM IMAGE OUTPUT",2006.574)

"^DIC",2006.585,2006.585,0)
USER APPLICATION^2006.585
"^DIC",2006.585,2006.585,0,"GL")
^MAGDICOM(2006.585,
"^DIC",2006.585,2006.585,"%",0)
^1.005^^0
"^DIC",2006.585,2006.585,"%D",0)
^^19^19^3010619^
"^DIC",2006.585,2006.585,"%D",1,0)
 +---------------------------------------------------------------+
"^DIC",2006.585,2006.585,"%D",2,0)
 |                                                               |
"^DIC",2006.585,2006.585,"%D",3,0)
 | Property of the US Government.                                |
"^DIC",2006.585,2006.585,"%D",4,0)
 | No permission to copy or redistribute this software is given. |
"^DIC",2006.585,2006.585,"%D",5,0)
 | Use of unreleased versions of this software requires the user |
"^DIC",2006.585,2006.585,"%D",6,0)
 | to execute a written test agreement with the VistA Imaging    |
"^DIC",2006.585,2006.585,"%D",7,0)
 | Development Office of the Department of Veterans Affairs,     |
"^DIC",2006.585,2006.585,"%D",8,0)
 | telephone (301) 734-0100.                                     |
"^DIC",2006.585,2006.585,"%D",9,0)
 |                                                               |
"^DIC",2006.585,2006.585,"%D",10,0)
 | The Food and Drug Administration classifies this software as  |
"^DIC",2006.585,2006.585,"%D",11,0)
 | a medical device.  As such, it may not be changed in any way. |
"^DIC",2006.585,2006.585,"%D",12,0)
 | Modifications to this software may result in an adulterated   |
"^DIC",2006.585,2006.585,"%D",13,0)
 | medical device under 21CFR820, the use of which is considered |
"^DIC",2006.585,2006.585,"%D",14,0)
 | to be a violation of US Federal Statutes.                     |
"^DIC",2006.585,2006.585,"%D",15,0)
 |                                                               |
"^DIC",2006.585,2006.585,"%D",16,0)
 +---------------------------------------------------------------+
"^DIC",2006.585,2006.585,"%D",17,0)
 
"^DIC",2006.585,2006.585,"%D",18,0)
The entries in this table describe the various services that are
"^DIC",2006.585,2006.585,"%D",19,0)
being used by the DICOM Gateway as a DICOM Service User.
"^DIC",2006.585,"B","USER APPLICATION",2006.585)

**END**
**END**


****
****
