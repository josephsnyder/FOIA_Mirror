
=============================================================================
Run Date: AUG 30, 2011                     Designation: MAG*3*117
Package : MAG - IMAGING                       Priority: Mandatory
Version : 3        SEQ #77                      Status: Released
                  Compliance Date: SEP 30, 2011
=============================================================================

Associated patches: (v)MAG*3*93    <<= must be installed BEFORE `MAG*3*117'
                    (v)MAG*3*106   <<= must be installed BEFORE `MAG*3*117'

Subject: CLINICAL CAPTURE AND DISPLAY ENHANCEMENT

Category: 
  - Routine
  - Data Dictionary
  - Other
  - Enhancement (Mandatory)

Description:
============

 This document describes MAG*3.0*117, the VistA Imaging Clinical Capture 
 and Display enhancement patch.
  
 Clinical Capture changes include:
  
 * QA Review and QA Report functionalities are no longer available in 
   Clinical Capture. 
  
 * Several improvements have been made to the TeleReader Consult image
   capture workflow. 
  
 Clinical Display changes include:
  
 * Users that hold the new MAG QA REVIEW security key will be able 
   to access QA Review and QA Report windows.
  
 * Users can run the QA Statistics Reports in the background and will
   also be able to specify any date range to be included in the report
   in Clinical Display.
  
 * Users can edit the status of each image contained in the group in the
   QA Review Window.
  
 * The patient's SSN information will be displayed in the Clinical Display
   QA Review window when a patient's image is viewed.
  
 * Users can choose to display Deleted Image Placeholders in the Image List
   window by selecting the option in the Image List view. This setting can
   now be saved as a user preference. 
  
 * Users can view Neurocognitive Assessment Tool (NCAT) data and other
   artifacts from DoD sites. 
  
 * Users that hold the MAG ROI security key will now be able to print
   multiple images at a time.
  
 * Various minor usability improvements and bug fixes.  
  
 NOTE: Patch 117 version checking will support only client versions 117, 
       106 and 94. All client versions that have been released prior to
       Patch 94 will not be supported.
  
 For details on these changes, refer to the 
 MAG3_0P117_Patch_Description.pdf document distributed with the patch.
  
 Distribution of Software:
 =========================
  
 This patch can be downloaded from:
  
   ftp.imaging.med.va.gov/Software/Released_Software/Mag3_0P117
  
 Installation instructions are included in this document.
  
 NOTE Any late-breaking news about this patch will be found in a readme 
 file.  If present, this file will also be located in the MAG3_0P117 
 directory. 
  
 Patch Contents:
 ===============
  
 This patch includes the following files: 
  
 Software:
 =========
  
 MAG3_0P117.KID - KIDS (Kernel Installation & Distribution System) package 
 to be installed on the VistA System.
  
 MAG3_0P117_Install.exe - Installation file for Clinical Display and 
                          Capture client software.
  
 MAG3_0P117_Install.msi - Installation file for sites using SMS or similar 
                          software. 
  
 MagAUShare.zip - Zip file containing files used by Auto-update sites. 
                  Contains MagASet.exe, MagSetup.exe, and magnet.ini.
  
 Documentation:
 ==============
  
 MAG3_0P117_Patch_Description.pdf - VistA Imaging Patch Description
  
 MAG_Display_User_Manual.pdf - Clinical Display User Manual
  
 MAG_Capture_User_Manual.pdf - Clinical Capture User Manual
  
 MAG3_0P117_Security_Guide_Changes.pdf - Security Guide change pages 
  
 MAG3_0P117_Install_Guide_Changes.pdf - Install Guide change pages
  
 MAG3_0P117_Technical_Manual_Changes.pdf - Technical Manual change pages
  
 Associated Patches:
 ===================
  
 Before Patch 117 is installed, the following patches must be installed:
  
   MAG*3.0*106
  
 For a list of all released Imaging (MAG) patches, refer to the 
 patch_list.txt file available on the Imaging FTP server (go to 
 ftp://ftp.imaging.med.va.gov, and then navigate to the 
 \Docs\Imaging_Docs_Latest folder).
  
 Test Sites:
 ===========
  
 The following sites are test sites for this patch:
  
 Altoona, PA (Small)
 Boston, MA (Integrated, Large)
 Charleston, SC (Large)
 Fayetteville, NC (Large)
 Montana HCS (Integrated)
 VISN 02 (Integrated, Large)
 West Haven, CT (Integrated, Large)
 West Los Angeles, CA (Integrated, Large)
  
 Remedy Calls:
 =============
  
 The following Remedy help desk calls are addressed in this patch:
  
 364548  TIU business rules to be fully implemented 
  
 365425  QA Review window in P93 should include Patient SSN info
  
 367570  Need two keys
  
 392150  Network folder with patient photo 
  
 392808  Issue 1: Image shows up as squiggly lines in the imaging client.
  
 397447  QA Review Report will not run.
  
 405846  QA reports not functioning as they used to.
  
 426919  JPG of patient photo in user network folder 
  
 433153  Bug in VistA Imaging QA Review Report: change status of <empty>
         to <viewable>.
  
 448310  QA REPORTS
  
 468802  MUSE/EKG - EKG retrieval taking too long
  
 484529  FOLDER ON C DRIVE WITH PATIENT PICTURES
  
 New Service Requests (NSRs):
 ============================
  
 20080304        Deleted Images
  
 This New Service Request requests that a placeholder is inserted on the
 GUI when an image has been found to be added to the wrong patient record
 and has been deleted from the record.
  
 20091208        NCAT Data from DoD to VA.
  
 This New Service Request requests that authorized VA users have access
 to DoD NCAT data for shared VA/DoD patients.
  
 2010-2012       JSP Objective 4.2.A
  
 Activity 3:
  
 VA will begin implementing technical solutions to enable VA providers
 to view DoD neuropsychological assessment data by June 30, 2011. 
  
  
 VistA System KIDS Summary Changes:
 ==================================
  
 Data Dictionaries:
 ==================
  
 MULTI IMAGE PRINT file (#2006.961) - New File. This file contains a log
 of multiple images that have been queued for printing.
  
 * PATIENT (#2006.961,.01) - New.  This is the patient whose images 
   were printed. 
  
 * PRINT DATE (#2006.961,1) - New. This field is the date and time 
   the images were printed. 
  
 * USER (#2006.961,2) - New. This is the person who printed the images.
  
 * REASON FOR PRINT (#2006.961,3) - New. This field indicates the reason
   the images were printed. The reason is copied from the REASON field 
   (#.01) of the MAG REASON file (#2005.88), as selected by the user.
  
 * IMAGES PRINTED (#2006.961,10) - New. This multiple contains the images
   which were printed.
  
 * IMAGE ID (#2006.9613,.01) - New. This field identifies the image
   sequence in the printing process.
  
 * IMAGE (#2006.9613,1) - New. This is the image that was printed.
  
 * IMAGE PRINT INFORMATION (#2006.9613,2) - New. This field identifies the
   image text displayed to the user in the VistA Imaging Clinical Capture
   and Display application and the print status of the image. 
  
 * REMOTE IMAGE (#2006.9613,3) - New. This field is used to identify a
   remote image location identifier. This field may be a URL or internal
   entry number on another system.
  
 IMAGE (#2005) File - Modified file.
  
 * Added cross reference ADTDUZ  - This cross reference optimizes the
   summation of counts of images captured by capture application, by date,
   by user, by site. 
  
 IMAGE AUDIT file (#2005.1) - Modified file. 
  
 * OBJECT NAME (#2005.1,.01) - Modified. Cross-reference modified to store
   the internal value of field STATUS (#113)
  
 * Added cross reference ADTDUZ  - This cross reference optimizes the 
   summation of counts of images captured by capture application, by date,
   by user, by site.
  
 IMAGING USER PREFERENCE file (#2006.18) - Modified file.
  
 * SHOW DELETED IMAGE PLACEHOLDER (#2006.18,78) - New. The value of this
   field controls the visibility of the deleted image placeholder in VistA
   Imaging Display.
  
 * SUPPRESS PRINT SUMMARY APPPREFS(#2006.18,79) - New. Enables the user to
   suppress the printing of the 'Print Summary' at the end of a Multi-Image
   print. 
  
 * RIVER AUTO CONNECT DOD (#2006.18,304)   New. Determines if the
   display client should automatically connect to DoD sites for the
   selected patient. 
  
 Security Keys:
 ==============
  
 The following security keys are included in this patch.
  
 MAG QA REVIEW - New.  This security key grants access to QA Review and
 QA Review Reports functionality.
  
 MAG REVIEW NCAT - New. MAG REVIEW NCAT enables the key holders to view
 NCAT images. 
  
 Remote Procedures:
 ==================
  
 The following RPCs (remote procedure calls) are included in this patch.
  
 MAG4 GET IMAGE INFO - Modified: A new input parameter (FLAGS) has been
 added that controls the execution. When "D  is sent the RPC considers 
 deleted image information. 
  
 MAG4 IMAGE LIST - Modified : A new value to input parameter FLAGS has 
 been introduced. It controls which group images in the list of images 
 are returned. If any image in a group has an image that matches the 
 status provided in the search criteria then the group will be returned.
 If the G flag is not sent then only the status of the Group entry will
 be checked and the group will be returned if it passes the check.
  
 MAGG GROUP IMAGES - Modified: A new input parameter (FLAGS) has been 
 added that controls the execution. When "D  is sent the RPC returns 
 deleted image information as well.
  
 MAGG IMAGE STATISTICS BY USER - New : Returns all statistics reports
 previously tasked for a user.
  
 MAGG IMAGE STATISTICS QUE - New: Queues a job through VA TaskMan that
 queries the image file(s) and returns various statistics/summary data.
  
 MAGG JUKE BOX PATH - New: Returns the Juke Box path to an image.
  
 MAGG MULTI IMAGE PRINT - New: Logs multiple images printed for a patient
 in the MULTI IMAGE PRINT file (#2006.961)
  
 MAGG PAT INFO - Modified: A new input parameter (FLAGS) has been added.
 When "D  is sent the RPC includes deleted image information. 
  
 Menu Options:
 =============
  
 The following new menu options are included in this patch:
  
 MAG REBUILD DATE-USER INDICES   New. Rebuilds the ADTDUZ cross references
 on the IMAGE File (#2005) and the IMAGE AUDIT File (#2005.1).
  
 Note: The ADTDUZ cross reference greatly optimizes the function that
 returns a list of users that have captured image in a certain date range. 
 If the QA Review window experiences time out errors while waiting for a 
 list of users when  Captured by  button is clicked, then this Option 
 should be run to assure the Cross reference has been created.
  
 Templates:
 ==========
  
 There are no new or modified templates included in this patch.
  
 Installation:
 =============
  
 This patch is to be installed on the VistA System and on the Clinical 
 workstations.
  
 This patch may be loaded while VistA Imaging System is active.  The KIDS
 installation will take approximately one minute. Do not task the 
 installation to run during off hours due to a prompt that must be 
 answered during the installation.
  
 During the install process, you must answer the question pertaining to
 building the ADTDUZ cross reference. You can choose to index the new cross
 reference ADTDUZ in the Foreground or Background. It is important to note 
 that if you choose to run this in the foreground, it will take 
 approximately one hour per every 15 million entries to complete 
 installation. 
  
 NOTE: It is highly recommended that you run the indexing in the
 background. Example shown below.
  
    This option builds the ADTDUZ cross reference on Files 2005 and 2005.1
    to optimize the gathering of user capture statistics.
  
  
         Select one of the following:
  
              F         Execute in the foreground
              B         Execute in the background
  
    Enter F or B:B Execute in the background...........
  
  
 AS A PART OF THE POST INSTALLATION OF THE KIDS, AN UPDATE OF STATUS FIELD
 (#113) IN IMAGE FILE (#2005) AND IMAGE AUDIT FILE (#2005.1) WILL OCCUR. 
 TWO TASKS WILL BE CREATED. THE TASKS ARE:
  
 1. Patch 117: Update of STATUS field (#113) in IMAGE file (#2005)
  
 2. Patch 117: Update of STATUS field (#113) in IMAGE AUDIT file 
    (#2005.1)
  
 The update will take approximately 60 minutes. This patch must be 
 installed by the compliance date to conform to VHA Directive 2001-023. 
  
 FOR FULL DETAILS AND INSTALLATION INSTRUCTIONS, refer to the 
 MAG3_0P117_Patch_Description.pdf document distributed with the patch.
  
 Installation Prerequisites:
 ===========================
  
 Before installing this patch, you will need to download the Patch 117 
 files from the Imaging FTP site to a local storage location.
  
 Verify that the patches listed in the Associated Patches section have 
 been installed.
  
 VistA System (KIDS) Installation:
 =================================
  
 All sites must install the KIDS portion of this patch.
  
 Installing the KIDS Package:
  
 1 Access the Kernel Installation and Distribution System Menu [XPD MAIN].
  
 2 Run the Installation option [XPD INSTALLATION MENU].
  
 3 Load the KIDS file by performing the following steps:
  
   a Run the Load a Distribution option [XPD LOAD DISTRIBUTION] to load 
     the KIDS distribution.
   b When prompted, enter the path and file name (MAG3_0P117.KID) of the 
     Patch 117 KIDS file that you downloaded from the Imaging FTP server.
   c When prompted to continue with the load, enter YES. 
  
 The Distribution OK! message will be displayed when the load is complete.
  
 4 After loading the KIDS file, use the following options to verify the 
   contents of the patch and to back up any affected routines.
  
   Verify Checksums in Transport Global [XPD PRINT CHECKSUM] run this 
   option if you want to ensure the integrity of the routines in the patch.
  
   Compare Transport Global to Current System [XPD COMPARE TO SYSTEM]   
   run this option if you want to view all changes that will be made when 
   the patch is installed. All components (routines, options, and so on) in
   the patch will be compared.
  
   Backup a Transport Global [XPD BACKUP]   run this option if you want to 
   create a backup message of any routines exported with the patch. It will
   NOT back up any of the other changes.
  
 5 After performing the load and any optional verification steps, install 
   the KIDS file by performing the following steps:
  
   a Run the Install Package(s) option [XPD INSTALL BUILD].
   b When prompted for the install name, enter MAG*3.0*117.
   c Answer NO to the following prompts:
  
     Want KIDS to INHIBIT LOGONs during the install? No//NO
     Want to DISABLE Scheduled Options, Menu Options, and Protocols? 
       YES//NO
  
 When installation has finished, an Install Complete message will be 
 displayed.
  
 Sample KIDS Installation:
 =========================
  
 Select Installation Option: 6  Install Package(s)
 Select INSTALL NAME: mag*3.0*117      8/3/11@12:01:20
      => VistA Imaging V3.0 - Patch 117 - 07/15/2011 11:16AM  ;Created o
  
 This Distribution was loaded on Aug 03, 2011@12:01:20 with header of 
    VistA Imaging V3.0 - Patch 117 - 07/15/2011 11:16AM  ;Created on Jul 1
 5, 2011@11:16:47
    It consisted of the following Install(s):
     MAG*3.0*117
 Checking Install for Package MAG*3.0*117
  
 Install Questions for MAG*3.0*117
  
 Incoming Files:
  
  
    2005      IMAGE  (Partial Definition)
 Note:  You already have the 'IMAGE' File.
  
  
    2005.1    IMAGE AUDIT  (Partial Definition)
 Note:  You already have the 'IMAGE AUDIT' File.
  
  
    2006.18   IMAGING USER PREFERENCE  (Partial Definition)
 Note:  You already have the 'IMAGING USER PREFERENCE' File.
  
  
    2006.961  MULTI IMAGE PRINT
  
 Want KIDS to Rebuild Menu Trees Upon Completion of Install? NO// 
  
  
 Want KIDS to INHIBIT LOGONs during the install? NO// 
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? NO// 
  
 Enter the Device you want to print the Install messages.
 You can queue the install by enter a 'Q' at the device prompt.
 Enter a '^' to abort the install.
  
 DEVICE: HOME//   HERE
  
  
  Install Started for MAG*3.0*117 : 
                Aug 03, 2011@12:01:35
  
 Build Distribution Date: Jul 15, 2011
  
  Installing Routines:............................
                Aug 03, 2011@12:01:35
  
  Running Pre-Install Routine: PRE^MAGIP117.
  
  Installing Data Dictionaries: ......
                Aug 03, 2011@12:01:36
  
  Installing PACKAGE COMPONENTS: 
  
  Installing SECURITY KEY...
  
  Installing REMOTE PROCEDURE.........
  
  Installing OPTION..
                Aug 03, 2011@12:01:36
  
  Running Post-Install Routine: POS^MAGIP117..
  
    Attaching RPCs to the 'MAG WINDOWS' option...
    MAGG IMAGE STATISTICS BY USER
    MAGG IMAGE STATISTICS QUE
    MAGG JUKE BOX PATH
    MAGG MULTI IMAGE PRINT
    RPCs have been successfully attached...
 Imaging DATE-USER-SITE index rebuild
  
 This option builds the ADTDUZ cross reference on Files 2005 and 2005.1
 to optimize the gathering of user capture statistics.
  
 This option has previously been run to completion.
 Enter F or B to re-run, or up-arrow (^) to exit.
  
  
      Select one of the following:
  
           F         Execute in the foreground
           B         Execute in the background
  
 Enter F or B: B  Execute in the background
 Queued as task number 477587
 .
  
    Setting Delete Image Placeholder to True
  
    Clearing orphaned QA Statistics from XTMP
  
  Updating Routine file......
  
  Updating KIDS files.......
  
  MAG*3.0*117 Installed. 
                Aug 03, 2011@12:01:41
  
  
  
 Clinical Workstation Installation:
 ==================================
  
 For details on the Clinical Workstation Installation process, refer to 
 the 
 MAG3_0P117_Patch_Description.pdf document distributed with the patch.
  
  
 KIDS Routines and Checksums:
 ============================
  
 New and modified Imaging routines for the VistA system are listed below.  
 For each routine, the second line will contain the following information. 
  
 Note: The before checksum may differ if a test version of the patch has 
 been installed.
  
 ;;3.0; IMAGING;**[PATCH LIST]**; Mar 19, 2002; Build 2238; Jul 15, 2011
  
 Checksums are calculated using the KERNEL utility program CHECK1^XTSUMBLD.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: MAGGA02
    Before: B57822621   After: B61650938  **93,117**
Routine Name: MAGGA02A
    Before: B40367747   After: B46417366  **93,117**
Routine Name: MAGGA03Q
    Before:       n/a   After: B73673627  **117**
Routine Name: MAGGA03U
    Before: B15820919   After: B13661023  **93,117**
Routine Name: MAGGI13
    Before: B36748899   After: B43871753  **93,117**
Routine Name: MAGGROI
    Before:       n/a   After: B12411084  **117**
Routine Name: MAGGSIA1
    Before: B41835903   After: B42690778  **7,8,85,59,93,106,117**
Routine Name: MAGGTIA
    Before: B47129366   After: B48548549  **8,48,106,117**
Routine Name: MAGGTIG
    Before: B58640406   After: B59987290  **8,48,93,117**
Routine Name: MAGGTPT1
    Before: B37889156   After: B43431536  **16,8,92,46,59,93,117**
Routine Name: MAGGTRA
    Before: B11950621   After: B12029388  **59,117**
Routine Name: MAGGTSY2
    Before:  B5995567   After:  B6386006  **59,117**
Routine Name: MAGGTSYS
    Before: B11574384   After: B12933916  **59,93,117**
Routine Name: MAGGTU3
    Before: B34334075   After: B33436210  **7,8,48,45,20,46,59,93,117**
Routine Name: MAGGTU31
    Before: B41847617   After: B50418193  **46,59,93,117**
Routine Name: MAGGTU4C
    Before:  B5091959   After:  B4896018  **93,94,106,117**
Routine Name: MAGGTU4D
    Before:  B5097764   After:  B4901823  **93,94,106,117**
Routine Name: MAGGTU4L
    Before:  B5092040   After:  B4896099  **93,94,106,117**
Routine Name: MAGGTU4T
    Before:  B5092112   After:  B4896171  **93,94,106,117**
Routine Name: MAGGTU6
    Before: B51862098   After: B51349836  **24,8,48,45,20,46,59,72,93,117**
Routine Name: MAGGTUP
    Before: B23961945   After: B24946997  **7,8,48,45,59,93,94,117**
Routine Name: MAGGTUX4
    Before:       n/a   After: B10042466  **117**
Routine Name: MAGGUJB
    Before:       n/a   After: B14550887  **117**
Routine Name: MAGIP117
    Before:       n/a   After: B13359033  **117**
Routine Name: MAGSIXG1
    Before: B36487191   After: B37750042  **8,48,59,93,117**
Routine Name: MAGSIXG3
    Before: B65195475   After: B80973956  **93,117**
Routine Name: MAGUXDPS
    Before:       n/a   After: B18227402  **117**
 
Routine list of preceding patches: 106

=============================================================================
User Information:
Entered By  : TROMBETTA,KATHY               Date Entered  : JUL 13, 2010
Completed By: SHOVESTUL,MARYANN             Date Completed: AUG 30, 2011
Released By : BLACK,KATHLEEN                Date Released : AUG 30, 2011
=============================================================================


Packman Mail Message:
=====================

No routines included
