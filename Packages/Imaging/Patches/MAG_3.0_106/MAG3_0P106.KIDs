KIDS Distribution saved on Feb 28, 2011@12:34:03
VistA Imaging V3.0 - Patch 106 - 02/28/2011 12:34PM
**KIDS**:MAG*3.0*106^

**INSTALL NAME**
MAG*3.0*106
"BLD",3463,0)
MAG*3.0*106^IMAGING^0^3110228^y
"BLD",3463,1,0)
^^21^21^3110228^
"BLD",3463,1,1,0)
Version 3.0 Patch 106 - Teledermatology
"BLD",3463,1,2,0)
 
"BLD",3463,1,3,0)
 
"BLD",3463,1,4,0)
Routines:
"BLD",3463,1,5,0)
MAGDHWC     new value = 48238555
"BLD",3463,1,6,0)
MAGGSIA1    new value = 41835903
"BLD",3463,1,7,0)
MAGGTIA     new value = 47129366
"BLD",3463,1,8,0)
MAGGTU4C    new value = 5091959
"BLD",3463,1,9,0)
MAGGTU4D    new value = 5097764
"BLD",3463,1,10,0)
MAGGTU4L    new value = 5092040
"BLD",3463,1,11,0)
MAGGTU4T    new value = 5092112
"BLD",3463,1,12,0)
MAGIP106    new value = 7756257
"BLD",3463,1,13,0)
MAGNDCMC    new value = 11551246
"BLD",3463,1,14,0)
MAGNGMR     new value = 70338961
"BLD",3463,1,15,0)
MAGNTLR3    new value = 4232767
"BLD",3463,1,16,0)
MAGNUID1    new value = 17116046
"BLD",3463,1,17,0)
MAGNUID2    new value = 4027276
"BLD",3463,1,18,0)
MAGUXRF     new value = 31728772
"BLD",3463,1,19,0)
 
"BLD",3463,1,20,0)
Please note that routine MAGIP106 is deleted after the KIDS Build is
"BLD",3463,1,21,0)
installed.
"BLD",3463,4,0)
^9.64PA^2006.15^3
"BLD",3463,6.3)
V3.0p106Build2002_T13
"BLD",3463,4,2005.71,0)
2005.71
"BLD",3463,4,2005.71,222)
y^y^f^^y^^y^r^n
"BLD",3463,4,2005.99,0)
2005.99
"BLD",3463,4,2005.99,222)
y^y^f^^y^^y^o^n
"BLD",3463,4,2006.15,0)
2006.15
"BLD",3463,4,2006.15,222)
y^y^f^^^^n
"BLD",3463,4,"B",2005.71,2005.71)

"BLD",3463,4,"B",2005.99,2005.99)

"BLD",3463,4,"B",2006.15,2006.15)

"BLD",3463,"ABNS",0)
^9.66A^^
"BLD",3463,"ABPKG")
n^n^G.IMAGING DEVELOPMENT TEAM@DOMAIN.EXT
"BLD",3463,"INI")
PRE^MAGIP106
"BLD",3463,"INID")
y^y^y
"BLD",3463,"INIT")
POS^MAGIP106
"BLD",3463,"KRN",0)
^9.67PA^8994^19
"BLD",3463,"KRN",.4,0)
.4
"BLD",3463,"KRN",.4,"NM",0)
^9.68A^^
"BLD",3463,"KRN",.401,0)
.401
"BLD",3463,"KRN",.401,"NM",0)
^9.68A^^
"BLD",3463,"KRN",.402,0)
.402
"BLD",3463,"KRN",.402,"NM",0)
^9.68A^^
"BLD",3463,"KRN",.403,0)
.403
"BLD",3463,"KRN",.5,0)
.5
"BLD",3463,"KRN",.84,0)
.84
"BLD",3463,"KRN",.84,"NM",0)
^9.68A^^
"BLD",3463,"KRN",3.6,0)
3.6
"BLD",3463,"KRN",3.8,0)
3.8
"BLD",3463,"KRN",9.2,0)
9.2
"BLD",3463,"KRN",9.8,0)
9.8
"BLD",3463,"KRN",9.8,"NM",0)
^9.68A^13^13
"BLD",3463,"KRN",9.8,"NM",1,0)
MAGDHWC^^0^B48238555
"BLD",3463,"KRN",9.8,"NM",2,0)
MAGGSIA1^^0^B41835903
"BLD",3463,"KRN",9.8,"NM",3,0)
MAGGTIA^^0^B47129366
"BLD",3463,"KRN",9.8,"NM",4,0)
MAGGTU4C^^0^B5091959
"BLD",3463,"KRN",9.8,"NM",5,0)
MAGGTU4D^^0^B5097764
"BLD",3463,"KRN",9.8,"NM",6,0)
MAGGTU4L^^0^B5092040
"BLD",3463,"KRN",9.8,"NM",7,0)
MAGGTU4T^^0^B5092112
"BLD",3463,"KRN",9.8,"NM",8,0)
MAGNDCMC^^0^B11551246
"BLD",3463,"KRN",9.8,"NM",9,0)
MAGNGMR^^0^B70338961
"BLD",3463,"KRN",9.8,"NM",10,0)
MAGNTLR3^^0^B4232767
"BLD",3463,"KRN",9.8,"NM",11,0)
MAGNUID1^^0^B17116046
"BLD",3463,"KRN",9.8,"NM",12,0)
MAGNUID2^^0^B4027276
"BLD",3463,"KRN",9.8,"NM",13,0)
MAGUXRF^^0^B31728772
"BLD",3463,"KRN",9.8,"NM","B","MAGDHWC",1)

"BLD",3463,"KRN",9.8,"NM","B","MAGGSIA1",2)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTIA",3)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTU4C",4)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTU4D",5)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTU4L",6)

"BLD",3463,"KRN",9.8,"NM","B","MAGGTU4T",7)

"BLD",3463,"KRN",9.8,"NM","B","MAGNDCMC",8)

"BLD",3463,"KRN",9.8,"NM","B","MAGNGMR",9)

"BLD",3463,"KRN",9.8,"NM","B","MAGNTLR3",10)

"BLD",3463,"KRN",9.8,"NM","B","MAGNUID1",11)

"BLD",3463,"KRN",9.8,"NM","B","MAGNUID2",12)

"BLD",3463,"KRN",9.8,"NM","B","MAGUXRF",13)

"BLD",3463,"KRN",19,0)
19
"BLD",3463,"KRN",19,"NM",0)
^9.68A^^
"BLD",3463,"KRN",19.1,0)
19.1
"BLD",3463,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",3463,"KRN",19.1,"NM",1,0)
MAGCAP TRC^^0
"BLD",3463,"KRN",19.1,"NM","B","MAGCAP TRC",1)

"BLD",3463,"KRN",101,0)
101
"BLD",3463,"KRN",101,"NM",0)
^9.68A^^
"BLD",3463,"KRN",409.61,0)
409.61
"BLD",3463,"KRN",771,0)
771
"BLD",3463,"KRN",771,"NM",0)
^9.68A^^
"BLD",3463,"KRN",870,0)
870
"BLD",3463,"KRN",870,"NM",0)
^9.68A^^
"BLD",3463,"KRN",8989.51,0)
8989.51
"BLD",3463,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",3463,"KRN",8989.51,"NM",1,0)
MAG TR ALLOW THIN CLIENT^^0
"BLD",3463,"KRN",8989.51,"NM","B","MAG TR ALLOW THIN CLIENT",1)

"BLD",3463,"KRN",8989.52,0)
8989.52
"BLD",3463,"KRN",8994,0)
8994
"BLD",3463,"KRN",8994,"NM",0)
^9.68A^7^7
"BLD",3463,"KRN",8994,"NM",1,0)
MAG3 DICOM CAPTURE GE LIST^^0
"BLD",3463,"KRN",8994,"NM",2,0)
MAG3 DICOM CAPTURE SOP CLASS^^0
"BLD",3463,"KRN",8994,"NM",3,0)
MAG3 TELEREADER CONSULT LIST^^0
"BLD",3463,"KRN",8994,"NM",4,0)
MAG3 TELEREADER DICOM SER NUM^^0
"BLD",3463,"KRN",8994,"NM",5,0)
MAG3 TELEREADER DICOM UID^^0
"BLD",3463,"KRN",8994,"NM",6,0)
MAG3 TELEREADER READ/UNRD ADD^^0
"BLD",3463,"KRN",8994,"NM",7,0)
MAG3 TR THIN CLIENT ALLOWED^^0
"BLD",3463,"KRN",8994,"NM","B","MAG3 DICOM CAPTURE GE LIST",1)

"BLD",3463,"KRN",8994,"NM","B","MAG3 DICOM CAPTURE SOP CLASS",2)

"BLD",3463,"KRN",8994,"NM","B","MAG3 TELEREADER CONSULT LIST",3)

"BLD",3463,"KRN",8994,"NM","B","MAG3 TELEREADER DICOM SER NUM",4)

"BLD",3463,"KRN",8994,"NM","B","MAG3 TELEREADER DICOM UID",5)

"BLD",3463,"KRN",8994,"NM","B","MAG3 TELEREADER READ/UNRD ADD",6)

"BLD",3463,"KRN",8994,"NM","B","MAG3 TR THIN CLIENT ALLOWED",7)

"BLD",3463,"KRN","B",.4,.4)

"BLD",3463,"KRN","B",.401,.401)

"BLD",3463,"KRN","B",.402,.402)

"BLD",3463,"KRN","B",.403,.403)

"BLD",3463,"KRN","B",.5,.5)

"BLD",3463,"KRN","B",.84,.84)

"BLD",3463,"KRN","B",3.6,3.6)

"BLD",3463,"KRN","B",3.8,3.8)

"BLD",3463,"KRN","B",9.2,9.2)

"BLD",3463,"KRN","B",9.8,9.8)

"BLD",3463,"KRN","B",19,19)

"BLD",3463,"KRN","B",19.1,19.1)

"BLD",3463,"KRN","B",101,101)

"BLD",3463,"KRN","B",409.61,409.61)

"BLD",3463,"KRN","B",771,771)

"BLD",3463,"KRN","B",870,870)

"BLD",3463,"KRN","B",8989.51,8989.51)

"BLD",3463,"KRN","B",8989.52,8989.52)

"BLD",3463,"KRN","B",8994,8994)

"BLD",3463,"PRE")
MAGIP106
"BLD",3463,"REQB",0)
^9.611^3^3
"BLD",3463,"REQB",1,0)
MAG*3.0*114^2
"BLD",3463,"REQB",2,0)
MAG*3.0*54^2
"BLD",3463,"REQB",3,0)
MAG*3.0*94^2
"BLD",3463,"REQB","B","MAG*3.0*114",1)

"BLD",3463,"REQB","B","MAG*3.0*54",2)

"BLD",3463,"REQB","B","MAG*3.0*94",3)

"DATA",2005.71,1,0)
TELEDERM
"DATA",2005.71,1,"M",0)
^2005.712A^9^9
"DATA",2005.71,1,"M",1,0)
SOP COMMON
"DATA",2005.71,1,"M",1,"E",0)
^2005.713A^4^4
"DATA",2005.71,1,"M",1,"E",1,0)
0008,0012^Instance Creation Date^3^DA^Z
"DATA",2005.71,1,"M",1,"E",2,0)
0008,0013^Instance Creation Time^3^TM^Z
"DATA",2005.71,1,"M",1,"E",3,0)
0008,0016^SOP Class UID^1^UI^Z
"DATA",2005.71,1,"M",1,"E",4,0)
0008,0018^SOP Instance UID^1^UI^Z
"DATA",2005.71,1,"M",2,0)
PATIENT
"DATA",2005.71,1,"M",2,"E",0)
^2005.713A^5^5
"DATA",2005.71,1,"M",2,"E",1,0)
0010,0010^Patients Name^1^PN^Z
"DATA",2005.71,1,"M",2,"E",2,0)
0010,0020^Patient ID^1^LO^Z
"DATA",2005.71,1,"M",2,"E",3,0)
0010,0030^Patients Birth Date^1^DA^Z
"DATA",2005.71,1,"M",2,"E",4,0)
0010,0040^Patients Sex^1^CS^Z
"DATA",2005.71,1,"M",2,"E",5,0)
0010,1000^Other Patient IDs^1^LO^Z
"DATA",2005.71,1,"M",3,0)
GENERAL STUDY
"DATA",2005.71,1,"M",3,"E",0)
^2005.713A^7^7
"DATA",2005.71,1,"M",3,"E",1,0)
0008,0020^Study Date^2^DA^Z
"DATA",2005.71,1,"M",3,"E",2,0)
0008,0030^Study Time^2^TM^Z
"DATA",2005.71,1,"M",3,"E",3,0)
0008,0050^Accession Number^1^SH^Z
"DATA",2005.71,1,"M",3,"E",4,0)
0008,0090^Referring Physicians Name^1^PN^Z
"DATA",2005.71,1,"M",3,"E",5,0)
0008,1030^Study Description^3^LO^Z
"DATA",2005.71,1,"M",3,"E",6,0)
0020,000D^Study Instance UID^1^UI^Z
"DATA",2005.71,1,"M",3,"E",7,0)
0020,0010^Study ID^2^SH^Z
"DATA",2005.71,1,"M",4,0)
GENERAL SERIES
"DATA",2005.71,1,"M",4,"E",0)
^2005.713A^9^9
"DATA",2005.71,1,"M",4,"E",1,0)
0008,0021^Series Date^3^DA^Z
"DATA",2005.71,1,"M",4,"E",2,0)
0008,0031^Series Time^3^TM^Z
"DATA",2005.71,1,"M",4,"E",3,0)
0008,1070^Operators Name^3^PN^Z
"DATA",2005.71,1,"M",4,"E",4,0)
0018,0015^Body Part Examined^3^CS^C
"DATA",2005.71,1,"M",4,"E",5,0)
0020,000E^Series Instance UID^1^UI^Z
"DATA",2005.71,1,"M",4,"E",6,0)
0020,0011^Series Number^2^IS^Z
"DATA",2005.71,1,"M",4,"E",7,0)
0020,0013^Instance Number^2^IS^Z
"DATA",2005.71,1,"M",4,"E",8,0)
0020,0060^Laterality^2^CS^C
"DATA",2005.71,1,"M",4,"E",9,0)
0008,0060^Modality^1^CS^Z
"DATA",2005.71,1,"M",5,0)
GENERAL EQUIPMENT
"DATA",2005.71,1,"M",5,"E",0)
^2005.713A^5^5
"DATA",2005.71,1,"M",5,"E",1,0)
0008,0070^Manufacturer^1^LO^Z
"DATA",2005.71,1,"M",5,"E",2,0)
0008,0080^Institution Name^1^LO^Z
"DATA",2005.71,1,"M",5,"E",3,0)
0008,1010^Station Name^1^SH^Z
"DATA",2005.71,1,"M",5,"E",4,0)
0008,1090^Manufacturers Model Name^1^LO^Z
"DATA",2005.71,1,"M",5,"E",5,0)
0018,1020^Software Version(s)^1^LO^Z
"DATA",2005.71,1,"M",6,0)
GENERAL IMAGE
"DATA",2005.71,1,"M",6,"E",0)
^2005.713A^3^3
"DATA",2005.71,1,"M",6,"E",1,0)
0008,0022^Acquisition Date^1^DA^Z
"DATA",2005.71,1,"M",6,"E",2,0)
0008,0032^Acquisition Time^1^TM^Z
"DATA",2005.71,1,"M",6,"E",3,0)
0020,0020^Patient Orientation^2^CS^Z
"DATA",2005.71,1,"M",7,0)
ACQUISITION CONTEXT
"DATA",2005.71,1,"M",7,"E",0)
^2005.713A^2^2
"DATA",2005.71,1,"M",7,"E",1,0)
0040,0556^Acquisition Context Description^3^ST^Z
"DATA",2005.71,1,"M",7,"E",2,0)
0040,0555^Acquisition Context Sequence^2^SQ^Z
"DATA",2005.71,1,"M",8,0)
IMAGE PIXEL
"DATA",2005.71,1,"M",8,"E",0)
^2005.713A^5^5
"DATA",2005.71,1,"M",8,"E",1,0)
0028,0010^Rows^1^US^Z
"DATA",2005.71,1,"M",8,"E",2,0)
0028,0011^Columns^1^US^Z
"DATA",2005.71,1,"M",8,"E",3,0)
0028,0030^Pixel Spacing^1^DS^Z
"DATA",2005.71,1,"M",8,"E",4,0)
0028,0034^Pixel Aspect Ratio^1^IS^Z
"DATA",2005.71,1,"M",8,"E",5,0)
7FE0,0010^Pixel Data^1^OB^Z
"DATA",2005.71,1,"M",9,0)
VL IMAGE
"DATA",2005.71,1,"M",9,"E",0)
^2005.713A^9^9
"DATA",2005.71,1,"M",9,"E",1,0)
0008,0008^Image Type^1^CS^Z
"DATA",2005.71,1,"M",9,"E",2,0)
0028,0002^Samples per Pixel^1^US^Z
"DATA",2005.71,1,"M",9,"E",3,0)
0028,0004^Photometric Interpretation^1^CS^Z
"DATA",2005.71,1,"M",9,"E",4,0)
0028,0006^Planar Configuration^1^US^Z
"DATA",2005.71,1,"M",9,"E",5,0)
0028,0100^Bits Allocated^1^US^Z
"DATA",2005.71,1,"M",9,"E",6,0)
0028,0101^Bits Stored^1^US^Z
"DATA",2005.71,1,"M",9,"E",7,0)
0028,0102^High Bit^1^US^Z
"DATA",2005.71,1,"M",9,"E",8,0)
0028,0103^Pixel Representation^1^US^Z
"DATA",2005.71,1,"M",9,"E",9,0)
0028,2110^Lossy Image Compression^2^CS^Z
"DATA",2005.99,1,0)
ABDOMEN^ABDOMEN^113345001^T-D4000^ABDOMEN^ABDOMEN^C76.2^LP6990
"DATA",2005.99,2,0)
ADRENAL GLAND^GLANDS^23451007^T-B3000^ADRENAL^ADRENAL GLAND^C74.9^LP33443
"DATA",2005.99,3,0)
ANKLE^JOINTS^182212002^T-15750^ANKLE^Ankle joint ^^LP7008
"DATA",2005.99,4,0)
AORTA^CARDIOVASCULAR SYSTEM^15825003^T-42000^AORTA^Aorta ^^LP7009
"DATA",2005.99,5,0)
ARM^UPPER EXTREMITY^40983000^T-D8200^ARM^Arm 
"DATA",2005.99,6,0)
BACK^BACK^77568009^T-D2100^BACK^BACK^^LP7046
"DATA",2005.99,7,0)
BILIARY SYSTEM^GI (GASTRO INTESTINAL SYSTEM)^34707002^T-60610^^BILE DUCT^C24.9^LP33437
"DATA",2005.99,8,0)
BLOOD^BLOOD^87612001^^^^C42.0^LP7057
"DATA",2005.99,9,0)
BONE MARROW^BONES^14016003^^^^C42.1^LP33671
"DATA",2005.99,10,0)
BONES^BONES^128530007^^^^C41.9^LP34384
"DATA",2005.99,11,0)
STERNUM^BONES^^T-11210^STERNUM^STERNUM
"DATA",2005.99,12,0)
SESAMOID BONES^BONES^^T-12980^^SESAMOID BONES OF FOOT
"DATA",2005.99,13,0)
BONES FOREARM^BONES^^T-12402^^FOREARM BONE
"DATA",2005.99,14,0)
MASTOID BONE^BONES^^T-11133^^MASTOID BONE
"DATA",2005.99,15,0)
CALCANEOUS^BONES^182099002^T-12770^CALCANEUS^CALCANEUS^^LP29864
"DATA",2005.99,16,0)
CLAVICLE^BONES^181910004^T-12310^CLAVICLE^CLAVICLE^C41.3^LP29906
"DATA",2005.99,17,0)
COCCYX^BONES^64688005^T-11BF0^COCCYX^COCCYX^C41.4^LP29911
"DATA",2005.99,18,0)
BONES OF FACE^BONES^91397008^T-11196^^FACIAL BONES^C41.0^LP29966
"DATA",2005.99,19,0)
FEMUR^BONES^182046008^T-12710^FEMUR^FEMUR^C40.2^LP29971
"DATA",2005.99,20,0)
BONES OF FOOT^BONES^84167007^T-D9700^FOOT^FOOT^C40.3^LP7245
"DATA",2005.99,21,0)
BONES OF HAND^BONES^24097009^T-D8700^HAND^HAND^C40.1^LP7279
"DATA",2005.99,22,0)
HIP BONE^BONES^29836001^T-15710^ HIP^HIP JOINT^C41.4^LP7348
"DATA",2005.99,23,0)
HUMERUS^BONES^181923006^T-12410^HUMERUS^HUMERUS^C40.0^LP30054
"DATA",2005.99,24,0)
MANDIBLE^BONES^91609006^T-11180^JAW^MANDIBLE^C41.1^LP30118
"DATA",2005.99,25,0)
NASAL BONES^BONES^74386004^T-11149^^NASAL BONE^C41.0^LP30131
"DATA",2005.99,26,0)
ORBIT^BONES^363654007^T-D0801^ORBIT^ORBITAL REGION^C41.0^LP33450
"DATA",2005.99,27,0)
RIBS^BONES^24201007^T-11300^RIB^RIB^C41.3^LP30465
"DATA",2005.99,28,0)
SACRUM^BONES^54735007^T-11AD0^SSPINE^SACRUM^C41.4^LP30257
"DATA",2005.99,29,0)
SKULL^BONES^31467002^T-11100^SKULL^Skull ^C41.0^LP30281
"DATA",2005.99,30,0)
TIBIA AND FIBULA^BONES^110536004^^^^C40.2^LP30335
"DATA",2005.99,31,0)
VERTEBREA^BONES^181817002^^^^C41.2^LP7569
"DATA",2005.99,32,0)
BONES WHOLE BODY^BONES^128530007^^^^C41.9^LP34384
"DATA",2005.99,33,0)
BRAIN^NERVOUS SYSTEM^12738006^T-A0100^BRAIN^BRAIN^C71.9^LP7084
"DATA",2005.99,34,0)
BRAIN STEM^NERVOUS SYSTEM^15926001^T-A6000^CEREBELLUM^CEREBELLUM^C71.7^LP33676
"DATA",2005.99,35,0)
BREAST^BREAST^15926001^T-04000^BREAST^BREAST^C50.9^LP7086
"DATA",2005.99,36,0)
BREAST LIQ^BREAST^^T-04003^BREAST^LOWER INNER QUADRANT OF BREAST
"DATA",2005.99,37,0)
BREAST LOQ^BREAST^^T-04005^BREAST^LOWER OUTER QUADRANT OF BREAST
"DATA",2005.99,38,0)
BREAST UIQ^BREAST^^T-04002^BREAST^UPPER INNER QUADRANT OF BREAST
"DATA",2005.99,39,0)
BREAST UOQ^BREAST^^T-04004^BREAST^UPPER OUTER QUADRANT OF BREAST
"DATA",2005.99,40,0)
CARDIOVASCULAR ^CARDIOVASCULAR SYSTEM^113257007
"DATA",2005.99,41,0)
CERVIX^GENITAL SYSTEM^71252005^T-83200^CERVIX^CERVIX^C53.9
"DATA",2005.99,42,0)
CHEST^CHEST^51185008^T-D3000^CHEST^CHEST^C76.1^LP7138
"DATA",2005.99,43,0)
CNS^NERVOUS SYSTEM^21483005^^^^C72.9^LP7441
"DATA",2005.99,44,0)
EAR^HEAD^1910005^T-AB000^EAR^EAR^^LP7188
"DATA",2005.99,45,0)
E AUDITORY CANAL^HEAD^^T-AB200^^EXTERNAL AUDITORY CANAL
"DATA",2005.99,46,0)
I AUDITORY CANAL^HEAD^^T-AB959^IAC^INTERNAL AUDITORY CANAL
"DATA",2005.99,47,0)
ELBOW^UPPER EXTREMITY^76248009^T-D8300^ELBOW^ELBOW^^LP7196
"DATA",2005.99,48,0)
ENT^HEAD^394604002^^^^^LP35159
"DATA",2005.99,49,0)
EYE^HEAD^81745001^T-AA000^EYE^EYE^C69.9^LP7218
"DATA",2005.99,50,0)
CORNEA^HEAD^^T-AA200^CORNEA^CORNEA
"DATA",2005.99,51,0)
SCLERA^HEAD^^T-AA110^SCLERA^SCLERA
"DATA",2005.99,52,0)
EYELID^HEAD^80243003^T-AA810^EYELID^EYELID^^LP30515
"DATA",2005.99,53,0)
FACE^HEAD^80243003^T-D1200^FACE^FACE^C76.0^LP7223
"DATA",2005.99,54,0)
FINGER^UPPER EXTREMITY^7569003^T-D8800^FINGER^FINGER^^LP29978
"DATA",2005.99,55,0)
FOOT^LOWER EXTREMITY^302545001^T-D9700^FOOT^FOOT^^LP7245
"DATA",2005.99,56,0)
FOREARM^UPPER EXTREMITY^14975008^^^^^LP7249
"DATA",2005.99,57,0)
GALL BLADDER^GI (GASTRO INTESTINAL SYSTEM)^28231008^T-63000^GALLBLADDER^GALL BLADDER^C23.9^LP29995
"DATA",2005.99,58,0)
UTERUS AND TUBES^GENITAL SYSTEM^71934003^T-88920^^UTERUS AND FALLOPIAN TUBES^C57.9^LP7261
"DATA",2005.99,59,0)
VAGINA^GENITAL SYSTEM^^T-82000^VAGINA^VAGINA
"DATA",2005.99,60,0)
VULVA^GENITAL SYSTEM^^T-81000^VULVA^VULVA
"DATA",2005.99,61,0)
GI SYSTEM^GI (GASTRO INTESTINAL SYSTEM)^122865005^^^^C26.9^LP7256
"DATA",2005.99,62,0)
ANAL CANAL^GI (GASTRO INTESTINAL SYSTEM)^34381000^^^^C21.1^LP29783
"DATA",2005.99,63,0)
COLON^GI (GASTRO INTESTINAL SYSTEM)^71854001^T-59300^COLON^COLON^C18.9^LP7151
"DATA",2005.99,64,0)
DUODENUM^GI (GASTRO INTESTINAL SYSTEM)^38848004^T-58200^DUODENUM^DUODENUM^C17.0^LP29931
"DATA",2005.99,65,0)
ESOPHAGUS^GI (GASTRO INTESTINAL SYSTEM)^32849002^T-56000^ESOPHAGUS^ESOPHAGUS^C15.9^LP29941
"DATA",2005.99,66,0)
LARGE INTESTINE^GI (GASTRO INTESTINAL SYSTEM)^14742008^T-59000^^LARGE INTESTINE
"DATA",2005.99,67,0)
LOWER GI^GI (GASTRO INTESTINAL SYSTEM)^279973004^^^^^LP7406
"DATA",2005.99,68,0)
RECTUM^GI (GASTRO INTESTINAL SYSTEM)^34402009^T-59600^RECTUM^RECTUM^C20.9^LP7540
"DATA",2005.99,69,0)
ILLIUM^GI (GASTRO INTESTINAL SYSTEM)^30315005^T-12340^ILIUM^ILIUM^C17.9^LP7588
"DATA",2005.99,70,0)
SMALL INTESTINE^GI (GASTRO INTESTINAL SYSTEM)^30315005^T-58000^^SMALL INTESTINE
"DATA",2005.99,71,0)
STOMACH^GI (GASTRO INTESTINAL SYSTEM)^69695003^T-57000^STOMACH^STOMACH^C16.9^LP7605
"DATA",2005.99,72,0)
STOMACH DUODENUM^GI (GASTRO INTESTINAL SYSTEM)^110775005^T-58200^^DUODENUM
"DATA",2005.99,73,0)
UPPER GI^GI (GASTRO INTESTINAL SYSTEM)^30315005^T-58400^JEJUNUM^JEJUNUM^^LP29997
"DATA",2005.99,74,0)
GROIN^SOFT TISSUE^26893007^T-D7000^^INGUINAL REGION^^LP7278
"DATA",2005.99,75,0)
HAND^UPPER EXTREMITY^85562004^T-D8700^HAND^HAND^^LP7279
"DATA",2005.99,76,0)
HEAD^HEAD^69536005^T-D1100^HEAD^HEAD^C76.0^LP7281
"DATA",2005.99,77,0)
HEART^CARDIOVASCULAR SYSTEM^80891009^T-32000^HEART^HEART^C38.0^LP7289
"DATA",2005.99,78,0)
ATRIUM^CARDIOVASCULAR SYSTEM^^T-32100^^ATRIUM
"DATA",2005.99,79,0)
VENTRICLE^CARDIOVASCULAR SYSTEM^^T-32400^^VENTRICLE
"DATA",2005.99,80,0)
ENDO CARDIUM^CARDIOVASCULAR SYSTEM^^T-32000^^ENDO-CARDIAC
"DATA",2005.99,81,0)
APEX LT VENTRIC^CARDIOVASCULAR SYSTEM^^T-32602^^APEX OF LEFT VENTRICLE
"DATA",2005.99,82,0)
CORONARY SINUS^CARDIOVASCULAR SYSTEM^361097006^T-48410^^CORONARY SINUS^^LP7700
"DATA",2005.99,83,0)
COMMON ATRIUM^CARDIOVASCULAR SYSTEM^^D4-31320^^COMMON ATRIUM
"DATA",2005.99,84,0)
COMMON VENTRICLE^CARDIOVASCULAR SYSTEM^361097006^D4-31120^^COMMON VENTRICLE^^LP7700
"DATA",2005.99,85,0)
LT ATRIUM^CARDIOVASCULAR SYSTEM^^T-32300^^LEFT ATRIUM
"DATA",2005.99,86,0)
LEFT VENTRICLE^CARDIOVASCULAR SYSTEM^^T-32600^^LEFT VENTRICLE
"DATA",2005.99,87,0)
VENTRIC INFLOW^CARDIOVASCULAR SYSTEM^^T-32640^^LEFT VENTRICLE INFLOW
"DATA",2005.99,88,0)
VENTRIC OUTFLOW^CARDIOVASCULAR SYSTEM^^D4-31022^^LEFT VENTRICLE OUTFLOW CHAMBER
"DATA",2005.99,90,0)
RT ATRIUM^CARDIOVASCULAR SYSTEM^^T-32200^^RIGHT ATRIUM
"DATA",2005.99,91,0)
RT AURICULAR APP^CARDIOVASCULAR SYSTEM^^T-32210^^RIGHT AURICULAR APPENDAGE
"DATA",2005.99,92,0)
RT VENTRICLE^CARDIOVASCULAR SYSTEM^^T-32500^^RIGHT VENTRICLE
"DATA",2005.99,95,0)
JOINT^JOINTS^39352004^T-15001^^JOINT^^LP30640
"DATA",2005.99,96,0)
ACROMIOCLAV J^JOINTS^^T-15420^^ACROMIOCLAVICULAR JOINT
"DATA",2005.99,97,0)
SACROILIAC JOINT^JOINTS^^T-15680^^SACROILIAC JOINT
"DATA",2005.99,98,0)
STERNOCLAV J^JOINTS^^T-15610^^STERNOCLAVICULAR JOINT
"DATA",2005.99,99,0)
TARSAL JOINT^JOINTS^^T-15770^^TARSAL JOINT
"DATA",2005.99,100,0)
TEMP MANDIB J^JOINTS^^T-15290^TMJ^TEMPOROMANDIBULAR JOINT
"DATA",2005.99,102,0)
ELBOW JOINT^JOINTS^182169008^T-D8300^ELBOW^ELBOW^^LP7196
"DATA",2005.99,103,0)
HIP JOINT^JOINTS^24136001^T-15710^ HIP^HIP JOINT^^LP7348
"DATA",2005.99,104,0)
KNEE JOINT^JOINTS^182204005^T-D9200^KNEE^KNEE^^LP7381
"DATA",2005.99,105,0)
SHOULDER^JOINTS^31398001^T-D2220^SHOULDER^SHOULDER^^LP29768
"DATA",2005.99,106,0)
WRIST JOINT^JOINTS^74670003^T-15460^WRIST^WRIST JOINT^^LP7733
"DATA",2005.99,107,0)
KIDNEY^URINARY SYSTEM^64033007^T-71000^KIDNEY^KIDNEY^C64.9^LP7380
"DATA",2005.99,108,0)
LARYNX^RESPIRATORY SYSTEM^4596009^T-24100^LARYNX^LARYNX^C32.9^LP30526
"DATA",2005.99,109,0)
VOCAL CORDS^RESPIRATORY SYSTEM^46105003
"DATA",2005.99,110,0)
LEGS^LOWER EXTREMITY^30021000^T-D9400^LEG^LEG^^LP30098
"DATA",2005.99,111,0)
LIP^HEAD^48477009^^^^C00.9^LP30527
"DATA",2005.99,112,0)
LIVER^LIVER AND SPLEEN^181268008^T-62000^LIVER^LIVER^C22.0^LP7400
"DATA",2005.99,113,0)
LIVER AND SPLEEN^LIVER AND SPLEEN^110810000^^^^^LP30103
"DATA",2005.99,114,0)
LOWER EXTREMITY^LOWER EXTREMITY^61685007^^^^C76.5^LP29948
"DATA",2005.99,115,0)
LUNG^RESPIRATORY SYSTEM^39607008^T-28000^LUNG^LUNG^C34.9^LP7407
"DATA",2005.99,116,0)
LUNG APEX^RESPIRATORY SYSTEM^^T-280A0^^APEX OF LUNG
"DATA",2005.99,117,0)
LYMPH NODES^LYMPH NODES^59441001^^^^C77.9^LP30457
"DATA",2005.99,118,0)
MOUTH^HEAD^181220002^T-51000^MOUTH^MOUTH^C06.9^LP7433
"DATA",2005.99,119,0)
NECK^NECK^45048000^T-D1600^NECK^NECK^C76.0^LP7440
"DATA",2005.99,120,0)
NERVOUS SYSTEM^NERVOUS SYSTEM^278196006^^^^C72.9^LP7441
"DATA",2005.99,121,0)
OVARY^GENITAL SYSTEM^181464007^T-87000^OVARY^OVARY^C56.9^LP30461
"DATA",2005.99,122,0)
PANCREAS^GI (GASTRO INTESTINAL SYSTEM)^181277001^T-65000^PANCREAS^PANCREAS^C25.9^LP30158
"DATA",2005.99,123,0)
PELVIS^PELVIS^229765004^T-D6000^PELVIS^PELVIS^C76.3^LP7467
"DATA",2005.99,124,0)
PHARYNX^RESPIRATORY SYSTEM^54066008^T-55002^PHARYNX^PHARYNX^C14.0^LP30540
"DATA",2005.99,125,0)
PROSTATE^GENITAL SYSTEM^41216001^T-9200B^PROSTATE^PROSTATE^C61.9^LP7501
"DATA",2005.99,126,0)
LIMB PROSTHESIS^PROSTHESIS^74444006
"DATA",2005.99,127,0)
RESPIRATORY SYS^RESPIRATORY SYSTEM^272626006^^^^C39.9^LP7556
"DATA",2005.99,128,0)
SALIVARY GLAND^HEAD^181236000^^^^C08.9^LP30466
"DATA",2005.99,129,0)
SKIN OF SCALP^SKIN^41695006^T-D1160^SCALP^SCALP^^LP30549
"DATA",2005.99,130,0)
SCROTUM^GENITAL SYSTEM^265794003^T-98000^SCROTUM^SCROTUM^C63.2^LP34879
"DATA",2005.99,131,0)
SERUM^BLOOD^67922002^^^^^LP7567
"DATA",2005.99,133,0)
SINUSES^HEAD^181203001^T-22000^^PARANASAL SINUS^C31.9^LP30277
"DATA",2005.99,134,0)
SKIN^SKIN^39937001^^^^C44.9^LP36760
"DATA",2005.99,135,0)
SKIN OF ABDOMEN^SKIN^75093004^^^^C44.5
"DATA",2005.99,136,0)
SKIN OF ARM^SKIN^371309009^^^^C44.6
"DATA",2005.99,137,0)
SKIN OF AXILLA^SKIN^76261009
"DATA",2005.99,138,0)
SKIN OF BACK^SKIN^66643007
"DATA",2005.99,139,0)
SKIN OF BUTTOCK^SKIN^22180002
"DATA",2005.99,140,0)
SKIN OF CHEEK^SKIN^36141000^^^^C44.3
"DATA",2005.99,141,0)
SKIN OF CHEST^SKIN^74160004^^^^C44.5
"DATA",2005.99,142,0)
SKIN OF EAR^SKIN^1902009^^^^C44.2
"DATA",2005.99,143,0)
SKIN OF FACE^SKIN^73897004^^^^C44.3
"DATA",2005.99,144,0)
SKIN OF FINGER^SKIN^56213003^^^^C44.6
"DATA",2005.99,145,0)
SKIN OF FOOT^SKIN^60496002^^^^C44.7
"DATA",2005.99,146,0)
SKIN OF FOREARM^SKIN^5742000^^^^C44.6
"DATA",2005.99,147,0)
SKIN OF FOREHEAD^SKIN^68698007^^^^C44.3
"DATA",2005.99,148,0)
SKIN OF HAND^SKIN^33712006^^^^C44.6
"DATA",2005.99,149,0)
SKIN OF HEAD^SKIN^70762009
"DATA",2005.99,150,0)
SKIN OF LEG^SKIN^75144006^^^^C44.7
"DATA",2005.99,151,0)
SKIN OF NECK^SKIN^281719008^^^^C44.4
"DATA",2005.99,152,0)
SKIN OF NOSE^SKIN^244085000^^^^C44.3
"DATA",2005.99,153,0)
SKIN OF THIGH^SKIN^371305003^^^^C44.7
"DATA",2005.99,154,0)
SKIN OF TOE^SKIN^52034004^^^^C44.7
"DATA",2005.99,155,0)
MUSCLES^SOFT TISSUE^71616004^^^^^LP33444
"DATA",2005.99,156,0)
SOFT TISSUE NECK^SOFT TISSUE^127961008^^^^C49.0
"DATA",2005.99,157,0)
SOFT TISSUES^SOFT TISSUE^87784001^^^^C49.9^LP30469
"DATA",2005.99,158,0)
SPINAL CORD^SPINE^2748008^T-A7010^^SPINAL CORD^C72.0^LP7569
"DATA",2005.99,159,0)
CERVICAL SPINE^SPINE^122494005^T-11501^CSPINE^CERVICAL SPINE^^LP30301
"DATA",2005.99,160,0)
LUMBER SPINE^SPINE^243932004^T-11503^LSPINE^LUMBAR SPINE^^LP30305
"DATA",2005.99,161,0)
SPINE SAC COCC^SPINE^54735007^^^^^LP33805
"DATA",2005.99,162,0)
THORACIC SPINE^SPINE^243931006^T-11502^TSPINE^THORACIC SPINE^^LP30308
"DATA",2005.99,163,0)
THORACOLUMB SPIN^SPINE^304574006^T-D00F8^TLSPINE^THORACO-LUMBAR SPINE^^LP30309
"DATA",2005.99,164,0)
LUMBOSACRAL SPIN^SPINE^65098007^T-D00F9^LSSPINE^LUMBO-SACRAL SPINE^^LP34011
"DATA",2005.99,165,0)
SPLEEN^LIVER AND SPLEEN^78961009^T-C3000^SPLEEN^SPLEEN^C42.2^LP30311
"DATA",2005.99,166,0)
TEETH^TEETH^245543004^^^^^LP40376
"DATA",2005.99,167,0)
TESTIS^GENITAL SYSTEM^40689003^T-94000^TESTIS^TESTIS^C62.9^LP30322
"DATA",2005.99,168,0)
THIGH^LOWER EXTREMITY^68367000^T-D9100^THIGH^THIGH^^LP7625
"DATA",2005.99,169,0)
THORAX^CHEST^51185008^T-D3000^^THORAX^C76.1^LP7630
"DATA",2005.99,170,0)
THUMB^UPPER EXTREMITY^76505004^T-D8810^THUMB^THUMB^^LP30331
"DATA",2005.99,171,0)
THYROID^NECK^69748006^T-B6000^THYROID^THYROID^C73.9^LP7636
"DATA",2005.99,172,0)
TOE^LOWER EXTREMITY^29707007^T-D9800^TOE^TOE^^LP33452
"DATA",2005.99,173,0)
TONGUE^HEAD^21974007^T-53000^TONGUE^TONGUE^C02.9^LP30556
"DATA",2005.99,174,0)
UPPER EXTREMITY^UPPER EXTREMITY^53120007^^^^C76.4^LP29957
"DATA",2005.99,175,0)
URETER^URINARY SYSTEM^87953007^T-73800^URETER^URETER^C66.9
"DATA",2005.99,176,0)
URINARY BLADDER^URINARY SYSTEM^89837001^T-74000^BLADDER^BLADDER^C67.9^LP7684
"DATA",2005.99,177,0)
URINARY SYSTEM^URINARY SYSTEM^122489005^^^^C68.9^LP7687
"DATA",2005.99,178,0)
UTERUS^GENITAL SYSTEM^35039007^T-83000^UTERUS^UTERUS^C55.9^LP7699
"DATA",2005.99,179,0)
ENDOMETRIUM^GENITAL SYSTEM^2739003^^^^C54.1^LP7204
"DATA",2005.99,180,0)
VEINS ARTERIES^CARDIOVASCULAR SYSTEM^361097006^^^^^LP7700
"DATA",2005.99,181,0)
ANTECUBITAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49215^^ANTECUBITAL VEIN^^LP7700
"DATA",2005.99,182,0)
ANT CARDIAC V^CARDIOVASCULAR SYSTEM^361097006^T-48440^^ANTERIOR CARDIAC VEIN^^LP7700
"DATA",2005.99,183,0)
ANT COMMUNI ART^CARDIOVASCULAR SYSTEM^361097006^T-45530^^ANTERIOR COMMUNICATING ARTERY^^LP7700
"DATA",2005.99,184,0)
ANT SPINAL ART^CARDIOVASCULAR SYSTEM^361097006^T-45730^^ANTERIOR SPINAL ARTERY^^LP7700
"DATA",2005.99,185,0)
ANT TIBIAL ART^CARDIOVASCULAR SYSTEM^361097006^T-47700^^ANTERIOR TIBIAL ARTERY^^LP7700
"DATA",2005.99,186,0)
ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46100^^SUBCLAVIAN ARTERY^^LP7700
"DATA",2005.99,187,0)
AXILLARY VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49110^^AXILLARY VEIN^^LP7700
"DATA",2005.99,188,0)
AZYGOS VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48340^^AZYGOS VEIN^^LP7700
"DATA",2005.99,189,0)
BASILAR ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45800^^BASILAR ARTERY^^LP7700
"DATA",2005.99,190,0)
BRACHIAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47160^^BRACHIAL ARTERY^^LP7700
"DATA",2005.99,191,0)
BRACHIAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49350^^BRACHIAL VEIN^^LP7700
"DATA",2005.99,192,0)
CAROTID ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45010^CAROTID^CAROTID ARTERY^^LP7700
"DATA",2005.99,193,0)
CEPHALIC VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49240^^CEPHALIC VEIN^^LP7700
"DATA",2005.99,194,0)
CEREBRAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45510^^CEREBRAL ARTERY^^LP7700
"DATA",2005.99,195,0)
CIRCLE OF WILLIS^CARDIOVASCULAR SYSTEM^361097006^T-45526^CIRCLEOFWILLIS^CIRCLE OF WILLIS^^LP7700
"DATA",2005.99,196,0)
COMMON CAROTID A^CARDIOVASCULAR SYSTEM^361097006^T-45100^^COMMON CAROTID ARTERY^^LP7700
"DATA",2005.99,197,0)
COMM ILIAC A^CARDIOVASCULAR SYSTEM^361097006^T-46710^^COMMON ILIAC ARTERY^^LP7700
"DATA",2005.99,198,0)
COM ILIAC V^CARDIOVASCULAR SYSTEM^361097006^T-48920^^COMMON ILIAC VEIN^^LP7700
"DATA",2005.99,200,0)
CORONARY ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-43000^CORONARYARTERY^CORONARY ARTERY^^LP7700
"DATA",2005.99,202,0)
CRANIAL VENOUS S^CARDIOVASCULAR SYSTEM^361097006^T-A0193^^CRANIAL VENOUS SYSTEM^^LP7700
"DATA",2005.99,203,0)
ENDO ARTERIAL^CARDIOVASCULAR SYSTEM^361097006^T-41000^^ENDO-ARTERIAL^^LP7700
"DATA",2005.99,204,0)
E CAROTID A^CARDIOVASCULAR SYSTEM^361097006^T-45200^^EXTERNAL CAROTID ARTERY^^LP7700
"DATA",2005.99,205,0)
EXTERNAL ILIAC A^CARDIOVASCULAR SYSTEM^361097006^T-46910^^EXTERNAL ILIAC ARTERY^^LP7700
"DATA",2005.99,206,0)
EXT ILIAC V^CARDIOVASCULAR SYSTEM^361097006^T-48930^^EXTERNAL ILIAC VEIN^^LP7700
"DATA",2005.99,207,0)
FACIAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45240^^FACIAL ARTERY^^LP7700
"DATA",2005.99,208,0)
FEMORAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47400^^FEMORAL ARTERY^^LP7700
"DATA",2005.99,209,0)
FEMORAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49410^^FEMORAL VEIN^^LP7700
"DATA",2005.99,210,0)
GASTRIC VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48820^^GASTRIC VEIN^^LP7700
"DATA",2005.99,211,0)
GENICULAR A^CARDIOVASCULAR SYSTEM^361097006^T-47490^^GENICULAR ARTERY^^LP7700
"DATA",2005.99,212,0)
GLUTEAL REGION^CARDIOVASCULAR SYSTEM^361097006^T-D2600^^GLUTEAL REGION^^LP7700
"DATA",2005.99,213,0)
GREAT CARDIAC V^CARDIOVASCULAR SYSTEM^361097006^T-48420^^GREAT CARDIAC VEIN^^LP7700
"DATA",2005.99,214,0)
HEPATIC ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46420^^HEPATIC ARTERY^^LP7700
"DATA",2005.99,215,0)
HEPATIC VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48720^^HEPATIC VEIN^^LP7700
"DATA",2005.99,216,0)
HUNT PERFORAT V^CARDIOVASCULAR SYSTEM^361097006^T-4942A^^HUNTERIAN PERFORATING VEIN^^LP7700
"DATA",2005.99,217,0)
ILIAC ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46700^^ILIAC ARTERY^^LP7700
"DATA",2005.99,218,0)
INF CARDIAC V^CARDIOVASCULAR SYSTEM^361097006^T-48470^^INFERIOR CARDIAC VEIN^^LP7700
"DATA",2005.99,219,0)
LT PULMONARY V^CARDIOVASCULAR SYSTEM^361097006^T-48540^^INFERIOR LEFT PULMONARY VEIN^^LP7700
"DATA",2005.99,220,0)
INF MESENTERIC A^CARDIOVASCULAR SYSTEM^361097006^T-46520^^INFERIOR MESENTERIC ARTERY^^LP7700
"DATA",2005.99,221,0)
INF RT PULMON V^CARDIOVASCULAR SYSTEM^361097006^T-48520^^INFERIOR RIGHT PULMONARY VEIN^^LP7700
"DATA",2005.99,222,0)
INFERIOR ^CARDIOVASCULAR SYSTEM^361097006^T-48710^^INFERIOR VENA CAVA^^LP7700
"DATA",2005.99,224,0)
INNOMINATE V^CARDIOVASCULAR SYSTEM^361097006^T-48620^^INNOMINATE VEIN^^LP7700
"DATA",2005.99,225,0)
I CAROTID A^CARDIOVASCULAR SYSTEM^361097006^T-45300^^INTERNAL CAROTID ARTERY^^LP7700
"DATA",2005.99,226,0)
I ILIAC A^CARDIOVASCULAR SYSTEM^361097006^T-46740^^INTERNAL ILIAC ARTEY^^LP7700
"DATA",2005.99,227,0)
I JUGULAR V^CARDIOVASCULAR SYSTEM^361097006^T-48170^^INTERNAL JUGULAR VEIN^^LP7700
"DATA",2005.99,228,0)
INT MAMMARY A^CARDIOVASCULAR SYSTEM^361097006^T-46200^^INTERNAL MAMMARY ARTERY^^LP7700
"DATA",2005.99,229,0)
LACRIMAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45410^^LACRIMAL ARTERY^^LP7700
"DATA",2005.99,231,0)
LEFT ^CARDIOVASCULAR SYSTEM^361097006^T-47420^^LEFT FEMORAL ARTERY^^LP7700
"DATA",2005.99,232,0)
LT PULMONARY A^CARDIOVASCULAR SYSTEM^361097006^T-44400^^LEFT PULMONARY ARTERY^^LP7700
"DATA",2005.99,233,0)
LINGUAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45230^^LINGUAL ARTERY^^LP7700
"DATA",2005.99,234,0)
LUMBAR ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46960^^LUMBAR ARTERY^^LP7700
"DATA",2005.99,235,0)
MESENTERIC A^CARDIOVASCULAR SYSTEM^361097006^T-46500^^MESENTERIC ARTERY^^LP7700
"DATA",2005.99,236,0)
MESENTERIC VEIN^CARDIOVASCULAR SYSTEM^361097006^T-4884A^^MESENTERIC VEIN^^LP7700
"DATA",2005.99,237,0)
OCCIPITAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-45250^^OCCIPITAL ARTERY^^LP7700
"DATA",2005.99,238,0)
OCCIPITAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48214^^OCCIPITAL VEIN^^LP7700
"DATA",2005.99,239,0)
OPHTHALMIC A^CARDIOVASCULAR SYSTEM^361097006^T-45400^^OPHTHALMIC ARTERY^^LP7700
"DATA",2005.99,240,0)
PERONEAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47630^^PERONEAL ARTERY^^LP7700
"DATA",2005.99,241,0)
POPLITEAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47500^^POPLITEAL ARTERY^^LP7700
"DATA",2005.99,242,0)
PORTAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48810^^PORTAL VEIN^^LP7700
"DATA",2005.99,243,0)
P COOMUNICAT A^CARDIOVASCULAR SYSTEM^361097006^T-45320^^POSTERIOR COMMUNICATION ARTERY^^LP7700
"DATA",2005.99,244,0)
P MED TRIBUTARY^CARDIOVASCULAR SYSTEM^361097006^T-49535^^POSTERIOR MEDIAL TRIBUTARY^^LP7700
"DATA",2005.99,245,0)
P TIBIAL A^CARDIOVASCULAR SYSTEM^361097006^T-47600^^POSTERIOR TIBIAL ARTERY^^LP7700
"DATA",2005.99,246,0)
PRIMITIVE AORTA^CARDIOVASCULAR SYSTEM^361097006^T-F7001^^PRIMITIVE AORTA^^LP7700
"DATA",2005.99,247,0)
PRIMIT PULMON A^CARDIOVASCULAR SYSTEM^361097006^T-F7040^^PRIMITIVE PULMONARY ARTERY^^LP7700
"DATA",2005.99,248,0)
PULMONARY ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-44000^^PULMONARY ARTERY^^LP7700
"DATA",2005.99,250,0)
PULMONARY VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48500^^PULMONARY VEIN^^LP7700
"DATA",2005.99,252,0)
RADIAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47300^^RADIAL ARTERY^^LP7700
"DATA",2005.99,253,0)
RENAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46600^^RENAL ARTERY^^LP7700
"DATA",2005.99,254,0)
RENAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48740^^RENAL VEIN^^LP7700
"DATA",2005.99,255,0)
RT FEMORAL A^CARDIOVASCULAR SYSTEM^361097006^T-47410^^RIGHT FEMORAL ARTERY^^LP7700
"DATA",2005.99,256,0)
RT PULMON A^CARDIOVASCULAR SYSTEM^361097006^T-44200^^RIGHT PULMONARY ARTERY^^LP7700
"DATA",2005.99,257,0)
SAPHENOUS VEIN^CARDIOVASCULAR SYSTEM^361097006^T-49530^^SAPHENOUS VEIN^^LP7700
"DATA",2005.99,258,0)
SPLENIC ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-46460^^SPLENIC ARTERY^^LP7700
"DATA",2005.99,259,0)
SPLENIC VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48890^^SPLENIC VEIN^^LP7700
"DATA",2005.99,261,0)
SUBCLAVIAN V^CARDIOVASCULAR SYSTEM^361097006^T-48330^^SUBCLAVIAN VEIN^^LP7700
"DATA",2005.99,262,0)
SUP TEMPORAL A^CARDIOVASCULAR SYSTEM^361097006^T-45270^^SUPERFICIAL TEMPORAL ARTERY^^LP7700
"DATA",2005.99,264,0)
SUP MESENTERIC A^CARDIOVASCULAR SYSTEM^361097006^T-46510^^SUPERIOR MESENTERIC ARTERY^^LP7700
"DATA",2005.99,265,0)
SUP PULMONARY V^CARDIOVASCULAR SYSTEM^361097006^T-48510^^SUPERIOR RIGHT PULMONARY VEIN^^LP7700
"DATA",2005.99,266,0)
SUP THYROID A^CARDIOVASCULAR SYSTEM^361097006^T-45210^^SUPERIOR THYROID ARTERY^^LP7700
"DATA",2005.99,267,0)
SUP VENA CAVA^CARDIOVASCULAR SYSTEM^361097006^T-48610^^SUPERIOR VENA CAVA^^LP7700
"DATA",2005.99,268,0)
SYS VEN ATRIUM^CARDIOVASCULAR SYSTEM^361097006^D4-33516^^SYSTEMIC VENOUS ATRIUM^^LP7700
"DATA",2005.99,269,0)
THORACIC AORTA^CARDIOVASCULAR SYSTEM^361097006^T-42070^^THORACIC AORTA^^LP7700
"DATA",2005.99,270,0)
ULNAR ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-47200^^ULNAR ARTERY^^LP7700
"DATA",2005.99,271,0)
UMBILICAL ARTERY^CARDIOVASCULAR SYSTEM^361097006^T-F1810^^UMBILICAL ARTERY^^LP7700
"DATA",2005.99,272,0)
UMBILICAL VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48817^^UMBILICAL VEIN^^LP7700
"DATA",2005.99,273,0)
VEIN^CARDIOVASCULAR SYSTEM^361097006^T-48000^^VEIN^^LP7700
"DATA",2005.99,274,0)
VERTEBRAL A^CARDIOVASCULAR SYSTEM^361097006^T-45700^^VERTEBRAL ARTERY^^LP7700
"DATA",2005.99,275,0)
WHOLE BODY^WHOLE BODY^38266002^T-D0010^WHOLEBODY^ENTIRE BODY
"DATA",2005.99,276,0)
WRIST^UPPER EXTREMITY^8205005^T-15460^WRIST^WRIST JOINT^^LP7733
"FIA",2005.71)
IMAGING DICOM FIELDS
"FIA",2005.71,0)
^MAG(2005.71,
"FIA",2005.71,0,0)
2005.71
"FIA",2005.71,0,1)
y^y^f^^y^^y^r^n
"FIA",2005.71,0,10)

"FIA",2005.71,0,11)

"FIA",2005.71,0,"RLRO")

"FIA",2005.71,0,"VR")
3.0^MAG
"FIA",2005.71,2005.71)
0
"FIA",2005.71,2005.712)
0
"FIA",2005.71,2005.713)
0
"FIA",2005.99)
IMAGE INDEX FOR BODY PART
"FIA",2005.99,0)
^MAG(2005.99,
"FIA",2005.99,0,0)
2005.99
"FIA",2005.99,0,1)
y^y^f^^y^^y^o^n
"FIA",2005.99,0,10)

"FIA",2005.99,0,11)

"FIA",2005.99,0,"RLRO")

"FIA",2005.99,0,"VR")
3.0^MAG
"FIA",2005.99,2005.99)
0
"FIA",2006.15)
DICOM UID ROOT
"FIA",2006.15,0)
^MAGD(2006.15,
"FIA",2006.15,0,0)
2006.15
"FIA",2006.15,0,1)
y^y^f^^^^n
"FIA",2006.15,0,10)

"FIA",2006.15,0,11)

"FIA",2006.15,0,"RLRO")

"FIA",2006.15,0,"VR")
3.0^MAG
"FIA",2006.15,2006.15)
0
"INI")
PRE^MAGIP106
"INIT")
POS^MAGIP106
"KRN",8989.51,123457,-1)
0^1
"KRN",8989.51,123457,0)
MAG TR ALLOW THIN CLIENT^MAG TELEREADER ALLOW THIN CLIENT^0
"KRN",8989.51,123457,1)
Y^^Enter YES to allow viewing of images using thin client.
"KRN",8989.51,123457,20,0)
^^2^2^3100415
"KRN",8989.51,123457,20,1,0)
This parameter controls if a user is allowed to view images
"KRN",8989.51,123457,20,2,0)
using thin client in TeleReader
"KRN",8989.51,123457,30,0)
^8989.513I^4^4
"KRN",8989.51,123457,30,1,0)
1^200
"KRN",8989.51,123457,30,2,0)
2^49
"KRN",8989.51,123457,30,3,0)
3^4
"KRN",8989.51,123457,30,4,0)
4^4.2
"KRN",19.1,123458,-1)
0^1
"KRN",19.1,123458,0)
MAGCAP TRC^TELEREADER CAPTURE KEY
"KRN",19.1,123458,1,0)
^19.11^1^1^3101223^^
"KRN",19.1,123458,1,1,0)
User can capture images associated to TelerReader Consult from the Imaging Capture workstation.
"KRN",8994,123459,-1)
0^1
"KRN",8994,123459,0)
MAG3 DICOM CAPTURE GE LIST^GGELIST^MAGNDCMC^2^R
"KRN",8994,123459,1,0)
^^2^2^3090928^
"KRN",8994,123459,1,1,0)
Return all records in IMAGING DICOM FIELDS file (#2005.71)
"KRN",8994,123459,1,2,0)
per SOP type  (e.g "TELEDERM")
"KRN",8994,123459,2,0)
^8994.02A^1^1
"KRN",8994,123459,2,1,0)
MAGSOP^1^^1^1
"KRN",8994,123459,2,1,1,0)
^^1^1^3090928^
"KRN",8994,123459,2,1,1,1,0)
SOP type (e.g "TELEDERM")
"KRN",8994,123459,2,"B","MAGSOP",1)

"KRN",8994,123459,2,"PARAMSEQ",1,1)

"KRN",8994,123459,3,0)
^^6^6^3090928^
"KRN",8994,123459,3,1,0)
if error found during execution
"KRN",8994,123459,3,2,0)
  MAGRY(0) = "0^Error"
"KRN",8994,123459,3,3,0)
if success
"KRN",8994,123459,3,4,0)
  MAGRY(0)    = "1^#CNT" - where #CNT is a number of records returned
"KRN",8994,123459,3,5,0)
  MAGRY(1)    = "MODULE^ELEMENT^ELEMENT NAME^VALUE MULTIPLICITY^VALUE REPRESENTATION^GUI CONTROL"
"KRN",8994,123459,3,6,0)
  MAGRY(2..n) = "^" delimited string with values of vields listed in MAGOUT(1) 
"KRN",8994,123460,-1)
0^2
"KRN",8994,123460,0)
MAG3 DICOM CAPTURE SOP CLASS^GSOPCLAS^MAGNDCMC^1^R
"KRN",8994,123460,1,0)
^^1^1^3101008^
"KRN",8994,123460,1,1,0)
Returns SOP CLASS UID per SOP type  (e.g. "TELEDERM")
"KRN",8994,123460,2,0)
^8994.02A^1^1
"KRN",8994,123460,2,1,0)
MAGSOP^1^^1^1
"KRN",8994,123460,2,1,1,0)
^^1^1^3101008^
"KRN",8994,123460,2,1,1,1,0)
MAGSOP = SOP type (e.g. "TELEDERM")
"KRN",8994,123460,2,"B","MAGSOP",1)

"KRN",8994,123460,2,"PARAMSEQ",1,1)

"KRN",8994,123460,3,0)
^^5^5^3101008^
"KRN",8994,123460,3,1,0)
If error found during execution
"KRN",8994,123460,3,2,0)
   MAGRY(0) = "0^Error Message"
"KRN",8994,123460,3,3,0)
If success
"KRN",8994,123460,3,4,0)
   MAGRY(0)    = "1^IEN^SOP CLASS UID
"KRN",8994,123460,3,5,0)
    where IEN is the IEN of the SOP CLASS UID in DICOM SOP CLASS file (#2006.532)
"KRN",8994,123461,-1)
0^3
"KRN",8994,123461,0)
MAG3 TELEREADER CONSULT LIST^CONSLIST^MAGNGMR^2^R
"KRN",8994,123461,1,0)
^8994.01^2^2^3090918^^^^
"KRN",8994,123461,1,1,0)
Return not completed consults for a patient
"KRN",8994,123461,1,2,0)
where TO SERVICE is setup in TELEREADER ACQUISITION SERVICE file (#2006.5841)
"KRN",8994,123461,2,0)
^8994.02A^1^1
"KRN",8994,123461,2,1,0)
DFN^1^^1^1
"KRN",8994,123461,2,1,1,0)
^8994.021^1^1^3090918^^^^
"KRN",8994,123461,2,1,1,1,0)
Patient ID
"KRN",8994,123461,2,"B","DFN",1)

"KRN",8994,123461,2,"PARAMSEQ",1,1)

"KRN",8994,123461,3,0)
^8994.03^7^7^3090918^^^^
"KRN",8994,123461,3,1,0)
Returns an array where the zeroeth element will be either:
"KRN",8994,123461,3,2,0)
  if error found during execution
"KRN",8994,123461,3,3,0)
     0^Error getting consult list
"KRN",8994,123461,3,4,0)
   if success
"KRN",8994,123461,3,5,0)
 MAGRY(0)    = "1^#CNT" - where #CNT is a number of records returned
"KRN",8994,123461,3,6,0)
 MAGRY(1)    = "Consult ID^Consult Request Date^Service^Procedure^Sending Provider"
"KRN",8994,123461,3,7,0)
 MAGRY(2..n) = "^" delimited string with values of the fields listed in MAGOUT(1) 
"KRN",8994,123462,-1)
0^4
"KRN",8994,123462,0)
MAG3 TELEREADER DICOM SER NUM^GETSRNUM^MAGNGMR^1^R
"KRN",8994,123462,1,0)
^^1^1^3100930^
"KRN",8994,123462,1,1,0)
Generates DICOM Series Number
"KRN",8994,123462,3,0)
^^4^4^3100930^
"KRN",8994,123462,3,1,0)
if error found during execution
"KRN",8994,123462,3,2,0)
   MAGRY = "0^Error message"
"KRN",8994,123462,3,3,0)
if success
"KRN",8994,123462,3,4,0)
   MAGRY = "1^DICOM Series Number
"KRN",8994,123463,-1)
0^5
"KRN",8994,123463,0)
MAG3 TELEREADER DICOM UID^GETUID^MAGNGMR^1^R
"KRN",8994,123463,1,0)
^8994.01^1^1^3100628^^^^
"KRN",8994,123463,1,1,0)
Returns a new TELEREADER DICOM Study, Series or SOP Instance UID
"KRN",8994,123463,2,0)
^8994.02A^1^1
"KRN",8994,123463,2,1,0)
MAGPARAM^2^^1^1
"KRN",8994,123463,2,1,1,0)
^8994.021^4^4^3100628^^
"KRN",8994,123463,2,1,1,1,0)
MAGPARAM - array with input values
"KRN",8994,123463,2,1,1,2,0)
           MAGPARAM("TYPE")= Type UID - "STUDY", "SERIES", "SOP"
"KRN",8994,123463,2,1,1,3,0)
           MAGPARAM("ACNUM")= Accession number - Patient consult ID
"KRN",8994,123463,2,1,1,4,0)
           MAGPARAM("DFN")= Patient DFN
"KRN",8994,123463,2,"B","MAGPARAM",1)

"KRN",8994,123463,2,"PARAMSEQ",1,1)

"KRN",8994,123463,3,0)
^8994.03^4^4^3100628^^^^
"KRN",8994,123463,3,1,0)
 if error found during execution
"KRN",8994,123463,3,2,0)
   MAGRY = 0^Error message
"KRN",8994,123463,3,3,0)
 if success
"KRN",8994,123463,3,4,0)
   MAGRY    = 1^UID
"KRN",8994,123464,-1)
0^6
"KRN",8994,123464,0)
MAG3 TELEREADER READ/UNRD ADD^FILE^MAGNGMR^1^R
"KRN",8994,123464,1,0)
^8994.01^3^3^3090819^^^
"KRN",8994,123464,1,1,0)
Add a consult and image pointers to
"KRN",8994,123464,1,2,0)
Unread/Read List file (#2006.5849)
"KRN",8994,123464,1,3,0)
and DICOM GMRC TEMP LIST file (#2006.5839)
"KRN",8994,123464,2,0)
^8994.02A^3^3
"KRN",8994,123464,2,1,0)
MAGDA^1^^^1
"KRN",8994,123464,2,1,1,0)
^^1^1^3090814^
"KRN",8994,123464,2,1,1,1,0)
An image IEN in IMAGE file (#2005) - ^MAG(2005,MAGDA)
"KRN",8994,123464,2,2,0)
MAGCNT^1^^1^2
"KRN",8994,123464,2,2,1,0)
^^1^1^3090814^
"KRN",8994,123464,2,2,1,1,0)
Count of new images captured
"KRN",8994,123464,2,3,0)
MAGRIEN^1^^1^3
"KRN",8994,123464,2,3,1,0)
^8994.021^1^1^3090819^^^
"KRN",8994,123464,2,3,1,1,0)
a request/consult IEN in REQUEST/CONSULTATION file (#123)
"KRN",8994,123464,2,"B","MAGCNT",2)

"KRN",8994,123464,2,"B","MAGDA",1)

"KRN",8994,123464,2,"B","MAGRIEN",3)

"KRN",8994,123464,2,"PARAMSEQ",1,1)

"KRN",8994,123464,2,"PARAMSEQ",2,2)

"KRN",8994,123464,2,"PARAMSEQ",3,3)

"KRN",8994,123464,3,0)
^8994.03^2^2^3090819^^^
"KRN",8994,123464,3,1,0)
if error MAGRY = The first "^" piece is zero if error occurs. The second piece is an error message
"KRN",8994,123464,3,2,0)
if success MAGRY = The first "^" piece is one and the second is update message
"KRN",8994,123465,-1)
0^7
"KRN",8994,123465,0)
MAG3 TR THIN CLIENT ALLOWED^TCALLOW^MAGNTLR3^1^R^0
"KRN",8994,123465,1,0)
^^1^1^3100415^
"KRN",8994,123465,1,1,0)
Check for thin client settings by User (DUZ)
"KRN",8994,123465,3,0)
^^2^2^3100415^
"KRN",8994,123465,3,1,0)
 if error MAGRY = first "^" piece is zero if error occurs
"KRN",8994,123465,3,2,0)
 if success MAGRY = "1^0|1" - 0 - not allowed; 1 - allowed
"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",454,-1)
1^1
"PKG",454,0)
IMAGING^MAG^Imaging Release History
"PKG",454,22,0)
^9.49I^1^1
"PKG",454,22,1,0)
3.0^3020328^3020328^.5
"PKG",454,22,1,"PAH",1,0)
106^3110228^.5
"PKG",454,22,1,"PAH",1,1,0)
^9.49011^20^20^3110228
"PKG",454,22,1,"PAH",1,1,1,0)
Routines for Patch 106, Test Build 13.
"PKG",454,22,1,"PAH",1,1,2,0)
 
"PKG",454,22,1,"PAH",1,1,3,0)
Routines:
"PKG",454,22,1,"PAH",1,1,4,0)
MAGDHWC     value = 12231552
"PKG",454,22,1,"PAH",1,1,5,0)
MAGGSIA1    value = 13960534
"PKG",454,22,1,"PAH",1,1,6,0)
MAGGTIA     value = 12401847
"PKG",454,22,1,"PAH",1,1,7,0)
MAGGTU4C    value = 3511227
"PKG",454,22,1,"PAH",1,1,8,0)
MAGGTU4D    value = 3511235
"PKG",454,22,1,"PAH",1,1,9,0)
MAGGTU4L    value = 3511299
"PKG",454,22,1,"PAH",1,1,10,0)
MAGGTU4T    value = 3511363
"PKG",454,22,1,"PAH",1,1,11,0)
MAGIP106    value = 3993590
"PKG",454,22,1,"PAH",1,1,12,0)
MAGNDCMC    value = 5330392
"PKG",454,22,1,"PAH",1,1,13,0)
MAGNGMR     value = 13876633
"PKG",454,22,1,"PAH",1,1,14,0)
MAGNTLR3    value = 2994749
"PKG",454,22,1,"PAH",1,1,15,0)
MAGNUID1    value = 6357640
"PKG",454,22,1,"PAH",1,1,16,0)
MAGNUID2    value = 2830351
"PKG",454,22,1,"PAH",1,1,17,0)
MAGUXRF     value = 6191185
"PKG",454,22,1,"PAH",1,1,18,0)
 
"PKG",454,22,1,"PAH",1,1,19,0)
Please note that routine MAGIP106 is deleted after the KIDS Build is
"PKG",454,22,1,"PAH",1,1,20,0)
installed.
"PRE")
MAGIP106
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
14
"RTN","MAGDHWC")
0^1^B48238555
"RTN","MAGDHWC",1,0)
MAGDHWC ;WOIFO/PMK/NST - Capture Consult/Procedure Request data ; 27 Aug 2010 8:40 AM
"RTN","MAGDHWC",2,0)
 ;;3.0;IMAGING;**10,51,46,54,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGDHWC",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGDHWC",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDHWC",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGDHWC",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGDHWC",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGDHWC",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGDHWC",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGDHWC",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGDHWC",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGDHWC",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGDHWC",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGDHWC",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGDHWC",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGDHWC",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGDHWC",17,0)
 ;;
"RTN","MAGDHWC",18,0)
ENTRY ;
"RTN","MAGDHWC",19,0)
 ; determine the kind of message and branch appropriately
"RTN","MAGDHWC",20,0)
 N APTSCHED,CONSULT,DATETIME,DEL,DEL2,DEL3,DEL4,DEL5,DFN
"RTN","MAGDHWC",21,0)
 N DIVISION,FILLER1,FWDFROM,FMDATE,FMDATETM,GMRCIEN,HL,HL7,HL7ORC,HL7REC
"RTN","MAGDHWC",22,0)
 N I,IGNORE,ITYPCODE,ITYPNAME,IGNORE,MSGTYPE,OBXSEGNO,ORIGSERV,SERVICE,X,Y,Z
"RTN","MAGDHWC",23,0)
 I $D(GMRCMSG) M HL7=GMRCMSG
"RTN","MAGDHWC",24,0)
 E  I $D(XQORHSTK(0)) M HL7=XQORHSTK(0)
"RTN","MAGDHWC",25,0)
 E  Q  ; can't find HL7 data to handle this!
"RTN","MAGDHWC",26,0)
 S HL7REC=HL7(1)
"RTN","MAGDHWC",27,0)
 S DEL=$E(HL7REC,4),X=$P(HL7REC,DEL,2)
"RTN","MAGDHWC",28,0)
 F I=1:1:$L(X) S @("DEL"_(I+1))=$E(X,I)
"RTN","MAGDHWC",29,0)
 S FMDATETM=$$NOW^XLFDT(),FMDATE=FMDATETM\1
"RTN","MAGDHWC",30,0)
 ;
"RTN","MAGDHWC",31,0)
 ; find PID segment and get the DFN
"RTN","MAGDHWC",32,0)
 S I=0 I '$$FINDSEG^MAGDHW0(.HL7,"PID",.I,.X) Q  ; no PID segment
"RTN","MAGDHWC",33,0)
 S DFN=$P(X,DEL,3)
"RTN","MAGDHWC",34,0)
 ;
"RTN","MAGDHWC",35,0)
 ; find ORC segment and get GMRCIEN
"RTN","MAGDHWC",36,0)
 S I=0 I '$$FINDSEG^MAGDHW0(.HL7,"ORC",.I,.HL7ORC) Q  ; no ORC segment
"RTN","MAGDHWC",37,0)
 S GMRCIEN=+$P(HL7ORC,DEL,3) ; GMRC request is in ^GMR(123,GMRCIEN,...)
"RTN","MAGDHWC",38,0)
 ;
"RTN","MAGDHWC",39,0)
 D ^MAGDTR01 ; update the Read/Unread list with the data from the HL7 message
"RTN","MAGDHWC",40,0)
 ;
"RTN","MAGDHWC",41,0)
 S IGNORE=1 ; decide if service is one that requires HL7->DICOM gateway
"RTN","MAGDHWC",42,0)
 ;
"RTN","MAGDHWC",43,0)
 ; find ORC segment and check for an "OK" order control value
"RTN","MAGDHWC",44,0)
 I $P(HL7ORC,DEL)="OK" D  Q  ; generate message by ^MAGDHWS
"RTN","MAGDHWC",45,0)
 . S SERVICE=$$GET1^DIQ(123,GMRCIEN,1,"I")
"RTN","MAGDHWC",46,0)
 . D SERVICE ; send this transaction to the DICOM gateway?
"RTN","MAGDHWC",47,0)
 . I 'IGNORE D
"RTN","MAGDHWC",48,0)
 . . D INIT^MAGDHW0 ; initialize variables
"RTN","MAGDHWC",49,0)
 . . S DATETIME=""
"RTN","MAGDHWC",50,0)
 . . D MESSAGE^MAGDHWS("O") ; indicates new order
"RTN","MAGDHWC",51,0)
 . . Q
"RTN","MAGDHWC",52,0)
 . Q
"RTN","MAGDHWC",53,0)
 ;
"RTN","MAGDHWC",54,0)
 I " CA CR DR OC OD "[(" "_$P(HL7ORC,DEL)_" ") D  Q  ; Discontinued order
"RTN","MAGDHWC",55,0)
 . S SERVICE=$$GET1^DIQ(123,GMRCIEN,1,"I")
"RTN","MAGDHWC",56,0)
 . D SERVICE ; send this transaction to the DICOM gateway?
"RTN","MAGDHWC",57,0)
 . I 'IGNORE D
"RTN","MAGDHWC",58,0)
 . . D INIT^MAGDHW0 ; initialize variables
"RTN","MAGDHWC",59,0)
 . . S DATETIME=""
"RTN","MAGDHWC",60,0)
 . . D MESSAGE^MAGDHWS("C") ; Cancelled/Discontinued order
"RTN","MAGDHWC",61,0)
 . . Q
"RTN","MAGDHWC",62,0)
 . Q
"RTN","MAGDHWC",63,0)
 ;
"RTN","MAGDHWC",64,0)
 ; check for a FORWARD in the ORC segment
"RTN","MAGDHWC",65,0)
 I $P($P(HL7ORC,DEL,16),DEL2,5)="FORWARD" D
"RTN","MAGDHWC",66,0)
 . ; get previous service from REQUEST PROCESSING ACTIVITY
"RTN","MAGDHWC",67,0)
 . S FWDFROM=$$FWDFROM^MAGDGMRC(GMRCIEN) ; FORWARDED FROM service
"RTN","MAGDHWC",68,0)
 . S Y=0 I FWDFROM S Y=$G(^MAG(2006.5831,FWDFROM,0))
"RTN","MAGDHWC",69,0)
 . I Y D  ; forwarded from location was one in the service group
"RTN","MAGDHWC",70,0)
 . . N DIVISION,Z
"RTN","MAGDHWC",71,0)
 . . ; original service request probably was sent to DICOM Gateway
"RTN","MAGDHWC",72,0)
 . . S ORIGSERV=DEL2_DEL2_DEL2_FWDFROM_DEL2
"RTN","MAGDHWC",73,0)
 . . S ORIGSERV=ORIGSERV_$S(FWDFROM:$$GET1^DIQ(123.5,FWDFROM,.01),1:"")
"RTN","MAGDHWC",74,0)
 . . S ORIGSERV=ORIGSERV_DEL2_"99CON"
"RTN","MAGDHWC",75,0)
 . . D DIVISION(Y)
"RTN","MAGDHWC",76,0)
 . . S Z=$P(Y,"^",2)
"RTN","MAGDHWC",77,0)
 . . S ITYPNAME=$P(^MAG(2005.84,Z,0),"^",1)
"RTN","MAGDHWC",78,0)
 . . S ITYPCODE=$P(^MAG(2005.84,Z,2),"^",1)
"RTN","MAGDHWC",79,0)
 . . S ORIGSERV=ORIGSERV_DEL_ITYPCODE_DEL2_ITYPNAME_DEL2_DIVISION
"RTN","MAGDHWC",80,0)
 . . S (ITYPCODE,ITYPNAME)="" ; may need them nulled in ZSV^MAGDHWA
"RTN","MAGDHWC",81,0)
 . . S IGNORE=0
"RTN","MAGDHWC",82,0)
 . . Q
"RTN","MAGDHWC",83,0)
 . Q
"RTN","MAGDHWC",84,0)
 ;
"RTN","MAGDHWC",85,0)
 ; find ZSV segment and requested service - check if appropriate
"RTN","MAGDHWC",86,0)
 S I=0 I '$$FINDSEG^MAGDHW0(.HL7,"ZSV",.I,.X) Q  ; no ZSV segment
"RTN","MAGDHWC",87,0)
 S SERVICE=$P($P(X,DEL),DEL2,4)
"RTN","MAGDHWC",88,0)
 D SERVICE ; send this transaction to the DICOM gateway?
"RTN","MAGDHWC",89,0)
 ;
"RTN","MAGDHWC",90,0)
 S Z=$P(HL7ORC,DEL,1) ; Order Control
"RTN","MAGDHWC",91,0)
 S Y=$P(HL7ORC,DEL,5) ; Order Status
"RTN","MAGDHWC",92,0)
 I Z="SC" S MSGTYPE="RECEIVED" ; received
"RTN","MAGDHWC",93,0)
 E  I Z="RE" D  ; result
"RTN","MAGDHWC",94,0)
 . I Y="A" S MSGTYPE="PARTIAL RESULT" ; unsigned TIU note
"RTN","MAGDHWC",95,0)
 . E  I Y="CM" D  ; check for a new unsigned note
"RTN","MAGDHWC",96,0)
 . . I $$UNSIGNED^MAGDGMRC(GMRCIEN) D
"RTN","MAGDHWC",97,0)
 . . . S MSGTYPE="PARTIAL RESULT" ; unsigned TIU note
"RTN","MAGDHWC",98,0)
 . . . S FILLER1="GMRC-NEW UNSIGNED RESULT"
"RTN","MAGDHWC",99,0)
 . . . Q
"RTN","MAGDHWC",100,0)
 . . E  S MSGTYPE="COMPLETE RESULT"  ; signed TIU note
"RTN","MAGDHWC",101,0)
 . . Q
"RTN","MAGDHWC",102,0)
 . Q
"RTN","MAGDHWC",103,0)
 E  S MSGTYPE="UNKNOWN"
"RTN","MAGDHWC",104,0)
 ;
"RTN","MAGDHWC",105,0)
 ;-- patch 106: In case the service is not in file #2006.5831
"RTN","MAGDHWC",106,0)
 I IGNORE D  Q  ; just ignore HL7 message, don't send it to DICOM gateway
"RTN","MAGDHWC",107,0)
 . N I
"RTN","MAGDHWC",108,0)
 . I MSGTYPE["RESULT" S I=$$NEWTIU^MAGDHWA(GMRCIEN)
"RTN","MAGDHWC",109,0)
 . Q
"RTN","MAGDHWC",110,0)
 ;
"RTN","MAGDHWC",111,0)
 D MSH^MAGDHWA,PID^MAGDHWA,ORC^MAGDHWA,OBR^MAGDHWA,ZSV^MAGDHWA
"RTN","MAGDHWC",112,0)
 I '$$OBX() D  ; get OBX segment from database
"RTN","MAGDHWC",113,0)
 . S I=$O(HL7(""),-1)+1 S I=$$OBX^MAGDHWS(I)
"RTN","MAGDHWC",114,0)
 . Q
"RTN","MAGDHWC",115,0)
 E  D  ; process existing OBX segment
"RTN","MAGDHWC",116,0)
 . D OBX1
"RTN","MAGDHWC",117,0)
 . Q
"RTN","MAGDHWC",118,0)
 D ALLERGY^MAGDHWA,POSTINGS^MAGDHWA
"RTN","MAGDHWC",119,0)
 D OUTPUT^MAGDHW0
"RTN","MAGDHWC",120,0)
 Q
"RTN","MAGDHWC",121,0)
 ;
"RTN","MAGDHWC",122,0)
SERVICE ; check if the service is in the DICOM Clinical Service dictionary
"RTN","MAGDHWC",123,0)
 N Y
"RTN","MAGDHWC",124,0)
 I SERVICE D  ; ignore SERVICE if it is null
"RTN","MAGDHWC",125,0)
 . S Y=$G(^MAG(2006.5831,SERVICE,0))
"RTN","MAGDHWC",126,0)
 . S DIVISION=DEL2
"RTN","MAGDHWC",127,0)
 . I Y D  ; new service is of interest to DICOM Gateway
"RTN","MAGDHWC",128,0)
 . . D DIVISION(Y)
"RTN","MAGDHWC",129,0)
 . . S Z=$P(Y,"^",2)
"RTN","MAGDHWC",130,0)
 . . S ITYPNAME=$P(^MAG(2005.84,Z,0),"^",1)
"RTN","MAGDHWC",131,0)
 . . S ITYPCODE=$P(^MAG(2005.84,Z,2),"^",1)
"RTN","MAGDHWC",132,0)
 . . S IGNORE=0
"RTN","MAGDHWC",133,0)
 . . D APPOINT
"RTN","MAGDHWC",134,0)
 . . Q
"RTN","MAGDHWC",135,0)
 . Q
"RTN","MAGDHWC",136,0)
 Q
"RTN","MAGDHWC",137,0)
 ;
"RTN","MAGDHWC",138,0)
DIVISION(Y) ;
"RTN","MAGDHWC",139,0)
 S DIVISION=$P(Y,"^",3)
"RTN","MAGDHWC",140,0)
 S DIVISION=DIVISION_DEL2_$S(DIVISION:$$GET1^DIQ(4,DIVISION,.01),1:"")
"RTN","MAGDHWC",141,0)
 Q
"RTN","MAGDHWC",142,0)
 ;
"RTN","MAGDHWC",143,0)
APPOINT ; quite often the appointment is entered before the order is entered
"RTN","MAGDHWC",144,0)
 ; if this is the case, see if we can find the corresponding appointment
"RTN","MAGDHWC",145,0)
 N CLINIC,HIT,I,LOCIEN,ORDERIEN,VASD,XE,XI
"RTN","MAGDHWC",146,0)
 ; look for appointments for today or later - don't need VASD parameters
"RTN","MAGDHWC",147,0)
 D SDA^VADPT ; get the list of the appointments
"RTN","MAGDHWC",148,0)
 ; first check the order record for the patient location
"RTN","MAGDHWC",149,0)
 ; it might be the clinic for the appointment
"RTN","MAGDHWC",150,0)
 S HIT=0 ; indicator for finding an appointment match
"RTN","MAGDHWC",151,0)
 S ORDERIEN=$$GET1^DIQ(123,GMRCIEN,.03,"I")
"RTN","MAGDHWC",152,0)
 S LOCIEN=$S(ORDERIEN:$$GET1^DIQ(100,ORDERIEN,6,"I"),1:"")
"RTN","MAGDHWC",153,0)
 I LOCIEN?1N.N1";SC(" D
"RTN","MAGDHWC",154,0)
 . S CLINIC=+LOCIEN
"RTN","MAGDHWC",155,0)
 . I $$ISCLINIC^MAGDGMRC(SERVICE,CLINIC) D
"RTN","MAGDHWC",156,0)
 . . S I=0 F  S I=$O(^UTILITY("VASD",$J,I)) Q:'I  Q:HIT  D
"RTN","MAGDHWC",157,0)
 . . . S XI=^UTILITY("VASD",$J,I,"I"),XE=^("E")
"RTN","MAGDHWC",158,0)
 . . . ; check if there is an appointment in this clinic
"RTN","MAGDHWC",159,0)
 . . . I CLINIC=$P(XI,"^",2) D APPOINT1 ; select first apt. in clinic
"RTN","MAGDHWC",160,0)
 . . . Q
"RTN","MAGDHWC",161,0)
 . . Q
"RTN","MAGDHWC",162,0)
 . Q
"RTN","MAGDHWC",163,0)
 I 'HIT D  ; no appointment for the pt. location, look for other clinics
"RTN","MAGDHWC",164,0)
 . S I=0 F  S I=$O(^UTILITY("VASD",$J,I)) Q:'I  Q:HIT  D
"RTN","MAGDHWC",165,0)
 . . S XI=^UTILITY("VASD",$J,I,"I"),XE=^("E")
"RTN","MAGDHWC",166,0)
 . . S CLINIC=$P(XI,"^",2)
"RTN","MAGDHWC",167,0)
 . . I $$ISCLINIC^MAGDGMRC(SERVICE,CLINIC) D APPOINT1
"RTN","MAGDHWC",168,0)
 . . Q
"RTN","MAGDHWC",169,0)
 . Q
"RTN","MAGDHWC",170,0)
 K ^UTILITY("VASD",$J)
"RTN","MAGDHWC",171,0)
 Q
"RTN","MAGDHWC",172,0)
 ;
"RTN","MAGDHWC",173,0)
APPOINT1 ; fill the appointment schedule array
"RTN","MAGDHWC",174,0)
 S APTSCHED("FM DATETIME")=$P(XI,"^")
"RTN","MAGDHWC",175,0)
 S APTSCHED("CLINIC IEN")=CLINIC
"RTN","MAGDHWC",176,0)
 S APTSCHED("DATETIME")=$P(XE,"^")
"RTN","MAGDHWC",177,0)
 S APTSCHED("CLINIC NAME")=$P(XE,"^",2)
"RTN","MAGDHWC",178,0)
 S HIT=1 ; to exit loop
"RTN","MAGDHWC",179,0)
 Q
"RTN","MAGDHWC",180,0)
 ;
"RTN","MAGDHWC",181,0)
OBX() ; find OBX segments to determine the highest value of OBXSEGNO
"RTN","MAGDHWC",182,0)
 N I,X
"RTN","MAGDHWC",183,0)
 S OBXSEGNO=0
"RTN","MAGDHWC",184,0)
 S I=0 F  D  Q:I=""  ; $o through HL7 message - quit when at end
"RTN","MAGDHWC",185,0)
 . I $$FINDSEG^MAGDHW0(.HL7,"OBX",.I,.X) S OBXSEGNO=$P(X,DEL,1)
"RTN","MAGDHWC",186,0)
 . Q
"RTN","MAGDHWC",187,0)
 Q OBXSEGNO
"RTN","MAGDHWC",188,0)
 ;
"RTN","MAGDHWC",189,0)
OBX1 ; if there are second level OBX data, add OBX segment prefix
"RTN","MAGDHWC",190,0)
 N I,J
"RTN","MAGDHWC",191,0)
 ; add additional OBX segments to convey the Reason for the Request
"RTN","MAGDHWC",192,0)
 ; more than one, so can't use "I $$FINDSEG^MAGDHW0(.HL7,"OBX",.I) D  "
"RTN","MAGDHWC",193,0)
 S I="" F  S I=$O(HL7(I)) Q:I=""  I $P(HL7(I),DEL)="OBX" D
"RTN","MAGDHWC",194,0)
 . I '$D(HL7(I,1)) Q  ; no additional OBX segments needed
"RTN","MAGDHWC",195,0)
 . S X=$P(HL7(I),DEL,1,5) ; copy pieces 1-5 to other segments
"RTN","MAGDHWC",196,0)
 . S J="" F  S J=$O(HL7(I,J)) Q:'J  S HL7(I,J)=X_DEL_HL7(I,J)
"RTN","MAGDHWC",197,0)
 . Q
"RTN","MAGDHWC",198,0)
 Q
"RTN","MAGGSIA1")
0^2^B41835903
"RTN","MAGGSIA1",1,0)
MAGGSIA1 ;WOIFO/GEK/SG/NST - RPC Call to Add Image File entry ; 29 Oct 2010 1:15 PM
"RTN","MAGGSIA1",2,0)
 ;;3.0;IMAGING;**7,8,85,59,93,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGSIA1",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGSIA1",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGSIA1",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGSIA1",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGSIA1",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGSIA1",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGSIA1",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGSIA1",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGSIA1",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGSIA1",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGSIA1",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGSIA1",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGSIA1",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGSIA1",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGSIA1",17,0)
 ;;
"RTN","MAGGSIA1",18,0)
 Q
"RTN","MAGGSIA1",19,0)
PRE(MAGERR,MAGGFDA,MAGGRP,MAGGDRV,MAGREF) ;
"RTN","MAGGSIA1",20,0)
 ;  Check on some possible problems: required fields etc.
"RTN","MAGGSIA1",21,0)
 ;  Object Type and (Patient, or Short Desc) Required.
"RTN","MAGGSIA1",22,0)
 N MAGRSLT,X,Z
"RTN","MAGGSIA1",23,0)
 ; Patch 106: PRE^MAGGSIA1 is called by Import API only so
"RTN","MAGGSIA1",24,0)
 ; if CAPTURE APPLICATION field (#8.1) is not set we set it to "I"
"RTN","MAGGSIA1",25,0)
 ; For VI Capture and DICOM Gateway the value of #8.1 is set
"RTN","MAGGSIA1",26,0)
 ; in ADD^MAGGTIA 
"RTN","MAGGSIA1",27,0)
 I '$D(MAGGFDA(2005,"+1,",8.1)) S MAGGFDA(2005,"+1,",8.1)="I"
"RTN","MAGGSIA1",28,0)
 I '$D(MAGGFDA(2005,"+1,",3)) D OBJTYPE
"RTN","MAGGSIA1",29,0)
 I '$D(MAGGFDA(2005,"+1,",3)) S MAGERR="0^Need an Object Type " Q
"RTN","MAGGSIA1",30,0)
 I '$D(MAGGFDA(2005,"+1,",5)),'$D(MAGGFDA(2005,"+1,",10)) D  Q
"RTN","MAGGSIA1",31,0)
 . S MAGERR="0^Need Patient or Short Desc.  Operation CANCELED "
"RTN","MAGGSIA1",32,0)
 ; IF no Procedure text we'll give it some so crossref will set.
"RTN","MAGGSIA1",33,0)
 D PATCHK(.MAGRSLT) I 'MAGRSLT S MAGERR=MAGRSLT Q
"RTN","MAGGSIA1",34,0)
 ; Patch 8 IAPI We Create IXCLS (#41 CLASS) and  IXPKG (#40 Package) if TYPE is in Data.
"RTN","MAGGSIA1",35,0)
 ; But we are not making TYPE required yet for backward compatibility.
"RTN","MAGGSIA1",36,0)
 I $D(MAGGFDA(2005,"+1,",42)) D
"RTN","MAGGSIA1",37,0)
 . I $$GET1^DIQ(2005.83,MAGGFDA(2005,"+1,",42),2,"E")="INACTIVE" D  S MAGRY=MAGERR Q
"RTN","MAGGSIA1",38,0)
 . . S MAGERR="0^Index Type: "_$$GET1^DIQ(2005.83,MAGGFDA(2005,"+1,",42),.01,"E")_"is INACTIVE"
"RTN","MAGGSIA1",39,0)
 . I '$D(MAGGFDA(2005,"+1,",41)) D MAKECLAS^MAGGSIU1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGSIA1",40,0)
 . I ($D(MAGGFDA(2005,"+1,",16)))&($$ISTYPADM(MAGGFDA(2005,"+1,",42))) D  S MAGRY=MAGERR Q
"RTN","MAGGSIA1",41,0)
 . . S MAGERR="0^Can't have an ADMIN TYPE with Clinical Image."
"RTN","MAGGSIA1",42,0)
 . I '$D(MAGGFDA(2005,"+1,",40)) D MAKEPKG^MAGGSIU1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGSIA1",43,0)
 . I '$D(MAGGFDA(2005,"+1,",6)) D MAKEPROC^MAGGSIU1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGSIA1",44,0)
 . I '$D(MAGGFDA(2005,"+1,",45)) D MAKEORIG^MAGGSIU1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGSIA1",45,0)
 . Q
"RTN","MAGGSIA1",46,0)
 ;
"RTN","MAGGSIA1",47,0)
 I '$D(MAGGFDA(2005,"+1,",6)) D PROCTEXT
"RTN","MAGGSIA1",48,0)
 ;
"RTN","MAGGSIA1",49,0)
 ; If no Procedure/Exam Date/Time we'll give it DocDT, or NOW
"RTN","MAGGSIA1",50,0)
 I '$D(MAGGFDA(2005,"+1,",15)) D
"RTN","MAGGSIA1",51,0)
 . I $D(MAGGFDA(2005,"+1,",110)) S MAGGFDA(2005,"+1,",15)=MAGGFDA(2005,"+1,",110) Q
"RTN","MAGGSIA1",52,0)
 . S MAGGFDA(2005,"+1,",15)=$E($$NOW^XLFDT,1,12)
"RTN","MAGGSIA1",53,0)
 ; DateTime image saved.
"RTN","MAGGSIA1",54,0)
 I '$D(MAGGFDA(2005,"+1,",7)) S MAGGFDA(2005,"+1,",7)=$E($$NOW^XLFDT,1,12)
"RTN","MAGGSIA1",55,0)
 ; Short Description
"RTN","MAGGSIA1",56,0)
 ;I '$D(MAGGFDA(2005,"+1,",10)) S MAGGFDA(2005,"+1,",10)=$$MAKENAME^MAGGSIU1(.MAGGFDA)
"RTN","MAGGSIA1",57,0)
 I '$D(MAGGFDA(2005,"+1,",10)) S MAGGFDA(2005,"+1,",10)=$G(MAGGFDA(2005,"+1,",6))
"RTN","MAGGSIA1",58,0)
 ; Name (.01)
"RTN","MAGGSIA1",59,0)
 I '$D(MAGGFDA(2005,"+1,",.01)) S MAGGFDA(2005,"+1,",.01)=$$MAKENAME^MAGGSIU1(.MAGGFDA)
"RTN","MAGGSIA1",60,0)
 I '$D(MAGGFDA(2005,"+1,",8)) S MAGGFDA(2005,"+1,",8)=$G(DUZ)
"RTN","MAGGSIA1",61,0)
 ; Acquisition Site, Use it to tell where to save the file.
"RTN","MAGGSIA1",62,0)
 I $D(MAGACT("ACQS")) D
"RTN","MAGGSIA1",63,0)
 . ; Patch 8 Have to modify: Field 105 (Acquisition Site) is NOW Field .05
"RTN","MAGGSIA1",64,0)
 . I $P(MAGACT("ACQS"),";")]"" S MAGGFDA(2005,"+1,",.05)=$P(MAGACT("ACQS"),";")
"RTN","MAGGSIA1",65,0)
 ; Only get drive:dir if not a group
"RTN","MAGGSIA1",66,0)
 I 'MAGGRP D  I $L(MAGERR) Q
"RTN","MAGGSIA1",67,0)
 . ; The value of the Action Code "WRITE^value" OVERRIDES any Write Location
"RTN","MAGGSIA1",68,0)
 . ; sent as field # 2 in the input array. (The only value we check for is "PACS" from peter's code)
"RTN","MAGGSIA1",69,0)
 . S X=$S($D(MAGACT("WRITE")):MAGACT("WRITE"),$D(MAGGFDA(2005,"+1,",2)):MAGGFDA(2005,"+1,",2),1:"")
"RTN","MAGGSIA1",70,0)
 . ;P85 Send ACQS as second Param. $$DRIVE will use ACQS If X = ""
"RTN","MAGGSIA1",71,0)
 . ;
"RTN","MAGGSIA1",72,0)
 . S Z=$$DRIVE^MAGGTU1(X,$G(MAGGFDA(2005,"+1,",.05))) ;Drv:Dir to Write
"RTN","MAGGSIA1",73,0)
 . I 'Z S MAGERR=Z Q
"RTN","MAGGSIA1",74,0)
 . S MAGGDRV=$P(Z,U,2)
"RTN","MAGGSIA1",75,0)
 . S MAGGFDA(2005,"+1,",2)=+Z               ;Disk & Vol magnetic
"RTN","MAGGSIA1",76,0)
 . ; if a big file is being made on workstation, put NetWork Location
"RTN","MAGGSIA1",77,0)
 . ; pointer in the BIG NETWORK LOCATION field.
"RTN","MAGGSIA1",78,0)
 . ; (BIG files default to same Network Location as FullRes (or PACS))
"RTN","MAGGSIA1",79,0)
 . I $G(MAGACT("BIG"))=1 S MAGGFDA(2005,"+1,",102)=+Z
"RTN","MAGGSIA1",80,0)
 . S MAGREF=+Z ; save network location ien for $$DIRHASH in ^MAGGSIA1
"RTN","MAGGSIA1",81,0)
 . I $G(MAGACT("ABS"))="STUFFONLY" S MAGGFDA(2005,"+1,",2.1)=+Z
"RTN","MAGGSIA1",82,0)
 ;
"RTN","MAGGSIA1",83,0)
 I $D(MAGACT("ACQL")) S MAGGFDA(2005,"+1,",101)=MAGACT("ACQL")
"RTN","MAGGSIA1",84,0)
 ; HERE we are putting PRE Processing for the Import API action codes.
"RTN","MAGGSIA1",85,0)
 ; "ACQD,ACQS" If Acquisition device entry doesn't exist, create it.
"RTN","MAGGSIA1",86,0)
 I $D(MAGACT("ACQD")) D
"RTN","MAGGSIA1",87,0)
 . ; IF Value is a pointer to the ACQ DEVICE File Quit.  If it's invalid then UPDATE will catch it.
"RTN","MAGGSIA1",88,0)
 . I (+MAGACT("ACQD")=MAGACT("ACQD")) S MAGGFDA(2005,"+1,",107)=MAGACT("ACQD") Q
"RTN","MAGGSIA1",89,0)
 . I $D(^MAG(2006.04,"B",MAGACT("ACQD"))) D  Q
"RTN","MAGGSIA1",90,0)
 . . ; IF Already exists, add it to the FDA
"RTN","MAGGSIA1",91,0)
 . . S MAGGFDA(2005,"+1,",107)=$O(^MAG(2006.04,"B",MAGACT("ACQD"),""))
"RTN","MAGGSIA1",92,0)
 . . ; What do we do with the Acquisition Site. IF Acq Dev already exists. ? 
"RTN","MAGGSIA1",93,0)
 . . ; ??
"RTN","MAGGSIA1",94,0)
 . ; IF it doesn't exist, create it, and add it's ien to the image entry 
"RTN","MAGGSIA1",95,0)
 . N MAGDFDA,MAGDIEN,MAGDXE
"RTN","MAGGSIA1",96,0)
 . S MAGDFDA(2006.04,"+1,",.01)=MAGACT("ACQD")
"RTN","MAGGSIA1",97,0)
 . S MAGDFDA(2006.04,"+1,",1)=$S($D(MAGACT("ACQS")):$P(MAGACT("ACQS"),";"),1:$G(MAGGFDA(2005,"+1,",.05)))
"RTN","MAGGSIA1",98,0)
 . S MAGDFDA(2006.04,"+1,",2)=$S($D(MAGACT("ACQL")):MAGACT("ACQL"),$D(MAGGFDA(2005,"+1,",101)):MAGGFDA(2005,"+1,",101),1:$P($G(MAGACT("ACQS")),";",2))
"RTN","MAGGSIA1",99,0)
 . ; ACQS was a 2 ';' piece value with Acq Location (HOSPITAL LOCATION) as 2nd piece
"RTN","MAGGSIA1",100,0)
 . ;   now it is sent as it's own value in ACQL
"RTN","MAGGSIA1",101,0)
 . D UPDATE^DIE("","MAGDFDA","MAGDIEN","MAGDXE")
"RTN","MAGGSIA1",102,0)
 . S MAGGFDA(2005,"+1,",107)=MAGDIEN(1)
"RTN","MAGGSIA1",103,0)
 ;~~~ Delete this comment and the following line of code when
"RTN","MAGGSIA1",104,0)
 ;    the IMAGE AUDIT file (#2005.1) is completely eliminated.
"RTN","MAGGSIA1",105,0)
 ;    If the last IEN in the IMAGE AUDIT file is greater than the
"RTN","MAGGSIA1",106,0)
 ;~~~ last IEN in the IMAGE file, update the IMAGE file header.
"RTN","MAGGSIA1",107,0)
 I ($O(^MAG(2005,"A"),-1)<$O(^MAG(2005.1,"A"),-1)) S $P(^MAG(2005,0),U,3)=$O(^MAG(2005.1,"A"),-1)
"RTN","MAGGSIA1",108,0)
 ;
"RTN","MAGGSIA1",109,0)
 Q
"RTN","MAGGSIA1",110,0)
PATCHK(MAGR) ; This uses the FDA Array and checks the Imaging Patient against the Procedure patient
"RTN","MAGGSIA1",111,0)
 ;
"RTN","MAGGSIA1",112,0)
 N MAGDFN,PX,PXDA,MAGY
"RTN","MAGGSIA1",113,0)
 S PX=$G(MAGGFDA(2005,"+1,",16))
"RTN","MAGGSIA1",114,0)
 S PXDA=$G(MAGGFDA(2005,"+1,",17))
"RTN","MAGGSIA1",115,0)
 I 'PX S MAGR=1 Q  ; This is a category, or an Image of a group (no parent pointer)
"RTN","MAGGSIA1",116,0)
 S MAGDFN=MAGGFDA(2005,"+1,",5)
"RTN","MAGGSIA1",117,0)
 I (PX=8925) D  Q
"RTN","MAGGSIA1",118,0)
 . I '$D(^TIU(8925,PXDA)) S MAGR="0^Invalid TIU Entry Number: "_PXDA Q
"RTN","MAGGSIA1",119,0)
 . D DATA^MAGGNTI(.MAGY,PXDA)
"RTN","MAGGSIA1",120,0)
 . I '(MAGDFN=$P(MAGY,U,4)) S MAGR="0^Procedure and Imaging patients don't match." Q
"RTN","MAGGSIA1",121,0)
 . S MAGR=1
"RTN","MAGGSIA1",122,0)
 Q
"RTN","MAGGSIA1",123,0)
OBJTYPE ; This call uses the EXT and computes an Object Type
"RTN","MAGGSIA1",124,0)
 N MTYPE
"RTN","MAGGSIA1",125,0)
 I '$L($G(MAGACT("EXT"))) Q
"RTN","MAGGSIA1",126,0)
 S MTYPE=$O(^MAG(2005.02,"AD",MAGACT("EXT"),""))
"RTN","MAGGSIA1",127,0)
 ;I 'MTYPE Q
"RTN","MAGGSIA1",128,0)
 ;TODO : Answer question, do we want to have a default Image type ?
"RTN","MAGGSIA1",129,0)
 I 'MTYPE S MTYPE=1
"RTN","MAGGSIA1",130,0)
 S MAGGFDA(2005,"+1,",3)=MTYPE
"RTN","MAGGSIA1",131,0)
 Q
"RTN","MAGGSIA1",132,0)
ISTYPADM(TYPE) ; Returns 1 if this is an Admin Type
"RTN","MAGGSIA1",133,0)
 N CL
"RTN","MAGGSIA1",134,0)
 I '$G(TYPE) Q 0
"RTN","MAGGSIA1",135,0)
 S CL=$$GET1^DIQ(2005.83,TYPE,1,"E")
"RTN","MAGGSIA1",136,0)
 Q $S($E(CL,1,5)="ADMIN":1,1:0)
"RTN","MAGGSIA1",137,0)
PROCTEXT ;This call uses flds 16 and 17 to compute fld #6 PROCEDURE TEXT [8F]
"RTN","MAGGSIA1",138,0)
 ; We are here because fld #6 PROCEDURE [8F] is null.
"RTN","MAGGSIA1",139,0)
 ; If a pointer to a package is in the data, (flds 16 and 17)
"RTN","MAGGSIA1",140,0)
 ;  get fld #6 from that , if not then treat it as an UNASSIGNED image 
"RTN","MAGGSIA1",141,0)
 ; i.e. Category UNASSIGNED.
"RTN","MAGGSIA1",142,0)
 N MAGYPX,PARENT,PARIEN,PXDESC
"RTN","MAGGSIA1",143,0)
 S PARENT=$G(MAGGFDA(2005,"+1,",16))
"RTN","MAGGSIA1",144,0)
 S PARIEN=$G(MAGGFDA(2005,"+1,",17))
"RTN","MAGGSIA1",145,0)
 ;
"RTN","MAGGSIA1",146,0)
 I (PARENT=8925),(PARIEN]"") D  Q
"RTN","MAGGSIA1",147,0)
 . D DATA^MAGGNTI(.MAGYPX,PARIEN)
"RTN","MAGGSIA1",148,0)
 . S MAGGFDA(2005,"+1,",6)=$P(MAGYPX,U,2)
"RTN","MAGGSIA1",149,0)
 ;TODO; create calls to get default procedure desc for all specialties
"RTN","MAGGSIA1",150,0)
 ; AND default to NONE if a TYPE and no PARENT data File (fld 16)
"RTN","MAGGSIA1",151,0)
 ; If a Parent pointer exists, and it isn't TIU, for now set "NO Description"
"RTN","MAGGSIA1",152,0)
 I PARENT]"" S MAGGFDA(2005,"+1,",6)="No Description" Q
"RTN","MAGGSIA1",153,0)
 ;
"RTN","MAGGSIA1",154,0)
 ; Do we have a pointer to a MAG DESCRIPTIVE CATEGORY
"RTN","MAGGSIA1",155,0)
 I ($G(MAGGFDA(2005,"+1,",100))]"") D  Q
"RTN","MAGGSIA1",156,0)
 . S MAGGFDA(2005,"+1,",6)=$P(^MAG(2005.81,MAGGFDA(2005,"+1,",100),0),U,1)
"RTN","MAGGSIA1",157,0)
 ; 
"RTN","MAGGSIA1",158,0)
 ; If a new child of a Group, use that Proc Desc
"RTN","MAGGSIA1",159,0)
 I $G(MAGGFDA(2005,"+1,",14))]"" D  Q
"RTN","MAGGSIA1",160,0)
 . S MAGGFDA(2005,"+1,",6)=$P(^MAG(2005,MAGGFDA(2005,"+1,",14),0),U,8)
"RTN","MAGGSIA1",161,0)
 ;
"RTN","MAGGSIA1",162,0)
 ; Parent="", and no Category pointer, then we Call it UNASSIGNED
"RTN","MAGGSIA1",163,0)
 S MAGGFDA(2005,"+1,",100)=$O(^MAG(2005.81,"B","UNASSIGNED",""))
"RTN","MAGGSIA1",164,0)
 S MAGGFDA(2005,"+1,",6)="UNASSIGNED"
"RTN","MAGGSIA1",165,0)
 Q
"RTN","MAGGTIA")
0^3^B47129366
"RTN","MAGGTIA",1,0)
MAGGTIA ;WOIFO/GEK/RMP/NST - Imaging RPC Broker calls. Add/Modify Image entry ; 20 Dec 2010 4:07 PM
"RTN","MAGGTIA",2,0)
 ;;3.0;IMAGING;**8,48,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGTIA",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTIA",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTIA",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTIA",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTIA",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTIA",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTIA",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTIA",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTIA",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTIA",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTIA",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTIA",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTIA",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTIA",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTIA",17,0)
 ;;
"RTN","MAGGTIA",18,0)
 Q
"RTN","MAGGTIA",19,0)
 ;
"RTN","MAGGTIA",20,0)
 ;**** CALLING ROUTINE is responsible for RENAMING THE IMAGE FILE
"RTN","MAGGTIA",21,0)
 ;**** on DISK TO THE NEW FILE NAME RETURNED BY THIS CALL.
"RTN","MAGGTIA",22,0)
 ;
"RTN","MAGGTIA",23,0)
ADD(MAGRY,MAGGZ) ; RPC [MAGGADDIMAGE] 
"RTN","MAGGTIA",24,0)
 ; Call to UPDATE^DIE to Add an Image File entry
"RTN","MAGGTIA",25,0)
 ; MAGGZ is an array of fields and their entries
"RTN","MAGGTIA",26,0)
 ;  i.e. MAGGZ(1)=".5^38"  Image File,  field .5   data is 38
"RTN","MAGGTIA",27,0)
 ; If Long Description is included in fields, we create a new
"RTN","MAGGTIA",28,0)
 ;  array to hold the text, and pass that to UPDATE^DIE
"RTN","MAGGTIA",29,0)
 ; If this entry is an object group
"RTN","MAGGTIA",30,0)
 ;  i.e. MAGGZ(n)="2005.04^344"
"RTN","MAGGTIA",31,0)
 ;   (the field 2005.04 is the OBJECT GROUP MULTIPLE)
"RTN","MAGGTIA",32,0)
 ;
"RTN","MAGGTIA",33,0)
 ; MAGRY - Ret variable (Single Variable)
"RTN","MAGGTIA",34,0)
 ;  
"RTN","MAGGTIA",35,0)
 ;   Changed to include hierarchical directory hash  - PMK 04/23/98
"RTN","MAGGTIA",36,0)
 ;   If successful   MAGRY = IEN^FILE NAME (with full path)
"RTN","MAGGTIA",37,0)
 ;        IEN is Internal Entry Number of ^MAG(2005
"RTN","MAGGTIA",38,0)
 ;   If UNsuccessful MAGRY = 0^Error desc
"RTN","MAGGTIA",39,0)
 ;
"RTN","MAGGTIA",40,0)
 ; CALLING ROUTINE is responsible for RENAMING THE IMAGE FILE on DISK
"RTN","MAGGTIA",41,0)
 ;   TO THE NEW FILE NAME RETURNED BY THIS CALL.
"RTN","MAGGTIA",42,0)
 ;----------------------------------------------------------------
"RTN","MAGGTIA",43,0)
 N MAGGXE,MAGGFDA,MAGGIEN,MAGGDRV,MAGGR,MAGGRC,MAGGDA,MAGGFNM
"RTN","MAGGTIA",44,0)
 N MAGGWP,MAGGWPC,MAGGFLD,MAGGDAT,MAGERR,MAGGEXT,MAGGJB
"RTN","MAGGTIA",45,0)
 N MAGADD,MAGMOD,MAGWRITE,MAGREF,MAGDHASH,MAGDCMSN,MAGDCMIN
"RTN","MAGGTIA",46,0)
 N MAGBIG,MAGGABS,MAGQY,MAGRET,MAGETXT
"RTN","MAGGTIA",47,0)
 N MAGFSPEC,MAGFNM
"RTN","MAGGTIA",48,0)
 N I,J,X,Y,Z,ZZ
"RTN","MAGGTIA",49,0)
 ;
"RTN","MAGGTIA",50,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERR^MAGGTERR"
"RTN","MAGGTIA",51,0)
 ;
"RTN","MAGGTIA",52,0)
 S MAGADD=1 ;Flag says we are adding an entry.
"RTN","MAGGTIA",53,0)
 S MAGRY="0^Starting Add Image Entry"
"RTN","MAGGTIA",54,0)
 S MAGERR="",MAGGR=0,MAGGRC=1,MAGGWPC=0
"RTN","MAGGTIA",55,0)
 I ($D(MAGGZ)<10) S MAGRY="0^No input data, Operation CANCELED" Q
"RTN","MAGGTIA",56,0)
 ;
"RTN","MAGGTIA",57,0)
 S Z="" F  S Z=$O(MAGGZ(Z)) Q:Z=""  D  I $L(MAGERR) Q
"RTN","MAGGTIA",58,0)
 . S MAGGFLD=$P(MAGGZ(Z),U,1),MAGGDAT=$P(MAGGZ(Z),U,2,99)
"RTN","MAGGTIA",59,0)
 . I MAGGFLD=""!(MAGGDAT="") S MAGRY="0^Field and Value are Required" Q
"RTN","MAGGTIA",60,0)
 . I MAGGFLD=5 S MAGGDAT=+MAGGDAT ; MOD RED 10/5/95
"RTN","MAGGTIA",61,0)
 . I MAGGFLD=2005.04 S MAGGDAT=+MAGGDAT ; MOD RED 10/18/95
"RTN","MAGGTIA",62,0)
 . I MAGGFLD="IEN" S MAGMOD=+MAGGDAT Q
"RTN","MAGGTIA",63,0)
 . I MAGGFLD="EXT" S MAGGEXT=MAGGDAT Q
"RTN","MAGGTIA",64,0)
 . I MAGGFLD="ABS" S MAGGABS=MAGGDAT Q
"RTN","MAGGTIA",65,0)
 . I MAGGFLD="JB" S MAGGJB=MAGGDAT Q
"RTN","MAGGTIA",66,0)
 . I MAGGFLD="WRITE" S MAGWRITE=MAGGDAT Q
"RTN","MAGGTIA",67,0)
 . I MAGGFLD="BIG" S MAGBIG=MAGGDAT Q
"RTN","MAGGTIA",68,0)
 . I MAGGFLD="DICOMSN" S MAGDCMSN=MAGGDAT Q
"RTN","MAGGTIA",69,0)
 . I MAGGFLD="DICOMIN" S MAGDCMIN=MAGGDAT Q
"RTN","MAGGTIA",70,0)
 . ;
"RTN","MAGGTIA",71,0)
 . ; if this is a group object.
"RTN","MAGGTIA",72,0)
 . I MAGGFLD=2005.04 D  Q
"RTN","MAGGTIA",73,0)
 . . S MAGGR=1
"RTN","MAGGTIA",74,0)
 . . I '+MAGGDAT Q  ; making a group entry, with no group entries.
"RTN","MAGGTIA",75,0)
 . . S MAGGR(MAGGDAT)=""
"RTN","MAGGTIA",76,0)
 . . S MAGGRC=MAGGRC+1
"RTN","MAGGTIA",77,0)
 . . I '$D(^MAG(2005,MAGGDAT,0)) S MAGERR="0^Group Object "_MAGGDAT_" doesn't exist"
"RTN","MAGGTIA",78,0)
 . . S MAGGFDA(2005.04,"+"_MAGGRC_",+1,",.01)=MAGGDAT
"RTN","MAGGTIA",79,0)
 . ;
"RTN","MAGGTIA",80,0)
 . ; if we are getting a WP for Long Desc, set array to pass.
"RTN","MAGGTIA",81,0)
 . I MAGGFLD=11 D  ; this is a line of the WP Long Desc field.
"RTN","MAGGTIA",82,0)
 . . S MAGGWPC=MAGGWPC+1,MAGGWP(MAGGWPC)=MAGGDAT
"RTN","MAGGTIA",83,0)
 . ;
"RTN","MAGGTIA",84,0)
 . ;if a BAD field number
"RTN","MAGGTIA",85,0)
 . I '$$VFIELD^DILFD(2005,MAGGFLD) S MAGERR="0^Field Number "_MAGGFLD_" doesn't exist" Q
"RTN","MAGGTIA",86,0)
 . ;
"RTN","MAGGTIA",87,0)
 . ; Get Field Specifiers
"RTN","MAGGTIA",88,0)
 . D FIELD^DID(2005,MAGGFLD,"","LABEL;SPECIFIER","MAGFSPEC")
"RTN","MAGGTIA",89,0)
 . ; if a Date field, we'll convert it here.
"RTN","MAGGTIA",90,0)
 . I (MAGFSPEC("SPECIFIER")["D") D  Q:$L(MAGERR)
"RTN","MAGGTIA",91,0)
 . . S %DT="T",X=MAGGDAT D ^%DT
"RTN","MAGGTIA",92,0)
 . . I Y=-1 S MAGERR="0^Invalid Date: "_MAGGDAT_" Field: "_MAGFSPEC("LABEL") Q
"RTN","MAGGTIA",93,0)
 . . S MAGGDAT=Y
"RTN","MAGGTIA",94,0)
 . ;
"RTN","MAGGTIA",95,0)
 . ;  if a pointer field, we'll assure the pointed to entry exists.
"RTN","MAGGTIA",96,0)
 . I (MAGFSPEC("SPECIFIER")["P") D  Q:$L(MAGERR)
"RTN","MAGGTIA",97,0)
 . . I ($$EXTERNAL^DILFD(2005,MAGGFLD,"",MAGGDAT)="") S MAGERR="0^Invalid Value for Field "_MAGFSPEC("LABEL") Q
"RTN","MAGGTIA",98,0)
 . ;
"RTN","MAGGTIA",99,0)
 . I (MAGFSPEC("SPECIFIER")["S") D  Q:$L(MAGERR)
"RTN","MAGGTIA",100,0)
 . . D VAL^DIE(2005,"",MAGGFLD,"",MAGGDAT,.MAGRET,"","MAGETXT") I MAGRET="^" D  Q
"RTN","MAGGTIA",101,0)
 . . . S MAGERR="0^"_MAGETXT("DIERR",1,"TEXT",1)
"RTN","MAGGTIA",102,0)
 . . ;P48T1 This assures we are filing the Internal code for a set.
"RTN","MAGGTIA",103,0)
 . . S MAGGDAT=MAGRET
"RTN","MAGGTIA",104,0)
 . ;
"RTN","MAGGTIA",105,0)
 . ; made it here, so set the Node for the UPDATE^DIC Call.
"RTN","MAGGTIA",106,0)
 . S MAGGFDA(2005,"+1,",MAGGFLD)=MAGGDAT
"RTN","MAGGTIA",107,0)
 ;
"RTN","MAGGTIA",108,0)
 ; if there was an Error in data we'll quit now.
"RTN","MAGGTIA",109,0)
 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGTIA",110,0)
 I $D(MAGMOD) D
"RTN","MAGGTIA",111,0)
 . I $D(MAGGWP) S MAGGFDA(2005,"+1,",11)="MAGGWP"
"RTN","MAGGTIA",112,0)
 . S MAGMOD=MAGMOD_","
"RTN","MAGGTIA",113,0)
 . M MAGXXX(2005,MAGMOD)=MAGGFDA(2005,"+1,") K MAGGFDA
"RTN","MAGGTIA",114,0)
 . M MAGGFDA=MAGXXX K MAGXXX
"RTN","MAGGTIA",115,0)
 I $D(MAGMOD) D ADD^MAGGTIA1 Q
"RTN","MAGGTIA",116,0)
 ;
"RTN","MAGGTIA",117,0)
 ;  some possible problems, we'll check for now.
"RTN","MAGGTIA",118,0)
 I '$D(MAGGFDA(2005,"+1,")) S MAGRY="0^No data to file  Operation CANCELED " Q
"RTN","MAGGTIA",119,0)
 ;
"RTN","MAGGTIA",120,0)
 ; Patch 106: For VI Capture and DICOM Gateway the value of #8.1 is set
"RTN","MAGGTIA",121,0)
 ; here if it is not send. For Imort API see PRE^MAGGSIA1 
"RTN","MAGGTIA",122,0)
 I '$D(MAGGFDA(2005,"+1,",8.1)) D
"RTN","MAGGTIA",123,0)
 . ; PACS UID (#60); RADIOLOGY REPORT (#61); PACS PROCEDURE (#62)
"RTN","MAGGTIA",124,0)
 . I $D(MAGGFDA(2005,"+1,",60))!$D(MAGGFDA(2005,"+1,",61))!$D(MAGGFDA(2005,"+1,",62)) S MAGGFDA(2005,"+1,",8.1)="D" Q
"RTN","MAGGTIA",125,0)
 . I $D(MAGGFDA(2005,"+1,",108)) S MAGGFDA(2005,"+1,",8.1)="I" Q  ; TRACKING ID (#108)
"RTN","MAGGTIA",126,0)
 . S MAGGFDA(2005,"+1,",8.1)="C"
"RTN","MAGGTIA",127,0)
 . Q
"RTN","MAGGTIA",128,0)
 ;
"RTN","MAGGTIA",129,0)
 ;  We're making Object Type and either Patient, or short Desc Required.
"RTN","MAGGTIA",130,0)
 I '$D(MAGGFDA(2005,"+1,",3)) S MAGRY="0^Need an Object Type " Q
"RTN","MAGGTIA",131,0)
 ; Change to require patient. not patient or short desc.
"RTN","MAGGTIA",132,0)
 I '$D(MAGGFDA(2005,"+1,",5)) D  Q
"RTN","MAGGTIA",133,0)
 . S MAGRY="0^Need Patient.  Operation CANCELED "
"RTN","MAGGTIA",134,0)
 ; MAGQA check.
"RTN","MAGGTIA",135,0)
 D QACHK^MAGGTIA2(.MAGQY,MAGGFDA(2005,"+1,",5),$G(MAGGFDA(2005,"+1,",16)),$G(MAGGFDA(2005,"+1,",17)))
"RTN","MAGGTIA",136,0)
 I 'MAGQY S MAGRY=MAGQY Q
"RTN","MAGGTIA",137,0)
 ;-Checking for a missing TYPE value, and generating a value if needed
"RTN","MAGGTIA",138,0)
 ;- are being deferred to a later patch.
"RTN","MAGGTIA",139,0)
 ; Check for Image TYPE #42
"RTN","MAGGTIA",140,0)
 ;-I '$D(MAGGFDA(2005,"+1,",42)) D MAKETYPE^MAGGSIA1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGTIA",141,0)
 ; Check for Image Class, #41
"RTN","MAGGTIA",142,0)
 I '$D(MAGGFDA(2005,"+1,",41)) D MAKECLAS^MAGGSIU1 I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGTIA",143,0)
 ; IF no Procedure text we'll give it some so crossref will set.
"RTN","MAGGTIA",144,0)
 I '$D(MAGGFDA(2005,"+1,",6)) S MAGGFDA(2005,"+1,",6)="NO TEXT"
"RTN","MAGGTIA",145,0)
 ; If no Procedure/Exam Date/Time we'll give it NOW
"RTN","MAGGTIA",146,0)
 I '$D(MAGGFDA(2005,"+1,",15)) S MAGGFDA(2005,"+1,",15)=$$NOW^XLFDT
"RTN","MAGGTIA",147,0)
 ; DateTime image saved.
"RTN","MAGGTIA",148,0)
 I '$D(MAGGFDA(2005,"+1,",7)) S MAGGFDA(2005,"+1,",7)=$$NOW^XLFDT
"RTN","MAGGTIA",149,0)
 ; If no INSTITUTION pointer then default to the DUZ(2) or the Kernel Site parameter file institution
"RTN","MAGGTIA",150,0)
 I '$D(MAGGFDA(2005,"+1,",.05)) D
"RTN","MAGGTIA",151,0)
 . I $D(DUZ(2)) S MAGGFDA(2005,"+1,",.05)=DUZ(2) Q
"RTN","MAGGTIA",152,0)
 . ;Q:$T(KSP^XUPARAM)=""  //GEK 4/15/2004 Not needed on Gateway anymore
"RTN","MAGGTIA",153,0)
 . S MAGGFDA(2005,"+1,",.05)=$$KSP^XUPARAM("INST")
"RTN","MAGGTIA",154,0)
 . Q
"RTN","MAGGTIA",155,0)
 ;
"RTN","MAGGTIA",156,0)
 I '$D(MAGGFDA(2005,"+1,",10)) S MAGGFDA(2005,"+1,",10)=$$MAKENAME^MAGGTIA1()
"RTN","MAGGTIA",157,0)
 ; Only get drive:dir if not a group
"RTN","MAGGTIA",158,0)
 I 'MAGGR D  I $L(MAGERR) S MAGRY=MAGERR Q
"RTN","MAGGTIA",159,0)
 . S X=$S($D(MAGGFDA(2005,"+1,",2)):MAGGFDA(2005,"+1,",2),1:"")
"RTN","MAGGTIA",160,0)
 . S Z=$$DRIVE^MAGGTU1(X)                     ;Drv:Dir to Write
"RTN","MAGGTIA",161,0)
 . I 'Z S MAGERR=Z Q
"RTN","MAGGTIA",162,0)
 . S MAGGDRV=$P(Z,U,2)
"RTN","MAGGTIA",163,0)
 . S MAGGFDA(2005,"+1,",2)=+Z               ;Disk & Vol magnetic
"RTN","MAGGTIA",164,0)
 . ; if a big file is being made on workstation, put NetWork Location
"RTN","MAGGTIA",165,0)
 . ; pointer in the BIG NETWORK LOCATION field.
"RTN","MAGGTIA",166,0)
 . ; (BIG files default to same Network Location as FullRes (or PACS))
"RTN","MAGGTIA",167,0)
 . I ($P($G(MAGBIG),U,1))=1 D
"RTN","MAGGTIA",168,0)
 . . S MAGGFDA(2005,"+1,",102)=+Z
"RTN","MAGGTIA",169,0)
 . . S MAGGFDA(2005,"+1,",104)=$P(MAGBIG,U,2)
"RTN","MAGGTIA",170,0)
 . . Q
"RTN","MAGGTIA",171,0)
 . S MAGREF=+Z ; save network location ien for $$DIRHASH in ^MAGGTIA1
"RTN","MAGGTIA",172,0)
 . I $G(MAGGABS)="STUFFONLY" S MAGGFDA(2005,"+1,",2.1)=+Z
"RTN","MAGGTIA",173,0)
 ;
"RTN","MAGGTIA",174,0)
 ; If a Name (.01) wasn't sent, we'll make one
"RTN","MAGGTIA",175,0)
 ; We know that either Patient or Short Desc, and Object Type exist
"RTN","MAGGTIA",176,0)
 I '$D(MAGGFDA(2005,"+1,",.01)) S MAGGFDA(2005,"+1,",.01)=$$MAKENAME^MAGGTIA1()
"RTN","MAGGTIA",177,0)
 ;
"RTN","MAGGTIA",178,0)
 ; If a long description was sent.
"RTN","MAGGTIA",179,0)
 I $D(MAGGWP) S MAGGFDA(2005,"+1,",11)="MAGGWP"
"RTN","MAGGTIA",180,0)
 ;
"RTN","MAGGTIA",181,0)
 D ADD^MAGGTIA1 ; continued
"RTN","MAGGTIA",182,0)
 Q
"RTN","MAGGTU4C")
0^4^B5091959
"RTN","MAGGTU4C",1,0)
MAGGTU4C ;WOIFO/SG/NST - VERSION CONTROL (CLINICAL CAPTURE) ; 07 Feb 2011 4:48 PM
"RTN","MAGGTU4C",2,0)
 ;;3.0;IMAGING;**93,94,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGTU4C",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4C",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4C",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4C",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4C",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4C",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4C",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4C",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4C",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4C",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4C",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4C",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4C",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4C",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4C",17,0)
 ;;
"RTN","MAGGTU4C",18,0)
 ; This routine contains the version control code and data specific
"RTN","MAGGTU4C",19,0)
 ; to the Clinical Capture application. DO NOT ADD ANYTHING ELSE!
"RTN","MAGGTU4C",20,0)
 Q
"RTN","MAGGTU4C",21,0)
 ;
"RTN","MAGGTU4C",22,0)
CLVERCT ;***** VERSION CONTROL TABLE FOR THE CLINICAL CAPTURE CLIENTS
"RTN","MAGGTU4C",23,0)
 ;;==================================================================
"RTN","MAGGTU4C",24,0)
 ;;| Version |Build|Seq #|                Comment                   |
"RTN","MAGGTU4C",25,0)
 ;;|---------+-----+------------------------------------------------|
"RTN","MAGGTU4C",26,0)
 ;;| 3.0.106 |  13 |  36 | Feb 2011                                 |
"RTN","MAGGTU4C",27,0)
 ;;| 3.0.94  |  12 |  35 | May 2010                                 |
"RTN","MAGGTU4C",28,0)
 ;;| 3.0.93  |  15 |  30 | Dec 2009                                 |
"RTN","MAGGTU4C",29,0)
 ;;| 3.0.72  |  30 |  26 | Feb 2009                                 |
"RTN","MAGGTU4C",30,0)
 ;;==================================================================
"RTN","MAGGTU4C",31,0)
 ;
"RTN","MAGGTU4C",32,0)
 ; Each row of the version control table contains the version and
"RTN","MAGGTU4C",33,0)
 ; build number of a supported client. Released patches must also
"RTN","MAGGTU4C",34,0)
 ; indicate the sequential numbers.
"RTN","MAGGTU4C",35,0)
 ;
"RTN","MAGGTU4C",36,0)
 ; Sort order of the rows does not matter. However, the reversed
"RTN","MAGGTU4C",37,0)
 ; order of patch sequential numbers is recommended.
"RTN","MAGGTU4C",38,0)
 ;
"RTN","MAGGTU4C",39,0)
 Q
"RTN","MAGGTU4C",40,0)
 ;
"RTN","MAGGTU4C",41,0)
 ;***** ADDS A CLIENT-SPECIFIC WARNING (IF NECESSARY)
"RTN","MAGGTU4C",42,0)
 ;
"RTN","MAGGTU4C",43,0)
 ; .MAGBUF       Reference to a local array that the warning text
"RTN","MAGGTU4C",44,0)
 ;               is returned to. It is appended to the RPC result
"RTN","MAGGTU4C",45,0)
 ;               array by the caller (WARNING^MAGGTU41).
"RTN","MAGGTU4C",46,0)
 ;
"RTN","MAGGTU4C",47,0)
 ; CLVER         Client application version (Major.Minor.Patch.Build)
"RTN","MAGGTU4C",48,0)
 ;
"RTN","MAGGTU4C",49,0)
 ; CVRC          Version check code returned by the $$CHKVER1^MAGGTU41
"RTN","MAGGTU4C",50,0)
 ;
"RTN","MAGGTU4C",51,0)
 ; Notes
"RTN","MAGGTU4C",52,0)
 ; =====
"RTN","MAGGTU4C",53,0)
 ;
"RTN","MAGGTU4C",54,0)
 ; If the RPC result array already contains an error message that
"RTN","MAGGTU4C",55,0)
 ; will terminate the client, application, this procedure is not
"RTN","MAGGTU4C",56,0)
 ; called.
"RTN","MAGGTU4C",57,0)
 ;
"RTN","MAGGTU4C",58,0)
WARNING(MAGBUF,CLVER,CVRC) ;
"RTN","MAGGTU4C",59,0)
 Q
"RTN","MAGGTU4D")
0^5^B5097764
"RTN","MAGGTU4D",1,0)
MAGGTU4D ;WOIFO/SG/NST - VERSION CONTROL (CLINICAL DISPLAY) ; 07 Feb 2011 4:47 PM
"RTN","MAGGTU4D",2,0)
 ;;3.0;IMAGING;**93,94,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGTU4D",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4D",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4D",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4D",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4D",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4D",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4D",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4D",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4D",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4D",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4D",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4D",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4D",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4D",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4D",17,0)
 ;;
"RTN","MAGGTU4D",18,0)
 ; This routine contains the version control code and data specific
"RTN","MAGGTU4D",19,0)
 ; to the Clinical Display application. DO NOT ADD ANYTHING ELSE!
"RTN","MAGGTU4D",20,0)
 Q
"RTN","MAGGTU4D",21,0)
 ;
"RTN","MAGGTU4D",22,0)
CLVERCT ;***** VERSION CONTROL TABLE FOR THE CLINICAL DISPLAY CLIENTS
"RTN","MAGGTU4D",23,0)
 ;;==================================================================
"RTN","MAGGTU4D",24,0)
 ;;| Version |Build|Seq #|                Comment                   |
"RTN","MAGGTU4D",25,0)
 ;;|---------+-----+------------------------------------------------|
"RTN","MAGGTU4D",26,0)
 ;;| 3.0.106 |  13 |  36 | Feb 2011                                 |
"RTN","MAGGTU4D",27,0)
 ;;| 3.0.94  |  12 |  35 | May 2010                                 |
"RTN","MAGGTU4D",28,0)
 ;;| 3.0.93  |  15 |  30 | Dec 2009                                 |
"RTN","MAGGTU4D",29,0)
 ;;| 3.0.72  |  30 |  26 | Feb 2009                                 |
"RTN","MAGGTU4D",30,0)
 ;;==================================================================
"RTN","MAGGTU4D",31,0)
 ;
"RTN","MAGGTU4D",32,0)
 ; Each row of the version control table contains the version and
"RTN","MAGGTU4D",33,0)
 ; build number of a supported client. Released patches must also
"RTN","MAGGTU4D",34,0)
 ; indicate the sequential numbers.
"RTN","MAGGTU4D",35,0)
 ;
"RTN","MAGGTU4D",36,0)
 ; Sort order of the rows does not matter. However, the reversed
"RTN","MAGGTU4D",37,0)
 ; order of patch sequential numbers is recommended.
"RTN","MAGGTU4D",38,0)
 ;
"RTN","MAGGTU4D",39,0)
 Q
"RTN","MAGGTU4D",40,0)
 ;
"RTN","MAGGTU4D",41,0)
 ;***** ADDS A CLIENT-SPECIFIC WARNING (IF NECESSARY)
"RTN","MAGGTU4D",42,0)
 ;
"RTN","MAGGTU4D",43,0)
 ; .MAGBUF       Reference to a local array that the warning text
"RTN","MAGGTU4D",44,0)
 ;               is returned to. It is appended to the RPC result
"RTN","MAGGTU4D",45,0)
 ;               array by the caller (WARNING^MAGGTU41).
"RTN","MAGGTU4D",46,0)
 ;
"RTN","MAGGTU4D",47,0)
 ;               Text must be stored at nodes with positive numbers
"RTN","MAGGTU4D",48,0)
 ;               or at the 0-node descendent from those nodes.
"RTN","MAGGTU4D",49,0)
 ;
"RTN","MAGGTU4D",50,0)
 ; CLVER         Client application version (Major.Minor.Patch.Build)
"RTN","MAGGTU4D",51,0)
 ;
"RTN","MAGGTU4D",52,0)
 ; CVRC          Version check code returned by the $$CHKVER1^MAGGTU41
"RTN","MAGGTU4D",53,0)
 ;
"RTN","MAGGTU4D",54,0)
 ; Notes
"RTN","MAGGTU4D",55,0)
 ; =====
"RTN","MAGGTU4D",56,0)
 ;
"RTN","MAGGTU4D",57,0)
 ; If the RPC result array already contains an error message that
"RTN","MAGGTU4D",58,0)
 ; will terminate the client, application, this procedure is not
"RTN","MAGGTU4D",59,0)
 ; called.
"RTN","MAGGTU4D",60,0)
 ;
"RTN","MAGGTU4D",61,0)
WARNING(MAGBUF,CLVER,CVRC) ;
"RTN","MAGGTU4D",62,0)
 Q
"RTN","MAGGTU4L")
0^6^B5092040
"RTN","MAGGTU4L",1,0)
MAGGTU4L ;WOIFO/SG/NST - VERSION CONTROL (CLINICAL UTILITIES) ; 07 Feb 2011 4:47 PM
"RTN","MAGGTU4L",2,0)
 ;;3.0;IMAGING;**93,94,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGTU4L",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4L",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4L",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4L",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4L",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4L",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4L",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4L",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4L",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4L",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4L",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4L",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4L",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4L",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4L",17,0)
 ;;
"RTN","MAGGTU4L",18,0)
 ; This routine contains the version control code and data specific
"RTN","MAGGTU4L",19,0)
 ; to the Clinical Utilities application. DO NOT ADD ANYTHING ELSE!
"RTN","MAGGTU4L",20,0)
 Q
"RTN","MAGGTU4L",21,0)
 ;
"RTN","MAGGTU4L",22,0)
CLVERCT ;***** VERSION CONTROL TABLE FOR THE CLINICAL UTILITIES
"RTN","MAGGTU4L",23,0)
 ;;==================================================================
"RTN","MAGGTU4L",24,0)
 ;;| Version |Build|Seq #|                Comment                   |
"RTN","MAGGTU4L",25,0)
 ;;|---------+-----+------------------------------------------------|
"RTN","MAGGTU4L",26,0)
 ;;| 3.0.106 |  13 |  36 | Feb 2011                                 |
"RTN","MAGGTU4L",27,0)
 ;;| 3.0.94  |  12 |  35 | May 2010                                 |
"RTN","MAGGTU4L",28,0)
 ;;| 3.0.93  |  15 |  30 | Dec 2009                                 |
"RTN","MAGGTU4L",29,0)
 ;;| 3.0.72  |  30 |  26 | Feb 2009                                 |
"RTN","MAGGTU4L",30,0)
 ;;==================================================================
"RTN","MAGGTU4L",31,0)
 ;
"RTN","MAGGTU4L",32,0)
 ; Each row of the version control table contains the version and
"RTN","MAGGTU4L",33,0)
 ; build number of a supported client. Released patches must also
"RTN","MAGGTU4L",34,0)
 ; indicate the sequential numbers.
"RTN","MAGGTU4L",35,0)
 ;
"RTN","MAGGTU4L",36,0)
 ; Sort order of the rows does not matter. However, the reversed
"RTN","MAGGTU4L",37,0)
 ; order of patch sequential numbers is recommended.
"RTN","MAGGTU4L",38,0)
 ;
"RTN","MAGGTU4L",39,0)
 Q
"RTN","MAGGTU4L",40,0)
 ;
"RTN","MAGGTU4L",41,0)
 ;***** ADDS A CLIENT-SPECIFIC WARNING (IF NECESSARY)
"RTN","MAGGTU4L",42,0)
 ;
"RTN","MAGGTU4L",43,0)
 ; .MAGBUF       Reference to a local array that the warning text
"RTN","MAGGTU4L",44,0)
 ;               is returned to. It is appended to the RPC result
"RTN","MAGGTU4L",45,0)
 ;               array by the caller (WARNING^MAGGTU41).
"RTN","MAGGTU4L",46,0)
 ;
"RTN","MAGGTU4L",47,0)
 ; CLVER         Client application version (Major.Minor.Patch.Build)
"RTN","MAGGTU4L",48,0)
 ;
"RTN","MAGGTU4L",49,0)
 ; CVRC          Version check code returned by the $$CHKVER1^MAGGTU41
"RTN","MAGGTU4L",50,0)
 ;
"RTN","MAGGTU4L",51,0)
 ; Notes
"RTN","MAGGTU4L",52,0)
 ; =====
"RTN","MAGGTU4L",53,0)
 ;
"RTN","MAGGTU4L",54,0)
 ; If the RPC result array already contains an error message that
"RTN","MAGGTU4L",55,0)
 ; will terminate the client, application, this procedure is not
"RTN","MAGGTU4L",56,0)
 ; called.
"RTN","MAGGTU4L",57,0)
 ;
"RTN","MAGGTU4L",58,0)
WARNING(MAGBUF,CLVER,CVRC) ;
"RTN","MAGGTU4L",59,0)
 Q
"RTN","MAGGTU4T")
0^7^B5092112
"RTN","MAGGTU4T",1,0)
MAGGTU4T ;WOIFO/SG/NST - VERSION CONTROL (TELEREADER) ; 07 Feb 2011 4:47 PM
"RTN","MAGGTU4T",2,0)
 ;;3.0;IMAGING;**93,94,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGGTU4T",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4T",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4T",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4T",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4T",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4T",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4T",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4T",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4T",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4T",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4T",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4T",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4T",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4T",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4T",17,0)
 ;;
"RTN","MAGGTU4T",18,0)
 ; This routine contains the version control code and data specific
"RTN","MAGGTU4T",19,0)
 ; to the TeleReader application. DO NOT ADD ANYTHING ELSE!
"RTN","MAGGTU4T",20,0)
 Q
"RTN","MAGGTU4T",21,0)
 ;
"RTN","MAGGTU4T",22,0)
CLVERCT ;***** VERSION CONTROL TABLE FOR THE TELEREADER CLIENTS
"RTN","MAGGTU4T",23,0)
 ;;==================================================================
"RTN","MAGGTU4T",24,0)
 ;;| Version |Build|Seq #|                Comment                   |
"RTN","MAGGTU4T",25,0)
 ;;|---------+-----+------------------------------------------------|
"RTN","MAGGTU4T",26,0)
 ;;| 3.0.106 |  13 |  36 | Feb 2011                                 |
"RTN","MAGGTU4T",27,0)
 ;;| 3.0.94  |  12 |  35 | May 2010                                 |
"RTN","MAGGTU4T",28,0)
 ;;| 3.0.93  |  15 |  30 | Dec 2009                                 |
"RTN","MAGGTU4T",29,0)
 ;;| 3.0.72  |  30 |  26 | Feb 2009                                 |
"RTN","MAGGTU4T",30,0)
 ;;==================================================================
"RTN","MAGGTU4T",31,0)
 ;
"RTN","MAGGTU4T",32,0)
 ; Each row of the version control table contains the version and
"RTN","MAGGTU4T",33,0)
 ; build number of a supported client. Released patches must also
"RTN","MAGGTU4T",34,0)
 ; indicate the sequential numbers.
"RTN","MAGGTU4T",35,0)
 ;
"RTN","MAGGTU4T",36,0)
 ; Sort order of the rows does not matter. However, the reversed
"RTN","MAGGTU4T",37,0)
 ; order of patch sequential numbers is recommended.
"RTN","MAGGTU4T",38,0)
 ;
"RTN","MAGGTU4T",39,0)
 Q
"RTN","MAGGTU4T",40,0)
 ;
"RTN","MAGGTU4T",41,0)
 ;***** ADDS A CLIENT-SPECIFIC WARNING (IF NECESSARY)
"RTN","MAGGTU4T",42,0)
 ;
"RTN","MAGGTU4T",43,0)
 ; .MAGBUF       Reference to a local array that the warning text
"RTN","MAGGTU4T",44,0)
 ;               is returned to. It is appended to the RPC result
"RTN","MAGGTU4T",45,0)
 ;               array by the caller (WARNING^MAGGTU41).
"RTN","MAGGTU4T",46,0)
 ;
"RTN","MAGGTU4T",47,0)
 ; CLVER         Client application version (Major.Minor.Patch.Build)
"RTN","MAGGTU4T",48,0)
 ;
"RTN","MAGGTU4T",49,0)
 ; CVRC          Version check code returned by the $$CHKVER1^MAGGTU41
"RTN","MAGGTU4T",50,0)
 ;
"RTN","MAGGTU4T",51,0)
 ; Notes
"RTN","MAGGTU4T",52,0)
 ; =====
"RTN","MAGGTU4T",53,0)
 ;
"RTN","MAGGTU4T",54,0)
 ; If the RPC result array already contains an error message that
"RTN","MAGGTU4T",55,0)
 ; will terminate the client, application, this procedure is not
"RTN","MAGGTU4T",56,0)
 ; called.
"RTN","MAGGTU4T",57,0)
 ;
"RTN","MAGGTU4T",58,0)
WARNING(MAGBUF,CLVER,CVRC) ;
"RTN","MAGGTU4T",59,0)
 Q
"RTN","MAGIP106")
0^^B7756257
"RTN","MAGIP106",1,0)
MAGIP106  ;WOIFO/NST - INSTALL CODE FOR MAG*3.0*106 ; 08 Nov 2010 3:17 PM
"RTN","MAGIP106",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGIP106",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGIP106",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIP106",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGIP106",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGIP106",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGIP106",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGIP106",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGIP106",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGIP106",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGIP106",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGIP106",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGIP106",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGIP106",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGIP106",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIP106",17,0)
 ;;
"RTN","MAGIP106",18,0)
 ; There are no environment checks here but the MAGIP106 has to be
"RTN","MAGIP106",19,0)
 ; referenced by the "Environment Check Routine" field of the KIDS
"RTN","MAGIP106",20,0)
 ; build so that entry points of the routine are available to the
"RTN","MAGIP106",21,0)
 ; KIDS during all installation phases.
"RTN","MAGIP106",22,0)
 Q
"RTN","MAGIP106",23,0)
 ;
"RTN","MAGIP106",24,0)
 ;+++++ INSTALLATION ERROR HANDLING
"RTN","MAGIP106",25,0)
ERROR ;
"RTN","MAGIP106",26,0)
 S:$D(XPDNM) XPDABORT=1
"RTN","MAGIP106",27,0)
 ;--- Display the messages and store them to the INSTALL file
"RTN","MAGIP106",28,0)
 D DUMP^MAGUERR1(),ABTMSG^MAGKIDS()
"RTN","MAGIP106",29,0)
 Q
"RTN","MAGIP106",30,0)
 ;
"RTN","MAGIP106",31,0)
 ;***** POST-INSTALL CODE
"RTN","MAGIP106",32,0)
POS ;
"RTN","MAGIP106",33,0)
 N CALLBACK
"RTN","MAGIP106",34,0)
 D CLEAR^MAGUERR(1)
"RTN","MAGIP106",35,0)
 ;
"RTN","MAGIP106",36,0)
 ;--- Link new remote procedures to the Broker context option
"RTN","MAGIP106",37,0)
 S CALLBACK="$$ADDRPCS^"_$NA(MAGKIDS1("RPCLST^"_$T(+0),"MAG WINDOWS"))
"RTN","MAGIP106",38,0)
 I $$CP^MAGKIDS("MAG ATTACH RPCS",CALLBACK)<0  D ERROR  Q
"RTN","MAGIP106",39,0)
 ;
"RTN","MAGIP106",40,0)
 ;--- Restart the Imaging Utilization Report task
"RTN","MAGIP106",41,0)
 I $$CP^MAGKIDS("MAG REPORT TASK","$$RPTSKCP^"_$T(+0))<0  D ERROR  Q
"RTN","MAGIP106",42,0)
 ;
"RTN","MAGIP106",43,0)
  ;--- Misc Updates
"RTN","MAGIP106",44,0)
 I $$CP^MAGKIDS("MAG 106 MISC UPDATES ","$$UPD106^"_$T(+0))<0  D ERROR  Q
"RTN","MAGIP106",45,0)
 ;
"RTN","MAGIP106",46,0)
 ;--- Send the notification e-mail
"RTN","MAGIP106",47,0)
 I $$CP^MAGKIDS("MAG NOTIFICATION","$$NOTIFY^MAGKIDS1")<0  D ERROR  Q
"RTN","MAGIP106",48,0)
 Q
"RTN","MAGIP106",49,0)
 ;
"RTN","MAGIP106",50,0)
 ;***** PRE-INSTALL CODE
"RTN","MAGIP106",51,0)
PRE ;
"RTN","MAGIP106",52,0)
 ;---
"RTN","MAGIP106",53,0)
 Q
"RTN","MAGIP106",54,0)
 ;
"RTN","MAGIP106",55,0)
UPD106() ; Misc Updates
"RTN","MAGIP106",56,0)
 N MAGOUT,MAGERR
"RTN","MAGIP106",57,0)
 ; Delete "ACA" cross-reference
"RTN","MAGIP106",58,0)
 D DELIXN^DDMOD(2005,"ACA","","MAGOUT","MAGERR")
"RTN","MAGIP106",59,0)
 I $D(MAGERR("DIERR","E")) Q -1
"RTN","MAGIP106",60,0)
 D DELIXN^DDMOD(2005.1,"ACA","","MAGOUT","MAGERR")
"RTN","MAGIP106",61,0)
 I $D(MAGERR("DIERR","E")) Q -1
"RTN","MAGIP106",62,0)
 ;
"RTN","MAGIP106",63,0)
 Q 0
"RTN","MAGIP106",64,0)
 ;
"RTN","MAGIP106",65,0)
 ;+++++ LIST OF NEW REMOTE PROCEDURES
"RTN","MAGIP106",66,0)
RPCLST ;
"RTN","MAGIP106",67,0)
 ;;MAG3 DICOM CAPTURE GE LIST
"RTN","MAGIP106",68,0)
 ;;MAG3 TELEREADER CONSULT LIST
"RTN","MAGIP106",69,0)
 ;;MAG3 TELEREADER DICOM UID
"RTN","MAGIP106",70,0)
 ;;MAG3 TELEREADER READ/UNRD ADD
"RTN","MAGIP106",71,0)
 ;;MAG3 TR THIN CLIENT ALLOWED
"RTN","MAGIP106",72,0)
 ;;MAG3 DICOM CAPTURE SOP CLASS
"RTN","MAGIP106",73,0)
 ;;MAG3 TELEREADER DICOM SER NUM
"RTN","MAGIP106",74,0)
 Q 0
"RTN","MAGIP106",75,0)
 ;
"RTN","MAGIP106",76,0)
 ;+++++ RESTARTS THE IMAGING UTILIZATION REPORT TASK
"RTN","MAGIP106",77,0)
RPTSKCP() ;
"RTN","MAGIP106",78,0)
 D REMTASK^MAGQE4,STTASK^MAGQE4
"RTN","MAGIP106",79,0)
 Q 0
"RTN","MAGNDCMC")
0^8^B11551246
"RTN","MAGNDCMC",1,0)
MAGNDCMC ;WOIFO/NST - Imaging Capture DICOM utilities  ; 09 Oct 2010 3:52 AM
"RTN","MAGNDCMC",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGNDCMC",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGNDCMC",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNDCMC",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGNDCMC",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGNDCMC",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGNDCMC",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGNDCMC",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGNDCMC",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGNDCMC",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGNDCMC",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGNDCMC",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGNDCMC",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGNDCMC",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGNDCMC",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNDCMC",17,0)
 ;;
"RTN","MAGNDCMC",18,0)
 Q
"RTN","MAGNDCMC",19,0)
 ;
"RTN","MAGNDCMC",20,0)
 ;***** Returns all records in IMAGING DICOM FIELDS file (#2005.71)
"RTN","MAGNDCMC",21,0)
 ;      per SOP type  (e.g. "TELEDERM")
"RTN","MAGNDCMC",22,0)
 ; RPC: MAG3 DICOM CAPTURE GE LIST
"RTN","MAGNDCMC",23,0)
 ;
"RTN","MAGNDCMC",24,0)
 ; Input Parameters
"RTN","MAGNDCMC",25,0)
 ; ================
"RTN","MAGNDCMC",26,0)
 ;  MAGSOP = SOP type (e.g. "TELEDERM")
"RTN","MAGNDCMC",27,0)
 ;  
"RTN","MAGNDCMC",28,0)
 ; Return Values
"RTN","MAGNDCMC",29,0)
 ; =============
"RTN","MAGNDCMC",30,0)
 ; if error found during execution
"RTN","MAGNDCMC",31,0)
 ;   MAGRY(0) = "0^Error"
"RTN","MAGNDCMC",32,0)
 ; if success
"RTN","MAGNDCMC",33,0)
 ;   MAGRY(0)    = "1^#CNT" - where #CNT is a number of records returned
"RTN","MAGNDCMC",34,0)
 ;   MAGRY(1)    = "MODULE^ELEMENT^ELEMENT NAME^VALUE MULTIPLICITY^VALUE REPRESENTATION^GUI CONTROL"
"RTN","MAGNDCMC",35,0)
 ;   MAGRY(2..n) = "^" delimited string with values of fields listed in MAGRY(1) 
"RTN","MAGNDCMC",36,0)
 ;
"RTN","MAGNDCMC",37,0)
GGELIST(MAGRY,MAGSOP)  ;RPC [MAG3 DICOM CAPTURE GE LIST]
"RTN","MAGNDCMC",38,0)
 N OUT,OUT1,CNT,DA0,DA1,MODULE
"RTN","MAGNDCMC",39,0)
 N X,I,J,ERR,CNT
"RTN","MAGNDCMC",40,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERRA^MAGGTERR"
"RTN","MAGNDCMC",41,0)
 ;
"RTN","MAGNDCMC",42,0)
 S MAGRY(0)="0^Error"
"RTN","MAGNDCMC",43,0)
 S MAGRY(1)="MODULE^ELEMENT^ELEMENT NAME^VALUE MULTIPLICITY^VALUE REPRESENTATION^GUI CONTROL"
"RTN","MAGNDCMC",44,0)
 S CNT=1
"RTN","MAGNDCMC",45,0)
 S DA0=$$FIND1^DIC(2005.71,"","X",MAGSOP,"","","ERR") ; Find "SOP type" IEN
"RTN","MAGNDCMC",46,0)
 I DA0=0 S MAGRY(0)="1^"_(CNT-1) Q  ; nothing found
"RTN","MAGNDCMC",47,0)
 I $D(ERR) Q  ; Error
"RTN","MAGNDCMC",48,0)
 D LIST^DIC(2005.712,","_DA0_",",";@;.01","P","*","","","#","","","OUT","OUT") ; Get all modules 
"RTN","MAGNDCMC",49,0)
 S I=0
"RTN","MAGNDCMC",50,0)
 F  S I=$O(OUT("DILIST",I)) Q:I=""  D
"RTN","MAGNDCMC",51,0)
 . S X=OUT("DILIST",I,0)
"RTN","MAGNDCMC",52,0)
 . S DA1=$P(X,"^",1),MODULE=$P(X,"^",2) D
"RTN","MAGNDCMC",53,0)
 . K OUT1
"RTN","MAGNDCMC",54,0)
 . D LIST^DIC(2005.713,","_DA1_","_DA0_",",";@;.01;2;3;4;5I","P","*","","","#","","","OUT1","OUT1") ; Get all elements 
"RTN","MAGNDCMC",55,0)
 . S J=0
"RTN","MAGNDCMC",56,0)
 . F  S J=$O(OUT1("DILIST",J)) Q:J=""  D
"RTN","MAGNDCMC",57,0)
 . . S X=OUT1("DILIST",J,0)
"RTN","MAGNDCMC",58,0)
 . . S CNT=CNT+1
"RTN","MAGNDCMC",59,0)
 . . S MAGRY(CNT)=MODULE_"^"_$P(X,"^",2,6)
"RTN","MAGNDCMC",60,0)
 . . Q
"RTN","MAGNDCMC",61,0)
 . Q
"RTN","MAGNDCMC",62,0)
 S MAGRY(0)="1^"_(CNT-1)
"RTN","MAGNDCMC",63,0)
 Q
"RTN","MAGNDCMC",64,0)
 ;
"RTN","MAGNDCMC",65,0)
 ;***** Returns SOP CLASS UID per SOP type  (e.g. "TELEDERM")
"RTN","MAGNDCMC",66,0)
 ;
"RTN","MAGNDCMC",67,0)
 ; RPC: MAG3 DICOM CAPTURE SOP CLASS
"RTN","MAGNDCMC",68,0)
 ;
"RTN","MAGNDCMC",69,0)
 ; Input Parameters
"RTN","MAGNDCMC",70,0)
 ; ================
"RTN","MAGNDCMC",71,0)
 ;  MAGSOP = SOP type (e.g. "TELEDERM")
"RTN","MAGNDCMC",72,0)
 ;  
"RTN","MAGNDCMC",73,0)
 ; Return Values
"RTN","MAGNDCMC",74,0)
 ; =============
"RTN","MAGNDCMC",75,0)
 ; If error found during execution
"RTN","MAGNDCMC",76,0)
 ;   MAGRY(0) = "0^Error Message"
"RTN","MAGNDCMC",77,0)
 ; If success
"RTN","MAGNDCMC",78,0)
 ;   MAGRY(0)    = "1^IEN^SOP CLASS UID
"RTN","MAGNDCMC",79,0)
 ;     where IEN is the IEN of the SOP CLASS UID in DICOM SOP CLASS file (#2006.532)
"RTN","MAGNDCMC",80,0)
 ;
"RTN","MAGNDCMC",81,0)
GSOPCLAS(MAGRY,MAGSOP)  ;RPC [MAG3 DICOM CAPTURE SOP CLASS]
"RTN","MAGNDCMC",82,0)
 N IEN,SOPCLASS
"RTN","MAGNDCMC",83,0)
 I MAGSOP="TELEDERM" D  Q
"RTN","MAGNDCMC",84,0)
 . ; SOP CLASS should come from IMAGING DICOM FIELDS file (#2005.71)
"RTN","MAGNDCMC",85,0)
 . ; SOP CLASS field should be added to (#2005.71)
"RTN","MAGNDCMC",86,0)
 . S SOPCLASS="1.2.840.10008.5.1.4.1.1.77.1.4"   ; VL Photographic Image Storage
"RTN","MAGNDCMC",87,0)
 . S IEN=$$FIND1^DIC(2006.532,"","BX",SOPCLASS)
"RTN","MAGNDCMC",88,0)
 . I IEN'>0 S MAGRY="0^Error getting SOP CLASS UID IEN" Q
"RTN","MAGNDCMC",89,0)
 . S MAGRY="1^"_IEN_"^"_SOPCLASS
"RTN","MAGNDCMC",90,0)
 . Q
"RTN","MAGNDCMC",91,0)
 S MAGRY="0^Error SOP type is not found"
"RTN","MAGNDCMC",92,0)
 Q
"RTN","MAGNGMR")
0^9^B70338961
"RTN","MAGNGMR",1,0)
MAGNGMR ;WOIFO/NST - Imaging interface to Consult RPC Calls etc. ; 11 Feb 2011 8:36 AM
"RTN","MAGNGMR",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGNGMR",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGNGMR",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNGMR",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGNGMR",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGNGMR",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGNGMR",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGNGMR",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGNGMR",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGNGMR",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGNGMR",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGNGMR",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGNGMR",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGNGMR",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGNGMR",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNGMR",17,0)
 ;;
"RTN","MAGNGMR",18,0)
 Q
"RTN","MAGNGMR",19,0)
 ;
"RTN","MAGNGMR",20,0)
 ;*****  Add a consult and image pointers to 
"RTN","MAGNGMR",21,0)
 ;       Unread/Read List file (#2006.5849)
"RTN","MAGNGMR",22,0)
 ;       and 
"RTN","MAGNGMR",23,0)
 ;       DICOM GMRC TEMP LIST file (#2006.5839)
"RTN","MAGNGMR",24,0)
 ;       
"RTN","MAGNGMR",25,0)
 ; RPC:MAG3 TELEREADER READ/UNRD ADD
"RTN","MAGNGMR",26,0)
 ; 
"RTN","MAGNGMR",27,0)
 ; Input Parameters
"RTN","MAGNGMR",28,0)
 ; ================
"RTN","MAGNGMR",29,0)
 ;   MAGDA is an image IEN in IMAGE file (#2005) - ^MAG(2005,MAGDA)
"RTN","MAGNGMR",30,0)
 ;   MAGCNT is count of new images captured
"RTN","MAGNGMR",31,0)
 ;   MAGRIEN is a request/consult IEN in REQUEST/CONSULTATION file (#123)
"RTN","MAGNGMR",32,0)
 ;
"RTN","MAGNGMR",33,0)
 ; Return Values
"RTN","MAGNGMR",34,0)
 ; =============
"RTN","MAGNGMR",35,0)
 ; if error MAGRY = The first "^" piece is zero if error occurs. The second piece is an error message
"RTN","MAGNGMR",36,0)
 ; if success MAGRY = The first "^" piece is one and the second is update message
"RTN","MAGNGMR",37,0)
 ;                              
"RTN","MAGNGMR",38,0)
FILE(MAGRY,MAGDA,MAGCNT,MAGRIEN) ;RPC [MAG3 TELEREADER READ/UNRD ADD]
"RTN","MAGNGMR",39,0)
 ; 
"RTN","MAGNGMR",40,0)
 ; The routine is called from GUI after the group is captured
"RTN","MAGNGMR",41,0)
 N D0,X,MAGI
"RTN","MAGNGMR",42,0)
 N MAGNFDA,MAGNIEN,MAGNXE,MAGRESA
"RTN","MAGNGMR",43,0)
 N RESULT,MAGFND,MAGGRP
"RTN","MAGNGMR",44,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERR^MAGGTERR"
"RTN","MAGNGMR",45,0)
 ;
"RTN","MAGNGMR",46,0)
 S MAGRY="0^Filing Image Pointer Failed"
"RTN","MAGNGMR",47,0)
 ;
"RTN","MAGNGMR",48,0)
 ; Get a Group IEN
"RTN","MAGNGMR",49,0)
 S MAGGRP=$$GRPIEN^MAGGI12(MAGDA)
"RTN","MAGNGMR",50,0)
 I MAGGRP<0 S MAGRY="0^Error getting Group IEN" Q  ; Error getting Group IEN
"RTN","MAGNGMR",51,0)
 I MAGGRP=0 S MAGGRP=MAGDA ; Single Image or the group IEN itself
"RTN","MAGNGMR",52,0)
 ;
"RTN","MAGNGMR",53,0)
 ; add the consult to the Consult Unread List, if necessary
"RTN","MAGNGMR",54,0)
 D ADD^MAGDTR03(.RESULT,MAGRIEN,"I",MAGCNT) ; add if "ON IMAGE" is set
"RTN","MAGNGMR",55,0)
 ;
"RTN","MAGNGMR",56,0)
 I 'RESULT S MAGRY="1^Skipped filing image pointer" Q  ; Do not add it to file #2006.5839 
"RTN","MAGNGMR",57,0)
 ;
"RTN","MAGNGMR",58,0)
 S MAGI="",MAGFND=0
"RTN","MAGNGMR",59,0)
 F  S MAGI=$O(^MAG(2006.5839,"C",123,MAGRIEN,MAGI)) Q:'MAGI  D  Q:MAGFND
"RTN","MAGNGMR",60,0)
 . S:MAGGRP=$P(^MAG(2006.5839,MAGI,0),"^",3) MAGFND=1
"RTN","MAGNGMR",61,0)
 . Q
"RTN","MAGNGMR",62,0)
 ;
"RTN","MAGNGMR",63,0)
 I MAGFND S MAGRY="1^Image pointer filed previously" Q  ; No need to add it to file #2006.5839  
"RTN","MAGNGMR",64,0)
 ;
"RTN","MAGNGMR",65,0)
 ; Update DICOM GMRC TEMP LIST counters
"RTN","MAGNGMR",66,0)
 ;
"RTN","MAGNGMR",67,0)
 S MAGNFDA(2006.5839,"+1,",.01)=123     ; REQUEST/CONSULTATION file (#123) 
"RTN","MAGNGMR",68,0)
 S MAGNFDA(2006.5839,"+1,",2)=MAGRIEN   ; IEN in file #123
"RTN","MAGNGMR",69,0)
 S MAGNFDA(2006.5839,"+1,",3)=MAGGRP    ; IEN in IMAGE file (#2005)
"RTN","MAGNGMR",70,0)
 D UPDATE^DIE("S","MAGNFDA","MAGNIEN","MAGNXE")
"RTN","MAGNGMR",71,0)
 I $D(MAGNXE("DIERR","E")) D  Q
"RTN","MAGNGMR",72,0)
 . D MSG^DIALOG("A",.MAGRESA,245,5,"MAGNXE")
"RTN","MAGNGMR",73,0)
 . S MAGRY="0^"_MAGRESA(1)
"RTN","MAGNGMR",74,0)
 . Q
"RTN","MAGNGMR",75,0)
 ;
"RTN","MAGNGMR",76,0)
 ; Set the Parent fields in the Image File for the group
"RTN","MAGNGMR",77,0)
 S $P(^MAG(2005,MAGGRP,2),U,6,8)=2006.5839_U_MAGRIEN_U_""
"RTN","MAGNGMR",78,0)
 ; Save the PARENT ASSOCIATION Date/Time 
"RTN","MAGNGMR",79,0)
 D LINKDT^MAGGTU6(.X,MAGGRP)
"RTN","MAGNGMR",80,0)
 ;
"RTN","MAGNGMR",81,0)
 ; Set Parent fields for the children
"RTN","MAGNGMR",82,0)
 S MAGI=0
"RTN","MAGNGMR",83,0)
 F  S MAGI=$O(^MAG(2005,MAGGRP,1,MAGI)) Q:'MAGI  D
"RTN","MAGNGMR",84,0)
 . S D0=$P($G(^MAG(2005,MAGGRP,1,MAGI,0)),U,1)  ; Get IEN of the child
"RTN","MAGNGMR",85,0)
 . Q:'D0  ; IEN is missing
"RTN","MAGNGMR",86,0)
 . S $P(^MAG(2005,D0,2),U,6,8)=2006.5839_U_MAGRIEN_U_""
"RTN","MAGNGMR",87,0)
 . D LINKDT^MAGGTU6(.X,D0)
"RTN","MAGNGMR",88,0)
 . Q
"RTN","MAGNGMR",89,0)
 ;
"RTN","MAGNGMR",90,0)
 ; DONE.
"RTN","MAGNGMR",91,0)
 S MAGRY="1^Image pointer filed successfully"
"RTN","MAGNGMR",92,0)
 Q
"RTN","MAGNGMR",93,0)
 ;
"RTN","MAGNGMR",94,0)
 ;***** Return not completed consults for a patient where
"RTN","MAGNGMR",95,0)
 ;      consult request "To Service" is setup in TELEREADER ACQUISITION SERVICE file (#2006.5841)
"RTN","MAGNGMR",96,0)
 ; RPC: MAG3 TELEREADER CONSULT LIST
"RTN","MAGNGMR",97,0)
 ;
"RTN","MAGNGMR",98,0)
 ; Input Parameters
"RTN","MAGNGMR",99,0)
 ; ================
"RTN","MAGNGMR",100,0)
 ; DFN - Patient ID
"RTN","MAGNGMR",101,0)
 ;  
"RTN","MAGNGMR",102,0)
 ; Return Values
"RTN","MAGNGMR",103,0)
 ; =============
"RTN","MAGNGMR",104,0)
 ; if error found during execution
"RTN","MAGNGMR",105,0)
 ;   MAGRY(0) = "0^Error getting consult list"
"RTN","MAGNGMR",106,0)
 ; if success
"RTN","MAGNGMR",107,0)
 ;   MAGRY(0)    = "1^#CNT" - where #CNT is a number of records returned
"RTN","MAGNGMR",108,0)
 ;   MAGRY(1)    = "Consult ID^Consult Request Date^Service^Procedure^Sending Provider^Status"
"RTN","MAGNGMR",109,0)
 ;   MAGRY(2..n) = "^" delimited string with values of the fields listed in MAGRY(1) 
"RTN","MAGNGMR",110,0)
 ;
"RTN","MAGNGMR",111,0)
CONSLIST(MAGRY,DFN) ;RPC [MAG3 TELEREADER CONSULT LIST]
"RTN","MAGNGMR",112,0)
 ;
"RTN","MAGNGMR",113,0)
 N I,SRVC,PROC,STAT,DAT,X,CNT
"RTN","MAGNGMR",114,0)
 N RES
"RTN","MAGNGMR",115,0)
 N CONIEN,IENS,OUT,DOCNAME
"RTN","MAGNGMR",116,0)
 N EXCLCONS
"RTN","MAGNGMR",117,0)
 ;
"RTN","MAGNGMR",118,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERRA^MAGGTERR"
"RTN","MAGNGMR",119,0)
 ;
"RTN","MAGNGMR",120,0)
 ; Exclude consult with statuses
"RTN","MAGNGMR",121,0)
 S EXCLCONS("DISCONTINUED")=""
"RTN","MAGNGMR",122,0)
 S EXCLCONS("COMPLETE")=""
"RTN","MAGNGMR",123,0)
 S EXCLCONS("HOLD")=""
"RTN","MAGNGMR",124,0)
 S EXCLCONS("FLAGGED")=""
"RTN","MAGNGMR",125,0)
 S EXCLCONS("EXPIRED")=""
"RTN","MAGNGMR",126,0)
 S EXCLCONS("DELAYED")=""
"RTN","MAGNGMR",127,0)
 S EXCLCONS("UNRELEASED")=""
"RTN","MAGNGMR",128,0)
 S EXCLCONS("DISCONTINUED/EDIT")=""
"RTN","MAGNGMR",129,0)
 S EXCLCONS("CANCELLED")=""
"RTN","MAGNGMR",130,0)
 S EXCLCONS("LAPSED")=""
"RTN","MAGNGMR",131,0)
 ;
"RTN","MAGNGMR",132,0)
 K MAGRY
"RTN","MAGNGMR",133,0)
 S MAGRY(0)="0^Error"
"RTN","MAGNGMR",134,0)
 ;
"RTN","MAGNGMR",135,0)
 I +DFN'>0 S MAGRY(0)="0^Not a valid Patient ID" Q  ; no patient number provided
"RTN","MAGNGMR",136,0)
 ;
"RTN","MAGNGMR",137,0)
 K ^TMP("GMRCR",$J,"CS")  ; clean up the temp list before the consult call
"RTN","MAGNGMR",138,0)
 D OER^GMRCSLM1(DFN,"","","","",1) ; IA #2740
"RTN","MAGNGMR",139,0)
 S CNT=1
"RTN","MAGNGMR",140,0)
 S I=0
"RTN","MAGNGMR",141,0)
 F  S I=$O(^TMP("GMRCR",$J,"CS",I)) Q:+I'>0  D
"RTN","MAGNGMR",142,0)
 . S X=$G(^TMP("GMRCR",$J,"CS",I,0))
"RTN","MAGNGMR",143,0)
 . S CONIEN=$P(X,U,1)  ; consult IEN
"RTN","MAGNGMR",144,0)
 . Q:CONIEN'>0  ; Quit if no consult found
"RTN","MAGNGMR",145,0)
 . Q:'$$FINDLIST^MAGDTR01(CONIEN)  ; skip the Consult/Procedure - the TO Service is not in TELEREADER ACQUISITION SERVICE file (#2006.5841)
"RTN","MAGNGMR",146,0)
 . S STAT=$P(X,U,3)    ; consult status
"RTN","MAGNGMR",147,0)
 . Q:STAT=""
"RTN","MAGNGMR",148,0)
 . Q:$D(EXCLCONS(STAT))  ; skip consults with status in EXCLCONS array 
"RTN","MAGNGMR",149,0)
 . S SRVC=$P(X,U,4)    ; REQUEST SERVICES
"RTN","MAGNGMR",150,0)
 . S DAT=$P(X,U,2)     ; date of consult
"RTN","MAGNGMR",151,0)
 . S PROC=$S($P(X,U,5)="Consult":"",1:$P(X,U,5))    ; procedure 
"RTN","MAGNGMR",152,0)
 . S IENS=CONIEN_","
"RTN","MAGNGMR",153,0)
 . K OUT
"RTN","MAGNGMR",154,0)
 . D GETS^DIQ(123,IENS,10,"","OUT") ; Get SENDING PROVIDER for a consult
"RTN","MAGNGMR",155,0)
 . S DOCNAME=$G(OUT(123,IENS,10)) ; requested physician name
"RTN","MAGNGMR",156,0)
 . S CNT=CNT+1
"RTN","MAGNGMR",157,0)
 . S MAGRY(CNT)=CONIEN_U_DAT_U_SRVC_U_PROC_U_DOCNAME_U_STAT
"RTN","MAGNGMR",158,0)
 . Q
"RTN","MAGNGMR",159,0)
 K ^TMP("GMRCR",$J,"CS")  ; clean up the temp list from the consult call
"RTN","MAGNGMR",160,0)
 S MAGRY(0)="1^"_(CNT-1)
"RTN","MAGNGMR",161,0)
 S MAGRY(1)="Consult ID^Consult Request Date^Service^Procedure^Sending Provider^Status"
"RTN","MAGNGMR",162,0)
 K RES
"RTN","MAGNGMR",163,0)
 Q
"RTN","MAGNGMR",164,0)
 ;
"RTN","MAGNGMR",165,0)
 ;***** Returns a new TELEREADER DICOM Study, Series or SOP Instance UID
"RTN","MAGNGMR",166,0)
 ;
"RTN","MAGNGMR",167,0)
 ; RPC: MAG3 TELEREADER DICOM UID
"RTN","MAGNGMR",168,0)
 ;
"RTN","MAGNGMR",169,0)
 ; Input Parameters
"RTN","MAGNGMR",170,0)
 ; ================
"RTN","MAGNGMR",171,0)
 ; MAGPARAM - array with input values
"RTN","MAGNGMR",172,0)
 ;            MAGPARAM("TYPE")= Type UID - "STUDY", "SERIES", "SOP"
"RTN","MAGNGMR",173,0)
 ;            MAGPARAM("ACNUM")= Accession number - Patient consult ID 
"RTN","MAGNGMR",174,0)
 ;            MAGPARAM("DFN")= Patient DFN
"RTN","MAGNGMR",175,0)
 ;            
"RTN","MAGNGMR",176,0)
 ; Return Values
"RTN","MAGNGMR",177,0)
 ; =============
"RTN","MAGNGMR",178,0)
 ; if error found during execution
"RTN","MAGNGMR",179,0)
 ;   MAGRY = "0^Error message"
"RTN","MAGNGMR",180,0)
 ; if success
"RTN","MAGNGMR",181,0)
 ;   MAGRY    = "1^UID
"RTN","MAGNGMR",182,0)
 ;
"RTN","MAGNGMR",183,0)
 ;
"RTN","MAGNGMR",184,0)
GETUID(MAGRY,MAGPARAM) ; RPC [MAG3 TELEREADER DICOM UID] 
"RTN","MAGNGMR",185,0)
 N UID,SITE,SITEIEN
"RTN","MAGNGMR",186,0)
 N MAGTYPE,MAGACNUM,MAGDFN
"RTN","MAGNGMR",187,0)
 N RESULT,TYPENUM
"RTN","MAGNGMR",188,0)
 N ERR,DONE
"RTN","MAGNGMR",189,0)
 ;
"RTN","MAGNGMR",190,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERR^MAGGTERR"
"RTN","MAGNGMR",191,0)
 ;
"RTN","MAGNGMR",192,0)
 S MAGTYPE=$G(MAGPARAM("TYPE"))
"RTN","MAGNGMR",193,0)
 S MAGACNUM=$G(MAGPARAM("ACNUM"))
"RTN","MAGNGMR",194,0)
 S MAGDFN=$G(MAGPARAM("DFN"))
"RTN","MAGNGMR",195,0)
 S MAGRY="0^Error creating UID"
"RTN","MAGNGMR",196,0)
 ;
"RTN","MAGNGMR",197,0)
 I (MAGTYPE'="STUDY"),(MAGTYPE'="SERIES"),(MAGTYPE'="SOP") S MAGRY="0^Unknow TYPE parameter:"_MAGTYPE Q
"RTN","MAGNGMR",198,0)
 S TYPENUM=$S(MAGTYPE="STUDY":"106.4",MAGTYPE="SERIES":"106.7",1:"106.8")
"RTN","MAGNGMR",199,0)
 ;
"RTN","MAGNGMR",200,0)
 ; Get the Study UID for the consult if one already exists
"RTN","MAGNGMR",201,0)
 S RESULT=""
"RTN","MAGNGMR",202,0)
 I MAGTYPE="STUDY" D  I RESULT'="" S MAGRY="1^"_RESULT Q 
"RTN","MAGNGMR",203,0)
 . Q:(MAGACNUM="")!(MAGDFN="")  ; Generate a new Study UID. Accession number or DFN is not provided
"RTN","MAGNGMR",204,0)
 . S RESULT=$$GSTUID^MAGNGMR(MAGACNUM,MAGDFN)
"RTN","MAGNGMR",205,0)
 . Q
"RTN","MAGNGMR",206,0)
 ;
"RTN","MAGNGMR",207,0)
 S SITEIEN=$G(DUZ(2))
"RTN","MAGNGMR",208,0)
 S:SITEIEN="" SITEIEN=$$KSP^XUPARAM("INST") ; IA #2541 Get Default Station IEN
"RTN","MAGNGMR",209,0)
 S SITE=$P($$NS^XUAF4(SITEIEN),U,2) ; IA #2171  Get Station Number
"RTN","MAGNGMR",210,0)
 ; Generate a new UID and check for dupes
"RTN","MAGNGMR",211,0)
 S (ERR,DONE)=0
"RTN","MAGNGMR",212,0)
 F  D  Q:ERR!DONE
"RTN","MAGNGMR",213,0)
 . D NEWUID^MAGNUID1(.MAGRY,SITE,TYPENUM,"")  ; Get a new UID
"RTN","MAGNGMR",214,0)
 . I 'MAGRY S ERR=1 Q  ; Error during UID generation
"RTN","MAGNGMR",215,0)
 . S UID=$P(MAGRY,"^",2)  ; Set the UID
"RTN","MAGNGMR",216,0)
 . ; Check for Dupes
"RTN","MAGNGMR",217,0)
 . I $$ISDUP^MAGNUID2(MAGTYPE,UID) Q  ; generate a new one
"RTN","MAGNGMR",218,0)
 . S DONE=1
"RTN","MAGNGMR",219,0)
 . Q
"RTN","MAGNGMR",220,0)
 Q  ; MAGRY is set when a new UID is generated
"RTN","MAGNGMR",221,0)
 ;
"RTN","MAGNGMR",222,0)
 ;+++++ Returns Study UID for accession number
"RTN","MAGNGMR",223,0)
 ;
"RTN","MAGNGMR",224,0)
 ; ACCNUM - Consult/Procedure Accession number
"RTN","MAGNGMR",225,0)
 ; DFN - Patient ID
"RTN","MAGNGMR",226,0)
 ;
"RTN","MAGNGMR",227,0)
GSTUID(ACCNUM,DFN) ; Check if a study UID exist for accession number (ACCNUM) and patient (DFN)
"RTN","MAGNGMR",228,0)
 ; Study UID is stored in image group level in IMAGE file (#2005)
"RTN","MAGNGMR",229,0)
 N RESULT
"RTN","MAGNGMR",230,0)
 N MAGIEN  ; IEN in DICOM GMRC TEMP LIST file (#2006.5839)
"RTN","MAGNGMR",231,0)
 N MAGDA,MAGGRP
"RTN","MAGNGMR",232,0)
 ; Get the image IEN in IMAGE file (#2005)
"RTN","MAGNGMR",233,0)
 S MAGIEN=$O(^MAG(2006.5839,"C",123,ACCNUM,""))  ; Get IEN for the consult in file #2006.5839
"RTN","MAGNGMR",234,0)
 I MAGIEN="" Q ""   ; Cannot find Study UID
"RTN","MAGNGMR",235,0)
 S MAGGRP=$P(^MAG(2006.5839,MAGIEN,0),U,3) ; IEN in IMAGE file (#2005)
"RTN","MAGNGMR",236,0)
 I '$$ISGRP^MAGGI11(MAGGRP) D
"RTN","MAGNGMR",237,0)
 . S MAGGRP=$$GRPIEN^MAGGI12(MAGGRP) ; Get the group IEN
"RTN","MAGNGMR",238,0)
 . Q
"RTN","MAGNGMR",239,0)
 I MAGGRP'>0 Q "" ; It is not a group. Cannot get Study UID from a single image
"RTN","MAGNGMR",240,0)
 I $P(^MAG(2005,MAGGRP,0),U,7)'=DFN Q ""  ; the patient of the group is not the same. Quit blank
"RTN","MAGNGMR",241,0)
 S RESULT=$P(^MAG(2005,MAGGRP,"PACS"),U,1)  ; Get Study UID
"RTN","MAGNGMR",242,0)
 Q RESULT
"RTN","MAGNGMR",243,0)
 ;
"RTN","MAGNGMR",244,0)
 ;***** Generates DICOM Series Number
"RTN","MAGNGMR",245,0)
 ;
"RTN","MAGNGMR",246,0)
 ; RPC: MAG3 TELEREADER DICOM SER NUM
"RTN","MAGNGMR",247,0)
 ;
"RTN","MAGNGMR",248,0)
 ; Input Parameters
"RTN","MAGNGMR",249,0)
 ; ================
"RTN","MAGNGMR",250,0)
 ; N/A
"RTN","MAGNGMR",251,0)
 ;
"RTN","MAGNGMR",252,0)
 ; Return Values
"RTN","MAGNGMR",253,0)
 ; =============
"RTN","MAGNGMR",254,0)
 ; if error found during execution
"RTN","MAGNGMR",255,0)
 ;   MAGRY = "0^Error message"
"RTN","MAGNGMR",256,0)
 ; if success
"RTN","MAGNGMR",257,0)
 ;   MAGRY = "1^DICOM Series Number
"RTN","MAGNGMR",258,0)
 ;
"RTN","MAGNGMR",259,0)
 ;
"RTN","MAGNGMR",260,0)
GETSRNUM(MAGRY) ; RPC [MAG3 TELEREADER DICOM SER NUM]  
"RTN","MAGNGMR",261,0)
 N H,M,S,TIME,DATE,DH,X
"RTN","MAGNGMR",262,0)
 S MAGRY="0^Error creating Series Number"
"RTN","MAGNGMR",263,0)
 ; can't use D NOW^XLFDT to set DH because it is incorrect at midnight
"RTN","MAGNGMR",264,0)
 S DH=$H
"RTN","MAGNGMR",265,0)
 S DATE=$$HTFM^XLFDT(DH,1)+17000000
"RTN","MAGNGMR",266,0)
 S DATE=$E(DATE,5,8) ; Strip the year. Just get MMDD because of size limitation in DICOM standard
"RTN","MAGNGMR",267,0)
 S X=$P(DH,",",2)
"RTN","MAGNGMR",268,0)
 S H=X\3600,M=X\60#60,S=X#60
"RTN","MAGNGMR",269,0)
 S TIME=H*100+M*100+S
"RTN","MAGNGMR",270,0)
 S TIME=$E("000000",1,6-$L(TIME))_TIME ; Pad the time
"RTN","MAGNGMR",271,0)
 S MAGRY="1^"_DATE_TIME
"RTN","MAGNGMR",272,0)
 Q
"RTN","MAGNTLR3")
0^10^B4232767
"RTN","MAGNTLR3",1,0)
MAGNTLR3 ;WOIFO/NST - TeleReader Configuration  ; 24 Aug 2010 2:39 PM
"RTN","MAGNTLR3",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGNTLR3",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGNTLR3",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNTLR3",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGNTLR3",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGNTLR3",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGNTLR3",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGNTLR3",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGNTLR3",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGNTLR3",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGNTLR3",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGNTLR3",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGNTLR3",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGNTLR3",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGNTLR3",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNTLR3",17,0)
 ;;
"RTN","MAGNTLR3",18,0)
 Q
"RTN","MAGNTLR3",19,0)
 ;
"RTN","MAGNTLR3",20,0)
 ;***** Check for thin client settings by User (DUZ)
"RTN","MAGNTLR3",21,0)
 ; RPC: MAG3 TR THIN CLIENT ALLOWED 
"RTN","MAGNTLR3",22,0)
 ;
"RTN","MAGNTLR3",23,0)
 ; Return Values
"RTN","MAGNTLR3",24,0)
 ; =============
"RTN","MAGNTLR3",25,0)
 ; if error MAGRY = first "^" piece is zero if error occurs
"RTN","MAGNTLR3",26,0)
 ; if success MAGRY = "1^0|1" - 0 - not allowed; 1 - allowed
"RTN","MAGNTLR3",27,0)
 ;                              
"RTN","MAGNTLR3",28,0)
TCALLOW(MAGRY) ; RPC [MAG3 TR THIN CLIENT ALLOWED]
"RTN","MAGNTLR3",29,0)
 ; USR^SRV^DIV^SYS
"RTN","MAGNTLR3",30,0)
 N SRV,RESULT
"RTN","MAGNTLR3",31,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERR^MAGGTERR"
"RTN","MAGNTLR3",32,0)
 ;
"RTN","MAGNTLR3",33,0)
 S MAGRY=0
"RTN","MAGNTLR3",34,0)
 S SRV=$$GET1^DIQ(200,DUZ,29,"I") ; Get service
"RTN","MAGNTLR3",35,0)
 S RESULT=+$$GET^XPAR("USR^SRV.`"_SRV_"^DIV^SYS","MAG TR ALLOW THIN CLIENT",,"I") ; IA# 2263
"RTN","MAGNTLR3",36,0)
 S MAGRY=1_"^"_RESULT
"RTN","MAGNTLR3",37,0)
 Q
"RTN","MAGNUID1")
0^11^B17116046
"RTN","MAGNUID1",1,0)
MAGNUID1 ;WOIFO/NST - DICOM UID generator ; 15 Oct 2010 12:45 AM
"RTN","MAGNUID1",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGNUID1",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGNUID1",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNUID1",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGNUID1",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGNUID1",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGNUID1",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGNUID1",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGNUID1",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGNUID1",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGNUID1",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGNUID1",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGNUID1",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGNUID1",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGNUID1",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNUID1",17,0)
 ;;
"RTN","MAGNUID1",18,0)
 Q
"RTN","MAGNUID1",19,0)
 ;
"RTN","MAGNUID1",20,0)
 ;*****  Generates a new DICOM UID
"RTN","MAGNUID1",21,0)
 ;       
"RTN","MAGNUID1",22,0)
 ; RPC: N/A
"RTN","MAGNUID1",23,0)
 ; 
"RTN","MAGNUID1",24,0)
 ; Input Parameters
"RTN","MAGNUID1",25,0)
 ; ================
"RTN","MAGNUID1",26,0)
 ;   SITE      -            VistA Station Number field #99 in INSTITUTION file (#4)
"RTN","MAGNUID1",27,0)
 ;   SUBROOT   - (Optional) A number, Default value is 0.
"RTN","MAGNUID1",28,0)
 ;                            (e.g. 106, 4, 7, 8, or 106.4 
"RTN","MAGNUID1",29,0)
 ;                              4 - STUDY UID,
"RTN","MAGNUID1",30,0)
 ;                              7 - SERIES UID,
"RTN","MAGNUID1",31,0)
 ;                              8 - SOP INSTANCE UID,
"RTN","MAGNUID1",32,0)
 ;                          106.4 - patch 106 STUDY UID.          
"RTN","MAGNUID1",33,0)
 ;   ROOTOWNER - (Optional) Name of the DICOM root owner.
"RTN","MAGNUID1",34,0)
 ;                          Default value is "Veterans' Administration".
"RTN","MAGNUID1",35,0)
 ;
"RTN","MAGNUID1",36,0)
 ; Return Values
"RTN","MAGNUID1",37,0)
 ; =============
"RTN","MAGNUID1",38,0)
 ; if error MAGRY = 0^Error message
"RTN","MAGNUID1",39,0)
 ; if success MAGRY = 1^New DICOM UID
"RTN","MAGNUID1",40,0)
 ;                              
"RTN","MAGNUID1",41,0)
NEWUID(MAGRY,SITE,SUBROOT,ROOTOWNER) ; Generates a new DICOM UID
"RTN","MAGNUID1",42,0)
 N ROOT,DTSTAMP,UNISITE,LASTCNT,CNT
"RTN","MAGNUID1",43,0)
 N ROOTIEN,UID,LASTUPDATE,X
"RTN","MAGNUID1",44,0)
 N MAGRESA,MAGNFDA,MAGNXE
"RTN","MAGNUID1",45,0)
 ;
"RTN","MAGNUID1",46,0)
 I SITE="" S MAGRY="0^Station number is blank" Q  ; fatal error
"RTN","MAGNUID1",47,0)
 S:$G(SUBROOT)="" SUBROOT=0
"RTN","MAGNUID1",48,0)
 S:$G(ROOTOWNER)="" ROOTOWNER="Veterans' Administration" ; VA is a default root owner 
"RTN","MAGNUID1",49,0)
 S ROOTIEN=$$FIND1^DIC(2006.15,"","BX",ROOTOWNER)
"RTN","MAGNUID1",50,0)
 I ROOTIEN'>0 S MAGRY="0^Root UID is not found" Q  ; fatal error
"RTN","MAGNUID1",51,0)
 ;
"RTN","MAGNUID1",52,0)
 S ROOT=$P($G(^MAGD(2006.15,ROOTIEN,"UID ROOT")),"^",1)
"RTN","MAGNUID1",53,0)
 I ROOT="" S MAGRY="0^DICOM root is missing." Q
"RTN","MAGNUID1",54,0)
 S DTSTAMP=$$DATETIME()
"RTN","MAGNUID1",55,0)
 S UNISITE=$$CONVS2N(SITE)
"RTN","MAGNUID1",56,0)
 I UNISITE'>0 S MAGRY="0^Cannot convert SITE NUMBER to numeric value" Q
"RTN","MAGNUID1",57,0)
 L +^MAGD(2006.15,ROOTIEN,1):1E9 ; Lock
"RTN","MAGNUID1",58,0)
 S X=$G(^MAGD(2006.15,ROOTIEN,1))
"RTN","MAGNUID1",59,0)
 S LASTUPDATE=$P(X,"^",1)
"RTN","MAGNUID1",60,0)
 S LASTCNT=$P(X,"^",2)
"RTN","MAGNUID1",61,0)
 ;
"RTN","MAGNUID1",62,0)
 S CNT=LASTCNT+1 ; Increment the TICK
"RTN","MAGNUID1",63,0)
 I (LASTUPDATE\1)'=(DTSTAMP\1) S CNT=1  ; Reset the TICK. New day - new beginning
"RTN","MAGNUID1",64,0)
 ;
"RTN","MAGNUID1",65,0)
 I (LASTUPDATE=DTSTAMP),(LASTCNT'<CNT) D  Q
"RTN","MAGNUID1",66,0)
 . S MAGRY="0^Last UID tick is greater than the new one"
"RTN","MAGNUID1",67,0)
 . L -^MAGD(2006.15,ROOTIEN,1) ; Unlock
"RTN","MAGNUID1",68,0)
 . Q
"RTN","MAGNUID1",69,0)
 I LASTUPDATE>DTSTAMP D  Q
"RTN","MAGNUID1",70,0)
 . S MAGRY="0^Last UID datetime stamp is greater than the new one"
"RTN","MAGNUID1",71,0)
 . L -^MAGD(2006.15,ROOTIEN,1) ; Unlock
"RTN","MAGNUID1",72,0)
 . Q
"RTN","MAGNUID1",73,0)
 ;
"RTN","MAGNUID1",74,0)
 K MAGNFDA
"RTN","MAGNUID1",75,0)
 S MAGNFDA(2006.15,ROOTIEN_",",2)=DTSTAMP
"RTN","MAGNUID1",76,0)
 S MAGNFDA(2006.15,ROOTIEN_",",3)=CNT
"RTN","MAGNUID1",77,0)
 D UPDATE^DIE("","MAGNFDA","","MAGNXE")
"RTN","MAGNUID1",78,0)
 L -^MAGD(2006.15,ROOTIEN,1) ; Unlock
"RTN","MAGNUID1",79,0)
 ;
"RTN","MAGNUID1",80,0)
 I $D(MAGNXE("DIERR","E")) D  Q
"RTN","MAGNUID1",81,0)
 . D MSG^DIALOG("A",.MAGRESA,245,5,"MAGNXE")
"RTN","MAGNUID1",82,0)
 . S MAGRY="0^"_MAGRESA(1)
"RTN","MAGNUID1",83,0)
 . Q
"RTN","MAGNUID1",84,0)
 ;
"RTN","MAGNUID1",85,0)
 S UID=ROOT_"."_SUBROOT_"."_UNISITE_"."_DTSTAMP_"."_CNT
"RTN","MAGNUID1",86,0)
 I $L(UID)>64 S MAGRY="0^Generated UID is greater than 64 characters" Q
"RTN","MAGNUID1",87,0)
 S MAGRY="1^"_UID
"RTN","MAGNUID1",88,0)
 Q
"RTN","MAGNUID1",89,0)
 ;
"RTN","MAGNUID1",90,0)
DATETIME() ; Get Date time
"RTN","MAGNUID1",91,0)
 Q $$NOW^XLFDT
"RTN","MAGNUID1",92,0)
 ;
"RTN","MAGNUID1",93,0)
CONVS2N(STRTOCNV) ; Convert a string to a unique number
"RTN","MAGNUID1",94,0)
 ; The string should include characters from "0" to "Z"
"RTN","MAGNUID1",95,0)
 ; If other character is found -1 will be return
"RTN","MAGNUID1",96,0)
 ; Before the conversion all characters are converted to upper case
"RTN","MAGNUID1",97,0)
 N I,X,RESULT,FACTOR,ERR
"RTN","MAGNUID1",98,0)
 S ERR=0
"RTN","MAGNUID1",99,0)
 S RESULT=""
"RTN","MAGNUID1",100,0)
 S FACTOR=1
"RTN","MAGNUID1",101,0)
 S STRTOCNV=$$UP^XLFSTR(STRTOCNV) ; All upper case
"RTN","MAGNUID1",102,0)
 ; Start with the last character
"RTN","MAGNUID1",103,0)
 F I=$L(STRTOCNV):-1:1 D  Q:ERR
"RTN","MAGNUID1",104,0)
 . S X=$A($E(STRTOCNV,I))-48  ; offset the ASCII number with 48. "0" is 0, "Z" is 42
"RTN","MAGNUID1",105,0)
 . I (X<0)!(X>42) S ERR=1 Q
"RTN","MAGNUID1",106,0)
 . S RESULT=RESULT+(FACTOR*X)
"RTN","MAGNUID1",107,0)
 . S FACTOR=FACTOR*43         ; 43 is the number of characters between "0" and "Z"
"RTN","MAGNUID1",108,0)
 . Q
"RTN","MAGNUID1",109,0)
 Q:ERR -1  ; a character is not in the "0"-"Z" range
"RTN","MAGNUID1",110,0)
 Q RESULT
"RTN","MAGNUID2")
0^12^B4027276
"RTN","MAGNUID2",1,0)
MAGNUID2 ;WOIFO/NST - Checks for duplicates UIDs ; 11 Oct 2010 3:42 AM
"RTN","MAGNUID2",2,0)
 ;;3.0;IMAGING;**106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGNUID2",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGNUID2",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNUID2",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGNUID2",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGNUID2",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGNUID2",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGNUID2",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGNUID2",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGNUID2",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGNUID2",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGNUID2",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGNUID2",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGNUID2",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGNUID2",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGNUID2",17,0)
 ;;
"RTN","MAGNUID2",18,0)
 Q
"RTN","MAGNUID2",19,0)
 ;
"RTN","MAGNUID2",20,0)
 ;*****  Check for duplicate DICOM UIDs
"RTN","MAGNUID2",21,0)
 ;       in IMAGE file (#2005)
"RTN","MAGNUID2",22,0)
 ;       
"RTN","MAGNUID2",23,0)
 ; RPC: N/A
"RTN","MAGNUID2",24,0)
 ; 
"RTN","MAGNUID2",25,0)
 ; Input Parameters
"RTN","MAGNUID2",26,0)
 ; ================
"RTN","MAGNUID2",27,0)
 ;   MAGTYPE = Type UID - "STUDY", "SERIES", "SOP"
"RTN","MAGNUID2",28,0)
 ;   UID     = DICOM UID
"RTN","MAGNUID2",29,0)
 ;
"RTN","MAGNUID2",30,0)
 ; Return Values
"RTN","MAGNUID2",31,0)
 ; =============
"RTN","MAGNUID2",32,0)
 ; If no duplicate UID found returns 0
"RTN","MAGNUID2",33,0)
 ; If duplicate found returns 1
"RTN","MAGNUID2",34,0)
 ;                              
"RTN","MAGNUID2",35,0)
ISDUP(MAGTYPE,UID) ;
"RTN","MAGNUID2",36,0)
 I UID="" Q 0
"RTN","MAGNUID2",37,0)
 I MAGTYPE="STUDY" Q:'$D(^MAG(2005,"P",UID)) 0 Q 1
"RTN","MAGNUID2",38,0)
 I MAGTYPE="SERIES" Q:'$D(^MAG(2005,"SERIESUID",UID)) 0 Q 1
"RTN","MAGNUID2",39,0)
 I MAGTYPE="SOP" Q:'$D(^MAG(2005,"P",UID)) 0 Q 1
"RTN","MAGNUID2",40,0)
 Q 0  ; nothing to check
"RTN","MAGUXRF")
0^13^B31728772
"RTN","MAGUXRF",1,0)
MAGUXRF ;WOIFO/SRR/SG/NST - Imaging MUMPS cross-references ; 29 Oct 2010 2:23 PM
"RTN","MAGUXRF",2,0)
 ;;3.0;IMAGING;**51,93,106**;Mar 19, 2002;Build 2002;Feb 28, 2011
"RTN","MAGUXRF",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGUXRF",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGUXRF",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGUXRF",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGUXRF",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGUXRF",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGUXRF",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGUXRF",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGUXRF",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGUXRF",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGUXRF",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGUXRF",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGUXRF",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGUXRF",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGUXRF",17,0)
 ;;
"RTN","MAGUXRF",18,0)
SETACT D AC(1) Q
"RTN","MAGUXRF",19,0)
KILLACT D AC(0) Q
"RTN","MAGUXRF",20,0)
 ;
"RTN","MAGUXRF",21,0)
AC(SETKIL) N ACTION,ROUTINE,TYPE
"RTN","MAGUXRF",22,0)
 ; "AC" Cross Reference for OBJECT TYPE - ACTION subfile
"RTN","MAGUXRF",23,0)
 ;  ^MAG(2005.02,"AC",OBJECT TYPE,ACTION)=OBJECT TYPE^ACTION ROUTINE
"RTN","MAGUXRF",24,0)
 S TYPE=$P(^MAG(2005.02,DA(1),0),"^",1)
"RTN","MAGUXRF",25,0)
 S ACTION=^MAG(2005.02,DA(1),1,DA,0)
"RTN","MAGUXRF",26,0)
 S ROUTINE=$P(ACTION,".",2),ACTION=$P(ACTION,".",1)
"RTN","MAGUXRF",27,0)
 S:SETKIL ^MAG(2005.02,"AC",TYPE,ACTION)=TYPE_"^"_ROUTINE
"RTN","MAGUXRF",28,0)
 K:'SETKIL ^MAG(2005.02,"AC",TYPE,ACTION)
"RTN","MAGUXRF",29,0)
 K MAGACT1,MAGMETH,MAG
"RTN","MAGUXRF",30,0)
 Q
"RTN","MAGUXRF",31,0)
 ;
"RTN","MAGUXRF",32,0)
SETPX ; Set PACS switch on; check fields first
"RTN","MAGUXRF",33,0)
 ; Write checks
"RTN","MAGUXRF",34,0)
 S ^MAG(2006.1,"APACS")=1
"RTN","MAGUXRF",35,0)
 Q
"RTN","MAGUXRF",36,0)
 ;
"RTN","MAGUXRF",37,0)
KILPX ; Stop PACS system
"RTN","MAGUXRF",38,0)
 K ^MAG(2006.1,"APACS")
"RTN","MAGUXRF",39,0)
 Q
"RTN","MAGUXRF",40,0)
 ;
"RTN","MAGUXRF",41,0)
SETPDPX ; Set P(atient) D(ate) PX(procedure)
"RTN","MAGUXRF",42,0)
 D SET Q:PDT=""  Q:DFN=""
"RTN","MAGUXRF",43,0)
 S ^MAG(2005,"APDPX",DFN,PDT,PX,DA)=""
"RTN","MAGUXRF",44,0)
 Q
"RTN","MAGUXRF",45,0)
 ;
"RTN","MAGUXRF",46,0)
SET S X0=^MAG(2005,DA,0),X2=$G(^(2))
"RTN","MAGUXRF",47,0)
 S PDT=$P(X2,U,5) I PDT="" S PDT=$P(X2,U) Q:PDT=""
"RTN","MAGUXRF",48,0)
 S DFN=$P(X0,U,7) Q:DFN=""
"RTN","MAGUXRF",49,0)
 ;
"RTN","MAGUXRF",50,0)
4 S PX=$P(X0,U,8) I PX="" S PX="OTHER"
"RTN","MAGUXRF",51,0)
 Q
"RTN","MAGUXRF",52,0)
 ;
"RTN","MAGUXRF",53,0)
KILPDPX ; Kill
"RTN","MAGUXRF",54,0)
 D SET Q:PDT=""  Q:DFN=""
"RTN","MAGUXRF",55,0)
 K ^MAG(2005,"APDPX",DFN,PDT,PX,DA)
"RTN","MAGUXRF",56,0)
 Q
"RTN","MAGUXRF",57,0)
 ;
"RTN","MAGUXRF",58,0)
SETPPXD ; #5:Set (patient=X=DFN); #6:PX(procedure); #15:DT(procedure date/time)
"RTN","MAGUXRF",59,0)
 ; Xref for patient field#5=Patient name (in form of DFN)
"RTN","MAGUXRF",60,0)
 ; ^MAG(2005,"APPXDT",X,PX,reverseDT)=""
"RTN","MAGUXRF",61,0)
 N CDT,RDT,PX,ER
"RTN","MAGUXRF",62,0)
 D SETUP Q:$D(ER)
"RTN","MAGUXRF",63,0)
 S ^MAG(2005,"APPXDT",X,PX,RDT,DA)=""
"RTN","MAGUXRF",64,0)
 S ^MAG(2005,"APDTPX",X,RDT,PX,DA)=""
"RTN","MAGUXRF",65,0)
 Q
"RTN","MAGUXRF",66,0)
 ;
"RTN","MAGUXRF",67,0)
SETUP ; Set up for patient Xref's-for field #5l
"RTN","MAGUXRF",68,0)
 S PX=$P(^MAG(2005,DA,0),U,8),CDT=$P($G(^(2)),U,5)
"RTN","MAGUXRF",69,0)
 I CDT="" S ER=1 Q
"RTN","MAGUXRF",70,0)
 I PX="" S ER=1 Q
"RTN","MAGUXRF",71,0)
 S RDT=9999999.9999-CDT
"RTN","MAGUXRF",72,0)
 Q
"RTN","MAGUXRF",73,0)
 ;
"RTN","MAGUXRF",74,0)
KILPPXD ;#5:KILL (PATIENT=X=DFN); #6:PX(PROCEDURE); #15:DT(PROCEDURE DATE/TIME)
"RTN","MAGUXRF",75,0)
 N CDT,PX,RDT,ER
"RTN","MAGUXRF",76,0)
 D SETUP Q:$D(ER)
"RTN","MAGUXRF",77,0)
 K ^MAG(2005,"APPXDT",X,PX,RDT,DA)
"RTN","MAGUXRF",78,0)
 K ^MAG(2005,"APDTPX",X,RDT,PX,DA)
"RTN","MAGUXRF",79,0)
 Q
"RTN","MAGUXRF",80,0)
 ;
"RTN","MAGUXRF",81,0)
SETPPXD6 ;#5:SET (PATIENT=X=DFN); #6:PX(PROCEDURE); #15:DT(PROCEDURE DATE/TIME)
"RTN","MAGUXRF",82,0)
 ;XREF FOR PROCEDURE,FIELD#6
"RTN","MAGUXRF",83,0)
 N DFN,CDT,RDT,ER
"RTN","MAGUXRF",84,0)
 D SETUP6 Q:$D(ER)
"RTN","MAGUXRF",85,0)
 S ^MAG(2005,"APPXDT",DFN,X,RDT,DA)=""
"RTN","MAGUXRF",86,0)
 S ^MAG(2005,"APDTPX",DFN,RDT,X,DA)=""
"RTN","MAGUXRF",87,0)
 Q
"RTN","MAGUXRF",88,0)
 ;
"RTN","MAGUXRF",89,0)
SETUP6 ; Set up for procedure xref-field#6
"RTN","MAGUXRF",90,0)
 S DFN=$P(^MAG(2005,DA,0),U,7),CDT=$P($G(^(2)),U,5)
"RTN","MAGUXRF",91,0)
 I CDT="" S ER=1 Q
"RTN","MAGUXRF",92,0)
 I DFN="" S ER=1 Q
"RTN","MAGUXRF",93,0)
 S RDT=9999999.9999-CDT
"RTN","MAGUXRF",94,0)
 Q
"RTN","MAGUXRF",95,0)
 ;
"RTN","MAGUXRF",96,0)
KILPPXD6 ;#5:KILL (PATIENT=X=DFN); #6:PX(PROCEDURE); #15:DT(PROCEDURE DATE/TIME)
"RTN","MAGUXRF",97,0)
 N DFN,CDT,RDT,ER
"RTN","MAGUXRF",98,0)
 D SETUP6 Q:$D(ER)
"RTN","MAGUXRF",99,0)
 K ^MAG(2005,"APPXDT",DFN,X,RDT,DA)
"RTN","MAGUXRF",100,0)
 K ^MAG(2005,"APDTPX",DFN,RDT,X,DA)
"RTN","MAGUXRF",101,0)
 Q
"RTN","MAGUXRF",102,0)
 ;
"RTN","MAGUXRF",103,0)
SETPPXD5 ;#5:SET (PATIENT=X=DFN); #6:PX(PROCEDURE); #15:DT(PROCEDURE DATE/TIME)
"RTN","MAGUXRF",104,0)
 ;XREF FOR FIELD#15
"RTN","MAGUXRF",105,0)
 ;^MAG(2005,"APPXDT",DFN,PX,reverseDT)=""
"RTN","MAGUXRF",106,0)
 N DFN,PX,RDT,ER
"RTN","MAGUXRF",107,0)
 D SETUP5 Q:$D(ER)
"RTN","MAGUXRF",108,0)
 S ^MAG(2005,"APPXDT",DFN,PX,RDT,DA)=""
"RTN","MAGUXRF",109,0)
 S ^MAG(2005,"APDTPX",DFN,RDT,PX,DA)=""
"RTN","MAGUXRF",110,0)
 Q
"RTN","MAGUXRF",111,0)
 ;
"RTN","MAGUXRF",112,0)
SETUP5 ; Set up for date/time procedure field #15
"RTN","MAGUXRF",113,0)
 S DFN=$P(^MAG(2005,DA,0),U,7),PX=$P(^(0),U,8)
"RTN","MAGUXRF",114,0)
 I PX="" S ER=1 Q
"RTN","MAGUXRF",115,0)
 I DFN="" S ER=1 Q
"RTN","MAGUXRF",116,0)
 S RDT=9999999.9999-X
"RTN","MAGUXRF",117,0)
 Q
"RTN","MAGUXRF",118,0)
 ;
"RTN","MAGUXRF",119,0)
KILPPXD5 ;#5:SET (PATIENT=X=DFN); #6:PX(PROCEDURE); #15:DT(PROCEDURE DATE/TIME)
"RTN","MAGUXRF",120,0)
 N DFN,CDT,ER
"RTN","MAGUXRF",121,0)
 D SETUP5 Q:$D(ER)
"RTN","MAGUXRF",122,0)
 K ^MAG(2005,"APPXDT",DFN,PX,RDT,DA)
"RTN","MAGUXRF",123,0)
 K ^MAG(2005,"APDTPX",DFN,RDT,PX,DA)
"RTN","MAGUXRF",124,0)
 Q
"RTN","MAGUXRF",125,0)
 ;
"RTN","MAGUXRF",126,0)
SETDCM ; Set the cross reference for DICOM SERIES NUM
"RTN","MAGUXRF",127,0)
 ; and DICOM IMAGE NUM fields of the OBJECT GROUP Multiple
"RTN","MAGUXRF",128,0)
 N MAGDSN,MAGDIN
"RTN","MAGUXRF",129,0)
 I '$$BOTHNUM(.MAGDSN,.MAGDIN) Q
"RTN","MAGUXRF",130,0)
 S Z=+^MAG(2005,DA(1),1,DA,0)
"RTN","MAGUXRF",131,0)
 S ^MAG(2005,DA(1),1,"ADCM",MAGDSN,MAGDIN,Z,DA)=""
"RTN","MAGUXRF",132,0)
 Q
"RTN","MAGUXRF",133,0)
 ;
"RTN","MAGUXRF",134,0)
KILLDSN ; Kill the cross reference for DICOM SERIES NUM
"RTN","MAGUXRF",135,0)
 N MAGDSN,MAGDIN
"RTN","MAGUXRF",136,0)
 I '$$BOTHNUM(.MAGDSN,.MAGDIN) Q
"RTN","MAGUXRF",137,0)
 S Z=+^MAG(2005,DA(1),1,DA,0)
"RTN","MAGUXRF",138,0)
 K ^MAG(2005,DA(1),1,"ADCM",X,MAGDIN,Z,DA)
"RTN","MAGUXRF",139,0)
 Q
"RTN","MAGUXRF",140,0)
 ;
"RTN","MAGUXRF",141,0)
KILLDIN ; Kill the DICOM IMAGE NUM cross reference
"RTN","MAGUXRF",142,0)
 ; of the OBJECT GROUP Multiple
"RTN","MAGUXRF",143,0)
 N MAGDSN,MAGDIN
"RTN","MAGUXRF",144,0)
 I '$$BOTHNUM(.MAGDSN,.MAGDIN) Q
"RTN","MAGUXRF",145,0)
 S Z=+^MAG(2005,DA(1),1,DA,0)
"RTN","MAGUXRF",146,0)
 K ^MAG(2005,DA(1),1,"ADCM",MAGDSN,X,Z,DA)
"RTN","MAGUXRF",147,0)
 Q
"RTN","MAGUXRF",148,0)
 ;
"RTN","MAGUXRF",149,0)
BOTHNUM(MAGDSN,MAGDIN) ;
"RTN","MAGUXRF",150,0)
 S MAGDSN=$P($G(^MAG(2005,DA(1),1,DA,0)),U,2)
"RTN","MAGUXRF",151,0)
 S MAGDIN=$P($G(^MAG(2005,DA(1),1,DA,0)),U,3)
"RTN","MAGUXRF",152,0)
 ;GEK 4/4/00
"RTN","MAGUXRF",153,0)
 ; Changed to test for "", not to test I 'DINUM (0 would fail)
"RTN","MAGUXRF",154,0)
 I ((MAGDIN="")!(MAGDSN="")) Q 0
"RTN","MAGUXRF",155,0)
 Q 1
"RTN","MAGUXRF",156,0)
 ;
"RTN","MAGUXRF",157,0)
 ;***** SAVES OLD FIELD VALUES TO THE AUDIT MULTIPLE
"RTN","MAGUXRF",158,0)
 ;
"RTN","MAGUXRF",159,0)
 ; FILE          Number of the file that audited fields belong to.
"RTN","MAGUXRF",160,0)
 ;
"RTN","MAGUXRF",161,0)
 ; IENS          Standard IENS of the record that has been updated.
"RTN","MAGUXRF",162,0)
 ;
"RTN","MAGUXRF",163,0)
 ; FLDLST        Numbers of audited fields separated by semicolons.
"RTN","MAGUXRF",164,0)
 ;               Positions of field numbers should match subscripts
"RTN","MAGUXRF",165,0)
 ;               (order numbers) in the X1 and X2 arrays.
"RTN","MAGUXRF",166,0)
 ;
"RTN","MAGUXRF",167,0)
 ; SUBFILE       Subfile number of the audit multiple of the file
"RTN","MAGUXRF",168,0)
 ;               defined by the FILE parameter (e.g. 99 for the
"RTN","MAGUXRF",169,0)
 ;               IMAGE file (#2005)).
"RTN","MAGUXRF",170,0)
 ;
"RTN","MAGUXRF",171,0)
 ; .X1           Reference to a local array that stores old values
"RTN","MAGUXRF",172,0)
 ;               of audited fields. Subscripts of this array are
"RTN","MAGUXRF",173,0)
 ;               order numbers of fields included in the audit
"RTN","MAGUXRF",174,0)
 ;               index/action definition.
"RTN","MAGUXRF",175,0)
 ;
"RTN","MAGUXRF",176,0)
 ; .X2           Reference to a local array that stores new values
"RTN","MAGUXRF",177,0)
 ;               of audited fields. Subscripts of this array are
"RTN","MAGUXRF",178,0)
 ;               order numbers of fields included in the audit
"RTN","MAGUXRF",179,0)
 ;               index/action definition.
"RTN","MAGUXRF",180,0)
 ;
"RTN","MAGUXRF",181,0)
 ; Input Variables
"RTN","MAGUXRF",182,0)
 ; ===============
"RTN","MAGUXRF",183,0)
 ;
"RTN","MAGUXRF",184,0)
 ; MAGNOFMAUDIT  If this variable is defined and not 0, then audit
"RTN","MAGUXRF",185,0)
 ;               is not performed. You can use this variable to
"RTN","MAGUXRF",186,0)
 ;               disable audit during creation of a record when a
"RTN","MAGUXRF",187,0)
 ;               basic record is created first and then its fields
"RTN","MAGUXRF",188,0)
 ;               are populated by separate VA FileMan call(s).
"RTN","MAGUXRF",189,0)
 ;
"RTN","MAGUXRF",190,0)
 ; Notes
"RTN","MAGUXRF",191,0)
 ; =====
"RTN","MAGUXRF",192,0)
 ;
"RTN","MAGUXRF",193,0)
 ; Definition of an index/action that performs the audit must always
"RTN","MAGUXRF",194,0)
 ; include the .01 field as the first item (order number = 1).
"RTN","MAGUXRF",195,0)
 ;
"RTN","MAGUXRF",196,0)
 ; If you do not want to track changes of the .01 field, leave the
"RTN","MAGUXRF",197,0)
 ; first piece of the FLDLST parameter empty.
"RTN","MAGUXRF",198,0)
 ;
"RTN","MAGUXRF",199,0)
 ; See the AUDIT40 index of the IMAGE file (#2005) for an example.
"RTN","MAGUXRF",200,0)
 ;
"RTN","MAGUXRF",201,0)
AUDIT(FILE,IENS,FLDLST,SUBFILE,X1,X2) ;
"RTN","MAGUXRF",202,0)
 ;--- Do not do anything if audit is disabled by an application
"RTN","MAGUXRF",203,0)
 ;--- (e.g. during creation and initial population of a record).
"RTN","MAGUXRF",204,0)
 Q:$G(MAGNOFMAUDIT)
"RTN","MAGUXRF",205,0)
 ;--- Do not do anything if the record is created or
"RTN","MAGUXRF",206,0)
 ;--- deleted (.01 field is empty or not defined)
"RTN","MAGUXRF",207,0)
 Q:($G(X1(1))="")!($G(X2(1))="")
"RTN","MAGUXRF",208,0)
 ;--- Initialize variables
"RTN","MAGUXRF",209,0)
 N AIENS,EXTVAL,FLD,I,INTVAL,MAGFDA,MAGMSG,NF,NOW
"RTN","MAGUXRF",210,0)
 S NOW=$$NOW^XLFDT
"RTN","MAGUXRF",211,0)
 ;===
"RTN","MAGUXRF",212,0)
 S NF=$L(FLDLST,";")
"RTN","MAGUXRF",213,0)
 F I=1:1:NF  S FLD=+$P(FLDLST,";",I)  D:FLD>0
"RTN","MAGUXRF",214,0)
 . S INTVAL=$G(X1(I))  Q:$G(X2(I))=INTVAL
"RTN","MAGUXRF",215,0)
 . ;--- Prepare data for the audit multiple
"RTN","MAGUXRF",216,0)
 . S AIENS="+"_I_","_IENS
"RTN","MAGUXRF",217,0)
 . S MAGFDA(SUBFILE,AIENS,.01)=NOW      ; DATE/TIME RECORDED
"RTN","MAGUXRF",218,0)
 . S MAGFDA(SUBFILE,AIENS,.02)=FLD      ; FIELD NUMBER
"RTN","MAGUXRF",219,0)
 . S MAGFDA(SUBFILE,AIENS,.03)=$G(DUZ)  ; USER
"RTN","MAGUXRF",220,0)
 . ;--- Do not create global nodes for empty values
"RTN","MAGUXRF",221,0)
 . Q:INTVAL=""
"RTN","MAGUXRF",222,0)
 . S MAGFDA(SUBFILE,AIENS,1)=INTVAL     ; OLD INTERNAL VALUE
"RTN","MAGUXRF",223,0)
 . ;--- The external value is stored only if it is
"RTN","MAGUXRF",224,0)
 . ;--- different from the internal one
"RTN","MAGUXRF",225,0)
 . S EXTVAL=$$EXTERNAL^DILFD(FILE,FLD,,INTVAL,"MAGMSG")
"RTN","MAGUXRF",226,0)
 . S:$G(DIERR) EXTVAL="<ERROR>"
"RTN","MAGUXRF",227,0)
 . S:EXTVAL'=INTVAL MAGFDA(SUBFILE,AIENS,2)=EXTVAL
"RTN","MAGUXRF",228,0)
 . Q
"RTN","MAGUXRF",229,0)
 ;===
"RTN","MAGUXRF",230,0)
 D:$D(MAGFDA)>1 UPDATE^DIE(,"MAGFDA",,"MAGMSG")
"RTN","MAGUXRF",231,0)
 Q
"SEC","^DIC",2005.71,2005.71,0,"AUDIT")
@
"SEC","^DIC",2005.71,2005.71,0,"DD")
@
"SEC","^DIC",2005.71,2005.71,0,"DEL")
@
"SEC","^DIC",2005.71,2005.71,0,"LAYGO")
@
"SEC","^DIC",2005.71,2005.71,0,"RD")
@
"SEC","^DIC",2005.71,2005.71,0,"WR")
@
"SEC","^DIC",2005.99,2005.99,0,"AUDIT")
@
"SEC","^DIC",2005.99,2005.99,0,"DD")
@
"SEC","^DIC",2005.99,2005.99,0,"DEL")
@
"SEC","^DIC",2005.99,2005.99,0,"LAYGO")
@
"SEC","^DIC",2005.99,2005.99,0,"RD")
@
"SEC","^DIC",2005.99,2005.99,0,"WR")
@
"SEC","^DIC",2006.15,2006.15,0,"AUDIT")
@
"SEC","^DIC",2006.15,2006.15,0,"DD")
@
"SEC","^DIC",2006.15,2006.15,0,"DEL")
@
"SEC","^DIC",2006.15,2006.15,0,"LAYGO")
@
"SEC","^DIC",2006.15,2006.15,0,"RD")
@
"SEC","^DIC",2006.15,2006.15,0,"WR")
@
"VER")
8.0^22.0
"^DD",2005.71,2005.71,0)
FIELD^^2^2
"^DD",2005.71,2005.71,0,"DDA")
N
"^DD",2005.71,2005.71,0,"DT")
3100610
"^DD",2005.71,2005.71,0,"IX","B",2005.71,.01)

"^DD",2005.71,2005.71,0,"NM","IMAGING DICOM FIELDS")

"^DD",2005.71,2005.71,.01,0)
SOP^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2005.71,2005.71,.01,.1)
 
"^DD",2005.71,2005.71,.01,1,0)
^.1
"^DD",2005.71,2005.71,.01,1,1,0)
2005.71^B
"^DD",2005.71,2005.71,.01,1,1,1)
S ^MAG(2005.71,"B",$E(X,1,30),DA)=""
"^DD",2005.71,2005.71,.01,1,1,2)
K ^MAG(2005.71,"B",$E(X,1,30),DA)
"^DD",2005.71,2005.71,.01,3)
Enter SOP type  (e.g. "TELEDERM"). It must be 3-30 characters in length.
"^DD",2005.71,2005.71,.01,21,0)
^.001^1^1^3090925^^^
"^DD",2005.71,2005.71,.01,21,1,0)
SOP type for the image being converted to DICOM.
"^DD",2005.71,2005.71,.01,"DT")
3090925
"^DD",2005.71,2005.71,2,0)
MODULE^2005.712A^^M;0
"^DD",2005.71,2005.71,2,"DT")
3090925
"^DD",2005.71,2005.712,0)
MODULE SUB-FIELD^^2^2
"^DD",2005.71,2005.712,0,"DT")
3100610
"^DD",2005.71,2005.712,0,"IX","B",2005.712,.01)

"^DD",2005.71,2005.712,0,"NM","MODULE")

"^DD",2005.71,2005.712,0,"UP")
2005.71
"^DD",2005.71,2005.712,.01,0)
MODULE^F^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",2005.71,2005.712,.01,1,0)
^.1
"^DD",2005.71,2005.712,.01,1,1,0)
2005.712^B
"^DD",2005.71,2005.712,.01,1,1,1)
S ^MAG(2005.71,DA(1),"M","B",$E(X,1,30),DA)=""
"^DD",2005.71,2005.712,.01,1,1,2)
K ^MAG(2005.71,DA(1),"M","B",$E(X,1,30),DA)
"^DD",2005.71,2005.712,.01,3)
Enter DICOM module name (e.g. "GENERAL STUDY"). It must be 3-30 characters in length.
"^DD",2005.71,2005.712,.01,21,0)
^.001^1^1^3090925^^
"^DD",2005.71,2005.712,.01,21,1,0)
DICOM module that contains multiple DICOM elements.
"^DD",2005.71,2005.712,.01,"DT")
3090925
"^DD",2005.71,2005.712,2,0)
ELEMENT TAG^2005.713A^^E;0
"^DD",2005.71,2005.712,2,"DT")
3100614
"^DD",2005.71,2005.713,0)
ELEMENT TAG SUB-FIELD^^5^5
"^DD",2005.71,2005.713,0,"DT")
3100610
"^DD",2005.71,2005.713,0,"IX","B",2005.713,.01)

"^DD",2005.71,2005.713,0,"NM","ELEMENT TAG")

"^DD",2005.71,2005.713,0,"UP")
2005.712
"^DD",2005.71,2005.713,.01,0)
ELEMENT TAG^F^^0;1^K:$L(X)>20!($L(X)<9) X
"^DD",2005.71,2005.713,.01,1,0)
^.1
"^DD",2005.71,2005.713,.01,1,1,0)
2005.713^B
"^DD",2005.71,2005.713,.01,1,1,1)
S ^MAG(2005.71,DA(2),"M",DA(1),"E","B",$E(X,1,30),DA)=""
"^DD",2005.71,2005.713,.01,1,1,2)
K ^MAG(2005.71,DA(2),"M",DA(1),"E","B",$E(X,1,30),DA)
"^DD",2005.71,2005.713,.01,3)
Enter element tag (e.g. 0008,0021). It must be 9-20 characters in length.
"^DD",2005.71,2005.713,.01,21,0)
^^3^3^3100610^
"^DD",2005.71,2005.713,.01,21,1,0)
The ELEMENT TAG is an ordered pair of numbers (a Group Number followed 
"^DD",2005.71,2005.713,.01,21,2,0)
by an Element Number)  that uniquely identifies each DICOM element.
"^DD",2005.71,2005.713,.01,21,3,0)
A comma is used as a separator between the Group Number and the Element Number.
"^DD",2005.71,2005.713,.01,"DT")
3100614
"^DD",2005.71,2005.713,2,0)
ELEMENT NAME^RF^^0;2^K:$L(X)>30!($L(X)<3) X
"^DD",2005.71,2005.713,2,3)
Enter DICOM element name (e.g. "Series Date"). It must be 3-30 characters in length.
"^DD",2005.71,2005.713,2,21,0)
^^1^1^3090925^
"^DD",2005.71,2005.713,2,21,1,0)
Descriptive name of the DICOM data element.
"^DD",2005.71,2005.713,2,"DT")
3090925
"^DD",2005.71,2005.713,3,0)
VALUE MULTIPLICITY^RF^^0;3^K:$L(X)>10!($L(X)<1) X
"^DD",2005.71,2005.713,3,3)
Enter value multiplicity. It must be 1-10 characters in length.
"^DD",2005.71,2005.713,3,21,0)
^^4^4^3100610^
"^DD",2005.71,2005.713,3,21,1,0)
Specifies the number of Values that can be encoded in the Value Field of a DICOM Data Element.
"^DD",2005.71,2005.713,3,21,2,0)
If the number of Values that may be encoded in an element is variable, 
"^DD",2005.71,2005.713,3,21,3,0)
it shall be represented by two numbers separated by a dash;
"^DD",2005.71,2005.713,3,21,4,0)
e.g., "1-10" means that there may be 1 to 10 Values in the element. 
"^DD",2005.71,2005.713,3,"DT")
3100610
"^DD",2005.71,2005.713,4,0)
VALUE REPRESENTATION^RS^AE:AE;AS:AS;AT:AT;CS:CS;DA:DA;DS:DS;DT:DT;FL:FL;FD:FD;IS:IS;LO:LO;LT:LT;OB:OB;OW:OW;PN:PN;SH:SH;SL:SL;SQ:SQ;SS:SS;ST:ST;TM:TM;UI:UI;UL:UL;US:US;UT:UT;^0;4^Q
"^DD",2005.71,2005.713,4,3)
Enter two characters value representation code.
"^DD",2005.71,2005.713,4,21,0)
^.001^29^29^3100610^^
"^DD",2005.71,2005.713,4,21,1,0)
The value of this field is a code for the "value representation" of the 
"^DD",2005.71,2005.713,4,21,2,0)
DICOM element.
"^DD",2005.71,2005.713,4,21,3,0)
Possible values are taken from part 5, section 6 of the DICOM standard:
"^DD",2005.71,2005.713,4,21,4,0)
 AE: Application Entity
"^DD",2005.71,2005.713,4,21,5,0)
 AS: Age String
"^DD",2005.71,2005.713,4,21,6,0)
 AT: Attribute Tag
"^DD",2005.71,2005.713,4,21,7,0)
 CS: Code String
"^DD",2005.71,2005.713,4,21,8,0)
 DA: Date
"^DD",2005.71,2005.713,4,21,9,0)
 DS: Decimal String
"^DD",2005.71,2005.713,4,21,10,0)
 DT: Date Time
"^DD",2005.71,2005.713,4,21,11,0)
 FL: Floating Point
"^DD",2005.71,2005.713,4,21,12,0)
 FD: Floating Point Double
"^DD",2005.71,2005.713,4,21,13,0)
 IS: Integer String
"^DD",2005.71,2005.713,4,21,14,0)
 LO: Long String
"^DD",2005.71,2005.713,4,21,15,0)
 LT: Long Text
"^DD",2005.71,2005.713,4,21,16,0)
 OB: Other Byte String
"^DD",2005.71,2005.713,4,21,17,0)
 OW: Other Word String
"^DD",2005.71,2005.713,4,21,18,0)
 PN: Person Name
"^DD",2005.71,2005.713,4,21,19,0)
 SH: Short String
"^DD",2005.71,2005.713,4,21,20,0)
 SL: Signed Long
"^DD",2005.71,2005.713,4,21,21,0)
 SQ: Sequence of Items
"^DD",2005.71,2005.713,4,21,22,0)
 SS: Signed Short
"^DD",2005.71,2005.713,4,21,23,0)
 ST: Short Text
"^DD",2005.71,2005.713,4,21,24,0)
 TM: Time
"^DD",2005.71,2005.713,4,21,25,0)
 UI: Unique Identifier (UID)
"^DD",2005.71,2005.713,4,21,26,0)
 UL: Unsigned Long
"^DD",2005.71,2005.713,4,21,27,0)
 UN: Unknown
"^DD",2005.71,2005.713,4,21,28,0)
 US: Unsigned Short
"^DD",2005.71,2005.713,4,21,29,0)
 UT: Unlimited Text
"^DD",2005.71,2005.713,4,"DT")
3100610
"^DD",2005.71,2005.713,5,0)
GUI CONTROL^RS^E:Edit Box;C:Combo Box;M:Memo;D:Date;Z:None;^0;5^Q
"^DD",2005.71,2005.713,5,3)
Enter the type of GUI control.
"^DD",2005.71,2005.713,5,21,0)
^^1^1^3100610^
"^DD",2005.71,2005.713,5,21,1,0)
Delphi control type that will be used to present DICOM elements.
"^DD",2005.71,2005.713,5,"DT")
3100610
"^DD",2005.99,2005.99,0)
FIELD^^7^8
"^DD",2005.99,2005.99,0,"DDA")
N
"^DD",2005.99,2005.99,0,"DT")
3090923
"^DD",2005.99,2005.99,0,"IX","B",2005.99,.01)

"^DD",2005.99,2005.99,0,"NM","IMAGE INDEX FOR BODY PART")

"^DD",2005.99,2005.99,0,"PT",2005,47)

"^DD",2005.99,2005.99,0,"PT",2005.1,47)

"^DD",2005.99,2005.99,0,"VRPK")
MAG
"^DD",2005.99,2005.99,.01,0)
NAME^RF^^0;1^K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
"^DD",2005.99,2005.99,.01,1,0)
^.1
"^DD",2005.99,2005.99,.01,1,1,0)
2005.99^B
"^DD",2005.99,2005.99,.01,1,1,1)
S ^MAG(2005.99,"B",$E(X,1,30),DA)=""
"^DD",2005.99,2005.99,.01,1,1,2)
K ^MAG(2005.99,"B",$E(X,1,30),DA)
"^DD",2005.99,2005.99,.01,3)
Enter the body part name 3-50 characters in length.
"^DD",2005.99,2005.99,.01,21,0)
^.001^1^1^3090924^^
"^DD",2005.99,2005.99,.01,21,1,0)
Name of the body part that relates best to the image.
"^DD",2005.99,2005.99,.01,"DT")
3090923
"^DD",2005.99,2005.99,1,0)
REGION/SYSTEM^F^^0;2^K:$L(X)>30!($L(X)<2) X
"^DD",2005.99,2005.99,1,3)
Enter Region or System  of the body part, it must be 2-30 characters in length.
"^DD",2005.99,2005.99,1,21,0)
^^1^1^3090924^
"^DD",2005.99,2005.99,1,21,1,0)
The Region or System that the body part belongs to.
"^DD",2005.99,2005.99,1,"DT")
3090923
"^DD",2005.99,2005.99,2,0)
SNOMED CONCEPT ID^F^^0;3^K:$L(X)>15!($L(X)<3) X
"^DD",2005.99,2005.99,2,3)
Enter SNOMED CT concept ID, it must be 3-15 characters in length.
"^DD",2005.99,2005.99,2,21,0)
^^1^1^3090924^
"^DD",2005.99,2005.99,2,21,1,0)
The ID of SNOMED CT Concept that best describes the body part.
"^DD",2005.99,2005.99,2,"DT")
3090923
"^DD",2005.99,2005.99,3,0)
SNOMED CODE VALUE^F^^0;4^K:$L(X)>10!($L(X)<4) X
"^DD",2005.99,2005.99,3,3)
Enter the SNOMED code value as defined in the DICOM Standard. must be 4-10 characters in length.
"^DD",2005.99,2005.99,3,21,0)
^^1^1^3090924^
"^DD",2005.99,2005.99,3,21,1,0)
SNOMED Code Value of the DICOM standard of the body part.
"^DD",2005.99,2005.99,3,"DT")
3090923
"^DD",2005.99,2005.99,4,0)
DICOM BODY PART EXAMINED^F^^0;5^K:$L(X)>30!($L(X)<3) X
"^DD",2005.99,2005.99,4,3)
Enter body part examined as defined by the DICOM Standard. must be 3-30 characters in length.
"^DD",2005.99,2005.99,4,21,0)
^^1^1^3090924^
"^DD",2005.99,2005.99,4,21,1,0)
Name of body part examined as defined by the DICOM standard.
"^DD",2005.99,2005.99,4,"DT")
3090923
"^DD",2005.99,2005.99,5,0)
DICOM CODE MEANING^F^^0;6^K:$L(X)>30!($L(X)<3) X
"^DD",2005.99,2005.99,5,3)
Enter the body part code meaning as defined by the DICOM Standard. It must be 3-30 characters in length.
"^DD",2005.99,2005.99,5,21,0)
^.001^1^1^3090924^^
"^DD",2005.99,2005.99,5,21,1,0)
The body part DICOM code meaning as defined by the DICOM standard.
"^DD",2005.99,2005.99,5,"DT")
3090923
"^DD",2005.99,2005.99,6,0)
ICD TOPOGRAPHY^F^^0;7^K:$L(X)>6!($L(X)<2) X
"^DD",2005.99,2005.99,6,3)
Enter the value of the ICD code for topography. It must be 2-6 characters in length.
"^DD",2005.99,2005.99,6,21,0)
^.001^1^1^3090924^^
"^DD",2005.99,2005.99,6,21,1,0)
The International Classification of Diseases (ICD) body part.
"^DD",2005.99,2005.99,6,"DT")
3090923
"^DD",2005.99,2005.99,7,0)
LOINC SYSTEM^F^^0;8^K:$L(X)>10!($L(X)<3) X
"^DD",2005.99,2005.99,7,3)
Enter the code of the body part in LOINC, it must be 3-10 characters in length.
"^DD",2005.99,2005.99,7,21,0)
^.001^1^1^3090924^^
"^DD",2005.99,2005.99,7,21,1,0)
The body part value in LOINC standard.
"^DD",2005.99,2005.99,7,"DT")
3090923
"^DD",2006.15,2006.15,0)
FIELD^^3^4
"^DD",2006.15,2006.15,0,"DT")
3101015
"^DD",2006.15,2006.15,0,"IX","B",2006.15,.01)

"^DD",2006.15,2006.15,0,"NM","DICOM UID ROOT")

"^DD",2006.15,2006.15,.01,0)
OWNER^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.15,2006.15,.01,1,0)
^.1
"^DD",2006.15,2006.15,.01,1,1,0)
2006.15^B
"^DD",2006.15,2006.15,.01,1,1,1)
S ^MAGD(2006.15,"B",$E(X,1,30),DA)=""
"^DD",2006.15,2006.15,.01,1,1,2)
K ^MAGD(2006.15,"B",$E(X,1,30),DA)
"^DD",2006.15,2006.15,.01,3)
Enter the name of the owner of this UID root code (3-30 chars).
"^DD",2006.15,2006.15,.01,21,0)
^.001^2^2^3100212^^
"^DD",2006.15,2006.15,.01,21,1,0)
The value of this field is a string that identifies the organization
"^DD",2006.15,2006.15,.01,21,2,0)
to which the UID root code that is stored in this record is assigned.
"^DD",2006.15,2006.15,.01,"DT")
3040204
"^DD",2006.15,2006.15,1,0)
UID ROOT^RF^^UID ROOT;1^K:$L(X)>90!($L(X)<1) X
"^DD",2006.15,2006.15,1,3)
Enter this organization's UID root code as obtained from ISO (1-90 chars).
"^DD",2006.15,2006.15,1,21,0)
^.001^15^15^3100212^^
"^DD",2006.15,2006.15,1,21,1,0)
The value of this field is a string that represents this organization's
"^DD",2006.15,2006.15,1,21,2,0)
UID root code.
"^DD",2006.15,2006.15,1,21,3,0)
 
"^DD",2006.15,2006.15,1,21,4,0)
Values for this code must be obtained from the International Standards
"^DD",2006.15,2006.15,1,21,5,0)
Organization (ISO) or from their national representative bodies (for the
"^DD",2006.15,2006.15,1,21,6,0)
USA, this is ANSI).
"^DD",2006.15,2006.15,1,21,7,0)
 
"^DD",2006.15,2006.15,1,21,8,0)
The format of an UID root code looks like a list of integer numbers,
"^DD",2006.15,2006.15,1,21,9,0)
separated by periods.
"^DD",2006.15,2006.15,1,21,10,0)
 
"^DD",2006.15,2006.15,1,21,11,0)
For VA hospitals, the value for this field will be automatically entered.
"^DD",2006.15,2006.15,1,21,12,0)
 
"^DD",2006.15,2006.15,1,21,13,0)
Other organizations first need to obtain their "root code" from the
"^DD",2006.15,2006.15,1,21,14,0)
appropriate standards organization, and then manually enter the assigned
"^DD",2006.15,2006.15,1,21,15,0)
value into this field.
"^DD",2006.15,2006.15,1,"DT")
3040204
"^DD",2006.15,2006.15,2,0)
LAST DATETIME UID GENERATED^D^^1;1^S %DT="ESTXR" D ^%DT S X=Y K:X<1 X
"^DD",2006.15,2006.15,2,3)
Enter the date and time of the last UID generation.
"^DD",2006.15,2006.15,2,21,0)
^^1^1^3101015^^
"^DD",2006.15,2006.15,2,21,1,0)
This field contains the date and time that the last DICOM UID was generated.
"^DD",2006.15,2006.15,2,23,0)
^^1^1^3101015^^
"^DD",2006.15,2006.15,2,23,1,0)
Added in patch MAG*3.0*106
"^DD",2006.15,2006.15,2,"DT")
3101015
"^DD",2006.15,2006.15,3,0)
TICK^NJ15,0^^1;2^K:+X'=X!(X>999999999999999)!(X<0)!(X?.E1"."1.N) X
"^DD",2006.15,2006.15,3,3)
Type a number between 0 and 999999999999999, 0 Decimal Digits.
"^DD",2006.15,2006.15,3,21,0)
^^5^5^3101015^^
"^DD",2006.15,2006.15,3,21,1,0)
This field is incremented every time a new DICOM UID is
"^DD",2006.15,2006.15,3,21,2,0)
generated. This field is reset to one ('1') daily when a new DICOM UID is 
"^DD",2006.15,2006.15,3,21,3,0)
generated for the first time during the day. This field supplements LAST 
"^DD",2006.15,2006.15,3,21,4,0)
DATETIME UID GENERATED field (2006.15,2) to prevent duplicate DICOM UIDs
"^DD",2006.15,2006.15,3,21,5,0)
within one second interval of generation requests.
"^DD",2006.15,2006.15,3,23,0)
^^1^1^3101015^^
"^DD",2006.15,2006.15,3,23,1,0)
Added in patch MAG*3.0*106
"^DD",2006.15,2006.15,3,"DT")
3101015
"^DIC",2005.71,2005.71,0)
IMAGING DICOM FIELDS^2005.71
"^DIC",2005.71,2005.71,0,"GL")
^MAG(2005.71,
"^DIC",2005.71,2005.71,"%",0)
^1.005^^
"^DIC",2005.71,2005.71,"%D",0)
^^4^4^3091016^^
"^DIC",2005.71,2005.71,"%D",1,0)
This file contains information for imaging DICOM fields that will be 
"^DIC",2005.71,2005.71,"%D",2,0)
displayed when capture of an image is done within VI Capture Client.
"^DIC",2005.71,2005.71,"%D",3,0)
 
"^DIC",2005.71,2005.71,"%D",4,0)
Added by Patch MAG*3.0*106
"^DIC",2005.71,"B","IMAGING DICOM FIELDS",2005.71)

"^DIC",2005.99,2005.99,0)
IMAGE INDEX FOR BODY PART^2005.99
"^DIC",2005.99,2005.99,0,"GL")
^MAG(2005.99,
"^DIC",2005.99,2005.99,"%",0)
^1.005^^0
"^DIC",2005.99,2005.99,"%D",0)
^^9^9^3100611^
"^DIC",2005.99,2005.99,"%D",1,0)
This file contains the body part index term for the images captured by 
"^DIC",2005.99,2005.99,"%D",2,0)
VI. It also contain the corresponding values in ICD, LOINC, SNOMED CT, 
"^DIC",2005.99,2005.99,"%D",3,0)
and DICOM standard.
"^DIC",2005.99,2005.99,"%D",4,0)
The information  is stored in DICOM header during the conversion of image 
"^DIC",2005.99,2005.99,"%D",5,0)
files in JPEG or TIFF formats to image files in DICOM format.
"^DIC",2005.99,2005.99,"%D",6,0)
 
"^DIC",2005.99,2005.99,"%D",7,0)
The Body Part Term could be used to sort and retrieve group of images for 
"^DIC",2005.99,2005.99,"%D",8,0)
educational and research uses when the corresponding information is 
"^DIC",2005.99,2005.99,"%D",9,0)
stored in VistA Imaging data files.
"^DIC",2005.99,"B","IMAGE INDEX FOR BODY PART",2005.99)

"^DIC",2006.15,2006.15,0)
DICOM UID ROOT^2006.15
"^DIC",2006.15,2006.15,0,"GL")
^MAGD(2006.15,
"^DIC",2006.15,2006.15,"%D",0)
^^24^24^3040212^^
"^DIC",2006.15,2006.15,"%D",1,0)
 +---------------------------------------------------------------+
"^DIC",2006.15,2006.15,"%D",2,0)
 | Property of the US Government.                                |
"^DIC",2006.15,2006.15,"%D",3,0)
 | No permission to copy or redistribute this software is given. |
"^DIC",2006.15,2006.15,"%D",4,0)
 | Use of unreleased versions of this software requires the user |
"^DIC",2006.15,2006.15,"%D",5,0)
 | to execute a written test agreement with the VistA Imaging    |
"^DIC",2006.15,2006.15,"%D",6,0)
 | Development Office of the Department of Veterans Affairs,     |
"^DIC",2006.15,2006.15,"%D",7,0)
 | telephone (301) 734-0100.                                     |
"^DIC",2006.15,2006.15,"%D",8,0)
 |                                                               |
"^DIC",2006.15,2006.15,"%D",9,0)
 | The Food and Drug Administration classifies this software as  |
"^DIC",2006.15,2006.15,"%D",10,0)
 | a medical device.  As such, it may not be changed in any way. |
"^DIC",2006.15,2006.15,"%D",11,0)
 | Modifications to this software may result in an adulterated   |
"^DIC",2006.15,2006.15,"%D",12,0)
 | medical device under 21CFR820, the use of which is considered |
"^DIC",2006.15,2006.15,"%D",13,0)
 | to be a violation of US Federal Statutes.                     |
"^DIC",2006.15,2006.15,"%D",14,0)
 +---------------------------------------------------------------+
"^DIC",2006.15,2006.15,"%D",15,0)
 
"^DIC",2006.15,2006.15,"%D",16,0)
The purpose of this table is to specify the first groups
"^DIC",2006.15,2006.15,"%D",17,0)
of digits for the unique object identifiers that will be
"^DIC",2006.15,2006.15,"%D",18,0)
generated by the software.
"^DIC",2006.15,2006.15,"%D",19,0)
Note that this "root" for the UIDs is organization-specific,
"^DIC",2006.15,2006.15,"%D",20,0)
and that the FOIA release of this software will only
"^DIC",2006.15,2006.15,"%D",21,0)
include data for this table for VA sites.
"^DIC",2006.15,2006.15,"%D",22,0)
 
"^DIC",2006.15,2006.15,"%D",23,0)
See the DICOM Standard (www.nema.org/dicom) PS 3.8 Annex A
"^DIC",2006.15,2006.15,"%D",24,0)
for instructions on how to obtain a valid UID root.
"^DIC",2006.15,"B","DICOM UID ROOT",2006.15)

**END**
**END**


****
****
