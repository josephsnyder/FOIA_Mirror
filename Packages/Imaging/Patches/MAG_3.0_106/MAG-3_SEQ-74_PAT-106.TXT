
=============================================================================
Run Date: APR 25, 2011                     Designation: MAG*3*106
Package : MAG - IMAGING                       Priority: Mandatory
Version : 3        SEQ #74                      Status: Released
                  Compliance Date: MAY 26, 2011
=============================================================================

Associated patches: (v)MAG*3*54    <<= must be installed BEFORE `MAG*3*106'
                    (v)MAG*3*94    <<= must be installed BEFORE `MAG*3*106'
                    (v)MAG*3*114   <<= must be installed BEFORE `MAG*3*106'

Subject: TELEDERMATOLOGY

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Data Dictionary
  - Other

Description:
============

 Patch 106 Overview:
 ===================
 
 This document describes VistA Imaging Patch 106, Teledermatology, which provides
 enhancements to support teledermatology. This patch enables the VistA Imaging 
 Clinical Capture to convert images into DICOM format and then associate the 
 images for viewing on the TeleReader worklist.   
 
 Specifically, this patch supports:
 
      *  The capture of images and their conversion to DICOM format before 
         storing 
 
      *  The use of TeleReader in a Thin Client environment, controllable by site
         administrators
 
      *  Consults that are discontinued, no longer appearing in TeleReader
 
 For detailed information, refer to the change summary section.
 
 Note: All sites running VistA Imaging 3.0 must install all components in this
       patch.
 
 Distribution of Software:
 =========================
 
 This patch can be downloaded from:
 
 ftp.imaging.med.va.gov/Software/Released_Software/Mag3_0P106
 
 Installation instructions are included in this document.
 
 Note: Any late-breaking news about this patch will be found in a readme file.
       If present, this file will also be located in the MAG3_0P106 directory.
 
 Patch Contents:
 ===============
 
 This patch includes the following files:
 
 Software:
 =========
 
      MAG3_0P106.KID - KIDS (Kernel Installation & Distribution System) package 
      to be installed on the VistA System
 
      MAG3_0P106_Install.exe - Installation file for Clinical Display, Clinical 
      Capture, and TeleReader client software
 
      MagAUShare.zip - Zip file containing files used by Autoupdate sites. 
      Contains MagASet.exe, MagSetup.exe, and magnet.ini
 
      MagInstall.msi - Installation file for sites using SMS or similar software
 
 Documentation:
 ==============
 
      The following documentation is available for MAG*3.0*106 Teledermatology:
 
      MAG3_0P106_Patch_Description.pdf - Patch Description
 
      MAG3_0P106_Clinical_Capture_User_Manual_Changes.pdf
 
      MAG3_0P106_Install_Guide_Changes.pdf
 
      MAG3_0P106_Security_Guide_Changes.pdf
 
      MAG3_0P106_Technical_Manual_Changes.pdf
 
 Associated Patches:
 ===================
 
 Before Patch 106 is installed, the following patches must be installed:
 
      MAG*3.0*114  TeleReader Configurator
 
      MAG*3.0*54  DICOM Maintenance IV
 
      MAG*3.0*94  Clinical Capture Maintenance II
 
 For a list of all released Imaging (MAG) patches, refer to the patch_list.txt
 file available on the Imaging FTP server (go to ftp://ftp.imaging.med.va.gov,
 then navigate to the \Docs\Imaging_Docs_Latest folder).
 
 Test Sites:
 ===========
 
 The following sites are test sites for this patch:
 
      Charleston, SC (Large)
 
      Fayetteville, NC (Large)
 
      San Diego, CA (Large)
 
      West Haven HCS, CT (Integrated)
 
      West Los Angeles HCS, CA (Integrated)
 
 Remedy Calls:
 =============
 
 There are no Remedy help desk calls addressed in this patch.
 
 National Service Requests:
 ==========================
 
 20080404   VistA Imaging Enhancements to Support Teledermatology
   
 Patch 106 Changes:
 ==================
 
 Patch 106 contains changes to the following Imaging components:
 
      *  VistA Imaging TeleReader
 
      *  VistA Imaging Clinical Capture
 
      *  VistA Imaging-related changes on the VistA System
 
 Note: The VistA Imaging Clinical Display software is included in this patch, 
       but is not altered by this patch. 
 
 VistA Imaging TeleReader Changes:
 
 Discontinued orders will not display in TeleReader.
 
 Teledermatology Support:
 
 Dermatology images acquired using the Patch 106 Clinical Capture can be 
 associated with consults allowing them to appear on the TeleReader worklist.
 
 Thin Client Support:
 
 Sites will be able to configure whether or not TeleReader will be able to 
 access and read images on a workstation that accesses VistA Imaging through a 
 Thin Client.
 
 VistA Imaging Clinical Capture Changes:
 
 Clinical Capture provides the capability to acquire dermatology images that can
 be remotely read using Inter-Facility Consults (IFCs) and TeleReader.  To 
 support this capability, a new association has been added to Clinical Capture 
 called "TeleReader Consult".  JPEG and TIFF dermatology images saved to VistA 
 using this new association will be converted into DICOM format before storing 
 in VistA Imaging.  The images will then be viewable in Clinical Display.
 
 The DICOM Header Data Entry dialog box, shown below, is new in Clinical 
 Capture.  This dialog box is used to add additional DICOM Header information 
 about an image, specifically on what part of the body the image was captured.
 The body part is identified by selecting the Body Part Examined (e.g., skin of 
 abdomen or skin of back) and the Laterality (Right or Left) of the image site.  
 
 WARNING:
 ========
 
 There is an option in the Clinical Capture batch capture process that allows 
 for the automatic deletion of image files from the import directory after they 
 have been captured.  Prior to using this option for Teledermatology images, it 
 is recommended that several single and/or groups of images be captured 
 successfully using each camera that will be used to capture Teledermatology 
 images.  This is to ensure the images are viewable before they are deleted.  
 Once the process is confirmed to work properly, deleting image files from the 
 import directory can be enabled if desired.
 
 VistA System Changes:
 =====================
 
 KIDS File Changes:
 ==================
 
 Data Dictionaries:
 
 Note: The following files are arranged in numerical order and contain new, 
       modified, or deleted fields in this patch:  
 
 IMAGE file (#2005) change:
 
   ACA cross-reference - removed 
 
 IMAGE AUDIT file (#2005.1) change:
 
   ACA cross-reference - removed
 
 IMAGING DICOM FIELDS file (#2005.71) new:
 
 Contains information for imaging DICOM fields that will be displayed when an 
 image is captured in Clinical Capture.
 
   SOP field (#.01) - SOP type for the image being converted
 
   MODULE field (#2) - a multiple field; sub-file with the following:
 
      MODULE field ( #.01) - DICOM module that contains multiple DICOM elements
 
      ELEMENT TAG field (#2) - a multiple field with sub-file with the following:
 
           ELEMENT TAG field (#.01) - an ordered pair of numbers (a Group Number
           followed by an Element Number) that uniquely identifies each DICOM 
           element
 
           ELEMENT NAME field (#2) - descriptive name of the DICOM data element
 
           VALUE MULTIPLICITY field (#3) - the number of values that can be
           encoded in the Value field of a DICOM data element
 
           VALUE REPRESENTATION field (#4) - code value for the "Value 
           Representation" of the DICOM element
 
           GUI CONTROL field (#5) - Delphi control type that will be used to 
           present DICOM elements
 
 IMAGE INDEX FOR BODY PART file (#2005.99) new:
 
 Contains the body part index term for the images captured by VI and also 
 contains the corresponding values in the ICD, LOINC, SNOMED CT, and DICOM 
 standard. The information is stored in the DICOM header during the conversion
 of image files from JPEG or TIFF formats to image files in DICOM format.
 
   NAME field (#.01) - the name of the body part that relates best to the image
 
   REGION/SYSTEM field (#1) - Region or System that the body part belongs to
 
   SNOMED CONCEPT ID field (#2) - the ID of the SNOMED CT Concept that best 
   describes the body part
 
   SNOMED CODE VALUE field (#3) - the SNOMED Code Value of the DICOM standard of 
   the body part
 
   DICOM BODY PART EXAMINED field (#4) - the name of the body part examined as 
   defined by the DICOM standard
 
   DICOM CODE MEANING field (#5) - the body part DICOM code meaning as defined 
   by the DICOM Standard.
 
   ICD TOPOGRAPHY field (#6) - the International Classification of Diseases 
   (ICD) body part
 
   LOINC SYSTEM field (#7) - the body part value in LOINC standard
 
 DICOM UID ROOT file (#2006.15) new:
 
   OWNER field (#.01) - a string that identifies the organization to which the 
   UID root code that is stored in this record is assigned
 
   UID ROOT field (#1) - a string that represents this organization's UID root 
   code
 
   LAST DATETIME UID GENERATED field (#2) - field indicating the date and time 
   when the last DICOM UID (unique identifier) was generated
  
   TICK field (#3) - field that is incremented every time a new DICOM UID is 
   generated. This field is reset to one (1) daily when a new DICOM UID is 
   generated for the first time during the day. This field supplements LAST 
   DATETIME UID GENERATED field (#2) to prevent duplicate DICOM UIDs within one 
   second interval of UID generation requests.
 
 Security Keys:
 ==============
 
 There is a new security key "MAGCAP TRC".  A user with this new key can 
 capture images associated with a "TelerReader Consult" from the Imaging 
 Capture workstation.
 
 Remote Procedures:
 ==================
  
 The following new remote procedures are included in this patch:
 
 MAG3 DICOM CAPTURE GE LIST - returns all records in the IMAGING DICOM FIELDS 
 file (#2005.71) per SOP type (e.g. "TELEDERM")
 
 MAG3 DICOM CAPTURE SOP CLASS - returns SOP CLASS UID per SOP type (e.g. 
 "TELEDERM")
 
 MAG3 TELEREADER CONSULT LIST - returns not completed consults for a patient 
 where TO SERVICE is set up in the TELEREADER ACQUISITION SERVICE file 
 (#2006.5841)
 
 MAG3 TELEREADER DICOM SER NUM - generates the DICOM Series Number
 
 MAG3 TELEREADER DICOM UID - returns a new TELEREADER DICOM Study, Series, or 
 SOP Instance UID
 
 MAG3 TELEREADER READ/UNRD ADD - adds a consult and image pointers to the 
 UNREAD/READ LIST file (#2006.5849) and DICOM GMRC TEMP LIST file (#2006.5839)
 
 MAG3 TR THIN CLIENT ALLOWED - checks for thin client settings by User (DUZ)
 
 Menu Options:
 =============
 
 There are no new menu options for this patch.
 
 Templates:
 ==========
 
 There are no new or modified templates included in this patch.
 
 Parameter Definition:
 =====================
 
 There is a new parameter definition:
 
 MAG TR ALLOW THIN
 
 This parameter controls whether a user is allowed to view images in TeleReader 
 using thin client; parameter changes are implemented by a system administrator.
 Allowance can be controlled at the user, service, division, and system levels.
  
 Installation:
 =============
 
 This patch is to be installed on the VistA System and on the Clinical 
 workstations.  If you have a choice of installing on Clinical Workstations with
 a Network Administrator account or a local Administrator account, it is 
 recommended that you use the local Administrator account.
 
 This patch may be loaded while VistA Imaging System is active.  The KIDS 
 installation will take approximately one minute. 
 
 Installation Prerequisites:
 ===========================
 
 Before installing this patch, you will need to download the Patch 106 files 
 from the Imaging FTP site to a local storage location.
 
 Verify that the patches listed in the Associated Patches section have been 
 installed.
 
 VistA System (KIDS) Installation:
 =================================
 
 Installation Steps:
 
 1.  Access the Kernel Installation and Distribution System Menu [XPD MAIN].
 
 2.  Run the Installation option [XPD INSTALLATION MENU].
 
 3.  Load the KIDS file by performing the following steps.
 
     a.  Run the Load a Distribution option [XPD LOAD DISTRIBUTION] to load the 
         KIDS distribution.
 
     b.  When prompted, enter the path and file name (MAG3_0P106.KID) of the 
         Patch 106 KIDS file that you downloaded from the Imaging FTP server.
 
     c.  When prompted to continue with the load, enter YES.  A Distribution 
         OK! message will be displayed when the load is complete.
 
 4.  After loading the KIDS file, use the following options to verify the 
     contents of the patch and to back up any affected routines.
 
        Verify Checksums in Transport Global [XPD PRINT CHECKSUM] - run this 
        option if you want to ensure the integrity of the routines in the patch. 
 
        Compare Transport Global to Current System [XPD COMPARE TO SYSTEM] -   
        run this option if you want to view all changes that will be made when 
        the patch is installed.  All components (routines, options, and so on) 
        in the patch will be compared.
 
        Backup a Transport Global [XPD BACKUP] - run this option if you want to
        create a backup message of any routines exported with the patch.  It 
        will NOT back up any of the other changes.
 
 5.  After performing the load and any optional verification steps, install 
     the KIDS file by performing the following steps:
 
     a.  Run the Install Package(s) [XPD INSTALL BUILD] option.
 
     b.  When prompted for the install name, enter MAG*3.0*106.
 
     c.  Answer NO to the following prompts:
 
         Want KIDS to Rebuild Menu Trees Upon Completion of Install? No//NO
         Want KIDS to INHIBIT LOGONs during the install? No//NO
         Want to DISABLE Scheduled Options, Menu Options, and Protocols? No//NO
 
 6.  When installation is finished, an Install Completed message will be 
     displayed.
 
 KIDS Installation Example:
 ==========================
 
 Select Installation Option: INStall Package(s)
 Select INSTALL NAME:    MAG*3.0*106    2/28/11@15:10:07
      => VistA Imaging V3.0 - Patch 106 - 02/28/2011 12:34PM  ;Created 
 
 This Distribution was loaded on Feb 28, 2011@15:10:07 with header of 
    VistA Imaging V3.0 - Patch 106 - 02/28/2011 12:34PM  ;Created on Feb 
 28, 2011@12:34:03
    It consisted of the following Install(s):
     MAG*3.0*106
 Checking Install for Package MAG*3.0*106
 Will first run the Environment Check Routine, MAGIP106
 
 Install Questions for MAG*3.0*106
 
 Incoming Files:
 
    2005.71   IMAGING DICOM FIELDS  (including data)
 
    2005.99   IMAGE INDEX FOR BODY PART  (including data)
 
    2006.15   DICOM UID ROOT
 
 Want KIDS to INHIBIT LOGONs during the install? NO// 
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? NO// 
 
 Enter the Device you want to print the Install messages.
 You can queue the install by enter a 'Q' at the device prompt.
 Enter a '^' to abort the install.
 
 DEVICE: HOME//   TELNET
 
  Install Started for MAG*3.0*106 : 
                Feb 28, 2011@15:10:16
 
 Build Distribution Date: Feb 28, 2011
 
  Installing Routines:
                Feb 28, 2011@15:10:17
 
  Running Pre-Install Routine: PRE^MAGIP106
 
  Installing Data Dictionaries: 
                Feb 28, 2011@15:10:17
 
  Installing Data: 
                Feb 28, 2011@15:10:17
 
  Installing PACKAGE COMPONENTS: 
  
  Installing SECURITY KEY
 
  Installing REMOTE PROCEDURE
 
  Installing PARAMETER DEFINITION
                Feb 28, 2011@15:10:17
 
  Running Post-Install Routine: POS^MAGIP106
 
    Attaching RPCs to the 'MAG WINDOWS' option...
    MAG3 DICOM CAPTURE GE LIST
    MAG3 DICOM CAPTURE SOP CLASS
    MAG3 TELEREADER CONSULT LIST
    MAG3 TELEREADER DICOM SER NUM
    MAG3 TELEREADER DICOM UID
    MAG3 TELEREADER READ/UNRD ADD
    MAG3 TR THIN CLIENT ALLOWED
    RPCs have been successfully attached.
 
  Updating Routine file...
 
  Updating KIDS files...
 
  MAG*3.0*106 Installed. 
                Feb 28, 2011@15:10:17
 
 Install Completed
 
 Imaging Clinical Workstation Installation:
 ==========================================
 
 The Clinical Imaging client software (Display, Capture, and TeleReader) can be 
 updated using one of the methods outlined below:
 
 *  Manual Installation
 
 *  Autoupdate Installation using VIIS (VistA Imaging Installation Service)
 
 *  Automatic Installation using other methods (SMS, PSexec, etc.) 
 
 After client installation is complete, log in to an updated workstation and use
 the Help | About menu option to verify that the version number is 3.0.106.13.
 
 Manual Installation:
 
 The MAG3_0P106_Install.exe file can be installed manually on workstations as 
 described in Section 2.5.5.1 in the Clinical Imaging Installation Guide.
 
 Autoupdate Installation:
 
 These steps assume Autoupdate has already been implemented. For information 
 about setting up Autoupdate, see Section 2.5.6 in the Clinical Imaging 
 Installation Guide.
 
 1.  Download MagAUShare.zip and MAG3_0P106_Install.exe from the Imaging FTP 
     server to a local storage location.
 
 2.  Rename the MAG3_0P106_Install.exe file to MagInstall.exe
 
 3.  Copy the new MAG3_0P106_Install.exe file to the location specified in 
     magautoupdate.bat. (magautoupdate.bat is typically stored in Program 
     Files\VistA\Imaging\InstallationService on the system where VIIS is 
     installed).
 
 4.  Perform the following steps to allow the new software to be pushed to 
     designated test workstations:
 
     a.  Extract the contents of the MagAUShare.zip file to the UPDATE\TEST 
         folder.
 
     b.  In the UPDATE\TEST folder, open magnet.ini and change the <server> 
         placeholder for "InstallService" to reflect the server (or cluster 
         name) where VIIS is installed. 
 
           [update_mode]
           ForceUpdateAll=FALSE
           InstallFile=MagSetup.exe
           InstallService=http://<SERVER>/imaging/install.asmx
           <MachineName>=TRUE
 
 5.  Run Clinical Display and Clinical Capture on the test workstations for a 
     period of time to insure there are no problems with the software at your 
     site.
 
 6.  When it is verified that the software is running properly, extract the 
     contents of the MagAUShare.zip file to the UPDATE\DISTRIB folder.
 
 7.  In the UPDATE\DISTRIB folder, open magnet.ini and change the <server> 
     placeholder for "InstallService" to reflect the server (or cluster name) 
     where VIIS is installed. 
 
     All workstations will be updated the next time Clinical Display or Clinical
     Capture is run.
 
 Other Automatic Installation Methods (SMS, PSexec, etc.):
 The following methods are available to push updated software to multiple 
 workstations:
 
      *  Remote push of MAG3_0P106_Install.exe using PSexec and an 
         administrator s account: For details, see section 2.5.5.3 in the 
         current Clinical Imaging Installation Guide.
 
      *  Remote push using Microsoft SMS or similar remote installation 
         software: Either MAG3_0P106_Install.exe or magInstall.msi can be used
         for this. Installation specifics will vary from site to site.
 
 Routines:
 =========
 
 For each routine, the second line will contain the following information. 
 Please note that the "before" checksum may differ if any test software has 
 been installed.
 
 ;;3.0;IMAGING;**[patch list]**;Mar 19, 2002;Build 2002; Feb 28, 2011
 
 The MAGIP106 routine will be automatically deleted after the installation is 
 completed.
 

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: MAGDHWC
    Before: B46762790   After: B48238555  **10,51,46,54,106**
Routine Name: MAGGSIA1
    Before: B40524442   After: B41835903  **7,8,85,59,93,106**
Routine Name: MAGGTIA
    Before: B42431443   After: B47129366  **8,48,106**
Routine Name: MAGGTU4C
    Before:  B4891026   After:  B5091959  **93,94,106**
Routine Name: MAGGTU4D
    Before:  B4896831   After:  B5097764  **93,94,106**
Routine Name: MAGGTU4L
    Before:  B4891107   After:  B5092040  **93,94,106**
Routine Name: MAGGTU4T
    Before:  B4891179   After:  B5092112  **93,94,106**
Routine Name: MAGIP106
    Before:       n/a   After:  B7756257  **106**
Routine Name: MAGNDCMC
    Before:       n/a   After: B11551246  **106**
Routine Name: MAGNGMR
    Before:       n/a   After: B70338961  **106**
Routine Name: MAGNTLR3
    Before:       n/a   After:  B4232767  **106**
Routine Name: MAGNUID1
    Before:       n/a   After: B17116046  **106**
Routine Name: MAGNUID2
    Before:       n/a   After:  B4027276  **106**
Routine Name: MAGUXRF
    Before: B41195502   After: B31728772  **51,93,106**

=============================================================================
User Information:
Entered By  : TROMBETTA,KATHY               Date Entered  : AUG 19, 2009
Completed By: CASUGAY,ELSIE G               Date Completed: APR 22, 2011
Released By : FUGETT,BRENT                  Date Released : APR 25, 2011
=============================================================================


Packman Mail Message:
=====================

No routines included
