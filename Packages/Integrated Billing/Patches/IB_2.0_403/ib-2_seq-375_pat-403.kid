Released IB*2*403 SEQ #375
Extracted from mail message
**KIDS**:IB*2.0*403^

**INSTALL NAME**
IB*2.0*403
"BLD",7241,0)
IB*2.0*403^INTEGRATED BILLING^0^3081204^y
"BLD",7241,1,0)
^^1^1^3080916^
"BLD",7241,1,1,0)
eClaims Plus - Diagnosis Present on Admission (POA) Indicator.
"BLD",7241,4,0)
^9.64PA^350.8^4
"BLD",7241,4,350.8,0)
350.8
"BLD",7241,4,350.8,222)
n^n^f^^n^^y^o^n
"BLD",7241,4,350.8,224)
I $$INC3508^IBY403PR(Y)
"BLD",7241,4,362.3,0)
362.3
"BLD",7241,4,362.3,2,0)
^9.641^362.3^1
"BLD",7241,4,362.3,2,362.3,0)
IB BILL/CLAIMS DIAGNOSIS  (File-top level)
"BLD",7241,4,362.3,2,362.3,1,0)
^9.6411^.04^1
"BLD",7241,4,362.3,2,362.3,1,.04,0)
POA INDICATOR
"BLD",7241,4,362.3,222)
y^y^p^^^^n^^n
"BLD",7241,4,362.3,224)

"BLD",7241,4,364.6,0)
364.6
"BLD",7241,4,364.6,222)
n^n^f^^y^^y^o^n
"BLD",7241,4,364.6,224)
I $$INCLUDE^IBY403PR(6,Y)
"BLD",7241,4,364.7,0)
364.7
"BLD",7241,4,364.7,222)
n^n^f^^y^^y^o^n
"BLD",7241,4,364.7,224)
I $$INCLUDE^IBY403PR(7,Y)
"BLD",7241,4,"APDD",362.3,362.3)

"BLD",7241,4,"APDD",362.3,362.3,.04)

"BLD",7241,4,"B",350.8,350.8)

"BLD",7241,4,"B",362.3,362.3)

"BLD",7241,4,"B",364.6,364.6)

"BLD",7241,4,"B",364.7,364.7)

"BLD",7241,6.3)
24
"BLD",7241,"INI")
IBY403PR
"BLD",7241,"INID")
^^y
"BLD",7241,"KRN",0)
^9.67PA^8989.52^19
"BLD",7241,"KRN",.4,0)
.4
"BLD",7241,"KRN",.401,0)
.401
"BLD",7241,"KRN",.402,0)
.402
"BLD",7241,"KRN",.403,0)
.403
"BLD",7241,"KRN",.5,0)
.5
"BLD",7241,"KRN",.84,0)
.84
"BLD",7241,"KRN",3.6,0)
3.6
"BLD",7241,"KRN",3.8,0)
3.8
"BLD",7241,"KRN",9.2,0)
9.2
"BLD",7241,"KRN",9.8,0)
9.8
"BLD",7241,"KRN",9.8,"NM",0)
^9.68A^15^11
"BLD",7241,"KRN",9.8,"NM",1,0)
IBCE277^^0^B49622694
"BLD",7241,"KRN",9.8,"NM",6,0)
IBCESRV2^^0^B60363273
"BLD",7241,"KRN",9.8,"NM",7,0)
IBCEU4^^0^B53347889
"BLD",7241,"KRN",9.8,"NM",8,0)
IBCSC4^^0^B23702708
"BLD",7241,"KRN",9.8,"NM",9,0)
IBCSC4D^^0^B54553691
"BLD",7241,"KRN",9.8,"NM",10,0)
IBCSC4F^^0^B24461587
"BLD",7241,"KRN",9.8,"NM",11,0)
IBCSC4E^^0^B44983116
"BLD",7241,"KRN",9.8,"NM",12,0)
IBCCC3^^0^B9625703
"BLD",7241,"KRN",9.8,"NM",13,0)
IBCEF2^^0^B62749444
"BLD",7241,"KRN",9.8,"NM",14,0)
IBCBB2^^0^B44800809
"BLD",7241,"KRN",9.8,"NM",15,0)
IBCBB21^^0^B11171395
"BLD",7241,"KRN",9.8,"NM","B","IBCBB2",14)

"BLD",7241,"KRN",9.8,"NM","B","IBCBB21",15)

"BLD",7241,"KRN",9.8,"NM","B","IBCCC3",12)

"BLD",7241,"KRN",9.8,"NM","B","IBCE277",1)

"BLD",7241,"KRN",9.8,"NM","B","IBCEF2",13)

"BLD",7241,"KRN",9.8,"NM","B","IBCESRV2",6)

"BLD",7241,"KRN",9.8,"NM","B","IBCEU4",7)

"BLD",7241,"KRN",9.8,"NM","B","IBCSC4",8)

"BLD",7241,"KRN",9.8,"NM","B","IBCSC4D",9)

"BLD",7241,"KRN",9.8,"NM","B","IBCSC4E",11)

"BLD",7241,"KRN",9.8,"NM","B","IBCSC4F",10)

"BLD",7241,"KRN",19,0)
19
"BLD",7241,"KRN",19.1,0)
19.1
"BLD",7241,"KRN",101,0)
101
"BLD",7241,"KRN",409.61,0)
409.61
"BLD",7241,"KRN",771,0)
771
"BLD",7241,"KRN",870,0)
870
"BLD",7241,"KRN",8989.51,0)
8989.51
"BLD",7241,"KRN",8989.52,0)
8989.52
"BLD",7241,"KRN",8994,0)
8994
"BLD",7241,"KRN","B",.4,.4)

"BLD",7241,"KRN","B",.401,.401)

"BLD",7241,"KRN","B",.402,.402)

"BLD",7241,"KRN","B",.403,.403)

"BLD",7241,"KRN","B",.5,.5)

"BLD",7241,"KRN","B",.84,.84)

"BLD",7241,"KRN","B",3.6,3.6)

"BLD",7241,"KRN","B",3.8,3.8)

"BLD",7241,"KRN","B",9.2,9.2)

"BLD",7241,"KRN","B",9.8,9.8)

"BLD",7241,"KRN","B",19,19)

"BLD",7241,"KRN","B",19.1,19.1)

"BLD",7241,"KRN","B",101,101)

"BLD",7241,"KRN","B",409.61,409.61)

"BLD",7241,"KRN","B",771,771)

"BLD",7241,"KRN","B",870,870)

"BLD",7241,"KRN","B",8989.51,8989.51)

"BLD",7241,"KRN","B",8989.52,8989.52)

"BLD",7241,"KRN","B",8994,8994)

"BLD",7241,"QDEF")
^^^^^^^^^^
"BLD",7241,"QUES",0)
^9.62^^
"BLD",7241,"REQB",0)
^9.611^8^5
"BLD",7241,"REQB",1,0)
IB*2.0*266^2
"BLD",7241,"REQB",2,0)
IB*2.0*290^2
"BLD",7241,"REQB",5,0)
IB*2.0*368^2
"BLD",7241,"REQB",7,0)
IB*2.0*371^2
"BLD",7241,"REQB",8,0)
IB*2.0*405^2
"BLD",7241,"REQB","B","IB*2.0*266",1)

"BLD",7241,"REQB","B","IB*2.0*290",2)

"BLD",7241,"REQB","B","IB*2.0*368",5)

"BLD",7241,"REQB","B","IB*2.0*371",7)

"BLD",7241,"REQB","B","IB*2.0*405",8)

"DATA",350.8,71,0)
IB NO DX^A claim must contain an ICD-9 diagnosis.^IB071^1^3
"DATA",350.8,385,0)
IB117^The Principal (first-entered) diagnosis cannot be an Ecode.^IB117^1
"DATA",364.6,93,0)
8^N^^90^1^^0^3^2^Diagnosis Code Qualifier^^1
"DATA",364.6,952,0)
8^N^^50^1^^0^36^10^BLANK^0^1
"DATA",364.6,1879,0)
8^N^^90^1^^0^4^1^POA Indicator^0^1
"DATA",364.7,27,0)
92^N^86^^^^N
"DATA",364.7,27,1)
N A,C,R,Z M A=IBXDATA S (Z,R)=0,C=1 K IBXDATA F  S Z=$O(A(Z)) Q:'Z  S A=$TR($P($G(^ICD9(+A(Z),0)),U),".") I A'="" D ID1^IBCEF2(.R,.A,.C) Q:C=""  I A'="" S IBXDATA(R)=A
"DATA",364.7,27,3,0)
^364.73^9^9^3040303^^^^
"DATA",364.7,27,3,1,0)
This is a group data element so more than 1 occurrence of a value is
"DATA",364.7,27,3,2,0)
possible for the data element in the IBXDATA array.  Each diagnosis code
"DATA",364.7,27,3,3,0)
name is stripped of its decimal point and is output on its own DCn entry
"DATA",364.7,27,3,4,0)
where n is a record count that will allow it to be mapped into one of the
"DATA",364.7,27,3,5,0)
12 available pieces of the 837 diagnosis code record correctly.  This is
"DATA",364.7,27,3,6,0)
done to accommodate Austin's translator and one of its shortcomings.  Save
"DATA",364.7,27,3,7,0)
off the extract sequence # of each diagnosis output in the global array
"DATA",364.7,27,3,8,0)
^TMP("IBXSAVE",$J,"DX") for later use.
"DATA",364.7,27,3,9,0)
Z>4 ADDED TO PREVENT SENDING MORE THAN 4 DIAG CODES (BL)
"DATA",364.7,41,0)
93^N^5^^^^N
"DATA",364.7,41,1)
K IBXDATA N Z S Z=0 F  S Z=$O(^TMP("DCX",$J,1,Z)) Q:'Z  S IBXDATA(Z)=$P(^TMP("DCX",$J,1,Z),U,2)
"DATA",364.7,41,3,0)
^^1^1^2960815^^^^
"DATA",364.7,41,3,1,0)
This is diagnosis qualifier.
"DATA",364.7,84,0)
153^N^100^^^^N
"DATA",364.7,84,1)
K IBXSAVE,^TMP("DCX",$J)
"DATA",364.7,84,3,0)
^^1^1^2990218^^^^
"DATA",364.7,84,3,1,0)
Cleans up IBXSAVE and ^TMP("DCX") arrays. No output.
"DATA",364.7,924,0)
952^N^5^^^^N
"DATA",364.7,924,1)
K IBXDATA
"DATA",364.7,924,3,0)
^^1^1^2990614^^^^
"DATA",364.7,924,3,1,0)
This field is blank.
"DATA",364.7,1015,0)
1014^N^5^^^^N
"DATA",364.7,1015,1)
S IBXDATA="403.0" I '$$PROD^XUPROD(1) S $E(IBXDATA,11)="D"
"DATA",364.7,1015,3,0)
^364.73^7^7^3060807^^^^
"DATA",364.7,1015,3,1,0)
This field contains the VistA IB patch# that pertains to the
"DATA",364.7,1015,3,2,0)
applicable changes in the claim map.  Austin uses this field to determine
"DATA",364.7,1015,3,3,0)
which set of EDI claim maps to use when processing the EDI claims.
"DATA",364.7,1015,3,4,0)

"DATA",364.7,1015,3,5,0)
If the EDI claims are being transmitted from a non-production account,
"DATA",364.7,1015,3,6,0)
then the "D" in the 11th position indicates to Austin that it is test
"DATA",364.7,1015,3,7,0)
data.
"DATA",364.7,1298,0)
1598^N^86^^^^N
"DATA",364.7,1298,1)
N C,Z,Z0,IBZ M IBZ=IBXDATA K IBXDATA S (C,Z)=0 F  S Z=$O(IBZ(Z)) Q:'Z  I '$$ECODE^IBCEU4(+IBZ(Z)) S C=C+1 S:C=1 IBXDATA=$P($G(^ICD9(+IBZ(Z),0)),U) S IBXSAVE("DX",C)=+IBZ(Z)_U_$$GETPOA^IBCEU4($P(IBZ(Z),U,2),1)
"DATA",364.7,1298,3,0)
^^3^3^3061121^
"DATA",364.7,1298,3,1,0)
The principal dx is found in the first occurrence of the data element's
"DATA",364.7,1298,3,2,0)
values.  The diagnoses are saved off in the IBXSAVE("DX") array for later
"DATA",364.7,1298,3,3,0)
use.  Only allow 3 E-codes.
"DATA",364.7,1371,0)
1671^N^5^^^^N
"DATA",364.7,1371,1)
K IBXDATA N IBZ,Z,Z0,C D F^IBCEF("N-DIAGNOSES","IBZ",,IBXIEN) S (C,Z)=0 F  S Z=$O(IBZ(Z)) Q:'Z  I $$ECODE^IBCEU4(+IBZ(Z),.Z0),$G(Z0)'="" S C=C+1,IBXSAVE("DX-E",C)=Z0_U_$$GETPOA^IBCEU4($P(IBZ(Z),U,2),1) S:C=1 IBXDATA=Z0 Q:C=3
"DATA",364.7,1371,3,0)
^364.73^3^3^3061125^^^^
"DATA",364.7,1371,3,1,0)
This data element creates an array containing E-code diagnoses for
"DATA",364.7,1371,3,2,0)
the bill and corresponding POA indicators. IBXDATA is set to the
"DATA",364.7,1371,3,3,0)
first 'E-code' dx found.
"DATA",364.7,1383,0)
1683^N^5^^^^N
"DATA",364.7,1383,1)
I $D(IBXSAVE("DX",1)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",1),U,2),1:" ") K IBXSAVE("DX",1)
"DATA",364.7,1383,3,0)
^^3^3^3061121^
"DATA",364.7,1383,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1383,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1383,3,3,0)
POA indicator is available.
"DATA",364.7,1384,0)
1684^N^5^^^^N
"DATA",364.7,1384,1)
I $D(IBXSAVE("DX",2)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",2),U,2),1:" ") K IBXSAVE("DX",2)
"DATA",364.7,1384,3,0)
^^3^3^3061121^
"DATA",364.7,1384,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1384,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1384,3,3,0)
POA indicator is available.
"DATA",364.7,1385,0)
1685^N^5^^^^N
"DATA",364.7,1385,1)
I $D(IBXSAVE("DX",3)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",3),U,2),1:" ") K IBXSAVE("DX",3)
"DATA",364.7,1385,3,0)
^^3^3^3061121^
"DATA",364.7,1385,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1385,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1385,3,3,0)
POA indicator is available.
"DATA",364.7,1386,0)
1686^N^5^^^^N
"DATA",364.7,1386,1)
I $D(IBXSAVE("DX",4)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",4),U,2),1:" ") K IBXSAVE("DX",4)
"DATA",364.7,1386,3,0)
^^3^3^3061121^
"DATA",364.7,1386,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1386,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1386,3,3,0)
POA indicator is available.
"DATA",364.7,1387,0)
1687^N^5^^^^N
"DATA",364.7,1387,1)
I $D(IBXSAVE("DX",5)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",5),U,2),1:" ") K IBXSAVE("DX",5)
"DATA",364.7,1387,3,0)
^^3^3^3061121^
"DATA",364.7,1387,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1387,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1387,3,3,0)
POA indicator is available.
"DATA",364.7,1388,0)
1688^N^5^^^^N
"DATA",364.7,1388,1)
I $D(IBXSAVE("DX",6)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",6),U,2),1:" ") K IBXSAVE("DX",6)
"DATA",364.7,1388,3,0)
^^3^3^3061121^
"DATA",364.7,1388,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1388,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1388,3,3,0)
POA indicator is available.
"DATA",364.7,1389,0)
1689^N^5^^^^N
"DATA",364.7,1389,1)
I $D(IBXSAVE("DX",7)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",7),U,2),1:" ") K IBXSAVE("DX",7)
"DATA",364.7,1389,3,0)
^^3^3^3061121^
"DATA",364.7,1389,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1389,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1389,3,3,0)
POA indicator is available.
"DATA",364.7,1390,0)
1690^N^5^^^^N
"DATA",364.7,1390,1)
I $D(IBXSAVE("DX",8)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",8),U,2),1:" ") K IBXSAVE("DX",8)
"DATA",364.7,1390,3,0)
^^3^3^3061121^
"DATA",364.7,1390,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1390,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1390,3,3,0)
POA indicator is available.
"DATA",364.7,1391,0)
1691^N^5^^^^N
"DATA",364.7,1391,1)
I $D(IBXSAVE("DX",9)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",9),U,2),1:" ") K IBXSAVE("DX",9)
"DATA",364.7,1391,3,0)
^^3^3^3061121^
"DATA",364.7,1391,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1391,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1391,3,3,0)
POA indicator is available.
"DATA",364.7,1392,0)
1692^N^5^^^^N
"DATA",364.7,1392,1)
I $D(IBXSAVE("DX",10)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",10),U,2),1:" ") K IBXSAVE("DX",10)
"DATA",364.7,1392,3,0)
^^3^3^3061121^
"DATA",364.7,1392,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1392,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1392,3,3,0)
POA indicator is available.
"DATA",364.7,1393,0)
1693^N^5^^^^N
"DATA",364.7,1393,1)
I $D(IBXSAVE("DX",11)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",11),U,2),1:" ") K IBXSAVE("DX",11)
"DATA",364.7,1393,3,0)
^^3^3^3061121^
"DATA",364.7,1393,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1393,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1393,3,3,0)
POA indicator is available.
"DATA",364.7,1394,0)
1694^N^5^^^^N
"DATA",364.7,1394,1)
I $D(IBXSAVE("DX",12)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",12),U,2),1:" ") K IBXSAVE("DX",12)
"DATA",364.7,1394,3,0)
^^3^3^3061121^
"DATA",364.7,1394,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1394,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1394,3,3,0)
POA indicator is available.
"DATA",364.7,1395,0)
1695^N^5^^^^N
"DATA",364.7,1395,1)
I $D(IBXSAVE("DX",13)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",13),U,2),1:" ") K IBXSAVE("DX",13)
"DATA",364.7,1395,3,0)
^^3^3^3061121^
"DATA",364.7,1395,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1395,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1395,3,3,0)
POA indicator is available.
"DATA",364.7,1396,0)
1696^N^5^^^^N
"DATA",364.7,1396,1)
I $D(IBXSAVE("DX",14)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",14),U,2),1:" ") K IBXSAVE("DX",14)
"DATA",364.7,1396,3,0)
^^3^3^3061121^
"DATA",364.7,1396,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1396,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1396,3,3,0)
POA indicator is available.
"DATA",364.7,1397,0)
1697^N^5^^^^N
"DATA",364.7,1397,1)
I $D(IBXSAVE("DX",15)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",15),U,2),1:" ") K IBXSAVE("DX",15)
"DATA",364.7,1397,3,0)
^^3^3^3061121^
"DATA",364.7,1397,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1397,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1397,3,3,0)
POA indicator is available.
"DATA",364.7,1398,0)
1698^N^5^^^^N
"DATA",364.7,1398,1)
I $D(IBXSAVE("DX",16)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",16),U,2),1:" ") K IBXSAVE("DX",16)
"DATA",364.7,1398,3,0)
^^3^3^3061121^
"DATA",364.7,1398,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1398,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1398,3,3,0)
POA indicator is available.
"DATA",364.7,1399,0)
1699^N^5^^^^N
"DATA",364.7,1399,1)
I $D(IBXSAVE("DX",17)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",17),U,2),1:" ") K IBXSAVE("DX",17)
"DATA",364.7,1399,3,0)
^^3^3^3061121^
"DATA",364.7,1399,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1399,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1399,3,3,0)
POA indicator is available.
"DATA",364.7,1400,0)
1700^N^5^^^^N
"DATA",364.7,1400,1)
I $D(IBXSAVE("DX",18)) S IBXDATA=$S($$INPAT^IBCEF(IBXIEN):$P(IBXSAVE("DX",18),U,2),1:" ") K IBXSAVE("DX",18)
"DATA",364.7,1400,3,0)
^^3^3^3061121^
"DATA",364.7,1400,3,1,0)
This is the present on admissions indicator.  The value "U" (No
"DATA",364.7,1400,3,2,0)
Information in the Record) is sent for INPATIENT claims if no
"DATA",364.7,1400,3,3,0)
POA indicator is available.
"DATA",364.7,1411,0)
1711^N^5^^^^N
"DATA",364.7,1411,1)
K IBXDATA S:$$INPAT^IBCEF(IBXIEN) IBXDATA=$P($G(IBXSAVE("DX-E",1)),U,2) K IBXSAVE("DX-E",1)
"DATA",364.7,1411,3,0)
^364.73^3^3^3070523^^^^
"DATA",364.7,1411,3,1,0)
This is the Present on Admission indicator for the first 'E-code' 
"DATA",364.7,1411,3,2,0)
diagnosis.  The value "U" (No Information in the Record) is sent 
"DATA",364.7,1411,3,3,0)
for INPATIENT claims if no POA indicator is available.
"DATA",364.7,1579,0)
1879^N^5^^^^N
"DATA",364.7,1579,1)
K IBXDATA N Z S Z=0 F  S Z=$O(^TMP("DCX",$J,1,Z)) Q:'Z  S IBXDATA(Z)=$P(^TMP("DCX",$J,1,Z),U,3)
"DATA",364.7,1579,3,0)
^^1^1^3080905^
"DATA",364.7,1579,3,1,0)
POA indicator for this diagnosis. Defaults to "1".
"FIA",350.8)
IB ERROR
"FIA",350.8,0)
^IBE(350.8,
"FIA",350.8,0,0)
350.8I
"FIA",350.8,0,1)
n^n^f^^n^^y^o^n
"FIA",350.8,0,10)

"FIA",350.8,0,11)
I $$INC3508^IBY403PR(Y)
"FIA",350.8,0,"RLRO")

"FIA",350.8,0,"VR")
2.0^IB
"FIA",350.8,350.8)
0
"FIA",362.3)
IB BILL/CLAIMS DIAGNOSIS
"FIA",362.3,0)
^IBA(362.3,
"FIA",362.3,0,0)
362.3IP
"FIA",362.3,0,1)
y^y^p^^^^n^^n
"FIA",362.3,0,10)

"FIA",362.3,0,11)

"FIA",362.3,0,"RLRO")

"FIA",362.3,0,"VR")
2.0^IB
"FIA",362.3,362.3)
1
"FIA",362.3,362.3,.04)

"FIA",364.6)
IB FORM SKELETON DEFINITION
"FIA",364.6,0)
^IBA(364.6,
"FIA",364.6,0,0)
364.6IP
"FIA",364.6,0,1)
n^n^f^^y^^y^o^n
"FIA",364.6,0,10)

"FIA",364.6,0,11)
I $$INCLUDE^IBY403PR(6,Y)
"FIA",364.6,0,"RLRO")

"FIA",364.6,0,"VR")
2.0^IB
"FIA",364.6,364.6)
0
"FIA",364.7)
IB FORM FIELD CONTENT
"FIA",364.7,0)
^IBA(364.7,
"FIA",364.7,0,0)
364.7IP
"FIA",364.7,0,1)
n^n^f^^y^^y^o^n
"FIA",364.7,0,10)

"FIA",364.7,0,11)
I $$INCLUDE^IBY403PR(7,Y)
"FIA",364.7,0,"RLRO")

"FIA",364.7,0,"VR")
2.0^IB
"FIA",364.7,364.7)
0
"FIA",364.7,364.73)
0
"INI")
IBY403PR
"IX",364.6,364.6,"ALL",0)
364.6^ALL^Allows for identification of local override fields that apply to ALL^MU^^F^IR^I^364.6^^^^^S
"IX",364.6,364.6,"ALL",1)
S ^IBA(364.7,"ALL",DA,X2(5))=""
"IX",364.6,364.6,"ALL",1.4)
I X2(4)'="L"!'X2(5)!(X2(2)'="")!(X2(3)'="")!'X2(1) S X=0
"IX",364.6,364.6,"ALL",2)
K ^IBA(364.7,"ALL",DA,X1(5))
"IX",364.6,364.6,"ALL",2.4)
I X1(4)'="L"!'X1(5)!(X1(2)'="")!(X1(3)'="")!'X1(1) S X=0
"IX",364.6,364.6,"ALL",2.5)
K ^IBA(364.7,"ALL")
"IX",364.6,364.6,"ALL",11.1,0)
^.114IA^5^5
"IX",364.6,364.6,"ALL",11.1,1,0)
1^F^364.6^.03^^1^F
"IX",364.6,364.6,"ALL",11.1,1,1)
 
"IX",364.6,364.6,"ALL",11.1,2,0)
2^C
"IX",364.6,364.6,"ALL",11.1,2,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,5)
"IX",364.6,364.6,"ALL",11.1,3,0)
3^C
"IX",364.6,364.6,"ALL",11.1,3,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,6)
"IX",364.6,364.6,"ALL",11.1,4,0)
4^C
"IX",364.6,364.6,"ALL",11.1,4,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,2)
"IX",364.6,364.6,"ALL",11.1,5,0)
5^C
"IX",364.6,364.6,"ALL",11.1,5,1.5)
S X=+$O(^IBA(364.7,"B",DA,0))
"IX",364.6,364.6,"C",0)
364.6^C^Field name lookup^R^^F^IR^I^364.6^^^^^LS
"IX",364.6,364.6,"C",1)
S ^IBA(364.6,"C",$E(X,1,40),DA)=""
"IX",364.6,364.6,"C",2)
K ^IBA(364.6,"C",$E(X,1,40),DA)
"IX",364.6,364.6,"C",2.5)
K ^IBA(364.6,"C")
"IX",364.6,364.6,"C",11.1,0)
^.114IA^1^1
"IX",364.6,364.6,"C",11.1,1,0)
1^F^364.6^.1^40^1^F
"IX",364.6,364.6,"C",11.1,1,2)
S X=$$UP^XLFSTR(X)
"IX",364.6,364.6,"D",0)
364.6^D^XREF BY FORM,PAGE,LINE,COL TO SIMPLIFY DEVELOPMENT^MU^^R^IR^I^364.6^^^^^LS
"IX",364.6,364.6,"D",1)
S ^IBA(364.6,"D",X2(1)_","_X2(2)_","_X2(3)_","_X2(4),DA)=""
"IX",364.6,364.6,"D",1.4)
I X2(1)=""!(X2(2)="")!(X2(3)="")!(X2(4)="") S X=0
"IX",364.6,364.6,"D",2)
K ^IBA(364.6,"D",X1(1)_","_X1(2)_","_X1(3)_","_X1(4),DA)
"IX",364.6,364.6,"D",2.4)
I X1(1)=""!(X1(2)="")!(X1(3)="")!(X1(4)="") S X=0
"IX",364.6,364.6,"D",2.5)
K ^IBA(364.6,"D")
"IX",364.6,364.6,"D",11.1,0)
^.114IA^4^4
"IX",364.6,364.6,"D",11.1,1,0)
1^F^364.6^.01^^1^F
"IX",364.6,364.6,"D",11.1,2,0)
2^F^364.6^.04^^^F
"IX",364.6,364.6,"D",11.1,3,0)
3^F^364.6^.05^^^F
"IX",364.6,364.6,"D",11.1,4,0)
4^F^364.6^.08^^^F
"IX",364.7,364.7,"ALL",0)
364.7^ALL^Xref contains all local overrides defined for all insurance and type^MU^^F^IR^I^364.7^^^^^S
"IX",364.7,364.7,"ALL",1)
S ^IBA(364.7,"ALL",X2(2),DA)=""
"IX",364.7,364.7,"ALL",1.4)
I 'X2(2)!(X2(4)'="")!(X2(5)'="")!(X2(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2)
K ^IBA(364.7,"ALL",X1(2),DA)
"IX",364.7,364.7,"ALL",2.4)
I 'X1(2)!(X1(4)'="")!(X1(5)'="")!(X1(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2.5)
K ^IBA(364.7,"ALL")
"IX",364.7,364.7,"ALL",11.1,0)
^.114IA^5^5
"IX",364.7,364.7,"ALL",11.1,1,0)
1^F^364.7^.01^15^^F
"IX",364.7,364.7,"ALL",11.1,1,3)
 
"IX",364.7,364.7,"ALL",11.1,2,0)
2^C^^^10^1
"IX",364.7,364.7,"ALL",11.1,2,1.5)
S X=$P($G(^IBA(364.6,+X(1),0)),U,3)
"IX",364.7,364.7,"ALL",11.1,3,0)
3^F^364.7^.02^10^^F
"IX",364.7,364.7,"ALL",11.1,3,3)
 
"IX",364.7,364.7,"ALL",11.1,4,0)
4^F^364.7^.05^20^^F
"IX",364.7,364.7,"ALL",11.1,4,3)
 
"IX",364.7,364.7,"ALL",11.1,5,0)
5^F^364.7^.06^20^^F
"IX",364.7,364.7,"ALL",11.1,5,3)
 
"MBREQ")
0
"PGL",364.6,0,3,.03)
ASSOCIATED FORM DEFINITION^P364.6'^IBA(364.6,^0;3^Q
"PGL",364.7,0,5,.05)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
403^3081204
"PKG",200,22,1,"PAH",1,1,0)
^^1^1^3081204
"PKG",200,22,1,"PAH",1,1,1,0)
eClaims Plus - Diagnosis Present on Admission (POA) Indicator.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
12
"RTN","IBCBB2")
0^14^B44800809^B43441310
"RTN","IBCBB2",1,0)
IBCBB2 ;ALB/ARH - CONTINUATION OF EDIT CHECKS ROUTINE (CMS-1500) ;04/14/92
"RTN","IBCBB2",2,0)
 ;;2.0;INTEGRATED BILLING;**51,137,210,245,232,296,320,349,371,403**;21-MAR-94;Build 24
"RTN","IBCBB2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCBB2",4,0)
 ;
"RTN","IBCBB2",5,0)
 ;MAP TO DGCRBB2
"RTN","IBCBB2",6,0)
 ;
"RTN","IBCBB2",7,0)
EN ;
"RTN","IBCBB2",8,0)
 N IBI,IBJ,IBN,IBY,IBDX,IBDXO,IBDXL,IBDXTYP,IBCPT,IBCPTL,IBOLAB,Z,IBXSAVE,IBLOC,IBTX,IBPS,IBSP,IBLCT,IBNVFLG,IBU3
"RTN","IBCBB2",9,0)
 I '$D(IBER) S IBER=""
"RTN","IBCBB2",10,0)
 S IBTX=$$TXMT^IBCEF4(IBIFN)
"RTN","IBCBB2",11,0)
 ;
"RTN","IBCBB2",12,0)
 ; Max 4 modifiers per CPT code allowed before warning
"RTN","IBCBB2",13,0)
 K IBXDATA
"RTN","IBCBB2",14,0)
 D F^IBCEF("N-HCFA 1500 MODIFIERS",,,IBIFN) ;Get modifiers
"RTN","IBCBB2",15,0)
 ;
"RTN","IBCBB2",16,0)
 S Z=0 F  S Z=$O(IBZPRC92(Z)) Q:'Z  I $P(IBZPRC92(Z),U)["ICPT(",$L($P(IBZPRC92(Z),U,15),",")>4 S IBI="Proc "_$$PRCD^IBCEF1($P(IBZPRC92(Z),U))_" has > 4 modifiers - only first 4 will be used" D WARN^IBCBB11(IBI)
"RTN","IBCBB2",17,0)
 ; ICD-9 diagnosis, at least 1 required
"RTN","IBCBB2",18,0)
 D SET^IBCSC4D(IBIFN,.IBDX,.IBDXO) I '$P(IBDX,U,2) S IBER=IBER_"IB071;"
"RTN","IBCBB2",19,0)
 S IBI=$O(IBDXO(0))
"RTN","IBCBB2",20,0)
 I IBI D
"RTN","IBCBB2",21,0)
 .S IBDXTYP=$E($$ICD9^IBACSV(+$P(IBDXO(IBI),U)))
"RTN","IBCBB2",22,0)
 .S:IBDXTYP="E" IBER=IBER_"IB117;"
"RTN","IBCBB2",23,0)
 .I $$INPAT^IBCEF(IBIFN,1),IBDXTYP="V" S Z="Principal Dx V-code may not be valid" D WARN^IBCBB11(Z)
"RTN","IBCBB2",24,0)
 .Q
"RTN","IBCBB2",25,0)
 ;
"RTN","IBCBB2",26,0)
 ; CPT procs must be associated with a dx, must have a defined provider
"RTN","IBCBB2",27,0)
 S (IBLOC,IBN,IBI,IBY)=0 F  S IBI=$O(^DGCR(399,IBIFN,"CP",IBI)) Q:IBI'?1N.N  S IBCPT=^(IBI,0) D  I +IBY S IBN=1
"RTN","IBCBB2",28,0)
 . I 'IBLOC,$P(IBCPT,U,15)'="",IBTX S Z="At least 1 charge has local box 24K data that will not be transmitted - " S IBLOC=1 D WARN^IBCBB11(Z) S Z="  This data will only print locally" D WARN^IBCBB11(Z)
"RTN","IBCBB2",29,0)
 . I $P(IBCPT,U)'["ICPT(" S:IBER'["IB092" IBER=IBER_"IB092;" Q
"RTN","IBCBB2",30,0)
 . S IBY=1 F IBJ=11:1:14 I +$P(IBCPT,"^",IBJ) S IBCPTL(+$P(IBCPT,"^",IBJ))="",IBY=0
"RTN","IBCBB2",31,0)
 I +IBN S IBER=IBER_"IB072;"
"RTN","IBCBB2",32,0)
 ;
"RTN","IBCBB2",33,0)
 I '$$OCC10(IBIFN,.IBDX,2) S IBER=IBER_"IB093;"
"RTN","IBCBB2",34,0)
 ; CMS-1500: dxs associated with procs must be defined dxs for the bill
"RTN","IBCBB2",35,0)
 S IBI=0 F  S IBI=$O(IBDX(IBI))  Q:'IBI  S IBDXL(IBDX(IBI))=""
"RTN","IBCBB2",36,0)
 S (IBN,IBI)=0 F  S IBI=$O(IBCPTL(IBI)) Q:'IBI  I '$D(IBDXL(IBI)) S IBN=1 Q
"RTN","IBCBB2",37,0)
 I +IBN S IBER=IBER_"IB073;"
"RTN","IBCBB2",38,0)
 ; ejk *296* Change # of diagnoses codes from 4 to 8 on CMS-1500 Claims. 
"RTN","IBCBB2",39,0)
 I IBTX S IBI=8 F  S IBI=$O(IBDXO(IBI)) Q:'IBI  S Z=+$G(IBDX(+$G(IBDXO(IBI)))) I Z,$D(IBCPTL(Z)) D WARN^IBCBB11("Too many diagnoses for claim & will be rejected - consider printing locally")
"RTN","IBCBB2",40,0)
 ;
"RTN","IBCBB2",41,0)
 I $$WNRBILL^IBEFUNC(IBIFN),$$MRATYPE^IBEFUNC(IBIFN)'="B" S IBER=IBER_"IB087;"
"RTN","IBCBB2",42,0)
 ;
"RTN","IBCBB2",43,0)
 ; IB*320 - CLIA# error/warning - error msg for MRA claims, else warning
"RTN","IBCBB2",44,0)
 I $P(IBNDU2,U,13)="",$$CLIAREQ^IBCEP8A(IBIFN) D
"RTN","IBCBB2",45,0)
 . I $$REQMRA^IBEFUNC(IBIFN) S IBER=IBER_"IB235;" Q
"RTN","IBCBB2",46,0)
 . D WARN^IBCBB11("Claim contains laboratory services. The payer may require a CLIA #.")
"RTN","IBCBB2",47,0)
 . Q
"RTN","IBCBB2",48,0)
 ;
"RTN","IBCBB2",49,0)
 ; Only one occurrence code can be present for event date for box 14
"RTN","IBCBB2",50,0)
 S Z=$$EVENT^IBCF22(IBIFN,.IBXSAVE,.IBI)
"RTN","IBCBB2",51,0)
 I IBI S IBER=IBER_"IB099;"
"RTN","IBCBB2",52,0)
 ;
"RTN","IBCBB2",53,0)
 ; esg - 6/6/07 - warning if missing non-VA care type for outside facility
"RTN","IBCBB2",54,0)
 S IBNVFLG=0
"RTN","IBCBB2",55,0)
 I $P(IBNDU2,U,10),'$P(IBNDU2,U,11) D WARN^IBCBB11("Non-VA facility indicated, but the Non-VA Care Type field is not defined") S IBNVFLG=1
"RTN","IBCBB2",56,0)
 ;
"RTN","IBCBB2",57,0)
 ; unit/charge limits
"RTN","IBCBB2",58,0)
 K IBXDATA
"RTN","IBCBB2",59,0)
 D F^IBCEF("N-HCFA 1500 SERVICES (PRINT)",,,IBIFN) ;Get charge lines
"RTN","IBCBB2",60,0)
 S (IBLCT,IBOLAB)=0,IBPS="",IBSP=$$BILLSPEC^IBCEU3(IBIFN)
"RTN","IBCBB2",61,0)
 S IBI=0 F  S IBI=$O(IBXDATA(IBI)) Q:'IBI  D  Q:IBER["IB310"!(IBER["IB311")
"RTN","IBCBB2",62,0)
 . S IBLCT=IBLCT+1
"RTN","IBCBB2",63,0)
 . I $P(IBNDU2,U,11) D
"RTN","IBCBB2",64,0)
 .. I '$P(IBXDATA(IBI),U,11) S IBPS=IBPS_$S(IBPS'="":",",1:"")_IBI Q
"RTN","IBCBB2",65,0)
 .. I $P(IBXDATA(IBI),U,14),"24"'[$P(IBNDU2,U,11) D WARN^IBCBB11("Outside lab charges exist on a non-lab NON-VA bill")
"RTN","IBCBB2",66,0)
 . I '$P(IBNDU2,U,11),$P(IBXDATA(IBI),U,11) D WARN^IBCBB11("Purchased service amounts are invalid unless this is a NON-VA bill")
"RTN","IBCBB2",67,0)
 . I IBNVFLG,'$P(IBXDATA(IBI),U,11) D WARN^IBCBB11("Non-VA facility indicated, but no purchased service charge on line# "_IBI)
"RTN","IBCBB2",68,0)
 . I $D(IBXDATA(IBI,"A")) S IBER=IBER_"IB310;" Q
"RTN","IBCBB2",69,0)
 . I $D(IBXDATA(IBI,"ARX")),IBER'["311;" S IBER=IBER_"IB311;" Q
"RTN","IBCBB2",70,0)
 . I $P(IBXDATA(IBI),U,14) S IBOLAB=IBOLAB+1
"RTN","IBCBB2",71,0)
 . ; Place of service required
"RTN","IBCBB2",72,0)
 . I $G(IBER)'["IB314;",$P(IBXDATA(IBI),U,3)="" S IBER=IBER_"IB314;"
"RTN","IBCBB2",73,0)
 . ; Type of service required
"RTN","IBCBB2",74,0)
 . I $G(IBER)'["IB313;",$P(IBXDATA(IBI),U,4)="" S IBER=IBER_"IB313;"
"RTN","IBCBB2",75,0)
 . ; 43 and 53 are invalid types of service
"RTN","IBCBB2",76,0)
 . I $G(IBER)'["IB110;",($P(IBXDATA(IBI),U,4)=43!($P(IBXDATA(IBI),U,4)=53)) S IBER=IBER_"IB110;"
"RTN","IBCBB2",77,0)
 . ; Units for the line item must be less than 100/1000
"RTN","IBCBB2",78,0)
 . I IBER'["IB088",$P(IBXDATA(IBI),U,9)'<100 D
"RTN","IBCBB2",79,0)
 .. I $P(IBXDATA(IBI),U,4)'=7 S IBER=IBER_"IB088;" Q
"RTN","IBCBB2",80,0)
 .. I $P(IBXDATA(IBI),U,9)'<1000 S IBER=IBER_"IB088;"
"RTN","IBCBB2",81,0)
 . ; Line item total charge must be less than $10,000.00, greater than 0
"RTN","IBCBB2",82,0)
 . I IBER'["IB090",$P(IBXDATA(IBI),U,9)'<10000 S IBER=IBER_"IB090;"
"RTN","IBCBB2",83,0)
 . I '($P(IBXDATA(IBI),U,9)*$P(IBXDATA(IBI),U,8)),$$COBN^IBCEF(IBIFN)'>1 S Z="Procedure "_$P(IBXDATA(IBI),U,5)_" has a 0-charge and will not be transmitted" D WARN^IBCBB11(Z)
"RTN","IBCBB2",84,0)
 I IBTX,IBLCT>50 D
"RTN","IBCBB2",85,0)
 . I '$$REQMRA^IBEFUNC(IBIFN) S IBER=IBER_"IB308;" Q
"RTN","IBCBB2",86,0)
 . I '$P(IBNDTX,U,9) S IBER=IBER_"IB325;"
"RTN","IBCBB2",87,0)
 S IBU3=$P($G(^DGCR(399,IBIFN,"U3")),U,4,7) I $TR(IBU3,U)'="" D
"RTN","IBCBB2",88,0)
 .I +IBSP'=35 D WARN^IBCBB11("Chiropractic service details only valid if provider specialty is '35'")
"RTN","IBCBB2",89,0)
 .I $P(IBU3,U,2)="" S IBER=IBER_"IB137;"
"RTN","IBCBB2",90,0)
 .I $P(IBU3,U,4)="" S IBER=IBER_"IB138;" Q
"RTN","IBCBB2",91,0)
 .I $P(IBU3,U,3)="","AM"[$P(IBU3,U,4) S IBER=IBER_"IB139;"
"RTN","IBCBB2",92,0)
 .Q
"RTN","IBCBB2",93,0)
 I IBPS'="" D WARN^IBCBB11("NON-VA facility indicated, but no purchased service charge on line item"_$S(IBPS[",":"s",1:"")_" #"_IBPS)
"RTN","IBCBB2",94,0)
 I $P(IBNDU2,U,11),$P(IBNDU2,U,11)=4,IBOLAB>1 D WARN^IBCBB11("For proper payment, you must bill each outside lab on a separate claim form")
"RTN","IBCBB2",95,0)
 K IBXDATA
"RTN","IBCBB2",96,0)
 ;
"RTN","IBCBB2",97,0)
 ;       ; Check for Physician Name
"RTN","IBCBB2",98,0)
 D F^IBCEF("N-REFERRING PROVIDER NAME",,,IBIFN)
"RTN","IBCBB2",99,0)
 I $P($G(IBXDATA),U)]"" D
"RTN","IBCBB2",100,0)
 .N IBZ,FUNCTION,IBINS
"RTN","IBCBB2",101,0)
 .S FUNCTION=1
"RTN","IBCBB2",102,0)
 .F IBINS=1:1:3 D
"RTN","IBCBB2",103,0)
 .. S Z=$$GETTYP^IBCEP2A(IBIFN,IBINS,FUNCTION)
"RTN","IBCBB2",104,0)
 .. I Z,$P(Z,U,2) D  ; Rendering/attending prov secondary id required
"RTN","IBCBB2",105,0)
 ... N IBID,IBOK,Q0
"RTN","IBCBB2",106,0)
 ... D PROVINF^IBCEF74(IBIFN,IBINS,.IBID,1,"C")  ; check all as though they were current
"RTN","IBCBB2",107,0)
 ... S IBOK=0
"RTN","IBCBB2",108,0)
 ... S Q0=0 F  S Q0=$O(IBID(1,FUNCTION,Q0)) Q:'Q0  I $P(IBID(1,FUNCTION,Q0),U,9)=+Z S IBOK=1 Q
"RTN","IBCBB2",109,0)
 ... I 'IBOK S IBER=IBER_$S(IBINS=1:"IB239;",IBINS=2:"IB240;",IBINS=3:"IB241;",1:"")
"RTN","IBCBB2",110,0)
 ;
"RTN","IBCBB2",111,0)
 Q
"RTN","IBCBB2",112,0)
 ;
"RTN","IBCBB2",113,0)
OCC10(IBIFN,IBARR,IBFT) ; Determine if occurrence code 10 exists for pregnancy dx
"RTN","IBCBB2",114,0)
 ; IBARR=array subscripted by ien of DX code if IBFT=2 (CMS-1500 form)
"RTN","IBCBB2",115,0)
 ;                         by seq # and = ien of DX code if IBFT'=2
"RTN","IBCBB2",116,0)
 ;
"RTN","IBCBB2",117,0)
 N IBN,IBI,IBXDATA,IBXSAVE,IBDX,Z
"RTN","IBCBB2",118,0)
 S IBN=1
"RTN","IBCBB2",119,0)
 ;
"RTN","IBCBB2",120,0)
 I '$D(^TMP($J,"LMD")) D
"RTN","IBCBB2",121,0)
 . D F^IBCEF("N-OCCURRENCE CODES",,,IBIFN)
"RTN","IBCBB2",122,0)
 . S ^TMP($J,"LMD")=""
"RTN","IBCBB2",123,0)
 . S Z=0 F  S Z=$O(IBXSAVE("OCC",Z)) Q:'Z  I +IBXSAVE("OCC",Z)=10 S ^TMP($J,"LMD")=1 Q
"RTN","IBCBB2",124,0)
 ;
"RTN","IBCBB2",125,0)
 I '^TMP($J,"LMD") S IBI=0 F  S IBI=$O(IBARR(IBI))  Q:'IBI  D  Q:'IBN
"RTN","IBCBB2",126,0)
 . N Z,Z1
"RTN","IBCBB2",127,0)
 . ; If a pregnancy DX exists, must be an occurrence code 10 for LMP date
"RTN","IBCBB2",128,0)
 . ; dx ranges are: V22*-V24*, V27*-V28*, 630*-677*
"RTN","IBCBB2",129,0)
 . S IBDX=$S($G(IBFT)'=2:+IBARR(IBI),1:IBI)
"RTN","IBCBB2",130,0)
 . S Z=$E($P($$ICD9^IBACSV(IBDX),U),1,3),Z1=$E(Z,2,3)
"RTN","IBCBB2",131,0)
 . I $S(Z'<630&(Z<678):1,$E(Z)="V":$S(Z1'<22&(Z1<25):1,1:Z1'<27&(Z1<28)),1:0) S IBN=0 ;Pregnancy Dx exists
"RTN","IBCBB2",132,0)
 ;
"RTN","IBCBB2",133,0)
OCC10Q K ^TMP($J,"LMD")
"RTN","IBCBB2",134,0)
 Q IBN
"RTN","IBCBB2",135,0)
 ;
"RTN","IBCBB21")
0^15^B11171395^B10829240
"RTN","IBCBB21",1,0)
IBCBB21 ;ALB/AAS - CONTINUATION OF EDIT CHECK ROUTINE FOR UB-04 ;2-NOV-89
"RTN","IBCBB21",2,0)
 ;;2.0;INTEGRATED BILLING;**51,137,210,232,155,291,348,349,403**;21-MAR-94;Build 24
"RTN","IBCBB21",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCBB21",4,0)
 ;
"RTN","IBCBB21",5,0)
EN(IBZPRC92) ;
"RTN","IBCBB21",6,0)
 ;
"RTN","IBCBB21",7,0)
 N ECODE,IBTXMT,IBXDATA,IBDXTYP,IBLPRT,IBI,Z,Z0,Z1,IBREQMRA
"RTN","IBCBB21",8,0)
 I '$D(IBZPRC92) D ALLPROC^IBCVA1(IBIFN,.IBZPRC92)
"RTN","IBCBB21",9,0)
 S IBREQMRA=$$REQMRA^IBEFUNC(IBIFN)    ; MRA?
"RTN","IBCBB21",10,0)
 K IBQUIT S IBQUIT=0
"RTN","IBCBB21",11,0)
 S (Z,Z0,Z1)=0
"RTN","IBCBB21",12,0)
 F  S Z=$O(IBZPRC92(Z)) Q:'Z  S:IBZPRC92(Z)["CPT" Z0=Z0+1 S:IBZPRC92(Z)["ICD" Z1=Z1+1
"RTN","IBCBB21",13,0)
 S IBTXMT=$$TXMT^IBCEF4(IBIFN)
"RTN","IBCBB21",14,0)
 S IBZPRC92=Z0_U_Z1 ;Save # of CPT's and ICD9's
"RTN","IBCBB21",15,0)
 ; More than 50 procedures on a bill - must print locally
"RTN","IBCBB21",16,0)
 I IBTXMT,(+IBZPRC92>50!(+$P(IBZPRC92,U,2)>50)) D  Q:IBQUIT
"RTN","IBCBB21",17,0)
 . I 'IBREQMRA S IBQUIT=$$IBER^IBCBB3(.IBER,308) Q
"RTN","IBCBB21",18,0)
 . I '$P(IBNDTX,U,9) S IBQUIT=$$IBER^IBCBB3(.IBER,325)
"RTN","IBCBB21",19,0)
 ; If ICD9 procedures with dates and charges, bill 11x or 83x needs operating physician
"RTN","IBCBB21",20,0)
 I IBTOB12="11",$P(IBZPRC92,U,2),'$$CKPROV^IBCEU(IBIFN,2) S IBER=IBER_"IB304;"
"RTN","IBCBB21",21,0)
 I IBTOB12="83",$P(IBZPRC92,U,2),'$$CKPROV^IBCEU(IBIFN,2) S IBER=IBER_"IB312;"
"RTN","IBCBB21",22,0)
 ;
"RTN","IBCBB21",23,0)
 ; If any CPT procedures have more than 2 modifiers, warn
"RTN","IBCBB21",24,0)
 S Z=0 F  S Z=$O(IBZPRC92(Z)) Q:'Z  I $P(IBZPRC92(Z),U)["ICPT(",$L($P(IBZPRC92(Z),U,15),",")>2 S Z0="Proc "_$$PRCD^IBCEF1($P(IBZPRC92(Z),U))_" has > 2 modifiers - only first 2 will be used" D WARN^IBCBB11(Z0)
"RTN","IBCBB21",25,0)
 ;
"RTN","IBCBB21",26,0)
 I $$WNRBILL^IBEFUNC(IBIFN),$$MRATYPE^IBEFUNC(IBIFN)'="A" S IBER=IBER_"IB086;"
"RTN","IBCBB21",27,0)
 ;
"RTN","IBCBB21",28,0)
 ; UB-04 Diagnosis Codes
"RTN","IBCBB21",29,0)
 K IBXDATA D F^IBCEF("N-DIAGNOSES",,,IBIFN)
"RTN","IBCBB21",30,0)
 ;
"RTN","IBCBB21",31,0)
 ; Only 9 dx's allowed per claim plus 1 E-code
"RTN","IBCBB21",32,0)
 S (Z,ECODE,IBI)=0 F  S Z=$O(IBXDATA(Z)) Q:'Z  D  Q:IBER["309;"
"RTN","IBCBB21",33,0)
 . S IBI=IBI+1
"RTN","IBCBB21",34,0)
 . I $E($$ICD9^IBACSV(+$P(IBXDATA(Z),U)))="E" S:ECODE IBQUIT=$$IBER^IBCBB3(.IBER,301) S:'ECODE IBI=IBI-1,ECODE=1
"RTN","IBCBB21",35,0)
 . ; max DX check does not apply to MRAs
"RTN","IBCBB21",36,0)
 . I IBTXMT,IBI>9 D
"RTN","IBCBB21",37,0)
 .. I 'IBREQMRA Q:$P(IBNDTX,U,8)  S IBER=IBER_"IB309;" Q
"RTN","IBCBB21",38,0)
 .. I '$P(IBNDTX,U,9) S IBER=IBER_"IB326;"
"RTN","IBCBB21",39,0)
 ;
"RTN","IBCBB21",40,0)
 I '$O(IBXDATA(0)) S IBER=IBER_"IB071;"   ;Require Diag code NOIS:OKL-0304-72495
"RTN","IBCBB21",41,0)
 I $O(IBXDATA(0)) D
"RTN","IBCBB21",42,0)
 .S IBDXTYP=$E($$ICD9^IBACSV(+$P(IBXDATA(1),U)))
"RTN","IBCBB21",43,0)
 .S:IBDXTYP="E" IBER=IBER_"IB117;"
"RTN","IBCBB21",44,0)
 .I $$INPAT^IBCEF(IBIFN,1),IBDXTYP="V" S Z="Principal Dx V-code may not be valid" D WARN^IBCBB11(Z)
"RTN","IBCBB21",45,0)
 .Q
"RTN","IBCBB21",46,0)
 I '$$OCC10^IBCBB2(IBIFN,.IBXDATA,3) S IBER=IBER_"IB093;"
"RTN","IBCBB21",47,0)
 ;
"RTN","IBCBB21",48,0)
 K ^TMP($J,"IBC-RC")
"RTN","IBCBB21",49,0)
 D F^IBCEF("N-UB-04 SERVICE LINE (PRINT)",,,IBIFN)
"RTN","IBCBB21",50,0)
 S (Z0,IBI)=0 F  S IBI=$O(^TMP($J,"IBC-RC",IBI)) Q:'IBI  S Z=$G(^(IBI))  Q:+$P(Z,U,2)=1  I $P(Z,U,2),$P(Z,U,1)=1 D
"RTN","IBCBB21",51,0)
 . I IBER'["IB090;",$P(Z,U,2)>1,($P(Z,U,7)>99999.99!($P(Z,U,8)>99999.99)) S IBER=IBER_"IB090;"
"RTN","IBCBB21",52,0)
 . Q:$P(Z,U,2)'<180&($P(Z,U,2)'>189)  ;Pass days (LOA) don't matter
"RTN","IBCBB21",53,0)
 . I '$P(Z,U,7),'$P(Z,U,8),'Z0,$$COBN^IBCEF(IBIFN)'>1  S Z0="Rev Code(s) having a 0-charge will not be transmitted for the bill" D WARN^IBCBB11(Z0) S Z0=1
"RTN","IBCBB21",54,0)
 K ^TMP($J,"IBC-RC")
"RTN","IBCBB21",55,0)
 Q
"RTN","IBCBB21",56,0)
 ;
"RTN","IBCCC3")
0^12^B9625703^B9467829
"RTN","IBCCC3",1,0)
IBCCC3 ;ALB/AAS - CANCEL AND CLONE A BILL - CONTINUED ;25-JAN-90
"RTN","IBCCC3",2,0)
 ;;2.0;INTEGRATED BILLING;**363,381,389,405,403**;21-MAR-94;Build 24
"RTN","IBCCC3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCCC3",4,0)
 ;
"RTN","IBCCC3",5,0)
 ;copy entries from table files:
"RTN","IBCCC3",6,0)
 ;passed in: IBIFN=new bill, IBIFN1=old bill
"RTN","IBCCC3",7,0)
 ;
"RTN","IBCCC3",8,0)
 I '$D(^DGCR(399,+$G(IBIFN),0))!'$D(^DGCR(399,+$G(IBIFN1),0)) Q
"RTN","IBCCC3",9,0)
 N IBXR,X,Y,IBX
"RTN","IBCCC3",10,0)
 ;
"RTN","IBCCC3",11,0)
DX ;copy diagnosis' (362.3)
"RTN","IBCCC3",12,0)
 N IBDX,IBDIFN
"RTN","IBCCC3",13,0)
 ;copy diagnosis from old bill
"RTN","IBCCC3",14,0)
 I $D(^IBA(362.3,"AIFN"_IBIFN1)) S IBXR="AIFN"_IBIFN1 D
"RTN","IBCCC3",15,0)
 . S IBDX=0 F  S IBDX=$O(^IBA(362.3,IBXR,IBDX)) Q:'IBDX  D
"RTN","IBCCC3",16,0)
 .. S IBDIFN=0 F  S IBDIFN=$O(^IBA(362.3,IBXR,IBDX,IBDIFN)) Q:'IBDIFN  D
"RTN","IBCCC3",17,0)
 ... S IBX=$G(^IBA(362.3,IBDIFN,0)) I 'IBX!($P(IBX,U,2)'=IBIFN1) Q
"RTN","IBCCC3",18,0)
 ... S DIC="^IBA(362.3,",DIC(0)="L",X=+IBX K DA,DO D FILE^DICN
"RTN","IBCCC3",19,0)
 ... S DIE=DIC,DA=+Y,DR=".02////"_IBIFN_";.03////"_$P(IBX,U,3)_";.04////"_$P(IBX,U,4) D ^DIE K DIC,DIE,DA,DO,DR
"RTN","IBCCC3",20,0)
 K DIE,DIC,DA,DO,DR,X,Y
"RTN","IBCCC3",21,0)
 ;
"RTN","IBCCC3",22,0)
PRDX ;repoint procedure's associated diagnosis (2,304,10-13 -> 362.3)
"RTN","IBCCC3",23,0)
 N IBCPT,IBDIFN1,IBLN,IBI
"RTN","IBCCC3",24,0)
 S IBCPT=0 F  S IBCPT=$O(^DGCR(399,+IBIFN,"CP",IBCPT)) Q:'IBCPT  D
"RTN","IBCCC3",25,0)
 . S IBLN=$G(^DGCR(399,+IBIFN,"CP",IBCPT,0)) F IBI=11:1:14 S IBDIFN1=$P(IBLN,U,IBI) I +IBDIFN1 D
"RTN","IBCCC3",26,0)
 .. S IBDX=+$G(^IBA(362.3,+IBDIFN1,0)) Q:'IBDX
"RTN","IBCCC3",27,0)
 .. S IBDIFN=$O(^IBA(362.3,"AIFN"_IBIFN,IBDX,0)) Q:'IBDIFN
"RTN","IBCCC3",28,0)
 .. S $P(^DGCR(399,+IBIFN,"CP",IBCPT,0),U,IBI)=IBDIFN
"RTN","IBCCC3",29,0)
 ;
"RTN","IBCCC3",30,0)
RX ;copy rx refills (362.4)
"RTN","IBCCC3",31,0)
 N IBRX,IBRIFN,IBRXDA,IBDATE,IBNDC,IBDFN,IB3624DA
"RTN","IBCCC3",32,0)
 ;copy rx refills from old bill
"RTN","IBCCC3",33,0)
 ; IB*2*363 - get NDC# from PRESCRIPTION file (#52) before creating new
"RTN","IBCCC3",34,0)
 ; record entry in 362.4
"RTN","IBCCC3",35,0)
 I $D(^IBA(362.4,"AIFN"_IBIFN1)) S IBXR="AIFN"_IBIFN1 D
"RTN","IBCCC3",36,0)
 . S IBRX=0 F  S IBRX=$O(^IBA(362.4,IBXR,IBRX)) Q:IBRX=""  D
"RTN","IBCCC3",37,0)
 .. S IBRIFN=0 F  S IBRIFN=$O(^IBA(362.4,IBXR,IBRX,IBRIFN)) Q:'IBRIFN  D
"RTN","IBCCC3",38,0)
 ... S IBX=$G(^IBA(362.4,IBRIFN,0)) I IBX=""!($P(IBX,U,2)'=IBIFN1) Q
"RTN","IBCCC3",39,0)
 ... S DIC="^IBA(362.4,",DIC(0)="L",X=$P(IBX,U,1) K DA,DO D FILE^DICN K DA,DO Q:Y'>0
"RTN","IBCCC3",40,0)
 ... S IB3624DA=+Y,IBRXDA=$P(IBX,U,5),IBDATE=$P(IBX,U,3),IBDFN=$$GET1^DIQ(399,IBIFN1,.02,"I")
"RTN","IBCCC3",41,0)
 ... S IBNDC=$S(IBRXDA:$$GETNDC^IBEFUNC3(IBDFN,IBRXDA,IBDATE),1:$P(IBX,U,8))
"RTN","IBCCC3",42,0)
 ... S DR=".02////"_IBIFN_";.03////"_IBDATE_";.04////"_$P(IBX,U,4)_";.05////"_IBRXDA_";.06////"_$P(IBX,U,6)_";.07////"_$P(IBX,U,7)_";.08////"_IBNDC
"RTN","IBCCC3",43,0)
 ... S:$L($P(IBX,U,10)) DR=DR_";.1////"_$P(IBX,U,10)
"RTN","IBCCC3",44,0)
 ... S DIE=DIC,DA=IB3624DA D ^DIE K DIC,DIE,DA,DO,DR
"RTN","IBCCC3",45,0)
 K DIE,DIC,DA,DO,DR,X,Y
"RTN","IBCCC3",46,0)
 ;
"RTN","IBCCC3",47,0)
PROS ;copy prosthetics (362.5)
"RTN","IBCCC3",48,0)
 N IBPR,IBPIFN
"RTN","IBCCC3",49,0)
 ;copy rx refills from old bill
"RTN","IBCCC3",50,0)
 I $D(^IBA(362.5,"AIFN"_IBIFN1)) S IBXR="AIFN"_IBIFN1 D
"RTN","IBCCC3",51,0)
 . S IBPR=0 F  S IBPR=$O(^IBA(362.5,IBXR,IBPR)) Q:IBPR=""  D
"RTN","IBCCC3",52,0)
 .. S IBPIFN=0 F  S IBPIFN=$O(^IBA(362.5,IBXR,IBPR,IBPIFN)) Q:'IBPIFN  D
"RTN","IBCCC3",53,0)
 ... S IBX=$G(^IBA(362.5,IBPIFN,0)) I IBX=""!($P(IBX,U,2)'=IBIFN1) Q
"RTN","IBCCC3",54,0)
 ... S DIC="^IBA(362.5,",DIC(0)="L",X=$P(IBX,U,1) K DA,DO D FILE^DICN K DA,DO Q:Y'>0
"RTN","IBCCC3",55,0)
 ... S DR=".02////"_IBIFN_";.04////"_$P(IBX,U,4)_";.05////^S X=$P(IBX,U,5)"
"RTN","IBCCC3",56,0)
 ... S DIE=DIC,DA=+Y D ^DIE K DIC,DIE,DA,DO,DR
"RTN","IBCCC3",57,0)
 K DIE,DIC,DA,DO,DR,X,Y
"RTN","IBCCC3",58,0)
 Q
"RTN","IBCCC3",59,0)
 ;IBCCC3
"RTN","IBCE277")
0^1^B49622694^B47601821
"RTN","IBCE277",1,0)
IBCE277 ;ALB/TMP - 277 EDI CLAIM STATUS MESSAGE PROCESSING ;15-JUL-98
"RTN","IBCE277",2,0)
 ;;2.0;INTEGRATED BILLING;**137,155,368,403**;21-MAR-94;Build 24
"RTN","IBCE277",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCE277",4,0)
 Q
"RTN","IBCE277",5,0)
 ; MESSAGE HEADER DATA STRING =
"RTN","IBCE277",6,0)
 ;   type of message^msg queue^msg #^bill #^REF NUM/Batch #^date/time
"RTN","IBCE277",7,0)
 ;
"RTN","IBCE277",8,0)
HDR(ENTITY,ENTVAL,IBTYPE,IBD) ;Process header data
"RTN","IBCE277",9,0)
 ; INPUT:
"RTN","IBCE277",10,0)
 ;   ENTITY = "BATCH" or "CLAIM" for batch/claim level messages respectively
"RTN","IBCE277",11,0)
 ;   ENTVAL = claim #
"RTN","IBCE277",12,0)
 ;   IBTYPE = the type of status msg this piece of the message represents
"RTN","IBCE277",13,0)
 ;             (837REC1, 837REJ1)
"RTN","IBCE277",14,0)
 ;   ^TMP("IBMSGH",$J,0) = header message text
"RTN","IBCE277",15,0)
 ;
"RTN","IBCE277",16,0)
 ; OUTPUT:
"RTN","IBCE277",17,0)
 ;   IBD array returned with processed data
"RTN","IBCE277",18,0)
 ;      "DATE" = Date/Time of status (Fileman format)
"RTN","IBCE277",19,0)
 ;      "MRA" =  1 if MRA, 0 if not         "X12" = 1 if X12, 0 if not
"RTN","IBCE277",20,0)
 ;      "BATCH" = Batch ien for batch level calls
"RTN","IBCE277",21,0)
 ;      "SOURCE" = Source of message code^source name, if known
"RTN","IBCE277",22,0)
 ;
"RTN","IBCE277",23,0)
 ;   ^TMP("IBMSG",$J,"BATCH",batch #,0)=MESSAGE HEADER DATA STRING
"RTN","IBCE277",24,0)
 ;                                      if batch level message
"RTN","IBCE277",25,0)
 ;                                  ,"D",0,1)=header record raw data
"RTN","IBCE277",26,0)
 ;                                  ,line #)=batch status message lines
"RTN","IBCE277",27,0)
 ;
"RTN","IBCE277",28,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,0)=MESSAGE HEADER DATA STRING
"RTN","IBCE277",29,0)
 ;                                      if claim level message
"RTN","IBCE277",30,0)
 ;                                  ,"D",0,1)=header record raw data
"RTN","IBCE277",31,0)
 ;                                  ,line #)=claim status message lines
"RTN","IBCE277",32,0)
 ;
"RTN","IBCE277",33,0)
 N DATA,IBD0,L,PC,X,Y
"RTN","IBCE277",34,0)
 S IBD0=$G(^TMP("IBMSGH",$J,0)) Q:IBD0=""
"RTN","IBCE277",35,0)
 S Y=0,L=1
"RTN","IBCE277",36,0)
 ; Convert claim date/time
"RTN","IBCE277",37,0)
 S X=$$DATE($P(IBD0,U,3))_"@"_$E($P(IBD0,U,4)_"0000",1,4) I X S %DT="XTS" D ^%DT
"RTN","IBCE277",38,0)
 ; populate IBD array
"RTN","IBCE277",39,0)
 S IBD("DATE")=$S(Y>0:Y,1:""),IBD("MRA")=$P(IBD0,U,5),IBD("X12")=($P(IBD0,U,2)="X")
"RTN","IBCE277",40,0)
 S IBD("SOURCE")=$P(IBD0,U,12,13),IBD("BATCH")=$P(IBD0,U,14)
"RTN","IBCE277",41,0)
 I +$TR($P(IBD0,U,6,9),U) F PC=6:1:9 D
"RTN","IBCE277",42,0)
 .I $P(IBD0,U,PC)'="" S DATA=$P("# Claims Submitted^# Claims Rejected^Total Charges Submitted^Total Charges Rejected",U,PC-5)_": "_$S(PC<8:+$P(IBD0,U,PC),1:$FNUMBER($P(IBD0,U,PC)/100,"",2))_"  "
"RTN","IBCE277",43,0)
 .I $L($G(^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L)))+$L(DATA)>70 S L=L+1 ; if data doesn't fit into current line, go to the next line
"RTN","IBCE277",44,0)
 .S ^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L)=$G(^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L))_DATA ; file this piece of data
"RTN","IBCE277",45,0)
 .Q
"RTN","IBCE277",46,0)
 ; file batch ref. number
"RTN","IBCE277",47,0)
 S:IBD("BATCH")'="" L=L+1,^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L)="Batch Reference Number: "_IBD("BATCH")
"RTN","IBCE277",48,0)
 I $TR($P(IBD0,U,10,13),U)'="" D
"RTN","IBCE277",49,0)
 .S L=L+1
"RTN","IBCE277",50,0)
 .; generate and file Payer Name / Payer Id line
"RTN","IBCE277",51,0)
 .S DATA="Payer Name: "_$S($P(IBD0,U,10)'="":$P(IBD0,U,10),1:"N/A")_"  Payer ID: "_$S($P(IBD0,U,11)'="":$P(IBD0,U,11),1:"N/A")
"RTN","IBCE277",52,0)
 .S ^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L)=DATA
"RTN","IBCE277",53,0)
 .I $P(IBD0,U,12)'=""!($P(IBD0,U,13)'="") D
"RTN","IBCE277",54,0)
 ..; generate and file Message Source line
"RTN","IBCE277",55,0)
 ..S DATA="Source: "_$S($P(IBD0,U,12)="Y":"Sent by payer",$P(IBD0,U,13)'="":"Sent by non-payer ("_$P(IBD0,U,13)_")",1:"UNKNOWN")
"RTN","IBCE277",56,0)
 ..S L=L+1,^TMP("IBMSG-H",$J,ENTITY,ENTVAL,L)=DATA
"RTN","IBCE277",57,0)
 ..Q
"RTN","IBCE277",58,0)
 .Q
"RTN","IBCE277",59,0)
 S ^TMP("IBMSG",$J,ENTITY,ENTVAL,0)=IBTYPE_U_$G(IBD("MSG#"))_U_$G(IBD("SUBJ"))_U_$$GETBILL(ENTVAL)_U_U_IBD("DATE")_U_IBD("SOURCE")
"RTN","IBCE277",60,0)
 ; file raw data
"RTN","IBCE277",61,0)
 S ^TMP("IBMSG",$J,ENTITY,ENTVAL,"D",0,1)="##RAW DATA: "_IBD0
"RTN","IBCE277",62,0)
 Q
"RTN","IBCE277",63,0)
 ;
"RTN","IBCE277",64,0)
9(IBD) ; Process Message Header record
"RTN","IBCE277",65,0)
 ; INPUT:
"RTN","IBCE277",66,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE277",67,0)
 ; OUTPUT:
"RTN","IBCE277",68,0)
 ;   IBD array returned with processed data
"RTN","IBCE277",69,0)
 ;      "CLAIM" = claim #
"RTN","IBCE277",70,0)
 ;      "LINE" = last line # populated in the message
"RTN","IBCE277",71,0)
 ;
"RTN","IBCE277",72,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,line#)= message data lines
"RTN","IBCE277",73,0)
 ;                                  ,"D",9,msg seq #)= raw data
"RTN","IBCE277",74,0)
 N ENTITY,ERR,FLD,IBCLM,IBIFN,L
"RTN","IBCE277",75,0)
 D STRTREC Q:IBCLM=""  ; if no claim/batch number, bail out
"RTN","IBCE277",76,0)
 ; make sure that we have data to file
"RTN","IBCE277",77,0)
 S ERR=$P(IBD,U,4) Q:ERR=""
"RTN","IBCE277",78,0)
 ; file error along with corresponding field number (if available)
"RTN","IBCE277",79,0)
 S L=L+1,FLD=$P(IBD,U,5),^TMP("IBMSG",$J,ENTITY,IBCLM,L)="Error"_$S(FLD'="":" in field "_FLD,1:"")_":"
"RTN","IBCE277",80,0)
 S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)=ERR
"RTN","IBCE277",81,0)
 D ENDREC(9)
"RTN","IBCE277",82,0)
 Q
"RTN","IBCE277",83,0)
 ;
"RTN","IBCE277",84,0)
10(IBD) ; Process message data
"RTN","IBCE277",85,0)
 ; INPUT:
"RTN","IBCE277",86,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE277",87,0)
 ; OUTPUT:
"RTN","IBCE277",88,0)
 ;   IBD array returned with processed data
"RTN","IBCE277",89,0)
 ;      "CLAIM" = claim #
"RTN","IBCE277",90,0)
 ;      "LINE" = last line # populated in the message
"RTN","IBCE277",91,0)
 ;
"RTN","IBCE277",92,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,line#)= message data lines
"RTN","IBCE277",93,0)
 ;                                  ,"D",10,msg seq #)= raw data
"RTN","IBCE277",94,0)
 ;   ^TMP("IBCONF",$J,claim #")="" for invalid claims within the batch
"RTN","IBCE277",95,0)
 ;
"RTN","IBCE277",96,0)
 N CODE,DATA,ENTITY,IBCLM,IBIFN,IBTYPE,L,Z
"RTN","IBCE277",97,0)
 D STRTREC Q:IBCLM=""  ; if no claim number, bail out
"RTN","IBCE277",98,0)
 S:$P(IBD,U,3)="R" ^TMP("IBCONF",$J,IBIFN)=""
"RTN","IBCE277",99,0)
 S IBTYPE=$S($P(IBD,U,3)="R":"837REJ1",1:"837REC1")
"RTN","IBCE277",100,0)
 ;Process header data if not already done
"RTN","IBCE277",101,0)
 I '$D(^TMP("IBMSG",$J,ENTITY,IBCLM,0)) D HDR(ENTITY,IBCLM,IBTYPE,.IBD)
"RTN","IBCE277",102,0)
 I IBTYPE="837REJ1",$P($G(^TMP("IBMSG",$J,ENTITY,IBCLM,0)),U,1)'="837REJ1" D HDR(ENTITY,IBCLM,IBTYPE,.IBD)
"RTN","IBCE277",103,0)
 S CODE=$P(IBD,U,4) I CODE'="",$TR($P(IBD,U,5,6),U)'="" D
"RTN","IBCE277",104,0)
 .S Z=CODE_$P(IBD,U,5) I Z'=$G(IBD("SCODE")) D
"RTN","IBCE277",105,0)
 ..; determine type of status code and file it
"RTN","IBCE277",106,0)
 ..S L=L+1,DATA=$S(CODE="W":"Warning",CODE="E":"Error",1:"Informational")_" "
"RTN","IBCE277",107,0)
 ..I $P(IBD,U,5)'="" S ^TMP("IBMSG",$J,ENTITY,IBCLM,L)=DATA_"Code: "_$P(IBD,U,5)
"RTN","IBCE277",108,0)
 ..I $P(IBD,U,6)'="" S:$P(IBD,U,5)'="" L=L+1 S ^TMP("IBMSG",$J,ENTITY,IBCLM,L)=DATA_"Message:",L=L+1
"RTN","IBCE277",109,0)
 ..S IBD("SCODE")=Z
"RTN","IBCE277",110,0)
 ..Q
"RTN","IBCE277",111,0)
 .; file status message
"RTN","IBCE277",112,0)
 .I $P(IBD,U,6)'="" S ^TMP("IBMSG",$J,ENTITY,IBCLM,L)=$P(IBD,U,6),L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)=" "
"RTN","IBCE277",113,0)
 .Q
"RTN","IBCE277",114,0)
 D ENDREC(10)
"RTN","IBCE277",115,0)
 Q
"RTN","IBCE277",116,0)
 ;
"RTN","IBCE277",117,0)
13(IBD) ; Process claim data
"RTN","IBCE277",118,0)
 ; Claim must have been referenced by a previous '10' level
"RTN","IBCE277",119,0)
 ; INPUT:
"RTN","IBCE277",120,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE277",121,0)
 ;
"RTN","IBCE277",122,0)
 ; OUTPUT:
"RTN","IBCE277",123,0)
 ;      IBD("LINE") = The last line # populated in the message
"RTN","IBCE277",124,0)
 ;
"RTN","IBCE277",125,0)
 ;     ^TMP("IBMSG",$J,"CLAIM",claim #,line#)=claim data lines
"RTN","IBCE277",126,0)
 ;                                    ,"D",13,msg seq #)=raw data
"RTN","IBCE277",127,0)
 ;
"RTN","IBCE277",128,0)
 N CTYPE,ENTITY,IBCLM,IBIFN,L,Z1,Z2
"RTN","IBCE277",129,0)
 D STRTREC
"RTN","IBCE277",130,0)
 ; quit if no claim number or no previous 'line 10' record
"RTN","IBCE277",131,0)
 Q:$S(IBCLM="":1,1:'$D(^TMP("IBMSG",$J,"CLAIM",IBCLM)))
"RTN","IBCE277",132,0)
 ; file clearinghouse trace number
"RTN","IBCE277",133,0)
 I $P(IBD,U,3)'="" S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="Clearinghouse Trace Number: "_$P(IBD,U,3)
"RTN","IBCE277",134,0)
 ; file payer status date
"RTN","IBCE277",135,0)
 I $P(IBD,U,4)'="" S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="         Payer Status Date: "_$$DATE($P(IBD,U,4))
"RTN","IBCE277",136,0)
 ; file payer claim number
"RTN","IBCE277",137,0)
 I $P(IBD,U,5)'="" S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="        Payer Claim Number: "_$P(IBD,U,5)
"RTN","IBCE277",138,0)
 ; file split claim indicator
"RTN","IBCE277",139,0)
 I +$P(IBD,U,6)'=0 S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="               Split Claim: "_$S(+$P(IBD,U,6)=1:"No",1:"Yes ("_+$P(IBD,U,6)_" parts)")
"RTN","IBCE277",140,0)
 ; file claim type if it either doesn't match value in VistA or if it's a dental claim
"RTN","IBCE277",141,0)
 S Z1=$P(IBD,U,7),Z2=$$FT^IBCEF(IBIFN),CTYPE=$S(Z1="P"&(Z2'=2):"Professional",Z1="I"&(Z2'=3):"Institutional",Z1="D":"Dental",1:"")
"RTN","IBCE277",142,0)
 S:CTYPE'="" L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="                Claim Type: "_CTYPE
"RTN","IBCE277",143,0)
 D ENDREC(13)
"RTN","IBCE277",144,0)
 Q
"RTN","IBCE277",145,0)
 ;
"RTN","IBCE277",146,0)
15(IBD) ; Process subscriber/patient data
"RTN","IBCE277",147,0)
 ; Claim must have been referenced by a previous '10' level
"RTN","IBCE277",148,0)
 ; INPUT:
"RTN","IBCE277",149,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE277",150,0)
 ;
"RTN","IBCE277",151,0)
 ; OUTPUT:
"RTN","IBCE277",152,0)
 ;      IBD("LINE") = The last line # populated in the message
"RTN","IBCE277",153,0)
 ;
"RTN","IBCE277",154,0)
 ;     ^TMP("IBMSG",$J,"CLAIM",claim #,line#)=formatted service dates
"RTN","IBCE277",155,0)
 ;                                    ,"D",15,msg seq #)=
"RTN","IBCE277",156,0)
 ;                                         subscr/patient raw data
"RTN","IBCE277",157,0)
 ;
"RTN","IBCE277",158,0)
 N ENTITY,DATA,IBCLM,IBIFN,IBNM,IBNUM,IBDFN,L
"RTN","IBCE277",159,0)
 D STRTREC
"RTN","IBCE277",160,0)
 ; quit if no claim number or no previous 'line 10' record
"RTN","IBCE277",161,0)
 Q:$S(IBCLM="":1,1:'$D(^TMP("IBMSG",$J,"CLAIM",IBCLM)))
"RTN","IBCE277",162,0)
 S IBDFN=+$P(^DGCR(399,IBIFN,0),U,2)
"RTN","IBCE277",163,0)
 S IBNM=$S($P(IBD,U,3)'="":$P(IBD,U,3)_","_$P(IBD,U,4)_$S($P(IBD,U,5)'="":" "_$P(IBD,U,5),1:""),1:$P($G(^DPT(IBDFN,0)),U))
"RTN","IBCE277",164,0)
 S IBNUM=$S($P(IBD,U,6)'="":$P(IBD,U,6),1:$P($G(^DPT(IBDFN,0)),U,9))
"RTN","IBCE277",165,0)
 S L=L+1,^TMP("IBMSG",$J,ENTITY,IBCLM,L)="Patient: "_IBNM_"   "_IBNUM
"RTN","IBCE277",166,0)
 I $P(IBD,U,11) D
"RTN","IBCE277",167,0)
 .S DATA=$$DATE($P(IBD,U,11)),L=L+1
"RTN","IBCE277",168,0)
 .S ^TMP("IBMSG",$J,ENTITY,IBCLM,L)="Service Dates: "_DATA_" - "_$S($P(IBD,U,12):$$DATE($P(IBD,U,12)),1:DATA)
"RTN","IBCE277",169,0)
 .Q
"RTN","IBCE277",170,0)
 D ENDREC(15)
"RTN","IBCE277",171,0)
 Q
"RTN","IBCE277",172,0)
 ;
"RTN","IBCE277",173,0)
STRTREC ; start processing of the record
"RTN","IBCE277",174,0)
 ;           
"RTN","IBCE277",175,0)
 ; OUTPUT:
"RTN","IBCE277",176,0)
 ;   sets the following variables
"RTN","IBCE277",177,0)
 ;   IBCLM = claim #
"RTN","IBCE277",178,0)
 ;   ENTITY = "CLAIM" (all 277STAT messages are on claim level)
"RTN","IBCE277",179,0)
 ;   L = last populated line number
"RTN","IBCE277",180,0)
 ;
"RTN","IBCE277",181,0)
 S IBCLM=$$GETCLM($P(IBD,U,2)),ENTITY="CLAIM",L=+$G(IBD("LINE"))
"RTN","IBCE277",182,0)
 S IBIFN=+$O(^DGCR(399,"B",IBCLM,0))
"RTN","IBCE277",183,0)
 Q
"RTN","IBCE277",184,0)
 ;
"RTN","IBCE277",185,0)
ENDREC(TYPE) ; finish processing of the record
"RTN","IBCE277",186,0)
 ; INPUT:
"RTN","IBCE277",187,0)
 ;   TYPE = record type (line type)
"RTN","IBCE277",188,0)
 ;   
"RTN","IBCE277",189,0)
 ; OUTPUT:
"RTN","IBCE277",190,0)
 ;   IBD("LINE") = is updated with last populated line number
"RTN","IBCE277",191,0)
 ;
"RTN","IBCE277",192,0)
 ;make sure all variables are set properly
"RTN","IBCE277",193,0)
 Q:$G(ENTITY)=""
"RTN","IBCE277",194,0)
 Q:$G(IBCLM)=""
"RTN","IBCE277",195,0)
 Q:$G(TYPE)=""
"RTN","IBCE277",196,0)
 ; file raw data
"RTN","IBCE277",197,0)
 S ^TMP("IBMSG",$J,ENTITY,IBCLM,"D",TYPE,$O(^TMP("IBMSG",$J,ENTITY,IBCLM,"D",TYPE,""),-1)+1)="##RAW DATA: "_IBD
"RTN","IBCE277",198,0)
 ; update line count
"RTN","IBCE277",199,0)
 S IBD("LINE")=$G(IBD("LINE"))+L
"RTN","IBCE277",200,0)
 Q
"RTN","IBCE277",201,0)
 ;
"RTN","IBCE277",202,0)
GETBILL(CLAIM) ; Extract transmission #
"RTN","IBCE277",203,0)
 N PREC,STATUS,TRANS
"RTN","IBCE277",204,0)
 S TRANS=$$LAST364^IBCEF4(IBIFN),PREC=0
"RTN","IBCE277",205,0)
 ; if status of the last transmission is "X" or "P", keep searching backwards through file 364 until record
"RTN","IBCE277",206,0)
 ; with different status is found; if there's only one "P" record present, save it off in PREC
"RTN","IBCE277",207,0)
 I TRANS F  S STATUS=$P(^IBA(364,TRANS,0),U,3) Q:"XP"'[STATUS  S:STATUS="P" PREC=$S(PREC=0:+TRANS,1:-1) S TRANS=$O(^IBA(364,"B",IBIFN,TRANS),-1) Q:TRANS=""  ;
"RTN","IBCE277",208,0)
 ; if we didn't find any good records, and there's only one "P" record present, use this "P" record
"RTN","IBCE277",209,0)
 I TRANS="",PREC>0 S TRANS=PREC
"RTN","IBCE277",210,0)
 Q +TRANS
"RTN","IBCE277",211,0)
 ;
"RTN","IBCE277",212,0)
DATE(DT) ; Convert YYMMDD Date into MM/DD/YY or YYYYMMDD into MM/DD/YYYY
"RTN","IBCE277",213,0)
 N D,Y
"RTN","IBCE277",214,0)
 S D=DT,Y=""
"RTN","IBCE277",215,0)
 I $L(DT)=8 S D=$E(DT,3,8),Y=$E(DT,1,2)
"RTN","IBCE277",216,0)
 Q ($E(D,3,4)_"/"_$E(D,5,6)_"/"_Y_$E(D,1,2))
"RTN","IBCE277",217,0)
 ;
"RTN","IBCE277",218,0)
GETCLM(X) ; Extract the claim # without site id from the data in X
"RTN","IBCE277",219,0)
 N IBCLM
"RTN","IBCE277",220,0)
 S IBCLM=$P(X,"-",2) I IBCLM="",X'="" S IBCLM=$E(X,$S($L(X)>7:4,1:1),$L(X))
"RTN","IBCE277",221,0)
 Q IBCLM
"RTN","IBCE277",222,0)
 ;
"RTN","IBCEF2")
0^13^B62749444^B53903581
"RTN","IBCEF2",1,0)
IBCEF2 ;ALB/TMP - FORMATTER SPECIFIC BILL FUNCTIONS ;8/6/03 10:54am
"RTN","IBCEF2",2,0)
 ;;2.0;INTEGRATED BILLING;**52,85,51,137,232,155,296,349,403**;21-MAR-94;Build 24
"RTN","IBCEF2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEF2",4,0)
 ;
"RTN","IBCEF2",5,0)
HOS(IBIFN) ; Extract rev codes for inst. episode into IBXDATA
"RTN","IBCEF2",6,0)
 ; Moved for space
"RTN","IBCEF2",7,0)
 D HOS^IBCEF22(IBIFN)
"RTN","IBCEF2",8,0)
 Q
"RTN","IBCEF2",9,0)
 ;
"RTN","IBCEF2",10,0)
OTHINS(IBIFN) ;Determine 'other insurance' node (I1,I2)
"RTN","IBCEF2",11,0)
 ; If primary bill, other ins is secondary
"RTN","IBCEF2",12,0)
 ; If sec or tert bill, other ins is primary
"RTN","IBCEF2",13,0)
 ;IBIFN = bill ien
"RTN","IBCEF2",14,0)
 N Z
"RTN","IBCEF2",15,0)
 S Z=$$COBN^IBCEF(IBIFN)
"RTN","IBCEF2",16,0)
 Q "I"_$S(Z=1:2,1:1)
"RTN","IBCEF2",17,0)
 ;
"RTN","IBCEF2",18,0)
OTHINS1(IBIFN) ; Returns the COB #'s of all 'other insurance' as a string
"RTN","IBCEF2",19,0)
 ;IBIFN = bill ien
"RTN","IBCEF2",20,0)
 N IBC,Z
"RTN","IBCEF2",21,0)
 S Z=$$COBN^IBCEF(IBIFN)
"RTN","IBCEF2",22,0)
 I Z=1 S IBC=$S($D(^DGCR(399,IBIFN,"I2")):$S($D(^DGCR(399,IBIFN,"I3")):23,1:2),1:"") ;Primary=>2 or 23
"RTN","IBCEF2",23,0)
 I Z=2 S IBC="1"_$S($D(^DGCR(399,IBIFN,"I3")):3,1:"") ;Secondary=>1 or 13
"RTN","IBCEF2",24,0)
 I Z=3 S IBC="12" ;Tertiary =>12
"RTN","IBCEF2",25,0)
OTHQ Q IBC
"RTN","IBCEF2",26,0)
 ;
"RTN","IBCEF2",27,0)
RECVR(IBIFN) ; Returns the V.A. internal routing id of the current ins
"RTN","IBCEF2",28,0)
 ; co for 837
"RTN","IBCEF2",29,0)
 ;IBIFN = bill ien
"RTN","IBCEF2",30,0)
 N MCR,NUM,IBPH
"RTN","IBCEF2",31,0)
 S IBPH=$P("P^H",U,$$FT^IBCEF(IBIFN)-1)
"RTN","IBCEF2",32,0)
 S NUM="ENVOY"_IBPH
"RTN","IBCEF2",33,0)
 ; If rate type is CHAMPVA, send 'CHAMVA'
"RTN","IBCEF2",34,0)
 I $P($G(^DGCR(399.3,+$P($G(^DGCR(399,IBIFN,0)),U,7),0)),U)="CHAMPVA" S NUM="CHAMV"_IBPH
"RTN","IBCEF2",35,0)
 I NUM["ENVOY",$$MCRWNR^IBEFUNC(+$$CURR(IBIFN)) D
"RTN","IBCEF2",36,0)
 . S MCR=$P("B^A",U,$$FT^IBCEF(IBIFN)-1)    ; PART A/B for MEDICARE
"RTN","IBCEF2",37,0)
 . S NUM="PART"_MCR
"RTN","IBCEF2",38,0)
 Q NUM
"RTN","IBCEF2",39,0)
 ;
"RTN","IBCEF2",40,0)
ALLPAYID(IBIFN,IBXDATA,SEQ) ; Returns clearinghouse id for all (SEQ="")
"RTN","IBCEF2",41,0)
 ;  or a specific (SEQ=1,2,3) ins co's for 837 in IBXDATA(n) for bill ien
"RTN","IBCEF2",42,0)
 ;  IBIFN
"RTN","IBCEF2",43,0)
 ; EJK *296* Add IBMRA - MRA Claim type. 
"RTN","IBCEF2",44,0)
 ; EJK *296* Add IBEBI - Electronic Billing ID
"RTN","IBCEF2",45,0)
 N Z,Z0,Z1,A,IBM,IBINST,IBMCR,IBX,IBMRA,IBEBI
"RTN","IBCEF2",46,0)
 S IBXDATA="",IBM=$G(^DGCR(399,IBIFN,"M"))
"RTN","IBCEF2",47,0)
 F Z=1:1:3 I $S('$G(SEQ):1,1:Z=SEQ) S Z0=$P(IBM,U,Z) I Z0 D  S:A'="" IBXDATA(Z)=A
"RTN","IBCEF2",48,0)
 . S A=""
"RTN","IBCEF2",49,0)
 . S IBINST=($$FT^IBCEF(IBIFN)=3) ;Is bill UB-04?
"RTN","IBCEF2",50,0)
 . ; EJK *296* Get IBEBI based on Prof. or Inst. claim
"RTN","IBCEF2",51,0)
 . I IBINST S IBEBI=$P($G(^DIC(36,Z0,3)),U,4)
"RTN","IBCEF2",52,0)
 . I 'IBINST S IBEBI=$P($G(^DIC(36,Z0,3)),U,2)
"RTN","IBCEF2",53,0)
 . S IBEBI=$$UP^XLFSTR(IBEBI)
"RTN","IBCEF2",54,0)
 . ; EJK *296* If this is a Medicare claim, it may be printed or transmitted. 
"RTN","IBCEF2",55,0)
 . S IBMRA=$$MRASEC^IBCEF4(IBIFN)   ;Is claim 2ndary to an MRA? 
"RTN","IBCEF2",56,0)
 . S IBMCR=$$MCRONBIL^IBEFUNC(IBIFN),Z1=$G(^DGCR(399,IBIFN,"TX"))
"RTN","IBCEF2",57,0)
 . Q:$P(Z1,U,8)=1!$S('$P(Z1,U,9):0,1:$$MRASEC^IBCEF4(IBIFN))  ;Force local prnt
"RTN","IBCEF2",58,0)
 . S A=$S($P(Z1,U,8)'=2:$P($G(^DIC(36,Z0,3)),U,$S(IBINST:4,1:2)),1:"")
"RTN","IBCEF2",59,0)
 . S A=$$UP^XLFSTR(A)
"RTN","IBCEF2",60,0)
 . ;
"RTN","IBCEF2",61,0)
 . ; RPRNT = CMS-1500 Rx bills
"RTN","IBCEF2",62,0)
 . ; IPRNT = Inst MRA secondary claims
"RTN","IBCEF2",63,0)
 . ; PPRNT = Prof MRA secondary claims
"RTN","IBCEF2",64,0)
 . ; HPRNT = inst printed bills (non-MRA, force print at clearinghouse)
"RTN","IBCEF2",65,0)
 . ; SPRNT = prof printed bills (non-MRA, force print at clearinghouse)
"RTN","IBCEF2",66,0)
 . ;
"RTN","IBCEF2",67,0)
 . ; Default to appropriate 'xPRNT' if Rx bill or COB bill or forced to
"RTN","IBCEF2",68,0)
 . ;    print - claims must print at clearinghouse
"RTN","IBCEF2",69,0)
 . ;
"RTN","IBCEF2",70,0)
 . ; Rx bills on CMS-1500
"RTN","IBCEF2",71,0)
 . I 'IBINST,$$ISRX^IBCEF1(IBIFN) S A="RPRNT" Q
"RTN","IBCEF2",72,0)
 . ;
"RTN","IBCEF2",73,0)
 . ; Claim forced to print at clearinghouse
"RTN","IBCEF2",74,0)
 . I $P(Z1,U,8)=2 S A=$S(IBINST:"H",1:"S")_"PRNT" Q
"RTN","IBCEF2",75,0)
 . ;
"RTN","IBCEF2",76,0)
 . ; EJK *296* Send IBEBI for MRA secondary claims if it exists
"RTN","IBCEF2",77,0)
 . I Z>1,IBMRA,IBEBI'="" S A=IBEBI Q
"RTN","IBCEF2",78,0)
 . ;
"RTN","IBCEF2",79,0)
 . ; MRA secondary claim
"RTN","IBCEF2",80,0)
 . I Z>1,IBMCR=1,$P(Z1,U,5)="C" S A=$S(IBINST:"I",1:"P")_"PRNT" Q
"RTN","IBCEF2",81,0)
 . ;
"RTN","IBCEF2",82,0)
 . ; Medicare is current payer (MRA request claim)
"RTN","IBCEF2",83,0)
 . I $$WNRBILL^IBEFUNC(IBIFN,Z) S A=$S(IBINST:"12M61",1:"SMTX1") Q
"RTN","IBCEF2",84,0)
 . ;
"RTN","IBCEF2",85,0)
 . ; IB*296 - Do not modify the payer ID for CHAMPVA (HAC)
"RTN","IBCEF2",86,0)
 . I A=84146 Q
"RTN","IBCEF2",87,0)
 . I A=84147 Q
"RTN","IBCEF2",88,0)
 . ;
"RTN","IBCEF2",89,0)
 . ; If not a primary bill force to print
"RTN","IBCEF2",90,0)
 . I Z>1,Z=$$COBN^IBCEF(IBIFN) S A=$S(IBINST:"H",1:"S")_"PRNT" Q
"RTN","IBCEF2",91,0)
 . Q
"RTN","IBCEF2",92,0)
 ;
"RTN","IBCEF2",93,0)
 Q
"RTN","IBCEF2",94,0)
 ;
"RTN","IBCEF2",95,0)
PAYERID(IBIFN) ; Returns clearinghouse id for current ins co
"RTN","IBCEF2",96,0)
 ; IBIFN = bill ien
"RTN","IBCEF2",97,0)
 N NUM,IBSEQ
"RTN","IBCEF2",98,0)
 ; Determine the current ins co's # to identify at WEBMD
"RTN","IBCEF2",99,0)
 ; Envoy changed to WEBMD in patch 232
"RTN","IBCEF2",100,0)
 S IBSEQ=+$$COBN^IBCEF(IBIFN)
"RTN","IBCEF2",101,0)
 D ALLPAYID(IBIFN,.NUM,IBSEQ) S NUM=$G(NUM(IBSEQ))
"RTN","IBCEF2",102,0)
 Q $G(NUM)
"RTN","IBCEF2",103,0)
 ;
"RTN","IBCEF2",104,0)
CURR(IBIFN) ; Returns ien of the current insurance
"RTN","IBCEF2",105,0)
 ; company for bill ien IBIFN
"RTN","IBCEF2",106,0)
 Q $$FINDINS^IBCEF1(IBIFN)
"RTN","IBCEF2",107,0)
 ;
"RTN","IBCEF2",108,0)
ADMDT(IBIFN,NOOUTCK) ; Calculate admission/start of care date/time
"RTN","IBCEF2",109,0)
 D ADMDT^IBCEF21(IBIFN,$G(NOOUTCK))      ; Moved for space
"RTN","IBCEF2",110,0)
 Q
"RTN","IBCEF2",111,0)
 ;
"RTN","IBCEF2",112,0)
DISDT(IBIFN) ; Calculate discharge date
"RTN","IBCEF2",113,0)
 D DISDT^IBCEF21(IBIFN)                  ; Moved for space
"RTN","IBCEF2",114,0)
 Q
"RTN","IBCEF2",115,0)
 ;
"RTN","IBCEF2",116,0)
INDTS(IBIFN) ; Function returns the admit ^ discharge date/time of admission if patient is an inpatient on bill's event date
"RTN","IBCEF2",117,0)
 N Z,Z0,DFN,VAINDT,VAIN S Z0=""
"RTN","IBCEF2",118,0)
 S Z=$G(^DGCR(399,+$G(IBIFN),0)),DFN=$P(Z,U,2),VAINDT=$P(Z,U,3)
"RTN","IBCEF2",119,0)
 I +DFN,+VAINDT D INP^VADPT I +VAIN(1) S Z0=+VAIN(7)_U_+$G(^DGPM(+$P($G(^DGPM(+VAIN(1),0)),U,17),0))
"RTN","IBCEF2",120,0)
 Q Z0
"RTN","IBCEF2",121,0)
 ;
"RTN","IBCEF2",122,0)
TXMT(IBIFN) ; Function moved - use new call in IBCEF4
"RTN","IBCEF2",123,0)
 Q $$TXMT^IBCEF4(IBIFN)
"RTN","IBCEF2",124,0)
 ;
"RTN","IBCEF2",125,0)
 ;
"RTN","IBCEF2",126,0)
ID(LN,VAL) ; Set EXTRACT GLOBAL for multi-valued record
"RTN","IBCEF2",127,0)
 ; ids for Austin
"RTN","IBCEF2",128,0)
 ; LN = the line # being extracted
"RTN","IBCEF2",129,0)
 ; VAL = the value of the element being extracted
"RTN","IBCEF2",130,0)
 ;
"RTN","IBCEF2",131,0)
 ; Assumes IBXPG exists
"RTN","IBCEF2",132,0)
 ;
"RTN","IBCEF2",133,0)
 Q:LN<2
"RTN","IBCEF2",134,0)
 D SETGBL^IBCEFG(IBXPG,LN,1,VAL,.IBXSIZE)
"RTN","IBCEF2",135,0)
 Q
"RTN","IBCEF2",136,0)
 ;
"RTN","IBCEF2",137,0)
ID1(LN,DX,CT) ;Special entrypoint for diagnoses to 'save' the fact
"RTN","IBCEF2",138,0)
 ;   a dx code is an e-code.
"RTN","IBCEF2",139,0)
 ; LN is last entry # output, returned as the entry # (IBXLINE) to assign to this entry
"RTN","IBCEF2",140,0)
 ; DX = the actual Dx code array(RECORD ID). Pass by reference, DX returned null if
"RTN","IBCEF2",141,0)
 ;      dx was not output
"RTN","IBCEF2",142,0)
 ; CT = the ct on the 'DC' entry.  pass by reference, returned null if
"RTN","IBCEF2",143,0)
 ;      the end of the valid dx codes has been reached
"RTN","IBCEF2",144,0)
 N IBINS,VAL,CNT,DXIEN,DXQ,EDX,I,POA
"RTN","IBCEF2",145,0)
 S IBINS=($$FT^IBCEF(IBXIEN)=3)
"RTN","IBCEF2",146,0)
 S VAL="DC"_CT                     ; **232**
"RTN","IBCEF2",147,0)
 S VAL=$E(VAL_" ",1,4)
"RTN","IBCEF2",148,0)
 S EDX=($E($G(DX))="E") ; TRUE if e-code DX
"RTN","IBCEF2",149,0)
 S I=$S(EDX:3,1:2)
"RTN","IBCEF2",150,0)
 S:'EDX DXQ=$S(+$G(^TMP("DCX",$J,2))>0:"BF",1:"BK") ; first non e-code DX is principal (qulifier "BK"), the rest have qualifier "BF"
"RTN","IBCEF2",151,0)
 I IBINS D
"RTN","IBCEF2",152,0)
 .I CT>8 S CT="" Q  ;Only 8 codes for institutional/UB  **232**
"RTN","IBCEF2",153,0)
 .S DXIEN=$P(DX(CT),U,2) Q:DXIEN=""
"RTN","IBCEF2",154,0)
 .S POA=$P($G(^IBA(362.3,DXIEN,0)),U,4) I POA="",$$INPAT^IBCEF(IBXIEN) S POA=1 ; POA indicator defaults to "1", if not present on inpatient claim
"RTN","IBCEF2",155,0)
 .S:EDX DXQ="BN" ; e-code DX qualifier
"RTN","IBCEF2",156,0)
 .Q
"RTN","IBCEF2",157,0)
 I 'IBINS S:EDX DXQ="BF" S POA="" ; on CMS-1500 e-code DX qualifiers are "BF" and there's no POA
"RTN","IBCEF2",158,0)
 I 'IBINS,CT>8 S ^TMP("IBXSAVE",$J,"DX",IBXIEN)=$G(^TMP("IBXSAVE",$J,"DX",IBXIEN))+1,^TMP("IBXSAVE",$J,"DX",IBXIEN,$P(DX(+^TMP("IBXSAVE",$J,"DX",IBXIEN)),U,2))=$G(^TMP("IBXSAVE",$J,"DX",IBXIEN)) S DX="" Q
"RTN","IBCEF2",159,0)
 I CT'="",DX'="" D
"RTN","IBCEF2",160,0)
 .; populate ^TMP("DCX") scratch global
"RTN","IBCEF2",161,0)
 .S ^TMP("DCX",$J,1)=CT,CNT=$G(^TMP("DCX",$J,I))+1,^TMP("DCX",$J,I)=CNT
"RTN","IBCEF2",162,0)
 .S (^TMP("DCX",$J,I,CNT),^TMP("DCX",$J,1,CT))=DX_U_DXQ_U_POA
"RTN","IBCEF2",163,0)
 .S LN=LN+1 D ID(LN,VAL) S ^TMP("IBXSAVE",$J,"DX",IBXIEN,$P(DX(LN),U,2))=LN,^TMP("IBXSAVE",$J,"DX",IBXIEN)=CT,CT=CT+1
"RTN","IBCEF2",164,0)
 .Q
"RTN","IBCEF2",165,0)
 Q
"RTN","IBCEF2",166,0)
 ;
"RTN","IBCEF2",167,0)
M(CT) ; Calculate multi-valued field for 837 extract
"RTN","IBCEF2",168,0)
 ; CT = passed by reference/the record ID counter
"RTN","IBCEF2",169,0)
 S CT=CT+1
"RTN","IBCEF2",170,0)
 Q $E(CT#12+$S(CT#12:0,1:12)_" ",1,2)
"RTN","IBCEF2",171,0)
 ;
"RTN","IBCEF2",172,0)
SVITM(IBA,LINE) ; Saves the linked items from the bill data extract into
"RTN","IBCEF2",173,0)
 ; an array the formatter will use to link Rxs and prosthetics
"RTN","IBCEF2",174,0)
 ; to an SV1 or SV2 line item, if possible.  Kills off IBA array entries
"RTN","IBCEF2",175,0)
 ; after they are 'moved'
"RTN","IBCEF2",176,0)
 ; IBA = array that contains the data to be saved
"RTN","IBCEF2",177,0)
 ;   subscripts are (line #,item type,item pointer)=ct
"RTN","IBCEF2",178,0)
 N Z0,Z1
"RTN","IBCEF2",179,0)
 S Z0="" F  S Z0=$O(IBA("OUTPT",LINE,Z0)) Q:Z0=""  I Z0?1N.N  S Z1="" F  S Z1=$O(IBA("OUTPT",LINE,Z0,Z1)) Q:Z1=""  S ^TMP($J,"IBITEM",Z0,Z1,LINE)=IBA("OUTPT",LINE,Z0,Z1) K IBA("OUTPT",LINE,Z0,Z1)
"RTN","IBCEF2",180,0)
 Q
"RTN","IBCEF2",181,0)
 ;
"RTN","IBCEF2",182,0)
LINK(IBTYP,IBDATA) ; Link the item with a service line, if possible
"RTN","IBCEF2",183,0)
 ; IBTYP = the code for the type of item
"RTN","IBCEF2",184,0)
 ;         returned incremented if no link is made
"RTN","IBCEF2",185,0)
 ; IBDATA = the extracted data string that identifies the item. 
"RTN","IBCEF2",186,0)
 ; Returns the line to link to or null if no link
"RTN","IBCEF2",187,0)
 N IBLN,IBKEY,Z
"RTN","IBCEF2",188,0)
 S IBLN=""
"RTN","IBCEF2",189,0)
 S IBKEY=$S(IBTYP=3:$P(IBDATA,U,9),IBTYP=5:$P(IBDATA,U,4),1:"") Q:IBKEY=""
"RTN","IBCEF2",190,0)
 I $D(^TMP($J,"IBITEM",IBTYP,IBKEY)) D  G:IBLN LINKQ
"RTN","IBCEF2",191,0)
 .S Z=0 F  S Z=$O(^TMP($J,"IBITEM",IBTYP,IBKEY,Z)) Q:'Z  I ^TMP($J,"IBITEM",IBTYP,IBKEY,Z) S IBLN=Z,^TMP($J,"IBITEM",IBTYP,IBKEY,Z)=^TMP($J,"IBITEM",IBTYP,IBKEY,Z)-1 Q
"RTN","IBCEF2",192,0)
 I $D(^TMP($J,"IBITEM",IBTYP,0)) S IBKEY=0 D
"RTN","IBCEF2",193,0)
 .S Z=0 F  S Z=$O(^TMP($J,"IBITEM",IBTYP,IBKEY,Z)) Q:'Z  I ^TMP($J,"IBITEM",IBTYP,IBKEY,Z) S IBLN=Z,^TMP($J,"IBITEM",IBTYP,IBKEY,Z)=^TMP($J,"IBITEM",IBTYP,IBKEY,Z)-1 Q
"RTN","IBCEF2",194,0)
LINKQ Q IBLN
"RTN","IBCEF2",195,0)
 ;
"RTN","IBCEF2",196,0)
COID(IBIFN) ; Claim office ID - moved for space
"RTN","IBCEF2",197,0)
 Q $$COID^IBCEF21(IBIFN)
"RTN","IBCEF2",198,0)
 ;
"RTN","IBCEF2",199,0)
PPOL(IBIFN,COB) ; return IFN of patient policy on a bill defined by COB (fields 399,112-114)
"RTN","IBCEF2",200,0)
 N X,Y,PPOL S PPOL=""
"RTN","IBCEF2",201,0)
 I +$G(IBIFN) S X=$G(^DGCR(399,+IBIFN,"M")) I +$G(COB),COB<4 S Y=COB+11,PPOL=$P(X,U,Y)
"RTN","IBCEF2",202,0)
 Q PPOL
"RTN","IBCEF2",203,0)
 ;
"RTN","IBCEF2",204,0)
LADJ(SUB,LINE,SEQ1,GRP,IBXSAVE,PIECE) ; Extract line level adjustments
"RTN","IBCEF2",205,0)
 ; SUB     = 1st subscript in IBXSAVE array to use
"RTN","IBCEF2",206,0)
 ; LINE    = 2nd subscript
"RTN","IBCEF2",207,0)
 ; SEQ1    = 4th subscript
"RTN","IBCEF2",208,0)
 ; GRP     = 5th subscript
"RTN","IBCEF2",209,0)
 ; IBXSAVE = array that has the data for COB line level adjustments
"RTN","IBCEF2",210,0)
 ; PIECE   = # of the piece on the 0-node of the line level
"RTN","IBCEF2",211,0)
 ;           adjustment reason to be extracted
"RTN","IBCEF2",212,0)
 ;
"RTN","IBCEF2",213,0)
 N A,B
"RTN","IBCEF2",214,0)
 S (A,B)=0
"RTN","IBCEF2",215,0)
 F  S A=$O(IBXSAVE(SUB,LINE,"COB",SEQ1,GRP,A)) Q:'A  D
"RTN","IBCEF2",216,0)
 . S B=B+1,IBXDATA(B)=$P(IBXSAVE(SUB,LINE,"COB",SEQ1,GRP,A),U,PIECE)
"RTN","IBCEF2",217,0)
 Q
"RTN","IBCEF2",218,0)
 ;
"RTN","IBCEF2",219,0)
ESGHPST(IBIFN,COB) ; return insureds employ status if bill policy defined by COB is an Employer Sponsored Group Health Plan
"RTN","IBCEF2",220,0)
 Q $$ESGHPST^IBCEF21(IBIFN,COB) ;Tag moved
"RTN","IBCEF2",221,0)
 ;
"RTN","IBCEF2",222,0)
ESGHPNL(IBIFN,COB) ; return employer name and location if bill policy defined by COB is an Employer Sponsored Group Health Plan
"RTN","IBCEF2",223,0)
 Q $$ESGHPNL^IBCEF21(IBIFN,COB) ;Tag moved
"RTN","IBCEF2",224,0)
 ;
"RTN","IBCEF2",225,0)
AMTOUT(A,B,C,IBXSAVE) ; format output amount
"RTN","IBCEF2",226,0)
 ;
"RTN","IBCEF2",227,0)
 N Z,K,IBZ,IBARR K IBXDATA S (IBZ,K)=0,IBARR="IBXSAVE("""_A_""")" F  S IBZ=$O(@IBARR@(IBZ)) Q:'IBZ  S K=K+1,Z=0 F  S Z=$O(@IBARR@(IBZ,Z)) Q:'Z  I $P($G(@IBARR@(IBZ,Z,B)),U,C) S IBXDATA(K)=$$DOLLAR^IBCEFG1($G(IBXDATA(K))+$P(@IBARR@(IBZ,Z,B),U,C))
"RTN","IBCEF2",228,0)
 Q
"RTN","IBCESRV2")
0^6^B60363273^B58582884
"RTN","IBCESRV2",1,0)
IBCESRV2 ;ALB/TMP - Server based Auto-update utilities - IB EDI ;03/05/96
"RTN","IBCESRV2",2,0)
 ;;2.0;INTEGRATED BILLING;**137,191,155,296,403**;21-MAR-94;Build 24
"RTN","IBCESRV2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCESRV2",4,0)
 Q
"RTN","IBCESRV2",5,0)
 ;
"RTN","IBCESRV2",6,0)
CON837 ; Confirmation of 837 batch - auto update
"RTN","IBCESRV2",7,0)
 ;Input expected: IBTDA = the ien of the message entry in file 364.2
"RTN","IBCESRV2",8,0)
 ;
"RTN","IBCESRV2",9,0)
 N IB0,IBBDA,IBBILL,IBMSG,IBFLAG,IBTYP,IBBST,DR,DA,DIE,Z
"RTN","IBCESRV2",10,0)
 Q:'$G(IBTDA)
"RTN","IBCESRV2",11,0)
 S IB0=$G(^IBA(364.2,IBTDA,0)),IBBDA=+$P(IB0,U,4) ;Batch ien
"RTN","IBCESRV2",12,0)
 S IBTYP=$P($G(^IBE(364.3,+$P(IB0,U,2),0)),U)
"RTN","IBCESRV2",13,0)
 ;
"RTN","IBCESRV2",14,0)
 Q:IBTYP'["837REC"
"RTN","IBCESRV2",15,0)
 ;
"RTN","IBCESRV2",16,0)
 I $P(IB0,U,14) D UPDTEST^IBCEPTM(IBTDA) Q  ; Test claim message from claim resubmitted claim
"RTN","IBCESRV2",17,0)
 ;
"RTN","IBCESRV2",18,0)
 ; Austin receipt is '837REC0',
"RTN","IBCESRV2",19,0)
 ;  other non-payer confirmations are '837REC1',
"RTN","IBCESRV2",20,0)
 ;  payer confirmations are '837REC2'
"RTN","IBCESRV2",21,0)
 S IBTYP=+$P(IBTYP,"837REC",2)
"RTN","IBCESRV2",22,0)
 S IBBST=$P($G(^IBA(364.1,IBBDA,0)),U,2)
"RTN","IBCESRV2",23,0)
 ;
"RTN","IBCESRV2",24,0)
 I $S(IBBST?1"A"1N:IBTYP<+$P(IBBST,"A",2),1:0) D  Q
"RTN","IBCESRV2",25,0)
 . ;Don't allow status to go backwards
"RTN","IBCESRV2",26,0)
 . D DELMSG(IBTDA)
"RTN","IBCESRV2",27,0)
 ;
"RTN","IBCESRV2",28,0)
 D UPDCONF(IBBDA,IBTDA,IBTYP,1)
"RTN","IBCESRV2",29,0)
 ;
"RTN","IBCESRV2",30,0)
 Q
"RTN","IBCESRV2",31,0)
 ;
"RTN","IBCESRV2",32,0)
BILLSTAC(IBBILL,IBTYP) ;Change status of transmit bill
"RTN","IBCESRV2",33,0)
 ; IBBILL = the ien of the entry in file 364 to update
"RTN","IBCESRV2",34,0)
 ; IBTYP = code for new status (see field 364;.03 for details)
"RTN","IBCESRV2",35,0)
 ;
"RTN","IBCESRV2",36,0)
 N IBSTAT,DIE,DA,DR,X,Y
"RTN","IBCESRV2",37,0)
 ;
"RTN","IBCESRV2",38,0)
 S IBSTAT=$P($G(^IBA(364,IBBILL,0)),U,3)
"RTN","IBCESRV2",39,0)
 ;
"RTN","IBCESRV2",40,0)
 Q:IBSTAT=IBTYP!(IBTYP="")  ;Status hasn't changed or new status is null
"RTN","IBCESRV2",41,0)
 Q:"CREZ"[IBSTAT  ;Don't update status of completed transmit record
"RTN","IBCESRV2",42,0)
 ;
"RTN","IBCESRV2",43,0)
 ; Don't allow the status to go backwards
"RTN","IBCESRV2",44,0)
 I $E(IBSTAT)="A","PX"[IBTYP Q
"RTN","IBCESRV2",45,0)
 I $E(IBSTAT)="A",$E(IBTYP)="A",$P(IBTYP,"A",2)<$P(IBSTAT,"A",2) Q
"RTN","IBCESRV2",46,0)
 ;
"RTN","IBCESRV2",47,0)
 S DIE="^IBA(364,",DA=IBBILL,DR=".03////"_IBTYP_";.04///NOW" D ^DIE
"RTN","IBCESRV2",48,0)
 Q
"RTN","IBCESRV2",49,0)
 ;
"RTN","IBCESRV2",50,0)
REJ837 ; Rejections 837
"RTN","IBCESRV2",51,0)
 ;Input IBTDA = the ien of the message entry in file 364.2
"RTN","IBCESRV2",52,0)
 ;
"RTN","IBCESRV2",53,0)
 Q:'$G(IBTDA)
"RTN","IBCESRV2",54,0)
 ;
"RTN","IBCESRV2",55,0)
 D UPDREJ(+$P($G(^IBA(364.2,IBTDA,0)),U,4),IBTDA)
"RTN","IBCESRV2",56,0)
 Q
"RTN","IBCESRV2",57,0)
 ;
"RTN","IBCESRV2",58,0)
DELMSG(IBTDA) ;
"RTN","IBCESRV2",59,0)
 ; Delete message after it successfully updates the database.
"RTN","IBCESRV2",60,0)
 ; IBTDA = the ien of the message in file 364.2
"RTN","IBCESRV2",61,0)
 D TRADEL^IBCESRV1(IBTDA)
"RTN","IBCESRV2",62,0)
 Q
"RTN","IBCESRV2",63,0)
 ;
"RTN","IBCESRV2",64,0)
BILLSTAR(IBBILL,IBTDA) ;Change status of transmit bill and bill on rejection
"RTN","IBCESRV2",65,0)
 ; IBBILL = ien of bill (399)
"RTN","IBCESRV2",66,0)
 ; IBTDA = ien of error message
"RTN","IBCESRV2",67,0)
 ;
"RTN","IBCESRV2",68,0)
 N DR,DIE,DA,IBSTAT,IBDA,IBCBH
"RTN","IBCESRV2",69,0)
 ;
"RTN","IBCESRV2",70,0)
 S IBDA=$S($P($G(^IBA(364.2,IBTDA,0)),U,5):$P(^(0),U,5),1:+$O(^IBA(364,"B",IBBILL,""),-1))
"RTN","IBCESRV2",71,0)
 S IBSTAT=$P($G(^IBA(364,IBDA,0)),U,3),IBCBH=$P($G(^DGCR(399,IBBILL,0)),U,21)
"RTN","IBCESRV2",72,0)
 ;
"RTN","IBCESRV2",73,0)
 Q:"CREZ"[IBSTAT  ;Don't update status of completed transmit record
"RTN","IBCESRV2",74,0)
 ;
"RTN","IBCESRV2",75,0)
 I IBSTAT'="E" S DIE="^IBA(364,",DA=IBDA,DR=".03////E;.04///NOW;.05////"_IBTDA D ^DIE
"RTN","IBCESRV2",76,0)
 ;
"RTN","IBCESRV2",77,0)
 ; Don't process further if only testing transmission with insurance co
"RTN","IBCESRV2",78,0)
 Q:+$G(^DIC(36,+$P($G(^DGCR(399,IBBILL,"I"_($F("PST",IBCBH)-1))),U),3))=2
"RTN","IBCESRV2",79,0)
 ;
"RTN","IBCESRV2",80,0)
 ; Suspend bill if waiting for MRA - allows it to be edited
"RTN","IBCESRV2",81,0)
 ;I $P($G(^DGCR(399,IBBILL,0)),U,13)=2,$$NEEDMRA^IBEFUNC(IBBILL)="1N" S DIE="^DGCR(399,",DA=IBBILL,DR=".13////6" D:DA ^DIE
"RTN","IBCESRV2",82,0)
 Q
"RTN","IBCESRV2",83,0)
 ;
"RTN","IBCESRV2",84,0)
UPDMSG(IBTDA,STAT,UPD) ; Update msg with status of 'P','U' or delete message
"RTN","IBCESRV2",85,0)
 ; STAT = 'P' 'U' for pending or updating, 'R' to delete
"RTN","IBCESRV2",86,0)
 ; UPD = flag that says update the data base updated field (.12) if 1
"RTN","IBCESRV2",87,0)
 ;
"RTN","IBCESRV2",88,0)
 N DIE,DA,DR
"RTN","IBCESRV2",89,0)
 ;
"RTN","IBCESRV2",90,0)
 I STAT="R" D DELMSG(IBTDA) Q
"RTN","IBCESRV2",91,0)
 ;
"RTN","IBCESRV2",92,0)
 I $P($G(^IBA(364.2,IBTDA,0)),U,6)'=STAT D
"RTN","IBCESRV2",93,0)
 . S DR=".06////"_STAT_$S($G(UPD):".12////1",1:"")
"RTN","IBCESRV2",94,0)
 . S DIE="^IBA(364.2,",DA=IBTDA
"RTN","IBCESRV2",95,0)
 . I $G(^IBA(364.2,DA,0)) D ^DIE
"RTN","IBCESRV2",96,0)
 Q
"RTN","IBCESRV2",97,0)
 ;
"RTN","IBCESRV2",98,0)
STOREM(IBTDA,IBTEXT,IBE) ;Store message text in file 364.2
"RTN","IBCESRV2",99,0)
 ; INPUT:
"RTN","IBCESRV2",100,0)
 ;   IBTDA = ien in file 364 message field entry #IBTDA
"RTN","IBCESRV2",101,0)
 ;   IBTEXT = name of the array where the message text is retrieved from
"RTN","IBCESRV2",102,0)
 ;            or "@" to delete the text from the message field
"RTN","IBCESRV2",103,0)
 ; OUTPUT:
"RTN","IBCESRV2",104,0)
 ;   IBE = array of errors (IBE("DIERR")) returned, pass by reference
"RTN","IBCESRV2",105,0)
 ;
"RTN","IBCESRV2",106,0)
 N IBZ,X,Y
"RTN","IBCESRV2",107,0)
 ;
"RTN","IBCESRV2",108,0)
 Q:$S($G(IBTEXT)="@":0,1:$D(@IBTEXT)<10)
"RTN","IBCESRV2",109,0)
 ;
"RTN","IBCESRV2",110,0)
 K IBE("DIERR")
"RTN","IBCESRV2",111,0)
 ;
"RTN","IBCESRV2",112,0)
 F IBZ=1:1:20 D WP^DIE(364.2,IBTDA_",",2,"AK",""_IBTEXT_"","IBE") Q:$S('$D(IBE("DIERR")):1,+IBE("DIERR")=1:$G(IBE("DIERR",1))'=110,1:1)  K IBE("DIERR") H .5 ; On lock error, retry up to 20 times
"RTN","IBCESRV2",113,0)
 Q
"RTN","IBCESRV2",114,0)
 ;
"RTN","IBCESRV2",115,0)
CKRES(IBBDA,IBDEF,IBLIST) ;Chk to see if the batch file can be updated to
"RTN","IBCESRV2",116,0)
 ; completely resubmitted based on finding all bills in it
"RTN","IBCESRV2",117,0)
 ; having a status of cancelled, resubmitted, deleted or closed
"RTN","IBCESRV2",118,0)
 ; or if none of these statuses, they at least have a transmission
"RTN","IBCESRV2",119,0)
 ; record for the same bill created at a later date/time.
"RTN","IBCESRV2",120,0)
 ;
"RTN","IBCESRV2",121,0)
 ; IBBDA : Batch # ien in file 364.1
"RTN","IBCESRV2",122,0)
 ; IBDEF : Default to set the batch status to.
"RTN","IBCESRV2",123,0)
 ;         0 or undefined, status will set to 0 (NOT INCOMPLETE)
"RTN","IBCESRV2",124,0)
 ;                         if no incomplete submissions found
"RTN","IBCESRV2",125,0)
 ;         1 status will set to 1 (INCOMPLETE)
"RTN","IBCESRV2",126,0)
 ;                  if any incomplete submissions found
"RTN","IBCESRV2",127,0)
 ;        -1 status will not be updated
"RTN","IBCESRV2",128,0)
 ; IBLIST : If passed by reference and IBLIST=1, returns list of bill
"RTN","IBCESRV2",129,0)
 ;          #'s not resubmitted in IBLIST(ien of file 364)=""
"RTN","IBCESRV2",130,0)
 ;
"RTN","IBCESRV2",131,0)
 N IB,IBINC,IBBILL,DIE,DR,DA,Z,Z0
"RTN","IBCESRV2",132,0)
 ;
"RTN","IBCESRV2",133,0)
 S IBDEF=+$G(IBDEF),IBINC=0
"RTN","IBCESRV2",134,0)
 Q:$S('$G(IBBDA):1,IBDEF'<0:'$P($G(^IBA(364.1,IBBDA,0)),U,10),1:0)
"RTN","IBCESRV2",135,0)
 ;
"RTN","IBCESRV2",136,0)
 I $G(IBLIST) K IBLIST S IBLIST=1
"RTN","IBCESRV2",137,0)
 S IB="" F  S IB=$O(^IBA(364,"ABAST",IBBDA,IB)) Q:IB=""  I "CRDZ"'[IB D  Q:'$G(IBLIST)
"RTN","IBCESRV2",138,0)
 . S Z=0 F  S Z=$O(^IBA(364,"ABAST",IBBDA,IB,Z)) Q:'Z  D
"RTN","IBCESRV2",139,0)
 .. S Z0=($$LAST364^IBCEF4(+$G(^IBA(364,Z,0)))=Z)
"RTN","IBCESRV2",140,0)
 .. I Z0,'$G(IBLIST) S IBINC=1 Q
"RTN","IBCESRV2",141,0)
 .. I $G(IBLIST),Z0 S IBLIST(Z)=""
"RTN","IBCESRV2",142,0)
 ;
"RTN","IBCESRV2",143,0)
 I $S('IBDEF:'IBINC,IBDEF>0:IBINC,1:0) S DA=IBBDA,DIE="^IBA(364.1,",DR=".1////"_IBDEF D ^DIE
"RTN","IBCESRV2",144,0)
 ;
"RTN","IBCESRV2",145,0)
 Q
"RTN","IBCESRV2",146,0)
 ;
"RTN","IBCESRV2",147,0)
UPDCONF(IBBDA,IBTDA,IBTYP,IBAUTO) ; Add status msgs to STATUS file #361
"RTN","IBCESRV2",148,0)
 ;   Update data base from confirmation msg
"RTN","IBCESRV2",149,0)
 ; IBBDA = ien of batch
"RTN","IBCESRV2",150,0)
 ; IBTDA = ien of message
"RTN","IBCESRV2",151,0)
 ; IBTYP = type of message
"RTN","IBCESRV2",152,0)
 ;         (0=Austin confirmation, 1=confirmation by non-payer
"RTN","IBCESRV2",153,0)
 ;          2=confirmation by payer)
"RTN","IBCESRV2",154,0)
 ; IBAUTO = flag for update mode
"RTN","IBCESRV2",155,0)
 ;         0 or null : manual   1 : auto
"RTN","IBCESRV2",156,0)
 ; ^TMP("IBCONF",$J,bill ien)="" where bill ien is the internal entry
"RTN","IBCESRV2",157,0)
 ;         number of any bills in file 364 to be excluded from the
"RTN","IBCESRV2",158,0)
 ;         confirmation due to reported errors
"RTN","IBCESRV2",159,0)
 ;
"RTN","IBCESRV2",160,0)
 N IBBILL,IBIDA,PRCASV,DA,DIE,DR,IBFLAG,IB0,IBS
"RTN","IBCESRV2",161,0)
 ;
"RTN","IBCESRV2",162,0)
 D UPDMSG(IBTDA,"U",0)
"RTN","IBCESRV2",163,0)
 ;
"RTN","IBCESRV2",164,0)
 S IB0=$G(^IBA(364.2,IBTDA,0))
"RTN","IBCESRV2",165,0)
 S IBS="A"_IBTYP
"RTN","IBCESRV2",166,0)
 ;
"RTN","IBCESRV2",167,0)
 S IBBILL="" F  S IBBILL=$O(^IBA(364,"ABABI",+IBBDA,IBBILL)) Q:'IBBILL  D
"RTN","IBCESRV2",168,0)
 . Q:$D(^TMP("IBCONF",$J,IBBILL))  ;Bill was rejected
"RTN","IBCESRV2",169,0)
 . ;Update status of all valid bills in a batch
"RTN","IBCESRV2",170,0)
 . S IBIDA=0 F  S IBIDA=$O(^IBA(364,"ABABI",IBBDA,IBBILL,IBIDA)) Q:'IBIDA  D
"RTN","IBCESRV2",171,0)
 .. D BILLSTAC(IBIDA,IBS)
"RTN","IBCESRV2",172,0)
 . ;
"RTN","IBCESRV2",173,0)
 . I 'IBTYP D
"RTN","IBCESRV2",174,0)
 .. S DR="20///NOW"
"RTN","IBCESRV2",175,0)
 .. S:$P($G(^DGCR(399,IBBILL,"TX")),U,5)="1N" DR=DR_";24///1R"
"RTN","IBCESRV2",176,0)
 .. S DA=IBBILL,DIE="^DGCR(399," D ^DIE
"RTN","IBCESRV2",177,0)
 ;
"RTN","IBCESRV2",178,0)
 I 'IBTYP D DELMSG(IBTDA)   ; remove Austin batch confirmation record from file 364.2
"RTN","IBCESRV2",179,0)
 ;
"RTN","IBCESRV2",180,0)
 I 'IBBDA,$P(IB0,U,5) D
"RTN","IBCESRV2",181,0)
 . N IB
"RTN","IBCESRV2",182,0)
 . S IB=$P($G(^IBA(364,+$P(IB0,U,5),0)),U,2) ; batch
"RTN","IBCESRV2",183,0)
 . D BILLSTAC($P(IB0,U,5),IBS) ;Upd individual transmitted bill entry
"RTN","IBCESRV2",184,0)
 . I $G(^IBA(364.1,+IB,0)),$P($G(^(0)),U,2)'="A0" S DIE="^IBA(364.1,",DA=+IB,DR=".02////A0" D ^DIE
"RTN","IBCESRV2",185,0)
 ;
"RTN","IBCESRV2",186,0)
 I IBBDA,$P($G(^IBA(364.1,+IBBDA,0)),U,2)'=IBS D
"RTN","IBCESRV2",187,0)
 . S DA=IBBDA,DIE="^IBA(364.1,"
"RTN","IBCESRV2",188,0)
 . S DR=".02////"_IBS_$S($G(IBFLAG)'="":";.06////"_IBFLAG,1:"")_";1.05////"_$P(IB0,U,10)_";1.06///NOW"
"RTN","IBCESRV2",189,0)
 . D ^DIE
"RTN","IBCESRV2",190,0)
 ;
"RTN","IBCESRV2",191,0)
 ; Add message to bill status file 361 for bill
"RTN","IBCESRV2",192,0)
 I IBTYP D UPD361^IBCEST(IBTDA)
"RTN","IBCESRV2",193,0)
 ;
"RTN","IBCESRV2",194,0)
 S ZTREQ="@"
"RTN","IBCESRV2",195,0)
 K ^TMP("IBCONF",$J)
"RTN","IBCESRV2",196,0)
 Q
"RTN","IBCESRV2",197,0)
 ;
"RTN","IBCESRV2",198,0)
UPDREJ(IBBDA,IBTDA) ;  Update data base from rejection msg
"RTN","IBCESRV2",199,0)
 ; IBBDA = ien of batch
"RTN","IBCESRV2",200,0)
 ; IBTDA = ien of message
"RTN","IBCESRV2",201,0)
 ;
"RTN","IBCESRV2",202,0)
 N DA,DR,DIE,IBBILL,IBTBILL,IB0
"RTN","IBCESRV2",203,0)
 ;
"RTN","IBCESRV2",204,0)
 D UPDMSG(IBTDA,"U",0)
"RTN","IBCESRV2",205,0)
 ;
"RTN","IBCESRV2",206,0)
 S IB0=$G(^IBA(364.2,IBTDA,0)),IBTBILL=+$P(IB0,U,5),IBBILL=+$G(^IBA(364,IBTBILL,0))
"RTN","IBCESRV2",207,0)
 ;
"RTN","IBCESRV2",208,0)
 I $P(IB0,U,14) D UPDTEST^IBCEPTM(IBTDA) Q  ; Test claim message from claim resubmission - store in test msg file instead
"RTN","IBCESRV2",209,0)
 ;
"RTN","IBCESRV2",210,0)
 I IBBILL D BILLSTAR(IBBILL,IBTDA) ;Update individual bill
"RTN","IBCESRV2",211,0)
 ;
"RTN","IBCESRV2",212,0)
 I IBBDA,'IBBILL D
"RTN","IBCESRV2",213,0)
 . S DA=IBBDA,DIE="^IBA(364.1,"
"RTN","IBCESRV2",214,0)
 . S DR=".11////"_IBTDA_";.06////1;1.05////"_$P(IB0,U,10)_";1.06///NOW;.05////1"
"RTN","IBCESRV2",215,0)
 . D ^DIE ;Batch Rejected
"RTN","IBCESRV2",216,0)
 .;
"RTN","IBCESRV2",217,0)
 . ;Update status of all bills in batch, bill file
"RTN","IBCESRV2",218,0)
 . F  S IBBILL=$O(^IBA(364,"ABABI",IBBDA,IBBILL)) Q:'IBBILL  D BILLSTAR(IBBILL,IBTDA)
"RTN","IBCESRV2",219,0)
 ;
"RTN","IBCESRV2",220,0)
 ;Add message to bill status file 361 for bill
"RTN","IBCESRV2",221,0)
 D UPD361^IBCEST(IBTDA)
"RTN","IBCESRV2",222,0)
 ;
"RTN","IBCESRV2",223,0)
 S ZTREQ="@"
"RTN","IBCESRV2",224,0)
 Q
"RTN","IBCESRV2",225,0)
 ;
"RTN","IBCESRV2",226,0)
MAILIT ; Mails the report text (bulletin) to the IB EDI SUPERVISOR mail grp;
"RTN","IBCESRV2",227,0)
 N IB0,IBHD,IBL,IBZ,IBOK,XMTO,XMSUBJ,XMBODY,XMDUZ,XMZ,Z
"RTN","IBCESRV2",228,0)
 K ^TMP("IBMSG",$J),^TMP("IBMSGH",$J)
"RTN","IBCESRV2",229,0)
 Q:'$G(IBTDA)  ;Assume this exists and is the IEN of the message in 364.2
"RTN","IBCESRV2",230,0)
 S (IBL,IBZ,IBHD)=0,IBOK=1
"RTN","IBCESRV2",231,0)
 F  S IBZ=$O(^IBA(364.2,IBTDA,2,IBZ)) Q:'IBZ  S IB0=$G(^(IBZ,0)) D
"RTN","IBCESRV2",232,0)
 . Q:$P(IB0,U)="REPORT"!($E(IB0,1,4)="99^$")
"RTN","IBCESRV2",233,0)
 . ;
"RTN","IBCESRV2",234,0)
 . I $P(IB0,U)="SUBJECT" D  Q
"RTN","IBCESRV2",235,0)
 .. I $O(^TMP("IBMSG",$J,0)) D SEND(.IBOK) ; send last report
"RTN","IBCESRV2",236,0)
 .. S ^TMP("IBMSGH",$J)=$P(IB0,"SUBJECT^",2)
"RTN","IBCESRV2",237,0)
 . ;
"RTN","IBCESRV2",238,0)
 . I $E(IB0,1,18)="***  NEW PAGE  ***" D  Q
"RTN","IBCESRV2",239,0)
 .. F Z=1:1:5 S IBL=IBL+1,^TMP("IBMSG",$J,IBL)=" "
"RTN","IBCESRV2",240,0)
 .. S ^TMP("IBMSG",$J,IBL)="*** END OF PAGE ***"
"RTN","IBCESRV2",241,0)
 .. F Z=1,2 S IBL=IBL+1,^TMP("IBMSG",$J,IBL)=" "
"RTN","IBCESRV2",242,0)
 . S IBL=IBL+1,^TMP("IBMSG",$J,IBL)=IB0
"RTN","IBCESRV2",243,0)
 . ;
"RTN","IBCESRV2",244,0)
 I $O(^TMP("IBMSG",$J,0)) D SEND(.IBOK)
"RTN","IBCESRV2",245,0)
 I IBOK D DELMSG($G(IBTDA))
"RTN","IBCESRV2",246,0)
 K ^TMP("IBMSG",$J),^TMP($J,"IBMSGH",$J)
"RTN","IBCESRV2",247,0)
 Q
"RTN","IBCESRV2",248,0)
 ;
"RTN","IBCESRV2",249,0)
SEND(IBOK) ; Send actual message for 1 report
"RTN","IBCESRV2",250,0)
 ;
"RTN","IBCESRV2",251,0)
 N XMSUBJ,XMBODY,XMTO,XMZ,XMDUZ
"RTN","IBCESRV2",252,0)
 S XMSUBJ=$G(^TMP("IBMSGH",$J)),XMBODY="^TMP(""IBMSG"",$J)",XMTO("I:G.IB EDI SUPERVISOR")=""
"RTN","IBCESRV2",253,0)
 D SENDMSG^XMXAPI(,$E(XMSUBJ,1,65),XMBODY,.XMTO,,.XMZ)
"RTN","IBCESRV2",254,0)
 I '$G(XMZ) S IBOK=0
"RTN","IBCESRV2",255,0)
 K ^TMP("IBMSG",$J),^TMP("IBMSGH",$J)
"RTN","IBCESRV2",256,0)
 Q
"RTN","IBCESRV2",257,0)
 ;
"RTN","IBCEU4")
0^7^B53347889^B51192138
"RTN","IBCEU4",1,0)
IBCEU4 ;ALB/TMP - EDI UTILITIES ;02-OCT-96
"RTN","IBCEU4",2,0)
 ;;2.0;INTEGRATED BILLING;**51,137,210,155,290,403**;21-MAR-94;Build 24
"RTN","IBCEU4",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEU4",4,0)
 ;
"RTN","IBCEU4",5,0)
TESTFLD ;  Entrypoint to call to test the output the formatter will
"RTN","IBCEU4",6,0)
 ;  produce for a specific entry in file 364.7
"RTN","IBCEU4",7,0)
 ;
"RTN","IBCEU4",8,0)
 N X,Y,DIC,IBCT
"RTN","IBCEU4",9,0)
 K IBXDATA,IBXSAVE
"RTN","IBCEU4",10,0)
 S IBCT=0
"RTN","IBCEU4",11,0)
 F  W !,$S(IBCT:"Another ",1:""),"Bill: " S DIC="^DGCR(399,",DIC(0)="AEMQ" D ^DIC Q:Y<0  D
"RTN","IBCEU4",12,0)
 . S IBCT=1
"RTN","IBCEU4",13,0)
 . K ^TMP($J),^TMP("IBXSAVE",$J),^TMP("IBXDATA",$J),IBXSAVE,IBXDATA
"RTN","IBCEU4",14,0)
 . D FLDS(+Y)
"RTN","IBCEU4",15,0)
 . F  R !!,"VARIABLE TO DISPLAY (IBXDATA): ",X:DTIME Q:X["^"  S:X="" X="IBXDATA" D
"RTN","IBCEU4",16,0)
 .. I $S($E(X,$L(X))'=")"&($L(X,"(")>1):1,1:$L(X,"(")'=$L(X,")")) W !,"BAD VARIABLE NAME" Q
"RTN","IBCEU4",17,0)
 .. I '$D(@X) W "   *** NO DATA TO DISPLAY" Q
"RTN","IBCEU4",18,0)
 .. N S S S=X
"RTN","IBCEU4",19,0)
 .. W !,X," = ",$G(@X)
"RTN","IBCEU4",20,0)
 .. F  S X=$Q(@X) Q:X'[S  W !,X," = ",@X
"RTN","IBCEU4",21,0)
 .. W !
"RTN","IBCEU4",22,0)
 Q
"RTN","IBCEU4",23,0)
 ;
"RTN","IBCEU4",24,0)
FLDS(IBIFN) ; Extract fields for bill IBIFN
"RTN","IBCEU4",25,0)
 N X,Y,DIC,IB1,IBI,IBAR,IBXPG,IBXLN,IBXCOL,IBXREC,Z,Z0
"RTN","IBCEU4",26,0)
 W !,"Remember to run this for flds that set up pre-requisite data (if any) first",!
"RTN","IBCEU4",27,0)
 ;
"RTN","IBCEU4",28,0)
 S IB1=1
"RTN","IBCEU4",29,0)
 F  W !,$S('IB1:"Another ",1:""),"Form Field: " S DIC="^IBA(364.7,",DIC(0)="AEMQZ" D ^DIC Q:Y<0  D
"RTN","IBCEU4",30,0)
 . S IB1=0
"RTN","IBCEU4",31,0)
 . N IBZXX,IBXIEN
"RTN","IBCEU4",32,0)
 . ; Execute data element logic for fld
"RTN","IBCEU4",33,0)
 . S IBI=+Y,Z=$P($G(^IBA(364.5,+$P(Y(0),U,3),0)),U)
"RTN","IBCEU4",34,0)
 . S Z0=$G(^IBA(364.6,+Y(0),0))
"RTN","IBCEU4",35,0)
 . S IBAR=$G(^IBA(364.5,+$P(Y(0),U,3),2)) S:IBAR="" IBAR="IBXDATA"
"RTN","IBCEU4",36,0)
 . S IBXPG=$P(Z0,U,4),IBXLN=$P(Z0,U,5),IBXCOL=$P(Z0,U,8),IBXREC=1
"RTN","IBCEU4",37,0)
 . D F^IBCEF(Z,"IBZXX","",IBIFN)
"RTN","IBCEU4",38,0)
 . Q:'$D(IBZXX)
"RTN","IBCEU4",39,0)
 . K @IBAR
"RTN","IBCEU4",40,0)
 . M @IBAR=IBZXX
"RTN","IBCEU4",41,0)
 . I $G(^IBA(364.7,IBI,1))'="" S IBXIEN=IBIFN X ^IBA(364.7,IBI,1)
"RTN","IBCEU4",42,0)
 . D CLEAN^DILF
"RTN","IBCEU4",43,0)
 Q
"RTN","IBCEU4",44,0)
 ;
"RTN","IBCEU4",45,0)
DATE(X) ; Convert date in YYYYMMDD or YYMMDD format to MM DD YYYY or MM DD YY
"RTN","IBCEU4",46,0)
 N Z
"RTN","IBCEU4",47,0)
 S Z=X
"RTN","IBCEU4",48,0)
 I $L(X)=8 S Z=$E(X,5,6)_" "_$E(X,7,8)_" "_$E(X,1,4)
"RTN","IBCEU4",49,0)
 I $L(X)=6 S Z=$E(X,3,4)_" "_$E(X,5,6)_" "_$E(X,1,2)
"RTN","IBCEU4",50,0)
 Q Z
"RTN","IBCEU4",51,0)
 ;
"RTN","IBCEU4",52,0)
MCRSPEC(IBIFN,MCR,IBPIEN) ; Returns specialty code for a provider on bill
"RTN","IBCEU4",53,0)
 ; IBIFN = bill ien (file 399)
"RTN","IBCEU4",54,0)
 ; MCR = 1 if 2-digit MCR code should be returned 0 or null=3 digit code
"RTN","IBCEU4",55,0)
 ; IBPIEN = vp of the provider for which to get the
"RTN","IBCEU4",56,0)
 ;   specialty, otherwise it returns specialty code for the 'required'
"RTN","IBCEU4",57,0)
 ;   provider on bill (default is file 200 if no file designated)
"RTN","IBCEU4",58,0)
 ;
"RTN","IBCEU4",59,0)
 N IBZ,IBDT
"RTN","IBCEU4",60,0)
 S IBZ="99" ;default if none found
"RTN","IBCEU4",61,0)
 S IBDT=$P($G(^DGCR(399,+IBIFN,"U")),U,1)  ; use statement from date
"RTN","IBCEU4",62,0)
 I '$G(IBPIEN) D F^IBCEF("N-SPECIALTY CODE","IBZ",,IBIFN)
"RTN","IBCEU4",63,0)
 I $G(IBPIEN) S:$P(IBPIEN,";",2)="" IBPIEN=IBPIEN_";VA(200," S IBZ=$$SPEC^IBCEU(IBPIEN,IBDT)
"RTN","IBCEU4",64,0)
 I '$G(MCR) S IBZ="0"_IBZ
"RTN","IBCEU4",65,0)
 Q IBZ
"RTN","IBCEU4",66,0)
 ;
"RTN","IBCEU4",67,0)
ECODE(IBP,CD) ; Function returns 1 if procedure ien IBP is an E-code
"RTN","IBCEU4",68,0)
 ; CD = returned = the external code, if passed by reference
"RTN","IBCEU4",69,0)
 N Q
"RTN","IBCEU4",70,0)
 S CD=$P($$ICD9^IBACSV(+IBP),U)
"RTN","IBCEU4",71,0)
 Q ($E(CD)="E")
"RTN","IBCEU4",72,0)
 ;
"RTN","IBCEU4",73,0)
BOX82NM(IBIFN,IBZSAVE) ; Returns the data to be printed in form locators 82
"RTN","IBCEU4",74,0)
 ; and 83 on the UB92 for bill ien IBIFN, based on the providers on the
"RTN","IBCEU4",75,0)
 ; bill
"RTN","IBCEU4",76,0)
 ; Pass array IBZSAVE by reference
"RTN","IBCEU4",77,0)
 N Z,IBZ,IBCT
"RTN","IBCEU4",78,0)
 ;
"RTN","IBCEU4",79,0)
 D F^IBCEF("N-ALL PROVIDERS","IBZ",,IBIFN)
"RTN","IBCEU4",80,0)
 F Z=1:1:6 S IBZSAVE("PRV-82",Z)=""
"RTN","IBCEU4",81,0)
 ; Find Providers and store them (if found) in this order:
"RTN","IBCEU4",82,0)
 ; Attending/Rendering, Operating, Referring, Other
"RTN","IBCEU4",83,0)
 F Z=4,2,1,9 D
"RTN","IBCEU4",84,0)
 . S IBCT=$S(Z=4:0,1:IBCT) Q:IBCT>4
"RTN","IBCEU4",85,0)
 . I Z=4,$$FT^IBCEF(IBIFN)=2 S Z=3    ; Find rendering for HCFA 1500
"RTN","IBCEU4",86,0)
 . I $S(Z=4!(Z=3):0,1:'$O(IBZ(Z,0))) Q
"RTN","IBCEU4",87,0)
 . S IBCT=IBCT+1
"RTN","IBCEU4",88,0)
 . I Z=4,$G(IBZ(4,1))="",$$FT^IBCEF(IBIFN)=3,'$D(^DGCR(399,IBIFN,"PRV")) S IBZ(Z,1)="DEPT OF VETERANS AFFAIRS" ;Default for old bills w/o prv
"RTN","IBCEU4",89,0)
 . I $O(IBZ(Z,1,1)) S IBZSAVE("PRV-82",IBCT)=$G(IBZ(Z,1,2))_" "_$G(IBZ(Z,1,3))
"RTN","IBCEU4",90,0)
 . S IBCT=IBCT+1,IBZSAVE("PRV-82",IBCT)=$P($G(IBZ(Z,1,1)),U)_" "_$P($G(IBZ(Z,1)),U)
"RTN","IBCEU4",91,0)
 Q
"RTN","IBCEU4",92,0)
 ;
"RTN","IBCEU4",93,0)
STATOK(IBIFN,VALST) ; Returns 1 if status of bill IBIFN is one of the valid
"RTN","IBCEU4",94,0)
 ;  status codes in VALST
"RTN","IBCEU4",95,0)
 N OK,Z
"RTN","IBCEU4",96,0)
 S OK=0
"RTN","IBCEU4",97,0)
 I $G(VALST)'="" S OK=$L(VALST,$P($G(^DGCR(399,IBIFN,0)),U,13))>1
"RTN","IBCEU4",98,0)
 Q OK
"RTN","IBCEU4",99,0)
 ;
"RTN","IBCEU4",100,0)
RXPRLOOK(IBX) ; Do a FM lookup of procedures for RX that can be linked
"RTN","IBCEU4",101,0)
 ; to a specific revenue code (ones that are not already soft-linked)
"RTN","IBCEU4",102,0)
 ; Function returns ien of the 'CP' node multiple for the selected proc
"RTN","IBCEU4",103,0)
 ; OR  "" if none selected or selection is invalid
"RTN","IBCEU4",104,0)
 ;
"RTN","IBCEU4",105,0)
 ; IBX = the procedure code
"RTN","IBCEU4",106,0)
 ;
"RTN","IBCEU4",107,0)
 N IBZ,IBMAX,IBEACH,IBMANY,IBHLP,IBNEXT,Z
"RTN","IBCEU4",108,0)
 S IBMAX=50,IBEACH=5,IBHLP=0
"RTN","IBCEU4",109,0)
 K ^TMP("DILIST",$J),^TMP("DIERR",$J),^TMP("DIHELP",$J),^TMP("IBLIST",$J)
"RTN","IBCEU4",110,0)
 ;
"RTN","IBCEU4",111,0)
 S IBZ=IBX
"RTN","IBCEU4",112,0)
 I IBX?1"?".E,'$D(DIQUIET) D
"RTN","IBCEU4",113,0)
 . I IBX?2"?".E S IBMAX=50,IBEACH=20 D RXPRHLP(IBMAX,.IBNEXT) S IBHLP=1
"RTN","IBCEU4",114,0)
 . S IBX=""
"RTN","IBCEU4",115,0)
 . ;
"RTN","IBCEU4",116,0)
 I IBX'="" D
"RTN","IBCEU4",117,0)
 . S:$L(IBX)<5 IBX="`"_IBX
"RTN","IBCEU4",118,0)
 . D FIND^DIC(399.0304,","_DA(1)_",","@;.01E","A",IBX,IBMAX,,"I '$$LINKED^IBCEU4(.DA,Y)")
"RTN","IBCEU4",119,0)
 . D XFER(0)
"RTN","IBCEU4",120,0)
 ;
"RTN","IBCEU4",121,0)
 S IBMANY=($G(^TMP("IBLIST",$J,0))>1)
"RTN","IBCEU4",122,0)
 I IBMANY D  ;More than one match found
"RTN","IBCEU4",123,0)
 . I $D(DIQUIET) S ^TMP("IBLIST",$J,0)=0,IBX="" Q
"RTN","IBCEU4",124,0)
 . N IB1,IB2,IBSEL,IBGOT,IBCNT,Q,Q1
"RTN","IBCEU4",125,0)
 . S (IBGOT,IB1,IB2)=0
"RTN","IBCEU4",126,0)
 . F  S IB1=$O(^TMP("IBLIST",$J,2,IB1)) Q:'IB1  D  Q:IBGOT
"RTN","IBCEU4",127,0)
 .. S IB2=IB2+1
"RTN","IBCEU4",128,0)
 .. S Q=$J("",5)_$S('IBHLP:$E(IB2_$J("",5),1,5),1:"")_^TMP("IBLIST",$J,2,IB1)
"RTN","IBCEU4",129,0)
 .. F Q1=0:0 S Q1=$O(^TMP("IBLIST",$J,"ID",IB1,Q1)) Q:'Q1  D
"RTN","IBCEU4",130,0)
 ... I $G(^TMP("IBLIST",$J,"ID",IB1,Q1))'="" S Q=Q_"  "_^TMP("IBLIST",$J,"ID",IB1,Q1) Q
"RTN","IBCEU4",131,0)
 ... I $G(^TMP("IBLIST",$J,"ID",IB1,Q1,"E"))'="" S Q=Q_"  "_^TMP("IBLIST",$J,"ID",IB1,Q1,"E")
"RTN","IBCEU4",132,0)
 .. S IBSEL($S(IB2#IBEACH:IB2#IBEACH,1:IBEACH))=Q
"RTN","IBCEU4",133,0)
 .. I '$O(^TMP("IBLIST",$J,2,IB1))!'(IB1#IBEACH) D
"RTN","IBCEU4",134,0)
 ... M DIR("A")=IBSEL K IBSEL
"RTN","IBCEU4",135,0)
 ... I 'IBHLP D
"RTN","IBCEU4",136,0)
 .... S:$O(^TMP("IBLIST",$J,2,IB1)) DIR("A",6)="Press <RETURN> to see more, '^' to exit this list, OR"
"RTN","IBCEU4",137,0)
 .... S DIR("A")="SELECT 1-"_IB2_": "
"RTN","IBCEU4",138,0)
 .... S DIR(0)="NAO^1:"_IB2_":0"
"RTN","IBCEU4",139,0)
 .... S DIR("?")="Enter your selection for procedure from 1 to "_IB2
"RTN","IBCEU4",140,0)
 ... I IBHLP D
"RTN","IBCEU4",141,0)
 .... I $S(IB2'=+$G(^TMP("IBLIST",$J,0)):1,1:$P($G(^(0)),U,3)) S DIR("A")="'^' TO STOP: ",DIR(0)="EA" Q
"RTN","IBCEU4",142,0)
 .... S Z=0 F  S Z=$O(DIR("A",Z)) Q:'Z  W !,DIR("A",Z)
"RTN","IBCEU4",143,0)
 .... S Y="^" K DIR W ! Q
"RTN","IBCEU4",144,0)
 ... I $D(DIR("A")) D ^DIR K DIR
"RTN","IBCEU4",145,0)
 ... I IBHLP S Y=$S(Y=1:"",1:"^")
"RTN","IBCEU4",146,0)
 ... I Y="" D  Q
"RTN","IBCEU4",147,0)
 .... I $O(^TMP("IBLIST",$J,2,IB1)) Q
"RTN","IBCEU4",148,0)
 .... S IBX=""
"RTN","IBCEU4",149,0)
 .... W:'IBHLP !
"RTN","IBCEU4",150,0)
 .... I $P($G(^TMP("IBLIST",$J,0)),U,3),IB1'<IBMAX D
"RTN","IBCEU4",151,0)
 ..... I 'IBHLP W !!,"There were more than ",IBMAX," matches found.  Please try again with more specific input",! Q
"RTN","IBCEU4",152,0)
 ..... D RXPRHLP(IBMAX,.IBNEXT)
"RTN","IBCEU4",153,0)
 ... I Y["^" S IBX="",IBGOT=1 Q
"RTN","IBCEU4",154,0)
 ... I Y>0 S IBGOT=1,IBX=$G(^TMP("IBLIST",$J,2,+Y)) D RECALL^DILFD(399.0304,+IBX_",",DUZ)
"RTN","IBCEU4",155,0)
 . I 'IBGOT S ^TMP("IBLIST",$J,0)=0
"RTN","IBCEU4",156,0)
 I 'IBMANY,$G(^TMP("IBLIST",$J,0)) D
"RTN","IBCEU4",157,0)
 . N Q,Q1
"RTN","IBCEU4",158,0)
 . S Q=^TMP("IBLIST",$J,2,1)
"RTN","IBCEU4",159,0)
 . F Q1=0:0 S Q1=$O(^TMP("IBLIST",$J,"ID",1,Q1)) Q:'Q1  D
"RTN","IBCEU4",160,0)
 .. I $G(^TMP("IBLIST",$J,"ID",1,Q1))'="" S Q=Q_"  "_^TMP("IBLIST",$J,"ID",1,Q1) Q
"RTN","IBCEU4",161,0)
 .. I $G(^TMP("IBLIST",$J,"ID",1,Q1,"E"))'="" S Q=Q_"  "_^TMP("IBLIST",$J,"ID",1,Q1,"E")
"RTN","IBCEU4",162,0)
 . D EN^DDIOL($J("",16)_Q) S IBX=$G(^TMP("IBLIST",$J,2,1)) D RECALL^DILFD(399.0304,+IBX_",",DUZ)
"RTN","IBCEU4",163,0)
 ;
"RTN","IBCEU4",164,0)
 D CLEAN^DILF
"RTN","IBCEU4",165,0)
 K ^TMP("IBLIST",$J)
"RTN","IBCEU4",166,0)
 Q IBX
"RTN","IBCEU4",167,0)
 ;
"RTN","IBCEU4",168,0)
RXPRHLP(IBMAX,IBNEXT) ; Get list for ?? help
"RTN","IBCEU4",169,0)
 ;
"RTN","IBCEU4",170,0)
 ; IBMAX = The maximum # of entries to extract at once
"RTN","IBCEU4",171,0)
 ; IBNEXT = Contains the value of the index to start at
"RTN","IBCEU4",172,0)
 ;
"RTN","IBCEU4",173,0)
 N IBQ,IBZ
"RTN","IBCEU4",174,0)
 S IBQ=+$O(^TMP("IBLIST",$J,2,""),-1),IBZ=","_DA(1)_","
"RTN","IBCEU4",175,0)
 D LIST^DIC(399.0304,IBZ,"@;.01EI;1E",,IBMAX,.IBNEXT,,"B","I '$$LINKED^IBCEU4(.DA,Y)"),XFER(IBQ)
"RTN","IBCEU4",176,0)
 Q
"RTN","IBCEU4",177,0)
 ;
"RTN","IBCEU4",178,0)
LINKED(DA,Y) ; Function returns 1 if proc already linked to an RX rev code
"RTN","IBCEU4",179,0)
 ; DA = the DA array from the RC multiple
"RTN","IBCEU4",180,0)
 ; Y = the ien of the CP multiple
"RTN","IBCEU4",181,0)
 N Z
"RTN","IBCEU4",182,0)
 S Z=+$O(^DGCR(399,DA(1),"RC","ACP",Y,0))
"RTN","IBCEU4",183,0)
 Q $S(Z:Z'=DA,1:0)
"RTN","IBCEU4",184,0)
 ;
"RTN","IBCEU4",185,0)
XFER(IBQ) ; Transfer DILIST to IBLIST array
"RTN","IBCEU4",186,0)
 ; IBQ = the number of entries already found
"RTN","IBCEU4",187,0)
 N Z,IBZ
"RTN","IBCEU4",188,0)
 S (Z,IBZ)=0
"RTN","IBCEU4",189,0)
 F  S Z=$O(^TMP("DILIST",$J,2,Z)) Q:'Z  S IBZ=IBZ+1,^TMP("IBLIST",$J,2,IBZ+IBQ)=^TMP("DILIST",$J,2,Z) M ^TMP("IBLIST",$J,"ID",IBZ+IBQ)=^TMP("DILIST",$J,"ID",Z)
"RTN","IBCEU4",190,0)
 ;
"RTN","IBCEU4",191,0)
 I $D(^TMP("DILIST",$J,0)) S ^TMP("IBLIST",$J,0)=^TMP("DILIST",$J,0)
"RTN","IBCEU4",192,0)
 S $P(^TMP("IBLIST",$J,0),U)=IBQ+IBZ
"RTN","IBCEU4",193,0)
 Q
"RTN","IBCEU4",194,0)
 ;
"RTN","IBCEU4",195,0)
NOREV(DA,IBRX) ; Returns 1 if no other revenue code on bill DA(1)
"RTN","IBCEU4",196,0)
 ; is linked to prescription entry IBRX
"RTN","IBCEU4",197,0)
 N X,Z
"RTN","IBCEU4",198,0)
 S X=1,Z=0 F  S Z=$O(^DGCR(399,DA(1),"RC",Z)) Q:'Z  I DA'=Z,$P($G(^(Z,0)),U,11)=IBRX S X=0 Q
"RTN","IBCEU4",199,0)
 Q X
"RTN","IBCEU4",200,0)
 ;
"RTN","IBCEU4",201,0)
ASKRX(DA) ; Returns the selected RX entry in file 362.4
"RTN","IBCEU4",202,0)
 N DIR,X,Y
"RTN","IBCEU4",203,0)
 S DIR(0)="PAO^IBA(362.4,"
"RTN","IBCEU4",204,0)
 S DIR("A")="  RX: ",DIR("B")=$P($G(^IBA(362.4,+$P($G(^DGCR(399,DA(1),"RC",DA,0)),U,11),0)),U)
"RTN","IBCEU4",205,0)
 S DIR("S")="I $P(^(0),U,2)=DA(1),$$NOREV^IBCEU4(.DA,Y)"
"RTN","IBCEU4",206,0)
 D ^DIR K DIR
"RTN","IBCEU4",207,0)
 Q $S(Y>0:+Y,1:"")
"RTN","IBCEU4",208,0)
 ;
"RTN","IBCEU4",209,0)
SLF(IBIFN) ;  Returns 1 if Attending/Rendering provider id is SLF000
"RTN","IBCEU4",210,0)
 N IB,IBZ
"RTN","IBCEU4",211,0)
 S IB=0
"RTN","IBCEU4",212,0)
 D F^IBCEF("N-ATT/REND PROVIDER ID","IBZ",,IBIFN)
"RTN","IBCEU4",213,0)
 S:$G(IBZ)="SLF000" IB=1
"RTN","IBCEU4",214,0)
 Q IB
"RTN","IBCEU4",215,0)
 ;
"RTN","IBCEU4",216,0)
GETPOA(IBDX,PRTFLG) ; returns POA indicator for a given DX
"RTN","IBCEU4",217,0)
 ; IBDX - ien in file 362.3
"RTN","IBCEU4",218,0)
 ; PRTFLG - 1 if POA is fetched for printed form, 0 otherwise
"RTN","IBCEU4",219,0)
 N POA
"RTN","IBCEU4",220,0)
 S POA=""
"RTN","IBCEU4",221,0)
 S:+IBDX>0 POA=$P($G(^IBA(362.3,IBDX,0)),U,4)
"RTN","IBCEU4",222,0)
 ; on UB-04 print "" instead of "1" for blank.
"RTN","IBCEU4",223,0)
 I PRTFLG,POA="1" S POA=""
"RTN","IBCEU4",224,0)
 Q POA
"RTN","IBCSC4")
0^8^B23702708^B22332423
"RTN","IBCSC4",1,0)
IBCSC4 ;ALB/MJB - MCCR SCREEN 4 (INPT. EOC) ;27 MAY 88 10:17
"RTN","IBCSC4",2,0)
 ;;2.0;INTEGRATED BILLING;**52,51,210,245,155,287,349,403**;21-MAR-94;Build 24
"RTN","IBCSC4",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCSC4",4,0)
 ;
"RTN","IBCSC4",5,0)
 ;MAP TO DGCRSC4
"RTN","IBCSC4",6,0)
 ;
"RTN","IBCSC4",7,0)
EN I $P(^DGCR(399,IBIFN,0),"^",5)>2 G EN^IBCSC5
"RTN","IBCSC4",8,0)
 I $D(IBASKCOD) K IBASKCOD D CODMUL^IBCU7 I $$BILLCPT^IBCRU4(IBIFN) D ASK^IBCU7A(IBIFN) S DGRVRCAL=1
"RTN","IBCSC4",9,0)
 I $D(DGRVRCAL) D ^IBCU6 K DGRVRCAL
"RTN","IBCSC4",10,0)
 D ^IBCSCU S IBSR=4,IBSR1="",IBV1="0000000"_$S($$FT^IBCEF(IBIFN)'=2:0,1:1),IBUC="UNSPECIFIED CODE"
"RTN","IBCSC4",11,0)
 S:IBV IBV1="11111111"
"RTN","IBCSC4",12,0)
 D H^IBCSCU F I=1:1:4 S Y="Q"_I_"^IBCVA" D @Y
"RTN","IBCSC4",13,0)
 D INP
"RTN","IBCSC4",14,0)
 S IBBT=$P(IB(0),"^",4)_$P(IB(0),"^",5)_$P(IB(0),"^",6)
"RTN","IBCSC4",15,0)
 D:DGPT(0)]"" DX^IBCSC4A D OCC^IBCVA1
"RTN","IBCSC4",16,0)
 I '$P(DGPT(0),U,6) W !?26,$S('DGPT(0):"No PTF record for this ADMISSION",1:"PTF record status: OPEN")
"RTN","IBCSC4",17,0)
 S J=$P(IB("U"),U,20),J=$S(J=99:"",J="":"",J=0:"",$L(J)=1:".0"_J,1:"."_J)
"RTN","IBCSC4",18,0)
 S Z=1 X IBWW W " Admission  : " S I=$S($P(DGPT(0),U,2)]"":$P(DGPT(0),U,2),1:$P(IBIP,U,2)_J) S:$P(I,".",2)=""&I $P(I,".",2)="2400"
"RTN","IBCSC4",19,0)
 S Y=$$FMTE^XLFDT(I,"1P")
"RTN","IBCSC4",20,0)
 W Y,?49,"Accident Hour: ",$S($P(IB("U"),U,10)=99:IBU,$P(IB("U"),U,10)'="":$P(IB("U"),U,10),1:IBU)
"RTN","IBCSC4",21,0)
 W !?4,"Source     : " S I=$P(^DD(399,159,0),U,3),I=$P($P(I,";",($P(IB("U"),U,9))),":",2) W I
"RTN","IBCSC4",22,0)
 W ?58,"Type: ",$S($P(IB("U"),U,8)=3:"ELECTIVE",$P(IB("U"),U,8)=1:"EMERGENCY",$P(IB("U"),U,8)=2:"URGENT",1:IBU)
"RTN","IBCSC4",23,0)
 D OT
"RTN","IBCSC4",24,0)
 S Z=2 X IBWW
"RTN","IBCSC4",25,0)
 W " Discharge  : " S Y=$S($P(IBIP,U,6)>0:$P(IBIP,U,6),1:"") X ^DD("DD") W $S(Y]"":Y,1:IBU)
"RTN","IBCSC4",26,0)
 W !?4,"Status     : ",$S($P(IB("U"),U,12)]""&($D(^DGCR(399.1,(+$P(IB("U"),"^",12)),0))):$P(^(0),"^",1),1:IBU)
"RTN","IBCSC4",27,0)
 N IBPOARR,IBDATE,NEEDPOA,POA
"RTN","IBCSC4",28,0)
 D SET^IBCSC4D(IBIFN,"",.IBPOARR)
"RTN","IBCSC4",29,0)
 S IBDATE=$$BDATE^IBACSV(+$G(IBIFN)) ; The EVENT DATE of the bill
"RTN","IBCSC4",30,0)
 S NEEDPOA=$$INPAT^IBCEF(IBIFN)&($$FT^IBCEF(IBIFN)=3)
"RTN","IBCSC4",31,0)
 S Z=3,IBW=1 X IBWW W " Prin. Diag.: " S Y=$$DX(0,IBDATE),POA="" S:NEEDPOA&(Y'="") POA=$P(IBPOARR(+Y),U,3)
"RTN","IBCSC4",32,0)
 W $S(Y'="":$P(Y,U,4)_" - "_$P(Y,U,2)_$S(POA=""!(POA=1):"",1:" ("_POA_")"),$$DXREQ(IBIFN):IBU,1:IBUN)
"RTN","IBCSC4",33,0)
 F I=1:1:4 S Y=$$DX(+Y,IBDATE) Q:Y=""  D
"RTN","IBCSC4",34,0)
 .S POA="" S:NEEDPOA POA=$P(IBPOARR(+Y),U,3)
"RTN","IBCSC4",35,0)
 .W !?4,"Other Diag.: ",$P(Y,U,4)_" - "_$P(Y,U,2)_$S(POA=""!(POA=1):"",1:" ("_POA_")")
"RTN","IBCSC4",36,0)
 .Q
"RTN","IBCSC4",37,0)
 I +Y S Y=$$DX(+Y,IBDATE) I +Y W !?4,"***There are more diagnoses associated with this bill.***"
"RTN","IBCSC4",38,0)
 S Z=4,IBW=1,DGPCM=$P(IB(0),U,9) X IBWW W " Cod. Method: ",$S(DGPCM="":IBUN,DGPCM=9:"ICD-9-CM",DGPCM=4:"CPT-4",1:"HCPCS")
"RTN","IBCSC4",39,0)
 D:$D(IBPROC) WRT^IBCSC5
"RTN","IBCSC4",40,0)
OCC ;
"RTN","IBCSC4",41,0)
 S Z=$S($P(IB(0),U,5)<3:5,1:6)
"RTN","IBCSC4",42,0)
 S IBW=1 X IBWW W " Pros. Items: " S Y=$$PD^IBCSC5 I 'Y W IBUN
"RTN","IBCSC4",43,0)
 S Z=$S($P(IB(0),U,5)<3:6,1:7) X IBWW
"RTN","IBCSC4",44,0)
 W " Occ. Code  : " F I=1:1:5 I $D(IBO(I)) W:I>1 !?4,"Occ. Code  : ",$E(IBOCN(I),1,27) W:I=1 $E(IBOCN(I),1,27) S Y=IBOCD(I) X ^DD("DD") W ?55,Y S Y=IBOCD2(I) I +Y X ^DD("DD") W " - ",Y
"RTN","IBCSC4",45,0)
 I '$D(IBO) W IBUN
"RTN","IBCSC4",46,0)
 I $D(IBO)=1,IBO="" W IBUN
"RTN","IBCSC4",47,0)
 S Z=$S($P(IB(0),U,5)<3:7,1:8) X IBWW
"RTN","IBCSC4",48,0)
 W " Cond. Code : " F I=1:1:5 I $D(IBCC(I)) W:I>1 !?4,"Cond. Code : ",IBCCN(I) W:I=1 IBCCN(I)
"RTN","IBCSC4",49,0)
 I '$D(IBCC) W IBUN
"RTN","IBCSC4",50,0)
 I $D(IBCC)=1,IBCC="" W IBUN
"RTN","IBCSC4",51,0)
 S Z=$S($P(IB(0),U,5)<3:8,1:9)
"RTN","IBCSC4",52,0)
 X IBWW W " Value Code : " S IBVC=0
"RTN","IBCSC4",53,0)
 I $$FT^IBCEF(IBIFN)'=2 D
"RTN","IBCSC4",54,0)
 . D VC^IBCVA1 I +IBVC S J=1,I=0 F  S I=$O(IBVC(I)) Q:'I  W:J>1 !,?3," Value Code : " W ?17,$E($P(IBVC(I),U,2),1,40),?58,$P(IBVC(I),U,3) S J=J+1
"RTN","IBCSC4",55,0)
 W:'IBVC IBUN K IBVC
"RTN","IBCSC4",56,0)
 D Q^IBCSC4B G ^IBCSCP
"RTN","IBCSC4",57,0)
 Q
"RTN","IBCSC4",58,0)
OCC1 W $P(^DGCR(399,IBIFN,"CP",I,0),"^",3)_" - "_$P($$PRCD^IBCEF1($P(^DGCR(399,IBIFN,"CP",I,0),U)),U),?55,"Date: ",Y
"RTN","IBCSC4",59,0)
 Q
"RTN","IBCSC4",60,0)
 ;IBIP= PTF ptr (399,.08) ^ PTF admiss dt (45,2) or Event dt (399,.03)^ accident hour (399,160) 
"RTN","IBCSC4",61,0)
 ; ^ source of addmis (399,159) ^ typ of addmiss (399,158)
"RTN","IBCSC4",62,0)
 ; ^ PTF disch dt (45,70) or Non-VA disch dt (399,.16) ^ disch status (399,162)
"RTN","IBCSC4",63,0)
 ; ^ dxls (45,79) ^ disch bedsection (399,161)
"RTN","IBCSC4",64,0)
INP F I="C","U",0 S IB(I)=$S($D(^DGCR(399,IBIFN,I)):^(I),1:"")
"RTN","IBCSC4",65,0)
 S IBPTF=$P(IB(0),U,8) F I=0,70 S DGPT(I)=$S(IBPTF="":"",$D(^DGPT(IBPTF,I)):^(I),1:"")
"RTN","IBCSC4",66,0)
 F I="C","U",0 S IB(I)=$S($D(^DGCR(399,IBIFN,I)):^(I),1:"")
"RTN","IBCSC4",67,0)
 S IBIP=IBPTF_"^"_$S($P(DGPT(0),"^",2)]"":$P(DGPT(0),"^",2),1:$P(IB(0),"^",3))_"^"_$P(IB("U"),"^",10)_"^"_$P(IB("U"),"^",9)_"^"_$P(IB("U"),"^",8)_"^"_$S(+DGPT(70)>0:+DGPT(70),1:$P(IB(0),"^",16))_"^"
"RTN","IBCSC4",68,0)
 S IBIP=IBIP_$P(IB("U"),"^",12)_"^"_$S($D(DGPT(70)):$P(DGPT(70),"^",10),1:"")_"^"_$P(IB("U"),"^",11)
"RTN","IBCSC4",69,0)
 Q
"RTN","IBCSC4",70,0)
SET ;S ^DD(399.0304,0,"ID","WRITE")="N X S X=^(0) W ""   "",$E($P($G(@(U_$P($P(X,U),"";"",2)_+X_"",0)"")),U,$S($P(X,U,1)[""CPT"":2,1:4)),1,30)"
"RTN","IBCSC4",71,0)
 Q
"RTN","IBCSC4",72,0)
 ;
"RTN","IBCSC4",73,0)
DX(ORDER,IBDATE) ; Get next diagnosis data
"RTN","IBCSC4",74,0)
 N IBX
"RTN","IBCSC4",75,0)
 S IBX=""
"RTN","IBCSC4",76,0)
 S ORDER=$O(IBPOARR(ORDER))
"RTN","IBCSC4",77,0)
 I ORDER S IBX=ORDER_U_$$ICD9^IBACSV(+IBPOARR(ORDER),$G(IBDATE))
"RTN","IBCSC4",78,0)
 Q IBX
"RTN","IBCSC4",79,0)
 ;
"RTN","IBCSC4",80,0)
OT ; print Other Care (SNF) multiple
"RTN","IBCSC4",81,0)
 N IBX,IBY,IBN I '$O(^DGCR(399,IBIFN,"OT",0)) W !,?4,"SNF Care   : UNSPECIFIED [NOT REQUIRED]"
"RTN","IBCSC4",82,0)
 S IBX=0 F  S IBX=$O(^DGCR(399,IBIFN,"OT",IBX)) Q:'IBX  D
"RTN","IBCSC4",83,0)
 . S IBY=$G(^DGCR(399,IBIFN,"OT",IBX,0)) Q:'IBY
"RTN","IBCSC4",84,0)
 . S IBN=$P($G(^DGCR(399.1,+IBY,0)),U,1),IBN=$S(IBN["SKILLED":"SNF Care ",IBN["SUB-ACUTE":"Sub-Acute",1:"Unknown  ")
"RTN","IBCSC4",85,0)
 . W !,?4,IBN,"  : ",$$FMTE^XLFDT(+$P(IBY,U,2))," - ",$$FMTE^XLFDT(+$P(IBY,U,3))
"RTN","IBCSC4",86,0)
 Q
"RTN","IBCSC4",87,0)
 ;
"RTN","IBCSC4",88,0)
DXREQ(IBIFN) ; Is the principle diagnosis code required or not?
"RTN","IBCSC4",89,0)
 ; Function returns true (1) if DX is required for this bill, otherwise 0
"RTN","IBCSC4",90,0)
 NEW REQ,IBFT
"RTN","IBCSC4",91,0)
 S REQ=0,IBFT=$$FT^IBCEF(IBIFN)
"RTN","IBCSC4",92,0)
 I IBFT=2 S REQ=1 G DXREQX                            ; required for CMS-1500
"RTN","IBCSC4",93,0)
 I IBFT=3,$$WNRBILL^IBEFUNC(IBIFN) S REQ=1 G DXREQX   ; UB with Medicare (WNR) current payer
"RTN","IBCSC4",94,0)
DXREQX ;
"RTN","IBCSC4",95,0)
 Q REQ
"RTN","IBCSC4",96,0)
 ;
"RTN","IBCSC4",97,0)
 ;IBCSC4
"RTN","IBCSC4D")
0^9^B54553691^B50440659
"RTN","IBCSC4D",1,0)
IBCSC4D ;ALB/ARH - ADD/ENTER DIAGNOSIS ;11/9/93
"RTN","IBCSC4D",2,0)
 ;;2.0;INTEGRATED BILLING;**55,62,91,106,124,51,210,403**;21-MAR-94;Build 24
"RTN","IBCSC4D",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCSC4D",4,0)
 ;
"RTN","IBCSC4D",5,0)
EN ;add/edit diagnosis for a bill, IBIFN required
"RTN","IBCSC4D",6,0)
 N IBINP,POAEDIT
"RTN","IBCSC4D",7,0)
 S POAEDIT=0 ; flag for editing POA indicators, set in DXINPT^IBCSC4E
"RTN","IBCSC4D",8,0)
 S IBX=$G(^DGCR(399,+IBIFN,0))
"RTN","IBCSC4D",9,0)
 S IBINP=$$INPAT^IBCEF(+IBIFN)
"RTN","IBCSC4D",10,0)
 D DELALL^IBCSC4E(+IBIFN)
"RTN","IBCSC4D",11,0)
 I IBINP D DXINPT^IBCSC4E(IBIFN)
"RTN","IBCSC4D",12,0)
 I 'IBINP D DXOPT(IBIFN)
"RTN","IBCSC4D",13,0)
 S IBDIFN=0 D SET(IBIFN,.IBDXA,.IBPOA) D:+IBDXA DISP(.IBPOA)
"RTN","IBCSC4D",14,0)
 I IBINP,$D(^IBA(362.3,"AO",IBIFN)),$$FT^IBCEF(IBIFN)=3,POAEDIT D POAASK^IBCSC4E
"RTN","IBCSC4D",15,0)
E1 S IBDX=$$ASKDX I +IBDX>0 S IBDIFN=+$G(IBDXA(+IBDX)) S:'IBDIFN IBDIFN=$$ADD(+IBDX,IBIFN) I +IBDIFN>0 D EDIT(+IBDIFN) D SET(IBIFN,.IBDXA,.IBPOA) G E1
"RTN","IBCSC4D",16,0)
 S IBX=$G(^DGCR(399,+IBIFN,0)) I $P(IBX,U,5)<3,$P(IBX,U,27)'=2 S DGRVRCAL=1
"RTN","IBCSC4D",17,0)
EXIT K IBDIFN,IBDXA,IBPOA,IBDX,IBX
"RTN","IBCSC4D",18,0)
 Q
"RTN","IBCSC4D",19,0)
 ;
"RTN","IBCSC4D",20,0)
ASKDX() ;
"RTN","IBCSC4D",21,0)
 N X,Y,IBDATE,IBDTTX
"RTN","IBCSC4D",22,0)
 ;S DIR("A")="Select ICD DIAGNOSIS",DIR(0)="362.3,.01O" D ^DIR K DIR
"RTN","IBCSC4D",23,0)
 S IBDATE=$$BDATE^IBACSV(IBIFN)
"RTN","IBCSC4D",24,0)
 S IBDTTX=$$DAT1^IBOUTL(IBDATE)
"RTN","IBCSC4D",25,0)
 I $G(IBIFN),$$INPAT^IBCEF(IBIFN,1) D
"RTN","IBCSC4D",26,0)
 . N Z S Z=$$EXPAND^IBTRE(399,215,+$G(^DGCR(399,IBIFN,"U2")))
"RTN","IBCSC4D",27,0)
 . W !,$S(Z'="":"",1:"NO ")_"Admitting Diagnosis"_$S(Z'="":": "_Z,1:" found"),!
"RTN","IBCSC4D",28,0)
AD S DIR("??")="^D HELP^IBCSC4D"
"RTN","IBCSC4D",29,0)
 S DIR("?",1)="Enter a diagnosis for this bill.  Duplicates are not allowed. Only codes active on "_IBDTTX_"."
"RTN","IBCSC4D",30,0)
 S DIR("?")="Only diagnosis codes active on "_IBDTTX_", no duplicates for a bill, and bill must not be authorized or cancelled."
"RTN","IBCSC4D",31,0)
 S DIR(0)="PO^80:EAMQ"
"RTN","IBCSC4D",32,0)
 D ^DIR K DIR
"RTN","IBCSC4D",33,0)
 I Y>0,'$D(IBDXA(+Y)),'$$ICD9ACT^IBACSV(+Y,IBDATE) D  G AD
"RTN","IBCSC4D",34,0)
 . W !!,*7,"The Diagnosis code is inactive for the date of service ("_IBDTTX_").",!
"RTN","IBCSC4D",35,0)
 Q Y
"RTN","IBCSC4D",36,0)
 ;
"RTN","IBCSC4D",37,0)
ADD(DX,IFN) ;
"RTN","IBCSC4D",38,0)
 S DIC="^IBA(362.3,",DIC(0)="AQL",DIC("DR")=".02////"_IFN,X=DX K DA,DO D FILE^DICN K DA,DO,DIC,X
"RTN","IBCSC4D",39,0)
 Q Y
"RTN","IBCSC4D",40,0)
 ;
"RTN","IBCSC4D",41,0)
EDIT(IBDXIFN) ;
"RTN","IBCSC4D",42,0)
 N NEEDPOA
"RTN","IBCSC4D",43,0)
 S DIDEL=362.3,DIE="^IBA(362.3,",DA=IBDXIFN
"RTN","IBCSC4D",44,0)
 ; only ask for POA if inpatient UB-04 claim
"RTN","IBCSC4D",45,0)
 S NEEDPOA=IBINP&($$FT^IBCEF(IBIFN)=3)
"RTN","IBCSC4D",46,0)
 S DR=".01Diagnosis"_$S(NEEDPOA:";.04POA Indicator",1:"")_";.03Order"
"RTN","IBCSC4D",47,0)
 D ^DIE K DIE,DR,DA,DIC,DIDEL
"RTN","IBCSC4D",48,0)
 ;
"RTN","IBCSC4D",49,0)
 I $D(^IBA(362.3,IBDXIFN,0)),$$FIRSTDX(IBDXIFN) D  G EDITQ
"RTN","IBCSC4D",50,0)
 . N DIE,DR,DA,Y,X,IB0
"RTN","IBCSC4D",51,0)
 . S IB0=^IBA(362.3,IBDXIFN,0)
"RTN","IBCSC4D",52,0)
 . S DIE="^DGCR(399,",DA=+$P(IB0,U,2),DR="215////"_+IB0 D ^DIE
"RTN","IBCSC4D",53,0)
 ;
"RTN","IBCSC4D",54,0)
 ; - if the entry was deleted, remove dangling pointers from #399.0304
"RTN","IBCSC4D",55,0)
 N IBPROC,IBPROCD,IBPIECE,IBHIT
"RTN","IBCSC4D",56,0)
 S (IBHIT,IBPROC)=0
"RTN","IBCSC4D",57,0)
 F  S IBPROC=$O(^DGCR(399,IBIFN,"CP",IBPROC)) Q:'IBPROC  S IBPROCD=$G(^(IBPROC,0)) I IBPROCD]"" D
"RTN","IBCSC4D",58,0)
 .F IBPIECE=11:1:14 I +$P(IBPROCD,"^",IBPIECE)=IBDXIFN S IBHIT=1 D UPD^IBCU72("@",IBPIECE-1)
"RTN","IBCSC4D",59,0)
 I IBHIT W *7,!,"This diagnosis was removed as a procedure diagnosis."
"RTN","IBCSC4D",60,0)
EDITQ Q
"RTN","IBCSC4D",61,0)
 ;
"RTN","IBCSC4D",62,0)
SET(IFN,DXARR,POARR) ;setup arrays of all dx's for bill, array names should be passed by reference
"RTN","IBCSC4D",63,0)
 ;returns: DXARR(DX)=DX IFN, POARR(ORDER)=DX ^ PRINT ORDER ^ POA,  (DXARR,POARR)=IFN ^ dx count
"RTN","IBCSC4D",64,0)
 ;if a dx does not have a print order then PRINT ORDER=(999+count of dx) so will be in order of entry if no print order
"RTN","IBCSC4D",65,0)
 N CNT,IBX,IBY,IBZ,DIFN,IBC,ARR K DXARR,POARR S IBC="AIFN"_$G(IFN)
"RTN","IBCSC4D",66,0)
 S (CNT,IBX)=0 F  S IBX=$O(^IBA(362.3,IBC,IBX)) Q:'IBX  D
"RTN","IBCSC4D",67,0)
 . S DIFN=$O(^IBA(362.3,IBC,IBX,0)),IBY=$G(^IBA(362.3,DIFN,0)) Q:'IBY
"RTN","IBCSC4D",68,0)
 . S CNT=CNT+1,IBZ=+$P(IBY,U,3) I 'IBZ S IBZ=999+CNT
"RTN","IBCSC4D",69,0)
 . S DXARR(+IBY)=DIFN,ARR(IBZ)=+IBY_U_$P(IBY,U,3,4)
"RTN","IBCSC4D",70,0)
 S (IBX,IBY)=0 F  S IBY=$O(ARR(IBY)) Q:'IBY  S IBX=IBX+1,POARR(IBX)=ARR(IBY)
"RTN","IBCSC4D",71,0)
 S (DXARR,POARR)=$G(IFN)_"^"_CNT
"RTN","IBCSC4D",72,0)
 Q
"RTN","IBCSC4D",73,0)
 ;
"RTN","IBCSC4D",74,0)
DISP(POARR) ;screen display of existing dx's for a bill,
"RTN","IBCSC4D",75,0)
 ;input should be print order array returned by SET^IBCSC4D: POARR(PRINT ORDER)=DX, passed by reference
"RTN","IBCSC4D",76,0)
 N IBX,IBY,IBZ,IBDATE,POA
"RTN","IBCSC4D",77,0)
 S IBDATE=$$BDATE^IBACSV(+$G(IBIFN)) ; The bill date of service
"RTN","IBCSC4D",78,0)
 W !!,?5,"-----------------  Existing Diagnoses for Bill  -----------------",!
"RTN","IBCSC4D",79,0)
 S IBX=0 F  S IBX=$O(POARR(IBX)) Q:'IBX  S IBZ=POARR(IBX),IBY=$$ICD9^IBACSV(+IBZ,IBDATE) D
"RTN","IBCSC4D",80,0)
 .S POA="" I $$INPAT^IBCEF(IBIFN),$$FT^IBCEF(IBIFN)=3 S POA=$P(IBZ,U,3) S:POA=1 POA="" S:POA'="" POA="("_POA_")"
"RTN","IBCSC4D",81,0)
 . W !,?12,$P(IBY,U),?20,POA,?26,$P(IBY,U,3),?60,$S($P(IBZ,U,2)<1000:"("_$P(IBZ,U,2)_")",1:"")
"RTN","IBCSC4D",82,0)
 W !
"RTN","IBCSC4D",83,0)
 Q
"RTN","IBCSC4D",84,0)
 ;
"RTN","IBCSC4D",85,0)
DISP1(IFN) ;
"RTN","IBCSC4D",86,0)
 I +$G(IFN) N POARR D SET(IFN,"",.POARR),DISP(.POARR)
"RTN","IBCSC4D",87,0)
 Q
"RTN","IBCSC4D",88,0)
HELP ;called for help from dx enter to display existing dx's
"RTN","IBCSC4D",89,0)
 Q:'$G(IBIFN)  N IBX
"RTN","IBCSC4D",90,0)
 D SET(IBIFN,.IBDXA,"") S IBX=$G(^DGCR(399,+IBIFN,0)) I IBX="" Q
"RTN","IBCSC4D",91,0)
 I $P(IBX,U,5)>2 S DFN=$P(IBX,U,2),IBX=$G(^DGCR(399,+IBIFN,"U")) D OPTDX(DFN,$P(IBX,U,1),$P(IBX,U,2),.IBOEDX,.IBDXA),DISPOE(.IBOEDX,.IBDXA)
"RTN","IBCSC4D",92,0)
 D SET(IBIFN,.IBDXA,.IBPOA) D:+IBDXA DISP(.IBPOA)
"RTN","IBCSC4D",93,0)
 Q
"RTN","IBCSC4D",94,0)
 ;
"RTN","IBCSC4D",95,0)
ADD1(IFN) ;does not work, but it should replace ask add, and edit
"RTN","IBCSC4D",96,0)
 ;S DIC="^IBA(362.3,",DIC(0)="EMAQ",D="AIFN"_$G(IFN) D IX^DIC K DA,DO,DIC,D
"RTN","IBCSC4D",97,0)
 Q
"RTN","IBCSC4D",98,0)
 ;
"RTN","IBCSC4D",99,0)
 ; ******************************************************************************************
"RTN","IBCSC4D",100,0)
 ;
"RTN","IBCSC4D",101,0)
DXOPT(IBIFN) ; display and ask user to select PCE diagnosis
"RTN","IBCSC4D",102,0)
 N IBDXA,IBOEDX,IBLIST,DFN,IBX
"RTN","IBCSC4D",103,0)
 D SET(IBIFN,.IBDXA,"")
"RTN","IBCSC4D",104,0)
 S DFN=$P($G(^DGCR(399,+IBIFN,0)),U,2),IBX=$G(^DGCR(399,+IBIFN,"U"))
"RTN","IBCSC4D",105,0)
 D OPTDX(DFN,$P(IBX,U,1),$P(IBX,U,2),.IBOEDX,.IBDXA),DISPOE(.IBOEDX,.IBDXA)
"RTN","IBCSC4D",106,0)
 I +$P($G(IBOEDX),U,2) D NEWDX(+IBOEDX) I $D(IBLIST) D ADDNEW(IBIFN,IBLIST,.IBOEDX)
"RTN","IBCSC4D",107,0)
 Q
"RTN","IBCSC4D",108,0)
 ;
"RTN","IBCSC4D",109,0)
OPTDX(DFN,DT1,DT2,ARRAY,IBDXE) ; get diagnosis from PCE for encounters within date range
"RTN","IBCSC4D",110,0)
 ; ARRAY(X)= DX ^ ORDER ^ OUTPATIENT ENCOUNTER (409.68) ^ DATE/TIME ^ TRUE IF NON-BILL ^ NON-BILL MESS ^ CLINIC
"RTN","IBCSC4D",111,0)
 N IBDT,IBOE,IBDX,IBDXN,IBDXA,IBDXB,IBCNT,IBCNT1,ARR,IBI,IBJ,IBK,IBVAL,IBCBK
"RTN","IBCSC4D",112,0)
 K ARRAY
"RTN","IBCSC4D",113,0)
 S (IBCNT,IBCNT1)=0,DT1=$G(DT1)-.0001,DT2=$S(+$G(DT2):DT2,1:9999999)+.7999
"RTN","IBCSC4D",114,0)
 ;
"RTN","IBCSC4D",115,0)
 S IBVAL("DFN")=DFN,IBVAL("BDT")=DT1,IBVAL("EDT")=DT2
"RTN","IBCSC4D",116,0)
 S IBCBK="D OEDX^IBCU81(Y,.IBDXA,.IBDXB)"
"RTN","IBCSC4D",117,0)
 D SCAN^IBSDU("PATIENT/DATE",.IBVAL,"",IBCBK,1) K ^TMP("DIERR",$J)
"RTN","IBCSC4D",118,0)
 ;
"RTN","IBCSC4D",119,0)
 S (IBCNT,IBCNT1,IBI)=0 F  S IBI=$O(IBDXA(IBI)) Q:'IBI  D
"RTN","IBCSC4D",120,0)
 . S IBJ=0 F  S IBJ=$O(IBDXA(IBI,IBJ)) Q:'IBJ  D
"RTN","IBCSC4D",121,0)
 .. S IBK=0 F  S IBK=$O(IBDXA(IBI,IBJ,IBK)) Q:'IBK  D
"RTN","IBCSC4D",122,0)
 ... S IBDXN=0 F  S IBDXN=$O(IBDXA(IBI,IBJ,IBK,IBDXN)) Q:'IBDXN  D
"RTN","IBCSC4D",123,0)
 .... S IBDX=IBDXA(IBI,IBJ,IBK,IBDXN) I $D(ARR(+IBDX))!(+$P(IBDX,U,5)&(+$G(IBDXB(+IBDX)))) Q
"RTN","IBCSC4D",124,0)
 .... S IBCNT=IBCNT+1 I '$D(IBDXE(+IBDX)) S IBCNT1=IBCNT1+1
"RTN","IBCSC4D",125,0)
 .... S ARRAY(IBCNT)=IBDX S ARR(+IBDX)=""
"RTN","IBCSC4D",126,0)
 S ARRAY=IBCNT_"^"_IBCNT1 K IBDXA,IBDXB,ARR
"RTN","IBCSC4D",127,0)
 Q
"RTN","IBCSC4D",128,0)
 ;
"RTN","IBCSC4D",129,0)
NEWDX(IBX) ; user select PCE diagnosis to add to bill
"RTN","IBCSC4D",130,0)
 Q:'$G(IBX)  N X,Y,DIR,DIRUT K IBLIST W !
"RTN","IBCSC4D",131,0)
NEWDX1 S DIR("?",1)="Enter the number preceding the Diagnosis you want added to the bill.",DIR("?",2)="Multiple entries may be added separated by commas or ranges separated by a dash."
"RTN","IBCSC4D",132,0)
 S DIR("?")="The diagnosis will be added to the bill with a print order corresponding to its position in this list."
"RTN","IBCSC4D",133,0)
 S DIR("A")="SELECT NEW DIAGNOSES TO ADD THE BILL"
"RTN","IBCSC4D",134,0)
 S DIR(0)="LO^1:"_+IBX D ^DIR K DIR G:'Y!$D(DIRUT) NEWDXE
"RTN","IBCSC4D",135,0)
 S IBLIST=Y
"RTN","IBCSC4D",136,0)
 ;
"RTN","IBCSC4D",137,0)
 S DIR("A")="YOU HAVE SELECTED "_IBLIST_" TO BE ADDED TO THE BILL IS THIS CORRECT",DIR("B")="YES"
"RTN","IBCSC4D",138,0)
 S DIR(0)="YO" D ^DIR K DIR I $D(DIRUT) K IBLIST G NEWDXE
"RTN","IBCSC4D",139,0)
 I 'Y G NEWDX1
"RTN","IBCSC4D",140,0)
NEWDXE Q
"RTN","IBCSC4D",141,0)
 ;
"RTN","IBCSC4D",142,0)
ADDNEW(IBIFN,LIST,IBOEA) ; add selected PCE diagnosis to bill
"RTN","IBCSC4D",143,0)
 Q:'LIST  N IBI,IBX,IBDX,IBDT,IBQ,IBY,IBPIFN,IBZ
"RTN","IBCSC4D",144,0)
 F IBI=1:1 S IBX=$P(LIST,",",IBI) Q:'IBX  I $D(IBOEA(IBX)) D
"RTN","IBCSC4D",145,0)
 . S IBDX=+IBOEA(IBX) I $D(^IBA(362.3,"AIFN"_IBIFN,IBDX)) Q
"RTN","IBCSC4D",146,0)
 . I $$ADD(IBDX,IBIFN) W "."
"RTN","IBCSC4D",147,0)
 Q
"RTN","IBCSC4D",148,0)
 ;
"RTN","IBCSC4D",149,0)
DISPOE(OEARR,EXARR) ; display outpatient PCE diagnosis
"RTN","IBCSC4D",150,0)
 N IBCNT,IBDX,IBX,IBY,IBDATE
"RTN","IBCSC4D",151,0)
 W @IOF,!,"============================= DIAGNOSIS SCREEN ==============================",!
"RTN","IBCSC4D",152,0)
 S IBDATE=$$BDATE^IBACSV(+$G(IBIFN)) ; The bills date of service
"RTN","IBCSC4D",153,0)
 S IBCNT=0 F  S IBCNT=$O(OEARR(IBCNT)) Q:'IBCNT  D
"RTN","IBCSC4D",154,0)
 . S IBY=OEARR(IBCNT),IBDX=$$ICD9^IBACSV(+IBY,IBDATE)
"RTN","IBCSC4D",155,0)
 . S IBX="" I $D(EXARR(+OEARR(IBCNT))) S IBX="*"
"RTN","IBCSC4D",156,0)
 . W !,$J(IBCNT,2),")",?5,IBX,?6,$P(IBDX,U),?14,$E($P(IBDX,U,3),1,19)
"RTN","IBCSC4D",157,0)
 . I +$P(IBY,U,7) W ?35,$E($P($G(^SC(+$P(IBY,U,7),0)),U,1),1,15)
"RTN","IBCSC4D",158,0)
 . I $P(IBY,U,2)'="" W ?52,$E($$EXPAND^IBTRE(9000010.07,.12,$P(IBY,U,2)),1,3)
"RTN","IBCSC4D",159,0)
 . I $P(IBY,U,4)'="" W ?57,$$FMTE^XLFDT($E($P(IBY,U,4),1,12),2)
"RTN","IBCSC4D",160,0)
 . I $P(IBY,U,6)'="" W ?72,$E($P(IBY,U,6),1,7)
"RTN","IBCSC4D",161,0)
 Q
"RTN","IBCSC4D",162,0)
 ;
"RTN","IBCSC4D",163,0)
DISPID ; Display the Associated Dx and Rx # for a procedure in the identifier.
"RTN","IBCSC4D",164,0)
 ;  Input:  Naked reference to the 0th node of an entry in the
"RTN","IBCSC4D",165,0)
 ;          Procedures (#304) sub-file of the Bill/Claims (#399) file.
"RTN","IBCSC4D",166,0)
 N I,X,IBY,Z
"RTN","IBCSC4D",167,0)
 S X=^(0),IBY=Y
"RTN","IBCSC4D",168,0)
 S I=$$PRCNM^IBCSCH1($P(X,U,1),$P(X,U,2)) W " ",$E($P(I,U,2)_$J("",27),1,27)
"RTN","IBCSC4D",169,0)
 S Z=$O(^DGCR(399,DA(1),"RC","ACP",+IBY,0))
"RTN","IBCSC4D",170,0)
 I Z S Z=$P($G(^DGCR(399,DA(1),"RC",Z,0)),U,11) W $E("  Rx: "_$S(Z:$P($G(^IBA(362.4,+Z,0)),U),1:"Missing")_$J("",14),1,14)
"RTN","IBCSC4D",171,0)
 I +$P(X,U,11) S I=+$G(^IBA(362.3,+$P(X,U,11),0)) W "  Dx 1: ",$P($$ICD9^IBACSV(+I),U)
"RTN","IBCSC4D",172,0)
 Q
"RTN","IBCSC4D",173,0)
FIRSTDX(DA) ; Called by trigger cross reference #2 on file 362.3,.03
"RTN","IBCSC4D",174,0)
 ; DA is the ien of the entry in file 362.3
"RTN","IBCSC4D",175,0)
 ; Check if the corresponding bill is for an inpatient episode, the
"RTN","IBCSC4D",176,0)
 ; admitting dx for the corresponding bill is null and the dx being
"RTN","IBCSC4D",177,0)
 ; entered is the first for the bill.  If this is all true, admitting
"RTN","IBCSC4D",178,0)
 ; dx should be set to the dx.
"RTN","IBCSC4D",179,0)
 ;
"RTN","IBCSC4D",180,0)
 N OK,Z
"RTN","IBCSC4D",181,0)
 S Z=$G(^IBA(362.3,DA,0)),OK=0
"RTN","IBCSC4D",182,0)
 I $$INPAT^IBCEF(+$P(Z,U,2)),$P($G(^DGCR(399,+$P(Z,U,2),"U2")),U)="",'$O(^IBA(362.3,"AO",+$P(Z,U,2),+$P(Z,U,3)),-1) S OK=1
"RTN","IBCSC4D",183,0)
 Q OK
"RTN","IBCSC4D",184,0)
 ;
"RTN","IBCSC4E")
0^11^B44983116^B39280455
"RTN","IBCSC4E",1,0)
IBCSC4E ;ALB/ARH - ADD/ENTER PTF/OE DIAGNOSIS ;3/2/94
"RTN","IBCSC4E",2,0)
 ;;2.0;INTEGRATED BILLING;**8,106,121,124,210,266,403**;21-MAR-94;Build 24
"RTN","IBCSC4E",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCSC4E",4,0)
 ;
"RTN","IBCSC4E",5,0)
DXINPT(IBIFN) ; display and ask user to select PTF diagnosis
"RTN","IBCSC4E",6,0)
 N IBLIST,IBPTFDX
"RTN","IBCSC4E",7,0)
 D PTFDSP(IBIFN),PTFASK I $D(IBLIST) D PTFADD(IBIFN,IBLIST) S POAEDIT=1
"RTN","IBCSC4E",8,0)
 ; get POA indicators from QuadraMed for UB-04 inpatient claims
"RTN","IBCSC4E",9,0)
 I $$FT^IBCEF(IBIFN)=3 D SETPOA^IBCSC4F(IBIFN)
"RTN","IBCSC4E",10,0)
 K ^TMP($J,"IBDX")
"RTN","IBCSC4E",11,0)
 Q
"RTN","IBCSC4E",12,0)
 ;
"RTN","IBCSC4E",13,0)
PTFASK ;
"RTN","IBCSC4E",14,0)
 D PTF Q:$G(IBPTFDX)'>0  N X,Y,DIR,DIRUT K IBLIST W !
"RTN","IBCSC4E",15,0)
PTFASK1 S DIR("A")="SELECT DIAGNOSIS FROM THE PTF RECORD TO INCLUDE ON THE BILL"
"RTN","IBCSC4E",16,0)
 S DIR("?",1)="Enter the alphanumeric preceding the diagnosis you want added to the bill.",DIR("?",2)=""
"RTN","IBCSC4E",17,0)
 S DIR("?",3)="To enter more than one separate them by a comma or within a movement use a"
"RTN","IBCSC4E",18,0)
 S DIR("?",4)="range separated by a dash.  * indicates the diagnosis is already on the bill."
"RTN","IBCSC4E",19,0)
 S DIR("?")="The print order for each diagnosis will be determined by the order in this list."
"RTN","IBCSC4E",20,0)
 S DIR(0)="FO^^D ITPTF^IBCSC4E" D ^DIR K DIR Q:$D(DIRUT)!(Y="")
"RTN","IBCSC4E",21,0)
 ;
"RTN","IBCSC4E",22,0)
 S X=Y D ITPTF S IBLIST=X,DIR("A",1)="YOU HAVE SELECTED "_X_" TO BE ADDED TO THE BILL",DIR("A")="IS THIS CORRECT",DIR("B")="YES"
"RTN","IBCSC4E",23,0)
 S DIR(0)="YO" D ^DIR K DIR I $D(DIRUT) K IBLIST Q
"RTN","IBCSC4E",24,0)
 I 'Y K IBLIST G PTFASK1
"RTN","IBCSC4E",25,0)
 Q
"RTN","IBCSC4E",26,0)
 ;
"RTN","IBCSC4E",27,0)
PTF ;
"RTN","IBCSC4E",28,0)
 Q:'$D(^TMP($J,"IBDX","S"))  N IBX,IBY,IBZ,IBORD,IBNUM K IBPTFDX S IBORD="",IBPTFDX=0
"RTN","IBCSC4E",29,0)
 S IBX="" F  S IBX=$O(^TMP($J,"IBDX","S",IBX)) Q:IBX=""  D
"RTN","IBCSC4E",30,0)
 . S IBZ=+$G(^TMP($J,"IBDX","S",IBX)) Q:'IBZ
"RTN","IBCSC4E",31,0)
 . S IBORD=$E(IBX) Q:IBORD'?1A  S IBNUM=+$E(IBX,2,999) Q:IBNUM'>0
"RTN","IBCSC4E",32,0)
 . I IBNUM>$G(IBPTFDX(IBORD)) S IBPTFDX(IBORD)=IBNUM
"RTN","IBCSC4E",33,0)
 . I '$D(^IBA(362.3,"AIFN"_+$G(IBIFN),+IBZ)) S IBPTFDX=IBPTFDX+1
"RTN","IBCSC4E",34,0)
 Q
"RTN","IBCSC4E",35,0)
 ;
"RTN","IBCSC4E",36,0)
ITPTF ;
"RTN","IBCSC4E",37,0)
 N IBI,IB1,IB2,IB3,IBJ,IBX,IBY,IBZ,IBA
"RTN","IBCSC4E",38,0)
 S IBA="",IBX=X
"RTN","IBCSC4E",39,0)
 F IBI=1:1 S IBY=$P(IBX,",",IBI) Q:IBY=""  D  Q:'$D(X)  S X=IBA
"RTN","IBCSC4E",40,0)
 . I IBY["-" S IBZ=$P(IBY,"-",1),IB2=$P(IBY,"-",2) D  Q:'$D(X)
"RTN","IBCSC4E",41,0)
 .. I $E(IBZ,1)'=$E(IB2,1) K X Q
"RTN","IBCSC4E",42,0)
 .. S IBY="",IB1=$E(IBZ,2,999),IB2=$E(IB2,2,999),IBZ=$E(IBZ,1) I +IB2'>+IB1 K X Q
"RTN","IBCSC4E",43,0)
 .. F IBJ=IB1:1:IB2 S IBY=IBY_IBZ_IBJ_"-" I IBJ>$G(IBPTFDX(IBZ)) Q
"RTN","IBCSC4E",44,0)
 . F IBJ=1:1 S IB1=$P(IBY,"-",IBJ) Q:IB1=""  S IB2=$E(IB1,1),IB3=$E(IB1,2,99) D  Q:'$D(X)
"RTN","IBCSC4E",45,0)
 .. I IB1'?1U1.3N K X Q
"RTN","IBCSC4E",46,0)
 .. I IB2=""!'IB3 K X Q
"RTN","IBCSC4E",47,0)
 .. I '$D(IBPTFDX(IB2)) K X Q
"RTN","IBCSC4E",48,0)
 .. I IB3>+$G(IBPTFDX(IB2)) K X Q
"RTN","IBCSC4E",49,0)
 .. S IBA=IBA_IB2_IB3_","
"RTN","IBCSC4E",50,0)
 Q
"RTN","IBCSC4E",51,0)
 ;
"RTN","IBCSC4E",52,0)
PTFADD(IBIFN,LIST) ;
"RTN","IBCSC4E",53,0)
 Q:'$D(^TMP($J,"IBDX","S"))!($G(LIST)="")!('$G(IBIFN))  N IBX,IBY,IBI,IBCD,IBDX
"RTN","IBCSC4E",54,0)
 F IBI=1:1 S IBCD=$P(LIST,",",IBI) Q:IBCD=""  D
"RTN","IBCSC4E",55,0)
 . S IBDX=+$G(^TMP($J,"IBDX","S",IBCD)) Q:'IBDX
"RTN","IBCSC4E",56,0)
 . I ($$ICD9^IBACSV(+IBDX)'=""),'$D(^IBA(362.3,"AIFN"_IBIFN,+IBDX)) I $$ADD^IBCSC4D(+IBDX,IBIFN) W "."
"RTN","IBCSC4E",57,0)
 Q
"RTN","IBCSC4E",58,0)
 ;
"RTN","IBCSC4E",59,0)
PTFDSP(IBIFN) ; display PTF diagnosis within date range of the bill
"RTN","IBCSC4E",60,0)
 ; Output:  ^TMP($J,"IBDX") as defined by PTFDXDT^IBCSC4F   and
"RTN","IBCSC4E",61,0)
 ;          ^TMP($J,"IBDX","S",x) = DIAGNOSIS w/x=selection identifer for a dx
"RTN","IBCSC4E",62,0)
 N IB0,IBPTF,IBTF,IBU,IBFDT,IBTDT,IBDSCH,IBW,IBC,IBA,IBN,IBCNT,IBMCNT,IBMDT,IBMV,IBDT,IBLN,IBLABEL,IBDXCNT,IBI
"RTN","IBCSC4E",63,0)
 N IBDX,IBID,IBON,IBY,IBMDRG,X,IBDATE,IEN362,POA
"RTN","IBCSC4E",64,0)
 ;
"RTN","IBCSC4E",65,0)
 K ^TMP($J,"IBDX") S IBW=41
"RTN","IBCSC4E",66,0)
 ;
"RTN","IBCSC4E",67,0)
 S IBDATE=$$BDATE^IBACSV(IBIFN) ; The Event Date of the bill
"RTN","IBCSC4E",68,0)
 S IB0=$G(^DGCR(399,+$G(IBIFN),0)),IBPTF=$P(IB0,U,8),IBTF=$P(IB0,U,6) Q:'$G(IBPTF)
"RTN","IBCSC4E",69,0)
 S IBU=$G(^DGCR(399,+IBIFN,"U")),IBFDT=+IBU,IBTDT=$P(IBU,U,2) Q:$P(IB0,U,5)>2
"RTN","IBCSC4E",70,0)
 ;
"RTN","IBCSC4E",71,0)
 D PTFDXDT^IBCSC4F(IBPTF,IBFDT,IBTDT,IBTF) S IBDSCH=$P(+$P($G(^TMP($J,"IBDX","M")),U,3),".")
"RTN","IBCSC4E",72,0)
 ;
"RTN","IBCSC4E",73,0)
 F IBN="M","D" S (IBCNT,IBMCNT,IBMDT)="" F  S IBMDT=$O(^TMP($J,"IBDX",IBN,IBMDT)) Q:'IBMDT  S IBMCNT=IBMCNT+1 D
"RTN","IBCSC4E",74,0)
 . S IBMV=$G(^TMP($J,"IBDX",IBN,IBMDT)),IBDT=+IBMV,IBMDRG=$P(IBMV,U,4)
"RTN","IBCSC4E",75,0)
 . I IBN="M" S IBC=0,IBLABEL="Move",IBA=$C(64+IBMCNT) I 'IBDT S IBDT="D/C"
"RTN","IBCSC4E",76,0)
 . I IBN="D" S IBC=41,IBLABEL="Discharge",IBA="X" I 'IBDT S IBDT="NOT DISCHARGED"
"RTN","IBCSC4E",77,0)
 . ;
"RTN","IBCSC4E",78,0)
 . S IBLN=IBLABEL_": "_$S(+IBDT:$P($$FMTE^XLFDT(+IBDT,2),"@",1),1:IBDT)
"RTN","IBCSC4E",79,0)
 . S IBLN=IBLN_" "_$E($P($G(^DIC(42.4,+$P(IBMV,U,2),0)),U,1),1,12)
"RTN","IBCSC4E",80,0)
 . S IBLN=IBLN_" "_$J("",(29-$L(IBLN)))_$S(+$P(IBMV,U,3):"<SC>",1:"<NSC>")
"RTN","IBCSC4E",81,0)
 . ;
"RTN","IBCSC4E",82,0)
 . S IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW)
"RTN","IBCSC4E",83,0)
 . S IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBC)_IBLN
"RTN","IBCSC4E",84,0)
 . ;
"RTN","IBCSC4E",85,0)
 . I '$O(^TMP($J,"IBDX",IBN,IBMDT,"")) S IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBC)_"  No DX Codes Entered For "_IBLABEL
"RTN","IBCSC4E",86,0)
 . ;
"RTN","IBCSC4E",87,0)
 . S (IBDXCNT,IBI)="" F  S IBI=$O(^TMP($J,"IBDX",IBN,IBMDT,IBI)) Q:'IBI  D
"RTN","IBCSC4E",88,0)
 .. S IBDX=^TMP($J,"IBDX",IBN,IBMDT,IBI),IBY=$$ICD9^IBACSV(+IBDX,IBDATE)
"RTN","IBCSC4E",89,0)
 .. S IEN362=$O(^IBA(362.3,"AIFN"_IBIFN,+IBDX,""))
"RTN","IBCSC4E",90,0)
 .. S IBDXCNT=IBDXCNT+1,IBID=IBA_IBDXCNT,IBON=$S(IEN362:"*",1:" ")
"RTN","IBCSC4E",91,0)
 .. S POA="" S:$P(IB0,U,19)=3 POA=$$GETPOA^IBCEU4(IEN362,1) S:POA'="" POA=" ("_POA_") "
"RTN","IBCSC4E",92,0)
 .. S IBLN=" "_IBON_IBID_" - "_$P(IBY,U,1)_POA_$J("",(7-$L($P(IBY,U,1))))_$E($P(IBY,U,3),1,23)
"RTN","IBCSC4E",93,0)
 .. S IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBC)_IBLN
"RTN","IBCSC4E",94,0)
 .. S ^TMP($J,"IBDX","S",IBID)=IBDX
"RTN","IBCSC4E",95,0)
 . ;
"RTN","IBCSC4E",96,0)
 . I 'IBMDRG,IBN="M" S IBLN="   *** No DRG for Charges ***",IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBC)_IBLN
"RTN","IBCSC4E",97,0)
 . I IBMDRG S IBLN=$P($$DRG^IBACSV(+IBMDRG,IBDATE),U,1)_" - "_$E($$DRGTD^IBACSV(+IBMDRG,IBDATE),1,30),IBCNT=IBCNT+1,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBC)_IBLN
"RTN","IBCSC4E",98,0)
 ;
"RTN","IBCSC4E",99,0)
 I IBDSCH,IBTDT<IBDSCH S IBCNT=2,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBW)_"Discharge: "_$$FMTE^XLFDT(+$P(IBDSCH,"."),2)_" Not In Bill Range"
"RTN","IBCSC4E",100,0)
 I 'IBDSCH,IBTDT<DT S IBCNT=2,X(IBCNT)=$G(X(IBCNT))_$J("",IBW),X(IBCNT)=$E(X(IBCNT),1,IBW)_"Discharge:  NOT DISCHARGED"
"RTN","IBCSC4E",101,0)
 ;
"RTN","IBCSC4E",102,0)
 W @IOF,"=============================== Diagnosis Screen ==============================="
"RTN","IBCSC4E",103,0)
 S IBI="" F  S IBI=$O(X(IBI)) Q:'IBI  W !,$E(X(IBI),1,80)
"RTN","IBCSC4E",104,0)
 Q
"RTN","IBCSC4E",105,0)
 ;
"RTN","IBCSC4E",106,0)
DELALL(IBIFN) ; ask/delete all diagnosis on a bill, including all CPT associated Diagnosis
"RTN","IBCSC4E",107,0)
 Q:'$O(^IBA(362.3,"AIFN"_+$G(IBIFN),0))
"RTN","IBCSC4E",108,0)
 ;
"RTN","IBCSC4E",109,0)
 N DIR,DIRUT,DUOUT,DTOUT,X,Y,DIK W !
"RTN","IBCSC4E",110,0)
 S DIR("?")="Enter Yes to delete all Diagnosis currently defined for a bill, including any CPT Associated Diagnosis.",DIR("??")="^D DISP1^IBCSC4D("_IBIFN_")"
"RTN","IBCSC4E",111,0)
 S DIR("A")="DELETE ALL DIAGNOSIS ON BILL, INCLUDING CPT ASSOCIATED DIAGNOSIS"
"RTN","IBCSC4E",112,0)
 S DIR(0)="YO",DIR("B")="NO" D ^DIR K DIR Q:Y'=1
"RTN","IBCSC4E",113,0)
 ;
"RTN","IBCSC4E",114,0)
 N IBPROC,IBPROCD,IBXRF,IBDX,IBDXI,DIE,DIC,DA,DR
"RTN","IBCSC4E",115,0)
 S IBPROC=0 F  S IBPROC=$O(^DGCR(399,IBIFN,"CP",IBPROC)) Q:'IBPROC  D
"RTN","IBCSC4E",116,0)
 . S IBPROCD=$G(^DGCR(399,IBIFN,"CP",IBPROC,0)) I "^^^"[$P(IBPROCD,U,11,14) Q
"RTN","IBCSC4E",117,0)
 . S DIE="^DGCR(399,"_IBIFN_",""CP"",",DA=IBPROC,DA(1)=IBIFN,DR="10///@;11///@;12///@;13///@" D ^DIE K DA,DIE,DR
"RTN","IBCSC4E",118,0)
 ;
"RTN","IBCSC4E",119,0)
 S IBXRF="AIFN"_+IBIFN
"RTN","IBCSC4E",120,0)
 S IBDX=0 F  S IBDX=$O(^IBA(362.3,IBXRF,IBDX)) Q:'IBDX  D
"RTN","IBCSC4E",121,0)
 . S IBDXI=0 F  S IBDXI=$O(^IBA(362.3,IBXRF,IBDX,IBDXI)) Q:'IBDXI  D
"RTN","IBCSC4E",122,0)
 .. S DIK="^IBA(362.3,",DA=IBDXI D ^DIK K DIK,DA
"RTN","IBCSC4E",123,0)
 W " .... deleted"
"RTN","IBCSC4E",124,0)
 Q
"RTN","IBCSC4E",125,0)
 ;
"RTN","IBCSC4E",126,0)
POAASK ; POA edit
"RTN","IBCSC4E",127,0)
 N DIR,DIRUT,DUOUT,DTOUT,DX,ORD,X,Y
"RTN","IBCSC4E",128,0)
 W !
"RTN","IBCSC4E",129,0)
 S DIR("?")="Enter Yes to edit POA indicators."
"RTN","IBCSC4E",130,0)
 S DIR("A")="Edit POA indicators"
"RTN","IBCSC4E",131,0)
 S DIR(0)="YO",DIR("B")="NO" D ^DIR K DIR Q:Y'=1
"RTN","IBCSC4E",132,0)
 S DIE="^IBA(362.3,",ORD="" F  S ORD=$O(^IBA(362.3,"AO",IBIFN,ORD)) Q:ORD=""  D  Q:$D(Y)  ;
"RTN","IBCSC4E",133,0)
 .S DA=$O(^IBA(362.3,"AO",IBIFN,ORD,"")),DX=$$GET1^DIQ(362.3,DA,.01),DR=".04 "_DX D ^DIE
"RTN","IBCSC4E",134,0)
 .Q
"RTN","IBCSC4E",135,0)
 K DA,DIE,DIR,DR
"RTN","IBCSC4E",136,0)
 D CLEAN^DILF
"RTN","IBCSC4E",137,0)
 Q
"RTN","IBCSC4F")
0^10^B24461587^B18198669
"RTN","IBCSC4F",1,0)
IBCSC4F ;ALB/ARH - GET PTF DIAGNOSIS ; 10-OCT-1998
"RTN","IBCSC4F",2,0)
 ;;2.0;INTEGRATED BILLING;**106,403**;21-MAR-94;Build 24
"RTN","IBCSC4F",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCSC4F",4,0)
 ;
"RTN","IBCSC4F",5,0)
PTFDXDT(IBPTF,IBDT1,IBDT2,TF) ; collect PTF Transfer (501) and Discharge (701) movements and diagnosis within a date range
"RTN","IBCSC4F",6,0)
 ; if end date is before Discharge date delete Discharge Diagnosis
"RTN","IBCSC4F",7,0)
 ; if bill is an interim first or interim continuous then the last date on the bill is included in the bill
"RTN","IBCSC4F",8,0)
 N IBSTAY,IBADM,IBDSCH,IBDT,IBLAST,IBMDT K ^TMP($J,"IBDX","D"),^TMP($J,"IBDX","M") Q:'$G(IBPTF)
"RTN","IBCSC4F",9,0)
 S IBDT1=+$G(IBDT1)\1 Q:IBDT1'?7N  S IBDT2=+$G(IBDT2)\1 Q:IBDT2'?7N
"RTN","IBCSC4F",10,0)
 ;
"RTN","IBCSC4F",11,0)
 D PTFDX(IBPTF)
"RTN","IBCSC4F",12,0)
 ;
"RTN","IBCSC4F",13,0)
 S IBSTAY=$G(^TMP($J,"IBDX","M")),IBADM=+$P($P(IBSTAY,U,2),".",1),IBDSCH=+$P($P(IBSTAY,U,3),".",1)
"RTN","IBCSC4F",14,0)
 ;
"RTN","IBCSC4F",15,0)
 I IBADM=IBDSCH Q  ; 1 day stay, accept all
"RTN","IBCSC4F",16,0)
 I IBDT1=IBADM,IBDT2=IBDSCH Q  ; bill for entire length of stay, accept all
"RTN","IBCSC4F",17,0)
 ;
"RTN","IBCSC4F",18,0)
 I IBDT2<IBDSCH K ^TMP($J,"IBDX","D") ; discharge date not on bill, exclude 701 Dxs
"RTN","IBCSC4F",19,0)
 I 'IBDSCH,IBDT2<DT K ^TMP($J,"IBDX","D") ; not discharged, current end date (today) not on bill, exclude 701 Dxs
"RTN","IBCSC4F",20,0)
 ;
"RTN","IBCSC4F",21,0)
 ; determine which of the movements should be included based on dates and timeframe
"RTN","IBCSC4F",22,0)
 S TF=$G(TF) I (TF=2)!(TF=3) S IBDT2=$$FMADD^XLFDT(IBDT2,1) ; if first or continuous bill include end date
"RTN","IBCSC4F",23,0)
 ;
"RTN","IBCSC4F",24,0)
 S (IBLAST,IBDT)="" F  S IBDT=$O(^TMP($J,"IBDX","M",IBDT)) Q:'IBDT  D  S IBLAST=IBDT
"RTN","IBCSC4F",25,0)
 . S IBMDT=$P(IBDT,".",1)
"RTN","IBCSC4F",26,0)
 . I IBMDT'>IBDT1 K ^TMP($J,"IBDX","M",IBDT)
"RTN","IBCSC4F",27,0)
 . I IBLAST>IBDT2 K ^TMP($J,"IBDX","M",IBDT)
"RTN","IBCSC4F",28,0)
 Q
"RTN","IBCSC4F",29,0)
 ;
"RTN","IBCSC4F",30,0)
PTFDX(IBPTF) ; collect all PTF Transfer (501) and Discharge (701) movements and diagnosis and try to assign SC
"RTN","IBCSC4F",31,0)
 ; PTF movements are assigned SC or NSC but diagnosis are not
"RTN","IBCSC4F",32,0)
 ; this routine 'interprets' this PTF data and 'assigns' SC/NSC to individual Diagnosis
"RTN","IBCSC4F",33,0)
 ; Movement (501) Diagnosis:  all Dx on SC movements are assigned SC
"RTN","IBCSC4F",34,0)
 ;                            a Dx on an NSC movement that is also the first Dx on an SC move is assigned SC
"RTN","IBCSC4F",35,0)
 ; Discharge (701) Diagnosis: if admit is for SC care all discharge Dx are assigned SC
"RTN","IBCSC4F",36,0)
 ;                            if the Dx is also the first Dx on an SC movement then is assigned SC
"RTN","IBCSC4F",37,0)
 ;                            a Dx on an SC movement only is assigned SC
"RTN","IBCSC4F",38,0)
 ;
"RTN","IBCSC4F",39,0)
 ; Output:  TMP($J,"IBDX","D")=PTF # ^ ADMIT DATE ^ DISCHARGE DATE
"RTN","IBCSC4F",40,0)
 ;          TMP($J,"IBDX","D", DISCHARGE DATE) = DISCHARGE DATE ^ SPECIALTY ^ SC (1/0) ^ DRG ^ PROVIDER
"RTN","IBCSC4F",41,0)
 ;          TMP($J,"IBDX","D", DISCHARGE DATE, x) = DIAGNOSIS ^ SC? (1/0)
"RTN","IBCSC4F",42,0)
 ;
"RTN","IBCSC4F",43,0)
 ;          TMP($J,"IBDX","M")=PTF # ^ ADMIT DATE ^ DISCHARGE DATE
"RTN","IBCSC4F",44,0)
 ;          TMP($J,"IBDX","M", MOVEMENT DATE) = MOVEMENT DATE ^ SPECIALTY ^ SC (1/0) ^ DRG ^ PROVIDER
"RTN","IBCSC4F",45,0)
 ;          TMP($J,"IBDX","M", MOVEMENT DATE, x) = DIAGNOSIS ^ SC? (1/0)
"RTN","IBCSC4F",46,0)
 ; if patient not discharged then NOW is used as date subscript and first piece will be null, SC?=interpreted SC
"RTN","IBCSC4F",47,0)
 ;
"RTN","IBCSC4F",48,0)
 N IBSTAY,IBMI,IBM0,IBDT,IBMDT,IBMBS,IBMP,IBMDRG,IBMPRV,IBMSC,IBMDX,IBD0,IBDDT,IBDBS,IBDDRG,IBDPRV,IBDSC,IBDDX
"RTN","IBCSC4F",49,0)
 N IBCNT,IBI,IBTMP,DFN,DGVAR,DRG,DRGCAL,ICDCAL,PTF K ^TMP($J,"IBDX","M"),^TMP($J,"IBDX","D") Q:'$G(IBPTF)
"RTN","IBCSC4F",50,0)
 ;
"RTN","IBCSC4F",51,0)
 S IBSTAY=IBPTF_U_$P($G(^DGPT(IBPTF,0)),U,2)_U_$P($G(^DGPT(IBPTF,70)),U,1) Q:'$P(IBSTAY,U,2)
"RTN","IBCSC4F",52,0)
 ;
"RTN","IBCSC4F",53,0)
 ; collect PTF Movement Diagnosis (501)
"RTN","IBCSC4F",54,0)
 S ^TMP($J,"IBDX","M")=IBSTAY
"RTN","IBCSC4F",55,0)
 S IBMI=0 F  S IBMI=$O(^DGPT(IBPTF,"M",IBMI)) Q:'IBMI  D
"RTN","IBCSC4F",56,0)
 . S IBM0=$G(^DGPT(IBPTF,"M",IBMI,0)) Q:'IBM0
"RTN","IBCSC4F",57,0)
 . S (IBDT,IBMDT)=$P(IBM0,U,10) I 'IBDT S IBDT=$$NOW^XLFDT
"RTN","IBCSC4F",58,0)
 . S IBMBS=$P(IBM0,U,2),IBMSC=$P(IBM0,U,18),IBMSC=$S(IBMSC=1:1,1:"")
"RTN","IBCSC4F",59,0)
 . S IBMP=$G(^DGPT(IBPTF,"M",IBMI,"P")),IBMPRV=$P(IBMP,U,5),IBMDRG=$$MVDRG^IBCRBG(IBPTF,IBMI)
"RTN","IBCSC4F",60,0)
 . ;
"RTN","IBCSC4F",61,0)
 . S ^TMP($J,"IBDX","M",IBDT)=IBMDT_U_IBMBS_U_IBMSC_U_IBMDRG_U_IBMPRV
"RTN","IBCSC4F",62,0)
 . ;
"RTN","IBCSC4F",63,0)
 . S IBCNT=0 F IBI=5:1:9 S IBMDX=+$P(IBM0,U,IBI) I +IBMDX S IBCNT=IBCNT+1 D
"RTN","IBCSC4F",64,0)
 .. S ^TMP($J,"IBDX","M",IBDT,IBCNT)=IBMDX,IBTMP("DXSC",IBMDX,+IBMSC,IBCNT)=""
"RTN","IBCSC4F",65,0)
 ;
"RTN","IBCSC4F",66,0)
 ; collect PTF Discharge Diagnosis (701)
"RTN","IBCSC4F",67,0)
 S ^TMP($J,"IBDX","D")=IBSTAY
"RTN","IBCSC4F",68,0)
 S IBD0=$G(^DGPT(IBPTF,70)),IBDDRG=$$GET1^DIQ(45,IBPTF,9,""),IBDPRV=$P(IBD0,U,15)
"RTN","IBCSC4F",69,0)
 S (IBDT,IBDDT)=$P(IBD0,U,1) I 'IBDT S IBDT=$$NOW^XLFDT
"RTN","IBCSC4F",70,0)
 S IBDBS=$P(IBD0,U,2),IBDSC=$P(IBD0,U,25),IBDSC=$S(IBDSC=1:1,1:"")
"RTN","IBCSC4F",71,0)
 ;
"RTN","IBCSC4F",72,0)
 S ^TMP($J,"IBDX","D",IBDT)=IBDDT_U_IBDBS_U_IBDSC_U_IBDDRG_U_IBDPRV
"RTN","IBCSC4F",73,0)
 ;
"RTN","IBCSC4F",74,0)
 S IBCNT=0 F IBI=10,16:1:24 S IBDDX=+$P(IBD0,U,IBI) I +IBDDX S IBCNT=IBCNT+1 D
"RTN","IBCSC4F",75,0)
 . S ^TMP($J,"IBDX","D",IBDT,IBCNT)=IBDDX
"RTN","IBCSC4F",76,0)
 ;
"RTN","IBCSC4F",77,0)
 ; Try to assign SC to PTF Diagnosis
"RTN","IBCSC4F",78,0)
 ;
"RTN","IBCSC4F",79,0)
 ; assign SC to Movement Diagnosis (501):  if movement is SC or first Dx on an SC movement
"RTN","IBCSC4F",80,0)
 S IBMDT=0 F  S IBMDT=$O(^TMP($J,"IBDX","M",IBMDT)) Q:'IBMDT  D
"RTN","IBCSC4F",81,0)
 . S IBI="" F  S IBI=$O(^TMP($J,"IBDX","M",IBMDT,IBI)) Q:'IBI  D
"RTN","IBCSC4F",82,0)
 .. S IBMDX=+$G(^TMP($J,"IBDX","M",IBMDT,IBI)) Q:'IBMDX
"RTN","IBCSC4F",83,0)
 .. ;
"RTN","IBCSC4F",84,0)
 .. S IBMSC=+$P($G(^TMP($J,"IBDX","M",IBMDT)),U,3) ; sc move
"RTN","IBCSC4F",85,0)
 .. I 'IBMSC,$D(IBTMP("DXSC",IBMDX,1,1)) S IBMSC=1 ; first dx on sc move
"RTN","IBCSC4F",86,0)
 .. ;
"RTN","IBCSC4F",87,0)
 .. I +IBMSC S $P(^TMP($J,"IBDX","M",IBMDT,IBI),U,2)=1
"RTN","IBCSC4F",88,0)
 ;
"RTN","IBCSC4F",89,0)
 ; assign SC to Discharge Diagnosis (701):  if stay is SC or first Dx on an SC movement or only on SC movement
"RTN","IBCSC4F",90,0)
 S IBDDT=0 F  S IBDDT=$O(^TMP($J,"IBDX","D",IBDDT)) Q:'IBDDT  D
"RTN","IBCSC4F",91,0)
 . S IBI="" F  S IBI=$O(^TMP($J,"IBDX","D",IBDDT,IBI)) Q:'IBI  D
"RTN","IBCSC4F",92,0)
 .. S IBDDX=+$G(^TMP($J,"IBDX","D",IBDDT,IBI)) Q:'IBDDX
"RTN","IBCSC4F",93,0)
 .. ;
"RTN","IBCSC4F",94,0)
 .. S IBDSC=+$P($G(^TMP($J,"IBDX","D",IBDDT)),U,3) ; sc stay
"RTN","IBCSC4F",95,0)
 .. I 'IBDSC,$D(IBTMP("DXSC",IBDDX,1,1)) S IBDSC=1 ; first dx on sc move
"RTN","IBCSC4F",96,0)
 .. I 'IBDSC,+$O(IBTMP("DXSC",IBDDX,"")) S IBDSC=1 ; on sc move only
"RTN","IBCSC4F",97,0)
 .. ;
"RTN","IBCSC4F",98,0)
 .. I +IBDSC S $P(^TMP($J,"IBDX","D",IBDDT,IBI),U,2)=1
"RTN","IBCSC4F",99,0)
 ;
"RTN","IBCSC4F",100,0)
 Q
"RTN","IBCSC4F",101,0)
 ;
"RTN","IBCSC4F",102,0)
SETPOA(IBIFN) ; get POAs from file 19640.1 and put them into file 362.3
"RTN","IBCSC4F",103,0)
 N DIAG,DIEN,IBPTF,IEN362,ORDER,POASET
"RTN","IBCSC4F",104,0)
 ; get PTF ien
"RTN","IBCSC4F",105,0)
 S IBPTF=$P($G(^DGCR(399,IBIFN,0)),U,8) Q:IBPTF=""
"RTN","IBCSC4F",106,0)
 ; loop through all entries in 19640.1 for this PTF
"RTN","IBCSC4F",107,0)
 S DIEN="" F  S DIEN=$O(^DSIPPOA("B",IBPTF,DIEN)) Q:DIEN=""  D
"RTN","IBCSC4F",108,0)
 .S DIAG=$P($G(^DSIPPOA(DIEN,0)),U,3) Q:DIAG=""
"RTN","IBCSC4F",109,0)
 .; loop through all DXes in 362.3 for this claim and try to find a match for 19640.1 entry
"RTN","IBCSC4F",110,0)
 .S POASET=0,ORDER="" F  S ORDER=$O(^IBA(362.3,"AO",IBIFN,ORDER)) Q:ORDER=""!(POASET=1)  D
"RTN","IBCSC4F",111,0)
 ..S IEN362=$O(^IBA(362.3,"AO",IBIFN,ORDER,""))
"RTN","IBCSC4F",112,0)
 ..; if DX in 362.3 matches DX in 19640.1, put proper POA indicator into 362.3 and bail out
"RTN","IBCSC4F",113,0)
 ..I DIAG=$P($G(^IBA(362.3,IEN362,0)),U) S $P(^IBA(362.3,IEN362,0),U,4)=$P(^DSIPPOA(DIEN,0),U,4),POASET=1
"RTN","IBCSC4F",114,0)
 ..Q 
"RTN","IBCSC4F",115,0)
 .Q
"RTN","IBCSC4F",116,0)
 Q 
"RTN","IBY403PR")
0^^B13247492^n/a
"RTN","IBY403PR",1,0)
IBY403PR ;BP/YMG - Pre-Installation for IB patch 403 ;26-Aug-2008
"RTN","IBY403PR",2,0)
 ;;2.0;INTEGRATED BILLING;**403**;21-MAR-94;Build 24
"RTN","IBY403PR",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBY403PR",4,0)
 ;
"RTN","IBY403PR",5,0)
 D DELOF       ; delete all output formatter data elements included in build
"RTN","IBY403PR",6,0)
 D DEFDIV      ; check default division
"RTN","IBY403PR",7,0)
 Q
"RTN","IBY403PR",8,0)
 ;
"RTN","IBY403PR",9,0)
DELOF ; Delete included output formatter entries
"RTN","IBY403PR",10,0)
 NEW FILE,DIK,LN,TAG,DATA,PCE,DA,Y
"RTN","IBY403PR",11,0)
 F FILE=5,6,7 S DIK="^IBA(364."_FILE_"," F LN=2:1 S TAG="ENT"_FILE_"+"_LN,DATA=$P($T(@TAG),";;",2) Q:DATA=""  D
"RTN","IBY403PR",12,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA("364."_FILE,DA,0)) D ^DIK
"RTN","IBY403PR",13,0)
 . Q
"RTN","IBY403PR",14,0)
 ;
"RTN","IBY403PR",15,0)
 ; Also delete output formatter entries which are not going to be
"RTN","IBY403PR",16,0)
 ; re-added later.  These are non-functioning or obsolete entries
"RTN","IBY403PR",17,0)
 ; in file 364.6.
"RTN","IBY403PR",18,0)
 S DIK="^IBA(364.6,",TAG="DEL6+2",DATA=$P($T(@TAG),";;",2)
"RTN","IBY403PR",19,0)
 I DATA'="" D
"RTN","IBY403PR",20,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA(364.6,DA,0)) D ^DIK
"RTN","IBY403PR",21,0)
 . Q
"RTN","IBY403PR",22,0)
 ;
"RTN","IBY403PR",23,0)
 ; Also delete output formatter entries which are not going to be
"RTN","IBY403PR",24,0)
 ; re-added later.  These are non-functioning or obsolete entries
"RTN","IBY403PR",25,0)
 ; in file 364.7.
"RTN","IBY403PR",26,0)
 S DIK="^IBA(364.7,",TAG="DEL7+2",DATA=$P($T(@TAG),";;",2)
"RTN","IBY403PR",27,0)
 I DATA'="" D
"RTN","IBY403PR",28,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA(364.7,DA,0)) D ^DIK
"RTN","IBY403PR",29,0)
 . Q
"RTN","IBY403PR",30,0)
 ;
"RTN","IBY403PR",31,0)
DELOFX ;
"RTN","IBY403PR",32,0)
 Q
"RTN","IBY403PR",33,0)
 ;
"RTN","IBY403PR",34,0)
DEFDIV ; check and report on default division (350.9,1.25)
"RTN","IBY403PR",35,0)
 N DEF,MAIN,DEFDN,MAINDN,DEFINST,MAININST,SITE,SUBJ,MSG,XMTO
"RTN","IBY403PR",36,0)
 ;
"RTN","IBY403PR",37,0)
 S DEF=+$P($G(^IBE(350.9,1,1)),U,25)          ; default division field from the IB site params
"RTN","IBY403PR",38,0)
 S MAIN=+$$PRIM^VASITE()                      ; main division for VistA database
"RTN","IBY403PR",39,0)
 I 'DEF G DEFDIVX                             ; exit if no default division
"RTN","IBY403PR",40,0)
 I DEF=MAIN G DEFDIVX                         ; exit if they're the same
"RTN","IBY403PR",41,0)
 I '$$PROD^XUPROD(1) G DEFDIVX                ; not a production account
"RTN","IBY403PR",42,0)
 ;
"RTN","IBY403PR",43,0)
 ; default division is different than main division - report on both
"RTN","IBY403PR",44,0)
 S DEFDN=$$GET1^DIQ(40.8,DEF_",",.01)         ; default division name
"RTN","IBY403PR",45,0)
 S MAINDN=$$GET1^DIQ(40.8,MAIN_",",.01)       ; main division name
"RTN","IBY403PR",46,0)
 ;
"RTN","IBY403PR",47,0)
 S DEFINST=$$SITE^VASITE($$DT^XLFDT,DEF)      ; default institution information
"RTN","IBY403PR",48,0)
 S MAININST=$$SITE^VASITE($$DT^XLFDT,MAIN)    ; main institution information
"RTN","IBY403PR",49,0)
 ;
"RTN","IBY403PR",50,0)
 ; send email
"RTN","IBY403PR",51,0)
 S SITE=$$SITE^VASITE
"RTN","IBY403PR",52,0)
 S SUBJ="Station# "_$P(SITE,U,3)_" - "_$P(SITE,U,2)_" - Default/Main Division"
"RTN","IBY403PR",53,0)
 S SUBJ=$E(SUBJ,1,65)
"RTN","IBY403PR",54,0)
 S MSG(1)="Default Division Name:  "_DEFDN
"RTN","IBY403PR",55,0)
 S MSG(2)="            Inst Name:  "_$P(DEFINST,U,2)
"RTN","IBY403PR",56,0)
 S MSG(3)="             Station#:  "_$P(DEFINST,U,3)
"RTN","IBY403PR",57,0)
 S MSG(4)=""
"RTN","IBY403PR",58,0)
 S MSG(5)="   Main Division Name:  "_MAINDN
"RTN","IBY403PR",59,0)
 S MSG(6)="            Inst Name:  "_$P(MAININST,U,2)
"RTN","IBY403PR",60,0)
 S MSG(7)="             Station#:  "_$P(MAININST,U,3)
"RTN","IBY403PR",61,0)
 ;
"RTN","IBY403PR",62,0)
 S XMTO("Eric.Gustafson@va.gov")=""
"RTN","IBY403PR",63,0)
 ;
"RTN","IBY403PR",64,0)
 D SENDMSG^XMXAPI(DUZ,SUBJ,"MSG",.XMTO)
"RTN","IBY403PR",65,0)
 ;
"RTN","IBY403PR",66,0)
DEFDIVX ;
"RTN","IBY403PR",67,0)
 Q
"RTN","IBY403PR",68,0)
 ;
"RTN","IBY403PR",69,0)
INCLUDE(FILE,Y) ; function to determine if output formatter entry should be
"RTN","IBY403PR",70,0)
 ; included in the build
"RTN","IBY403PR",71,0)
 ; FILE=5,6,7 indicating file 364.x
"RTN","IBY403PR",72,0)
 ; Y=ien to file
"RTN","IBY403PR",73,0)
 ;
"RTN","IBY403PR",74,0)
 NEW OK,LN,TAG,DATA
"RTN","IBY403PR",75,0)
 S OK=0
"RTN","IBY403PR",76,0)
 F LN=2:1 S TAG="ENT"_FILE_"+"_LN,DATA=$P($T(@TAG),";;",2) Q:DATA=""  I $F(DATA,U_Y_U) S OK=1 Q
"RTN","IBY403PR",77,0)
INCLUDEX ;
"RTN","IBY403PR",78,0)
 Q OK
"RTN","IBY403PR",79,0)
 ;
"RTN","IBY403PR",80,0)
INC3508(Y) ; function to determine if entry in IB ERROR file (350.8) should be included in the build
"RTN","IBY403PR",81,0)
 ; Y - ien to file
"RTN","IBY403PR",82,0)
 N DATA,ENTRY,LN,OK,TAG
"RTN","IBY403PR",83,0)
 S OK=0,ENTRY=U_$P($G(^IBE(350.8,Y,0)),U,3)_U
"RTN","IBY403PR",84,0)
 F LN=2:1 S TAG="ENT3508+"_LN,DATA=$P($T(@TAG),";;",2) Q:DATA=""  I $F(DATA,ENTRY) S OK=1 Q
"RTN","IBY403PR",85,0)
 Q OK
"RTN","IBY403PR",86,0)
 ;
"RTN","IBY403PR",87,0)
 ;-----------------------------------------------------------------------
"RTN","IBY403PR",88,0)
 ; 364.5 entries modified:
"RTN","IBY403PR",89,0)
 ;
"RTN","IBY403PR",90,0)
ENT5 ; output formatter entries in file 364.5 to be included
"RTN","IBY403PR",91,0)
 ;
"RTN","IBY403PR",92,0)
 ;;
"RTN","IBY403PR",93,0)
 ;
"RTN","IBY403PR",94,0)
 ;-----------------------------------------------------------------------
"RTN","IBY403PR",95,0)
 ; 364.6 entries modified:
"RTN","IBY403PR",96,0)
 ;
"RTN","IBY403PR",97,0)
ENT6 ; output formatter entries in file 364.6 to be included
"RTN","IBY403PR",98,0)
 ;
"RTN","IBY403PR",99,0)
 ;;^93^952^1879^
"RTN","IBY403PR",100,0)
 ;
"RTN","IBY403PR",101,0)
 ;
"RTN","IBY403PR",102,0)
 ;-----------------------------------------------------------------------
"RTN","IBY403PR",103,0)
 ; 364.7 entries modified:
"RTN","IBY403PR",104,0)
 ;
"RTN","IBY403PR",105,0)
ENT7 ; output formatter entries in file 364.7 to be included
"RTN","IBY403PR",106,0)
 ;
"RTN","IBY403PR",107,0)
 ;;^27^41^84^924^1015^1298^1371^1383^1384^1385^1386^1387^1388^1389^1390^1391^1392^1393^
"RTN","IBY403PR",108,0)
 ;;^1394^1395^1396^1397^1398^1399^1400^1411^1579^
"RTN","IBY403PR",109,0)
 ;;
"RTN","IBY403PR",110,0)
 ;
"RTN","IBY403PR",111,0)
 ;
"RTN","IBY403PR",112,0)
 ;-----------------------------------------------------------------------
"RTN","IBY403PR",113,0)
DEL6 ; remove output formatter entries in file 364.6 (not re-added)
"RTN","IBY403PR",114,0)
 ;
"RTN","IBY403PR",115,0)
 ;;
"RTN","IBY403PR",116,0)
 ;
"RTN","IBY403PR",117,0)
 ;-----------------------------------------------------------------------
"RTN","IBY403PR",118,0)
DEL7 ; remove output formatter entries in file 364.7 (not re-added)
"RTN","IBY403PR",119,0)
 ;
"RTN","IBY403PR",120,0)
 ;;
"RTN","IBY403PR",121,0)
 ;
"RTN","IBY403PR",122,0)
ENT3508 ; entries in file 350.8 to be included
"RTN","IBY403PR",123,0)
 ;
"RTN","IBY403PR",124,0)
 ;;^IB071^IB117^
"RTN","IBY403PR",125,0)
 ;;
"RTN","IBY403PR",126,0)
 ; 
"VER")
8.0^22.0
"^DD",350.8,350.8,0)
FIELD^^10^7
"^DD",350.8,350.8,0,"DDA")
N
"^DD",350.8,350.8,0,"DT")
2930322
"^DD",350.8,350.8,0,"ID",.03)
W "   ",$P(^(0),U,3)
"^DD",350.8,350.8,0,"IX","AC",350.8,.03)

"^DD",350.8,350.8,0,"IX","B",350.8,.01)

"^DD",350.8,350.8,0,"IX","C",350.8,.03)

"^DD",350.8,350.8,0,"NM","IB ERROR")
 
"^DD",350.8,350.8,0,"VRPK")
IB
"^DD",350.8,350.8,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",350.8,350.8,.01,1,0)
^.1
"^DD",350.8,350.8,.01,1,1,0)
350.8^B
"^DD",350.8,350.8,.01,1,1,1)
S ^IBE(350.8,"B",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.01,1,1,2)
K ^IBE(350.8,"B",$E(X,1,30),DA)
"^DD",350.8,350.8,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",350.8,350.8,.01,21,0)
^^2^2^2910305^^
"^DD",350.8,350.8,.01,21,1,0)
This is a free text name of the entry.  It should be namespaced with
"^DD",350.8,350.8,.01,21,2,0)
the namespace of the package reporting the error.
"^DD",350.8,350.8,.02,0)
ERROR MESSAGE^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",350.8,350.8,.02,3)
Answer must be 3-80 characters in length.
"^DD",350.8,350.8,.02,21,0)
^^3^3^2940209^^^^
"^DD",350.8,350.8,.02,21,1,0)
This is the text of the message as it will be displayed to a user or
"^DD",350.8,350.8,.02,21,2,0)
posted in a bulletin.  It should be as meaningful as possible to the
"^DD",350.8,350.8,.02,21,3,0)
person seeing the message.
"^DD",350.8,350.8,.03,0)
ERROR CODE^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>9!($L(X)<1) X
"^DD",350.8,350.8,.03,1,0)
^.1
"^DD",350.8,350.8,.03,1,1,0)
350.8^AC
"^DD",350.8,350.8,.03,1,1,1)
S ^IBE(350.8,"AC",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,1,2)
K ^IBE(350.8,"AC",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,1,2,0)
350.8^C
"^DD",350.8,350.8,.03,1,2,1)
S ^IBE(350.8,"C",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,2,2)
K ^IBE(350.8,"C",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,3)
Answer must be 1-9 characters in length.
"^DD",350.8,350.8,.03,21,0)
^^9^9^2920219^^^^
"^DD",350.8,350.8,.03,21,1,0)
This is the error code that will be passed to or determined by
"^DD",350.8,350.8,.03,21,2,0)
Integrated Billing.  The format for the Error Code should be
"^DD",350.8,350.8,.03,21,3,0)
nnxxx, where nn is the reporting package namespace and xxx are numeric
"^DD",350.8,350.8,.03,21,4,0)
values.
"^DD",350.8,350.8,.03,21,5,0)
 
"^DD",350.8,350.8,.03,21,6,0)
This is the error code that will be passed as the second piece of
"^DD",350.8,350.8,.03,21,7,0)
the variable Y to IB when +Y=-1.  More than one error code can be
"^DD",350.8,350.8,.03,21,8,0)
placed in the second ^ piece of Y delimited by semi-colons.  Applications
"^DD",350.8,350.8,.03,21,9,0)
may call ^IBAERR to display the error message(s).
"^DD",350.8,350.8,.03,"DT")
2920219
"^DD",350.8,350.8,.04,0)
PACKAGE REPORTING ERROR^S^1:INTEGRATED BILLING;2:ACCOUNTS RECEIVABLE;3:PHARMACY;^0;4^Q
"^DD",350.8,350.8,.04,21,0)
^^2^2^2920415^^^
"^DD",350.8,350.8,.04,21,1,0)
This is the package that requested this entry in this file and will
"^DD",350.8,350.8,.04,21,2,0)
report it to IB as an error if the conditions are detected.
"^DD",350.8,350.8,.05,0)
ERROR ACTION^S^1:DISPLAY MESSAGE;2:SEND BULLETIN;3:EDIT FILE;^0;5^Q
"^DD",350.8,350.8,.05,21,0)
^^6^6^2910227^
"^DD",350.8,350.8,.05,21,1,0)
This is the type of action that should be taken when this error is
"^DD",350.8,350.8,.05,21,2,0)
reported to IB.  If action other than displaying a message is indicated
"^DD",350.8,350.8,.05,21,3,0)
then the MUMPS code in the ERROR ACTION field will be executed.
"^DD",350.8,350.8,.05,21,4,0)
 
"^DD",350.8,350.8,.05,21,5,0)
Currently only display actions are implemented.  Please contact the 
"^DD",350.8,350.8,.05,21,6,0)
developing ISC if other action types are desired.
"^DD",350.8,350.8,.06,0)
CORRESPONDING ALERT^P354.5'^IBE(354.5,^0;6^Q
"^DD",350.8,350.8,.06,21,0)
^^1^1^2940209^
"^DD",350.8,350.8,.06,21,1,0)
This is the type of alert that should be sent when this error occurs.
"^DD",350.8,350.8,.06,"DT")
2930322
"^DD",350.8,350.8,10,0)
EXECUTABLE LOGIC^K^^10;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",350.8,350.8,10,3)
This is Standard MUMPS code.
"^DD",350.8,350.8,10,21,0)
^^2^2^2910227^
"^DD",350.8,350.8,10,21,1,0)
This is the MUMPS code that will be executed if an error is reported
"^DD",350.8,350.8,10,21,2,0)
with an ERROR ACTION of other than to display a message.
"^DD",362.3,362.3,.04,0)
POA INDICATOR^S^Y:Yes;N:No;U:No Information;W:Clinically Undetermined;1:Blank/Exempt from POA Reporting;^0;4^Q
"^DD",362.3,362.3,.04,3)
Enter the value that correctly indicates if this condition was present at the time the patient was admitted.
"^DD",362.3,362.3,.04,21,0)
^^2^2^3081010^
"^DD",362.3,362.3,.04,21,1,0)
Enter the value that correctly indicates if this condition was present
"^DD",362.3,362.3,.04,21,2,0)
at the time the patient was admitted.
"^DD",362.3,362.3,.04,23,0)
^^4^4^3080908^
"^DD",362.3,362.3,.04,23,1,0)
This is "Present On Admission" indicator.
"^DD",362.3,362.3,.04,23,2,0)
 
"^DD",362.3,362.3,.04,23,3,0)
Value of "1" instead of the actual blank is required for 837 
"^DD",362.3,362.3,.04,23,4,0)
transmissions and QuadraMed interface.
"^DD",362.3,362.3,.04,"DT")
3081010
"^DD",364.6,364.6,0)
FIELD^^.13^13
"^DD",364.6,364.6,0,"DDA")
N
"^DD",364.6,364.6,0,"DT")
3071126
"^DD",364.6,364.6,0,"ID",.04)
W "   ",$P(^(0),U,4)
"^DD",364.6,364.6,0,"ID",.05)
W "   ",$P(^(0),U,5)
"^DD",364.6,364.6,0,"ID",.08)
W "   ",$P(^(0),U,8)
"^DD",364.6,364.6,0,"ID",.1)
W "   ",$P(^(0),U,10)
"^DD",364.6,364.6,0,"IX","APAR",364.6,.01)

"^DD",364.6,364.6,0,"IX","APAR1",364.6,.03)

"^DD",364.6,364.6,0,"IX","ASEQ",364.6,.01)

"^DD",364.6,364.6,0,"IX","ASEQ1",364.6,.04)

"^DD",364.6,364.6,0,"IX","ASEQ2",364.6,.05)

"^DD",364.6,364.6,0,"IX","ASEQ3",364.6,.08)

"^DD",364.6,364.6,0,"IX","B",364.6,.01)

"^DD",364.6,364.6,0,"NM","IB FORM SKELETON DEFINITION")
 
"^DD",364.6,364.6,0,"PT",364.6,.03)

"^DD",364.6,364.6,0,"PT",364.7,.01)

"^DD",364.6,364.6,0,"VRPK")
IB
"^DD",364.6,364.6,.01,0)
BILL FORM^RP353'X^IBE(353,^0;1^I $$DUP^IBCEFG0($G(DA),X,1) K X
"^DD",364.6,364.6,.01,1,0)
^.1
"^DD",364.6,364.6,.01,1,1,0)
364.6^B
"^DD",364.6,364.6,.01,1,1,1)
S ^IBA(364.6,"B",$E(X,1,30),DA)=""
"^DD",364.6,364.6,.01,1,1,2)
K ^IBA(364.6,"B",$E(X,1,30),DA)
"^DD",364.6,364.6,.01,1,2,0)
364.6^ASEQ^MUMPS
"^DD",364.6,364.6,.01,1,2,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=$P(Z0,U,4),Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 S ^IBA(364.6,"ASEQ",+X,Z1,Z2,Z3,DA)=""
"^DD",364.6,364.6,.01,1,2,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=$P(Z0,U,4),Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 K ^IBA(364.6,"ASEQ",+X,Z1,Z2,Z3,DA)
"^DD",364.6,364.6,.01,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,2,"%D",0)
^^1^1^2960117^^
"^DD",364.6,364.6,.01,1,2,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.01,1,2,"DT")
2960116
"^DD",364.6,364.6,.01,1,3,0)
364.6^APAR^MUMPS
"^DD",364.6,364.6,.01,1,3,1)
N Z0 S Z0=$P($G(^IBA(364.6,DA,0)),U,3) I Z0,Z0'=X S ^IBA(364.6,"APAR",$E(X,1,30),Z0,DA)=""
"^DD",364.6,364.6,.01,1,3,2)
N Z0 S Z0=$P($G(^IBA(364.6,DA,0)),U,3) I Z0,Z0'=X K ^IBA(364.6,"APAR",$E(X,1,30),Z0,DA)
"^DD",364.6,364.6,.01,1,3,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,3,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.01,1,3,"%D",1,0)
Xref by bill form and associated form field definition.
"^DD",364.6,364.6,.01,1,3,"DT")
2960117
"^DD",364.6,364.6,.01,1,4,0)
^^TRIGGER^364.6^.03
"^DD",364.6,364.6,.01,1,4,1)
X ^DD(364.6,.01,1,4,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=$S('$D(D0):"",D0<0:"",1:D0) X ^DD(364.6,.01,1,4,1.4)
"^DD",364.6,364.6,.01,1,4,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.01,1,4,69.2) S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.01,1,4,1.4)
S DIH=$G(^IBA(364.6,DIV(0),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=364.6,DIG=.03 D ^DICR
"^DD",364.6,364.6,.01,1,4,2)
X ^DD(364.6,.01,1,4,2.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" S DIH=$G(^IBA(364.6,DIV(0),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=364.6,DIG=.03 D ^DICR
"^DD",364.6,364.6,.01,1,4,2.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.01,1,4,79.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.01,1,4,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,4,69.2)
S I(0,0)=$G(D0),D0=Y(0) S:'D0!'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$P($G(^DD(353,2.02,0)),U,3),Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"")
"^DD",364.6,364.6,.01,1,4,79.2)
S I(0,0)=$G(D0),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'D0!'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$P($G(^DD(353,2.02,0)),U,3)
"^DD",364.6,364.6,.01,1,4,"%D",0)
^^1^1^3000613^
"^DD",364.6,364.6,.01,1,4,"%D",1,0)
This trigger is needed for the local screen 9 logic to work correctly.
"^DD",364.6,364.6,.01,1,4,"CREATE CONDITION")
BILL FORM:FORMAT TYPE="BILLING SCREEN"
"^DD",364.6,364.6,.01,1,4,"CREATE VALUE")
NUMBER
"^DD",364.6,364.6,.01,1,4,"DELETE CONDITION")
BILL FORM:FORMAT TYPE="BILLING SCREEN"
"^DD",364.6,364.6,.01,1,4,"DELETE VALUE")
@
"^DD",364.6,364.6,.01,1,4,"DT")
3000613
"^DD",364.6,364.6,.01,1,4,"FIELD")
ASSOCIATED FORM DEFINITION
"^DD",364.6,364.6,.01,3)
Enter a BILLING FORM that the data element will appear on.
"^DD",364.6,364.6,.01,21,0)
^^2^2^2960318^^^^
"^DD",364.6,364.6,.01,21,1,0)
Identifies a billing 'form' or 'screen' where the data element is used.
"^DD",364.6,364.6,.01,21,2,0)
The combination of form/page/line/column must be unique.
"^DD",364.6,364.6,.01,"DT")
3000613
"^DD",364.6,364.6,.02,0)
SECURITY LEVEL^SX^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^I X="N",$P($G(^IBA(364.6,DA,0)),U,3) K X
"^DD",364.6,364.6,.02,3)
Enter an N if no editing is allowed, L if editing is OK because this entry is associated with a locally defined form.
"^DD",364.6,364.6,.02,5,1,0)
364.6^.03^7
"^DD",364.6,364.6,.02,21,0)
^.001^4^4^3001030^^
"^DD",364.6,364.6,.02,21,1,0)
This field determines whether or not editing of the entry is allowed.  If
"^DD",364.6,364.6,.02,21,2,0)
the security level of the entry is NATIONAL (N), no local editing is
"^DD",364.6,364.6,.02,21,3,0)
allowed.  If the security level of the entry is LOCAL (L), it may be
"^DD",364.6,364.6,.02,21,4,0)
edited.
"^DD",364.6,364.6,.02,"DT")
2960117
"^DD",364.6,364.6,.03,0)
ASSOCIATED FORM DEFINITION^P364.6'^IBA(364.6,^0;3^Q
"^DD",364.6,364.6,.03,1,0)
^.1
"^DD",364.6,364.6,.03,1,1,0)
364.6^APAR1^MUMPS
"^DD",364.6,364.6,.03,1,1,1)
N Z0 S Z0=+$G(^IBA(364.6,DA,0)) I Z0,Z0'=X S ^IBA(364.6,"APAR",Z0,$E(X,1,30),DA)=""
"^DD",364.6,364.6,.03,1,1,2)
N Z0 S Z0=+$G(^IBA(364.6,DA,0)) I Z0,Z0'=X K ^IBA(364.6,"APAR",Z0,$E(X,1,30),DA)
"^DD",364.6,364.6,.03,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,1,"%D",0)
^^1^1^2960117^^
"^DD",364.6,364.6,.03,1,1,"%D",1,0)
Xref by bill form and associated form field definition.
"^DD",364.6,364.6,.03,1,1,"DT")
2960117
"^DD",364.6,364.6,.03,1,2,0)
^^TRIGGER^364.6^.04
"^DD",364.6,364.6,.03,1,2,1)
X ^DD(364.6,.03,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,2,1.4)
"^DD",364.6,364.6,.03,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,2,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,2,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,4)=DIV,DIH=364.6,DIG=.04 D ^DICR
"^DD",364.6,364.6,.03,1,2,2)
Q
"^DD",364.6,364.6,.03,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,2,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,2,"%D",0)
^.101^2^2^3000424^^
"^DD",364.6,364.6,.03,1,2,"%D",1,0)
If an associated form that is not a screen form, page is taken from the
"^DD",364.6,364.6,.03,1,2,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,2,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,2,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,2,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,2,"DT")
3000405
"^DD",364.6,364.6,.03,1,2,"FIELD")
PAGE OR SEQUENCE
"^DD",364.6,364.6,.03,1,3,0)
^^TRIGGER^364.6^.05
"^DD",364.6,364.6,.03,1,3,1)
X ^DD(364.6,.03,1,3,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,3,1.4)
"^DD",364.6,364.6,.03,1,3,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,3,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,3,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,5)=DIV,DIH=364.6,DIG=.05 D ^DICR
"^DD",364.6,364.6,.03,1,3,2)
Q
"^DD",364.6,364.6,.03,1,3,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,3,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,3,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,3,"%D",1,0)
If an associated form that is not a screen form, line is taken from the
"^DD",364.6,364.6,.03,1,3,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,3,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,3,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,3,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,3,"DT")
3000405
"^DD",364.6,364.6,.03,1,3,"FIELD")
FIRST LINE NUMBER
"^DD",364.6,364.6,.03,1,4,0)
^^TRIGGER^364.6^.08
"^DD",364.6,364.6,.03,1,4,1)
X ^DD(364.6,.03,1,4,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,4,1.4)
"^DD",364.6,364.6,.03,1,4,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,4,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,4,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,8)=DIV,DIH=364.6,DIG=.08 D ^DICR
"^DD",364.6,364.6,.03,1,4,2)
Q
"^DD",364.6,364.6,.03,1,4,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,4,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,4,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,4,"%D",1,0)
If an associated form that is not a screen form, column is taken from the
"^DD",364.6,364.6,.03,1,4,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,4,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,4,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,4,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,4,"DT")
3000405
"^DD",364.6,364.6,.03,1,4,"FIELD")
STARTING COLUMN
"^DD",364.6,364.6,.03,1,5,0)
^^TRIGGER^364.6^.09
"^DD",364.6,364.6,.03,1,5,1)
X ^DD(364.6,.03,1,5,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,5,1.4)
"^DD",364.6,364.6,.03,1,5,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,5,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,5,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,9)=DIV,DIH=364.6,DIG=.09 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,5,2)
Q
"^DD",364.6,364.6,.03,1,5,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,5,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,5,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,5,"%D",1,0)
If an associated form that is not a screen form, length is taken from the
"^DD",364.6,364.6,.03,1,5,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,5,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,5,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,5,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,5,"DT")
3000405
"^DD",364.6,364.6,.03,1,5,"FIELD")
LENGTH
"^DD",364.6,364.6,.03,1,6,0)
^^TRIGGER^364.6^.06
"^DD",364.6,364.6,.03,1,6,1)
X ^DD(364.6,.03,1,6,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,6,1.4)
"^DD",364.6,364.6,.03,1,6,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,6,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,6,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,6)=DIV,DIH=364.6,DIG=.06 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,6,2)
Q
"^DD",364.6,364.6,.03,1,6,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,6,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,6,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,6,"%D",1,0)
If associated form that is not a screen form, the max number lines is taken
"^DD",364.6,364.6,.03,1,6,"%D",2,0)
from the associated with field definition.
"^DD",364.6,364.6,.03,1,6,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,6,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,6,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,6,"DT")
3000405
"^DD",364.6,364.6,.03,1,6,"FIELD")
MAX NUMBER LINES
"^DD",364.6,364.6,.03,1,7,0)
^^TRIGGER^364.6^.02
"^DD",364.6,364.6,.03,1,7,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X="L" X ^DD(364.6,.03,1,7,1.4)
"^DD",364.6,364.6,.03,1,7,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=364.6,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,7,2)
Q
"^DD",364.6,364.6,.03,1,7,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,7,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.03,1,7,"%D",1,0)
Only local entries can be associated.
"^DD",364.6,364.6,.03,1,7,"CREATE VALUE")
"L"
"^DD",364.6,364.6,.03,1,7,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,7,"DT")
2960117
"^DD",364.6,364.6,.03,1,7,"FIELD")
SECURITY LEVEL
"^DD",364.6,364.6,.03,3)
Enter the form definition record this definition will override.
"^DD",364.6,364.6,.03,5,1,0)
364.6^.01^4
"^DD",364.6,364.6,.03,21,0)
^^1^1^2960117^^
"^DD",364.6,364.6,.03,21,1,0)
The form definition record this definition will override.
"^DD",364.6,364.6,.03,"DT")
3000414
"^DD",364.6,364.6,.04,0)
PAGE OR SEQUENCE^FX^^0;4^K:$L(X)>20!($L(X)<1) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,2) K X
"^DD",364.6,364.6,.04,1,0)
^.1^^-1
"^DD",364.6,364.6,.04,1,1,0)
364.6^ASEQ1^MUMPS
"^DD",364.6,364.6,.04,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 S ^IBA(364.6,"ASEQ",Z1,$E(X,1,30),Z2,Z3,DA)=""
"^DD",364.6,364.6,.04,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 K ^IBA(364.6,"ASEQ",Z1,$E(X,1,30),Z2,Z3,DA)
"^DD",364.6,364.6,.04,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.04,1,1,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.04,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.04,1,1,"DT")
2960117
"^DD",364.6,364.6,.04,3)
This data must be 1-20 char long, can't be an assoc form, and must be a unique form/page/line/column.
"^DD",364.6,364.6,.04,5,1,0)
364.6^.03^2
"^DD",364.6,364.6,.04,21,0)
^^4^4^2960318^^^^
"^DD",364.6,364.6,.04,21,1,0)
This field is used to specify the page, section, transaction segment, etc.
"^DD",364.6,364.6,.04,21,2,0)
that the data element is to be associated with.  This field will be used as
"^DD",364.6,364.6,.04,21,3,0)
the second-level sort field when extracting data fields for this form.
"^DD",364.6,364.6,.04,21,4,0)
The combination of form/page/line/column must be unique.
"^DD",364.6,364.6,.04,"DT")
3000428
"^DD",364.6,364.6,.05,0)
FIRST LINE NUMBER^NJ4,0X^^0;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,3) K X
"^DD",364.6,364.6,.05,.1)
LINE
"^DD",364.6,364.6,.05,1,0)
^.1
"^DD",364.6,364.6,.05,1,1,0)
364.6^ASEQ2^MUMPS
"^DD",364.6,364.6,.05,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,8) I Z1,Z2'="",Z3 S ^IBA(364.6,"ASEQ",Z1,Z2,$E(X,1,30),Z3,DA)=""
"^DD",364.6,364.6,.05,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,8) I Z1,Z2'="",Z3 K ^IBA(364.6,"ASEQ",Z1,Z2,$E(X,1,30),Z3,DA)
"^DD",364.6,364.6,.05,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.05,1,1,"%D",0)
^^1^1^2960117^^^^
"^DD",364.6,364.6,.05,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.05,1,1,"DT")
2960117
"^DD",364.6,364.6,.05,3)
Type a # 0-9999, 0 Decimals, can't be assoc form, need unique form/pg/line/col.
"^DD",364.6,364.6,.05,5,1,0)
364.6^.03^3
"^DD",364.6,364.6,.05,21,0)
^^5^5^2960318^^^
"^DD",364.6,364.6,.05,21,1,0)
If this is a printed form, this is the first line number that this data
"^DD",364.6,364.6,.05,21,2,0)
element will appear on.  For transmitted forms, this is assumed to always
"^DD",364.6,364.6,.05,21,3,0)
be a 1.  This will be used as the third-level sort field when extracting
"^DD",364.6,364.6,.05,21,4,0)
data fields for this form.  The combination of form/page/line/column must
"^DD",364.6,364.6,.05,21,5,0)
be unique.
"^DD",364.6,364.6,.05,"DT")
3000428
"^DD",364.6,364.6,.06,0)
MAX NUMBER LINES^NJ3,0X^^0;6^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X I $D(X),$P($G(^IBA(364.6,DA,0)),U,3) K X
"^DD",364.6,364.6,.06,3)
Type a Number between 0 and 999, 0 Decimal Digits (can't be an associated form).
"^DD",364.6,364.6,.06,5,1,0)
364.6^.03^6
"^DD",364.6,364.6,.06,21,0)
^^2^2^2951205^
"^DD",364.6,364.6,.06,21,1,0)
If a printed form, this is the highest numbered line number that this data
"^DD",364.6,364.6,.06,21,2,0)
element is allowed to print on.
"^DD",364.6,364.6,.06,"DT")
2960117
"^DD",364.6,364.6,.07,0)
LOCAL OVERRIDE ALLOWED^S^0:NO;1:YES;^0;7^Q
"^DD",364.6,364.6,.07,3)
Enter 0 (NO) to prevent local override, 1 to allow local override.
"^DD",364.6,364.6,.07,21,0)
^.001^2^2^3020822^^
"^DD",364.6,364.6,.07,21,1,0)
This controls whether or not the output forms generator will allow for a
"^DD",364.6,364.6,.07,21,2,0)
redefinition of this record via a local override.
"^DD",364.6,364.6,.07,"DT")
2960311
"^DD",364.6,364.6,.08,0)
STARTING COLUMN OR PIECE^NJ3,1X^^0;8^K:+X'=X!(X>999)!(X<0)!($S(X[".":X'?.E1"."1.2N,1:0)) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,4) K X
"^DD",364.6,364.6,.08,.1)
COLUMN
"^DD",364.6,364.6,.08,1,0)
^.1
"^DD",364.6,364.6,.08,1,1,0)
364.6^ASEQ3^MUMPS
"^DD",364.6,364.6,.08,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,5) I Z1,Z2'="",Z3 S ^IBA(364.6,"ASEQ",Z1,Z2,Z3,$E(X,1,30),DA)=""
"^DD",364.6,364.6,.08,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,5) I Z1,Z2'="",Z3 K ^IBA(364.6,"ASEQ",Z1,Z2,Z3,$E(X,1,30),DA)
"^DD",364.6,364.6,.08,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.08,1,1,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.08,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.08,1,1,"DT")
2960117
"^DD",364.6,364.6,.08,1,2,0)
^^TRIGGER^364.6^.11
"^DD",364.6,364.6,.08,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0)["." I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,11),X=X S DIU=X K Y S X=DIV S X=1 X ^DD(364.6,.08,1,2,1.4)
"^DD",364.6,364.6,.08,1,2,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,11)=DIV,DIH=364.6,DIG=.11 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.08,1,2,2)
Q
"^DD",364.6,364.6,.08,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.08,1,2,"%D",0)
^^2^2^2960126^^^
"^DD",364.6,364.6,.08,1,2,"%D",1,0)
If the starting column or piece is not a whole number, this must be a
"^DD",364.6,364.6,.08,1,2,"%D",2,0)
calculate only field - no output.
"^DD",364.6,364.6,.08,1,2,"CREATE CONDITION")
STARTING COLUMN OR PIECE["."
"^DD",364.6,364.6,.08,1,2,"CREATE VALUE")
S X=1
"^DD",364.6,364.6,.08,1,2,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.08,1,2,"DT")
2960126
"^DD",364.6,364.6,.08,1,2,"FIELD")
#.11
"^DD",364.6,364.6,.08,3)
Type a # 0-9999, 1-2 Decimals, can't be assoc form, need unique form/pg/line/col.
"^DD",364.6,364.6,.08,5,1,0)
364.6^.03^4
"^DD",364.6,364.6,.08,21,0)
^^5^5^2960318^^^^
"^DD",364.6,364.6,.08,21,1,0)
This is the column on the form, position in the data string (for non-printed
"^DD",364.6,364.6,.08,21,2,0)
forms) -  starting at position 1, or delimited piece that this data element
"^DD",364.6,364.6,.08,21,3,0)
is to be printed or stored in.  This will be used as the fourth-level sort
"^DD",364.6,364.6,.08,21,4,0)
field when extracting data fields for this form.  The combination of
"^DD",364.6,364.6,.08,21,5,0)
form/page/line/column must be unique.
"^DD",364.6,364.6,.08,"DT")
3000428
"^DD",364.6,364.6,.09,0)
LENGTH^NJ3,0X^^0;9^K:+X'=X!(X>250)!(X<1)!(X?.E1"."1N.N) X I $D(X),$P($G(^IBA(364.6,DA,0)),U,3),$P($G(^IBE(353,+^IBA(364.6,DA,0),2)),U,2)'="S" K X
"^DD",364.6,364.6,.09,3)
Type a Number between 1 and 250, 0 Decimal Digits (can't be an associated form).
"^DD",364.6,364.6,.09,5,1,0)
364.6^.03^5
"^DD",364.6,364.6,.09,21,0)
^^3^3^2951205^
"^DD",364.6,364.6,.09,21,1,0)
The length desired for the data element.  If present, this field will be used
"^DD",364.6,364.6,.09,21,2,0)
to truncate or pad the data element to this length after the element has been
"^DD",364.6,364.6,.09,21,3,0)
passed through the routine identified in the FORMAT ROUTINE field.
"^DD",364.6,364.6,.09,"DT")
3000111
"^DD",364.6,364.6,.1,0)
SHORT DESCRIPTION^F^^0;10^K:$L(X)>40!($L(X)<1) X
"^DD",364.6,364.6,.1,3)
Answer must be 1-40 characters in length
"^DD",364.6,364.6,.1,21,0)
^^2^2^3071126^
"^DD",364.6,364.6,.1,21,1,0)
This is a short description of the field that is used as an identifier to
"^DD",364.6,364.6,.1,21,2,0)
make lookups on this file meaningful.
"^DD",364.6,364.6,.1,"DT")
3080310
"^DD",364.6,364.6,.11,0)
CALCULATE ONLY OR OUTPUT^S^1:CALCULATE ONLY;0:OUTPUT;^0;11^Q
"^DD",364.6,364.6,.11,3)
Enter 1 if this field is used for calculation purposes and is not meant to be output
"^DD",364.6,364.6,.11,5,1,0)
364.6^.08^2
"^DD",364.6,364.6,.11,21,0)
^^4^4^2960715^^^^
"^DD",364.6,364.6,.11,21,1,0)
This field is set to 1 if there is a need to do a special extract or
"^DD",364.6,364.6,.11,21,2,0)
calculation at some point in the processing, but no output is desired
"^DD",364.6,364.6,.11,21,3,0)
from the field's code execution.  Used to set up arrays for group elements
"^DD",364.6,364.6,.11,21,4,0)
then the individual elements are output separately.
"^DD",364.6,364.6,.11,"DT")
2960715
"^DD",364.6,364.6,.12,0)
TRANSMIT IGNORES IF NULL^S^0:FALSE;1:TRUE;^0;12^Q
"^DD",364.6,364.6,.12,3)
Enter 1 (TRUE) if there should be no entry made in the output global if the data value of the element is null.
"^DD",364.6,364.6,.12,21,0)
^.001^5^5^3001030^^^
"^DD",364.6,364.6,.12,21,1,0)
This field can be used to suppress output of a field if its value is null.
"^DD",364.6,364.6,.12,21,2,0)
If not suppressed, an entry is made in the output global used by the
"^DD",364.6,364.6,.12,21,3,0)
formatter, regardless of the contents of the data for this field.
"^DD",364.6,364.6,.12,21,4,0)
Supressing the value results in no output to the formatter's output
"^DD",364.6,364.6,.12,21,5,0)
global if the value of the data for this field is determined to be null.
"^DD",364.6,364.6,.12,"DT")
2991006
"^DD",364.6,364.6,.13,0)
DATA REQUIRED FOR FIELD^S^1:YES;0:NO;^0;13^Q
"^DD",364.6,364.6,.13,3)
Enter yes if there should always be data in this field.
"^DD",364.6,364.6,.13,21,0)
^^2^2^3000216^
"^DD",364.6,364.6,.13,21,1,0)
This field is a flag that will stop the output of a record if this field
"^DD",364.6,364.6,.13,21,2,0)
indicates data is required and the data extracted is null.
"^DD",364.6,364.6,.13,"DT")
3000216
"^DD",364.7,364.7,0)
FIELD^^3^12
"^DD",364.7,364.7,0,"DDA")
N
"^DD",364.7,364.7,0,"DT")
2960710
"^DD",364.7,364.7,0,"ID",.03)
S %I=Y,Y=$S('$D(^(0)):"",$D(^IBA(364.5,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(364.5,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",364.7,364.7,0,"IX","AINS",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINS1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINTYP1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP2",364.7,.06)

"^DD",364.7,364.7,0,"IX","ATYPE",364.7,.01)

"^DD",364.7,364.7,0,"IX","ATYPE1",364.7,.06)

"^DD",364.7,364.7,0,"IX","B",364.7,.01)

"^DD",364.7,364.7,0,"IX","C",364.7,.03)

"^DD",364.7,364.7,0,"NM","IB FORM FIELD CONTENT")
 
"^DD",364.7,364.7,0,"VRPK")
IB
"^DD",364.7,364.7,.01,0)
FORM FIELD REFERENCE^RP364.6'^IBA(364.6,^0;1^Q
"^DD",364.7,364.7,.01,1,0)
^.1
"^DD",364.7,364.7,.01,1,1,0)
364.7^B
"^DD",364.7,364.7,.01,1,1,1)
S ^IBA(364.7,"B",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.01,1,1,2)
K ^IBA(364.7,"B",$E(X,1,30),DA)
"^DD",364.7,364.7,.01,1,2,0)
364.7^ATYPE^MUMPS
"^DD",364.7,364.7,.01,1,2,1)
N Z1,Z0 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3),'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,2,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,2,"%D",0)
^^1^1^2980104^^^^
"^DD",364.7,364.7,.01,1,2,"%D",1,0)
Xref by form and bill type
"^DD",364.7,364.7,.01,1,2,"DT")
2960117
"^DD",364.7,364.7,.01,1,3,0)
364.7^AINTYP^MUMPS
"^DD",364.7,364.7,.01,1,3,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) S ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)=""
"^DD",364.7,364.7,.01,1,3,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)
"^DD",364.7,364.7,.01,1,3,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,3,"%D",0)
^^1^1^2971231^^^
"^DD",364.7,364.7,.01,1,3,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.01,1,3,"DT")
2960117
"^DD",364.7,364.7,.01,1,4,0)
364.7^AINS^MUMPS
"^DD",364.7,364.7,.01,1,4,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3),$P(Z0,U,6)="" S ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,4,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,4,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,4,"%D",0)
^^1^1^2971231^^
"^DD",364.7,364.7,.01,1,4,"%D",1,0)
Xref by form field and insurance company
"^DD",364.7,364.7,.01,1,4,"DT")
2960118
"^DD",364.7,364.7,.01,3)
Enter the billing form that this field is associated with
"^DD",364.7,364.7,.01,21,0)
^^2^2^2951207^^^^
"^DD",364.7,364.7,.01,21,1,0)
This is a pointer to the billing form field that this field is associated
"^DD",364.7,364.7,.01,21,2,0)
with.
"^DD",364.7,364.7,.01,"DT")
3000428
"^DD",364.7,364.7,.02,0)
SECURITY LEVEL^S^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^Q
"^DD",364.7,364.7,.02,3)
Enter N for nationally released fields (no edit) or L for locally added fields.
"^DD",364.7,364.7,.02,21,0)
^^3^3^2951219^^^
"^DD",364.7,364.7,.02,21,1,0)
This field determines whether or not editing of the entry is allowed.  For
"^DD",364.7,364.7,.02,21,2,0)
NATIONAL (N) field, no local editing is allowed.  If LOCAL (L) field is
"^DD",364.7,364.7,.02,21,3,0)
created, editing is allowed.
"^DD",364.7,364.7,.02,"DT")
3000428
"^DD",364.7,364.7,.03,0)
DATA ELEMENT^P364.5'^IBA(364.5,^0;3^Q
"^DD",364.7,364.7,.03,1,0)
^.1
"^DD",364.7,364.7,.03,1,1,0)
364.7^C
"^DD",364.7,364.7,.03,1,1,1)
S ^IBA(364.7,"C",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.03,1,1,2)
K ^IBA(364.7,"C",$E(X,1,30),DA)
"^DD",364.7,364.7,.03,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.03,1,1,"%D",0)
^^1^1^2960702^
"^DD",364.7,364.7,.03,1,1,"%D",1,0)
Xref by DATA ELEMENT NAME
"^DD",364.7,364.7,.03,1,1,"DT")
2960702
"^DD",364.7,364.7,.03,3)
Enter the data element that will define this form field.  If used on a screen, it must be a fileman type.
"^DD",364.7,364.7,.03,21,0)
^^1^1^2960627^^^^
"^DD",364.7,364.7,.03,21,1,0)
This identifies the data element that be extracted for this entry.
"^DD",364.7,364.7,.03,23,0)
^^4^4^2960627^^^^
"^DD",364.7,364.7,.03,23,1,0)
This is the data element that will be allowed to be displayed/edited on a
"^DD",364.7,364.7,.03,23,2,0)
screen, extracted for a transmit, or printed on a printed form.  If used on
"^DD",364.7,364.7,.03,23,3,0)
a screen, the data element must be a fileman type and a local field (>10000
"^DD",364.7,364.7,.03,23,4,0)
for ifn and on a node >10000) to be editable.
"^DD",364.7,364.7,.03,"DT")
2960702
"^DD",364.7,364.7,.04,0)
SCREEN PROMPT^FX^^0;4^K:$L(X)>70!($L(X)<1) X I $D(X),$P($G(^IBE(353,+$G(^IBA(364.6,+$G(^IBA(364.7,DA,0)),0)),2)),U,2)'="S" K X
"^DD",364.7,364.7,.04,.1)
 
"^DD",364.7,364.7,.04,1,0)
^.1^^0
"^DD",364.7,364.7,.04,3)
Answer must be 1-70 characters in length.
"^DD",364.7,364.7,.04,21,0)
3^^2^2^2960321^^^^
"^DD",364.7,364.7,.04,21,1,0)
This is used only by screen-type forms to place a prompt on the screen
"^DD",364.7,364.7,.04,21,2,0)
for a particular field.
"^DD",364.7,364.7,.04,23,0)
^^3^3^2960321^^^^
"^DD",364.7,364.7,.04,23,1,0)
This is the prompt that will preceed the data element defined for this
"^DD",364.7,364.7,.04,23,2,0)
entry.  If no data element, this prompt will display.  This field is only
"^DD",364.7,364.7,.04,23,3,0)
used for screen-type forms.
"^DD",364.7,364.7,.04,"DT")
2960321
"^DD",364.7,364.7,.05,0)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"^DD",364.7,364.7,.05,1,0)
^.1
"^DD",364.7,364.7,.05,1,1,0)
364.7^AINS1^MUMPS
"^DD",364.7,364.7,.05,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,$P(Z0,U,6)="" S ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.05,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA) I Z2'="",$D(^IBA(364.7,"AINTYP",Z1,X,Z2,DA)) S ^IBA(364.7,"ATYPE",Z1,Z2,DA)=""
"^DD",364.7,364.7,.05,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,1,"%D",0)
^^1^1^2960118^
"^DD",364.7,364.7,.05,1,1,"%D",1,0)
Xref by form field and insurance company.
"^DD",364.7,364.7,.05,1,1,"DT")
2960118
"^DD",364.7,364.7,.05,1,2,0)
364.7^AINTYP1^MUMPS
"^DD",364.7,364.7,.05,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) I Z1,Z2'="" S ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)="" K ^IBA(364.7,"ATYPE",Z1,Z2,DA),^IBA(364.7,"AINS",Z1,X,DA)
"^DD",364.7,364.7,.05,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K:Z1&(Z2'="") ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)
"^DD",364.7,364.7,.05,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.05,1,2,"%D",1,0)
Xref by insurance company and bill type
"^DD",364.7,364.7,.05,1,2,"DT")
2960117
"^DD",364.7,364.7,.05,3)
Enter the name of the insurance company that this field is associated with.
"^DD",364.7,364.7,.05,21,0)
^^2^2^2951207^
"^DD",364.7,364.7,.05,21,1,0)
This is the insurance company who has a need for other than the standard
"^DD",364.7,364.7,.05,21,2,0)
data in this field.
"^DD",364.7,364.7,.05,"DT")
3000428
"^DD",364.7,364.7,.06,0)
BILL TYPE^S^I:INPATIENT;O:OUTPATIENT;^0;6^Q
"^DD",364.7,364.7,.06,1,0)
^.1
"^DD",364.7,364.7,.06,1,1,0)
364.7^ATYPE1^MUMPS
"^DD",364.7,364.7,.06,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1 K ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA) I Z2,$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) S ^IBA(364.7,"AINS",Z1,Z2,DA)=""
"^DD",364.7,364.7,.06,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,1,"%D",0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,1,1,"%D",1,0)
Xref by form and bill type.
"^DD",364.7,364.7,.06,1,1,"DT")
2960117
"^DD",364.7,364.7,.06,1,2,0)
364.7^AINTYP2^MUMPS
"^DD",364.7,364.7,.06,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1,Z2 K:'$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) ^IBA(364.7,"AINS",Z1,Z2,DA) S ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) K:Z1&Z2 ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)
"^DD",364.7,364.7,.06,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.06,1,2,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.06,1,2,"DT")
2960117
"^DD",364.7,364.7,.06,3)
Enter the type of the bill.
"^DD",364.7,364.7,.06,21,0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,21,1,0)
This is the type of bill that requires this field.
"^DD",364.7,364.7,.06,"DT")
3000428
"^DD",364.7,364.7,.07,0)
PAD CHARACTER^S^ZL:ZERO PAD ON LEFT;ZR:ZERO PAD ON RIGHT;SL:SPACE PAD ON LEFT;SR:SPACE PAD ON RIGHT;N:NO PAD REQUIRED;^0;7^Q
"^DD",364.7,364.7,.07,3)
Enter the code that corresponds to the format and pad character to use for the data output in this field.
"^DD",364.7,364.7,.07,21,0)
^^3^3^2960126^^
"^DD",364.7,364.7,.07,21,1,0)
If present, this defines the character to be used to pad the DATA
"^DD",364.7,364.7,.07,21,2,0)
ELEMENT to its desired length and the orientation of the padding characters
"^DD",364.7,364.7,.07,21,3,0)
to the left or right of the data.  The default is space pad to the right.
"^DD",364.7,364.7,.07,"DT")
2960126
"^DD",364.7,364.7,.08,0)
REQUIRED^S^0:NO;1:YES;^0;8^Q
"^DD",364.7,364.7,.08,3)
Enter 1 (YES) if this data element is on a local screen 9 form and the data is required for the bill to be authorized.
"^DD",364.7,364.7,.08,21,0)
^.001^4^4^3001030^^
"^DD",364.7,364.7,.08,21,1,0)
This field controls the required/not required status of a data element
"^DD",364.7,364.7,.08,21,2,0)
on a local screen 9 form.  If this field is 1 (YES), this data element
"^DD",364.7,364.7,.08,21,3,0)
is always required to have data (not null) in order for a bill to be
"^DD",364.7,364.7,.08,21,4,0)
authorized.
"^DD",364.7,364.7,.08,"DT")
2951207
"^DD",364.7,364.7,.09,0)
EDIT STATUS^S^E:EDITABLE;D:DISPLAY ONLY;^0;9^Q
"^DD",364.7,364.7,.09,3)
Enter 'E' to enable editing for this field, 'D' for a display only field.
"^DD",364.7,364.7,.09,21,0)
^^2^2^2960320^
"^DD",364.7,364.7,.09,21,1,0)
This field is used to control whether or not a data element on a screen is
"^DD",364.7,364.7,.09,21,2,0)
editable or for display-only purposes.
"^DD",364.7,364.7,.09,"DT")
2960320
"^DD",364.7,364.7,.1,0)
EDIT GROUP NUMBER^NJ2,0^^0;10^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",364.7,364.7,.1,3)
 Enter the edit group # that this field will be included in.  Valid #'s are 1-99.
"^DD",364.7,364.7,.1,21,0)
^^6^6^2960321^^
"^DD",364.7,364.7,.1,21,1,0)
This field contains the # of the edit group that the screen data element
"^DD",364.7,364.7,.1,21,2,0)
will be included with.  When this group # is selected on an edit screen,
"^DD",364.7,364.7,.1,21,3,0)
all data elements assigned to this group # on this screen will be presented
"^DD",364.7,364.7,.1,21,4,0)
for editing.  If no # is entered here, this field will not be available for
"^DD",364.7,364.7,.1,21,5,0)
editing.  This field will only apply to screen-type forms' editable data
"^DD",364.7,364.7,.1,21,6,0)
element descriptions.
"^DD",364.7,364.7,.1,"DT")
2960321
"^DD",364.7,364.7,1,0)
FORMAT CODE^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",364.7,364.7,1,3)
This is Standard MUMPS code.
"^DD",364.7,364.7,1,9)
@
"^DD",364.7,364.7,1,21,0)
^^8^8^2951207^
"^DD",364.7,364.7,1,21,1,0)
This is the code that will be xecuted to format the 'raw' data element
"^DD",364.7,364.7,1,21,2,0)
value that is returned from the execution of the DATA ELEMENT's definition.
"^DD",364.7,364.7,1,21,3,0)
This code can assume the variable/array IBXDATA is available as input and
"^DD",364.7,364.7,1,21,4,0)
should set this variable/array as its output.  Standard calls for data
"^DD",364.7,364.7,1,21,5,0)
formatting have been provided.  The variables IBXPG, IBXLN, IBXCOL are the
"^DD",364.7,364.7,1,21,6,0)
only IBX* variables that should be changed in this routine.  These represent
"^DD",364.7,364.7,1,21,7,0)
the page, line, column as the first 3 levels of subscript for the output
"^DD",364.7,364.7,1,21,8,0)
array.
"^DD",364.7,364.7,1,"DT")
2951207
"^DD",364.7,364.7,3,0)
FORMAT CODE DESCRIPTION^364.73^^3;0
"^DD",364.7,364.7,3,21,0)
^.001^1^1^3010102^^
"^DD",364.7,364.7,3,21,1,0)
This field describes the function of the format code entered.
"^DD",364.7,364.7,3,"DT")
2960710
"^DD",364.7,364.73,0)
FORMAT CODE DESCRIPTION SUB-FIELD^^.01^1
"^DD",364.7,364.73,0,"DT")
2960710
"^DD",364.7,364.73,0,"NM","FORMAT CODE DESCRIPTION")
 
"^DD",364.7,364.73,0,"UP")
364.7
"^DD",364.7,364.73,.01,0)
FORMAT CODE DESCRIPTION^W^^0;1^Q
"^DD",364.7,364.73,.01,3)
Enter a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,21,0)
^.001^1^1^3010102^^^^
"^DD",364.7,364.73,.01,21,1,0)
This is a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,"DT")
2960710
"^DIC",350.8,350.8,0)
IB ERROR
"^DIC",350.8,350.8,0,"GL")
^IBE(350.8,
"^DIC",350.8,350.8,"%D",0)
^^11^11^2940214^^^^
"^DIC",350.8,350.8,"%D",1,0)
This file contains errors for billing functions.  It may be used by
"^DIC",350.8,350.8,"%D",2,0)
applications, IB or AR.  The normal format for a routine to return
"^DIC",350.8,350.8,"%D",3,0)
an error is to return the variable:
"^DIC",350.8,350.8,"%D",4,0)
  Y=1^... a successful event occured
"^DIC",350.8,350.8,"%D",5,0)
  Y=-1^error code[;error code;error code...]^additional text
"^DIC",350.8,350.8,"%D",6,0)
The error messages can be displayed by calling routine ^IBAERR.  If
"^DIC",350.8,350.8,"%D",7,0)
the error occurs in a tasked job ($D(ZTQUEUED)'=0) the routine will
"^DIC",350.8,350.8,"%D",8,0)
put the error message in a bulletin and post it to the group defined
"^DIC",350.8,350.8,"%D",9,0)
in the IB SITE PARAMETER FILE.
"^DIC",350.8,350.8,"%D",10,0)
 
"^DIC",350.8,350.8,"%D",11,0)
Per VHA Directive 10-93-142, this file definition should not be modified.
"^DIC",350.8,"B","IB ERROR",350.8)

"^DIC",364.6,364.6,0)
IB FORM SKELETON DEFINITION^364.6P
"^DIC",364.6,364.6,0,"GL")
^IBA(364.6,
"^DIC",364.6,364.6,"%D",0)
^^10^10^2970606^^^^
"^DIC",364.6,364.6,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.6,364.6,"%D",2,0)
 
"^DIC",364.6,364.6,"%D",3,0)
This file contains records that define the skeleton makeup of forms for
"^DIC",364.6,364.6,"%D",4,0)
the IB system.  This definition includes the absolute position of every
"^DIC",364.6,364.6,"%D",5,0)
field that can be output on the form, the length each field must be limited
"^DIC",364.6,364.6,"%D",6,0)
to, and some descriptive information.   This includes printed forms,
"^DIC",364.6,364.6,"%D",7,0)
transmittable output files, and special local billing screens.
"^DIC",364.6,364.6,"%D",8,0)
 
"^DIC",364.6,364.6,"%D",9,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.6,364.6,"%D",10,0)
NATIONAL should not be deleted or edited.
"^DIC",364.6,"B","IB FORM SKELETON DEFINITION",364.6)

"^DIC",364.7,364.7,0)
IB FORM FIELD CONTENT^364.7P
"^DIC",364.7,364.7,0,"GL")
^IBA(364.7,
"^DIC",364.7,364.7,"%D",0)
^1.001^9^9^3030331^^^^
"^DIC",364.7,364.7,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.7,364.7,"%D",2,0)
 
"^DIC",364.7,364.7,"%D",3,0)
This is the file that contains the specific fields to be used to produce
"^DIC",364.7,364.7,"%D",4,0)
the associated form or screen.  If there is no insurance company or bill
"^DIC",364.7,364.7,"%D",5,0)
type specified for an entry, this is assumed to be the default definition
"^DIC",364.7,364.7,"%D",6,0)
of the field.
"^DIC",364.7,364.7,"%D",7,0)
 
"^DIC",364.7,364.7,"%D",8,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.7,364.7,"%D",9,0)
NATIONAL should not be deleted or edited.
"^DIC",364.7,"B","IB FORM FIELD CONTENT",364.7)

"BLD",7241,6)
^375
**END**
**END**
