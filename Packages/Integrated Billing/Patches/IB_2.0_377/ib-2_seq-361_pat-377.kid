Released IB*2*377 SEQ #361
Extracted from mail message
**KIDS**:IB*2.0*377^

**INSTALL NAME**
IB*2.0*377
"BLD",6801,0)
IB*2.0*377^INTEGRATED BILLING^0^3080417^y
"BLD",6801,1,0)
^^1^1^3080314^
"BLD",6801,1,1,0)
eClaims Plus Iteration 3, phase 2
"BLD",6801,4,0)
^9.64PA^350.8^10
"BLD",6801,4,2,0)
2
"BLD",6801,4,2,2,0)
^9.641^2.312^1
"BLD",6801,4,2,2,2.312,0)
INSURANCE TYPE  (sub-file)
"BLD",6801,4,2,2,2.312,1,0)
^9.6411^17^3
"BLD",6801,4,2,2,2.312,1,4.03,0)
PT. RELATIONSHIP - HIPAA
"BLD",6801,4,2,2,2.312,1,16,0)
PT. RELATIONSHIP TO INSURED
"BLD",6801,4,2,2,2.312,1,17,0)
NAME OF INSURED
"BLD",6801,4,2,222)
y^y^p^^^^n^^n
"BLD",6801,4,2,224)

"BLD",6801,4,350.8,0)
350.8
"BLD",6801,4,350.8,222)
n^n^f^^n^^y^o^n
"BLD",6801,4,350.8,224)
I $F(".IB123.IB172.IB173.","."_$P($G(^IBE(350.8,+Y,0)),U,1)_".")
"BLD",6801,4,350.9,0)
350.9
"BLD",6801,4,350.9,2,0)
^9.641^350.9^1
"BLD",6801,4,350.9,2,350.9,0)
IB SITE PARAMETERS  (File-top level)
"BLD",6801,4,350.9,2,350.9,1,0)
^9.6411^1.04^1
"BLD",6801,4,350.9,2,350.9,1,1.04,0)
REMARKS TO APPEAR ON EACH FORM
"BLD",6801,4,350.9,222)
y^y^p^^^^n^^n
"BLD",6801,4,350.9,224)

"BLD",6801,4,355.33,0)
355.33
"BLD",6801,4,355.33,2,0)
^9.641^355.33^1
"BLD",6801,4,355.33,2,355.33,0)
INSURANCE BUFFER  (File-top level)
"BLD",6801,4,355.33,2,355.33,1,0)
^9.6411^60.14^2
"BLD",6801,4,355.33,2,355.33,1,60.06,0)
PT. RELATIONSHIP TO INSURED
"BLD",6801,4,355.33,2,355.33,1,60.14,0)
PT. RELATIONSHIP - HIPAA
"BLD",6801,4,355.33,222)
y^y^p^^^^n^^n
"BLD",6801,4,355.33,224)

"BLD",6801,4,356,0)
356
"BLD",6801,4,356,2,0)
^9.641^356^1
"BLD",6801,4,356,2,356,0)
CLAIMS TRACKING  (File-top level)
"BLD",6801,4,356,2,356,1,0)
^9.6411^1.08^1
"BLD",6801,4,356,2,356,1,1.08,0)
ADDITIONAL COMMENT
"BLD",6801,4,356,222)
y^y^p^^^^n^^n
"BLD",6801,4,356,224)

"BLD",6801,4,361.1,0)
361.1
"BLD",6801,4,361.1,2,0)
^9.641^361.1^1
"BLD",6801,4,361.1,2,361.1,0)
EXPLANATION OF BENEFITS  (File-top level)
"BLD",6801,4,361.1,2,361.1,1,0)
^9.6411^62.01^3
"BLD",6801,4,361.1,2,361.1,1,6.03,0)
CORRECTED DATA MESSAGE
"BLD",6801,4,361.1,2,361.1,1,61.01,0)
ORIGINAL 06 RECORD DATA
"BLD",6801,4,361.1,2,361.1,1,62.01,0)
MAILMAN HEADER INFORMATION
"BLD",6801,4,361.1,222)
y^y^p^^^^n^^n
"BLD",6801,4,361.1,224)

"BLD",6801,4,364.5,0)
364.5
"BLD",6801,4,364.5,222)
n^n^f^^y^^y^o^n
"BLD",6801,4,364.5,224)
I $$INCLUDE^IBY377PR(5,Y)
"BLD",6801,4,364.6,0)
364.6
"BLD",6801,4,364.6,222)
y^n^f^^y^^y^o^n
"BLD",6801,4,364.6,224)
I $$INCLUDE^IBY377PR(6,Y)
"BLD",6801,4,364.7,0)
364.7
"BLD",6801,4,364.7,222)
n^n^f^^y^^y^o^n
"BLD",6801,4,364.7,224)
I $$INCLUDE^IBY377PR(7,Y)
"BLD",6801,4,399,0)
399
"BLD",6801,4,399,2,0)
^9.641^399.042^3
"BLD",6801,4,399,2,399,0)
BILL/CLAIMS  (File-top level)
"BLD",6801,4,399,2,399,1,0)
^9.6411^28.1^1
"BLD",6801,4,399,2,399,1,28.1,0)
MRA REVIEW STATUS
"BLD",6801,4,399,2,399.042,0)
REVENUE CODE  (sub-file)
"BLD",6801,4,399,2,399.042,1,0)
^9.6411^.09^1
"BLD",6801,4,399,2,399.042,1,.09,0)
NON-COVERED CHARGE
"BLD",6801,4,399,2,399.077,0)
MRA REQUEST CLAIM COMMENTS  (sub-file)
"BLD",6801,4,399,2,399.077,1,0)
^9.6411^^0
"BLD",6801,4,399,222)
y^y^p^^^^n^^n
"BLD",6801,4,399,224)

"BLD",6801,4,"APDD",2,2.312)

"BLD",6801,4,"APDD",2,2.312,4.03)

"BLD",6801,4,"APDD",2,2.312,16)

"BLD",6801,4,"APDD",2,2.312,17)

"BLD",6801,4,"APDD",350.9,350.9)

"BLD",6801,4,"APDD",350.9,350.9,1.04)

"BLD",6801,4,"APDD",355.33,355.33)

"BLD",6801,4,"APDD",355.33,355.33,60.06)

"BLD",6801,4,"APDD",355.33,355.33,60.14)

"BLD",6801,4,"APDD",356,356)

"BLD",6801,4,"APDD",356,356,1.08)

"BLD",6801,4,"APDD",361.1,361.1)

"BLD",6801,4,"APDD",361.1,361.1,6.03)

"BLD",6801,4,"APDD",361.1,361.1,61.01)

"BLD",6801,4,"APDD",361.1,361.1,62.01)

"BLD",6801,4,"APDD",399,399)

"BLD",6801,4,"APDD",399,399,28.1)

"BLD",6801,4,"APDD",399,399.042)

"BLD",6801,4,"APDD",399,399.042,.09)

"BLD",6801,4,"APDD",399,399.077)

"BLD",6801,4,"B",2,2)

"BLD",6801,4,"B",350.8,350.8)

"BLD",6801,4,"B",350.9,350.9)

"BLD",6801,4,"B",355.33,355.33)

"BLD",6801,4,"B",356,356)

"BLD",6801,4,"B",361.1,361.1)

"BLD",6801,4,"B",364.5,364.5)

"BLD",6801,4,"B",364.6,364.6)

"BLD",6801,4,"B",364.7,364.7)

"BLD",6801,4,"B",399,399)

"BLD",6801,6.3)
23
"BLD",6801,"ABPKG")
n
"BLD",6801,"INI")
IBY377PR
"BLD",6801,"INID")
^y^y
"BLD",6801,"INIT")
IBY377PO
"BLD",6801,"KRN",0)
^9.67PA^8989.52^19
"BLD",6801,"KRN",.4,0)
.4
"BLD",6801,"KRN",.4,"NM",0)
^9.68A^^
"BLD",6801,"KRN",.401,0)
.401
"BLD",6801,"KRN",.402,0)
.402
"BLD",6801,"KRN",.402,"NM",0)
^9.68A^4^4
"BLD",6801,"KRN",.402,"NM",1,0)
IBCN PATIENT INSURANCE    FILE #2^2^0
"BLD",6801,"KRN",.402,"NM",2,0)
IB SCREEN7    FILE #399^399^0
"BLD",6801,"KRN",.402,"NM",3,0)
IB SCREEN82    FILE #399^399^0
"BLD",6801,"KRN",.402,"NM",4,0)
IB SCREEN8H    FILE #399^399^0
"BLD",6801,"KRN",.402,"NM","B","IB SCREEN7    FILE #399",2)

"BLD",6801,"KRN",.402,"NM","B","IB SCREEN82    FILE #399",3)

"BLD",6801,"KRN",.402,"NM","B","IB SCREEN8H    FILE #399",4)

"BLD",6801,"KRN",.402,"NM","B","IBCN PATIENT INSURANCE    FILE #2",1)

"BLD",6801,"KRN",.403,0)
.403
"BLD",6801,"KRN",.5,0)
.5
"BLD",6801,"KRN",.84,0)
.84
"BLD",6801,"KRN",3.6,0)
3.6
"BLD",6801,"KRN",3.8,0)
3.8
"BLD",6801,"KRN",9.2,0)
9.2
"BLD",6801,"KRN",9.8,0)
9.8
"BLD",6801,"KRN",9.8,"NM",0)
^9.68A^43^42
"BLD",6801,"KRN",9.8,"NM",1,0)
IBCEXTRP^^0^B44709750
"BLD",6801,"KRN",9.8,"NM",2,0)
IBJPS^^0^B5270103
"BLD",6801,"KRN",9.8,"NM",3,0)
IBJPS2^^0^B47271248
"BLD",6801,"KRN",9.8,"NM",4,0)
IBCSC3^^0^B37249647
"BLD",6801,"KRN",9.8,"NM",5,0)
IBCNSP1^^0^B59835347
"BLD",6801,"KRN",9.8,"NM",6,0)
IBCNSP01^^0^B32701738
"BLD",6801,"KRN",9.8,"NM",7,0)
IBCEBUL^^0^B14688365
"BLD",6801,"KRN",9.8,"NM",8,0)
IBCERP3^^0^B24573380
"BLD",6801,"KRN",9.8,"NM",9,0)
IBCNBEE^^0^B44866934
"BLD",6801,"KRN",9.8,"NM",10,0)
IBCNQ^^0^B25492974
"BLD",6801,"KRN",9.8,"NM",11,0)
IBCEF73^^0^B59655554
"BLD",6801,"KRN",9.8,"NM",12,0)
IBCEFG1^^0^B23263677
"BLD",6801,"KRN",9.8,"NM",13,0)
IBCEDS^^0^B75763086
"BLD",6801,"KRN",9.8,"NM",14,0)
IBCEDS1^^0^B30639639
"BLD",6801,"KRN",9.8,"NM",15,0)
IBCEDC^^0^B29467886
"BLD",6801,"KRN",9.8,"NM",16,0)
IBCEDP^^0^B32525754
"BLD",6801,"KRN",9.8,"NM",17,0)
IBCECOB6^^0^B23813020
"BLD",6801,"KRN",9.8,"NM",18,0)
IBCC1^^0^B38579110
"BLD",6801,"KRN",9.8,"NM",19,0)
IBCECOB1^^0^B68510086
"BLD",6801,"KRN",9.8,"NM",20,0)
IBCEMCA2^^0^B19841299
"BLD",6801,"KRN",9.8,"NM",21,0)
IBTOBI1^^0^B18898112
"BLD",6801,"KRN",9.8,"NM",22,0)
IBJTTC^^0^B21337725
"BLD",6801,"KRN",9.8,"NM",23,0)
IBJTA1^^0^B18194531
"BLD",6801,"KRN",9.8,"NM",24,0)
IBCE835^^0^B38860252
"BLD",6801,"KRN",9.8,"NM",25,0)
IBCEOB^^0^B58527801
"BLD",6801,"KRN",9.8,"NM",26,0)
IBCEOB00^^0^B75423000
"BLD",6801,"KRN",9.8,"NM",27,0)
IBCEOB01^^0^B24417822
"BLD",6801,"KRN",9.8,"NM",28,0)
IBCBB3^^0^B47525889
"BLD",6801,"KRN",9.8,"NM",29,0)
IBCECSA3^^0^B42335133
"BLD",6801,"KRN",9.8,"NM",30,0)
IBCE837A^^0^B49945293
"BLD",6801,"KRN",9.8,"NM",31,0)
IBCEP82^^0^B31460736
"BLD",6801,"KRN",9.8,"NM",32,0)
IBCEP6^^0^B19310181
"BLD",6801,"KRN",9.8,"NM",33,0)
IBCEP8^^0^B80393448
"BLD",6801,"KRN",9.8,"NM",35,0)
IBCEPA^^0^B57987337
"BLD",6801,"KRN",9.8,"NM",36,0)
IBCEP4^^0^B23601105
"BLD",6801,"KRN",9.8,"NM",37,0)
IBCEP4A^^0^B54389720
"BLD",6801,"KRN",9.8,"NM",38,0)
IBCBB^^0^B71092497
"BLD",6801,"KRN",9.8,"NM",39,0)
IBCBB0^^0^B3028781
"BLD",6801,"KRN",9.8,"NM",40,0)
IBCNADD^^0^B6555779
"BLD",6801,"KRN",9.8,"NM",41,0)
IBCEP0A^^0^B41455887
"BLD",6801,"KRN",9.8,"NM",42,0)
IBCEP5^^0^B48717212
"BLD",6801,"KRN",9.8,"NM",43,0)
IBCEP0^^0^B72988183
"BLD",6801,"KRN",9.8,"NM","B","IBCBB",38)

"BLD",6801,"KRN",9.8,"NM","B","IBCBB0",39)

"BLD",6801,"KRN",9.8,"NM","B","IBCBB3",28)

"BLD",6801,"KRN",9.8,"NM","B","IBCC1",18)

"BLD",6801,"KRN",9.8,"NM","B","IBCE835",24)

"BLD",6801,"KRN",9.8,"NM","B","IBCE837A",30)

"BLD",6801,"KRN",9.8,"NM","B","IBCEBUL",7)

"BLD",6801,"KRN",9.8,"NM","B","IBCECOB1",19)

"BLD",6801,"KRN",9.8,"NM","B","IBCECOB6",17)

"BLD",6801,"KRN",9.8,"NM","B","IBCECSA3",29)

"BLD",6801,"KRN",9.8,"NM","B","IBCEDC",15)

"BLD",6801,"KRN",9.8,"NM","B","IBCEDP",16)

"BLD",6801,"KRN",9.8,"NM","B","IBCEDS",13)

"BLD",6801,"KRN",9.8,"NM","B","IBCEDS1",14)

"BLD",6801,"KRN",9.8,"NM","B","IBCEF73",11)

"BLD",6801,"KRN",9.8,"NM","B","IBCEFG1",12)

"BLD",6801,"KRN",9.8,"NM","B","IBCEMCA2",20)

"BLD",6801,"KRN",9.8,"NM","B","IBCEOB",25)

"BLD",6801,"KRN",9.8,"NM","B","IBCEOB00",26)

"BLD",6801,"KRN",9.8,"NM","B","IBCEOB01",27)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP0",43)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP0A",41)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP4",36)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP4A",37)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP5",42)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP6",32)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP8",33)

"BLD",6801,"KRN",9.8,"NM","B","IBCEP82",31)

"BLD",6801,"KRN",9.8,"NM","B","IBCEPA",35)

"BLD",6801,"KRN",9.8,"NM","B","IBCERP3",8)

"BLD",6801,"KRN",9.8,"NM","B","IBCEXTRP",1)

"BLD",6801,"KRN",9.8,"NM","B","IBCNADD",40)

"BLD",6801,"KRN",9.8,"NM","B","IBCNBEE",9)

"BLD",6801,"KRN",9.8,"NM","B","IBCNQ",10)

"BLD",6801,"KRN",9.8,"NM","B","IBCNSP01",6)

"BLD",6801,"KRN",9.8,"NM","B","IBCNSP1",5)

"BLD",6801,"KRN",9.8,"NM","B","IBCSC3",4)

"BLD",6801,"KRN",9.8,"NM","B","IBJPS",2)

"BLD",6801,"KRN",9.8,"NM","B","IBJPS2",3)

"BLD",6801,"KRN",9.8,"NM","B","IBJTA1",23)

"BLD",6801,"KRN",9.8,"NM","B","IBJTTC",22)

"BLD",6801,"KRN",9.8,"NM","B","IBTOBI1",21)

"BLD",6801,"KRN",19,0)
19
"BLD",6801,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",6801,"KRN",19,"NM",1,0)
IBCE BATCHES PENDING TOO LONG^^0
"BLD",6801,"KRN",19,"NM",2,0)
IBCE TXMT MGMNT REPORTS^^2
"BLD",6801,"KRN",19,"NM",3,0)
IBCE BATCH STATUS DETAIL^^1^
"BLD",6801,"KRN",19,"NM",4,0)
IBCED EDI CLAIM STATUS REPORT^^0
"BLD",6801,"KRN",19,"NM","B","IBCE BATCH STATUS DETAIL",3)

"BLD",6801,"KRN",19,"NM","B","IBCE BATCHES PENDING TOO LONG",1)

"BLD",6801,"KRN",19,"NM","B","IBCE TXMT MGMNT REPORTS",2)

"BLD",6801,"KRN",19,"NM","B","IBCED EDI CLAIM STATUS REPORT",4)

"BLD",6801,"KRN",19.1,0)
19.1
"BLD",6801,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6801,"KRN",101,0)
101
"BLD",6801,"KRN",101,"NM",0)
^9.68A^51^47
"BLD",6801,"KRN",101,"NM",1,0)
IBCEM ENTER COMMENTS^^0
"BLD",6801,"KRN",101,"NM",2,0)
IBCEM VIEW COMMENTS^^0
"BLD",6801,"KRN",101,"NM",3,0)
IBCEM COB MANAGEMENT^^2
"BLD",6801,"KRN",101,"NM",4,0)
IBCEM COB COMMENTS^^0
"BLD",6801,"KRN",101,"NM",5,0)
IBCEM MRA STATUS^^0
"BLD",6801,"KRN",101,"NM",9,0)
IBCEM ENTER COMMENTS 1^^0
"BLD",6801,"KRN",101,"NM",10,0)
VALM QUIT^^0
"BLD",6801,"KRN",101,"NM",12,0)
IBJT AR COMMENT ADD^^0
"BLD",6801,"KRN",101,"NM",13,0)
IBCE PRVMAINT^^1^
"BLD",6801,"KRN",101,"NM",14,0)
IBCE PRVMAINT ACTION^^1^
"BLD",6801,"KRN",101,"NM",15,0)
IBCE PRVPRV MAINT^^0
"BLD",6801,"KRN",101,"NM",16,0)
IBCE PRVNUM ADD^^0
"BLD",6801,"KRN",101,"NM",17,0)
IBCE PRVNUM EDIT^^0
"BLD",6801,"KRN",101,"NM",18,0)
IBCE PRVNUM DELETE^^0
"BLD",6801,"KRN",101,"NM",19,0)
IBCE EXIT^^0
"BLD",6801,"KRN",101,"NM",20,0)
IBCE PRVINS ID^^0
"BLD",6801,"KRN",101,"NM",21,0)
IBCE PRVINS JUMP^^0
"BLD",6801,"KRN",101,"NM",22,0)
IBCE PRVINS ADD^^0
"BLD",6801,"KRN",101,"NM",23,0)
IBCE PRVINS DELETE^^0
"BLD",6801,"KRN",101,"NM",24,0)
IBCE PRVCARE UNIT MAINT^^0
"BLD",6801,"KRN",101,"NM",25,0)
IBCE PRVINS CHG INS^^0
"BLD",6801,"KRN",101,"NM",26,0)
IBCE PRVINS EDIT^^0
"BLD",6801,"KRN",101,"NM",27,0)
IBCE PRVINS DISPLAY PARAMS^^0
"BLD",6801,"KRN",101,"NM",28,0)
IBCE PRVINS CHG FORMAT^^0
"BLD",6801,"KRN",101,"NM",29,0)
IBCE PRVCARE UNIT MENU^^0
"BLD",6801,"KRN",101,"NM",30,0)
IBCE PRVCARE ADD^^0
"BLD",6801,"KRN",101,"NM",31,0)
IBCE PRVCARE EDIT^^0
"BLD",6801,"KRN",101,"NM",32,0)
IBCE PRVCARE DELETE^^0
"BLD",6801,"KRN",101,"NM",33,0)
IBCE 2ND PRVCARE MENU^^0
"BLD",6801,"KRN",101,"NM",34,0)
IBCE 2ND PRVCARE ADD^^0
"BLD",6801,"KRN",101,"NM",35,0)
IBCE 2ND PRVCARE EDIT^^0
"BLD",6801,"KRN",101,"NM",36,0)
IBCE 2ND PRVCARE DELETE^^0
"BLD",6801,"KRN",101,"NM",37,0)
IBCE PRVNVA MAINT^^0
"BLD",6801,"KRN",101,"NM",38,0)
IBCE PRVNVA NP PI^^0
"BLD",6801,"KRN",101,"NM",39,0)
IBCE PRVNVA NP PO^^0
"BLD",6801,"KRN",101,"NM",40,0)
IBCE PRVNVA DEMOG^^0
"BLD",6801,"KRN",101,"NM",41,0)
IBCE PRVNVA IDS^^1^
"BLD",6801,"KRN",101,"NM",42,0)
IBCE PRVNVA NONIND MAINT^^0
"BLD",6801,"KRN",101,"NM",43,0)
IBCE PRVNVA NF LI^^0
"BLD",6801,"KRN",101,"NM",44,0)
IBCE PRVNVA NF LO^^0
"BLD",6801,"KRN",101,"NM",45,0)
IBCE PRVNVA PROVINFO^^0
"BLD",6801,"KRN",101,"NM",46,0)
IBCE PRVNVA SECIDS^^1^
"BLD",6801,"KRN",101,"NM",47,0)
IBCE PRVNVA LOF MAINT^^0
"BLD",6801,"KRN",101,"NM",48,0)
IBCE PRVNVA LOF ADD^^0
"BLD",6801,"KRN",101,"NM",49,0)
IBCE PRVNVA LOF EDIT^^0
"BLD",6801,"KRN",101,"NM",50,0)
IBCE PRVNVA LOF DELETE^^0
"BLD",6801,"KRN",101,"NM",51,0)
VALM BLANK 1^^0
"BLD",6801,"KRN",101,"NM","B","IBCE 2ND PRVCARE ADD",34)

"BLD",6801,"KRN",101,"NM","B","IBCE 2ND PRVCARE DELETE",36)

"BLD",6801,"KRN",101,"NM","B","IBCE 2ND PRVCARE EDIT",35)

"BLD",6801,"KRN",101,"NM","B","IBCE 2ND PRVCARE MENU",33)

"BLD",6801,"KRN",101,"NM","B","IBCE EXIT",19)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVCARE ADD",30)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVCARE DELETE",32)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVCARE EDIT",31)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVCARE UNIT MAINT",24)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVCARE UNIT MENU",29)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS ADD",22)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS CHG FORMAT",28)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS CHG INS",25)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS DELETE",23)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS DISPLAY PARAMS",27)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS EDIT",26)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS ID",20)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVINS JUMP",21)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVMAINT",13)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVMAINT ACTION",14)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNUM ADD",16)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNUM DELETE",18)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNUM EDIT",17)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA DEMOG",40)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA IDS",41)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA LOF ADD",48)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA LOF DELETE",50)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA LOF EDIT",49)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA LOF MAINT",47)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA MAINT",37)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA NF LI",43)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA NF LO",44)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA NONIND MAINT",42)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA NP PI",38)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA NP PO",39)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA PROVINFO",45)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVNVA SECIDS",46)

"BLD",6801,"KRN",101,"NM","B","IBCE PRVPRV MAINT",15)

"BLD",6801,"KRN",101,"NM","B","IBCEM COB COMMENTS",4)

"BLD",6801,"KRN",101,"NM","B","IBCEM COB MANAGEMENT",3)

"BLD",6801,"KRN",101,"NM","B","IBCEM ENTER COMMENTS",1)

"BLD",6801,"KRN",101,"NM","B","IBCEM ENTER COMMENTS 1",9)

"BLD",6801,"KRN",101,"NM","B","IBCEM MRA STATUS",5)

"BLD",6801,"KRN",101,"NM","B","IBCEM VIEW COMMENTS",2)

"BLD",6801,"KRN",101,"NM","B","IBJT AR COMMENT ADD",12)

"BLD",6801,"KRN",101,"NM","B","VALM BLANK 1",51)

"BLD",6801,"KRN",101,"NM","B","VALM QUIT",10)

"BLD",6801,"KRN",409.61,0)
409.61
"BLD",6801,"KRN",409.61,"NM",0)
^9.68A^4^4
"BLD",6801,"KRN",409.61,"NM",1,0)
IBCEM MRA MANAGEMENT^^0
"BLD",6801,"KRN",409.61,"NM",2,0)
IBCEM MRA COMMENTS^^0
"BLD",6801,"KRN",409.61,"NM",3,0)
IBJT AR COMMENT HISTORY^^0
"BLD",6801,"KRN",409.61,"NM",4,0)
IBCE PRVMAINT^^1^
"BLD",6801,"KRN",409.61,"NM","B","IBCE PRVMAINT",4)

"BLD",6801,"KRN",409.61,"NM","B","IBCEM MRA COMMENTS",2)

"BLD",6801,"KRN",409.61,"NM","B","IBCEM MRA MANAGEMENT",1)

"BLD",6801,"KRN",409.61,"NM","B","IBJT AR COMMENT HISTORY",3)

"BLD",6801,"KRN",771,0)
771
"BLD",6801,"KRN",870,0)
870
"BLD",6801,"KRN",8989.51,0)
8989.51
"BLD",6801,"KRN",8989.52,0)
8989.52
"BLD",6801,"KRN",8994,0)
8994
"BLD",6801,"KRN","B",.4,.4)

"BLD",6801,"KRN","B",.401,.401)

"BLD",6801,"KRN","B",.402,.402)

"BLD",6801,"KRN","B",.403,.403)

"BLD",6801,"KRN","B",.5,.5)

"BLD",6801,"KRN","B",.84,.84)

"BLD",6801,"KRN","B",3.6,3.6)

"BLD",6801,"KRN","B",3.8,3.8)

"BLD",6801,"KRN","B",9.2,9.2)

"BLD",6801,"KRN","B",9.8,9.8)

"BLD",6801,"KRN","B",19,19)

"BLD",6801,"KRN","B",19.1,19.1)

"BLD",6801,"KRN","B",101,101)

"BLD",6801,"KRN","B",409.61,409.61)

"BLD",6801,"KRN","B",771,771)

"BLD",6801,"KRN","B",870,870)

"BLD",6801,"KRN","B",8989.51,8989.51)

"BLD",6801,"KRN","B",8989.52,8989.52)

"BLD",6801,"KRN","B",8994,8994)

"BLD",6801,"QUES",0)
^9.62^^
"BLD",6801,"REQB",0)
^9.611^6^6
"BLD",6801,"REQB",1,0)
IB*2.0*371^2
"BLD",6801,"REQB",2,0)
IB*2.0*250^2
"BLD",6801,"REQB",3,0)
IB*2.0*276^2
"BLD",6801,"REQB",4,0)
IB*2.0*296^2
"BLD",6801,"REQB",5,0)
IB*2.0*347^2
"BLD",6801,"REQB",6,0)
IB*2.0*374^2
"BLD",6801,"REQB","B","IB*2.0*250",2)

"BLD",6801,"REQB","B","IB*2.0*276",3)

"BLD",6801,"REQB","B","IB*2.0*296",4)

"BLD",6801,"REQB","B","IB*2.0*347",5)

"BLD",6801,"REQB","B","IB*2.0*371",1)

"BLD",6801,"REQB","B","IB*2.0*374",6)

"DATA",350.8,382,0)
IB123^Non-covered charges required when modifier GY is present for a procedure.^IB123^1^1
"DATA",350.8,383,0)
IB172^Address line 1, City, State and ZIP are required for Current payer.^IB172^1^1
"DATA",350.8,384,0)
IB173^Address line 1, City, State and ZIP are required for Other payer.^IB173^1^1
"DATA",364.6,1,0)
8^N^^30^1^^0^2^10^Payer Responsibility Sequence^^1^0^^
"DATA",364.6,3,0)
8^N^^15^1^^0^11^25^Billing Prov Address 2^0^1^^
"DATA",364.6,7,0)
8^N^^30^1^^0^8^30^Subscriber City Name^^1^^
"DATA",364.6,9,0)
8^N^^30^1^^0^10^5^Subscriber ZIP Code^^1^^
"DATA",364.6,11,0)
8^N^^30^1^^0^12^1^Subscriber Gender Code^^1^^
"DATA",364.6,12,0)
8^N^^30^1^^0^13^20^Subscriber Phone #^^1^^
"DATA",364.6,14,0)
8^N^^35^1^^0^7^2^Insured Employer State Code^^1^^
"DATA",364.6,15,0)
8^N^^35^1^^0^6^30^Insured Employer City Name^^1^^
"DATA",364.6,16,0)
8^N^^30^1^^0^11^8^Subscriber Birth DT^^1^^
"DATA",364.6,17,0)
8^N^^30^1^^0^7^35^Subscriber Address 1^^1^^
"DATA",364.6,18,0)
8^N^^35^1^^0^5^30^Insured Employer Name^^1^^
"DATA",364.6,22,0)
8^N^^30^1^^0^4^20^Subscriber First Name^^1^0^^
"DATA",364.6,26,0)
8^N^^30^1^^0^3^30^Subscriber Last Name^^1^0^^
"DATA",364.6,27,0)
8^N^^30^1^^0^5^25^Subscriber Middle Name^^1^^
"DATA",364.6,28,0)
8^N^^40^1^^0^2^2^Pt. Relationship to Insured^^1^0^^
"DATA",364.6,29,0)
8^N^^40^1^^0^3^2^Employment Status Code^^1^^
"DATA",364.6,30,0)
8^N^^40^1^^0^4^30^Pt. Last Name^^1^0^^
"DATA",364.6,31,0)
8^N^^40^1^^0^5^20^Pt. First Name^^1^0^^
"DATA",364.6,32,0)
8^N^^40^1^^0^6^25^Pt. Middle Name^^1^^
"DATA",364.6,33,0)
8^N^^40^1^^0^7^35^Pt. Address 1^^1^0^^
"DATA",364.6,34,0)
8^N^^40^1^^0^8^35^Pt. Address 2^^1^^
"DATA",364.6,35,0)
8^N^^40^1^^0^9^30^Pt. City Name^^1^0^^
"DATA",364.6,36,0)
8^N^^40^1^^0^10^2^Pt. State Code^^1^0^^
"DATA",364.6,37,0)
8^N^^40^1^^0^11^5^Pt. ZIP Code^^1^^
"DATA",364.6,38,0)
8^N^^40^1^^0^12^8^Pt. Birth DT^^1^^
"DATA",364.6,39,0)
8^N^^40^1^^0^13^1^Pt. Gender Code^^1^^
"DATA",364.6,40,0)
8^N^^40^1^^0^14^1^Marital Status Code^^1^^
"DATA",364.6,42,0)
8^N^^40^1^^0^16^20^Medical Record Number^^1^0^^
"DATA",364.6,43,0)
8^N^^45^1^^0^2^30^Pt. Employer Name^^1^^
"DATA",364.6,44,0)
8^N^^50^1^^0^2^38^Pt. Control #^^1^0^^
"DATA",364.6,45,0)
8^N^^50^1^^0^3^1^Facility Type Code^^1^^
"DATA",364.6,46,0)
8^N^^50^1^^0^5^1^Claim Frequency Code^^1^^
"DATA",364.6,47,0)
8^N^^50^1^^0^6^2^Claim Type^^1^^
"DATA",364.6,48,0)
8^N^^50^1^^0^7^1^Release of Information Code^^1^^
"DATA",364.6,49,0)
8^N^^50^1^^0^8^1^Assignment of Benefits Indicator^^1^^
"DATA",364.6,50,0)
8^N^^50^1^^0^9^2^Bill Status^^1^^
"DATA",364.6,51,0)
8^N^^50^1^^0^10^8^Statement From DT^^1^0^^
"DATA",364.6,52,0)
8^N^^50^1^^0^12^15^Estimated Claim Due Amount^^1^0^^
"DATA",364.6,53,0)
8^N^^50^1^^0^13^15^Total Claim Charge Amount^^1^0^^
"DATA",364.6,54,0)
8^N^^50^1^^0^14^8^Admission/Start of Care DT^^1^^
"DATA",364.6,55,0)
8^N^^50^1^^1^15^2^Admission Hour^^1^^
"DATA",364.6,56,0)
8^N^^50^1^^0^16^8^Discharge DT^^1^^
"DATA",364.6,57,0)
8^N^^50^1^^1^17^2^Discharge Hour^^1^^
"DATA",364.6,58,0)
8^N^^50^1^^0^18^8^Onset of Current Illness/Symptom DT^^1^^
"DATA",364.6,59,0)
8^N^^50^1^^0^19^8^Similar Illness or Symptom DT^^1^^
"DATA",364.6,60,0)
8^N^^50^1^^0^20^8^Last Worked DT^^1^^
"DATA",364.6,61,0)
8^N^^50^1^^0^21^8^Work Return DT^^1^^
"DATA",364.6,62,0)
8^N^^50^1^^0^22^1^Admission Source Code^^1^^
"DATA",364.6,63,0)
8^N^^50^1^^0^23^1^Admission Type Code^^1^^
"DATA",364.6,64,0)
8^N^^50^1^^0^24^2^Pt. Status Code^^1^^
"DATA",364.6,65,0)
8^N^^30^1^^0^14^30^Subscriber Address 2^^1^^
"DATA",364.6,66,0)
8^N^^50^1^^0^26^3^Claim Covered Days Count^^1^^
"DATA",364.6,67,0)
8^N^^50^1^^0^27^3^Claim Non-Covered Days Count^^1^^
"DATA",364.6,70,0)
8^N^^50^1^^0^28^2^Accident/Employ Related Causes (Auto)^^1^^
"DATA",364.6,71,0)
8^N^^50^1^^0^29^2^Accident/Employ Related Causes (Employ)^^1^^
"DATA",364.6,72,0)
8^N^^50^1^^0^30^2^Accident/Employ Related Causes (Other)^^1^^
"DATA",364.6,73,0)
8^N^^50^1^^0^31^2^Auto Accident State Code^^1^^
"DATA",364.6,74,0)
8^N^^50^1^^0^32^1^Provider Signature On File^^1^^
"DATA",364.6,75,0)
8^N^^60^1^^0^3^2^Special Program Indicator^^1^^
"DATA",364.6,76,0)
8^N^^60^1^^0^4^8^Last Seen DT^^1^^
"DATA",364.6,81,0)
8^N^^65^1^^0^2^8^Occurrence Code DT^^1^^
"DATA",364.6,82,0)
8^N^^65^1^^0^3^3^Occurrence Code^^1^^
"DATA",364.6,83,0)
8^N^^70^1^^0^2^8^Occurrence Span Code DT (From)^^1^^
"DATA",364.6,84,0)
8^N^^70^1^^0^4^3^Occurrence Span Code^^1^^
"DATA",364.6,85,0)
8^N^^75^1^^0^2^8^Procedure DT^^1^^
"DATA",364.6,86,0)
8^N^^75^1^^0^3^10^Procedure Code^^1^^
"DATA",364.6,87,0)
8^N^^75^1^^0^4^2^Procedure Code Qualifier^^1^^
"DATA",364.6,88,0)
8^N^^80^1^^0^2^2^Value Code^^1^^
"DATA",364.6,89,0)
8^N^^80^1^^0^3^9^Value Code Dollars^^1^^
"DATA",364.6,91,0)
8^N^^85^1^^0^2^2^Condition Code^^1^^
"DATA",364.6,92,0)
8^N^^90^1^^0^2^10^Diagnosis Code^^1^^
"DATA",364.6,93,0)
8^N^^90^1^^0^3^1^Principal Diagnosis Code Indicator^^1^^
"DATA",364.6,95,0)
8^N^^105^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,96,0)
8^N^^105^1^^0^11^35^Other Payer Last or Organization Name^^1^^
"DATA",364.6,97,0)
8^N^^105^1^^0^3^2^Pt. Relationship to Insured^^1^^
"DATA",364.6,98,0)
8^N^^105^1^^0^4^20^Other Group or Policy #^^1^^
"DATA",364.6,99,0)
8^N^^110^1^^0^3^35^Other Subscriber Primary ID^^1^^
"DATA",364.6,100,0)
8^N^^105^1^^0^5^35^Other Group or Policy Name^^1^^
"DATA",364.6,101,0)
8^N^^110^1^^0^4^30^Other Subscriber Last Name^^1^^
"DATA",364.6,102,0)
8^N^^110^1^^0^5^20^Other Subscriber First Name^^1^^
"DATA",364.6,103,0)
8^N^^110^1^^0^6^25^Other Subscriber Middle Name^^1^^
"DATA",364.6,104,0)
8^N^^105^1^^0^6^8^Other Insured Birth DT^^1^^
"DATA",364.6,105,0)
8^N^^105^1^^0^7^1^Other Insured Gender Code^^1^^
"DATA",364.6,106,0)
8^N^^105^1^^0^8^8^Other Payer Paid Amt^^1^^
"DATA",364.6,108,0)
8^N^^110^1^^0^7^35^Other Subscriber Employer Name^^1^^
"DATA",364.6,109,0)
8^N^^110^1^^0^8^30^Other Subscriber Employer City^^1^^
"DATA",364.6,110,0)
8^N^^110^1^^0^9^2^Other Subscriber Employer State Code^^1^^
"DATA",364.6,111,0)
8^N^^105^1^^0^10^23^Other Payer Secondary ID (ICN/DCN)^^1^^
"DATA",364.6,112,0)
8^N^^180^1^^0^2^6^Service Line #^^1^0^^
"DATA",364.6,113,0)
8^N^^180^1^^0^3^2^Service ID Qualifier^^1^^
"DATA",364.6,114,0)
8^N^^180^1^^0^5^8^Line Item Charge Amt^^1^0^^
"DATA",364.6,115,0)
8^N^^180^1^^0^6^6^Service Unit Count^^1^0^^
"DATA",364.6,116,0)
8^N^^180^1^^0^7^2^Place of Service Code^^1^0^^
"DATA",364.6,117,0)
8^N^^180^1^^0^8^2^Service Type Code^^1^0^^
"DATA",364.6,118,0)
8^N^^180^1^^0^9^8^Service DT From^^1^0^^
"DATA",364.6,119,0)
8^N^^180^1^^0^11^1^Diagnosis Code Pointer(1)^^1^^
"DATA",364.6,120,0)
8^N^^180^1^^0^12^1^Diagnosis Code Pointer(2)^^1^^
"DATA",364.6,121,0)
8^N^^180^1^^0^13^1^Diagnosis Code Pointer(3)^^1^^
"DATA",364.6,122,0)
8^N^^180^1^^0^14^1^Diagnosis Code Pointer(4)^^1^^
"DATA",364.6,123,0)
8^N^^185^1^^0^2^6^Service Line Counter^^1^^
"DATA",364.6,124,0)
8^N^^185^1^^0^3^10^Revenue Code^^1^^
"DATA",364.6,125,0)
8^N^^185^1^^0^4^10^Procedure Code^^1^^
"DATA",364.6,126,0)
8^N^^185^1^^0^5^6^Service Unit Count^^1^0^^
"DATA",364.6,127,0)
8^N^^185^1^^0^6^8^Service Line Rate Amt^^1^^
"DATA",364.6,128,0)
8^N^^185^1^^0^7^2^Procedure Modifier(1)^^1^^
"DATA",364.6,129,0)
8^N^^185^1^^0^8^2^Procedure Modifier(2)^^1^^
"DATA",364.6,130,0)
8^N^^185^1^^0^9^8^Service Line Charge Amt^^1^^
"DATA",364.6,131,0)
8^N^^185^1^^0^10^8^Service Date From^^1^0^^
"DATA",364.6,132,0)
8^N^^185^1^^0^11^8^Service Date To^^1^^
"DATA",364.6,133,0)
8^N^^190^1^^0^2^6^Service Line Counter^^1^^
"DATA",364.6,134,0)
8^N^^190^1^^0^3^15^Prescription #^^1^^
"DATA",364.6,135,0)
8^N^^190^1^^0^4^11^National Drug Code(1)^^1^^
"DATA",364.6,136,0)
8^N^^190^1^^0^5^3^Refill #^^1^^
"DATA",364.6,137,0)
8^N^^190^1^^0^6^55^Drug Name, Quantity, Days Supply^^1^^
"DATA",364.6,138,0)
8^N^^190^1^^0^7^8^Service Date (Refill)^^1^^
"DATA",364.6,165,0)
8^N^^60^1^^0^2^1^Cert. Condition Indicator (Homebound)^^1^^
"DATA",364.6,166,0)
8^N^^50^1^^0^33^10^Admitting Diagnosis^^1^^
"DATA",364.6,167,0)
8^N^^5^1^^0^2^10^Batch Number^0^1^^
"DATA",364.6,168,0)
8^N^^5^1^^0^3^8^Batch Date^^1^0^^
"DATA",364.6,169,0)
8^N^^5^1^^0^4^10^Batch Reference Number^^1^0^^
"DATA",364.6,170,0)
8^N^^55^1^^0^2^30^Lab/Facility Name^^1^^
"DATA",364.6,171,0)
8^N^^55^1^^0^3^35^Lab/Facility Address 1^^1^^
"DATA",364.6,172,0)
8^N^^55^1^^0^4^30^Lab/Facility City Name^^1^^
"DATA",364.6,173,0)
8^N^^55^1^^0^5^2^Lab/Facility State Code^^1^^
"DATA",364.6,174,0)
8^N^^55^1^^0^6^5^Lab/Facility ZIP Code^^1^^
"DATA",364.6,175,0)
8^N^^5^1^^0^6^30^Receiver ID Number^^1^0^^
"DATA",364.6,177,0)
8^N^^15^1^^0^3^25^Billing Prov Organization Name^^1^0^^
"DATA",364.6,178,0)
8^N^^15^1^^0^4^35^Billing Prov Address 1^^1^0^^
"DATA",364.6,179,0)
8^N^^15^1^^0^6^2^Billing Prov State Code^^1^0^^
"DATA",364.6,180,0)
8^N^^15^1^^0^7^5^Billing Prov ZIP Code^^1^0^^
"DATA",364.6,181,0)
8^N^^15^1^^0^5^30^Billing Prov City Name^^1^0^^
"DATA",364.6,182,0)
8^N^^15^1^^0^9^17^Billing Prov Primary ID^^1^0^^
"DATA",364.6,183,0)
8^N^^15^1^^0^8^20^Communication # (Phone)^^1^^
"DATA",364.6,185,0)
8^N^^20^1^^0^3^35^Payer Address 1^^1^0^^
"DATA",364.6,186,0)
8^N^^20^1^^0^4^30^Payer City Name^^1^0^^
"DATA",364.6,187,0)
8^N^^20^1^^0^5^2^Payer State Code^^1^0^^
"DATA",364.6,188,0)
8^N^^20^1^^0^6^15^Payer ZIP Code^^1^0^^
"DATA",364.6,189,0)
8^N^^35^1^^0^2^20^Insured Group or Policy #^^1^^
"DATA",364.6,190,0)
8^N^^35^1^^0^3^30^Insured Group Name^^1^^
"DATA",364.6,192,0)
8^N^^20^1^^0^2^30^Payer Name^^1^0^^
"DATA",364.6,194,0)
8^N^^180^1^^0^4^10^Procedure Code^^1^0^^
"DATA",364.6,226,0)
8^N^^28^1^^0^2^2^Billing Prov Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,227,0)
8^N^^28^1^^0^3^20^Billing Prov Sec ID(1)^0^1^0^^
"DATA",364.6,230,0)
8^N^^110^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,242,0)
8^N^^70^1^^0^1^4^RECORD ID 'OS1 '^^1^1^^
"DATA",364.6,479,0)
8^N^^50^1^^0^11^8^Statement To DT^^1^0^^
"DATA",364.6,481,0)
8^N^^70^1^^0^3^8^Occurrence Span Code DT (To)^^1^^
"DATA",364.6,483,0)
8^N^^180^1^^0^10^8^Service DT To^^1^^
"DATA",364.6,488,0)
8^N^^5^1^^0^5^3^Site Number^^1^0^^
"DATA",364.6,579,0)
8^N^^185^1^^0^12^8^Service Line Non-covered Charge Amt^^1^^
"DATA",364.6,580,0)
8^N^^190^1^^0^8^10^National Drug Unit Count^^1^^
"DATA",364.6,581,0)
8^N^^190^1^^0^9^3^BLANK^^1^^
"DATA",364.6,582,0)
8^N^^1^1^^0^1^4^RECORD ID 'BGN '^^1^1^^
"DATA",364.6,583,0)
8^N^^1^1^^0^2^1^Segment Delimiter^^1^1^^
"DATA",364.6,610,0)
8^N^^180^1^^0^15^2^Procedure Modifier(1)^^1^^
"DATA",364.6,775,0)
8^N^^50^1^^0^4^1^Type of Bill Classification^^1^^
"DATA",364.6,783,0)
8^N^^55^1^^0^7^15^Total Purchased Service Amount^0^1
"DATA",364.6,784,0)
8^N^^50^1^^0^34^3^Claim Days Count (Co-Insurance)^^1^^
"DATA",364.6,785,0)
8^N^^50^1^^0^35^3^BLANK^^1^^
"DATA",364.6,789,0)
8^N^^30^1^^0^9^2^Subscriber State Code^^1^^
"DATA",364.6,790,0)
8^N^^45^1^^0^3^20^Pt. Phone^^1^^
"DATA",364.6,793,0)
8^N^^20^1^^0^10^35^Payer Address 2^^1^^
"DATA",364.6,794,0)
8^N^^35^1^^0^8^2^Type of Pay/Source of Pay^^1^0^^
"DATA",364.6,795,0)
8^N^^45^1^^0^4^8^Insured or Pt. Death DT^^1^^
"DATA",364.6,796,0)
8^N^^50^1^^0^25^8^Last Menstrual Period DT^^1^^
"DATA",364.6,805,0)
8^N^^105^1^^0^14^2^Claim Filing Indicator (Type of Payer)^^1^^
"DATA",364.6,808,0)
8^N^^115^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,809,0)
8^N^^115^1^^0^3^15^Other Payer Pt. Responsibility Amt^^1^^
"DATA",364.6,810,0)
8^N^^115^1^^0^4^15^Other Payer Covered Amt^^1^^
"DATA",364.6,811,0)
8^N^^115^1^^0^5^15^Other Payer Discount Amt^^1^^
"DATA",364.6,812,0)
8^N^^115^1^^0^6^15^Other Payer Per Day Limit Amt^^1^^
"DATA",364.6,813,0)
8^N^^115^1^^0^7^15^BLANK^^1^^
"DATA",364.6,814,0)
8^N^^115^1^^0^8^15^Other Payer Tax Amt^^1^^
"DATA",364.6,815,0)
8^N^^115^1^^0^9^15^Other Payer Pre-Tax Total Claim Amt^^1^^
"DATA",364.6,817,0)
8^N^^120^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,818,0)
8^N^^120^1^^0^3^3^Outpatient Reimbursement Rate^^1^^
"DATA",364.6,819,0)
8^N^^120^1^^0^4^15^HCPCS Payable Amt^^1^^
"DATA",364.6,820,0)
8^N^^120^1^^0^5^15^Remarks Code(1)^^1^^
"DATA",364.6,821,0)
8^N^^120^1^^0^6^15^Remarks Code(2)^^1^^
"DATA",364.6,822,0)
8^N^^120^1^^0^7^15^Remarks Code(3)^^1^^
"DATA",364.6,823,0)
8^N^^120^1^^0^8^15^Remarks Code(4)^^1^^
"DATA",364.6,825,0)
8^N^^120^1^^0^10^15^ESRD Payment Amt^^1^^
"DATA",364.6,826,0)
8^N^^120^1^^0^11^15^Non-payable Prof Component Billed Amt^^1^^
"DATA",364.6,828,0)
8^N^^125^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,829,0)
8^N^^125^1^^0^3^4^Covered Days or Visits Amt^^1^^
"DATA",364.6,830,0)
8^N^^125^1^^0^4^15^Claim DRG Amt^^1^^
"DATA",364.6,831,0)
8^N^^125^1^^0^5^10^DRG Used^^1^^
"DATA",364.6,832,0)
8^N^^125^1^^0^6^15^Claim Disproportionate Share Amt^^1^^
"DATA",364.6,833,0)
8^N^^125^1^^0^7^15^Claim MSP Pass-through Amt^^1^^
"DATA",364.6,834,0)
8^N^^125^1^^0^8^15^Claim PPS Capital Amt^^1^^
"DATA",364.6,835,0)
8^N^^125^1^^0^9^15^PPS-Capital FSP DRG Amt^^1^^
"DATA",364.6,836,0)
8^N^^125^1^^0^10^15^PPS-Capital HSP DRG Amt^^1^^
"DATA",364.6,837,0)
8^N^^125^1^^0^11^15^PPS-Capital DSH DRG Amt^^1^^
"DATA",364.6,838,0)
8^N^^125^1^^0^12^15^Old Capital Amt^^1^^
"DATA",364.6,840,0)
8^N^^130^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,841,0)
8^N^^130^1^^0^3^4^PPS-Capital IME Amt^^1^^
"DATA",364.6,842,0)
8^N^^130^1^^0^4^15^PPS-Operating Hospital Specific DRG Amt^^1^^
"DATA",364.6,843,0)
8^N^^130^1^^0^5^4^Cost Report Day Count^^1^^
"DATA",364.6,844,0)
8^N^^130^1^^0^6^15^PPS-Operating Federal Specific DRG Amt^^1^^
"DATA",364.6,845,0)
8^N^^130^1^^0^7^15^Claim PPS Capital Outlier Amt^^1^^
"DATA",364.6,846,0)
8^N^^130^1^^0^8^15^Claim Indirect Teaching Amt^^1^^
"DATA",364.6,847,0)
8^N^^130^1^^0^9^15^Non-Payable Prof Component Amt^^1^^
"DATA",364.6,848,0)
8^N^^130^1^^0^10^10^Claim Payment Remark Code(1)^^1^^
"DATA",364.6,849,0)
8^N^^130^1^^0^11^10^Claim Payment Remark Code(2)^^1^^
"DATA",364.6,850,0)
8^N^^130^1^^0^12^10^Claim Payment Remark Code(3)^^1^^
"DATA",364.6,851,0)
8^N^^130^1^^0^13^10^Claim Payment Remark Code(4)^^1^^
"DATA",364.6,852,0)
8^N^^130^1^^0^15^15^PPS-Capital Exception Amt^^1^^
"DATA",364.6,854,0)
8^N^^135^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,855,0)
8^N^^135^1^^0^3^2^Adjustment Group Code^^1^^
"DATA",364.6,856,0)
8^N^^135^1^^0^4^5^Adjustment Reason Code(1)^^1^^
"DATA",364.6,857,0)
8^N^^135^1^^0^5^15^Adjustment Amt(1)^^1^^
"DATA",364.6,858,0)
8^N^^135^1^^0^6^6^Adjustment Quantity(1)^^1^^
"DATA",364.6,859,0)
8^N^^180^1^^0^16^2^Procedure Modifier(2)^^1^^
"DATA",364.6,860,0)
8^N^^180^1^^0^17^2^Procedure Modifier(3)^^1^^
"DATA",364.6,861,0)
8^N^^180^1^^0^18^2^Procedure Modifier(4)^^1^^
"DATA",364.6,862,0)
8^N^^180^1^^0^19^1^Emergency Indicator^^1^^
"DATA",364.6,863,0)
8^N^^180^1^^0^20^2^Units/Basis for Measurement Code^^1^^
"DATA",364.6,864,0)
8^N^^185^1^^0^13^2^Units/Basis for Measurement Code^^1^^
"DATA",364.6,866,0)
8^N^^195^1^^0^2^6^Service Line Counter^^1^^^
"DATA",364.6,867,0)
8^N^^195^1^^0^3^20^Payer Primary ID^^1^^
"DATA",364.6,868,0)
8^N^^195^1^^0^4^15^Service Line Paid Amt^^1^^
"DATA",364.6,869,0)
8^N^^195^1^^0^5^20^Procedure Code^^1^^
"DATA",364.6,870,0)
8^N^^195^1^^0^6^10^Service Line Revenue Code^^1^^
"DATA",364.6,871,0)
8^N^^195^1^^0^7^2^Procedure Modifier(1)^^1^^
"DATA",364.6,872,0)
8^N^^195^1^^0^8^2^Procedure Modifier(2)^^1^^
"DATA",364.6,873,0)
8^N^^195^1^^0^9^2^Procedure Modifier(3)^^1^^
"DATA",364.6,874,0)
8^N^^195^1^^0^10^2^Procedure Modifier(4)^^1^^
"DATA",364.6,875,0)
8^N^^195^1^^0^11^80^Procedure Code Description^^1^^
"DATA",364.6,876,0)
8^N^^195^1^^0^12^15^Paid Service Unit Count^^1^^
"DATA",364.6,877,0)
8^N^^195^1^^0^13^6^Bundled Line #^^1^^
"DATA",364.6,879,0)
8^N^^200^1^^0^2^6^Service Line Counter^^1^^
"DATA",364.6,880,0)
8^N^^200^1^^0^3^2^Claim Adjustment Group Code^^1^^
"DATA",364.6,881,0)
8^N^^200^1^^0^4^5^Adjustment Reason Code(1)^^1^^
"DATA",364.6,882,0)
8^N^^200^1^^0^5^15^Adjustment Amt(1)^^1^^
"DATA",364.6,883,0)
8^N^^200^1^^0^6^6^Adjustment Quantity(1)^^1^^
"DATA",364.6,891,0)
8^N^^115^1^^0^10^8^Adjudication or Payment DT^^1^^
"DATA",364.6,892,0)
8^N^^135^1^^0^7^5^Adjustment Reason Code(2)^^1^^
"DATA",364.6,893,0)
8^N^^135^1^^0^10^5^Adjustment Reason Code(3)^^1^^
"DATA",364.6,894,0)
8^N^^135^1^^0^13^5^Adjustment Reason Code(4)^^1^^
"DATA",364.6,895,0)
8^N^^135^1^^0^16^5^Adjustment Reason Code(5)^^1^^
"DATA",364.6,896,0)
8^N^^135^1^^0^19^5^Adjustment Reason Code(6)^^1^^
"DATA",364.6,897,0)
8^N^^135^1^^0^8^15^Adjustment Amt(2)^^1^^
"DATA",364.6,898,0)
8^N^^135^1^^0^11^15^Adjustment Amt(3)^^1^^
"DATA",364.6,899,0)
8^N^^135^1^^0^14^15^Adjustment Amt(4)^^1^^
"DATA",364.6,900,0)
8^N^^135^1^^0^17^15^Adjustment Amt(5)^^1^^
"DATA",364.6,901,0)
8^N^^135^1^^0^20^15^Adjustment Amt(6)^^1^^
"DATA",364.6,902,0)
8^N^^135^1^^0^9^6^Adjustment Quantity(2)^^1^^
"DATA",364.6,903,0)
8^N^^135^1^^0^12^6^Adjustment Quantity(3)^^1^^
"DATA",364.6,904,0)
8^N^^135^1^^0^15^6^Adjustment Quantity(4)^^1^^
"DATA",364.6,905,0)
8^N^^135^1^^0^18^6^Adjustment Quantity(5)^^1^^
"DATA",364.6,906,0)
8^N^^135^1^^0^21^6^Adjustment Quantity(6)^^1^^
"DATA",364.6,907,0)
8^N^^200^1^^0^7^5^Adjustment Reason Code(2)^^1^^
"DATA",364.6,908,0)
8^N^^200^1^^0^10^5^Adjustment Reason Code(3)^^1^^
"DATA",364.6,909,0)
8^N^^200^1^^0^13^5^Adjustment Reason Code(4)^^1^^
"DATA",364.6,910,0)
8^N^^200^1^^0^16^5^Adjustment Reason Code(5)^^1^^
"DATA",364.6,911,0)
8^N^^200^1^^0^19^5^Adjustment Reason Code(6)^^1^^
"DATA",364.6,912,0)
8^N^^200^1^^0^8^15^Adjustment Amt(2)^^1^^
"DATA",364.6,913,0)
8^N^^200^1^^0^11^15^Adjustment Amt(3)^^1^^
"DATA",364.6,914,0)
8^N^^200^1^^0^14^15^Adjustment Amt(4)^^1^^
"DATA",364.6,915,0)
8^N^^200^1^^0^17^15^Adjustment Amt(5)^^1^^
"DATA",364.6,916,0)
8^N^^200^1^^0^20^15^Adjustment Amt(6)^^1^^
"DATA",364.6,917,0)
8^N^^200^1^^0^9^6^Adjustment Quantity(2)^^1^^
"DATA",364.6,918,0)
8^N^^200^1^^0^12^6^Adjustment Quantity(3)^^1^^
"DATA",364.6,919,0)
8^N^^200^1^^0^15^6^Adjustment Quantity(4)^^1^^
"DATA",364.6,920,0)
8^N^^200^1^^0^18^6^Adjustment Quantity(5)^^1^^
"DATA",364.6,921,0)
8^N^^200^1^^0^21^6^Adjustment Quantity(6)^^1^^
"DATA",364.6,923,0)
8^N^^120^1^^0^9^15^Remarks Code(5)^^1^^
"DATA",364.6,924,0)
8^N^^130^1^^0^14^10^Claim Payment Remark Code(5)^^1^^
"DATA",364.6,936,0)
8^N^^96^1^^0^15^10^Referring Prov Name Suffix^0^1^^
"DATA",364.6,937,0)
8^N^^96^1^^0^14^20^Referring Prov First Name^0^1^^
"DATA",364.6,938,0)
8^N^^96^1^^0^13^20^Referring Prov Last Name^0^1^^
"DATA",364.6,939,0)
8^N^^96^1^^0^12^5^BLANK^0^1^^
"DATA",364.6,941,0)
8^N^^96^1^^0^2^20^Att Phy/Rend Prov Last Name^0^1^0^^
"DATA",364.6,942,0)
8^N^^96^1^^0^3^20^Att Phy/Rend Prov First Name^0^1^^
"DATA",364.6,943,0)
8^N^^96^1^^0^4^10^Att Phy/Rend Prov Name Suffix^0^1^0^^
"DATA",364.6,944,0)
8^N^^96^1^^0^5^5^Prov Spec/Taxonomy Code (Att/Rend)^0^1^^
"DATA",364.6,945,0)
8^N^^96^1^^0^6^20^Other Prov Last Name^0^1^^
"DATA",364.6,946,0)
8^N^^96^1^^0^7^20^Other Prov First Name^0^1^^
"DATA",364.6,947,0)
8^N^^96^1^^0^8^10^Other Prov Name Suffix^0^1^^
"DATA",364.6,948,0)
8^N^^96^1^^0^9^20^Operating Phy Last Name^0^1^^
"DATA",364.6,949,0)
8^N^^96^1^^0^10^20^Operating Phy First Name^0^1^^
"DATA",364.6,950,0)
8^N^^96^1^^0^11^10^Operating Phy Name Suffix^0^1^^
"DATA",364.6,952,0)
8^N^^50^1^^0^36^10^E-Code Diagnosis^0^1^^
"DATA",364.6,956,0)
8^N^^105^1^^0^16^18^Other Payer Prior Auth/Referral #^^1^^
"DATA",364.6,957,0)
8^N^^35^1^^0^9^35^Prior Authorization or Referral #^^1^^
"DATA",364.6,960,0)
8^N^^50^1^^0^37^1^Explanation of Benefits Indicator^0^1^^
"DATA",364.6,961,0)
8^N^^115^1^^0^11^15^Other Payer Allowed Amt^0^1^^
"DATA",364.6,962,0)
8^N^^115^1^^0^12^2^Claim Status^0^1^^
"DATA",364.6,964,0)
8^N^^115^1^^0^13^3^Other Payer Covered Days^0^1^^
"DATA",364.6,965,0)
8^N^^50^1^^0^38^8^Accident DT^0^1^^
"DATA",364.6,968,0)
8^N^^15^1^^0^10^15^BLANK^0^1^0^^
"DATA",364.6,971,0)
8^N^^55^1^^0^9^10^Lab/Facility Primary ID^0^1^^
"DATA",364.6,972,0)
8^N^^55^1^^0^10^1^Purchased Serv Flag^0^1^^
"DATA",364.6,973,0)
8^N^^97^1^^0^4^1^Att Phy/Rend Prov Entity Type Code^0^1^^^
"DATA",364.6,974,0)
8^N^^180^1^^0^21^8^Purchased Service Charge Amt^0^1^^
"DATA",364.6,975,0)
8^N^^180^1^^0^22^15^BLANK^0^1^^
"DATA",364.6,976,0)
8^N^^195^1^^0^14^8^Adjudication or Payment DT^0^1^^
"DATA",364.6,978,0)
8^N^^180^1^^0^24^1^Hospice Employee Indicator^0^1^^
"DATA",364.6,982,0)
8^N^^180^1^^0^29^1^EPSDT Indicator^0^1^^
"DATA",364.6,985,0)
8^N^^97^1^^0^2^10^Att Phy/Rend Prov Primary ID Qualifier^0^1^^
"DATA",364.6,986,0)
8^N^^97^1^^0^3^10^Att Phy/Rend Prov Primary ID^0^1^^
"DATA",364.6,987,0)
8^N^^35^1^^0^12^20^Insured Employer Address 1^0^1^^
"DATA",364.6,988,0)
8^N^^110^1^^0^10^20^Other Subscriber Employer Address^0^1^^
"DATA",364.6,990,0)
8^N^^97^1^^0^7^1^Other Prov Entity Type Qualifier^0^1^^
"DATA",364.6,991,0)
8^N^^97^1^^0^5^10^Other Prov Primary ID Qualifier^0^1^^
"DATA",364.6,992,0)
8^N^^97^1^^0^6^10^Other Prov Primary ID^0^1^^
"DATA",364.6,993,0)
8^N^^97^1^^0^8^10^Operating Phy Primary ID Qualifier^0^1^^
"DATA",364.6,994,0)
8^N^^97^1^^0^9^10^Operating Phy Primary ID^0^1^^
"DATA",364.6,999,0)
8^N^^35^1^^0^11^20^Original Reference # (ICN/DCN)^^1^^
"DATA",364.6,1002,0)
8^N^^60^1^^0^19^80^Claim Note Text^^1
"DATA",364.6,1005,0)
8^N^^105^1^^0^17^2^Insurance Type Code^^1^^
"DATA",364.6,1006,0)
8^N^^180^1^^0^30^61^Line Note Text^0^1^^
"DATA",364.6,1007,0)
8^N^^97^1^^0^10^3^Att Phy/Rend Prov Credentials^0^1^^
"DATA",364.6,1009,0)
8^N^^20^1^^0^12^2^Insurance Type Code^0^1^0^^
"DATA",364.6,1011,0)
8^N^^190^1^^0^10^2^Service ID Qualifier^0^1^^
"DATA",364.6,1012,0)
8^N^^195^1^^0^15^2^Product or Service ID Qualifier^^1^^
"DATA",364.6,1015,0)
8^N^^28^1^^0^6^2^Billing Prov Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1016,0)
8^N^^30^1^^0^15^10^Subscriber Name Suffix^0^1^0^^
"DATA",364.6,1018,0)
8^N^^36^1^^0^2^2^Responsible Party Entity ID Code^0^1^0^^
"DATA",364.6,1019,0)
8^N^^36^1^^0^3^1^Responsible Party Entity Type Qualifier^0^1^0^^
"DATA",364.6,1020,0)
8^N^^36^1^^0^4^35^Responsible Party Last/Organization Name^0^1^0^^
"DATA",364.6,1029,0)
8^N^^40^1^^0^17^2^Unit/Basis for Measurement Code^0^1^0^^
"DATA",364.6,1030,0)
8^N^^40^1^^0^18^10^Pt. Weight^0^1^0^^
"DATA",364.6,1031,0)
8^N^^40^1^^0^19^1^Pregnancy Indicator^0^1^0^^
"DATA",364.6,1032,0)
8^N^^51^1^^0^2^8^Initial Treatment DT (Spinal)^0^1^0^^
"DATA",364.6,1033,0)
8^N^^51^1^^0^3^8^Last X-Ray DT (Spinal)^0^1^0^^
"DATA",364.6,1034,0)
8^N^^51^1^^0^4^8^Prescription DT (Hearing/Vision)^0^1^0^^
"DATA",364.6,1035,0)
8^N^^51^1^^0^5^1^Medicare Assignment Code^0^1^0^^
"DATA",364.6,1036,0)
8^N^^51^1^^0^6^30^Mammography Certification #^0^1^0^^
"DATA",364.6,1037,0)
8^N^^51^1^^0^7^1^Pt. Condition Description (Spinal)^0^1^0^^
"DATA",364.6,1038,0)
8^N^^51^1^^0^8^8^Acute Manifestation DT (Spinal)^0^1^0^^
"DATA",364.6,1039,0)
8^N^^55^1^^0^12^50^Lab/Facility Address 2^0^1^0^^
"DATA",364.6,1040,0)
8^N^^56^1^^0^2^2^Purchased Serv Prov Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1041,0)
8^N^^57^1^^0^2^2^Lab/Facility Entity Code^0^1^0^^
"DATA",364.6,1042,0)
8^N^^57^1^^0^3^1^Lab/Facility Entity Type Qualifier^0^1^0^^
"DATA",364.6,1043,0)
8^N^^57^1^^0^4^35^Lab/Facility Name^0^1^0^^
"DATA",364.6,1044,0)
8^N^^57^1^^0^7^2^Lab/Facility Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1045,0)
8^N^^57^1^^0^5^2^Lab/Facility Primary ID Qualifier^0^1^0^^
"DATA",364.6,1046,0)
8^N^^57^1^^0^6^20^Lab/Facility Primary ID^0^1^0^^
"DATA",364.6,1047,0)
8^N^^97^1^^0^11^10^Referring Prov Primary ID Qualifier^0^1^0^^
"DATA",364.6,1048,0)
8^N^^97^1^^0^12^10^Referring Prov Primary ID^0^1^0^^
"DATA",364.6,1051,0)
8^N^^51^1^^0^9^2^Mammography Certification Qualifier^0^1^0^^
"DATA",364.6,1058,0)
8^N^^103^1^^0^2^35^Supervising Prov Last Name^0^1^0^^
"DATA",364.6,1059,0)
8^N^^103^1^^0^3^25^Supervising Prov First Name^0^1^0^^
"DATA",364.6,1060,0)
8^N^^103^1^^0^4^25^Supervising Prov Middle Name^0^1^0^^
"DATA",364.6,1061,0)
8^N^^103^1^^0^5^10^Supervising Prov Name Suffix^0^1^0^^
"DATA",364.6,1062,0)
8^N^^103^1^^0^6^2^Supervising Prov Primary ID Qualifier^0^1^0^^
"DATA",364.6,1063,0)
8^N^^103^1^^0^7^30^Supervising Prov Primary ID^0^1^0^^
"DATA",364.6,1065,0)
8^N^^105^1^0^0^18^1^Other Payer Pt. Signature Source Code^0^1^0^^
"DATA",364.6,1072,0)
8^N^^112^1^^0^2.9^^CLEAN UP OTHER PAYER ADDRESS^1^1^0^^
"DATA",364.6,1073,0)
8^N^^112^1^^0^3^55^Other Payer Address Line 1^0^1^0^^
"DATA",364.6,1074,0)
8^N^^112^1^^0^4^55^Other Payer Address Line 2^0^1^0^^
"DATA",364.6,1075,0)
8^N^^112^1^^0^5^30^Other Payer City Name^0^1^0^^
"DATA",364.6,1076,0)
8^N^^112^1^^0^6^2^Other Payer State Code^0^1^0^^
"DATA",364.6,1077,0)
8^N^^112^1^^0^7^15^Other Payer ZIP Code^0^1^0^^
"DATA",364.6,1081,0)
8^N^^113^1^^0^3^10^Other Subscriber Name Suffix^0^1^0^^
"DATA",364.6,1083,0)
8^N^^111^1^0^0^4^1^Other Payer Entity Type Qualifier^0^1^0^^
"DATA",364.6,1084,0)
8^N^^111^1^0^0^5^2^Other Payer Pt. Primary ID Qualifier^0^1^0^^
"DATA",364.6,1085,0)
8^N^^111^1^0^0^6^30^Other Payer Pt. Primary ID^0^1^0^^
"DATA",364.6,1086,0)
8^N^^111^1^0^0^7^2^Other Payer Pt. Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1087,0)
8^N^^111^1^0^0^8^30^Other Payer Pt. Sec ID(1)^0^1^0^^
"DATA",364.6,1088,0)
8^N^^111^1^0^0^9^2^Other Payer Pt. Sec ID Qualifier(2)^0^1^0^^
"DATA",364.6,1089,0)
8^N^^111^1^0^0^10^30^Other Payer Pt. Sec ID(2)^0^1^0^^
"DATA",364.6,1090,0)
8^N^^111^1^0^0^11^2^Other Payer Pt. Sec ID Qualifier(3)^0^1^0^^
"DATA",364.6,1091,0)
8^N^^111^1^0^0^12^30^Other Payer Pt. Sec ID(3)^0^1^0^^
"DATA",364.6,1094,0)
8^N^^28^1^^0^7^20^Billing Prov Sec ID(3)^0^1^^
"DATA",364.6,1095,0)
8^N^^28^1^^0^8^2^Billing Prov Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1096,0)
8^N^^28^1^^0^9^20^Billing Prov Sec ID(4)^0^1^^
"DATA",364.6,1097,0)
8^N^^28^1^^0^10^2^Billing Prov Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1098,0)
8^N^^28^1^^0^11^20^Billing Prov Sec ID(5)^0^1^^
"DATA",364.6,1099,0)
8^N^^28^1^^0^12^2^Billing Prov Sec ID Qualifier(6)^0^1^^
"DATA",364.6,1100,0)
8^N^^28^1^^0^13^20^Billing Prov Sec ID(6)^0^1^^
"DATA",364.6,1101,0)
8^N^^28^1^^0^14^2^Billing Prov Sec ID Qualifier(7)^0^1^^
"DATA",364.6,1102,0)
8^N^^28^1^^0^15^20^Billing Prov Sec ID(7)^^1^^
"DATA",364.6,1103,0)
8^N^^28^1^^0^16^2^Billing Prov Sec ID Qualifier(8)^0^1^^
"DATA",364.6,1104,0)
8^N^^28^1^^0^17^20^Billing Prov Sec ID(8)^0^1^^
"DATA",364.6,1107,0)
8^N^^170^1^0^0^3^2^Other Payer Att/Rend Entity ID^0^1^0^^
"DATA",364.6,1108,0)
8^N^^170^1^0^0^4^1^Other Payer Att/Rend Entity Qualifier^0^1^0^^
"DATA",364.6,1110,0)
8^N^^170^1^0^0^5^2^Other Payer Att/Rend Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1111,0)
8^N^^170^1^0^0^6^30^Other Payer Att/Rend Sec ID(1)^0^1^0^^
"DATA",364.6,1112,0)
8^N^^170^1^0^0^7^2^Other Payer Att/Rend Sec ID Qualifier(2)^0^1^0^^
"DATA",364.6,1113,0)
8^N^^170^1^0^0^8^30^Other Payer Att/Rend Sec ID(2)^0^1^0^^
"DATA",364.6,1114,0)
8^N^^170^1^0^0^9^2^Other Payer Att/Rend Sec ID Qualifier(3)^0^1^0^^
"DATA",364.6,1115,0)
8^N^^170^1^0^0^10^30^Other Payer Att/Rend Sec ID(3)^0^1^0^^
"DATA",364.6,1117,0)
8^N^^171^1^0^0^3^2^Other Payer Operating Phy Entity ID^0^1^0^^
"DATA",364.6,1118,0)
8^N^^171^1^0^0^4^1^Other Payer Oper Phy Entity Qualifier^0^1^0^^
"DATA",364.6,1119,0)
8^N^^171^1^0^0^5^2^Other Payer Oper Phy Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1120,0)
8^N^^171^1^0^0^6^30^Other Payer Operating Phy Sec ID(1)^0^1^0^^
"DATA",364.6,1121,0)
8^N^^171^1^0^0^7^2^Other Payer Oper Phy Sec ID Qualifier(2)^0^1^0^^
"DATA",364.6,1122,0)
8^N^^171^1^0^0^8^30^Other Payer Operating Phy Sec ID(2)^0^1^0^^
"DATA",364.6,1123,0)
8^N^^171^1^0^0^9^2^Other Payer Oper Phy Sec ID Qualifier(3)^0^1^0^^
"DATA",364.6,1124,0)
8^N^^171^1^0^0^10^30^Other Payer Operating Phy Sec ID(3)^0^1^0^^
"DATA",364.6,1127,0)
8^N^^172^1^0^0^3^2^Other Payer Lab/Facility Entity ID^0^1^0^^
"DATA",364.6,1128,0)
8^N^^172^1^0^0^4^1^Other Payer Lab/Fac Entity Qualifier^0^1^0^^
"DATA",364.6,1129,0)
8^N^^172^1^0^0^5^2^Other Payer Lab/Fac Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1130,0)
8^N^^172^1^0^0^6^30^Other Payer Lab/Facility Sec ID(1)^0^1^0^^
"DATA",364.6,1131,0)
8^N^^172^1^0^0^7^2^Other Payer Lab/Fac Sec ID Qualifier(2)^0^1^0^^
"DATA",364.6,1132,0)
8^N^^172^1^0^0^8^30^Other Payer Lab/Facility Sec ID(2)^0^1^0^^
"DATA",364.6,1133,0)
8^N^^172^1^0^0^9^2^Other Payer Lab/Fac Sec ID Qualifier(3)^0^1^0^^
"DATA",364.6,1134,0)
8^N^^172^1^0^0^10^30^Other Payer Lab/Facility Sec ID(3)^0^1^0^^
"DATA",364.6,1136,0)
8^N^^173^1^0^0^3^2^Other Payer Referring Prov Entity ID^0^1^0^^
"DATA",364.6,1137,0)
8^N^^173^1^0^0^4^1^Other Payer Refer Prov Entity Qualifier^0^1^0^^
"DATA",364.6,1138,0)
8^N^^173^1^0^0^5^2^Other Payer Refer Prov Sec ID Qual(1)^0^1^0^^
"DATA",364.6,1139,0)
8^N^^173^1^^0^6^30^Other Payer Referring Prov Sec ID(1)^0^1^0^^
"DATA",364.6,1140,0)
8^N^^173^1^0^0^7^2^Other Payer Refer Prov Sec ID Qual(2)^0^1^0^^
"DATA",364.6,1141,0)
8^N^^173^1^0^0^8^30^Other Payer Referring Prov Sec ID(2)^0^1^0^^
"DATA",364.6,1142,0)
8^N^^173^1^0^0^9^2^Other Payer Refer Prov Sec ID Qual(3)^0^1^0^^
"DATA",364.6,1143,0)
8^N^^173^1^0^0^10^30^Other Payer Referring Prov Sec ID(3)^0^1^0^^
"DATA",364.6,1154,0)
8^N^^175^1^0^0^3^2^Other Payer Purchased Serv Entity ID^0^1^0^^
"DATA",364.6,1155,0)
8^N^^175^1^0^0^4^1^Other Payer Purch Serv Entity Qualifier^0^1^0^^
"DATA",364.6,1156,0)
8^N^^175^1^0^0^5^2^Other Payer Purch Serv Sec ID Qual(1)^0^1^0^^
"DATA",364.6,1157,0)
8^N^^175^1^0^0^6^30^Other Payer Purchased Serv Sec ID(1)^0^1^0^^
"DATA",364.6,1158,0)
8^N^^175^1^0^0^7^2^Other Payer Purch Serv Sec ID Qual(2)^0^1^0^^
"DATA",364.6,1159,0)
8^N^^175^1^0^0^8^30^Other Payer Purchased Serv Sec ID(2)^0^1^0^^
"DATA",364.6,1160,0)
8^N^^175^1^0^0^9^2^Other Payer Purch Serv Sec ID Qual(3)^0^1^0^^
"DATA",364.6,1161,0)
8^N^^175^1^0^0^10^30^Other Payer Purchased Serv Sec ID(3)^0^1^0^^
"DATA",364.6,1163,0)
8^N^^176^1^0^0^3^2^Other Payer Service Facility Entity ID^0^1^0^^
"DATA",364.6,1164,0)
8^N^^176^1^0^0^4^1^Other Payer Service Fac Entity Qualifier^0^1^0^^
"DATA",364.6,1165,0)
8^N^^176^1^0^0^5^2^Other Payer Service Fac Sec ID Qual(1)^0^1^0^^
"DATA",364.6,1166,0)
8^N^^176^1^0^0^6^30^Other Payer Service Facility Sec ID(1)^0^1^0^^
"DATA",364.6,1167,0)
8^N^^176^1^0^0^7^2^Other Payer Service Fac Sec ID Qual(2)^0^1^0^^
"DATA",364.6,1168,0)
8^N^^176^1^0^0^8^30^Other Payer Service Facility Sec ID(2)^0^1^0^^
"DATA",364.6,1169,0)
8^N^^176^1^0^0^9^2^Other Payer Service Fac Sec ID Qual(3)^0^1^0^^
"DATA",364.6,1170,0)
8^N^^176^1^0^0^10^30^Other Payer Service Facility Sec ID(3)^0^1^0^^
"DATA",364.6,1172,0)
8^N^^177^1^0^0^3^2^Other Payer Supervising Prov Entity ID^0^1^0^^
"DATA",364.6,1173,0)
8^N^^177^1^0^0^4^1^Other Payer Super Prov Entity ID Qual^0^1^0^^
"DATA",364.6,1174,0)
8^N^^177^1^0^0^5^2^Other Payer Super Prov Sec ID Qual(1)^0^1^0^^
"DATA",364.6,1175,0)
8^N^^177^1^0^0^6^30^Other Payer Supervising Prov Sec ID(1)^0^1^0^^
"DATA",364.6,1176,0)
8^N^^177^1^0^0^7^2^Other Payer Super Prov Sec ID Qual(2)^0^1^0^^
"DATA",364.6,1177,0)
8^N^^177^1^0^0^8^30^Other Payer Supervising Prov Sec ID(2)^0^1^0^^
"DATA",364.6,1178,0)
8^N^^177^1^0^0^9^2^Other Payer Super Prov Sec ID Qual(3)^0^1^0^^
"DATA",364.6,1179,0)
8^N^^177^1^0^0^10^30^Other Payer Supervising Prov Sec ID(3)^0^1^0^^
"DATA",364.6,1181,0)
8^N^^178^1^0^0^3^2^Other Payer Other Prov Entity ID^0^1^0^^
"DATA",364.6,1182,0)
8^N^^178^1^0^0^4^1^Other Payer Other Prov Entity Qual^0^1^0^^
"DATA",364.6,1183,0)
8^N^^178^1^0^0^5^2^Other Payer Other Prov Sec ID Qual(1)^0^1^0^^
"DATA",364.6,1184,0)
8^N^^178^1^0^0^6^30^Other Payer Other Prov Sec ID(1)^0^1^0^^
"DATA",364.6,1185,0)
8^N^^178^1^0^0^7^2^Other Payer Other Prov Sec ID Qual(2)^0^1^0^^
"DATA",364.6,1186,0)
8^N^^178^1^0^0^8^30^Other Payer Other Prov Sec ID(2)^0^1^0^^
"DATA",364.6,1187,0)
8^N^^178^1^0^0^9^2^Other Payer Other Prov Sec ID Qual(3)^0^1^0^^
"DATA",364.6,1188,0)
8^N^^178^1^0^0^10^30^Other Payer Other Prov Sec ID(3)^0^1^0^^
"DATA",364.6,1191,0)
8^N^^28^1^^0^4^2^Billing Prov Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1192,0)
8^N^^28^1^^0^5^20^Billing Prov Sec ID(2)^0^1^0^^
"DATA",364.6,1194,0)
8^N^^55^1^^0^11^3^Purchased Serv Amt Qualifier^0^1
"DATA",364.6,1195,0)
8^N^^55^1^^0^13^2^Purchased Serv Prov Primary ID Qualifier^0^1^^
"DATA",364.6,1196,0)
8^N^^55^1^^0^14^1^Purchased Serv Entity Type Qualifier^0^1^^
"DATA",364.6,1198,0)
8^N^^56^1^^0^3^20^Purchased Serv Prov Sec ID(1)^0^1^^
"DATA",364.6,1199,0)
8^N^^56^1^^0^4^2^Purchased Serv Prov Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1200,0)
8^N^^56^1^^0^5^20^Purchased Serv Prov Sec ID(2)^0^1^^
"DATA",364.6,1201,0)
8^N^^56^1^^0^6^2^Purchased Serv Prov Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1202,0)
8^N^^56^1^^0^7^20^Purchased Serv Prov Sec ID(3)^0^1^^
"DATA",364.6,1203,0)
8^N^^56^1^^0^8^2^Purchased Serv Prov Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1204,0)
8^N^^56^1^^0^9^20^Purchased Serv Prov Sec ID(4)^0^1^^
"DATA",364.6,1205,0)
8^N^^56^1^^0^10^2^Purchased Serv Prov Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1206,0)
8^N^^56^1^^0^11^20^Purchased Serv Prov Sec ID(5)^0^1^^
"DATA",364.6,1209,0)
8^N^^57^1^^0^8^20^Lab/Facility Sec ID(1)^0^1^^
"DATA",364.6,1210,0)
8^N^^57^1^^0^9^2^Lab/Facility Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1211,0)
8^N^^57^1^^0^10^20^Lab/Facility Sec ID(2)^0^1^^
"DATA",364.6,1212,0)
8^N^^57^1^^0^11^2^Lab/Facility Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1213,0)
8^N^^57^1^^0^12^20^Lab/Facility Sec ID(3)^0^1^^
"DATA",364.6,1214,0)
8^N^^57^1^^0^13^2^Lab/Facility Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1215,0)
8^N^^57^1^^0^14^20^Lab/Facility Sec ID(4)^0^1^^
"DATA",364.6,1216,0)
8^N^^57^1^^0^15^2^Lab/Facility Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1217,0)
8^N^^57^1^^0^16^20^Lab/Facility Sec ID(5)^0^1^^
"DATA",364.6,1224,0)
8^N^^98^1^^0^2^2^Att Phy/Rend Prov Sec ID Qualifier(1)^0^1^^
"DATA",364.6,1225,0)
8^N^^98^1^^0^3^30^Att Phy/Rend Prov Sec ID(1)^0^1^^
"DATA",364.6,1226,0)
8^N^^98^1^^0^4^2^Att Phy/Rend Prov Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1227,0)
8^N^^98^1^^0^5^30^Att Phy/Rend Prov Sec ID(2)^0^1^^
"DATA",364.6,1228,0)
8^N^^98^1^^0^6^2^Att Phy/Rend Prov Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1229,0)
8^N^^98^1^^0^7^30^Att Phy/Rend Prov Sec ID(3)^0^1^^
"DATA",364.6,1230,0)
8^N^^98^1^^0^8^2^Att Phy/Rend Prov Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1231,0)
8^N^^98^1^^0^9^30^Att Phy/Rend Prov Sec ID(4)^0^1^^
"DATA",364.6,1232,0)
8^N^^98^1^^0^10^2^Att Phy/Rend Prov Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1233,0)
8^N^^98^1^^0^11^30^Att Phy/Rend Prov Sec ID(5)^0^1^^
"DATA",364.6,1234,0)
8^N^^99^1^^0^2^2^Operating Phy Sec ID Qualifier(1)^0^1^^
"DATA",364.6,1235,0)
8^N^^99^1^^0^3^30^Operating Phy Sec ID(1)^0^1^^
"DATA",364.6,1236,0)
8^N^^99^1^^0^4^2^Operating Phy Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1237,0)
8^N^^99^1^^0^5^30^Operating Phy Sec ID(2)^0^1^^
"DATA",364.6,1238,0)
8^N^^99^1^^0^6^2^Operating Phy Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1239,0)
8^N^^99^1^^0^7^30^Operating Phy Sec ID(3)^0^1^^
"DATA",364.6,1240,0)
8^N^^99^1^^0^8^2^Operating Phy Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1241,0)
8^N^^99^1^^0^9^30^Operating Phy Sec ID(4)^0^1^^
"DATA",364.6,1242,0)
8^N^^99^1^^0^10^2^Operating Phy Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1243,0)
8^N^^99^1^^0^11^30^Operating Phy Sec ID(5)^0^1^^
"DATA",364.6,1244,0)
8^N^^100^1^^0^2^2^Other Prov Sec ID Qualifier(1)^^1^^
"DATA",364.6,1245,0)
8^N^^100^1^^0^3^30^Other Prov Sec ID(1)^^1^^
"DATA",364.6,1246,0)
8^N^^100^1^^0^4^2^Other Prov Sec ID Qualifier(2)^^1^^
"DATA",364.6,1247,0)
8^N^^100^1^^0^5^30^Other Prov Sec ID(2)^^1^^
"DATA",364.6,1248,0)
8^N^^100^1^^0^6^2^Other Prov Sec ID Qualifier(3)^^1^^
"DATA",364.6,1249,0)
8^N^^100^1^^0^7^30^Other Prov Sec ID(3)^^1^^
"DATA",364.6,1250,0)
8^N^^100^1^^0^8^2^Other Prov Sec ID Qualifier(4)^^1^^
"DATA",364.6,1251,0)
8^N^^100^1^^0^9^30^Other Prov Sec ID(4)^^1^^
"DATA",364.6,1252,0)
8^N^^100^1^^0^10^2^Other Prov Sec ID Qualifier(5)^^1^^
"DATA",364.6,1253,0)
8^N^^100^1^^0^11^30^Other Prov Sec ID(5)^^1^^
"DATA",364.6,1254,0)
8^N^^101^1^^0^2^2^Referring Prov Sec ID Qualifier(1)^0^1^0^^
"DATA",364.6,1255,0)
8^N^^101^1^^0^3^30^Referring Prov Sec ID(1)^0^1^^
"DATA",364.6,1256,0)
8^N^^101^1^^0^4^2^Referring Prov Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1257,0)
8^N^^101^1^^0^5^30^Referring Prov Sec ID(2)^0^1^^
"DATA",364.6,1258,0)
8^N^^101^1^^0^6^2^Referring Prov Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1259,0)
8^N^^101^1^^0^7^30^Referring Prov Sec ID(3)^0^1^^
"DATA",364.6,1260,0)
8^N^^101^1^^0^8^2^Referring Prov Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1261,0)
8^N^^101^1^^0^9^30^Referring Prov Sec ID(4)^0^1^^
"DATA",364.6,1262,0)
8^N^^101^1^^0^10^2^Referring Prov Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1263,0)
8^N^^101^1^^0^11^30^Referring Prov Sec ID(5)^0^1^^
"DATA",364.6,1277,0)
8^N^^104^1^^0^2^2^Supervising Prov Sec ID Qualifier(1)^0^1^^
"DATA",364.6,1278,0)
8^N^^104^1^^0^3^30^Supervising Prov Sec ID(1)^0^1^^
"DATA",364.6,1279,0)
8^N^^104^1^^0^4^2^Supervising Prov Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1280,0)
8^N^^104^1^^0^5^30^Supervising Prov Sec ID(2)^0^1^^
"DATA",364.6,1281,0)
8^N^^104^1^^0^6^2^Supervising Prov Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1282,0)
8^N^^104^1^^0^7^30^Supervising Prov Sec ID(3)^0^1^^
"DATA",364.6,1283,0)
8^N^^104^1^^0^8^2^Supervising Prov Sec ID Qualifier(4)^0^1^^
"DATA",364.6,1284,0)
8^N^^104^1^^0^9^30^Supervising Prov Sec ID(4)^0^1^^
"DATA",364.6,1285,0)
8^N^^104^1^^0^10^2^Supervising Prov Sec ID Qualifier(5)^0^1^^
"DATA",364.6,1286,0)
8^N^^104^1^^0^11^30^Supervising Prov Sec ID(5)^0^1^^
"DATA",364.6,1289,0)
8^N^^113^1^^0^4^45^Other Subscriber Address 1^0^1^^
"DATA",364.6,1290,0)
8^N^^113^1^^0^5^40^Other Subscriber Address 2^0^1^^
"DATA",364.6,1291,0)
8^N^^113^1^^0^6^30^Other Subscriber City Name^0^1^^
"DATA",364.6,1292,0)
8^N^^113^1^^0^7^2^Other Subscriber State Code^0^1^^
"DATA",364.6,1293,0)
8^N^^113^1^^0^8^10^Other Subscriber ZIP Code^0^1^^
"DATA",364.6,1294,0)
8^N^^113^1^^0^9^2^Other Subscriber Sec ID Qualifier(1)^0^1^^
"DATA",364.6,1295,0)
8^N^^113^1^^0^10^30^Other Subscriber Sec ID(1)^0^1^^
"DATA",364.6,1296,0)
8^N^^113^1^^0^11^2^Other Subscriber Sec ID Qualifier(2)^0^1^^
"DATA",364.6,1297,0)
8^N^^113^1^^0^12^30^Other Subscriber Sec ID(2)^0^1^^
"DATA",364.6,1298,0)
8^N^^113^1^^0^13^2^Other Subscriber Sec ID Qualifier(3)^0^1^^
"DATA",364.6,1299,0)
8^N^^113^1^^0^14^30^Other Subscriber Sec ID(3)^0^1^^
"DATA",364.6,1301,0)
8^N^^177^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1303,0)
8^N^^170^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1304,0)
8^N^^171^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^0^^
"DATA",364.6,1305,0)
8^N^^172^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1306,0)
8^N^^173^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1308,0)
8^N^^175^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1309,0)
8^N^^176^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1310,0)
8^N^^178^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^^
"DATA",364.6,1311,0)
8^N^^111^1^^0^2^1^Payer Responsibility Sequence # Code^0^1^0^^
"DATA",364.6,1312,0)
8^N^^112^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,1313,0)
8^N^^113^1^^0^2^1^Payer Responsibility Sequence # Code^^1^^
"DATA",364.6,1314,0)
8^N^^111^1^3^0^3^2^Other Payer Entity ID Code^0^1^0^^
"DATA",364.6,1316,0)
8^N^^20^1^^0^7^10^BLANK^0^1
"DATA",364.6,1317,0)
8^N^^20^1^1^^13^2^BLANK^0^1^^
"DATA",364.6,1318,0)
8^N^^97^1^^0^14^1^Referring Prov Entity Type Qualifier^0^1^^
"DATA",364.6,1319,0)
8^N^^97^1^^0^15^1^Operating Phy Entity Type Qualifier^0^1^0^^
"DATA",364.6,1321,0)
8^N^^20^1^1^0^14^1^Payer Sequence^0^1^0^^
"DATA",364.6,1322,0)
8^N^^20^1^1^0^15^1^MRA Secondary Indicator^0^1^0^^
"DATA",364.6,1324,0)
8^N^^104.5^1^^0^2^10^Att Phy/Rend Prov NPI Code^0^1^0^^
"DATA",364.6,1325,0)
8^N^^104.5^1^^0^3^10^Att Phy/Rend Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1326,0)
8^N^^104.5^1^^0^4^10^Other Prov NPI Code^0^1^0^^
"DATA",364.6,1327,0)
8^N^^104.5^1^^0^5^10^Other Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1328,0)
8^N^^104.5^1^^0^6^10^Operating Phy NPI Code^0^1^0^^
"DATA",364.6,1329,0)
8^N^^104.5^1^^0^7^10^Operating Phy Taxonomy Code^0^1^0^^
"DATA",364.6,1330,0)
8^N^^104.5^1^^0^8^10^Supervising Prov NPI Code^0^1^0^^
"DATA",364.6,1331,0)
8^N^^104.5^1^^0^9^10^Supervising Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1332,0)
8^N^^104.5^1^^0^10^10^Referring Prov NPI Code^0^1^0^^
"DATA",364.6,1333,0)
8^N^^104.5^1^^0^11^10^Referring Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1334,0)
8^N^^104.5^1^^0^12^10^Billing Prov NPI Code^0^1^0^^
"DATA",364.6,1335,0)
8^N^^104.5^1^^0^13^10^Billing Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1336,0)
8^N^^104.5^1^^0^14^10^Purchased Serv Prov NPI Code^0^1^0^^
"DATA",364.6,1337,0)
8^N^^104.5^1^^0^15^10^Purchased Serv Prov Taxonomy Code^0^1^0^^
"DATA",364.6,1338,0)
8^N^^104.5^1^^0^16^10^Lab/Facility NPI Code^0^1^0^^
"DATA",364.6,1339,0)
8^N^^104.5^1^^0^17^10^Lab/Facility Taxonomy Code^0^1^0^^
"DATA",364.6,1801,0)
8^N^^38^1^^0^2^3^Subscriber Primary ID Qualifier^0^1
"DATA",364.6,1802,0)
8^N^^38^1^^0^3^30^Subscriber Primary ID^0^1
"DATA",364.6,1803,0)
8^N^^38^1^^0^4^3^Subscriber Sec ID Qualifier(1)^0^1
"DATA",364.6,1804,0)
8^N^^38^1^^0^5^30^Subscriber Sec ID(1)^0^1
"DATA",364.6,1805,0)
8^N^^38^1^^0^6^3^Subscriber Sec ID Qualifier(2)^0^1
"DATA",364.6,1806,0)
8^N^^38^1^^0^7^30^Subscriber Sec ID(2)^0^1
"DATA",364.6,1807,0)
8^N^^38^1^^0^8^3^Subscriber Sec ID Qualifier(3)^0^1
"DATA",364.6,1808,0)
8^N^^38^1^^0^9^30^Subscriber Sec ID(3)^0^1
"DATA",364.6,1810,0)
8^N^^46^1^^0^2^3^Pt. Primary ID Qualifier^0^1
"DATA",364.6,1811,0)
8^N^^46^1^^0^3^30^Pt. Primary ID^0^1
"DATA",364.6,1812,0)
8^N^^46^1^^0^4^3^Pt. Sec ID Qualifier(1)^0^1
"DATA",364.6,1813,0)
8^N^^46^1^^0^5^30^Pt. Sec ID(1)^0^1
"DATA",364.6,1814,0)
8^N^^46^1^^0^6^3^Pt. Sec ID Qualifier(2)^0^1
"DATA",364.6,1815,0)
8^N^^46^1^^0^7^30^Pt. Sec ID(2)^0^1
"DATA",364.6,1816,0)
8^N^^46^1^^0^8^3^Pt. Sec ID Qualifier(3)^0^1
"DATA",364.6,1817,0)
8^N^^46^1^^0^9^30^Pt. Sec ID(3)^0^1
"DATA",364.6,1819,0)
8^N^^37^1^^0^2^3^Payer Primary ID Qualifier^0^1
"DATA",364.6,1820,0)
8^N^^37^1^^0^3^20^Payer Primary ID^0^1
"DATA",364.6,1821,0)
8^N^^110^1^^0^11^3^Other Subscriber Primary ID Qualifier^0^1
"DATA",364.6,1822,0)
8^N^^37^1^^0^4^3^Payer Sec ID Qualifier(1)^0^1
"DATA",364.6,1823,0)
8^N^^37^1^^0^5^30^Payer Sec ID(1)^0^1
"DATA",364.6,1824,0)
8^N^^37^1^^0^6^3^Payer Sec ID Qualifier(2)^0^1
"DATA",364.6,1825,0)
8^N^^37^1^^0^7^30^Payer Sec ID(2)^0^1
"DATA",364.6,1826,0)
8^N^^37^1^^0^8^3^Payer Sec ID Qualifier(3)^0^1
"DATA",364.6,1827,0)
8^N^^37^1^^0^9^30^Payer Sec ID(3)^0^1
"DATA",364.6,1831,0)
8^N^^114^1^^0^2^1^Payer Responsibility Sequence # Code^0^1
"DATA",364.6,1832,0)
8^N^^114^1^^0^3^3^Other Payer Primary ID Qualifier^0^1
"DATA",364.6,1834,0)
8^N^^114^1^^0^4^30^Other Payer Primary ID^0^1
"DATA",364.6,1835,0)
8^N^^114^1^^0^5^3^Other Payer Sec ID Qualifier(1)^0^1
"DATA",364.6,1836,0)
8^N^^114^1^^0^6^30^Other Payer Sec ID(1)^0^1
"DATA",364.6,1837,0)
8^N^^114^1^^0^7^3^Other Payer Sec ID Qualifier(2)^0^1
"DATA",364.6,1838,0)
8^N^^114^1^^0^8^30^Other Payer Sec ID(2)^0^1
"DATA",364.6,1839,0)
8^N^^114^1^^0^9^3^Other Payer Sec ID Qualifier(3)^0^1
"DATA",364.6,1840,0)
8^N^^114^1^^0^10^30^Other Payer Sec ID(3)^0^1
"DATA",364.6,1842,0)
8^N^^51^1^^0^10^3^Initial Treatment DT Qualifier^0^1
"DATA",364.6,1843,0)
8^N^^51^1^^0^12^3^Acute Manifestation DT Qualifier^0^1
"DATA",364.6,1844,0)
8^N^^51^1^^0^11^3^Last X-Ray DT Qualifier^0^1
"DATA",364.6,1845,0)
8^N^^40^1^^0^20^10^Pt. Name Suffix^0^1
"DATA",364.6,1846,0)
8^N^^60^1^^0^20^3^Billing Note Text Qualifier^0^1
"DATA",364.6,1847,0)
8^N^^60^1^^0^21^80^Billing Note Text^0^1
"DATA",364.6,1853,0)
8^N^^36^1^^0^5^25^Responsible Party First Name^0^1^^
"DATA",364.6,1854,0)
8^N^^36^1^^0^6^25^Responsible Party Middle Name^0^1^^
"DATA",364.6,1855,0)
8^N^^36^1^^0^7^10^Responsible Party Name Suffix^0^1^^
"DATA",364.6,1856,0)
8^N^^36^1^^0^8^50^Responsible Party Address 1^0^1^^
"DATA",364.6,1857,0)
8^N^^36^1^^0^9^35^Responsible Party Address 2^0^1^^
"DATA",364.6,1858,0)
8^N^^36^1^^0^10^30^Responsible Party City Name^0^1^^
"DATA",364.6,1859,0)
8^N^^36^1^^0^11^2^Responsible Party State Code^0^1^^
"DATA",364.6,1860,0)
8^N^^36^1^^0^12^15^Responsible Party ZIP Code^0^1^^
"DATA",364.6,1861,0)
8^N^^15^1^^0^2^30^BLANK^0^1
"DATA",364.6,1862,0)
8^N^^60^1^^0^5^29^BLANK^0^1
"DATA",364.6,1863,0)
8^N^^60^1^^0^6^30^BLANK^0^1
"DATA",364.6,1864,0)
8^N^^60^1^^0^7^12^BLANK^0^1
"DATA",364.6,1865,0)
8^N^^60^1^^0^8^13^BLANK^0^1
"DATA",364.6,1866,0)
8^N^^60^1^^0^9^5^BLANK^0^1
"DATA",364.6,1867,0)
8^N^^60^1^^0^10^6^BLANK^0^1
"DATA",364.6,1868,0)
8^N^^60^1^^0^11^13^BLANK^0^1
"DATA",364.6,1869,0)
8^N^^60^1^^0^12^14^BLANK^0^1
"DATA",364.6,1870,0)
8^N^^60^1^^0^13^14^BLANK^0^1
"DATA",364.6,1871,0)
8^N^^60^1^^0^14^14^BLANK^0^1
"DATA",364.6,1872,0)
8^N^^60^1^^0^15^14^BLANK^0^1
"DATA",364.6,1873,0)
8^N^^60^1^^0^16^27^BLANK^0^1
"DATA",364.6,1874,0)
8^N^^60^1^^0^17^2^BLANK^0^1
"DATA",364.6,1875,0)
8^N^^60^1^^0^18^3^BLANK^0^1
"DATA",364.6,1876,0)
8^N^^97^1^^0^13^3^BLANK^0^1
"DATA",364.6,1877,0)
8^N^^112^1^^0^2.8^^EXTRACT OTHER PAYER FULL ADDRESS^1^1
"DATA",364.6,1878,0)
8^N^^112^1^^0^99^^IBXSAVE CLEAN-UP^1^1
"DATA",364.7,1,0)
1^N^54^^^^N
"DATA",364.7,1,3,0)
^364.73^2^2^3071129^^
"DATA",364.7,1,3,1,0)
This is CI2-2.
"DATA",364.7,1,3,2,0)
FileMan Extract - CURRENT BILL PAYER SEQUENCE (Field .21, File 399)
"DATA",364.7,2,0)
4^N^2^^^^N
"DATA",364.7,2,1)
S IBXSAVE("INM")=$$NAME^IBCEFG1(IBXDATA) K IBXDATA
"DATA",364.7,2,3,0)
^^2^2^3071129^
"DATA",364.7,2,3,1,0)
Changes data element (name) into LAST^FIRST^MIDDLE^CRED^SUFFIX format.
"DATA",364.7,2,3,2,0)
Saves data in IBXSAVE array for use by later fields.  No output.
"DATA",364.7,24,0)
28^N^25^^^^N
"DATA",364.7,24,1)
S IBXDATA=$$PRELCNV^IBCNSP1(IBXDATA,1)
"DATA",364.7,24,3,0)
^^2^2^2960815^^^^
"DATA",364.7,24,3,1,0)
Calculates the X12 code for relationship from the DHCP code extracted.
"DATA",364.7,24,3,2,0)
If data element's value is null, do not output.
"DATA",364.7,114,0)
97^N^35^^^^N
"DATA",364.7,114,1)
N Z,Z0,IBZ M IBZ=IBXDATA K IBXDATA F Z=1,2 I $G(IBZ(Z))'="",$D(^DGCR(399,IBXIEN,"I"_(Z+1))) S Z0=$$PRELCNV^IBCNSP1(IBZ(Z),1) I Z0'="" S IBXDATA(Z)=Z0
"DATA",364.7,114,3,0)
^^4^4^2960815^^^^
"DATA",364.7,114,3,1,0)
This is a group data element so more than 1 occurrence of a value is
"DATA",364.7,114,3,2,0)
possible for the data element in the IBXDATA array.  If any other insurance
"DATA",364.7,114,3,3,0)
is found, the output is formatted as the X12 code for the DHCP value for
"DATA",364.7,114,3,4,0)
relationship.
"DATA",364.7,144,0)
1032^N^21^^^^N^0
"DATA",364.7,144,1)
S IBXDATA=$S($$FT^IBCEF(IBXIEN)=3:"",1:$$DT^IBCEFG1(IBXDATA,"","D8")) S:IBXDATA IBXSAVE("INIT-DATE")=1
"DATA",364.7,144,3,0)
^364.73^2^2^3041216^^^^
"DATA",364.7,144,3,1,0)
INITIAL TREATMENT DATE ON CLAIMS INVOLVING
"DATA",364.7,144,3,2,0)
 SPINAL MANIPULATION FOR MEDICARE PART B
"DATA",364.7,154,0)
188^N^5^^^^N
"DATA",364.7,154,1)
K IBXDATA I $P($G(IBXSAVE("CADR")),U,6)'="" S IBXDATA=$$NOPUNCT^IBCEF($P(IBXSAVE("CADR"),U,6),1)
"DATA",364.7,154,3,0)
^364.73^6^6^3071205^^^^
"DATA",364.7,154,3,1,0)
If header data has already been extracted, array ^TMP("IBHDR1",$J) will
"DATA",364.7,154,3,2,0)
already exist.  Don't want to extract this field again, so kill data
"DATA",364.7,154,3,3,0)
element so there is no output.  Also don't output data element if its
"DATA",364.7,154,3,4,0)
value is null.
"DATA",364.7,154,3,5,0)
This data relies on the presence of the IBXSAVE("CADR") array that should
"DATA",364.7,154,3,6,0)
have been set in a previous data field.
"DATA",364.7,186,0)
1033^N^29^^^^N^0
"DATA",364.7,186,1)
S IBXDATA=$S($$FT^IBCEF(IBXIEN)=3:"",1:$$DT^IBCEFG1(IBXDATA,"","D8")) S:IBXDATA IBXSAVE("XRAY-DATE")=1
"DATA",364.7,186,3,0)
^364.73^1^1^3041216^^^^
"DATA",364.7,186,3,1,0)
FIND THE LAST XRAY DATE WHEN CLAIM INVOLVES A SPINAL MANIPULATION
"DATA",364.7,197,0)
1037^N^36^^^^N^0
"DATA",364.7,197,1)
I $$FT^IBCEF(IBXIEN)=3 K IBXDATA
"DATA",364.7,197,3,0)
^364.73^2^2^3041216^^^^
"DATA",364.7,197,3,1,0)
SPINAL MANIP. CONDITION CODE; A = Acute Condition, C = Chronic Condition, D = Non-Acute
"DATA",364.7,197,3,2,0)
E = Non-Life Threatening, F = Routine, G = Symptomatic, M = Acute Manifestation of a Chronic Condition
"DATA",364.7,198,0)
1038^N^22^^^^N^0
"DATA",364.7,198,1)
S IBXDATA=$S($$FT^IBCEF(IBXIEN)=3:"",1:$$DT^IBCEFG1(IBXDATA,"","D8")) S:IBXDATA IBXSAVE("ACUT-DATE")=1
"DATA",364.7,198,3,0)
^364.73^2^2^3041216^^^^
"DATA",364.7,198,3,1,0)
Required when sequence 51 piece 7 (Spinal Manipulation Nature of Condifion Code) = A or M on spinal
"DATA",364.7,198,3,2,0)
manipulation claims and the payer is Medicare
"DATA",364.7,326,0)
1072^N^5^^^^N^0
"DATA",364.7,326,1)
N Z,ADDR,OK,PCE F Z=1,2 S ADDR=$G(IBXSAVE("OTH_PAY_ADDR",Z)) I ADDR'="" S OK=1 X "F PCE=1,4,5,6 I $P(ADDR,U,PCE)="""" S OK=0 Q" I 'OK K IBXSAVE("OTH_PAY_ADDR",Z)
"DATA",364.7,326,3,0)
^364.73^3^3^3080314^^^
"DATA",364.7,326,3,1,0)
If the other payer address is missing any component among address line 1, 
"DATA",364.7,326,3,2,0)
city, state, or zip, then blank out the entire address.  We can't send 
"DATA",364.7,326,3,3,0)
partial addresses.
"DATA",364.7,333,0)
1073^N^5^^^^N^0
"DATA",364.7,333,1)
N Z K IBXDATA S Z=0 F  S Z=$O(IBXSAVE("OTH_PAY_ADDR",Z)) Q:'Z  S IBXDATA(Z)=$P($G(IBXSAVE("OTH_PAY_ADDR",Z)),U,1)
"DATA",364.7,333,3,0)
^^1^1^3080314^
"DATA",364.7,333,3,1,0)
address line 1, multi-valued array
"DATA",364.7,334,0)
1074^N^5^^^^N^0
"DATA",364.7,334,1)
N Z K IBXDATA S Z=0 F  S Z=$O(IBXSAVE("OTH_PAY_ADDR",Z)) Q:'Z  S IBXDATA(Z)=$P($G(IBXSAVE("OTH_PAY_ADDR",Z)),U,2)
"DATA",364.7,334,3,0)
^^1^1^3080314^
"DATA",364.7,334,3,1,0)
Address line 2 in a multi-valued array
"DATA",364.7,358,0)
1075^N^5^^^^N^0
"DATA",364.7,358,1)
N Z K IBXDATA S Z=0 F  S Z=$O(IBXSAVE("OTH_PAY_ADDR",Z)) Q:'Z  S IBXDATA(Z)=$TR($P($G(IBXSAVE("OTH_PAY_ADDR",Z)),U,4),"-/.,()'","  ")
"DATA",364.7,358,3,0)
^^2^2^3080314^
"DATA",364.7,358,3,1,0)
Other payer city in a multi-valued array.  Do the standard punctuation 
"DATA",364.7,358,3,2,0)
edits for cities.
"DATA",364.7,359,0)
1076^N^5^^^^N^0
"DATA",364.7,359,1)
N Z K IBXDATA S Z=0 F  S Z=$O(IBXSAVE("OTH_PAY_ADDR",Z)) Q:'Z  S IBXDATA(Z)=$$STATE^IBCEFG1($P($G(IBXSAVE("OTH_PAY_ADDR",Z)),U,5))
"DATA",364.7,359,3,0)
^^2^2^3080314^
"DATA",364.7,359,3,1,0)
Other payer state code in a multi-valued array.  Use of the state code 
"DATA",364.7,359,3,2,0)
conversion utility.
"DATA",364.7,360,0)
1077^N^5^^^^N^0
"DATA",364.7,360,1)
N Z K IBXDATA S Z=0 F  S Z=$O(IBXSAVE("OTH_PAY_ADDR",Z)) Q:'Z  S IBXDATA(Z)=$P($G(IBXSAVE("OTH_PAY_ADDR",Z)),U,6)
"DATA",364.7,360,3,0)
^^1^1^3080314^
"DATA",364.7,360,3,1,0)
Other payer zip code in a multi-valued array.
"DATA",364.7,481,0)
581^N^5^^^^N
"DATA",364.7,481,1)
K IBXDATA
"DATA",364.7,481,3,0)
^^1^1^3071128^
"DATA",364.7,481,3,1,0)
This is being blanked out with IB patch 377.
"DATA",364.7,482,0)
579^N^5^^^^N
"DATA",364.7,482,1)
K IBXDATA N Z S Z=0 F  S Z=$O(IBXSAVE("INPT",Z)) Q:'Z  S:$P(IBXSAVE("INPT",Z),U,6)'="" IBXDATA(Z)=$$DOLLAR^IBCEFG1($P(IBXSAVE("INPT",Z),U,6))
"DATA",364.7,482,3,0)
^^6^6^3080107^
"DATA",364.7,482,3,1,0)
INS-12 for UB service line detail data.
"DATA",364.7,482,3,2,0)
 
"DATA",364.7,482,3,3,0)
This is a group data element so more than 1 occurrence of a value is
"DATA",364.7,482,3,4,0)
possible for the data element in the previously extract IBXSAVE array.  If
"DATA",364.7,482,3,5,0)
any service line data is found, the data is formatted as a numeric 
"DATA",364.7,482,3,6,0)
including cents, without the decimal.
"DATA",364.7,843,0)
813^N^5^^^^N
"DATA",364.7,843,1)
K IBXDATA
"DATA",364.7,843,3,0)
^^1^1^3071128^
"DATA",364.7,843,3,1,0)
This is being blanked out with IB patch 377.
"DATA",364.7,1028,0)
1312^N^101^^^^N
"DATA",364.7,1028,1)
N IBZ,Z,Z0 M IBZ=IBXDATA K IBXDATA I $O(IBXSAVE(1,0)) S (Z,Z0)=0 F  S Z=$O(IBXSAVE(1,Z)) Q:'Z  S Z0=Z0+1,IBXDATA(Z0)=IBXSAVE(1,Z) I Z0>1 D ID^IBCEF2(Z0,"OI4 ")
"DATA",364.7,1028,3,0)
^364.73^7^7^3030929^^^^
"DATA",364.7,1028,3,1,0)
This is a group data element so more than 1 occurrence of a value is
"DATA",364.7,1028,3,2,0)
possible for the data element in the IBXDATA array.  The IBXSAVE(1) variable
"DATA",364.7,1028,3,3,0)
holds the indicator of which insurance [(P)rimary/(S)econdary/(T)ertiary] is
"DATA",364.7,1028,3,4,0)
currently responsible for the bill.  Using this data as a guide, the next
"DATA",364.7,1028,3,5,0)
insurance for the primary is secondary, then tertiary.  For secondary, it's
"DATA",364.7,1028,3,6,0)
primary then tertiary, and for tertiary, it's primary, then secondary. For
"DATA",364.7,1028,3,7,0)
other than the first occurrence, the RECORD ID 'OI4 ' must be output.
"DATA",364.7,1362,0)
1662^N^197^^^^N
"DATA",364.7,1362,1)
N Z,FLG S FLG=$S($$ISRX^IBCEF1(IBXIEN):2,1:1) F Z=1:1:3 I $D(IBXDATA(Z)) S IBXDATA(Z)=$$PRELCNV^IBCNSP1(IBXDATA(Z),FLG)
"DATA",364.7,1362,3,0)
^364.73^5^5^3080407^^^
"DATA",364.7,1362,3,1,0)
IB patch 377
"DATA",364.7,1362,3,2,0)
Convert the VistA codes into HIPAA or NCPDP codes.
"DATA",364.7,1362,3,3,0)
HIPAA codes are the same as EDI codes.
"DATA",364.7,1362,3,4,0)
FLG variable controls conversion:
"DATA",364.7,1362,3,5,0)
 1 - convert to HIPAA, 2 - convert to NCPDP.
"DATA",364.7,1553,0)
1853^N^5^^^^N
"DATA",364.7,1553,1)
K IBXDATA
"DATA",364.7,1554,0)
1854^N^5^^^^N
"DATA",364.7,1554,1)
K IBXDATA
"DATA",364.7,1555,0)
1855^N^5^^^^N
"DATA",364.7,1555,1)
K IBXDATA
"DATA",364.7,1556,0)
1856^N^5^^^^N
"DATA",364.7,1556,1)
K IBXDATA
"DATA",364.7,1557,0)
1857^N^5^^^^N
"DATA",364.7,1557,1)
K IBXDATA
"DATA",364.7,1558,0)
1858^N^5^^^^N
"DATA",364.7,1558,1)
K IBXDATA
"DATA",364.7,1559,0)
1859^N^5^^^^N
"DATA",364.7,1559,1)
K IBXDATA
"DATA",364.7,1560,0)
1860^N^5^^^^N
"DATA",364.7,1560,1)
K IBXDATA
"DATA",364.7,1561,0)
1861^N^5^^^^N
"DATA",364.7,1561,1)
K IBXDATA
"DATA",364.7,1562,0)
1862^N^5^^^^N
"DATA",364.7,1562,1)
K IBXDATA
"DATA",364.7,1563,0)
1863^N^5^^^^N
"DATA",364.7,1563,1)
K IBXDATA
"DATA",364.7,1564,0)
1864^N^5^^^^N
"DATA",364.7,1564,1)
K IBXDATA
"DATA",364.7,1565,0)
1865^N^5^^^^N
"DATA",364.7,1565,1)
K IBXDATA
"DATA",364.7,1566,0)
1866^N^5^^^^N
"DATA",364.7,1566,1)
K IBXDATA
"DATA",364.7,1567,0)
1867^N^5^^^^N
"DATA",364.7,1567,1)
K IBXDATA
"DATA",364.7,1568,0)
1868^N^5^^^^N
"DATA",364.7,1568,1)
K IBXDATA
"DATA",364.7,1569,0)
1869^N^5^^^^N
"DATA",364.7,1569,1)
K IBXDATA
"DATA",364.7,1570,0)
1870^N^5^^^^N
"DATA",364.7,1570,1)
K IBXDATA
"DATA",364.7,1571,0)
1871^N^5^^^^N
"DATA",364.7,1571,1)
K IBXDATA
"DATA",364.7,1572,0)
1872^N^5^^^^N
"DATA",364.7,1572,1)
K IBXDATA
"DATA",364.7,1573,0)
1873^N^5^^^^N
"DATA",364.7,1573,1)
K IBXDATA
"DATA",364.7,1574,0)
1874^N^5^^^^N
"DATA",364.7,1574,1)
K IBXDATA
"DATA",364.7,1575,0)
1875^N^5^^^^N
"DATA",364.7,1575,1)
K IBXDATA
"DATA",364.7,1576,0)
1876^N^5^^^^N
"DATA",364.7,1576,1)
K IBXDATA
"DATA",364.7,1577,0)
1877^N^5^^^^N
"DATA",364.7,1577,1)
N Z,Z0,SEQ K IBXSAVE("OTH_PAY_ADDR") I $O(IBXSAVE(1,0)) S (Z,Z0)=0 F  S Z=$O(IBXSAVE(1,Z)) Q:'Z  S Z0=Z0+1,SEQ=IBXSAVE(1,Z),IBXSAVE("OTH_PAY_ADDR",Z0)=$$ADD^IBCNADD(IBXIEN,SEQ)
"DATA",364.7,1577,3,0)
^^24^24^3080313^
"DATA",364.7,1577,3,1,0)
The IBXSAVE input array should still exist from the piece 2 call to
"DATA",364.7,1577,3,2,0)
data element N-OTH INSURANCE SEQUENCE.
"DATA",364.7,1577,3,3,0)
 
"DATA",364.7,1577,3,4,0)
Input:
"DATA",364.7,1577,3,5,0)
IBXSAVE(1)=current payer sequence letter
"DATA",364.7,1577,3,6,0)
IBXSAVE(1,Z)=other payer sequence letters where Z is the payer sequence
"DATA",364.7,1577,3,7,0)
number of the other payers
"DATA",364.7,1577,3,8,0)
 
"DATA",364.7,1577,3,9,0)
Loop through this to produce the output IBXSAVE array.
"DATA",364.7,1577,3,10,0)
 
"DATA",364.7,1577,3,11,0)
Output:
"DATA",364.7,1577,3,12,0)
IBXSAVE("OTH_PAY_ADDR",1)=address string for other payer#1
"DATA",364.7,1577,3,13,0)
IBXSAVE("OTH_PAY_ADDR",2)=address string for other payer#2
"DATA",364.7,1577,3,14,0)
 
"DATA",364.7,1577,3,15,0)
Address string format:
"DATA",364.7,1577,3,16,0)
  [1] address line 1
"DATA",364.7,1577,3,17,0)
  [2] address line 2
"DATA",364.7,1577,3,18,0)
  [3] address line 3
"DATA",364.7,1577,3,19,0)
  [4] city
"DATA",364.7,1577,3,20,0)
  [5] state ien ptr to file 5
"DATA",364.7,1577,3,21,0)
  [6] zipcode
"DATA",364.7,1577,3,22,0)
 
"DATA",364.7,1577,3,23,0)
Utility call $$ADD^IBCNADD(IBXIEN,SEQ) to pull the payer address for the
"DATA",364.7,1577,3,24,0)
payer at the specified payer sequence.
"DATA",364.7,1578,0)
1878^N^5^^^^N
"DATA",364.7,1578,1)
K IBXSAVE("OTH_PAY_ADDR")
"FIA",2)
PATIENT
"FIA",2,0)
^DPT(
"FIA",2,0,0)
2I
"FIA",2,0,1)
y^y^p^^^^n^^n
"FIA",2,0,10)

"FIA",2,0,11)

"FIA",2,0,"RLRO")

"FIA",2,0,"VR")
2.0^IB
"FIA",2,2)
1
"FIA",2,2.312)
1
"FIA",2,2.312,4.03)

"FIA",2,2.312,16)

"FIA",2,2.312,17)

"FIA",350.8)
IB ERROR
"FIA",350.8,0)
^IBE(350.8,
"FIA",350.8,0,0)
350.8I
"FIA",350.8,0,1)
n^n^f^^n^^y^o^n
"FIA",350.8,0,10)

"FIA",350.8,0,11)
I $F(".IB123.IB172.IB173.","."_$P($G(^IBE(350.8,+Y,0)),U,1)_".")
"FIA",350.8,0,"RLRO")

"FIA",350.8,0,"VR")
2.0^IB
"FIA",350.8,350.8)
0
"FIA",350.9)
IB SITE PARAMETERS
"FIA",350.9,0)
^IBE(350.9,
"FIA",350.9,0,0)
350.9I
"FIA",350.9,0,1)
y^y^p^^^^n^^n
"FIA",350.9,0,10)

"FIA",350.9,0,11)

"FIA",350.9,0,"RLRO")

"FIA",350.9,0,"VR")
2.0^IB
"FIA",350.9,350.9)
1
"FIA",350.9,350.9,1.04)

"FIA",355.33)
INSURANCE BUFFER
"FIA",355.33,0)
^IBA(355.33,
"FIA",355.33,0,0)
355.33DA
"FIA",355.33,0,1)
y^y^p^^^^n^^n
"FIA",355.33,0,10)

"FIA",355.33,0,11)

"FIA",355.33,0,"RLRO")

"FIA",355.33,0,"VR")
2.0^IB
"FIA",355.33,355.33)
1
"FIA",355.33,355.33,60.06)

"FIA",355.33,355.33,60.14)

"FIA",356)
CLAIMS TRACKING
"FIA",356,0)
^IBT(356,
"FIA",356,0,0)
356I
"FIA",356,0,1)
y^y^p^^^^n^^n
"FIA",356,0,10)

"FIA",356,0,11)

"FIA",356,0,"RLRO")

"FIA",356,0,"VR")
2.0^IB
"FIA",356,356)
1
"FIA",356,356,1.08)

"FIA",361.1)
EXPLANATION OF BENEFITS
"FIA",361.1,0)
^IBM(361.1,
"FIA",361.1,0,0)
361.1PI
"FIA",361.1,0,1)
y^y^p^^^^n^^n
"FIA",361.1,0,10)

"FIA",361.1,0,11)

"FIA",361.1,0,"RLRO")

"FIA",361.1,0,"VR")
2.0^IB
"FIA",361.1,361.1)
1
"FIA",361.1,361.1,6.03)

"FIA",361.1,361.1,61.01)

"FIA",361.1,361.1,62.01)

"FIA",364.5)
IB DATA ELEMENT DEFINITION
"FIA",364.5,0)
^IBA(364.5,
"FIA",364.5,0,0)
364.5I
"FIA",364.5,0,1)
n^n^f^^y^^y^o^n
"FIA",364.5,0,10)

"FIA",364.5,0,11)
I $$INCLUDE^IBY377PR(5,Y)
"FIA",364.5,0,"RLRO")

"FIA",364.5,0,"VR")
2.0^IB
"FIA",364.5,364.5)
0
"FIA",364.5,364.53)
0
"FIA",364.6)
IB FORM SKELETON DEFINITION
"FIA",364.6,0)
^IBA(364.6,
"FIA",364.6,0,0)
364.6IP
"FIA",364.6,0,1)
y^n^f^^y^^y^o^n
"FIA",364.6,0,10)

"FIA",364.6,0,11)
I $$INCLUDE^IBY377PR(6,Y)
"FIA",364.6,0,"RLRO")

"FIA",364.6,0,"VR")
2.0^IB
"FIA",364.6,364.6)
0
"FIA",364.7)
IB FORM FIELD CONTENT
"FIA",364.7,0)
^IBA(364.7,
"FIA",364.7,0,0)
364.7IP
"FIA",364.7,0,1)
n^n^f^^y^^y^o^n
"FIA",364.7,0,10)

"FIA",364.7,0,11)
I $$INCLUDE^IBY377PR(7,Y)
"FIA",364.7,0,"RLRO")

"FIA",364.7,0,"VR")
2.0^IB
"FIA",364.7,364.7)
0
"FIA",364.7,364.73)
0
"FIA",399)
BILL/CLAIMS
"FIA",399,0)
^DGCR(399,
"FIA",399,0,0)
399I
"FIA",399,0,1)
y^y^p^^^^n^^n
"FIA",399,0,10)

"FIA",399,0,11)

"FIA",399,0,"RLRO")

"FIA",399,0,"VR")
2.0^IB
"FIA",399,399)
1
"FIA",399,399,28.1)

"FIA",399,399,77)

"FIA",399,399.042)
1
"FIA",399,399.042,.09)

"FIA",399,399.077)
0
"FIA",399,399.0771)
0
"INI")
IBY377PR
"INIT")
IBY377PO
"IX",364.6,364.6,"ALL",0)
364.6^ALL^Allows for identification of local override fields that apply to ALL^MU^^F^IR^I^364.6^^^^^S
"IX",364.6,364.6,"ALL",1)
S ^IBA(364.7,"ALL",DA,X2(5))=""
"IX",364.6,364.6,"ALL",1.4)
I X2(4)'="L"!'X2(5)!(X2(2)'="")!(X2(3)'="")!'X2(1) S X=0
"IX",364.6,364.6,"ALL",2)
K ^IBA(364.7,"ALL",DA,X1(5))
"IX",364.6,364.6,"ALL",2.4)
I X1(4)'="L"!'X1(5)!(X1(2)'="")!(X1(3)'="")!'X1(1) S X=0
"IX",364.6,364.6,"ALL",2.5)
K ^IBA(364.7,"ALL")
"IX",364.6,364.6,"ALL",11.1,0)
^.114IA^5^5
"IX",364.6,364.6,"ALL",11.1,1,0)
1^F^364.6^.03^^1^F
"IX",364.6,364.6,"ALL",11.1,1,1)
 
"IX",364.6,364.6,"ALL",11.1,2,0)
2^C
"IX",364.6,364.6,"ALL",11.1,2,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,5)
"IX",364.6,364.6,"ALL",11.1,3,0)
3^C
"IX",364.6,364.6,"ALL",11.1,3,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,6)
"IX",364.6,364.6,"ALL",11.1,4,0)
4^C
"IX",364.6,364.6,"ALL",11.1,4,1.5)
N Z S Z=+$O(^IBA(364.7,"B",DA,0)) I Z S X=$P($G(^IBA(364.7,Z,0)),U,2)
"IX",364.6,364.6,"ALL",11.1,5,0)
5^C
"IX",364.6,364.6,"ALL",11.1,5,1.5)
S X=+$O(^IBA(364.7,"B",DA,0))
"IX",364.6,364.6,"C",0)
364.6^C^Field name lookup^R^^F^IR^I^364.6^^^^^LS
"IX",364.6,364.6,"C",1)
S ^IBA(364.6,"C",$E(X,1,40),DA)=""
"IX",364.6,364.6,"C",2)
K ^IBA(364.6,"C",$E(X,1,40),DA)
"IX",364.6,364.6,"C",2.5)
K ^IBA(364.6,"C")
"IX",364.6,364.6,"C",11.1,0)
^.114IA^1^1
"IX",364.6,364.6,"C",11.1,1,0)
1^F^364.6^.1^40^1^F
"IX",364.6,364.6,"C",11.1,1,2)
S X=$$UP^XLFSTR(X)
"IX",364.6,364.6,"C",11.1,1,3)

"IX",364.6,364.6,"D",0)
364.6^D^XREF BY FORM,PAGE,LINE,COL TO SIMPLIFY DEVELOPMENT^MU^^R^IR^I^364.6^^^^^LS
"IX",364.6,364.6,"D",1)
S ^IBA(364.6,"D",X2(1)_","_X2(2)_","_X2(3)_","_X2(4),DA)=""
"IX",364.6,364.6,"D",1.4)
I X2(1)=""!(X2(2)="")!(X2(3)="")!(X2(4)="") S X=0
"IX",364.6,364.6,"D",2)
K ^IBA(364.6,"D",X1(1)_","_X1(2)_","_X1(3)_","_X1(4),DA)
"IX",364.6,364.6,"D",2.4)
I X1(1)=""!(X1(2)="")!(X1(3)="")!(X1(4)="") S X=0
"IX",364.6,364.6,"D",2.5)
K ^IBA(364.6,"D")
"IX",364.6,364.6,"D",11.1,0)
^.114IA^4^4
"IX",364.6,364.6,"D",11.1,1,0)
1^F^364.6^.01^^1^F
"IX",364.6,364.6,"D",11.1,2,0)
2^F^364.6^.04^^^F
"IX",364.6,364.6,"D",11.1,3,0)
3^F^364.6^.05^^^F
"IX",364.6,364.6,"D",11.1,4,0)
4^F^364.6^.08^^^F
"IX",364.7,364.7,"ALL",0)
364.7^ALL^Xref contains all local overrides defined for all insurance and type^MU^^F^IR^I^364.7^^^^^S
"IX",364.7,364.7,"ALL",1)
S ^IBA(364.7,"ALL",X2(2),DA)=""
"IX",364.7,364.7,"ALL",1.4)
I 'X2(2)!(X2(4)'="")!(X2(5)'="")!(X2(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2)
K ^IBA(364.7,"ALL",X1(2),DA)
"IX",364.7,364.7,"ALL",2.4)
I 'X1(2)!(X1(4)'="")!(X1(5)'="")!(X1(3)'="L") S X=0
"IX",364.7,364.7,"ALL",2.5)
K ^IBA(364.7,"ALL")
"IX",364.7,364.7,"ALL",11.1,0)
^.114IA^5^5
"IX",364.7,364.7,"ALL",11.1,1,0)
1^F^364.7^.01^15^^F
"IX",364.7,364.7,"ALL",11.1,1,3)
 
"IX",364.7,364.7,"ALL",11.1,2,0)
2^C^^^10^1
"IX",364.7,364.7,"ALL",11.1,2,1.5)
S X=$P($G(^IBA(364.6,+X(1),0)),U,3)
"IX",364.7,364.7,"ALL",11.1,3,0)
3^F^364.7^.02^10^^F
"IX",364.7,364.7,"ALL",11.1,3,3)
 
"IX",364.7,364.7,"ALL",11.1,4,0)
4^F^364.7^.05^20^^F
"IX",364.7,364.7,"ALL",11.1,4,3)
 
"IX",364.7,364.7,"ALL",11.1,5,0)
5^F^364.7^.06^20^^F
"IX",364.7,364.7,"ALL",11.1,5,3)
 
"KRN",.402,1077,-1)
0^2
"KRN",.402,1077,0)
IB SCREEN7^3080131.1509^@^399^^@^3070215
"KRN",.402,1077,"DIAB",1,1,399.043,0)
ALL
"KRN",.402,1077,"DIAB",4,0,399,1)
UB-04 TIMEFRAME OF BILL;TIMEFRAME OF BILL~
"KRN",.402,1077,"DIAB",11,0,399,0)
UB-04 LOCATION OF CARE;LOCATION OF CARE~
"KRN",.402,1077,"DIAB",13,0,399,0)
UB-04 BILL CLASSIFICATION;BILL CLASSIFICATION~
"KRN",.402,1077,"DR",1,399)
S:IBDR20'["74" Y="@71";S:$D(IBOUT) Y="@999";43;@999;K IBOUT;@71;S:IBDR20'["71" Y="@72";S:$P($G(^DGCR(399,DA,0)),U,19)'=3 Y="@712";@711;S DIE("NO^")="";.24LOCATION OF CARE~~;S:'$D(DIE("NO^")) DIE("NO^")="";.25BILL CLASSIFICATION~~;
"KRN",.402,1077,"DR",1,399,1)
I '$$TOBIN^IBCU4($P(^DGCR(399,DA,0),U,25),DA) W !!,*7,"  **  The 'BILL CLASSIFICATION' must be consistent with the 'LOCATION OF CARE.'",! S Y="@711";@712;K DIE("NO^");.26TIMEFRAME OF BILL~~;216;217;162;.22;243;
"KRN",.402,1077,"DR",1,399,2)
D DISPTAX^IBCEP81($P($G(^DGCR(399,DA,"U3")),U,2),"Default Division");.27;S DGRVRCAL=1;S DIPA("FT1")=$P($G(^DGCR(399,DA,0)),U,19);D CKFT^IBCIUT1(IBIFN);@714;.19;S DIPA("FT")=$P($G(^DGCR(399,DA,0)),U,19);
"KRN",.402,1077,"DR",1,399,3)
I $P($G(^IBE(353,+DIPA("FT"),2)),U,2)="P",$P($G(^(2)),U,4) S DIPA("FT1")=DIPA("FT") D CKFT^IBCIUT1(IBIFN) S Y="@715";W !,*7,"Must be a printable national form type";.19///^S X=$G(DIPA("FT1"));S Y="@714";@715;D FTPRV^IBCEU5(DA);@72;
"KRN",.402,1077,"DR",1,399,4)
S:IBDR20'["72" Y="@73";155;S:X=0 Y=156;157;156;S:'$D(IBOX) Y="@73";153;@73;S:IBDR20'["73" Y="@75";151;152;@75;S:IBDR20'["75" Y="@76";D RCD^IBCU1;42;202;S:'X Y="@757";203;@757;I $P(^DGCR(399,DA,"U1"),"^",11)']"" S Y="@76";210;@76;
"KRN",.402,1077,"DR",1,399,5)
@77;S:IBDR20'["77" Y="@78";S:'$D(^DGCR(399,DA,"I1")) Y="@772";218;@772;S:'$D(^DGCR(399,DA,"I2")) Y="@773";219;@773;S:'$D(^DGCR(399,DA,"I3")) Y="@78";220;@78;K DIE("NO^");
"KRN",.402,1077,"DR",2,399.042)
.01;.02;.03;.04;.05;.09;.06;I '$P(^DGCR(399,DA(1),"RC",DA,0),U,6) S Y="@758";.07//^S X=$$DEFDIV^IBCU7(DA(1));@758;I +$P(^DGCR(399,DA(1),"RC",DA,0),U,8) W !," AUTO ADDED CHARGE - NO CHANGE TO TYPE/COMPONENT" S Y="@759";.1;.12;
"KRN",.402,1077,"DR",2,399.042,1)
I $S($P($G(^DGCR(399,DA(1),"RC",DA,0)),U,10)=3:0,1:$P($G(^(0)),U,10)'=4)!$P($G(^(0)),U,8) S Y="@759";I $P($G(^DGCR(399,DA(1),"RC",DA,0)),U,10)=4 S Y="@7581";S DGRVRCAL=1;D LINKRX^IBCEU5(DA(1),DA);.15;S Y="@759";@7581;
"KRN",.402,1077,"DR",2,399.042,2)
D LINKCPT^IBCEU5(DA(1),DA);@759;
"KRN",.402,1077,"DR",2,399.043)
.01
"KRN",.402,1077,"ROU")
^IBXSC7
"KRN",.402,1077,"ROUOLD")
IBXSC7
"KRN",.402,1080,-1)
0^4
"KRN",.402,1080,0)
IB SCREEN8H^3080312.1046^@^399^^@^3080312
"KRN",.402,1080,"%D",0)
^^1^1^3070110^
"KRN",.402,1080,"%D",1,0)
Billing screen 8 input template for form type CMS-1500.
"KRN",.402,1080,"DIAB",1,0,399,1)
TREATMENT AUTHORIZATION CODE;"PRIMARY AUTHORIZATION CODE"
"KRN",.402,1080,"DIAB",1,0,399,2)
NON-VA FACILITY:
"KRN",.402,1080,"DIAB",1,1,355.93,1)
FACILITY DEFAULT ID NUMBER;REQ;"LAB OR FACILITY PRIMARY ID"
"KRN",.402,1080,"DIAB",1,1,399.0222,2)
PERFORMED BY:355.93:
"KRN",.402,1080,"DIAB",1,2,355.9342,0)
ALL
"KRN",.402,1080,"DIAB",1,3,355.9342,0)
ALL
"KRN",.402,1080,"DIAB",4,1,399.0222,9)
PRIM INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1080,"DIAB",5,1,399.0222,9)
PRIMARY INS CO ID NUMBER;T
"KRN",.402,1080,"DIAB",7,0,399,4)
D ASK19^IBCEU3(DA);X
"KRN",.402,1080,"DIAB",8,0,399,0)
FORM LOCATOR 64A;T
"KRN",.402,1080,"DIAB",8,1,399.0222,9)
SEC INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1080,"DIAB",9,1,399.0222,9)
SECONDARY INS CO ID NUMBER;T
"KRN",.402,1080,"DIAB",9,2,355.93,1)
FACILITY DEFAULT ID NUMBER;REQ;"LAB OR FACILITY PRIMARY ID"
"KRN",.402,1080,"DIAB",10,0,399,0)
FORM LOCATOR 64B;T
"KRN",.402,1080,"DIAB",12,1,399.0222,9)
TERT INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1080,"DIAB",13,1,399.0222,9)
TERTIARY INS CO ID NUMBER;T
"KRN",.402,1080,"DR",1,399)
K DIPA S DIPA("I1")=$D(^DGCR(399,DA,"I1")),DIPA("I2")=$D(^("I2")),DIPA("I3")=$D(^("I3"));S:IBDR20'["81" Y="@82";166;167;@82;S:IBDR20'["82" Y="@83";215;453T~;S:'DIPA("I2") Y="@825";454T~;S:'DIPA("I3") Y="@825";455;@825;
"KRN",.402,1080,"DR",1,399,1)
163PRIMARY AUTHORIZATION CODE~;S:'DIPA("I2") Y="@83";230;S:'DIPA("I3") Y="@83";231;@83;S:IBDR20'["83" Y="@84";222;@84;S:IBDR20'["84" Y="@86";232;S DIPA("NVA_FC")=X S:X="" Y="@846";
"KRN",.402,1080,"DR",1,399,2)
^355.93^IBA(355.93,^^S I(0,0)=D0 S Y(1)=$S($D(^DGCR(399,D0,"U2")):^("U2"),1:"") S X=$P(Y(1),U,10),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");S DIK="^DGCR(399,",DIK(1)="232" D EN1^DIK;K DIK;244;
"KRN",.402,1080,"DR",1,399,3)
D DISPTAX^IBCEP81($P($G(^DGCR(399,DA,"U3")),U,3),"Non-VA Facility");233;@846;S DIPA("OLDCLIA")=$P($G(^DGCR(399,DA,"U2")),U,13);235;I X="",$G(DIPA("OLDCLIA"))'="" S IBMDOTCN=1;@847;I '$$XRAY^IBCEP8A(DA) S Y="@848";
"KRN",.402,1080,"DR",1,399,4)
D MAMMODP^IBCEP8A(DA);242;@848;@86;S:IBDR20'["86" Y="@87";459;D ASK19^IBCEU3(DA);236;237;238//^S X=$S($$WNRBILL^IBEFUNC(DA):"31",1:"");@87;S:IBDR20'["87" Y="@99";I '$P($G(^DGCR(399,DA,"TX")),U,8),'$$TXMT^IBCEF4(DA) S Y="@872";
"KRN",.402,1080,"DR",1,399,5)
I $$REQMRA^IBEFUNC(DA) S Y="@8711";27//NO FORCED PRINT;S Y="@872";@8711;28//NO FORCED PRINT;@872;@99;
"KRN",.402,1080,"DR",2,355.93)
S DIPA("NVA_FC-0")=$G(^IBA(355.93,+DIPA("NVA_FC"),0)) S:$P(DIPA("NVA_FC-0"),U,5)'=""&($P(DIPA("NVA_FC-0"),U,6)'="")&($P(DIPA("NVA_FC-0"),U,7)'="") Y="@841";.05;.1;.06;.07;.08;@841;S:$P(DIPA("NVA_FC-0"),U,9)'="" Y="@842";
"KRN",.402,1080,"DR",2,355.93,1)
.09LAB OR FACILITY PRIMARY ID~R~;@842;S:$P(DIPA("NVA_FC-0"),U,11)'="" Y="@843";.11;@843;S:$P(DIPA("NVA_FC-0"),U,14)'="" Y="@844";D EN2^IBCEP82(+DIPA("NVA_FC"),2);@844;S:$D(^IBA(355.93,+DIPA("NVA_FC"),"TAXONOMY"))>0 Y="@845";42;
"KRN",.402,1080,"DR",2,355.93,2)
@845;
"KRN",.402,1080,"DR",2,399.0222)
.01;S DIPA("RF")=X S:$D(^XUSEC("IB PROVIDER EDIT",DUZ)) DLAYGO=355.93;.02;K DLAYGO S DIPA("PRF")=X S:X="" Y="@98";N Z1 S Z1=$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,2) S DIPA("NVA_PRV")=$S(Z1["IBA(355.93":+Z1,1:0);
"KRN",.402,1080,"DR",2,399.0222,1)
S:DIPA("NVA_PRV")=0 Y="@828";
"KRN",.402,1080,"DR",2,399.0222,2)
^355.93^IBA(355.93,^^N DIERR X DR(99,1,9.2) K DIC S DIC="^IBA(355.93,",DIC(0)="MF" D ^DIC S (D,D0,D(0))=+Y S Y(101)=$S($D(^IBA(355.93,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");@828;
"KRN",.402,1080,"DR",2,399.0222,3)
S DIK="^DGCR(399,"_DA(1)_",""PRV"",",DIK(1)=".02" D EN1^DIK K DIK;S Z1=$P($$PROVID^IBCEF73(DA(1)),U,$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U));
"KRN",.402,1080,"DR",2,399.0222,4)
I Z1="",$P($G(DIPA("NVA_PRV-0")),U,2)=2 N X,Y,DIR S DIR(0)="EA",DIR("A",1)="You must use Provider ID Maintenance to enter an SSN or EIN for this provider.",DIR("A")="PRESS RETURN TO CONTINUE: " W ! D ^DIR W ! K DIR;.15;
"KRN",.402,1080,"DR",2,399.0222,5)
D DISPTAX^IBCEP81($P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,15),"");N Z S Z=$$EXPAND^IBTRE(399.0222,.08,$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,8)),DIPA("SPC")=$S(Z'="":Z,1:"UNSPECIFIED") W !,"    Prov Specialty On File: ",DIPA("SPC");
"KRN",.402,1080,"DR",2,399.0222,6)
S DIPA("CRD")=$$CRED^IBCEU($P(^DGCR(399,DA(1),"PRV",DA,0),U,2));.03;K DIPA("W1") S:$G(DIPA("CRD"))'=$P(^DGCR(399,DA(1),"PRV",DA,0),U,3) DIPA("W1")=1;I $G(DIPA("W1")) D WRT1^IBCSC8H($G(DIPA("CRD")));K DIPA("W1");
"KRN",.402,1080,"DR",2,399.0222,7)
I '$G(DIPA("I1")) S Y="@8305";D PROVID^IBCEP2B(DA(1),DA,1,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8382",DIPA("EDIT")=1:"@8391",DIPA("EDIT")=2:"@8371",1:"");@8382;I '$G(DIPA("I2")) S Y="@8305";
"KRN",.402,1080,"DR",2,399.0222,8)
D PROVID^IBCEP2B(DA(1),DA,2,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8383",DIPA("EDIT")=1:"@8392",DIPA("EDIT")=2:"@8372",1:"");@8383;I '$G(DIPA("I3")) S Y="@8305";
"KRN",.402,1080,"DR",2,399.0222,9)
D PROVID^IBCEP2B(DA(1),DA,3,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8305",DIPA("EDIT")=1:"@8393",DIPA("EDIT")=2:"@8373",1:"");S Y="@8305";@8391;.12R~T~;.05T~;S Y="@8382";@8392;.13R~T~;.06T~;S Y="@8383";@8393;.14R~T~;.07T~;S Y="@8305";@8371;
"KRN",.402,1080,"DR",2,399.0222,10)
.12////^S X=DIPA("PRIDT");.05////^S X=DIPA("PRID");S Y="@8382";@8372;.13////^S X=DIPA("PRIDT");.06////^S X=DIPA("PRID");S Y="@8383";@8373;.14////^S X=DIPA("PRIDT");.07////^S X=DIPA("PRID");S Y="@8305";@8305;@98;W @IOF;
"KRN",.402,1080,"DR",3,355.93)
S DIPA("NVA_PRV-0")=$G(^IBA(355.93,DIPA("NVA_PRV"),0));S:$P(DIPA("NVA_PRV-0"),U,2)=1 Y="@822";S:$P(DIPA("NVA_PRV-0"),U,3)'="" Y="@821";.03;@821;S:$P(DIPA("NVA_PRV-0"),U,3)'="" Y="@825";.04;S Y="@825";@822;
"KRN",.402,1080,"DR",3,355.93,1)
S:$P(DIPA("NVA_PRV-0"),U,5)'=""&($P(DIPA("NVA_PRV-0"),U,6)'="")&($P(DIPA("NVA_PRV-0"),U,7)'="") Y="@823";.05;.1;.06;.07;.08;@823;S:$P(DIPA("NVA_PRV-0"),U,9)'="" Y="@824";.09LAB OR FACILITY PRIMARY ID~R~;@824;
"KRN",.402,1080,"DR",3,355.93,2)
S:$P(DIPA("NVA_PRV-0"),U,11)'="" Y="@825";.11;@825;S:$P(DIPA("NVA_PRV-0"),U,14)'="" Y="@826";D EN2^IBCEP82(DIPA("NVA_PRV"),4);@826;S:$D(^IBA(355.93,DIPA("NVA_PRV"),"TAXONOMY"))>0 Y="@827";42;@827;
"KRN",.402,1080,"DR",3,355.9342)
.01:.03
"KRN",.402,1080,"DR",4,355.9342)
.01:.03
"KRN",.402,1080,"DR",99,1)
N DIERR X DR(99,1,9.2) K DIC S DIC="^IBA(355.93,",DIC(0)="MF" D ^DIC S (D,D0,D(0))=+Y S Y(101)=$S($D(^IBA(355.93,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0)
"KRN",.402,1080,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^DGCR(399,D0,"PRV",D1,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(399.0222,.02,"",$P(Y(1),U,2))
"KRN",.402,1080,"ROUOLD")
IBXSC8H
"KRN",.402,1316,-1)
0^3
"KRN",.402,1316,0)
IB SCREEN82^3080312.105^@^399^^@^3080324
"KRN",.402,1316,"%D",0)
^^1^1^3070328^
"KRN",.402,1316,"%D",1,0)
Billing screen 8 for UB claims.
"KRN",.402,1316,"DIAB",1,1,355.93,1)
FACILITY DEFAULT ID NUMBER;REQ;"LAB OR FACILITY PRIMARY ID"
"KRN",.402,1316,"DIAB",1,1,399.0222,2)
PERFORMED BY:355.93:
"KRN",.402,1316,"DIAB",1,2,355.9342,0)
ALL
"KRN",.402,1316,"DIAB",1,3,355.9342,0)
ALL
"KRN",.402,1316,"DIAB",4,0,399,0)
FORM LOCATOR 64A;T
"KRN",.402,1316,"DIAB",4,0,399,3)
NON-VA FACILITY:
"KRN",.402,1316,"DIAB",4,1,399.0222,9)
PRIM INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1316,"DIAB",5,1,399.0222,9)
PRIMARY INS CO ID NUMBER;T
"KRN",.402,1316,"DIAB",6,0,399,0)
FORM LOCATOR 64B;T
"KRN",.402,1316,"DIAB",8,0,399,0)
FORM LOCATOR 64C;T
"KRN",.402,1316,"DIAB",8,1,399.0222,9)
SEC INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1316,"DIAB",9,1,399.0222,9)
SECONDARY INS CO ID NUMBER;T
"KRN",.402,1316,"DIAB",9,2,355.93,1)
FACILITY DEFAULT ID NUMBER;REQ;"LAB OR FACILITY PRIMARY ID"
"KRN",.402,1316,"DIAB",10,0,399,0)
TREATMENT AUTHORIZATION CODE;"PRIMARY AUTHORIZATION CODE"
"KRN",.402,1316,"DIAB",12,1,399.0222,9)
TERT INS PROVIDER ID TYPE;T;REQ
"KRN",.402,1316,"DIAB",13,1,399.0222,9)
TERTIARY INS CO ID NUMBER;T
"KRN",.402,1316,"DR",1,399)
K DIPA S DIPA("I1")=$D(^DGCR(399,DA,"I1")),DIPA("I2")=$D(^("I2")),DIPA("I3")=$D(^("I3"));S:IBDR20'["81" Y="@82";402;453T~;S:'DIPA("I2") Y="@8111";454T~;S:'DIPA("I3") Y="@8111";455T~;@8111;163PRIMARY AUTHORIZATION CODE~;
"KRN",.402,1316,"DR",1,399,1)
S:'DIPA("I2") Y="@811";230;S:'DIPA("I3") Y="@811";231;@811;215;159;@82;S:IBDR20'["82" Y="@83";222;@83;S:IBDR20'["83" Y="@84";I '$P($G(^DGCR(399,DA,"TX")),U,8),'$$TXMT^IBCEF4(DA) S Y="@831";I $$REQMRA^IBEFUNC(DA) S Y="@8311";
"KRN",.402,1316,"DR",1,399,2)
27//NO FORCED PRINT;S Y="@84";@8311;28//NO FORCED PRINT;S Y="@84";@831;N X,Y,DIR S DIR(0)="EA",DIR("A",1)="NO FIELDS AVAILABLE TO EDIT",DIR("A")="PRESS RETURN TO CONTINUE: " W ! D ^DIR K DIR;@84;S:IBDR20'["84" Y="@85";@85;
"KRN",.402,1316,"DR",1,399,3)
S:IBDR20'["85" Y="@89";232;S DIPA("NVA_FC")=X S:DIPA("NVA_FC")="" Y="@856";^355.93^IBA(355.93,^^S I(0,0)=D0 S Y(1)=$S($D(^DGCR(399,D0,"U2")):^("U2"),1:"") S X=$P(Y(1),U,10),X=X S D(0)=+X S X=$S(D(0)>0:D(0),1:"");
"KRN",.402,1316,"DR",1,399,4)
S DIK="^DGCR(399,",DIK(1)="232" D EN1^DIK;K DIK;244;D DISPTAX^IBCEP81($P($G(^DGCR(399,DA,"U3")),U,3),"Non-VA Facility");233;@856;@89;
"KRN",.402,1316,"DR",2,355.93)
S DIPA("NVA_FC-0")=$G(^IBA(355.93,+DIPA("NVA_FC"),0)) S:$P(DIPA("NVA_FC-0"),U,5)'=""&($P(DIPA("NVA_FC-0"),U,6)'="")&($P(DIPA("NVA_FC-0"),U,7)'="") Y="@851";.05;.1;.06;.07;.08;@851;S:$P(DIPA("NVA_FC-0"),U,9)'="" Y="@852";
"KRN",.402,1316,"DR",2,355.93,1)
.09LAB OR FACILITY PRIMARY ID~R~;@852;S:$P(DIPA("NVA_FC-0"),U,11)'="" Y="@853";.11;@853;S:$P(DIPA("NVA_FC-0"),U,14)'="" Y="@854";D EN2^IBCEP82(+DIPA("NVA_FC"),2);@854;S:$D(^IBA(355.93,+DIPA("NVA_FC"),"TAXONOMY"))>0 Y="@855";42;
"KRN",.402,1316,"DR",2,355.93,2)
@855;
"KRN",.402,1316,"DR",2,399.0222)
.01;S DIPA("RF")=X S:$D(^XUSEC("IB PROVIDER EDIT",DUZ)) DLAYGO=355.93;.02;K DLAYGO S DIPA("PRF")=X S:DIPA("PRF")="" Y="@98";N Z1 S Z1=$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,2) S DIPA("NVA_PRV")=$S(Z1["IBA(355.93":+Z1,1:0);
"KRN",.402,1316,"DR",2,399.0222,1)
S:DIPA("NVA_PRV")=0 Y="@828";
"KRN",.402,1316,"DR",2,399.0222,2)
^355.93^IBA(355.93,^^N DIERR X DR(99,1,9.2) K DIC S DIC="^IBA(355.93,",DIC(0)="MF" D ^DIC S (D,D0,D(0))=+Y S Y(101)=$S($D(^IBA(355.93,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");@828;
"KRN",.402,1316,"DR",2,399.0222,3)
S DIK="^DGCR(399,"_DA(1)_",""PRV"",",DIK(1)=".02" D EN1^DIK K DIK;S Z1=$P($$PROVID^IBCEF73(DA(1)),U,$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U));
"KRN",.402,1316,"DR",2,399.0222,4)
I Z1="",$P($G(DIPA("NVA_PRV-0")),U,2)=2 N X,Y,DIR S DIR(0)="EA",DIR("A",1)="You must use Provider ID Maintenance to enter an SSN or EIN for this provider.",DIR("A")="PRESS RETURN TO CONTINUE: " W ! D ^DIR W ! K DIR;.15;
"KRN",.402,1316,"DR",2,399.0222,5)
D DISPTAX^IBCEP81($P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,15),"");N Z S Z=$$EXPAND^IBTRE(399.0222,.08,$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,8)),DIPA("SPC")=$S(Z'="":Z,1:"UNSPECIFIED") W !,"    Prov Specialty On File: ",DIPA("SPC");
"KRN",.402,1316,"DR",2,399.0222,6)
S DIPA("CRD")=$$CRED^IBCEU($P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,2));.03;K DIPA("W1") S:$G(DIPA("CRD"))'=$P($G(^DGCR(399,DA(1),"PRV",DA,0)),U,3) DIPA("W1")=1;I $G(DIPA("W1")) D WRT1^IBCSC8H($G(DIPA("CRD")));K DIPA("W1");
"KRN",.402,1316,"DR",2,399.0222,7)
I '$G(DIPA("I1")) S Y="@8205";D PROVID^IBCEP2B(DA(1),DA,1,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8282",DIPA("EDIT")=1:"@8291",DIPA("EDIT")=2:"@8271",1:"");@8282;I '$G(DIPA("I2")) S Y="@8205";
"KRN",.402,1316,"DR",2,399.0222,8)
D PROVID^IBCEP2B(DA(1),DA,2,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8283",DIPA("EDIT")=1:"@8292",DIPA("EDIT")=2:"@8272",1:"");@8283;I '$G(DIPA("I3")) S Y="@8205";
"KRN",.402,1316,"DR",2,399.0222,9)
D PROVID^IBCEP2B(DA(1),DA,3,.DIPA) S Y=$S(DIPA("EDIT")<0:"@8205",DIPA("EDIT")=1:"@8293",DIPA("EDIT")=2:"@8273",1:"");S Y="@8205";@8291;.12R~T~;.05T~;S Y="@8282";@8292;.13R~T~;.06T~;S Y="@8283";@8293;.14R~T~;.07T~;S Y="@8205";@8271;
"KRN",.402,1316,"DR",2,399.0222,10)
.12////^S X=DIPA("PRIDT");.05////^S X=DIPA("PRID");S Y="@8282";@8272;.13////^S X=DIPA("PRIDT");.06////^S X=DIPA("PRID");S Y="@8283";@8273;.14////^S X=DIPA("PRIDT");.07////^S X=DIPA("PRID");S Y="@8205";@8205;@98;W @IOF;
"KRN",.402,1316,"DR",3,355.93)
S DIPA("NVA_PRV-0")=$G(^IBA(355.93,DIPA("NVA_PRV"),0));S:$P(DIPA("NVA_PRV-0"),U,2)=1 Y="@822";S:$P(DIPA("NVA_PRV-0"),U,3)'="" Y="@821";.03;@821;S:$P(DIPA("NVA_PRV-0"),U,3)'="" Y="@825";.04;S Y="@825";@822;
"KRN",.402,1316,"DR",3,355.93,1)
S:$P(DIPA("NVA_PRV-0"),U,5)'=""&($P(DIPA("NVA_PRV-0"),U,6)'="")&($P(DIPA("NVA_PRV-0"),U,7)'="") Y="@823";.05;.1;.06;.07;.08;@823;S:$P(DIPA("NVA_PRV-0"),U,9)'="" Y="@824";.09LAB OR FACILITY PRIMARY ID~R~;@824;
"KRN",.402,1316,"DR",3,355.93,2)
S:$P(DIPA("NVA_PRV-0"),U,11)'="" Y="@825";.11;@825;S:$P(DIPA("NVA_PRV-0"),U,14)'="" Y="@826";D EN2^IBCEP82(DIPA("NVA_PRV"),4);@826;S:$D(^IBA(355.93,DIPA("NVA_PRV"),"TAXONOMY"))>0 Y="@827";42;@827;
"KRN",.402,1316,"DR",3,355.9342)
.01:.03
"KRN",.402,1316,"DR",4,355.9342)
.01:.03
"KRN",.402,1316,"DR",99,1)
N DIERR X DR(99,1,9.2) K DIC S DIC="^IBA(355.93,",DIC(0)="MF" D ^DIC S (D,D0,D(0))=+Y S Y(101)=$S($D(^IBA(355.93,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0)
"KRN",.402,1316,"DR",99,1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^DGCR(399,D0,"PRV",D1,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(399.0222,.02,"",$P(Y(1),U,2))
"KRN",.402,1316,"ROUOLD")
IBXSC82
"KRN",.402,2644,-1)
0^1
"KRN",.402,2644,0)
IBCN PATIENT INSURANCE^3080204.1237^@^2^^@^3080108
"KRN",.402,2644,"%D",0)
^^4^4^3070611^
"KRN",.402,2644,"%D",1,0)
esg - 6/11/2007 - IB patch 371
"KRN",.402,2644,"%D",2,0)
 
"KRN",.402,2644,"%D",3,0)
New input template to handle the input/edit of fields in the patient 
"KRN",.402,2644,"%D",4,0)
insurance multiple (2.312) in the patient file.
"KRN",.402,2644,"DIAB",2,1,2.312,0)
INSURANCE TYPE;"INSURANCE COMPANY"
"KRN",.402,2644,"DIAB",4,1,2.312,0)
PT. RELATIONSHIP - HIPAA;"PT. RELATIONSHIP TO INSURED"
"KRN",.402,2644,"DIAB",9,1,2.312,1)
SUBSCRIBER ID;"SUBSCRIBER PRIMARY ID"
"KRN",.402,2644,"DIAB",12,1,2.312,2)
PATIENT ID;"PATIENT PRIMARY ID"
"KRN",.402,2644,"DR",1,2)
.3121;
"KRN",.402,2644,"DR",2,2.312)
I '$G(IBREG)!'$$KCHK^XUSRB("IB INSURANCE SUPERVISOR") S Y="@10";.01INSURANCE COMPANY~;@10;4.03PT. RELATIONSHIP TO INSURED~;S IBREL=X;I IBREL="" S Y="";I '$G(IBDFN) S Y="";F IBZ="VADM","VAPA" K ^UTILITY(IBZ,$J);
"KRN",.402,2644,"DR",2,2.312,1)
17//^S X=$$PIDEF^IBCNSP1($G(IBREL),17,$G(IBDFN));8;3;4.01;4.02;.2;1.09;W !;1SUBSCRIBER PRIMARY ID~;I '$$ASK^IBCNSP1("Do you want to enter/update Subscriber Secondary IDs") S Y="@30";S IB1ST("ID EDIT")=1;5.02;I X="" S Y="@30";5.03;
"KRN",.402,2644,"DR",2,2.312,2)
I X="" S Y="@30";5.04;I X="" S Y="@30";5.05;I X="" S Y="@30";5.06;I X="" S Y="@30";5.07;@30;I +$G(IBREL)=18 S Y="@20";W !;5.01PATIENT PRIMARY ID~;I '$$ASK^IBCNSP1("Do you want to enter/update Patient Secondary IDs") S Y="@20";
"KRN",.402,2644,"DR",2,2.312,3)
S IB1ST("ID EDIT")=1;5.08;I X="" S Y="@20";5.09;I X="" S Y="@20";5.1;I X="" S Y="@20";5.11;I X="" S Y="@20";5.12;I X="" S Y="@20";5.13;@20;W !;3.01//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.01,$G(IBDFN));
"KRN",.402,2644,"DR",2,2.312,4)
3.12//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.12,$G(IBDFN));3.02//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.02,$G(IBDFN));3.03;3.06//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.06,$G(IBDFN),1);3.07//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.07,$G(IBDFN),1);
"KRN",.402,2644,"DR",2,2.312,5)
3.08//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.08,$G(IBDFN),1);3.09//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.09,$G(IBDFN),1);3.1//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.1,$G(IBDFN),1);3.11//^S X=$$PIDEF^IBCNSP1($G(IBREL),3.11,$G(IBDFN),1);
"KRN",19,10974,-1)
0^1
"KRN",19,10974,0)
IBCE BATCHES PENDING TOO LONG^EDI Batches Pending Receipt^^R^^^^^^^^
"KRN",19,10974,1,0)
^^4^4^2961001^^
"KRN",19,10974,1,1,0)
This report lists all batches by batch type that have been in a PENDING
"KRN",19,10974,1,2,0)
status and have not yet received confirmation of receipt from Austin for
"KRN",19,10974,1,3,0)
more than 1 day.  Report includes pending since date and mail message # the
"KRN",19,10974,1,4,0)
batch is contained in.
"KRN",19,10974,25)
PENDING^IBCERP3
"KRN",19,10974,"U")
EDI BATCHES PENDING RECEIPT
"KRN",19,10988,-1)
2^2
"KRN",19,10988,0)
IBCE TXMT MGMNT REPORTS^EDI Transmission Status Reports^^M^12540^^^^^^^200
"KRN",19,10988,10,0)
^19.01IP^10^8
"KRN",19,10988,10,2,0)
10973^DET
"KRN",19,10988,10,2,"^")
IBCE BATCH STATUS DETAIL
"KRN",19,10988,10,3,0)
10974^PND
"KRN",19,10988,10,3,"^")
IBCE BATCHES PENDING TOO LONG
"KRN",19,10988,10,10,0)
12496^ECS
"KRN",19,10988,10,10,"^")
IBCED EDI CLAIM STATUS REPORT
"KRN",19,10988,"U")
EDI TRANSMISSION STATUS REPORT
"KRN",19,12496,-1)
0^4
"KRN",19,12496,0)
IBCED EDI CLAIM STATUS REPORT^EDI Claim Status Report^^R^^^^^^^^
"KRN",19,12496,1,0)
^^3^3^3071224^
"KRN",19,12496,1,1,0)
This report shows information about transmitted electronic claims.  
"KRN",19,12496,1,2,0)
Selection criteria includes division, payer, date last transmitted, and 
"KRN",19,12496,1,3,0)
current EDI status.  This report has 3 sort levels and 8 sorting criteria.
"KRN",19,12496,25)
EN^IBCEDS
"KRN",19,12496,"U")
EDI CLAIM STATUS REPORT
"KRN",19,12508,-1)
1^3
"KRN",19,12508,0)
IBCE BATCH STATUS DETAIL
"KRN",101,642,-1)
0^10
"KRN",101,642,0)
VALM QUIT^Quit^^A^^^^^^^^
"KRN",101,642,.1)
 
"KRN",101,642,1,0)
^^1^1^2911105^
"KRN",101,642,1,1,0)
This protocol can be used as a generic 'quit' action.
"KRN",101,642,2,0)
^101.02A^2^2
"KRN",101,642,2,1,0)
EXIT
"KRN",101,642,2,2,0)
QUIT
"KRN",101,642,2,"B","EXIT",1)

"KRN",101,642,2,"B","QUIT",2)

"KRN",101,642,15)

"KRN",101,642,20)
Q
"KRN",101,642,99)
60978,49713
"KRN",101,647,-1)
0^51
"KRN",101,647,0)
VALM BLANK 1^^^A^^^^^^^^LIST MANAGER
"KRN",101,647,1,0)
^^1^1^2920203^
"KRN",101,647,1,1,0)
This protocol is used to format spaces in menu lists.
"KRN",101,647,10,0)
^101.01PA^0^0
"KRN",101,1413,-1)
0^12
"KRN",101,1413,0)
IBJT AR COMMENT ADD^Add Comment^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,1413,20)
D ARCA^IBJTA1
"KRN",101,1413,99)
61006,55019
"KRN",101,1908,-1)
0^19
"KRN",101,1908,0)
IBCE EXIT^Exit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,1908,1,0)
^101.06^2^2^3060105^^
"KRN",101,1908,1,1,0)
Allows the user to exit the system without quitting through the hierarchy
"KRN",101,1908,1,2,0)
of screens, or the user can exit to the previous screen.
"KRN",101,1908,2,0)
^101.02A^1^1
"KRN",101,1908,2,1,0)
EX
"KRN",101,1908,2,"B","EX",1)

"KRN",101,1908,4)
^^^EX
"KRN",101,1908,20)
D FASTEXIT^IBCEFG4
"KRN",101,1908,28)

"KRN",101,1908,99)
60530,25334
"KRN",101,3442,-1)
2^3
"KRN",101,3442,0)
IBCEM COB MANAGEMENT^^^M^66481^^^^^^^200
"KRN",101,3442,10,0)
^101.01PA^24^24
"KRN",101,3442,10,22,0)
4384^EC^33^
"KRN",101,3442,10,22,"^")
IBCEM ENTER COMMENTS
"KRN",101,3442,10,23,0)
4385^VC^37^
"KRN",101,3442,10,23,"^")
IBCEM VIEW COMMENTS
"KRN",101,3442,10,24,0)
4387^RS^35^
"KRN",101,3442,10,24,"^")
IBCEM MRA STATUS
"KRN",101,3495,-1)
0^29
"KRN",101,3495,0)
IBCE PRVCARE UNIT MENU^PROVIDER ID CARE UNIT MENU^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,3495,4)
35
"KRN",101,3495,10,0)
^101.01PA^6^6
"KRN",101,3495,10,1,0)
3496^AU^1^
"KRN",101,3495,10,1,"^")
IBCE PRVCARE ADD
"KRN",101,3495,10,4,0)
1908^EX^50^
"KRN",101,3495,10,4,"^")
IBCE EXIT
"KRN",101,3495,10,5,0)
3525^EU^5^
"KRN",101,3495,10,5,"^")
IBCE PRVCARE EDIT
"KRN",101,3495,10,6,0)
4414^DU^20^
"KRN",101,3495,10,6,"^")
IBCE PRVCARE DELETE
"KRN",101,3495,15)

"KRN",101,3495,20)

"KRN",101,3495,26)
D SHOW^VALM
"KRN",101,3495,28)
Select Action: 
"KRN",101,3495,99)
61048,54680
"KRN",101,3496,-1)
0^30
"KRN",101,3496,0)
IBCE PRVCARE ADD^Add a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3496,20)
D NEW^IBCEP4A(0)
"KRN",101,3496,99)
61048,54402
"KRN",101,3497,-1)
0^15
"KRN",101,3497,0)
IBCE PRVPRV MAINT^Provider ID Maintenance^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,3497,4)
35
"KRN",101,3497,10,0)
^101.01PA^4^4
"KRN",101,3497,10,1,0)
3499^AI^5^
"KRN",101,3497,10,1,"^")
IBCE PRVNUM ADD
"KRN",101,3497,10,2,0)
3498^EI^10^
"KRN",101,3497,10,2,"^")
IBCE PRVNUM EDIT
"KRN",101,3497,10,3,0)
3500^DI^15^
"KRN",101,3497,10,3,"^")
IBCE PRVNUM DELETE
"KRN",101,3497,10,4,0)
1908^EX^100^
"KRN",101,3497,10,4,"^")
IBCE EXIT
"KRN",101,3497,26)
D SHOW^VALM
"KRN",101,3497,28)
Select Action: 
"KRN",101,3497,99)
61048,37188
"KRN",101,3498,-1)
0^17
"KRN",101,3498,0)
IBCE PRVNUM EDIT^Edit an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3498,20)
D CHG1^IBCEP5A
"KRN",101,3498,99)
60530,25334
"KRN",101,3499,-1)
0^16
"KRN",101,3499,0)
IBCE PRVNUM ADD^Add an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3499,20)
D NEW^IBCEP5A($G(IBPRV),$G(IBINS))
"KRN",101,3499,99)
60530,25334
"KRN",101,3500,-1)
0^18
"KRN",101,3500,0)
IBCE PRVNUM DELETE^Delete an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3500,20)
D DEL1^IBCEP5A
"KRN",101,3500,99)
60530,25334
"KRN",101,3501,-1)
0^24
"KRN",101,3501,0)
IBCE PRVCARE UNIT MAINT^Care Unit Maint^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3501,1,0)
^101.06^2^2^3010427^^
"KRN",101,3501,1,1,0)
This protocol calls the list manager template for provider id care unit
"KRN",101,3501,1,2,0)
maintenance functions.
"KRN",101,3501,20)
D EN1^IBCEP4($G(IBINS))
"KRN",101,3501,99)
61048,44170
"KRN",101,3502,-1)
0^26
"KRN",101,3502,0)
IBCE PRVINS EDIT^Edit an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3502,10,0)
^101.01PA^^0
"KRN",101,3502,15)
Q
"KRN",101,3502,20)
D CHG1^IBCEP0A
"KRN",101,3502,99)
61048,44048
"KRN",101,3503,-1)
0^22
"KRN",101,3503,0)
IBCE PRVINS ADD^Add an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3503,15)
Q
"KRN",101,3503,20)
D NEW^IBCEP0A($G(IBINS),$G(IBPRV),$G(IBPTYP),$G(IBDSP))
"KRN",101,3503,99)
61048,44002
"KRN",101,3504,-1)
0^23
"KRN",101,3504,0)
IBCE PRVINS DELETE^Delete an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3504,20)
D DEL1^IBCEP0A
"KRN",101,3504,99)
61048,44030
"KRN",101,3506,-1)
0^20
"KRN",101,3506,0)
IBCE PRVINS ID^Insurance Co Prov ID Maintenance^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,3506,4)
26
"KRN",101,3506,10,0)
^101.01PA^12^12
"KRN",101,3506,10,4,0)
1908^EX^100^
"KRN",101,3506,10,4,"^")
IBCE EXIT
"KRN",101,3506,10,5,0)
3514^VI^70^^^
"KRN",101,3506,10,5,"^")
IBCE PRVINS JUMP
"KRN",101,3506,10,6,0)
3503^AI^2^^^
"KRN",101,3506,10,6,"^")
IBCE PRVINS ADD
"KRN",101,3506,10,7,0)
3504^DI^4^^^
"KRN",101,3506,10,7,"^")
IBCE PRVINS DELETE
"KRN",101,3506,10,8,0)
3501^CU^80^
"KRN",101,3506,10,8,"^")
IBCE PRVCARE UNIT MAINT
"KRN",101,3506,10,9,0)
3515^CI^65^
"KRN",101,3506,10,9,"^")
IBCE PRVINS CHG INS
"KRN",101,3506,10,10,0)
3502^EI^10^
"KRN",101,3506,10,10,"^")
IBCE PRVINS EDIT
"KRN",101,3506,10,11,0)
3516^DP^60^
"KRN",101,3506,10,11,"^")
IBCE PRVINS DISPLAY PARAMS
"KRN",101,3506,10,12,0)
3517^CD^67^
"KRN",101,3506,10,12,"^")
IBCE PRVINS CHG FORMAT
"KRN",101,3506,15)
I $G(IBFASTXT) S VALMBCK="Q"
"KRN",101,3506,24)
I $$SCREEN^IBCEP0("ID")
"KRN",101,3506,26)
D SHOW^VALM
"KRN",101,3506,28)
Select Action: 
"KRN",101,3506,99)
61048,44192
"KRN",101,3511,-1)
0^37
"KRN",101,3511,0)
IBCE PRVNVA MAINT^Non-VA Provider Maintenance^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,3511,4)
40
"KRN",101,3511,10,0)
^101.01PA^7^7
"KRN",101,3511,10,4,0)
1908^EX^100^
"KRN",101,3511,10,4,"^")
IBCE EXIT
"KRN",101,3511,10,5,0)
3512^ED^2^
"KRN",101,3511,10,5,"^")
IBCE PRVNVA DEMOG
"KRN",101,3511,10,6,0)
4415^PO^10^
"KRN",101,3511,10,6,"^")
IBCE PRVNVA NP PO
"KRN",101,3511,10,7,0)
4416^PI^20^
"KRN",101,3511,10,7,"^")
IBCE PRVNVA NP PI
"KRN",101,3511,26)
D SHOW^VALM
"KRN",101,3511,28)
Select Action: 
"KRN",101,3511,99)
61052,64602
"KRN",101,3512,-1)
0^40
"KRN",101,3512,0)
IBCE PRVNVA DEMOG^Edit Demographics^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3512,15)
Q
"KRN",101,3512,20)
D EDIT1^IBCEP8($G(IBNPRV))
"KRN",101,3512,99)
58954,27840
"KRN",101,3514,-1)
0^21
"KRN",101,3514,0)
IBCE PRVINS JUMP^View IDs by Type^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3514,15)
Q
"KRN",101,3514,20)
D PRVJMP^IBCEP0A($G(IBDSP))
"KRN",101,3514,99)
61048,44145
"KRN",101,3515,-1)
0^25
"KRN",101,3515,0)
IBCE PRVINS CHG INS^Change Ins Co^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3515,20)
D CHGINS^IBCEP0A
"KRN",101,3515,99)
61048,44087
"KRN",101,3516,-1)
0^27
"KRN",101,3516,0)
IBCE PRVINS DISPLAY PARAMS^Display Ins Params^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3516,15)
Q
"KRN",101,3516,20)
D EN^IBCEPB
"KRN",101,3516,99)
61048,44071
"KRN",101,3517,-1)
0^28
"KRN",101,3517,0)
IBCE PRVINS CHG FORMAT^Change Display^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3517,20)
D CHGFMT^IBCEP0A
"KRN",101,3517,99)
61048,44124
"KRN",101,3525,-1)
0^31
"KRN",101,3525,0)
IBCE PRVCARE EDIT^Edit a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,3525,20)
D CHANGE^IBCEP4A(0)
"KRN",101,3525,99)
61048,54443
"KRN",101,4277,-1)
0^45
"KRN",101,4277,0)
IBCE PRVNVA PROVINFO^Lab/Facility Info^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4277,15)
Q
"KRN",101,4277,20)
D EDIT1^IBCEP8($G(IBNPRV))
"KRN",101,4277,99)
61052,64976
"KRN",101,4279,-1)
0^42
"KRN",101,4279,0)
IBCE PRVNVA NONIND MAINT^Non-VA Lab or Facility Maint^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,4279,4)
40
"KRN",101,4279,10,0)
^101.01PA^4^4
"KRN",101,4279,10,1,0)
1908^EX^100^
"KRN",101,4279,10,1,"^")
IBCE EXIT
"KRN",101,4279,10,2,0)
4277^FI^2^
"KRN",101,4279,10,2,"^")
IBCE PRVNVA PROVINFO
"KRN",101,4279,10,3,0)
4417^LO^10^
"KRN",101,4279,10,3,"^")
IBCE PRVNVA NF LO
"KRN",101,4279,10,4,0)
4418^LI^20^
"KRN",101,4279,10,4,"^")
IBCE PRVNVA NF LI
"KRN",101,4279,15)
I $G(IBFASTXT) S VALMBCK="Q"
"KRN",101,4279,26)
D SHOW^VALM
"KRN",101,4279,28)
Select Action: 
"KRN",101,4279,99)
61052,65067
"KRN",101,4280,-1)
0^48
"KRN",101,4280,0)
IBCE PRVNVA LOF ADD^Add an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4280,10,0)
^101.01PA^^0
"KRN",101,4280,20)
D NEW^IBCEP5A($G(IBPRV),$G(IBINS))
"KRN",101,4280,99)
61053,34853
"KRN",101,4281,-1)
0^49
"KRN",101,4281,0)
IBCE PRVNVA LOF EDIT^Edit an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4281,20)
D CHG1^IBCEP5A
"KRN",101,4281,99)
61053,34878
"KRN",101,4282,-1)
0^50
"KRN",101,4282,0)
IBCE PRVNVA LOF DELETE^Delete an ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4282,20)
D DEL1^IBCEP5A
"KRN",101,4282,99)
61053,34904
"KRN",101,4283,-1)
0^47
"KRN",101,4283,0)
IBCE PRVNVA LOF MAINT^Secondary ID Maintenance^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,4283,4)
35
"KRN",101,4283,10,0)
^101.01PA^4^4
"KRN",101,4283,10,1,0)
4280^AI^5^
"KRN",101,4283,10,1,"^")
IBCE PRVNVA LOF ADD
"KRN",101,4283,10,2,0)
4281^EI^10^
"KRN",101,4283,10,2,"^")
IBCE PRVNVA LOF EDIT
"KRN",101,4283,10,3,0)
4282^DI^15^
"KRN",101,4283,10,3,"^")
IBCE PRVNVA LOF DELETE
"KRN",101,4283,10,4,0)
1908^EX^100^
"KRN",101,4283,10,4,"^")
IBCE EXIT
"KRN",101,4283,15)
I $G(IBFASTXT) S VALMBCK="Q"
"KRN",101,4283,26)
D SHOW^VALM
"KRN",101,4283,28)
Select Action: 
"KRN",101,4283,99)
61053,34927
"KRN",101,4285,-1)
0^34
"KRN",101,4285,0)
IBCE 2ND PRVCARE ADD^Add a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4285,20)
D NEW^IBCEPA
"KRN",101,4285,99)
61051,62771
"KRN",101,4286,-1)
0^35
"KRN",101,4286,0)
IBCE 2ND PRVCARE EDIT^Edit a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4286,20)
D CHANGE^IBCEPA
"KRN",101,4286,99)
61051,62792
"KRN",101,4287,-1)
0^33
"KRN",101,4287,0)
IBCE 2ND PRVCARE MENU^Provider Secondary ID Care Unit Menu^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,4287,4)
35
"KRN",101,4287,10,0)
^101.01PA^4^4
"KRN",101,4287,10,1,0)
4285^AU^1^
"KRN",101,4287,10,1,"^")
IBCE 2ND PRVCARE ADD
"KRN",101,4287,10,2,0)
4286^EU^5^
"KRN",101,4287,10,2,"^")
IBCE 2ND PRVCARE EDIT
"KRN",101,4287,10,3,0)
1908^EX^50^
"KRN",101,4287,10,3,"^")
IBCE EXIT
"KRN",101,4287,10,4,0)
4300^DU^15^
"KRN",101,4287,10,4,"^")
IBCE 2ND PRVCARE DELETE
"KRN",101,4287,15)
I $G(IBFASTXT) S VALMBCK="Q"
"KRN",101,4287,20)

"KRN",101,4287,26)
D SHOW^VALM
"KRN",101,4287,28)
Select Action: 
"KRN",101,4287,99)
61051,62802
"KRN",101,4300,-1)
0^36
"KRN",101,4300,0)
IBCE 2ND PRVCARE DELETE^Delete a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4300,20)
D DEL^IBCEPA
"KRN",101,4300,99)
61051,62783
"KRN",101,4384,-1)
0^1
"KRN",101,4384,0)
IBCEM ENTER COMMENTS^Enter Comments^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4384,4)
^^^EC
"KRN",101,4384,20)
D CMNTW^IBCECOB6
"KRN",101,4384,99)
61004,47982
"KRN",101,4385,-1)
0^2
"KRN",101,4385,0)
IBCEM VIEW COMMENTS^View Comments^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4385,4)
^^^VC
"KRN",101,4385,20)
D EN^IBCECOB6
"KRN",101,4385,99)
61004,48025
"KRN",101,4386,-1)
0^4
"KRN",101,4386,0)
IBCEM COB COMMENTS^^^M^^^^^^^^INTEGRATED BILLING
"KRN",101,4386,4)
26^4
"KRN",101,4386,10,0)
^101.01PA^3^3
"KRN",101,4386,10,1,0)
4389^EC^10^
"KRN",101,4386,10,1,"^")
IBCEM ENTER COMMENTS 1
"KRN",101,4386,10,2,0)
642^Q^50^
"KRN",101,4386,10,2,"^")
VALM QUIT
"KRN",101,4386,10,3,0)
647^^30^
"KRN",101,4386,10,3,"^")
VALM BLANK 1
"KRN",101,4386,15)
I $G(IBFASTXT) S VALMBCK="Q"
"KRN",101,4386,20)
K IBFASTXT
"KRN",101,4386,26)
D SHOW^VALM
"KRN",101,4386,28)
Select Action: 
"KRN",101,4386,99)
61093,58745
"KRN",101,4387,-1)
0^5
"KRN",101,4387,0)
IBCEM MRA STATUS^Review Status^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4387,4)
^^^RS
"KRN",101,4387,20)
D STATUS^IBCECOB6
"KRN",101,4387,99)
61004,48147
"KRN",101,4389,-1)
0^9
"KRN",101,4389,0)
IBCEM ENTER COMMENTS 1^Enter Comments^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4389,4)
^^^EC
"KRN",101,4389,15)

"KRN",101,4389,20)
D CMNTV^IBCECOB6
"KRN",101,4389,99)
61004,48002
"KRN",101,4414,-1)
0^32
"KRN",101,4414,0)
IBCE PRVCARE DELETE^Delete a Unit^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4414,20)
D DELETE^IBCEP4A(0)
"KRN",101,4414,99)
61048,54475
"KRN",101,4415,-1)
0^39
"KRN",101,4415,0)
IBCE PRVNVA NP PO^Provider Own ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4415,15)
Q
"KRN",101,4415,20)
D EDITID^IBCEP8($G(IBNPRV),1)
"KRN",101,4415,99)
61052,63208
"KRN",101,4416,-1)
0^38
"KRN",101,4416,0)
IBCE PRVNVA NP PI^Provider Ins ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4416,15)
Q
"KRN",101,4416,20)
D EDITID^IBCEP8($G(IBNPRV),2)
"KRN",101,4416,99)
61052,63342
"KRN",101,4417,-1)
0^44
"KRN",101,4417,0)
IBCE PRVNVA NF LO^Lab/Facility Own ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4417,15)
Q
"KRN",101,4417,20)
D EDITID^IBCEP8($G(IBNPRV),1)
"KRN",101,4417,99)
61052,63459
"KRN",101,4418,-1)
0^43
"KRN",101,4418,0)
IBCE PRVNVA NF LI^Lab/Facility Ins ID^^A^^^^^^^^INTEGRATED BILLING
"KRN",101,4418,15)
Q
"KRN",101,4418,20)
D EDITID^IBCEP8($G(IBNPRV),2)
"KRN",101,4418,99)
61052,63516
"KRN",101,4419,-1)
1^13
"KRN",101,4419,0)
IBCE PRVMAINT
"KRN",101,4420,-1)
1^14
"KRN",101,4420,0)
IBCE PRVMAINT ACTION
"KRN",101,4421,-1)
1^41
"KRN",101,4421,0)
IBCE PRVNVA IDS
"KRN",101,4422,-1)
1^46
"KRN",101,4422,0)
IBCE PRVNVA SECIDS
"KRN",409.61,245,-1)
0^3
"KRN",409.61,245,0)
IBJT AR COMMENT HISTORY^1^^80^5^17^1^1^AR Comments^IBJT AR COMMENT HISTORY MENU^Comment History^1^^1
"KRN",409.61,245,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,245,"ARRAY")
 ^TMP("IBJTTC",$J)
"KRN",409.61,245,"FNL")
D EXIT^IBJTTC
"KRN",409.61,245,"HDR")
D HDR^IBJTTC
"KRN",409.61,245,"HLP")
D HELP^IBJTTC
"KRN",409.61,245,"INIT")
D INIT^IBJTTC
"KRN",409.61,710,-1)
0^1
"KRN",409.61,710,0)
IBCEM MRA MANAGEMENT^1^^80^4^18^1^1^MRA/EOB^IBCEM COB MANAGEMENT^MRA Management WorkList^1^^1
"KRN",409.61,710,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,710,"ARRAY")
 ^TMP("IBCECOB",$J)
"KRN",409.61,710,"COL",0)
^409.621^14^7
"KRN",409.61,710,"COL",1,0)
BILL^5^12^Bill #^^
"KRN",409.61,710,"COL",2,0)
SERVICE^18^8^Svc Date^^
"KRN",409.61,710,"COL",9,0)
NUMBER^1^4^^^
"KRN",409.61,710,"COL",10,0)
PATNM^27^23^Patient Name        SSN
"KRN",409.61,710,"COL",12,0)
BTYPE^72^9^Care/Form
"KRN",409.61,710,"COL",13,0)
PTRESP^51^9^  Pt Resp
"KRN",409.61,710,"COL",14,0)
IBAMT^61^9^ Bill Amt
"KRN",409.61,710,"COL","B","BILL",1)

"KRN",409.61,710,"COL","B","BTYPE",12)

"KRN",409.61,710,"COL","B","IBAMT",14)

"KRN",409.61,710,"COL","B","NUMBER",9)

"KRN",409.61,710,"COL","B","PATNM",10)

"KRN",409.61,710,"COL","B","PTRESP",13)

"KRN",409.61,710,"COL","B","SERVICE",2)

"KRN",409.61,710,"EXP")
D EXP^IBCECOB
"KRN",409.61,710,"FNL")
D EXIT^IBCECOB
"KRN",409.61,710,"HDR")
D HDR^IBCECOB
"KRN",409.61,710,"HLP")
D HELP^IBCECOB
"KRN",409.61,710,"INIT")
D INIT^IBCECOB
"KRN",409.61,802,-1)
0^2
"KRN",409.61,802,0)
IBCEM MRA COMMENTS^1^^80^4^19^1^1^MRA Comments^IBCEM COB COMMENTS^MRA Claim Comment History^1^^1
"KRN",409.61,802,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,802,"COL",0)
^409.621^2^2
"KRN",409.61,802,"COL",1,0)
ENTERED^1^79^^H
"KRN",409.61,802,"COL",2,0)
MESSAGE^3^75
"KRN",409.61,802,"COL","B","ENTERED",1)

"KRN",409.61,802,"COL","B","MESSAGE",2)

"KRN",409.61,802,"FNL")
D EXIT^IBCECOB6
"KRN",409.61,802,"HDR")
D HDR^IBCECOB6
"KRN",409.61,802,"HLP")
D HELP^IBCECOB6
"KRN",409.61,802,"INIT")
D INIT^IBCECOB6
"KRN",409.61,803,-1)
1^4
"KRN",409.61,803,0)
IBCE PRVMAINT
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",17,409.61)
409.61;17;1;;;;;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PGL",364.6,0,3,.03)
ASSOCIATED FORM DEFINITION^P364.6'^IBA(364.6,^0;3^Q
"PGL",364.7,0,5,.05)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
377^3080417
"PKG",200,22,1,"PAH",1,1,0)
^^1^1^3080417
"PKG",200,22,1,"PAH",1,1,1,0)
eClaims Plus Iteration 3, phase 2
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
44
"RTN","IBCBB")
0^38^B71092497^B70083781
"RTN","IBCBB",1,0)
IBCBB ;ALB/AAS - EDIT CHECK ROUTINE TO BE INVOKED BEFORE ALL BILL APPROVAL ACTIONS ;2-NOV-89
"RTN","IBCBB",2,0)
 ;;2.0;INTEGRATED BILLING;**80,51,137,288,327,361,371,377**;21-MAR-94;Build 23
"RTN","IBCBB",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCBB",4,0)
 ;
"RTN","IBCBB",5,0)
 ;MAP TO DGCRBB
"RTN","IBCBB",6,0)
 ;
"RTN","IBCBB",7,0)
 ;IBNDn = IBND(n) = ^ib(399,n)
"RTN","IBCBB",8,0)
 ;RETURNS:
"RTN","IBCBB",9,0)
 ;IBER=fields with errors separated by semi-colons
"RTN","IBCBB",10,0)
 ;PRCASV("OKAY")=1 if iber="" and $D(prcasv("array")) compete
"RTN","IBCBB",11,0)
 ;
"RTN","IBCBB",12,0)
GVAR ;set up variables for mccr
"RTN","IBCBB",13,0)
 Q:'$D(IBIFN)  F I=0,"M","U","U1","S","MP","TX","UF3","UF31","U2" S @("IBND"_I)=$G(^DGCR(399,IBIFN,I))
"RTN","IBCBB",14,0)
 S IBBNO=$P(IBND0,"^"),DFN=$P(IBND0,"^",2),IBEVDT=$P(IBND0,"^",3)
"RTN","IBCBB",15,0)
 S IBLOC=$P(IBND0,"^",4),IBCL=$P(IBND0,"^",5),IBTF=$P(IBND0,"^",6)
"RTN","IBCBB",16,0)
 S IBAT=$P(IBND0,"^",7),IBWHO=$P(IBND0,"^",11),IBST=$P(IBND0,"^",13),IBFT=$P(IBND0,"^",19)
"RTN","IBCBB",17,0)
 S IBFDT=$P(IBNDU,"^",1),IBTDT=$P(IBNDU,"^",2)
"RTN","IBCBB",18,0)
 S IBTC=$P(IBNDU1,"^",1),IBFY=$P(IBNDU1,"^",9),IBFYC=$P(IBNDU1,"^",10)
"RTN","IBCBB",19,0)
 S IBEU=$P(IBNDS,"^",2),IBRU=$P(IBNDS,"^",5),IBAU=$P(IBNDS,"^",8)
"RTN","IBCBB",20,0)
 S IBTOB=$$TOB(IBND0),IBTOB12=$E(IBTOB,1,2)
"RTN","IBCBB",21,0)
 K ^TMP($J,"BILL-WARN")
"RTN","IBCBB",22,0)
 Q
"RTN","IBCBB",23,0)
 ;
"RTN","IBCBB",24,0)
EN ;Entry to check for errors
"RTN","IBCBB",25,0)
 N IBQ,IBXERR,IBXDATA,IBXSAVE,IBZPRC92,IBQUIT,IBISEQ,IDDATA,IBFOR,IBC
"RTN","IBCBB",26,0)
 I $D(IBFL) N IBFL
"RTN","IBCBB",27,0)
 K ^TMP($J)
"RTN","IBCBB",28,0)
 W !
"RTN","IBCBB",29,0)
 S IBER="" D GVAR I '$D(IBND0) S IBER=-1 Q
"RTN","IBCBB",30,0)
 ;
"RTN","IBCBB",31,0)
 ;patient in patient file
"RTN","IBCBB",32,0)
 I DFN="" S IBER=IBER_"IB057;"
"RTN","IBCBB",33,0)
 I DFN]"",'$D(^DPT(DFN)) S IBER=IBER_"IB057;"
"RTN","IBCBB",34,0)
 ;
"RTN","IBCBB",35,0)
 ;Event date in correct format
"RTN","IBCBB",36,0)
 I IBEVDT="" S IBER=IBER_"IB049;"
"RTN","IBCBB",37,0)
 I IBEVDT]"",IBEVDT'?7N&(IBEVDT'?7N1".".N) S IBER=IBER_"IB049;"
"RTN","IBCBB",38,0)
 ;
"RTN","IBCBB",39,0)
 ;Rate Type
"RTN","IBCBB",40,0)
 I IBAT="" S IBER=IBER_"IB059;"
"RTN","IBCBB",41,0)
 I IBAT]"",'$D(^DGCR(399.3,IBAT,0)) S IBER=IBER_"IB059;"
"RTN","IBCBB",42,0)
 I IBAT]"",$D(^DGCR(399.3,IBAT,0)),'$P(^(0),"^",6) S IBER=IBER_"IB059;",IBAT=""
"RTN","IBCBB",43,0)
 I IBAT]"",$P($G(^DGCR(399.3,IBAT,0)),"^",6) S IBARTP=$P($$CATN^PRCAFN($P(^DGCR(399.3,IBAT,0),"^",6)),"^",3)
"RTN","IBCBB",44,0)
 ;Check that AR category expects same debtor as defined in who's responsible.
"RTN","IBCBB",45,0)
 I $D(IBARTP),IBWHO="i"&(IBARTP'="T")!(IBWHO="p"&("PC"'[IBARTP))!(IBWHO="o"&(IBARTP'="N")) S IBER=IBER_"IB058;"
"RTN","IBCBB",46,0)
 ;
"RTN","IBCBB",47,0)
 ;Who's Responsible
"RTN","IBCBB",48,0)
 I IBWHO=""!($L(IBWHO)>1)!("iop"'[IBWHO) S IBER=IBER_"IB065;"
"RTN","IBCBB",49,0)
 S IBMRA=$S($$MCRWNR^IBEFUNC(+$$CURR^IBCEF2(IBIFN)):$$TXMT^IBCEF4(IBIFN)>0,1:0)
"RTN","IBCBB",50,0)
 ;  MCR will not reimburse is only valid if there is subsequent insurance
"RTN","IBCBB",51,0)
 ;   that will reimburse
"RTN","IBCBB",52,0)
 I IBWHO="i" D
"RTN","IBCBB",53,0)
 . I IBMRA D  Q
"RTN","IBCBB",54,0)
 .. N Z,IBZ
"RTN","IBCBB",55,0)
 .. S IBZ=0
"RTN","IBCBB",56,0)
 .. F Z=$$COBN^IBCEF(IBIFN):1:3 I $D(^DGCR(399,IBIFN,"I"_(Z+1))),$P($G(^DIC(36,+$G(^DGCR(399,IBIFN,"I"_(Z+1))),0)),U,2)'="N" S IBZ=1 Q
"RTN","IBCBB",57,0)
 .. I 'IBZ S IBER=IBER_"IB054;" D WARN^IBCBB11("A valid claim for MEDICARE WNR needs subsequent ins. that will reimburse")
"RTN","IBCBB",58,0)
 ..
"RTN","IBCBB",59,0)
 . I $$COB^IBCEF(IBIFN)="S",$$MCRWNR^IBEFUNC(+$$CURR^IBCEF2(IBIFN))=1,$D(^DGCR(399,IBIFN,"I3")) Q
"RTN","IBCBB",60,0)
 . I $S('IBNDMP:1,1:$P(IBNDMP,U,2)'=$$BPP^IBCNS2(IBIFN,1)) S IBER=IBER_"IB054;"
"RTN","IBCBB",61,0)
 I IBWHO="o",'$P(IBNDM,"^",11) S IBER=IBER_"IB053;"
"RTN","IBCBB",62,0)
 ;
"RTN","IBCBB",63,0)
 ; All insurance subscribers must have a birth date on file
"RTN","IBCBB",64,0)
 ;  - 11/10/04 - IB*2.0*288
"RTN","IBCBB",65,0)
 ;  - 12/14/06 - IB*2.0*361 - must have INSURED'S SEX too
"RTN","IBCBB",66,0)
 ; IB error codes
"RTN","IBCBB",67,0)
 ;    IB221 - Primary insurance subscriber missing date of birth
"RTN","IBCBB",68,0)
 ;    IB222 - Secondary insurance subscriber missing date of birth
"RTN","IBCBB",69,0)
 ;    IB223 - Tertiary insurance subscriber missing date of birth
"RTN","IBCBB",70,0)
 ;    IB261 - Primary insurance subscriber is missing INSURED'S SEX
"RTN","IBCBB",71,0)
 ;    IB262 - Secondary insurance subscriber is missing INSURED'S SEX
"RTN","IBCBB",72,0)
 ;    IB263 - Tertiary insurance subscriber is missing INSURED'S SEX
"RTN","IBCBB",73,0)
 ;
"RTN","IBCBB",74,0)
 F IBISEQ=1:1:3 D
"RTN","IBCBB",75,0)
 . I '$P($G(^DGCR(399,IBIFN,"I"_IBISEQ)),U,1) Q   ; no insurance here
"RTN","IBCBB",76,0)
 . K ^UTILITY("VADM",$J),^UTILITY("VAPA",$J)
"RTN","IBCBB",77,0)
 . S IDDATA=$$INSDEM^IBCEF(IBIFN,IBISEQ)
"RTN","IBCBB",78,0)
 . K ^UTILITY("VADM",$J),^UTILITY("VAPA",$J)
"RTN","IBCBB",79,0)
 . ;
"RTN","IBCBB",80,0)
 . I '$P(IDDATA,U,1) D ERR(221)   ; birth date missing
"RTN","IBCBB",81,0)
 . ;
"RTN","IBCBB",82,0)
 . I "^M^F^"'[(U_$P(IDDATA,U,2)_U) D ERR(261)  ; sex missing
"RTN","IBCBB",83,0)
 . ;
"RTN","IBCBB",84,0)
 . ; IB*2*371 - esg - check for other missing insurance pieces
"RTN","IBCBB",85,0)
 . ; check insured's name, primary ID#, pt. relationship to insured,
"RTN","IBCBB",86,0)
 . ; and subscriber address data  
"RTN","IBCBB",87,0)
 . N INNAME,SUBID,PTREL,SFA,CAS,LN,FN
"RTN","IBCBB",88,0)
 . ;
"RTN","IBCBB",89,0)
 . ;          IB273 - Primary Insurance name of insured missing
"RTN","IBCBB",90,0)
 . ;          IB274 - Secondary Insurance name of insured missing
"RTN","IBCBB",91,0)
 . ;          IB275 - Tertiary Insurance name of insured missing
"RTN","IBCBB",92,0)
 . S INNAME=$$POLICY^IBCEF(IBIFN,17,IBISEQ)
"RTN","IBCBB",93,0)
 . S LN=$P(INNAME,",",1),FN=$P(INNAME,",",2)   ; last name,first name
"RTN","IBCBB",94,0)
 . S LN=$$NOPUNCT^IBCEF(LN,1)
"RTN","IBCBB",95,0)
 . S FN=$$NOPUNCT^IBCEF(FN,1)
"RTN","IBCBB",96,0)
 . I LN=""!(FN="") D ERR(273)   ; name of insured missing or invalid
"RTN","IBCBB",97,0)
 . S LN=$$NAME^IBCEFG1(INNAME)  ; additional name checks
"RTN","IBCBB",98,0)
 . S FN=$P(LN,U,2)
"RTN","IBCBB",99,0)
 . S LN=$P(LN,U,1)
"RTN","IBCBB",100,0)
 . I LN=""!(FN="") D ERR(273)   ; name of insured missing or invalid
"RTN","IBCBB",101,0)
 . ;
"RTN","IBCBB",102,0)
 . ;          IB276 - Primary Insurance subscriber ID missing
"RTN","IBCBB",103,0)
 . ;          IB277 - Secondary Insurance subscriber ID missing
"RTN","IBCBB",104,0)
 . ;          IB278 - Tertiary Insurance subscriber ID missing
"RTN","IBCBB",105,0)
 . S SUBID=$$NOPUNCT^IBCEF($$POLICY^IBCEF(IBIFN,2,IBISEQ),1)
"RTN","IBCBB",106,0)
 . I SUBID="" D ERR(276)     ; subscriber ID# missing
"RTN","IBCBB",107,0)
 . ;
"RTN","IBCBB",108,0)
 . ;          IB279 - Primary Insurance missing pt relationship
"RTN","IBCBB",109,0)
 . ;          IB280 - Secondary Insurance missing pt relationship
"RTN","IBCBB",110,0)
 . ;          IB281 - Tertiary Insurance missing pt relationship
"RTN","IBCBB",111,0)
 . S PTREL=$$POLICY^IBCEF(IBIFN,16,IBISEQ)
"RTN","IBCBB",112,0)
 . I PTREL="" D ERR(279)      ; missing patient relationship to insured
"RTN","IBCBB",113,0)
 . ;
"RTN","IBCBB",114,0)
 . ; subscriber address section
"RTN","IBCBB",115,0)
 . S SFA=$$INSADDR^IBCEF(IBIFN,IBISEQ)     ; full address all pieces
"RTN","IBCBB",116,0)
 . S CAS=$$NOPUNCT^IBCEF($P(SFA,U,2,5),1)  ; string city,st,zip,addr1
"RTN","IBCBB",117,0)
 . ;
"RTN","IBCBB",118,0)
 . ;          IB282 - Primary Insurance address line 1 missing
"RTN","IBCBB",119,0)
 . ;          IB283 - Secondary Insurance address line 1 missing
"RTN","IBCBB",120,0)
 . ;          IB284 - Tertiary Insurance address line 1 missing
"RTN","IBCBB",121,0)
 . I $$NOPUNCT^IBCEF($P(SFA,U,5),1)="" D   ; address line 1 is blank
"RTN","IBCBB",122,0)
 .. ; pat=subscriber and current insurance - address is required
"RTN","IBCBB",123,0)
 .. I +PTREL=1,IBISEQ=$$COBN^IBCEF(IBIFN) D ERR(282) Q
"RTN","IBCBB",124,0)
 .. ; if any part of the address is there, then all fields are required
"RTN","IBCBB",125,0)
 .. I CAS'="" D ERR(282) Q
"RTN","IBCBB",126,0)
 .. Q
"RTN","IBCBB",127,0)
 . ;
"RTN","IBCBB",128,0)
 . ;          IB285 - Primary Insurance city missing
"RTN","IBCBB",129,0)
 . ;          IB286 - Secondary Insurance city missing
"RTN","IBCBB",130,0)
 . ;          IB287 - Tertiary Insurance city missing
"RTN","IBCBB",131,0)
 . I $$NOPUNCT^IBCEF($P(SFA,U,2),1)="" D   ; city is blank
"RTN","IBCBB",132,0)
 .. ; pat=subscriber and current insurance - address is required
"RTN","IBCBB",133,0)
 .. I +PTREL=1,IBISEQ=$$COBN^IBCEF(IBIFN) D ERR(285) Q
"RTN","IBCBB",134,0)
 .. ; if any part of the address is there, then all fields are required
"RTN","IBCBB",135,0)
 .. I CAS'="" D ERR(285) Q
"RTN","IBCBB",136,0)
 .. Q
"RTN","IBCBB",137,0)
 . ;
"RTN","IBCBB",138,0)
 . ;          IB288 - Primary Insurance state missing
"RTN","IBCBB",139,0)
 . ;          IB289 - Secondary Insurance state missing
"RTN","IBCBB",140,0)
 . ;          IB290 - Tertiary Insurance state missing
"RTN","IBCBB",141,0)
 . I $$NOPUNCT^IBCEF($P(SFA,U,3),1)="" D   ; state is blank
"RTN","IBCBB",142,0)
 .. ; pat=subscriber and current insurance - address is required
"RTN","IBCBB",143,0)
 .. I +PTREL=1,IBISEQ=$$COBN^IBCEF(IBIFN) D ERR(288) Q
"RTN","IBCBB",144,0)
 .. ; if any part of the address is there, then all fields are required
"RTN","IBCBB",145,0)
 .. I CAS'="" D ERR(288) Q
"RTN","IBCBB",146,0)
 .. Q
"RTN","IBCBB",147,0)
 . ;
"RTN","IBCBB",148,0)
 . ;          IB291 - Primary Insurance zipcode missing
"RTN","IBCBB",149,0)
 . ;          IB292 - Secondary Insurance zipcode missing
"RTN","IBCBB",150,0)
 . ;          IB293 - Tertiary Insurance zipcode missing
"RTN","IBCBB",151,0)
 . I $$NOPUNCT^IBCEF($P(SFA,U,4),1)="" D   ; zipcode is blank
"RTN","IBCBB",152,0)
 .. ; pat=subscriber and current insurance - address is required
"RTN","IBCBB",153,0)
 .. I +PTREL=1,IBISEQ=$$COBN^IBCEF(IBIFN) D ERR(291) Q
"RTN","IBCBB",154,0)
 .. ; if any part of the address is there, then all fields are required
"RTN","IBCBB",155,0)
 .. I CAS'="" D ERR(291) Q
"RTN","IBCBB",156,0)
 .. Q
"RTN","IBCBB",157,0)
 . ;
"RTN","IBCBB",158,0)
 . Q
"RTN","IBCBB",159,0)
 ;
"RTN","IBCBB",160,0)
 ; esg - IB*2*371 - check patient address fields
"RTN","IBCBB",161,0)
 K ^UTILITY("VAPA",$J)
"RTN","IBCBB",162,0)
 ;
"RTN","IBCBB",163,0)
 S IBFOR=0                              ; foreign address flag
"RTN","IBCBB",164,0)
 S IBC=+$$PTADDR^IBCEF(IBIFN,25)        ; country code ien
"RTN","IBCBB",165,0)
 I IBC D
"RTN","IBCBB",166,0)
 . N CODE
"RTN","IBCBB",167,0)
 . S CODE=$$GET1^DIQ(779.004,IBC,.01)   ; .01 code field file 779.004
"RTN","IBCBB",168,0)
 . I CODE'="",CODE'="USA" S IBFOR=1     ; foreign country exists
"RTN","IBCBB",169,0)
 . Q
"RTN","IBCBB",170,0)
 ;
"RTN","IBCBB",171,0)
 I $$NOPUNCT^IBCEF($$PTADDR^IBCEF(IBIFN,1),1)="" S IBER=IBER_"IB269;"
"RTN","IBCBB",172,0)
 I $$NOPUNCT^IBCEF($$PTADDR^IBCEF(IBIFN,4),1)="" S IBER=IBER_"IB270;"
"RTN","IBCBB",173,0)
 I $$NOPUNCT^IBCEF($$PTADDR^IBCEF(IBIFN,5),1)="",'IBFOR S IBER=IBER_"IB271;"
"RTN","IBCBB",174,0)
 I $$NOPUNCT^IBCEF($$PTADDR^IBCEF(IBIFN,11),1)="",'IBFOR S IBER=IBER_"IB272;"
"RTN","IBCBB",175,0)
 K ^UTILITY("VAPA",$J)
"RTN","IBCBB",176,0)
 ;
"RTN","IBCBB",177,0)
 D PAYERADD^IBCBB0(IBIFN)     ; check the payer addresses
"RTN","IBCBB",178,0)
 ;
"RTN","IBCBB",179,0)
 ; esg - 9/20/07 - IB patch 371 - prevent EDI transmission for 3 payer
"RTN","IBCBB",180,0)
 ;       claims for all but the first payer.  To be removed when Emdeon
"RTN","IBCBB",181,0)
 ;       and FSC are able to deal with these.
"RTN","IBCBB",182,0)
 ;
"RTN","IBCBB",183,0)
 I +$G(^DGCR(399,IBIFN,"I2")),+$G(^DGCR(399,IBIFN,"I3")),$$TXMT^IBCEF4(IBIFN) D
"RTN","IBCBB",184,0)
 . ; for MRA request claims, make sure the MRA secondary claim is forced to print
"RTN","IBCBB",185,0)
 . I $$REQMRA^IBEFUNC(IBIFN) D  Q
"RTN","IBCBB",186,0)
 .. I '$P($G(^DGCR(399,IBIFN,"TX")),U,9) S IBER=IBER_"IB146;"
"RTN","IBCBB",187,0)
 .. Q
"RTN","IBCBB",188,0)
 . ;
"RTN","IBCBB",189,0)
 . I $$COBN^IBCEF(IBIFN)=1 Q   ; primary payer sequence claims are OK
"RTN","IBCBB",190,0)
 . ;
"RTN","IBCBB",191,0)
 . ; But claims with a payer sequence of 2 or 3 need to print locally
"RTN","IBCBB",192,0)
 . S IBER=IBER_"IB147;"
"RTN","IBCBB",193,0)
 . Q
"RTN","IBCBB",194,0)
 ;
"RTN","IBCBB",195,0)
 D ^IBCBB1
"RTN","IBCBB",196,0)
 Q
"RTN","IBCBB",197,0)
 ;
"RTN","IBCBB",198,0)
EDIT(IBIFN) ; Run edits from within the billing edit screens
"RTN","IBCBB",199,0)
 N IBVIEW,IBDISP,IBNOFIX,DIR,X,Y
"RTN","IBCBB",200,0)
 S (IBNOFIX,IBVIEW,IBDISP)=1
"RTN","IBCBB",201,0)
 D EDITS^IBCB2
"RTN","IBCBB",202,0)
 W ! S DIR("A")="Press RETURN to continue",DIR(0)="E" D ^DIR K DIR
"RTN","IBCBB",203,0)
 Q
"RTN","IBCBB",204,0)
 ;
"RTN","IBCBB",205,0)
TOB(IBND0) ;
"RTN","IBCBB",206,0)
 ; IBND0 = the 0-node of the bill (file 399)
"RTN","IBCBB",207,0)
 Q ($P(IBND0,U,24)_$P($G(^DGCR(399.1,+$P(IBND0,U,25),0)),U,2)_$P(IBND0,U,26))
"RTN","IBCBB",208,0)
 ;
"RTN","IBCBB",209,0)
ERR(Z) ; update IBER variable from the above insurance checks
"RTN","IBCBB",210,0)
 ; Z is the IB error code# for the primary insurance error
"RTN","IBCBB",211,0)
 N IBERRNO
"RTN","IBCBB",212,0)
 S IBERRNO="IB"_(Z+IBISEQ-1)
"RTN","IBCBB",213,0)
 I IBER[IBERRNO Q
"RTN","IBCBB",214,0)
 S IBER=IBER_IBERRNO_";"
"RTN","IBCBB",215,0)
 Q
"RTN","IBCBB",216,0)
 ;
"RTN","IBCBB0")
0^39^B3028781^n/a
"RTN","IBCBB0",1,0)
IBCBB0 ;ALB/ESG - IB edit check routine continuation ;12-Mar-2008
"RTN","IBCBB0",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCBB0",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCBB0",4,0)
 ;
"RTN","IBCBB0",5,0)
 Q
"RTN","IBCBB0",6,0)
 ;
"RTN","IBCBB0",7,0)
PAYERADD(IBIFN) ; check to make sure payer address is present for all payers on the claim
"RTN","IBCBB0",8,0)
 ; Address line 1, city, state, and zip must be present for all non-Medicare payers on the claim
"RTN","IBCBB0",9,0)
 ;
"RTN","IBCBB0",10,0)
 NEW IBZ,OK,Z,IBL,N,SEQ,ADDR,IBXDATA,IBXSAVE,IBXARRAY,IBXARRY,IBXERR
"RTN","IBCBB0",11,0)
 ;
"RTN","IBCBB0",12,0)
 ; check current payer address if not Medicare
"RTN","IBCBB0",13,0)
 I '$$WNRBILL^IBEFUNC(IBIFN) D
"RTN","IBCBB0",14,0)
 . D F^IBCEF("N-CURR INS CO FULL ADDRESS","IBZ",,IBIFN)
"RTN","IBCBB0",15,0)
 . S OK=1
"RTN","IBCBB0",16,0)
 . F Z=1,4,5,6 I $G(IBZ(Z))="" S OK=0 Q
"RTN","IBCBB0",17,0)
 . I 'OK S IBER=IBER_"IB172;"
"RTN","IBCBB0",18,0)
 . Q
"RTN","IBCBB0",19,0)
 ;
"RTN","IBCBB0",20,0)
 ; check other payer addresses if they exist
"RTN","IBCBB0",21,0)
 D F^IBCEF("N-OTH INSURANCE SEQUENCE","IBL",,IBIFN)    ; other payer sequence array
"RTN","IBCBB0",22,0)
 I '$O(IBXSAVE(1,0)) G PAYERAX                         ; no other payers on claim
"RTN","IBCBB0",23,0)
 S N=0 F  S N=$O(IBXSAVE(1,N)) Q:'N  D
"RTN","IBCBB0",24,0)
 . S SEQ=IBXSAVE(1,N)                                  ; other payer sequence letter
"RTN","IBCBB0",25,0)
 . I $$WNRBILL^IBEFUNC(IBIFN,SEQ) Q                    ; ignore Medicare addresses
"RTN","IBCBB0",26,0)
 . S ADDR=$$ADD^IBCNADD(IBIFN,SEQ)                     ; other payer address string
"RTN","IBCBB0",27,0)
 . S OK=1
"RTN","IBCBB0",28,0)
 . F Z=1,4,5,6 I $P(ADDR,U,Z)="" S OK=0 Q
"RTN","IBCBB0",29,0)
 . I 'OK S IBER=IBER_"IB173;"
"RTN","IBCBB0",30,0)
 . Q
"RTN","IBCBB0",31,0)
 ;
"RTN","IBCBB0",32,0)
PAYERAX ;
"RTN","IBCBB0",33,0)
 Q
"RTN","IBCBB0",34,0)
 ;
"RTN","IBCBB3")
0^28^B47525889^B41352216
"RTN","IBCBB3",1,0)
IBCBB3 ;ALB/TMP - CONTINUATION OF EDIT CHECKS ROUTINE (MEDICARE) ;06/23/98
"RTN","IBCBB3",2,0)
 ;;2.0;INTEGRATED BILLING;**51,137,155,349,371,377**;21-MAR-94;Build 23
"RTN","IBCBB3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCBB3",4,0)
 ;
"RTN","IBCBB3",5,0)
EDITMRA(IBQUIT,IBER,IBIFN,IBFT) ;
"RTN","IBCBB3",6,0)
 ; Requires execution of GVAR^IBCBB, IBIFN defined
"RTN","IBCBB3",7,0)
 ; File IB ERROR (350.8) contains error codes/text
"RTN","IBCBB3",8,0)
 ;
"RTN","IBCBB3",9,0)
 N IBMRATYP,Z,IBZP,IBZP1,IBOK
"RTN","IBCBB3",10,0)
 S IBQUIT=0 ;Flag to say we have too many errors - quit edits
"RTN","IBCBB3",11,0)
 ;
"RTN","IBCBB3",12,0)
 S IBMRATYP=$$MRATYPE^IBEFUNC(IBIFN,"C")
"RTN","IBCBB3",13,0)
 ;
"RTN","IBCBB3",14,0)
 I IBFT=3 D
"RTN","IBCBB3",15,0)
 . D PARTA
"RTN","IBCBB3",16,0)
 ;
"RTN","IBCBB3",17,0)
 I IBFT=2 D PARTB^IBCBB9
"RTN","IBCBB3",18,0)
 ;
"RTN","IBCBB3",19,0)
 K IBXDATA D F^IBCEF("N-ADMITTING DIAGNOSIS",,,IBIFN)
"RTN","IBCBB3",20,0)
 ; Req. for UB-04 type of bills 11x!18x
"RTN","IBCBB3",21,0)
 I $G(IBXDATA)="",IBFT=3 D  Q:IBQUIT
"RTN","IBCBB3",22,0)
 . N Z
"RTN","IBCBB3",23,0)
 . I "^11^18^"[(U_IBTOB12_U) S IBQUIT=$$IBER(.IBER,231) Q
"RTN","IBCBB3",24,0)
 . I $$INPAT^IBCEF(IBIFN,1) S Z="Admitting Diagnosis may be required by payer, please verify" D WARN^IBCBB11(Z)
"RTN","IBCBB3",25,0)
 ;
"RTN","IBCBB3",26,0)
 D GETPRV^IBCEU(IBIFN,"2,3,4",.Z)
"RTN","IBCBB3",27,0)
 S IBOK=1,Z=0,IBZP=U F  S Z=$O(Z(Z)) Q:'Z  S:$S($P($G(Z(Z,1)),U,3)["VA(200":1,1:0) IBZP=IBZP_+$P(Z(Z,1),U,3)_U
"RTN","IBCBB3",28,0)
 D ALLPROC^IBCVA1(IBIFN,.IBZP1)
"RTN","IBCBB3",29,0)
 S Z=0 F  S Z=$O(IBZP1(Z)) Q:'Z  I $P(IBZP1(Z),U,18),IBZP'[(U_$P(IBZP1(Z),U,18)_U) S IBOK=0 Q
"RTN","IBCBB3",30,0)
 I 'IBOK D WARN^IBCBB11("At least one provider on a procedure does not match your "_$S(IBFT=2:"render",1:"attend")_"ing or operating provider")
"RTN","IBCBB3",31,0)
 I IBFT=2 D EN^IBCBB2
"RTN","IBCBB3",32,0)
 ; edit checks for UB-04 (institutional) forms
"RTN","IBCBB3",33,0)
 I IBFT=3 D EN^IBCBB21(.IBZPRC92)
"RTN","IBCBB3",34,0)
 ;
"RTN","IBCBB3",35,0)
 Q
"RTN","IBCBB3",36,0)
 ;
"RTN","IBCBB3",37,0)
PARTA ; MEDICARE specific edit checks for PART A claims (UB-04 formats)
"RTN","IBCBB3",38,0)
 ;
"RTN","IBCBB3",39,0)
 N IBI,IBJ,IBX,IBCTYP,VADM,VAPA,IBSTOP,IBDXC,IBDXARY,IBPR,IBLABS,REQMRA
"RTN","IBCBB3",40,0)
 N IBS,IBTUNIT,IBCAGE,IBREV1,IBOCCS,IBOCSDT,IBVALCD,IBOCCD,IBNOPR
"RTN","IBCBB3",41,0)
 N IBCCARY1,IBPATST,IBZADMIT,IBZDISCH,IBXIEN,IBXERR,IBXDATA,IBOCSP
"RTN","IBCBB3",42,0)
 N IBCOV,IBNCOV,IBREVC,IBREVDUP,IBBCPT,IBREVC12,IBREVTOT,IBECAT,IBINC
"RTN","IBCBB3",43,0)
 ;
"RTN","IBCBB3",44,0)
 ; Medicare is the current payer, but no diagnosis codes
"RTN","IBCBB3",45,0)
 I $$WNRBILL^IBEFUNC(IBIFN) D SET^IBCSC4D(IBIFN,.IBDX,.IBDXO) I '$P(IBDX,U,2) S IBQUIT=$$IBER(.IBER,120) Q:IBQUIT
"RTN","IBCBB3",46,0)
 ;
"RTN","IBCBB3",47,0)
 ; Type of Bill must be three digits
"RTN","IBCBB3",48,0)
 I IBTOB'?3N S X=$$IBER(.IBER,103) Q
"RTN","IBCBB3",49,0)
 ;
"RTN","IBCBB3",50,0)
 ; Covered Days
"RTN","IBCBB3",51,0)
 S IBCTYP=0
"RTN","IBCBB3",52,0)
 S IBCOV=$P(IBNDU2,U,2),IBNCOV=$P(IBNDU2,U,3)
"RTN","IBCBB3",53,0)
 ;
"RTN","IBCBB3",54,0)
 ; If interim bill, covered days must not be greater than 60
"RTN","IBCBB3",55,0)
 I "23"[$E(IBTOB,3),IBCOV>60 S IBQUIT=$$IBER(.IBER,"096") Q:IBQUIT
"RTN","IBCBB3",56,0)
 ;
"RTN","IBCBB3",57,0)
 ; I bill type is 11x or 18x or 21x then we need covered days
"RTN","IBCBB3",58,0)
 I "^11^18^21^"[(U_IBTOB12_U) S IBCTYP=1 I IBCOV="" S IBQUIT=$$IBER(.IBER,106) Q:IBQUIT
"RTN","IBCBB3",59,0)
 ;
"RTN","IBCBB3",60,0)
 S (IBI,IBJ)=0
"RTN","IBCBB3",61,0)
 K IBXDATA D F^IBCEF("N-CONDITION CODES",,,IBIFN)
"RTN","IBCBB3",62,0)
 ; Re-sort the condition codes by code
"RTN","IBCBB3",63,0)
 S IBI=0 F  S IBI=$O(IBXDATA(IBI)) Q:'IBI  S IBCCARY1($P(IBXDATA(IBI),U))=""
"RTN","IBCBB3",64,0)
 ;
"RTN","IBCBB3",65,0)
 ; for condition code 40, covered days must be 0
"RTN","IBCBB3",66,0)
 I $D(IBCCARY1(40)),IBCOV'=0 S IBQUIT=$$IBER(.IBER,107) Q:IBQUIT
"RTN","IBCBB3",67,0)
 ;
"RTN","IBCBB3",68,0)
 ; cov days+non=to date -from date unless the patient status = 30 (still
"RTN","IBCBB3",69,0)
 ;  pt) or outpatient or if the to date and from date are same then add 1
"RTN","IBCBB3",70,0)
 S IBPATST="",IBX=$P(IBNDU,U,12),IBPATST=$P($G(^DGCR(399.1,+IBX,0)),U,2)
"RTN","IBCBB3",71,0)
 S IBINC=$S(IBPATST=30!(IBFDT=IBTDT):1,1:0)
"RTN","IBCBB3",72,0)
 I $$INPAT^IBCEF(IBIFN,1),(IBCOV+IBNCOV)'=($$FMDIFF^XLFDT(IBTDT,IBFDT)+IBINC) S IBQUIT=$$IBER(.IBER,108) Q:IBQUIT
"RTN","IBCBB3",73,0)
 ;
"RTN","IBCBB3",74,0)
 ; if covered days >100 and type of bill is 21x or 18x error
"RTN","IBCBB3",75,0)
 I IBCOV>100,(IBTOB12=18!(IBTOB12=21)) S IBQUIT=$$IBER(.IBER,109) Q:IBQUIT
"RTN","IBCBB3",76,0)
 ;
"RTN","IBCBB3",77,0)
 S (IBJ,IBTUNIT,IBS,IBREVTOT("AC"),IBREVTOT("AI"),IBREVTOT("AO"),IBREVTOT)=0
"RTN","IBCBB3",78,0)
 ;
"RTN","IBCBB3",79,0)
 K IBXDATA D F^IBCEF("N-UB-04 SERVICE LINE (EDI)",,,IBIFN) ;Get rev codes
"RTN","IBCBB3",80,0)
 ;
"RTN","IBCBB3",81,0)
 ; Re-sort the revenue codes by code
"RTN","IBCBB3",82,0)
 ;>> IBREV1(rev code,x)=Rev code^ptr cpt^unit chg^units^total^tot unc
"RTN","IBCBB3",83,0)
 ;   IBREV1(rev code) = revenue code edit category
"RTN","IBCBB3",84,0)
 ;
"RTN","IBCBB3",85,0)
 ; IBNOPR = flag that determines if there are revenue codes with
"RTN","IBCBB3",86,0)
 ;          charges that do not have a procedure - no need to check
"RTN","IBCBB3",87,0)
 ;          for billable MCR procedures if at least one RC is billable
"RTN","IBCBB3",88,0)
 ;          1 = there is at least one billable revenue code without a
"RTN","IBCBB3",89,0)
 ;              procedure
"RTN","IBCBB3",90,0)
 ;
"RTN","IBCBB3",91,0)
 S REQMRA=$$REQMRA^IBEFUNC(IBIFN)
"RTN","IBCBB3",92,0)
 S (IBNOPR,IBI)=0
"RTN","IBCBB3",93,0)
 F  S IBI=$O(IBXDATA(IBI)) Q:'IBI  D
"RTN","IBCBB3",94,0)
 . I REQMRA D GYMODCHK(IBXDATA(IBI))      ; IB*2*377 GY modifier check
"RTN","IBCBB3",95,0)
 . S IBJ=$P(IBXDATA(IBI),U),IBECAT=""
"RTN","IBCBB3",96,0)
 . I 'IBNOPR D
"RTN","IBCBB3",97,0)
 .. I $P(IBXDATA(IBI),U,2)'="" S IBPR($P(IBXDATA(IBI),U,2))=IBI Q
"RTN","IBCBB3",98,0)
 .. S IBNOPR=1 K IBPR
"RTN","IBCBB3",99,0)
 . S:$D(IBREV1(IBJ)) IBECAT=$G(IBREV1(IBJ))
"RTN","IBCBB3",100,0)
 . I '$D(IBREV1(IBJ))!(IBECAT="") D  S IBREV1(IBJ)=IBECAT
"RTN","IBCBB3",101,0)
 . . ;
"RTN","IBCBB3",102,0)
 . . ; Accomodations (AC)
"RTN","IBCBB3",103,0)
 . . I (IBJ'<100&(IBJ'>219))!(IBJ=224) S IBECAT="AC" Q
"RTN","IBCBB3",104,0)
 . . ;
"RTN","IBCBB3",105,0)
 . . ; Ancillary Outpatient (AO)
"RTN","IBCBB3",106,0)
 . . I '$$INPAT^IBCEF(IBIFN,1) S IBECAT="AO" Q
"RTN","IBCBB3",107,0)
 . . ;
"RTN","IBCBB3",108,0)
 . . ; Ancillary Inpatient (AI)
"RTN","IBCBB3",109,0)
 . . S IBECAT="AI"
"RTN","IBCBB3",110,0)
 . ;
"RTN","IBCBB3",111,0)
 . S IBREV1(IBJ,+$O(IBREV1(IBJ,""),-1)+1)=IBXDATA(IBI)
"RTN","IBCBB3",112,0)
 . S IBREVTOT(IBECAT)=IBREVTOT(IBECAT)+$P(IBXDATA(IBI),U,6)
"RTN","IBCBB3",113,0)
 . I IBECAT="AC" S IBTUNIT=IBTUNIT+$P(IBXDATA(IBI),U,4)
"RTN","IBCBB3",114,0)
 ;
"RTN","IBCBB3",115,0)
 I $$NEEDMRA^IBEFUNC(IBIFN),$O(IBPR(""))'="" D  Q:IBQUIT
"RTN","IBCBB3",116,0)
 . ; Don't allow a bill containing only billable procedures for:
"RTN","IBCBB3",117,0)
 . ;    Oxygen, labs, or influenza shots
"RTN","IBCBB3",118,0)
 . ;  OR a bill with prosthetics on it
"RTN","IBCBB3",119,0)
 . ;    to be sent to MEDICARE for an MRA
"RTN","IBCBB3",120,0)
 . D NONMCR(.IBPR,.IBLABS) ; Remove Oxygen, labs, influenza shots
"RTN","IBCBB3",121,0)
 . I $G(IBLABS) D WARN^IBCBB11("The only possible billable procedures on this bill are labs -"),WARN^IBCBB11(" Please verify that MEDICARE does not reimburse these labs at 100%") Q
"RTN","IBCBB3",122,0)
 . I $O(IBPR(""))="" D
"RTN","IBCBB3",123,0)
 .. S IBQUIT=$$IBER(.IBER,"098")
"RTN","IBCBB3",124,0)
 ;
"RTN","IBCBB3",125,0)
 ; covered days+non covered = units of accom rev codes
"RTN","IBCBB3",126,0)
 ; Check room and board
"RTN","IBCBB3",127,0)
 I IBTUNIT,IBTUNIT'=(IBCOV+IBNCOV) S IBQUIT=$$IBER(.IBER,114) Q:IBQUIT
"RTN","IBCBB3",128,0)
 ;
"RTN","IBCBB3",129,0)
 ; Non Covered Days
"RTN","IBCBB3",130,0)
 ;   required when the type of bill is 11x,18x,21x or covered days=0
"RTN","IBCBB3",131,0)
 I IBNCOV="",(IBCTYP!(IBCOV=0)) S IBQUIT=$$IBER(.IBER,115) Q:IBQUIT
"RTN","IBCBB3",132,0)
 ;
"RTN","IBCBB3",133,0)
 ; if cc code=40 then non-covered days must be 1
"RTN","IBCBB3",134,0)
 I $D(IBCCARY1(40)),IBNCOV'=1 S IBQUIT=$$IBER(.IBER,116) Q:IBQUIT
"RTN","IBCBB3",135,0)
 ;
"RTN","IBCBB3",136,0)
 ; Patient Sex
"RTN","IBCBB3",137,0)
 ; must be "M" or "F"
"RTN","IBCBB3",138,0)
 D DEM^VADPT
"RTN","IBCBB3",139,0)
 I $P(VADM(5),U)'="M",$P(VADM(5),U)'="F" S IBQUIT=$$IBER(.IBER,124) Q:IBQUIT
"RTN","IBCBB3",140,0)
 ;
"RTN","IBCBB3",141,0)
 ; esg - 10/17/07 - patch 371
"RTN","IBCBB3",142,0)
 ; For Part A replacement MRA request claims, make sure
"RTN","IBCBB3",143,0)
 ; the Medicare ICN/DCN number is present and also text in FL-80.
"RTN","IBCBB3",144,0)
 I $$REQMRA^IBEFUNC(IBIFN),$F(".137.138.117.118.","."_IBTOB_".") D  Q:IBQUIT
"RTN","IBCBB3",145,0)
 . N IBZ,FL80TXT
"RTN","IBCBB3",146,0)
 . D F^IBCEF("N-CURR INS FORM LOC 64","IBZ",,IBIFN)  ; see CI3-11
"RTN","IBCBB3",147,0)
 . I IBZ="" S IBQUIT=$$IBER(.IBER,205) Q:IBQUIT      ; missing ICN/DCN
"RTN","IBCBB3",148,0)
 . S FL80TXT=$P($G(^DGCR(399,IBIFN,"UF2")),U,3)
"RTN","IBCBB3",149,0)
 . I FL80TXT="" S IBQUIT=$$IBER(.IBER,206) Q:IBQUIT  ; missing FL80 text
"RTN","IBCBB3",150,0)
 . Q
"RTN","IBCBB3",151,0)
 ;
"RTN","IBCBB3",152,0)
 D ^IBCBB4
"RTN","IBCBB3",153,0)
 Q
"RTN","IBCBB3",154,0)
 ;
"RTN","IBCBB3",155,0)
IBER(IBER,ERRNO) ; Sets error list
"RTN","IBCBB3",156,0)
 ; NOTE: add code to check error list > 20 ... If so, display message and
"RTN","IBCBB3",157,0)
 ;   quit so we don't get too many errors at once to handle
"RTN","IBCBB3",158,0)
 ;   Print all if printing list
"RTN","IBCBB3",159,0)
 ;
"RTN","IBCBB3",160,0)
 I '$G(IBQUIT) D
"RTN","IBCBB3",161,0)
 . I ERRNO?1N.N S:$L(ERRNO)<3 ERRNO=$E("00",1,3-$L(ERRNO))_ERRNO
"RTN","IBCBB3",162,0)
 . I $L(IBER,";")>19,'$G(IBPRT("PRT")) S IBER=IBER_"IB999;",IBQUIT=1
"RTN","IBCBB3",163,0)
 . I $G(IBER)'[("IB"_ERRNO_";") S IBER=IBER_"IB"_ERRNO_";"
"RTN","IBCBB3",164,0)
 Q IBQUIT
"RTN","IBCBB3",165,0)
 ;
"RTN","IBCBB3",166,0)
NONMCR(IBPR,IBLABS) ;  Delete all oxygen and lab, flu shot CPT entries from IBPR
"RTN","IBCBB3",167,0)
 ; IBPR = array subscripted by CPT codes from bill
"RTN","IBCBB3",168,0)
 ; IBLABS = flag returned =1 if labs found on bill
"RTN","IBCBB3",169,0)
 N Z S IBLABS=0
"RTN","IBCBB3",170,0)
 ; Oxygen
"RTN","IBCBB3",171,0)
 F Z="A0422","A4575","A4616","A4619","A4620","A4621","E0455","E1353","E1355" K IBPR(Z)
"RTN","IBCBB3",172,0)
 F Z=77:1:85 S Z0="E13"_Z K IBPR(Z0)
"RTN","IBCBB3",173,0)
 ; Labs
"RTN","IBCBB3",174,0)
 S Z="80000" F  S Z=$O(IBPR(Z)) Q:Z'?1"8"4N  S IBLABS=1
"RTN","IBCBB3",175,0)
 ; Flu shots
"RTN","IBCBB3",176,0)
 F Z="90724","G0008","90732","G0009","90657","90658","90659","90660" K IBPR(Z)
"RTN","IBCBB3",177,0)
 Q
"RTN","IBCBB3",178,0)
 ;
"RTN","IBCBB3",179,0)
MCRANUM(IBIFN) ; Determine MEDICARE A provider ID # from bedsection for
"RTN","IBCBB3",180,0)
 ; bill ien IBIFN
"RTN","IBCBB3",181,0)
 N IBX
"RTN","IBCBB3",182,0)
 ; PART A MRA (only) needed - determine if psych/non-psych claim
"RTN","IBCBB3",183,0)
 N IBX,IBI
"RTN","IBCBB3",184,0)
 S IBI=$P($G(^DGCR(399,IBIFN,"U")),U,11)
"RTN","IBCBB3",185,0)
 S IBX=$S($TR($P($G(^DGCR(399.1,+IBI,0)),U),"psych","PSYCH")'["PSYCH":670899,1:674499)
"RTN","IBCBB3",186,0)
 Q IBX
"RTN","IBCBB3",187,0)
 ;
"RTN","IBCBB3",188,0)
MCRACK(IBIFN,X,IBFLD) ; Check for MEDICARE A for bill IBIFN
"RTN","IBCBB3",189,0)
 ; Called from CLAIM STATUS MRA field (#24) xrefs in file 399
"RTN","IBCBB3",190,0)
 ; X = current value of field 399;24
"RTN","IBCBB3",191,0)
 ; IBFLD = 1 for primary ins co, 2 for secondary, 3 for tertiary
"RTN","IBCBB3",192,0)
 N IB
"RTN","IBCBB3",193,0)
 S IB=0
"RTN","IBCBB3",194,0)
 I +X,$$COBN^IBCEF(IBIFN)=IBFLD,$$WNRBILL^IBEFUNC(IBIFN,IBFLD),$$MRATYPE^IBEFUNC(IBIFN,"C")="A" S IB=1
"RTN","IBCBB3",195,0)
 Q IB
"RTN","IBCBB3",196,0)
 ;
"RTN","IBCBB3",197,0)
GYMODCHK(Z) ; GY modifier check procedure.  IB*2*377 - 2/4/08
"RTN","IBCBB3",198,0)
 ; Z is the IBXDATA(IBI) service line EDI
"RTN","IBCBB3",199,0)
 N MODS
"RTN","IBCBB3",200,0)
 I IBER["IB123" Q     ; error already found
"RTN","IBCBB3",201,0)
 S MODS=$P(Z,U,9)     ; list of modifiers separated by commas
"RTN","IBCBB3",202,0)
 I MODS'["GY" Q       ; GY modifier not here on this line item
"RTN","IBCBB3",203,0)
 I $P(Z,U,6) Q        ; non-covered charges exist on this line item
"RTN","IBCBB3",204,0)
 S IBQUIT=$$IBER(.IBER,123)
"RTN","IBCBB3",205,0)
GYMODX ;
"RTN","IBCBB3",206,0)
 Q
"RTN","IBCBB3",207,0)
 ;
"RTN","IBCC1")
0^18^B38579110^B14938424
"RTN","IBCC1",1,0)
IBCC1 ;ALB/MJB - CANCEL THIRD PARTY BILL ;10-OCT-94
"RTN","IBCC1",2,0)
 ;;2.0;INTEGRATED BILLING;**19,95,160,159,320,347,377**;21-MAR-94;Build 23
"RTN","IBCC1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCC1",4,0)
 ;
"RTN","IBCC1",5,0)
RNB ; -- Add a reason not billable to claims tracking
"RTN","IBCC1",6,0)
 N X,Y,DIC,DIE,I,J,DA,DR,IBTYP,IBTRE,IB,IBAPPT,IBDT,IBTALK,IBCODE,IBTRED,IBTSAV,FILL,IBRX,IBDATA,IBD,IBDT,IBQUIT,IBPRO,IBDD
"RTN","IBCC1",7,0)
 N ZT,TCNT,CNT
"RTN","IBCC1",8,0)
 Q:'$G(IBIFN)
"RTN","IBCC1",9,0)
 S IB(0)=$G(^DGCR(399,IBIFN,0)),IBTYP=$P(IB(0),"^",5),IBQUIT=0
"RTN","IBCC1",10,0)
 I '$D(DFN) S DFN=$P(IB(0),"^",2)
"RTN","IBCC1",11,0)
 KILL ^TMP($J,"IBCC1")
"RTN","IBCC1",12,0)
 ;
"RTN","IBCC1",13,0)
 ; -- is inpt find entry in dgpm, then in ibt(356, s da=ibtre then edit
"RTN","IBCC1",14,0)
INPT I IBTYP<3 D
"RTN","IBCC1",15,0)
 .S DATE=$P(IB(0),"^",3),DFN=$P(IB(0),"^",2)
"RTN","IBCC1",16,0)
 .S DGPM=$O(^DGPM("APTT1",DFN,DATE,0)) ; double check for asih
"RTN","IBCC1",17,0)
 .I DGPM S (IBTRE,IBTSAV)=$O(^IBT(356,"AD",DGPM,0))
"RTN","IBCC1",18,0)
 .I $G(IBTRE) D CTSET(IBTRE)
"RTN","IBCC1",19,0)
 .Q:IBQUIT
"RTN","IBCC1",20,0)
 .;
"RTN","IBCC1",21,0)
 .; -- alternate inpt method
"RTN","IBCC1",22,0)
 .S IBCODE=$O(^IBE(356.6,"ACODE",1,0))
"RTN","IBCC1",23,0)
 .S DATE=$P(IB(0),"^",3),DFN=$P(IB(0),"^",2)
"RTN","IBCC1",24,0)
 .S IBDT=(DATE-.25) F  S IBDT=$O(^IBT(356,"APTY",DFN,IBCODE,IBDT)) Q:'IBDT!(IBDT>(DATE+.24))  D
"RTN","IBCC1",25,0)
 ..S IBTRE=0 F  S IBTRE=$O(^IBT(356,"APTY",DFN,IBCODE,IBDT,IBTRE)) Q:IBTRE=""!(IBQUIT)  D:$G(IBTSAV)'=IBTRE CTSET(IBTRE)
"RTN","IBCC1",26,0)
 .Q
"RTN","IBCC1",27,0)
 ;
"RTN","IBCC1",28,0)
OPT ; -- is opt-find entries in IBT(356, for opt dates and then edit
"RTN","IBCC1",29,0)
 I IBTYP>2 S IBCODE=$O(^IBE(356.6,"ACODE",2,0)) D
"RTN","IBCC1",30,0)
 .S IBAPPT=0 F  S IBAPPT=$O(^DGCR(399,IBIFN,"OP",IBAPPT)) Q:'IBAPPT!(IBQUIT)  D
"RTN","IBCC1",31,0)
 ..S IBDT=(IBAPPT-.01) F  S IBDT=$O(^IBT(356,"APTY",DFN,IBCODE,IBDT)) Q:'IBDT!(IBDT>(IBAPPT+.24))  D
"RTN","IBCC1",32,0)
 ...S IBTRE=0 F  S IBTRE=$O(^IBT(356,"APTY",DFN,IBCODE,IBDT,IBTRE)) Q:IBTRE=""!(IBQUIT)  D CTSET(IBTRE)
"RTN","IBCC1",33,0)
 .Q
"RTN","IBCC1",34,0)
 ;
"RTN","IBCC1",35,0)
RX ; -- find rx's on bill
"RTN","IBCC1",36,0)
 S IBDD=0 F  S IBDD=$O(^IBA(362.4,"AIFN"_IBIFN,IBDD)) Q:'IBDD  S IBD=0 F  S IBD=$O(^IBA(362.4,"AIFN"_IBIFN,IBDD,IBD)) Q:'IBD!(IBQUIT)  D
"RTN","IBCC1",37,0)
 .S IBDATA=$G(^IBA(362.4,IBD,0)),IBRX=$P(IBDATA,"^",5),IBDT=$P(IBDATA,"^",3)
"RTN","IBCC1",38,0)
 .I '$G(IBRX) S DIC=52,DIC(0)="BO",X=$P(IBDATA,"^",1) D DIC^PSODI(52,.DIC,X) S IBRX=+Y K DIC,X,Y Q:IBRX=-1
"RTN","IBCC1",39,0)
 .S FILL="" F  S FILL=$O(^IBT(356,"ARXFL",IBRX,FILL)) Q:FILL=""!(IBQUIT)  D
"RTN","IBCC1",40,0)
 ..S IBTRE=0 F  S IBTRE=$O(^IBT(356,"ARXFL",IBRX,FILL,IBTRE)) Q:'IBTRE!(IBQUIT)  I $P(^IBT(356,+IBTRE,0),"^",6)=IBDT D CTSET(IBTRE)
"RTN","IBCC1",41,0)
 ;
"RTN","IBCC1",42,0)
PRO ; -- find prosthetics on bill
"RTN","IBCC1",43,0)
 S IBDD=0 F  S IBDD=$O(^IBA(362.5,"AIFN"_IBIFN,IBDD)) Q:'IBDD  S IBD=0 F  S IBD=$O(^IBA(362.5,"AIFN"_IBIFN,IBDD,IBD)) Q:'IBD!(IBQUIT)  D
"RTN","IBCC1",44,0)
 .S IBDATA=$G(^IBA(362.5,IBD,0)),IBPRO=$P(IBDATA,"^",4)
"RTN","IBCC1",45,0)
 .Q:'$G(IBPRO)
"RTN","IBCC1",46,0)
 .S IBTRE=0 F  S IBTRE=$O(^IBT(356,"APRO",+IBPRO,IBTRE)) Q:'IBTRE!(IBQUIT)  D CTSET(IBTRE)
"RTN","IBCC1",47,0)
 ;
"RTN","IBCC1",48,0)
 ; ----- Finished with the gathering of the CT data entries -----
"RTN","IBCC1",49,0)
 ;
"RTN","IBCC1",50,0)
 ; count up the total number of CT entries recorded in the scratch global
"RTN","IBCC1",51,0)
 S ZT="",TCNT=0
"RTN","IBCC1",52,0)
 F  S ZT=$O(^TMP($J,"IBCC1",ZT)) Q:ZT=""  S IBTRE=0 F  S IBTRE=$O(^TMP($J,"IBCC1",ZT,IBTRE)) Q:'IBTRE  S TCNT=TCNT+1
"RTN","IBCC1",53,0)
 ;
"RTN","IBCC1",54,0)
 ; loop thru all of the associated CT entries and call the RNBEDIT procedure for each one
"RTN","IBCC1",55,0)
 S ZT="",CNT=0
"RTN","IBCC1",56,0)
 F  S ZT=$O(^TMP($J,"IBCC1",ZT)) Q:ZT=""!IBQUIT  D  Q:IBQUIT
"RTN","IBCC1",57,0)
 . S IBTRE=0 F  S IBTRE=$O(^TMP($J,"IBCC1",ZT,IBTRE)) Q:'IBTRE!IBQUIT  S CNT=CNT+1 D RNBEDIT(IBTRE,ZT,TCNT,CNT)
"RTN","IBCC1",58,0)
 . Q
"RTN","IBCC1",59,0)
 ;
"RTN","IBCC1",60,0)
 ; clean-up the scratch global when completed
"RTN","IBCC1",61,0)
 KILL ^TMP($J,"IBCC1")
"RTN","IBCC1",62,0)
 Q
"RTN","IBCC1",63,0)
 ;
"RTN","IBCC1",64,0)
CTSET(IBTRE) ; procedure to store this CT entry in the scratch global
"RTN","IBCC1",65,0)
 Q:'$G(IBTRE)
"RTN","IBCC1",66,0)
 S ^TMP($J,"IBCC1",$$TYPE(IBTRE),IBTRE)=""
"RTN","IBCC1",67,0)
CTSETX ;
"RTN","IBCC1",68,0)
 Q
"RTN","IBCC1",69,0)
 ;
"RTN","IBCC1",70,0)
RNBEDIT(IBTRE,CTTYPE,TCNT,CNT) ; CT entry display and capture RNB data and additional comment data
"RTN","IBCC1",71,0)
 Q:IBQUIT
"RTN","IBCC1",72,0)
 I '$D(IBTALK) D
"RTN","IBCC1",73,0)
 . N CTZ
"RTN","IBCC1",74,0)
 . W !!,"Since you have canceled this bill, you may enter a Reason Not Billable and"
"RTN","IBCC1",75,0)
 . W !,"an Additional Comment into Claims Tracking."
"RTN","IBCC1",76,0)
 . W !,"This will take the care off of the UNBILLED lists."
"RTN","IBCC1",77,0)
 . I TCNT=1 S CTZ="Note:  There is 1 associated Claims Tracking entry."
"RTN","IBCC1",78,0)
 . E  S CTZ="Note:  There are "_TCNT_" associated Claims Tracking entries."
"RTN","IBCC1",79,0)
 . W !!,CTZ
"RTN","IBCC1",80,0)
 . Q
"RTN","IBCC1",81,0)
 ;
"RTN","IBCC1",82,0)
 S IBTALK=1
"RTN","IBCC1",83,0)
 ;
"RTN","IBCC1",84,0)
 N %,IBTRED,IBTRED1 S IBTRED=$G(^IBT(356,IBTRE,0)),IBTRED1=$G(^IBT(356,IBTRE,1))
"RTN","IBCC1",85,0)
 ;
"RTN","IBCC1",86,0)
 W !!,"Claims Tracking Entry [",CNT," of ",TCNT,"]"
"RTN","IBCC1",87,0)
 W !?7,"Entry ID#: ",+IBTRED
"RTN","IBCC1",88,0)
 W !?12,"Type: ",$$EXPAND^IBTRE(356,.18,$P(IBTRED,U,18))
"RTN","IBCC1",89,0)
 ;
"RTN","IBCC1",90,0)
 I CTTYPE=1 D     ; inpatient admission or scheduled admission
"RTN","IBCC1",91,0)
 . W !?2,"Admission Date: ",$$FMTE^XLFDT($P(IBTRED,U,6),"1P")
"RTN","IBCC1",92,0)
 . Q
"RTN","IBCC1",93,0)
 ;
"RTN","IBCC1",94,0)
 I CTTYPE=2 D     ; outpatient visit
"RTN","IBCC1",95,0)
 . N IBOE,IBOE0
"RTN","IBCC1",96,0)
 . W !?6,"Visit Date: ",$$FMTE^XLFDT($P(IBTRED,U,6),"1P")
"RTN","IBCC1",97,0)
 . S IBOE=+$P(IBTRED,U,4),IBOE0=$$SCE^IBSDU(IBOE)
"RTN","IBCC1",98,0)
 . W !?10,"Clinic: ",$$GET1^DIQ(44,+$P(IBOE0,U,4)_",",.01)
"RTN","IBCC1",99,0)
 . Q
"RTN","IBCC1",100,0)
 ;
"RTN","IBCC1",101,0)
 I CTTYPE=3 D     ; prescription refill
"RTN","IBCC1",102,0)
 . N PSONTALK,PSOTMP,X
"RTN","IBCC1",103,0)
 . S PSONTALK=1
"RTN","IBCC1",104,0)
 . S X=+$P(IBTRED,U,8)_U_+$P(IBTRED,U,10) D EN^PSOCPVW
"RTN","IBCC1",105,0)
 . ;if refill was deleted and EN^PSOCPVW doesn't return any data use IB API
"RTN","IBCC1",106,0)
 . I '$D(PSOTMP) D PSOCPVW^IBNCPDPC(+$P(IBTRED,U,2),+$P(IBTRED,U,8),.PSOTMP)
"RTN","IBCC1",107,0)
 . W !?3,"Prescription#: ",$G(PSOTMP(52,+$P(IBTRED,U,8),.01,"E"))
"RTN","IBCC1",108,0)
 . I '$P(IBTRED,U,10) W !?7,"Fill Date: ",$$FMTE^XLFDT($P(IBTRED,U,6),"1P")
"RTN","IBCC1",109,0)
 . I $P(IBTRED,U,10) W !?5,"Refill Date: ",$$FMTE^XLFDT($P(IBTRED,U,6),"1P")
"RTN","IBCC1",110,0)
 . W !?12,"Drug: ",$G(PSOTMP(52,+$P(IBTRED,U,8),6,"E"))
"RTN","IBCC1",111,0)
 . Q
"RTN","IBCC1",112,0)
 ;
"RTN","IBCC1",113,0)
 I CTTYPE=4 D     ; prosthetic item
"RTN","IBCC1",114,0)
 . N IBDA,IBRMPR
"RTN","IBCC1",115,0)
 . S IBDA=$P(IBTRED,U,9)
"RTN","IBCC1",116,0)
 . D PRODATA^IBTUTL1(IBDA)
"RTN","IBCC1",117,0)
 . W !?3,"Delivery Date: ",$$FMTE^XLFDT($P(IBTRED,U,6),"1P")
"RTN","IBCC1",118,0)
 . W !?12,"Item: ",$G(IBRMPR(660,+IBDA,4,"E"))
"RTN","IBCC1",119,0)
 . W !?5,"Description: ",$G(IBRMPR(660,+IBDA,24,"E"))
"RTN","IBCC1",120,0)
 . Q
"RTN","IBCC1",121,0)
 ;
"RTN","IBCC1",122,0)
 I $G(IBMCSRNB)'="",$P(IBTRED,U,19) W !," Note:  A Reason Not Billable has been previously entered",!?8,"for this Claims Tracking record."
"RTN","IBCC1",123,0)
 I $G(IBMCSCAC)'="",$P(IBTRED1,U,8)'="" W !," Note:  An Additional Comment has been previously entered",!?8,"for this Claims Tracking record."
"RTN","IBCC1",124,0)
 ;
"RTN","IBCC1",125,0)
 S DA=IBTRE,DIE="^IBT(356,",DR=".19"
"RTN","IBCC1",126,0)
 I $G(IBMCSRNB)'="" S DR=".19//"_$P(IBMCSRNB,U,2)    ; IB*320 MCS cancel - reason not billable
"RTN","IBCC1",127,0)
 I $G(IBMCSCAC)'="" S DR=DR_";1.08//^S X=IBMCSCAC"   ; IB*377 MCS cancel - additional comment
"RTN","IBCC1",128,0)
 I $G(IBMCSCAC)="" S DR=DR_";1.08"                   ; IB*377 additional comment field SRS 3.3.2.1
"RTN","IBCC1",129,0)
 D ^DIE
"RTN","IBCC1",130,0)
 ;
"RTN","IBCC1",131,0)
 ; - if the RNB or additional comment changed, update the user and date/time last edited
"RTN","IBCC1",132,0)
 I $P(IBTRED,U,19)'=$P($G(^IBT(356,IBTRE,0)),U,19)!($P(IBTRED1,U,8)'=$P($G(^IBT(356,IBTRE,1)),U,8)) D NOW^%DTC S DR="1.03///"_%_";1.04////"_DUZ D ^DIE
"RTN","IBCC1",133,0)
 ;
"RTN","IBCC1",134,0)
 ; $D(Y) indicates an up-arrow exit from the DIE call (??)
"RTN","IBCC1",135,0)
 I $D(Y) S DFN=+$P(^IBT(356,IBTRE,0),"^",2) D FIND^IBOHCT(DFN,IBTRE) S IBQUIT=1
"RTN","IBCC1",136,0)
 Q
"RTN","IBCC1",137,0)
 ;
"RTN","IBCC1",138,0)
TYPE(Z) ; function to get the type of claims tracking entry
"RTN","IBCC1",139,0)
 ; Z is the ien to file 356
"RTN","IBCC1",140,0)
 Q +$P($G(^IBE(356.6,+$P($G(^IBT(356,+Z,0)),U,18),0)),U,3)
"RTN","IBCC1",141,0)
 ;
"RTN","IBCE835")
0^24^B38860252^B36249252
"RTN","IBCE835",1,0)
IBCE835 ;ALB/TMP - 835 EDI EXPLANATION OF BENEFITS MSG PROCESSING ;19-JAN-99
"RTN","IBCE835",2,0)
 ;;2.0;INTEGRATED BILLING;**137,135,155,377**;21-MAR-94;Build 23
"RTN","IBCE835",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCE835",4,0)
 ;
"RTN","IBCE835",5,0)
 Q
"RTN","IBCE835",6,0)
 ;
"RTN","IBCE835",7,0)
 ; MESSAGE HEADER DATA STRING =
"RTN","IBCE835",8,0)
 ;   type of message^msg queue^msg #^bill #^^date/time
"RTN","IBCE835",9,0)
 ;
"RTN","IBCE835",10,0)
HDR(IBCLNO,IBD) ;Process header data
"RTN","IBCE835",11,0)
 ; INPUT:
"RTN","IBCE835",12,0)
 ;   IBCLNO = claim #
"RTN","IBCE835",13,0)
 ;
"RTN","IBCE835",14,0)
 ;   ^TMP("IBMSGH",$J,0) = header message text
"RTN","IBCE835",15,0)
 ;
"RTN","IBCE835",16,0)
 ; OUTPUT:
"RTN","IBCE835",17,0)
 ;   IBD array returned with processed data
"RTN","IBCE835",18,0)
 ;      "LINE"  = The last line # populated in the message
"RTN","IBCE835",19,0)
 ;      "DATE"  = Date/Time of EOB (Fileman format)
"RTN","IBCE835",20,0)
 ;      "MRA"   = 1 if MRA, 0 if not
"RTN","IBCE835",21,0)
 ;      "X12"   = 1 if X12, 0 if not
"RTN","IBCE835",22,0)
 ;
"RTN","IBCE835",23,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,0)=MESSAGE HEADER DATA STRING
"RTN","IBCE835",24,0)
 ;                                  ,"D",0,1)=header record raw data
"RTN","IBCE835",25,0)
 ;                                  ,"D1",1,0)=header record raw data
"RTN","IBCE835",26,0)
 ;                                  ,line #)=EOB message lines
"RTN","IBCE835",27,0)
 ;
"RTN","IBCE835",28,0)
 N CT,IB399,IBD0,IBBILL,LINE,L,X,Y,Z,%DT
"RTN","IBCE835",29,0)
 S IBD0=$G(^TMP("IBMSGH",$J,0)),IBD("LINE")=0
"RTN","IBCE835",30,0)
 Q:IBD0=""
"RTN","IBCE835",31,0)
 S X=$P(IBD0,U,3),X=$E(X,5,8)_$E(X,1,4)_"@"_$P(IBD0,U,4)
"RTN","IBCE835",32,0)
 I X S %DT="XTS" D ^%DT
"RTN","IBCE835",33,0)
 S IBD("DATE")=$S(Y>0:Y,1:"")
"RTN","IBCE835",34,0)
 S IBD("MRA")=$P(IBD0,U,5)
"RTN","IBCE835",35,0)
 S IBD("X12")=($P(IBD0,U,2)="X")
"RTN","IBCE835",36,0)
 S CT=0
"RTN","IBCE835",37,0)
 ;
"RTN","IBCE835",38,0)
 I $P(IBD0,U,6)'="" S CT=CT+1 S LINE(CT)=$G(LINE(CT))_"Payer Name: "_$P(IBD0,U,6)
"RTN","IBCE835",39,0)
 ;
"RTN","IBCE835",40,0)
 I CT D
"RTN","IBCE835",41,0)
 . S (L,Z)=0
"RTN","IBCE835",42,0)
 . F  S Z=$O(LINE(Z)) Q:'Z  S L=L+1,^TMP("IBMSG",$J,"CLAIM",IBCLNO,L)=LINE(Z)
"RTN","IBCE835",43,0)
 . S IBD("LINE")=IBD("LINE")+CT
"RTN","IBCE835",44,0)
 ;
"RTN","IBCE835",45,0)
 S IB399=+$O(^DGCR(399,"B",$$GETCLM^IBCE277(IBCLNO),""),-1)
"RTN","IBCE835",46,0)
 ;
"RTN","IBCE835",47,0)
 S IBBILL=$$LAST364^IBCEF4(IB399)
"RTN","IBCE835",48,0)
 ;
"RTN","IBCE835",49,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLNO,0)="835EOB"_U_$G(IBD("MSG#"))_U_$G(IBD("SUBJ"))_U_IBBILL_U_U_IBD("DATE")
"RTN","IBCE835",50,0)
 ;
"RTN","IBCE835",51,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLNO,"D",0,1)="##RAW DATA: "_IBD0
"RTN","IBCE835",52,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLNO,"D1",1,0)="##RAW DATA: "_IBD0
"RTN","IBCE835",53,0)
 Q
"RTN","IBCE835",54,0)
 ;
"RTN","IBCE835",55,0)
5(IBD) ; Process claim patient ID data
"RTN","IBCE835",56,0)
 ; INPUT:
"RTN","IBCE835",57,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE835",58,0)
 ;
"RTN","IBCE835",59,0)
 ; OUTPUT:
"RTN","IBCE835",60,0)
 ;   IBD array
"RTN","IBCE835",61,0)
 ;      "LINE" = the last line # populated in the message
"RTN","IBCE835",62,0)
 ;
"RTN","IBCE835",63,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,line#)=claim pt id message lines
"RTN","IBCE835",64,0)
 ;                                  ,"D",5,msg seq #)=
"RTN","IBCE835",65,0)
 ;                                  ,"D1",msg seq #,5)=
"RTN","IBCE835",66,0)
 ;                                       claim pt id message raw data
"RTN","IBCE835",67,0)
 ;
"RTN","IBCE835",68,0)
 N IBBILL
"RTN","IBCE835",69,0)
 S IBBILL=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",70,0)
 ;
"RTN","IBCE835",71,0)
 I '$D(^TMP("IBMSG",$J,"CLAIM",IBBILL)) D HDR(IBBILL,.IBD) ;Process header data if not already done for claim
"RTN","IBCE835",72,0)
 ;
"RTN","IBCE835",73,0)
 I $P(IBD,U,9) D  ;Statement dates
"RTN","IBCE835",74,0)
 . S IBD("LINE")=$G(IBD("LINE"))+1
"RTN","IBCE835",75,0)
 . S ^TMP("IBMSG",$J,"CLAIM",IBBILL,IBD("LINE"))="Statement Dates: "_$$DATE^IBCE277($P(IBD,U,9))_" - "_$$DATE^IBCE277($P(IBD,U,10))
"RTN","IBCE835",76,0)
 ;
"RTN","IBCE835",77,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBBILL,"D",5,1)="##RAW DATA: "_IBD
"RTN","IBCE835",78,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBBILL,"D1",1,5)="##RAW DATA: "_IBD
"RTN","IBCE835",79,0)
 Q
"RTN","IBCE835",80,0)
 ;
"RTN","IBCE835",81,0)
6(IBD) ; Process 06 record type for corrected name and/or ID# - IB*2*377 - 1/14/08
"RTN","IBCE835",82,0)
 NEW IBCLM,Z
"RTN","IBCE835",83,0)
 S IBCLM=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",84,0)
 Q:IBCLM=""
"RTN","IBCE835",85,0)
 I '$D(^TMP("IBMSG",$J,"CLAIM",IBCLM)) D HDR(IBCLM,.IBD)   ;Process header data if not already done for claim
"RTN","IBCE835",86,0)
 ;
"RTN","IBCE835",87,0)
 S Z=$G(IBD("LINE"))
"RTN","IBCE835",88,0)
 I $P(IBD,U,3)'="" S Z=Z+1,^TMP("IBMSG",$J,"CLAIM",IBCLM,Z)="Corrected Patient Last Name: "_$P(IBD,U,3)
"RTN","IBCE835",89,0)
 I $P(IBD,U,4)'="" S Z=Z+1,^TMP("IBMSG",$J,"CLAIM",IBCLM,Z)="Corrected Patient First Name: "_$P(IBD,U,4)
"RTN","IBCE835",90,0)
 I $P(IBD,U,5)'="" S Z=Z+1,^TMP("IBMSG",$J,"CLAIM",IBCLM,Z)="Corrected Patient Middle Name: "_$P(IBD,U,5)
"RTN","IBCE835",91,0)
 I $P(IBD,U,6)'="" S Z=Z+1,^TMP("IBMSG",$J,"CLAIM",IBCLM,Z)="Corrected Patient ID#: "_$P(IBD,U,6)
"RTN","IBCE835",92,0)
 S IBD("LINE")=Z
"RTN","IBCE835",93,0)
 ;
"RTN","IBCE835",94,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D",6,1)="##RAW DATA: "_IBD
"RTN","IBCE835",95,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D1",1,6)="##RAW DATA: "_IBD
"RTN","IBCE835",96,0)
 Q
"RTN","IBCE835",97,0)
 ;
"RTN","IBCE835",98,0)
10(IBD) ; Process claim status data
"RTN","IBCE835",99,0)
 ; INPUT:
"RTN","IBCE835",100,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE835",101,0)
 ;
"RTN","IBCE835",102,0)
 ; OUTPUT:
"RTN","IBCE835",103,0)
 ;   IBD array returned with processed data
"RTN","IBCE835",104,0)
 ;      "CLAIM" = The claim #
"RTN","IBCE835",105,0)
 ;      "LINE" = The last line # populated in the message
"RTN","IBCE835",106,0)
 ;
"RTN","IBCE835",107,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,line#)=claim status message lines
"RTN","IBCE835",108,0)
 ;                                  ,"D",10,msg seq #)=
"RTN","IBCE835",109,0)
 ;                                  ,"D1",msg seq #,10)=
"RTN","IBCE835",110,0)
 ;                                       claim status raw data
"RTN","IBCE835",111,0)
 ;
"RTN","IBCE835",112,0)
 N IBCLM,CT,LINE,L,Z,Z0,IBDATA,IBSTAT
"RTN","IBCE835",113,0)
 S IBCLM=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",114,0)
 Q:IBCLM=""
"RTN","IBCE835",115,0)
 ;
"RTN","IBCE835",116,0)
 I '$D(^TMP("IBMSG",$J,"CLAIM",IBCLM)) D HDR(IBCLM,.IBD) ;Process header data if not already done for claim
"RTN","IBCE835",117,0)
 ;
"RTN","IBCE835",118,0)
 S CT=0
"RTN","IBCE835",119,0)
 F Z=3:1:6 I $P(IBD,U,Z)="Y" D  Q  ;Claim status
"RTN","IBCE835",120,0)
 . S IBSTAT=(Z-2)
"RTN","IBCE835",121,0)
 . S CT=CT+1,LINE(CT)="CLAIM STATUS: "_$P("PROCESSED^DENIED^PENDED^REVERSAL",U,IBSTAT)
"RTN","IBCE835",122,0)
 I '$G(IBSTAT) D
"RTN","IBCE835",123,0)
 . S CT=CT+1,LINE(CT)="CLAIM STATUS: "_$P(IBD,U,7)_" (OTHER)"
"RTN","IBCE835",124,0)
 ;
"RTN","IBCE835",125,0)
 I $P(IBD,U,8)'="" D  ;Crossed over info
"RTN","IBCE835",126,0)
 . S LINE(CT)=LINE(CT)_"  Crossed over to: "_$P(IBD,U,9)_"  "_$P(IBD,U,8)
"RTN","IBCE835",127,0)
 ;
"RTN","IBCE835",128,0)
 I CT D
"RTN","IBCE835",129,0)
 . S L=$G(IBD("LINE")),Z=0
"RTN","IBCE835",130,0)
 . F  S Z=$O(LINE(Z)) Q:'Z  S L=L+1,^TMP("IBMSG",$J,"CLAIM",IBCLM,L)=LINE(Z)
"RTN","IBCE835",131,0)
 . S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D",10,1)="##RAW DATA: "_IBD
"RTN","IBCE835",132,0)
 . S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D1",1,10)="##RAW DATA: "_IBD
"RTN","IBCE835",133,0)
 . S IBD("LINE")=$G(IBD("LINE"))+CT
"RTN","IBCE835",134,0)
 Q
"RTN","IBCE835",135,0)
 ;
"RTN","IBCE835",136,0)
15(IBD) ; Process claim status data
"RTN","IBCE835",137,0)
 ; INPUT:
"RTN","IBCE835",138,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE835",139,0)
 ;
"RTN","IBCE835",140,0)
 ; OUTPUT:
"RTN","IBCE835",141,0)
 ;   IBD array
"RTN","IBCE835",142,0)
 ;      "LINE" = The last line # populated in the message
"RTN","IBCE835",143,0)
 ;
"RTN","IBCE835",144,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,"D",15,msg seq #)=
"RTN","IBCE835",145,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,"D1",msg seq #,15)=
"RTN","IBCE835",146,0)
 ;                                       claim status raw data
"RTN","IBCE835",147,0)
 ;
"RTN","IBCE835",148,0)
 N IBCLM,Z,Z0,IBDATA
"RTN","IBCE835",149,0)
 S IBCLM=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",150,0)
 Q:IBCLM=""
"RTN","IBCE835",151,0)
 ;
"RTN","IBCE835",152,0)
 I '$D(^TMP("IBMSG",$J,"CLAIM",IBCLM)) D HDR(IBCLM,.IBD) ;Process header data if not already done for claim
"RTN","IBCE835",153,0)
 ;
"RTN","IBCE835",154,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D",15,1)="##RAW DATA: "_IBD
"RTN","IBCE835",155,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D1",1,15)="##RAW DATA: "_IBD
"RTN","IBCE835",156,0)
 Q
"RTN","IBCE835",157,0)
 ;
"RTN","IBCE835",158,0)
20(IBD) ; Process claim level adjustment data
"RTN","IBCE835",159,0)
 ; Claim must have been referenced by a previous '05' level
"RTN","IBCE835",160,0)
 ;
"RTN","IBCE835",161,0)
 ; INPUT:
"RTN","IBCE835",162,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE835",163,0)
 ;
"RTN","IBCE835",164,0)
 ; OUTPUT:
"RTN","IBCE835",165,0)
 ;    IBD("LINE") = The last line # populated in the message
"RTN","IBCE835",166,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,line #)=claim level adjustment
"RTN","IBCE835",167,0)
 ;                                  ,"D",20,seq#)=
"RTN","IBCE835",168,0)
 ;                                  ,"D1",seq#,20)=
"RTN","IBCE835",169,0)
 ;                                          claim level adjust. raw data
"RTN","IBCE835",170,0)
 ;
"RTN","IBCE835",171,0)
 N IBCLM
"RTN","IBCE835",172,0)
 S IBCLM=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",173,0)
 Q:'$D(^TMP("IBMSG",$J,"CLAIM",IBCLM))
"RTN","IBCE835",174,0)
 S IBD("LINE")=$G(IBD("LINE"))+1
"RTN","IBCE835",175,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,IBD("LINE"))="ADJUSTMENT GROUP: "_$P(IBD,U,3)_"  QTY: "_+$P(IBD,U,6)_", AMT: "_($P(IBD,U,5)/100)
"RTN","IBCE835",176,0)
 S IBD("LINE")=IBD("LINE")+1
"RTN","IBCE835",177,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,IBD("LINE"))="   REASON: ("_$P(IBD,U,4)_")  "_$P(IBD,U,7)
"RTN","IBCE835",178,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D",20,IBD("LINE"))="##RAW DATA: "_IBD
"RTN","IBCE835",179,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D1",IBD("LINE"),20)="##RAW DATA: "_IBD
"RTN","IBCE835",180,0)
 Q
"RTN","IBCE835",181,0)
 ;
"RTN","IBCE835",182,0)
37(IBD) ; Process claim level adjustment data for Inpatient MEDICARE
"RTN","IBCE835",183,0)
 D 37^IBCE835A(.IBD)
"RTN","IBCE835",184,0)
 Q
"RTN","IBCE835",185,0)
 ;
"RTN","IBCE835",186,0)
40(IBD) ; Process service line data
"RTN","IBCE835",187,0)
 D 40^IBCE835A(.IBD)
"RTN","IBCE835",188,0)
 Q
"RTN","IBCE835",189,0)
 ;
"RTN","IBCE835",190,0)
45(IBD) ; Process service line adjustment data
"RTN","IBCE835",191,0)
 D 45^IBCE835A(.IBD)
"RTN","IBCE835",192,0)
 Q
"RTN","IBCE835",193,0)
 ;
"RTN","IBCE835",194,0)
17(IBD) ; Process claim contact data segment
"RTN","IBCE835",195,0)
 D XX(.IBD,17)
"RTN","IBCE835",196,0)
 Q
"RTN","IBCE835",197,0)
 ;
"RTN","IBCE835",198,0)
30(IBD) ; Process MEDICARE inpatient adjudication data (part 1)
"RTN","IBCE835",199,0)
 D XX(.IBD,30)
"RTN","IBCE835",200,0)
 Q
"RTN","IBCE835",201,0)
 ;
"RTN","IBCE835",202,0)
35(IBD) ; Process MEDICARE inpatient adjudication data (part 2)
"RTN","IBCE835",203,0)
 D XX(.IBD,35)
"RTN","IBCE835",204,0)
 Q
"RTN","IBCE835",205,0)
 ;
"RTN","IBCE835",206,0)
41(IBD) ; Process service line data (part 2)
"RTN","IBCE835",207,0)
 D XX(.IBD,41)
"RTN","IBCE835",208,0)
 Q
"RTN","IBCE835",209,0)
 ;
"RTN","IBCE835",210,0)
42(IBD) ; Process service line data (part 3)
"RTN","IBCE835",211,0)
 D XX(.IBD,42)
"RTN","IBCE835",212,0)
 Q
"RTN","IBCE835",213,0)
 ;
"RTN","IBCE835",214,0)
99(IBD) ; Process trailer record for non-MRA EOB
"RTN","IBCE835",215,0)
 D XX(.IBD,99)
"RTN","IBCE835",216,0)
 Q
"RTN","IBCE835",217,0)
 ;
"RTN","IBCE835",218,0)
XX(IBD,IBID) ; Store non-displayed data nodes in TMP array
"RTN","IBCE835",219,0)
 ;
"RTN","IBCE835",220,0)
 ; INPUT:
"RTN","IBCE835",221,0)
 ;   IBD must be passed by reference = entire message line
"RTN","IBCE835",222,0)
 ;   IBID = record id for generic store
"RTN","IBCE835",223,0)
 ;
"RTN","IBCE835",224,0)
 ; OUTPUT:
"RTN","IBCE835",225,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,"D",IBID,msg seq #)=
"RTN","IBCE835",226,0)
 ;   ^TMP("IBMSG",$J,"CLAIM",claim #,"D1",msg seq #,IBID)=
"RTN","IBCE835",227,0)
 ;                                       claim status raw data
"RTN","IBCE835",228,0)
 ;    IBD("LINE") = The last line # populated in the message
"RTN","IBCE835",229,0)
 ;
"RTN","IBCE835",230,0)
 N IBCLM
"RTN","IBCE835",231,0)
 S IBCLM=$$GETCLM^IBCE277($P(IBD,U,2))
"RTN","IBCE835",232,0)
 ;
"RTN","IBCE835",233,0)
 S IBD("LINE")=$G(IBD("LINE"))+1
"RTN","IBCE835",234,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D",IBID,IBD("LINE"))="##RAW DATA: "_IBD
"RTN","IBCE835",235,0)
 S ^TMP("IBMSG",$J,"CLAIM",IBCLM,"D1",IBD("LINE"),IBID)="##RAW DATA: "_IBD
"RTN","IBCE835",236,0)
 ;
"RTN","IBCE835",237,0)
 Q
"RTN","IBCE835",238,0)
 ;
"RTN","IBCE837A")
0^30^B49945293^B42933569
"RTN","IBCE837A",1,0)
IBCE837A ;ALB/TMP - OUTPUT FOR 837 TRANSMISSION - CONTINUED ;8/6/03 10:50am
"RTN","IBCE837A",2,0)
 ;;2.0;INTEGRATED BILLING;**137,191,211,232,296,377**;21-MAR-94;Build 23
"RTN","IBCE837A",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCE837A",4,0)
 ;
"RTN","IBCE837A",5,0)
UPD(MSGNUM,BATCH,CNT,BILLS,DESC,IBBTYP,IBINS) ; Upd current batch + bills w/new status
"RTN","IBCE837A",6,0)
 ;MSGNUM = mail msg # for batch
"RTN","IBCE837A",7,0)
 ;BATCH = batch #
"RTN","IBCE837A",8,0)
 ;CNT = # of bills in batch
"RTN","IBCE837A",9,0)
 ;BILLS = array BILLS(bill ien in 364) in batch
"RTN","IBCE837A",10,0)
 ;DESC = 1-80 character description of batch
"RTN","IBCE837A",11,0)
 ;IBBTYP = X-Y where X = P for professional or I for institution
"RTN","IBCE837A",12,0)
 ;                   Y = 1 for test or 0 for live transmission
"RTN","IBCE837A",13,0)
 ;                         or 2 for live claim resubmitted as test
"RTN","IBCE837A",14,0)
 ;IBINS = ien of single insurance company for the batch (optional)
"RTN","IBCE837A",15,0)
 ;
"RTN","IBCE837A",16,0)
 N DIC,DIE,DR,DA,IBBATCH,IBIFN,IBIEN,IBYY,IBTXTEST,IBMRA
"RTN","IBCE837A",17,0)
 S IBBATCH=$O(^IBA(364.1,"B",+BATCH,"")) Q:'IBBATCH
"RTN","IBCE837A",18,0)
 S IBTXTEST=+$P(IBBTYP,"-",2)
"RTN","IBCE837A",19,0)
 I '$P($G(^IBE(350.9,1,8)),U,7) S IBINS=""
"RTN","IBCE837A",20,0)
 ;
"RTN","IBCE837A",21,0)
 S DIE="^IBA(364.1,",DA=IBBATCH,DR=".02////P;.03///"_CNT_";.04///"_MSGNUM_";.05///0;.07////1;.08///^S X="""_DESC_""""_$S($G(IBINS):";.12////"_IBINS,1:"")
"RTN","IBCE837A",22,0)
 ;
"RTN","IBCE837A",23,0)
 I '$P($G(^TMP("IBRESUBMIT",$J)),U,3) S DR=DR_";1.01///NOW;1.02///.5"
"RTN","IBCE837A",24,0)
 I $P($G(^TMP("IBRESUBMIT",$J)),U,2) S DR=DR_";.15////"_$P(^($J),U,2)
"RTN","IBCE837A",25,0)
 ;
"RTN","IBCE837A",26,0)
 S DR=DR_";.14////"_$S('IBTXTEST:0,1:1)_";.06////"_$S($E(IBBTYP)="P":2,1:3) D ^DIE ; Update batch
"RTN","IBCE837A",27,0)
 ;
"RTN","IBCE837A",28,0)
 I IBTXTEST=2 D ADDTXM^IBCEPTM(.BILLS,IBBATCH,$$NOW^XLFDT()) Q
"RTN","IBCE837A",29,0)
 I IBTXTEST'=2 S IBIEN=0 F  S IBIEN=$O(BILLS(IBIEN)) Q:'IBIEN  D  ;Update each bill
"RTN","IBCE837A",30,0)
 .S DA=IBIEN,DIE="^IBA(364,",DR=".02////"_IBBATCH_";.03///P;.04///NOW" D ^DIE
"RTN","IBCE837A",31,0)
 .S IBIFN=+$G(^IBA(364,IBIEN,0))
"RTN","IBCE837A",32,0)
 . ;
"RTN","IBCE837A",33,0)
 . ; If this claim has just been retransmitted, set the .06 field for the previous transmission entry
"RTN","IBCE837A",34,0)
 . N PRVTXI,PRVTXD
"RTN","IBCE837A",35,0)
 . S PRVTXI=$O(^IBA(364,"B",IBIFN,IBIEN),-1)      ; previous transmission for this claim
"RTN","IBCE837A",36,0)
 . I PRVTXI D
"RTN","IBCE837A",37,0)
 .. S PRVTXD=$G(^IBA(364,PRVTXI,0))
"RTN","IBCE837A",38,0)
 .. I '$F(".R.E.","."_$P(PRVTXD,U,3)_".") Q                 ; prev trans must have status of "R" or "E"
"RTN","IBCE837A",39,0)
 .. I $P(PRVTXD,U,7,8)'=$P($G(^IBA(364,IBIEN,0)),U,7,8) Q   ; test bill and COB must be the same
"RTN","IBCE837A",40,0)
 .. S DA=PRVTXI,DIE=364,DR=".06///"_IBBATCH D ^DIE          ; update the resubmit batch number
"RTN","IBCE837A",41,0)
 .. Q
"RTN","IBCE837A",42,0)
 . ;
"RTN","IBCE837A",43,0)
 .Q:$D(^TMP("IBRESUBMIT",$J))!($P($G(^DGCR(399,IBIFN,0)),U,13)=4)!(+$$TXMT^IBCEF4(IBIEN)=2)
"RTN","IBCE837A",44,0)
 .S IBMRA=$$NEEDMRA^IBEFUNC(IBIFN)
"RTN","IBCE837A",45,0)
 .I IBMRA="C",$P($G(^DGCR(399,IBIFN,0)),U,13)=2 S IBMRA=1
"RTN","IBCE837A",46,0)
 .I IBIFN D
"RTN","IBCE837A",47,0)
 ..S (DIC,DIE)="^DGCR(399,",DA=$P($G(^IBA(364,IBIEN,0)),U),DR="[IB STATUS]",IBYY=$S('IBMRA:"@91",1:"@911") D:DA ^DIE
"RTN","IBCE837A",48,0)
 ..D BSTAT^IBCDC(IBIFN) ; remove from AB list
"RTN","IBCE837A",49,0)
 Q
"RTN","IBCE837A",50,0)
 ;
"RTN","IBCE837A",51,0)
PRE ; Run before processing a bill entry
"RTN","IBCE837A",52,0)
 K IBXSAVE,IBXERR,^UTILITY("VAPA",$J),^TMP("IBXSAVE",$J),^TMP($J),^TMP("DIERR",$J)
"RTN","IBCE837A",53,0)
 Q
"RTN","IBCE837A",54,0)
 ;
"RTN","IBCE837A",55,0)
POST ; Run after processing a bill entry for cleanup
"RTN","IBCE837A",56,0)
 N Q
"RTN","IBCE837A",57,0)
 I $G(IBXERR)'="" D
"RTN","IBCE837A",58,0)
 .S ^TMP("IBXERR",$J,IBXIEN)=IBXERR K ^TMP("IBXDATA",$J)
"RTN","IBCE837A",59,0)
 .K ^TMP("IBHDR1",$J)
"RTN","IBCE837A",60,0)
 .I $D(^TMP("IBRESUBMIT",$J)),'$G(^TMP("IBEDI_TEST_BATCH",$J)) D  ;Set not resub flag for non-test bill
"RTN","IBCE837A",61,0)
 ..N Z,Z0
"RTN","IBCE837A",62,0)
 ..S Z0=$P($G(^TMP("IBRESUBMIT",$J)),U) Q:Z0=""
"RTN","IBCE837A",63,0)
 ..S Z=$O(^IBA(364,"ABABI",+$O(^IBA(364.1,"B",Z0,"")),IBXIEN,""))
"RTN","IBCE837A",64,0)
 ..I Z S ^TMP("IBNOT",$J,Z)=IBXIEN
"RTN","IBCE837A",65,0)
 K IBXSAVE,IBXNOREQ,^TMP("IBXSAVE",$J),^TMP($J)
"RTN","IBCE837A",66,0)
 S Q="VA" F  S Q=$O(^UTILITY(Q)) Q:$E(Q,1,2)'="VA"  I $D(^(Q,$J)) K ^UTILITY(Q,$J)
"RTN","IBCE837A",67,0)
 D CLEAN^DILF
"RTN","IBCE837A",68,0)
 Q
"RTN","IBCE837A",69,0)
 ;
"RTN","IBCE837A",70,0)
MAILIT(IBQUEUE,IBBILL,IBCTM,IBDUZ,IBDESC,IBBTYP,IBINS) ; Send mail msg, update bills
"RTN","IBCE837A",71,0)
 ;IBQUEUE = mail queue name to send 837 transactions to
"RTN","IBCE837A",72,0)
 ;IBBILL = array of ien's in file 364 of bills in batch - IBBILL(IEN)=""
"RTN","IBCE837A",73,0)
 ;IBCTM = # of bills in batch, returned reset to 0
"RTN","IBCE837A",74,0)
 ;IBDUZ = ien of user 'running' extract (if any)
"RTN","IBCE837A",75,0)
 ;IBDESC = description of batch
"RTN","IBCE837A",76,0)
 ;IBBTYP = X-Y where X = P for professional or I for institution
"RTN","IBCE837A",77,0)
 ;                   Y = 1 or 2 for test or 0 for live transmission
"RTN","IBCE837A",78,0)
 ;IBINS = ien of insurance company if only one/batch option (optional)
"RTN","IBCE837A",79,0)
 ;
"RTN","IBCE837A",80,0)
 N DIK,DA,XMTO,XMZ,XMBODY,XMDUZ,XMSUBJ,IBBDA,IBBNO
"RTN","IBCE837A",81,0)
 ;
"RTN","IBCE837A",82,0)
 S IBBNO=+$P($G(^TMP("IBHDR",$J)),U),IBBDA=$O(^IBA(364.1,"B",IBBNO,""))
"RTN","IBCE837A",83,0)
 I '$P($G(^IBE(350.9,1,8)),U,7) S IBINS=""
"RTN","IBCE837A",84,0)
 ;
"RTN","IBCE837A",85,0)
 I IBCTM D
"RTN","IBCE837A",86,0)
 . I +$G(^TMP("IBEDI_TEST_BATCH",$J)) S IBQUEUE="MCT"
"RTN","IBCE837A",87,0)
 . I IBQUEUE'="",IBQUEUE'["@" S XMTO("XXX@Q-"_IBQUEUE_".VA.GOV")=""
"RTN","IBCE837A",88,0)
 . I IBQUEUE["@" S XMTO(IBQUEUE)=""
"RTN","IBCE837A",89,0)
 . S XMDUZ=$G(IBDUZ),XMBODY="^TMP(""IBXMSG"","_$J_")",XMSUBJ=$S($P(IBBTYP,U,2):"** TEST"_$S($P(IBBTYP,U,2)=2:"/RESUB OF LIVE",1:""),1:"")_" CLAIM BATCH: "_$S(IBQUEUE'["@":IBQUEUE,1:$P(IBQUEUE,"@"))_"/"_IBBNO
"RTN","IBCE837A",90,0)
 . K XMZ
"RTN","IBCE837A",91,0)
 . D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,.XMTO,,.XMZ)
"RTN","IBCE837A",92,0)
 . I $G(XMZ) D
"RTN","IBCE837A",93,0)
 .. D UPD(XMZ,$P($G(^TMP("IBHDR",$J)),U),IBCTM,.IBBILL,IBDESC,IBBTYP,IBINS) ;Update batch/bills
"RTN","IBCE837A",94,0)
 .. S ^TMP("IBCE-BATCH",$J,IBBNO)=IBBDA_U_IBCTM_U_$P($G(^TMP("IBRESUBMIT",$J)),U)
"RTN","IBCE837A",95,0)
MAILQ S IBCTM=0
"RTN","IBCE837A",96,0)
 D CHKBTCH(+$G(^TMP("IBHDR",$J)))
"RTN","IBCE837A",97,0)
 K ^TMP("IBHDR",$J),^TMP("IBHDR1",$J),^TMP("IBXMSG",$J),IBBILL
"RTN","IBCE837A",98,0)
 Q
"RTN","IBCE837A",99,0)
 ;
"RTN","IBCE837A",100,0)
CHKNEW(IBQ,IBBILL,IBCTM,IBDESC,IBBTYP,IBINS,IBSITE,IBSIZE) ;
"RTN","IBCE837A",101,0)
 ;  Determine if ok to send msg
"RTN","IBCE837A",102,0)
 ;  Check for one insurance per batch if IBINS defined
"RTN","IBCE837A",103,0)
 ; Returns IBSIZE, IBCTM, IBBILL (pass by reference)
"RTN","IBCE837A",104,0)
 ;
"RTN","IBCE837A",105,0)
 ; IBQ = data queue name
"RTN","IBCE837A",106,0)
 ; IBBILL = the 'list' of bill #'s in the batch
"RTN","IBCE837A",107,0)
 ; IBCTM = the # of claims output so far to the batch
"RTN","IBCE837A",108,0)
 ; IBDESC = the batch description text
"RTN","IBCE837A",109,0)
 ; IBBTYP = X-Y where X = P for professional or I for institution
"RTN","IBCE837A",110,0)
 ;                   Y = 1 for test or 0 for live transmission
"RTN","IBCE837A",111,0)
 ; IBINS = the ien of the single insurance co. for the batch (optional)
"RTN","IBCE837A",112,0)
 ; IBSITE = the '8' node of file 350.9 (IB PARAMETERS)
"RTN","IBCE837A",113,0)
 ; IBSIZE = the 'running' size of the output message
"RTN","IBCE837A",114,0)
 ;
"RTN","IBCE837A",115,0)
 Q:$S($G(IBINS)="":0,1:'$P(IBSITE,U,7))
"RTN","IBCE837A",116,0)
 ;
"RTN","IBCE837A",117,0)
 ; New batch needed
"RTN","IBCE837A",118,0)
 I IBCTM D MAILIT(IBQ,.IBBILL,.IBCTM,"",IBDESC,IBBTYP,IBINS) S IBSIZE=0
"RTN","IBCE837A",119,0)
 Q
"RTN","IBCE837A",120,0)
 ;
"RTN","IBCE837A",121,0)
ERRMSG(XMBODY) ; Send bulletin for error message
"RTN","IBCE837A",122,0)
 N XMTO,XMSUBJ
"RTN","IBCE837A",123,0)
 S XMTO("I:G.IB EDI")="",XMSUBJ="EDI 837 TRANSMISSION ERRORS"
"RTN","IBCE837A",124,0)
 ;
"RTN","IBCE837A",125,0)
 D SENDMSG^XMXAPI(,XMSUBJ,XMBODY,.XMTO)
"RTN","IBCE837A",126,0)
 D ALERT("One or more EDI bills were not transmitted.  Check your mail for details","G.IB EDI")
"RTN","IBCE837A",127,0)
 Q
"RTN","IBCE837A",128,0)
 ;
"RTN","IBCE837A",129,0)
CLEANUP ; Cleans up bill transmission environment
"RTN","IBCE837A",130,0)
 ;
"RTN","IBCE837A",131,0)
 N IBTEST
"RTN","IBCE837A",132,0)
 S IBTEST=+$G(^TMP("IBEDI_TEST_BATCH",$J))
"RTN","IBCE837A",133,0)
 L -^IBA(364,0)
"RTN","IBCE837A",134,0)
 I $D(^TMP("IBRESUBMIT",$J,"IBXERR"))!$D(^TMP("IBONE",$J,"IBXERR"))!$D(^TMP("IBSELX",$J,"IBXERR")) D  ;Error message to mail group
"RTN","IBCE837A",135,0)
 . N XMTO,XMBODY,XMDUZ,XMSUBJ,XMZ,IBFUNC
"RTN","IBCE837A",136,0)
 . S IBFUNC=$S($D(^TMP("IBRESUBMIT",$J,"IBXERR")):$S('IBTEST:1,1:4),$D(^TMP("IBONE",$J,"IBXERR")):2,1:3)
"RTN","IBCE837A",137,0)
 . Q:'IBFUNC
"RTN","IBCE837A",138,0)
 . S XMTO("I:G.IB EDI")="",XMDUZ="",XMBODY="^TMP("""_$S(IBFUNC=1!(IBFUNC=4):"IBRESUBMIT",1:"IBONE")_""","_$J_",""IBXERR"")"
"RTN","IBCE837A",139,0)
 . S XMSUBJ="EDI 837 B"_$P("ATCH^ILL^ILL(s)^ILL(s)",U,IBFUNC)_" NOT "_$S($G(^TMP("IBONE",$J)):"RE",1:"")_"SUBMITTED"_$S('IBTEST:"",1:" AS TEST CLAIMS")
"RTN","IBCE837A",140,0)
 . D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,.XMTO,,.XMZ)
"RTN","IBCE837A",141,0)
 . K ^TMP("IBRESUBMIT",$J),^TMP("IBONE",$J)
"RTN","IBCE837A",142,0)
 ;
"RTN","IBCE837A",143,0)
 I $D(^TMP("IBRESUBMIT",$J)),'IBTEST D RESUBUP^IBCEM02 ;Upd resubmtd batch bills
"RTN","IBCE837A",144,0)
 I '$D(^TMP("IBSELX",$J)) K ^TMP("IBCE-BATCH",$J)
"RTN","IBCE837A",145,0)
 K ^TMP("IBXERR",$J),IBXERR
"RTN","IBCE837A",146,0)
 I 'IBTEST D CHKBTCH(+$G(^TMP("IBHDR",$J)))
"RTN","IBCE837A",147,0)
CLEANP ;  Entrypoint for extract data disply
"RTN","IBCE837A",148,0)
 K ^TMP("IBTXMT",$J),^TMP("IBXINS",$J)
"RTN","IBCE837A",149,0)
 K ^TMP("IBRESUBMIT",$J),^TMP("IBRESUB",$J),^TMP("IBNOT",$J),^TMP("IBONE",$J),^TMP("IBHDR",$J),^TMP("IBTX",$J),^TMP("IBEDI_TEST_BATCH",$J)
"RTN","IBCE837A",150,0)
 K ^UTILITY("VADM",$J)
"RTN","IBCE837A",151,0)
 D CLEAN^DILF
"RTN","IBCE837A",152,0)
 K ZTREQ S ZTREQ="@"
"RTN","IBCE837A",153,0)
 Q
"RTN","IBCE837A",154,0)
 ;
"RTN","IBCE837A",155,0)
ALERT(XQAMSG,IBGRP) ; Send alert message
"RTN","IBCE837A",156,0)
 N XQA
"RTN","IBCE837A",157,0)
 S XQA(IBGRP)=""
"RTN","IBCE837A",158,0)
 D SETUP^XQALERT
"RTN","IBCE837A",159,0)
 Q
"RTN","IBCE837A",160,0)
CHKBTCH(IBBNO) ; Delete batch whose batch # is IBBNO if no entries in file 364
"RTN","IBCE837A",161,0)
 ; and not a resubmitted batch
"RTN","IBCE837A",162,0)
 N IBZ,DA,DIK
"RTN","IBCE837A",163,0)
 S IBZ=+$O(^IBA(364.1,"B",+IBBNO,""))
"RTN","IBCE837A",164,0)
 I IBZ,'$O(^IBA(364,"C",IBZ,0)),'$P($G(^IBA(364.1,IBZ,0)),U,14) S DA=IBZ,DIK="^IBA(364.1," D ^DIK
"RTN","IBCE837A",165,0)
 Q
"RTN","IBCE837A",166,0)
 ;
"RTN","IBCE837A",167,0)
TESTLIM(IBINS) ; Check for test bill limit per day has been reached
"RTN","IBCE837A",168,0)
 N IB3,DA,DIK
"RTN","IBCE837A",169,0)
 S IB3=$G(^DIC(36,IBINS,3))
"RTN","IBCE837A",170,0)
 I $P(IB3,U,5)'=DT S $P(IB3,U,7)=0
"RTN","IBCE837A",171,0)
 I ($P(IB3,U,7)+$G(^TMP("IBICT",$J,IBINS))+1)>$P(IB3,U,6) D  Q
"RTN","IBCE837A",172,0)
 . S IBINS="" ;max # hit
"RTN","IBCE837A",173,0)
 . S DA=IBX,DIK="^IBA(364," D ^DIK
"RTN","IBCE837A",174,0)
 S ^TMP("IBICT",$J,IBINS)=$G(^TMP("IBICT",$J,IBINS))+1
"RTN","IBCE837A",175,0)
 Q
"RTN","IBCE837A",176,0)
 ;
"RTN","IBCE837A",177,0)
SETVAR(IBXIEN,IBINS,IB0,IBSEC,IBNID,IB837R,IBDIV) ;
"RTN","IBCE837A",178,0)
 ; Set up variables needed for subscripts in sort global
"RTN","IBCE837A",179,0)
 ; ejk added IBSEC logic for patch 296
"RTN","IBCE837A",180,0)
 ; IBSEC=1 if primary bill, 2 if 2nd/non-MRA, 3 if 2nd/MRA
"RTN","IBCE837A",181,0)
 S IBSEC=$S($$COBN^IBCEF(IBXIEN)=1:1,'$$MRASEC^IBCEF4(IBXIEN):2,1:3)
"RTN","IBCE837A",182,0)
 S IBNID=$$PAYERID^IBCEF2(IBXIEN)
"RTN","IBCE837A",183,0)
 S IB837R=$$RECVR^IBCEF2(IBXIEN)
"RTN","IBCE837A",184,0)
 S IBDIV=$P($S($P(IB0,U,22):$$SITE^VASITE(DT,$P(IB0,U,22)),1:$$SITE^VASITE()),U,3)
"RTN","IBCE837A",185,0)
 I IBNID'="","RPIHS"[$E(IBNID),$E(IBNID,2,$L(IBNID))="PRNT" S IBNID=IBNID_"*"_IBINS
"RTN","IBCE837A",186,0)
 I IBNID="" S IBNID="*"_IBINS
"RTN","IBCE837A",187,0)
 S $P(IBNID,"*",3)=$S($P(IB0,U,22):$P(IB0,U,22),1:"")
"RTN","IBCE837A",188,0)
 Q
"RTN","IBCE837A",189,0)
 ;
"RTN","IBCEBUL")
0^7^B14688365^B7594280
"RTN","IBCEBUL",1,0)
IBCEBUL ;ALB/TMP - 837 EDI SPECIAL BULLETINS PROCESSING ;19-SEP-96
"RTN","IBCEBUL",2,0)
 ;;2.0;INTEGRATED BILLING;**137,250,377**;21-MAR-94;Build 23
"RTN","IBCEBUL",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEBUL",4,0)
 ;
"RTN","IBCEBUL",5,0)
NOTSENT ; Check for batches in pending status (no confirmation from Austin)
"RTN","IBCEBUL",6,0)
 ;  from yesterday or before
"RTN","IBCEBUL",7,0)
 N XMTO,XMSUBJ,XMBODY,XMDUZ,IBT,IB,IBE,IBCT,IBI,IB0,IB1,Z,IBTYP
"RTN","IBCEBUL",8,0)
 K ^TMP($J,"IBNOTSENT")
"RTN","IBCEBUL",9,0)
 S (IBCT,IBI)=0
"RTN","IBCEBUL",10,0)
 F  S IBI=$O(^IBA(364.1,"ASTAT","P",IBI)) Q:'IBI  D
"RTN","IBCEBUL",11,0)
 . I $$BCHCHK(IBI) Q    ; Batch check function
"RTN","IBCEBUL",12,0)
 . S IBCT=IBCT+1
"RTN","IBCEBUL",13,0)
 . S IBTYP=$P($G(^IBA(364.1,IBI,0)),U,7)
"RTN","IBCEBUL",14,0)
 . I IBCT'>10,IBTYP'="" S ^TMP($J,"IBNOTSENT",IBTYP,IBI)=""
"RTN","IBCEBUL",15,0)
 . Q
"RTN","IBCEBUL",16,0)
 ;
"RTN","IBCEBUL",17,0)
 I IBCT D
"RTN","IBCEBUL",18,0)
 .S IBT(1)="There are "_IBCT_" EDI batch(es) still pending Austin receipt "
"RTN","IBCEBUL",19,0)
 .S IBT(2)="for more than 1 day.  Please investigate why they have not yet been confirmed"
"RTN","IBCEBUL",20,0)
 .S IBT(3)="as being received by Austin."
"RTN","IBCEBUL",21,0)
 .S IBT(4)=" "
"RTN","IBCEBUL",22,0)
 .I IBCT>10 S IBT(5)="Since there were more than 10 batches found, please run the ",IBT(6)="  EDI BATCHES PENDING RECEIPT report to get a list of these batches."
"RTN","IBCEBUL",23,0)
 .I IBCT'>10 D
"RTN","IBCEBUL",24,0)
 ..S IBT(5)="      BATCH #      PENDING SINCE             MAIL MESSAGE #",IBT(6)="",$P(IBT(6),"-",76)="",IBT(6)="  "_IBT(6),IBE=6
"RTN","IBCEBUL",25,0)
 ..S IBTYP=""
"RTN","IBCEBUL",26,0)
 ..F  S IBTYP=$O(^TMP($J,"IBNOTSENT",IBTYP)) Q:IBTYP=""  D
"RTN","IBCEBUL",27,0)
 ...S Z=$$EXPAND^IBTRE(364.1,.07,IBTYP) S:Z="" Z="??"
"RTN","IBCEBUL",28,0)
 ...I $O(^TMP($J,"IBNOTSENT",IBTYP),-1)'="" S IBE=IBE+1,IBT(IBE)=" "
"RTN","IBCEBUL",29,0)
 ...S IBE=IBE+1,IBT(IBE)="  BATCH TYPE: "_Z
"RTN","IBCEBUL",30,0)
 ...S IBI=0 F  S IBI=$O(^TMP($J,"IBNOTSENT",IBTYP,IBI)) Q:'IBI  D
"RTN","IBCEBUL",31,0)
 ....S IBE=IBE+1,IB0=$G(^IBA(364.1,IBI,0)),IB1=$G(^(1))
"RTN","IBCEBUL",32,0)
 ....S IBT(IBE)="      "_$E($P(IB0,U)_$J("",10),1,10)_"   "_$E($$FMTE^XLFDT($P(IB1,U,6),1)_$J("",20),1,20)_"      "_$P(IB0,U,4),IBE=IBE+1,IBT(IBE)=$J("",8)_$E($P(IB0,U,8),1,72)
"RTN","IBCEBUL",33,0)
 .S XMSUBJ="EDI BATCHES WAITING AUSTIN RECEIPT FOR OVER 1 DAY",XMBODY="IBT",XMDUZ="",XMTO("I:G.IB EDI")=""
"RTN","IBCEBUL",34,0)
 .D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,XMBODY,.XMTO)
"RTN","IBCEBUL",35,0)
 K ^TMP($J,"IBNOTSENT")
"RTN","IBCEBUL",36,0)
 Q
"RTN","IBCEBUL",37,0)
 ;
"RTN","IBCEBUL",38,0)
UPDBCH(BCHIEN) ; update the status of this batch to show A0:received in Austin
"RTN","IBCEBUL",39,0)
 NEW DIE,DA,DR
"RTN","IBCEBUL",40,0)
 S DIE=364.1,DA=+BCHIEN,DR=".02///A0"
"RTN","IBCEBUL",41,0)
 I $D(^IBA(DIE,DA,0)) D ^DIE
"RTN","IBCEBUL",42,0)
UPDBCHX ;
"RTN","IBCEBUL",43,0)
 Q
"RTN","IBCEBUL",44,0)
 ;
"RTN","IBCEBUL",45,0)
BCHCHK(BCHIEN) ; This function will check the EDI claims associated with this
"RTN","IBCEBUL",46,0)
 ; batch and determine if this batch has been received in Austin or not.
"RTN","IBCEBUL",47,0)
 ;
"RTN","IBCEBUL",48,0)
 ; ** This function is also called by routine IBCERP3 **
"RTN","IBCEBUL",49,0)
 ;
"RTN","IBCEBUL",50,0)
 ; Function value = 1 if we can determine that the batch was received in Austin, or
"RTN","IBCEBUL",51,0)
 ;                = 1 if there are no claims in this batch, or
"RTN","IBCEBUL",52,0)
 ;                = 1 if the batch is less than 24 hours old - too new to worry about
"RTN","IBCEBUL",53,0)
 ;                = 1 means don't display on report or MailMan message
"RTN","IBCEBUL",54,0)
 ;
"RTN","IBCEBUL",55,0)
 ; Function value = 0 if the batch has not yet been received in Austin
"RTN","IBCEBUL",56,0)
 ;                = 0 means we need to display batch on report and in MailMan message
"RTN","IBCEBUL",57,0)
 ;
"RTN","IBCEBUL",58,0)
 NEW IBEDI,IBOK,IBZ,IBIFN,IB0,AR,IBSECS
"RTN","IBCEBUL",59,0)
 S IBEDI=0,IBOK=1,BCHIEN=+$G(BCHIEN)
"RTN","IBCEBUL",60,0)
 ;
"RTN","IBCEBUL",61,0)
 ; if the batch transmission is still less than 24 hours old, skip this batch and get out
"RTN","IBCEBUL",62,0)
 S IBSECS=$$FMDIFF^XLFDT($$NOW^XLFDT,$P($G(^IBA(364.1,BCHIEN,1)),U,6),2)
"RTN","IBCEBUL",63,0)
 I IBSECS<86400 G BCHCHKX    ; # seconds in a day
"RTN","IBCEBUL",64,0)
 ;
"RTN","IBCEBUL",65,0)
 ; if no edi claims in this batch, update batch status and get out
"RTN","IBCEBUL",66,0)
 I '$O(^IBA(364,"C",BCHIEN,0)) D UPDBCH(BCHIEN) G BCHCHKX
"RTN","IBCEBUL",67,0)
 ;
"RTN","IBCEBUL",68,0)
 F  S IBEDI=$O(^IBA(364,"C",BCHIEN,IBEDI)) Q:'IBEDI  D  Q:'IBOK
"RTN","IBCEBUL",69,0)
 . S IBZ=$G(^IBA(364,IBEDI,0))
"RTN","IBCEBUL",70,0)
 . S IBIFN=+IBZ,IB0=$G(^DGCR(399,IBIFN,0))
"RTN","IBCEBUL",71,0)
 . I $P(IB0,U,13)=7 Q                    ; cancelled in IB
"RTN","IBCEBUL",72,0)
 . I $P(IBZ,U,3)'="P" Q                  ; edi claim status is not pending
"RTN","IBCEBUL",73,0)
 . S AR=$P($$BILL^RCJIBFN2(IBIFN),U,2)   ; AR status DBIA 1452
"RTN","IBCEBUL",74,0)
 . I $F(".22.26.39.","."_AR_".") Q       ; collected/closed or cancelled
"RTN","IBCEBUL",75,0)
 . ;
"RTN","IBCEBUL",76,0)
 . ; if we get to this point, then we have found an EDI claim in this batch
"RTN","IBCEBUL",77,0)
 . ; that is not cancelled in IB, the EDI claim status is "P", and the
"RTN","IBCEBUL",78,0)
 . ; AR status is not collected/closed nor cancelled in AR.  So therefore
"RTN","IBCEBUL",79,0)
 . ; this claim didn't get to Austin, so the batch didn't get to Austin.
"RTN","IBCEBUL",80,0)
 . S IBOK=0
"RTN","IBCEBUL",81,0)
 . Q
"RTN","IBCEBUL",82,0)
 ;
"RTN","IBCEBUL",83,0)
 ; If we find the batch has been received in Austin, then change the batch status.
"RTN","IBCEBUL",84,0)
 I IBOK D UPDBCH(BCHIEN)
"RTN","IBCEBUL",85,0)
 ;
"RTN","IBCEBUL",86,0)
BCHCHKX ;
"RTN","IBCEBUL",87,0)
 Q IBOK
"RTN","IBCEBUL",88,0)
 ;
"RTN","IBCECOB1")
0^19^B68510086^B67244551
"RTN","IBCECOB1",1,0)
IBCECOB1 ;ALB/CXW - IB COB MANAGEMENT SCREEN/REPORT ;14-JUN-99
"RTN","IBCECOB1",2,0)
 ;;2.0;INTEGRATED BILLING;**137,155,288,348,377**;21-MAR-94;Build 23
"RTN","IBCECOB1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCECOB1",4,0)
 ;
"RTN","IBCECOB1",5,0)
BLD ; Build list entrypoint
"RTN","IBCECOB1",6,0)
 N I,IBFND,IBB,IBIFN,IB364,IBDA1,IBDTN,IBDA,IBDAY,IBHIS,IBNDS,IBEUT,IBAPY,IBOAM,IBDT,IBMUT,IBBPY,IBINS,IBNDM,IBQ,IBNDI1,IBNDI2,IBNDI3,Z,Z0,IBSEQ,IB3611,IBINS1,IBINS2,IBEXPY,IBNBAL,IBPTRSP,IBAMT,IBMRACNT,IBPTNM,IBSRVC,IBPY,IBB364
"RTN","IBCECOB1",7,0)
 N IBEOBREV,IBDENDUP
"RTN","IBCECOB1",8,0)
 K ^TMP("IBCECOB",$J),^TMP("IBCECOB1",$J),^TMP("IBCOBST",$J),^TMP("IBCOBSTX",$J)
"RTN","IBCECOB1",9,0)
 D CLEAN^VALM10      ; kill data and video control arrays
"RTN","IBCECOB1",10,0)
 S VALMCNT=0,IBHIS=""
"RTN","IBCECOB1",11,0)
 ; since 0 is a valid Review Status, init w/null
"RTN","IBCECOB1",12,0)
 S IBEOBREV=""
"RTN","IBCECOB1",13,0)
 ; get EOB's w/Review Status of 0, 1, 1.5 or 2; If 3 or higher, not needed
"RTN","IBCECOB1",14,0)
 F  S IBEOBREV=$O(^IBM(361.1,"AMRA",1,IBEOBREV)) Q:IBEOBREV=""  Q:IBEOBREV>2  D  ;
"RTN","IBCECOB1",15,0)
 . S IBDA="A" F  S IBDA=$O(^IBM(361.1,"AMRA",1,IBEOBREV,IBDA),-1) Q:'IBDA  D BLD1
"RTN","IBCECOB1",16,0)
 ; no data accumulated
"RTN","IBCECOB1",17,0)
 I $O(^TMP("IBCOBST",$J,""))="" D NMAT Q
"RTN","IBCECOB1",18,0)
 ; display accumulated data
"RTN","IBCECOB1",19,0)
 D SCRN
"RTN","IBCECOB1",20,0)
 Q
"RTN","IBCECOB1",21,0)
BLD1 ;
"RTN","IBCECOB1",22,0)
 I '$$ELIG(IBDA) Q
"RTN","IBCECOB1",23,0)
 S IBDENDUP=$$DENDUP^IBCEMU4(IBDA)
"RTN","IBCECOB1",24,0)
 I '$G(IBMRADUP),IBDENDUP Q     ; don't include denied MRAs for Duplicate Claim/Service
"RTN","IBCECOB1",25,0)
 S IB3611=$G(^IBM(361.1,IBDA,0))
"RTN","IBCECOB1",26,0)
 S IBIFN=+IB3611,IB364=$P(IB3611,U,19),IBDT=+$P(IB3611,U,6)
"RTN","IBCECOB1",27,0)
 I $D(^TMP("IBCOBSTX",$J,IBIFN)) Q  ;show each bill once on the worklist
"RTN","IBCECOB1",28,0)
 S IBB=$G(^DGCR(399,IBIFN,0))
"RTN","IBCECOB1",29,0)
 S IBNDS=$G(^DGCR(399,IBIFN,"S")),IBNDI1=$G(^("I1")),IBNDI2=$G(^("I2")),IBNDI3=$G(^("I3")),IBNDM=$G(^("M"))
"RTN","IBCECOB1",30,0)
 S IBMUT=+$P(IBNDS,U,8),IBEUT=+$P(IBNDS,U,2)
"RTN","IBCECOB1",31,0)
 S IBINS="",IBSEQ=$P(IB3611,U,15)
"RTN","IBCECOB1",32,0)
 F I=1:1:3 S Z="IBNDI"_I I @Z D
"RTN","IBCECOB1",33,0)
 . N Q
"RTN","IBCECOB1",34,0)
 . S Q=(IBSEQ=I)
"RTN","IBCECOB1",35,0)
 . I Q S IBINS1=+@Z_U_$P($G(^DIC(36,+@Z,0)),U)
"RTN","IBCECOB1",36,0)
 . S IBINS=IBINS_$S(IBINS="":"",1:", ")_$P($G(^DIC(36,+@Z,0)),U)
"RTN","IBCECOB1",37,0)
 ; Get the payer/insurance company that comes after Medicare WNR
"RTN","IBCECOB1",38,0)
 ; If WNR is Primary, get the secondary ins. co.
"RTN","IBCECOB1",39,0)
 ; If WNR is secondary, get the tertiary ins. co.
"RTN","IBCECOB1",40,0)
 D  I $P(IBINS2,U,2)="" S $P(IBINS2,U,2)="UNKNOWN"
"RTN","IBCECOB1",41,0)
 . I $$WNRBILL^IBEFUNC(IBIFN,1) S IBINS2=+IBNDI2_U_$P($G(^DIC(36,+IBNDI2,0)),U) Q
"RTN","IBCECOB1",42,0)
 . S IBINS2=+IBNDI3_U_$P($G(^DIC(36,+IBNDI3,0)),U)
"RTN","IBCECOB1",43,0)
 S IBFND=0
"RTN","IBCECOB1",44,0)
 ; biller entry not ALL and no biller, then get entered/edited by user
"RTN","IBCECOB1",45,0)
 I $D(^TMP("IBBIL",$J)) D  Q:'IBFND
"RTN","IBCECOB1",46,0)
 . S IBFND=$S($D(^TMP("IBBIL",$J,IBMUT)):IBMUT,$D(^TMP("IBBIL",$J,IBEUT)):IBEUT,1:0)
"RTN","IBCECOB1",47,0)
 S Z=$S(IBFND:IBFND,IBMUT:IBMUT,1:IBEUT)
"RTN","IBCECOB1",48,0)
 S IBMUT=$P($G(^VA(200,+Z,0)),U)_"~"_Z
"RTN","IBCECOB1",49,0)
 S:'$P(IBMUT,"~",2) IBMUT="UNKNOWN~0"
"RTN","IBCECOB1",50,0)
 S IBBPY=+$$COBN^IBCEF(IBIFN),IBQ=1
"RTN","IBCECOB1",51,0)
 ;IBQ;1=EOB without subsequent insurer,0=COB,2=0 balance
"RTN","IBCECOB1",52,0)
 D  ;I IBQ Q
"RTN","IBCECOB1",53,0)
 . ;Check for no reimbursable subsequent insurance
"RTN","IBCECOB1",54,0)
 .  F I=IBBPY+1:1:3 D  Q:'IBQ
"RTN","IBCECOB1",55,0)
 .. S Z="IBNDI"_I,Z=$G(@Z)
"RTN","IBCECOB1",56,0)
 .. I $P($G(^DIC(36,+Z,0)),U,2)="N" S IBQ=0 Q
"RTN","IBCECOB1",57,0)
 . ;Check if next ins doesn't exist or next bill# already created
"RTN","IBCECOB1",58,0)
 . S Z="IBNDI"_(IBBPY+1),Z=$G(@Z)
"RTN","IBCECOB1",59,0)
 . I Z,'$P($G(^DGCR(399,IBIFN,"M1")),U,5+IBBPY) S IBQ=0
"RTN","IBCECOB1",60,0)
 ;
"RTN","IBCECOB1",61,0)
 ; Days since transmission of latest bill in COB - IBDAY
"RTN","IBCECOB1",62,0)
 S IBDAY=+$P($G(^DGCR(399,IBIFN,"TX")),U,2) I IBDAY S IBDAY=$$FMDIFF^XLFDT(DT,IBDAY,1)
"RTN","IBCECOB1",63,0)
 ; if no Last Electronic Extract Date on file 399, get it from file 364
"RTN","IBCECOB1",64,0)
 I 'IBDAY D  I IBDAY S IBDAY=$$FMDIFF^XLFDT(DT,IBDAY,1) ;calc. the difference
"RTN","IBCECOB1",65,0)
 . S IBB364=$$LAST364^IBCEF4(IBIFN) I IBB364'="" S IBDAY=+$P($P($G(^IBA(364,IBB364,0)),U,4),".",1)
"RTN","IBCECOB1",66,0)
 ;
"RTN","IBCECOB1",67,0)
 S IBAPY=$$TPR^PRCAFN(IBIFN) ; payment on this bill from A/R
"RTN","IBCECOB1",68,0)
 S IBEXPY=+$G(^IBM(361.1,IBDA,1))       ; payer paid amount
"RTN","IBCECOB1",69,0)
 S IBPTRSP=$$PREOBTOT^IBCEU0(IBIFN)     ; patient resp. function
"RTN","IBCECOB1",70,0)
 S IBPY=$S(IBAPY:IBAPY,1:IBEXPY)
"RTN","IBCECOB1",71,0)
 S IBOAM=+$G(^DGCR(399,IBIFN,"U1"))     ; total charges for bill
"RTN","IBCECOB1",72,0)
 S IBNBAL=IBOAM-IBPY
"RTN","IBCECOB1",73,0)
 I IBNBAL'>0 S IBQ=2
"RTN","IBCECOB1",74,0)
 S IBPTNM=$P($G(^DPT(+$P($G(^DGCR(399,IBIFN,0)),U,2),0)),U) I IBPTNM="" S IBPTNM="UNKNOWN"
"RTN","IBCECOB1",75,0)
 S IBSRVC=$P($G(^DGCR(399,IBIFN,"U")),U)
"RTN","IBCECOB1",76,0)
 S Z0=$S(IBSRT="B":IBMUT,IBSRT="D":-IBDAY,IBSRT="I":$P(IBINS2,U,2)_"~"_$P(IBINS2,U),IBSRT="M":$$EXTERNAL^DILFD(361.1,.13,"",$P(IB3611,"^",13)),IBSRT="R":-IBPTRSP,IBSRT="P":IBPTNM,IBSRT="S":IBSRVC,1:IBDT)
"RTN","IBCECOB1",77,0)
 S ^TMP("IBCOBST",$J,Z0,IBIFN)=IBSRVC_U_IBOAM_U_IBAPY_U_$S(IBNBAL>0:IBNBAL,1:0)_U_$P(IBB,U,5)_U_$P(IBB,U,19)_U_IBBPY_U_$P(IBMUT,"~")_U_IBINS_U_IBDA_U_$$HIS(IBIFN)_U_IBDAY_U_IBDT_U_IBQ_U_IB364_U_IBSEQ_U_IBEXPY_U_IBPTRSP
"RTN","IBCECOB1",78,0)
 S ^TMP("IBCOBST",$J,Z0,IBIFN,1)=$$EXTERNAL^DILFD(361.1,.13,"",$P(IB3611,"^",13))_", "_$$FMTE^XLFDT($P($P(IB3611,"^",6),"."))_"^"_$P(IB3611,"^",16)
"RTN","IBCECOB1",79,0)
 S ^TMP("IBCOBSTX",$J,IBIFN)=IBDA  ;keep track of compiled IBIFN's
"RTN","IBCECOB1",80,0)
 ;
"RTN","IBCECOB1",81,0)
 ; Save some data when there are multiple MRA's on file for this bill
"RTN","IBCECOB1",82,0)
 S IBMRACNT=$$MRACNT^IBCEMU1(IBIFN)
"RTN","IBCECOB1",83,0)
 I IBMRACNT>1 S $P(^TMP("IBCOBST",$J,Z0,IBIFN,1),U,1)="Multiple MRA's on file"
"RTN","IBCECOB1",84,0)
 S $P(^TMP("IBCOBST",$J,Z0,IBIFN,1),U,3)=IBMRACNT
"RTN","IBCECOB1",85,0)
 S $P(^TMP("IBCOBST",$J,Z0,IBIFN,1),U,4)=IBDENDUP
"RTN","IBCECOB1",86,0)
 Q
"RTN","IBCECOB1",87,0)
 ;
"RTN","IBCECOB1",88,0)
HIS(IBIFN) ; COB history
"RTN","IBCECOB1",89,0)
 N A,B,IBST,IBBIL,IBHIS
"RTN","IBCECOB1",90,0)
 S IBHIS="",A=0 F  S A=$O(^IBM(361.1,"ABS",IBIFN,A)) Q:'A  S B=0 F  S B=$O(^IBM(361.1,"ABS",IBIFN,A,B)) Q:'B  D
"RTN","IBCECOB1",91,0)
 . S IBST=$P($G(^IBM(361.1,B,0)),U,4),IBBIL=$P(^DGCR(399,IBIFN,"M1"),U,4+A)
"RTN","IBCECOB1",92,0)
 . Q:IBBIL=""
"RTN","IBCECOB1",93,0)
 . S IBHIS=IBHIS_$S(IBHIS="":"",1:";")_$S(A=1:"PRIMARY",A=2:"SECONDARY",1:"TERTIARY")_" "_$S(IBST:"MRA",1:"EOB")_" RECEIVED - "_IBBIL
"RTN","IBCECOB1",94,0)
 Q IBHIS
"RTN","IBCECOB1",95,0)
 ;
"RTN","IBCECOB1",96,0)
NMAT ;No COB list
"RTN","IBCECOB1",97,0)
 S VALMCNT=2,IBCNT=2
"RTN","IBCECOB1",98,0)
 S ^TMP("IBCECOB",$J,1,0)=" "
"RTN","IBCECOB1",99,0)
 S ^TMP("IBCECOB",$J,2,0)="    No MRA's Matching Selection Criteria Were Found"
"RTN","IBCECOB1",100,0)
 Q
"RTN","IBCECOB1",101,0)
 ;
"RTN","IBCECOB1",102,0)
SCRN ;
"RTN","IBCECOB1",103,0)
 N IBX,IBCNT,IBIFN,IBDA,IB,X,IBS1,IBPAT,Z,IBK,IBFORM
"RTN","IBCECOB1",104,0)
 S IBCNT=0
"RTN","IBCECOB1",105,0)
 S IBS1=$S(IBSRT="B":"BILLER",IBSRT="D":"Days Since Last Transmission",IBSRT="L":"Date Last MRA Received",IBSRT="I":"SECONDARY INSURANCE COMPANY",IBSRT="M":"MRA Status",1:"")
"RTN","IBCECOB1",106,0)
 S IBX="" F  S IBX=$O(^TMP("IBCOBST",$J,IBX)) Q:IBX=""  D
"RTN","IBCECOB1",107,0)
 . I IBSRT="B"!(IBSRT="I")!(IBSRT="M") D
"RTN","IBCECOB1",108,0)
 .. D:IBCNT SET("",IBCNT+1)
"RTN","IBCECOB1",109,0)
 .. D SET(IBS1_": "_$P(IBX,"~"),IBCNT+1)
"RTN","IBCECOB1",110,0)
 . S IBIFN=0 F  S IBIFN=$O(^TMP("IBCOBST",$J,IBX,IBIFN)) Q:'IBIFN  D
"RTN","IBCECOB1",111,0)
 .. S IB=$G(^TMP("IBCOBST",$J,IBX,IBIFN))
"RTN","IBCECOB1",112,0)
 .. S Z=$G(^DPT(+$P($G(^DGCR(399,IBIFN,0)),U,2),0))
"RTN","IBCECOB1",113,0)
 .. S IBPAT=$$LJ^XLFSTR($E($P(Z,U),1,18),18," ")_" "_$E($P(Z,U,9),6,9)
"RTN","IBCECOB1",114,0)
 .. S IBDA=$P(IB,U,10) ;361.1-ien
"RTN","IBCECOB1",115,0)
 .. S IBQ=$P(IB,U,14),IB364=$P(IB,U,15)
"RTN","IBCECOB1",116,0)
 .. S IBFORM=$$EXTERNAL^DILFD(399,.19,,+$P(IB,U,6))
"RTN","IBCECOB1",117,0)
 .. I +$P(IB,U,6)=2 S IBFORM=1500   ; for space reasons
"RTN","IBCECOB1",118,0)
 .. S IBPTRSP=$P(IB,U,18)
"RTN","IBCECOB1",119,0)
 .. S IBAMT=$P(IB,U,2)
"RTN","IBCECOB1",120,0)
 .. S IBCNT=IBCNT+1
"RTN","IBCECOB1",121,0)
 .. S X=""
"RTN","IBCECOB1",122,0)
 .. S X=$$SETFLD^VALM1(IBCNT,X,"NUMBER")
"RTN","IBCECOB1",123,0)
 .. S X=$$SETFLD^VALM1($$BN1^PRCAFN(IBIFN)_$S($P($G(^DGCR(399,IBIFN,"TX")),U,10)=1:"*",1:""),X,"BILL")
"RTN","IBCECOB1",124,0)
 .. S X=$$SETFLD^VALM1($$DAT1^IBOUTL($P(IB,U)),X,"SERVICE")
"RTN","IBCECOB1",125,0)
 .. S X=$$SETFLD^VALM1(IBPAT,X,"PATNM")
"RTN","IBCECOB1",126,0)
 .. S X=$$SETFLD^VALM1($$RJ^XLFSTR($FN(IBPTRSP,"",2),9," "),X,"PTRESP")
"RTN","IBCECOB1",127,0)
 .. S X=$$SETFLD^VALM1($$RJ^XLFSTR($FN(IBAMT,"",2),9," "),X,"IBAMT")
"RTN","IBCECOB1",128,0)
 .. S X=$$SETFLD^VALM1($$TYPE^IBJTLA1($P(IB,U,5))_"/"_IBFORM,X,"BTYPE")
"RTN","IBCECOB1",129,0)
 .. D SET(X,IBCNT,IBIFN,IBDA,IBQ,IB364,IBX,IB)
"RTN","IBCECOB1",130,0)
 .. ;For R (Pt Resp), P (Pt Name) and S (Service Date) don't display sub-headers
"RTN","IBCECOB1",131,0)
 .. I "BIMRPS"'[IBSRT D
"RTN","IBCECOB1",132,0)
 ... S Z=$S(IBSRT="L":$$DAT1^IBOUTL(IBX),IBSRT="D":-IBX,1:IBX)
"RTN","IBCECOB1",133,0)
 ... D SET("   "_IBS1_": "_Z,IBCNT)
"RTN","IBCECOB1",134,0)
 .. S X=$$SETSTR^VALM1("Insurers:  "_$P(IB,U,9),"",7,74)
"RTN","IBCECOB1",135,0)
 .. D SET(X,IBCNT,IBIFN,IBDA,IBQ,IB364,IBX,IB)
"RTN","IBCECOB1",136,0)
 .. ;
"RTN","IBCECOB1",137,0)
 .. ; line 3 of display:  MRA status/date/split claim indicator
"RTN","IBCECOB1",138,0)
 .. S X=$$SETSTR^VALM1("MRA Status:  ","",5,13)
"RTN","IBCECOB1",139,0)
 .. S IBK=$G(^TMP("IBCOBST",$J,IBX,IBIFN,1))
"RTN","IBCECOB1",140,0)
 .. S X=$$SETSTR^VALM1($P(IBK,U,1),X,18,63)
"RTN","IBCECOB1",141,0)
 .. I $P(IBK,U,2)=2 S X=$$SETSTR^VALM1("** SPLIT CLAIM **",X,63,18)
"RTN","IBCECOB1",142,0)
 .. I $P(IBK,U,4),$P(IBK,U,2)'=2,$P(IBK,U,3)=1 S X=$$SETSTR^VALM1("** Denied for Duplicate **",X,54,27)
"RTN","IBCECOB1",143,0)
 .. D SET(X,IBCNT,IBIFN,IBDA,IBQ,IB364,IBX,IB)
"RTN","IBCECOB1",144,0)
 .. ;
"RTN","IBCECOB1",145,0)
 .. ; conditionally update video attributes of line 3
"RTN","IBCECOB1",146,0)
 .. I '$D(IOINHI) D ENS^%ZISS
"RTN","IBCECOB1",147,0)
 .. ; split claim
"RTN","IBCECOB1",148,0)
 .. I $P(IBK,U,2)=2 D CNTRL^VALM10(VALMCNT,63,17,IOINHI,IOINORM)
"RTN","IBCECOB1",149,0)
 .. ; multiple mra's on file
"RTN","IBCECOB1",150,0)
 .. I $P(IBK,U,3)>1 D CNTRL^VALM10(VALMCNT,18,22,IOINHI,IOINORM)
"RTN","IBCECOB1",151,0)
 .. ; Denied for Duplicate - no split claim and single MRA only
"RTN","IBCECOB1",152,0)
 .. I $P(IBK,U,4),$P(IBK,U,2)'=2,$P(IBK,U,3)=1 D CNTRL^VALM10(VALMCNT,54,26,IOINHI,IOINORM)
"RTN","IBCECOB1",153,0)
 .. Q
"RTN","IBCECOB1",154,0)
 Q
"RTN","IBCECOB1",155,0)
 ;
"RTN","IBCECOB1",156,0)
SET(X,CNT,IBIFN,IBDA,IBQ,IB364,IBX,IB) ;set up list manager screen array
"RTN","IBCECOB1",157,0)
 S VALMCNT=VALMCNT+1
"RTN","IBCECOB1",158,0)
 S ^TMP("IBCECOB",$J,VALMCNT,0)=X
"RTN","IBCECOB1",159,0)
 S ^TMP("IBCECOB",$J,"IDX",VALMCNT,CNT)=""
"RTN","IBCECOB1",160,0)
 I $G(IBIFN),$G(^TMP("IBCECOB",$J,CNT))="" S ^TMP("IBCECOB",$J,CNT)=VALMCNT_U_IBIFN_U_IB364_U_IBDA_U_IBQ_U_IBX,^TMP("IBCECOB1",$J,CNT)=IB
"RTN","IBCECOB1",161,0)
 Q
"RTN","IBCECOB1",162,0)
 ;
"RTN","IBCECOB1",163,0)
FTYPE(Y) ;type classification
"RTN","IBCECOB1",164,0)
 Q $E($P($G(^IBE(353,Y,0)),U),1,8)
"RTN","IBCECOB1",165,0)
 ;
"RTN","IBCECOB1",166,0)
PTRESPI(IBEOB) ; Function - Computes the Patient's Responsibility based on IBEOB
"RTN","IBCECOB1",167,0)
 ; of 361.1 for Claims/Bills with form type 3=UB
"RTN","IBCECOB1",168,0)
 ; Input IBEOB - a single EOB ien; Required
"RTN","IBCECOB1",169,0)
 ; Output      - Function Returns IBPTRES - Patient Responsibility Amount for the EOB
"RTN","IBCECOB1",170,0)
 ;
"RTN","IBCECOB1",171,0)
 N IBPTRES,IBC,EOBADJ
"RTN","IBCECOB1",172,0)
 S IBPTRES=0,IBEOB=+$G(IBEOB)
"RTN","IBCECOB1",173,0)
 I 'IBEOB Q IBPTRES   ;PTRESPI
"RTN","IBCECOB1",174,0)
 ;
"RTN","IBCECOB1",175,0)
 ; get claim level adjustments
"RTN","IBCECOB1",176,0)
 K EOBADJ M EOBADJ=^IBM(361.1,IBEOB,10)
"RTN","IBCECOB1",177,0)
 S IBPTRES=$$CALCPR^IBCEU0(.EOBADJ)
"RTN","IBCECOB1",178,0)
 ;
"RTN","IBCECOB1",179,0)
 ; get line level adjustments
"RTN","IBCECOB1",180,0)
 S IBC=0 F  S IBC=$O(^IBM(361.1,IBEOB,15,IBC)) Q:'IBC  D
"RTN","IBCECOB1",181,0)
 . K EOBADJ M EOBADJ=^IBM(361.1,IBEOB,15,IBC,1)
"RTN","IBCECOB1",182,0)
 . S IBPTRES=IBPTRES+$$CALCPR^IBCEU0(.EOBADJ)
"RTN","IBCECOB1",183,0)
 Q IBPTRES
"RTN","IBCECOB1",184,0)
 ;
"RTN","IBCECOB1",185,0)
ELIG(IBEOB) ; Function to determine if an EOB entry is eligible for
"RTN","IBCECOB1",186,0)
 ; inclusion on the MRA management worklist or not.
"RTN","IBCECOB1",187,0)
 ; IBEOB - ien into file 361.1 (required)
"RTN","IBCECOB1",188,0)
 ; Returns 1 if EOB should appear on the worklist
"RTN","IBCECOB1",189,0)
 ; Returns 0 if EOB should not appear on the worklist
"RTN","IBCECOB1",190,0)
 ;
"RTN","IBCECOB1",191,0)
 NEW ELIG,IB3611,IBIFN
"RTN","IBCECOB1",192,0)
 S ELIG=0,IBEOB=+$G(IBEOB)
"RTN","IBCECOB1",193,0)
 S IB3611=$G(^IBM(361.1,IBEOB,0))
"RTN","IBCECOB1",194,0)
 I $P(IB3611,U,4)'=1 G ELIGX    ; eob type must be Medicare MRA
"RTN","IBCECOB1",195,0)
 I $P(IB3611,U,16)>2 G ELIGX    ; review status must be <= 2
"RTN","IBCECOB1",196,0)
 S IBIFN=+IB3611
"RTN","IBCECOB1",197,0)
 I $P($G(^DGCR(399,IBIFN,0)),U,13)'=2 G ELIGX  ; Request MRA bill status
"RTN","IBCECOB1",198,0)
 I $D(^IBM(361.1,IBEOB,"ERR")) G ELIGX         ; filing errors
"RTN","IBCECOB1",199,0)
 ;
"RTN","IBCECOB1",200,0)
 S ELIG=1    ; this EOB is eligible for the worklist
"RTN","IBCECOB1",201,0)
 ;
"RTN","IBCECOB1",202,0)
ELIGX ;
"RTN","IBCECOB1",203,0)
 Q ELIG
"RTN","IBCECOB1",204,0)
 ;
"RTN","IBCECOB6")
0^17^B23813020^n/a
"RTN","IBCECOB6",1,0)
IBCECOB6 ;YMG/BP - IB COB MANAGEMENT SCREEN ;26-Dec-2007
"RTN","IBCECOB6",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCECOB6",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCECOB6",4,0)
 ;
"RTN","IBCECOB6",5,0)
EN ; view MRA comments - entry point from MRA Worklist
"RTN","IBCECOB6",6,0)
 N IBDA,IBIFN
"RTN","IBCECOB6",7,0)
 ; we need to select a claim and set IBIFN
"RTN","IBCECOB6",8,0)
 D SEL^IBCECOB2(.IBDA,1) S:$O(IBDA(0)) IBIFN=+IBDA($O(IBDA(0)))
"RTN","IBCECOB6",9,0)
 D:$G(IBIFN) EN^VALM("IBCEM MRA COMMENTS")
"RTN","IBCECOB6",10,0)
 S VALMBCK="R"
"RTN","IBCECOB6",11,0)
 Q
"RTN","IBCECOB6",12,0)
 ;
"RTN","IBCECOB6",13,0)
HDR ; header code
"RTN","IBCECOB6",14,0)
 S VALMHDR(1)="MRA Claim "_$P($G(^DGCR(399,IBIFN,0)),U)
"RTN","IBCECOB6",15,0)
 Q
"RTN","IBCECOB6",16,0)
 ;
"RTN","IBCECOB6",17,0)
INIT ; init variables and list array
"RTN","IBCECOB6",18,0)
 N CMLN,CMSTR,I,IB0,IBDATE,IBDUZ,LEN,LN,MAX,POS,STR
"RTN","IBCECOB6",19,0)
 S LN=1
"RTN","IBCECOB6",20,0)
 ; check if we have any comments to display
"RTN","IBCECOB6",21,0)
 I '$D(^DGCR(399,IBIFN,"TXC","B")) D  Q
"RTN","IBCECOB6",22,0)
 .S STR="",STR=$$SETFLD^VALM1("No comments found for this claim.",STR,"MESSAGE")
"RTN","IBCECOB6",23,0)
 .D SET^VALM10(LN,STR),FLDCTRL^VALM10(LN,"MESSAGE",IOINHI,IOINORM)
"RTN","IBCECOB6",24,0)
 .S VALMCNT=LN
"RTN","IBCECOB6",25,0)
 .Q
"RTN","IBCECOB6",26,0)
 ; loop through all available comments
"RTN","IBCECOB6",27,0)
 S IBDATE="" F  S IBDATE=$O(^DGCR(399,IBIFN,"TXC","B",IBDATE),-1) Q:IBDATE=""  D
"RTN","IBCECOB6",28,0)
 .S I=$O(^DGCR(399,IBIFN,"TXC","B",IBDATE,"")),IB0=^DGCR(399,IBIFN,"TXC",I,0),IBDUZ=$P(IB0,U,2)
"RTN","IBCECOB6",29,0)
 .D SET^VALM10(LN,"") S LN=LN+1
"RTN","IBCECOB6",30,0)
 .S STR="",STR=$$SETFLD^VALM1("Entered by "_$$GET1^DIQ(200,IBDUZ,.01)_" on "_$$FMTE^XLFDT(IBDATE,"2Z"),STR,"ENTERED")
"RTN","IBCECOB6",31,0)
 .D SET^VALM10(LN,STR),FLDCTRL^VALM10(LN) S LN=LN+1
"RTN","IBCECOB6",32,0)
 .; loop through comment lines
"RTN","IBCECOB6",33,0)
 .S CMLN=0 F  S CMLN=$O(^DGCR(399,IBIFN,"TXC",I,1,CMLN)) Q:CMLN=""  D
"RTN","IBCECOB6",34,0)
 ..S CMSTR=^DGCR(399,IBIFN,"TXC",I,1,CMLN,0) ; complete comment line
"RTN","IBCECOB6",35,0)
 ..S MAX=$P(VALMDDF("MESSAGE"),U,3) ; max. number of characters in the "MESSAGE" field
"RTN","IBCECOB6",36,0)
 ..; if comment line is too long, split it into chunks that fit in the "MESSAGE" field
"RTN","IBCECOB6",37,0)
 ..F  D  Q:CMSTR=""
"RTN","IBCECOB6",38,0)
 ...S (POS,LEN)=$L(CMSTR) I LEN>MAX S POS=MAX F  Q:POS=0  Q:$E(CMSTR,POS)=" "  S POS=POS-1 ; try to make a split on a space char.
"RTN","IBCECOB6",39,0)
 ...S:'POS POS=MAX ; if we couldn't find a space, split at the max. number of chars
"RTN","IBCECOB6",40,0)
 ...; populate list manager array with this substring and remove it from the comment line
"RTN","IBCECOB6",41,0)
 ...S STR="",STR=$$SETFLD^VALM1($E(CMSTR,1,POS),STR,"MESSAGE") D SET^VALM10(LN,STR) S LN=LN+1,CMSTR=$E(CMSTR,POS+1,LEN)
"RTN","IBCECOB6",42,0)
 ...Q
"RTN","IBCECOB6",43,0)
 ..Q
"RTN","IBCECOB6",44,0)
 .Q
"RTN","IBCECOB6",45,0)
 S VALMCNT=LN-1,VALMBG=1
"RTN","IBCECOB6",46,0)
 D CLEAN^DILF
"RTN","IBCECOB6",47,0)
 Q
"RTN","IBCECOB6",48,0)
 ;
"RTN","IBCECOB6",49,0)
HELP ; help code
"RTN","IBCECOB6",50,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBCECOB6",51,0)
 Q
"RTN","IBCECOB6",52,0)
 ;
"RTN","IBCECOB6",53,0)
EXIT ; exit code
"RTN","IBCECOB6",54,0)
 N COL,I,LN,STR,WIDTH,Z0,Z1,Z2
"RTN","IBCECOB6",55,0)
 ; update status for this claim in MRW list - could have been changed from View Comments
"RTN","IBCECOB6",56,0)
 S (Z0,Z1)=0,Z2=""
"RTN","IBCECOB6",57,0)
 S Z0=$$FIND1^DIC(409.61,,"X","IBCEM MRA MANAGEMENT")
"RTN","IBCECOB6",58,0)
 S:+Z0 Z1=$$FIND1^DIC(409.621,","_Z0_",","X","BILL")
"RTN","IBCECOB6",59,0)
 S:+Z1 Z2=Z1_","_Z0_","
"RTN","IBCECOB6",60,0)
 I Z2'="" D
"RTN","IBCECOB6",61,0)
 .S COL=$$GET1^DIQ(409.621,Z2,.02)
"RTN","IBCECOB6",62,0)
 .S WIDTH=$$GET1^DIQ(409.621,Z2,.03)
"RTN","IBCECOB6",63,0)
 .Q:COL=""!(WIDTH="")
"RTN","IBCECOB6",64,0)
 .S LN=($O(VALMY(""))-1)*3+2,STR=$E($$BN1^PRCAFN(IBIFN)_$S($P($G(^DGCR(399,IBIFN,"TX")),U,10)=1:"*",1:" "),1,WIDTH)
"RTN","IBCECOB6",65,0)
 .F I=1:1:$L(STR) S $E(^TMP("IBCECOB",$J,LN,0),COL+I-1)=$E(STR,I)
"RTN","IBCECOB6",66,0)
 .Q
"RTN","IBCECOB6",67,0)
 ; clean up variables
"RTN","IBCECOB6",68,0)
 D CLEAR^VALM1,CLEAN^VALM10
"RTN","IBCECOB6",69,0)
 Q
"RTN","IBCECOB6",70,0)
 ;
"RTN","IBCECOB6",71,0)
CMNTW ; enter MRA comments - entry point from MRA Worklist screen
"RTN","IBCECOB6",72,0)
 ; we need to select a claim and set IBIFN
"RTN","IBCECOB6",73,0)
 N IBDA,IBIFN,MRAFLG
"RTN","IBCECOB6",74,0)
 S MRAFLG=1
"RTN","IBCECOB6",75,0)
 D SEL^IBCECOB2(.IBDA,1) S:$O(IBDA(0)) IBIFN=+IBDA($O(IBDA(0))) D:$G(IBIFN) CMNT
"RTN","IBCECOB6",76,0)
 S VALMBCK="R"
"RTN","IBCECOB6",77,0)
 Q
"RTN","IBCECOB6",78,0)
 ;
"RTN","IBCECOB6",79,0)
CMNTV ; enter MRA comments - entry point from View MRA Comments screen
"RTN","IBCECOB6",80,0)
 ; IBIFN should already be defined, only need to set a flag used to rebuild list of comments
"RTN","IBCECOB6",81,0)
 N MRAFLG,VCFLG
"RTN","IBCECOB6",82,0)
 S (MRAFLG,VCFLG)=1 D:$G(IBIFN) CMNT
"RTN","IBCECOB6",83,0)
 S VALMBCK="R"
"RTN","IBCECOB6",84,0)
 Q
"RTN","IBCECOB6",85,0)
 ;
"RTN","IBCECOB6",86,0)
CMNT ; enter MRA comments, called from entry points CMNTV and CMNTW above. Also called from ARCA^IBJTA1 (TPJI)
"RTN","IBCECOB6",87,0)
 N DA,DD,DIC,DIK,DLAYGO,X,Y
"RTN","IBCECOB6",88,0)
 W !
"RTN","IBCECOB6",89,0)
 ; make sure this entry is not locked already
"RTN","IBCECOB6",90,0)
 L +^DGCR(399,IBIFN):3 I '$T W !,*7,"Sorry, another user currently editing this entry." D PAUSE^VALM1 Q
"RTN","IBCECOB6",91,0)
 K DO S DIC="^DGCR(399,"_IBIFN_",""TXC"",",DIC(0)="L",DIC("DR")=".03",DA(1)=IBIFN,X=$$NOW^XLFDT,DLAYGO=399.077
"RTN","IBCECOB6",92,0)
 D FILE^DICN
"RTN","IBCECOB6",93,0)
 S DA=+Y I DA>0 D
"RTN","IBCECOB6",94,0)
 .; if no comment has been added, delete the created entry in comments subfile
"RTN","IBCECOB6",95,0)
 .I '$D(^DGCR(399,IBIFN,"TXC",DA,1)) S DIK=DIC D ^DIK Q
"RTN","IBCECOB6",96,0)
 .; if we got here, comment has been added successfully
"RTN","IBCECOB6",97,0)
 .; if called from MRA Worklist or View MRA Comments, ask if status needs to be changed
"RTN","IBCECOB6",98,0)
 .I $G(MRAFLG) S DIE=399,DA=IBIFN,DR="28.1//REVIEW IN PROCESS" D ^DIE D:'$G(VCFLG) BLD^IBCECOB1
"RTN","IBCECOB6",99,0)
 .; if action was invoked from View Comments, rebuild the list of comments
"RTN","IBCECOB6",100,0)
 .D:$G(VCFLG) CLEAN^VALM10,INIT
"RTN","IBCECOB6",101,0)
 .Q
"RTN","IBCECOB6",102,0)
 D CLEAN^DILF
"RTN","IBCECOB6",103,0)
 L -^DGCR(399,IBIFN)
"RTN","IBCECOB6",104,0)
 Q
"RTN","IBCECOB6",105,0)
 ;
"RTN","IBCECOB6",106,0)
STATUS ; change MRA review status
"RTN","IBCECOB6",107,0)
 N DA,DIE,DR,IBDA,IBIFN,SEL
"RTN","IBCECOB6",108,0)
 D SEL^IBCECOB2(.IBDA,1) S:$O(IBDA(0)) IBIFN=+IBDA($O(IBDA(0))) G:'$G(IBIFN) STATUSX
"RTN","IBCECOB6",109,0)
 W !
"RTN","IBCECOB6",110,0)
 ; make sure this entry is not locked already
"RTN","IBCECOB6",111,0)
 L +^DGCR(399,IBIFN):3 I '$T W !,*7,"Sorry, another user currently editing this entry." D PAUSE^VALM1 G STATUSX
"RTN","IBCECOB6",112,0)
 S DIE=399,DA=IBIFN,DR="28.1//REVIEW IN PROCESS" D ^DIE,CLEAN^DILF
"RTN","IBCECOB6",113,0)
 ;update list manager display
"RTN","IBCECOB6",114,0)
 D BLD^IBCECOB1
"RTN","IBCECOB6",115,0)
 L -^DGCR(399,IBIFN)
"RTN","IBCECOB6",116,0)
STATUSX ;
"RTN","IBCECOB6",117,0)
 S VALMBCK="R"
"RTN","IBCECOB6",118,0)
 Q
"RTN","IBCECSA3")
0^29^B42335133^B27586417
"RTN","IBCECSA3",1,0)
IBCECSA3 ;ALB/CXW - CLAIMS STATUS AWAITING RESOLUTION REPORT ;23-JUL-99
"RTN","IBCECSA3",2,0)
 ;;2.0;INTEGRATED BILLING;**137,320,371,377**;21-MAR-94;Build 23
"RTN","IBCECSA3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCECSA3",4,0)
 Q
"RTN","IBCECSA3",5,0)
EN ; Report of claims status awaiting resolution
"RTN","IBCECSA3",6,0)
 NEW %ZIS,ZTSAVE,ZTRTN,ZTDESC,DIR,X,Y,DIRUT,DTOUT,DUOUT,DIROUT,IBRVW
"RTN","IBCECSA3",7,0)
 ;
"RTN","IBCECSA3",8,0)
 D FULL^VALM1
"RTN","IBCECSA3",9,0)
 W !
"RTN","IBCECSA3",10,0)
 S DIR(0)="YO"           ; IB*2*377 new question
"RTN","IBCECSA3",11,0)
 S DIR("A")="Would you like to include Review Comments with this report"
"RTN","IBCECSA3",12,0)
 S DIR("B")="No"
"RTN","IBCECSA3",13,0)
 D ^DIR K DIR
"RTN","IBCECSA3",14,0)
 I $D(DIRUT) Q
"RTN","IBCECSA3",15,0)
 S IBRVW=Y
"RTN","IBCECSA3",16,0)
 ;
"RTN","IBCECSA3",17,0)
 W !!,"You will need a 132 column printer for this report!",!
"RTN","IBCECSA3",18,0)
 ;
"RTN","IBCECSA3",19,0)
 S %ZIS="QM" D ^%ZIS Q:POP
"RTN","IBCECSA3",20,0)
 I $D(IO("Q")) K IO("Q") D  Q
"RTN","IBCECSA3",21,0)
 . S ZTRTN="LIST^IBCECSA3"
"RTN","IBCECSA3",22,0)
 . S ZTSAVE("IBSORT1")=""
"RTN","IBCECSA3",23,0)
 . S ZTSAVE("IBSORT2")=""
"RTN","IBCECSA3",24,0)
 . S ZTSAVE("IBSORT3")=""
"RTN","IBCECSA3",25,0)
 . S ZTSAVE("IBSORTOR")=""
"RTN","IBCECSA3",26,0)
 . S ZTSAVE("^TMP(""IBCECSB"",$J,")=""
"RTN","IBCECSA3",27,0)
 . S ZTSAVE("IBRVW")=""
"RTN","IBCECSA3",28,0)
 . S ZTDESC="IB -Claims Status Awaiting Resolution Report" D ^%ZTLOAD K ZTSK D HOME^%ZIS
"RTN","IBCECSA3",29,0)
 U IO
"RTN","IBCECSA3",30,0)
LIST ; display
"RTN","IBCECSA3",31,0)
 N IBSTOP,X,IBPAGE,IBX,IBDIV,IBDA,IBPAY,IB,IBZ,IBZFT,IBFST,IBX2
"RTN","IBCECSA3",32,0)
 W:$E(IOST,1,2)["C-" @IOF ;Only initial form feed for print to screen
"RTN","IBCECSA3",33,0)
 S (IBSTOP,IBPAGE,IBFST,IBDIV)=0
"RTN","IBCECSA3",34,0)
 I IBSORT1="D" S IBDIV=1
"RTN","IBCECSA3",35,0)
 I '$D(^TMP("IBCECSB",$J)) D  G LISTQ
"RTN","IBCECSA3",36,0)
 . D HDR1 W !,"No entries found for this report"
"RTN","IBCECSA3",37,0)
 S IBX="" F  S IBX=$O(^TMP("IBCECSB",$J,IBX)) Q:IBX=""!IBSTOP  S IBX2="" F  S IBX2=$O(^TMP("IBCECSB",$J,IBX,IBX2)) Q:IBX2=""!IBSTOP  S IBX3="" F  S IBX3=$O(^TMP("IBCECSB",$J,IBX,IBX2,IBX3)) Q:IBX3=""!IBSTOP  D  Q:IBSTOP
"RTN","IBCECSA3",38,0)
 . I 'IBFST S IBPAY=$$IBPAY(IBX,IBX2,IBX3) D HDR1 S:'IBDIV IBFST=1 Q:IBSTOP
"RTN","IBCECSA3",39,0)
 . S IBDA=0 F  S IBDA=$O(^TMP("IBCECSB",$J,IBX,IBX2,IBX3,IBDA)) Q:'IBDA!IBSTOP  S IB=$G(^TMP("IBCECSB",$J,IBX,IBX2,IBX3,IBDA)) D  Q:IBSTOP
"RTN","IBCECSA3",40,0)
 .. I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",41,0)
 .. W $$BN1^PRCAFN(+IB),$P(IB,U,12),?13,$E($P(IB,U,2),1,25),?40,$E($P(IB,U,3),1,30),?72,$P($P(IB,U,4),"~"),?78,$$DAT1^IBOUTL($P(IB,U,5)),?88,$E($P(IB,U,7),1,10),?100,"$"_$J($P(IB,U,6),0,2),?110,$P(IB,U,10),?122,$P(IB,U,11),!
"RTN","IBCECSA3",42,0)
 .. I $P(IB,U,12)="*" W " ***** CSA REVIEW IN PROCESS *****",!
"RTN","IBCECSA3",43,0)
 .. W " FORM TYPE: "_$P($G(^IBE(353,$P($G(^DGCR(399,+IB,0)),U,19),0)),U),!
"RTN","IBCECSA3",44,0)
 .. I 'IBDIV S X=" DIVISION: "_$P(IB,U,8) W X,$J(" ",40-$L(X))_"AUTHORIZING BILLER: "_$P($P(IB,U,9),"~",1),!
"RTN","IBCECSA3",45,0)
 .. W " MESSAGE TEXT: " S IBZFT=0
"RTN","IBCECSA3",46,0)
 .. S IBZ=0 F  S IBZ=$O(^IBM(361,IBDA,1,IBZ)) Q:'IBZ  D  Q:IBSTOP
"RTN","IBCECSA3",47,0)
 ... W:'IBZFT ?15 S X=$G(^IBM(361,IBDA,1,IBZ,0))
"RTN","IBCECSA3",48,0)
 ... F I=1:131:$L(X) W " "_$E(X,I,I+130),!
"RTN","IBCECSA3",49,0)
 ... S IBZFT=1
"RTN","IBCECSA3",50,0)
 ... I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",51,0)
 ... Q
"RTN","IBCECSA3",52,0)
 .. Q:IBSTOP
"RTN","IBCECSA3",53,0)
 .. ;
"RTN","IBCECSA3",54,0)
 .. ; Display the Review Comments if they exist based on user choice (IB*377)
"RTN","IBCECSA3",55,0)
 .. I $G(IBRVW),+$O(^IBM(361,IBDA,2,0)) D  Q:IBSTOP
"RTN","IBCECSA3",56,0)
 ... N IBCM,IBT1,IBT0,IBD0,IBCL
"RTN","IBCECSA3",57,0)
 ... I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",58,0)
 ... W ?3,"*** Review Comments for Claim "_$$BN1^PRCAFN(+IB)_" ***",!
"RTN","IBCECSA3",59,0)
 ... S IBCM=0 F IBT1=0:1 S IBCM=$O(^IBM(361,IBDA,2,IBCM)) Q:'IBCM     ; count up # of comments
"RTN","IBCECSA3",60,0)
 ... S IBT0=0
"RTN","IBCECSA3",61,0)
 ... S IBCM=0 F  S IBCM=$O(^IBM(361,IBDA,2,IBCM)) Q:'IBCM!IBSTOP  D  Q:IBSTOP
"RTN","IBCECSA3",62,0)
 .... S IBT0=IBT0+1
"RTN","IBCECSA3",63,0)
 .... S IBD0=$G(^IBM(361,IBDA,2,IBCM,0))
"RTN","IBCECSA3",64,0)
 .... I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",65,0)
 .... W ?7,"Entered "_$$FMTE^XLFDT($P(IBD0,U,1),"5ZPM")
"RTN","IBCECSA3",66,0)
 .... I $P(IBD0,U,2) W " by "_$P($G(^VA(200,$P(IBD0,U,2),0)),U,1)
"RTN","IBCECSA3",67,0)
 .... W " ("_IBT0_" of "_IBT1_")",!
"RTN","IBCECSA3",68,0)
 .... S IBCL=0 F  S IBCL=$O(^IBM(361,IBDA,2,IBCM,1,IBCL)) Q:'IBCL!IBSTOP  D  Q:IBSTOP
"RTN","IBCECSA3",69,0)
 ..... I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",70,0)
 ..... W ?10,$G(^IBM(361,IBDA,2,IBCM,1,IBCL,0)),!
"RTN","IBCECSA3",71,0)
 ..... Q
"RTN","IBCECSA3",72,0)
 .... Q
"RTN","IBCECSA3",73,0)
 ... Q
"RTN","IBCECSA3",74,0)
 .. ;
"RTN","IBCECSA3",75,0)
 .. ; Display a line break before the next claim in this report
"RTN","IBCECSA3",76,0)
 .. I ($Y+3)>IOSL D HDR1 Q:IBSTOP
"RTN","IBCECSA3",77,0)
 .. W !
"RTN","IBCECSA3",78,0)
 .. Q
"RTN","IBCECSA3",79,0)
 . Q
"RTN","IBCECSA3",80,0)
 ;
"RTN","IBCECSA3",81,0)
 G:IBSTOP LISTQ
"RTN","IBCECSA3",82,0)
 I $E(IOST,1,2)["C-" K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","IBCECSA3",83,0)
LISTQ I $D(ZTQUEUED) S ZTREQ="@" Q
"RTN","IBCECSA3",84,0)
 W ! D ^%ZISC
"RTN","IBCECSA3",85,0)
 Q
"RTN","IBCECSA3",86,0)
IBPAY(IBX,IBX2,IBX3) ; return biller name
"RTN","IBCECSA3",87,0)
 N X
"RTN","IBCECSA3",88,0)
 S X=$O(^TMP("IBCECSB",$J,IBX,IBX2,IBX3,0))
"RTN","IBCECSA3",89,0)
 S X=$G(^TMP("IBCECSB",$J,IBX,IBX2,IBX3,X))
"RTN","IBCECSA3",90,0)
 Q $P($P(X,U,9),"~",1)
"RTN","IBCECSA3",91,0)
HDR1 ;
"RTN","IBCECSA3",92,0)
 N DIR,Y
"RTN","IBCECSA3",93,0)
 I IBPAGE D  Q:IBSTOP
"RTN","IBCECSA3",94,0)
 . I $E(IOST,1,2)["C-" K DIR S DIR(0)="E" D ^DIR K DIR S IBSTOP=('Y) Q:IBSTOP
"RTN","IBCECSA3",95,0)
 . W @IOF
"RTN","IBCECSA3",96,0)
 S IBPAGE=IBPAGE+1
"RTN","IBCECSA3",97,0)
 W !,"Sort 1: ",$$SD^IBCECSA(IBSORT1)
"RTN","IBCECSA3",98,0)
 W ?46,"Claims Status Awaiting Resolution Report",?120,$J("Page: "_IBPAGE,11)
"RTN","IBCECSA3",99,0)
 W !,"Sort 2: ",$S($G(IBSORT2)'="":$$SD^IBCECSA(IBSORT2),1:"n/a")
"RTN","IBCECSA3",100,0)
 W ?104,$J("Run Date: "_$$HTE^XLFDT($H,"2Z"),27)
"RTN","IBCECSA3",101,0)
 W !,"Sort 3: ",$S($G(IBSORT3)'="":$$SD^IBCECSA(IBSORT3),1:"n/a")
"RTN","IBCECSA3",102,0)
 I IBDIV W !!,"Division: "_$S($G(IBX)=0:"",1:$G(IBX)),!,"Authorizing Biller: "_$G(IBPAY)
"RTN","IBCECSA3",103,0)
 W !,?72,"Last",?78,"Date of",?88,"Location",?100,"Current",?110,"Source of",?122,"Days Msg"
"RTN","IBCECSA3",104,0)
 W !,"Bill #",?13,"Payer Name",?40,"Patient Name",?72,"4 SSN",?78,"Service",?88,"of Service",?100,"Balance",?110,"Message",?122,"Pending"
"RTN","IBCECSA3",105,0)
 W !,$TR($J("",132)," ","-"),!
"RTN","IBCECSA3",106,0)
 Q
"RTN","IBCECSA3",107,0)
 ;
"RTN","IBCECSA3",108,0)
 ;
"RTN","IBCECSA3",109,0)
RESORT ; CSA screen re-sort action
"RTN","IBCECSA3",110,0)
 NEW DIR,X,Y,Z,IBSAVE,VALMQUIT,IBCURR
"RTN","IBCECSA3",111,0)
 D FULL^VALM1 S VALMBCK="R"
"RTN","IBCECSA3",112,0)
 W !!?2,"The CSA screen is currently sorted in the following manner:"
"RTN","IBCECSA3",113,0)
 W !!?9,"Primary Sort:  ",$S($G(IBSORT1)'="":$$SD^IBCECSA(IBSORT1),1:"n/a")
"RTN","IBCECSA3",114,0)
 W !?7,"Secondary Sort:  ",$S($G(IBSORT2)'="":$$SD^IBCECSA(IBSORT2),1:"n/a")
"RTN","IBCECSA3",115,0)
 W !?8,"Tertiary Sort:  ",$S($G(IBSORT3)'="":$$SD^IBCECSA(IBSORT3),1:"n/a")
"RTN","IBCECSA3",116,0)
 ;
"RTN","IBCECSA3",117,0)
 W !
"RTN","IBCECSA3",118,0)
 S DIR(0)="Y",DIR("A")="Would you like to change the sort criteria"
"RTN","IBCECSA3",119,0)
 S DIR("B")="Yes" D ^DIR K DIR
"RTN","IBCECSA3",120,0)
 I 'Y G RESORTX
"RTN","IBCECSA3",121,0)
 ;
"RTN","IBCECSA3",122,0)
 ; save the old sort criteria
"RTN","IBCECSA3",123,0)
 S IBSAVE=$G(IBSORT1)_U_$G(IBSORT2)_U_$G(IBSORT3)
"RTN","IBCECSA3",124,0)
 S Z="" F  S Z=$O(IBSORTOR(Z)) Q:Z=""  S IBSAVE=IBSAVE_U_Z_U_IBSORTOR(Z)
"RTN","IBCECSA3",125,0)
 ;
"RTN","IBCECSA3",126,0)
 W !
"RTN","IBCECSA3",127,0)
 K IBSORTOR
"RTN","IBCECSA3",128,0)
 D SORT^IBCECSA(1,$P(IBSAVE,U,1)) I $G(VALMQUIT) G RES1
"RTN","IBCECSA3",129,0)
 D SORT^IBCECSA(2) I $G(VALMQUIT) G RES1
"RTN","IBCECSA3",130,0)
 I $G(IBSORT2)'="" D SORT^IBCECSA(3) I $G(VALMQUIT) G RES1
"RTN","IBCECSA3",131,0)
RES1 ;
"RTN","IBCECSA3",132,0)
 I $G(IBSORT1)="" S IBSORT1=$P(IBSAVE,U,1)   ; need at least one
"RTN","IBCECSA3",133,0)
 ;
"RTN","IBCECSA3",134,0)
 ; see if the sort criteria changed
"RTN","IBCECSA3",135,0)
 S IBCURR=$G(IBSORT1)_U_$G(IBSORT2)_U_$G(IBSORT3)
"RTN","IBCECSA3",136,0)
 S Z="" F  S Z=$O(IBSORTOR(Z)) Q:Z=""  S IBCURR=IBCURR_U_Z_U_IBSORTOR(Z)
"RTN","IBCECSA3",137,0)
 I IBSAVE=IBCURR G RESORTX    ; no sort changes made at all
"RTN","IBCECSA3",138,0)
 ;
"RTN","IBCECSA3",139,0)
 ; time to rebuild the list because sorts have changed
"RTN","IBCECSA3",140,0)
 I $G(IBDAYS)="" S IBDAYS=0
"RTN","IBCECSA3",141,0)
 I $G(IBSEV)="" S IBSEV="R"
"RTN","IBCECSA3",142,0)
 D BLD^IBCECSA1
"RTN","IBCECSA3",143,0)
 S VALMBCK="R",VALMBG=1
"RTN","IBCECSA3",144,0)
 ;
"RTN","IBCECSA3",145,0)
RESORTX ;
"RTN","IBCECSA3",146,0)
 Q
"RTN","IBCECSA3",147,0)
 ;
"RTN","IBCECSA3",148,0)
MCS ; Link to the Multiple CSA Message Management option
"RTN","IBCECSA3",149,0)
 NEW IBCSAMCS S IBCSAMCS=1
"RTN","IBCECSA3",150,0)
 D FULL^VALM1 S VALMBCK="R"
"RTN","IBCECSA3",151,0)
 I '$$KCHK^XUSRB("IB MESSAGE MANAGEMENT") D  G MCSX
"RTN","IBCECSA3",152,0)
 . W !!?5,"You must hold the IB MESSAGE MANAGEMENT key to access this option."
"RTN","IBCECSA3",153,0)
 . D PAUSE^VALM1
"RTN","IBCECSA3",154,0)
 . Q
"RTN","IBCECSA3",155,0)
 ;
"RTN","IBCECSA3",156,0)
 D      ; call the MCS screen
"RTN","IBCECSA3",157,0)
 . NEW IBSORT1,IBSORT2,IBSORT3,IBDAYS,IBSEV     ; protect CSA vars
"RTN","IBCECSA3",158,0)
 . D EN^IBCEMCL
"RTN","IBCECSA3",159,0)
 . Q
"RTN","IBCECSA3",160,0)
 ;
"RTN","IBCECSA3",161,0)
 I $G(IBCSAMCS)=2 D BLD^IBCECSA1 S VALMBG=1     ; rebuild CSA
"RTN","IBCECSA3",162,0)
 S VALMBCK="R"
"RTN","IBCECSA3",163,0)
MCSX ;
"RTN","IBCECSA3",164,0)
 Q
"RTN","IBCECSA3",165,0)
 ;
"RTN","IBCEDC")
0^15^B29467886^n/a
"RTN","IBCEDC",1,0)
IBCEDC ;ALB/ESG - EDI CLAIM STATUS REPORT COMPILE ;13-DEC-2007
"RTN","IBCEDC",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCEDC",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEDC",4,0)
 ;
"RTN","IBCEDC",5,0)
 Q
"RTN","IBCEDC",6,0)
 ;
"RTN","IBCEDC",7,0)
EN ; Compile entry point - Queued Job Entry Point
"RTN","IBCEDC",8,0)
 NEW BCHIEN,COUNT,DT1,DT2,IBIFN,IBLTRDT,IEN
"RTN","IBCEDC",9,0)
 K ^TMP($J,"IBCEDC")
"RTN","IBCEDC",10,0)
 I '$D(ZTQUEUED) W !!,"Compiling EDI Claim Status Report.  Please wait "
"RTN","IBCEDC",11,0)
 ;
"RTN","IBCEDC",12,0)
 I IBMETHOD="C" G EN1     ; specific claims selected
"RTN","IBCEDC",13,0)
 ;
"RTN","IBCEDC",14,0)
 ; get dates and loop thru ALT area
"RTN","IBCEDC",15,0)
 S DT1=$G(^TMP($J,"IBCEDS","ALTDT"))
"RTN","IBCEDC",16,0)
 S DT2=$P(DT1,U,2),DT1=$P(DT1,U,1)
"RTN","IBCEDC",17,0)
 S IBLTRDT=$O(^IBA(364.1,"ALT",DT1),-1)  ; get starting point
"RTN","IBCEDC",18,0)
 F  S IBLTRDT=$O(^IBA(364.1,"ALT",IBLTRDT)) Q:'IBLTRDT!(IBLTRDT\1>DT2)!$G(ZTSTOP)  D
"RTN","IBCEDC",19,0)
 . S BCHIEN=0
"RTN","IBCEDC",20,0)
 . F  S BCHIEN=$O(^IBA(364.1,"ALT",IBLTRDT,BCHIEN)) Q:'BCHIEN!$G(ZTSTOP)  D
"RTN","IBCEDC",21,0)
 .. S IEN=0
"RTN","IBCEDC",22,0)
 .. F  S IEN=$O(^IBA(364,"C",BCHIEN,IEN)) Q:'IEN!$G(ZTSTOP)  D COMPILE(IEN)
"RTN","IBCEDC",23,0)
 .. Q
"RTN","IBCEDC",24,0)
 . Q
"RTN","IBCEDC",25,0)
 G RPT
"RTN","IBCEDC",26,0)
 ;
"RTN","IBCEDC",27,0)
 ;
"RTN","IBCEDC",28,0)
EN1 ; specific claims selected so loop thru all EDI claims in file 364
"RTN","IBCEDC",29,0)
 ; for these claims
"RTN","IBCEDC",30,0)
 ;
"RTN","IBCEDC",31,0)
 S IBIFN=0
"RTN","IBCEDC",32,0)
 F  S IBIFN=$O(^TMP($J,"IBCEDS","CLAIM",IBIFN)) Q:'IBIFN!$G(ZTSTOP)  D
"RTN","IBCEDC",33,0)
 . S IEN=0
"RTN","IBCEDC",34,0)
 . F  S IEN=$O(^IBA(364,"B",IBIFN,IEN)) Q:'IEN!$G(ZTSTOP)  D
"RTN","IBCEDC",35,0)
 .. S BCHIEN=+$P($G(^IBA(364,IEN,0)),U,2)         ; batch ien
"RTN","IBCEDC",36,0)
 .. S IBLTRDT=$P($G(^IBA(364.1,BCHIEN,1)),U,3)    ; date/time last transmitted
"RTN","IBCEDC",37,0)
 .. D COMPILE(IEN)
"RTN","IBCEDC",38,0)
 .. Q
"RTN","IBCEDC",39,0)
 . Q
"RTN","IBCEDC",40,0)
 G RPT
"RTN","IBCEDC",41,0)
 ;
"RTN","IBCEDC",42,0)
 ;
"RTN","IBCEDC",43,0)
RPT ; print the report and close things down
"RTN","IBCEDC",44,0)
 D PRINT^IBCEDP                          ; print report
"RTN","IBCEDC",45,0)
 D ^%ZISC                                ; close the device
"RTN","IBCEDC",46,0)
 K ^TMP($J,"IBCEDS"),^TMP($J,"IBCEDC")   ; clean up scratch globals
"RTN","IBCEDC",47,0)
 I $D(ZTQUEUED) S ZTREQ="@"              ; purge the task record
"RTN","IBCEDC",48,0)
 ;
"RTN","IBCEDC",49,0)
EX ; routine exit point
"RTN","IBCEDC",50,0)
 ;
"RTN","IBCEDC",51,0)
 Q
"RTN","IBCEDC",52,0)
 ;
"RTN","IBCEDC",53,0)
COMPILE(IEN) ; gather and compile EDI claim data for one EDI claim
"RTN","IBCEDC",54,0)
 ; IEN - 364 ien
"RTN","IBCEDC",55,0)
 NEW AR,DIV,IB0,IBAGE,IBAGEDT,IBARSTAT,IBCURBAL,IBDIV,IBDIVID,IBEDIST
"RTN","IBCEDC",56,0)
 NEW IBEXTCLM,IBIFN,IBPAY,IBS,IBSGD,IBSTAT,IBZ,INS,STAT,SV1,SV2,SV3
"RTN","IBCEDC",57,0)
 S COUNT=$G(COUNT)+1
"RTN","IBCEDC",58,0)
 I COUNT#1000=0 D  I $G(ZTSTOP) G COMPX
"RTN","IBCEDC",59,0)
 . I $D(ZTQUEUED),$$S^%ZTLOAD() S ZTSTOP=1 Q   ; check for TM stop request
"RTN","IBCEDC",60,0)
 . I '$D(ZTQUEUED) W "."                       ; display progress indicator
"RTN","IBCEDC",61,0)
 . Q
"RTN","IBCEDC",62,0)
 S IBZ=$G(^IBA(364,IEN,0)) I IBZ="" G COMPX
"RTN","IBCEDC",63,0)
 S IBIFN=+IBZ
"RTN","IBCEDC",64,0)
 S IB0=$G(^DGCR(399,IBIFN,0)) I IB0="" G COMPX
"RTN","IBCEDC",65,0)
 S DIV=+$P(IB0,U,22)                           ; division ien
"RTN","IBCEDC",66,0)
 S INS=+$$FINDINS^IBCEF1(IBIFN,$P(IBZ,U,8))    ; insurance company ien for this EDI transmission
"RTN","IBCEDC",67,0)
 S STAT=$P(IBZ,U,3)                            ; edi status code
"RTN","IBCEDC",68,0)
 S AR=$P($$BILL^RCJIBFN2(IBIFN),U,2)           ; current AR status ien
"RTN","IBCEDC",69,0)
 S IBARSTAT=$P($G(^PRCA(430.3,AR,0)),U,2)      ; current AR status abbr/sort value
"RTN","IBCEDC",70,0)
 ;
"RTN","IBCEDC",71,0)
 I IBMETHOD="R",'$$CHECK(IB0,DIV,INS,STAT,IBARSTAT) G COMPX   ; failed selection criteria checks
"RTN","IBCEDC",72,0)
 ;
"RTN","IBCEDC",73,0)
 S IBPAY=$P($G(^DIC(36,INS,0)),U,1)_U_INS  ; payer name^insurance company ien
"RTN","IBCEDC",74,0)
 S IBDIVID=$P($G(^DG(40.8,DIV,0)),U,2)     ; division id#
"RTN","IBCEDC",75,0)
 S IBDIV=IBDIVID                           ; division sort value
"RTN","IBCEDC",76,0)
 S IBEXTCLM=$P(IB0,U,1)                    ; claim#
"RTN","IBCEDC",77,0)
 S IBEDIST=STAT                            ; edi status sort value
"RTN","IBCEDC",78,0)
 S IBCURBAL=$G(^DGCR(399,IBIFN,"U1"))
"RTN","IBCEDC",79,0)
 S IBCURBAL=$P(IBCURBAL,U,1)-$P(IBCURBAL,U,2)   ; current balance (total charges - offset)
"RTN","IBCEDC",80,0)
 ;
"RTN","IBCEDC",81,0)
 ; calculate age
"RTN","IBCEDC",82,0)
 S IBS=$G(^DGCR(399,IBIFN,"S"))
"RTN","IBCEDC",83,0)
 ; if the payer is Medicare and an MRA request date exists then use that date
"RTN","IBCEDC",84,0)
 I $$MCRWNR^IBEFUNC(INS),$P(IBS,U,7) S IBAGEDT=$P(IBS,U,7)
"RTN","IBCEDC",85,0)
 E  S IBAGEDT=$P(IBS,U,10)     ; otherwise use the Authorization Date
"RTN","IBCEDC",86,0)
 I 'IBAGEDT S IBAGEDT=$P(IBS,U,1)   ; if error, use date entered
"RTN","IBCEDC",87,0)
 I 'IBAGEDT S IBAGEDT=$P($G(^DGCR(399,IBIFN,"U")),U,1)    ; if error again, use from date on claim
"RTN","IBCEDC",88,0)
 S IBAGE=$$FMDIFF^XLFDT(DT,IBAGEDT)
"RTN","IBCEDC",89,0)
 ;
"RTN","IBCEDC",90,0)
 ; capture IB status abbr
"RTN","IBCEDC",91,0)
 S IBSTAT=$P(IB0,U,13)
"RTN","IBCEDC",92,0)
 S IBSTAT=$S(IBSTAT=2:"REQ MRA",IBSTAT=4:"PRNT/TX",IBSTAT=7:"CANCEL",1:$$EXTERNAL^DILFD(399,.13,,IBSTAT))
"RTN","IBCEDC",93,0)
 ;
"RTN","IBCEDC",94,0)
 ; Build the scratch global
"RTN","IBCEDC",95,0)
 S IBSGD=IBEXTCLM_U_$$FT^IBCEF(IBIFN)_U_$$INPAT^IBCEF(IBIFN)_U_$P(IBZ,U,8)_U_STAT_U_IBLTRDT_U_IBAGE_U_+$P(IBZ,U,2)
"RTN","IBCEDC",96,0)
 S IBSGD=IBSGD_U_IBCURBAL_U_DIV_U_IBARSTAT_U_INS_U_IBSTAT
"RTN","IBCEDC",97,0)
 S SV1=$$SV^IBCEDS1($G(IBSORT1),IEN)
"RTN","IBCEDC",98,0)
 S SV2=$$SV^IBCEDS1($G(IBSORT2),IEN)
"RTN","IBCEDC",99,0)
 S SV3=$$SV^IBCEDS1($G(IBSORT3),IEN)
"RTN","IBCEDC",100,0)
 S ^TMP($J,"IBCEDC",SV1,SV2,SV3,IEN)=IBSGD
"RTN","IBCEDC",101,0)
 ;
"RTN","IBCEDC",102,0)
COMPX ;
"RTN","IBCEDC",103,0)
 Q
"RTN","IBCEDC",104,0)
 ;
"RTN","IBCEDC",105,0)
CHECK(IB0,DIV,INS,STAT,IBARSTAT) ; check to see if EDI claim passes the selection criteria
"RTN","IBCEDC",106,0)
 ; function value =1 if passed checks
"RTN","IBCEDC",107,0)
 ; function value =0 if failed checks
"RTN","IBCEDC",108,0)
 NEW OK,EDI,PROFID,INSTID S OK=0
"RTN","IBCEDC",109,0)
 I STAT="" S STAT="~~~~"
"RTN","IBCEDC",110,0)
 I $D(^TMP($J,"IBCEDS","DIV")),'$D(^TMP($J,"IBCEDS","DIV",DIV)) S OK=0 G CHECKX    ; division check
"RTN","IBCEDC",111,0)
 I $D(^TMP($J,"IBCEDS","EDI")),'$D(^TMP($J,"IBCEDS","EDI",STAT)) S OK=0 G CHECKX   ; EDI status check
"RTN","IBCEDC",112,0)
 ;
"RTN","IBCEDC",113,0)
 ; IB cancelled claim check
"RTN","IBCEDC",114,0)
 I $P(IB0,U,13)=7,'$G(^TMP($J,"IBCEDS","CANCEL")) S OK=0 G CHECKX
"RTN","IBCEDC",115,0)
 ;
"RTN","IBCEDC",116,0)
 ; AR cancelled claim check
"RTN","IBCEDC",117,0)
 I $F(".CB.CN.","."_IBARSTAT_"."),'$G(^TMP($J,"IBCEDS","CANCEL")) S OK=0 G CHECKX
"RTN","IBCEDC",118,0)
 ;
"RTN","IBCEDC",119,0)
 ; payer check
"RTN","IBCEDC",120,0)
 I $D(^TMP($J,"IBCEDS","INS")) D  I 'OK G CHECKX
"RTN","IBCEDC",121,0)
 . S OK=0
"RTN","IBCEDC",122,0)
 . I 'INS Q   ; don't include if the payer isn't valid
"RTN","IBCEDC",123,0)
 . I $D(^TMP($J,"IBCEDS","INS",1,INS)) S OK=1 Q
"RTN","IBCEDC",124,0)
 . I '$D(^TMP($J,"IBCEDS","INS",2)) Q
"RTN","IBCEDC",125,0)
 . S EDI=$$UP^XLFSTR($G(^DIC(36,INS,3)))
"RTN","IBCEDC",126,0)
 . S PROFID=$P(EDI,U,2),INSTID=$P(EDI,U,4)
"RTN","IBCEDC",127,0)
 . I PROFID'="",$D(^TMP($J,"IBCEDS","INS",2,PROFID)) S OK=1 Q
"RTN","IBCEDC",128,0)
 . I INSTID'="",$D(^TMP($J,"IBCEDS","INS",2,INSTID)) S OK=1 Q
"RTN","IBCEDC",129,0)
 . Q
"RTN","IBCEDC",130,0)
 ;
"RTN","IBCEDC",131,0)
 ; all checks passed OK
"RTN","IBCEDC",132,0)
 S OK=1
"RTN","IBCEDC",133,0)
 ;
"RTN","IBCEDC",134,0)
CHECKX ;
"RTN","IBCEDC",135,0)
 Q OK
"RTN","IBCEDC",136,0)
 ;
"RTN","IBCEDP")
0^16^B32525754^n/a
"RTN","IBCEDP",1,0)
IBCEDP ;ALB/ESG - EDI CLAIM STATUS REPORT PRINT ;13-DEC-2007
"RTN","IBCEDP",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCEDP",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEDP",4,0)
 ;
"RTN","IBCEDP",5,0)
 Q
"RTN","IBCEDP",6,0)
 ;
"RTN","IBCEDP",7,0)
PRINT ; entry point to print the report
"RTN","IBCEDP",8,0)
 NEW CRT,IBPAGE,IBSTOP,IBCT,SV1,SV2,SV3,IEN,DATA,NEWHDR
"RTN","IBCEDP",9,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIROUT,DIRUT
"RTN","IBCEDP",10,0)
 I IOST["C-" S CRT=1
"RTN","IBCEDP",11,0)
 E  S CRT=0
"RTN","IBCEDP",12,0)
 ;
"RTN","IBCEDP",13,0)
 S IBPAGE=0,IBSTOP=0,IBCT=0,NEWHDR=0
"RTN","IBCEDP",14,0)
 ;
"RTN","IBCEDP",15,0)
 I '$D(^TMP($J,"IBCEDC")) D HDR W !!?5,"No data found for this report." G PX
"RTN","IBCEDP",16,0)
 I $G(ZTSTOP) D HDR W !!?5,"This report was halted during compilation by TaskManager Request." G PX
"RTN","IBCEDP",17,0)
 ;
"RTN","IBCEDP",18,0)
 D HDR   ; initial header display
"RTN","IBCEDP",19,0)
 S SV1=""
"RTN","IBCEDP",20,0)
 F  S SV1=$O(^TMP($J,"IBCEDC",SV1)) Q:SV1=""!IBSTOP  D SD(SV1) D  Q:IBSTOP
"RTN","IBCEDP",21,0)
 . S SV2=""
"RTN","IBCEDP",22,0)
 . F  S SV2=$O(^TMP($J,"IBCEDC",SV1,SV2)) Q:SV2=""!IBSTOP  D  Q:IBSTOP
"RTN","IBCEDP",23,0)
 .. S SV3=""
"RTN","IBCEDP",24,0)
 .. F  S SV3=$O(^TMP($J,"IBCEDC",SV1,SV2,SV3)) Q:SV3=""!IBSTOP  D  Q:IBSTOP
"RTN","IBCEDP",25,0)
 ... S IEN=0
"RTN","IBCEDP",26,0)
 ... F  S IEN=$O(^TMP($J,"IBCEDC",SV1,SV2,SV3,IEN)) Q:'IEN!IBSTOP  D  Q:IBSTOP
"RTN","IBCEDP",27,0)
 .... S DATA=$G(^TMP($J,"IBCEDC",SV1,SV2,SV3,IEN))
"RTN","IBCEDP",28,0)
 .... D PRT(DATA)
"RTN","IBCEDP",29,0)
 .... Q
"RTN","IBCEDP",30,0)
 ... Q
"RTN","IBCEDP",31,0)
 .. Q
"RTN","IBCEDP",32,0)
 . Q
"RTN","IBCEDP",33,0)
 ;
"RTN","IBCEDP",34,0)
 I IBSTOP G PRINTX
"RTN","IBCEDP",35,0)
 D:$Y>(IOSL-4) HDR G:IBSTOP PRINTX
"RTN","IBCEDP",36,0)
 W !!?5,"Total number of EDI Claims:  ",IBCT
"RTN","IBCEDP",37,0)
 D:$Y>(IOSL-4) HDR G:IBSTOP PRINTX
"RTN","IBCEDP",38,0)
 W !!,"*** End of Report ***"
"RTN","IBCEDP",39,0)
 ;
"RTN","IBCEDP",40,0)
PX ;
"RTN","IBCEDP",41,0)
 I CRT,'$D(ZTQUEUED) S DIR(0)="E" D ^DIR K DIR
"RTN","IBCEDP",42,0)
PRINTX ;
"RTN","IBCEDP",43,0)
 Q
"RTN","IBCEDP",44,0)
 ;
"RTN","IBCEDP",45,0)
PRT(Z) ; print a line on the report
"RTN","IBCEDP",46,0)
 ; Z - data from the scratch global node
"RTN","IBCEDP",47,0)
 N DIV,PAY,ADDR1
"RTN","IBCEDP",48,0)
 D:$Y>(IOSL-3) HDR G:IBSTOP PRTX
"RTN","IBCEDP",49,0)
 S IBCT=IBCT+1
"RTN","IBCEDP",50,0)
 S DIV=$P($G(^DG(40.8,+$P(Z,U,10),0)),U,2)      ; division abbr
"RTN","IBCEDP",51,0)
 S PAY=$P($G(^DIC(36,+$P(Z,U,12),0)),U,1)       ; payer name
"RTN","IBCEDP",52,0)
 S ADDR1=$P($G(^DIC(36,+$P(Z,U,12),.11)),U,1)   ; payer address line 1
"RTN","IBCEDP",53,0)
 ;
"RTN","IBCEDP",54,0)
 W !,$P(Z,U,1)                                            ; claim#
"RTN","IBCEDP",55,0)
 W ?9,$S($P(Z,U,2)=2:1500,1:"UB04")                       ; form type
"RTN","IBCEDP",56,0)
 W ?14,$S($P(Z,U,3):"INPT",1:"OUTPT")                     ; inpat/outpat
"RTN","IBCEDP",57,0)
 W ?21,$P(Z,U,4)                                          ; payer sequence
"RTN","IBCEDP",58,0)
 W ?25,$P(Z,U,5)                                          ; EDI status code
"RTN","IBCEDP",59,0)
 W ?29,$E($P(Z,U,13),1,9)                                 ; IB status abbr
"RTN","IBCEDP",60,0)
 W ?39,$E($P(Z,U,11),1,2)                                 ; ar status abbr
"RTN","IBCEDP",61,0)
 W ?44,$$FMTE^XLFDT($P(Z,U,6)\1,"2Z")                     ; last transmit date
"RTN","IBCEDP",62,0)
 W ?55,$J($P(Z,U,7),4)                                    ; age in days
"RTN","IBCEDP",63,0)
 W ?62,$P(Z,U,8)                                          ; batch#
"RTN","IBCEDP",64,0)
 W ?69,$J($FN($P(Z,U,9),"",2),9)                          ; balance due
"RTN","IBCEDP",65,0)
 W ?81,DIV                                                ; division
"RTN","IBCEDP",66,0)
 W ?89,$E(PAY,1,23)                                       ; payer name
"RTN","IBCEDP",67,0)
 W ?114,$E(ADDR1,1,18)                                    ; payer address line 1
"RTN","IBCEDP",68,0)
 ;
"RTN","IBCEDP",69,0)
 S NEWHDR=0  ; toggle new header flag
"RTN","IBCEDP",70,0)
PRTX ;
"RTN","IBCEDP",71,0)
 Q
"RTN","IBCEDP",72,0)
 ;
"RTN","IBCEDP",73,0)
HDR ; report header
"RTN","IBCEDP",74,0)
 ;
"RTN","IBCEDP",75,0)
 ; if screen output and page# already exists, do a page break at the bottom of the screen
"RTN","IBCEDP",76,0)
 I IBPAGE,CRT D  I IBSTOP G HDRX
"RTN","IBCEDP",77,0)
 . S DIR(0)="E" D ^DIR K DIR
"RTN","IBCEDP",78,0)
 . I 'Y S IBSTOP=1
"RTN","IBCEDP",79,0)
 . Q
"RTN","IBCEDP",80,0)
 ;
"RTN","IBCEDP",81,0)
 ; if screen output OR page# already exists, do a form feed
"RTN","IBCEDP",82,0)
 I IBPAGE!CRT W @IOF
"RTN","IBCEDP",83,0)
 I 'IBPAGE,'CRT W $C(13)   ; first printer page - left margin set
"RTN","IBCEDP",84,0)
 ;
"RTN","IBCEDP",85,0)
 S IBPAGE=IBPAGE+1
"RTN","IBCEDP",86,0)
 ;
"RTN","IBCEDP",87,0)
 W "EDI Claim Status Report",?96,$$FMTE^XLFDT($$NOW^XLFDT),"   Page: ",IBPAGE
"RTN","IBCEDP",88,0)
 W !,"** A claim may appear multiple times if transmitted more than once. **"
"RTN","IBCEDP",89,0)
 W !?3,"Sorted by ",$$SD^IBCEDS1($G(IBSORT1))
"RTN","IBCEDP",90,0)
 I $G(IBSORT2)'="" W ", then by ",$$SD^IBCEDS1(IBSORT2)
"RTN","IBCEDP",91,0)
 I $G(IBSORT3)'="" W ", then by ",$$SD^IBCEDS1(IBSORT3)
"RTN","IBCEDP",92,0)
 ;
"RTN","IBCEDP",93,0)
 ; display column headers
"RTN","IBCEDP",94,0)
 W !?25,"*-- Statuses --*"
"RTN","IBCEDP",95,0)
 W !,"Claim",?9,"Form",?14,"Type",?20,"Seq",?25,"EDI",?31,"IB",?39,"AR",?44,"Trans Dt",?56,"Age",?62,"Batch#",?71,"Bal Due"
"RTN","IBCEDP",96,0)
 W ?81,"Div",?89,"Payer"
"RTN","IBCEDP",97,0)
 ;
"RTN","IBCEDP",98,0)
 N Z S Z="",$P(Z,"-",133)="" W !,Z
"RTN","IBCEDP",99,0)
 ;
"RTN","IBCEDP",100,0)
 S NEWHDR=1    ; flag indicating a new page header was just printed
"RTN","IBCEDP",101,0)
 ;
"RTN","IBCEDP",102,0)
 ; check for a TaskManager stop request
"RTN","IBCEDP",103,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD() D  G HDRX
"RTN","IBCEDP",104,0)
 . S (ZTSTOP,IBSTOP)=1
"RTN","IBCEDP",105,0)
 . W !!!?5,"*** Report Halted by TaskManager Request ***"
"RTN","IBCEDP",106,0)
 . Q
"RTN","IBCEDP",107,0)
 ;
"RTN","IBCEDP",108,0)
HDRX ;
"RTN","IBCEDP",109,0)
 Q
"RTN","IBCEDP",110,0)
 ;
"RTN","IBCEDP",111,0)
SD(SV) ; primary sort value display break.  This procedure is to display a break whenever the primary sort value changes
"RTN","IBCEDP",112,0)
 ; SV - subscript value of the primary sort
"RTN","IBCEDP",113,0)
 I IBSORT1=4!(IBSORT1=6) G SDX  ; don't display a break for current balance or for claim# primary sorts
"RTN","IBCEDP",114,0)
 ;
"RTN","IBCEDP",115,0)
 D:$Y>(IOSL-4) HDR G:IBSTOP SDX
"RTN","IBCEDP",116,0)
 I 'NEWHDR W !     ; an extra line break if a page header was not just printed
"RTN","IBCEDP",117,0)
 I $E(SV)="-",$D(IBSORTOR(IBSORT1)) S SV=$E(SV,2,999)    ; remove leading "-" on descending numerical sorts
"RTN","IBCEDP",118,0)
 ;
"RTN","IBCEDP",119,0)
 I IBSORT1=1 S SV=$$FMTE^XLFDT(SV,"5Z")   ; last transmitted date/time
"RTN","IBCEDP",120,0)
 I IBSORT1=2 D                            ; payer name and address
"RTN","IBCEDP",121,0)
 . N INS,ADDR
"RTN","IBCEDP",122,0)
 . S INS=+$P(SV,U,2)                      ; ins co ien 2nd piece of subscript
"RTN","IBCEDP",123,0)
 . S ADDR=$$INSADD^IBCNSC02(INS)          ; address fields
"RTN","IBCEDP",124,0)
 . S SV=$P(SV,U,1)_"   "_$P(ADDR,U,2)_" "_$P(ADDR,U,6)_" "_$P(ADDR,U,5)
"RTN","IBCEDP",125,0)
 . Q
"RTN","IBCEDP",126,0)
 I IBSORT1=3 S SV=SV_" - "_$$EXTERNAL^DILFD(364,.03,,SV)   ; edi claim status and description
"RTN","IBCEDP",127,0)
 I IBSORT1=5 D                                             ; division
"RTN","IBCEDP",128,0)
 . N DZ,DIVNM
"RTN","IBCEDP",129,0)
 . S DZ=+$O(^DG(40.8,"C",SV,""))                           ; division ien
"RTN","IBCEDP",130,0)
 . S DIVNM=$P($G(^DG(40.8,DZ,0)),U,1)                      ; division name
"RTN","IBCEDP",131,0)
 . S SV=SV_" - "_DIVNM
"RTN","IBCEDP",132,0)
 . Q
"RTN","IBCEDP",133,0)
 I IBSORT1=7 D                                             ; AR status
"RTN","IBCEDP",134,0)
 . N AZ,ANM
"RTN","IBCEDP",135,0)
 . S AZ=+$O(^PRCA(430.3,"C",SV,""))                        ; AR status ien
"RTN","IBCEDP",136,0)
 . S ANM=$P($G(^PRCA(430.3,AZ,0)),U,1)                     ; AR status description
"RTN","IBCEDP",137,0)
 . S SV=SV_" - "_ANM
"RTN","IBCEDP",138,0)
 . Q
"RTN","IBCEDP",139,0)
 I IBSORT1=8 S SV=SV_" Days"
"RTN","IBCEDP",140,0)
 ;
"RTN","IBCEDP",141,0)
 S SV=$$SD^IBCEDS1(IBSORT1)_": "_SV
"RTN","IBCEDP",142,0)
 W !,SV
"RTN","IBCEDP",143,0)
SDX ;
"RTN","IBCEDP",144,0)
 Q
"RTN","IBCEDP",145,0)
 ;
"RTN","IBCEDS")
0^13^B75763086^n/a
"RTN","IBCEDS",1,0)
IBCEDS ;ALB/ESG - EDI CLAIM STATUS REPORT - SELECTION ;13-DEC-2007
"RTN","IBCEDS",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCEDS",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEDS",4,0)
 ;
"RTN","IBCEDS",5,0)
 Q
"RTN","IBCEDS",6,0)
 ;
"RTN","IBCEDS",7,0)
EN ; entry point
"RTN","IBCEDS",8,0)
 ;
"RTN","IBCEDS",9,0)
 NEW STOP,IBMETHOD,IBSORT1,IBSORT2,IBSORT3,IBSORTOR
"RTN","IBCEDS",10,0)
 S STOP=0
"RTN","IBCEDS",11,0)
 K ^TMP($J,"IBCEDS")
"RTN","IBCEDS",12,0)
 W @IOF,!,"EDI Claim Status Report"
"RTN","IBCEDS",13,0)
 ;
"RTN","IBCEDS",14,0)
DS10 D CLAIM I STOP G:$$STOP EX G DS10
"RTN","IBCEDS",15,0)
 I IBMETHOD="C" G DS70   ; skip down to the Sort questions
"RTN","IBCEDS",16,0)
DS20 D DIV I STOP G:$$STOP EX G DS10
"RTN","IBCEDS",17,0)
DS30 D PAYER I STOP G:$$STOP EX G DS20
"RTN","IBCEDS",18,0)
DS40 D TXDATE I STOP G:$$STOP EX G DS30
"RTN","IBCEDS",19,0)
DS50 D EDISTAT I STOP G:$$STOP EX G DS40
"RTN","IBCEDS",20,0)
DS60 D CANCEL I STOP G:$$STOP EX G DS50
"RTN","IBCEDS",21,0)
DS70 D SORT I STOP G:$$STOP EX G:IBMETHOD="C" DS10 G DS60
"RTN","IBCEDS",22,0)
DS80 D DEVICE I STOP G:$$STOP EX G DS70
"RTN","IBCEDS",23,0)
 ;
"RTN","IBCEDS",24,0)
EX ; exit point
"RTN","IBCEDS",25,0)
 Q
"RTN","IBCEDS",26,0)
 ;
"RTN","IBCEDS",27,0)
STOP() ; Determine if user wants to exit out of the whole option
"RTN","IBCEDS",28,0)
 ; 1=yes, get out entirely
"RTN","IBCEDS",29,0)
 ; 0=no, just go back to the previous question
"RTN","IBCEDS",30,0)
 N DIR,X,Y,DIRUT
"RTN","IBCEDS",31,0)
 ;
"RTN","IBCEDS",32,0)
 W !
"RTN","IBCEDS",33,0)
 S DIR(0)="Y"
"RTN","IBCEDS",34,0)
 S DIR("A")="Do you want to exit out of this option entirely"
"RTN","IBCEDS",35,0)
 S DIR("B")="YES"
"RTN","IBCEDS",36,0)
 S DIR("?",1)="  Enter YES to immediately exit out of this option."
"RTN","IBCEDS",37,0)
 S DIR("?")="  Enter NO to return to the previous question."
"RTN","IBCEDS",38,0)
 D ^DIR K DIR
"RTN","IBCEDS",39,0)
 I $D(DIRUT) S (STOP,Y)=1 G STOPX
"RTN","IBCEDS",40,0)
 I 'Y S STOP=0
"RTN","IBCEDS",41,0)
 ;
"RTN","IBCEDS",42,0)
STOPX ; STOP exit pt
"RTN","IBCEDS",43,0)
 Q Y
"RTN","IBCEDS",44,0)
 ;
"RTN","IBCEDS",45,0)
CLAIM ; enter in multiple claim#'s or generate a report
"RTN","IBCEDS",46,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,IBDONE,Z
"RTN","IBCEDS",47,0)
CLM1 ;
"RTN","IBCEDS",48,0)
 W !!,"CLAIM SELECTION METHOD"
"RTN","IBCEDS",49,0)
 K ^TMP($J,"IBCEDS","CLAIM") S IBMETHOD=""
"RTN","IBCEDS",50,0)
 S DIR(0)="SA^C:Select Specific Claims;R:Regular Selection Criteria"
"RTN","IBCEDS",51,0)
 S DIR("A")="Method to Select Claims: "
"RTN","IBCEDS",52,0)
 S DIR("B")="Regular Selection Criteria"
"RTN","IBCEDS",53,0)
 D ^DIR K DIR
"RTN","IBCEDS",54,0)
 I $D(DIRUT) S STOP=1 G CLAIMX
"RTN","IBCEDS",55,0)
 S IBMETHOD=Y
"RTN","IBCEDS",56,0)
 I IBMETHOD="R" K ^TMP($J,"IBCEDS","CLAIM") G CLAIMX   ; regular selection method
"RTN","IBCEDS",57,0)
 ;
"RTN","IBCEDS",58,0)
 ; select specific claims
"RTN","IBCEDS",59,0)
 ;
"RTN","IBCEDS",60,0)
 W !
"RTN","IBCEDS",61,0)
 S IBDONE=0
"RTN","IBCEDS",62,0)
 F  D  Q:IBDONE!STOP
"RTN","IBCEDS",63,0)
 . S DIR(0)="PAO^364:AEMQZ"
"RTN","IBCEDS",64,0)
 . S DIR("S")="I '$O(^IBA(364,""B"",+$G(^(0)),Y))"   ; prevent multiple 364 entries from listing
"RTN","IBCEDS",65,0)
 . S DIR("A")="   Select a Claim: "
"RTN","IBCEDS",66,0)
 . I $O(^TMP($J,"IBCEDS","CLAIM","")) S DIR("A")="   Select Another Claim: "
"RTN","IBCEDS",67,0)
 . D ^DIR K DIR
"RTN","IBCEDS",68,0)
 . I $D(DUOUT)!$D(DTOUT) S STOP=1 Q    ; up arrow or timeout
"RTN","IBCEDS",69,0)
 . I +Y'>0 S IBDONE=1 Q                ; null response
"RTN","IBCEDS",70,0)
 . S Z=$G(^IBA(364,+Y,0))
"RTN","IBCEDS",71,0)
 . I $P(Z,U,7) W *7,!!?3,"Test Claim Transmissions are not Allowed.",! Q
"RTN","IBCEDS",72,0)
 . I $P(Z,U,3)="X" W *7,!!?3,"This Claim is still in a READY FOR EXTRACT status.",! Q
"RTN","IBCEDS",73,0)
 . I '$P(Z,U,2) W *7,!!?3,"This Claim has no Batch#.",! Q
"RTN","IBCEDS",74,0)
 . I '$P(Z,U,1) W *7,!!?3,"This Claim is Corrupted.",! Q
"RTN","IBCEDS",75,0)
 . ;
"RTN","IBCEDS",76,0)
 . S ^TMP($J,"IBCEDS","CLAIM",+Z)=+Y
"RTN","IBCEDS",77,0)
 . Q
"RTN","IBCEDS",78,0)
 ;
"RTN","IBCEDS",79,0)
 I STOP G CLAIMX
"RTN","IBCEDS",80,0)
 ;
"RTN","IBCEDS",81,0)
 I '$O(^TMP($J,"IBCEDS","CLAIM","")) D  G CLM1
"RTN","IBCEDS",82,0)
 . W *7,!!?3,"No claims have been selected.  Please try again."
"RTN","IBCEDS",83,0)
 . Q
"RTN","IBCEDS",84,0)
 ;
"RTN","IBCEDS",85,0)
CLAIMX ;
"RTN","IBCEDS",86,0)
 Q
"RTN","IBCEDS",87,0)
 ;
"RTN","IBCEDS",88,0)
DIV ; division selection
"RTN","IBCEDS",89,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,IBDONE,DIC
"RTN","IBCEDS",90,0)
DV1 ;
"RTN","IBCEDS",91,0)
 K ^TMP($J,"IBCEDS","DIV")
"RTN","IBCEDS",92,0)
 W !!,"DIVISION SELECTION"
"RTN","IBCEDS",93,0)
 S DIR(0)="SA^A:All Divisions;S:Selected Divisions"
"RTN","IBCEDS",94,0)
 S DIR("A")="Include All Divisions or Selected Divisions? "
"RTN","IBCEDS",95,0)
 S DIR("B")="All Divisions"
"RTN","IBCEDS",96,0)
 D ^DIR K DIR
"RTN","IBCEDS",97,0)
 I $D(DIRUT) S STOP=1 G DIVX
"RTN","IBCEDS",98,0)
 I Y="A" K ^TMP($J,"IBCEDS","DIV") G DIVX
"RTN","IBCEDS",99,0)
 ;
"RTN","IBCEDS",100,0)
 W !
"RTN","IBCEDS",101,0)
 S IBDONE=0
"RTN","IBCEDS",102,0)
 F  D  Q:IBDONE!STOP
"RTN","IBCEDS",103,0)
 . S DIC=40.8,DIC(0)="AEMQ",DIC("A")="   Select Division: "
"RTN","IBCEDS",104,0)
 . I $O(^TMP($J,"IBCEDS","DIV","")) S DIC("A")="   Select Another Division: "
"RTN","IBCEDS",105,0)
 . D ^DIC K DIC                       ; lookup
"RTN","IBCEDS",106,0)
 . I $D(DUOUT)!$D(DTOUT) S STOP=1 Q   ; up arrow or timeout
"RTN","IBCEDS",107,0)
 . I +Y'>0 S IBDONE=1 Q               ; user is done
"RTN","IBCEDS",108,0)
 . S ^TMP($J,"IBCEDS","DIV",+Y)=$P(Y,U,2)
"RTN","IBCEDS",109,0)
 . Q
"RTN","IBCEDS",110,0)
 ;
"RTN","IBCEDS",111,0)
 I STOP G DIVX
"RTN","IBCEDS",112,0)
 ;
"RTN","IBCEDS",113,0)
 I '$O(^TMP($J,"IBCEDS","DIV","")) D  G DV1
"RTN","IBCEDS",114,0)
 . W *7,!!?3,"No divisions have been selected.  Please try again."
"RTN","IBCEDS",115,0)
 . Q
"RTN","IBCEDS",116,0)
 ;
"RTN","IBCEDS",117,0)
DIVX ;
"RTN","IBCEDS",118,0)
 Q
"RTN","IBCEDS",119,0)
 ;
"RTN","IBCEDS",120,0)
PAYER ; payer selection
"RTN","IBCEDS",121,0)
 NEW IBPAYER,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,IBDONE,DIC,EDI,PROF,INST
"RTN","IBCEDS",122,0)
PY1 ;
"RTN","IBCEDS",123,0)
 K ^TMP($J,"IBCEDS","INS")
"RTN","IBCEDS",124,0)
 W !!,"PAYER SELECTION"
"RTN","IBCEDS",125,0)
 S IBPAYER=""
"RTN","IBCEDS",126,0)
 S DIR(0)="SA^A:All Payers;S:Selected Payers"
"RTN","IBCEDS",127,0)
 S DIR("A")="Include All Payers or Selected Payers? "
"RTN","IBCEDS",128,0)
 S DIR("B")="All Payers"
"RTN","IBCEDS",129,0)
 D ^DIR K DIR
"RTN","IBCEDS",130,0)
 I $D(DIRUT) S STOP=1 G PAYERX
"RTN","IBCEDS",131,0)
 I Y="A" K ^TMP($J,"IBCEDS","INS") G PAYERX
"RTN","IBCEDS",132,0)
 W !
"RTN","IBCEDS",133,0)
 S DIR(0)="Y"
"RTN","IBCEDS",134,0)
 S DIR("A")="   Include all payers with the same electronic Payer ID"
"RTN","IBCEDS",135,0)
 S DIR("B")="Yes"
"RTN","IBCEDS",136,0)
 D ^DIR K DIR
"RTN","IBCEDS",137,0)
 I $D(DIRUT) S STOP=1 G PAYERX
"RTN","IBCEDS",138,0)
 S IBPAYER=Y
"RTN","IBCEDS",139,0)
 W !
"RTN","IBCEDS",140,0)
 ;
"RTN","IBCEDS",141,0)
 S IBDONE=0
"RTN","IBCEDS",142,0)
 F  D  Q:IBDONE!STOP
"RTN","IBCEDS",143,0)
 . S DIC=36,DIC(0)="AEMQ",DIC("A")="   Select Insurance Company: "
"RTN","IBCEDS",144,0)
 . I $O(^TMP($J,"IBCEDS","INS",1,"")) S DIC("A")="   Select Another Insurance Company: "
"RTN","IBCEDS",145,0)
 . S DIC("W")="D INSLIST^IBCEMCA(Y)"
"RTN","IBCEDS",146,0)
 . D ^DIC K DIC                       ; lookup
"RTN","IBCEDS",147,0)
 . I $D(DUOUT)!$D(DTOUT) S STOP=1 Q   ; up arrow or timeout
"RTN","IBCEDS",148,0)
 . I +Y'>0 S IBDONE=1 Q               ; user is done
"RTN","IBCEDS",149,0)
 . S ^TMP($J,"IBCEDS","INS",1,+Y)=$P(Y,U,2)
"RTN","IBCEDS",150,0)
 . I 'IBPAYER Q
"RTN","IBCEDS",151,0)
 . S EDI=$$UP^XLFSTR($G(^DIC(36,+Y,3)))
"RTN","IBCEDS",152,0)
 . S PROF=$P(EDI,U,2)
"RTN","IBCEDS",153,0)
 . S INST=$P(EDI,U,4)
"RTN","IBCEDS",154,0)
 . I PROF'="",PROF'["PRNT" S ^TMP($J,"IBCEDS","INS",2,PROF,+Y)=""
"RTN","IBCEDS",155,0)
 . I INST'="",INST'["PRNT" S ^TMP($J,"IBCEDS","INS",2,INST,+Y)=""
"RTN","IBCEDS",156,0)
 . Q
"RTN","IBCEDS",157,0)
 ;
"RTN","IBCEDS",158,0)
 I STOP G PAYERX
"RTN","IBCEDS",159,0)
 ;
"RTN","IBCEDS",160,0)
 I '$O(^TMP($J,"IBCEDS","INS",1,"")) D  G PY1
"RTN","IBCEDS",161,0)
 . W *7,!!?3,"No payers have been selected.  Please try again."
"RTN","IBCEDS",162,0)
 . Q
"RTN","IBCEDS",163,0)
 ;
"RTN","IBCEDS",164,0)
PAYERX ;
"RTN","IBCEDS",165,0)
 Q
"RTN","IBCEDS",166,0)
 ;
"RTN","IBCEDS",167,0)
TXDATE ; date range for the last transmission date
"RTN","IBCEDS",168,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,TDEF
"RTN","IBCEDS",169,0)
 K ^TMP($J,"IBCEDS","ALTDT")
"RTN","IBCEDS",170,0)
 W !!,"LAST TRANSMIT DATE RANGE SELECTION"
"RTN","IBCEDS",171,0)
 S DIR(0)="DAO^:"_DT_":AEX"
"RTN","IBCEDS",172,0)
 S DIR("A")="   Start with Date Last Transmitted: "
"RTN","IBCEDS",173,0)
 S DIR("B")=$$FMTE^XLFDT($$FMADD^XLFDT(DT,-14),"5Z")
"RTN","IBCEDS",174,0)
 D ^DIR K DIR
"RTN","IBCEDS",175,0)
 I $D(DIRUT)!'Y S STOP=1 G TXDATEX
"RTN","IBCEDS",176,0)
 S $P(^TMP($J,"IBCEDS","ALTDT"),U,1)=Y
"RTN","IBCEDS",177,0)
 ;
"RTN","IBCEDS",178,0)
 S DIR(0)="DAO^"_Y_":"_DT_":AEX"
"RTN","IBCEDS",179,0)
 S DIR("A")="   Go to Date Last Transmitted: "
"RTN","IBCEDS",180,0)
 S TDEF=$$FMADD^XLFDT(DT,-7)       ; normal to date default
"RTN","IBCEDS",181,0)
 I TDEF'>Y S TDEF=DT               ; if to date default is on or before from date, set default=today
"RTN","IBCEDS",182,0)
 S DIR("B")=$$FMTE^XLFDT(TDEF,"5Z")
"RTN","IBCEDS",183,0)
 D ^DIR K DIR
"RTN","IBCEDS",184,0)
 I $D(DIRUT)!'Y S STOP=1 G TXDATEX
"RTN","IBCEDS",185,0)
 S $P(^TMP($J,"IBCEDS","ALTDT"),U,2)=Y
"RTN","IBCEDS",186,0)
TXDATEX ;
"RTN","IBCEDS",187,0)
 Q
"RTN","IBCEDS",188,0)
 ;
"RTN","IBCEDS",189,0)
EDISTAT ; selection of one or all of the EDI claim statuses
"RTN","IBCEDS",190,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,IBDONE,EDILST
"RTN","IBCEDS",191,0)
EDI1 ;
"RTN","IBCEDS",192,0)
 W !!,"EDI CLAIM STATUS SELECTION"
"RTN","IBCEDS",193,0)
 K ^TMP($J,"IBCEDS","EDI")
"RTN","IBCEDS",194,0)
 S DIR(0)="SA^A:All EDI Statuses;S:Selected EDI Statuses"
"RTN","IBCEDS",195,0)
 S DIR("A")="Include All EDI Statuses or Selected EDI Statuses? "
"RTN","IBCEDS",196,0)
 S DIR("B")="Selected EDI Statuses"
"RTN","IBCEDS",197,0)
 D ^DIR K DIR
"RTN","IBCEDS",198,0)
 I $D(DIRUT) S STOP=1 G EDISTATX
"RTN","IBCEDS",199,0)
 I Y="A" K ^TMP($J,"IBCEDS","EDI") G EDISTATX
"RTN","IBCEDS",200,0)
 ;
"RTN","IBCEDS",201,0)
 W !
"RTN","IBCEDS",202,0)
 K EDILST D FIELD^DID(364,.03,,"POINTER","EDILST")
"RTN","IBCEDS",203,0)
 S IBDONE=0
"RTN","IBCEDS",204,0)
 F  D  Q:IBDONE!STOP
"RTN","IBCEDS",205,0)
 . S DIR(0)="364,.03AO"
"RTN","IBCEDS",206,0)
 . I $G(EDILST("POINTER"))'="" S DIR(0)="SAO^"_EDILST("POINTER")
"RTN","IBCEDS",207,0)
 . S DIR("A")="   Select Status: "
"RTN","IBCEDS",208,0)
 . I $O(^TMP($J,"IBCEDS","EDI",""))'="" S DIR("A")="   Select Another Status: "
"RTN","IBCEDS",209,0)
 . I $O(^TMP($J,"IBCEDS","EDI",""))="" S DIR("B")="RECEIVED IN AUSTIN"
"RTN","IBCEDS",210,0)
 . D ^DIR K DIR
"RTN","IBCEDS",211,0)
 . I $D(DUOUT)!$D(DTOUT) S STOP=1 Q   ; up arrow or timeout
"RTN","IBCEDS",212,0)
 . I Y="" S IBDONE=1 Q
"RTN","IBCEDS",213,0)
 . S ^TMP($J,"IBCEDS","EDI",Y)=$G(Y(0))
"RTN","IBCEDS",214,0)
 . Q
"RTN","IBCEDS",215,0)
 ;
"RTN","IBCEDS",216,0)
 I STOP G EDISTATX
"RTN","IBCEDS",217,0)
 ;
"RTN","IBCEDS",218,0)
 I $O(^TMP($J,"IBCEDS","EDI",""))="" D  G EDI1
"RTN","IBCEDS",219,0)
 . W *7,!!?3,"No EDI statuses have been selected.  Please try again."
"RTN","IBCEDS",220,0)
 . Q
"RTN","IBCEDS",221,0)
 ;
"RTN","IBCEDS",222,0)
EDISTATX ;
"RTN","IBCEDS",223,0)
 Q
"RTN","IBCEDS",224,0)
 ;
"RTN","IBCEDS",225,0)
CANCEL ; Include cancelled claims?
"RTN","IBCEDS",226,0)
 W !!,"CANCELLED CLAIM SELECTION"
"RTN","IBCEDS",227,0)
 K ^TMP($J,"IBCEDS","CANCEL")
"RTN","IBCEDS",228,0)
 S DIR(0)="Y"
"RTN","IBCEDS",229,0)
 S DIR("A")="Include Cancelled Claims"
"RTN","IBCEDS",230,0)
 S DIR("B")="YES"
"RTN","IBCEDS",231,0)
 S DIR("?",1)="  Enter No to omit claims that have been cancelled in IB and/or AR."
"RTN","IBCEDS",232,0)
 S DIR("?")="  Enter Yes to include claims that have been cancelled in IB and/or AR."
"RTN","IBCEDS",233,0)
 D ^DIR K DIR
"RTN","IBCEDS",234,0)
 I $D(DIRUT) S STOP=1 G CANCELX
"RTN","IBCEDS",235,0)
 S ^TMP($J,"IBCEDS","CANCEL")=Y
"RTN","IBCEDS",236,0)
CANCELX ;
"RTN","IBCEDS",237,0)
 Q
"RTN","IBCEDS",238,0)
 ;
"RTN","IBCEDS",239,0)
SORT ; Gather the primary, secondary, and tert sorts
"RTN","IBCEDS",240,0)
 W @IOF
"RTN","IBCEDS",241,0)
 W !!,"SORT CRITERIA"
"RTN","IBCEDS",242,0)
 K IBSORTOR
"RTN","IBCEDS",243,0)
 D SORTSEL^IBCEDS1(1) I STOP G SORTX
"RTN","IBCEDS",244,0)
 D SORTSEL^IBCEDS1(2) I STOP G SORTX
"RTN","IBCEDS",245,0)
 I $G(IBSORT2)'="" D SORTSEL^IBCEDS1(3) I STOP G SORTX
"RTN","IBCEDS",246,0)
SORTX ;
"RTN","IBCEDS",247,0)
 Q
"RTN","IBCEDS",248,0)
 ;
"RTN","IBCEDS",249,0)
DEVICE ; Device selection
"RTN","IBCEDS",250,0)
 NEW ZTRTN,ZTDESC,ZTSAVE,POP
"RTN","IBCEDS",251,0)
 W !!!,"This report is 132 characters wide.  Please choose an appropriate device.",!
"RTN","IBCEDS",252,0)
 S ZTRTN="EN^IBCEDC"
"RTN","IBCEDS",253,0)
 S ZTDESC="COMPILE/PRINT EDI CLAIM STATUS DETAIL REPORT"
"RTN","IBCEDS",254,0)
 S ZTSAVE("IBMETHOD")=""
"RTN","IBCEDS",255,0)
 S ZTSAVE("IBSORT1")=""
"RTN","IBCEDS",256,0)
 S ZTSAVE("IBSORT2")=""
"RTN","IBCEDS",257,0)
 S ZTSAVE("IBSORT3")=""
"RTN","IBCEDS",258,0)
 S ZTSAVE("IBSORTOR")=""
"RTN","IBCEDS",259,0)
 S ZTSAVE("^TMP($J,""IBCEDS"",")=""
"RTN","IBCEDS",260,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE,"QM")
"RTN","IBCEDS",261,0)
 I POP S STOP=1
"RTN","IBCEDS",262,0)
DEVICEX ;
"RTN","IBCEDS",263,0)
 Q
"RTN","IBCEDS",264,0)
 ;
"RTN","IBCEDS1")
0^14^B30639639^n/a
"RTN","IBCEDS1",1,0)
IBCEDS1 ;ALB/ESG - EDI CLAIM STATUS REPORT - SELECTION CONT ;13-DEC-2007
"RTN","IBCEDS1",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCEDS1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEDS1",4,0)
 ;
"RTN","IBCEDS1",5,0)
 Q
"RTN","IBCEDS1",6,0)
 ;
"RTN","IBCEDS1",7,0)
SORTSEL(LVL) ; sort selection criteria
"RTN","IBCEDS1",8,0)
 ; LVL - sort level 1, 2, or 3
"RTN","IBCEDS1",9,0)
 ;
"RTN","IBCEDS1",10,0)
 NEW DIR,X,Y,LVLD,G,LN,S,SC,SCP,DTOUT,DUOUT,DIRUT,DIROUT,IBZ
"RTN","IBCEDS1",11,0)
 K IBSORT3 I LVL<3 K IBSORT2 I LVL=1 K IBSORT1
"RTN","IBCEDS1",12,0)
 I '$F(".1.2.3.","."_$G(LVL)_".") G SORTSELX
"RTN","IBCEDS1",13,0)
 I STOP G SORTSELX
"RTN","IBCEDS1",14,0)
 ;
"RTN","IBCEDS1",15,0)
 I LVL>1,$G(IBSORT1)="" D SORTSEL(1) I $G(IBSORT1)="" G SORTSELX
"RTN","IBCEDS1",16,0)
 I LVL=3,$G(IBSORT2)="" D SORTSEL(2) I $G(IBSORT2)="" G SORTSELX
"RTN","IBCEDS1",17,0)
 ;
"RTN","IBCEDS1",18,0)
 S LVLD=$S(LVL=2:"Secondary",LVL=3:"Tertiary",1:"Primary")
"RTN","IBCEDS1",19,0)
 ;
"RTN","IBCEDS1",20,0)
 S DIR("A")=LVLD_" Sort"
"RTN","IBCEDS1",21,0)
 I LVL=1 S DIR("B")=$$SD("1")
"RTN","IBCEDS1",22,0)
 I LVL>1 K DIR("B")
"RTN","IBCEDS1",23,0)
 ;
"RTN","IBCEDS1",24,0)
 S DIR("?")="Enter a code from the list to indicate the "_LVLD_" sort order."
"RTN","IBCEDS1",25,0)
 I LVL>1 S DIR("?",1)="  Primary Sort is "_$$SD($G(IBSORT1)),DIR("?",LVL)=""
"RTN","IBCEDS1",26,0)
 I LVL=3 S DIR("?",2)="Secondary Sort is "_$$SD($G(IBSORT2))
"RTN","IBCEDS1",27,0)
 ;
"RTN","IBCEDS1",28,0)
 I LVL=1 S DIR(0)="SB"    ; primary sort required
"RTN","IBCEDS1",29,0)
 I LVL>1 S DIR(0)="SOB"   ; optional sorts
"RTN","IBCEDS1",30,0)
 ;
"RTN","IBCEDS1",31,0)
 S G=""
"RTN","IBCEDS1",32,0)
 F LN=1:1 S S=$P($T(ZZ+LN),";",3) Q:S=""  D
"RTN","IBCEDS1",33,0)
 . S SC=$P(S,":",1)     ; sort code
"RTN","IBCEDS1",34,0)
 . I LVL=2,IBSORT1=SC Q
"RTN","IBCEDS1",35,0)
 . I LVL=3,IBSORT1=SC!(IBSORT2=SC) Q
"RTN","IBCEDS1",36,0)
 . S SCP=$P(S,":",1,2)  ; sort code:desc pair
"RTN","IBCEDS1",37,0)
 . S G=$S(G="":SCP,1:G_";"_SCP)
"RTN","IBCEDS1",38,0)
 . Q
"RTN","IBCEDS1",39,0)
 ;
"RTN","IBCEDS1",40,0)
 S $P(DIR(0),U,2)=G
"RTN","IBCEDS1",41,0)
 ;
"RTN","IBCEDS1",42,0)
 D ^DIR K DIR
"RTN","IBCEDS1",43,0)
 I $D(DTOUT)!$D(DUOUT) S STOP=1 G SORTSELX     ; timeout or up arrow
"RTN","IBCEDS1",44,0)
 I Y="" G SORTSELX                             ; null response
"RTN","IBCEDS1",45,0)
 S @("IBSORT"_LVL)=Y,IBZ=Y
"RTN","IBCEDS1",46,0)
 ;
"RTN","IBCEDS1",47,0)
 I IBZ="4" D  G SORTSELX    ; current balance question
"RTN","IBCEDS1",48,0)
 . S DIR(0)="Y"
"RTN","IBCEDS1",49,0)
 . S DIR("A")="Display Highest Balances First",DIR("B")="Yes"
"RTN","IBCEDS1",50,0)
 . S DIR("A",1)=""
"RTN","IBCEDS1",51,0)
 . S DIR("?",1)="Enter Yes or No."
"RTN","IBCEDS1",52,0)
 . S DIR("?",2)=""
"RTN","IBCEDS1",53,0)
 . S DIR("?",3)="Yes, I want to see the large balances first at the top of the list and the"
"RTN","IBCEDS1",54,0)
 . S DIR("?",4)="small balances last at the bottom of the list."
"RTN","IBCEDS1",55,0)
 . S DIR("?",5)=""
"RTN","IBCEDS1",56,0)
 . S DIR("?",6)="No, I want to see the small balances first at the top of the list and the"
"RTN","IBCEDS1",57,0)
 . S DIR("?")="large balances last at the bottom of the list."
"RTN","IBCEDS1",58,0)
 . D ^DIR K DIR
"RTN","IBCEDS1",59,0)
 . I $D(DTOUT) S STOP=1 Q    ; timeout
"RTN","IBCEDS1",60,0)
 . I $D(DIRUT) S:LVL=1 STOP=1 K @("IBSORT"_LVL) Q   ; ^ or nil resp
"RTN","IBCEDS1",61,0)
 . I Y S IBSORTOR(IBZ)="D"    ; yes, large first, descending
"RTN","IBCEDS1",62,0)
 . I 'Y S IBSORTOR(IBZ)="A"   ; no, small first, ascending
"RTN","IBCEDS1",63,0)
 . Q
"RTN","IBCEDS1",64,0)
 ;
"RTN","IBCEDS1",65,0)
 I IBZ="1" D  G SORTSELX    ; Last Transmitted Date Question
"RTN","IBCEDS1",66,0)
 . S DIR(0)="Y"
"RTN","IBCEDS1",67,0)
 . S DIR("A")="Display Oldest EDI Claims First",DIR("B")="Yes"
"RTN","IBCEDS1",68,0)
 . S DIR("A",1)=""
"RTN","IBCEDS1",69,0)
 . S DIR("?",1)="Enter Yes to display claims with oldest transmission dates first."
"RTN","IBCEDS1",70,0)
 . S DIR("?")="Enter No to display claims with recent transmission dates first."
"RTN","IBCEDS1",71,0)
 . D ^DIR K DIR
"RTN","IBCEDS1",72,0)
 . I $D(DTOUT) S STOP=1 Q    ; timeout
"RTN","IBCEDS1",73,0)
 . I $D(DIRUT) S:LVL=1 STOP=1 K @("IBSORT"_LVL) Q   ; ^ or nil resp
"RTN","IBCEDS1",74,0)
 . I Y S IBSORTOR(IBZ)="A"    ; yes, old first, ascending sort
"RTN","IBCEDS1",75,0)
 . I 'Y S IBSORTOR(IBZ)="D"   ; no, new first, descending sort
"RTN","IBCEDS1",76,0)
 . Q
"RTN","IBCEDS1",77,0)
 ;
"RTN","IBCEDS1",78,0)
 I IBZ="8" D  G SORTSELX    ; Age Question
"RTN","IBCEDS1",79,0)
 . S DIR(0)="Y"
"RTN","IBCEDS1",80,0)
 . S DIR("A")="Display Oldest EDI Claims First",DIR("B")="Yes"
"RTN","IBCEDS1",81,0)
 . S DIR("A",1)=""
"RTN","IBCEDS1",82,0)
 . S DIR("?",1)="Enter Yes or No."
"RTN","IBCEDS1",83,0)
 . S DIR("?",2)=""
"RTN","IBCEDS1",84,0)
 . S DIR("?",3)="Yes, I want to see old EDI claims first at the top of the list and newer"
"RTN","IBCEDS1",85,0)
 . S DIR("?",4)="EDI claims last at the bottom of the list."
"RTN","IBCEDS1",86,0)
 . S DIR("?",5)=""
"RTN","IBCEDS1",87,0)
 . S DIR("?",6)="No, I want to see new EDI claims first at the top of the list and older"
"RTN","IBCEDS1",88,0)
 . S DIR("?",7)="EDI claims last at the bottom of the list."
"RTN","IBCEDS1",89,0)
 . S DIR("?",8)=""
"RTN","IBCEDS1",90,0)
 . S DIR("?",9)="Note:"
"RTN","IBCEDS1",91,0)
 . S DIR("?",10)="For MRA request claims, AGE is calculated as the number of days from the MRA"
"RTN","IBCEDS1",92,0)
 . S DIR("?",11)="request date through today's date."
"RTN","IBCEDS1",93,0)
 . S DIR("?",12)=""
"RTN","IBCEDS1",94,0)
 . S DIR("?",13)="For all other claims, AGE is calculated as the number of days from the"
"RTN","IBCEDS1",95,0)
 . S DIR("?")="Authorization date through today's date."
"RTN","IBCEDS1",96,0)
 . D ^DIR K DIR
"RTN","IBCEDS1",97,0)
 . I $D(DTOUT) S STOP=1 Q    ; timeout
"RTN","IBCEDS1",98,0)
 . I $D(DIRUT) S:LVL=1 STOP=1 K @("IBSORT"_LVL) Q   ; ^ or nil resp
"RTN","IBCEDS1",99,0)
 . I Y S IBSORTOR(IBZ)="D"    ; yes, old first, high age#'s first, descending
"RTN","IBCEDS1",100,0)
 . I 'Y S IBSORTOR(IBZ)="A"   ; no, new first, low age#'s first, ascending
"RTN","IBCEDS1",101,0)
 . Q
"RTN","IBCEDS1",102,0)
 ;
"RTN","IBCEDS1",103,0)
SORTSELX ;
"RTN","IBCEDS1",104,0)
 Q
"RTN","IBCEDS1",105,0)
 ;
"RTN","IBCEDS1",106,0)
SD(SORT) ; sort description given the sort code
"RTN","IBCEDS1",107,0)
 Q $P($P($T(@("ZZ"_$G(SORT))),";",3),":",2)
"RTN","IBCEDS1",108,0)
 ;
"RTN","IBCEDS1",109,0)
SV(SORT,DEF) ; sort value given the sort code
"RTN","IBCEDS1",110,0)
 ; SORT - sort code
"RTN","IBCEDS1",111,0)
 ;  DEF - default value if the sort code is nil (must be non-nil)
"RTN","IBCEDS1",112,0)
 ;
"RTN","IBCEDS1",113,0)
 NEW S,VAR,VALUE
"RTN","IBCEDS1",114,0)
 I $G(SORT)="" S VALUE=DEF G SVX
"RTN","IBCEDS1",115,0)
 S S=$P($T(@("ZZ"_$G(SORT))),";",3)
"RTN","IBCEDS1",116,0)
 S VAR=$P(S,":",4)   ; variable name
"RTN","IBCEDS1",117,0)
 S VALUE=$G(@VAR)    ; value of variable
"RTN","IBCEDS1",118,0)
 I VALUE="" S VALUE="~" G SVX    ; get out if undefined
"RTN","IBCEDS1",119,0)
 I '$P(S,":",3) G SVX            ; non-numeric
"RTN","IBCEDS1",120,0)
 I $G(IBSORTOR(SORT))="D" S VALUE=-VALUE   ; descending sort
"RTN","IBCEDS1",121,0)
SVX Q VALUE
"RTN","IBCEDS1",122,0)
 ;
"RTN","IBCEDS1",123,0)
 ;
"RTN","IBCEDS1",124,0)
ZZ ; List of allowable sort criteria
"RTN","IBCEDS1",125,0)
ZZ1 ;;1:Last Transmitted Date:1:IBLTRDT;
"RTN","IBCEDS1",126,0)
ZZ2 ;;2:Payer:0:IBPAY;
"RTN","IBCEDS1",127,0)
ZZ3 ;;3:EDI Claim Status:0:IBEDIST;
"RTN","IBCEDS1",128,0)
ZZ4 ;;4:Current Balance:1:IBCURBAL;
"RTN","IBCEDS1",129,0)
ZZ5 ;;5:Division:0:IBDIV;
"RTN","IBCEDS1",130,0)
ZZ6 ;;6:Claim Number:0:IBEXTCLM;
"RTN","IBCEDS1",131,0)
ZZ7 ;;7:AR Status:0:IBARSTAT;
"RTN","IBCEDS1",132,0)
ZZ8 ;;8:Age:1:IBAGE;
"RTN","IBCEDS1",133,0)
 ;
"RTN","IBCEF73")
0^11^B59655554^B54498448
"RTN","IBCEF73",1,0)
IBCEF73 ;WOIFO/SS - FORMATTER AND EXTRACTOR SPECIFIC BILL FUNCTIONS ;8/6/03 10:56am
"RTN","IBCEF73",2,0)
 ;;2.0;INTEGRATED BILLING;**232,320,358,349,377**;21-MAR-94;Build 23
"RTN","IBCEF73",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEF73",4,0)
 ;
"RTN","IBCEF73",5,0)
 ;check qualifier
"RTN","IBCEF73",6,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",7,0)
 ;IBPROV - function in #399 (1-referring, 2-operating,etc)
"RTN","IBCEF73",8,0)
 ;IBTYPE - "C"-current insurance, "O"-other insurance
"RTN","IBCEF73",9,0)
 ;IBVAL - value to check
"RTN","IBCEF73",10,0)
CHCKSEC(IBFRM,IBPROV,IBTYPE,IBVAL) ;
"RTN","IBCEF73",11,0)
 I IBFRM=0 Q:$$CHSEC(1,IBPROV,IBTYPE,IBVAL) 1  Q $$CHSEC(2,IBPROV,IBTYPE,IBVAL)
"RTN","IBCEF73",12,0)
 Q $$CHSEC(IBFRM,IBPROV,IBTYPE,IBVAL)
"RTN","IBCEF73",13,0)
 ;
"RTN","IBCEF73",14,0)
CHSEC(IBFRM,IBPROV,IBTYPE,IBVAL) ;
"RTN","IBCEF73",15,0)
 N IBSTR S IBSTR=""
"RTN","IBCEF73",16,0)
 ;referring
"RTN","IBCEF73",17,0)
 I IBPROV=1 S IBSTR=$S(IBTYPE="C":$$OPR5(IBFRM),IBTYPE="O":$$OP4(IBFRM),1:"")
"RTN","IBCEF73",18,0)
 ;operating
"RTN","IBCEF73",19,0)
 I IBPROV=2 S IBSTR=$S(IBTYPE="C":$$OPR3(IBFRM),IBTYPE="O":$$OP2(IBFRM),1:"")
"RTN","IBCEF73",20,0)
 ;rendering
"RTN","IBCEF73",21,0)
 I IBPROV=3 S IBSTR=$S(IBTYPE="C":$$OPR2(IBFRM),IBTYPE="O":$$OP1(IBFRM),1:"")
"RTN","IBCEF73",22,0)
 ;attending
"RTN","IBCEF73",23,0)
 I IBPROV=4 S IBSTR=$S(IBTYPE="C":$$OPR2(IBFRM),IBTYPE="O":$$OP1(IBFRM),1:"")
"RTN","IBCEF73",24,0)
 ;supervising
"RTN","IBCEF73",25,0)
 I IBPROV=5 S IBSTR=$S(IBTYPE="C":$$OPR8(IBFRM),IBTYPE="O":$$OP8(IBFRM),1:"")
"RTN","IBCEF73",26,0)
 ;other
"RTN","IBCEF73",27,0)
 I IBPROV=9 S IBSTR=$S(IBTYPE="C":$$OPR4(IBFRM),IBTYPE="O":$$OP9(IBFRM),1:"")
"RTN","IBCEF73",28,0)
 Q:IBPROV=0!(IBSTR="") 1  ;if "" or facility id always return 1
"RTN","IBCEF73",29,0)
 Q IBSTR[("^"_IBVAL_"^")
"RTN","IBCEF73",30,0)
 ;
"RTN","IBCEF73",31,0)
 ;Filter invalid qualifier entries for records SUB1,SUB2,OP6,OP7,OP3
"RTN","IBCEF73",32,0)
 ; Rebuild the IBXSAVE("PROVINF" or IBXSAVE("PROVINF_FAC" array with
"RTN","IBCEF73",33,0)
 ;  only ids that have valid qualifiers
"RTN","IBCEF73",34,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",35,0)
 ;IBREC record ID whose ids are being filtered (SUB1,SUB2,etc)
"RTN","IBCEF73",36,0)
 ;IBFAC - 1 if facility check, 0 if attending/rendering check
"RTN","IBCEF73",37,0)
 ;IBTYPE - "C"-current insurance, "O"-other insurance
"RTN","IBCEF73",38,0)
 ;IBXSAVE - the array of provider ids extracted, returned filtered -
"RTN","IBCEF73",39,0)
 ;   passed by reference
"RTN","IBCEF73",40,0)
CHCKSUB(IBFRM,IBREC,IBFAC,IBTYPE,IBXSAVE) ;
"RTN","IBCEF73",41,0)
 N Z,Z0,Z1,Z2,CT,IBSAVE
"RTN","IBCEF73",42,0)
 S Z="PROVINF"_$P("^_FAC",U,$G(IBFAC)+1)
"RTN","IBCEF73",43,0)
 I '$G(IBXSAVE(Z,IBXIEN)) D
"RTN","IBCEF73",44,0)
 . D F^IBCEF("N-ALL "_$S($G(IBFAC):"OUTSIDE FAC PROVIDER INF",1:"CUR/OTH PROVIDER INFO"))
"RTN","IBCEF73",45,0)
 M IBSAVE(Z,IBXIEN,IBTYPE)=IBXSAVE(Z,IBXIEN,IBTYPE) K IBXSAVE(Z,IBXIEN,IBTYPE)
"RTN","IBCEF73",46,0)
 S Z0=0 F  S Z0=$O(IBSAVE(Z,IBXIEN,IBTYPE,Z0)) Q:'Z0  S Z1="" F  S Z1=$O(IBSAVE(Z,IBXIEN,IBTYPE,Z0,Z1)) Q:Z1=""  S (Z2,CT)=0 F  S Z2=$O(IBSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,Z2)) Q:'Z2  D
"RTN","IBCEF73",47,0)
 . N IBVAL
"RTN","IBCEF73",48,0)
 . S IBVAL=$P(IBSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,Z2),U,3)
"RTN","IBCEF73",49,0)
 . I IBFRM=0 D  Q
"RTN","IBCEF73",50,0)
 .. I $S($$CHSUB(1,IBREC,IBVAL):1,1:$$CHSUB(2,IBPROV,IBTYPE,IBVAL)) D
"RTN","IBCEF73",51,0)
 ... S CT=CT+1,IBXSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,CT)=IBSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,Z2)
"RTN","IBCEF73",52,0)
 ... I $G(IBXSAVE(Z,IBXIEN,IBTYPE,Z0))="",$G(IBSAVE(Z,IBXIEN,IBTYPE,Z0))'="" S IBXSAVE(Z,IBXIEN,IBTYPE,Z0)=IBSAVE(Z,IBXIEN,IBTYPE,Z0)
"RTN","IBCEF73",53,0)
 . I $$CHSUB(IBFRM,IBREC,IBVAL) D
"RTN","IBCEF73",54,0)
 .. S CT=CT+1,IBXSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,CT)=IBSAVE(Z,IBXIEN,IBTYPE,Z0,Z1,Z2)
"RTN","IBCEF73",55,0)
 .. I $G(IBXSAVE(Z,IBXIEN,IBTYPE,Z0))="",$G(IBSAVE(Z,IBXIEN,IBTYPE,Z0))'="" S IBXSAVE(Z,IBXIEN,IBTYPE,Z0)=IBSAVE(Z,IBXIEN,IBTYPE,Z0)
"RTN","IBCEF73",56,0)
 Q
"RTN","IBCEF73",57,0)
 ;
"RTN","IBCEF73",58,0)
 ; Check if valid qualifier
"RTN","IBCEF73",59,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",60,0)
 ;IBREC record ID whose ids are being filtered (SUB1,SUB2,etc)
"RTN","IBCEF73",61,0)
 ;IBVAL - value to check
"RTN","IBCEF73",62,0)
CHSUB(IBFRM,IBREC,IBVAL) ;
"RTN","IBCEF73",63,0)
 N IBSTR
"RTN","IBCEF73",64,0)
 I IBREC="SUB1" S IBSTR=$$SUB1(IBFRM)
"RTN","IBCEF73",65,0)
 I IBREC="SUB2" S IBSTR=$$SUB2(IBFRM)
"RTN","IBCEF73",66,0)
 I IBREC="OP7" S IBSTR=$$OP7(IBFRM)
"RTN","IBCEF73",67,0)
 I IBREC="OP3" S IBSTR=$$OP3(IBFRM)
"RTN","IBCEF73",68,0)
 I IBREC="OP6" S IBSTR=$$OP6(IBFRM)
"RTN","IBCEF73",69,0)
 Q:$G(IBSTR)="" 1  ;if "" always return 1
"RTN","IBCEF73",70,0)
 Q IBSTR[("^"_IBVAL_"^")
"RTN","IBCEF73",71,0)
 ;
"RTN","IBCEF73",72,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",73,0)
OPR2(IBFRM) ;
"RTN","IBCEF73",74,0)
 Q:IBFRM=1 "^0B^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",75,0)
 Q:IBFRM=2 "^0B^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",76,0)
 Q ""
"RTN","IBCEF73",77,0)
 ;
"RTN","IBCEF73",78,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",79,0)
OP1(IBFRM) ;
"RTN","IBCEF73",80,0)
 Q:IBFRM=1 "^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^"
"RTN","IBCEF73",81,0)
 Q:IBFRM=2 "^1B^1C^1D^EI^G2^LU^N5^"
"RTN","IBCEF73",82,0)
 Q ""
"RTN","IBCEF73",83,0)
 ;
"RTN","IBCEF73",84,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",85,0)
OPR3(IBFRM) ;
"RTN","IBCEF73",86,0)
 Q:IBFRM=1 "^0B^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",87,0)
 Q ""
"RTN","IBCEF73",88,0)
 ;
"RTN","IBCEF73",89,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",90,0)
OP2(IBFRM) ;
"RTN","IBCEF73",91,0)
 Q:IBFRM=1 "^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^"
"RTN","IBCEF73",92,0)
 Q ""
"RTN","IBCEF73",93,0)
 ;
"RTN","IBCEF73",94,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",95,0)
SUB1(IBFRM) ;
"RTN","IBCEF73",96,0)
 Q:IBFRM=1 "^0B^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",97,0)
 Q:IBFRM=2 "^0B^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^U3^SY^X5^"
"RTN","IBCEF73",98,0)
 Q ""
"RTN","IBCEF73",99,0)
 ;
"RTN","IBCEF73",100,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",101,0)
OPR4(IBFRM) ;
"RTN","IBCEF73",102,0)
 Q:IBFRM=1 "^0B^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",103,0)
 Q ""
"RTN","IBCEF73",104,0)
 ;
"RTN","IBCEF73",105,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",106,0)
OP9(IBFRM) ;
"RTN","IBCEF73",107,0)
 Q:IBFRM=1 "^1A^1B^1C^1D^1G^1H^EI^G2^LU^N5^"
"RTN","IBCEF73",108,0)
 Q ""
"RTN","IBCEF73",109,0)
 ;
"RTN","IBCEF73",110,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",111,0)
SUB2(IBFRM) ;
"RTN","IBCEF73",112,0)
 Q:IBFRM=1 "^0B^1A^1B^1C^1G^1H^1J^EI^FH^G2^G5^LU^N5^X5^TJ^B3^BQ^SY^U3^"
"RTN","IBCEF73",113,0)
 Q:IBFRM=2 "^0B^X4^1A^1B^1C^1G^1H^G2^LU^X5^TJ^B3^BQ^SY^U3^"
"RTN","IBCEF73",114,0)
 Q ""
"RTN","IBCEF73",115,0)
 ;
"RTN","IBCEF73",116,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",117,0)
OP3(IBFRM) ;
"RTN","IBCEF73",118,0)
 Q:IBFRM=1 "^1B^1C^EI^G2^LU^N5^"
"RTN","IBCEF73",119,0)
 Q ""
"RTN","IBCEF73",120,0)
 ;
"RTN","IBCEF73",121,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",122,0)
OPR5(IBFRM) ;
"RTN","IBCEF73",123,0)
 Q:IBFRM=2 "^0B^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",124,0)
 Q ""
"RTN","IBCEF73",125,0)
 ;
"RTN","IBCEF73",126,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",127,0)
OPR8(IBFRM) ;
"RTN","IBCEF73",128,0)
 Q:IBFRM=2 "^0B^1B^1C^1D^1G^1H^EI^G2^LU^N5^SY^X5^"
"RTN","IBCEF73",129,0)
 Q ""
"RTN","IBCEF73",130,0)
 ;
"RTN","IBCEF73",131,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",132,0)
OP4(IBFRM) ;
"RTN","IBCEF73",133,0)
 Q:IBFRM=2 "^1B^1C^1D^EI^G2^LU^N5^"
"RTN","IBCEF73",134,0)
 Q ""
"RTN","IBCEF73",135,0)
 ;
"RTN","IBCEF73",136,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",137,0)
OP8(IBFRM) ;
"RTN","IBCEF73",138,0)
 Q:IBFRM=2 "^1B^1C^1D^EI^G2^N5^"
"RTN","IBCEF73",139,0)
 Q ""
"RTN","IBCEF73",140,0)
 ;
"RTN","IBCEF73",141,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",142,0)
OP6(IBFRM) ;
"RTN","IBCEF73",143,0)
 Q:IBFRM=2 "^1A^1B^1C^G2^LU^N5^"
"RTN","IBCEF73",144,0)
 Q ""
"RTN","IBCEF73",145,0)
 ;
"RTN","IBCEF73",146,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",147,0)
OP7(IBFRM) ;
"RTN","IBCEF73",148,0)
 Q:IBFRM=2 "^1A^1B^1C^G2^LU^N5^"
"RTN","IBCEF73",149,0)
 Q ""
"RTN","IBCEF73",150,0)
 ;
"RTN","IBCEF73",151,0)
 ;check qualifier for PRV1
"RTN","IBCEF73",152,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",153,0)
 ;IBVAL - value to check
"RTN","IBCEF73",154,0)
CHCKPRV1(IBFRM,IBVAL) ;
"RTN","IBCEF73",155,0)
 I IBFRM=0 Q:$$CHPRV1(1,IBVAL) 1  Q $$CHPRV1(2,IBVAL)
"RTN","IBCEF73",156,0)
 Q $$CHPRV1(IBFRM,IBVAL)
"RTN","IBCEF73",157,0)
 ;IBFRM 0-both, 1=UB,2=1500
"RTN","IBCEF73",158,0)
CHPRV1(IBFRM,IBVAL) ;
"RTN","IBCEF73",159,0)
 N IBSTR S IBSTR=""
"RTN","IBCEF73",160,0)
 S IBSTR=$$PRV1(IBFRM)
"RTN","IBCEF73",161,0)
 Q:IBSTR="" 1
"RTN","IBCEF73",162,0)
 Q IBSTR[("^"_IBVAL_"^")
"RTN","IBCEF73",163,0)
 ;
"RTN","IBCEF73",164,0)
PRV1(IBFRM) ;
"RTN","IBCEF73",165,0)
 Q:IBFRM=1 "^1A^1C^1D^1G^1H^1J^B3^BQ^EI^FH^G2^G5^LU^SY^X5^"
"RTN","IBCEF73",166,0)
 Q:IBFRM=2 "^1B^1C^1D^1G^1H^1J^B3^BQ^EI^FH^G2^G5^LU^U3^SY^X5^"
"RTN","IBCEF73",167,0)
 Q ""
"RTN","IBCEF73",168,0)
 ;
"RTN","IBCEF73",169,0)
PTSELF ;This tag is for the CI2 segment. If the IBXSAVE("IADR") is empty
"RTN","IBCEF73",170,0)
 ;check to see if the relationship to pt is 18 (self) if so pull info
"RTN","IBCEF73",171,0)
 ;from PT1 calls
"RTN","IBCEF73",172,0)
 ;See if relationship to insured is 18 if not or if "" quit
"RTN","IBCEF73",173,0)
 N IBZ
"RTN","IBCEF73",174,0)
 D F^IBCEF("N-ALL INSURED PT RELATION","IBZ",,IBXIEN)
"RTN","IBCEF73",175,0)
 S IBZ=$G(IBZ(+$$COBN^IBCEF(IBXIEN)))
"RTN","IBCEF73",176,0)
 S IBZ=$$PRELCNV^IBCNSP1(IBZ,1)
"RTN","IBCEF73",177,0)
 I IBZ'="18" S IBXDATA="" Q
"RTN","IBCEF73",178,0)
 N IBZ D F^IBCEF("N-PATIENT STREET ADDRESS 1-3","IBZ",,IBXIEN)
"RTN","IBCEF73",179,0)
 S IBXDATA="18"
"RTN","IBCEF73",180,0)
 Q
"RTN","IBCEF73",181,0)
 ;
"RTN","IBCEF73",182,0)
NOPUNCT(X,SPACE,EXC) ; Strip punctuation from data in X
"RTN","IBCEF73",183,0)
 ; SPACE = flag if 1 strip SPACES
"RTN","IBCEF73",184,0)
 ; EXC = list of punct not to strip
"RTN","IBCEF73",185,0)
 ;
"RTN","IBCEF73",186,0)
 N PUNCT,Z
"RTN","IBCEF73",187,0)
 S PUNCT=".,-+(){}[]\/><:;?|=_*&%$#@!~`^'"""
"RTN","IBCEF73",188,0)
 I $G(SPACE) S PUNCT=PUNCT_" "
"RTN","IBCEF73",189,0)
 I $G(EXC)'="" S PUNCT=$TR(PUNCT,EXC)
"RTN","IBCEF73",190,0)
 N L S L=""
"RTN","IBCEF73",191,0)
 F  S L=$O(X(L)) Q:L=""  D
"RTN","IBCEF73",192,0)
 . S X(L)=$TR(X(L),PUNCT)
"RTN","IBCEF73",193,0)
 I $G(X)'="" D
"RTN","IBCEF73",194,0)
 . S X=$TR(X,PUNCT)
"RTN","IBCEF73",195,0)
 Q
"RTN","IBCEF73",196,0)
 ;
"RTN","IBCEF73",197,0)
PROVID(IBXIEN) ;This modified version of prov id call is to acquire the SSN
"RTN","IBCEF73",198,0)
 ;first, if the ssn is not available then we need to get the tax id.
"RTN","IBCEF73",199,0)
 ;we also need to provide the modifier for which value it is
"RTN","IBCEF73",200,0)
 Q:+$G(IBXIEN)=0 ""
"RTN","IBCEF73",201,0)
 S IBXSAVE("ID")=""
"RTN","IBCEF73",202,0)
 S IBXSAVE=""
"RTN","IBCEF73",203,0)
 S IBXSAVE=$$PROVSSN^IBCEF7(IBXIEN)
"RTN","IBCEF73",204,0)
 N I
"RTN","IBCEF73",205,0)
 F I=1:1:9 D
"RTN","IBCEF73",206,0)
 . I $P(IBXSAVE,"^",I)]"" S $P(IBXSAVE("ID"),U,I)="34"
"RTN","IBCEF73",207,0)
 ;If no ibxdata go look in 355.97 for 24 
"RTN","IBCEF73",208,0)
 N IBRETVAL S IBRETVAL=""
"RTN","IBCEF73",209,0)
 N IBPTR,IBFT
"RTN","IBCEF73",210,0)
 F IBFT=1:1:9 D
"RTN","IBCEF73",211,0)
 . Q:$P(IBXSAVE,U,IBFT)]""
"RTN","IBCEF73",212,0)
 . S IBPTR=$$PROVPTR^IBCEF7(IBXIEN,IBFT)
"RTN","IBCEF73",213,0)
 . S $P(IBRETVAL,"^",IBFT)=$$TAX3559(IBPTR)
"RTN","IBCEF73",214,0)
 . I $P(IBRETVAL,U,IBFT)]"" D
"RTN","IBCEF73",215,0)
 . . S $P(IBXSAVE,U,IBFT)=$P(IBRETVAL,U,IBFT)
"RTN","IBCEF73",216,0)
 . . S $P(IBXSAVE("ID"),U,IBFT)="24"
"RTN","IBCEF73",217,0)
 Q IBXSAVE
"RTN","IBCEF73",218,0)
 ;
"RTN","IBCEF73",219,0)
TAX3559(IBPROV) ;
"RTN","IBCEF73",220,0)
 I $P(IBPROV,";",2)'["IBA(355.9" Q ""
"RTN","IBCEF73",221,0)
 N IB2,IB3559,IBIDTYP,IBID,IBQFL
"RTN","IBCEF73",222,0)
 S (IB3559,IBQFL)=0
"RTN","IBCEF73",223,0)
 S IBID=""
"RTN","IBCEF73",224,0)
 Q:+$G(IBPROV)=0 ""
"RTN","IBCEF73",225,0)
 F IB2=1:1 S IB3559=$O(^IBA(355.9,"B",IBPROV,IB3559)) Q:IB3559=""!IBQFL  D
"RTN","IBCEF73",226,0)
 . S IBIDTYP=+$P($G(^IBA(355.9,IB3559,0)),"^",6) ;provider ID type, ptr to #355.97
"RTN","IBCEF73",227,0)
 . S IBIDTYP=$P($G(^IBE(355.97,IBIDTYP,0)),"^",3)
"RTN","IBCEF73",228,0)
 . S:IBIDTYP="EI" IBID=$P($G(^IBA(355.9,IB3559,0)),"^",7),IBQFL=1
"RTN","IBCEF73",229,0)
 ; if nothing found yet, look in file 355.93 for Facility Default ID
"RTN","IBCEF73",230,0)
 I IBID="",IBPROV["IBA(355.93" D
"RTN","IBCEF73",231,0)
 .N IB0,IBFID,IBQ
"RTN","IBCEF73",232,0)
 .S IB0=$G(^IBA(355.93,+IBPROV,0)) Q:IB0=""!($P(IB0,U,2)'=1)  ; not a facility - bail out
"RTN","IBCEF73",233,0)
 .S IBFID=$P(IB0,U,9) Q:IBFID=""  ; no default id on file - bail out
"RTN","IBCEF73",234,0)
 .S IBQ=$P(IB0,U,13) I +IBQ>0,$P($G(^IBE(355.97,IBQ,0)),U,3)=24 S IBID=IBFID
"RTN","IBCEF73",235,0)
 .Q
"RTN","IBCEF73",236,0)
 Q $$NOPUNCT^IBCEF(IBID)
"RTN","IBCEF73",237,0)
 ;
"RTN","IBCEF73",238,0)
 ;IBFULL-full name
"RTN","IBCEF73",239,0)
 ;IBEL - Name element : "FAMILY","GIVEN","MIDDLE","SUFFIX"
"RTN","IBCEF73",240,0)
 ;
"RTN","IBCEF73",241,0)
SSN200(IBPTR)   ;
"RTN","IBCEF73",242,0)
 I $P(IBPTR,";",2)'="VA(200," Q ""
"RTN","IBCEF73",243,0)
 Q $$NOPUNCT^IBCEF($$GET1^DIQ(200,+$P(IBPTR,";")_",",9))
"RTN","IBCEF73",244,0)
 ;
"RTN","IBCEF73",245,0)
 ;Input:
"RTN","IBCEF73",246,0)
 ; IBIEN399 - ien in #399
"RTN","IBCEF73",247,0)
 ;Output:
"RTN","IBCEF73",248,0)
 ; returns a string with "^" delimiters that contains SSNs (if any)
"RTN","IBCEF73",249,0)
 ; in the position that equal to FUNCTION number
"RTN","IBCEF73",250,0)
 ; i.e. if RENDERING function # is 3 then SSN will be
"RTN","IBCEF73",251,0)
 ; in $P(return value,"^",3), etc.
"RTN","IBCEF73",252,0)
 ;
"RTN","IBCEF73",253,0)
SSN3559(IBPROV) ;
"RTN","IBCEF73",254,0)
 N IB2,IB3559,IBIDTYP,IBID,IBQFL
"RTN","IBCEF73",255,0)
 S (IB3559,IBQFL)=0
"RTN","IBCEF73",256,0)
 S IBID=""
"RTN","IBCEF73",257,0)
 Q:+$G(IBPROV)=0 ""
"RTN","IBCEF73",258,0)
 F IB2=1:1 S IB3559=$O(^IBA(355.9,"B",IBPROV,IB3559)) Q:IB3559=""!IBQFL  D
"RTN","IBCEF73",259,0)
 . S IBIDTYP=+$P($G(^IBA(355.9,IB3559,0)),"^",6)
"RTN","IBCEF73",260,0)
 . S IBIDTYP=$P($G(^IBE(355.97,IBIDTYP,0)),"^",3)
"RTN","IBCEF73",261,0)
 . S:IBIDTYP="SY" IBID=$P($G(^IBA(355.9,IB3559,0)),"^",7),IBQFL=1
"RTN","IBCEF73",262,0)
 Q $$NOPUNCT^IBCEF(IBID)
"RTN","IBCEF73",263,0)
 ;
"RTN","IBCEF73",264,0)
 ;IBIDTYP-provider ID type, ptr to #355.97
"RTN","IBCEF73",265,0)
 ;IBFULL-full name
"RTN","IBCEF73",266,0)
 ;IBEL - Name element : "FAMILY","GIVEN","MIDDLE","SUFFIX"
"RTN","IBCEF73",267,0)
 ;
"RTN","IBCEF73",268,0)
PRV1FMT(P) ;FORMAT CODE FOR PRV1 SEGMENT THAT WON'T FIT ON LINE
"RTN","IBCEF73",269,0)
 K IBXDATA
"RTN","IBCEF73",270,0)
 S:'$D(IBXSAVE("BIL-PROV-SEC")) IBXSAVE("BIL-PROV-SEC")=$$PRV1^IBCEF7(IBXIEN)
"RTN","IBCEF73",271,0)
 S IBXDATA=$P($G(IBXSAVE("BIL-PROV-SEC")),"^",P)
"RTN","IBCEF73",272,0)
 I $G(IBXDATA)'="" S IBXDATA=$$NOPUNCT^IBCEF(IBXDATA,1)
"RTN","IBCEF73",273,0)
 Q
"RTN","IBCEF73",274,0)
 ;
"RTN","IBCEFG1")
0^12^B23263677^B26758325
"RTN","IBCEFG1",1,0)
IBCEFG1 ;ALB/TMP - OUTPUT FORMATTER DATA DEFINITION UTILITIES ;18-JAN-96
"RTN","IBCEFG1",2,0)
 ;;2.0;INTEGRATED BILLING;**52,51,137,181,197,232,288,349,371,377**;21-MAR-94;Build 23
"RTN","IBCEFG1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEFG1",4,0)
 ;
"RTN","IBCEFG1",5,0)
EDIBILL(IBXFORM,IBXDA,IBINS,IBTYP) ; Find element associated with form fld
"RTN","IBCEFG1",6,0)
 ; IBXFORM = (REQUIRED) actual form being extracted (in file 353)
"RTN","IBCEFG1",7,0)
 ; IBXDA = (REQUIRED) form definition file (364.6) entry to use to find
"RTN","IBCEFG1",8,0)
 ;         extract data element definition entry (in file 364.7)
"RTN","IBCEFG1",9,0)
 ; IBINS = (REQUIRED) insurance co. ien for the current insurance on bill
"RTN","IBCEFG1",10,0)
 ; IBTYP = (REQUIRED) bill type (I/O)
"RTN","IBCEFG1",11,0)
 ;
"RTN","IBCEFG1",12,0)
 ; Returns ien of the entry in file 364.7 if a match on override criteria
"RTN","IBCEFG1",13,0)
 ;  was found.  Returns -1 if a screen form and the criteria fails for a
"RTN","IBCEFG1",14,0)
 ;  field without an override
"RTN","IBCEFG1",15,0)
 ;
"RTN","IBCEFG1",16,0)
 N IBX,IBPARFM,IBSCREEN,IBNMATCH,EDIQ,IB1
"RTN","IBCEFG1",17,0)
 I $G(IBXDA)=""!($G(IBXFORM)="") G EDIQ
"RTN","IBCEFG1",18,0)
 S EDIQ=0
"RTN","IBCEFG1",19,0)
 S IBPARFM=$P($G(^IBE(353,IBXFORM,2)),U,5) S:'IBPARFM IBPARFM=IBXFORM
"RTN","IBCEFG1",20,0)
 S IBSCREEN=($P($G(^IBE(353,+IBXFORM,2)),U,2)="S")
"RTN","IBCEFG1",21,0)
 S IB1=(IBPARFM=IBXFORM) ; Not a local field that is not a parent
"RTN","IBCEFG1",22,0)
 ;
"RTN","IBCEFG1",23,0)
 I $G(IBINS)'="",$G(IBTYP)'="" D:$O(^IBA(364.7,"AINTYP",IBXDA,""))'=""  G:EDIQ EDIQ
"RTN","IBCEFG1",24,0)
 . I '$D(^IBA(364.7,"AINTYP",IBXDA,IBINS,IBTYP)) S IBNMATCH=1 Q
"RTN","IBCEFG1",25,0)
 . S IBX=+$O(^IBA(364.7,"AINTYP",IBXDA,IBINS,IBTYP,"")),EDIQ=1 S:IBX IBNMATCH=0 ;by ins co and type of bill
"RTN","IBCEFG1",26,0)
 ;
"RTN","IBCEFG1",27,0)
 I $G(IBINS)'="" D:$O(^IBA(364.7,"AINS",IBXDA,""))'=""  G:EDIQ EDIQ
"RTN","IBCEFG1",28,0)
 . I '$D(^IBA(364.7,"AINS",IBXDA,IBINS)) S IBNMATCH=1 Q
"RTN","IBCEFG1",29,0)
 . S IBX=+$O(^IBA(364.7,"AINS",IBXDA,IBINS,"")),EDIQ=1 S:IBX IBNMATCH=0 ;ins co only
"RTN","IBCEFG1",30,0)
 ;
"RTN","IBCEFG1",31,0)
 I $G(IBTYP)'="" D:$O(^IBA(364.7,"ATYPE",IBXDA,""))'=""  G:EDIQ EDIQ
"RTN","IBCEFG1",32,0)
 . I '$D(^IBA(364.7,"ATYPE",IBXDA,IBTYP)) S IBNMATCH=1 Q
"RTN","IBCEFG1",33,0)
 . S IBX=+$O(^IBA(364.7,"ATYPE",IBXDA,IBTYP,"")),EDIQ=1 S:IBX IBNMATCH=0 ;type of bill only
"RTN","IBCEFG1",34,0)
 ;
"RTN","IBCEFG1",35,0)
 I IBXFORM,$S(IBXFORM'=IBPARFM:1,1:IBSCREEN) D  G EDIQ
"RTN","IBCEFG1",36,0)
 . S IBX=+$O(^IBA(364.7,"ALL",IBXDA,"")) ; Check for all ins co and types
"RTN","IBCEFG1",37,0)
 . I IBX,+$O(^IBA(364.7,"ALL",IBXDA,IBX)) D  ; Find override for 'ALL'
"RTN","IBCEFG1",38,0)
 .. N Z
"RTN","IBCEFG1",39,0)
 .. S Z=0 F  S Z=$O(^IBA(364.7,"ALL",IBXDA,Z)) Q:'Z  I $P($G(^IBA(364.7,Z,0)),U)'=IBXDA S IBX=Z Q
"RTN","IBCEFG1",40,0)
 . I 'IBX,+$O(^IBA(364.7,"B",IBXDA,"")) S IBX=$O(^(""))
"RTN","IBCEFG1",41,0)
 . S:IBX IBNMATCH=0
"RTN","IBCEFG1",42,0)
 ;
"RTN","IBCEFG1",43,0)
 I IBXFORM,$O(^IBA(364.6,"APAR",IBXFORM,IBXDA,"")) S IBX=+$O(^("")),IBX=+$O(^IBA(364.7,"B",IBX,0)) I IBX G EDIQ
"RTN","IBCEFG1",44,0)
 S IBX=+$O(^IBA(364.7,"B",IBXDA,""))
"RTN","IBCEFG1",45,0)
EDIQ I IBSCREEN,$G(IBNMATCH) S IBX=-1
"RTN","IBCEFG1",46,0)
 Q $G(IBX)
"RTN","IBCEFG1",47,0)
 ;
"RTN","IBCEFG1",48,0)
DT(DATE1,DATE2,FORMAT) ; Return date in DATE1 (and optionally DATE2)
"RTN","IBCEFG1",49,0)
 ;   (input in Fileman format) converted to X12 format
"RTN","IBCEFG1",50,0)
 ; FORMAT (required)
"RTN","IBCEFG1",51,0)
 ; DATE1,DATE2 in FILEMAN date format
"RTN","IBCEFG1",52,0)
 N DATE S DATE=""
"RTN","IBCEFG1",53,0)
 I DATE1=0 S DATE1=""
"RTN","IBCEFG1",54,0)
 I $E(FORMAT)="D" D  G DTQ
"RTN","IBCEFG1",55,0)
 .S DATE=$E(DATE1,2,7) Q:$P(FORMAT,"D",2)=6  ;YYMMDD
"RTN","IBCEFG1",56,0)
 .S:DATE1 DATE=($E(DATE1)+17)_DATE ;CCYYMMDD
"RTN","IBCEFG1",57,0)
 I $E(FORMAT)="R" D
"RTN","IBCEFG1",58,0)
 .S:DATE1 DATE=$E(DATE1,2,7)_"-"_$E($S($G(DATE2):DATE2,1:DATE1),2,7) ;YYMMDD-YYMMDD
"RTN","IBCEFG1",59,0)
 .Q:FORMAT["6"
"RTN","IBCEFG1",60,0)
 .S DATE=($E(DATE1)+17)_DATE,$P(DATE,"-",2)=($E($S($G(DATE2):DATE2,1:DATE1))+17)_$P(DATE,"-",2) ;CCYYMMDD-CCYYMMDD
"RTN","IBCEFG1",61,0)
DTQ Q DATE
"RTN","IBCEFG1",62,0)
 ;
"RTN","IBCEFG1",63,0)
NAME(IBNM1,COMB) ; Parse person's nm into 5 pieces LAST^FIRST^MIDDLE^CRED^SUFFIX
"RTN","IBCEFG1",64,0)
 ; IBNM1 = NAME in LAST,FIRST MIDDLE^vp file ien (200 or 355.93)^bill ien^prv type
"RTN","IBCEFG1",65,0)
 ;      OR         FIRST MIDDLE LAST^vp file ien (200 or 355.93)^bill ien^prv type
"RTN","IBCEFG1",66,0)
 ; COMB = if set to 1, then combine the first and middle name
"RTN","IBCEFG1",67,0)
 ;        if set to 2, combine the last and middle names
"RTN","IBCEFG1",68,0)
 N PC,IBIEN,IBCRED,IBNM,IBNMC,IBPIEN
"RTN","IBCEFG1",69,0)
 S IBIEN=$P(IBNM1,U,2),IBNMC=$P(IBNM1,U)
"RTN","IBCEFG1",70,0)
 S IBPIEN=+$O(^DGCR(399,+$P(IBNM1,U,3),"PRV","B",+$P(IBNM1,U,4),0))
"RTN","IBCEFG1",71,0)
 S IBCRED=$$CRED^IBCEU(IBIEN,+$P(IBNM1,U,3),IBPIEN) ;Degree
"RTN","IBCEFG1",72,0)
 I IBNMC="DEPT VETERANS AFFAIRS" S IBNMC="VETERANS AFFAIRS,DEPT"
"RTN","IBCEFG1",73,0)
 I IBNMC["," D  G NAMEQ
"RTN","IBCEFG1",74,0)
 . S IBNMC=$TR(IBNMC,".") D NAMECOMP^XLFNAME(.IBNMC)
"RTN","IBCEFG1",75,0)
 . S IBNM=$G(IBNMC("FAMILY"))_U_$G(IBNMC("GIVEN"))_U_$G(IBNMC("MIDDLE"))_U_IBCRED_U_$G(IBNMC("SUFFIX"))
"RTN","IBCEFG1",76,0)
 D STDNAME^XLFNAME(.IBNMC,"C")
"RTN","IBCEFG1",77,0)
 S IBNM=$G(IBNMC("FAMILY"))_U_$G(IBNMC("GIVEN"))_U_$G(IBNMC("MIDDLE"))_U_IBCRED_U_$G(IBNMC("SUFFIX"))
"RTN","IBCEFG1",78,0)
 I $P(IBNM1,U,2)["355.93",$P($G(^IBA(355.93,+$P(IBNM1,U,2),0)),U,2)=1 D  G NAMEQ  ; group performing provider
"RTN","IBCEFG1",79,0)
 . S IBNM=$P(IBNM1,U)_U_U_U_IBCRED_U
"RTN","IBCEFG1",80,0)
 I $G(COMB)=1,$G(IBNMC("MIDDLE"))'="" S IBNM=$P(IBNM,U)_U_$P(IBNM,U,2)_" "_$P(IBNM,U,3)_U_IBCRED_U_$P(IBNM,U,5)
"RTN","IBCEFG1",81,0)
 I $G(COMB)=2,$G(IBNMC("MIDDLE"))'="" S IBNM=$P(IBNM,U)_" "_$P(IBNM,U,3)_U_$P(IBNM,U,2)_U_IBCRED_U_$P(IBNM,U,5)
"RTN","IBCEFG1",82,0)
 ;
"RTN","IBCEFG1",83,0)
NAMEQ Q IBNM
"RTN","IBCEFG1",84,0)
 ;
"RTN","IBCEFG1",85,0)
DOLLAR(AMT) ; Format amount in AMT so it is numeric including cents, without
"RTN","IBCEFG1",86,0)
 ; the decimal and commas.
"RTN","IBCEFG1",87,0)
 N DOLR,CENT
"RTN","IBCEFG1",88,0)
 I AMT'="" S AMT=$TR(AMT,","),DOLR=$P(AMT,"."),CENT=$E($P(AMT,".",2)_"00",1,2),AMT=DOLR_CENT
"RTN","IBCEFG1",89,0)
 Q AMT
"RTN","IBCEFG1",90,0)
 ;
"RTN","IBCEFG1",91,0)
STATE(CODE) ;Return state code from state pointer
"RTN","IBCEFG1",92,0)
 Q $P($G(^DIC(5,+CODE,0)),U,2)
"RTN","IBCEFG1",93,0)
 ;
"RTN","IBCEFG1",94,0)
SEX(CODE) ;Return the X12 code for sex
"RTN","IBCEFG1",95,0)
 ; CODE = DHCP code for sex
"RTN","IBCEFG1",96,0)
 Q $S(CODE="":"U","MF"[$E(CODE):$E(CODE),1:"U")
"RTN","IBCEFG1",97,0)
 ;
"RTN","IBCEFG1",98,0)
EMPLST(CODE) ;Return the X12 code for employment status
"RTN","IBCEFG1",99,0)
 ; CODE = DHCP code for employment status
"RTN","IBCEFG1",100,0)
 N X12
"RTN","IBCEFG1",101,0)
 S X12=""
"RTN","IBCEFG1",102,0)
 S:CODE'="" X12=$P($P("1;FT^2;PT^3;NE^4;SE^5;RT^6;AU^9;UK",CODE_";",2),U)
"RTN","IBCEFG1",103,0)
 S:X12="" X12="UK"
"RTN","IBCEFG1",104,0)
 Q X12
"RTN","IBCEFG1",105,0)
 ;
"RTN","IBCEFG1",106,0)
MARITAL(CODE) ;Return the X12 code for marital status
"RTN","IBCEFG1",107,0)
 ; CODE = ien of code for marital status
"RTN","IBCEFG1",108,0)
 N X12
"RTN","IBCEFG1",109,0)
 S X12=$P($G(^DIC(11,+CODE,0)),U,3)
"RTN","IBCEFG1",110,0)
 I X12'="" S X12=$P($P("D;D^M;M^N;I^S;X^W;W^U;K",X12_";",2),U)
"RTN","IBCEFG1",111,0)
 Q X12
"RTN","IBCEFG1",112,0)
 ;
"RTN","IBCEFG1",113,0)
TOS(CODE) ;Return the X12 code for type of service
"RTN","IBCEFG1",114,0)
 ; CODE = DHCP code for type of service
"RTN","IBCEFG1",115,0)
 N X12
"RTN","IBCEFG1",116,0)
 S X12=$S(CODE>0&(CODE<10):CODE,1:$P($P("0;10^A;11^B;13^H;45^L;18^M;15^N;63^V;19^Y;20^Z;21^43;96^53;96",CODE_";",2),U)) S:X12="" X12=CODE
"RTN","IBCEFG1",117,0)
 Q X12
"RTN","IBCEFG1",118,0)
 ;
"RTN","IBCEFG1",119,0)
FIXLEN(DATA,LEN) ; Create a fixed length field from data DATA length LEN
"RTN","IBCEFG1",120,0)
 Q $E(DATA_$J("",LEN),1,LEN)
"RTN","IBCEFG1",121,0)
 ;
"RTN","IBCEFG1",122,0)
RCDT(IBXSAVE,IBXDATA,IBDT) ; Format date for multiple revenue code transmission)
"RTN","IBCEFG1",123,0)
 ;IBXSAVE = array containing the extracted service line data for the UB format bill
"RTN","IBCEFG1",124,0)
 ;IBXDATA = array returned with service line dates formatted in YYYYMMDD format
"RTN","IBCEFG1",125,0)
 ;IBDT = the default date for the revenue codes on the bill
"RTN","IBCEFG1",126,0)
 N Q,W
"RTN","IBCEFG1",127,0)
 S Q=0 F  S Q=$O(IBXSAVE("INPT",Q)) Q:'Q  S W=$$DT($P(IBXSAVE("INPT",1),U,10),,"D8"),IBXDATA(Q)=$S(W:W,1:IBDT)
"RTN","IBCEFG1",128,0)
 Q
"RTN","IBCEMCA2")
0^20^B19841299^B17866540
"RTN","IBCEMCA2",1,0)
IBCEMCA2 ;ALB/ESG - Multiple CSA Message Management - Actions ;20-SEP-2005
"RTN","IBCEMCA2",2,0)
 ;;2.0;INTEGRATED BILLING;**320,377**;21-MAR-1994;Build 23
"RTN","IBCEMCA2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEMCA2",4,0)
 ;
"RTN","IBCEMCA2",5,0)
 Q
"RTN","IBCEMCA2",6,0)
 ;
"RTN","IBCEMCA2",7,0)
CANCEL ; mass claim cancel
"RTN","IBCEMCA2",8,0)
 NEW NS,IBIFN,NSC,DIR,X,Y,DUOUT,DTOUT,DIRUT,DIROUT,IBDA,IB364,DISP,IBCE
"RTN","IBCEMCA2",9,0)
 NEW IBMCSRSC,IBMCSRNB,IBMCSCNT,IBMCSTOT,IBMCSTOP,IBMCSCAN,MRACHK,IBCAN,IBMCSCAC
"RTN","IBCEMCA2",10,0)
 D FULL^VALM1
"RTN","IBCEMCA2",11,0)
 ;
"RTN","IBCEMCA2",12,0)
 I '$$KCHK^XUSRB("IB AUTHORIZE") D  G CANCELX
"RTN","IBCEMCA2",13,0)
 . W !!?5,"You don't hold the proper security key to access this option."
"RTN","IBCEMCA2",14,0)
 . W !?5,"The necessary key is IB AUTHORIZE.  Please see your manager."
"RTN","IBCEMCA2",15,0)
 . D PAUSE^VALM1
"RTN","IBCEMCA2",16,0)
 . Q
"RTN","IBCEMCA2",17,0)
 ;
"RTN","IBCEMCA2",18,0)
 S NS=+$G(^TMP($J,"IBCEMCL",4))
"RTN","IBCEMCA2",19,0)
 I 'NS D  G CANCELX
"RTN","IBCEMCA2",20,0)
 . W !!?5,"There are no selected messages." D PAUSE^VALM1
"RTN","IBCEMCA2",21,0)
 . Q
"RTN","IBCEMCA2",22,0)
 ;
"RTN","IBCEMCA2",23,0)
 ; count number of claims too
"RTN","IBCEMCA2",24,0)
 S IBIFN=0 F NSC=0:1 S IBIFN=$O(^TMP($J,"IBCEMCL",4,2,IBIFN)) Q:'IBIFN
"RTN","IBCEMCA2",25,0)
 ;
"RTN","IBCEMCA2",26,0)
 W !!?5,"Number of messages selected:  ",NS
"RTN","IBCEMCA2",27,0)
 W !?7,"Number of claims selected:  ",NSC
"RTN","IBCEMCA2",28,0)
 W !!,"In order to cancel "
"RTN","IBCEMCA2",29,0)
 W $S(NSC=1:"this claim",1:"these claims")
"RTN","IBCEMCA2",30,0)
 W ", a Reason Cancelled and a Reason Not Billable"
"RTN","IBCEMCA2",31,0)
 W !,"are required.  You may also provide an optional CT Additional Comment."
"RTN","IBCEMCA2",32,0)
 W !,"These will be used as the default responses for "
"RTN","IBCEMCA2",33,0)
 W $S(NSC=1:"this claim",1:"all claims")
"RTN","IBCEMCA2",34,0)
 W "."
"RTN","IBCEMCA2",35,0)
 ;
"RTN","IBCEMCA2",36,0)
CANQ1 ; reader call for the Reason Cancelled field
"RTN","IBCEMCA2",37,0)
 W !
"RTN","IBCEMCA2",38,0)
 S DIR(0)="399,19"
"RTN","IBCEMCA2",39,0)
 S DIR("A")="Reason Cancelled"
"RTN","IBCEMCA2",40,0)
 D ^DIR K DIR
"RTN","IBCEMCA2",41,0)
 I X="",Y="" W *7,!,"This is a required response. Enter '^' to exit." G CANQ1
"RTN","IBCEMCA2",42,0)
 I $D(DIRUT) G CANCELX
"RTN","IBCEMCA2",43,0)
 M IBMCSRSC=Y           ; save the entered text for reason cancelled
"RTN","IBCEMCA2",44,0)
 ;
"RTN","IBCEMCA2",45,0)
CANQ2 ; reader call for the reason not billable field
"RTN","IBCEMCA2",46,0)
 W !
"RTN","IBCEMCA2",47,0)
 S DIR(0)="356,.19"
"RTN","IBCEMCA2",48,0)
 S DIR("A")="Reason Not Billable"
"RTN","IBCEMCA2",49,0)
 D ^DIR K DIR
"RTN","IBCEMCA2",50,0)
 I X="",Y="" W *7,!,"This is a required response. Enter '^' to exit." G CANQ2
"RTN","IBCEMCA2",51,0)
 I $D(DIRUT) G CANCELX
"RTN","IBCEMCA2",52,0)
 M IBMCSRNB=Y           ; save the reason not billable code/desc
"RTN","IBCEMCA2",53,0)
 ;
"RTN","IBCEMCA2",54,0)
CANQ3 ; reader call for the Claims Tracking Additional Comment field
"RTN","IBCEMCA2",55,0)
 W !
"RTN","IBCEMCA2",56,0)
 S DIR(0)="356,1.08O"
"RTN","IBCEMCA2",57,0)
 S DIR("A")="CT Additional Comment"
"RTN","IBCEMCA2",58,0)
 D ^DIR K DIR
"RTN","IBCEMCA2",59,0)
 I $D(DIRUT) G CANCELX
"RTN","IBCEMCA2",60,0)
 M IBMCSCAC=Y
"RTN","IBCEMCA2",61,0)
 ;
"RTN","IBCEMCA2",62,0)
 W !
"RTN","IBCEMCA2",63,0)
 S DIR(0)="YO"
"RTN","IBCEMCA2",64,0)
 S DIR("A")="OK to proceed into the cancel claim loop",DIR("B")="No"
"RTN","IBCEMCA2",65,0)
 D ^DIR K DIR
"RTN","IBCEMCA2",66,0)
 I Y'=1 G CANCELX
"RTN","IBCEMCA2",67,0)
 ;
"RTN","IBCEMCA2",68,0)
 S IBIFN=0,IBMCSCNT=0,IBMCSTOT=NSC,IBMCSTOP=0
"RTN","IBCEMCA2",69,0)
 F  S IBIFN=$O(^TMP($J,"IBCEMCL",4,2,IBIFN)) Q:'IBIFN  D  Q:IBMCSTOP
"RTN","IBCEMCA2",70,0)
 . S IBMCSCNT=IBMCSCNT+1
"RTN","IBCEMCA2",71,0)
 . S IBDA=+$O(^TMP($J,"IBCEMCL",4,2,IBIFN,""),-1)  ; most recent 361 ien
"RTN","IBCEMCA2",72,0)
 . S IB364=+$P($G(^IBM(361,IBDA,0)),U,11)          ; transmit bill 364 ien
"RTN","IBCEMCA2",73,0)
 . W !!," *** Processing MCS claim# ",IBMCSCNT," of ",IBMCSTOT," ***"
"RTN","IBCEMCA2",74,0)
 . S DISP=$$DISP^IBCEM3(IBIFN,"cancel","",1,.DIRUT)
"RTN","IBCEMCA2",75,0)
 . ;
"RTN","IBCEMCA2",76,0)
 . I $D(DIRUT) D  Q       ; up arrow or time-out
"RTN","IBCEMCA2",77,0)
 .. N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","IBCEMCA2",78,0)
 .. S DIR(0)="YO"
"RTN","IBCEMCA2",79,0)
 .. S DIR("A")="Do you want to Exit this MCS cancel claim loop"
"RTN","IBCEMCA2",80,0)
 .. S DIR("B")="Yes"
"RTN","IBCEMCA2",81,0)
 .. W ! D ^DIR K DIR
"RTN","IBCEMCA2",82,0)
 .. I Y=1 S IBMCSTOP=1    ; Yes, exit out altogether
"RTN","IBCEMCA2",83,0)
 .. Q
"RTN","IBCEMCA2",84,0)
 . ;
"RTN","IBCEMCA2",85,0)
 . I 'DISP Q              ; user said No to cancel
"RTN","IBCEMCA2",86,0)
 . ;
"RTN","IBCEMCA2",87,0)
 . I 'IBDA!'IB364 D  Q
"RTN","IBCEMCA2",88,0)
 .. W !?4,"Cannot determine the EDI transmission record."
"RTN","IBCEMCA2",89,0)
 .. W !?4,"This claim can't be cancelled here."
"RTN","IBCEMCA2",90,0)
 .. D PAUSE^VALM1
"RTN","IBCEMCA2",91,0)
 .. Q
"RTN","IBCEMCA2",92,0)
 . ;
"RTN","IBCEMCA2",93,0)
 . D MRACHK^IBCECSA4 I MRACHK Q
"RTN","IBCEMCA2",94,0)
 . ;
"RTN","IBCEMCA2",95,0)
 . ; set-up required variables for main call to cancel this claim
"RTN","IBCEMCA2",96,0)
 . S IBCAN=1,IBMCSCAN=1
"RTN","IBCEMCA2",97,0)
 . S IBCE("EDI")=1
"RTN","IBCEMCA2",98,0)
 . S Y=IBIFN
"RTN","IBCEMCA2",99,0)
 . D
"RTN","IBCEMCA2",100,0)
 .. ; protect variables to be restored after call to IBCC and
"RTN","IBCEMCA2",101,0)
 .. ; leftover junk variables from IBCC
"RTN","IBCEMCA2",102,0)
 .. NEW IBIFN,IBMCSTOP,IBMCSCNT,IBMCSTOT,IBCSAMCS
"RTN","IBCEMCA2",103,0)
 .. NEW IBCCCC,IBCCR,IBQUIT,NAME,POP,RDATES,COL,CTRLCOL,FINISH
"RTN","IBCEMCA2",104,0)
 .. D NOPTF^IBCC
"RTN","IBCEMCA2",105,0)
 .. Q
"RTN","IBCEMCA2",106,0)
 . Q
"RTN","IBCEMCA2",107,0)
 ;
"RTN","IBCEMCA2",108,0)
 I IBMCSTOP W !!?5,"MCS cancel loop aborted."
"RTN","IBCEMCA2",109,0)
 I 'IBMCSTOP W !!?5,"Done with MCS cancel loop!"
"RTN","IBCEMCA2",110,0)
 D PAUSE^VALM1
"RTN","IBCEMCA2",111,0)
 ;
"RTN","IBCEMCA2",112,0)
 ; rebuild the list
"RTN","IBCEMCA2",113,0)
 KILL ^TMP($J,"IBCEMCA"),VALMHDR
"RTN","IBCEMCA2",114,0)
 S VALMBG=1
"RTN","IBCEMCA2",115,0)
 D UNLOCK^IBCEMCL
"RTN","IBCEMCA2",116,0)
 D INIT^IBCEMCL
"RTN","IBCEMCA2",117,0)
 I $G(IBCSAMCS)=1 S IBCSAMCS=2   ; flag to rebuild CSA
"RTN","IBCEMCA2",118,0)
 ;
"RTN","IBCEMCA2",119,0)
CANCELX ;
"RTN","IBCEMCA2",120,0)
 S VALMBCK="R"
"RTN","IBCEMCA2",121,0)
 Q
"RTN","IBCEMCA2",122,0)
 ;
"RTN","IBCEOB")
0^25^B58527801^B66548072
"RTN","IBCEOB",1,0)
IBCEOB ;ALB/TMP - 835 EDI EOB MESSAGE PROCESSING ;20-JAN-99
"RTN","IBCEOB",2,0)
 ;;2.0;INTEGRATED BILLING;**137,135,265,155,377**;21-MAR-94;Build 23
"RTN","IBCEOB",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEOB",4,0)
 ;
"RTN","IBCEOB",5,0)
 Q
"RTN","IBCEOB",6,0)
 ;
"RTN","IBCEOB",7,0)
UPDEOB(IBTDA) ; Update EXPLANATION OF BENEFITS file (#361.1) from return msg
"RTN","IBCEOB",8,0)
 ; IBTDA = ien of return message
"RTN","IBCEOB",9,0)
 ; Function returns ien of EOB file entry or "" if errors found
"RTN","IBCEOB",10,0)
 ;          the data.  Any errors found are
"RTN","IBCEOB",11,0)
 ;          stored in array ^TMP("IBCERR-EOB",$J,n) in text format
"RTN","IBCEOB",12,0)
 ;          n = seq # and are stored with the EOB in a wp field
"RTN","IBCEOB",13,0)
 ;
"RTN","IBCEOB",14,0)
 N IB0,IB100,IBBTCH,IBE,IBMNUM,IBT,DLAYGO,DIC,DD,DO,X,Y,Z,Z0,Z1,IBEOB,IBBAD,IBOK,IB,IBA1,IBIFN,IBFILE
"RTN","IBCEOB",15,0)
 K ^TMP($J),^TMP("IBCERR-EOB",$J)
"RTN","IBCEOB",16,0)
 ;
"RTN","IBCEOB",17,0)
 S (IBBAD,IBEOB)=""
"RTN","IBCEOB",18,0)
 S IB0=$G(^IBA(364.2,IBTDA,0))
"RTN","IBCEOB",19,0)
 S IBMNUM=+$P(IB0,U)
"RTN","IBCEOB",20,0)
 S X=+$G(^IBA(364,+$P(IB0,U,5),0))
"RTN","IBCEOB",21,0)
 ;
"RTN","IBCEOB",22,0)
 G:$S(IBMNUM=""!(X=""):1,1:$D(^IBM(361.1,"AC",IBMNUM))) UPDQ
"RTN","IBCEOB",23,0)
 ;
"RTN","IBCEOB",24,0)
 ; Duplicate EOB Check
"RTN","IBCEOB",25,0)
 S IBFILE="^IBA(364.2,"_IBTDA_",2)"
"RTN","IBCEOB",26,0)
 I $$DUP(IBFILE,X) D DELMSG^IBCESRV2(IBTDA) G UPDQ
"RTN","IBCEOB",27,0)
 ;
"RTN","IBCEOB",28,0)
 I '$$LOCK^IBCEM(IBTDA) G UPDQ ;Lock msg file 364.2
"RTN","IBCEOB",29,0)
 S IBEOB=+$$ADD3611(IBMNUM,$P(IB0,U,5),$P(IB0,U,4),X,0,IBFILE)
"RTN","IBCEOB",30,0)
 L -^IBA(364.2,IBTDA,0)
"RTN","IBCEOB",31,0)
 ;
"RTN","IBCEOB",32,0)
 I IBEOB<0 S IBEOB="" G UPDQ
"RTN","IBCEOB",33,0)
 D UPD3611(IBEOB,IBTDA,0)
"RTN","IBCEOB",34,0)
 ;
"RTN","IBCEOB",35,0)
UPDQ I IBEOB,$O(^TMP("IBCERR-EOB",$J,0)) D ERRUPD(IBEOB,"IBCERR-EOB")
"RTN","IBCEOB",36,0)
 K ^TMP($J),^TMP("IBCERR-EOB",$J)
"RTN","IBCEOB",37,0)
 D CLEAN^DILF
"RTN","IBCEOB",38,0)
 Q +IBEOB
"RTN","IBCEOB",39,0)
 ;
"RTN","IBCEOB",40,0)
 ;
"RTN","IBCEOB",41,0)
 ; NOTE: **** For all variables IB0,IBEGBL,IBEOB below:
"RTN","IBCEOB",42,0)
 ; IB0 = raw data received for this record type on the 835 flat file
"RTN","IBCEOB",43,0)
 ; IBEGBL = subscript to use in error global
"RTN","IBCEOB",44,0)
 ; IBEOB = ien in file 361.1 for this EOB
"RTN","IBCEOB",45,0)
 ;
"RTN","IBCEOB",46,0)
835(IB0,IBEGBL,IBEOB) ; Store header
"RTN","IBCEOB",47,0)
 ;
"RTN","IBCEOB",48,0)
 Q $$HDR^IBCEOB1(IB0,IBEGBL,IBEOB)
"RTN","IBCEOB",49,0)
 ;
"RTN","IBCEOB",50,0)
5(IB0,IBEGBL,IBEOB) ; Record '05'
"RTN","IBCEOB",51,0)
 ;
"RTN","IBCEOB",52,0)
 N IBOK,DA,DR,DIE,X,Y
"RTN","IBCEOB",53,0)
 K IBZDATA
"RTN","IBCEOB",54,0)
 S DR=";",IBOK=1
"RTN","IBCEOB",55,0)
 S DIE="^IBM(361.1,",DA=IBEOB
"RTN","IBCEOB",56,0)
 ;
"RTN","IBCEOB",57,0)
 I $P(IB0,U,9) S DR=DR_"1.1///"_$$DATE^IBCEU($P(IB0,U,9))_";"         ; statement start date
"RTN","IBCEOB",58,0)
 I $P(IB0,U,10) S DR=DR_"1.11///"_$$DATE^IBCEU($P(IB0,U,10))_";"      ; statement end date
"RTN","IBCEOB",59,0)
 S DR=$P(DR,";",2,$L(DR,";")-1)
"RTN","IBCEOB",60,0)
 I DR'="" D ^DIE S IBOK=$D(Y)=0
"RTN","IBCEOB",61,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad record 5 data"
"RTN","IBCEOB",62,0)
 Q IBOK
"RTN","IBCEOB",63,0)
 ;
"RTN","IBCEOB",64,0)
6(IB0,IBEGBL,IBEOB) ; Record '06' - corrected patient name and/or ID#
"RTN","IBCEOB",65,0)
 ; This data is not going to be filed into file 361.1 so the value of this function will always be a 1 so as to
"RTN","IBCEOB",66,0)
 ; not interrupt the filing process of the EOB/MRA data into file 361.1.
"RTN","IBCEOB",67,0)
 ;
"RTN","IBCEOB",68,0)
 ; perform overall integrity checks on the incoming 06 record.  If anything is out of place, don't update anything
"RTN","IBCEOB",69,0)
 ; and report the problem and get out.
"RTN","IBCEOB",70,0)
 NEW CLM,SITE,IBM,IBIFN,IBIFN1,DFN,SEQ,DIE,DA,DR
"RTN","IBCEOB",71,0)
 S DIE=361.1,DA=IBEOB,DR="61.01////^S X=IB0" D ^DIE    ; archive the raw 06 record data
"RTN","IBCEOB",72,0)
 S CLM=$P(IB0,U,2),SITE=+CLM,CLM=$P(CLM,"-",2) I CLM="" D MSG(IBEOB,"The claim# in piece 2 is invalid.") G Q6
"RTN","IBCEOB",73,0)
 S IBM=$G(^IBM(361.1,IBEOB,0))
"RTN","IBCEOB",74,0)
 I $P(IBM,U,4)'=1 D MSG(IBEOB,"This is a non-Medicare EOB.") G Q6
"RTN","IBCEOB",75,0)
 S IBIFN=+$P(IBM,U,1)                    ; claim# from MRA
"RTN","IBCEOB",76,0)
 S IBIFN1=+$O(^DGCR(399,"B",CLM,""))     ; claim# from 06 record
"RTN","IBCEOB",77,0)
 I IBIFN'=IBIFN1 D MSG(IBEOB,"Claim mismatch error."_IBIFN_","_IBIFN1_","_CLM_".") G Q6
"RTN","IBCEOB",78,0)
 I $P($$SITE^VASITE,U,3)'=SITE D MSG(IBEOB,"Invalid station# mismatch."_$P($$SITE^VASITE,U,3)_","_SITE_".") G Q6
"RTN","IBCEOB",79,0)
 S SEQ=$$COBN^IBCEF(IBIFN)               ; current payer sequence# on claim
"RTN","IBCEOB",80,0)
 I '$$WNRBILL^IBEFUNC(IBIFN,SEQ) D MSG(IBEOB,"The current payer on this claim is not MEDICARE (WNR).") G Q6
"RTN","IBCEOB",81,0)
 S DFN=+$P($G(^DGCR(399,IBIFN,0)),U,2)   ; patient ien
"RTN","IBCEOB",82,0)
 I 'DFN D MSG(IBEOB,"The patient DFN cannot be determined.") G Q6
"RTN","IBCEOB",83,0)
 ;
"RTN","IBCEOB",84,0)
 D UPD^IBCEOB01(IB0,IBEOB,IBIFN,DFN,SEQ)     ; update patient insurance policy data
"RTN","IBCEOB",85,0)
 ;
"RTN","IBCEOB",86,0)
Q6 ; exit point for $$6 function
"RTN","IBCEOB",87,0)
 Q 1
"RTN","IBCEOB",88,0)
 ;
"RTN","IBCEOB",89,0)
10(IB0,IBEGBL,IBEOB) ; Record '10'
"RTN","IBCEOB",90,0)
 ;
"RTN","IBCEOB",91,0)
 N DA,DR,DIE,X,Y,VAL,IBOK
"RTN","IBCEOB",92,0)
 S DIE="^IBM(361.1,",DA=IBEOB
"RTN","IBCEOB",93,0)
 S DR=".13////"_$S($P(IB0,U,3)="Y":1,$P(IB0,U,4)="Y":2,$P(IB0,U,5)="Y":3,$P(IB0,U,6)="Y":4,1:5)_";.21////"_$P(IB0,U,7)
"RTN","IBCEOB",94,0)
 S DR=DR_";2.04////"_$$DOLLAR($P(IB0,U,10))_";1.01////"_$$DOLLAR($P(IB0,U,11))_$S($P(IB0,U,12)'="":";.14///"_$P(IB0,U,12),1:"")
"RTN","IBCEOB",95,0)
 S DR=DR_$S($P(IB0,U,13)'="":";.1///"_$P(IB0,U,13),1:"")_";.11///"_($P(IB0,U,14)/10000)_";.12///"_($P(IB0,U,15)/100)
"RTN","IBCEOB",96,0)
 I $P(IB0,U,8)'="" S DR=DR_";.08////"_$P(IB0,U,8)_$S($P(IB0,U,9)'="":";.09///"_$P(IB0,U,9),1:"")
"RTN","IBCEOB",97,0)
 ;
"RTN","IBCEOB",98,0)
 D ^DIE
"RTN","IBCEOB",99,0)
 S IBOK=($D(Y)=0)
"RTN","IBCEOB",100,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad record 10 data" G Q10
"RTN","IBCEOB",101,0)
 ;
"RTN","IBCEOB",102,0)
 ; File ICN in Bill
"RTN","IBCEOB",103,0)
 D ICN^IBCEOB00(IBEOB,$P(IB0,U,12),$P($G(^IBM(361.1,IBEOB,0)),U,15),.IBOK)
"RTN","IBCEOB",104,0)
 ;
"RTN","IBCEOB",105,0)
Q10 Q IBOK
"RTN","IBCEOB",106,0)
 ;
"RTN","IBCEOB",107,0)
15(IB0,IBEGBL,IBEOB) ; Record '15'
"RTN","IBCEOB",108,0)
 ; Moved due to space constraints
"RTN","IBCEOB",109,0)
Q15 Q $$15^IBCEOB00(IB0,IBEGBL,IBEOB)
"RTN","IBCEOB",110,0)
 ;
"RTN","IBCEOB",111,0)
17(IB0,IBEGBL,IBEOB) ; Record '17'
"RTN","IBCEOB",112,0)
 N A,IBOK
"RTN","IBCEOB",113,0)
 S A="3;25.01;0;1;0^4;25.02;0;1;0^5;25.03;0;1;0^6;25.04;0;1;0^7;25.05;0;1;0^8;25.06;0;1;0^9;25.07;0;1;0"
"RTN","IBCEOB",114,0)
 S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB)
"RTN","IBCEOB",115,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad record 17 data"
"RTN","IBCEOB",116,0)
Q17 Q IBOK
"RTN","IBCEOB",117,0)
 ;
"RTN","IBCEOB",118,0)
20(IB0,IBEGBL,IBEOB) ; Record '20'
"RTN","IBCEOB",119,0)
 ; Moved due to space constraints
"RTN","IBCEOB",120,0)
Q20 Q $$20^IBCEOB00(IB0,IBEGBL,IBEOB)
"RTN","IBCEOB",121,0)
 ;
"RTN","IBCEOB",122,0)
30(IB0,IBEGBL,IBEOB) ; Record '30'
"RTN","IBCEOB",123,0)
 ;
"RTN","IBCEOB",124,0)
 N IBOK
"RTN","IBCEOB",125,0)
 D 30^IBCEOB0(IB0,IBEOB,.IBOK)
"RTN","IBCEOB",126,0)
Q30 Q $G(IBOK)
"RTN","IBCEOB",127,0)
 ;
"RTN","IBCEOB",128,0)
35(IB0,IBEGBL,IBEOB) ; Record '35'
"RTN","IBCEOB",129,0)
 ; Moved due to space constraints
"RTN","IBCEOB",130,0)
Q35 Q $$35^IBCEOB00(IB0,IBEGBL,IBEOB)
"RTN","IBCEOB",131,0)
 ;
"RTN","IBCEOB",132,0)
37(IB0,IBEGBL,IBEOB) ; Record '37'
"RTN","IBCEOB",133,0)
 ; Moved due to space constraints
"RTN","IBCEOB",134,0)
Q37 Q $$37^IBCEOB00(IB0,IBEGBL,IBEOB)
"RTN","IBCEOB",135,0)
 ;
"RTN","IBCEOB",136,0)
40(IB0,IBEGBL,IBEOB) ; Record '40'
"RTN","IBCEOB",137,0)
 ;
"RTN","IBCEOB",138,0)
 N IBOK
"RTN","IBCEOB",139,0)
 D 40^IBCEOB0(IB0,IBEOB,.IBOK)
"RTN","IBCEOB",140,0)
Q40 Q $G(IBOK)
"RTN","IBCEOB",141,0)
 ;
"RTN","IBCEOB",142,0)
41(IB0,IBEGBL,IBEOB) ; Record '41'
"RTN","IBCEOB",143,0)
 ;
"RTN","IBCEOB",144,0)
 N IBOK
"RTN","IBCEOB",145,0)
 D 41^IBCEOB0(IB0,IBEOB,.IBOK)
"RTN","IBCEOB",146,0)
Q41 Q $G(IBOK)
"RTN","IBCEOB",147,0)
 ;
"RTN","IBCEOB",148,0)
42(IB0,IBEGBL,IBEOB) ; Record '42'
"RTN","IBCEOB",149,0)
 ;
"RTN","IBCEOB",150,0)
 N IBOK
"RTN","IBCEOB",151,0)
 D 42^IBCEOB0(IB0,IBEOB,.IBOK)
"RTN","IBCEOB",152,0)
Q42 Q $G(IBOK)
"RTN","IBCEOB",153,0)
 ;
"RTN","IBCEOB",154,0)
45(IB0,IBEGBL,IBEOB) ; Record '45'
"RTN","IBCEOB",155,0)
 ;
"RTN","IBCEOB",156,0)
 N IBOK
"RTN","IBCEOB",157,0)
 D 45^IBCEOB0(IB0,IBEOB,.IBOK)
"RTN","IBCEOB",158,0)
 Q $G(IBOK)
"RTN","IBCEOB",159,0)
 ;
"RTN","IBCEOB",160,0)
MSG(IBEOB,MSG) ; procedure to file message into field 6.03
"RTN","IBCEOB",161,0)
 ; Results of processing of the "06" record type
"RTN","IBCEOB",162,0)
 N DIE,DA,DR,Z
"RTN","IBCEOB",163,0)
 S DIE=361.1,DA=+$G(IBEOB)
"RTN","IBCEOB",164,0)
 I $G(MSG)="" G MSGX
"RTN","IBCEOB",165,0)
 S Z=$P($G(^IBM(361.1,DA,6)),U,3)    ; already existing message
"RTN","IBCEOB",166,0)
 I Z'="" S MSG=Z_"  "_MSG            ; append new message to existing message
"RTN","IBCEOB",167,0)
 S MSG=$E(MSG,1,190)
"RTN","IBCEOB",168,0)
 S DR="6.03///^S X=MSG"
"RTN","IBCEOB",169,0)
 D ^DIE
"RTN","IBCEOB",170,0)
MSGX ;
"RTN","IBCEOB",171,0)
 Q
"RTN","IBCEOB",172,0)
 ;
"RTN","IBCEOB",173,0)
DOLLAR(X) ; Convert value in X to dollar format XXX.XX
"RTN","IBCEOB",174,0)
 Q $S(+X:$J(X/100,$L(+X),2),1:0)
"RTN","IBCEOB",175,0)
 ;
"RTN","IBCEOB",176,0)
ADD3611(IBMNUM,IBTBILL,IBBATCH,X,IBAR,IBFILE) ; Add stub record to file 361.1
"RTN","IBCEOB",177,0)
 ; X = the ien of the referenced bill in file 399
"RTN","IBCEOB",178,0)
 ; IBTBILL = ien of transmitted bill (optional)
"RTN","IBCEOB",179,0)
 ; IBBATCH = ien of batch # the transmitted bill was in (optional)
"RTN","IBCEOB",180,0)
 ; IBMNUM = the message # from which this record originally came
"RTN","IBCEOB",181,0)
 ; IBAR = 1 only if called from AR
"RTN","IBCEOB",182,0)
 ; IBFILE = array reference of raw EOB data
"RTN","IBCEOB",183,0)
 ;
"RTN","IBCEOB",184,0)
 N DIC,DA,DR,DO,DD,DLAYGO,Y,REVSTAT,BS,MMI
"RTN","IBCEOB",185,0)
 F  L +^IBM(361.1,0):10 Q:$T
"RTN","IBCEOB",186,0)
 ;
"RTN","IBCEOB",187,0)
 ; default proper review status
"RTN","IBCEOB",188,0)
 S BS=$P($G(^DGCR(399,X,0)),U,13)   ; bill status
"RTN","IBCEOB",189,0)
 S REVSTAT=$S(BS=7:9,BS=3:3,BS=4:3,1:0)
"RTN","IBCEOB",190,0)
 S MMI=$$NET^XMRENT(IBMNUM)         ; MailMan header info
"RTN","IBCEOB",191,0)
 S DIC(0)="L",DIC="^IBM(361.1,",DLAYGO=361.1
"RTN","IBCEOB",192,0)
 S DIC("DR")=".16////"_REVSTAT_";.17////0"_";100.02////"_IBMNUM_$S('$G(IBAR):";.19////"_+IBTBILL_";100.01////"_IBBATCH,1:"")
"RTN","IBCEOB",193,0)
 S DIC("DR")=DIC("DR")_";100.05////"_$$CHKSUM^IBCEMU1(IBFILE)_";62.01////^S X=MMI"
"RTN","IBCEOB",194,0)
 D FILE^DICN
"RTN","IBCEOB",195,0)
 L -^IBM(361.1,0)
"RTN","IBCEOB",196,0)
 Q +Y
"RTN","IBCEOB",197,0)
 ;
"RTN","IBCEOB",198,0)
UPD3611(IBEOB,IBTDA,IBAR) ; From flat file 835 format, add EOB record
"RTN","IBCEOB",199,0)
 ; IBEOB = the ien of the entry in file 361.1 being updated
"RTN","IBCEOB",200,0)
 ; IBTDA = the ien in the source file
"RTN","IBCEOB",201,0)
 ; IBAR = 1 if being called from AR
"RTN","IBCEOB",202,0)
 N IBA1,IBFILE,IBEGBL,Z,IBREC,Q
"RTN","IBCEOB",203,0)
 S IBFILE=$S('$G(IBAR):"^IBA(364.2,"_IBTDA_",2)",1:"^TMP("_$J_",""RCDP-EOB"","_IBTDA_")")
"RTN","IBCEOB",204,0)
 S IBEGBL=$S('$G(IBAR):"IBCERR-EOB",1:"RCDPERR-EOB")
"RTN","IBCEOB",205,0)
 I $G(IBAR),'$$HDR^IBCEOB1($G(^TMP($J,"RCDPEOB","HDR")),IBEGBL,IBEOB) Q
"RTN","IBCEOB",206,0)
 S IBA1=0
"RTN","IBCEOB",207,0)
 F  S IBA1=$O(@IBFILE@(IBA1)) Q:'IBA1  S IB0=$S('$G(IBAR):$P($G(^(IBA1,0)),"##RAW DATA: ",2),1:$G(@IBFILE@(IBA1,0))) I IB0'="" D
"RTN","IBCEOB",208,0)
 . S IBREC=+IB0
"RTN","IBCEOB",209,0)
 . I IBREC'=37 K ^TMP($J,37)
"RTN","IBCEOB",210,0)
 . I IBREC S IB="S IBOK=$$"_IBREC_"(IB0,IBEGBL,IBEOB)",Q=IBREC_"^IBCEOB" I $T(@Q)'="" X IB S:'IBOK ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)=$S('$G(IBAR):"  ##RAW DATA: ",1:"")_IB0
"RTN","IBCEOB",211,0)
 ;
"RTN","IBCEOB",212,0)
 Q
"RTN","IBCEOB",213,0)
 ;
"RTN","IBCEOB",214,0)
ERRUPD(IBEOB,IBEGBL) ; Update error text in entry, if needed
"RTN","IBCEOB",215,0)
 D WP^DIE(361.1,IBEOB_",",20,"","^TMP(IBEGBL,$J)","")
"RTN","IBCEOB",216,0)
 Q
"RTN","IBCEOB",217,0)
 ;
"RTN","IBCEOB",218,0)
 ;
"RTN","IBCEOB",219,0)
DUP(IBARRAY,IBIFN) ; Duplicate Check
"RTN","IBCEOB",220,0)
 ; This function determines if the EOB data already exists in file
"RTN","IBCEOB",221,0)
 ; 361.1 by comparing the checksums of the raw 835 data.
"RTN","IBCEOB",222,0)
 ;
"RTN","IBCEOB",223,0)
 ; IBARRAY = Literal array reference where the raw 835 data exists.
"RTN","IBCEOB",224,0)
 ;           The data exists at @IBARRAY@(n,0), where n is the seq#.
"RTN","IBCEOB",225,0)
 ;           For example, IBARRAY = "^IBA(364.2,IBIEN,2)"
"RTN","IBCEOB",226,0)
 ;
"RTN","IBCEOB",227,0)
 ; IBIFN = the bill # (ptr to 399).  The checksums of the EOB's on 
"RTN","IBCEOB",228,0)
 ;         file for this bill will be compared to the checksum of the
"RTN","IBCEOB",229,0)
 ;         835 raw data in the IBARRAY reference.
"RTN","IBCEOB",230,0)
 ;
"RTN","IBCEOB",231,0)
 ; This function returns 0 if the entry is not found (no duplicate),
"RTN","IBCEOB",232,0)
 ; Otherwise, the IEN of the entry in file 361.1 is returned if this
"RTN","IBCEOB",233,0)
 ; is a duplicate EOB.
"RTN","IBCEOB",234,0)
 ;
"RTN","IBCEOB",235,0)
 NEW DUP,IBEOB,CHKSUM1,CHKSUM2
"RTN","IBCEOB",236,0)
 S DUP=0,IBIFN=+$G(IBIFN)
"RTN","IBCEOB",237,0)
 I $G(IBARRAY)=""!'IBIFN G DUPX
"RTN","IBCEOB",238,0)
 I '$D(^IBM(361.1,"B",IBIFN)) G DUPX     ; no EOB's on file yet
"RTN","IBCEOB",239,0)
 S CHKSUM1=$$CHKSUM^IBCEMU1(IBARRAY)     ; checksum of current EOB
"RTN","IBCEOB",240,0)
 I 'CHKSUM1 G DUPX                       ; must be able to be calculated
"RTN","IBCEOB",241,0)
 S IBEOB=0
"RTN","IBCEOB",242,0)
 F  S IBEOB=$O(^IBM(361.1,"B",IBIFN,IBEOB)) Q:'IBEOB  D  Q:DUP
"RTN","IBCEOB",243,0)
 . S CHKSUM2=+$P($G(^IBM(361.1,IBEOB,100)),U,5)   ; checksum of old EOB
"RTN","IBCEOB",244,0)
 . I 'CHKSUM2 Q
"RTN","IBCEOB",245,0)
 . I CHKSUM1=CHKSUM2 S DUP=IBEOB Q                    ; comparison
"RTN","IBCEOB",246,0)
 . Q
"RTN","IBCEOB",247,0)
DUPX ;
"RTN","IBCEOB",248,0)
 Q DUP
"RTN","IBCEOB",249,0)
 ;
"RTN","IBCEOB00")
0^26^B75423000^B60829108
"RTN","IBCEOB00",1,0)
IBCEOB00 ;ALB/ESG - 835 EDI EOB MSG PROCESSING CONT ;30-JUN-2003
"RTN","IBCEOB00",2,0)
 ;;2.0;INTEGRATED BILLING;**155,349,377**;21-MAR-94;Build 23
"RTN","IBCEOB00",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEOB00",4,0)
 Q
"RTN","IBCEOB00",5,0)
 ;
"RTN","IBCEOB00",6,0)
RCRU(IBZDATA,IB0,IBLN) ; Revenue Code Roll-up procedure check -
"RTN","IBCEOB00",7,0)
 ; Total up outbound line items by revenue code and compare with
"RTN","IBCEOB00",8,0)
 ; incoming EOB 40 record to see if it has been rolled up
"RTN","IBCEOB00",9,0)
 ;
"RTN","IBCEOB00",10,0)
 ; IBZDATA - UB output formatter array, passed by reference
"RTN","IBCEOB00",11,0)
 ; IB0     - 40 record data
"RTN","IBCEOB00",12,0)
 ; IBLN    - output parameter, passed by reference
"RTN","IBCEOB00",13,0)
 ;
"RTN","IBCEOB00",14,0)
 NEW Z,LN,REV,UN,CH,RUD,RUD2,UCH,MRAUCH
"RTN","IBCEOB00",15,0)
 I $P(IB0,U,4)="" G RCRUX
"RTN","IBCEOB00",16,0)
 S IBLN="",Z=0
"RTN","IBCEOB00",17,0)
 F  S Z=$O(IBZDATA(Z)) Q:'Z  S LN=IBZDATA(Z) D
"RTN","IBCEOB00",18,0)
 . S REV=$P(LN,U,1),UN=$P(LN,U,4),CH=$P(LN,U,5),UCH=+$P(LN,U,3)
"RTN","IBCEOB00",19,0)
 . I REV="" Q
"RTN","IBCEOB00",20,0)
 . ;
"RTN","IBCEOB00",21,0)
 . S RUD=$G(RUD(REV))                 ; roll up data array for rev code
"RTN","IBCEOB00",22,0)
 . S $P(RUD,U,1)=$P(RUD,U,1)+CH       ; total charges
"RTN","IBCEOB00",23,0)
 . S $P(RUD,U,2)=$P(RUD,U,2)+UN       ; total units
"RTN","IBCEOB00",24,0)
 . S $P(RUD,U,3)=$P(RUD,U,3)+1        ; total line items
"RTN","IBCEOB00",25,0)
 . S RUD(REV)=RUD
"RTN","IBCEOB00",26,0)
 . S RUD(REV,Z)=""
"RTN","IBCEOB00",27,0)
 . ;
"RTN","IBCEOB00",28,0)
 . S RUD2=$G(RUD2(REV,UCH))           ; roll up data array for rev code
"RTN","IBCEOB00",29,0)
 . S $P(RUD2,U,1)=$P(RUD2,U,1)+CH     ; total charges
"RTN","IBCEOB00",30,0)
 . S $P(RUD2,U,2)=$P(RUD2,U,2)+UN     ; total units
"RTN","IBCEOB00",31,0)
 . S $P(RUD2,U,3)=$P(RUD2,U,3)+1      ; total line items
"RTN","IBCEOB00",32,0)
 . S RUD2(REV,UCH)=RUD2
"RTN","IBCEOB00",33,0)
 . S RUD2(REV,UCH,Z)=""
"RTN","IBCEOB00",34,0)
 . ;
"RTN","IBCEOB00",35,0)
 . Q
"RTN","IBCEOB00",36,0)
 ;
"RTN","IBCEOB00",37,0)
 I '$D(RUD),'$D(RUD2) G RCRUX
"RTN","IBCEOB00",38,0)
 ;
"RTN","IBCEOB00",39,0)
 ; delete the revenue code roll-up, if only 1 line item.
"RTN","IBCEOB00",40,0)
 S REV=""     ; this is not a roll up situation
"RTN","IBCEOB00",41,0)
 F  S REV=$O(RUD(REV)) Q:REV=""  I $P(RUD(REV),U,3)=1 KILL RUD(REV)
"RTN","IBCEOB00",42,0)
 ;
"RTN","IBCEOB00",43,0)
 S (REV,UCH)=""
"RTN","IBCEOB00",44,0)
 F  S REV=$O(RUD2(REV)) Q:REV=""  F  S UCH=$O(RUD2(REV,UCH)) Q:UCH=""  I $P(RUD2(REV,UCH),U,3)=1 KILL RUD2(REV,UCH)
"RTN","IBCEOB00",45,0)
 ;
"RTN","IBCEOB00",46,0)
 I '$D(RUD),'$D(RUD2) G RCRUX
"RTN","IBCEOB00",47,0)
 ;
"RTN","IBCEOB00",48,0)
 S RUD=$G(RUD($P(IB0,U,4)))      ; compare with 40 record data
"RTN","IBCEOB00",49,0)
 I RUD="" G RCRU2                ; make sure it exists
"RTN","IBCEOB00",50,0)
 I $P(RUD,U,1)'=+$$DOLLAR^IBCEOB($P(IB0,U,15)) G RCRU2    ; charges
"RTN","IBCEOB00",51,0)
 I $P(RUD,U,2)'=$P(IB0,U,16) G RCRU2                      ; units
"RTN","IBCEOB00",52,0)
 S IBLN=$O(RUD($P(IB0,U,4),""))  ; use the first line# found
"RTN","IBCEOB00",53,0)
 G RCRUX
"RTN","IBCEOB00",54,0)
 ;
"RTN","IBCEOB00",55,0)
RCRU2 ; check roll-up data by rev code and unit charge
"RTN","IBCEOB00",56,0)
 S MRAUCH=0
"RTN","IBCEOB00",57,0)
 I $P(IB0,U,16) S MRAUCH=+$$DOLLAR^IBCEOB($P(IB0,U,15))/$P(IB0,U,16)
"RTN","IBCEOB00",58,0)
 S RUD2=$G(RUD2($P(IB0,U,4),MRAUCH))     ; compare with 40 record data
"RTN","IBCEOB00",59,0)
 I RUD2="" G RCRUX                       ; make sure it exists
"RTN","IBCEOB00",60,0)
 I $P(RUD2,U,1)'=+$$DOLLAR^IBCEOB($P(IB0,U,15)) G RCRUX   ; charges
"RTN","IBCEOB00",61,0)
 I $P(RUD2,U,2)'=$P(IB0,U,16) G RCRUX                     ; units
"RTN","IBCEOB00",62,0)
 S IBLN=$O(RUD2($P(IB0,U,4),MRAUCH,""))  ; use the first line# found
"RTN","IBCEOB00",63,0)
 ;
"RTN","IBCEOB00",64,0)
RCRUX ;
"RTN","IBCEOB00",65,0)
 Q
"RTN","IBCEOB00",66,0)
 ;
"RTN","IBCEOB00",67,0)
ICN(IBEOB,ICN,COBN,IBOK) ; File the 835 ICN into the Bill
"RTN","IBCEOB00",68,0)
 ;
"RTN","IBCEOB00",69,0)
 ; Input parameters
"RTN","IBCEOB00",70,0)
 ;   IBEOB - ien to file 361.1
"RTN","IBCEOB00",71,0)
 ;   ICN   - the ICN# from the 835 transmission
"RTN","IBCEOB00",72,0)
 ;   COBN  - the insurance sequence#
"RTN","IBCEOB00",73,0)
 ;
"RTN","IBCEOB00",74,0)
 ; Output parameter
"RTN","IBCEOB00",75,0)
 ;   IBOK  - returns as 0 if we get a filing error here
"RTN","IBCEOB00",76,0)
 ;
"RTN","IBCEOB00",77,0)
 ; The field in file 399 depends on the current payer sequence
"RTN","IBCEOB00",78,0)
 ;     399,453 - primary ICN
"RTN","IBCEOB00",79,0)
 ;     399,454 - secondary ICN
"RTN","IBCEOB00",80,0)
 ;     399,455 - tertiary ICN
"RTN","IBCEOB00",81,0)
 ;
"RTN","IBCEOB00",82,0)
 NEW IBIFN,FIELD,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","IBCEOB00",83,0)
 S IBEOB=+$G(IBEOB),COBN=+$G(COBN)
"RTN","IBCEOB00",84,0)
 I 'IBEOB!'COBN G ICNX
"RTN","IBCEOB00",85,0)
 S IBIFN=+$P($G(^IBM(361.1,IBEOB,0)),U,1)
"RTN","IBCEOB00",86,0)
 I '$D(^DGCR(399,IBIFN)) G ICNX
"RTN","IBCEOB00",87,0)
 I $G(ICN)="" G ICNX
"RTN","IBCEOB00",88,0)
 I '$F(".1.2.3.","."_COBN_".") G ICNX
"RTN","IBCEOB00",89,0)
 ;
"RTN","IBCEOB00",90,0)
 S FIELD=452+COBN
"RTN","IBCEOB00",91,0)
 S DIE=399,DA=IBIFN,DR=FIELD_"////"_ICN D ^DIE
"RTN","IBCEOB00",92,0)
 S IBOK=($D(Y)=0)
"RTN","IBCEOB00",93,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Error in filing the ICN into the Bill/Claims file"
"RTN","IBCEOB00",94,0)
ICNX ;
"RTN","IBCEOB00",95,0)
 Q
"RTN","IBCEOB00",96,0)
 ;
"RTN","IBCEOB00",97,0)
15(IB0,IBEGBL,IBEOB) ; Record '15'
"RTN","IBCEOB00",98,0)
 ;
"RTN","IBCEOB00",99,0)
 N A,IBOK
"RTN","IBCEOB00",100,0)
 ;
"RTN","IBCEOB00",101,0)
 S A="3;1.03;1;0;0^4;1.04;1;0;0^5;1.05;1;0;0^6;1.07;1;0;0^7;1.08;1;0;0^8;1.09;1;0;0^9;1.02;1;0;0^10;2.05;1;0;0"
"RTN","IBCEOB00",102,0)
 ;
"RTN","IBCEOB00",103,0)
 S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB)
"RTN","IBCEOB00",104,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad record 15 data" G Q15
"RTN","IBCEOB00",105,0)
 ;
"RTN","IBCEOB00",106,0)
 ; For Medicare MRA's only:
"RTN","IBCEOB00",107,0)
 ; If the Covered Amount is present (15 record, piece 3), then file
"RTN","IBCEOB00",108,0)
 ; a claim level adjustment with Group code=OA, Reason code=AB3.
"RTN","IBCEOB00",109,0)
 ;
"RTN","IBCEOB00",110,0)
 I $P($G(^IBM(361.1,IBEOB,0)),U,4)=1,+$P(IB0,U,3) D
"RTN","IBCEOB00",111,0)
 . N IB20
"RTN","IBCEOB00",112,0)
 . S IB20=20_U_$P(IB0,U,2)_U_"OA"_U_"AB3"_U_$P(IB0,U,3)_U_"0000000000"
"RTN","IBCEOB00",113,0)
 . S IB20=IB20_U_"Covered Amount"
"RTN","IBCEOB00",114,0)
 . S IBOK=$$20(IB20,IBEGBL,IBEOB)
"RTN","IBCEOB00",115,0)
 . I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Could not file the OA-AB3 claim level adjustment for the Covered Amount"
"RTN","IBCEOB00",116,0)
 . K ^TMP($J,20)
"RTN","IBCEOB00",117,0)
 . Q
"RTN","IBCEOB00",118,0)
 ;
"RTN","IBCEOB00",119,0)
Q15 Q IBOK
"RTN","IBCEOB00",120,0)
 ;
"RTN","IBCEOB00",121,0)
20(IB0,IBEGBL,IBEOB) ; Record '20'
"RTN","IBCEOB00",122,0)
 ;
"RTN","IBCEOB00",123,0)
 N A,LEVEL,IBGRP,IBDA,IBOK
"RTN","IBCEOB00",124,0)
 ;
"RTN","IBCEOB00",125,0)
 S IBGRP=$P(IB0,U,3)
"RTN","IBCEOB00",126,0)
 I IBGRP'="" S ^TMP($J,20)=IBGRP
"RTN","IBCEOB00",127,0)
 I IBGRP="" S IBGRP=$G(^TMP($J,20))
"RTN","IBCEOB00",128,0)
 I IBGRP="" S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Missing claim level adjustment group code" G Q20
"RTN","IBCEOB00",129,0)
 ;
"RTN","IBCEOB00",130,0)
 S IBDA(1)=$O(^IBM(361.1,IBEOB,10,"B",IBGRP,0))
"RTN","IBCEOB00",131,0)
 ;
"RTN","IBCEOB00",132,0)
 I 'IBDA(1) D  ;Needs a new entry at group level
"RTN","IBCEOB00",133,0)
 . N X,Y,DA,DD,DO,DIC,DLAYGO
"RTN","IBCEOB00",134,0)
 . S DIC="^IBM(361.1,"_IBEOB_",10,",DIC(0)="L",DLAYGO=361.11,DA(1)=IBEOB
"RTN","IBCEOB00",135,0)
 . S DIC("P")=$$GETSPEC^IBEFUNC(361.1,10)
"RTN","IBCEOB00",136,0)
 . S X=IBGRP
"RTN","IBCEOB00",137,0)
 . D FILE^DICN K DIC,DO,DD,DLAYGO
"RTN","IBCEOB00",138,0)
 . I Y<0 K IBDA S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Adjustment group code could not be added" Q
"RTN","IBCEOB00",139,0)
 . S IBDA(1)=+Y
"RTN","IBCEOB00",140,0)
 ;
"RTN","IBCEOB00",141,0)
 I $G(IBDA(1)) D  ;Add a new entry at the reason code level
"RTN","IBCEOB00",142,0)
 . S DIC="^IBM(361.1,"_IBEOB_",10,"_IBDA(1)_",1,",DIC(0)="L",DLAYGO=361.111,DA(2)=IBEOB,DA(1)=IBDA(1)
"RTN","IBCEOB00",143,0)
 . S DIC("P")=$$GETSPEC^IBEFUNC(361.11,1)
"RTN","IBCEOB00",144,0)
 . S X=$P(IB0,U,4)
"RTN","IBCEOB00",145,0)
 . D FILE^DICN K DIC,DO,DD,DLAYGO
"RTN","IBCEOB00",146,0)
 . I Y<0 K IBDA S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Adjustment reason code could not be added" Q
"RTN","IBCEOB00",147,0)
 . S IBDA=+Y
"RTN","IBCEOB00",148,0)
 ;
"RTN","IBCEOB00",149,0)
 I $G(IBDA) D
"RTN","IBCEOB00",150,0)
 . S LEVEL=10,LEVEL("DIE")="^IBM(361.1,"_IBEOB_",10,"_IBDA(1)_",1,"
"RTN","IBCEOB00",151,0)
 . S LEVEL(0)=IBDA,LEVEL(1)=IBDA(1),LEVEL(2)=IBEOB
"RTN","IBCEOB00",152,0)
 . S A="5;.02;1;0;0^6;.03;0;1;1^7;.04;0;1;0"
"RTN","IBCEOB00",153,0)
 . S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB,.LEVEL)
"RTN","IBCEOB00",154,0)
 . I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad adjustment reason code ("_$P(IB0,U,4)_") data" Q
"RTN","IBCEOB00",155,0)
Q20 Q $G(IBOK)
"RTN","IBCEOB00",156,0)
 ;
"RTN","IBCEOB00",157,0)
35(IB0,IBEGBL,IBEOB) ; Record '35'
"RTN","IBCEOB00",158,0)
 ;
"RTN","IBCEOB00",159,0)
 N A,IBOK
"RTN","IBCEOB00",160,0)
 ;
"RTN","IBCEOB00",161,0)
 S A="3;4.12;1;0;0^4;4.13;1;0;0^5;4.14;0;1;1^6;4.15;1;0;0^7;4.16;1;0;0^8;4.17;1;0;0^9;4.18;1;0;0^10;4.04;1;0;0^11;3.01;0;1;1^12;3.02;1;0;0^13;3.08;1;0;0^14;3.09;1;0;0"
"RTN","IBCEOB00",162,0)
 ;
"RTN","IBCEOB00",163,0)
 S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB)
"RTN","IBCEOB00",164,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad MEDICARE Inpt Adjudication data"
"RTN","IBCEOB00",165,0)
Q35 Q $G(IBOK)
"RTN","IBCEOB00",166,0)
 ;
"RTN","IBCEOB00",167,0)
37(IB0,IBEGBL,IBEOB) ; Record '37'
"RTN","IBCEOB00",168,0)
 ;
"RTN","IBCEOB00",169,0)
 N IBOK,IBCT
"RTN","IBCEOB00",170,0)
 S IBCT=$G(^TMP($J,37))+1
"RTN","IBCEOB00",171,0)
 I IBCT>5 S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Too many Medicare Claim Level Adjudication Remarks" G Q37    ; Max 5 allowed
"RTN","IBCEOB00",172,0)
 S A="4;"_$S($P(IB0,U,3)="O":"3.0"_(IBCT+2),1:"5.0"_IBCT)_";0;0;0^5;5.0"_IBCT_"1;0;0;0"
"RTN","IBCEOB00",173,0)
 S IBOK=$$STORE^IBCEOB1(A,IB0,IBEOB)
"RTN","IBCEOB00",174,0)
 I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Bad Medicare Claim Level Adjudication Remarks data"
"RTN","IBCEOB00",175,0)
 ;
"RTN","IBCEOB00",176,0)
 ; 4/22/03 - esg - If claim level remark code MA15 is reported, then
"RTN","IBCEOB00",177,0)
 ;         this is a split EOB and we need to change the REVIEW STATUS
"RTN","IBCEOB00",178,0)
 ;         of this EOB to be ACCEPTED-INTERIM EOB.
"RTN","IBCEOB00",179,0)
 ;
"RTN","IBCEOB00",180,0)
 I $P(IB0,U,4)["MA15" D
"RTN","IBCEOB00",181,0)
 . N DA,DIE,DR,DIC
"RTN","IBCEOB00",182,0)
 . S DA=IBEOB,DIE=361.1,DR=".16////2" D ^DIE S IBOK=($D(Y)=0)
"RTN","IBCEOB00",183,0)
 . I 'IBOK S ^TMP(IBEGBL,$J,+$O(^TMP(IBEGBL,$J,""),-1)+1)="Split EOB, but review status was not updated correctly"
"RTN","IBCEOB00",184,0)
 . Q
"RTN","IBCEOB00",185,0)
 ;
"RTN","IBCEOB00",186,0)
Q37 S ^TMP($J,37)=$G(^TMP($J,37))+1 ; Saves the # of entries for 37 records
"RTN","IBCEOB00",187,0)
 Q $G(IBOK)
"RTN","IBCEOB00",188,0)
 ;
"RTN","IBCEOB00",189,0)
 ;
"RTN","IBCEOB00",190,0)
DET40(IB0,ARRAY) ; Format important details of record 40 for error
"RTN","IBCEOB00",191,0)
 ; IB0 = data on 40 record (some pieces pre-formatted)
"RTN","IBCEOB00",192,0)
 ;  ARRAY(n)=formatted line is returned if passed by ref
"RTN","IBCEOB00",193,0)
 N Q
"RTN","IBCEOB00",194,0)
 S ARRAY(1)="Payer reported the following was billed to them:"
"RTN","IBCEOB00",195,0)
 S ARRAY(2)=" "_$S($P(IB0,U,21)="NU":"Rev Cd",1:"Proc")_": "_$S($P(IB0,U,10)'="":$P(IB0,U,10),1:"Same as adjudicated")_"  Chg: "_$J($P(IB0,U,15)/100,"",2)_"  Units: "_$S($P(IB0,U,16):$P(IB0,U,16),1:1)
"RTN","IBCEOB00",196,0)
 S ARRAY(3)="  Svc Date(s): "_$S($P(IB0,U,19)'="":$$FDT($P(IB0,U,19)),1:"??")_$S($P(IB0,U,20)'="":"-"_$$FDT($P(IB0,U,20)),1:"")
"RTN","IBCEOB00",197,0)
 I $P(IB0,U,11)'="" S ARRAY(3)=ARRAY(3)_"  Mods: " F Q=11:1:14 I $P(IB0,U,Q)'="" S ARRAY(3)=ARRAY(3)_$P(IB0,U,Q)_$S(Q=14:"",$P(IB0,U,Q+1)'="":",",1:"")
"RTN","IBCEOB00",198,0)
 S ARRAY(4)="Payer reported adjudication on:"
"RTN","IBCEOB00",199,0)
 S ARRAY(5)=" "_$S($P(IB0,U,21)="NU":"Rev Cd",1:"Proc")_": "_$S($P(IB0,U,3)'="":$P(IB0,U,3),1:$P(IB0,U,4))
"RTN","IBCEOB00",200,0)
 S ARRAY(5)=ARRAY(5)_"  Type: "_$P(IB0,U,21)_$S($P(IB0,U,21)'="NU":"  Rev Cd: "_$P(IB0,U,4),1:"")_"  Units: "_$S($P(IB0,U,18):$P(IB0,U,18)/100,1:1)_"  Amt: "_$J($P(IB0,U,17)/100,"",2)
"RTN","IBCEOB00",201,0)
 I $P(IB0,U,5)'="" S ARRAY(5)=ARRAY(5)_"  Mods: " F Q=5:1:8 I $P(IB0,U,Q)'="" S ARRAY(5)=ARRAY(5)_$P(IB0,U,Q)_$S(Q=8:"",$P(IB0,U,Q+1)'="":",",1:"")
"RTN","IBCEOB00",202,0)
 Q
"RTN","IBCEOB00",203,0)
 ;
"RTN","IBCEOB00",204,0)
DET4X(RECID,IB0,ARRAY) ; Format important details of record 41-45 for error
"RTN","IBCEOB00",205,0)
 ; RECID = 41,42,45
"RTN","IBCEOB00",206,0)
 ; IB0 = data on RECID record
"RTN","IBCEOB00",207,0)
 ;  ARRAY(n)=formatted line is returned if passed by ref
"RTN","IBCEOB00",208,0)
 N CT,Q
"RTN","IBCEOB00",209,0)
 I RECID=41 D  Q
"RTN","IBCEOB00",210,0)
 . S ARRAY(1)="Allowed Amt: "_$J($P(IB0,U,3)/100,"",2)_"  Per Diem Amt: "_$J($P(IB0,U,4)/100,"",2)
"RTN","IBCEOB00",211,0)
 ;
"RTN","IBCEOB00",212,0)
 I RECID=42 D  Q
"RTN","IBCEOB00",213,0)
 . S ARRAY(1)="Line Item Remark Code: "_$P(IB0,U,3)
"RTN","IBCEOB00",214,0)
 . I $P(IB0,U,4)'="" S CT=1 F Q=0:80:190 I $E($P(IB0,U,4),Q+1,Q+80)'="" S CT=CT+1,ARRAY(CT)=$E($P(IB0,U,4),Q+1,Q+80)
"RTN","IBCEOB00",215,0)
 ;
"RTN","IBCEOB00",216,0)
 I RECID=45 D
"RTN","IBCEOB00",217,0)
 . S ARRAY(1)="Adj Group Cd: "_$P(IB0,U,3)_"  Reason Cd: "_$P(IB0,U,4)_"  Amt: "_$J($P(IB0,U,5)/100,"",2)_"  Quantity: "_+$P(IB0,U,6)
"RTN","IBCEOB00",218,0)
 . I $P(IB0,U,7)'="" S CT=1 F Q=0:80:190 I $E($P(IB0,U,7),Q+1,Q+80)'="" S CT=CT+1,ARRAY(CT)=$E($P(IB0,U,7),Q+1,Q+80)
"RTN","IBCEOB00",219,0)
 Q
"RTN","IBCEOB00",220,0)
 ; 
"RTN","IBCEOB00",221,0)
FDT(X) ; Format date in X (YYYYMMDD) to MM/DD/YYYY
"RTN","IBCEOB00",222,0)
 S:X'="" X=$E(X,5,6)_"/"_$E(X,7,8)_"/"_$E(X,1,4)
"RTN","IBCEOB00",223,0)
 Q X
"RTN","IBCEOB00",224,0)
 ;
"RTN","IBCEOB01")
0^27^B24417822^n/a
"RTN","IBCEOB01",1,0)
IBCEOB01 ;ALB/ESG - 835 EDI EOB MSG PROCESSING CONT ;16-JAN-2008
"RTN","IBCEOB01",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBCEOB01",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEOB01",4,0)
 ;
"RTN","IBCEOB01",5,0)
 Q
"RTN","IBCEOB01",6,0)
 ;
"RTN","IBCEOB01",7,0)
 ; This routine processes the "06" record on the incoming 835 and
"RTN","IBCEOB01",8,0)
 ; updates the patient insurance files with the corrected name and/or
"RTN","IBCEOB01",9,0)
 ; subscriber ID# data.
"RTN","IBCEOB01",10,0)
 ;
"RTN","IBCEOB01",11,0)
UPD(IB0,IBEOB,IBIFN,DFN,SEQ) ; update pat ins policy data
"RTN","IBCEOB01",12,0)
 ; IB0   - This is the full "06" record data
"RTN","IBCEOB01",13,0)
 ; IBEOB - ien# to file 361.1
"RTN","IBCEOB01",14,0)
 ; IBIFN - ien# to file 399
"RTN","IBCEOB01",15,0)
 ; DFN   - patient ien# to file 2
"RTN","IBCEOB01",16,0)
 ; SEQ   - payer sequence number
"RTN","IBCEOB01",17,0)
 ;
"RTN","IBCEOB01",18,0)
 NEW CORRID,IBIT,IBZ,IBZ1,IDCHG,INS,MAX,NAMECHG,NNM,NNM1,PD,POL,X,MCRSFX,MCRLEN,LN
"RTN","IBCEOB01",19,0)
 ;
"RTN","IBCEOB01",20,0)
 ; patient ID# processing
"RTN","IBCEOB01",21,0)
 S IDCHG=0   ; flag indicating an ID# change
"RTN","IBCEOB01",22,0)
 S CORRID=$P(IB0,U,6)   ; corrected patient ID#
"RTN","IBCEOB01",23,0)
 S CORRID=$TR(CORRID,"-","")
"RTN","IBCEOB01",24,0)
 I CORRID'="" D
"RTN","IBCEOB01",25,0)
 . I $$VALHIC^IBCNSMM(CORRID) S IDCHG=1   ; valid HIC#
"RTN","IBCEOB01",26,0)
 . E  D MSG^IBCEOB(IBEOB,"The corrected ID# "_CORRID_" is not a valid Medicare HIC#.  No ID# correction done.")
"RTN","IBCEOB01",27,0)
 . Q
"RTN","IBCEOB01",28,0)
 ;
"RTN","IBCEOB01",29,0)
 ; corrected name processing
"RTN","IBCEOB01",30,0)
 S NAMECHG=0   ; flag indicating a name change
"RTN","IBCEOB01",31,0)
 I $P(IB0,U,3)="",$P(IB0,U,4)="",$P(IB0,U,5)="" G UPD1    ; no corrected name components indicated
"RTN","IBCEOB01",32,0)
 ;
"RTN","IBCEOB01",33,0)
 D F^IBCEF("N-CURR INSURED FULL NAME","IBZ",,IBIFN)   ; get the existing name in standard format (see CI2-2.9)
"RTN","IBCEOB01",34,0)
 I IBZ="" D MSG^IBCEOB(IBEOB,"Unable to determine the existing subscriber name.") G UPD1
"RTN","IBCEOB01",35,0)
 S IBZ1=$$NAME^IBCEFG1(IBZ)   ; parse existing name into component pieces (see CI2-2.9)
"RTN","IBCEOB01",36,0)
 ;
"RTN","IBCEOB01",37,0)
 ; Determine if Medicare sent the suffix in the last name field
"RTN","IBCEOB01",38,0)
 S MCRSFX=""                              ; default Medicare suffix found in last name
"RTN","IBCEOB01",39,0)
 S LN=$P(IB0,U,3)                         ; last name
"RTN","IBCEOB01",40,0)
 S MCRLEN=$L(LN," ")                      ; how many " " pieces there are in the Medicare last name
"RTN","IBCEOB01",41,0)
 I MCRLEN>1 D
"RTN","IBCEOB01",42,0)
 . S MCRSFX=$$CHKSUF($P(LN," ",MCRLEN))   ; check the last piece to see if it is a common suffix
"RTN","IBCEOB01",43,0)
 . Q
"RTN","IBCEOB01",44,0)
 ;
"RTN","IBCEOB01",45,0)
 ; build new name components
"RTN","IBCEOB01",46,0)
 S NNM("FAMILY")=$S($P(IB0,U,3)'="":$P(IB0,U,3),1:$P(IBZ1,U,1))
"RTN","IBCEOB01",47,0)
 S NNM("GIVEN")=$S($P(IB0,U,4)'="":$P(IB0,U,4),1:$P(IBZ1,U,2))
"RTN","IBCEOB01",48,0)
 S NNM("MIDDLE")=$S($P(IB0,U,5)'="":$P(IB0,U,5),1:$P(IBZ1,U,3))
"RTN","IBCEOB01",49,0)
 S NNM("SUFFIX")=$S(MCRSFX'="":"",1:$P(IBZ1,U,5))     ; if suffix is in the Medicare last name, blank it out here
"RTN","IBCEOB01",50,0)
 ;
"RTN","IBCEOB01",51,0)
 I NNM("FAMILY")="" D MSG^IBCEOB(IBEOB,"Last name is nil.") G UPD1
"RTN","IBCEOB01",52,0)
 I NNM("GIVEN")="" D MSG^IBCEOB(IBEOB,"First name is nil.") G UPD1
"RTN","IBCEOB01",53,0)
 ;
"RTN","IBCEOB01",54,0)
 K MAX D FIELD^DID(2.312,17,,"FIELD LENGTH","MAX") S MAX=$G(MAX("FIELD LENGTH"))
"RTN","IBCEOB01",55,0)
 I 'MAX D MSG^IBCEOB(IBEOB,"Unable to determine the maximum field length for 2.312,17.") G UPD1
"RTN","IBCEOB01",56,0)
 S NNM1=$$NAMEFMT^XLFNAME(.NNM,"F","CL"_MAX)     ; construct the new name
"RTN","IBCEOB01",57,0)
 K IBIT D FIELD^DID(2.312,17,,"INPUT TRANSFORM","IBIT") S IBIT=$G(IBIT("INPUT TRANSFORM"))
"RTN","IBCEOB01",58,0)
 S X=NNM1 X IBIT        ; invoke the input transform on the field to see if it is valid
"RTN","IBCEOB01",59,0)
 I '$D(X) D MSG^IBCEOB(IBEOB,"New name '"_NNM1_"' failed the input transform for field 2.312,17.") G UPD1
"RTN","IBCEOB01",60,0)
 ;
"RTN","IBCEOB01",61,0)
 ; at this point, all name checks have passed and we have a valid, new, corrected name in NNM1
"RTN","IBCEOB01",62,0)
 S NAMECHG=1
"RTN","IBCEOB01",63,0)
 ;
"RTN","IBCEOB01",64,0)
UPD1 ;
"RTN","IBCEOB01",65,0)
 ;
"RTN","IBCEOB01",66,0)
 I 'NAMECHG,'IDCHG D MSG^IBCEOB(IBEOB,"No changes made.") G UPDX
"RTN","IBCEOB01",67,0)
 ;
"RTN","IBCEOB01",68,0)
 I NAMECHG D
"RTN","IBCEOB01",69,0)
 . N DIE,DA,DR
"RTN","IBCEOB01",70,0)
 . D MSG^IBCEOB(IBEOB,"Name corrected from "_IBZ_" to "_NNM1_".")
"RTN","IBCEOB01",71,0)
 . S DIE=361.1,DA=IBEOB,DR="6.01////^S X=NNM1" D ^DIE
"RTN","IBCEOB01",72,0)
 . Q
"RTN","IBCEOB01",73,0)
 ;
"RTN","IBCEOB01",74,0)
 I IDCHG D
"RTN","IBCEOB01",75,0)
 . N DIE,DA,DR
"RTN","IBCEOB01",76,0)
 . D MSG^IBCEOB(IBEOB,"ID# corrected from "_$$POLICY^IBCEF(IBIFN,2,SEQ)_" to "_CORRID_".")
"RTN","IBCEOB01",77,0)
 . S DIE=361.1,DA=IBEOB,DR="6.02////^S X=CORRID" D ^DIE
"RTN","IBCEOB01",78,0)
 . Q
"RTN","IBCEOB01",79,0)
 ;
"RTN","IBCEOB01",80,0)
 ; Loop thru patient policies looking to update all Medicare entries
"RTN","IBCEOB01",81,0)
 S POL=0
"RTN","IBCEOB01",82,0)
 F  S POL=$O(^DPT(DFN,.312,POL)) Q:'POL  D
"RTN","IBCEOB01",83,0)
 . S PD=$G(^DPT(DFN,.312,POL,0))   ; policy data on the 0 node
"RTN","IBCEOB01",84,0)
 . S INS=+PD
"RTN","IBCEOB01",85,0)
 . I '$$MCRWNR^IBEFUNC(INS) Q      ; quit if ins co isn't Medicare
"RTN","IBCEOB01",86,0)
 . I IDCHG,CORRID'=$P(PD,U,2) D UPDID(DFN,POL,CORRID)   ; ID# change
"RTN","IBCEOB01",87,0)
 . I NAMECHG,NNM1'=$P(PD,U,17) D UPDNM(DFN,POL,NNM1)    ; name change
"RTN","IBCEOB01",88,0)
 . Q
"RTN","IBCEOB01",89,0)
UPDX ;
"RTN","IBCEOB01",90,0)
 Q
"RTN","IBCEOB01",91,0)
 ;
"RTN","IBCEOB01",92,0)
UPDID(DFN,DA,ID) ; update the subscriber ID# field
"RTN","IBCEOB01",93,0)
 N DR,DIE,DIC
"RTN","IBCEOB01",94,0)
 S DIE="^DPT("_DFN_",.312,",DA(1)=DFN
"RTN","IBCEOB01",95,0)
 S DR="1///^S X=ID"
"RTN","IBCEOB01",96,0)
 D ^DIE
"RTN","IBCEOB01",97,0)
 D UPDAUD(DFN,DA)           ; audit info
"RTN","IBCEOB01",98,0)
 Q
"RTN","IBCEOB01",99,0)
 ;
"RTN","IBCEOB01",100,0)
UPDNM(DFN,DA,NM) ; update the subscriber name field
"RTN","IBCEOB01",101,0)
 N DR,DIE,DIC
"RTN","IBCEOB01",102,0)
 S DIE="^DPT("_DFN_",.312,",DA(1)=DFN
"RTN","IBCEOB01",103,0)
 S DR="17///^S X=NM"
"RTN","IBCEOB01",104,0)
 D ^DIE
"RTN","IBCEOB01",105,0)
 D UPDAUD(DFN,DA)           ; audit info
"RTN","IBCEOB01",106,0)
 Q
"RTN","IBCEOB01",107,0)
 ;
"RTN","IBCEOB01",108,0)
UPDAUD(DFN,DA) ; update the audit information for this patient insurance policy
"RTN","IBCEOB01",109,0)
 N DR,DIE,DIC
"RTN","IBCEOB01",110,0)
 D UPDATPT^IBCNSP3(DFN,DA)   ; date and time last edited and by whom
"RTN","IBCEOB01",111,0)
 S DIE="^DPT("_DFN_",.312,",DA(1)=DFN
"RTN","IBCEOB01",112,0)
 S DR="1.09///MEDICARE"      ; source of information is MEDICARE
"RTN","IBCEOB01",113,0)
 D ^DIE
"RTN","IBCEOB01",114,0)
 D UPDCLM^IBCNSP1(DFN,DA)    ; update editable claims
"RTN","IBCEOB01",115,0)
 Q
"RTN","IBCEOB01",116,0)
 ;
"RTN","IBCEOB01",117,0)
CHKSUF(X) ; Return X if it looks like a suffix; otherwise, return null
"RTN","IBCEOB01",118,0)
 Q:"^I^II^III^IV^V^VI^VII^VIII^IX^X^JR^SR^DR^MD^ESQ^DDS^RN^"[(U_X_U) X
"RTN","IBCEOB01",119,0)
 Q:"^1ST^2ND^3RD^4TH^5TH^6TH^7TH^8TH^9TH^10TH^"[(U_X_U) X
"RTN","IBCEOB01",120,0)
 Q ""
"RTN","IBCEOB01",121,0)
 ;
"RTN","IBCEP0")
0^43^B72988183^B68376329
"RTN","IBCEP0",1,0)
IBCEP0 ;ALB/TMP - Functions for PROVIDER ID MAINTENANCE ;13-DEC-99
"RTN","IBCEP0",2,0)
 ;;2.0;INTEGRATED BILLING;**137,191,239,232,320,348,349,377**;21-MAR-94;Build 23
"RTN","IBCEP0",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP0",4,0)
 ;
"RTN","IBCEP0",5,0)
EN ; -- main entry point for IBCE PRV INS ID
"RTN","IBCEP0",6,0)
 N IBINS,IBDSP,IBSORT,IBPRV ; Variables should be available throughout actions
"RTN","IBCEP0",7,0)
 K IBFASTXT
"RTN","IBCEP0",8,0)
 D FULL^VALM1
"RTN","IBCEP0",9,0)
 D EN^VALM("IBCE PRVINS ID")
"RTN","IBCEP0",10,0)
 Q
"RTN","IBCEP0",11,0)
 ;
"RTN","IBCEP0",12,0)
EN1(IBINS) ; Entrypoint from insurance co maintenance
"RTN","IBCEP0",13,0)
 N IBDSP,IBSORT ; Variables should be available throughout actions
"RTN","IBCEP0",14,0)
 D FULL^VALM1
"RTN","IBCEP0",15,0)
 D EN^VALM("IBCE PRVINS ID FROM INS MAINT")
"RTN","IBCEP0",16,0)
 Q
"RTN","IBCEP0",17,0)
 ;
"RTN","IBCEP0",18,0)
HDR ; -- header code
"RTN","IBCEP0",19,0)
 N Z,Z0,Z1,IBCT,IBPPTYP,IBEMCTYP
"RTN","IBCEP0",20,0)
 S IBCT=1
"RTN","IBCEP0",21,0)
 K VALMHDR
"RTN","IBCEP0",22,0)
 I $G(IBINS) D
"RTN","IBCEP0",23,0)
 . N PCF,PCDISP
"RTN","IBCEP0",24,0)
 . S PCF=$P($G(^DIC(36,+IBINS,3)),U,13)
"RTN","IBCEP0",25,0)
 . S PCDISP=$S(PCF="C":"(Child)",PCF="P":"(Parent)",1:"")
"RTN","IBCEP0",26,0)
 . S VALMHDR(1)="Insurance Co: "_$P($G(^DIC(36,+IBINS,0)),U)_" "_PCDISP
"RTN","IBCEP0",27,0)
 . ; Get performing provider id type for insurance co
"RTN","IBCEP0",28,0)
 . S IBPPTYP=$$PPTYP(IBINS)
"RTN","IBCEP0",29,0)
 . ; Get ien of EMC ID from file 355.97
"RTN","IBCEP0",30,0)
 . S IBEMCTYP=+$$EMCID^IBCEP()
"RTN","IBCEP0",31,0)
 . I $G(IBSORT)="ALL"!($G(IBDSP)="I")!($G(IBSORT)=IBPPTYP)!($G(IBSORT)=IBEMCTYP) D
"RTN","IBCEP0",32,0)
 .. ; Look for care unit in either of these id types - if there, report on line 2 of header
"RTN","IBCEP0",33,0)
 .. I $G(IBSORT)=IBPPTYP S IBEMCTYP=0
"RTN","IBCEP0",34,0)
 .. I $G(IBSORT)=IBEMCTYP S IBPPTYP=0
"RTN","IBCEP0",35,0)
 .. F Z0=IBPPTYP_"P",IBEMCTYP_"E" S Z1="" F  S Z1=$O(^IBA(355.96,"D",+IBINS,+Z0,Z1)) Q:Z1=""  I Z1'="*N/A*" S Z($E(Z0,$L(Z0)))=1 Q
"RTN","IBCEP0",36,0)
 .. I $D(Z("P"))!$D(Z("E")) D
"RTN","IBCEP0",37,0)
 ... S IBCT=IBCT+1
"RTN","IBCEP0",38,0)
 ... S VALMHDR(IBCT)="  "_$S($D(Z("P")):"PERFORMING PROV ID"_$S($D(Z("E")):" AND ",1:""),1:"")_$S($D(Z("E")):"EMC PROV ID",1:"")_" MAY REQUIRE CARE UNIT"
"RTN","IBCEP0",39,0)
 . I $D(Z("P"))!$D(Z("E")) S IBCT=IBCT+1,VALMHDR(IBCT)=" "
"RTN","IBCEP0",40,0)
 . S IBCT=IBCT+1,VALMHDR(IBCT)="     PROVIDER "_$S($G(IBDSP)="I":"ID TYPE",1:"NAME   ")_$J("",6)_"FORM   CARE TYPE    CARE UNIT       ID#"
"RTN","IBCEP0",41,0)
 Q
"RTN","IBCEP0",42,0)
 ;
"RTN","IBCEP0",43,0)
INIT ; Initialization
"RTN","IBCEP0",44,0)
 K ^TMP("IB_EDITED_IDS",$J)  ; This will be to keep track of ID's edited during this session
"RTN","IBCEP0",45,0)
 D INSID(.IBINS,.IBDSP,.IBSORT)
"RTN","IBCEP0",46,0)
 I $G(IBDSP)="I",$G(IBSORT) S IBPRV=IBSORT
"RTN","IBCEP0",47,0)
 I '$G(IBINS) S VALMQUIT=1
"RTN","IBCEP0",48,0)
 Q
"RTN","IBCEP0",49,0)
 ;
"RTN","IBCEP0",50,0)
INSID(IBINS,IBDSP,IBSORT) ;
"RTN","IBCEP0",51,0)
 N DIC,DIR,DA,X,Y,IBOK,DTOUT,DUOUT
"RTN","IBCEP0",52,0)
 S IBOK=1
"RTN","IBCEP0",53,0)
 I '$G(IBINS) D
"RTN","IBCEP0",54,0)
 . S DIC(0)="AEMQ",DIC="^DIC(36," D ^DIC
"RTN","IBCEP0",55,0)
 . I Y'>0 S IBOK=0 Q
"RTN","IBCEP0",56,0)
 . S IBINS=+Y
"RTN","IBCEP0",57,0)
 I '$G(IBINS) S IBOK=0
"RTN","IBCEP0",58,0)
 I 'IBOK G INSIDQ
"RTN","IBCEP0",59,0)
 ;
"RTN","IBCEP0",60,0)
 S DIR(0)="SA^D:INSURANCE CO DEFAULT IDS;I:INDIVIDUAL PROVIDER IDS FURNISHED BY THE INS CO;A:ALL IDS FURNISHED BY THE INS CO BY PROVIDER TYPE"
"RTN","IBCEP0",61,0)
 S DIR("A")="SELECT DISPLAY CONTENT: ",DIR("B")="A"
"RTN","IBCEP0",62,0)
 S DIR("?",1)="(D) DISPLAY CONTAINS ONLY THOSE IDS ASSIGNED AS DEFAULTS TO THE FACILITY BY",DIR("?",2)="    THE INSURANCE COMPANY"
"RTN","IBCEP0",63,0)
 S DIR("?",3)="(I) DISPLAY CONTAINS ONLY THOSE IDS ASSIGNED TO INDIVIDUAL PROVIDERS BY THE",DIR("?",4)="    INSURANCE COMPANY"
"RTN","IBCEP0",64,0)
 S DIR("?",5)="(A) DISPLAY CONTAINS ALL IDS ASSIGNED BY THE INSURANCE COMPANY FOR ONE OR ALL",DIR("?")="    PROVIDER ID TYPES"
"RTN","IBCEP0",65,0)
 W ! D ^DIR K DIR W !
"RTN","IBCEP0",66,0)
 I $D(DTOUT)!$D(DUOUT)!("DIA"'[Y) S IBOK=0 G INSIDQ
"RTN","IBCEP0",67,0)
 S IBDSP=Y,IBSORT=""
"RTN","IBCEP0",68,0)
 I IBDSP="A"!(IBDSP="I") F  D  Q:'IBOK!(IBSORT'="")
"RTN","IBCEP0",69,0)
 . ;
"RTN","IBCEP0",70,0)
 . I IBDSP="A" D
"RTN","IBCEP0",71,0)
 .. S DIR("A")="Display only IDs with a specific ID Qualifier?: "
"RTN","IBCEP0",72,0)
 .. S DIR("?",1)="Answer Yes to select a specific ID Qualifier by which to display IDs."
"RTN","IBCEP0",73,0)
 .. S DIR("?")="Answer No to display all IDs."
"RTN","IBCEP0",74,0)
 .. Q
"RTN","IBCEP0",75,0)
 . ;
"RTN","IBCEP0",76,0)
 . I IBDSP="I" D
"RTN","IBCEP0",77,0)
 .. S DIR("A")="Display IDs for a specific Provider?: "
"RTN","IBCEP0",78,0)
 .. S DIR("?",1)="Answer Yes to select a specific Provider."
"RTN","IBCEP0",79,0)
 .. S DIR("?")="Answer No to display all Providers."
"RTN","IBCEP0",80,0)
 .. Q
"RTN","IBCEP0",81,0)
 . ;
"RTN","IBCEP0",82,0)
 . S DIR("B")="NO",DIR(0)="YA"
"RTN","IBCEP0",83,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0",84,0)
 . I $D(DTOUT)!$D(DUOUT) S IBOK=0 Q
"RTN","IBCEP0",85,0)
 . I Y'=1 S IBSORT="ALL" Q
"RTN","IBCEP0",86,0)
 . ;
"RTN","IBCEP0",87,0)
 . I IBDSP="A" D  Q
"RTN","IBCEP0",88,0)
 .. S DIC(0)="AEMQ",DIC="^IBE(355.97,",DIC("S")="I $S('$P(^(0),U,2):1,1:$P(^(0),U,2)=3)"
"RTN","IBCEP0",89,0)
 .. S DIC("A")="Select type of ID Qualifier: "
"RTN","IBCEP0",90,0)
 .. D ^DIC K DIC
"RTN","IBCEP0",91,0)
 .. I Y>0 S IBSORT=+Y Q
"RTN","IBCEP0",92,0)
 .. I $D(DTOUT)!$D(DUOUT) S IBOK=0
"RTN","IBCEP0",93,0)
 . ;
"RTN","IBCEP0",94,0)
 . I IBDSP="I" D  Q
"RTN","IBCEP0",95,0)
 .. N DA
"RTN","IBCEP0",96,0)
 .. S DIR(0)="399.0222,.02A",DIR("A")="SELECT PROVIDER: "
"RTN","IBCEP0",97,0)
 .. W ! D ^DIR K DIR W !
"RTN","IBCEP0",98,0)
 .. I Y>0 S IBSORT=Y Q
"RTN","IBCEP0",99,0)
 .. I $D(DTOUT)!$D(DUOUT) S IBOK=0 Q
"RTN","IBCEP0",100,0)
 . S IBOK=0 Q
"RTN","IBCEP0",101,0)
 ;
"RTN","IBCEP0",102,0)
 G:'IBOK INSIDQ
"RTN","IBCEP0",103,0)
 D BLD(IBINS,IBDSP,IBSORT)
"RTN","IBCEP0",104,0)
INSIDQ I 'IBOK S VALMQUIT=1
"RTN","IBCEP0",105,0)
 Q
"RTN","IBCEP0",106,0)
 ;
"RTN","IBCEP0",107,0)
BLD(IBINS,IBDSP,IBSORT) ; Build display for Insurance co level provider ID's
"RTN","IBCEP0",108,0)
 N IB,IBENT,IBLCT,IBCT,IBPRV,IBSRT1,IBSRT2,IBOSRT1,IBOSRT2,CU,FT,PT,CT,Z,Z0
"RTN","IBCEP0",109,0)
 K ^TMP("IBPRV_INS_ID",$J),^TMP("IBPRV_INS_SORT",$J)
"RTN","IBCEP0",110,0)
 ;
"RTN","IBCEP0",111,0)
 S (IBENT,IBCT,IBLCT)=0
"RTN","IBCEP0",112,0)
 ;
"RTN","IBCEP0",113,0)
 I "DA"[$G(IBDSP) D
"RTN","IBCEP0",114,0)
 . S CU="" F  S CU=$O(^IBA(355.91,"AUNIQ",IBINS,CU)) Q:CU=""  S FT="" F  S FT=$O(^IBA(355.91,"AUNIQ",IBINS,CU,FT)) Q:FT=""  D
"RTN","IBCEP0",115,0)
 .. S CT="" F  S CT=$O(^IBA(355.91,"AUNIQ",IBINS,CU,FT,CT)) Q:CT=""  S PT=0 F  S PT=$S(IBDSP="A"&IBSORT:IBSORT,1:$O(^IBA(355.91,"AUNIQ",IBINS,CU,FT,CT,PT))) Q:'PT  D  Q:IBDSP="A"&IBSORT
"RTN","IBCEP0",116,0)
 ... S Z=0 F  S Z=$O(^IBA(355.91,"AUNIQ",IBINS,CU,FT,CT,PT,Z)) Q:'Z  S IB=$G(^IBA(355.91,Z,0)) S ^TMP("IBPRV_INS_SORT",$J,PT,"^<<INS CO DEFAULT>>",FT,CT,CU,Z)=$P(IB,U,7)_U
"RTN","IBCEP0",117,0)
 ;
"RTN","IBCEP0",118,0)
 I "IA"[$G(IBDSP) D
"RTN","IBCEP0",119,0)
 . S IBPRV=""
"RTN","IBCEP0",120,0)
 . N IB1,IB2
"RTN","IBCEP0",121,0)
 . F  S IBPRV=$O(^IBA(355.9,"AE",IBINS,IBPRV)) Q:'IBPRV  S Z=0 F  S Z=$O(^IBA(355.9,"AE",IBINS,IBPRV,Z)) Q:'Z  S IB=$G(^IBA(355.9,Z,0)) D
"RTN","IBCEP0",122,0)
 .. Q:$P(IB,U,4)=""!($P(IB,U,5)="")!($P(IB,U,6)="")!($P(IB,U,16)="")
"RTN","IBCEP0",123,0)
 .. I IBSORT,$S(IBDSP="I":IBPRV'=IBSORT,1:$P(IB,U,6)'=IBSORT) Q
"RTN","IBCEP0",124,0)
 .. S IB1=$S(IBDSP="A":$P(IB,U,6),1:U_$$EXPAND^IBTRE(355.9,.01,IBPRV)_U_IBPRV)
"RTN","IBCEP0",125,0)
 .. S IB2=$S(IBDSP="I":$P(IB,U,6),1:U_$$EXPAND^IBTRE(355.9,.01,IBPRV)_U_IBPRV)
"RTN","IBCEP0",126,0)
 .. S ^TMP("IBPRV_INS_SORT",$J,IB1,IB2,$P(IB,U,4),$P(IB,U,5),$P(IB,U,16),Z)=$P(IB,U,7)_U_IBPRV
"RTN","IBCEP0",127,0)
 ;
"RTN","IBCEP0",128,0)
 S IBOSRT1=""
"RTN","IBCEP0",129,0)
 S IBSRT1="" F  S IBSRT1=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1)) Q:IBSRT1=""  D
"RTN","IBCEP0",130,0)
 . S IBSRT2="",IBOSRT2=""
"RTN","IBCEP0",131,0)
 . F  S IBSRT2=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1,IBSRT2)) Q:IBSRT2=""  D
"RTN","IBCEP0",132,0)
 .. I IBOSRT1'=IBSRT1 D
"RTN","IBCEP0",133,0)
 ... I IBOSRT1'="" S IBLCT=IBLCT+1 D SET^VALM10(IBLCT," ",IBCT+1)
"RTN","IBCEP0",134,0)
 ... S IBLCT=IBLCT+1 D SET^VALM10(IBLCT,$S(IBDSP'="I":"ID Qualifier",1:"Provider")_": "_$S(IBDSP'="I":$$EXPAND^IBTRE(355.91,.06,IBSRT1),1:$P(IBSRT1,U,2_$S($P(IBSRT2,U,3)["VA(200":" (VA)",1:"(NON-VA)"))),IBCT+1)
"RTN","IBCEP0",135,0)
 ... S IBOSRT1=IBSRT1
"RTN","IBCEP0",136,0)
 .. ;
"RTN","IBCEP0",137,0)
 .. S FT="" F  S FT=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1,IBSRT2,FT)) Q:FT=""  S CT="" F  S CT=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1,IBSRT2,FT,CT)) Q:CT=""  D
"RTN","IBCEP0",138,0)
 ... S CU="" F  S CU=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1,IBSRT2,FT,CT,CU)) Q:CU=""  S Z=0 F  S Z=$O(^TMP("IBPRV_INS_SORT",$J,IBSRT1,IBSRT2,FT,CT,CU,Z)) Q:'Z  S IB=$G(^(Z)) D
"RTN","IBCEP0",139,0)
 .... S IBLCT=IBLCT+1,IBCT=IBCT+1
"RTN","IBCEP0",140,0)
 .... S Z0=$E(IBCT_$J("",4),1,4)_" "
"RTN","IBCEP0",141,0)
 .... I IBDSP'="I" S Z0=Z0_$E($S(IBOSRT2'=IBSRT2:$P(IBSRT2,U,2),1:"")_$J("",20),1,20)
"RTN","IBCEP0",142,0)
 .... I IBDSP="I" S Z0=Z0_$E($S(IBOSRT2'=IBSRT2:$$EXPAND^IBTRE(355.9,.06,IBSRT2),1:"")_$J("",20),1,20)
"RTN","IBCEP0",143,0)
 .... S IBOSRT2=IBSRT2
"RTN","IBCEP0",144,0)
 .... S Z0=Z0_"  "_$S(FT=1:"UB-04",FT=2:"1500 ",1:"BOTH ")_"  "_$E($S(CT=3:"RX",CT=1:"INPT",CT=2:"OUTPT",1:"INPT/OUTPT")_$J("",11),1,11)_"  "_$E($S(CU'="*N/A*":$P($G(^IBA(355.95,+$P($G(^IBA(355.96,+CU,0)),U),0)),U),1:"")_$J("",15),1,15)
"RTN","IBCEP0",145,0)
 .... D SET^VALM10(IBLCT,Z0_" "_$P(IB,U),IBCT)
"RTN","IBCEP0",146,0)
 .... S ^TMP("IBPRV_INS_ID",$J,"ZIDX",IBCT)=Z,^(IBCT,"PRV")=$P(IB,U,2)
"RTN","IBCEP0",147,0)
 .... I '$D(^TMP("IBPRV_INS_ID",$J,$S(IBDSP="I":"ZXPRV",1:"ZXPTYP"),IBSRT1)) S ^(IBSRT1)=IBLCT-1
"RTN","IBCEP0",148,0)
 K ^TMP("IBPRV_INS_SORT",$J)
"RTN","IBCEP0",149,0)
 ;
"RTN","IBCEP0",150,0)
 I IBLCT=0 D  G BLDQ ; No entries found
"RTN","IBCEP0",151,0)
 . D SET^VALM10(1," ")
"RTN","IBCEP0",152,0)
 . S Z="  No "_$S(IBDSP="D":"default ",1:"")
"RTN","IBCEP0",153,0)
 . S Z=Z_"ID's found for "_$S(IBDSP="I":"provider "_$S(IBSORT:"("_$$EXPAND^IBTRE(355.9,.01,IBSORT)_") ",1:"")_"and ",IBDSP="A":"provider type "_$S(IBSORT:"("_$$EXPAND^IBTRE(355.9,.06,IBSORT)_") ",1:"")_"and ",1:"")_"insurance co"
"RTN","IBCEP0",154,0)
 . D SET^VALM10(2,Z)
"RTN","IBCEP0",155,0)
 . S IBLCT=2
"RTN","IBCEP0",156,0)
 ;
"RTN","IBCEP0",157,0)
BLDQ S VALMCNT=IBLCT,VALMBG=1
"RTN","IBCEP0",158,0)
 Q
"RTN","IBCEP0",159,0)
 ;
"RTN","IBCEP0",160,0)
EXPND ;
"RTN","IBCEP0",161,0)
 Q
"RTN","IBCEP0",162,0)
 ;
"RTN","IBCEP0",163,0)
HELP ;
"RTN","IBCEP0",164,0)
 Q
"RTN","IBCEP0",165,0)
 ;
"RTN","IBCEP0",166,0)
EXIT ;
"RTN","IBCEP0",167,0)
 K IBFASTXT
"RTN","IBCEP0",168,0)
 D COPYPROV^IBCEP5A(IBINS)
"RTN","IBCEP0",169,0)
 K ^TMP("IBPRV_INS_ID",$J)
"RTN","IBCEP0",170,0)
 D CLEAN^VALM10
"RTN","IBCEP0",171,0)
 Q
"RTN","IBCEP0",172,0)
 ;
"RTN","IBCEP0",173,0)
SEL(IBDA,MANY) ; Select from provider id list
"RTN","IBCEP0",174,0)
 ; IBDA is passed by reference and IBDA(1) returned containing
"RTN","IBCEP0",175,0)
 ;  ien's of the provider id records selected (file 355.9).
"RTN","IBCEP0",176,0)
 ; If > 1 entry can be selected, MANY is set to 1
"RTN","IBCEP0",177,0)
 N Z
"RTN","IBCEP0",178,0)
 S IBDA=0
"RTN","IBCEP0",179,0)
 D EN^VALM2($G(XQORNOD(0)),$S($G(MANY):"",1:"S"))
"RTN","IBCEP0",180,0)
 S Z=0 F  S Z=$O(VALMY(Z)) Q:'Z  S IBDA=IBDA+1,IBDA(IBDA)=+$G(^TMP("IBPRV_INS_ID",$J,"ZIDX",Z))_U_$G(^(Z,"PRV"))
"RTN","IBCEP0",181,0)
 Q
"RTN","IBCEP0",182,0)
 ;
"RTN","IBCEP0",183,0)
ENX(IBINS1) ; Insurance co level defaults for all providers or
"RTN","IBCEP0",184,0)
 ; for all providers by care unit
"RTN","IBCEP0",185,0)
 N DIC,DIE,DR,DA,X,Y,DLAYGO
"RTN","IBCEP0",186,0)
 I '$G(IBINS1) D  G:'$G(IBINS1) ENQ
"RTN","IBCEP0",187,0)
 . S DIC="^IBA(355.91,",DIC(0)="AELMQ",DLAYGO=355.91 D ^DIC
"RTN","IBCEP0",188,0)
 . I Y>0 S IBINS1=+Y
"RTN","IBCEP0",189,0)
 S DIE="^IBA(355.91,",DA=IBINS1,DR=".01;.06;.04;.05;.03;.07" D ^DIE
"RTN","IBCEP0",190,0)
 ;
"RTN","IBCEP0",191,0)
ENQ Q
"RTN","IBCEP0",192,0)
 ;
"RTN","IBCEP0",193,0)
PPTYP(IBINS) ; Returns the ien of the default performing provider type for 
"RTN","IBCEP0",194,0)
 ;  insurance company IBINS (ien file 36)
"RTN","IBCEP0",195,0)
 Q +$G(^DIC(36,+IBINS,4))
"RTN","IBCEP0",196,0)
 ;
"RTN","IBCEP0",197,0)
SCREEN(WHICH) ; This screen is used the menu protocol to screen out the ID functions if it is a child ins co
"RTN","IBCEP0",198,0)
 Q:'$G(DA) 0
"RTN","IBCEP0",199,0)
 Q:'$G(DA(1)) 0
"RTN","IBCEP0",200,0)
 N FILE,IENS,FIELD,FLAG,TARGET
"RTN","IBCEP0",201,0)
 S FILE=101.01,IENS=DA_","_DA(1),FIELD=".01",FLAG="I"
"RTN","IBCEP0",202,0)
 D GETS^DIQ(FILE,IENS,FIELD,FLAG,"TARGET")
"RTN","IBCEP0",203,0)
 Q:'$D(TARGET) 0
"RTN","IBCEP0",204,0)
 N IEN
"RTN","IBCEP0",205,0)
 S IEN=$G(TARGET(FILE,IENS_",",FIELD,FLAG))
"RTN","IBCEP0",206,0)
 Q:'+IEN 0
"RTN","IBCEP0",207,0)
 S FILE=101,FIELD=1,FLAG="E"
"RTN","IBCEP0",208,0)
 K TARGET
"RTN","IBCEP0",209,0)
 D GETS^DIQ(FILE,IEN,FIELD,FLAG,"TARGET")
"RTN","IBCEP0",210,0)
 Q:'$D(TARGET) 0
"RTN","IBCEP0",211,0)
 I $G(TARGET(FILE,IEN_",",FIELD,FLAG))'[WHICH Q 1
"RTN","IBCEP0",212,0)
 Q:'$G(IBINS) 0
"RTN","IBCEP0",213,0)
 N PCF
"RTN","IBCEP0",214,0)
 S PCF=$P($G(^DIC(36,+IBINS,3)),U,13)
"RTN","IBCEP0",215,0)
 I PCF="C" Q 0
"RTN","IBCEP0",216,0)
 Q 1
"RTN","IBCEP0A")
0^41^B41455887^B41076613
"RTN","IBCEP0A",1,0)
IBCEP0A ;ALB/TMP - EDI UTILITIES for insurance assigned provider ID ;01-NOV-00
"RTN","IBCEP0A",2,0)
 ;;2.0;INTEGRATED BILLING;**137,232,320,377**;21-MAR-94;Build 23
"RTN","IBCEP0A",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP0A",4,0)
 ;
"RTN","IBCEP0A",5,0)
NEW(IBINS,IBPRV,IBPTYP,IBDEF) ; Add new insurance co assigned id
"RTN","IBCEP0A",6,0)
 ; IBDEF = flag sent as 1 if only insurance co defaults are being added
"RTN","IBCEP0A",7,0)
 N DIC,DIR,X,Y,Z,DA,DR,DIE,DO,DD,DLAYGO,IBQ,IBIEN,IBCUND,DTOUT,DUOUT
"RTN","IBCEP0A",8,0)
 D FULL^VALM1
"RTN","IBCEP0A",9,0)
 S IBQ=0
"RTN","IBCEP0A",10,0)
 I $G(IBDEF)="D" W !!,"YOU ARE ADDING A PROVIDER ID THAT WILL BE THE INSURANCE CO DEFAULT",!
"RTN","IBCEP0A",11,0)
 I '$G(IBPRV),$G(IBDEF)'="D" D  G:IBQ NEWQ
"RTN","IBCEP0A",12,0)
 . N DA,IBO
"RTN","IBCEP0A",13,0)
 . S IBO=($G(IBDSP)'="I")
"RTN","IBCEP0A",14,0)
 . S DIR(0)="355.9,.01A"_$S(IBO:"O",1:""),DIR("A")="Select PROVIDER"_$S(IBO:" (optional)",1:"")_": "
"RTN","IBCEP0A",15,0)
 . S DIR("?")="Select the PROVIDER to be assigned a provider ID"
"RTN","IBCEP0A",16,0)
 . I IBO S DIR("?",1)=DIR("?"),DIR("?")="Or    Press ENTER to add an insurance co level default id (all providers)"
"RTN","IBCEP0A",17,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0A",18,0)
 . I $D(DTOUT)!$D(DUOUT) S IBQ=1 Q
"RTN","IBCEP0A",19,0)
 . S IBPRV=$S(Y>0:$P(Y,U),1:"")
"RTN","IBCEP0A",20,0)
 . Q:IBPRV
"RTN","IBCEP0A",21,0)
 . S DIR(0)="YA",DIR("B")="YES",DIR("A",1)="YOU ARE ADDING A PROVIDER ID THAT WILL BE THE INSURANCE CO DEFAULT",DIR("A")="IS THIS OK?: "
"RTN","IBCEP0A",22,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0A",23,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y'=1) S IBQ=1
"RTN","IBCEP0A",24,0)
 . Q
"RTN","IBCEP0A",25,0)
 ;
"RTN","IBCEP0A",26,0)
 I '$G(IBPTYP) D  G:IBQ NEWQ
"RTN","IBCEP0A",27,0)
 . S DIR(0)="PAr^355.97:AEMQ",DIR("A")="Select Provider ID Qualifier: "
"RTN","IBCEP0A",28,0)
 . S DIR("?")="Enter a Qualifier to identify the type of ID number you are entering."
"RTN","IBCEP0A",29,0)
 . S DIR("S")="I $$RAINS^IBCEPU(Y)"   ; Rendering/Attending IDs provided by ins
"RTN","IBCEP0A",30,0)
 . S DA=0
"RTN","IBCEP0A",31,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0A",32,0)
 . I $D(DTOUT)!$D(DUOUT)!'Y S IBQ=1 Q
"RTN","IBCEP0A",33,0)
 . S IBPTYP=+Y
"RTN","IBCEP0A",34,0)
 ;
"RTN","IBCEP0A",35,0)
 S IBQ=$$ADDID(IBINS,IBPRV,IBPTYP)
"RTN","IBCEP0A",36,0)
 ;
"RTN","IBCEP0A",37,0)
NEWQ D:'$G(IBQ) BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT))
"RTN","IBCEP0A",38,0)
 S VALMBCK="R"
"RTN","IBCEP0A",39,0)
 Q
"RTN","IBCEP0A",40,0)
 ;
"RTN","IBCEP0A",41,0)
DEL1 ; Delete Insurance Co assigned provider ID's
"RTN","IBCEP0A",42,0)
 ; IBPRV = vp ien of provider if editing entry in file 355.9
"RTN","IBCEP0A",43,0)
 ;         otherwise, null
"RTN","IBCEP0A",44,0)
 N IB1,IBDA,IBFILE
"RTN","IBCEP0A",45,0)
 D FULL^VALM1
"RTN","IBCEP0A",46,0)
 D SEL^IBCEP0(.IBDA)
"RTN","IBCEP0A",47,0)
 G:'$O(IBDA(0)) DEL1Q
"RTN","IBCEP0A",48,0)
 S IBDA=+$O(IBDA("")),IBDA=$G(IBDA(IBDA))
"RTN","IBCEP0A",49,0)
 G:'IBDA DEL1Q
"RTN","IBCEP0A",50,0)
 S IB1=$P(IBDA,U,2),IBDA=+IBDA
"RTN","IBCEP0A",51,0)
 S IBFILE=$S(IB1:355.9,1:355.91)
"RTN","IBCEP0A",52,0)
 I IBDA>0 D DEL^IBCEP5B(IBFILE,IBDA,1),BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT))
"RTN","IBCEP0A",53,0)
 ;
"RTN","IBCEP0A",54,0)
DEL1Q S VALMBCK="R"
"RTN","IBCEP0A",55,0)
 Q
"RTN","IBCEP0A",56,0)
 ;
"RTN","IBCEP0A",57,0)
CHG1 ; Edit Provider ID's
"RTN","IBCEP0A",58,0)
 N IBDA,IB1,IBFILE
"RTN","IBCEP0A",59,0)
 D FULL^VALM1
"RTN","IBCEP0A",60,0)
 D SEL^IBCEP0(.IBDA)
"RTN","IBCEP0A",61,0)
 G:'$O(IBDA(0)) CHG1Q
"RTN","IBCEP0A",62,0)
 S IBDA=+$O(IBDA("")),IBDA=$G(IBDA(IBDA))
"RTN","IBCEP0A",63,0)
 G:'IBDA CHG1Q
"RTN","IBCEP0A",64,0)
 S IB1=$P(IBDA,U,2),IBDA=+IBDA
"RTN","IBCEP0A",65,0)
 S IBFILE=$S(IB1:355.9,1:355.91)
"RTN","IBCEP0A",66,0)
 I IBDA>0 D
"RTN","IBCEP0A",67,0)
 . I IBFILE=355.9 W !!,"PROVIDER: ",$$EXPAND^IBTRE(355.9,.01,IB1)
"RTN","IBCEP0A",68,0)
 . I IBFILE'=355.9 W !!,"  <<INS CO DEFAULT>>"
"RTN","IBCEP0A",69,0)
 . D CHG^IBCEP5B(IBFILE,IBDA),BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT))
"RTN","IBCEP0A",70,0)
 ;
"RTN","IBCEP0A",71,0)
CHG1Q S VALMBCK="R"
"RTN","IBCEP0A",72,0)
 Q
"RTN","IBCEP0A",73,0)
 ;
"RTN","IBCEP0A",74,0)
PRVJMP(IBDSP) ; Navigate to a specific sort level in current LM list
"RTN","IBCEP0A",75,0)
 ;   (from insurance co option)
"RTN","IBCEP0A",76,0)
 ; IBDSP = 'I', 'A' or 'D' to indicate format selected for display
"RTN","IBCEP0A",77,0)
 ;        ([P]ROVIDER, PROVIDER [T]YPE OR [I]NSURANCE DEFAULT)
"RTN","IBCEP0A",78,0)
 ; Sets VALMBG = LINE # if a provider in list selected
"RTN","IBCEP0A",79,0)
 ;
"RTN","IBCEP0A",80,0)
 I $G(IBDSP)="I" D PRVNJMP(.VALMBG)
"RTN","IBCEP0A",81,0)
 I $G(IBDSP)="D"!($G(IBDSP)="A") D PRVTJMP(.VALMBG)
"RTN","IBCEP0A",82,0)
 S VALMBCK="R"
"RTN","IBCEP0A",83,0)
 Q
"RTN","IBCEP0A",84,0)
 ;
"RTN","IBCEP0A",85,0)
PRVNJMP(VALMBG) ; Navigate to a specific provider name (from insurance co
"RTN","IBCEP0A",86,0)
 ;  option)
"RTN","IBCEP0A",87,0)
 ;
"RTN","IBCEP0A",88,0)
 N DIR,X,Y,DA
"RTN","IBCEP0A",89,0)
 D FULL^VALM1
"RTN","IBCEP0A",90,0)
 S DIR(0)="355.9,.01AO^^I '$D(^TMP(""IBPRV_INS_ID"",$J,""ZXPRV"",U_$$EXPAND^IBTRE(355.9,.01,Y)_U_$P(Y,U))) K X"
"RTN","IBCEP0A",91,0)
 S DIR("?",1)="*** YOU MAY ONLY SELECT PROVIDERS INCLUDED IN THE CURRENT LIST ***",DIR("?",2)=" ",DIR("?",3)="SELECTING A PROVIDER WILL FORCE THE DISPLAY TO SKIP TO THE DATA FOR THAT",DIR("?")="   PROVIDER"
"RTN","IBCEP0A",92,0)
 S DIR("A")="SELECT PROVIDER: "
"RTN","IBCEP0A",93,0)
 S DIR("S")="N Z S Z=$P(^(0),U) I $D(^TMP(""IBPRV_INS_ID"",$J,""ZXPRV"",U_$$EXPAND^IBTRE(355.9,.01,Z)_U_Z))"
"RTN","IBCEP0A",94,0)
 W ! D ^DIR K DIR W !
"RTN","IBCEP0A",95,0)
 I Y>0,'$D(DTOUT),'$D(DUOUT) D
"RTN","IBCEP0A",96,0)
 . N Z
"RTN","IBCEP0A",97,0)
 . S Z=$G(^TMP("IBPRV_INS_ID",$J,"ZXPRV",U_$$EXPAND^IBTRE(355.9,.01,$P(Y,U))_U_$P(Y,U)))
"RTN","IBCEP0A",98,0)
 . I Z S VALMBG=Z Q
"RTN","IBCEP0A",99,0)
 . S DIR(0)="EA",DIR("A",1)="THIS PROVIDER DOES NOT EXIST IN THE CURRENT DISPLAY",DIR("A")="PRESS THE ENTER KEY TO CONTINUE"
"RTN","IBCEP0A",100,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0A",101,0)
 Q
"RTN","IBCEP0A",102,0)
 ;
"RTN","IBCEP0A",103,0)
PRVTJMP(VALMBG) ; Navigate to a specific type of ID qualifier (from ins co option)
"RTN","IBCEP0A",104,0)
 ;
"RTN","IBCEP0A",105,0)
 N DIR,X,Y
"RTN","IBCEP0A",106,0)
 D FULL^VALM1
"RTN","IBCEP0A",107,0)
 S DIR(0)="PAO^355.97:AEMQ",DIR("A")="Select type of ID Qualifier: "
"RTN","IBCEP0A",108,0)
 S DIR("?")="Select a type of ID Qualifier to display the IDs of that type."
"RTN","IBCEP0A",109,0)
 S DIR("S")="I $D(^TMP(""IBPRV_INS_ID"",$J,""ZXPTYP"",+Y))"
"RTN","IBCEP0A",110,0)
 W ! D ^DIR K DIR W !
"RTN","IBCEP0A",111,0)
 I Y>0,'$D(DTOUT),'$D(DUOUT) D
"RTN","IBCEP0A",112,0)
 . N Z
"RTN","IBCEP0A",113,0)
 . S Z=$G(^TMP("IBPRV_INS_ID",$J,"ZXPTYP",+Y))
"RTN","IBCEP0A",114,0)
 . I Z S VALMBG=Z Q
"RTN","IBCEP0A",115,0)
 . S DIR(0)="EA",DIR("A",1)="This type of ID Qualifier does not exist in the current display",DIR("A")="Press the Enter key to continue"
"RTN","IBCEP0A",116,0)
 . W ! D ^DIR K DIR W !
"RTN","IBCEP0A",117,0)
 Q
"RTN","IBCEP0A",118,0)
 ;
"RTN","IBCEP0A",119,0)
CHGINS ; Change insurance co being displayed, using the same or new params
"RTN","IBCEP0A",120,0)
 ; Assumes IBINS exists = IEN of insurance co (file 36)
"RTN","IBCEP0A",121,0)
 N IBINEW,IBSAVE,DIC,DA,Y,X,DIR
"RTN","IBCEP0A",122,0)
 D FULL^VALM1
"RTN","IBCEP0A",123,0)
 S DIC="^DIC(36,",DIC(0)="AEMQ" D ^DIC
"RTN","IBCEP0A",124,0)
 S IBINEW=+Y
"RTN","IBCEP0A",125,0)
 ;
"RTN","IBCEP0A",126,0)
 I IBINEW>0,IBINS'=IBINEW D
"RTN","IBCEP0A",127,0)
 . D COPYPROV^IBCEP5A(IBINS)
"RTN","IBCEP0A",128,0)
 . S DIR(0)="YA",DIR("?")="IF YOU WANT TO CHANGE THE FORMAT OF THE DISPLAY, RESPOND NO HERE"
"RTN","IBCEP0A",129,0)
 . S DIR("A")="DO YOU WANT TO DISPLAY THE NEW INS. CO IDS USING THE CURRENT DISPLAY FORMAT?: ",DIR("B")="YES" W ! D ^DIR W ! K DIR
"RTN","IBCEP0A",130,0)
 . Q:Y'=1
"RTN","IBCEP0A",131,0)
 . S IBSAVE("IBINS")=IBINS
"RTN","IBCEP0A",132,0)
 . K ^TMP("IBPRV_INS_ID",$J),VALMHDR S VALMBG=1,IBINS=IBINEW
"RTN","IBCEP0A",133,0)
 . I Y=1 D BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT)) Q
"RTN","IBCEP0A",134,0)
 . D INIT^IBCEP0
"RTN","IBCEP0A",135,0)
 . I '$G(VALMQUIT) Q
"RTN","IBCEP0A",136,0)
 . S IBINS=IBSAVE("IBINS") D BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT))
"RTN","IBCEP0A",137,0)
 S VALMBCK="R"
"RTN","IBCEP0A",138,0)
 Q
"RTN","IBCEP0A",139,0)
 ;
"RTN","IBCEP0A",140,0)
CHGFMT ; Change format parameters for display
"RTN","IBCEP0A",141,0)
 N IBSAVE
"RTN","IBCEP0A",142,0)
 S IBSAVE("IBINS")=$G(IBINS)
"RTN","IBCEP0A",143,0)
 D INIT^IBCEP0
"RTN","IBCEP0A",144,0)
 I '$G(VALMQUIT) G CHGFMTQ
"RTN","IBCEP0A",145,0)
 S IBINS=IBSAVE("IBINS") D BLD^IBCEP0($G(IBINS),$G(IBDSP),$G(IBSORT))
"RTN","IBCEP0A",146,0)
CHGFMTQ S VALMBCK="R"
"RTN","IBCEP0A",147,0)
 Q
"RTN","IBCEP0A",148,0)
 ;
"RTN","IBCEP0A",149,0)
IPARAM ; Display Insurance co parameters and care unit requirements
"RTN","IBCEP0A",150,0)
 ; Assumes IBINS exists = IEN of insurance co
"RTN","IBCEP0A",151,0)
 N IBDSP,IBSORT,IBHOLD
"RTN","IBCEP0A",152,0)
 D FULL^VALM1
"RTN","IBCEP0A",153,0)
 S IBHOLD("IBINS")=$G(IBINS)
"RTN","IBCEP0A",154,0)
 D EN^VALM("IBCE PRVINS PARAM DISPLAY")
"RTN","IBCEP0A",155,0)
 S:$G(IBHOLD("IBINS"))'="" IBINS=IBHOLD("IBINS")
"RTN","IBCEP0A",156,0)
 K VALMQUIT
"RTN","IBCEP0A",157,0)
 S VALMBCK="R"
"RTN","IBCEP0A",158,0)
 Q
"RTN","IBCEP0A",159,0)
 ;
"RTN","IBCEP0A",160,0)
ADDID(IBINS,IBPRV,IBPTYP) ; Adds a new ID for the provider and/or ins co
"RTN","IBCEP0A",161,0)
 ; IBINS = ien of file 36
"RTN","IBCEP0A",162,0)
 ; IBPRV = vp ien of file 355.9
"RTN","IBCEP0A",163,0)
 ; IBPTYP = ien of file 355.97
"RTN","IBCEP0A",164,0)
 ; FUNCTION returns 1 if record not added, 0 if filed OK
"RTN","IBCEP0A",165,0)
 N IBIEN,IBQ,DIC,DA,DO,DD,DLAYGO,X,Y
"RTN","IBCEP0A",166,0)
 S IBQ=0
"RTN","IBCEP0A",167,0)
 I $G(IBPRV) D  G:IBQ ADDIDQ
"RTN","IBCEP0A",168,0)
 . ; Provider specific for insurance co - add to file 355.9
"RTN","IBCEP0A",169,0)
 . S DIC(0)="L",DLAYGO=355.9,DIC="^IBA(355.9,",X=IBPRV
"RTN","IBCEP0A",170,0)
 . S:$G(IBINS) DIC("DR")=".02////"_IBINS
"RTN","IBCEP0A",171,0)
 . D FILE^DICN K DIC,DLAYGO,DD,DO
"RTN","IBCEP0A",172,0)
 . I Y'>0!$D(DUOUT)!$D(DTOUT) S IBIEN=0,IBQ=1 Q
"RTN","IBCEP0A",173,0)
 . S IBIEN=+Y
"RTN","IBCEP0A",174,0)
 . D NEWID^IBCEP5B(355.9,IBINS,IBPRV,IBPTYP,IBIEN,"")
"RTN","IBCEP0A",175,0)
 E  D
"RTN","IBCEP0A",176,0)
 . ; Insurance co default - add to file 355.91
"RTN","IBCEP0A",177,0)
 . S DIC(0)="L",DLAYGO=355.91,DIC="^IBA(355.91,",X=IBINS
"RTN","IBCEP0A",178,0)
 . D FILE^DICN K DIC,DLAYGO,DD,DO
"RTN","IBCEP0A",179,0)
 . I Y'>0!$D(DUOUT)!$D(DTOUT) S IBIEN=0,IBQ=1 Q
"RTN","IBCEP0A",180,0)
 . S IBIEN=+Y
"RTN","IBCEP0A",181,0)
 . D NEWID^IBCEP5B(355.91,IBINS,"",IBPTYP,IBIEN,1)
"RTN","IBCEP0A",182,0)
ADDIDQ Q IBQ
"RTN","IBCEP4")
0^36^B23601105^B23664048
"RTN","IBCEP4",1,0)
IBCEP4 ;ALB/TMP - EDI UTILITIES for provider ID ;29-SEP-00
"RTN","IBCEP4",2,0)
 ;;2.0;INTEGRATED BILLING;**137,320,348,349,377**;21-MAR-94;Build 23
"RTN","IBCEP4",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP4",4,0)
 ;
"RTN","IBCEP4",5,0)
EN ; -- main entry point
"RTN","IBCEP4",6,0)
 N IBINS,IBALL,IB95
"RTN","IBCEP4",7,0)
 D ENX
"RTN","IBCEP4",8,0)
 Q
"RTN","IBCEP4",9,0)
 ;
"RTN","IBCEP4",10,0)
EN1(IBINS) ; -- Entry point from provider number maintenence
"RTN","IBCEP4",11,0)
 N IBPRV,IBALL,IB95
"RTN","IBCEP4",12,0)
 S VALMBCK="R"
"RTN","IBCEP4",13,0)
 D ENX
"RTN","IBCEP4",14,0)
 Q
"RTN","IBCEP4",15,0)
 ;
"RTN","IBCEP4",16,0)
ENX ; Common call to list template for dual entry points
"RTN","IBCEP4",17,0)
 N IBSLEV,DIR,Y
"RTN","IBCEP4",18,0)
 K IBFASTXT
"RTN","IBCEP4",19,0)
 D FULL^VALM1
"RTN","IBCEP4",20,0)
 S DIR(0)="SA^1:Performing Provider Care Units;2:Billing Provider Care Units"
"RTN","IBCEP4",21,0)
 S DIR("A")="Enter Type of Care Unit: ",DIR("B")=$P($P(DIR(0),":",2),";",1)
"RTN","IBCEP4",22,0)
 W ! D ^DIR K DIR W !
"RTN","IBCEP4",23,0)
 I Y'>0 Q
"RTN","IBCEP4",24,0)
 S IBSLEV=+Y
"RTN","IBCEP4",25,0)
 I IBSLEV=2 D EN^VALM("IBCE 2ND PRVID CARE UNIT MAINT") Q
"RTN","IBCEP4",26,0)
 D EN^VALM("IBCE PRVCARE UNIT MAINT")
"RTN","IBCEP4",27,0)
 Q
"RTN","IBCEP4",28,0)
 ;
"RTN","IBCEP4",29,0)
HDR ; -- header
"RTN","IBCEP4",30,0)
 K VALMHDR
"RTN","IBCEP4",31,0)
 S VALMHDR(1)=" "
"RTN","IBCEP4",32,0)
 S VALMHDR(2)="Insurance Co: "_$S('$G(IBALL)&$G(IBINS):$P($G(^DIC(36,+IBINS,0)),U),1:"ALL")
"RTN","IBCEP4",33,0)
 Q
"RTN","IBCEP4",34,0)
 ;
"RTN","IBCEP4",35,0)
INIT ; -- init variables, list array
"RTN","IBCEP4",36,0)
 N Z,IB,IBLCT,IBENT,IBNM,IB0,Z0,Z1,IBQ,DIR,Y,X
"RTN","IBCEP4",37,0)
 I $G(IBINS) S Y=IBINS ; For entrypoint from provider number maintenance
"RTN","IBCEP4",38,0)
 ;
"RTN","IBCEP4",39,0)
 I '$G(IBINS) D
"RTN","IBCEP4",40,0)
 . S DIR(0)="PA^DIC(36,:AEMQ",DIR("A")="Select INSURANCE CO: ",DIR("?")="Select an INSURANCE CO to display its care units"
"RTN","IBCEP4",41,0)
 . D ^DIR K DIR
"RTN","IBCEP4",42,0)
 . I $D(DTOUT)!$D(DUOUT) S Y=-2 Q
"RTN","IBCEP4",43,0)
 . I Y>0 S IBINS=+Y Q
"RTN","IBCEP4",44,0)
 ;
"RTN","IBCEP4",45,0)
 I Y'=-2 D
"RTN","IBCEP4",46,0)
 . D BLD
"RTN","IBCEP4",47,0)
 E  D
"RTN","IBCEP4",48,0)
 . S VALMQUIT=1
"RTN","IBCEP4",49,0)
 Q
"RTN","IBCEP4",50,0)
 ;
"RTN","IBCEP4",51,0)
BLD ;  Bld display  - IBINS must = ien of file 36
"RTN","IBCEP4",52,0)
 K ^TMP("IBPRV_CU",$J)
"RTN","IBCEP4",53,0)
 ;
"RTN","IBCEP4",54,0)
 I $G(IBSLEV)=2 Q
"RTN","IBCEP4",55,0)
 ;
"RTN","IBCEP4",56,0)
 S (IBENT,IBLCT)=0,IBNM=""
"RTN","IBCEP4",57,0)
 F  S IBNM=$O(^IBA(355.95,"C",IBINS,IBNM)) Q:IBNM=""  S Z=0 F  S Z=$O(^IBA(355.95,"C",IBINS,IBNM,Z)) Q:'Z  S IB=$G(^IBA(355.95,Z,0)) I IB'="",$P(IB,U,4)="" D
"RTN","IBCEP4",58,0)
 . S IBLCT=IBLCT+1,IBENT=IBENT+1
"RTN","IBCEP4",59,0)
 . I '$D(^IBA(355.96,"AUNIQ",IBINS,Z)) D SET^VALM10(IBLCT,$E(IBENT_"    ",1,4)_$E($P(IB,U)_$J("",30),1,30)_"  "_$E($P(IB,U,2)_$J("",20),1,20)_" (NO COMBINATIONS FOUND)",IBENT) Q
"RTN","IBCEP4",60,0)
 . D SET^VALM10(IBLCT,$E(IBENT_"    ",1,4)_$E($P(IB,U)_$J("",30),1,30)_"  "_$E($P(IB,U,2)_$J("",20),1,20),IBENT)
"RTN","IBCEP4",61,0)
 . S ^TMP("IBPRV_CU",$J,"ZIDX",IBENT)=Z
"RTN","IBCEP4",62,0)
 . S Z0=0 F  S Z0=$O(^IBA(355.96,"AE",Z,Z0)) Q:'Z0  S Z1=0 F  S Z1=$O(^IBA(355.96,"AE",Z,Z0,Z1)) Q:'Z1  S IB0=$G(^IBA(355.96,Z1,0)) I IB0'="" D
"RTN","IBCEP4",63,0)
 .. S IBLCT=IBLCT+1
"RTN","IBCEP4",64,0)
 .. S IBQ=$J("",28)_"o "_$E($$EXPAND^IBTRE(355.96,.06,+$P(IB0,U,6))_$J("",20),1,20)
"RTN","IBCEP4",65,0)
 .. S IBQ=IBQ_"  "_$E($P("Both form types^UB-04 Only^CMS-1500 Only",U,$P(IB0,U,4)+1)_$J("",15),1,15)_"  "_$E($P("Inpt/Outpt^Inpt Only^Outpt Only^RX Only",U,+$P(IB0,U,5)+1)_$J("",10),1,10)
"RTN","IBCEP4",66,0)
 .. D SET^VALM10(IBLCT,IBQ,IBENT)
"RTN","IBCEP4",67,0)
 ;
"RTN","IBCEP4",68,0)
 I 'IBLCT D SET^VALM10(1,"No CARE UNITs Found"_$S('$G(IBINS):"",1:" for Insurance Co")) S IBLCT=1
"RTN","IBCEP4",69,0)
 S VALMCNT=IBLCT,VALMBG=1
"RTN","IBCEP4",70,0)
 Q
"RTN","IBCEP4",71,0)
 ;
"RTN","IBCEP4",72,0)
HELP ; -- help
"RTN","IBCEP4",73,0)
 ;
"RTN","IBCEP4",74,0)
 I $G(IBSLEV)=2 Q
"RTN","IBCEP4",75,0)
 ;
"RTN","IBCEP4",76,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBCEP4",77,0)
 Q
"RTN","IBCEP4",78,0)
 ;
"RTN","IBCEP4",79,0)
EXIT ; -- exit
"RTN","IBCEP4",80,0)
 D CLEAN^VALM10
"RTN","IBCEP4",81,0)
 K ^TMP("IBPRV_CU",$J),IBINS,IBALL
"RTN","IBCEP4",82,0)
 Q
"RTN","IBCEP4",83,0)
 ;
"RTN","IBCEP4",84,0)
EXPND ;
"RTN","IBCEP4",85,0)
 Q
"RTN","IBCEP4",86,0)
 ;
"RTN","IBCEP4",87,0)
SEL(IBDA,MANY) ; Select from care unit list
"RTN","IBCEP4",88,0)
 ; IBDA is passed by reference and IBDA(1) returned containing
"RTN","IBCEP4",89,0)
 ;  ien's of the care unit selected (file 355.95).
"RTN","IBCEP4",90,0)
 ; If > 1 entry can be selected, MANY is set to 1
"RTN","IBCEP4",91,0)
 N Z
"RTN","IBCEP4",92,0)
 S IBDA=0
"RTN","IBCEP4",93,0)
 D EN^VALM2($G(XQORNOD(0)),$S($G(MANY):"",1:"S"))
"RTN","IBCEP4",94,0)
 S Z=0 F  S Z=$O(VALMY(Z)) Q:'Z  S IBDA=IBDA+1,IBDA(IBDA)=+$G(^TMP("IBPRV_CU",$J,"ZIDX",Z))
"RTN","IBCEP4",95,0)
 Q
"RTN","IBCEP4",96,0)
 ;
"RTN","IBCEP4",97,0)
DISP(IBVAR,IBINS,IBPTYP,IBFT,IBCT,START,END) ; Set up display array for
"RTN","IBCEP4",98,0)
 ; provider id
"RTN","IBCEP4",99,0)
 N Z
"RTN","IBCEP4",100,0)
 S START=$S($G(START):START,1:1)
"RTN","IBCEP4",101,0)
 S (Z,END)=$G(START)
"RTN","IBCEP4",102,0)
 S @IBVAR@(START)="INSURANCE: "_$S(IBINS:$P($G(^DIC(36,+IBINS,0)),U),1:"ALL INSURANCE")
"RTN","IBCEP4",103,0)
 S @IBVAR@(START+1)="PROV TYPE: "_$$EXPAND^IBTRE(355.96,.06,IBPTYP)
"RTN","IBCEP4",104,0)
 S @IBVAR@(START+2)="FORM TYPE: "_$$EXPAND^IBTRE(355.96,.04,IBFT)
"RTN","IBCEP4",105,0)
 S @IBVAR@(START+3)="CARE TYPE: "_$$EXPAND^IBTRE(355.96,.05,IBCT)
"RTN","IBCEP4",106,0)
 S END=$G(START)+3
"RTN","IBCEP4",107,0)
 Q
"RTN","IBCEP4",108,0)
 ;
"RTN","IBCEP4",109,0)
CAREUOK(IBIFN,IBCU,IBTYPE,IBSEQ) ; Returns 1 if care unit is appropriate 
"RTN","IBCEP4",110,0)
 ; for bill based on provider type, care type, bill type and insurance co
"RTN","IBCEP4",111,0)
 ; IBIFN = ien of bill (file 399)
"RTN","IBCEP4",112,0)
 ; IBCU = the ien of the care unit (file 355.96)
"RTN","IBCEP4",113,0)
 ; IBTYPE = type of ID being checked (1=performing, 2=EMC)
"RTN","IBCEP4",114,0)
 ; IBSEQ = the COB seq being checked (1-3)
"RTN","IBCEP4",115,0)
 N Z,IBOK,IBINS,IBCT,IBFT,IBPTYP,IBRX
"RTN","IBCEP4",116,0)
 S IBOK=0
"RTN","IBCEP4",117,0)
 S IBINS=+$$FINDINS^IBCEF1(IBIFN,+IBSEQ),IBFT=$S($$FT^IBCEF(IBIFN)=2:2,1:1)
"RTN","IBCEP4",118,0)
 S IBPTYP=+$S(IBTYPE=1:$$PPTYP^IBCEP0(IBINS),1:$$EMCID^IBCEP())
"RTN","IBCEP4",119,0)
 S IBRX=$$ISRX^IBCEF1(IBIFN)
"RTN","IBCEP4",120,0)
 S IBCT=$S('IBRX:$S($$INPAT^IBCEF(IBIFN,1):1,1:2),1:3)
"RTN","IBCEP4",121,0)
 ;Check from most general to most specific
"RTN","IBCEP4",122,0)
 I $D(^IBA(355.96,"AD",IBINS,0,0,IBPTYP,IBCU)) S IBOK=1 G CAREOKQ
"RTN","IBCEP4",123,0)
 I 'IBRX,$D(^IBA(355.96,"AD",IBINS,IBFT,0,IBPTYP,IBCU)) S IBOK=1 G CAREOKQ
"RTN","IBCEP4",124,0)
 I $D(^IBA(355.96,"AD",IBINS,0,IBCT,IBPTYP,IBCU)) S IBOK=1 G CAREOKQ
"RTN","IBCEP4",125,0)
 I $D(^IBA(355.96,"AD",IBINS,IBFT,IBCT,IBPTYP,IBCU)) S IBOK=1 G CAREOKQ
"RTN","IBCEP4",126,0)
 ;
"RTN","IBCEP4",127,0)
CAREOKQ Q IBOK
"RTN","IBCEP4",128,0)
 ;
"RTN","IBCEP4A")
0^37^B54389720^B49631156
"RTN","IBCEP4A",1,0)
IBCEP4A ;ALB/TMP - EDI UTILITIES for provider ID ;29-SEP-00
"RTN","IBCEP4A",2,0)
 ;;2.0;INTEGRATED BILLING;**137,232,280,349,377**;21-MAR-94;Build 23
"RTN","IBCEP4A",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP4A",4,0)
 ;
"RTN","IBCEP4A",5,0)
NEW(IB) ; Add care unit
"RTN","IBCEP4A",6,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEP4A",7,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEP4A",8,0)
 N DIC,DIR,X,Y,Z,DA,DR,DIE,DO,DD,DLAYGO,IB95,IBADD,IBOK
"RTN","IBCEP4A",9,0)
 I '$G(IB) D FULL^VALM1
"RTN","IBCEP4A",10,0)
 ;
"RTN","IBCEP4A",11,0)
 ; Add an entry - either new care unit/ins co or a combination for
"RTN","IBCEP4A",12,0)
 ;  existing care unit/ins co
"RTN","IBCEP4A",13,0)
 S DIC("A")="SELECT CARE UNIT FOR THE INSURANCE CO: ",DIC="^IBA(355.95,",DIC("S")="I $P(^(0),U,3)=+$G(IBINS)",DIC(0)="AELMQ",DIC("DR")=".03////"_+$G(IBINS)_";.02",DLAYGO=355.95 D ^DIC K DIC,DLAYGO
"RTN","IBCEP4A",14,0)
 G:Y'>0 NEWQ
"RTN","IBCEP4A",15,0)
 S IB95=3,IB95("IBCU")=+Y
"RTN","IBCEP4A",16,0)
 D INSASS(IBINS,.IB95)
"RTN","IBCEP4A",17,0)
 I '$G(IB) D BLD^IBCEP4
"RTN","IBCEP4A",18,0)
NEWQ I '$G(IB) S VALMBCK="R"
"RTN","IBCEP4A",19,0)
 Q
"RTN","IBCEP4A",20,0)
 ;
"RTN","IBCEP4A",21,0)
CHANGE(IB) ; Edit a care unit name or combination for ins co IBINS
"RTN","IBCEP4A",22,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEP4A",23,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEP4A",24,0)
 N DIC,DIK,DIR,X,Y,Z,DA,DR,DIE,DO,DD,DLAYGO,IB95,IBOK,IBZ,IB0,IBEDIT,IBCK,IBDA,IBCHG,IBDELETE,Z100,DTOUT,DUOUT
"RTN","IBCEP4A",25,0)
 I '$G(IB) D FULL^VALM1 S Y=$$SEL()
"RTN","IBCEP4A",26,0)
 I $G(IB) S DIC("A")="CARE UNIT NAME: ",DIC(0)="AEMQ",DIC("S")="I $P(^(0),U,3)=+$G(IBINS)",DIC="^IBA(355.95," W ! D ^DIC K DIC
"RTN","IBCEP4A",27,0)
 I Y'>0 G CHGQ
"RTN","IBCEP4A",28,0)
 S IB95("IBCU")=+Y,IBDELETE=0,IBDELETE(0)=$G(^IBA(355.95,0)),IBDELETE(1)=$G(^(1))
"RTN","IBCEP4A",29,0)
 ; Edit fields outside of FM to assure uniqueness of combos is maintained
"RTN","IBCEP4A",30,0)
 W ! S DIR("A")="CARE UNIT NAME: ",DIR("B")=$P($G(^IBA(355.95,+IB95("IBCU"),0)),U),DIR(0)="355.95,.01AO",DIR("S")="I $P(^(0),U,3)=IBINS" D ^DIR K DIR
"RTN","IBCEP4A",31,0)
 I $D(DTOUT)!$D(DUOUT) G CHGQ
"RTN","IBCEP4A",32,0)
 I X="@" S DIR(0)="EA",DIR("A")="NOTHING DELETED - PRESS ENTER TO CONTINUE" D ^DIR K DIR G CHGQ
"RTN","IBCEP4A",33,0)
 I $P($G(^IBA(355.95,IB95("IBCU"),0)),U)'=Y S DIE="^IBA(355.95,",DR=".01///"_Y,DA=IB95("IBCU") D ^DIE ; File the name change
"RTN","IBCEP4A",34,0)
 S DR=".02",DIE="^IBA(355.95,",DA=IB95("IBCU") D ^DIE
"RTN","IBCEP4A",35,0)
 I $D(Y) G CHGQ
"RTN","IBCEP4A",36,0)
 ;
"RTN","IBCEP4A",37,0)
 I $O(^IBA(355.96,"ACARE",IB95("IBCU"),""))="" S IB95=3 D INSASS(IBINS,.IB95) G CHGQ
"RTN","IBCEP4A",38,0)
 ; only 1 combination found for ins/care unit
"RTN","IBCEP4A",39,0)
 I $O(^IBA(355.96,"ACARE",IB95("IBCU"),""),-1)=$O(^IBA(355.96,"ACARE",IB95("IBCU"),0)) D
"RTN","IBCEP4A",40,0)
 . S IBDA=$O(^IBA(355.96,"ACARE",IB95("IBCU"),0))
"RTN","IBCEP4A",41,0)
 ;
"RTN","IBCEP4A",42,0)
 ; Choose the combination to edit - more than 1 exists
"RTN","IBCEP4A",43,0)
 E  D
"RTN","IBCEP4A",44,0)
 . W !,"SELECT ONE OF THE FOLLOWING CARE UNIT COMBINATIONS:"
"RTN","IBCEP4A",45,0)
 . S DIC="^IBA(355.96,",DIC(0)="EMQ",DIC("S")="I $D(^IBA(355.96,""ACARE"","_IB95("IBCU")_",Y))",X=IBINS D ^DIC K DIC S IBDA=+Y
"RTN","IBCEP4A",46,0)
 ;
"RTN","IBCEP4A",47,0)
 I IBDA>0 D
"RTN","IBCEP4A",48,0)
 . N IBDA0,Q,Q0
"RTN","IBCEP4A",49,0)
 . S IBDA0=$G(^IBA(355.96,IBDA,0))
"RTN","IBCEP4A",50,0)
 . Q:IBDA0=""
"RTN","IBCEP4A",51,0)
 . W !!,"*** CARE UNIT COMBINATION FOR: ",$P($G(^IBA(355.95,+IB95("IBCU"),0)),U)," ***"
"RTN","IBCEP4A",52,0)
 . D DISP^IBCEP4("Q",IBINS,$P(IBDA0,U,6),$P(IBDA0,U,4),$P(IBDA0,U,5),1,.Q0)
"RTN","IBCEP4A",53,0)
 . S Z=0 F  S Z=$O(Q(Z)) Q:'Z  W !,Q(Z)
"RTN","IBCEP4A",54,0)
 . I $P(IBDA0,U,7) W !,"EXP DATE: ",$$FMTE^XLFDT($P(IBDA0,U,7),"2D")
"RTN","IBCEP4A",55,0)
 . W !,"CARE UNIT: ",$P($G(^IBA(355.95,+IBDA0,0)),U),!
"RTN","IBCEP4A",56,0)
 . W ! S DIR(0)="SA^E:EDIT;D:DELETE",DIR("B")="EDIT",DIR("A")="EDIT OR DELETE THIS CARE UNIT COMBINATION?: " D ^DIR K DIR
"RTN","IBCEP4A",57,0)
 . I $D(DTOUT)!$D(DUOUT) Q
"RTN","IBCEP4A",58,0)
 . I Y="D" D  Q
"RTN","IBCEP4A",59,0)
 .. S DIR(0)="YA",DIR("A")="ARE YOU SURE YOU WANT TO DELETE THIS CARE UNIT COMBINATION?: ",DIR("B")="NO" D ^DIR K DIR
"RTN","IBCEP4A",60,0)
 .. I Y=1 S DIK="^IBA(355.96,",DA=IBDA,IBCHG=1 D ^DIK
"RTN","IBCEP4A",61,0)
 . S (IBCK,IBCHG)=0,(IBEDIT,IBOK)=1
"RTN","IBCEP4A",62,0)
 . F  Q:'IBEDIT  S IBEDIT=0,IB0=$G(^IBA(355.96,+IBDA,0)) K IBZ F Z=.01,.03,.06,.04,.05 D  Q:'IBOK!IBEDIT
"RTN","IBCEP4A",63,0)
 .. S Z100=Z*100
"RTN","IBCEP4A",64,0)
 .. I Z100=1 W !,"CARE UNIT: ",$P($G(^IBA(355.95,IB95("IBCU"),0)),U) S IBZ(.01)=$P(IB0,U) Q
"RTN","IBCEP4A",65,0)
 .. I Z100=3 W !,"INSURANCE COMPANY: ",$$EXPAND^IBTRE(355.96,.03,$P(IB0,U,3)) S IBZ(.03)=$P(IB0,U) Q
"RTN","IBCEP4A",66,0)
 .. I Z100=5 S IBCK=1
"RTN","IBCEP4A",67,0)
 .. S IBZ(Z)=$$EDIT(Z,IB0,+IBDA,IBCK),IBCK=0
"RTN","IBCEP4A",68,0)
 .. I '$P(IBZ(Z),U,2) D  Q
"RTN","IBCEP4A",69,0)
 ... I $P(IB0,U,Z100)'=IBZ(Z) S IBCHG=1
"RTN","IBCEP4A",70,0)
 ... S $P(IB0,U,Z100)=IBZ(Z)
"RTN","IBCEP4A",71,0)
 .. S (IBOK,IBCHG)=0
"RTN","IBCEP4A",72,0)
 .. I $P(IBZ(Z),U,2)=2 D
"RTN","IBCEP4A",73,0)
 ... S DIR(0)="YA",DIR("A",1)="This entry already exists",DIR("A")="Do you want to re-edit?: " W ! D ^DIR K DIR W !
"RTN","IBCEP4A",74,0)
 ... I Y=1 S (IBOK,IBEDIT)=1
"RTN","IBCEP4A",75,0)
 . I IBOK Q:'IBCHG  S DIE="^IBA(355.96,",DR=".03////"_IBZ(.03)_";.04////"_IBZ(.04)_";.05////"_IBZ(.05)_";.06////"_IBZ(.06)_";.07",DA=+IBDA D ^DIE,BLD^IBCEP4 Q
"RTN","IBCEP4A",76,0)
 ;
"RTN","IBCEP4A",77,0)
 I '$G(IB) D BLD^IBCEP4
"RTN","IBCEP4A",78,0)
CHGQ I '$G(IB) S VALMBCK="R"
"RTN","IBCEP4A",79,0)
 Q
"RTN","IBCEP4A",80,0)
 ;
"RTN","IBCEP4A",81,0)
INSASS(IBINSZ,IB95) ; Assign care unit to or delete from an ins co
"RTN","IBCEP4A",82,0)
 ; IBINSZ = ien of ins co (file 36)
"RTN","IBCEP4A",83,0)
 ; IB95 = flag  ("IBCU")=care unit
"RTN","IBCEP4A",84,0)
 ;     can have subscripts to send in pre-entered data
"RTN","IBCEP4A",85,0)
 N DIR,DIC,DA,DR,X,Y,Z,IBFT,IBCT,IBPTYP,IBCU,IBCHG,IBINS,IBDA,IBPXDT,IBDICS
"RTN","IBCEP4A",86,0)
 S IBINS=IBINSZ
"RTN","IBCEP4A",87,0)
 S IBCHG=0,IBCU=$G(IB95("IBCU"))
"RTN","IBCEP4A",88,0)
 D FULL^VALM1
"RTN","IBCEP4A",89,0)
 I '$G(IBINSZ) K IB95 G INSQ
"RTN","IBCEP4A",90,0)
 W !
"RTN","IBCEP4A",91,0)
 F Z=.06,.04,.05,.07,.03 D  G:Z="" INSQ
"RTN","IBCEP4A",92,0)
 . ;
"RTN","IBCEP4A",93,0)
 . I $S(Z=.04:'$D(IB95("IBFT")),Z=.05:'$D(IB95("IBCT")),Z=.06:'$D(IB95("IBPTYP")),Z=.03:'$D(IB95("IBCU")),1:1) D
"RTN","IBCEP4A",94,0)
 .. N DA
"RTN","IBCEP4A",95,0)
 .. K IBDICS
"RTN","IBCEP4A",96,0)
 .. I Z=.04 D
"RTN","IBCEP4A",97,0)
 ... I $P($G(^IBE(355.97,+$G(IB95("IBPTYP")),0)),U,3)="1A" S IBDICS="I Y'=1 K X",DIR("B")="UB-04",DIR("?")="ONLY UB-04 IS VALID FOR A BLUE CROSS ID"
"RTN","IBCEP4A",98,0)
 .. S DIR(0)="355.96,"_Z_$S($G(IBDICS)="":"",1:"^^"_IBDICS) D ^DIR K DIR
"RTN","IBCEP4A",99,0)
 . I $D(DTOUT)!$D(DUOUT) S VALMBCK="R",Z="" K:$G(IB95)=2 IB95 Q
"RTN","IBCEP4A",100,0)
 . ;
"RTN","IBCEP4A",101,0)
 . I Z=.04 S IBFT=$S($G(IB95("IBFT"))="":+Y,1:IB95("IBFT")) S IB95("IBFT")=IBFT Q
"RTN","IBCEP4A",102,0)
 . ;
"RTN","IBCEP4A",103,0)
 . I Z=.05 S IBCT=$S($G(IB95("IBCT"))="":+Y,1:IB95("IBCT")) S IB95("IBCT")=IBCT Q
"RTN","IBCEP4A",104,0)
 . ;
"RTN","IBCEP4A",105,0)
 . I Z=.06 S IBPTYP=$S($G(IB95("IBPTYP"))="":+Y,1:IB95("IBPTYP")) S IB95("IBPTYP")=IBPTYP Q
"RTN","IBCEP4A",106,0)
 . ;
"RTN","IBCEP4A",107,0)
 . I Z=.07 S IBPXDT=$S('$G(IB95("IBEXPDT")):+Y,1:IB95("IBEXPDT")) S IB95("IBEXPDT")=IBPXDT Q
"RTN","IBCEP4A",108,0)
 . ;
"RTN","IBCEP4A",109,0)
 . I Z=.03,$G(IB95)=3,$G(IB95("IBCU"))'="" D  Q:Z=""
"RTN","IBCEP4A",110,0)
 .. N Q  ; Assign from add care type
"RTN","IBCEP4A",111,0)
 .. S IBCT=0
"RTN","IBCEP4A",112,0)
 .. W !,"CARE UNIT: "_$$EXPAND^IBTRE(355.96,.01,IB95("IBCU"))
"RTN","IBCEP4A",113,0)
 .. S IB95("IBINS")=+IBINSZ
"RTN","IBCEP4A",114,0)
 .. I $D(^IBA(355.96,"AUNIQ",IBINSZ,IB95("IBCU"),IB95("IBFT"),IB95("IBCT"),IB95("IBPTYP"))) D  Q
"RTN","IBCEP4A",115,0)
 ... S DIR(0)="EA",DIR("A",1)="This combination already exists - NOT ADDED",DIR("A")="Press ENTER to continue" W ! D ^DIR K DIR W !
"RTN","IBCEP4A",116,0)
 .. S IBCT=1 S Y=$$ADDCU(IBINSZ,IB95("IBCU"),IB95("IBFT"),IB95("IBCT"),IB95("IBPTYP"))
"RTN","IBCEP4A",117,0)
 .. I Y<0 W ! S DIR("A",1)="  >> Care Unit NOT completely filed",DIR("A")="PRESS ENTER TO CONTINUE ",DIR(0)="EA" D ^DIR K DIR Q
"RTN","IBCEP4A",118,0)
 .. W ! S DIR(0)="EA",DIR("A",1)="  >> CARE UNIT COMBINATION FILED FOR THE INSURANCE CO",IBCT=1,IBCHG=1,DIR("A")="PRESS ENTER TO CONTINUE ",DIR(0)="EA" D ^DIR K DIR
"RTN","IBCEP4A",119,0)
 I $G(IBCHG) D BLD^IBCEP4
"RTN","IBCEP4A",120,0)
INSQ S VALMBCK="R"
"RTN","IBCEP4A",121,0)
 Q
"RTN","IBCEP4A",122,0)
 ;
"RTN","IBCEP4A",123,0)
EDIT(IBFLD,IB0,IBIEN,IBCK1) ; Allow addition/edit of fields in file 355.96
"RTN","IBCEP4A",124,0)
 ; without direct Fileman call so uniqueness can be checked
"RTN","IBCEP4A",125,0)
 ; IBFLD = field # in file 355.96
"RTN","IBCEP4A",126,0)
 ; IB0 = current 0-node of data in the entry in file 355.96
"RTN","IBCEP4A",127,0)
 ; IBIEN = ien of entry being edited in file 355.96
"RTN","IBCEP4A",128,0)
 ; IBCK1 = flag ... if 1, checks for uniqueness after field changed
"RTN","IBCEP4A",129,0)
 ;
"RTN","IBCEP4A",130,0)
 ; FUNCTION RETURNS: value of field if field is OK, second piece is null
"RTN","IBCEP4A",131,0)
 ;                   If not good, 2nd piece = 1 : no data or ^ entered
"RTN","IBCEP4A",132,0)
 ;                                          = 2 : record not unique
"RTN","IBCEP4A",133,0)
 N DIR,DA,Y,X,IBNEW,IBINS,IBVAL
"RTN","IBCEP4A",134,0)
 S IBINS=+IB0,IBNEW="",IBVAL=$$EXPAND^IBTRE(355.96,IBFLD,$P(IB0,U,(IBFLD*100)))
"RTN","IBCEP4A",135,0)
 S DIR(0)="355.96,"_IBFLD
"RTN","IBCEP4A",136,0)
 S:IBVAL'="" DIR("B")=IBVAL
"RTN","IBCEP4A",137,0)
 D ^DIR K DIR
"RTN","IBCEP4A",138,0)
 I Y=""!$D(DTOUT)!$D(DUOUT) S IBNEW="^1" G EDITQ
"RTN","IBCEP4A",139,0)
 S IBNEW=$P(Y,U)
"RTN","IBCEP4A",140,0)
 I $G(IBCK1) D
"RTN","IBCEP4A",141,0)
 . N X1,X2,X3,X4,X5
"RTN","IBCEP4A",142,0)
 . S X1=$S(IBFLD'=.03:IBINS,1:IBNEW),X2=$S(IBFLD'=.01:$P(IB0,U),1:IBNEW),X3=$S(IBFLD'=.04:$P(IB0,U,4),1:IBNEW),X4=$S(IBFLD'=.05:$P(IB0,U,5),1:IBNEW),X5=$S(IBFLD'=.06:$P(IB0,U,6),1:IBNEW)
"RTN","IBCEP4A",143,0)
 . I $S(X1=""!(X2="")!(X3="")!(X4="")!(X5=""):1,$O(^IBA(355.96,"AUNIQ",X1,X2,X3,X4,X5,0)):$O(^(0))'=IBIEN,1:0) S IBNEW=IBNEW_"^2"
"RTN","IBCEP4A",144,0)
 ;
"RTN","IBCEP4A",145,0)
EDITQ Q IBNEW
"RTN","IBCEP4A",146,0)
 ;
"RTN","IBCEP4A",147,0)
ADDCU(IBINSZ,IBCU,IBFT,IBCT,IBPTYP) ;  Add a new care unit record to file 355.96
"RTN","IBCEP4A",148,0)
 ; Same parameter definitions as EDIT
"RTN","IBCEP4A",149,0)
 N DIC,DA,X,Y,DLAYGO
"RTN","IBCEP4A",150,0)
 S DIC(0)="L",DLAYGO=355.96,DIC="^IBA(355.96,",DIC("DR")=".03////"_IBINSZ_";.04////"_IBFT_";.05////"_IBCT_";.06////"_IBPTYP,X=IBCU
"RTN","IBCEP4A",151,0)
 D FILE^DICN
"RTN","IBCEP4A",152,0)
 Q Y
"RTN","IBCEP4A",153,0)
 ;
"RTN","IBCEP4A",154,0)
DELETE(IB) ; delete a care unit name
"RTN","IBCEP4A",155,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEP4A",156,0)
 N DIR,X,Y
"RTN","IBCEP4A",157,0)
 I '$G(IB) D FULL^VALM1 S Y=$$SEL() I Y'>0 G DELETEQ
"RTN","IBCEP4A",158,0)
 S:'$G(IB) IB95("IBCU")=+Y
"RTN","IBCEP4A",159,0)
 S DIR("A",1)="THIS WILL DELETE THE CARE UNIT NAME AND ALL ITS COMBINATIONS",DIR("A")="ARE YOU SURE THIS IS WHAT YOU WANT TO DO?: ",DIR(0)="YA",DIR("B")="NO" D ^DIR K DIR
"RTN","IBCEP4A",160,0)
 I Y'=1 S IB95("IBCU")="" Q  ; Changed their mind - don't delete
"RTN","IBCEP4A",161,0)
 S Z=0 F  S Z=$O(^IBA(355.96,"B",IB95("IBCU"),Z)) Q:'Z  S DIK="^IBA(355.96,",DA=Z D ^DIK
"RTN","IBCEP4A",162,0)
 S DA=IB95("IBCU"),DIK="^IBA(355.95," D ^DIK
"RTN","IBCEP4A",163,0)
 W ! S DIR(0)="EA",DIR("A",1)="CARE UNIT AND ALL ITS COMBINATIONS WERE DELETED",DIR("A")="PRESS ENTER TO CONTINUE " D ^DIR K DIR D BLD^IBCEP4
"RTN","IBCEP4A",164,0)
DELETEQ ;
"RTN","IBCEP4A",165,0)
 S:'$G(IB) VALMBCK="R"
"RTN","IBCEP4A",166,0)
 Q
"RTN","IBCEP4A",167,0)
 ;
"RTN","IBCEP4A",168,0)
SEL() ; Select entry from list
"RTN","IBCEP4A",169,0)
 ; returns ien in file 355.95 for selected entry
"RTN","IBCEP4A",170,0)
 N VALMY,SEL
"RTN","IBCEP4A",171,0)
 D EN^VALM2($G(XQORNOD(0)),"S")
"RTN","IBCEP4A",172,0)
 S SEL=+$O(VALMY(""))
"RTN","IBCEP4A",173,0)
 I SEL'>0 Q 0
"RTN","IBCEP4A",174,0)
 Q +$G(^TMP("IBPRV_CU",$J,"ZIDX",SEL))
"RTN","IBCEP4A",175,0)
 ;
"RTN","IBCEP5")
0^42^B48717212^B48846448
"RTN","IBCEP5",1,0)
IBCEP5 ;ALB/TMP - EDI UTILITIES for provider ID ;29-SEP-00
"RTN","IBCEP5",2,0)
 ;;2.0;INTEGRATED BILLING;**137,232,320,348,349,377**;21-MAR-94;Build 23
"RTN","IBCEP5",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP5",4,0)
 ;
"RTN","IBCEP5",5,0)
EN ; -- main entry point for IBCE PRV MAINT
"RTN","IBCEP5",6,0)
 N IBPRV,IBINS
"RTN","IBCEP5",7,0)
EN1 ; Entrypoint for non-VA provider ID maintenance hook
"RTN","IBCEP5",8,0)
 N IBSLEV,DIR,Y,X,IBPRMPT,IBNVAFL,IBIF
"RTN","IBCEP5",9,0)
 K IBFASTXT
"RTN","IBCEP5",10,0)
 S IBIF="" I $G(IBPRV) S IBIF=$$GET1^DIQ(355.93,IBPRV,.02,"I")
"RTN","IBCEP5",11,0)
 D FULL^VALM1
"RTN","IBCEP5",12,0)
 S IBPRMPT=$S(IBIF=1:"LAB OR FACILITY",1:"PROVIDER")
"RTN","IBCEP5",13,0)
 S DIR(0)="SA^1:"_IBPRMPT_"'S OWN IDS;2:"_IBPRMPT_" IDS FURNISHED BY AN INSURANCE COMPANY"
"RTN","IBCEP5",14,0)
 S DIR("A")="SELECT SOURCE OF ID: ",DIR("B")=$P($P(DIR(0),":",2),";")
"RTN","IBCEP5",15,0)
 W ! D ^DIR K DIR W !
"RTN","IBCEP5",16,0)
 I Y'>0 Q
"RTN","IBCEP5",17,0)
 S IBSLEV=+Y
"RTN","IBCEP5",18,0)
 D EN^VALM("IBCE PRVPRV MAINT")
"RTN","IBCEP5",19,0)
 Q
"RTN","IBCEP5",20,0)
 ;
"RTN","IBCEP5",21,0)
HDR ; -- header code
"RTN","IBCEP5",22,0)
 N IBC,Z,IBIF
"RTN","IBCEP5",23,0)
 S IBIF="" I $G(IBNPRV) S IBIF=$$GET1^DIQ(355.93,IBNPRV,.02,"I")
"RTN","IBCEP5",24,0)
 K VALMHDR
"RTN","IBCEP5",25,0)
 S IBC=1
"RTN","IBCEP5",26,0)
 S IBPRMPT=$S(IBIF=1:"Lab or Facility",1:"Performing Provider")
"RTN","IBCEP5",27,0)
 S Z="** "_$S($G(IBSLEV)=1:IBPRMPT_"'s Own IDs (No Specific Insurance Co)",1:IBPRMPT_" IDs from Insurance Co")_" **"
"RTN","IBCEP5",28,0)
 S VALMHDR(IBC)=$J("",80-$L(Z)\2)_Z,IBC=IBC+1
"RTN","IBCEP5",29,0)
 I $G(IBPRV),'+IBIF S VALMHDR(IBC)="PROVIDER   : "_$$EXPAND^IBTRE(355.9,.01,IBPRV)_$S(IBPRV["VA(200":" (VA PROVIDER)",1:" (NON-VA PROVIDER)"),IBC=IBC+1
"RTN","IBCEP5",30,0)
 I $G(IBPRV),+IBIF S VALMHDR(IBC)="Provider: "_$$EXPAND^IBTRE(355.9,.01,IBPRV)_$S(IBIF=1:"(Non-VA Lab or Facility)",1:""),IBC=IBC+1
"RTN","IBCEP5",31,0)
 I $G(IBINS) D
"RTN","IBCEP5",32,0)
 . N PCF,PCDISP
"RTN","IBCEP5",33,0)
 . S PCF=$P($G(^DIC(36,+IBINS,3)),"^",13)
"RTN","IBCEP5",34,0)
 . S PCDISP=$S($G(IBSLEV)'=2!($G(IBPRV)'["VA(200,"):"",PCF="C":"(Child)",PCF="P":"(Parent)",1:"")
"RTN","IBCEP5",35,0)
 . S VALMHDR(IBC)=$S(IBIF:"Insurance Co: ",1:"INSURANCE CO: ")_$P($G(^DIC(36,+IBINS,0)),U)_" "_PCDISP
"RTN","IBCEP5",36,0)
 Q
"RTN","IBCEP5",37,0)
 ;
"RTN","IBCEP5",38,0)
INIT ; -- init variables and list array
"RTN","IBCEP5",39,0)
 N IBFILE,DIR,DIC,Y,X,DTOUT,DUOUT,IBIF,AGAIN
"RTN","IBCEP5",40,0)
 ;
"RTN","IBCEP5",41,0)
 K ^TMP("IB_EDITED_IDS",$J)  ; This will be to keep track of ID's edited during this session
"RTN","IBCEP5",42,0)
 S IBIF="" I $G(IBNPRV) S IBIF=$$GET1^DIQ(355.93,IBNPRV,.02,"I")
"RTN","IBCEP5",43,0)
 ;
"RTN","IBCEP5",44,0)
 ; Removing Care Unit under certain conditions
"RTN","IBCEP5",45,0)
 ; This list is used for multiple purposes and not all have Care Units Associated with them
"RTN","IBCEP5",46,0)
 ; Also, a different protocol menu is used with these
"RTN","IBCEP5",47,0)
 ; IBNPRV is a non VA provider
"RTN","IBCEP5",48,0)
 ; IBIF = 1 means this is a group or facility, not an individual.
"RTN","IBCEP5",49,0)
 ; 
"RTN","IBCEP5",50,0)
 I $G(IBNPRV),$G(IBIF)=1 D
"RTN","IBCEP5",51,0)
 . S VALM("TITLE")="Secondary Provider ID"
"RTN","IBCEP5",52,0)
 . K VALMDDF("CAREUNIT")
"RTN","IBCEP5",53,0)
 . I VALMCAP["Care Unit" S VALMCAP=$P(VALMCAP,"Care Unit")_"         "_$P(VALMCAP,"Care Unit",2)
"RTN","IBCEP5",54,0)
 . K VALM("PROTOCOL")
"RTN","IBCEP5",55,0)
 . S Y=$$FIND1^DIC(101,,,"IBCE PRVNVA LOF MAINT")
"RTN","IBCEP5",56,0)
 . I Y S VALM("PROTOCOL")=+Y_";ORD(101,"
"RTN","IBCEP5",57,0)
 ;
"RTN","IBCEP5",58,0)
 I $G(IBPRV) S IBFILE="IBA(355.93,",IBPRV=+IBPRV_";"_IBFILE
"RTN","IBCEP5",59,0)
 I '$G(IBPRV) D  G:$G(VALMQUIT) INITQ
"RTN","IBCEP5",60,0)
 . S DIR(0)="SAO^V:VA PROVIDER;N:NON-VA PROVIDER",DIR("A")="(V)A or (N)on-VA provider: ",DIR("B")="V"
"RTN","IBCEP5",61,0)
 . D ^DIR K DIR
"RTN","IBCEP5",62,0)
 . I "NV"'[Y!(Y="") S VALMQUIT=1 Q
"RTN","IBCEP5",63,0)
 . S IBFILE=$S(Y="V":"VA(200,",1:"IBA(355.93,")
"RTN","IBCEP5",64,0)
 . S DIC=U_IBFILE,DIC(0)="AEMQ"_$S(IBFILE["355.93":"L",1:"")
"RTN","IBCEP5",65,0)
 . S DIC("A")="Select "_$S(IBFILE["355.93":"NON-",1:"")_"V.A. PROVIDER NAME: "
"RTN","IBCEP5",66,0)
 . S:IBFILE["355.93" DIC("DR")=".02////2;.03;.04"
"RTN","IBCEP5",67,0)
 . F  D  I $G(IBPRV)!$G(VALMQUIT) K DIC Q
"RTN","IBCEP5",68,0)
 .. D ^DIC
"RTN","IBCEP5",69,0)
 .. I $D(DTOUT)!$D(DUOUT) S VALMQUIT=1 Q
"RTN","IBCEP5",70,0)
 .. I Y'>0 W !,*7,"This is a required response. Enter '^' to exit" Q
"RTN","IBCEP5",71,0)
 .. S IBPRV=+Y_";"_IBFILE
"RTN","IBCEP5",72,0)
 ;
"RTN","IBCEP5",73,0)
AGAIN I $G(IBSLEV)=2 D  G:$G(AGAIN) AGAIN G:$G(VALMQUIT) INITQ
"RTN","IBCEP5",74,0)
 . S AGAIN=0
"RTN","IBCEP5",75,0)
 . S DIR(0)="PA^DIC(36,:AEMQ",DIR("A")="Select INSURANCE CO: ",DIR("?",1)="Select an INSURANCE CO to display its provider ID's"
"RTN","IBCEP5",76,0)
 . D ^DIR K DIR
"RTN","IBCEP5",77,0)
 . I $D(DTOUT)!$D(DUOUT) S VALMQUIT=1 Q
"RTN","IBCEP5",78,0)
 . S IBINS=$S(Y>0:+Y,1:"NO")
"RTN","IBCEP5",79,0)
 . I $G(IBPRV)'["VA(200," Q    ; Only VA providers
"RTN","IBCEP5",80,0)
 . I $P($G(^DIC(36,+IBINS,3)),"^",13)="C" D  S AGAIN=1 Q
"RTN","IBCEP5",81,0)
 .. W !,*7,"This is a Child Insurance Company.  Editing IDs is not permitted."
"RTN","IBCEP5",82,0)
 ;
"RTN","IBCEP5",83,0)
 E  D
"RTN","IBCEP5",84,0)
 . S IBINS="NO"
"RTN","IBCEP5",85,0)
 D BLD
"RTN","IBCEP5",86,0)
INITQ Q
"RTN","IBCEP5",87,0)
 ;
"RTN","IBCEP5",88,0)
BLD ;  Build initial display
"RTN","IBCEP5",89,0)
 ; Assumes IBPRV = the variable ptr for prov id file (355.9)
"RTN","IBCEP5",90,0)
 ;         IBINS = the ien of the ins co or if null, ALL is assumed
"RTN","IBCEP5",91,0)
 ;         IBSLEV = 1 to display only provider default ids
"RTN","IBCEP5",92,0)
 ;                = 2 to display all provider/insurance co ids
"RTN","IBCEP5",93,0)
 N IB,IBLCT,IBCT,CT,PT,CU,INS,FT,Z,IBENT,IB1,IBIF
"RTN","IBCEP5",94,0)
 ;
"RTN","IBCEP5",95,0)
 S IBIF="" I $G(IBPRV)[355.93 S IBIF=$$GET1^DIQ(355.93,+IBPRV,.02,"I")
"RTN","IBCEP5",96,0)
 ;
"RTN","IBCEP5",97,0)
 K ^TMP("IBPRV_",$J),^TMP("IBPRV_SORT",$J)
"RTN","IBCEP5",98,0)
 K Z0
"RTN","IBCEP5",99,0)
 S (IBENT,IBCT,IBLCT)=0,INS="",IB1=1
"RTN","IBCEP5",100,0)
 F  S INS=$S($G(IBINS):IBINS,IBSLEV=1:"*ALL*",1:$O(^IBA(355.9,"AUNIQ",IBPRV,INS))) Q:$S(INS="":1,$G(IBINS)!(IBSLEV=1):$D(CU),1:0)  S CU="",IB1=0 F  S CU=$O(^IBA(355.9,"AUNIQ",IBPRV,INS,CU)) Q:CU=""  D
"RTN","IBCEP5",101,0)
 . S FT="" F  S FT=$O(^IBA(355.9,"AUNIQ",IBPRV,INS,CU,FT)) Q:FT=""  S CT="" F  S CT=$O(^IBA(355.9,"AUNIQ",IBPRV,INS,CU,FT,CT)) Q:CT=""  S PT=0 F  S PT=$O(^IBA(355.9,"AUNIQ",IBPRV,INS,CU,FT,CT,PT)) Q:'PT  D
"RTN","IBCEP5",102,0)
 .. S Z=0 F  S Z=$O(^IBA(355.9,"AUNIQ",IBPRV,INS,CU,FT,CT,PT,Z)) Q:'Z  S IB=$G(^IBA(355.9,Z,0)) D
"RTN","IBCEP5",103,0)
 ... S ^TMP("IBPRV_SORT",$J,$S(INS:$P($G(^DIC(36,+INS,0)),U)_" ",1:" ALL"),PT,FT,CT,CU,Z)=$P(IB,U,7)
"RTN","IBCEP5",104,0)
 ;
"RTN","IBCEP5",105,0)
 I IBSLEV=1,IBPRV["IBA(355.93",$P($G(^IBA(355.93,+IBPRV,0)),U,12)'="" S ^TMP("IBPRV_SORT",$J," ALL",+$$STLIC^IBCEP8(),0,0,"*N/A*",0)=$P(^IBA(355.93,+IBPRV,0),U,12)
"RTN","IBCEP5",106,0)
 S INS="" F  S INS=$O(^TMP("IBPRV_SORT",$J,INS)) Q:INS=""  D
"RTN","IBCEP5",107,0)
 . I '$G(IBINS),'IBIF D:IBLCT SET^VALM10(IBLCT+1," ",IBCT) S IBLCT=$S(IBLCT:IBLCT+2,1:1) D SET^VALM10(IBLCT,"INSURANCE CO: "_$S($E(INS)=" ":"ALL INSURANCE",1:INS),$S(IBCT:IBCT,1:1))
"RTN","IBCEP5",108,0)
 . S PT=""
"RTN","IBCEP5",109,0)
 . F  S PT=$O(^TMP("IBPRV_SORT",$J,INS,PT)) Q:PT=""  S FT="" F  S FT=$O(^TMP("IBPRV_SORT",$J,INS,PT,FT)) Q:FT=""  S CT="" F  S CT=$O(^TMP("IBPRV_SORT",$J,INS,PT,FT,CT)) Q:CT=""  D
"RTN","IBCEP5",110,0)
 .. S CU="" F  S CU=$O(^TMP("IBPRV_SORT",$J,INS,PT,FT,CT,CU)) Q:CU=""  S Z="" F  S Z=$O(^TMP("IBPRV_SORT",$J,INS,PT,FT,CT,CU,Z)) Q:Z=""  S IB=$G(^(Z)) D
"RTN","IBCEP5",111,0)
 ... S IBLCT=IBLCT+1,IBCT=IBCT+1
"RTN","IBCEP5",112,0)
 ... S Z0=$E(IBCT_"     ",1,4)_" "_$E($$EXPAND^IBTRE(355.9,.06,PT)_$S(PT=$$STLIC^IBCEP8():"("_$P($G(^DIC(5,+$P($G(^IBA(355.93,+IBPRV,0)),U,7),0)),U,2)_")",1:"")_$J("",20),1,20)_"  "_$S(FT=1:"UB-04",FT=2:"1500 ",1:"BOTH ")
"RTN","IBCEP5",113,0)
 ... S Z0=Z0_"  "_$E($S(CT=3:"RX",CT=1:"INPT",CT=2:"OUTPT",1:"INPT/OUTPT")_$J("",11),1,11)
"RTN","IBCEP5",114,0)
 ... S Z0=Z0_"  "_$E($S(CU'="*N/A*":$P($G(^IBA(355.95,+$G(^IBA(355.96,CU,0)),0)),U),1:"")_$J("",15),1,15) I Z0["MEDICINE" X "*"
"RTN","IBCEP5",115,0)
 ... D SET^VALM10(IBLCT,Z0_" "_IB,IBCT)
"RTN","IBCEP5",116,0)
 ... S ^TMP("IBPRV_",$J,"ZIDX",IBCT)=$S(Z'=0:Z,1:"LIC^"_IBPRV)
"RTN","IBCEP5",117,0)
 I IBSLEV=1,IBPRV["VA(200" D
"RTN","IBCEP5",118,0)
 . N IBP
"RTN","IBCEP5",119,0)
 . S IBP=+IBPRV
"RTN","IBCEP5",120,0)
 . Q:'$$GETLIC^IBCEP5D(.IBP)
"RTN","IBCEP5",121,0)
 . I IBCT S IBLCT=IBLCT+1 D SET^VALM10(IBLCT," ",IBCT)
"RTN","IBCEP5",122,0)
 . S Z=0 F  S Z=$O(IBP(Z)) Q:'Z  D
"RTN","IBCEP5",123,0)
 .. S IBLCT=IBLCT+1,IBCT=IBCT+1
"RTN","IBCEP5",124,0)
 .. D SET^VALM10(IBLCT,$E(IBCT_"     ",1,4)_$E($P($G(^DIC(5,+Z,0)),U,2)_" STATE LICENSE #"_$J("",20),1,20)_$J("",39)_IBP(Z),IBCT)
"RTN","IBCEP5",125,0)
 .. S ^TMP("IBPRV_",$J,"ZIDX",IBCT)="LIC^"_+IBPRV
"RTN","IBCEP5",126,0)
 K ^TMP("IBPRV_SORT",$J)
"RTN","IBCEP5",127,0)
 ;
"RTN","IBCEP5",128,0)
 I IBLCT=0 D  G BLDQ ; No entries for ins co selected
"RTN","IBCEP5",129,0)
 . D SET^VALM10(1," ")
"RTN","IBCEP5",130,0)
 . D SET^VALM10(2,"  No ID's found for provider "_$S('$G(IBINS):"",1:"and selected insurance co"))
"RTN","IBCEP5",131,0)
 . S IBLCT=2
"RTN","IBCEP5",132,0)
 ;
"RTN","IBCEP5",133,0)
BLDQ K VALMCNT,VALMBG
"RTN","IBCEP5",134,0)
 S VALMCNT=IBLCT,VALMBG=1
"RTN","IBCEP5",135,0)
 Q
"RTN","IBCEP5",136,0)
 ;
"RTN","IBCEP5",137,0)
HELP ; -- help code
"RTN","IBCEP5",138,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBCEP5",139,0)
 Q
"RTN","IBCEP5",140,0)
 ;
"RTN","IBCEP5",141,0)
EXIT ; -- exit code
"RTN","IBCEP5",142,0)
 D COPYPROV^IBCEP5A(IBINS)
"RTN","IBCEP5",143,0)
 K IBPRV
"RTN","IBCEP5",144,0)
 D CLEAN^VALM10
"RTN","IBCEP5",145,0)
 K ^TMP("IBPRV_",$J),^TMP("IBPRV_SORT",$J),IBINS,IBALL
"RTN","IBCEP5",146,0)
 Q
"RTN","IBCEP5",147,0)
 ;
"RTN","IBCEP5",148,0)
EXPND ; -- expand code
"RTN","IBCEP5",149,0)
 Q
"RTN","IBCEP5",150,0)
 ;
"RTN","IBCEP5",151,0)
SEL(IBDA,MANY) ; Select from provider id list
"RTN","IBCEP5",152,0)
 ; IBDA is passed by reference and IBDA(1) returned containing
"RTN","IBCEP5",153,0)
 ;  ien's of the provider id records selected (file 355.9).
"RTN","IBCEP5",154,0)
 ; If > 1 entry can be selected, MANY is set to 1
"RTN","IBCEP5",155,0)
 N Z
"RTN","IBCEP5",156,0)
 S IBDA=0
"RTN","IBCEP5",157,0)
 D EN^VALM2($G(XQORNOD(0)),$S($G(MANY):"",1:"S"))
"RTN","IBCEP5",158,0)
 S Z=0 F  S Z=$O(VALMY(Z)) Q:'Z  S IBDA=IBDA+1,IBDA(IBDA)=$G(^TMP("IBPRV_",$J,"ZIDX",Z))
"RTN","IBCEP5",159,0)
 Q
"RTN","IBCEP5",160,0)
 ;
"RTN","IBCEP6")
0^32^B19310181^B11155166
"RTN","IBCEP6",1,0)
IBCEP6 ;ALB/TMP - PROVIDER ID MAINT menu and INS CO EDIT hook ;11-02-00
"RTN","IBCEP6",2,0)
 ;;2.0;INTEGRATED BILLING;**137,232,320,377**;21-MAR-94;Build 23
"RTN","IBCEP6",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP6",4,0)
 ;
"RTN","IBCEP6",5,0)
EN ; -- main entry point
"RTN","IBCEP6",6,0)
 N IBRESP
"RTN","IBCEP6",7,0)
 D FULL^VALM1
"RTN","IBCEP6",8,0)
 F  Q:'$$MENU(.IBRESP)  D @IBRESP
"RTN","IBCEP6",9,0)
ENQ ;
"RTN","IBCEP6",10,0)
 Q
"RTN","IBCEP6",11,0)
 ;
"RTN","IBCEP6",12,0)
EN1 ; Provider maintenance from the billing screen 8
"RTN","IBCEP6",13,0)
 N DIR,X,Y,IBEDIT
"RTN","IBCEP6",14,0)
 W !
"RTN","IBCEP6",15,0)
 I '$D(^XUSEC("IB PROVIDER EDIT",DUZ)) S DIR(0)="EA",DIR("A")="Press ENTER to continue: ",DIR("A",1)="YOU LACK THE SECURITY KEY FOR THIS ACTION" D ^DIR K DIR Q
"RTN","IBCEP6",16,0)
 D EN
"RTN","IBCEP6",17,0)
 Q
"RTN","IBCEP6",18,0)
 ;
"RTN","IBCEP6",19,0)
PO ; provider's own IDs
"RTN","IBCEP6",20,0)
 N IBPRV,IBINS
"RTN","IBCEP6",21,0)
 N IBSLEV,DIR,Y,X,IBPRMPT,IBNVAFL,IBIF
"RTN","IBCEP6",22,0)
 K IBFASTXT
"RTN","IBCEP6",23,0)
 S IBIF=""
"RTN","IBCEP6",24,0)
 S IBPRMPT="PROVIDER"
"RTN","IBCEP6",25,0)
 D FULL^VALM1
"RTN","IBCEP6",26,0)
 S IBSLEV=1
"RTN","IBCEP6",27,0)
 D EN^VALM("IBCE PRVPRV MAINT")
"RTN","IBCEP6",28,0)
POX ;
"RTN","IBCEP6",29,0)
 Q
"RTN","IBCEP6",30,0)
 ;
"RTN","IBCEP6",31,0)
PI ; provider's IDs provided by an insurance company
"RTN","IBCEP6",32,0)
 N IBPRV,IBINS
"RTN","IBCEP6",33,0)
 N IBSLEV,DIR,Y,X,IBPRMPT,IBNVAFL,IBIF
"RTN","IBCEP6",34,0)
 K IBFASTXT
"RTN","IBCEP6",35,0)
 S IBIF=""
"RTN","IBCEP6",36,0)
 S IBPRMPT="PROVIDER"
"RTN","IBCEP6",37,0)
 D FULL^VALM1
"RTN","IBCEP6",38,0)
 S IBSLEV=2
"RTN","IBCEP6",39,0)
 D EN^VALM("IBCE PRVPRV MAINT")
"RTN","IBCEP6",40,0)
PIX ;
"RTN","IBCEP6",41,0)
 Q
"RTN","IBCEP6",42,0)
 ;
"RTN","IBCEP6",43,0)
BI ; Insurance company batch ID entry
"RTN","IBCEP6",44,0)
 D EN^IBCEP9
"RTN","IBCEP6",45,0)
BIX ;
"RTN","IBCEP6",46,0)
 Q
"RTN","IBCEP6",47,0)
 ;
"RTN","IBCEP6",48,0)
II ; Insurance company IDs
"RTN","IBCEP6",49,0)
 D EN^IBCEP0
"RTN","IBCEP6",50,0)
IIX ;
"RTN","IBCEP6",51,0)
 Q
"RTN","IBCEP6",52,0)
 ;
"RTN","IBCEP6",53,0)
CP ; Care Unit maintenance - performing providers
"RTN","IBCEP6",54,0)
 N IBINS,IBALL,IB95
"RTN","IBCEP6",55,0)
 N IBSLEV,DIR,Y
"RTN","IBCEP6",56,0)
 K IBFASTXT
"RTN","IBCEP6",57,0)
 D FULL^VALM1
"RTN","IBCEP6",58,0)
 S IBSLEV=1
"RTN","IBCEP6",59,0)
 D EN^VALM("IBCE PRVCARE UNIT MAINT")
"RTN","IBCEP6",60,0)
CPX ;
"RTN","IBCEP6",61,0)
 Q
"RTN","IBCEP6",62,0)
 ;
"RTN","IBCEP6",63,0)
CB ; Care Unit maintenance - billing provider
"RTN","IBCEP6",64,0)
 N IBINS,IBALL,IB95
"RTN","IBCEP6",65,0)
 N IBSLEV,DIR,Y
"RTN","IBCEP6",66,0)
 K IBFASTXT
"RTN","IBCEP6",67,0)
 D FULL^VALM1
"RTN","IBCEP6",68,0)
 S IBSLEV=2
"RTN","IBCEP6",69,0)
 D EN^VALM("IBCE 2ND PRVID CARE UNIT MAINT")
"RTN","IBCEP6",70,0)
CBX ;
"RTN","IBCEP6",71,0)
 Q
"RTN","IBCEP6",72,0)
 ;
"RTN","IBCEP6",73,0)
NP ; non-VA individual provider information
"RTN","IBCEP6",74,0)
 N IBNVPMIF
"RTN","IBCEP6",75,0)
 S IBNVPMIF="I"
"RTN","IBCEP6",76,0)
 D EN^IBCEP8
"RTN","IBCEP6",77,0)
NPX ;
"RTN","IBCEP6",78,0)
 Q
"RTN","IBCEP6",79,0)
 ;
"RTN","IBCEP6",80,0)
NF ; non-VA facility provider information
"RTN","IBCEP6",81,0)
 N IBNVPMIF
"RTN","IBCEP6",82,0)
 S IBNVPMIF="F"
"RTN","IBCEP6",83,0)
 D EN^IBCEP8
"RTN","IBCEP6",84,0)
NFX ;
"RTN","IBCEP6",85,0)
 Q
"RTN","IBCEP6",86,0)
 ;
"RTN","IBCEP6",87,0)
MENU(IBSEL) ; display main provider ID maintenance menu and receive response from user
"RTN","IBCEP6",88,0)
 ; function value returns 0 if user exits from menu or "^" out
"RTN","IBCEP6",89,0)
 ; function value returns 1 otherwise
"RTN","IBCEP6",90,0)
 ; IBSEL is the internal value of the user's selection if any (pass by reference)
"RTN","IBCEP6",91,0)
 N IBQ,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,C,Z
"RTN","IBCEP6",92,0)
 N IORESET,IORVON,IORVOFF,IOUON,IOUOFF,IOINHI,IOINLOW,IOINORM
"RTN","IBCEP6",93,0)
 S IBQ=1,IBSEL=""
"RTN","IBCEP6",94,0)
 S X="IORESET;IORVON;IORVOFF;IOUON;IOUOFF;IOINHI;IOINLOW;IOINORM"
"RTN","IBCEP6",95,0)
 D ENDR^%ZISS
"RTN","IBCEP6",96,0)
 ;
"RTN","IBCEP6",97,0)
 S $P(DIR(0),U,1)="SOA"
"RTN","IBCEP6",98,0)
 S $P(Z,";",1)="PO:Provider Own IDs"
"RTN","IBCEP6",99,0)
 S $P(Z,";",2)="PI:Provider Insurance IDs"
"RTN","IBCEP6",100,0)
 S $P(Z,";",3)="BI:Batch ID Entry"
"RTN","IBCEP6",101,0)
 S $P(Z,";",4)="II:Insurance Co IDs"
"RTN","IBCEP6",102,0)
 S $P(Z,";",5)="CP:Care Units for Providers"
"RTN","IBCEP6",103,0)
 S $P(Z,";",6)="CB:Care Units for Billing Provider"
"RTN","IBCEP6",104,0)
 S $P(Z,";",7)="NP:Non-VA Provider"
"RTN","IBCEP6",105,0)
 S $P(Z,";",8)="NF:Non-VA Facility"
"RTN","IBCEP6",106,0)
 ;
"RTN","IBCEP6",107,0)
 S $P(DIR(0),U,2)=Z
"RTN","IBCEP6",108,0)
 ;
"RTN","IBCEP6",109,0)
 S DIR("L",1)="                "_IOINHI_"Provider IDs"_IOINORM
"RTN","IBCEP6",110,0)
 S DIR("L",2)="          "_$P($P(Z,";",1),":",1)_"  "_$P($P(Z,";",1),":",2)
"RTN","IBCEP6",111,0)
 S DIR("L",3)="          "_$P($P(Z,";",2),":",1)_"  "_$P($P(Z,";",2),":",2)
"RTN","IBCEP6",112,0)
 S DIR("L",4)=""
"RTN","IBCEP6",113,0)
 S DIR("L",5)="                "_IOINHI_"Insurance IDs"_IOINORM
"RTN","IBCEP6",114,0)
 S DIR("L",6)="          "_$P($P(Z,";",3),":",1)_"  "_$P($P(Z,";",3),":",2)
"RTN","IBCEP6",115,0)
 S DIR("L",7)="          "_$P($P(Z,";",4),":",1)_"  "_$P($P(Z,";",4),":",2)
"RTN","IBCEP6",116,0)
 S DIR("L",8)=""
"RTN","IBCEP6",117,0)
 S DIR("L",9)="                "_IOINHI_"Care Units"_IOINORM
"RTN","IBCEP6",118,0)
 S DIR("L",10)="          "_$P($P(Z,";",5),":",1)_"  "_$P($P(Z,";",5),":",2)
"RTN","IBCEP6",119,0)
 S DIR("L",11)="          "_$P($P(Z,";",6),":",1)_"  "_$P($P(Z,";",6),":",2)
"RTN","IBCEP6",120,0)
 S DIR("L",12)=""
"RTN","IBCEP6",121,0)
 S DIR("L",13)="                "_IOINHI_"Non-VA Items"_IOINORM
"RTN","IBCEP6",122,0)
 S DIR("L",14)="          "_$P($P(Z,";",7),":",1)_"  "_$P($P(Z,";",7),":",2)
"RTN","IBCEP6",123,0)
 S DIR("L")="          "_$P($P(Z,";",8),":",1)_"  "_$P($P(Z,";",8),":",2)
"RTN","IBCEP6",124,0)
 ;
"RTN","IBCEP6",125,0)
 S DIR("?")="^D MENH^IBCEP6"
"RTN","IBCEP6",126,0)
 S DIR("A")="    Select Provider ID Maintenance Option: "
"RTN","IBCEP6",127,0)
 ;
"RTN","IBCEP6",128,0)
 ; paint the screen and display menu first time in
"RTN","IBCEP6",129,0)
 D MENH
"RTN","IBCEP6",130,0)
 W !
"RTN","IBCEP6",131,0)
 S C=0 F  S C=$O(DIR("L",C)) Q:'C  W !,DIR("L",C)
"RTN","IBCEP6",132,0)
 W !,DIR("L"),!
"RTN","IBCEP6",133,0)
 D ^DIR K DIR W !
"RTN","IBCEP6",134,0)
 I $D(DIRUT) S IBQ=0 G MENUX
"RTN","IBCEP6",135,0)
 S IBSEL=Y
"RTN","IBCEP6",136,0)
 I IBSEL="" S IBQ=0
"RTN","IBCEP6",137,0)
MENUX ;
"RTN","IBCEP6",138,0)
 Q IBQ
"RTN","IBCEP6",139,0)
 ;
"RTN","IBCEP6",140,0)
MENH ; menu help
"RTN","IBCEP6",141,0)
 W @IOF,!?4,"Provider ID Maintenance Main Menu"
"RTN","IBCEP6",142,0)
 W !!?4,"Enter a code from the list."
"RTN","IBCEP6",143,0)
MENHX ;
"RTN","IBCEP6",144,0)
 Q
"RTN","IBCEP6",145,0)
 ;
"RTN","IBCEP8")
0^33^B80393448^B72198572
"RTN","IBCEP8",1,0)
IBCEP8 ;ALB/TMP - Functions for NON-VA PROVIDER ;11-07-00
"RTN","IBCEP8",2,0)
 ;;2.0;INTEGRATED BILLING;**51,137,232,288,320,343,374,377**;21-MAR-94;Build 23
"RTN","IBCEP8",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP8",4,0)
 ;
"RTN","IBCEP8",5,0)
EN ; -- main entry point
"RTN","IBCEP8",6,0)
 N IBNPRV
"RTN","IBCEP8",7,0)
 K IBFASTXT
"RTN","IBCEP8",8,0)
 D FULL^VALM1
"RTN","IBCEP8",9,0)
 D EN^VALM("IBCE PRVNVA MAINT")
"RTN","IBCEP8",10,0)
 Q
"RTN","IBCEP8",11,0)
 ;
"RTN","IBCEP8",12,0)
HDR ; -- header code
"RTN","IBCEP8",13,0)
 K VALMHDR
"RTN","IBCEP8",14,0)
 Q
"RTN","IBCEP8",15,0)
 ;
"RTN","IBCEP8",16,0)
INIT ; Initialization
"RTN","IBCEP8",17,0)
 N DIC,DA,X,Y,DLAYGO,IBIF,DIR,DTOUT,DUOUT
"RTN","IBCEP8",18,0)
 K ^TMP("IBCE_PRVNVA_MAINT",$J)
"RTN","IBCEP8",19,0)
 ;
"RTN","IBCEP8",20,0)
 ; if coming in from main routine ^IBCEP6 this special variable IBNVPMIF is set already
"RTN","IBCEP8",21,0)
 I $G(IBNVPMIF)'="" S IBIF=IBNVPMIF G INIT1
"RTN","IBCEP8",22,0)
 ;
"RTN","IBCEP8",23,0)
 S DIR("A")="(I)NDIVIDUAL OR (F)ACILITY?: ",DIR(0)="SA^I:INDIVIDUAL;F:FACILITY" D ^DIR K DIR
"RTN","IBCEP8",24,0)
 I $D(DUOUT)!$D(DTOUT) S VALMQUIT=1 G INITQ
"RTN","IBCEP8",25,0)
 S IBIF=Y
"RTN","IBCEP8",26,0)
 ;
"RTN","IBCEP8",27,0)
INIT1 ;
"RTN","IBCEP8",28,0)
 ;
"RTN","IBCEP8",29,0)
 I IBIF="F" D
"RTN","IBCEP8",30,0)
 . S VALM("TITLE")="Non-VA Lab or Facility Info"
"RTN","IBCEP8",31,0)
 . K VALM("PROTOCOL")
"RTN","IBCEP8",32,0)
 . S Y=$$FIND1^DIC(101,,,"IBCE PRVNVA NONIND MAINT")
"RTN","IBCEP8",33,0)
 . I Y S VALM("PROTOCOL")=+Y_";ORD(101,"
"RTN","IBCEP8",34,0)
 ;
"RTN","IBCEP8",35,0)
 S DIC="^IBA(355.93,",DIC("DR")=".02///"_$S(IBIF'="F":2,1:1)
"RTN","IBCEP8",36,0)
 S DIC("S")="I $P(^(0),U,2)="_$S(IBIF'="F":2,1:1)
"RTN","IBCEP8",37,0)
 S DLAYGO=355.93,DIC(0)="AELMQ",DIC("A")="Select a NON"_$S(IBIF="I":"-",1:"/OTHER ")_"VA PROVIDER: "
"RTN","IBCEP8",38,0)
 D ^DIC K DIC,DLAYGO
"RTN","IBCEP8",39,0)
 I Y'>0 S VALMQUIT=1 G INITQ
"RTN","IBCEP8",40,0)
 S IBNPRV=+Y
"RTN","IBCEP8",41,0)
 D BLD
"RTN","IBCEP8",42,0)
INITQ Q
"RTN","IBCEP8",43,0)
 ;
"RTN","IBCEP8",44,0)
BLD ; Build/Rebuild display
"RTN","IBCEP8",45,0)
 N IBLCT,IBCT,IBLST,IBPRI,IBIEN,Z,Z1,Z2
"RTN","IBCEP8",46,0)
 K @VALMAR
"RTN","IBCEP8",47,0)
 S (IBLCT,IBCT)=0,Z=$G(^IBA(355.93,IBNPRV,0))
"RTN","IBCEP8",48,0)
 S IBCT=IBCT+1
"RTN","IBCEP8",49,0)
 S Z1=$J("Name: ",15)_$P(Z,U) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",50,0)
 I $P(Z,U,2)=2 D
"RTN","IBCEP8",51,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",52,0)
 . S Z1=$J("Type: ",15)_$S($P(Z,U,2)=2:"INDIVIDUAL PROVIDER",1:"OUTSIDE OR OTHER VA FACILITY") D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",53,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",54,0)
 . S Z1=$J("Credentials: ",15)_$P(Z,U,3) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",55,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",56,0)
 . S Z1=$J("Specialty: ",15)_$P(Z,U,4) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",57,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",58,0)
 . S Z1=$J("NPI: ",15)_$$NPIGET^IBCEP81(IBNPRV) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",59,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",60,0)
 . S IBPRI=$$TAXGET^IBCEP81(IBNPRV,.IBLST)
"RTN","IBCEP8",61,0)
 . S Z1=$J("Taxonomy Code: ",15)_$P(IBPRI,U)
"RTN","IBCEP8",62,0)
 . I $D(IBLST) S Z1=Z1_" ("_$S($P(IBLST(IBLST),U,3)=1:"Primary",1:"Secondary")_")"
"RTN","IBCEP8",63,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",64,0)
 . S IBIEN=""
"RTN","IBCEP8",65,0)
 . F  S IBIEN=$O(IBLST(IBIEN)) Q:IBIEN=""  D
"RTN","IBCEP8",66,0)
 .. I IBIEN=IBLST Q
"RTN","IBCEP8",67,0)
 .. S IBCT=IBCT+1
"RTN","IBCEP8",68,0)
 .. S Z1=$J("",15)_$P(IBLST(IBIEN),U)_" ("_$S($P(IBLST(IBIEN),U,3)=1:"Primary",1:"Secondary")_")"
"RTN","IBCEP8",69,0)
 .. D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",70,0)
 E  D
"RTN","IBCEP8",71,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",72,0)
 . S Z1=$J("Address: ",15)_$P(Z,U,5) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",73,0)
 . I $P(Z,U,10) D
"RTN","IBCEP8",74,0)
 .. S IBCT=IBCT+1
"RTN","IBCEP8",75,0)
 .. S Z1=$J("",15)_$P(Z,U,10)
"RTN","IBCEP8",76,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",77,0)
 . S Z1=$J("",15)_$P(Z,U,6)_$S($P(Z,U,6)'="":", ",1:"")_$S($P(Z,U,7):$$EXTERNAL^DILFD(355.93,.07,"",$P(Z,U,7))_"  ",1:"")_$P(Z,U,8)
"RTN","IBCEP8",78,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",79,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",80,0)
 . S Z1=" " D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",81,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",82,0)
 . S Z1=$J("Type of Facility: ",30)_$$EXTERNAL^DILFD(355.93,.11,,$P(Z,U,11))
"RTN","IBCEP8",83,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",84,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",85,0)
 . S Z1=$J("Primary ID: ",30)_$P(Z,U,9)
"RTN","IBCEP8",86,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",87,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",88,0)
 . S Z1=$J("ID Qualifier: ",30)_$$GET1^DIQ(355.97,$P(Z,U,13),.03) I $P(Z,U,13)]"" S Z1=Z1_" - "_$$GET1^DIQ(355.97,$P(Z,U,13),.01)
"RTN","IBCEP8",89,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",90,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",91,0)
 . S Z1=$J("Mammography Certification #: ",30)_$P(Z,U,15)
"RTN","IBCEP8",92,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",93,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",94,0)
 . S Z1=$J("NPI: ",30)_$$NPIGET^IBCEP81(IBNPRV) D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",95,0)
 . S IBCT=IBCT+1
"RTN","IBCEP8",96,0)
 . S IBPRI=$$TAXGET^IBCEP81(IBNPRV,.IBLST)
"RTN","IBCEP8",97,0)
 . S Z1=$J("Taxonomy Code: ",30)_$P(IBPRI,U)
"RTN","IBCEP8",98,0)
 . I $D(IBLST) S Z1=Z1_" ("_$S($P(IBLST(IBLST),U,3)=1:"Primary",1:"Secondary")_")"
"RTN","IBCEP8",99,0)
 . D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",100,0)
 . S IBIEN=""
"RTN","IBCEP8",101,0)
 . F  S IBIEN=$O(IBLST(IBIEN)) Q:IBIEN=""  D
"RTN","IBCEP8",102,0)
 .. I IBIEN=IBLST Q
"RTN","IBCEP8",103,0)
 .. S IBCT=IBCT+1
"RTN","IBCEP8",104,0)
 .. S Z1=$J("",30)_$P(IBLST(IBIEN),U)_" ("_$S($P(IBLST(IBIEN),U,3)=1:"Primary",1:"Secondary")_")"
"RTN","IBCEP8",105,0)
 .. D SET1(.IBLCT,Z1,IBCT)
"RTN","IBCEP8",106,0)
 K VALMBG,VALMCNT
"RTN","IBCEP8",107,0)
 S VALMBG=1,VALMCNT=IBLCT
"RTN","IBCEP8",108,0)
 Q
"RTN","IBCEP8",109,0)
 ;
"RTN","IBCEP8",110,0)
SET1(IBLCT,TEXT,IBCT) ;
"RTN","IBCEP8",111,0)
 S IBLCT=IBLCT+1 D SET^VALM10(IBLCT,TEXT,$G(IBCT))
"RTN","IBCEP8",112,0)
 Q
"RTN","IBCEP8",113,0)
EXPND ;
"RTN","IBCEP8",114,0)
 Q
"RTN","IBCEP8",115,0)
 ;
"RTN","IBCEP8",116,0)
HELP ;
"RTN","IBCEP8",117,0)
 Q
"RTN","IBCEP8",118,0)
 ;
"RTN","IBCEP8",119,0)
EXIT ;
"RTN","IBCEP8",120,0)
 K ^TMP("IBCE_PRVNVA_MAINT",$J)
"RTN","IBCEP8",121,0)
 D CLEAN^VALM10
"RTN","IBCEP8",122,0)
 K IBFASTXT
"RTN","IBCEP8",123,0)
 Q
"RTN","IBCEP8",124,0)
 ;
"RTN","IBCEP8",125,0)
EDIT1(IBNPRV,IBNOLM) ; Edit non-VA provider/facility demographics
"RTN","IBCEP8",126,0)
 ; IBNPRV = ien of entry in file 355.93
"RTN","IBCEP8",127,0)
 ; IBNOLM = 1 if not called from list manager
"RTN","IBCEP8",128,0)
 ;
"RTN","IBCEP8",129,0)
 N DA,X,Y,DIE,DR,IBP
"RTN","IBCEP8",130,0)
 I '$G(IBNOLM) D FULL^VALM1
"RTN","IBCEP8",131,0)
 I IBNPRV D
"RTN","IBCEP8",132,0)
 . I '$G(IBNOLM) D CLEAR^VALM1
"RTN","IBCEP8",133,0)
 . S DIE="^IBA(355.93,",DA=IBNPRV,IBP=($P($G(^IBA(355.93,IBNPRV,0)),U,2)=2)
"RTN","IBCEP8",134,0)
 . ; PRXM/KJH - Added NPI and Taxonomy to the list of fields to be edited. Put a "NO^" around the Taxonomy multiple (#42) since some of the sub-field entries are 'required'.
"RTN","IBCEP8",135,0)
 . S DR=".01;"_$S(IBP:".03;.04",1:".05;.1;.06;.07;.08;.13///24;W !,""ID Qualifier: 24 - EMPLOYER'S IDENTIFICATION #"";.09Lab or Facility Primary ID;.11;.15")_";D EN^IBCEP82;S DIE(""NO^"")="""";42;K DIE(""NO^"")"
"RTN","IBCEP8",136,0)
 . D ^DIE
"RTN","IBCEP8",137,0)
 . Q:$G(IBNOLM)
"RTN","IBCEP8",138,0)
 . D BLD
"RTN","IBCEP8",139,0)
 I '$G(IBNOLM) K VALMBCK S VALMBCK="R"
"RTN","IBCEP8",140,0)
 Q
"RTN","IBCEP8",141,0)
 ;
"RTN","IBCEP8",142,0)
EDITID(IBNPRV,IBSLEV) ; Link from this list template to maintain provider-specific ids
"RTN","IBCEP8",143,0)
 ; This entry point is called by 4 action protocols.
"RTN","IBCEP8",144,0)
 ; IBNPRV = ien of entry in file 355.93 (can be either an individual or a facility) (required)
"RTN","IBCEP8",145,0)
 ; IBSLEV = 1 for facility/provider own ID's
"RTN","IBCEP8",146,0)
 ; IBSLEV = 2 for facility/provider ID's furnished by an insurance company
"RTN","IBCEP8",147,0)
 ;
"RTN","IBCEP8",148,0)
 Q:'$G(IBNPRV)
"RTN","IBCEP8",149,0)
 Q:'$G(IBSLEV)
"RTN","IBCEP8",150,0)
 N IBPRV,IBIF
"RTN","IBCEP8",151,0)
 D FULL^VALM1    ; set full scrolling region
"RTN","IBCEP8",152,0)
 D CLEAR^VALM1   ; clear screen
"RTN","IBCEP8",153,0)
 S IBPRV=IBNPRV
"RTN","IBCEP8",154,0)
 ;
"RTN","IBCEP8",155,0)
 K IBFASTXT
"RTN","IBCEP8",156,0)
 S IBIF=$$GET1^DIQ(355.93,IBPRV,.02,"I")    ; 1=facility/group      2=individual
"RTN","IBCEP8",157,0)
 D EN^VALM("IBCE PRVPRV MAINT")
"RTN","IBCEP8",158,0)
 ;
"RTN","IBCEP8",159,0)
 K VALMQUIT
"RTN","IBCEP8",160,0)
 S VALMBCK=$S($G(IBFASTXT)'="":"Q",1:"R")
"RTN","IBCEP8",161,0)
 Q
"RTN","IBCEP8",162,0)
 ;
"RTN","IBCEP8",163,0)
NVAFAC ; Enter/edit Non-VA facility information
"RTN","IBCEP8",164,0)
 ; This entry point is called by the menu system for option IBCE PRVNVA FAC EDIT
"RTN","IBCEP8",165,0)
 N X,Y,DA,DIC,IBNPRV,DLAYGO
"RTN","IBCEP8",166,0)
 S DIC="^IBA(355.93,",DIC("S")="I $P(^(0),U,2)=1",DIC("DR")=".02///1"
"RTN","IBCEP8",167,0)
 S DLAYGO=355.93,DIC(0)="AELMQ",DIC("A")="Select a NON/Other VA FACILITY: "
"RTN","IBCEP8",168,0)
 D ^DIC K DIC,DLAYGO
"RTN","IBCEP8",169,0)
 I Y'>0 S VALMQUIT=1 G NVAFACQ
"RTN","IBCEP8",170,0)
 S IBNPRV=+Y
"RTN","IBCEP8",171,0)
 D EDIT1(IBNPRV,1)
"RTN","IBCEP8",172,0)
 ;
"RTN","IBCEP8",173,0)
NVAFACQ Q
"RTN","IBCEP8",174,0)
 ;
"RTN","IBCEP8",175,0)
GETFAC(IB,IBFILE,IBELE,IBSFD) ; Returns facility name,address lines or city-state-zip
"RTN","IBCEP8",176,0)
 ; IB = ien of entry in file
"RTN","IBCEP8",177,0)
 ; IBFILE = 0 for retrieval from file 4, 1 for retrieval from file 355.93
"RTN","IBCEP8",178,0)
 ; If IBELE=0, returns name
"RTN","IBCEP8",179,0)
 ;         =1, returns address line 1
"RTN","IBCEP8",180,0)
 ;         =2, returns address line 2
"RTN","IBCEP8",181,0)
 ;         =3, returns city, state zip
"RTN","IBCEP8",182,0)
 ;         = "3C", returns city  = "3S", state    = "3Z", zip
"RTN","IBCEP8",183,0)
 ; IBSFD (optional) = Output formatter segment name if the output needs
"RTN","IBCEP8",184,0)
 ;       to be screened thru the VAMCFD^IBCEF75 procedure for the flag
"RTN","IBCEP8",185,0)
 ;       in the insurance company file
"RTN","IBCEP8",186,0)
 ;
"RTN","IBCEP8",187,0)
 N Z,IBX,IBZ
"RTN","IBCEP8",188,0)
 S IBX=""
"RTN","IBCEP8",189,0)
 ;
"RTN","IBCEP8",190,0)
 I $G(IBSFD)="SUB" D VAMCFD^IBCEF75(+$G(IBXIEN),.IBZ) I $D(IBZ),'$G(IBZ("C",1)) G GETFACX
"RTN","IBCEP8",191,0)
 ;
"RTN","IBCEP8",192,0)
 S Z=$S('IBFILE:$G(^DIC(4,+IB,1)),1:$G(^IBA(355.93,+IB,0)))
"RTN","IBCEP8",193,0)
 I +IBELE=0 S IBX=$S('IBFILE:$P($G(^DIC(4,+IB,0)),U),1:$P($G(^IBA(355.93,+IB,0)),U))
"RTN","IBCEP8",194,0)
 I IBELE=1!(IBELE=12) S IBX=$S('IBFILE:$P(Z,U),1:$P(Z,U,5))
"RTN","IBCEP8",195,0)
 I IBELE=2!(IBELE=12) S IBX=$S(IBELE=12:IBX_" ",1:"")_$S('IBFILE:$P(Z,U,2),1:$P(Z,U,10))
"RTN","IBCEP8",196,0)
 ;
"RTN","IBCEP8",197,0)
 I +IBELE=3,'IBFILE D
"RTN","IBCEP8",198,0)
 . S:IBELE=3!(IBELE["C") IBX=$P(Z,U,3) Q:IBELE["C"
"RTN","IBCEP8",199,0)
 . S:IBELE=3 IBX=IBX_$S(IBX'="":", ",1:"") S:IBELE=3!(IBELE["S") IBX=IBX_$$STATE^IBCEFG1($P($G(^DIC(4,+IB,0)),U,2)) Q:IBELE["S"
"RTN","IBCEP8",200,0)
 . S:IBELE=3 IBX=IBX_" " S:IBELE=3!(IBELE["Z") IBX=IBX_$P(Z,U,4)
"RTN","IBCEP8",201,0)
 . Q
"RTN","IBCEP8",202,0)
 ;
"RTN","IBCEP8",203,0)
 I +IBELE=3,IBFILE D
"RTN","IBCEP8",204,0)
 . S:IBELE=3!(IBELE["C") IBX=$P(Z,U,6) Q:IBELE["C"
"RTN","IBCEP8",205,0)
 . S:IBELE=3 IBX=IBX_$S(IBX'="":", ",1:"") S:IBELE=3!(IBELE["S") IBX=IBX_$$STATE^IBCEFG1($P(Z,U,7))
"RTN","IBCEP8",206,0)
 . S:IBELE=3 IBX=IBX_" " S:IBELE=3!(IBELE["Z") IBX=IBX_$P(Z,U,8)
"RTN","IBCEP8",207,0)
 . Q
"RTN","IBCEP8",208,0)
GETFACX ;
"RTN","IBCEP8",209,0)
 Q IBX
"RTN","IBCEP8",210,0)
 ;
"RTN","IBCEP8",211,0)
ALLID(IBPRV,IBPTYP,IBZ) ; Returns array IBZ for all ids for provider IBPRV
"RTN","IBCEP8",212,0)
 ; for all provider id types or for id type in IBPTYP
"RTN","IBCEP8",213,0)
 ; IBPRV = vp ien of provider
"RTN","IBCEP8",214,0)
 ; IBPTYP = ien of provider id type to return or "" for all
"RTN","IBCEP8",215,0)
 ; IBZ = array returned with internal data:
"RTN","IBCEP8",216,0)
 ;  IBZ(file 355.9 ien)=ID type^ID#^ins co^form type^bill care type^care un^X12 code for id type
"RTN","IBCEP8",217,0)
 N Z,Z0
"RTN","IBCEP8",218,0)
 K IBZ
"RTN","IBCEP8",219,0)
 G:'$G(IBPRV) ALLIDQ
"RTN","IBCEP8",220,0)
 S IBPTYP=$G(IBPTYP)
"RTN","IBCEP8",221,0)
 S Z=0 F  S Z=$O(^IBA(355.9,"B",IBPRV,Z)) Q:'Z  S Z0=$G(^IBA(355.9,Z,0)) D
"RTN","IBCEP8",222,0)
 . I $S(IBPTYP="":1,1:($P(Z0,U,6)=IBPTYP)) S IBZ(Z)=($P(Z0,U,6)_U_$P(Z0,U,7)_U_$P(Z0,U,2)_U_$P(Z0,U,4)_U_$P(Z0,U,5)_U_$P(Z0,U,3))_U_$P($G(^IBE(355.97,+$P(Z0,U,6),0)),U,3)
"RTN","IBCEP8",223,0)
 ;
"RTN","IBCEP8",224,0)
ALLIDQ Q
"RTN","IBCEP8",225,0)
 ;
"RTN","IBCEP8",226,0)
CLIA() ; Returns ien of CLIA # provider id type
"RTN","IBCEP8",227,0)
 N Z,IBZ
"RTN","IBCEP8",228,0)
 S (IBZ,Z)=0 F  S Z=$O(^IBE(355.97,Z)) Q:'Z  I $P($G(^(Z,0)),U,3)="X4",$P(^(0),U)["CLIA" S IBZ=Z Q
"RTN","IBCEP8",229,0)
 Q IBZ
"RTN","IBCEP8",230,0)
 ;
"RTN","IBCEP8",231,0)
STLIC() ; Returns ien of STLIC# provider id type
"RTN","IBCEP8",232,0)
 N Z,IBZ
"RTN","IBCEP8",233,0)
 S (IBZ,Z)=0 F  S Z=$O(^IBE(355.97,Z)) Q:'Z  I $P($G(^(Z,1)),U,3) S IBZ=Z Q
"RTN","IBCEP8",234,0)
 Q IBZ
"RTN","IBCEP8",235,0)
 ;
"RTN","IBCEP8",236,0)
TAXID() ; Returns ien of Fed tax id provider id type
"RTN","IBCEP8",237,0)
 N Z,IBZ
"RTN","IBCEP8",238,0)
 S (IBZ,Z)=0 F  S Z=$O(^IBE(355.97,Z)) Q:'Z  I $P($G(^(Z,1)),U,4) S IBZ=Z Q
"RTN","IBCEP8",239,0)
 Q IBZ
"RTN","IBCEP8",240,0)
 ;
"RTN","IBCEP8",241,0)
CLIANVA(IBIFN) ; Returns CLIA # for a non-VA facility on bill ien IBIFN
"RTN","IBCEP8",242,0)
 N IBCLIA,IBZ,IBNVA,Z
"RTN","IBCEP8",243,0)
 S IBCLIA="",IBZ=$$CLIA()
"RTN","IBCEP8",244,0)
 I IBZ D
"RTN","IBCEP8",245,0)
 . S IBNVA=$P($G(^DGCR(399,IBIFN,"U2")),U,10) Q:'IBNVA
"RTN","IBCEP8",246,0)
 . S IBCLIA=$$IDFIND^IBCEP2(IBIFN,IBZ,IBNVA_";IBA(355.93,","",1)
"RTN","IBCEP8",247,0)
 Q IBCLIA
"RTN","IBCEP8",248,0)
 ;
"RTN","IBCEP8",249,0)
VALFAC(X) ; Function returns 1 if format is valid for X12 facility name
"RTN","IBCEP8",250,0)
 ; Alpha/numeric/certain punctuation valid.  Must start with an Alpha
"RTN","IBCEP8",251,0)
 N OK,VAL
"RTN","IBCEP8",252,0)
 S OK=1
"RTN","IBCEP8",253,0)
 S VAL("A")="",VAL("N")="",VAL=",.- "
"RTN","IBCEP8",254,0)
 I $E(X)'?1A!'$$VALFMT(X,.VAL) S OK=0
"RTN","IBCEP8",255,0)
 Q OK
"RTN","IBCEP8",256,0)
 ;
"RTN","IBCEP8",257,0)
VALFMT(X,VAL) ; Returns 1 if format of X is valid, 0 if not
"RTN","IBCEP8",258,0)
 ; X = data to be examined
"RTN","IBCEP8",259,0)
 ; VAL = a 'string' of valid characters AND/OR (passed by reference)
"RTN","IBCEP8",260,0)
 ;    if VAL("A") defined ==> Alpha
"RTN","IBCEP8",261,0)
 ;    if VAL("A") defined ==> Numeric valid
"RTN","IBCEP8",262,0)
 ;    if VAL("A") defined ==> Punctuation valid
"RTN","IBCEP8",263,0)
 ;   any other character included in the string is checked individually
"RTN","IBCEP8",264,0)
 N Z
"RTN","IBCEP8",265,0)
 I $D(VAL("A")) D
"RTN","IBCEP8",266,0)
 . N Z0
"RTN","IBCEP8",267,0)
 . F Z=1:1:$L(X) I $E(X,Z)?1A S Z0(Z)=""
"RTN","IBCEP8",268,0)
 . S Z0="" F  S Z0=$O(Z0(Z0),-1) Q:'Z0  S $E(X,Z0)=""
"RTN","IBCEP8",269,0)
 I $D(VAL("N")) D
"RTN","IBCEP8",270,0)
 . N Z0
"RTN","IBCEP8",271,0)
 . F Z=1:1:$L(X) I $E(X,Z)?1N S Z0(Z)=""
"RTN","IBCEP8",272,0)
 . S Z0="" F  S Z0=$O(Z0(Z0),-1) Q:'Z0  S $E(X,Z0)=""
"RTN","IBCEP8",273,0)
 I $D(VAL("P")) D
"RTN","IBCEP8",274,0)
 . N Z0
"RTN","IBCEP8",275,0)
 . F Z=1:1:$L(X) I $E(X,Z)?1P S Z0(Z)=""
"RTN","IBCEP8",276,0)
 . S Z0="" F  S Z0=$O(Z0(Z0),-1) Q:'Z0  S $E(X,Z0)=""
"RTN","IBCEP8",277,0)
 I $G(VAL)'="" S X=$TR(X,VAL,"")
"RTN","IBCEP8",278,0)
 Q (X="")
"RTN","IBCEP8",279,0)
 ;
"RTN","IBCEP8",280,0)
PS(IBXSAVE) ; Returns 1 if IBXSAVE("PSVC") indicates the svc was non-lab
"RTN","IBCEP8",281,0)
 ; 
"RTN","IBCEP8",282,0)
 Q $S($G(IBXSAVE("PSVC"))="":0,1:"13"[IBXSAVE("PSVC"))
"RTN","IBCEP8",283,0)
 ;
"RTN","IBCEP8",284,0)
 ; Pass in the Internal Entry number to File 355.93
"RTN","IBCEP8",285,0)
 ; Return the Primary ID and Qualifier (ID Type) from 355.9
"RTN","IBCEP8",286,0)
PRIMID(IEN35593) ; Return External Primary ID and ID Quailier
"RTN","IBCEP8",287,0)
 N INDXVAL,LIST,MSG,IDCODE
"RTN","IBCEP8",288,0)
 S INDXVAL=IEN35593_";IBA(355.93,"
"RTN","IBCEP8",289,0)
 N SCREEN S SCREEN="I $P(^(0),U,8)"
"RTN","IBCEP8",290,0)
 D FIND^DIC(355.9,,"@;.06EI;.07","Q",INDXVAL,,,SCREEN,,"LIST","MSG")
"RTN","IBCEP8",291,0)
 I '+$G(LIST("DILIST",0)) Q ""   ; No Primary ID
"RTN","IBCEP8",292,0)
 I +$G(LIST("DILIST",0))>1 Q "***ERROR***^***ERROR***"  ; Bad.  More than one. 
"RTN","IBCEP8",293,0)
 ; Found just one
"RTN","IBCEP8",294,0)
 S IDCODE=$$GET1^DIQ(355.97,LIST("DILIST","ID",1,.06,"I"),.03)
"RTN","IBCEP8",295,0)
 Q $G(LIST("DILIST","ID",1,.07))_U_IDCODE_" - "_$G(LIST("DILIST","ID",1,.06,"E"))
"RTN","IBCEP82")
0^31^B31460736^B24437621
"RTN","IBCEP82",1,0)
IBCEP82 ;ALB/CLT, Special cross references and data entry for fields in file 355.93 ; 14 Apr 2006  9:41 AM
"RTN","IBCEP82",2,0)
 ;;2.0;INTEGRATED BILLING;**343,374,377**;21-MAR-94;Build 23
"RTN","IBCEP82",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEP82",4,0)
 ;
"RTN","IBCEP82",5,0)
 ; Call at tags only
"RTN","IBCEP82",6,0)
 Q
"RTN","IBCEP82",7,0)
 ;This routine will ask for the NPI, check for duplicate entries, and check for proper
"RTN","IBCEP82",8,0)
 ;format using the double-add-double formula.  If the NPI is being deleted it will ask
"RTN","IBCEP82",9,0)
 ;the user why it is being deleted.
"RTN","IBCEP82",10,0)
 ;If it is being deleted because of an erroneous entry it will be completely deleted.
"RTN","IBCEP82",11,0)
 ;If it is a valid NPI being deleted because of possible inappropriate usage it will be
"RTN","IBCEP82",12,0)
 ;maintained in the history cross reference to preclude anyone from using this NPI again.
"RTN","IBCEP82",13,0)
 ;
"RTN","IBCEP82",14,0)
EN ;Routine primary entry point
"RTN","IBCEP82",15,0)
 N DTOUT,DUOUT,DIR,DIE,DIC,DR,X,Y
"RTN","IBCEP82",16,0)
 N IBIEN,IBNPI,IBCHECK,IBOLDNPI,IBRBNPI,IBRB
"RTN","IBCEP82",17,0)
 S IBIEN=DA,IBOLDNPI=""
"RTN","IBCEP82",18,0)
EN1 ;
"RTN","IBCEP82",19,0)
 K DIR
"RTN","IBCEP82",20,0)
 S DIR(0)="FO^10:10",DIR("A")="NPI",DIR("?")="Enter a 10 digit National Provider Identifier"
"RTN","IBCEP82",21,0)
 I $G(DA) S:$P($G(^IBA(355.93,DA,0)),U,14)'="" (DIR("B"),IBOLDNPI)=$P($G(^IBA(355.93,DA,0)),U,14)
"RTN","IBCEP82",22,0)
 D ^DIR S IBCHECK=0
"RTN","IBCEP82",23,0)
 I X="^" W *7,!,"   EXIT NOT ALLOWED ??" G EN1
"RTN","IBCEP82",24,0)
 I $E(X)="^" W *7,!,"   JUMPING NOT ALLOWED ??" G EN1
"RTN","IBCEP82",25,0)
 I X="@" G:IBOLDNPI'="" DEL W *7,"??" G EN1
"RTN","IBCEP82",26,0)
 I $G(DUOUT)!$G(DTOUT)!(X="")!(Y=IBOLDNPI) G XIT
"RTN","IBCEP82",27,0)
 I '$$PROC(Y,IBOLDNPI,IBIEN) G EN1
"RTN","IBCEP82",28,0)
 G XIT
"RTN","IBCEP82",29,0)
 ;
"RTN","IBCEP82",30,0)
EN2(DA,INDENT) ; entry point from input templates IB SCREEN82 and IB SCREEN8H
"RTN","IBCEP82",31,0)
 N DTOUT,DUOUT,DIR,DIE,DIC,DR,X,Y
"RTN","IBCEP82",32,0)
 N IBIEN,IBNPI,IBCHECK,IBOLDNPI,IBRBNPI,IBRB,SPACES
"RTN","IBCEP82",33,0)
 S IBIEN=DA,IBOLDNPI="",SPACES="          "
"RTN","IBCEP82",34,0)
EN21 ;
"RTN","IBCEP82",35,0)
 K DIR
"RTN","IBCEP82",36,0)
 S DIR(0)="FO^10:10",DIR("A")=$E(SPACES,1,INDENT)_"NPI",DIR("?")=$E(SPACES,1,INDENT)_"Enter a 10 digit National Provider Identifier"
"RTN","IBCEP82",37,0)
 I $G(DA) S:$P($G(^IBA(355.93,DA,0)),U,14)'="" (DIR("B"),IBOLDNPI)=$P($G(^IBA(355.93,DA,0)),U,14)
"RTN","IBCEP82",38,0)
 D ^DIR S IBCHECK=0
"RTN","IBCEP82",39,0)
 I X="@" G:IBOLDNPI'="" DEL W *7,"??" G EN21
"RTN","IBCEP82",40,0)
 I $G(DUOUT)!$G(DTOUT)!(X="")!(Y=IBOLDNPI) G XIT
"RTN","IBCEP82",41,0)
 I '$$PROC(Y,IBOLDNPI,IBIEN) G EN21
"RTN","IBCEP82",42,0)
 G XIT
"RTN","IBCEP82",43,0)
 ;
"RTN","IBCEP82",44,0)
PROC(IBNPI,IBOLDNPI,IBIEN) ; process new NPI
"RTN","IBCEP82",45,0)
 I '$$CHKDGT^XUSNPI(IBNPI) W !,*7,$E($G(SPACES),1,+$G(INDENT))_"Not a valid NPI.  Please try again.",! Q 0
"RTN","IBCEP82",46,0)
 I $$NPIUSED^IBCEP81(IBNPI) Q 0
"RTN","IBCEP82",47,0)
 S IBCHECK=1
"RTN","IBCEP82",48,0)
 I IBOLDNPI="" D ACTI
"RTN","IBCEP82",49,0)
 I IBOLDNPI'="" D:IBNPI'=IBOLDNPI INACT
"RTN","IBCEP82",50,0)
 S $P(^IBA(355.93,IBIEN,0),U,14)=IBNPI,^IBA(355.93,"NPI",IBNPI,IBIEN)="",^IBA(355.93,"NPIHISTORY",IBNPI,IBIEN)=""
"RTN","IBCEP82",51,0)
 Q 1
"RTN","IBCEP82",52,0)
 ;
"RTN","IBCEP82",53,0)
ACTI ;CREATE AN ACTIVATED ENTRY IN MULTIPLE NPISTATUS FIELD
"RTN","IBCEP82",54,0)
 S DA(1)=IBIEN,DIC="^IBA(355.93,"_DA(1)_",""NPISTATUS"",",DIC(0)="L",X=$$NOW^XLFDT()
"RTN","IBCEP82",55,0)
 S DIC("DR")=".02////^S X=1;.03////^S X=IBNPI;.04////^S X=DUZ"
"RTN","IBCEP82",56,0)
 D FILE^DICN
"RTN","IBCEP82",57,0)
 S $P(^IBA(355.93,IBIEN,0),U,14)=IBNPI
"RTN","IBCEP82",58,0)
 Q
"RTN","IBCEP82",59,0)
 ;
"RTN","IBCEP82",60,0)
DEL ;NPI HAS BEEN DELETED
"RTN","IBCEP82",61,0)
 ;If the user deletes the NPI this subroutine will determine why it was deleted and if it was because it was found
"RTN","IBCEP82",62,0)
 ;in a false identity situation will mark it in history to never be used again.
"RTN","IBCEP82",63,0)
 S IBNPI=DIR("B")
"RTN","IBCEP82",64,0)
 K DIR
"RTN","IBCEP82",65,0)
 S DIR(0)="Y"
"RTN","IBCEP82",66,0)
 S DIR("A")="Are you sure you wish to delete this NPI"
"RTN","IBCEP82",67,0)
 S DIR("?")="You have indicated you wish to delete the NPI.  This is a second chance check."
"RTN","IBCEP82",68,0)
 D ^DIR
"RTN","IBCEP82",69,0)
 G:Y(0)="NO" XIT
"RTN","IBCEP82",70,0)
 S DIR(0)="S^E:ERROR;V:VALID",DIR("A")="Was this a Valid NPI or an NPI entered in Error"
"RTN","IBCEP82",71,0)
 S DIR("?",1)="An example of an NPI entered in error is if the entry person transposed numbers,"
"RTN","IBCEP82",72,0)
 S DIR("?",2)="or if the NPI for one provider is accidentally assigned to a different provider."
"RTN","IBCEP82",73,0)
 S DIR("?")="Enter an 'E' for Error or a 'V' for Valid."
"RTN","IBCEP82",74,0)
 D ^DIR
"RTN","IBCEP82",75,0)
 I Y="E" D COMP W !,"The NPI has been deleted.",!
"RTN","IBCEP82",76,0)
 I Y="V" S IBCHECK=2 D INACT W !,"The NPI is now inactive.",!
"RTN","IBCEP82",77,0)
 Q
"RTN","IBCEP82",78,0)
 ;
"RTN","IBCEP82",79,0)
COMP ;COMPLETELY DELETE THE NPI
"RTN","IBCEP82",80,0)
 ;This subroutine will delete the NPI from the file 355.93.
"RTN","IBCEP82",81,0)
 S OIEN=$O(^IBA(355.93,IBIEN,"NPISTATUS","C",IBOLDNPI,"A"),-1)
"RTN","IBCEP82",82,0)
 D DELNPI(IBIEN,OIEN)
"RTN","IBCEP82",83,0)
 K ^IBA(355.93,"NPI",IBOLDNPI,DA),^IBA(355.93,"NPIHISTORY",IBOLDNPI,DA)
"RTN","IBCEP82",84,0)
 S IBRB=0
"RTN","IBCEP82",85,0)
 D  ; Find the most recent status '0' (inactive) NPI entry in the list.
"RTN","IBCEP82",86,0)
 . N IBRBLST,IBRBTMP
"RTN","IBCEP82",87,0)
 . ; Don't want to roll back to the same number you are deleting.
"RTN","IBCEP82",88,0)
 . S IBRBLST(IBOLDNPI)=""
"RTN","IBCEP82",89,0)
 . S IBRBTMP="A"
"RTN","IBCEP82",90,0)
 . ; Go through each entry in reverse order
"RTN","IBCEP82",91,0)
 . F  S IBRBTMP=$O(^IBA(355.93,IBIEN,"NPISTATUS",IBRBTMP),-1) Q:'IBRBTMP  D  Q:IBRB'=0
"RTN","IBCEP82",92,0)
 .. S IBRBLST=^IBA(355.93,IBIEN,"NPISTATUS",IBRBTMP,0)
"RTN","IBCEP82",93,0)
 .. ; If this is an 'active' entry then ignore it.
"RTN","IBCEP82",94,0)
 .. I $P(IBRBLST,U,2)=1 Q
"RTN","IBCEP82",95,0)
 .. ; If this entry does not have an NPI then ignore it.
"RTN","IBCEP82",96,0)
 .. I $P(IBRBLST,U,3)="" Q
"RTN","IBCEP82",97,0)
 .. ;If this is an inactive entry then report it.
"RTN","IBCEP82",98,0)
 .. I $P(IBRBLST,U,2)=0 S IBRB=IBRBTMP Q
"RTN","IBCEP82",99,0)
 .. Q
"RTN","IBCEP82",100,0)
 . Q
"RTN","IBCEP82",101,0)
 I IBRB>0 D ROLLBACK
"RTN","IBCEP82",102,0)
 Q
"RTN","IBCEP82",103,0)
 ;
"RTN","IBCEP82",104,0)
DELNPI(IEN,OIEN) ;DELETE-INVALID removes NPI from file.
"RTN","IBCEP82",105,0)
 NEW DIE,DIK,DIC,DA,DR,D,D0,DI,DIC,DQ,X
"RTN","IBCEP82",106,0)
 NEW DP,DM,DK,DL,DIEL
"RTN","IBCEP82",107,0)
 S DIE="^IBA(355.93,",DA=IEN,DR="41.01////@"
"RTN","IBCEP82",108,0)
 D ^DIE
"RTN","IBCEP82",109,0)
 S DA(1)=IEN,DIK="^IBA(355.93,"_DA(1)_",""NPISTATUS"",",DA=OIEN
"RTN","IBCEP82",110,0)
 D ^DIK
"RTN","IBCEP82",111,0)
 Q
"RTN","IBCEP82",112,0)
 ;
"RTN","IBCEP82",113,0)
INACT ;INACTIVATE AN ENTRY
"RTN","IBCEP82",114,0)
 ;This subroutine makes two entries in the NPI multiple field.
"RTN","IBCEP82",115,0)
 ;One for the deactivation of the old NPI and the second
"RTN","IBCEP82",116,0)
 ;for the activation of a new NPI.
"RTN","IBCEP82",117,0)
 S DA(1)=IBIEN,DIC="^IBA(355.93,"_DA(1)_",""NPISTATUS"",",DIC(0)="L",X=$$NOW^XLFDT()
"RTN","IBCEP82",118,0)
 S DIC("DR")=".02////^S X=0;.03////^S X=IBOLDNPI;.04////^S X=DUZ"
"RTN","IBCEP82",119,0)
 D FILE^DICN
"RTN","IBCEP82",120,0)
 S ^IBA(355.93,"NPIHISTORY",IBOLDNPI,DA(1))=""
"RTN","IBCEP82",121,0)
 K ^IBA(355.93,"NPI",IBOLDNPI,DA(1))
"RTN","IBCEP82",122,0)
 S $P(^IBA(355.93,IBIEN,0),U,14)=""
"RTN","IBCEP82",123,0)
 I $G(IBCHECK)<2 D ACTI
"RTN","IBCEP82",124,0)
 S ^IBA(355.93,"NPIHISTORY",IBNPI,DA(1))=""
"RTN","IBCEP82",125,0)
 Q
"RTN","IBCEP82",126,0)
 ;
"RTN","IBCEP82",127,0)
ROLLBACK ;Rollback or delete NPI
"RTN","IBCEP82",128,0)
 S IBRBNPI=$P(^IBA(355.93,IBIEN,"NPISTATUS",IBRB,0),U,3)
"RTN","IBCEP82",129,0)
 NEW DIE,DIK,DIC,DA,DR,D,D0,DI,DIC,DQ,X
"RTN","IBCEP82",130,0)
 NEW DP,DM,DK,DL,DIEL
"RTN","IBCEP82",131,0)
 S DA(1)=IBIEN,DIK="^IBA(355.93,"_DA(1)_",""NPISTATUS"",",DA=IBRB
"RTN","IBCEP82",132,0)
 D ^DIK
"RTN","IBCEP82",133,0)
 S $P(^IBA(355.93,IBIEN,0),U,14)=IBRBNPI,^IBA(355.93,"NPI",IBRBNPI,IBIEN)=""
"RTN","IBCEP82",134,0)
 Q
"RTN","IBCEP82",135,0)
 ;
"RTN","IBCEP82",136,0)
XIT ;CLEAN AND EXIT
"RTN","IBCEP82",137,0)
 Q
"RTN","IBCEP82",138,0)
 ;
"RTN","IBCEP82",139,0)
XR ;Set the primary taxonomy code cross reference for field 42
"RTN","IBCEP82",140,0)
 N ATAX S ATAX=""
"RTN","IBCEP82",141,0)
 I $D(^IBA(355.93,DA(1),"TAXONOMY","D")) D:X=1
"RTN","IBCEP82",142,0)
 . F  S ATAX=$O(^IBA(355.93,DA(1),"TAXONOMY","D",1,ATAX)) Q:ATAX=""  D
"RTN","IBCEP82",143,0)
 .. K ^IBA(355.93,DA(1),"TAXONOMY","D",1,ATAX)
"RTN","IBCEP82",144,0)
 .. I ATAX'=DA S $P(^IBA(355.93,DA(1),"TAXONOMY",ATAX,0),U,2)=0,^IBA(355.93,DA(1),"TAXONOMY","D",0,ATAX)=""
"RTN","IBCEP82",145,0)
 S ^IBA(355.93,DA(1),"TAXONOMY","D",X,DA)=""
"RTN","IBCEP82",146,0)
 Q
"RTN","IBCEP82",147,0)
 ;
"RTN","IBCEP82",148,0)
KXR ;Kill primary taxonomy code cross reference for field 42
"RTN","IBCEP82",149,0)
 N K
"RTN","IBCEP82",150,0)
 F K=0,1 K ^IBA(355.93,DA(1),"TAXONOMY","D",K,DA)
"RTN","IBCEP82",151,0)
 Q
"RTN","IBCEPA")
0^35^B57987337^B50420799
"RTN","IBCEPA",1,0)
IBCEPA ;ALB/WCJ - Provider ID functions - Care Units ;21-OCT-2005
"RTN","IBCEPA",2,0)
 ;;2.0;INTEGRATED BILLING;**320,348,377**;21-MAR-94;Build 23
"RTN","IBCEPA",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEPA",4,0)
 ;
"RTN","IBCEPA",5,0)
EN ; -- main entry point for IBCE 2ND PRVID CARE UNIT MAINT
"RTN","IBCEPA",6,0)
 D EN^VALM("IBCE 2ND PRVID CARE UNIT MAINT")
"RTN","IBCEPA",7,0)
 Q
"RTN","IBCEPA",8,0)
 ;
"RTN","IBCEPA",9,0)
HDR ; -- header code
"RTN","IBCEPA",10,0)
 K VALMHDR
"RTN","IBCEPA",11,0)
 S VALMHDR(1)=" "
"RTN","IBCEPA",12,0)
 S VALMHDR(2)="Insurance Co: "_$S('$G(IBALL)&$G(IBINS):$P($G(^DIC(36,+IBINS,0)),U),1:"ALL")
"RTN","IBCEPA",13,0)
 Q
"RTN","IBCEPA",14,0)
 ;
"RTN","IBCEPA",15,0)
INIT ; -- init variables and list array
"RTN","IBCEPA",16,0)
 N DIR,Y
"RTN","IBCEPA",17,0)
 I '$G(IBINS) D  I +Y<0 S VALMQUIT=1 Q
"RTN","IBCEPA",18,0)
 . S DIR(0)="PA^DIC(36,:AEMQ",DIR("A")="Select INSURANCE CO: ",DIR("?")="Select an INSURANCE CO to display its care units"
"RTN","IBCEPA",19,0)
 . D ^DIR K DIR
"RTN","IBCEPA",20,0)
 . I $D(DTOUT)!$D(DUOUT) S Y=-2 Q
"RTN","IBCEPA",21,0)
 . I Y>0 S IBINS=+Y Q
"RTN","IBCEPA",22,0)
 ;
"RTN","IBCEPA",23,0)
 D BLD
"RTN","IBCEPA",24,0)
 Q
"RTN","IBCEPA",25,0)
 ;
"RTN","IBCEPA",26,0)
BLD ;
"RTN","IBCEPA",27,0)
 D CLEAN^VALM10
"RTN","IBCEPA",28,0)
 K ^TMP("IBPRV_CU",$J)
"RTN","IBCEPA",29,0)
 N TAR,MSG,I,D0,IBCT,Z,DIV,SCREEN
"RTN","IBCEPA",30,0)
 ;
"RTN","IBCEPA",31,0)
 S VALMBG=1
"RTN","IBCEPA",32,0)
 ;
"RTN","IBCEPA",33,0)
 ; Get all care units for this insurance company that have a division
"RTN","IBCEPA",34,0)
 ; If there is no division, then it is part of the other care units code (IBCEP4)
"RTN","IBCEPA",35,0)
 ; 
"RTN","IBCEPA",36,0)
 S SCREEN="I $P(^(0),U,4)'="""",$P(^(0),U,3)=IBINS"
"RTN","IBCEPA",37,0)
 D LIST^DIC(355.95,,"@;.01;.02;.04",,,,,,SCREEN,,"TAR")
"RTN","IBCEPA",38,0)
 ;
"RTN","IBCEPA",39,0)
 I '+TAR("DILIST",0) D
"RTN","IBCEPA",40,0)
 . D SET^VALM10(1,"No CARE UNITs found for this Insurance Company")
"RTN","IBCEPA",41,0)
 ;
"RTN","IBCEPA",42,0)
 I +TAR("DILIST",0) D
"RTN","IBCEPA",43,0)
 . S IBCT=0
"RTN","IBCEPA",44,0)
 . F VALMCNT=1:1:+TAR("DILIST",0) D
"RTN","IBCEPA",45,0)
 .. S ^TMP("IBPRV_CU",$J,"SORT",TAR("DILIST","ID",VALMCNT,.04),TAR("DILIST",2,VALMCNT))=VALMCNT
"RTN","IBCEPA",46,0)
 . S DIV="" F  S DIV=$O(^TMP("IBPRV_CU",$J,"SORT",DIV)) Q:DIV=""  D
"RTN","IBCEPA",47,0)
 .. S Z="Division: "_DIV
"RTN","IBCEPA",48,0)
 .. S IBCT=IBCT+1
"RTN","IBCEPA",49,0)
 .. D SET^VALM10(IBCT,Z)
"RTN","IBCEPA",50,0)
 .. S D0=0 F  S D0=$O(^TMP("IBPRV_CU",$J,"SORT",DIV,D0)) Q:'D0  D
"RTN","IBCEPA",51,0)
 ... S IN=^TMP("IBPRV_CU",$J,"SORT",DIV,D0)
"RTN","IBCEPA",52,0)
 ... S Z=$J("",2)
"RTN","IBCEPA",53,0)
 ... S Z=Z_$E(IN_"    ",1,4)_$E(TAR("DILIST","ID",IN,.01),1,36)
"RTN","IBCEPA",54,0)
 ... S Z=Z_$J("",40-$L(Z))
"RTN","IBCEPA",55,0)
 ... S Z=Z_$E(TAR("DILIST","ID",IN,.02),1,38)
"RTN","IBCEPA",56,0)
 ... S IBCT=IBCT+1
"RTN","IBCEPA",57,0)
 ... D SET^VALM10(IBCT,Z)
"RTN","IBCEPA",58,0)
 ;
"RTN","IBCEPA",59,0)
 ; correct the VALMCNT variable - number of lines in the list (not entries)
"RTN","IBCEPA",60,0)
 S VALMCNT=+$O(@VALMAR@(""),-1)
"RTN","IBCEPA",61,0)
 Q
"RTN","IBCEPA",62,0)
 ;
"RTN","IBCEPA",63,0)
HELP ; -- help code
"RTN","IBCEPA",64,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBCEPA",65,0)
 Q
"RTN","IBCEPA",66,0)
 ;
"RTN","IBCEPA",67,0)
EXIT ; -- exit code
"RTN","IBCEPA",68,0)
 D CLEAN^VALM10
"RTN","IBCEPA",69,0)
 K ^TMP("IBPRV_CU",$J)
"RTN","IBCEPA",70,0)
 Q
"RTN","IBCEPA",71,0)
 ;
"RTN","IBCEPA",72,0)
EXPND ; -- expand code
"RTN","IBCEPA",73,0)
 Q
"RTN","IBCEPA",74,0)
 ;
"RTN","IBCEPA",75,0)
NEW ; Add care unit
"RTN","IBCEPA",76,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEPA",77,0)
 ; IB = 0 or null if called from list manager, 1 if not
"RTN","IBCEPA",78,0)
 N DIC,DIR,X,Y,Z,D,DA,DR,DIE,DO,DD,DLAYGO,IB95,IBADD,IBOK,IBDIV,MAIN,IBDIVNM
"RTN","IBCEPA",79,0)
 ;
"RTN","IBCEPA",80,0)
 D FULL^VALM1
"RTN","IBCEPA",81,0)
 ; Add an entry - either new care unit/ins co or a combination for
"RTN","IBCEPA",82,0)
 ; existing care unit/ins co
"RTN","IBCEPA",83,0)
 ;
"RTN","IBCEPA",84,0)
 S MAIN=$$MAIN^IBCEP2B()
"RTN","IBCEPA",85,0)
 S MAIN=$$EXTERNAL^DILFD(355.92,.05,"",MAIN)
"RTN","IBCEPA",86,0)
 S DIC=40.8,DIC("A")="Enter the Division for this Care Unit: ",DIC("B")=MAIN,DIC(0)="AEMQ"
"RTN","IBCEPA",87,0)
 S D="B^C"
"RTN","IBCEPA",88,0)
 D MIX^DIC1
"RTN","IBCEPA",89,0)
 I Y'>0 G NEWQ
"RTN","IBCEPA",90,0)
 S IBDIV=+Y
"RTN","IBCEPA",91,0)
 S IBDIVNM=$$EXTERNAL^DILFD(355.92,.05,"",IBDIV)
"RTN","IBCEPA",92,0)
 ;
"RTN","IBCEPA",93,0)
 N SCREEN,TAR,MESS,I
"RTN","IBCEPA",94,0)
 S SCREEN="I $P(^(0),U,3)=+$G(IBINS),$P(^(0),U,4)=+$G(IBDIV)"
"RTN","IBCEPA",95,0)
 D LIST^DIC(355.95,,.01,,,,,,SCREEN,,"TAR")
"RTN","IBCEPA",96,0)
 ;
"RTN","IBCEPA",97,0)
ACU K DIR
"RTN","IBCEPA",98,0)
 S I=0
"RTN","IBCEPA",99,0)
 I $G(TAR("DILIST",0)) D 
"RTN","IBCEPA",100,0)
 . S DIR("?",1)="Current Entries are:"
"RTN","IBCEPA",101,0)
 . F I=2:1 Q:'$D(TAR("DILIST",1,I-1))  S DIR("?",I)="     "_TAR("DILIST",1,I-1)
"RTN","IBCEPA",102,0)
 . S DIR("?",I)=" "
"RTN","IBCEPA",103,0)
 ;
"RTN","IBCEPA",104,0)
 S DIR("?",I+1)="You may enter the name of a new Care Unit for this Insurance Company."
"RTN","IBCEPA",105,0)
 S DIR("?",I+2)="You can then define a Billing Provider Secondary ID - Billing Screen 3 - for"
"RTN","IBCEPA",106,0)
 S DIR("?")="this Care Unit and Insurance Company using the Insurance Company Editor."
"RTN","IBCEPA",107,0)
 S DIR("A")="Enter the Care Unit name"
"RTN","IBCEPA",108,0)
 S DIR(0)="FO^1:30"
"RTN","IBCEPA",109,0)
 D ^DIR
"RTN","IBCEPA",110,0)
 I X=""!$G(DUOUT)!$G(DTOUT)!$G(DIROUT) G NEWQ
"RTN","IBCEPA",111,0)
 S CAREUNIT=X
"RTN","IBCEPA",112,0)
 ; 
"RTN","IBCEPA",113,0)
 ; At this point, we have X and it'a not a ? or ^
"RTN","IBCEPA",114,0)
 ;
"RTN","IBCEPA",115,0)
 K DIC
"RTN","IBCEPA",116,0)
 S DIC="^IBA(355.95,",DIC("S")="I $P(^(0),U,3)=+$G(IBINS),$P(^(0),U,4)=+$G(IBDIV)",DIC(0)="EX"
"RTN","IBCEPA",117,0)
 D ^DIC
"RTN","IBCEPA",118,0)
 ;
"RTN","IBCEPA",119,0)
 ; Check if we have an exisitng entry and if so, get out of Dodge (This option was for new care units)
"RTN","IBCEPA",120,0)
 I Y>0 D  G ACU
"RTN","IBCEPA",121,0)
 . D DISPMESS("This action is for adding new entries, not editing existing entries.")
"RTN","IBCEPA",122,0)
 ;
"RTN","IBCEPA",123,0)
 ; New entry , validate field
"RTN","IBCEPA",124,0)
 N TAR2
"RTN","IBCEPA",125,0)
 D FIELD^DID(355.95,.01,"N","INPUT TRANSFORM","TAR2")
"RTN","IBCEPA",126,0)
 S X=CAREUNIT
"RTN","IBCEPA",127,0)
 X TAR2("INPUT TRANSFORM")
"RTN","IBCEPA",128,0)
 I '$D(X) D  G ACU  ; Failed input transform
"RTN","IBCEPA",129,0)
 . D DISPMESS("Invalid Format.")
"RTN","IBCEPA",130,0)
 ;
"RTN","IBCEPA",131,0)
 K DIR
"RTN","IBCEPA",132,0)
 S DIR("A")="Are you adding '"_X_"' as a new Care Unit for '"_IBDIVNM_"'"
"RTN","IBCEPA",133,0)
 S DIR("B")="N"
"RTN","IBCEPA",134,0)
 S DIR(0)="Y"
"RTN","IBCEPA",135,0)
 D ^DIR
"RTN","IBCEPA",136,0)
 I Y=0 G ACU
"RTN","IBCEPA",137,0)
 I Y["^" G NEWQ
"RTN","IBCEPA",138,0)
 ;
"RTN","IBCEPA",139,0)
 ; If it got this far, we have an exact match or a new entry.   
"RTN","IBCEPA",140,0)
 S X=CAREUNIT
"RTN","IBCEPA",141,0)
 S DIC="^IBA(355.95,",DIC("S")="I $P(^(0),U,3)=+$G(IBINS),$P(^(0),U,4)=+$G(IBDIV)",DIC(0)="XL",DLAYGO=355.95
"RTN","IBCEPA",142,0)
 S DIC("DR")=".03////"_+$G(IBINS)_";.04////"_$G(IBDIV)
"RTN","IBCEPA",143,0)
 D ^DIC
"RTN","IBCEPA",144,0)
 I Y>0 D
"RTN","IBCEPA",145,0)
 . S DA=+Y,DIE="^IBA(355.95,"
"RTN","IBCEPA",146,0)
 . S DR=".02Enter the Care Unit Description"
"RTN","IBCEPA",147,0)
 . D ^DIE
"RTN","IBCEPA",148,0)
 D BLD
"RTN","IBCEPA",149,0)
 ;
"RTN","IBCEPA",150,0)
NEWQ S VALMBCK="R"
"RTN","IBCEPA",151,0)
 Q
"RTN","IBCEPA",152,0)
 ;
"RTN","IBCEPA",153,0)
CHANGE ; Edit care unit
"RTN","IBCEPA",154,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEPA",155,0)
 ;
"RTN","IBCEPA",156,0)
 D FULL^VALM1
"RTN","IBCEPA",157,0)
 ;
"RTN","IBCEPA",158,0)
 N X,Y,Z,D,DA,DD,DIC,DIK,DIR,IBDIV,CAREUNIT,SCREEN,TAR,DIVISION,I
"RTN","IBCEPA",159,0)
 ;
"RTN","IBCEPA",160,0)
 S SCREEN="I $P(^(0),U,3)=+$G(IBINS),$P(^(0),U,4)]"""""
"RTN","IBCEPA",161,0)
 D LIST^DIC(355.95,,".01;.04",,,,,,SCREEN,,"TAR")
"RTN","IBCEPA",162,0)
 ;
"RTN","IBCEPA",163,0)
 I '+$G(TAR("DILIST",0)) D  G CHANGEQ
"RTN","IBCEPA",164,0)
 .D DISPMESS("No Care Units Defined for this insurance company.")
"RTN","IBCEPA",165,0)
 ;
"RTN","IBCEPA",166,0)
 ; Store all Divisons with at least one care unit in DIVISION array
"RTN","IBCEPA",167,0)
 F I=1:1 Q:'$D(TAR("DILIST","ID",I,.04))  D
"RTN","IBCEPA",168,0)
 . S DIVISION(TAR("DILIST","ID",I,.04))=""
"RTN","IBCEPA",169,0)
 ;
"RTN","IBCEPA",170,0)
 ; Only allow divisions that have care units to be selected
"RTN","IBCEPA",171,0)
 S DIC=40.8
"RTN","IBCEPA",172,0)
 S DIC("A")="Enter the Division for this Care Unit: "
"RTN","IBCEPA",173,0)
 S DIC(0)="AEMQ"
"RTN","IBCEPA",174,0)
 S DIC("S")="I $D(DIVISION($P(^(0),U)))"
"RTN","IBCEPA",175,0)
 S D="B^C"
"RTN","IBCEPA",176,0)
 D MIX^DIC1
"RTN","IBCEPA",177,0)
 I Y'>0 G CHANGEQ
"RTN","IBCEPA",178,0)
 S IBDIV=+Y
"RTN","IBCEPA",179,0)
 S DA=$$SEL($P(Y,U,2)) I 'DA G CHANGEQ
"RTN","IBCEPA",180,0)
 S DIE=355.95
"RTN","IBCEPA",181,0)
 S DR=".01Care Unit;.04Division;.02Description"
"RTN","IBCEPA",182,0)
 D ^DIE
"RTN","IBCEPA",183,0)
 ;
"RTN","IBCEPA",184,0)
 D BLD
"RTN","IBCEPA",185,0)
 ;
"RTN","IBCEPA",186,0)
CHANGEQ S VALMBCK="R"
"RTN","IBCEPA",187,0)
 Q
"RTN","IBCEPA",188,0)
 ;
"RTN","IBCEPA",189,0)
DEL ; Delete a Care Unit
"RTN","IBCEPA",190,0)
 ; Assumes IBINS is defined as ins co ien (file 36)
"RTN","IBCEPA",191,0)
 ; 
"RTN","IBCEPA",192,0)
 D FULL^VALM1
"RTN","IBCEPA",193,0)
 N X,Y,Z,D,DA,DD,DIC,DIK,DIR,IBDIV,CAREUNIT,SCREEN,TAR,DIVISION
"RTN","IBCEPA",194,0)
 ;
"RTN","IBCEPA",195,0)
 S SCREEN="I $P(^(0),U,3)=+$G(IBINS),$P(^(0),U,4)]"""""
"RTN","IBCEPA",196,0)
 D LIST^DIC(355.95,,".01;.04",,,,,,SCREEN,,"TAR")
"RTN","IBCEPA",197,0)
 ;
"RTN","IBCEPA",198,0)
 I '+$G(TAR("DILIST",0)) D  G DELQ
"RTN","IBCEPA",199,0)
 .D DISPMESS("No Care Units Defined for this insurance company.")
"RTN","IBCEPA",200,0)
 ;
"RTN","IBCEPA",201,0)
 ; Store all Divisons with at least one care unit in DIVISION array
"RTN","IBCEPA",202,0)
 F I=1:1 Q:'$D(TAR("DILIST","ID",I,.04))  D
"RTN","IBCEPA",203,0)
 . S DIVISION(TAR("DILIST","ID",I,.04))=""
"RTN","IBCEPA",204,0)
 ;
"RTN","IBCEPA",205,0)
 ; Only allow divisions that have care units to be selected
"RTN","IBCEPA",206,0)
 S DIC=40.8
"RTN","IBCEPA",207,0)
 S DIC("A")="Enter the Division for this Care Unit: "
"RTN","IBCEPA",208,0)
 S DIC(0)="AEMQ"
"RTN","IBCEPA",209,0)
 S DIC("S")="I $D(DIVISION($P(^(0),U)))"
"RTN","IBCEPA",210,0)
 S D="B^C"
"RTN","IBCEPA",211,0)
 D MIX^DIC1
"RTN","IBCEPA",212,0)
 I Y'>0 G DELQ
"RTN","IBCEPA",213,0)
 S IBDIV=+Y
"RTN","IBCEPA",214,0)
 S CAREUNIT=$$SEL($P(Y,U,2)) I 'CAREUNIT G DELQ
"RTN","IBCEPA",215,0)
 ;
"RTN","IBCEPA",216,0)
 I $D(^IBA(355.92,"AC",+Y)) D  G DELQ
"RTN","IBCEPA",217,0)
 . S DIR(0)="EA"
"RTN","IBCEPA",218,0)
 . S DIR("A",1)="IDs that are assigned to the Care Unit in the Insurance Company Editor must be"
"RTN","IBCEPA",219,0)
 . S DIR("A",2)="deleted before deleting the Care Unit."
"RTN","IBCEPA",220,0)
 . S DIR("A")="Press return to continue "
"RTN","IBCEPA",221,0)
 . W ! D ^DIR K DIR
"RTN","IBCEPA",222,0)
 ;
"RTN","IBCEPA",223,0)
 S DIR("A")="OK to Delete: "
"RTN","IBCEPA",224,0)
 S DIR("B")="No"
"RTN","IBCEPA",225,0)
 S DIR(0)="YAO"
"RTN","IBCEPA",226,0)
 D ^DIR
"RTN","IBCEPA",227,0)
 I '$G(Y) G DELQ
"RTN","IBCEPA",228,0)
 K DIR
"RTN","IBCEPA",229,0)
 ;
"RTN","IBCEPA",230,0)
 S DA=CAREUNIT
"RTN","IBCEPA",231,0)
 S DIK="^IBA("_355.95_","
"RTN","IBCEPA",232,0)
 D ^DIK
"RTN","IBCEPA",233,0)
 ;
"RTN","IBCEPA",234,0)
 D BLD
"RTN","IBCEPA",235,0)
 ;
"RTN","IBCEPA",236,0)
DELQ S VALMBCK="R"
"RTN","IBCEPA",237,0)
 Q
"RTN","IBCEPA",238,0)
 ;
"RTN","IBCEPA",239,0)
DISPMESS(MESS) ;
"RTN","IBCEPA",240,0)
 N DIR,X,Y
"RTN","IBCEPA",241,0)
 S DIR(0)="EA",DIR("A",1)=MESS
"RTN","IBCEPA",242,0)
 S DIR("A")="PRESS ENTER to continue "
"RTN","IBCEPA",243,0)
 D ^DIR
"RTN","IBCEPA",244,0)
 Q
"RTN","IBCEPA",245,0)
 ;
"RTN","IBCEPA",246,0)
SEL(DIV) ; select care unit for a given division
"RTN","IBCEPA",247,0)
 ; DIV - name of division
"RTN","IBCEPA",248,0)
 ; returns ien of selected care unit, or 0 if nothing is selected
"RTN","IBCEPA",249,0)
 N DIR,I,IEN,MIN,MAX,X,Y
"RTN","IBCEPA",250,0)
 I $G(DIV)="" Q 0
"RTN","IBCEPA",251,0)
 S IEN=0
"RTN","IBCEPA",252,0)
 S I=$O(^TMP("IBPRV_CU",$J,"SORT",DIV,"")),MIN=$G(^TMP("IBPRV_CU",$J,"SORT",DIV,I))
"RTN","IBCEPA",253,0)
 S I=$O(^TMP("IBPRV_CU",$J,"SORT",DIV,""),-1),MAX=$G(^TMP("IBPRV_CU",$J,"SORT",DIV,I))
"RTN","IBCEPA",254,0)
 I MIN=MAX S IEN=I
"RTN","IBCEPA",255,0)
 I MIN'=MAX D
"RTN","IBCEPA",256,0)
 .S DIR("A")="Select CARE UNITS",DIR(0)="N^"_MIN_":"_MAX_":0" D ^DIR
"RTN","IBCEPA",257,0)
 .Q:$D(DTOUT)!$D(DUOUT)
"RTN","IBCEPA",258,0)
 .S I="" F  S I=$O(^TMP("IBPRV_CU",$J,"SORT",DIV,I)) Q:I=""!(IEN>0)  S:$G(^TMP("IBPRV_CU",$J,"SORT",DIV,I))=Y IEN=I
"RTN","IBCEPA",259,0)
 .Q
"RTN","IBCEPA",260,0)
 Q IEN
"RTN","IBCERP3")
0^8^B24573380^B8609666
"RTN","IBCERP3",1,0)
IBCERP3 ;ALB/TMP - EDI BATCHES WAITING MORE THAN 1 DAY REPORT ;30-SEP-96
"RTN","IBCERP3",2,0)
 ;;2.0;INTEGRATED BILLING;**137,296,377**;21-MAR-94;Build 23
"RTN","IBCERP3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCERP3",4,0)
 ;
"RTN","IBCERP3",5,0)
 Q
"RTN","IBCERP3",6,0)
 ;
"RTN","IBCERP3",7,0)
PENDING ; Report of batches not sent after the day the bills in it were extracted - report entry point
"RTN","IBCERP3",8,0)
 ;
"RTN","IBCERP3",9,0)
 NEW DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,IBCLM
"RTN","IBCERP3",10,0)
 I '$O(^IBA(364.1,"ASTAT","P",0)) W !!,"There are no batches that are Pending Austin Receipt.",! S DIR(0)="E" D ^DIR K DIR G EX
"RTN","IBCERP3",11,0)
 ;
"RTN","IBCERP3",12,0)
 ; Ask user if they want to include claim level detail
"RTN","IBCERP3",13,0)
 S DIR(0)="Y",DIR("A")="Include Claims in each Batch",DIR("B")="Yes"
"RTN","IBCERP3",14,0)
 W ! D ^DIR K DIR
"RTN","IBCERP3",15,0)
 I $D(DIRUT) G EX
"RTN","IBCERP3",16,0)
 S IBCLM=+Y
"RTN","IBCERP3",17,0)
 ;
"RTN","IBCERP3",18,0)
 D DEVICE
"RTN","IBCERP3",19,0)
EX ;
"RTN","IBCERP3",20,0)
 Q
"RTN","IBCERP3",21,0)
 ;
"RTN","IBCERP3",22,0)
DEVICE ; selection of device on which to print report
"RTN","IBCERP3",23,0)
 NEW ZTRTN,ZTDESC,ZTSAVE,POP
"RTN","IBCERP3",24,0)
 W !!,"This report is 80 characters wide."
"RTN","IBCERP3",25,0)
 S ZTRTN="COMPILE^IBCERP3"
"RTN","IBCERP3",26,0)
 S ZTDESC="REPORT OF BILL BATCHES WAITING AUSTIN RECEIPT AFTER 1 DAY"
"RTN","IBCERP3",27,0)
 S ZTSAVE("IBCLM")=""
"RTN","IBCERP3",28,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE,"QM")
"RTN","IBCERP3",29,0)
DEVICEX ;
"RTN","IBCERP3",30,0)
 Q
"RTN","IBCERP3",31,0)
 ;
"RTN","IBCERP3",32,0)
COMPILE ; Queued job entrypoint
"RTN","IBCERP3",33,0)
 N IBBA,IB0,IB1,IEN,IBZ,IBIFN,IB399,CLM,BALDUE,IBSTAT,ARSTAT,IB
"RTN","IBCERP3",34,0)
 ;
"RTN","IBCERP3",35,0)
 K ^TMP($J,"IBSORT")
"RTN","IBCERP3",36,0)
 S IBBA=0
"RTN","IBCERP3",37,0)
 F  S IBBA=$O(^IBA(364.1,"ASTAT","P",IBBA)) Q:'IBBA  D
"RTN","IBCERP3",38,0)
 . I $$BCHCHK^IBCEBUL(IBBA) Q    ; Batch check function
"RTN","IBCERP3",39,0)
 . S IB0=$G(^IBA(364.1,IBBA,0)),IB1=$G(^(1))
"RTN","IBCERP3",40,0)
 . S:$P(IB0,U,7)="" $P(IB0,U,7)="~"
"RTN","IBCERP3",41,0)
 . S ^TMP($J,"IBSORT",$P(IB0,U,7),$P(IB0,U,1),IBBA)=$P(IB1,U,6)_U_$P(IB0,U,4)
"RTN","IBCERP3",42,0)
 . ;
"RTN","IBCERP3",43,0)
 . I 'IBCLM Q   ; include claim data flag
"RTN","IBCERP3",44,0)
 . ;
"RTN","IBCERP3",45,0)
 . ; gather the EDI claim data for this batch
"RTN","IBCERP3",46,0)
 . S IEN=0 F  S IEN=$O(^IBA(364,"C",IBBA,IEN)) Q:'IEN  D
"RTN","IBCERP3",47,0)
 .. S IBZ=$G(^IBA(364,IEN,0)),IBIFN=+IBZ,IB399=$G(^DGCR(399,IBIFN,0))
"RTN","IBCERP3",48,0)
 .. S CLM=$P(IB399,U,1) S:CLM="" CLM="~"
"RTN","IBCERP3",49,0)
 .. S BALDUE=$G(^DGCR(399,IBIFN,"U1")),BALDUE=$P(BALDUE,U,1)-$P(BALDUE,U,2)
"RTN","IBCERP3",50,0)
 .. S IBSTAT=$$EXTERNAL^DILFD(399,.13,,$P(IB399,U,13))
"RTN","IBCERP3",51,0)
 .. S ARSTAT=$$EXTERNAL^DILFD(430,8,,+$P($$BILL^RCJIBFN2(IBIFN),U,2))
"RTN","IBCERP3",52,0)
 .. S IB=$P(IBZ,U,8)_U_BALDUE_U_$P(IBZ,U,3)_U_IBSTAT_U_ARSTAT
"RTN","IBCERP3",53,0)
 .. S ^TMP($J,"IBSORT",$P(IB0,U,7),$P(IB0,U,1),IBBA,CLM,IEN)=IB
"RTN","IBCERP3",54,0)
 .. Q
"RTN","IBCERP3",55,0)
 . Q
"RTN","IBCERP3",56,0)
 ;
"RTN","IBCERP3",57,0)
 D PRINT                         ; print report
"RTN","IBCERP3",58,0)
 D ^%ZISC                        ; close the device
"RTN","IBCERP3",59,0)
 K ^TMP($J,"IBSORT")             ; clean up scratch global
"RTN","IBCERP3",60,0)
 I $D(ZTQUEUED) S ZTREQ="@"      ; purge the task record
"RTN","IBCERP3",61,0)
 ;
"RTN","IBCERP3",62,0)
COMPX ;
"RTN","IBCERP3",63,0)
 Q
"RTN","IBCERP3",64,0)
 ;
"RTN","IBCERP3",65,0)
PRINT ; print the report to the specified device
"RTN","IBCERP3",66,0)
 ;
"RTN","IBCERP3",67,0)
 NEW CRT,IBPAGE,IBSTOP,IBCT,IBTYP,IBBAT,IBBA,IBV,CLM,IEN,DIR,X,Y,Z
"RTN","IBCERP3",68,0)
 I IOST["C-" S CRT=1
"RTN","IBCERP3",69,0)
 E  S CRT=0
"RTN","IBCERP3",70,0)
 ;
"RTN","IBCERP3",71,0)
 S IBPAGE=0
"RTN","IBCERP3",72,0)
 I '$D(^TMP($J,"IBSORT")) D HDR1 W !,?3,"No batches found Pending Austin Receipt for >1 day."
"RTN","IBCERP3",73,0)
 S (IBSTOP,IBCT)=0
"RTN","IBCERP3",74,0)
 ;
"RTN","IBCERP3",75,0)
 S IBTYP=""
"RTN","IBCERP3",76,0)
 F  S IBTYP=$O(^TMP($J,"IBSORT",IBTYP)) Q:IBTYP=""  D  Q:IBSTOP
"RTN","IBCERP3",77,0)
 . D HDR1
"RTN","IBCERP3",78,0)
 . S IBBAT=""
"RTN","IBCERP3",79,0)
 . F  S IBBAT=$O(^TMP($J,"IBSORT",IBTYP,IBBAT)) Q:'IBBAT!(IBSTOP)  S IBBA=0 F  S IBBA=$O(^TMP($J,"IBSORT",IBTYP,IBBAT,IBBA)) Q:'IBBA!IBSTOP  S IBV=$G(^(IBBA)) D  Q:IBSTOP
"RTN","IBCERP3",80,0)
 .. D:$Y>(IOSL-4) HDR1 Q:IBSTOP
"RTN","IBCERP3",81,0)
 .. W !,?2,IBBAT,?16,$$FMTE^XLFDT($P(IBV,U,1),"5Z"),?42,$P(IBV,U,2)
"RTN","IBCERP3",82,0)
 .. S IBCT=IBCT+1
"RTN","IBCERP3",83,0)
 .. I 'IBCLM Q    ; no claim level detail
"RTN","IBCERP3",84,0)
 .. I $O(^TMP($J,"IBSORT",IBTYP,IBBAT,IBBA,""))="" Q   ; no claim data
"RTN","IBCERP3",85,0)
 .. ;
"RTN","IBCERP3",86,0)
 .. D:$Y>(IOSL-4) HDR1 Q:IBSTOP
"RTN","IBCERP3",87,0)
 .. W !!?5,"Claim",?14,"Seq",?22,"Bal Due",?32,"EDI Stat",?43,"IB Status",?57,"AR Status"
"RTN","IBCERP3",88,0)
 .. S CLM="" F  S CLM=$O(^TMP($J,"IBSORT",IBTYP,IBBAT,IBBA,CLM)) Q:CLM=""!IBSTOP  S IEN=0 F  S IEN=$O(^TMP($J,"IBSORT",IBTYP,IBBAT,IBBA,CLM,IEN)) Q:'IEN!IBSTOP  D  Q:IBSTOP
"RTN","IBCERP3",89,0)
 ... S IBV=$G(^TMP($J,"IBSORT",IBTYP,IBBAT,IBBA,CLM,IEN))
"RTN","IBCERP3",90,0)
 ... D:$Y>(IOSL-4) HDR1 Q:IBSTOP
"RTN","IBCERP3",91,0)
 ... W !,?5,CLM,?15,$P(IBV,U,1),?19,$J($FN($P(IBV,U,2),"",2),10),?35,$P(IBV,U,3),?43,$E($P(IBV,U,4),1,11),?57,$E($P(IBV,U,5),1,16)
"RTN","IBCERP3",92,0)
 ... Q
"RTN","IBCERP3",93,0)
 .. ;
"RTN","IBCERP3",94,0)
 .. Q:IBSTOP
"RTN","IBCERP3",95,0)
 .. D:$Y>(IOSL-4) HDR1 Q:IBSTOP
"RTN","IBCERP3",96,0)
 .. W !
"RTN","IBCERP3",97,0)
 .. Q
"RTN","IBCERP3",98,0)
 . Q
"RTN","IBCERP3",99,0)
 ;
"RTN","IBCERP3",100,0)
 I IBSTOP G PRINTX
"RTN","IBCERP3",101,0)
 D:$Y>(IOSL-4) HDR1 G:IBSTOP PRINTX
"RTN","IBCERP3",102,0)
 W !!,"Total Number of Batches: ",IBCT
"RTN","IBCERP3",103,0)
 D:$Y>(IOSL-4) HDR1 G:IBSTOP PRINTX
"RTN","IBCERP3",104,0)
 W !!?5,"*** End of Report ***"
"RTN","IBCERP3",105,0)
 I CRT,'$D(ZTQUEUED) S DIR(0)="E" D ^DIR K DIR
"RTN","IBCERP3",106,0)
PRINTX ;
"RTN","IBCERP3",107,0)
 Q
"RTN","IBCERP3",108,0)
 ;
"RTN","IBCERP3",109,0)
HDR1 ; Report header
"RTN","IBCERP3",110,0)
 ;
"RTN","IBCERP3",111,0)
 ; if screen output and page# already exists, do a page break
"RTN","IBCERP3",112,0)
 I IBPAGE,CRT D  I IBSTOP G HDR1X
"RTN","IBCERP3",113,0)
 . S DIR(0)="E" D ^DIR K DIR
"RTN","IBCERP3",114,0)
 . I 'Y S IBSTOP=1
"RTN","IBCERP3",115,0)
 . Q
"RTN","IBCERP3",116,0)
 ;
"RTN","IBCERP3",117,0)
 ; if screen output OR page# already exists, do a form feed
"RTN","IBCERP3",118,0)
 I IBPAGE!CRT W @IOF
"RTN","IBCERP3",119,0)
 ;
"RTN","IBCERP3",120,0)
 S IBPAGE=IBPAGE+1
"RTN","IBCERP3",121,0)
 ;
"RTN","IBCERP3",122,0)
 W !,"EDI Batches Pending Austin Receipt After 1 Day",?70,"Page: ",IBPAGE
"RTN","IBCERP3",123,0)
 W !,"Run Date: ",$$FMTE^XLFDT($$NOW^XLFDT,"5Z")
"RTN","IBCERP3",124,0)
 W !!?2,"Batch #",?16,"Transmission Date",?42,"Mail Message #"
"RTN","IBCERP3",125,0)
 S Z="",$P(Z,"-",79)="" W !?1,Z
"RTN","IBCERP3",126,0)
 ;
"RTN","IBCERP3",127,0)
 ; check for a TaskManager stop request
"RTN","IBCERP3",128,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD() D  G HDR1X
"RTN","IBCERP3",129,0)
 . S (ZTSTOP,IBSTOP)=1
"RTN","IBCERP3",130,0)
 . W !!!?5,"*** Report Halted by TaskManager Request ***"
"RTN","IBCERP3",131,0)
 . Q
"RTN","IBCERP3",132,0)
HDR1X ;
"RTN","IBCERP3",133,0)
 Q
"RTN","IBCERP3",134,0)
 ;
"RTN","IBCEXTRP")
0^1^B44709750^B22039999
"RTN","IBCEXTRP",1,0)
IBCEXTRP ;ALB/JEH - VIEW/PRINT EDI EXTRACT DATA ;4/22/03 9:59am
"RTN","IBCEXTRP",2,0)
 ;;2.0;INTEGRATED BILLING;**137,197,211,348,349,377**;21-MAR-94;Build 23
"RTN","IBCEXTRP",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCEXTRP",4,0)
 ;
"RTN","IBCEXTRP",5,0)
EN ;
"RTN","IBCEXTRP",6,0)
INIT ;
"RTN","IBCEXTRP",7,0)
 W !!,"This option will display the EDI extract data for a bill.",!
"RTN","IBCEXTRP",8,0)
 N IBREC1,IBIEN,IBINC,DIC,X,Y,DIR,IB364IEN,IBVNUM,IBSEG,STOP,POP,DTOUT,DUOUT
"RTN","IBCEXTRP",9,0)
 ;
"RTN","IBCEXTRP",10,0)
 N DPTNOFZY S DPTNOFZY=1 ; Suppress PATIENT file fuzzy lookups
"RTN","IBCEXTRP",11,0)
 S DIC="^DGCR(399,",DIC(0)="AEMQ",DIC("S")="I 234[$P(^(0),U,13)" D ^DIC
"RTN","IBCEXTRP",12,0)
 I Y<1 G EXITQ
"RTN","IBCEXTRP",13,0)
 S IBIEN=+Y,IBREC1=$G(^DGCR(399,IBIEN,0))
"RTN","IBCEXTRP",14,0)
 S IB364IEN=$$LAST364^IBCEF4(IBIEN) I +$G(IB364IEN)=0 D  G EXITQ
"RTN","IBCEXTRP",15,0)
 . W !,"There is no entry in the EDI Transmit Bill file for this bill number."
"RTN","IBCEXTRP",16,0)
 S IBVNUM=$P($G(^IBA(364,IB364IEN,0)),U,2) I +$G(IBVNUM)=0 D  G EXITQ
"RTN","IBCEXTRP",17,0)
 . W !!,"There is no batch # for this bill.  It has not been transmitted."
"RTN","IBCEXTRP",18,0)
 S IBVNUM=$P($G(^IBA(364.1,IBVNUM,0)),U)
"RTN","IBCEXTRP",19,0)
 S DIR("A")="Include Fields With No Data?: ",DIR("B")="NO",DIR(0)="YA"
"RTN","IBCEXTRP",20,0)
 W ! D ^DIR K DIR
"RTN","IBCEXTRP",21,0)
 I $D(DTOUT)!$D(DUOUT) G EXITQ
"RTN","IBCEXTRP",22,0)
 S IBINC=+Y
"RTN","IBCEXTRP",23,0)
 ;
"RTN","IBCEXTRP",24,0)
 ; IB*2*377 - esg - Ask for specific EDI segments to view
"RTN","IBCEXTRP",25,0)
 ;
"RTN","IBCEXTRP",26,0)
 W !
"RTN","IBCEXTRP",27,0)
 S DIR(0)="SA^A:All EDI Segments;S:Selected EDI Segments"
"RTN","IBCEXTRP",28,0)
 S DIR("A")="Include (A)ll or (S)elected EDI Segments?: "
"RTN","IBCEXTRP",29,0)
 S DIR("B")="All EDI Segments"
"RTN","IBCEXTRP",30,0)
 D ^DIR K DIR
"RTN","IBCEXTRP",31,0)
 I $D(DTOUT)!$D(DUOUT) G EXITQ
"RTN","IBCEXTRP",32,0)
 I Y="A" G DEV                    ; all segments, skip to device prompt
"RTN","IBCEXTRP",33,0)
 ;
"RTN","IBCEXTRP",34,0)
 W !
"RTN","IBCEXTRP",35,0)
 K IBSEG
"RTN","IBCEXTRP",36,0)
 S STOP=0
"RTN","IBCEXTRP",37,0)
 F  D  Q:STOP
"RTN","IBCEXTRP",38,0)
 . S DIR(0)="FO^3:4"
"RTN","IBCEXTRP",39,0)
 . S DIR("A")=" Select EDI Segment"
"RTN","IBCEXTRP",40,0)
 . I $D(IBSEG) S DIR("A")="Another EDI Segment"
"RTN","IBCEXTRP",41,0)
 . S DIR("?")="Enter the name of the EDI segment to include."
"RTN","IBCEXTRP",42,0)
 . D ^DIR K DIR
"RTN","IBCEXTRP",43,0)
 . I $D(DTOUT)!$D(DUOUT) S STOP=1 Q
"RTN","IBCEXTRP",44,0)
 . S Y=$$UP^XLFSTR(Y),Y=$$TRIM^XLFSTR(Y)   ; uppercase/trim spaces
"RTN","IBCEXTRP",45,0)
 . I Y="" S STOP=1 Q
"RTN","IBCEXTRP",46,0)
 . S IBSEG(Y)=""
"RTN","IBCEXTRP",47,0)
 . Q
"RTN","IBCEXTRP",48,0)
 I $D(DTOUT)!$D(DUOUT) G EXITQ
"RTN","IBCEXTRP",49,0)
 ;
"RTN","IBCEXTRP",50,0)
DEV ; - Select device
"RTN","IBCEXTRP",51,0)
 N %ZIS,ZTRTN,ZTSAVE,ZTDESC
"RTN","IBCEXTRP",52,0)
 W !
"RTN","IBCEXTRP",53,0)
 S %ZIS="QM" D ^%ZIS G:POP EXITQ
"RTN","IBCEXTRP",54,0)
 I $D(IO("Q")) D  G EXITQ
"RTN","IBCEXTRP",55,0)
 . S ZTRTN="LIST^IBCEXTRP",ZTDESC="Transmitted Bill Extract Data"
"RTN","IBCEXTRP",56,0)
 . S ZTSAVE("IB*")=""
"RTN","IBCEXTRP",57,0)
 . D ^%ZTLOAD
"RTN","IBCEXTRP",58,0)
 . W !!,$S($D(ZTSK):"Your task number "_ZTSK_" has been queued.",1:"Unable to queue this job.")
"RTN","IBCEXTRP",59,0)
 .K ZTSK,IO("Q") D HOME^%ZIS
"RTN","IBCEXTRP",60,0)
 U IO
"RTN","IBCEXTRP",61,0)
 ;
"RTN","IBCEXTRP",62,0)
LIST ; - set up array and print data
"RTN","IBCEXTRP",63,0)
 N IBPG,IBSEQ,IBPC,IBDA,IBREC,IBQUIT,IBILL,IBLINE,IBXDATA,IBERR,IBXERR,Z,Z0,Z1
"RTN","IBCEXTRP",64,0)
 D EXTRACT(IBIEN,IBVNUM,8,1)
"RTN","IBCEXTRP",65,0)
 S (IBPG,IBQUIT,IBSEQ,IBPC,IBDA,IBLINE)=0
"RTN","IBCEXTRP",66,0)
 K ^TMP($J,"IBLINES")
"RTN","IBCEXTRP",67,0)
 ;IB*2.0*211 - rely on form type instead of bill charge type
"RTN","IBCEXTRP",68,0)
 N IBFMTYP S IBFMTYP=$$FT^IBCEF(IBIEN)
"RTN","IBCEXTRP",69,0)
 S IBFMTYP=$S(IBFMTYP=2:"CMS-1500",IBFMTYP=3:"UB-04",1:"OTHER"_"("_IBFMTYP_")")
"RTN","IBCEXTRP",70,0)
 S IBILL=$S($$INPAT^IBCEF(IBIEN,1):"Inpt",1:"Oupt")_"/"_IBFMTYP
"RTN","IBCEXTRP",71,0)
 ;
"RTN","IBCEXTRP",72,0)
 I $D(^TMP("IBXERR",$J)) D  G EXITQ
"RTN","IBCEXTRP",73,0)
 . S IBERR=0 F  S IBERR=$O(^TMP("IBXERR",$J,IBERR)) Q:'IBERR  W !,$G(^TMP("IBXERR",$J,IBERR))
"RTN","IBCEXTRP",74,0)
 . Q
"RTN","IBCEXTRP",75,0)
 ;
"RTN","IBCEXTRP",76,0)
 F  S IBSEQ=$O(^IBA(364.6,"ASEQ",8,IBSEQ)) Q:'IBSEQ  I $$INCLUDE(IBSEQ) F  S IBPC=$O(^IBA(364.6,"ASEQ",8,IBSEQ,1,IBPC)) Q:'IBPC  F  S IBDA=$O(^IBA(364.6,"ASEQ",8,IBSEQ,1,IBPC,IBDA)) Q:'IBDA  D
"RTN","IBCEXTRP",77,0)
 . N IBOK,Z,IBMULT,DSP,IBDATA,PCD,SN
"RTN","IBCEXTRP",78,0)
 . S IBREC=$G(^IBA(364.6,IBDA,0))
"RTN","IBCEXTRP",79,0)
 . I $P(IBREC,U,11)=1 Q     ; calculate only field
"RTN","IBCEXTRP",80,0)
 . ;
"RTN","IBCEXTRP",81,0)
 . ; processing for piece 1 of this EDI segment to see if there is any
"RTN","IBCEXTRP",82,0)
 . ; other data that exists in this segment
"RTN","IBCEXTRP",83,0)
 . I IBPC=1 S IBOK=0 D
"RTN","IBCEXTRP",84,0)
 .. S Z=1 F  S Z=$O(^TMP("IBXDATA",$J,1,IBSEQ,1,Z)) Q:'Z  I $G(^(Z))'="" S IBOK=1 Q
"RTN","IBCEXTRP",85,0)
 .. I IBOK Q   ; data exists so include segment normally
"RTN","IBCEXTRP",86,0)
 .. S SN=$P($G(^TMP("IBXDATA",$J,1,IBSEQ,1,1)),U,1)   ; segment name
"RTN","IBCEXTRP",87,0)
 .. I SN="" S SN=$P($P(IBREC,U,10),"'",2)
"RTN","IBCEXTRP",88,0)
 .. S SN=SN_" (No Data - Record Not Sent)"
"RTN","IBCEXTRP",89,0)
 .. S $P(^TMP("IBXDATA",$J,1,IBSEQ,1,1),U,1)=SN
"RTN","IBCEXTRP",90,0)
 .. Q
"RTN","IBCEXTRP",91,0)
 . ;
"RTN","IBCEXTRP",92,0)
 . ; loop thru all multiple occurrences of this segment
"RTN","IBCEXTRP",93,0)
 . S IBMULT=0 F  S IBMULT=$O(^TMP("IBXDATA",$J,1,IBSEQ,IBMULT)) Q:'IBMULT   D
"RTN","IBCEXTRP",94,0)
 .. ;
"RTN","IBCEXTRP",95,0)
 .. ; field with no data; check user preference
"RTN","IBCEXTRP",96,0)
 .. I '$G(IBINC),$P($G(^TMP("IBXDATA",$J,1,IBSEQ,IBMULT,IBPC)),U,1)="" Q
"RTN","IBCEXTRP",97,0)
 .. ;
"RTN","IBCEXTRP",98,0)
 .. ; build display data
"RTN","IBCEXTRP",99,0)
 .. S PCD="["_IBPC_"] "      ; piece#
"RTN","IBCEXTRP",100,0)
 .. S DSP=$P(IBREC,U,10)     ; short description field
"RTN","IBCEXTRP",101,0)
 .. S IBDATA=$P($G(^TMP("IBXDATA",$J,1,IBSEQ,IBMULT,IBPC)),U,1)   ; data
"RTN","IBCEXTRP",102,0)
 .. S DSP=$J(PCD,5)_$$FO^IBCNEUT1(DSP,40)_": "_IBDATA
"RTN","IBCEXTRP",103,0)
 .. S ^TMP($J,"IBLINES",IBSEQ,IBMULT,IBPC)=DSP
"RTN","IBCEXTRP",104,0)
 .. Q
"RTN","IBCEXTRP",105,0)
 . Q
"RTN","IBCEXTRP",106,0)
 ;
"RTN","IBCEXTRP",107,0)
 S IBQUIT=0
"RTN","IBCEXTRP",108,0)
 W:$E(IOST,1,2)["C-" @IOF ; initial form feed for screen print
"RTN","IBCEXTRP",109,0)
 N IBFMTYP S IBFMTYP=$$FT^IBCEF(IBIEN)
"RTN","IBCEXTRP",110,0)
 S IBFMTYP=$S(IBFMTYP=2:"CMS-1500",IBFMTYP=3:"UB-04",1:"OTHER"_"("_IBFMTYP_")")
"RTN","IBCEXTRP",111,0)
 S IBILL=$S($$INPAT^IBCEF(IBIEN,1):"Inpt",1:"Oupt")_"/"_IBFMTYP
"RTN","IBCEXTRP",112,0)
 D HDR
"RTN","IBCEXTRP",113,0)
 S Z=0 F  S Z=$O(^TMP($J,"IBLINES",Z)) Q:'Z!IBQUIT  S Z0=0 F  S Z0=$O(^TMP($J,"IBLINES",Z,Z0)) Q:'Z0!IBQUIT  S Z1=0 F  S Z1=$O(^TMP($J,"IBLINES",Z,Z0,Z1)) Q:'Z1!IBQUIT  D  Q:IBQUIT
"RTN","IBCEXTRP",114,0)
 . I IBLINE>(IOSL-3) D HDR Q:IBQUIT
"RTN","IBCEXTRP",115,0)
 . W !,^TMP($J,"IBLINES",Z,Z0,Z1)
"RTN","IBCEXTRP",116,0)
 . S IBLINE=IBLINE+1
"RTN","IBCEXTRP",117,0)
 . I IBLINE>(IOSL-3) D HDR Q:IBQUIT
"RTN","IBCEXTRP",118,0)
 . ;
"RTN","IBCEXTRP",119,0)
 . ; end of segment add an extra line feed
"RTN","IBCEXTRP",120,0)
 . I '$O(^TMP($J,"IBLINES",Z,Z0,Z1)) W ! S IBLINE=IBLINE+1
"RTN","IBCEXTRP",121,0)
 . Q
"RTN","IBCEXTRP",122,0)
 ;
"RTN","IBCEXTRP",123,0)
 K ^TMP($J,"IBLINES")
"RTN","IBCEXTRP",124,0)
 G EXITQ
"RTN","IBCEXTRP",125,0)
 ;
"RTN","IBCEXTRP",126,0)
 ;
"RTN","IBCEXTRP",127,0)
HDR ; - Report header
"RTN","IBCEXTRP",128,0)
 N DIR,Y
"RTN","IBCEXTRP",129,0)
 I IBPG D  Q:IBQUIT
"RTN","IBCEXTRP",130,0)
 . I $E(IOST,1,2)["C-" K DIR S DIR(0)="E" D ^DIR K DIR S IBQUIT=('Y) Q:IBQUIT
"RTN","IBCEXTRP",131,0)
 . W @IOF
"RTN","IBCEXTRP",132,0)
 ;
"RTN","IBCEXTRP",133,0)
 S IBPG=IBPG+1
"RTN","IBCEXTRP",134,0)
 W !,?25,"EDI Transmitted Bill Extract Data",!,"Bill #",?11,"Type",?27,"Patient Name",?52,"SSN",?57,$$FMTE^XLFDT(DT),?71,"Page: "_IBPG
"RTN","IBCEXTRP",135,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","IBCEXTRP",136,0)
 W !,$P(IBREC1,U)_" "_"("_IBILL_")",?27,$P($G(^DPT(+$P(IBREC1,U,2),0)),U),?52,$P($G(^DPT($P(IBREC1,U,2),0)),U,9),!
"RTN","IBCEXTRP",137,0)
 S IBLINE=6
"RTN","IBCEXTRP",138,0)
 Q
"RTN","IBCEXTRP",139,0)
 ;
"RTN","IBCEXTRP",140,0)
EXITQ ; - clean up and exit
"RTN","IBCEXTRP",141,0)
 I $E(IOST,1,2)["C-",'$G(IBQUIT) K DIR S DIR(0)="E" W ! D ^DIR K DIR
"RTN","IBCEXTRP",142,0)
 K ^TMP("IBXERR",$J),^TMP("IBXDATA",$J),IBXERR
"RTN","IBCEXTRP",143,0)
 D CLEAN^DILF
"RTN","IBCEXTRP",144,0)
 Q
"RTN","IBCEXTRP",145,0)
 ;
"RTN","IBCEXTRP",146,0)
EXTRACT(IBIFN,IBBATCH,IBFORM,IBLOCAL) ; Extracts transmitted form data into global
"RTN","IBCEXTRP",147,0)
 ; ^TMP("IBXDATA",$J).  Errors are in ^TMP("IBXERR",$J,err_num)=text.
"RTN","IBCEXTRP",148,0)
 ; IBBATCH = Batch # of bill (if known), otherwise, set to 1.  This
"RTN","IBCEXTRP",149,0)
 ;          variable must be > 0 to prevent a new batch from being added
"RTN","IBCEXTRP",150,0)
 ; IBFORM = the ien of the form in file 353
"RTN","IBCEXTRP",151,0)
 ; IBLOCAL = 1 if OK to use local form, 0 if not
"RTN","IBCEXTRP",152,0)
 N IBVNUM,IBL,IBINC,IBSEG
"RTN","IBCEXTRP",153,0)
 D FORMPRE^IBCFP1
"RTN","IBCEXTRP",154,0)
 S IBVNUM=$G(IBBATCH)
"RTN","IBCEXTRP",155,0)
 S IBL=$S('$G(IBLOCAL):IBFORM,1:"") ; No local form ... set = main form
"RTN","IBCEXTRP",156,0)
 ; Get local form associated with parent, if any
"RTN","IBCEXTRP",157,0)
 I IBL="" S IBL=$S($P($G(^IBE(353,+IBFORM,2)),U,8):$P(^(2),U,8),1:IBFORM)
"RTN","IBCEXTRP",158,0)
 D SETUP^IBCE837(1)
"RTN","IBCEXTRP",159,0)
 D ROUT^IBCFP1(IBFORM,1,IBIFN,0,IBL)
"RTN","IBCEXTRP",160,0)
 Q
"RTN","IBCEXTRP",161,0)
 ;
"RTN","IBCEXTRP",162,0)
INCLUDE(IBSEQ) ; Function to determine if segment should be included or not
"RTN","IBCEXTRP",163,0)
 N OK,LZ,SEGNAME
"RTN","IBCEXTRP",164,0)
 S OK=1                   ; default is to include it
"RTN","IBCEXTRP",165,0)
 I '$D(IBSEG) G INCLX     ; if nothing in array, then include all
"RTN","IBCEXTRP",166,0)
 I '$D(^TMP("IBXDATA",$J,1,IBSEQ)) S OK=0 G INCLX        ; no data there
"RTN","IBCEXTRP",167,0)
 S LZ=+$O(^TMP("IBXDATA",$J,1,IBSEQ,""))   ; first line# found in data
"RTN","IBCEXTRP",168,0)
 S SEGNAME=$P($G(^TMP("IBXDATA",$J,1,IBSEQ,LZ,1)),U,1)   ; piece 1
"RTN","IBCEXTRP",169,0)
 S SEGNAME=$$TRIM^XLFSTR(SEGNAME)
"RTN","IBCEXTRP",170,0)
 I SEGNAME'="",'$D(IBSEG(SEGNAME)) S OK=0   ; don't include
"RTN","IBCEXTRP",171,0)
INCLX ;
"RTN","IBCEXTRP",172,0)
 Q OK
"RTN","IBCEXTRP",173,0)
 ;
"RTN","IBCNADD")
0^40^B6555779^B5277961
"RTN","IBCNADD",1,0)
IBCNADD ;ALB/AAS - ADDRESS RETRIEVAL ENGINE FOR FILE 399 ; 29-AUG-93
"RTN","IBCNADD",2,0)
 ;;2.0;INTEGRATED BILLING;**52,80,377**;21-MAR-94;Build 23
"RTN","IBCNADD",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCNADD",4,0)
 ;
"RTN","IBCNADD",5,0)
ADD(DA,IBCOB) ; -- Retrieve correct billing address for a bill, mailing address of Bill Payer
"RTN","IBCNADD",6,0)
 ;    assumes that new policy field points to valid ins. policy
"RTN","IBCNADD",7,0)
 ;    DA = ien to file 399
"RTN","IBCNADD",8,0)
 ;    IBCOB = payer sequence PST or 123 (optional)
"RTN","IBCNADD",9,0)
 ;
"RTN","IBCNADD",10,0)
 N X,Y,I,J,IB01,IB02,IBTYP,DFN,IBCNS,IBCDFN,IBCNT,IBAGAIN,IBFND,IBBILLTY,IBCHRGTY
"RTN","IBCNADD",11,0)
 S IB02=""
"RTN","IBCNADD",12,0)
 S DFN=$P($G(^DGCR(399,DA,0)),"^",2)
"RTN","IBCNADD",13,0)
 S IBBILLTY=$P($G(^DGCR(399,DA,0)),"^",5),IBCHRGTY=$P($$CHGTYPE^IBCU(DA),"^;",1)
"RTN","IBCNADD",14,0)
 ;
"RTN","IBCNADD",15,0)
 S IBCNS=+$P($G(^DGCR(399,DA,"MP")),U,1)
"RTN","IBCNADD",16,0)
 S IBCDFN=$P($G(^DGCR(399,DA,"MP")),U,2)
"RTN","IBCNADD",17,0)
 ;
"RTN","IBCNADD",18,0)
 ; If a specific payer sequence was passed in, get the ins. company and the policy ptr
"RTN","IBCNADD",19,0)
 ; No address returned for Medicare
"RTN","IBCNADD",20,0)
 I $G(IBCOB)'="" D  I $$MCRWNR^IBEFUNC(IBCNS) G MAINQ
"RTN","IBCNADD",21,0)
 . S IBCOB=$TR(IBCOB,"PST","123")
"RTN","IBCNADD",22,0)
 . S IBCNS=+$P($G(^DGCR(399,DA,"I"_IBCOB)),U,1)
"RTN","IBCNADD",23,0)
 . S IBCDFN=+$P($G(^DGCR(399,DA,"M")),U,IBCOB+11)
"RTN","IBCNADD",24,0)
 . Q
"RTN","IBCNADD",25,0)
 ;
"RTN","IBCNADD",26,0)
 I 'IBCNS G MAINQ
"RTN","IBCNADD",27,0)
 I IBCDFN S IBCNS=+$G(^DPT(+DFN,.312,+IBCDFN,0))
"RTN","IBCNADD",28,0)
 I '$D(^DIC(36,+IBCNS,0)) G MAINQ
"RTN","IBCNADD",29,0)
 ;
"RTN","IBCNADD",30,0)
 ; -- if send bill to employer and state is filled in use this
"RTN","IBCNADD",31,0)
 I +$G(^DPT(DFN,.312,+IBCDFN,2)),+$P(^(2),"^",6) S IB02=$P(^(2),"^",2,99) G MAINQ
"RTN","IBCNADD",32,0)
 ;
"RTN","IBCNADD",33,0)
MAIN ; -- determine address for company for type bill
"RTN","IBCNADD",34,0)
 ;
"RTN","IBCNADD",35,0)
 ; -- get main address
"RTN","IBCNADD",36,0)
 S IB02=$S($D(^DIC(36,+IBCNS,.11)):^(.11),1:"")
"RTN","IBCNADD",37,0)
 S IBCNT=$G(IBCNT)+1
"RTN","IBCNADD",38,0)
 ;
"RTN","IBCNADD",39,0)
 ; -- if process the same co. more than once you are in an infinite loop
"RTN","IBCNADD",40,0)
 I $D(IBCNT(IBCNS)) G MAINQ ;already processed this company  use main add
"RTN","IBCNADD",41,0)
 S IBCNT(IBCNS)=""
"RTN","IBCNADD",42,0)
 ;
"RTN","IBCNADD",43,0)
 ; -- type of charges:   Rx charges - if ins company has an rx address use it, otherwise use opt address
"RTN","IBCNADD",44,0)
 I IBCHRGTY=3 S IBTYP="R" D @IBTYP G:$D(IBFND) MAINQ I $D(IBAGAIN) K IBAGAIN G MAIN
"RTN","IBCNADD",45,0)
 ;
"RTN","IBCNADD",46,0)
 ; -- type of bill:   inpatient<3, outpatient>2
"RTN","IBCNADD",47,0)
 S IBTYP=$S(IBBILLTY<3:"I",1:"O")
"RTN","IBCNADD",48,0)
 D @IBTYP I $D(IBAGAIN) K IBAGAIN G MAIN
"RTN","IBCNADD",49,0)
 ;
"RTN","IBCNADD",50,0)
 ; -- return address
"RTN","IBCNADD",51,0)
MAINQ Q IB02
"RTN","IBCNADD",52,0)
 ;
"RTN","IBCNADD",53,0)
I ; -- see if there is an inpatient address
"RTN","IBCNADD",54,0)
 ; -- use if state is there
"RTN","IBCNADD",55,0)
 I $P($G(^DIC(36,+IBCNS,.12)),"^",5) S IB02=$P($G(^(.12)),"^",1,6)
"RTN","IBCNADD",56,0)
 ;
"RTN","IBCNADD",57,0)
 ; -- if other company processes claims start again
"RTN","IBCNADD",58,0)
 I $P($G(^DIC(36,+IBCNS,.12)),"^",7) S IBCNS=$P($G(^DIC(36,+IBCNS,.12)),"^",7) S IBAGAIN=1
"RTN","IBCNADD",59,0)
 Q
"RTN","IBCNADD",60,0)
 ;
"RTN","IBCNADD",61,0)
O ; -- see if there is an outpatient address
"RTN","IBCNADD",62,0)
 ; -- use if state is there
"RTN","IBCNADD",63,0)
 I $P($G(^DIC(36,+IBCNS,.16)),"^",5) S IB02=$P($G(^(.16)),"^",1,6)
"RTN","IBCNADD",64,0)
 ;
"RTN","IBCNADD",65,0)
 ; -- if other company processes claims start again
"RTN","IBCNADD",66,0)
 I $P($G(^DIC(36,+IBCNS,.16)),"^",7) S IBCNS=$P($G(^DIC(36,+IBCNS,.16)),"^",7) S IBAGAIN=1
"RTN","IBCNADD",67,0)
 Q
"RTN","IBCNADD",68,0)
 ;
"RTN","IBCNADD",69,0)
R ; -- see if there is an Rx address
"RTN","IBCNADD",70,0)
 ; -- use if state is there
"RTN","IBCNADD",71,0)
 I $P($G(^DIC(36,+IBCNS,.18)),"^",5) S IB02=$P($G(^(.18)),"^",1,6) S IBFND=1
"RTN","IBCNADD",72,0)
 ;
"RTN","IBCNADD",73,0)
 ; -- if other company processes claims start again
"RTN","IBCNADD",74,0)
 I $P($G(^DIC(36,+IBCNS,.18)),"^",7) S IBCNS=$P($G(^DIC(36,+IBCNS,.18)),"^",7) S IBAGAIN=1 K IBFND
"RTN","IBCNADD",75,0)
 Q
"RTN","IBCNBEE")
0^9^B44866934^B45297417
"RTN","IBCNBEE",1,0)
IBCNBEE ;ALB/ARH-Ins Buffer: add/edit existing entries in buffer ;1 Jun 97
"RTN","IBCNBEE",2,0)
 ;;2.0;INTEGRATED BILLING;**82,184,252,251,356,361,371,377**;21-MAR-94;Build 23
"RTN","IBCNBEE",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCNBEE",4,0)
 ;
"RTN","IBCNBEE",5,0)
ADD(IBSOURCE) ; add a new buffer file entry (#355.33), sets only status (0) node data
"RTN","IBCNBEE",6,0)
 N IBARR,IBERR,IBIFN,IBX I '$G(IBSOURCE) S IBSOURCE=1
"RTN","IBCNBEE",7,0)
 ;
"RTN","IBCNBEE",8,0)
 S IBARR(355.33,"+1,",.01)="NOW",IBARR(355.33,"+1,",.03)=IBSOURCE
"RTN","IBCNBEE",9,0)
 D UPDATE^DIE("E","IBARR","IBIFN","IBERR")
"RTN","IBCNBEE",10,0)
 S IBX=+$G(IBIFN(1)) I $D(IBERR) S $P(IBX,U,2)=$G(IBERR("DIERR",1,"TEXT",1))
"RTN","IBCNBEE",11,0)
 Q IBX
"RTN","IBCNBEE",12,0)
 ;
"RTN","IBCNBEE",13,0)
STATUS(IBBUFDA,STATUS,NC,NG,NP) ; edit the status node
"RTN","IBCNBEE",14,0)
 ;
"RTN","IBCNBEE",15,0)
 N IBX,IBARR,IBIFN Q:'$G(IBBUFDA)  S IBIFN=IBBUFDA_","
"RTN","IBCNBEE",16,0)
 D CHK^DIE(355.33,.04,"",$G(STATUS),.IBX) Q:IBX="^"
"RTN","IBCNBEE",17,0)
 ;
"RTN","IBCNBEE",18,0)
 S IBARR(355.33,IBIFN,.04)=STATUS I STATUS="R" S (NC,NG,NP)=0
"RTN","IBCNBEE",19,0)
 S IBARR(355.33,IBIFN,.07)=+$G(NC),IBARR(355.33,IBIFN,.08)=+$G(NG),IBARR(355.33,IBIFN,.09)=+$G(NP)
"RTN","IBCNBEE",20,0)
 D FILE^DIE("E","IBARR")
"RTN","IBCNBEE",21,0)
 Q
"RTN","IBCNBEE",22,0)
 ;
"RTN","IBCNBEE",23,0)
INS(IBBUFDA,FLDS) ; edit the insurance company portion of a buffer file entry
"RTN","IBCNBEE",24,0)
 ;
"RTN","IBCNBEE",25,0)
 N DIC,DIE,DA,DR,X,Y,IBCNEXT1
"RTN","IBCNBEE",26,0)
 I $P($G(^IBA(355.33,+$G(IBBUFDA),0)),U,4)'="E" Q
"RTN","IBCNBEE",27,0)
 I $G(FLDS)="" S FLDS="MR"
"RTN","IBCNBEE",28,0)
 ;
"RTN","IBCNBEE",29,0)
 ; ESG - 6/18/02 - SDD 5.1.4 - Usage of Auto Match when editing
"RTN","IBCNBEE",30,0)
 ;     - the insurance company name in the buffer.  Also added an
"RTN","IBCNBEE",31,0)
 ;     - input transform (see below) to clean up the data coming in.
"RTN","IBCNBEE",32,0)
 ;     - fetch the current buffer ins co name
"RTN","IBCNBEE",33,0)
 ;
"RTN","IBCNBEE",34,0)
 I FLDS="MR" S IBCNEXT1=$P($G(^IBA(355.33,IBBUFDA,20)),U,1)
"RTN","IBCNBEE",35,0)
 ;
"RTN","IBCNBEE",36,0)
 S DR=$P($T(@(FLDS_"INS")+1),";;",2,9999) Q:DR=""
"RTN","IBCNBEE",37,0)
 ;
"RTN","IBCNBEE",38,0)
 I FLDS="MR" Q:$$INSNAME(IBBUFDA)<0  S DR=$P($T(@(FLDS_"INS")+1),";;",2,9999),DR=$P(DR,";",2,99999)
"RTN","IBCNBEE",39,0)
 ;
"RTN","IBCNBEE",40,0)
 S DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR
"RTN","IBCNBEE",41,0)
 Q
"RTN","IBCNBEE",42,0)
 ;
"RTN","IBCNBEE",43,0)
GRP(IBBUFDA,FLDS) ; edit the group/plan portion of the buffer file entry
"RTN","IBCNBEE",44,0)
 ;
"RTN","IBCNBEE",45,0)
 N DIC,DIE,DA,DR,X,Y I $P($G(^IBA(355.33,+$G(IBBUFDA),0)),U,4)'="E" Q
"RTN","IBCNBEE",46,0)
 I $G(FLDS)="" S FLDS="MR"
"RTN","IBCNBEE",47,0)
 ;
"RTN","IBCNBEE",48,0)
 S DR=$P($T(@(FLDS_"GRP")+1),";;",2,9999) Q:DR=""
"RTN","IBCNBEE",49,0)
 S DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR
"RTN","IBCNBEE",50,0)
 Q
"RTN","IBCNBEE",51,0)
 ;
"RTN","IBCNBEE",52,0)
POLICY(IBBUFDA,FLDS) ; edit the patient policy portion of the buffer file entry
"RTN","IBCNBEE",53,0)
 ;
"RTN","IBCNBEE",54,0)
 N DIC,DIE,DA,DR,X,Y,IBZZ I $P($G(^IBA(355.33,+$G(IBBUFDA),0)),U,4)'="E" Q
"RTN","IBCNBEE",55,0)
 I $G(FLDS)="" S FLDS="MR"
"RTN","IBCNBEE",56,0)
 ;
"RTN","IBCNBEE",57,0)
 S DR=$P($T(@(FLDS_"POL")+1),";;",2,9999) Q:DR=""
"RTN","IBCNBEE",58,0)
 S DIE="^IBA(355.33,",DA=IBBUFDA
"RTN","IBCNBEE",59,0)
 S DIE("NO^")="BACKOUTOK" D ^DIE K DIE,DA,DR Q:$D(Y)
"RTN","IBCNBEE",60,0)
 ;
"RTN","IBCNBEE",61,0)
 I FLDS="MR" D ESGHP(IBBUFDA)
"RTN","IBCNBEE",62,0)
 Q
"RTN","IBCNBEE",63,0)
 ;
"RTN","IBCNBEE",64,0)
ESGHP(IBBUFDA) ; sponsoring employer information
"RTN","IBCNBEE",65,0)
 N DIR,DIRUT,DUOUT,DTOUT,VAOA,VAERR,VA,DFN,IB60,IBE,IBEMPST,IBREL
"RTN","IBCNBEE",66,0)
 ;
"RTN","IBCNBEE",67,0)
 ; if insured is patient or spouse, ask if insured's current employer is the plan's sponsoring employer, if yes auto stuff it
"RTN","IBCNBEE",68,0)
 I +$G(^IBA(355.33,IBBUFDA,61)) W ! S IB60=$G(^IBA(355.33,IBBUFDA,60)) D  Q:$D(DIRUT)
"RTN","IBCNBEE",69,0)
 . ; sponsoring employer is current employer?
"RTN","IBCNBEE",70,0)
 . S DFN=+IB60,IBREL=$P(IB60,U,6),VAOA("A")=$S(IBREL="01":5,IBREL="02":6,1:"") I 'DFN!(VAOA("A")="") Q
"RTN","IBCNBEE",71,0)
 . D OAD^VADPT I $G(VAOA(9))="" Q
"RTN","IBCNBEE",72,0)
 . S DIR("?")="Enter Yes if this plan is sponsored by the "_$S(IBREL="01":"patient's",1:"spouse's")_" current employer."
"RTN","IBCNBEE",73,0)
 . S DIR("?",1)="Entering Yes will result in the "_$S(IBREL="01":"patient's",1:"spouse's")_" current employer data being",DIR("?",2)="added to the policy as the Sponsoring Employer data.",DIR("?",3)=""
"RTN","IBCNBEE",74,0)
 . S DIR("A")="Current Employer "_VAOA(9)_" Sponsors this Plan",DIR("B")="No",DIR(0)="Y" D ^DIR W ! I Y'=1 Q
"RTN","IBCNBEE",75,0)
 . ;
"RTN","IBCNBEE",76,0)
 . D DELEMP(IBBUFDA) ; delete any data already contained in these fields
"RTN","IBCNBEE",77,0)
 . ;
"RTN","IBCNBEE",78,0)
 . ; if the insured's current employer sponsors the plan then stuff that employer's address into the buffer
"RTN","IBCNBEE",79,0)
 . S IBE=$S(IBREL="01":.311,1:.25),IBEMPST=$P($G(^DPT(DFN,IBE)),U,15)
"RTN","IBCNBEE",80,0)
 . S DR="61.02///"_VAOA(9)_";61.03///"_IBEMPST_";61.06///"_$E(VAOA(1),1,30)_";61.07///"_$E(VAOA(2),1,30)
"RTN","IBCNBEE",81,0)
 . S DR=DR_";61.08///"_$E(VAOA(3),1,30)_";61.09///"_$E(VAOA(4),1,20)_";61.1////"_$P(VAOA(5),U,1)
"RTN","IBCNBEE",82,0)
 . S DR=DR_";61.11////"_$P(VAOA(11),U,1)_";61.12///"_$E(VAOA(8),1,15)
"RTN","IBCNBEE",83,0)
 . S DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR
"RTN","IBCNBEE",84,0)
 ;
"RTN","IBCNBEE",85,0)
 ; if employer sponsored plan, edit buffer entry's sponsoring employer info
"RTN","IBCNBEE",86,0)
 I +$G(^IBA(355.33,IBBUFDA,61)) S DR="61.02:61.12",DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR
"RTN","IBCNBEE",87,0)
 ;
"RTN","IBCNBEE",88,0)
 ; if not employer sponsored plan, delete any existing sponsoring employer data
"RTN","IBCNBEE",89,0)
 I $D(^IBA(355.33,IBBUFDA,61)),'$G(^IBA(355.33,IBBUFDA,61)) D DELEMP(IBBUFDA)
"RTN","IBCNBEE",90,0)
 Q
"RTN","IBCNBEE",91,0)
 ;
"RTN","IBCNBEE",92,0)
DELEMP(IBBUFDA) ; delete sponsoring employer data
"RTN","IBCNBEE",93,0)
 N DIC,DIE,DA,DR,X,Y Q:'$D(^IBA(355.33,+$G(IBBUFDA),61))
"RTN","IBCNBEE",94,0)
 S DR="61.02///@;61.03///@;61.04///@;61.05///@;61.06///@;61.07///@;61.08///@;61.09///@;61.10///@;61.11///@;61.12///@"
"RTN","IBCNBEE",95,0)
 S DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR
"RTN","IBCNBEE",96,0)
 Q
"RTN","IBCNBEE",97,0)
 ;
"RTN","IBCNBEE",98,0)
INSHELP ;
"RTN","IBCNBEE",99,0)
 W !!,"------------------------ INSURANCE COMPANY INFORMATION -------------------------",!
"RTN","IBCNBEE",100,0)
 Q
"RTN","IBCNBEE",101,0)
GRPHELP ;
"RTN","IBCNBEE",102,0)
 W !!,"---------------------------- GROUP/PLAN INFORMATION ----------------------------"
"RTN","IBCNBEE",103,0)
 W !," The following data defines a specific Group or Plan provided by an Insurance "
"RTN","IBCNBEE",104,0)
 W !," Company.  This may be either a group plan with many potential members or an "
"RTN","IBCNBEE",105,0)
 W !," individual plan with a single member.",!
"RTN","IBCNBEE",106,0)
 Q
"RTN","IBCNBEE",107,0)
POLHELP ;
"RTN","IBCNBEE",108,0)
 W !!,"---------------------- POLICY AND SUBSCRIBER INFORMATION -----------------------"
"RTN","IBCNBEE",109,0)
 W !," The following data defines the subscriber specific policy information for a "
"RTN","IBCNBEE",110,0)
 W !," particular Insurance Plan.  The subscriber, the insured, and the policy holder "
"RTN","IBCNBEE",111,0)
 W !," all refer to the person who is a member of the plan and therefore holds the "
"RTN","IBCNBEE",112,0)
 W !," policy.  The patient must be covered under the plan but may not be the policy"
"RTN","IBCNBEE",113,0)
 W !," holder.",!
"RTN","IBCNBEE",114,0)
 Q
"RTN","IBCNBEE",115,0)
 ;
"RTN","IBCNBEE",116,0)
INSNAME(IBBUFDA) ;  Reset insurance company name
"RTN","IBCNBEE",117,0)
 N DR,DIE,DA,Y,X,IBX,IBNEW,IBNAME
"RTN","IBCNBEE",118,0)
 S IBX=-1
"RTN","IBCNBEE",119,0)
 S DR=20.01,DIE="^IBA(355.33,",DA=IBBUFDA
"RTN","IBCNBEE",120,0)
 D ^DIE
"RTN","IBCNBEE",121,0)
 I '$D(Y) S IBNEW=$$CHECK(IBBUFDA)
"RTN","IBCNBEE",122,0)
 I +$G(IBNEW)'<0,$G(IBNEW)'=0,$D(IBNEW) S DR=$P(DR,";",1)_"////"_IBNEW S DIE="^IBA(355.33,",DA=IBBUFDA D ^DIE K DIE,DA,DR I '$D(Y) S IBX=0
"RTN","IBCNBEE",123,0)
 ; BHS - 10/15/03 - If user entered a caret during $$CHECK still set
"RTN","IBCNBEE",124,0)
 ;                  return value to 0 so the user can edit the other
"RTN","IBCNBEE",125,0)
 ;                  INS fields
"RTN","IBCNBEE",126,0)
 I $G(IBNEW)=0!($G(IBNEW)=-1) S IBX=0
"RTN","IBCNBEE",127,0)
 Q IBX
"RTN","IBCNBEE",128,0)
 ;
"RTN","IBCNBEE",129,0)
CHECK(IBBUFDA) ; Select Insurance Company Name and Automatch
"RTN","IBCNBEE",130,0)
 ; Buffer file (#355.33), field# 20.01.
"RTN","IBCNBEE",131,0)
 ; ESG - 6/18/02 - SDD 5.1.4 - Usage of Auto Match when editing the
"RTN","IBCNBEE",132,0)
 ;       insurance company name.  Also, display the insurance company
"RTN","IBCNBEE",133,0)
 ;       name lookup/lister and the Auto Match lookup/lister.
"RTN","IBCNBEE",134,0)
 ;
"RTN","IBCNBEE",135,0)
 NEW IBNEW,IBNAME,AMLIST
"RTN","IBCNBEE",136,0)
 ;
"RTN","IBCNBEE",137,0)
 S IBNEW=0,IBNAME=$P($G(^IBA(355.33,$G(IBBUFDA),20)),U,1)
"RTN","IBCNBEE",138,0)
 I IBNAME="" G CHECKQ
"RTN","IBCNBEE",139,0)
 ;
"RTN","IBCNBEE",140,0)
 ; Perform an insurance company lookup/lister
"RTN","IBCNBEE",141,0)
 ; BHS - 10/15/03 - Removed quits when user enters a caret to quit the
"RTN","IBCNBEE",142,0)
 ;                  the ins lister or Auto Match lister
"RTN","IBCNBEE",143,0)
 S IBNEW=$$DICINS^IBCNBU1(IBNAME,1,10)
"RTN","IBCNBEE",144,0)
 I IBNEW=0!(IBNEW<0) D
"RTN","IBCNBEE",145,0)
 . I '$$AMLOOK^IBCNEUT1(IBNAME,1,.AMLIST) Q
"RTN","IBCNBEE",146,0)
 . S IBNEW=$$AMSEL^IBCNEUT1(.AMLIST)
"RTN","IBCNBEE",147,0)
 ;
"RTN","IBCNBEE",148,0)
 ; user chose a valid insurance company - possible Auto Match add
"RTN","IBCNBEE",149,0)
 I IBNEW'<0,IBNEW'=0 D AMADD^IBCNEUT6(X,IBCNEXT1)
"RTN","IBCNBEE",150,0)
 ;
"RTN","IBCNBEE",151,0)
CHECKQ Q IBNEW
"RTN","IBCNBEE",152,0)
 ;
"RTN","IBCNBEE",153,0)
MRINS ; Insurance Company fields asked of MCCR users in the Buffer Process options (all buffer ins fields 20.01-21.06)
"RTN","IBCNBEE",154,0)
 ;;20.01;20.05;20.02:20.04;21.01;I X="" S Y="@111";21.02;I X="" S Y="@111";21.03;@111;21.04:21.06
"RTN","IBCNBEE",155,0)
 ;
"RTN","IBCNBEE",156,0)
MRGRP ; Group/Plan fields asked of MCCR users in the Buffer Process options (all buffer grp fields 40.01-40.09) ;;Daou/EEN adding BIN and PCN (40.1,40.11)
"RTN","IBCNBEE",157,0)
 ;;40.01:40.03;40.1;40.11;40.09;40.04:40.08
"RTN","IBCNBEE",158,0)
 ;
"RTN","IBCNBEE",159,0)
MRPOL ; Patient Policy fields asked of MCCR users in the Buffer Process options (all buffer policy fields except ESGHP,60.05,60.06 60.02-61.01
"RTN","IBCNBEE",160,0)
 ;;60.02;60.03;60.14PT. RELATIONSHIP TO INSURED;S IBZZ=X;60.04T;I IBZZ'="18" S Y="@111";60.07///1;60.08///@;60.09///@;62.01///@;S Y="@112";@111;60.07;60.08;60.13;62.01T;@112;60.1:60.12;.03;61.01
"RTN","IBCNBEE",161,0)
 ;
"RTN","IBCNBEE",162,0)
OTINS ; Insurance Company fields asked of non-MCCR users entering buffer data from options outside IB (20.01-20.04,21.01-21.06)
"RTN","IBCNBEE",163,0)
 ;;20.01:20.04;21.01;I X="" S Y="@111";21.02;I X="" S Y="@111";21.03;@111;21.04:21.06
"RTN","IBCNBEE",164,0)
 ;
"RTN","IBCNBEE",165,0)
OTGRP ; Group/Plan fields asked of non-MCCR users entering buffer data from options outside IB (40.02,40.03,40.09) ;;Daou/EEN-adding BIN & PCN (40.1,40.11)
"RTN","IBCNBEE",166,0)
 ;;40.02;40.03;40.1;40.11;40.09
"RTN","IBCNBEE",167,0)
 ;
"RTN","IBCNBEE",168,0)
OTPOL ; Patient Policy fields asked of non-MCCR users entering buffer data from options outside IB (60.02-60.08)
"RTN","IBCNBEE",169,0)
 ;;60.02;60.03;60.14PT. RELATIONSHIP TO INSURED;S IBZZ=X;60.04T;I IBZZ'="18" S Y="@111";60.07///1;60.08///@;60.09///@;62.01///@;S Y="@112";@111;60.07;60.08;60.13;62.01T;@112
"RTN","IBCNQ")
0^10^B25492974^B25553746
"RTN","IBCNQ",1,0)
IBCNQ ;ALB/MJB - MCCR PATIENT BILLING INQUIRY ;13 JUN 88 13:52
"RTN","IBCNQ",2,0)
 ;;2.0;INTEGRATED BILLING;**51,320,377**;21-MAR-94;Build 23
"RTN","IBCNQ",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCNQ",4,0)
 ;
"RTN","IBCNQ",5,0)
 ;MAP TO DGCRNQ
"RTN","IBCNQ",6,0)
 ;
"RTN","IBCNQ",7,0)
 D HOME^%ZIS
"RTN","IBCNQ",8,0)
ASKPAT S DIC="^DGCR(399,",DIC(0)="AEMQZ",DIC("A")="Enter BILL NUMBER or PATIENT NAME: " W !! D ^DIC G:X=""!(X["^") Q
"RTN","IBCNQ",9,0)
 ;
"RTN","IBCNQ",10,0)
 S IBIFN=+Y,IBQUIT=0,IBAC=7
"RTN","IBCNQ",11,0)
VIEW ;
"RTN","IBCNQ",12,0)
 ;***
"RTN","IBCNQ",13,0)
 F I=0,"S","U","U1" S IB(I)=$G(^DGCR(399,IBIFN,I))
"RTN","IBCNQ",14,0)
 S DFN=$P(IB(0),"^",2),IBSTAT=$P(IB(0),"^",13),IBBNO=$$BN^PRCAFN(IBIFN),IBPAGE=0 S:IBBNO=-1 IBBNO=$S($D(IBIL):IBIL,1:$P(IB(0),"^"))
"RTN","IBCNQ",15,0)
 ;
"RTN","IBCNQ",16,0)
 D NOW^%DTC S Y=$E(%,1,12) D D^DIQ S IBNOW=Y,IBPT=$$PT^IBEFUNC(DFN) D HDR1
"RTN","IBCNQ",17,0)
 ;
"RTN","IBCNQ",18,0)
 S IBUN="UNSPECIFIED",IBUK="UNKNOWN USER"
"RTN","IBCNQ",19,0)
 W !,"Bill Status",?15,": ",$S(IBSTAT=1:"ENTERED/NOT REVIEWED",IBSTAT=2:"MRA REQUESTED",IBSTAT=3:"AUTHORIZED",IBSTAT=4:"PRINTED/TRANSMITTED",IBSTAT=7:"CANCELLED",1:IBUN)," - RECORD IS ",$S(IBSTAT=1:"",1:"UN"),"EDITABLE"
"RTN","IBCNQ",20,0)
 W !,"Rate Type",?15,": ",$S($P(IB(0),"^",7)="":IBUN,'$D(^DGCR(399.3,$P(IB(0),"^",7),0)):IBUN,1:$P(^DGCR(399.3,$P(IB(0),"^",7),0),"^"))
"RTN","IBCNQ",21,0)
 W:+$P(^IBE(350.9,1,1),"^",22) !,"Form Type",?15,": ",$S($P($G(^IBE(353,+$P(IB(0),"^",19),0)),"^")]"":$P(^(0),"^"),1:IBUN)
"RTN","IBCNQ",22,0)
 W:IBSTAT=7 !,"Reason Canceled",?15,": ",$S($P(IB("S"),"^",19)]"":$P(IB("S"),"^",19),1:IBUN)
"RTN","IBCNQ",23,0)
 I $$INPAT^IBCEF(IBIFN) S Y=$P(IB(0),"^",3) D D^DIQ W !!,"Admission Date : ",Y
"RTN","IBCNQ",24,0)
 E  D OPDATE
"RTN","IBCNQ",25,0)
 W !!,"Charges",?15,": " S X=$P(IB("U1"),U,1),X2="2$" D:X]"" COMMA^%DTC W $S(X]"":X,1:IBUN)
"RTN","IBCNQ",26,0)
 I $P(IB("U1"),U,2)]"" W !,"LESS Offset",?15,": " S X=$P(IB("U1"),U,2),X2="2$" D COMMA^%DTC W X,"   [",$P(IB("U1"),U,3),"]",!,"Bill Total",?15,": " S X=($P(IB("U1"),U,1)-$P(IB("U1"),U,2)),X2="2$" D COMMA^%DTC W X
"RTN","IBCNQ",27,0)
 S X=$$TPR^PRCAFN(IBIFN) I X>0 S X2="2$" D COMMA^%DTC W !,"Amount Paid",?15,": ",X
"RTN","IBCNQ",28,0)
 S X=$$STA^PRCAFN(IBIFN) I X>0 W !,"AR Status",?15,": ",$P(X,"^",2)
"RTN","IBCNQ",29,0)
 I $P(IB("U"),U)]"" S Y=$P(IB("U"),U) D D^DIQ W !!,"Statement From",?15,": ",Y S Y=$P(IB("U"),"^",2) D D^DIQ W !,"Statement To",?15,": ",Y,!
"RTN","IBCNQ",30,0)
 I $P(IB("U"),U)']"" W !!,"Statement From",?15,": ",IBUN,!,"Statement To",?15,": ",IBUN,!
"RTN","IBCNQ",31,0)
 D DISP I IBQUIT Q:IBAC[8  G Q
"RTN","IBCNQ",32,0)
 I IBSTAT<5 D NOPTF^IBCB2 I 'IBAC1 D:$Y>(IOSL-6) HDR Q:IBQUIT&(IBAC[8)  G Q:IBQUIT D NOPTF1^IBCB2
"RTN","IBCNQ",33,0)
 D PAUSE,^IBOLK1:$G(IBFULL)&('IBQUIT) Q:IBAC[8  ; Called from Outpatient Visit Date Inquiry
"RTN","IBCNQ",34,0)
 G Q:IBQUIT,ASKPAT
"RTN","IBCNQ",35,0)
 ;
"RTN","IBCNQ",36,0)
DISP ; The variable IBAC must be defined as input to this sub-routine.
"RTN","IBCNQ",37,0)
 G:'$D(IBAC) DISPQ
"RTN","IBCNQ",38,0)
 S IBUN="UNSPECIFIED",IBUK="UNKNOWN USER"
"RTN","IBCNQ",39,0)
 I IB("S")']"" W !,"Past actions of this billing record unspecified." G DISPQ
"RTN","IBCNQ",40,0)
 S IBX="Entered^^^^^^MRA Requested^^^Authorized^^First Printed^^Last Printed^^^Cancelled"
"RTN","IBCNQ",41,0)
 F I=1,7,10,12,14,17 I $P(IB("S"),U,I)]"" D:IBAC[7&($Y>(IOSL-4)) HDR Q:$S(IBAC'[7:0,1:IBQUIT)  D DISP1
"RTN","IBCNQ",42,0)
 ;
"RTN","IBCNQ",43,0)
 ;Patch 320 - Added call to retrieve claim clone history.
"RTN","IBCNQ",44,0)
 N IBCCR,IBCURR,IBNEXT,IBBCH,IBINDENT
"RTN","IBCNQ",45,0)
 S IBINDENT=0
"RTN","IBCNQ",46,0)
 D EN^IBCCR(IBIFN,.IBCCR)   ; utility to pull cloning history
"RTN","IBCNQ",47,0)
 ;
"RTN","IBCNQ",48,0)
 ; attempt to go one claim forward from the current claim
"RTN","IBCNQ",49,0)
 S IBCURR="IBCCR("_+$P(IB("S"),U,1)_","_IBIFN_")"
"RTN","IBCNQ",50,0)
 S IBNEXT=$Q(@IBCURR)
"RTN","IBCNQ",51,0)
 I IBNEXT'="" D
"RTN","IBCNQ",52,0)
 . N IBX S IBX=@IBNEXT
"RTN","IBCNQ",53,0)
 . W !,"Copied"
"RTN","IBCNQ",54,0)
 . W ?15,": ",$$FMTE^XLFDT($P(IBX,U,1),"1Z")_" by "_$P(IBX,U,3)
"RTN","IBCNQ",55,0)
 . W !,"Copied To",?15,": ",$P(IBX,U,2)
"RTN","IBCNQ",56,0)
 . S IBINDENT=1
"RTN","IBCNQ",57,0)
 . Q
"RTN","IBCNQ",58,0)
 ;
"RTN","IBCNQ",59,0)
 ; now go backwards for claim cloning history all the way back
"RTN","IBCNQ",60,0)
 S IBBCH=IBCURR
"RTN","IBCNQ",61,0)
 F  S IBBCH=$Q(@IBBCH,-1) Q:IBBCH=""  D
"RTN","IBCNQ",62,0)
 . N IBX,TS1,TS2 S IBX=@IBBCH
"RTN","IBCNQ",63,0)
 . I IBINDENT S TS1=4,TS2=19     ; set tab stops
"RTN","IBCNQ",64,0)
 . E  S TS1=0,TS2=15
"RTN","IBCNQ",65,0)
 . W !?TS1,"Copied",?TS2,": "
"RTN","IBCNQ",66,0)
 . W $$FMTE^XLFDT($P(IBX,U,1),"1Z")_" by "_$P(IBX,U,3)
"RTN","IBCNQ",67,0)
 . W !?TS1,"Copied From",?TS2,": ",$P(IBX,U,2)
"RTN","IBCNQ",68,0)
 . W !?TS1,"Reason Copied",?TS2,": ",$P(IBX,U,4)
"RTN","IBCNQ",69,0)
 . S IBINDENT=1
"RTN","IBCNQ",70,0)
 . Q
"RTN","IBCNQ",71,0)
 ;
"RTN","IBCNQ",72,0)
 I $D(^DGCR(399,IBIFN,"R","AC",1)) S IB=0 F I=0:0 S IB=$O(^DGCR(399,IBIFN,"R","AC",1,IB)) Q:'IB  D:IBAC[7&($Y>(IOSL-4)) HDR Q:$S(IBAC'[7:0,1:IBQUIT)  W !,"Returned to AR : " D RETN
"RTN","IBCNQ",73,0)
DISPQ Q
"RTN","IBCNQ",74,0)
 ;
"RTN","IBCNQ",75,0)
DISP1 W !,$P(IBX,U,I) S Y=$P(IB("S"),U,I) D D^DIQ W ?15,": ",Y,?28," by " S IBN=$P(IB("S"),U,(I+1)) W $S(IBN']"":IBUK,$D(^VA(200,IBN,0)):$P(^(0),U,1),1:IBUK)
"RTN","IBCNQ",76,0)
 Q
"RTN","IBCNQ",77,0)
 ;
"RTN","IBCNQ",78,0)
Q K DFN,IB,IBAC,IBBNO,IBN,IBNOW,IBPAGE,IBPT,IBU,IBQUIT,IBUK,IBUN,IBX,IBSTAT,IBAC1,IBIFN,IBOPD,DIC,X,X2,Y
"RTN","IBCNQ",79,0)
 Q
"RTN","IBCNQ",80,0)
 ;
"RTN","IBCNQ",81,0)
RETN I $D(^DGCR(399,IBIFN,"R",IB,0)) S IBN=^(0),Y=$P($P(IBN,"^"),".") D D^DIQ W Y,?28," by " S IBN=$P(IBN,"^",2) I IBN]"",$D(^VA(200,IBN,0)) W $P(^VA(200,IBN,0),"^")
"RTN","IBCNQ",82,0)
 Q
"RTN","IBCNQ",83,0)
 ;
"RTN","IBCNQ",84,0)
HDR D PAUSE Q:IBQUIT
"RTN","IBCNQ",85,0)
HDR1 S L="",$P(L,"=",80)="",IBPAGE=IBPAGE+1
"RTN","IBCNQ",86,0)
 W:$E(IOST,1,2)["C-"!(IBPAGE>1) @IOF
"RTN","IBCNQ",87,0)
 W $E($P(IBPT,"^"),1,20),"   ",$P(IBPT,"^",2),?38,IBBNO,?51,IBNOW,?72,"PAGE: ",IBPAGE,!,L
"RTN","IBCNQ",88,0)
 K L Q
"RTN","IBCNQ",89,0)
 ;
"RTN","IBCNQ",90,0)
OPDATE ; List Outpatient Visit Dates.
"RTN","IBCNQ",91,0)
 Q:'$O(^DGCR(399,IBIFN,"OP",0))
"RTN","IBCNQ",92,0)
 W !!,"OP Visit Dates :" S IBOPD=0
"RTN","IBCNQ",93,0)
 F I=1:1 S IBOPD=$O(^DGCR(399,IBIFN,"OP",IBOPD)) Q:'IBOPD  D
"RTN","IBCNQ",94,0)
 . W:'((I-1)#4)&(I>1) !
"RTN","IBCNQ",95,0)
 . S Y=IBOPD D D^DIQ W ?($S(I#4:I#4,1:4)*14+3),Y
"RTN","IBCNQ",96,0)
 Q
"RTN","IBCNQ",97,0)
 ;
"RTN","IBCNQ",98,0)
PAUSE Q:$E(IOST,1,2)'="C-"
"RTN","IBCNQ",99,0)
 F I=$Y:1:(IOSL-3) W !
"RTN","IBCNQ",100,0)
 S DIR(0)="E" D ^DIR K DIR I $D(DIRUT)!($D(DUOUT)) S IBQUIT=1 K DIRUT,DTOUT,DUOUT
"RTN","IBCNQ",101,0)
 Q
"RTN","IBCNSP01")
0^6^B32701738^B32694224
"RTN","IBCNSP01",1,0)
IBCNSP01 ;ALB/AAS - INSURANCE MANAGEMENT - EXPANDED POLICY  ;05-MAR-1993
"RTN","IBCNSP01",2,0)
 ;;2.0;INTEGRATED BILLING;**43,52,85,251,371,377**;21-MAR-94;Build 23
"RTN","IBCNSP01",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCNSP01",4,0)
 ;
"RTN","IBCNSP01",5,0)
 ;
"RTN","IBCNSP01",6,0)
% D SUBSC,RIDER
"RTN","IBCNSP01",7,0)
 Q
"RTN","IBCNSP01",8,0)
 ;
"RTN","IBCNSP01",9,0)
SUBSC ; -- subscriber region
"RTN","IBCNSP01",10,0)
 N OFFSET,START
"RTN","IBCNSP01",11,0)
 S START=24,OFFSET=2
"RTN","IBCNSP01",12,0)
 D SET^IBCNSP(START,OFFSET," Subscriber Information ",IORVON,IORVOFF)
"RTN","IBCNSP01",13,0)
 S Y=$P(IBCDFND,"^",6),C=$P(^DD(2.312,6,0),"^",2) D Y^DIQ
"RTN","IBCNSP01",14,0)
 D SET^IBCNSP(START+1,OFFSET," Whose Insurance: "_Y)
"RTN","IBCNSP01",15,0)
 D SET^IBCNSP(START+2,OFFSET," Subscriber Name: "_$P(IBCDFND,"^",17))
"RTN","IBCNSP01",16,0)
 S Y=$P(IBCDFND4,"^",3),C=$P(^DD(2.312,4.03,0),"^",2) D Y^DIQ
"RTN","IBCNSP01",17,0)
 D SET^IBCNSP(START+3,OFFSET,"    Relationship: "_Y)
"RTN","IBCNSP01",18,0)
 D SET^IBCNSP(START+4,OFFSET,"      Primary ID: "_$P(IBCDFND,"^",2))
"RTN","IBCNSP01",19,0)
 S Y=$P(IBCDFND,"^",20),C=$P(^DD(2.312,.2,0),"^",2) D Y^DIQ
"RTN","IBCNSP01",20,0)
 D SET^IBCNSP(START+5,OFFSET,"Coord.  Benefits: "_Y)
"RTN","IBCNSP01",21,0)
 D SET^IBCNSP(START+6,OFFSET,"Primary Provider: "_$P(IBCDFND4,"^",1))
"RTN","IBCNSP01",22,0)
 D SET^IBCNSP(START+7,OFFSET," Prim Prov Phone: "_$P(IBCDFND4,"^",2))
"RTN","IBCNSP01",23,0)
 Q
"RTN","IBCNSP01",24,0)
 ;
"RTN","IBCNSP01",25,0)
VER ; -- Entered/Verfied Region
"RTN","IBCNSP01",26,0)
 N OFFSET,START
"RTN","IBCNSP01",27,0)
 S START=$O(^TMP("IBCNSVP",$J,""),-1)+1,OFFSET=2
"RTN","IBCNSP01",28,0)
 S IB1ST("VERIFY")=START
"RTN","IBCNSP01",29,0)
 D SET^IBCNSP(START,OFFSET," User Information ",IORVON,IORVOFF)
"RTN","IBCNSP01",30,0)
 D SET^IBCNSP(START+1,OFFSET,"      Entered By: "_$E($P($G(^VA(200,+$P(IBCDFND1,"^",2),0)),"^",1),1,20))
"RTN","IBCNSP01",31,0)
 D SET^IBCNSP(START+2,OFFSET,"      Entered On: "_$$DAT1^IBOUTL(+IBCDFND1))
"RTN","IBCNSP01",32,0)
 D SET^IBCNSP(START+3,OFFSET,"Last Verified By: "_$E($P($G(^VA(200,+$P(IBCDFND1,"^",4),0)),"^",1),1,20))
"RTN","IBCNSP01",33,0)
 D SET^IBCNSP(START+4,OFFSET,"Last Verified On: "_$$DAT1^IBOUTL(+$P(IBCDFND1,"^",3)))
"RTN","IBCNSP01",34,0)
 D SET^IBCNSP(START+5,OFFSET," Last Updated By: "_$E($P($G(^VA(200,+$P(IBCDFND1,"^",6),0)),"^",1),1,20))
"RTN","IBCNSP01",35,0)
 D SET^IBCNSP(START+6,OFFSET," Last Updated On: "_$$DAT1^IBOUTL(+$P(IBCDFND1,"^",5)))
"RTN","IBCNSP01",36,0)
 D SET^IBCNSP(START+7,2," ")   ; 2 blank lines to end section
"RTN","IBCNSP01",37,0)
 D SET^IBCNSP(START+8,2," ")
"RTN","IBCNSP01",38,0)
VERQ Q
"RTN","IBCNSP01",39,0)
 ;
"RTN","IBCNSP01",40,0)
ID ; Subscriber and patient primary and secondary ID's and qualifiers
"RTN","IBCNSP01",41,0)
 NEW START,OFFSET,IBL,G,PCE,QUAL,QUAL1
"RTN","IBCNSP01",42,0)
 S G=IBCDFND5
"RTN","IBCNSP01",43,0)
 S (START,IBL)=$O(^TMP("IBCNSVP",$J,""),-1)+1,OFFSET=2
"RTN","IBCNSP01",44,0)
 S IB1ST("ID")=START
"RTN","IBCNSP01",45,0)
 D SET^IBCNSP(START,OFFSET," Insurance Company ID Numbers (use Subscriber Update Action) ",IORVON,IORVOFF)
"RTN","IBCNSP01",46,0)
 S IBL=IBL+1
"RTN","IBCNSP01",47,0)
 D SET^IBCNSP(IBL,OFFSET,"  Subscriber Primary ID: "_$P(IBCDFND,U,2))
"RTN","IBCNSP01",48,0)
 ;
"RTN","IBCNSP01",49,0)
 F PCE=3,5,7 D            ; subscriber secondary IDs
"RTN","IBCNSP01",50,0)
 . I $P(G,U,PCE)="" Q     ; no secondary ID#
"RTN","IBCNSP01",51,0)
 . S QUAL=$P(G,U,PCE-1)   ; internal qualifier code
"RTN","IBCNSP01",52,0)
 . S QUAL1=$S(QUAL="23":"Client#",QUAL="IG":"Ins. Policy#",QUAL="SY":"SSN",1:"Unknown")
"RTN","IBCNSP01",53,0)
 . S IBL=IBL+1
"RTN","IBCNSP01",54,0)
 . D SET^IBCNSP(IBL,OFFSET,"Subscriber Secondary ID: "_$P(G,U,PCE))
"RTN","IBCNSP01",55,0)
 . D SET^IBCNSP(IBL,52,"ID Qual: "_QUAL_" ("_QUAL1_")")
"RTN","IBCNSP01",56,0)
 . Q
"RTN","IBCNSP01",57,0)
 ;
"RTN","IBCNSP01",58,0)
 ; patient=subscriber so skip over patient ID# display
"RTN","IBCNSP01",59,0)
 I +$P(IBCDFND,U,16)=1 G ID1
"RTN","IBCNSP01",60,0)
 ;
"RTN","IBCNSP01",61,0)
 S IBL=IBL+1 D SET^IBCNSP(IBL,2," ")   ; blank line
"RTN","IBCNSP01",62,0)
 S IBL=IBL+1
"RTN","IBCNSP01",63,0)
 D SET^IBCNSP(IBL,OFFSET,"     Patient Primary ID: "_$P(G,U,1))
"RTN","IBCNSP01",64,0)
 ;
"RTN","IBCNSP01",65,0)
 F PCE=9,11,13 D          ; patient secondary IDs
"RTN","IBCNSP01",66,0)
 . I $P(G,U,PCE)="" Q     ; no secondary ID#
"RTN","IBCNSP01",67,0)
 . S QUAL=$P(G,U,PCE-1)   ; internal qualifier code
"RTN","IBCNSP01",68,0)
 . S QUAL1=$S(QUAL="23":"Client#",QUAL="IG":"Ins. Policy#",QUAL="SY":"SSN",1:"Unknown")
"RTN","IBCNSP01",69,0)
 . S IBL=IBL+1
"RTN","IBCNSP01",70,0)
 . D SET^IBCNSP(IBL,OFFSET,"   Patient Secondary ID: "_$P(G,U,PCE))
"RTN","IBCNSP01",71,0)
 . D SET^IBCNSP(IBL,52,"ID Qual: "_QUAL_" ("_QUAL1_")")
"RTN","IBCNSP01",72,0)
 . Q
"RTN","IBCNSP01",73,0)
 ;
"RTN","IBCNSP01",74,0)
ID1 ; end of section - 2 blank lines
"RTN","IBCNSP01",75,0)
 S IBL=IBL+1 D SET^IBCNSP(IBL,2," ")
"RTN","IBCNSP01",76,0)
 S IBL=IBL+1 D SET^IBCNSP(IBL,2," ")
"RTN","IBCNSP01",77,0)
IDQ ;
"RTN","IBCNSP01",78,0)
 Q
"RTN","IBCNSP01",79,0)
 ;
"RTN","IBCNSP01",80,0)
RIDER ; -- Personal policy riders
"RTN","IBCNSP01",81,0)
 N OFFSET,START,IBI,IBL,IBPR,IBPRD
"RTN","IBCNSP01",82,0)
 S START=$O(^TMP("IBCNSVP",$J,""),-1)+1,OFFSET=2,IBL=0
"RTN","IBCNSP01",83,0)
 D SET^IBCNSP(START,OFFSET," Personal Riders ",IORVON,IORVOFF)
"RTN","IBCNSP01",84,0)
 S IBI="" F  S IBI=$O(^IBA(355.7,"APP",DFN,IBCDFN,IBI)) Q:'IBI  S IBPR=$O(^(IBI,0)),IBPRD=+$G(^IBA(355.7,IBPR,0)),IBL=IBL+1 D
"RTN","IBCNSP01",85,0)
 . D SET^IBCNSP(START+IBL,OFFSET,"   Rider #"_IBL_": "_$$EXPAND^IBTRE(355.7,.01,IBPRD))
"RTN","IBCNSP01",86,0)
 . Q
"RTN","IBCNSP01",87,0)
 S IBL=IBL+1 D SET^IBCNSP(START+IBL,OFFSET," ")
"RTN","IBCNSP01",88,0)
 S IBL=IBL+1 D SET^IBCNSP(START+IBL,OFFSET," ")
"RTN","IBCNSP01",89,0)
 Q
"RTN","IBCNSP01",90,0)
 ;
"RTN","IBCNSP01",91,0)
AI ; -- Add ins. verification entry
"RTN","IBCNSP01",92,0)
 ;    called from ai^ibcnsp1
"RTN","IBCNSP01",93,0)
 ;
"RTN","IBCNSP01",94,0)
 ; -- see if current inpatient
"RTN","IBCNSP01",95,0)
 D INP^VADPT I +VAIN(1) D
"RTN","IBCNSP01",96,0)
 .S IBTRN=$O(^IBT(356,"AD",+VAIN(1),0))
"RTN","IBCNSP01",97,0)
 ;
"RTN","IBCNSP01",98,0)
 S IBXIFN=$O(^IBE(356.11,"ACODE",85,0))
"RTN","IBCNSP01",99,0)
 ;
"RTN","IBCNSP01",100,0)
 ; -- if not tracking id allow selecting
"RTN","IBCNSP01",101,0)
 I '$G(IBTRN) D  G:IBQUIT AIQ
"RTN","IBCNSP01",102,0)
 .W !,"You can now enter a contact and relate it to a Claims Tracking Admission entry."
"RTN","IBCNSP01",103,0)
 .S DIC("A")="Select RELATED ADMISSION DATE: "
"RTN","IBCNSP01",104,0)
 .S DIC="^IBT(356,",DIC(0)="AEQ",D="ADFN"_DFN,DIC("S")="I $P(^(0),U,5)"
"RTN","IBCNSP01",105,0)
 .D IX^DIC K DA,DR,DIC,DIE I $D(DUOUT)!($D(DTOUT)) S IBQUIT=1 Q
"RTN","IBCNSP01",106,0)
 .I +Y>1 S IBTRN=+Y
"RTN","IBCNSP01",107,0)
 ;
"RTN","IBCNSP01",108,0)
 I '$G(IBTRN) W !!,"Warning: This contact is not associated with any care in Claims Tracking.",!,"You may only edit or view this contact using this action.",!
"RTN","IBCNSP01",109,0)
 ;
"RTN","IBCNSP01",110,0)
 ; -- select date
"RTN","IBCNSP01",111,0)
 S IBOK=0,IBI=0 F  S IBI=$O(^IBT(356.2,"D",DFN,IBI)) Q:'IBI  I $P($G(^IBT(356.2,+IBI,0)),"^",4)=IBXIFN,$P($G(^(1)),"^",5)=IBCDFN S IBOK=1
"RTN","IBCNSP01",112,0)
 I IBOK D  G:IBQUIT AIQ
"RTN","IBCNSP01",113,0)
 .S DIC="^IBT(356.2,",DIC("A")="Select Contact Date: "
"RTN","IBCNSP01",114,0)
 .S X="??",DIC(0)="EQ",DIC("S")="I $P($G(^(1)),U,5)=IBCDFN,$P(^(0),U,4)=IBXIFN" ;,DLAYGO=356.2
"RTN","IBCNSP01",115,0)
 .S D="ADFN"_DFN
"RTN","IBCNSP01",116,0)
 .D IX^DIC K DIC,DR,DA,DIE,D I $D(DUOUT)!($D(DTOUT)) S IBQUIT=1
"RTN","IBCNSP01",117,0)
 ;
"RTN","IBCNSP01",118,0)
 S DIC="^IBT(356.2,",DIC("A")="Select Contact Date: ",DIC("B")="TODAY"
"RTN","IBCNSP01",119,0)
 S DIC("DR")=".02////"_$G(IBTRN)_";.04////"_IBXIFN_";.05////"_DFN_";.19////1;1.01///NOW;1.02////"_DUZ_";1.05////"_IBCDFN
"RTN","IBCNSP01",120,0)
 S DIC(0)="AEQL",DIC("S")="I $P(^(0),U,5)=DFN,$P($G(^(1)),U,5)=IBCDFN,$P(^(0),U,4)=IBXIFN",DLAYGO=356.2
"RTN","IBCNSP01",121,0)
 D ^DIC K DIC
"RTN","IBCNSP01",122,0)
 I $D(DTOUT)!($D(DUOUT))!(+Y<1) G AIQ
"RTN","IBCNSP01",123,0)
 S IBTRC=+Y
"RTN","IBCNSP01",124,0)
 I $G(IBTRC),$G(IBTRN),'$P(^IBT(356.2,+IBTRC,0),"^",2) S DA=IBTRC,DIE="^IBT(356.2,",DR=".02////"_$G(IBTRN) D ^DIE
"RTN","IBCNSP01",125,0)
 ;
"RTN","IBCNSP01",126,0)
 ; -- edit ins ver type
"RTN","IBCNSP01",127,0)
 D EDIT^IBTRCD1("[IBT INS VERIFICATION]",1)
"RTN","IBCNSP01",128,0)
AIQ Q
"RTN","IBCNSP1")
0^5^B59835347^B54597105
"RTN","IBCNSP1",1,0)
IBCNSP1 ;ALB/AAS - INSURANCE MANAGEMENT - policy actions ;22-OCT-92
"RTN","IBCNSP1",2,0)
 ;;2.0;INTEGRATED BILLING;**6,28,40,43,52,85,103,361,371,377**;21-MAR-94;Build 23
"RTN","IBCNSP1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCNSP1",4,0)
 ;;ICR#5002 for read of ^DIE input template data
"RTN","IBCNSP1",5,0)
 ;
"RTN","IBCNSP1",6,0)
% G EN^IBCNSP
"RTN","IBCNSP1",7,0)
 ;
"RTN","IBCNSP1",8,0)
EA ; -- Edit all
"RTN","IBCNSP1",9,0)
 N IBCDFN,IBTRC,IBTRN
"RTN","IBCNSP1",10,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",11,0)
 S IBCDFN=$P($G(IBPPOL),"^",4) I 'IBCDFN W !!,"Can't identify the policy!" G EAQ
"RTN","IBCNSP1",12,0)
 S IBCNSEH=1 D PAT^IBCNSEH
"RTN","IBCNSP1",13,0)
 ;
"RTN","IBCNSP1",14,0)
 D BEFORE^IBCNSEVT
"RTN","IBCNSP1",15,0)
 D PATPOL^IBCNSM32(IBCDFN)
"RTN","IBCNSP1",16,0)
 D AFTER^IBCNSEVT,^IBCNSEVT
"RTN","IBCNSP1",17,0)
 ;
"RTN","IBCNSP1",18,0)
 ; -- edit policy data
"RTN","IBCNSP1",19,0)
 D POL^IBCNSEH
"RTN","IBCNSP1",20,0)
 D EDPOL^IBCNSM3(IBCDFN)
"RTN","IBCNSP1",21,0)
 ;
"RTN","IBCNSP1",22,0)
 W !! D AI
"RTN","IBCNSP1",23,0)
 ;
"RTN","IBCNSP1",24,0)
EAQ D:$G(IBTRC) AIP^IBCNSP02(IBTRC)
"RTN","IBCNSP1",25,0)
 D BLD^IBCNSP
"RTN","IBCNSP1",26,0)
 S VALMBCK="R"
"RTN","IBCNSP1",27,0)
 Q
"RTN","IBCNSP1",28,0)
 ;
"RTN","IBCNSP1",29,0)
AB ; -- Annual Benefits
"RTN","IBCNSP1",30,0)
 S X=+$P($G(IBPPOL),"^",4),IBCNS=+$G(^DPT(DFN,.312,X,0)),IBCPOL=+$P($G(^(0)),"^",18)
"RTN","IBCNSP1",31,0)
 I 'IBCPOL W !!,"Can't identify the plan!" S VALMBCK="" G ABQ
"RTN","IBCNSP1",32,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",33,0)
 D EN^VALM("IBCNS ANNUAL BENEFITS")
"RTN","IBCNSP1",34,0)
 S VALMBCK="R"
"RTN","IBCNSP1",35,0)
ABQ Q
"RTN","IBCNSP1",36,0)
 ;
"RTN","IBCNSP1",37,0)
BU ; -- Benefits Used
"RTN","IBCNSP1",38,0)
 S IBCDFN=+$P($G(IBPPOL),"^",4),IBCNS=+$G(^DPT(DFN,.312,IBCDFN,0)),IBCPOL=+$P($G(^(0)),"^",18)
"RTN","IBCNSP1",39,0)
 I 'IBCPOL W !!,"Can't identify the plan!" S VALMBCK="" G BUQ
"RTN","IBCNSP1",40,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",41,0)
 D EN^VALM("IBCNS BENEFITS USED BY DATE")
"RTN","IBCNSP1",42,0)
 S VALMBCK="R"
"RTN","IBCNSP1",43,0)
BUQ Q
"RTN","IBCNSP1",44,0)
 ;
"RTN","IBCNSP1",45,0)
IT ; -- edit insurance type info from patient policy and plan edit
"RTN","IBCNSP1",46,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",47,0)
 N IBCDFN
"RTN","IBCNSP1",48,0)
 S IBCDFN=+$P($G(IBPPOL),"^",4),IBCPOL=+$P($G(^DPT(DFN,.312,IBCDFN,0)),"^",18)
"RTN","IBCNSP1",49,0)
 I 'IBCPOL W !!,"Can't identify the plan!" S VALMBCK="" G ITQ
"RTN","IBCNSP1",50,0)
 D ITEDIT(IBCPOL,IBCDFN)
"RTN","IBCNSP1",51,0)
ITQ S VALMBCK="R" Q
"RTN","IBCNSP1",52,0)
 ;
"RTN","IBCNSP1",53,0)
IT1 ; -- edit insurance type info from patient policy
"RTN","IBCNSP1",54,0)
 D ITEDIT(IBCPOL)
"RTN","IBCNSP1",55,0)
 S VALMBCK="R"
"RTN","IBCNSP1",56,0)
 Q
"RTN","IBCNSP1",57,0)
 ;
"RTN","IBCNSP1",58,0)
ITEDIT(IBCPOL,IBCDFN) ;Edit insurance type info once you have plan (IBCPOL)
"RTN","IBCNSP1",59,0)
 ; IBCDFN = the ifn of the policy multiple for pt in ^DPT, node .312
"RTN","IBCNSP1",60,0)
 ;          only defined for editing via patient policy
"RTN","IBCNSP1",61,0)
 G:'$G(IBCPOL) ITEDITQ
"RTN","IBCNSP1",62,0)
 D SAVE^IBCNSP3(IBCPOL)
"RTN","IBCNSP1",63,0)
 L +^IBA(355.3,+IBCPOL):5 I '$T D LOCKED^IBTRCD1 G ITEDITQ
"RTN","IBCNSP1",64,0)
 I $G(IBCDFN) S IBCNSEH=+$G(^IBE(350.9,1,4)) D POL^IBCNSEH
"RTN","IBCNSP1",65,0)
 I $P($G(^IBA(355.3,IBCPOL,0)),"^",11) W !?2,*7,"Please note that this plan is inactive!",!
"RTN","IBCNSP1",66,0)
 S DA=IBCPOL,DIE="^IBA(355.3,",DR=".05;.12;.06;.07;.08"
"RTN","IBCNSP1",67,0)
 D ^DIE K DIC,DIE,DA,DR
"RTN","IBCNSP1",68,0)
 D COMP^IBCNSP3(IBCPOL)
"RTN","IBCNSP1",69,0)
 I IBDIF D UPDATE^IBCNSP3(IBCPOL) D:$G(IBCDFN) UPDATPT^IBCNSP3(DFN,IBCDFN),BLD^IBCNSP D:'$G(IBCDFN) INIT^IBCNSC4
"RTN","IBCNSP1",70,0)
 L -^IBA(355.3,+IBCPOL)
"RTN","IBCNSP1",71,0)
ITEDITQ Q
"RTN","IBCNSP1",72,0)
 ;
"RTN","IBCNSP1",73,0)
ED ; -- Edit effective dates
"RTN","IBCNSP1",74,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",75,0)
 N IBDIF,DA,DR,DIE,DIC
"RTN","IBCNSP1",76,0)
 D BEFORE^IBCNSEVT
"RTN","IBCNSP1",77,0)
 D SAVEPT^IBCNSP3(DFN,IBCDFN)
"RTN","IBCNSP1",78,0)
 L +^DPT(DFN,.312,+$P($G(IBPPOL),"^",4)):5 I '$T D LOCKED^IBTRCD1 G EDQ
"RTN","IBCNSP1",79,0)
 D VARS^IBCNSP3
"RTN","IBCNSP1",80,0)
 S DR="8;3;1.09//;3.04"
"RTN","IBCNSP1",81,0)
 D ^DIE K DIC,DIE,DA,DR
"RTN","IBCNSP1",82,0)
 D COMPPT^IBCNSP3(DFN,IBCDFN) I IBDIF D UPDATPT^IBCNSP3(DFN,IBCDFN),UPDCLM(DFN,IBCDFN),AFTER^IBCNSEVT,^IBCNSEVT,BLD^IBCNSP
"RTN","IBCNSP1",83,0)
 L -^DPT(DFN,.312,+$P($G(IBPPOL),"^",4))
"RTN","IBCNSP1",84,0)
EDQ S VALMBCK="R" Q
"RTN","IBCNSP1",85,0)
 ;
"RTN","IBCNSP1",86,0)
VC ; -- Verify Coverage
"RTN","IBCNSP1",87,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",88,0)
 D VFY^IBCNSM2
"RTN","IBCNSP1",89,0)
 D BLD^IBCNSP
"RTN","IBCNSP1",90,0)
 S VALMBCK="R" Q
"RTN","IBCNSP1",91,0)
 ;
"RTN","IBCNSP1",92,0)
SU ; -- Subscriber Update
"RTN","IBCNSP1",93,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",94,0)
 ;Patch 40
"RTN","IBCNSP1",95,0)
 N IBDIF,DA,DR,DIC,DIE,DGSENFLG
"RTN","IBCNSP1",96,0)
 S DGSENFLG=1
"RTN","IBCNSP1",97,0)
 D SAVEPT^IBCNSP3(DFN,IBCDFN)
"RTN","IBCNSP1",98,0)
 D VARS^IBCNSP3
"RTN","IBCNSP1",99,0)
 L +^DPT(DFN,.312,+$P($G(IBPPOL),"^",4)):5 I '$T D LOCKED^IBTRCD1 G SUQ
"RTN","IBCNSP1",100,0)
 ;
"RTN","IBCNSP1",101,0)
 D EDIT(DFN,IBCDFN)   ; IB*371 - edit pat ins 2.312 subfile fields
"RTN","IBCNSP1",102,0)
 ;
"RTN","IBCNSP1",103,0)
 D COMPPT^IBCNSP3(DFN,IBCDFN)
"RTN","IBCNSP1",104,0)
 I IBDIF D UPDATPT^IBCNSP3(DFN,IBCDFN),BLD^IBCNSP
"RTN","IBCNSP1",105,0)
 L -^DPT(DFN,.312,+$P($G(IBPPOL),"^",4))
"RTN","IBCNSP1",106,0)
SUQ S VALMBCK="R" Q
"RTN","IBCNSP1",107,0)
 ;
"RTN","IBCNSP1",108,0)
IC ; -- Insurance Contact Information
"RTN","IBCNSP1",109,0)
 D FULL^VALM1 W !!
"RTN","IBCNSP1",110,0)
 N IBDIF,DA,DR,DIC,DIE,IBTRC,DIR,DUOUT,DTOUT,DIRUT,IBTRN
"RTN","IBCNSP1",111,0)
 D AI
"RTN","IBCNSP1",112,0)
 D:$G(IBTRC) AIP^IBCNSP02(IBTRC),BLD^IBCNSP
"RTN","IBCNSP1",113,0)
 S VALMBCK="R" Q
"RTN","IBCNSP1",114,0)
 Q
"RTN","IBCNSP1",115,0)
AI ; -- Add ins. verification entry
"RTN","IBCNSP1",116,0)
 N X,Y,I,J,DA,DR,DIC,DIE,DR,DD,DO,VA,VAIN,VAERR,IBQUIT,IBXIFN,IBTRN,DUOUT,IBX,IBQUIT,DTOUT
"RTN","IBCNSP1",117,0)
 Q:'$G(DFN)
"RTN","IBCNSP1",118,0)
 Q:'$G(IBCDFN)  S IBQUIT=0
"RTN","IBCNSP1",119,0)
 D AI^IBCNSP02
"RTN","IBCNSP1",120,0)
 Q
"RTN","IBCNSP1",121,0)
 ;
"RTN","IBCNSP1",122,0)
PIDEF(IBREL,FLD,IBDFN,SPDEF) ; Function to return patient file defaults
"RTN","IBCNSP1",123,0)
 ; Called from input template IBCN PATIENT INSURANCE
"RTN","IBCNSP1",124,0)
 ; IBREL = value from 2.312,4.03 field (PT. RELATIONSHIP - HIPAA)
"RTN","IBCNSP1",125,0)
 ;   FLD = field# in file 2.312
"RTN","IBCNSP1",126,0)
 ; IBDFN = patient ien to file 2
"RTN","IBCNSP1",127,0)
 ; SPDEF = spouse default flag =1 if this field should be defaulted
"RTN","IBCNSP1",128,0)
 ;         when the spouse is the policy holder
"RTN","IBCNSP1",129,0)
 ;
"RTN","IBCNSP1",130,0)
 ; The purpose is to provide a default value for the field when the
"RTN","IBCNSP1",131,0)
 ; patient and the ins. subscriber are the same.
"RTN","IBCNSP1",132,0)
 ;
"RTN","IBCNSP1",133,0)
 NEW VAL
"RTN","IBCNSP1",134,0)
 S VAL=""
"RTN","IBCNSP1",135,0)
 I +$G(IBREL)'=1,+$G(IBREL)'=18 G PIDEFX     ; patient not the insured or spouse, get out
"RTN","IBCNSP1",136,0)
 I +$G(IBREL)=1,'$G(SPDEF) G PIDEFX          ; not a field for spouse default
"RTN","IBCNSP1",137,0)
 I '$G(FLD) G PIDEFX                         ; no field# passed in
"RTN","IBCNSP1",138,0)
 I '$G(IBDFN) G PIDEFX                       ; no patient passed in
"RTN","IBCNSP1",139,0)
 ;
"RTN","IBCNSP1",140,0)
 ; Build the patient demographics area
"RTN","IBCNSP1",141,0)
 I '$D(^UTILITY("VADM",$J)) D
"RTN","IBCNSP1",142,0)
 . N VAHOW,DFN,VADM
"RTN","IBCNSP1",143,0)
 . S VAHOW=2,DFN=IBDFN D DEM^VADPT
"RTN","IBCNSP1",144,0)
 . Q
"RTN","IBCNSP1",145,0)
 ;
"RTN","IBCNSP1",146,0)
 ; Build the patient address area
"RTN","IBCNSP1",147,0)
 I '$D(^UTILITY("VAPA",$J)) D
"RTN","IBCNSP1",148,0)
 . N VAHOW,DFN,VAPA
"RTN","IBCNSP1",149,0)
 . S VAHOW=2,DFN=IBDFN,VAPA("P")="" D ADD^VADPT
"RTN","IBCNSP1",150,0)
 . Q
"RTN","IBCNSP1",151,0)
 ;
"RTN","IBCNSP1",152,0)
 I FLD=17 S VAL=$P($G(^UTILITY("VADM",$J,1)),U,1) G PIDEFX                          ; Name
"RTN","IBCNSP1",153,0)
 I FLD=3.01 S VAL=$$FMTE^XLFDT($P($G(^UTILITY("VADM",$J,3)),U,1),"5Z") G PIDEFX     ; Date of Birth
"RTN","IBCNSP1",154,0)
 I FLD=3.02 S VAL=$$EXTERNAL^DILFD(2,.325,,$P($G(^DPT(IBDFN,.32)),U,5)) G PIDEFX    ; Branch
"RTN","IBCNSP1",155,0)
 I FLD=3.05 S VAL=$P($G(^UTILITY("VADM",$J,2)),U,2) G PIDEFX                        ; SSN
"RTN","IBCNSP1",156,0)
 I FLD=3.06 S VAL=$P($G(^UTILITY("VAPA",$J,1)),U,1) G PIDEFX                        ; Street Address 1
"RTN","IBCNSP1",157,0)
 I FLD=3.07 S VAL=$P($G(^UTILITY("VAPA",$J,2)),U,1) G PIDEFX                        ; Street Address 2
"RTN","IBCNSP1",158,0)
 I FLD=3.08 S VAL=$P($G(^UTILITY("VAPA",$J,4)),U,1) G PIDEFX                        ; City
"RTN","IBCNSP1",159,0)
 I FLD=3.09 S VAL=$P($G(^UTILITY("VAPA",$J,5)),U,2) G PIDEFX                        ; State
"RTN","IBCNSP1",160,0)
 I FLD=3.1 S VAL=$P($G(^UTILITY("VAPA",$J,11)),U,2) G PIDEFX                        ; Zipcode
"RTN","IBCNSP1",161,0)
 I FLD=3.11 S VAL=$P($G(^UTILITY("VAPA",$J,8)),U,1) G PIDEFX                        ; Phone#
"RTN","IBCNSP1",162,0)
 I FLD=3.12 S VAL=$P($G(^UTILITY("VADM",$J,5)),U,2) G PIDEFX                        ; Sex
"RTN","IBCNSP1",163,0)
PIDEFX ;
"RTN","IBCNSP1",164,0)
 Q VAL
"RTN","IBCNSP1",165,0)
 ;
"RTN","IBCNSP1",166,0)
ASK(QUES,DEFLT) ; Function to ask Yes/No Question
"RTN","IBCNSP1",167,0)
 ; Returns 1 (yes), 0 (no, up-arrow, or timeout)
"RTN","IBCNSP1",168,0)
 NEW X,Y,DIR,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","IBCNSP1",169,0)
 S DIR(0)="Y",DIR("A")=$G(QUES)
"RTN","IBCNSP1",170,0)
 S DIR("B")=$S($G(DEFLT):"Yes",1:"No")
"RTN","IBCNSP1",171,0)
 W ! D ^DIR W:Y !
"RTN","IBCNSP1",172,0)
 I $D(DIRUT) S Y=0
"RTN","IBCNSP1",173,0)
ASKX ;
"RTN","IBCNSP1",174,0)
 Q Y
"RTN","IBCNSP1",175,0)
 ;
"RTN","IBCNSP1",176,0)
EDIT(IBDFN,IBCDFN,IBQUIT) ; Main call to edit data in 2.312 pat ins subfile
"RTN","IBCNSP1",177,0)
 ;  IBDFN - patient DFN
"RTN","IBCNSP1",178,0)
 ; IBCDFN - ien for patient insurance policy in subfile 2.312
"RTN","IBCNSP1",179,0)
 ; IBQUIT - Output variable.  Pass by reference.  Will be set to 1 if
"RTN","IBCNSP1",180,0)
 ;          the user entered an up-arrow, timed-out, or deleted the
"RTN","IBCNSP1",181,0)
 ;          2.312 subfile entry by entering "@" at the .01 field
"RTN","IBCNSP1",182,0)
 ; 
"RTN","IBCNSP1",183,0)
 NEW DA,DR,DIE,IBZ,IBY,X,Y,DTOUT
"RTN","IBCNSP1",184,0)
 NEW IDS,SUB,PAT,PCE,SUB1,PAT1
"RTN","IBCNSP1",185,0)
 S DA(1)=+$G(IBDFN)    ; patient IEN
"RTN","IBCNSP1",186,0)
 S DA=+$G(IBCDFN)      ; patient insurance IEN
"RTN","IBCNSP1",187,0)
 I 'DA!'DA(1) G EDITX
"RTN","IBCNSP1",188,0)
 S DIE="^DPT("_IBDFN_",.312,"
"RTN","IBCNSP1",189,0)
 ;
"RTN","IBCNSP1",190,0)
 ; Find the input template IEN for the [IBCN PATIENT INSURANCE] template
"RTN","IBCNSP1",191,0)
 S IBY=+$$FIND1^DIC(.402,,"X","IBCN PATIENT INSURANCE")
"RTN","IBCNSP1",192,0)
 I 'IBY G EDITX
"RTN","IBCNSP1",193,0)
 ;
"RTN","IBCNSP1",194,0)
 ; Build the DR array/string - ICR# 5002
"RTN","IBCNSP1",195,0)
 M DR(1)=^DIE(IBY,"DR",2)
"RTN","IBCNSP1",196,0)
 S DR=$G(DR(1,2.312))
"RTN","IBCNSP1",197,0)
 I DR="" G EDITX
"RTN","IBCNSP1",198,0)
 ;
"RTN","IBCNSP1",199,0)
 S $P(^DIE(IBY,0),U,7)=DT   ; see TEM+2^DIE  ICR# 5002
"RTN","IBCNSP1",200,0)
 ;
"RTN","IBCNSP1",201,0)
 D ^DIE     ; edit subfile data
"RTN","IBCNSP1",202,0)
 ;
"RTN","IBCNSP1",203,0)
 ; If the user entered an up-arrow, or timed-out, or deleted the entry,
"RTN","IBCNSP1",204,0)
 ; then set the output variable IBQUIT
"RTN","IBCNSP1",205,0)
 I $D(Y)!$D(DTOUT)!'$D(DA) S IBQUIT=1
"RTN","IBCNSP1",206,0)
 ;
"RTN","IBCNSP1",207,0)
 F IBZ="VADM","VAPA" K ^UTILITY(IBZ,$J)    ; cleanup scratch global
"RTN","IBCNSP1",208,0)
 ;
"RTN","IBCNSP1",209,0)
 D UPDCLM(IBDFN,IBCDFN)      ; update editable claims
"RTN","IBCNSP1",210,0)
 ;
"RTN","IBCNSP1",211,0)
 ; Cleanup any problems in the secondary ID area
"RTN","IBCNSP1",212,0)
 S IDS=$G(^DPT(IBDFN,.312,IBCDFN,5))           ; whole 5 node
"RTN","IBCNSP1",213,0)
 S (SUB,PAT)=""
"RTN","IBCNSP1",214,0)
 F PCE=3:1:8 S $P(SUB,U,PCE)=$P(IDS,U,PCE-1)   ; subscriber sec ID/qual
"RTN","IBCNSP1",215,0)
 F PCE=3:1:8 S $P(PAT,U,PCE)=$P(IDS,U,PCE+5)   ; patient sec ID/qual
"RTN","IBCNSP1",216,0)
 ; SUB and PAT are 8-piece strings with pieces 1 and 2 being nil
"RTN","IBCNSP1",217,0)
 S SUB1=$$SCRUB^IBCEF21(SUB)                   ; scrub 8-piece string
"RTN","IBCNSP1",218,0)
 S PAT1=$$SCRUB^IBCEF21(PAT)                   ; scrub 8-piece string
"RTN","IBCNSP1",219,0)
 I SUB'=SUB1 S $P(^DPT(IBDFN,.312,IBCDFN,5),U,2,7)=$P(SUB1,U,3,8)
"RTN","IBCNSP1",220,0)
 I PAT'=PAT1 S $P(^DPT(IBDFN,.312,IBCDFN,5),U,8,13)=$P(PAT1,U,3,8)
"RTN","IBCNSP1",221,0)
 ;
"RTN","IBCNSP1",222,0)
EDITX ;
"RTN","IBCNSP1",223,0)
 Q
"RTN","IBCNSP1",224,0)
 ;
"RTN","IBCNSP1",225,0)
UPDCLM(IBDFN,IBCDFN) ; Update the Insurance nodes of claims that are still editable
"RTN","IBCNSP1",226,0)
 NEW IBIFN
"RTN","IBCNSP1",227,0)
 S IBIFN=0 F  S IBIFN=$O(^DGCR(399,"C",IBDFN,IBIFN)) Q:'IBIFN  D UPDCLM^IBCNSP2(IBIFN,IBDFN,IBCDFN)
"RTN","IBCNSP1",228,0)
 ;
"RTN","IBCNSP1",229,0)
UPDCLMX ;
"RTN","IBCNSP1",230,0)
 Q
"RTN","IBCNSP1",231,0)
 ;
"RTN","IBCNSP1",232,0)
PRELCNV(CODE,FLG) ; conversion between X12, NCPDP and VistA pt. relationship codes
"RTN","IBCNSP1",233,0)
 ; CODE - code for pt. relationship to convert
"RTN","IBCNSP1",234,0)
 ; FLG - 0 for X12 -> VistA conversion, 1 for VistA -> X12 conversion, 2 - for VistA -> NCPDP conversion
"RTN","IBCNSP1",235,0)
 ; returns converted code for pt. relationship, or null if no match found
"RTN","IBCNSP1",236,0)
 N I,RES,VSTR,X12STR
"RTN","IBCNSP1",237,0)
 S VSTR="01^02^03^08^11^15^32^33^34^35^36"
"RTN","IBCNSP1",238,0)
 S X12STR="18^01^19^20^39^41^32^33^29^53^G8"
"RTN","IBCNSP1",239,0)
 S RES=""
"RTN","IBCNSP1",240,0)
 I FLG=0 F I=1:1:11 S:$P(X12STR,U,I)=CODE RES=$P(VSTR,U,I) Q:RES'=""
"RTN","IBCNSP1",241,0)
 I FLG=1 F I=1:1:11 S:$P(VSTR,U,I)=CODE RES=$P(X12STR,U,I) Q:RES'=""
"RTN","IBCNSP1",242,0)
 I FLG=2,+CODE>0 S RES=$S(+CODE>3:"04",1:CODE)
"RTN","IBCNSP1",243,0)
 Q RES
"RTN","IBCSC3")
0^4^B37249647^B36137301
"RTN","IBCSC3",1,0)
IBCSC3 ;ALB/MJB - MCCR SCREEN 3 (PAYER/MAILING ADDRESS) ;27 MAY 88 10:15
"RTN","IBCSC3",2,0)
 ;;2.0;INTEGRATED BILLING;**8,43,52,80,82,51,137,232,320,377**;21-MAR-94;Build 23
"RTN","IBCSC3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBCSC3",4,0)
 ;
"RTN","IBCSC3",5,0)
 ;MAP TO DGCRSC3
"RTN","IBCSC3",6,0)
 ;
"RTN","IBCSC3",7,0)
EN N IB,IBX,IBINS,Y,Z
"RTN","IBCSC3",8,0)
 I $D(DGRVRCAL) D ^IBCU6 K DGRVRCAL
"RTN","IBCSC3",9,0)
 D ^IBCSCU S IBSR=3,IBSR1="",IBV1="000" I IBV S IBV1="111"
"RTN","IBCSC3",10,0)
 D H^IBCSCU
"RTN","IBCSC3",11,0)
 D:$D(^DGCR(399,IBIFN,"AIC")) 3^IBCVA0
"RTN","IBCSC3",12,0)
 D:'$D(^DGCR(399,IBIFN,"AIC")) 123^IBCVA
"RTN","IBCSC3",13,0)
 D POL^IBCNSU41(DFN)
"RTN","IBCSC3",14,0)
 F I=0,"M","M1","U","U2" S IB(I)=$S($D(^DGCR(399,IBIFN,I)):(^(I)),1:"")
"RTN","IBCSC3",15,0)
 S IBOUTP=2,IBINDT=$S(+$G(IB("U")):+IB("U"),1:DT)
"RTN","IBCSC3",16,0)
 ;
"RTN","IBCSC3",17,0)
 S X=" Rate Type  : "_$S($P(IB(0),U,7)']"":IBU,$D(^DGCR(399.3,$P(IB(0),U,7),0)):$P(^(0),U),1:IBUN)
"RTN","IBCSC3",18,0)
 S Z=1,IBW=1 X IBWW W X
"RTN","IBCSC3",19,0)
 I +$P($G(^IBE(350.9,1,1)),U,22) W $J("",(42-$L(X))),"Form Type: ",$P($G(^IBE(353,+$P(IB(0),U,19),0)),U,1)
"RTN","IBCSC3",20,0)
 W !?4,"Responsible: ",$S($P(IB(0),U,11)']"":IBU,$P(IB(0),U,11)="p":"PATIENT",$P(IB(0),U,11)="i":"INSURER",1:"OTHER")
"RTN","IBCSC3",21,0)
 W ?45,"Payer Sequence: " S IBX=$P(IB(0),U,21) W $S(IBX="P":"Primary",IBX="S":"Secondary",IBX="T":"Tertiary",IBX="A":"Patient",1:"")
"RTN","IBCSC3",22,0)
 I $P(IB(0),U,11)="i" D
"RTN","IBCSC3",23,0)
 . W !?4,"Bill Payer : " S X=$G(^DGCR(399,IBIFN,"MP"))
"RTN","IBCSC3",24,0)
 . W $S(+X:$P($G(^DIC(36,+X,0)),U,1),$$MCRWNR^IBEFUNC($$CURR^IBCEF2(IBIFN)):"MRA NEEDED FROM MEDICARE",1:IBU)
"RTN","IBCSC3",25,0)
 . W ?45,"Transmit: " S Z=0,X=$$TXMT^IBCEF4(IBIFN,.Z)
"RTN","IBCSC3",26,0)
 . W $S(X:"Yes",1:"No-"_$S(Z=1:"Forced to print local",Z=2&($$WNRBILL^IBEFUNC(IBIFN)):"MRA not active",Z=2:"EDI not active",Z=3:"Rate typ transmit off",Z=4:"Ins. co transmit off",Z=5:"Failed RULE #"_$G(Z(0)),Z=6:"Invalid NDC code type",1:"??"))
"RTN","IBCSC3",27,0)
 I $P(IB(0),U,11)']"" G MAIL
"RTN","IBCSC3",28,0)
 I $P(IB(0),U,11)="p" G MAIL
"RTN","IBCSC3",29,0)
 I $P(IB(0),U,11)="o" W !?4,"Inst. Name : ",$S($P(IB("M"),U,11)']"":IBU,$D(^DIC(4,$P(IB("M"),U,11),0)):$P(^(0),U,1),1:"UNKNOWN INSTITUTION") G MAIL
"RTN","IBCSC3",30,0)
 I $P(IB(0),U,11)="i" I $D(IBDD)>1,$D(^DGCR(399,IBIFN,"AIC")) G SHW
"RTN","IBCSC3",31,0)
 D UP G LST:$D(IBDD)>1 W !?4,"Insurance : NO REIMBURSABLE INSURANCE INFORMATION ON FILE",!?17,"[Add Insurance Information by entering '1' at the prompt below]" G MAIL
"RTN","IBCSC3",32,0)
 ;
"RTN","IBCSC3",33,0)
LST N IBDTIN,IBICT
"RTN","IBCSC3",34,0)
 S IBDTIN=+$G(IB("U")),IBICT=0
"RTN","IBCSC3",35,0)
 W ! D HDR^IBCNS
"RTN","IBCSC3",36,0)
 S I=0 F  S I=$O(IBDD("S",I)) Q:'I  D  Q:IBICT'<5
"RTN","IBCSC3",37,0)
 .S IBX=0 F  S IBX=$O(IBDD("S",I,IBX)) Q:'IBX  S IBINS=$G(IBDD(IBX,0)) I IBINS'="" S IBICT=IBICT+1 D:IBICT<5 D1^IBCNS I IBICT'<5 W !,?1,"**Patient has additional insurance - use ?INS to see the entire list" Q
"RTN","IBCSC3",38,0)
 G MAIL
"RTN","IBCSC3",39,0)
LST1 W !?4,$S($D(^DIC(36,+IBDD(IBX,0),0)):$E($P(^(0),"^",1),1,20),1:"UNKNOWN") S X=$P(IBDD(IBX,0),"^",6) W ?26,$S(X="v":"VETERAN",X="s":"SPOUSE",1:"OTHER") S X=$P(IBDD(IBX,0),"^",16)
"RTN","IBCSC3",40,0)
 S X=$S(+X=1:"PATIENT",+X=2:"SPOUSE",+X=3:"CHILD",+X=8:"EMPLOYEE",+X=11:"ORGAN DONOR",+X=18:"PARENT",+X=15:"PLANTIFF",1:"UNKNOWN")
"RTN","IBCSC3",41,0)
 I X="UNKNOWN" S X1=$S($D(IBDD(IBX,0)):$P(IBDD(IBX,0),"^",6),1:""),X=$S(X1="v":"PATIENT",X1="s":"SPOUSE",1:X)
"RTN","IBCSC3",42,0)
 W ?37,X,?49 S Y=$P(IBDD(IBX,0),"^",8) X ^DD("DD") W Y,?64 S Y=$P(IBDD(IBX,0),"^",4) X ^DD("DD") W Y
"RTN","IBCSC3",43,0)
 Q
"RTN","IBCSC3",44,0)
SHW I $D(IBDD) S I="" F  S I=$O(IBDD(I)) Q:'I  D SHW1
"RTN","IBCSC3",45,0)
MAIL I $$BUFFER^IBCNBU1(DFN) W !!,?17,"***  Patient has Insurance Buffer entries  ***"
"RTN","IBCSC3",46,0)
 ;
"RTN","IBCSC3",47,0)
 S IB("M")=$S($D(^DGCR(399,IBIFN,"M")):^("M"),1:""),IB("M1")=$S($D(^DGCR(399,IBIFN,"M1")):^("M1"),1:""),IB(0)=^DGCR(399,IBIFN,0)
"RTN","IBCSC3",48,0)
 S Z=2,IBW=1 W ! X IBWW
"RTN","IBCSC3",49,0)
 N IBRAMS S IBRAMS=4.06
"RTN","IBCSC3",50,0)
 I $$FT^IBCEF(IBIFN)=3 S IBRAMS=4.08
"RTN","IBCSC3",51,0)
 S IB("RAFLAG",1)=$S($P(IB("M"),U,1)="":0,1:$$GET1^DIQ(36,$P(IB("M"),U,1),IBRAMS,"I"))
"RTN","IBCSC3",52,0)
 S IB("RAFLAG",2)=$S($P(IB("M"),U,2)="":0,1:$$GET1^DIQ(36,$P(IB("M"),U,2),IBRAMS,"I"))
"RTN","IBCSC3",53,0)
 S IB("RAFLAG",3)=$S($P(IB("M"),U,3)="":0,1:$$GET1^DIQ(36,$P(IB("M"),U,3),IBRAMS,"I"))
"RTN","IBCSC3",54,0)
 S X=0
"RTN","IBCSC3",55,0)
 I $P(IB("M1"),U,2)="",'IB("RAFLAG",1),$P(IB("M1"),U,3)="",'IB("RAFLAG",2),$P(IB("M1"),U,4)="",'IB("RAFLAG",3) S X=1
"RTN","IBCSC3",56,0)
 W " Billing Provider Secondary IDs: "
"RTN","IBCSC3",57,0)
 I X W IBUN          ; no data found, unspecified not required
"RTN","IBCSC3",58,0)
 I 'X D              ; data found, display below
"RTN","IBCSC3",59,0)
 . W !?5,"Primary Payer: ",$S($P(IB("M1"),U,2)]"":$P(IB("M1"),U,2),IB("RAFLAG",1):"ATT/REND ID",1:"")
"RTN","IBCSC3",60,0)
 . W !?5,"Secondary Payer: ",$S($P(IB("M1"),U,3)]"":$P(IB("M1"),U,3),IB("RAFLAG",2):"ATT/REND ID",1:"")
"RTN","IBCSC3",61,0)
 . W ?46,"Tertiary Payer: ",$S($P(IB("M1"),U,4)]"":$P(IB("M1"),U,4),IB("RAFLAG",3):"ATT/REND ID",1:"")
"RTN","IBCSC3",62,0)
 . Q
"RTN","IBCSC3",63,0)
 ;
"RTN","IBCSC3",64,0)
 S Z=3,IBW=1 W ! X IBWW
"RTN","IBCSC3",65,0)
 W " Mailing Address : "
"RTN","IBCSC3",66,0)
 S X=+$G(^DGCR(399,IBIFN,"MP"))
"RTN","IBCSC3",67,0)
 I 'X,$$MCRWNR^IBEFUNC(+$$CURR^IBCEF2(IBIFN)) S X=+$$CURR^IBCEF2(IBIFN)
"RTN","IBCSC3",68,0)
 I X,+$G(^DIC(36,X,3)) S I=$P(^(3),U,$S($$FT^IBCEF(IBIFN)=2:2,1:4)) W ?56,"Electronic ID: ",$S(I'="":I,1:"<NONE>")
"RTN","IBCSC3",69,0)
 S X="" I IB("M")]"" F I=4:1:9 Q:X]""  S X=$P(IB("M"),"^",I)
"RTN","IBCSC3",70,0)
 I X']"" W !?4,"NO MAILING ADDRESS HAS BEEN SPECIFIED!",?45,$$UP1,!?4,"Send Bill to PAYER listed above." G ENDSCR
"RTN","IBCSC3",71,0)
 S X=IB("M") W !,?4,$S($P(X,"^",4)]"":$P(X,"^",4),1:"'MAIL TO' PERSON/PLACE UNSPECIFIED"),?45,$$UP1
"RTN","IBCSC3",72,0)
 W !?4,$S($P(X,"^",5)]"":$P(X,"^",5),1:"STREET ADDRESS UNSPECIFIED") W:$P(X,"^",6)]"" ", ",$P(X,"^",6)
"RTN","IBCSC3",73,0)
 W ! W:$P(IB("M1"),"^",1)]"" ?4,$P(IB("M1"),"^",1),", "
"RTN","IBCSC3",74,0)
 W ?4,$S($P(X,"^",7)]"":$P(X,"^",7),1:"CITY UNSPECIFIED"),", ",$S($D(^DIC(5,+$P(X,"^",8),0)):$P(^(0),"^",2),1:"STATE UNSPECIFIED"),"  ",$S($P(X,"^",9)]"":$P(X,"^",9),1:"ZIP UNSPECIFIED")
"RTN","IBCSC3",75,0)
 ;
"RTN","IBCSC3",76,0)
ENDSCR K IBADI,IBDD,IBOUTP,IBINDT,I,X,X1
"RTN","IBCSC3",77,0)
 G ^IBCSCP
"RTN","IBCSC3",78,0)
 ;
"RTN","IBCSC3",79,0)
SHW1 S X=IBDD(I,0),Z=$G(^DIC(36,+X,0))
"RTN","IBCSC3",80,0)
 W !!?4,"Ins ",I,": " W $E($S($P(Z,U,1)'="":$P(Z,U,1),1:IBU),1,16)
"RTN","IBCSC3",81,0)
 I $P(Z,U,2)="N" W ?30,"WILL NOT REIMBURSE"
"RTN","IBCSC3",82,0)
 W ?51,"Policy #: ",$E($S($P(X,"^",2)]"":$P(X,"^",2),1:IBU),1,18)
"RTN","IBCSC3",83,0)
 W !?4,"Grp #: ",$E($S($P(X,"^",3)]"":$P(X,"^",3),1:IBU),1,16)
"RTN","IBCSC3",84,0)
 W ?30,"Whose: ",$S($P(X,"^",6)="v":"VETERAN",$P(X,"^",6)="s":"SPOUSE",1:"OTHER")
"RTN","IBCSC3",85,0)
 W ?51,"Rel to Insd: ",IBIR(I)
"RTN","IBCSC3",86,0)
 W !?4,"Grp Nm: ",$E($S($P(X,"^",15)]"":$P(X,"^",15),1:IBU),1,16)
"RTN","IBCSC3",87,0)
 W ?30,"Insd Sex: ",$S($D(IBISEX(I)):IBISEX(I),1:IBU)
"RTN","IBCSC3",88,0)
 W ?51,"Insured: ",$E($P(X,"^",17),1,19)
"RTN","IBCSC3",89,0)
 Q
"RTN","IBCSC3",90,0)
 ;
"RTN","IBCSC3",91,0)
UP K IBDD D ALL^IBCNS1(DFN,"IBDD",2,IBINDT,1)
"RTN","IBCSC3",92,0)
 I $D(IBDD("S",.5)) D  ; At least 1 MCR WNR insurance policy exists
"RTN","IBCSC3",93,0)
 . ;try to put correct part (A for institution and B for facility)
"RTN","IBCSC3",94,0)
 . N Z,IBAB
"RTN","IBCSC3",95,0)
 . S IBAB=$S($$FT^IBCEF(IBIFN)=3:"A",1:"B")
"RTN","IBCSC3",96,0)
 . S Z=0 F  S Z=$O(IBDD("S",.5,Z)) Q:'Z  D
"RTN","IBCSC3",97,0)
 .. I $P($G(IBDD(Z,355.3)),U,14)=IBAB S IBDD("S",.1,Z,0)="" K IBDD("S",.5,Z)
"RTN","IBCSC3",98,0)
 Q
"RTN","IBCSC3",99,0)
 ;
"RTN","IBCSC3",100,0)
UP1() ;check if patient has medicare so can print a flag for the user
"RTN","IBCSC3",101,0)
 N IBDD,IBX,IBY S IBY="" D ALL^IBCNS1(DFN,"IBDD",2,IBINDT)
"RTN","IBCSC3",102,0)
 S IBX=0 F  S IBX=$O(IBDD(IBX)) Q:'IBX  I $P($G(IBDD(IBX,355.3)),U,9)=33 S IBY="(Patient has Medicare)"
"RTN","IBCSC3",103,0)
 Q IBY
"RTN","IBCSC3",104,0)
 ;IBCSC3
"RTN","IBJPS")
0^2^B5270103^B5288376
"RTN","IBJPS",1,0)
IBJPS ;ALB/MAF,ARH - IBSP IB SITE PARAMETER SCREEN ;22-DEC-1995
"RTN","IBJPS",2,0)
 ;;2.0;INTEGRATED BILLING;**39,52,70,115,143,51,137,161,155,320,348,349,377**;21-MAR-94;Build 23
"RTN","IBJPS",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBJPS",4,0)
 ;
"RTN","IBJPS",5,0)
EN ; -- main entry point for IBJP IB SITE PARAMETERS, display IB site parameters
"RTN","IBJPS",6,0)
 D EN^VALM("IBJP IB SITE PARAMETERS")
"RTN","IBJPS",7,0)
 Q
"RTN","IBJPS",8,0)
 ;
"RTN","IBJPS",9,0)
HDR ; -- header code
"RTN","IBJPS",10,0)
 S VALMHDR(1)="Only authorized persons may edit this data."
"RTN","IBJPS",11,0)
 Q
"RTN","IBJPS",12,0)
 ;
"RTN","IBJPS",13,0)
INIT ; -- init variables and list array
"RTN","IBJPS",14,0)
 K ^TMP("IBJPS",$J),^TMP("IBJPSAX",$J)
"RTN","IBJPS",15,0)
 D BLD^IBJPS1
"RTN","IBJPS",16,0)
 Q
"RTN","IBJPS",17,0)
 ;
"RTN","IBJPS",18,0)
HELP ; -- help code
"RTN","IBJPS",19,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBJPS",20,0)
 Q
"RTN","IBJPS",21,0)
 ;
"RTN","IBJPS",22,0)
EXIT ; -- exit code
"RTN","IBJPS",23,0)
 K ^TMP("IBJPS",$J),^TMP("IBJPSAX",$J)
"RTN","IBJPS",24,0)
 D CLEAR^VALM1
"RTN","IBJPS",25,0)
 Q
"RTN","IBJPS",26,0)
 ;
"RTN","IBJPS",27,0)
NXEDIT ; -- IBJP IB SITE PARAMETER EDIT ACTION (EP): Select data set to edit, do edit
"RTN","IBJPS",28,0)
 N VALMY,IBSELN,IBSET
"RTN","IBJPS",29,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","IBJPS",30,0)
 I $D(VALMY) S IBSELN=0 F  S IBSELN=$O(VALMY(IBSELN)) Q:'IBSELN  D
"RTN","IBJPS",31,0)
 . S IBSET=$P($G(^TMP("IBJPSAX",$J,IBSELN)),U,1) Q:'IBSET
"RTN","IBJPS",32,0)
 . D EDIT(IBSET)
"RTN","IBJPS",33,0)
 S VALMBCK="R"
"RTN","IBJPS",34,0)
 Q
"RTN","IBJPS",35,0)
 ;
"RTN","IBJPS",36,0)
EDIT(IBSET) ; edit IB Site Parameters
"RTN","IBJPS",37,0)
 D FULL^VALM1
"RTN","IBJPS",38,0)
 I IBSET'="" S DR=$P($T(@IBSET),";;",2,999)
"RTN","IBJPS",39,0)
 I DR'="" S DIE="^IBE(350.9,",DA=1 D ^DIE K DA,DR,DIE,DIC,X,Y
"RTN","IBJPS",40,0)
 D INIT^IBJPS S VALMBCK="R"
"RTN","IBJPS",41,0)
 Q
"RTN","IBJPS",42,0)
 ;
"RTN","IBJPS",43,0)
1 ;;.09;.13;.14
"RTN","IBJPS",44,0)
2 ;;1.2;.15;.11;.12;7.04
"RTN","IBJPS",45,0)
3 ;;1.09;1.07;2.07
"RTN","IBJPS",46,0)
4 ;;4.04;6.25;6.24
"RTN","IBJPS",47,0)
5 ;;.02;1.14;1.25;1.08
"RTN","IBJPS",48,0)
6 ;;1.23;1.16;1.22;1.19;1.15;1.17
"RTN","IBJPS",49,0)
7 ;;1.33;1.32;1.31;1.27
"RTN","IBJPS",50,0)
8 ;;1.29;1.3;1.18;1.28
"RTN","IBJPS",51,0)
9 ;;1.01;1.02;1.05
"RTN","IBJPS",52,0)
10 ;;2.12;2.1;2.02;2.03;2.04;2.05;2.06;2.01
"RTN","IBJPS",53,0)
11 ;;2.08;2.09
"RTN","IBJPS",54,0)
12 ;;9.01;9.02;9.03;9.11;9.12;9.13;9.14;9.15
"RTN","IBJPS",55,0)
13 ;;10.02;10.03;10.04;10.05;D INIT^IBATFILE
"RTN","IBJPS",56,0)
14 ;;2.11;8.01;8.09;8.03;8.06;8.04;8.07;8.02;8.12T;8.11T
"RTN","IBJPS",57,0)
15 ;;50.01;50.02;50.05;50.06;50.03;50.04;50.07
"RTN","IBJPS",58,0)
 ;
"RTN","IBJPS",59,0)
 ;
"RTN","IBJPS",60,0)
ADD(IBLN,LNG,ARR) ; output array of address in X, line length=LNG
"RTN","IBJPS",61,0)
 N IBCNT,IBI,IBY,IBX,IBZ K ARR S IBCNT=1
"RTN","IBJPS",62,0)
 F IBI=2:1:4 S IBY=$P(IBLN,U,IBI) I IBY'="" D  S ARR(IBCNT)=IBY
"RTN","IBJPS",63,0)
 . S IBX=$G(ARR(IBCNT)) I IBI=4 S IBY=$P($G(^DIC(5,+IBY,0)),U,2)_" "_$P(IBLN,U,5)
"RTN","IBJPS",64,0)
 . S IBZ=$S(IBX'="":IBX_", ",1:"")_IBY I $L(IBZ)'>LNG S IBY=IBZ Q
"RTN","IBJPS",65,0)
 . S IBCNT=IBCNT+1
"RTN","IBJPS",66,0)
 Q
"RTN","IBJPS2")
0^3^B47271248^B48618964
"RTN","IBJPS2",1,0)
IBJPS2 ;ALB/MAF,ARH - IBSP IB SITE PARAMETER BUILD (cont) ;22-DEC-1995
"RTN","IBJPS2",2,0)
 ;;2.0;INTEGRATED BILLING;**39,52,115,143,51,137,161,155,320,348,349,377**;21-MAR-94;Build 23
"RTN","IBJPS2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBJPS2",4,0)
 ;
"RTN","IBJPS2",5,0)
BLD2 ; - continue build screen array for IB parameters
"RTN","IBJPS2",6,0)
 ;
"RTN","IBJPS2",7,0)
 N Z,Z0
"RTN","IBJPS2",8,0)
 D RIGHT(1,1,1) ; - facility/med center  (new line for each)
"RTN","IBJPS2",9,0)
 S IBLN=$$SET("Medical Center",$$EXSET^IBJU1($P(IBPD0,U,2),350.9,.02),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",10,0)
 S IBLN=$$SET("MAS Service",$$EXSET^IBJU1($P(IBPD1,U,14),350.9,1.14),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",11,0)
 ;
"RTN","IBJPS2",12,0)
 D LEFT(2)
"RTN","IBJPS2",13,0)
 S IBLN=$$SET("Default Division",$$EXSET^IBJU1($P(IBPD1,U,25),350.9,1.25),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",14,0)
 S IBLN=$$SET("Billing Supervisor",$$EXSET^IBJU1($P(IBPD1,U,8),350.9,1.08),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",15,0)
 ;
"RTN","IBJPS2",16,0)
 D RIGHT(1,1,1)
"RTN","IBJPS2",17,0)
 S IBLN=$$SET("Initiator Authorize",$$YN(+$P(IBPD1,U,23)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",18,0)
 S IBLN=$$SET("Ask HINQ in MCCR",$$YN(+$P(IBPD1,U,16)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",19,0)
 S IBLN=$$SET("Multiple Form Types",$$YN(+$P(IBPD1,U,22)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",20,0)
 ;
"RTN","IBJPS2",21,0)
 D LEFT(2)
"RTN","IBJPS2",22,0)
 S IBLN=$$SET("Xfer Proc to Sched",$$YN(+$P(IBPD1,U,19)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",23,0)
 S IBLN=$$SET("Use Non-PTF Codes",$$YN(+$P(IBPD1,U,15)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",24,0)
 S IBLN=$$SET("Use OP CPT screen",$$YN(+$P(IBPD1,U,17)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",25,0)
 ;
"RTN","IBJPS2",26,0)
 ; IB patch 349 for UB-04 claim form and parameters
"RTN","IBJPS2",27,0)
 D RIGHT(1,1,1)
"RTN","IBJPS2",28,0)
 S IBLN=$$SET("UB-04 Print IDs",$$EXSET^IBJU1($P(IBPD1,U,33),350.9,1.33),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",29,0)
 S IBLN=$$SET("CMS-1500 Print IDs",$$EXSET^IBJU1($P(IBPD1,U,32),350.9,1.32),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",30,0)
 ;
"RTN","IBJPS2",31,0)
 D LEFT(2)
"RTN","IBJPS2",32,0)
 S IBLN=$$SET("UB-04 Address Col",$P(IBPD1,U,31),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",33,0)
 S IBLN=$$SET("CMS-1500 Addr Col",$P(IBPD1,U,27),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",34,0)
 ;
"RTN","IBJPS2",35,0)
 D RIGHT(1,1,1)
"RTN","IBJPS2",36,0)
 S IBLN=$$SET("Default RX DX Cd",$$EXSET^IBJU1($P(IBPD1,U,29),350.9,1.29),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",37,0)
 S IBLN=$$SET("Default RX CPT Cd",$$EXSET^IBJU1($P(IBPD1,U,30),350.9,1.30),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",38,0)
 ;
"RTN","IBJPS2",39,0)
 D LEFT(2)
"RTN","IBJPS2",40,0)
 S IBLN=$$SET("Default ASC Rev Cd",$$EXSET^IBJU1($P(IBPD1,U,18),350.9,1.18),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",41,0)
 S IBLN=$$SET("Default RX Rev Cd",$$EXSET^IBJU1($P(IBPD1,U,28),350.9,1.28),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",42,0)
 ;
"RTN","IBJPS2",43,0)
 D RIGHT(1,1,1)
"RTN","IBJPS2",44,0)
 S IBLN=$$SET("Bill Signer Name","<No longer used>",IBLN,IBLR,IBSEL)
"RTN","IBJPS2",45,0)
 S IBLN=$$SET("Bill Signer Title","<No longer used>",IBLN,IBLR,IBSEL)
"RTN","IBJPS2",46,0)
 ;
"RTN","IBJPS2",47,0)
 D LEFT(2)
"RTN","IBJPS2",48,0)
 S IBLN=$$SET("Federal Tax #",$P(IBPD1,U,5),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",49,0)
 ;
"RTN","IBJPS2",50,0)
 D RIGHT(3,1,1) ; - Remittance/Agent Cashier Address
"RTN","IBJPS2",51,0)
 S IBLN=$$SET("Billing Facility is Another Facility",$$EXPAND^IBTRE(350.9,2.12,+$P(IBPD2,U,12)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",52,0)
 S IBLN=$$SET("Billing Facility Name",$P(IBPD2,U,10),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",53,0)
 D ADD^IBJPS(IBPD2,IBSW(3),.IBX) D  K IBX
"RTN","IBJPS2",54,0)
 . S IBT="Remittance Address",IBX=0 F  S IBX=$O(IBX(IBX)) Q:'IBX  D
"RTN","IBJPS2",55,0)
 .. S IBLN=$$SET(IBT,IBX(IBX),IBLN,IBLR,IBSEL),IBT=""
"RTN","IBJPS2",56,0)
 S IBLN=$$SET("Phone",$P(IBPD2,U,6),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",57,0)
 ;
"RTN","IBJPS2",58,0)
 D RIGHT(3,1,1)
"RTN","IBJPS2",59,0)
 S IBLN=$$SET("Inpt Health Summary",$$EXSET^IBJU1($P(IBPD2,U,8),350.9,2.08),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",60,0)
 S IBLN=$$SET("Opt Health Summary",$$EXSET^IBJU1($P(IBPD2,U,9),350.9,2.09),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",61,0)
 ;
"RTN","IBJPS2",62,0)
 D RIGHT(5,1,1)
"RTN","IBJPS2",63,0)
 S IBLN=$$SET("Rx Billing Port",$P(IBPD9,U),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",64,0)
 S IBLN=$$SET("AWP Update Port",$P(IBPD9,U,2),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",65,0)
 S IBLN=$$SET("TCP/IP Address",$P(IBPD9,U,3),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",66,0)
 S IBLN=$$SET("Task UCI/VOL",$P(IBPD9,U,11),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",67,0)
 S IBLN=$$SET("AWP Charge Set",$$EXSET^IBJU1($P(IBPD9,U,12),350.9,9.12),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",68,0)
 S IBLN=$$SET("Prescriber ID",$P(IBPD9,U,13),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",69,0)
 S IBLN=$$SET("DEA vs Presc.ID",$$YN($P(IBPD9,U,14)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",70,0)
 S IBLN=$$SET("Calc comp code",$$YN($P(IBPD9,U,15)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",71,0)
 ;
"RTN","IBJPS2",72,0)
 D LEFT(6)
"RTN","IBJPS2",73,0)
 S IBLN=$$SET("Prim Billing Task",$P(IBPD9,U,4),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",74,0)
 S IBLN=$$SET("Sec Billing Task",$P(IBPD9,U,5),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",75,0)
 S IBLN=$$SET("Prim AWP Upd Task",$P(IBPD9,U,6),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",76,0)
 S IBLN=$$SET("Sec AWP Upd Task",$P(IBPD9,U,7),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",77,0)
 S IBLN=$$SET("Task Started",$$DAT1^IBOUTL($P(IBPD9,U,8),1),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",78,0)
 S IBLN=$$SET("Task Last Ran",$$DAT1^IBOUTL($P(IBPD9,U,9),1),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",79,0)
 S IBLN=$$SET("Shutdown Tasks?",$$YN($P(IBPD9,U,10)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",80,0)
 ;
"RTN","IBJPS2",81,0)
 ; transfer pricing
"RTN","IBJPS2",82,0)
 D RIGHT(1,1,1)
"RTN","IBJPS2",83,0)
 S IBLN=$$SET("Inpatient TP Active ",$$YN(+$P(IBPD10,U,2)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",84,0)
 S IBLN=$$SET("Outpatient TP Active",$$YN(+$P(IBPD10,U,3)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",85,0)
 S IBLN=$$SET("Pharmacy TP Active  ",$$YN(+$P(IBPD10,U,4)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",86,0)
 S IBLN=$$SET("Prosthetic TP Active",$$YN(+$P(IBPD10,U,5)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",87,0)
 ;
"RTN","IBJPS2",88,0)
 ; EDI/MRA parameters
"RTN","IBJPS2",89,0)
 D RIGHT(7,1,1)
"RTN","IBJPS2",90,0)
 N IBZ S IBZ=$P(IBPD8,U,3)
"RTN","IBJPS2",91,0)
 S IBLN=$$SET(" EDI/MRA Activated",$$EXSET^IBJU1(+$P(IBPD8,U,10),350.9,8.1),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",92,0)
 S IBLN=$$SET(" EDI Contact Phone",$P(IBPD2,U,11),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",93,0)
 S IBLN=$$SET(" EDI 837 Live Transmit Queue",$P(IBPD8,U),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",94,0)
 S IBLN=$$SET(" EDI 837 Test Transmit Queue",$P(IBPD8,U,9),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",95,0)
 S IBLN=$$SET(" Auto-Txmt Bill Frequency",$S(IBZ:"Every"_$S(IBZ>1:" "_$P(IBPD8,U,3),1:""),1:"")_$S(IBZ:" Day"_$S(IBZ=1:"",1:"s"),1:"Never Run"),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",96,0)
 S IBLN=$$SET(" Hours To Auto-Transmit",$P(IBPD8,U,6),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",97,0)
 S IBLN=$$SET(" Max # Bills Per Batch",$P(IBPD8,U,4),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",98,0)
 S IBLN=$$SET(" Only Allow 1 Ins Co/Claim Batch?",$$EXPAND^IBTRE(350.9,8.07,+$P(IBPD8,U,7)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",99,0)
 S IBLN=$$SET(" Last Auto-Txmt Run Date",$$DATE^IBJU1($P(IBPD8,U,5)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",100,0)
 S IBLN=$$SET(" Days To Wait To Purge Msgs",$P(IBPD8,U,2),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",101,0)
 S IBLN=$$SET(" Allow MRA Processing?",$$YN(+$P(IBPD8,U,12)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",102,0)
 S IBLN=$$SET(" Enable Automatic MRA Processing?",$$YN(+$P(IBPD8,U,11)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",103,0)
 ;
"RTN","IBJPS2",104,0)
 ; Ingenix ClaimsManager Information
"RTN","IBJPS2",105,0)
 D RIGHT(9,1,1)
"RTN","IBJPS2",106,0)
 S IBLN=$$SET("Are we using ClaimsManager?",$$YN(+$P(IBPD50,U,1)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",107,0)
 S IBLN=$$SET("Is ClaimsManager working OK?",$$YN(+$P(IBPD50,U,2)),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",108,0)
 S IBLN=$$SET("ClaimsManager TCP/IP Address",$P(IBPD50,U,5),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",109,0)
 S IBCISOCK=$O(^IBE(350.9,1,50.06,"B",""))
"RTN","IBJPS2",110,0)
 S IBLN=$$SET("ClaimsManager TCP/IP Ports",IBCISOCK,IBLN,IBLR,IBSEL)
"RTN","IBJPS2",111,0)
 F  S IBCISOCK=$O(^IBE(350.9,1,50.06,"B",IBCISOCK)) Q:IBCISOCK=""  D
"RTN","IBJPS2",112,0)
 . S IBLN=$$SET("",IBCISOCK,IBLN,IBLR,IBSEL)
"RTN","IBJPS2",113,0)
 . Q
"RTN","IBJPS2",114,0)
 S IBLN=$$SET("General Error MailGroup",$$EXSET^IBJU1($P(IBPD50,U,3),350.9,50.03),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",115,0)
 S IBLN=$$SET("Communication Error MailGroup",$$EXSET^IBJU1($P(IBPD50,U,4),350.9,50.04),IBLN,IBLR,IBSEL)
"RTN","IBJPS2",116,0)
 S IBCIMFLG=$$EXTERNAL^DILFD(350.9,50.07,"",$P(IBPD50,U,7))
"RTN","IBJPS2",117,0)
 I IBCIMFLG="" S IBCIMFLG="PRIORITY"
"RTN","IBJPS2",118,0)
 S IBLN=$$SET("MailMan Messages",IBCIMFLG,IBLN,IBLR,IBSEL)
"RTN","IBJPS2",119,0)
 ;
"RTN","IBJPS2",120,0)
 Q
"RTN","IBJPS2",121,0)
 ;
"RTN","IBJPS2",122,0)
SET(TTL,DATA,LN,LR,SEL,HDR) ;
"RTN","IBJPS2",123,0)
 N IBY,IBX,IBC S IBC=": " I TTL="" S IBC="  "
"RTN","IBJPS2",124,0)
 S IBY=TTL_$J("",(IBTW(LR)-$L(TTL)-2))_$S('$G(HDR):IBC_DATA,1:""),IBX=$G(^TMP("IBJPS",$J,LN,0))
"RTN","IBJPS2",125,0)
 S IBX=$$SETSTR^VALM1(IBY,IBX,IBTC(LR),(IBTW(LR)+IBSW(LR)))
"RTN","IBJPS2",126,0)
 D SET1(IBX,LN,SEL)
"RTN","IBJPS2",127,0)
 S LN=LN+1
"RTN","IBJPS2",128,0)
 Q LN
"RTN","IBJPS2",129,0)
 ;
"RTN","IBJPS2",130,0)
SET1(STR,LN,SEL,HI) ; set up TMP array with screen data
"RTN","IBJPS2",131,0)
 S ^TMP("IBJPS",$J,LN,0)=STR
"RTN","IBJPS2",132,0)
 S ^TMP("IBJPS",$J,"IDX",LN,SEL)=""
"RTN","IBJPS2",133,0)
 S ^TMP("IBJPSAX",$J,SEL)=SEL
"RTN","IBJPS2",134,0)
 I $G(HI)'="" D CNTRL^VALM10(LN,1,4,IOINHI,IOINORM)
"RTN","IBJPS2",135,0)
 ;I $G(RV) D CNTRL^VALM10(LN,6,19,IOUON,IOUOFF)
"RTN","IBJPS2",136,0)
 Q
"RTN","IBJPS2",137,0)
 ;
"RTN","IBJPS2",138,0)
YN(X) Q $S(+X:"YES",1:"NO")
"RTN","IBJPS2",139,0)
 ;
"RTN","IBJPS2",140,0)
RIGHT(LR,SEL,BL) ; - reset control variables for right side of screen
"RTN","IBJPS2",141,0)
 S IBLN=$S(IBLN>IBGRPE:IBLN,1:IBGRPE) I $G(BL) S IBLN=$$SET("","",IBLN,IBLR,IBSEL)
"RTN","IBJPS2",142,0)
 S IBLR=$G(LR),IBGRPB=IBLN I +$G(SEL) S IBSEL=IBSEL+1 D SET1("["_IBSEL_"]",IBLN,IBSEL,1)
"RTN","IBJPS2",143,0)
 Q
"RTN","IBJPS2",144,0)
 ;
"RTN","IBJPS2",145,0)
LEFT(LR) ; - reset control variables for left side of screen
"RTN","IBJPS2",146,0)
 S IBLR=$G(LR),IBGRPE=IBLN,IBLN=IBGRPB
"RTN","IBJPS2",147,0)
 Q
"RTN","IBJTA1")
0^23^B18194531^B15741142
"RTN","IBJTA1",1,0)
IBJTA1 ;ALB/ARH - TPI ACTIONS ;2/14/95
"RTN","IBJTA1",2,0)
 ;;2.0;INTEGRATED BILLING;**39,137,377**;21-MAR-94;Build 23
"RTN","IBJTA1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBJTA1",4,0)
 ;
"RTN","IBJTA1",5,0)
CP ; -- IBJT CHANGE PATIENT action: change patient, only available on AL screen
"RTN","IBJTA1",6,0)
 ;    user selects new patient, then Active Bills screen rebuilt with that patients active bills
"RTN","IBJTA1",7,0)
 N VALMQUIT,IBDFN
"RTN","IBJTA1",8,0)
 D FULL^VALM1
"RTN","IBJTA1",9,0)
 S IBDFN=DFN S DFN=+$$PAT^IBJTU2 I 'DFN S DFN=IBDFN
"RTN","IBJTA1",10,0)
 K ^TMP("IBJTLA",$J),^TMP("IBJTLAX",$J)
"RTN","IBJTA1",11,0)
 D BLDA^IBJTLA1,HDR^IBJTLA
"RTN","IBJTA1",12,0)
 S VALMBCK="R",VALMBG=1
"RTN","IBJTA1",13,0)
CPQ Q
"RTN","IBJTA1",14,0)
 ;
"RTN","IBJTA1",15,0)
CB ; -- IBJT CHANGE BILL action: change bill, only available on CI screen
"RTN","IBJTA1",16,0)
 ;    user enters new bill number then Claim Info screen rebuilt/redisplayed for that bill
"RTN","IBJTA1",17,0)
 ;    if option entered through Active List screen then only allows bills for current patient
"RTN","IBJTA1",18,0)
 N VALMQUIT,IBIFN1,IBDFN1
"RTN","IBJTA1",19,0)
 D FULL^VALM1
"RTN","IBJTA1",20,0)
 S IBDFN1=DFN,IBIFN1=IBIFN
"RTN","IBJTA1",21,0)
 I $D(^TMP("IBJTLA",$J)) S DIC("S")="I $P(^(0),U,2)="_DFN
"RTN","IBJTA1",22,0)
 S IBIFN=+$$BILL^IBJTU2 I 'IBIFN S IBIFN=IBIFN1
"RTN","IBJTA1",23,0)
 S DFN=$P(^DGCR(399,+IBIFN,0),U,2)
"RTN","IBJTA1",24,0)
 D CLEAN^VALM10 K IBXSAVE,IBXDATA D BLD^IBJTCA1,HDR^IBJTCA
"RTN","IBJTA1",25,0)
 S VALMBCK="R",VALMBG=1
"RTN","IBJTA1",26,0)
CBQ Q
"RTN","IBJTA1",27,0)
 ;
"RTN","IBJTA1",28,0)
CDI ; -- IBJT CHANGE DATES INACTIVE action: Change Date range for Inactive screen
"RTN","IBJTA1",29,0)
 ;    user enters end date for search for inactive bills for a patient, Inactive Bills screen then rebuilt with
"RTN","IBJTA1",30,0)
 ;    inactive bills for the patient and new date range,  IBEND passed to screen build
"RTN","IBJTA1",31,0)
 ;    if IBBEG is defined the day before is used as the default end date, otherwise, today
"RTN","IBJTA1",32,0)
 ;    this way the defaults will work backwards until end of bills, then restarts with today
"RTN","IBJTA1",33,0)
 D FULL^VALM1
"RTN","IBJTA1",34,0)
 S DIR("?",1)="Enter most recent date to include in list."
"RTN","IBJTA1",35,0)
 S DIR("?")="A search for inactive bills for this patient will begin on the date entered and go back at least 6 months into the past.  If the patient has few bills then the search may span more than six months."
"RTN","IBJTA1",36,0)
 S DIR("B")=$S(+$G(IBBEG):$$DATE^IBJU1($$FMADD^XLFDT(IBBEG,-1)),1:"TODAY")
"RTN","IBJTA1",37,0)
 S DIR(0)="DO^::EX",DIR("A")="End Date"
"RTN","IBJTA1",38,0)
 D ^DIR K DIR I 'Y!($D(DIRUT))!(Y=$G(IBEND)) S VALMSG="Date range was not changed." G CDIQ
"RTN","IBJTA1",39,0)
 K ^TMP("IBJTLB",$J),^TMP("IBJTLBX",$J)
"RTN","IBJTA1",40,0)
 S IBEND=Y D BLDA^IBJTLB1,HDR^IBJTLB
"RTN","IBJTA1",41,0)
CDIQ S VALMBCK="R",VALMBG=1
"RTN","IBJTA1",42,0)
 K VALMB,VALMBEG,VALMEND,DIRUT
"RTN","IBJTA1",43,0)
 Q
"RTN","IBJTA1",44,0)
 ;
"RTN","IBJTA1",45,0)
ARCA ;  -- IBJT AR COMMENT ADD action:  add a comment transaction to the AR account, IBIFN required
"RTN","IBJTA1",46,0)
 ;     IBARCOMM set to indicate AR Profile screen needs to be rebuilt when it is reentered
"RTN","IBJTA1",47,0)
 ;     will cause the AR screen to be rebuilt including the new information if the AR screen is already open
"RTN","IBJTA1",48,0)
 N AUTHDT,MRADT,STATUS,VALMQUIT,DIR
"RTN","IBJTA1",49,0)
 D FULL^VALM1
"RTN","IBJTA1",50,0)
 S STATUS=$P($G(^DGCR(399,IBIFN,0)),U,13)
"RTN","IBJTA1",51,0)
 S AUTHDT=$P($G(^DGCR(399,IBIFN,"S")),U,10)
"RTN","IBJTA1",52,0)
 S MRADT=$P($G(^DGCR(399,IBIFN,"S")),U,7)
"RTN","IBJTA1",53,0)
 ; if claim status is "NOT REVIEWED" or claim status is "CANCELLED" with neither MRA request date
"RTN","IBJTA1",54,0)
 ; nor Authorization date present, display an error and bail out.
"RTN","IBJTA1",55,0)
 I STATUS=1!(STATUS=7&(MRADT="")&(AUTHDT="")) D  G ARCAQ
"RTN","IBJTA1",56,0)
 .S DIR(0)="EA",DIR("A",1)="A comment can not be added for an incomplete or cancelled while incomplete claim.",DIR("A")="Press RETURN to continue: " D ^DIR K DIR
"RTN","IBJTA1",57,0)
 ; if claim status is "REQUEST MRA" or claim status is "CANCELLED" with MRA request date present,
"RTN","IBJTA1",58,0)
 ; but no Authorization date, enter MRA comments.
"RTN","IBJTA1",59,0)
 I STATUS=2!(STATUS=7&(MRADT'="")&(AUTHDT="")) D:$G(IBIFN) CMNT^IBCECOB6 G ARCAR
"RTN","IBJTA1",60,0)
 ; otherwise, enter AR comments.
"RTN","IBJTA1",61,0)
 D ADJUST^RCJIBFN3(IBIFN)
"RTN","IBJTA1",62,0)
 I $D(^TMP("IBJTTA",$J)) S IBARCOMM=1
"RTN","IBJTA1",63,0)
 K ^TMP("IBJTTC",$J)
"RTN","IBJTA1",64,0)
ARCAR ; rebuild comments screen
"RTN","IBJTA1",65,0)
 D BLD^IBJTTC,HDR^IBJTTC
"RTN","IBJTA1",66,0)
ARCAQ S VALMBCK="R",VALMBG=1
"RTN","IBJTA1",67,0)
 Q
"RTN","IBJTA1",68,0)
 ;
"RTN","IBJTA1",69,0)
HS ; -- IBJT HS HEALTH SUMMARY action: health summary (inpt (350.9,2.08), outpt (350.9,2.09))
"RTN","IBJTA1",70,0)
 ;    if a Health Summary has been defined for the type of care (Inpt/Outpt) it is printed to the screen
"RTN","IBJTA1",71,0)
 ;    type of care is taken from the current bill if there is one otherwise the user is asked
"RTN","IBJTA1",72,0)
 ;    requires HS 2.5 or greater, if 2.7 is available then a date range can be used
"RTN","IBJTA1",73,0)
 ;    if date range used it is taken from the current bill if available otherwise askes user
"RTN","IBJTA1",74,0)
 N X,Y,IBX,IBHS,DIR,DIRUT,IBIOPT,IBDT1,IBDT2,IBHSVER
"RTN","IBJTA1",75,0)
 S (IBIOPT,IBHS)=0,IBHSVER=$$VERSION^XPDUTL("HEALTH SUMMARY")
"RTN","IBJTA1",76,0)
 I IBHSVER<2.5 S VALMSG="Health Summary package not available." G HSQ
"RTN","IBJTA1",77,0)
 D FULL^VALM1
"RTN","IBJTA1",78,0)
 I +$G(IBIFN) D  I 'IBIOPT G HSQ
"RTN","IBJTA1",79,0)
 . S IBX=$G(^DGCR(399,+IBIFN,0)) I '$G(DFN) S DFN=$P(IBX,U,2) I 'DFN Q
"RTN","IBJTA1",80,0)
 . S IBIOPT=$S($P(IBX,U,5)<1:0,$P(IBX,U,5)<3:1,1:2)
"RTN","IBJTA1",81,0)
 . S IBDT1=$G(^DGCR(399,+IBIFN,"U")),IBDT2=$P(IBDT1,U,2),IBDT1=+IBDT1
"RTN","IBJTA1",82,0)
 ;
"RTN","IBJTA1",83,0)
 I '$G(IBIFN) D  I 'IBIOPT G HSQ
"RTN","IBJTA1",84,0)
 . S DIR(0)="SOB^I:Inpatient;O:Outpatient",DIR("A")="Inpatient or Outpatient Health Summary?" D ^DIR K DIR
"RTN","IBJTA1",85,0)
 . S IBIOPT=$S(Y="I":1,Y="O":2,1:0) Q:'IBIOPT
"RTN","IBJTA1",86,0)
 . ;
"RTN","IBJTA1",87,0)
 . Q:IBHSVER<2.7
"RTN","IBJTA1",88,0)
 . W !!,"Enter the date range the Health Summary should cover."
"RTN","IBJTA1",89,0)
 . S IBDT1=$$DR^IBJTU2($$FMADD^XLFDT(DT,-365),DT),IBDT2=$P(IBDT1,U,2),IBDT1=+IBDT1
"RTN","IBJTA1",90,0)
 ;
"RTN","IBJTA1",91,0)
 S IBX=$G(^IBE(350.9,1,2)),IBHS=$S(IBIOPT=1:$P(IBX,U,8),1:$P(IBX,U,9))
"RTN","IBJTA1",92,0)
 ;
"RTN","IBJTA1",93,0)
 I 'IBHS S VALMSG="No Health Summary Type chosen for "_$S(IBIOPT=1:"In",1:"Out")_"patient." G HSQ
"RTN","IBJTA1",94,0)
 I IBHSVER<2.7 D ENX^GMTSDVR(DFN,IBHS) G HSQ
"RTN","IBJTA1",95,0)
 D ENX^GMTSDVR(DFN,IBHS,IBDT1,IBDT2)
"RTN","IBJTA1",96,0)
HSQ S VALMBCK="R"
"RTN","IBJTA1",97,0)
 Q
"RTN","IBJTTC")
0^22^B21337725^B12317143
"RTN","IBJTTC",1,0)
IBJTTC ;ALB/ARH - TPI AR COMMENT HISTORY ; 06-MAR-1995
"RTN","IBJTTC",2,0)
 ;;2.0;INTEGRATED BILLING;**39,377**;21-MAR-94;Build 23
"RTN","IBJTTC",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBJTTC",4,0)
 ;
"RTN","IBJTTC",5,0)
 ; AR Profile of Comments:  This screen prints the following Comments:
"RTN","IBJTTC",6,0)
 ;    Bill Comments (430,98)  - entered during auditing
"RTN","IBJTTC",7,0)
 ;    For each COMMENT Transaction:
"RTN","IBJTTC",8,0)
 ;           Brief Comment (433,5.02)
"RTN","IBJTTC",9,0)
 ;           Transaction Comment (433,86)
"RTN","IBJTTC",10,0)
 ;           Comment (433,41)
"RTN","IBJTTC",11,0)
 ;
"RTN","IBJTTC",12,0)
EN ; -- main entry point for IBJT AR COMMENT HISTORY
"RTN","IBJTTC",13,0)
 D EN^VALM("IBJT AR COMMENT HISTORY")
"RTN","IBJTTC",14,0)
 Q
"RTN","IBJTTC",15,0)
 ;
"RTN","IBJTTC",16,0)
HDR ; -- header code
"RTN","IBJTTC",17,0)
 D HDR^IBJTU1(+IBIFN,+DFN,13)
"RTN","IBJTTC",18,0)
 Q
"RTN","IBJTTC",19,0)
 ;
"RTN","IBJTTC",20,0)
INIT ; -- init variables and list array
"RTN","IBJTTC",21,0)
 K ^TMP("IBJTTC",$J)
"RTN","IBJTTC",22,0)
 I '$G(DFN)!'$G(IBIFN) S VALMQUIT="" G INITQ
"RTN","IBJTTC",23,0)
 D BLD
"RTN","IBJTTC",24,0)
INITQ Q
"RTN","IBJTTC",25,0)
 ;
"RTN","IBJTTC",26,0)
HELP ; -- help code
"RTN","IBJTTC",27,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","IBJTTC",28,0)
 Q
"RTN","IBJTTC",29,0)
 ;
"RTN","IBJTTC",30,0)
EXIT ; -- exit code
"RTN","IBJTTC",31,0)
 K ^TMP("IBJTTC",$J)
"RTN","IBJTTC",32,0)
 D CLEAR^VALM1
"RTN","IBJTTC",33,0)
 Q
"RTN","IBJTTC",34,0)
 ;
"RTN","IBJTTC",35,0)
BLD ;
"RTN","IBJTTC",36,0)
 N CMLN,CMSTR,X,IBCNT,IBZ,IB0,IBI,IBX,IBD,IBDATE,IBDUZ,IBRCT5,IBLN,IBSTR,IBK,IBJ,DIWL,DIWR,DIWF,COM
"RTN","IBJTTC",37,0)
 ;
"RTN","IBJTTC",38,0)
 S VALMCNT=0,IBLN=0
"RTN","IBJTTC",39,0)
 ;
"RTN","IBJTTC",40,0)
 ; Bill Comments (430,98)
"RTN","IBJTTC",41,0)
 K COM,^UTILITY($J,"W") D BCOM^RCJIBFN2(IBIFN) I $D(COM)>10 D
"RTN","IBJTTC",42,0)
 . S IBSTR="",IBD="AR BILL COMMENTS:" S IBSTR=$$SETLN(IBD,IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN)
"RTN","IBJTTC",43,0)
 . ;
"RTN","IBJTTC",44,0)
 . S IBJ="" F  S IBJ=$O(COM(IBJ)) Q:'IBJ  S X=$G(COM(IBJ)) I X'="" S DIWL=1,DIWR=54,DIWF=""  D ^DIWP
"RTN","IBJTTC",45,0)
 . ;
"RTN","IBJTTC",46,0)
 . I $D(^UTILITY($J,"W")) S (IBK,IBCNT)=0 F  S IBK=$O(^UTILITY($J,"W",1,IBK)) Q:'IBK  D
"RTN","IBJTTC",47,0)
 .. S IBD=$G(^UTILITY($J,"W",1,IBK,0)) S IBSTR=$$SETLN(IBD,IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN),IBSTR=""
"RTN","IBJTTC",48,0)
 . K ^UTILITY($J,"W")
"RTN","IBJTTC",49,0)
 ;
"RTN","IBJTTC",50,0)
 ; AR profile of comment transactions  (433: 5.02, 41, 86)
"RTN","IBJTTC",51,0)
 K ^TMP("RCJIB",$J),^UTILITY($J,"W") D TRN^RCJIBFN2(IBIFN)
"RTN","IBJTTC",52,0)
 I $D(^TMP("RCJIB",$J)) S IBI="" F  S IBI=$O(^TMP("RCJIB",$J,IBI)) Q:'IBI  D
"RTN","IBJTTC",53,0)
 . S IBX=$G(^TMP("RCJIB",$J,IBI)) I $$STNO^RCJIBFN2(+$P(IBX,U,3))'["COMMENT" Q
"RTN","IBJTTC",54,0)
 . S IBRCT5=$$N5^RCJIBFN1(IBI)
"RTN","IBJTTC",55,0)
 . S IBSTR="",IBLN=$$SET(IBSTR,IBLN)
"RTN","IBJTTC",56,0)
 . S IBD=$P(IBX,U,1) S IBSTR=$$SETLN(IBD,IBSTR,2,8)
"RTN","IBJTTC",57,0)
 . S IBD=$$DATE(+$P(IBX,U,2)) S IBSTR=$$SETLN(IBD,IBSTR,14,8)
"RTN","IBJTTC",58,0)
 . S IBD=$P(IBRCT5,U,1) S IBSTR=$$SETLN(IBD,IBSTR,25,30)
"RTN","IBJTTC",59,0)
 . S IBD="FOLLOW-UP DT: "_$$DATE(+$P(IBRCT5,U,2)) S IBSTR=$$SETLN(IBD,IBSTR,57,22)
"RTN","IBJTTC",60,0)
 . S IBLN=$$SET(IBSTR,IBLN),IBSTR=""
"RTN","IBJTTC",61,0)
 . ;
"RTN","IBJTTC",62,0)
 . ;   -- transaction comments (86)
"RTN","IBJTTC",63,0)
 . S X=$P($G(^TMP("RCJIB",$J,IBI)),U,6) I X'="" S DIWL=1,DIWR=54,DIWF=""  D ^DIWP
"RTN","IBJTTC",64,0)
 . ;
"RTN","IBJTTC",65,0)
 . ;   -- comments  (86 & 41)
"RTN","IBJTTC",66,0)
 . K COM D N7^RCJIBFN1(IBI) I $D(COM)>2 D
"RTN","IBJTTC",67,0)
 .. S IBJ="" F  S IBJ=$O(COM(IBJ)) Q:'IBJ  S X=$G(COM(IBJ)) I X'="" S DIWL=1,DIWR=54,DIWF=""  D ^DIWP
"RTN","IBJTTC",68,0)
 . ;
"RTN","IBJTTC",69,0)
 . I $D(^UTILITY($J,"W")) S (IBK,IBCNT)=0 F  S IBK=$O(^UTILITY($J,"W",1,IBK)) Q:'IBK  D
"RTN","IBJTTC",70,0)
 .. S IBD=$G(^UTILITY($J,"W",1,IBK,0)) S IBSTR=$$SETLN(IBD,IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN),IBSTR=""
"RTN","IBJTTC",71,0)
 . K ^UTILITY($J,"W")
"RTN","IBJTTC",72,0)
 K ^TMP("RCJIB",$J),^UTILITY($J,"W")
"RTN","IBJTTC",73,0)
 ; MRA comments
"RTN","IBJTTC",74,0)
 ; check if we have any comments to display
"RTN","IBJTTC",75,0)
 I $D(^DGCR(399,IBIFN,"TXC","B")) D
"RTN","IBJTTC",76,0)
 .S IBLN=$$SET("",IBLN)
"RTN","IBJTTC",77,0)
 .S IBSTR="",IBSTR=$$SETLN("MRA REQUEST CLAIM COMMENTS",IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN)
"RTN","IBJTTC",78,0)
 .S IBSTR="",IBSTR=$$SETLN("--------------------------",IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN)
"RTN","IBJTTC",79,0)
 .; loop through all available comments
"RTN","IBJTTC",80,0)
 .S IBDATE="" F  S IBDATE=$O(^DGCR(399,IBIFN,"TXC","B",IBDATE),-1) Q:IBDATE=""  D
"RTN","IBJTTC",81,0)
 ..S IBZ=$O(^DGCR(399,IBIFN,"TXC","B",IBDATE,"")),IB0=^DGCR(399,IBIFN,"TXC",IBZ,0),IBDUZ=$P(IB0,U,2)
"RTN","IBJTTC",82,0)
 ..S IBLN=$$SET("",IBLN)
"RTN","IBJTTC",83,0)
 ..S IBSTR=""
"RTN","IBJTTC",84,0)
 ..S IBSTR=$$SETLN($$FMTE^XLFDT(IBDATE,"2Z"),IBSTR,14,8)
"RTN","IBJTTC",85,0)
 ..S IBSTR=$$SETLN($J("Entered by "_$$GET1^DIQ(200,IBDUZ,.01),54),IBSTR,25,54)
"RTN","IBJTTC",86,0)
 ..S IBLN=$$SET(IBSTR,IBLN),IBSTR=""
"RTN","IBJTTC",87,0)
 ..; loop through comment lines
"RTN","IBJTTC",88,0)
 ..S CMLN=0 F  S CMLN=$O(^DGCR(399,IBIFN,"TXC",IBZ,1,CMLN)) Q:CMLN=""  D
"RTN","IBJTTC",89,0)
 ...S X=^DGCR(399,IBIFN,"TXC",IBZ,1,CMLN,0) I X'="" S DIWL=1,DIWR=54,DIWF=""  D ^DIWP
"RTN","IBJTTC",90,0)
 ...Q
"RTN","IBJTTC",91,0)
 ..I $D(^UTILITY($J,"W")) S IBK=0 F  S IBK=$O(^UTILITY($J,"W",1,IBK)) Q:'IBK  D
"RTN","IBJTTC",92,0)
 ...S CMSTR=$G(^UTILITY($J,"W",1,IBK,0)) S IBSTR=$$SETLN(CMSTR,IBSTR,25,54),IBLN=$$SET(IBSTR,IBLN),IBSTR=""
"RTN","IBJTTC",93,0)
 ...Q
"RTN","IBJTTC",94,0)
 ..K ^UTILITY($J,"W")
"RTN","IBJTTC",95,0)
 ..Q
"RTN","IBJTTC",96,0)
 .D CLEAN^DILF
"RTN","IBJTTC",97,0)
 .Q
"RTN","IBJTTC",98,0)
 ;
"RTN","IBJTTC",99,0)
 I IBLN=0 S IBLN=$$SET("",IBLN),IBLN=$$SET("No Comment Transactions Exist For This Account.",IBLN)
"RTN","IBJTTC",100,0)
 S VALMCNT=IBLN
"RTN","IBJTTC",101,0)
 Q
"RTN","IBJTTC",102,0)
 ;
"RTN","IBJTTC",103,0)
DATE(X) ; date in external format
"RTN","IBJTTC",104,0)
 N Y S Y="" I +X S Y=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)
"RTN","IBJTTC",105,0)
 Q Y
"RTN","IBJTTC",106,0)
 ;
"RTN","IBJTTC",107,0)
SETLN(STR,IBX,COL,WD) ;
"RTN","IBJTTC",108,0)
 S IBX=$$SETSTR^VALM1(STR,IBX,COL,WD)
"RTN","IBJTTC",109,0)
 Q IBX
"RTN","IBJTTC",110,0)
 ;
"RTN","IBJTTC",111,0)
SET(STR,LN) ; set up TMP array with screen data
"RTN","IBJTTC",112,0)
 S LN=LN+1 D SET^VALM10(LN,STR)
"RTN","IBJTTC",113,0)
SETQ Q LN
"RTN","IBTOBI1")
0^21^B18898112^B18274759
"RTN","IBTOBI1",1,0)
IBTOBI1 ;ALB/AAS - CLAIMS TRACKING BILLING INFORMATION PRINT ;27-OCT-93
"RTN","IBTOBI1",2,0)
 ;;2.0;INTEGRATED BILLING;**276,377**;21-MAR-94;Build 23
"RTN","IBTOBI1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBTOBI1",4,0)
 ;
"RTN","IBTOBI1",5,0)
% ;
"RTN","IBTOBI1",6,0)
 F IBTAG="INS","BI","SC","CLIN^IBTOBI4","IR^IBTOBI2","HR^IBTOBI3" D @IBTAG Q:IBQUIT
"RTN","IBTOBI1",7,0)
 Q
"RTN","IBTOBI1",8,0)
 ;
"RTN","IBTOBI1",9,0)
INS ; -- print ins. stuff
"RTN","IBTOBI1",10,0)
 N TAB,TAB2,IBALLIN,IBDT,IBINS,IBCNT,I,X,IBI,PHON,PHON2,PHON3,P,IBI
"RTN","IBTOBI1",11,0)
 S TAB=5,TAB2=45,IBALLIN=1
"RTN","IBTOBI1",12,0)
 S IBDT=$P(IBTRND,"^",6)
"RTN","IBTOBI1",13,0)
 I '$G(IBDT) S IBDT=DT
"RTN","IBTOBI1",14,0)
 W !,"  Insurance Information "
"RTN","IBTOBI1",15,0)
 ;
"RTN","IBTOBI1",16,0)
 D ALL^IBCNS1(DFN,"IBINS",1,IBDT)
"RTN","IBTOBI1",17,0)
 I $G(IBINS(0))<1 W !,?TAB,"No Insurance Information",!!! G INSQ
"RTN","IBTOBI1",18,0)
 S IBI=0,IBCNT=0 F  S IBI=$O(IBINS(IBI)) Q:'IBI!(IBQUIT)  S IBINS=IBINS(IBI,0) D  Q:IBQUIT
"RTN","IBTOBI1",19,0)
 .S IBCNT=IBCNT+1
"RTN","IBTOBI1",20,0)
 .I ($Y+8)>IOSL D HDR^IBTOBI Q:IBQUIT
"RTN","IBTOBI1",21,0)
 .I IBCNT>1 W !
"RTN","IBTOBI1",22,0)
 .W !?TAB,"     Ins. Co "_IBCNT_": ",$E($P($G(^DIC(36,+IBINS,0)),"^"),1,23)
"RTN","IBTOBI1",23,0)
 .S X=$G(^DIC(36,+IBINS,.13))
"RTN","IBTOBI1",24,0)
 .S PHON=$S($P(X,"^",3)'="":$P(X,"^",3),1:$P(X,"^"))
"RTN","IBTOBI1",25,0)
 .S PHON2=$S($P(X,"^",2)'="":$P(X,"^",2),1:$P(X,"^"))
"RTN","IBTOBI1",26,0)
 .S P=$S($P(IBETYP,"^",3)=1:5,$P(IBETYP,"^",3)=2:6,$P(IBETYP,"^",3)=3:11,1:1)
"RTN","IBTOBI1",27,0)
 .S PHON3=$S($P(X,"^",P)'="":$P(X,"^",P),1:$P(X,"^"))
"RTN","IBTOBI1",28,0)
 .W ?TAB2,"Pre-Cert Phone: ",PHON
"RTN","IBTOBI1",29,0)
 .W !?TAB,"        Subsc.: ",$P(IBINS,"^",17)
"RTN","IBTOBI1",30,0)
 .W ?TAB2,"          Type: ",$E($P($G(^IBE(355.1,+$P($G(^IBA(355.3,+$P(IBINS,"^",18),0)),"^",9),0)),"^"),1,18)
"RTN","IBTOBI1",31,0)
 .W !?TAB,"     Subsc. ID: ",$P(IBINS,"^",2)
"RTN","IBTOBI1",32,0)
 .W ?TAB2,"         Group: ",$$GRP^IBCNS($P(IBINS,"^",18))
"RTN","IBTOBI1",33,0)
 .W !?TAB,"     Coord Ben: ",$E($$EXPAND^IBTRE(2.312,.2,$P(IBINS,"^",20)),1,18)
"RTN","IBTOBI1",34,0)
 .W ?TAB2," Billing Phone: ",PHON2
"RTN","IBTOBI1",35,0)
 .W !,?TAB,"Filing Time Fr: ",$$EXPAND^IBTRE(36,.12,$P($G(^DIC(36,+IBINS,0)),"^",12))
"RTN","IBTOBI1",36,0)
 .W ?TAB2,"  Claims Phone: ",PHON3
"RTN","IBTOBI1",37,0)
 .S X=$P($G(IBINS(IBI,1)),"^",8) I X'="" W !,"     Policy Comment: " W:($L(X)+23)>IOM ! W " ",X
"RTN","IBTOBI1",38,0)
 .D COMM(+$P(IBINS,"^",18))
"RTN","IBTOBI1",39,0)
 .Q:IBQUIT
"RTN","IBTOBI1",40,0)
 .W !?30,"-----------------------------------"
"RTN","IBTOBI1",41,0)
 W:'IBQUIT !?4,$TR($J(" ",IOM-8)," ","-"),!
"RTN","IBTOBI1",42,0)
INSQ Q
"RTN","IBTOBI1",43,0)
 ;
"RTN","IBTOBI1",44,0)
BI ; -- print billing information
"RTN","IBTOBI1",45,0)
 Q:$D(IBCTHDR)
"RTN","IBTOBI1",46,0)
 I ($Y+8)>IOSL D HDR^IBTOBI Q:IBQUIT
"RTN","IBTOBI1",47,0)
BI1 W !,"  Billing Information "
"RTN","IBTOBI1",48,0)
 N IBDGCR,IBDGCRU1,IBDGCRU,IBAMNT,IBD,I,IBIFN,IBLN,IBECME
"RTN","IBTOBI1",49,0)
 S IBIFN=+$P(IBTRND,"^",11)
"RTN","IBTOBI1",50,0)
 S IBDGCR=$G(^DGCR(399,IBIFN,0)),IBDGCRU1=$G(^("U1")),IBDGCRU=$G(^("U"))
"RTN","IBTOBI1",51,0)
 S IBECME=$P($P($G(^DGCR(399,IBIFN,"M1")),U,8),";")
"RTN","IBTOBI1",52,0)
 S IBAMNT=$$BILLD^IBTRED1(IBTRN)
"RTN","IBTOBI1",53,0)
 S IBLN=0
"RTN","IBTOBI1",54,0)
 S IBLN=IBLN+1,IBD(IBLN,1)="  Initial Bill: "_$P(IBDGCR,U,1)
"RTN","IBTOBI1",55,0)
 I IBECME D
"RTN","IBTOBI1",56,0)
 . S IBD(IBLN,1)=IBD(IBLN,1)_"e"
"RTN","IBTOBI1",57,0)
 . S IBLN=IBLN+1,IBD(IBLN,1)="   ECME Number: "_IBECME
"RTN","IBTOBI1",58,0)
 S IBLN=IBLN+1,IBD(IBLN,1)="   Bill Status: "_$E($$EXPAND^IBTRE(399,.13,$P(IBDGCR,U,13)),1,14)
"RTN","IBTOBI1",59,0)
 S IBLN=IBLN+1,IBD(IBLN,1)=" Total Charges: $ "_$J($P(IBAMNT,"^"),8)
"RTN","IBTOBI1",60,0)
 S IBLN=IBLN+1,IBD(IBLN,1)="   Amount Paid: $ "_$J($P(IBAMNT,"^",2),8)
"RTN","IBTOBI1",61,0)
 ;
"RTN","IBTOBI1",62,0)
 I $P(IBTRND,U,19) D
"RTN","IBTOBI1",63,0)
 . S IBLN=IBLN+1,IBD(IBLN,1)="Reason Not Billable: "_$$EXPAND^IBTRE(356,.19,$P(IBTRND,U,19))
"RTN","IBTOBI1",64,0)
 . S IBLN=IBLN+1,IBD(IBLN,1)="Additional Comment: "_$P(IBTRND1,U,8)
"RTN","IBTOBI1",65,0)
 . Q
"RTN","IBTOBI1",66,0)
 ;
"RTN","IBTOBI1",67,0)
 I '$P(IBTRND,U,19),$L($P(IBTRND1,U,8))>0 S IBLN=IBLN+1,IBD(IBLN,1)="Additional Comment: "_$P(IBTRND1,U,8)
"RTN","IBTOBI1",68,0)
 ;
"RTN","IBTOBI1",69,0)
 S IBD(1,2)="Estimated Recv (Pri): $ "_$J($P(IBTRND,"^",21),8)
"RTN","IBTOBI1",70,0)
 S IBD(2,2)="Estimated Recv (Sec): $ "_$J($P(IBTRND,"^",22),8)
"RTN","IBTOBI1",71,0)
 S IBD(3,2)="Estimated Recv (ter): $ "_$J($P(IBTRND,"^",23),8)
"RTN","IBTOBI1",72,0)
 S IBD(4,2)="  Means Test Charges: $ "_$J($P(IBTRND,"^",28),8)
"RTN","IBTOBI1",73,0)
 ;
"RTN","IBTOBI1",74,0)
 S I=0 F  S I=$O(IBD(I)) Q:'I  W !,$G(IBD(I,1)),?39,$E($G(IBD(I,2)),1,36)
"RTN","IBTOBI1",75,0)
 W:'IBQUIT !,?4,$TR($J(" ",IOM-8)," ","-")
"RTN","IBTOBI1",76,0)
 Q
"RTN","IBTOBI1",77,0)
 ;
"RTN","IBTOBI1",78,0)
SC ; -- print SC information
"RTN","IBTOBI1",79,0)
 I ($Y+7)>IOSL D HDR^IBTOBI Q:IBQUIT
"RTN","IBTOBI1",80,0)
 N VAEL,TAB,IBTRCSC
"RTN","IBTOBI1",81,0)
 D ELIG^VADPT
"RTN","IBTOBI1",82,0)
 W !!,"  Eligibility Information"
"RTN","IBTOBI1",83,0)
 W !,"       Primary Eligibility: "_$P(VAEL(1),"^",2)
"RTN","IBTOBI1",84,0)
 W !,"         Means Test Status: "_$P(VAEL(9),"^",2)
"RTN","IBTOBI1",85,0)
 W !," Service Connected Percent: "_$S(+VAEL(3):+$P(VAEL(3),"^",2)_"%",1:"")
"RTN","IBTOBI1",86,0)
 I 'VAEL(3) W "Patient Not Service Connected",!! G SCQ
"RTN","IBTOBI1",87,0)
 S TAB=5,IBTRCSC=1 D SC^IBTOAT2
"RTN","IBTOBI1",88,0)
SCQ W:'IBQUIT !?4,$TR($J(" ",IOM-8)," ","-"),!
"RTN","IBTOBI1",89,0)
 Q
"RTN","IBTOBI1",90,0)
 ;
"RTN","IBTOBI1",91,0)
COMM(DA) ; -- print comments from GROUP plans.
"RTN","IBTOBI1",92,0)
 Q:IBQUIT
"RTN","IBTOBI1",93,0)
 W !,"Group Plan Comments: "
"RTN","IBTOBI1",94,0)
 Q:'$D(^IBA(355.3,DA,11))
"RTN","IBTOBI1",95,0)
 K ^UTILITY($J,"W")
"RTN","IBTOBI1",96,0)
 S DIWL=10,DIWR=IOM-12,DIWF="W"
"RTN","IBTOBI1",97,0)
 S IBJ=0 F  S IBJ=$O(^IBA(355.3,DA,11,IBJ)) Q:'IBJ  S X=^(IBJ,0) D ^DIWP I IOSL<($Y+3) Q:IBQUIT  D HDR^IBTOBI
"RTN","IBTOBI1",98,0)
 Q:IBQUIT
"RTN","IBTOBI1",99,0)
 D ^DIWW
"RTN","IBTOBI1",100,0)
 K ^UTILITY($J,"W")
"RTN","IBTOBI1",101,0)
 Q
"RTN","IBY377PO")
0^^B47817727^n/a
"RTN","IBY377PO",1,0)
IBY377PO ;ALB/ESG - Post Install for IB patch 377 ;29-Nov-2007
"RTN","IBY377PO",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBY377PO",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBY377PO",4,0)
 ;
"RTN","IBY377PO",5,0)
EN ;
"RTN","IBY377PO",6,0)
 N XPDIDTOT S XPDIDTOT=5
"RTN","IBY377PO",7,0)
 D XREF          ; 1. re-build DD cross reference
"RTN","IBY377PO",8,0)
 D PND           ; 2. change one EDI reports menu mnemonic
"RTN","IBY377PO",9,0)
 D REL2          ; 3. populate new field 2.312/4.03
"RTN","IBY377PO",10,0)
 D REL355        ; 4. populate new field 355.33/60.14
"RTN","IBY377PO",11,0)
 D EMAIL         ; 5. send email message to FSC
"RTN","IBY377PO",12,0)
 ;
"RTN","IBY377PO",13,0)
 ; remove identifier label from this field
"RTN","IBY377PO",14,0)
 KILL ^DD(355.93,0,"ID",.09)    ; DBIA# 5131 
"RTN","IBY377PO",15,0)
EX ;
"RTN","IBY377PO",16,0)
 Q
"RTN","IBY377PO",17,0)
 ;
"RTN","IBY377PO",18,0)
XREF ; Re-build DD cross references
"RTN","IBY377PO",19,0)
 NEW IBXR,IBRES,IBOUT,DIK
"RTN","IBY377PO",20,0)
 D BMES^XPDUTL(" STEP 1 of "_XPDIDTOT)
"RTN","IBY377PO",21,0)
 D MES^XPDUTL("-------------")
"RTN","IBY377PO",22,0)
 D MES^XPDUTL("Re-building the ""C"" cross-reference in file 364.6 ...")
"RTN","IBY377PO",23,0)
 KILL ^IBA(364.6,"C")                   ; kill whatever is there
"RTN","IBY377PO",24,0)
 S IBXR("FILE")=364.6
"RTN","IBY377PO",25,0)
 S IBXR("NAME")="C"
"RTN","IBY377PO",26,0)
 S IBXR("TYPE")="R"
"RTN","IBY377PO",27,0)
 S IBXR("USE")="LS"
"RTN","IBY377PO",28,0)
 S IBXR("EXECUTION")="F"
"RTN","IBY377PO",29,0)
 S IBXR("ACTIVITY")="IR"
"RTN","IBY377PO",30,0)
 S IBXR("SHORT DESCR")="Field name lookup"
"RTN","IBY377PO",31,0)
 S IBXR("VAL",1)=.1
"RTN","IBY377PO",32,0)
 S IBXR("VAL",1,"SUBSCRIPT")=1
"RTN","IBY377PO",33,0)
 S IBXR("VAL",1,"LENGTH")=40
"RTN","IBY377PO",34,0)
 S IBXR("VAL",1,"COLLATION")="F"
"RTN","IBY377PO",35,0)
 S IBXR("VAL",1,"XFORM FOR STORAGE")="S X=$$UP^XLFSTR(X)"
"RTN","IBY377PO",36,0)
 D CREIXN^DDMOD(.IBXR,"SW",.IBRES,"IBOUT")
"RTN","IBY377PO",37,0)
 S DIK="^IBA(364.6,",DIK(1)=".1^C"      ; set-up
"RTN","IBY377PO",38,0)
 D ENALL^DIK                            ; rebuild it
"RTN","IBY377PO",39,0)
XREFX ;
"RTN","IBY377PO",40,0)
 D MES^XPDUTL(" Done.")
"RTN","IBY377PO",41,0)
 D UPDATE^XPDID(1)
"RTN","IBY377PO",42,0)
 Q
"RTN","IBY377PO",43,0)
 ;
"RTN","IBY377PO",44,0)
PND ; Change one EDI reports menu mnemonic
"RTN","IBY377PO",45,0)
 NEW MENUIEN,ITEMIEN,STOP,IBX,DIE,DA,DR
"RTN","IBY377PO",46,0)
 D BMES^XPDUTL(" STEP 2 of "_XPDIDTOT)
"RTN","IBY377PO",47,0)
 D MES^XPDUTL("-------------")
"RTN","IBY377PO",48,0)
 D MES^XPDUTL("Updating EDI reports menu mnemonic ....")
"RTN","IBY377PO",49,0)
 ;
"RTN","IBY377PO",50,0)
 S MENUIEN=$O(^DIC(19,"B","IBCE TXMT MGMNT REPORTS",0)) I 'MENUIEN G PNDX
"RTN","IBY377PO",51,0)
 S ITEMIEN=0,STOP=0
"RTN","IBY377PO",52,0)
 F  S ITEMIEN=$O(^DIC(19,MENUIEN,10,ITEMIEN)) Q:'ITEMIEN  D  Q:STOP
"RTN","IBY377PO",53,0)
 . S IBX=$P($G(^DIC(19,MENUIEN,10,ITEMIEN,0)),U,1) Q:'IBX
"RTN","IBY377PO",54,0)
 . I $P($G(^DIC(19,IBX,0)),U,1)'="IBCE BATCHES PENDING TOO LONG" Q
"RTN","IBY377PO",55,0)
 . S DIE="^DIC(19,"_MENUIEN_",10,"
"RTN","IBY377PO",56,0)
 . S DA=ITEMIEN,DA(1)=MENUIEN
"RTN","IBY377PO",57,0)
 . S DR="2////PND"
"RTN","IBY377PO",58,0)
 . D ^DIE
"RTN","IBY377PO",59,0)
 . S STOP=1
"RTN","IBY377PO",60,0)
 . Q
"RTN","IBY377PO",61,0)
PNDX ;
"RTN","IBY377PO",62,0)
 D MES^XPDUTL(" Done.")
"RTN","IBY377PO",63,0)
 D UPDATE^XPDID(2)
"RTN","IBY377PO",64,0)
 Q
"RTN","IBY377PO",65,0)
 ;
"RTN","IBY377PO",66,0)
REL2 ; Populate new pt. relation field 2.312/4.03
"RTN","IBY377PO",67,0)
 ;
"RTN","IBY377PO",68,0)
 N IBCNT,IEN2,IEN2312,NODE,WINS,X12CODE
"RTN","IBY377PO",69,0)
 D BMES^XPDUTL(" STEP 3 of "_XPDIDTOT)
"RTN","IBY377PO",70,0)
 D MES^XPDUTL("-------------")
"RTN","IBY377PO",71,0)
 D MES^XPDUTL("Updating new patient relationship field in PATIENT file...")
"RTN","IBY377PO",72,0)
 ; If this patch has been installed before, then this update has already been completed.
"RTN","IBY377PO",73,0)
 I $$ICPLT() D MES^XPDUTL(" This field has already been updated. No further action.") G REL2X
"RTN","IBY377PO",74,0)
 D MES^XPDUTL("Each ""."" represents 10,000 records.")
"RTN","IBY377PO",75,0)
 D MES^XPDUTL("")
"RTN","IBY377PO",76,0)
 S (IEN2,IBCNT)=0 F  S IEN2=$O(^DPT(IEN2)) Q:IEN2?1.A!(IEN2="")  D
"RTN","IBY377PO",77,0)
 .S IBCNT=IBCNT+1 W:(IBCNT#10000=0)&'$D(ZTQUEUED) "."
"RTN","IBY377PO",78,0)
 .Q:'$D(^DPT(IEN2,.312))  ; make sure file 2.312 exists for this patient
"RTN","IBY377PO",79,0)
 .S IEN2312=0 F  S IEN2312=$O(^DPT(IEN2,.312,IEN2312)) Q:IEN2312?1.A!(IEN2312="")  D
"RTN","IBY377PO",80,0)
 ..S NODE=$G(^DPT(IEN2,.312,IEN2312,0)),X12CODE=$$PRELCNV^IBCNSP1($P(NODE,U,16),1)
"RTN","IBY377PO",81,0)
 ..; if we couldn't find a match, try to use WHOSE INSURANCE field
"RTN","IBY377PO",82,0)
 ..S:X12CODE="" WINS=$P(NODE,U,6),X12CODE=$S(WINS="v":"18",WINS="s":"01",1:"")
"RTN","IBY377PO",83,0)
 ..Q:X12CODE=""  ; still no valid code - skip this record
"RTN","IBY377PO",84,0)
 ..N DIE,DR,DA
"RTN","IBY377PO",85,0)
 ..S DIE="^DPT("_IEN2_",.312,",DA=IEN2312,DA(1)=IEN2,DR="4.03////"_X12CODE D ^DIE
"RTN","IBY377PO",86,0)
 ..Q
"RTN","IBY377PO",87,0)
 .Q
"RTN","IBY377PO",88,0)
 D MES^XPDUTL(" Done.")
"RTN","IBY377PO",89,0)
REL2X ;
"RTN","IBY377PO",90,0)
 D UPDATE^XPDID(3)
"RTN","IBY377PO",91,0)
 D CLEAN^DILF
"RTN","IBY377PO",92,0)
 Q
"RTN","IBY377PO",93,0)
 ;
"RTN","IBY377PO",94,0)
REL355 ; Populate new pt. relation field 355.33/60.14
"RTN","IBY377PO",95,0)
 ;
"RTN","IBY377PO",96,0)
 N IEN355,NODE,WINS,X12CODE
"RTN","IBY377PO",97,0)
 D BMES^XPDUTL(" STEP 4 of "_XPDIDTOT)
"RTN","IBY377PO",98,0)
 D MES^XPDUTL("-------------")
"RTN","IBY377PO",99,0)
 D MES^XPDUTL("Updating new patient relationship field in INSURANCE BUFFER file...")
"RTN","IBY377PO",100,0)
 ; If this patch has been installed before, then this update has already been completed.
"RTN","IBY377PO",101,0)
 I $$ICPLT() D MES^XPDUTL(" This field has already been updated. No further action.") G REL355X
"RTN","IBY377PO",102,0)
 S IEN355=0 F  S IEN355=$O(^IBA(355.33,IEN355)) Q:IEN355?1.A!(IEN355="")  D
"RTN","IBY377PO",103,0)
 .S NODE=$G(^IBA(355.33,IEN355,60)) Q:NODE=""  ; make sure that node 60 of file 355.33 exists
"RTN","IBY377PO",104,0)
 .S X12CODE=$$PRELCNV^IBCNSP1($P(NODE,U,6),1)
"RTN","IBY377PO",105,0)
 .; if we couldn't find a match, try to use WHOSE INSURANCE field
"RTN","IBY377PO",106,0)
 .S:X12CODE="" WINS=$P(NODE,U,5),X12CODE=$S(WINS="v":"18",WINS="s":"01",1:"")
"RTN","IBY377PO",107,0)
 .Q:X12CODE=""  ; still no valid code - skip this record
"RTN","IBY377PO",108,0)
 .N DIE,DR,DA
"RTN","IBY377PO",109,0)
 .S DIE=355.33,DA=IEN355,DR="60.14////"_X12CODE D ^DIE
"RTN","IBY377PO",110,0)
 .Q
"RTN","IBY377PO",111,0)
 D MES^XPDUTL(" Done.")
"RTN","IBY377PO",112,0)
REL355X ;
"RTN","IBY377PO",113,0)
 D UPDATE^XPDID(4)
"RTN","IBY377PO",114,0)
 D CLEAN^DILF
"RTN","IBY377PO",115,0)
 Q
"RTN","IBY377PO",116,0)
 ;
"RTN","IBY377PO",117,0)
ICPLT() ; Returns 1 if this patch has been successfully installed before, 0 otherwise
"RTN","IBY377PO",118,0)
 N I,ICPLT,INST
"RTN","IBY377PO",119,0)
 D FIND^DIC(9.7,,"@;.02I","QPX","IB*2.0*377",,,,,"INST")
"RTN","IBY377PO",120,0)
 S (I,ICPLT)=0 F  S I=$O(INST("DILIST",I)) Q:I=""  S:+$P(INST("DILIST",I,0),U,2)=3 ICPLT=1 Q:ICPLT
"RTN","IBY377PO",121,0)
 Q ICPLT
"RTN","IBY377PO",122,0)
 ;
"RTN","IBY377PO",123,0)
EMAIL ; Send an email message to Austin FSC to let them know this site has installed IB patch 377
"RTN","IBY377PO",124,0)
 NEW SITE,SUBJ,MSG,XMTO,LN,GLO,GLB
"RTN","IBY377PO",125,0)
 D BMES^XPDUTL(" STEP 5 of "_XPDIDTOT)
"RTN","IBY377PO",126,0)
 D MES^XPDUTL("-------------")
"RTN","IBY377PO",127,0)
 D MES^XPDUTL("Sending email notification to Austin FSC ... ")
"RTN","IBY377PO",128,0)
 I '$$PROD^XUPROD(1) D MES^XPDUTL("No email sent for test account installation.") G EMAILX
"RTN","IBY377PO",129,0)
 S SITE=$$SITE^VASITE
"RTN","IBY377PO",130,0)
 S SUBJ="IB*2*377 installed at Station# "_$P(SITE,U,3)_" - "_$P(SITE,U,2)
"RTN","IBY377PO",131,0)
 S SUBJ=$E(SUBJ,1,65)
"RTN","IBY377PO",132,0)
 S MSG(1)="VistA patch IB*2.0*377 was installed successfully at the following site:"
"RTN","IBY377PO",133,0)
 S MSG(2)=""
"RTN","IBY377PO",134,0)
 S MSG(3)="        Name: "_$P(SITE,U,2)
"RTN","IBY377PO",135,0)
 S MSG(4)="    Station#: "_$P(SITE,U,3)
"RTN","IBY377PO",136,0)
 S MSG(5)="      Domain: "_$G(^XMB("NETNAME"))
"RTN","IBY377PO",137,0)
 S MSG(6)="   Date/Time: "_$$FMTE^XLFDT($$NOW^XLFDT,"5ZPM")
"RTN","IBY377PO",138,0)
 S MSG(7)=""
"RTN","IBY377PO",139,0)
 S MSG(8)="This patch is eClaims Plus Iteration 3, Phase 2."
"RTN","IBY377PO",140,0)
 ;
"RTN","IBY377PO",141,0)
 S XMTO("fsc.edi-team@va.gov")=""
"RTN","IBY377PO",142,0)
 S XMTO("Eric.Gustafson@va.gov")=""
"RTN","IBY377PO",143,0)
 S XMTO("Yan.Gurtovoy@va.gov")=""
"RTN","IBY377PO",144,0)
 S XMTO("Mary.Simons@va.gov")=""
"RTN","IBY377PO",145,0)
 ;
"RTN","IBY377PO",146,0)
 D SENDMSG^XMXAPI(DUZ,SUBJ,"MSG",.XMTO)
"RTN","IBY377PO",147,0)
 I '$D(^TMP("XMERR",$J)) G EMAILX    ; no email problems
"RTN","IBY377PO",148,0)
 ;
"RTN","IBY377PO",149,0)
 D MES^XPDUTL("MailMan problem reported.  Please review messages.")
"RTN","IBY377PO",150,0)
 S SUBJ="IB*2*377 email notification failure"
"RTN","IBY377PO",151,0)
 K MSG S LN=0
"RTN","IBY377PO",152,0)
 S LN=LN+1,MSG(LN)="MailMan reported the following error(s) when attempting to send the"
"RTN","IBY377PO",153,0)
 S LN=LN+1,MSG(LN)="installation notification message for IB patch 377."
"RTN","IBY377PO",154,0)
 S LN=LN+1,MSG(LN)=""
"RTN","IBY377PO",155,0)
 S (GLO,GLB)="^TMP(""XMERR"","_$J
"RTN","IBY377PO",156,0)
 S GLO=GLO_")"
"RTN","IBY377PO",157,0)
 F  S GLO=$Q(@GLO) Q:GLO'[GLB  S LN=LN+1,MSG(LN)="   "_GLO_" = "_$G(@GLO)
"RTN","IBY377PO",158,0)
 S LN=LN+1,MSG(LN)=""
"RTN","IBY377PO",159,0)
 S LN=LN+1,MSG(LN)="Please contact EPS and report this problem by entering a Remedy ticket"
"RTN","IBY377PO",160,0)
 S LN=LN+1,MSG(LN)="or by calling the VA Service Desk (ph. 1-888-596-4357)."
"RTN","IBY377PO",161,0)
 S LN=LN+1,MSG(LN)=""
"RTN","IBY377PO",162,0)
 S LN=LN+1,MSG(LN)="Austin FSC needs to be notified when this patch is installed."
"RTN","IBY377PO",163,0)
 S LN=LN+1,MSG(LN)=""
"RTN","IBY377PO",164,0)
 K XMTO
"RTN","IBY377PO",165,0)
 S XMTO(DUZ)=""
"RTN","IBY377PO",166,0)
 S XMTO("G.PATCHES")=""
"RTN","IBY377PO",167,0)
 D SENDMSG^XMXAPI(DUZ,SUBJ,"MSG",.XMTO)
"RTN","IBY377PO",168,0)
 D MES^XPDUTL(.MSG)
"RTN","IBY377PO",169,0)
 ;
"RTN","IBY377PO",170,0)
EMAILX ;
"RTN","IBY377PO",171,0)
 D MES^XPDUTL(" Done.")
"RTN","IBY377PO",172,0)
 D UPDATE^XPDID(5)
"RTN","IBY377PO",173,0)
 D CLEAN^DILF
"RTN","IBY377PO",174,0)
 Q
"RTN","IBY377PO",175,0)
 ;
"RTN","IBY377PR")
0^^B41295354^n/a
"RTN","IBY377PR",1,0)
IBY377PR ;ALB/ESG - Pre-Installation for IB patch 377 ;26-Nov-2007
"RTN","IBY377PR",2,0)
 ;;2.0;INTEGRATED BILLING;**377**;21-MAR-94;Build 23
"RTN","IBY377PR",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","IBY377PR",4,0)
 ;
"RTN","IBY377PR",5,0)
 D DELOF       ; delete all output formatter data elements included in build
"RTN","IBY377PR",6,0)
 D DELINS      ; delete inactive patient insurance fields and data
"RTN","IBY377PR",7,0)
 D DELIX^DDMOD(364.6,.1,1)   ; delete traditional x-ref
"RTN","IBY377PR",8,0)
 ;
"RTN","IBY377PR",9,0)
 Q
"RTN","IBY377PR",10,0)
 ;
"RTN","IBY377PR",11,0)
 ;
"RTN","IBY377PR",12,0)
DELOF ; Delete included output formatter entries
"RTN","IBY377PR",13,0)
 NEW FILE,DIK,LN,TAG,DATA,PCE,DA,Y
"RTN","IBY377PR",14,0)
 F FILE=5,6,7 S DIK="^IBA(364."_FILE_"," F LN=2:1 S TAG="ENT"_FILE_"+"_LN,DATA=$P($T(@TAG),";;",2) Q:DATA=""  D
"RTN","IBY377PR",15,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA("364."_FILE,DA,0)) D ^DIK
"RTN","IBY377PR",16,0)
 . Q
"RTN","IBY377PR",17,0)
 ;
"RTN","IBY377PR",18,0)
 ; Also delete output formatter entries which are not going to be
"RTN","IBY377PR",19,0)
 ; re-added later.  These are non-functioning or obsolete entries
"RTN","IBY377PR",20,0)
 ; in file 364.6.
"RTN","IBY377PR",21,0)
 S DIK="^IBA(364.6,",TAG="DEL6+2",DATA=$P($T(@TAG),";;",2)
"RTN","IBY377PR",22,0)
 I DATA'="" D
"RTN","IBY377PR",23,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA(364.6,DA,0)) D ^DIK
"RTN","IBY377PR",24,0)
 . Q
"RTN","IBY377PR",25,0)
 ;
"RTN","IBY377PR",26,0)
 ; Also delete output formatter entries which are not going to be
"RTN","IBY377PR",27,0)
 ; re-added later.  These are non-functioning or obsolete entries
"RTN","IBY377PR",28,0)
 ; in file 364.7.
"RTN","IBY377PR",29,0)
 S DIK="^IBA(364.7,",TAG="DEL7+2",DATA=$P($T(@TAG),";;",2)
"RTN","IBY377PR",30,0)
 I DATA'="" D
"RTN","IBY377PR",31,0)
 . F PCE=2:1 S DA=$P(DATA,U,PCE) Q:'DA  I $D(^IBA(364.7,DA,0)) D ^DIK
"RTN","IBY377PR",32,0)
 . Q
"RTN","IBY377PR",33,0)
 ;
"RTN","IBY377PR",34,0)
DELOFX ;
"RTN","IBY377PR",35,0)
 Q
"RTN","IBY377PR",36,0)
 ;
"RTN","IBY377PR",37,0)
DELINS ; This procedure will delete 7 inactive fields from the patient insurance subfile (#2.312)
"RTN","IBY377PR",38,0)
 ; The reason we are doing this is so we can increase the size of the subscriber name field from 30 to 50 chars
"RTN","IBY377PR",39,0)
 ; and we need to make some room.
"RTN","IBY377PR",40,0)
 ; Fields deleted:   7  *RENEWAL DATE
"RTN","IBY377PR",41,0)
 ;                   9  *AGENT'S NAME
"RTN","IBY377PR",42,0)
 ;                  10  *AGENT'S TELEPHONE NUMBER
"RTN","IBY377PR",43,0)
 ;                  11  *AGENT'S STREET
"RTN","IBY377PR",44,0)
 ;                  12  *AGENT'S CITY
"RTN","IBY377PR",45,0)
 ;                  13  *AGENT'S STATE
"RTN","IBY377PR",46,0)
 ;                  14  *AGENT'S ZIP CODE
"RTN","IBY377PR",47,0)
 ; These fields have been inactivated since early 1993, being deleted in 2008.
"RTN","IBY377PR",48,0)
 ;
"RTN","IBY377PR",49,0)
 D BMES^XPDUTL("Removing inactive data from the patient insurance file ... ")
"RTN","IBY377PR",50,0)
 ;
"RTN","IBY377PR",51,0)
 NEW DFN,CNT,POL,PCE,DIK,DA
"RTN","IBY377PR",52,0)
 ;
"RTN","IBY377PR",53,0)
 ; If these fields are already gone, then this process has already been run so get out
"RTN","IBY377PR",54,0)
 I '$$VFIELD^DILFD(2.312,7),'$$VFIELD^DILFD(2.312,9),'$$VFIELD^DILFD(2.312,11) D MES^XPDUTL("   ... Data and Fields already removed.  No further action.")  G DELINSX
"RTN","IBY377PR",55,0)
 ;
"RTN","IBY377PR",56,0)
 D MES^XPDUTL("Each ""."" represents 10,000 patients  ")
"RTN","IBY377PR",57,0)
 S DFN=0,CNT=0
"RTN","IBY377PR",58,0)
 F  S DFN=$O(^DPT(DFN)) Q:'DFN  D
"RTN","IBY377PR",59,0)
 . S CNT=CNT+1 I CNT#10000=0,'$D(ZTQUEUED) W "."
"RTN","IBY377PR",60,0)
 . S POL=0 F  S POL=$O(^DPT(DFN,.312,POL)) Q:'POL  D
"RTN","IBY377PR",61,0)
 .. Q:'$D(^DPT(DFN,.312,POL,0))
"RTN","IBY377PR",62,0)
 .. F PCE=7,9:1:14 S $P(^DPT(DFN,.312,POL,0),U,PCE)=""    ; blank out these 7 pieces
"RTN","IBY377PR",63,0)
 .. Q
"RTN","IBY377PR",64,0)
 . Q
"RTN","IBY377PR",65,0)
 D MES^XPDUTL("   ... Done.")
"RTN","IBY377PR",66,0)
 ;
"RTN","IBY377PR",67,0)
 ; now remove the fields from the DD
"RTN","IBY377PR",68,0)
 D BMES^XPDUTL("Removing inactive fields from the Data Dictionary ... ")
"RTN","IBY377PR",69,0)
 S DIK="^DD(2.312,"
"RTN","IBY377PR",70,0)
 S DA(1)=2.312
"RTN","IBY377PR",71,0)
 F DA=7,9:1:14 D ^DIK
"RTN","IBY377PR",72,0)
 D MES^XPDUTL("   ... Done.")
"RTN","IBY377PR",73,0)
 ;
"RTN","IBY377PR",74,0)
DELINSX ;
"RTN","IBY377PR",75,0)
 Q
"RTN","IBY377PR",76,0)
 ;
"RTN","IBY377PR",77,0)
INCLUDE(FILE,Y) ; function to determine if output formatter entry should be
"RTN","IBY377PR",78,0)
 ; included in the build
"RTN","IBY377PR",79,0)
 ; FILE=5,6,7 indicating file 364.x
"RTN","IBY377PR",80,0)
 ; Y=ien to file
"RTN","IBY377PR",81,0)
 ;
"RTN","IBY377PR",82,0)
 NEW OK,LN,TAG,DATA
"RTN","IBY377PR",83,0)
 S OK=0
"RTN","IBY377PR",84,0)
 F LN=2:1 S TAG="ENT"_FILE_"+"_LN,DATA=$P($T(@TAG),";;",2) Q:DATA=""  I $F(DATA,U_Y_U) S OK=1 Q
"RTN","IBY377PR",85,0)
INCLUDEX ;
"RTN","IBY377PR",86,0)
 Q OK
"RTN","IBY377PR",87,0)
 ;
"RTN","IBY377PR",88,0)
 ;-----------------------------------------------------------------------
"RTN","IBY377PR",89,0)
 ; 364.5 entries modified:
"RTN","IBY377PR",90,0)
 ;
"RTN","IBY377PR",91,0)
ENT5 ; output formatter entries in file 364.5 to be included
"RTN","IBY377PR",92,0)
 ;
"RTN","IBY377PR",93,0)
 ;;
"RTN","IBY377PR",94,0)
 ;
"RTN","IBY377PR",95,0)
 ;-----------------------------------------------------------------------
"RTN","IBY377PR",96,0)
 ; 364.6 entries modified:
"RTN","IBY377PR",97,0)
 ;
"RTN","IBY377PR",98,0)
ENT6 ; output formatter entries in file 364.6 to be included
"RTN","IBY377PR",99,0)
 ;
"RTN","IBY377PR",100,0)
 ;;^1^3^7^9^11^12^14^15^16^17^18^22^26^27^28^29^30^31^32^33^34^35^36^37^38^39^40^42^43^44^45^46^47^48^49^50^51^
"RTN","IBY377PR",101,0)
 ;;^52^53^54^55^56^57^58^59^60^61^62^63^64^65^66^67^70^71^72^73^74^75^76^81^82^83^84^85^86^87^88^89^91^92^93^95^
"RTN","IBY377PR",102,0)
 ;;^96^97^98^99^100^101^102^103^104^105^106^108^109^110^111^112^113^114^115^116^117^118^119^120^121^122^123^124^
"RTN","IBY377PR",103,0)
 ;;^125^126^127^128^129^130^131^132^133^134^135^136^137^138^165^166^167^168^169^170^171^172^173^174^175^177^178^
"RTN","IBY377PR",104,0)
 ;;^179^180^181^182^183^185^186^187^188^189^190^192^194^226^227^230^242^479^481^483^488^579^580^581^582^583^610^
"RTN","IBY377PR",105,0)
 ;;^775^783^784^785^789^790^793^794^795^796^805^808^809^810^811^812^813^814^815^817^818^819^820^821^822^823^825^
"RTN","IBY377PR",106,0)
 ;;^826^828^829^830^831^832^833^834^835^836^837^838^840^841^842^843^844^845^846^847^848^849^850^851^852^854^855^
"RTN","IBY377PR",107,0)
 ;;^856^857^858^859^860^861^862^863^864^866^867^868^869^870^871^872^873^874^875^876^877^879^880^881^882^883^891^
"RTN","IBY377PR",108,0)
 ;;^892^893^894^895^896^897^898^899^900^901^902^903^904^905^906^907^908^909^910^911^912^913^914^915^916^917^918^
"RTN","IBY377PR",109,0)
 ;;^919^920^921^923^924^936^937^938^939^941^942^943^944^945^946^947^948^949^950^952^956^957^960^961^962^964^965^
"RTN","IBY377PR",110,0)
 ;;^968^971^972^973^974^975^976^978^982^985^986^987^988^990^991^992^993^994^999^1002^1005^1006^1007^1009^1011^
"RTN","IBY377PR",111,0)
 ;;^1012^1015^1016^1018^1019^1020^1029^1030^1031^1032^1033^1034^1035^1036^1037^1038^1039^1040^1041^1042^1043^
"RTN","IBY377PR",112,0)
 ;;^1044^1045^1046^1047^1048^1051^1058^1059^1060^1061^1062^1063^1065^1072^1073^1074^1075^1076^1077^1081^1083^1084^
"RTN","IBY377PR",113,0)
 ;;^1085^1086^1087^1088^1089^1090^1091^1094^1095^1096^1097^1098^1099^1100^1101^1102^1103^1104^1107^1108^1110^
"RTN","IBY377PR",114,0)
 ;;^1111^1112^1113^1114^1115^1117^1118^1119^1120^1121^1122^1123^1124^1127^1128^1129^1130^1131^1132^1133^1134^
"RTN","IBY377PR",115,0)
 ;;^1136^1137^1138^1139^1140^1141^1142^1143^1154^1155^1156^1157^1158^1159^1160^1161^1163^1164^1165^1166^1167^
"RTN","IBY377PR",116,0)
 ;;^1168^1169^1170^1172^1173^1174^1175^1176^1177^1178^1179^1181^1182^1183^1184^1185^1186^1187^1188^1191^1192^
"RTN","IBY377PR",117,0)
 ;;^1194^1195^1196^1198^1199^1200^1201^1202^1203^1204^1205^1206^1209^1210^1211^1212^1213^1214^1215^1216^1217^
"RTN","IBY377PR",118,0)
 ;;^1224^1225^1226^1227^1228^1229^1230^1231^1232^1233^1234^1235^1236^1237^1238^1239^1240^1241^1242^1243^1244^
"RTN","IBY377PR",119,0)
 ;;^1245^1246^1247^1248^1249^1250^1251^1252^1253^1254^1255^1256^1257^1258^1259^1260^1261^1262^1263^1277^1278^
"RTN","IBY377PR",120,0)
 ;;^1279^1280^1281^1282^1283^1284^1285^1286^1289^1290^1291^1292^1293^1294^1295^1296^1297^1298^1299^1301^1303^
"RTN","IBY377PR",121,0)
 ;;^1304^1305^1306^1308^1309^1310^1311^1312^1313^1314^1316^1317^1318^1319^1321^1322^1324^1325^1326^1327^1328^1329^
"RTN","IBY377PR",122,0)
 ;;^1330^1331^1332^1333^1334^1335^1336^1337^1338^1339^1801^1802^1803^1804^1805^1806^1807^1808^1810^1811^1812^
"RTN","IBY377PR",123,0)
 ;;^1813^1814^1815^1816^1817^1819^1820^1821^1822^1823^1824^1825^1826^1827^1831^1832^1834^1835^1836^1837^1838^
"RTN","IBY377PR",124,0)
 ;;^1839^1840^1842^1843^1844^1845^1846^1847^1853^1854^1855^1856^1857^1858^1859^1860^1861^1862^1863^1864^1865^
"RTN","IBY377PR",125,0)
 ;;^1866^1867^1868^1869^1870^1871^1872^1873^1874^1875^1876^1877^1878^
"RTN","IBY377PR",126,0)
 ;;
"RTN","IBY377PR",127,0)
 ;
"RTN","IBY377PR",128,0)
 ;
"RTN","IBY377PR",129,0)
 ;-----------------------------------------------------------------------
"RTN","IBY377PR",130,0)
 ; 364.7 entries modified:
"RTN","IBY377PR",131,0)
 ;
"RTN","IBY377PR",132,0)
ENT7 ; output formatter entries in file 364.7 to be included
"RTN","IBY377PR",133,0)
 ;
"RTN","IBY377PR",134,0)
 ;;^1^2^24^114^144^154^186^197^198^326^333^334^358^359^360^481^482^843^1028^1362^1553^1554^1555^
"RTN","IBY377PR",135,0)
 ;;^1556^1557^1558^1559^1560^1561^1562^1563^1564^
"RTN","IBY377PR",136,0)
 ;;^1565^1566^1567^1568^1569^1570^1571^1572^1573^1574^1575^1576^1577^1578^
"RTN","IBY377PR",137,0)
 ;;
"RTN","IBY377PR",138,0)
 ;
"RTN","IBY377PR",139,0)
 ;
"RTN","IBY377PR",140,0)
 ;-----------------------------------------------------------------------
"RTN","IBY377PR",141,0)
DEL6 ; remove output formatter entries in file 364.6 (not re-added)
"RTN","IBY377PR",142,0)
 ;
"RTN","IBY377PR",143,0)
 ;;^94^154^247^577^578^
"RTN","IBY377PR",144,0)
 ;;
"RTN","IBY377PR",145,0)
 ;
"RTN","IBY377PR",146,0)
 ;-----------------------------------------------------------------------
"RTN","IBY377PR",147,0)
DEL7 ; remove output formatter entries in file 364.7 (not re-added)
"RTN","IBY377PR",148,0)
 ;
"RTN","IBY377PR",149,0)
 ;;^83^109^238^476^477^
"RTN","IBY377PR",150,0)
 ;;
"RTN","IBY377PR",151,0)
 ;
"UP",2,2.312,-1)
2^.312
"UP",2,2.312,0)
2.312
"UP",399,399.042,-1)
399^RC
"UP",399,399.042,0)
399.042
"UP",399,399.077,-1)
399^TXC
"UP",399,399.077,0)
399.077
"UP",399,399.0771,-2)
399^TXC
"UP",399,399.0771,-1)
399.077^1
"UP",399,399.0771,0)
399.0771
"VER")
8.0^22.0
"^DD",2,2.312,4.03,0)
PT. RELATIONSHIP - HIPAA^RS^01:SPOUSE;18:SELF;19:CHILD;20:EMPLOYEE;29:SIGNIFICANT OTHER;32:MOTHER;33:FATHER;39:ORGAN DONOR;41:INJURED PLAINTIFF;53:LIFE PARTNER;G8:OTHER RELATIONSHIP;^4;3^Q
"^DD",2,2.312,4.03,1,0)
^.1
"^DD",2,2.312,4.03,1,1,0)
^^TRIGGER^2.312^16
"^DD",2,2.312,4.03,1,1,1)
X ^DD(2.312,4.03,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^DPT(D0,.312,D1,0)):^(0),1:"") S X=$P(Y(1),U,16),X=X S DIU=X K Y S X=DIV S X=$$PRELCNV^IBCNSP1($P(^DPT(DA(1),.312,DA,4),U,3),0) X ^DD(2.312,4.03,1,1,1.4)
"^DD",2,2.312,4.03,1,1,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 N Z S Z=$$PRELCNV^IBCNSP1($P(^DPT(D0,.312,D1,4),U,3),0),X=(Z'=""&(Z'=$P(^DPT(D0,.312,D1,0),U,16)))
"^DD",2,2.312,4.03,1,1,1.4)
S DIH=$G(^DPT(DIV(0),.312,DIV(1),0)),DIV=X S $P(^(0),U,16)=DIV,DIH=2.312,DIG=16 D ^DICR
"^DD",2,2.312,4.03,1,1,2)
Q
"^DD",2,2.312,4.03,1,1,"%D",0)
^^1^1^3080204^
"^DD",2,2.312,4.03,1,1,"%D",1,0)
Triggers field 16 if its value differs from value in this field.
"^DD",2,2.312,4.03,1,1,"CREATE CONDITION")
N Z S Z=$$PRELCNV^IBCNSP1($P(^DPT(D0,.312,D1,4),U,3),0),X=(Z'=""&(Z'=$P(^DPT(D0,.312,D1,0),U,16)))
"^DD",2,2.312,4.03,1,1,"CREATE VALUE")
S X=$$PRELCNV^IBCNSP1($P(^DPT(DA(1),.312,DA,4),U,3),0)
"^DD",2,2.312,4.03,1,1,"DELETE VALUE")
NO EFFECT
"^DD",2,2.312,4.03,1,1,"DT")
3071203
"^DD",2,2.312,4.03,1,1,"FIELD")
#16
"^DD",2,2.312,4.03,3)
Select the HIPAA relationship code that describes the relationship this patient has to the holder of this insurance policy.
"^DD",2,2.312,4.03,5,1,0)
2.312^16^2
"^DD",2,2.312,4.03,21,0)
^^2^2^3080108^
"^DD",2,2.312,4.03,21,1,0)
Enter the code which best describes the patient's relationship
"^DD",2,2.312,4.03,21,2,0)
to the person who holds this policy (or insured).
"^DD",2,2.312,4.03,"DT")
3080108
"^DD",2,2.312,16,0)
PT. RELATIONSHIP TO INSURED^R*S^01:PATIENT;02:SPOUSE;03:NATURAL CHILD;08:EMPLOYEE;09:DO NOT USE;11:ORGAN DONOR;15:INJURED PLANTIFF;18:DO NOT USE;32:MOTHER;33:FATHER;34:SIGNIFICANT OTHER;35:LIFE PARTNER;36:OTHER RELATIONSHIP;^0;16^Q
"^DD",2,2.312,16,1,0)
^.1
"^DD",2,2.312,16,1,1,0)
^^TRIGGER^2.312^6
"^DD",2,2.312,16,1,1,1)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^DPT(D0,.312,D1,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X=DIV S X=$S(+X=1:"v",+X=2:"s",1:"o") X ^DD(2.312,16,1,1,1.4)
"^DD",2,2.312,16,1,1,1.4)
S DIH=$G(^DPT(DIV(0),.312,DIV(1),0)),DIV=X S $P(^(0),U,6)=DIV,DIH=2.312,DIG=6 D ^DICR
"^DD",2,2.312,16,1,1,2)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^DPT(D0,.312,D1,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" S DIH=$G(^DPT(DIV(0),.312,DIV(1),0)),DIV=X S $P(^(0),U,6)=DIV,DIH=2.312,DIG=6 D ^DICR
"^DD",2,2.312,16,1,1,"%D",0)
^^2^2^3070611^
"^DD",2,2.312,16,1,1,"%D",1,0)
This trigger will set the WHOSE INSURANCE field (#6).  WHOSE INSURANCE 
"^DD",2,2.312,16,1,1,"%D",2,0)
will no longer be asked on user interface screens.
"^DD",2,2.312,16,1,1,"CREATE VALUE")
S X=$S(+X=1:"v",+X=2:"s",1:"o")
"^DD",2,2.312,16,1,1,"DELETE VALUE")
@
"^DD",2,2.312,16,1,1,"DT")
3070611
"^DD",2,2.312,16,1,1,"FIELD")
WHOSE INSURANCE
"^DD",2,2.312,16,1,2,0)
^^TRIGGER^2.312^4.03
"^DD",2,2.312,16,1,2,1)
X ^DD(2.312,16,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^DPT(D0,.312,D1,4)):^(4),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=$$PRELCNV^IBCNSP1($P(^DPT(DA(1),.312,DA,0),U,16),1) X ^DD(2.312,16,1,2,1.4)
"^DD",2,2.312,16,1,2,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 N Z S Z=$$PRELCNV^IBCNSP1($P(^DPT(D0,.312,D1,0),U,16),1),X=(Z'=""&(Z'=$P($G(^DPT(D0,.312,D1,4)),U,3)))
"^DD",2,2.312,16,1,2,1.4)
S DIH=$G(^DPT(DIV(0),.312,DIV(1),4)),DIV=X S $P(^(4),U,3)=DIV,DIH=2.312,DIG=4.03 D ^DICR
"^DD",2,2.312,16,1,2,2)
Q
"^DD",2,2.312,16,1,2,"%D",0)
^^1^1^3080204^
"^DD",2,2.312,16,1,2,"%D",1,0)
Triggers field 4.03 if its value differs from value in this field.
"^DD",2,2.312,16,1,2,"CREATE CONDITION")
N Z S Z=$$PRELCNV^IBCNSP1($P(^DPT(D0,.312,D1,0),U,16),1),X=(Z'=""&(Z'=$P($G(^DPT(D0,.312,D1,4)),U,3)))
"^DD",2,2.312,16,1,2,"CREATE VALUE")
S X=$$PRELCNV^IBCNSP1($P(^DPT(DA(1),.312,DA,0),U,16),1)
"^DD",2,2.312,16,1,2,"DELETE VALUE")
NO EFFECT
"^DD",2,2.312,16,1,2,"DT")
3071203
"^DD",2,2.312,16,1,2,"FIELD")
#4.03
"^DD",2,2.312,16,3)
Enter the code which indicates the patient's relationship to the insured party.
"^DD",2,2.312,16,5,1,0)
2.312^4.03^1
"^DD",2,2.312,16,12)
Cannot use 09 or 18 anymore
"^DD",2,2.312,16,12.1)
S DIC("S")="I X'=""09"",X'=""18"""
"^DD",2,2.312,16,21,0)
^.001^4^4^3030910^^^^
"^DD",2,2.312,16,21,1,0)
Select the relationship code that describes the relationship this
"^DD",2,2.312,16,21,2,0)
patient has to the holder of this insurance policy. If the policy
"^DD",2,2.312,16,21,3,0)
belongs to the patient enter '01' for patient. If the policy
"^DD",2,2.312,16,21,4,0)
belongs to the spouse enter '02' for spouse, etc.
"^DD",2,2.312,16,"DT")
3071203
"^DD",2,2.312,17,0)
NAME OF INSURED^RFX^^0;17^K:$L(X)>50!($L(X)<2) X K:$G(X)'["," X
"^DD",2,2.312,17,1,0)
^.1
"^DD",2,2.312,17,1,1,0)
2.312^AENR17^MUMPS
"^DD",2,2.312,17,1,1,1)
D EVENT^IVMPLOG($G(DA(1)))
"^DD",2,2.312,17,1,1,2)
D EVENT^IVMPLOG($G(DA(1)))
"^DD",2,2.312,17,1,1,3)
 DO NOT DELETE
"^DD",2,2.312,17,1,1,"%D",0)
^.101^2^2^3050913^^^^
"^DD",2,2.312,17,1,1,"%D",1,0)
This cross-reference is used to notify HEC of changes that may affect
"^DD",2,2.312,17,1,1,"%D",2,0)
enrollment.
"^DD",2,2.312,17,1,1,"DT")
3050913
"^DD",2,2.312,17,3)
ENTER 2-50 CHARACTER NAME OF PERSON WHO HOLDS THIS INSURANCE POLICY
"^DD",2,2.312,17,21,0)
^^5^5^3080124^
"^DD",2,2.312,17,21,1,0)
Enter the name of the individual for which this insurance policy was
"^DD",2,2.312,17,21,2,0)
issued.  If the patient and the insurance subscriber are the same,
"^DD",2,2.312,17,21,3,0)
then this field will be defaulted from the patient name field.
"^DD",2,2.312,17,21,4,0)
 
"^DD",2,2.312,17,21,5,0)
The name must contain a comma and be entered in Last,First format.
"^DD",2,2.312,17,"DT")
3080124
"^DD",350.8,350.8,0)
FIELD^^10^7
"^DD",350.8,350.8,0,"DDA")
N
"^DD",350.8,350.8,0,"DT")
2930322
"^DD",350.8,350.8,0,"ID",.03)
W "   ",$P(^(0),U,3)
"^DD",350.8,350.8,0,"IX","AC",350.8,.03)

"^DD",350.8,350.8,0,"IX","B",350.8,.01)

"^DD",350.8,350.8,0,"IX","C",350.8,.03)

"^DD",350.8,350.8,0,"NM","IB ERROR")
 
"^DD",350.8,350.8,0,"VRPK")
IB
"^DD",350.8,350.8,.01,0)
NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",350.8,350.8,.01,1,0)
^.1
"^DD",350.8,350.8,.01,1,1,0)
350.8^B
"^DD",350.8,350.8,.01,1,1,1)
S ^IBE(350.8,"B",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.01,1,1,2)
K ^IBE(350.8,"B",$E(X,1,30),DA)
"^DD",350.8,350.8,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",350.8,350.8,.01,21,0)
^^2^2^2910305^^
"^DD",350.8,350.8,.01,21,1,0)
This is a free text name of the entry.  It should be namespaced with
"^DD",350.8,350.8,.01,21,2,0)
the namespace of the package reporting the error.
"^DD",350.8,350.8,.02,0)
ERROR MESSAGE^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",350.8,350.8,.02,3)
Answer must be 3-80 characters in length.
"^DD",350.8,350.8,.02,21,0)
^^3^3^2940209^^^^
"^DD",350.8,350.8,.02,21,1,0)
This is the text of the message as it will be displayed to a user or
"^DD",350.8,350.8,.02,21,2,0)
posted in a bulletin.  It should be as meaningful as possible to the
"^DD",350.8,350.8,.02,21,3,0)
person seeing the message.
"^DD",350.8,350.8,.03,0)
ERROR CODE^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>9!($L(X)<1) X
"^DD",350.8,350.8,.03,1,0)
^.1
"^DD",350.8,350.8,.03,1,1,0)
350.8^AC
"^DD",350.8,350.8,.03,1,1,1)
S ^IBE(350.8,"AC",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,1,2)
K ^IBE(350.8,"AC",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,1,2,0)
350.8^C
"^DD",350.8,350.8,.03,1,2,1)
S ^IBE(350.8,"C",$E(X,1,30),DA)=""
"^DD",350.8,350.8,.03,1,2,2)
K ^IBE(350.8,"C",$E(X,1,30),DA)
"^DD",350.8,350.8,.03,3)
Answer must be 1-9 characters in length.
"^DD",350.8,350.8,.03,21,0)
^^9^9^2920219^^^^
"^DD",350.8,350.8,.03,21,1,0)
This is the error code that will be passed to or determined by
"^DD",350.8,350.8,.03,21,2,0)
Integrated Billing.  The format for the Error Code should be
"^DD",350.8,350.8,.03,21,3,0)
nnxxx, where nn is the reporting package namespace and xxx are numeric
"^DD",350.8,350.8,.03,21,4,0)
values.
"^DD",350.8,350.8,.03,21,5,0)
 
"^DD",350.8,350.8,.03,21,6,0)
This is the error code that will be passed as the second piece of
"^DD",350.8,350.8,.03,21,7,0)
the variable Y to IB when +Y=-1.  More than one error code can be
"^DD",350.8,350.8,.03,21,8,0)
placed in the second ^ piece of Y delimited by semi-colons.  Applications
"^DD",350.8,350.8,.03,21,9,0)
may call ^IBAERR to display the error message(s).
"^DD",350.8,350.8,.03,"DT")
2920219
"^DD",350.8,350.8,.04,0)
PACKAGE REPORTING ERROR^S^1:INTEGRATED BILLING;2:ACCOUNTS RECEIVABLE;3:PHARMACY;^0;4^Q
"^DD",350.8,350.8,.04,21,0)
^^2^2^2920415^^^
"^DD",350.8,350.8,.04,21,1,0)
This is the package that requested this entry in this file and will
"^DD",350.8,350.8,.04,21,2,0)
report it to IB as an error if the conditions are detected.
"^DD",350.8,350.8,.05,0)
ERROR ACTION^S^1:DISPLAY MESSAGE;2:SEND BULLETIN;3:EDIT FILE;^0;5^Q
"^DD",350.8,350.8,.05,21,0)
^^6^6^2910227^
"^DD",350.8,350.8,.05,21,1,0)
This is the type of action that should be taken when this error is
"^DD",350.8,350.8,.05,21,2,0)
reported to IB.  If action other than displaying a message is indicated
"^DD",350.8,350.8,.05,21,3,0)
then the MUMPS code in the ERROR ACTION field will be executed.
"^DD",350.8,350.8,.05,21,4,0)
 
"^DD",350.8,350.8,.05,21,5,0)
Currently only display actions are implemented.  Please contact the 
"^DD",350.8,350.8,.05,21,6,0)
developing ISC if other action types are desired.
"^DD",350.8,350.8,.06,0)
CORRESPONDING ALERT^P354.5'^IBE(354.5,^0;6^Q
"^DD",350.8,350.8,.06,21,0)
^^1^1^2940209^
"^DD",350.8,350.8,.06,21,1,0)
This is the type of alert that should be sent when this error occurs.
"^DD",350.8,350.8,.06,"DT")
2930322
"^DD",350.8,350.8,10,0)
EXECUTABLE LOGIC^K^^10;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",350.8,350.8,10,3)
This is Standard MUMPS code.
"^DD",350.8,350.8,10,21,0)
^^2^2^2910227^
"^DD",350.8,350.8,10,21,1,0)
This is the MUMPS code that will be executed if an error is reported
"^DD",350.8,350.8,10,21,2,0)
with an ERROR ACTION of other than to display a message.
"^DD",350.9,350.9,1.04,0)
*REMARKS ON EACH EDI CLAIM^F^^1;4^K:$L(X)>39!($L(X)<2) X
"^DD",350.9,350.9,1.04,3)
Enter any facility specific remarks to appear in the CCOM segment of the electronic transmission. Answer must be 2-39 characters in length.
"^DD",350.9,350.9,1.04,21,0)
^^5^5^3071203^
"^DD",350.9,350.9,1.04,21,1,0)
This remark will appear in the CCOM segment of the electronic 
"^DD",350.9,350.9,1.04,21,2,0)
transmission.
"^DD",350.9,350.9,1.04,21,3,0)
 
"^DD",350.9,350.9,1.04,21,4,0)
November 2007:  This field is being removed from the IB site parameter 
"^DD",350.9,350.9,1.04,21,5,0)
screen with IB patch 377.   The CCOM segment is no longer being sent.
"^DD",350.9,350.9,1.04,"DT")
3071203
"^DD",355.33,355.33,60.06,0)
PT. RELATIONSHIP TO INSURED^*S^01:PATIENT;02:SPOUSE;03:NATURAL CHILD;08:EMPLOYEE;09:DO NOT USE;11:ORGAN DONOR;15:INJURED PLANTIFF;18:DO NOT USE;32:MOTHER;33:FATHER;34:SIGNIFICANT OTHER;35:LIFE PARTNER;36:OTHER RELATIONSHIP;^60;6^Q
"^DD",355.33,355.33,60.06,1,0)
^.1
"^DD",355.33,355.33,60.06,1,1,0)
355.33^AI1^MUMPS
"^DD",355.33,355.33,60.06,1,1,1)
Q
"^DD",355.33,355.33,60.06,1,1,2)
Q
"^DD",355.33,355.33,60.06,1,1,"%D",0)
^^1^1^2981017^
"^DD",355.33,355.33,60.06,1,1,"%D",1,0)
Cross reference to force filing of data so input transform will work.
"^DD",355.33,355.33,60.06,1,1,"DT")
2981017
"^DD",355.33,355.33,60.06,1,2,0)
^^TRIGGER^355.33^60.14
"^DD",355.33,355.33,60.06,1,2,1)
X ^DD(355.33,60.06,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(355.33,D0,60)):^(60),1:"") S X=$P(Y(1),U,14),X=X S DIU=X K Y S X=DIV S X=$$PRELCNV^IBCNSP1($P(^IBA(355.33,DA,60),U,6),1) X ^DD(355.33,60.06,1,2,1.4)
"^DD",355.33,355.33,60.06,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 N Z S Z=$$PRELCNV^IBCNSP1($P(^IBA(355.33,D0,60),U,6),1),X=(Z'=""&(Z'=$P(^IBA(355.33,D0,60),U,14)))
"^DD",355.33,355.33,60.06,1,2,1.4)
S DIH=$G(^IBA(355.33,DIV(0),60)),DIV=X S $P(^(60),U,14)=DIV,DIH=355.33,DIG=60.14 D ^DICR
"^DD",355.33,355.33,60.06,1,2,2)
Q
"^DD",355.33,355.33,60.06,1,2,"%D",0)
^.101^1^1^3080204^^
"^DD",355.33,355.33,60.06,1,2,"%D",1,0)
Triggers field 60.14 if its value differs from value in this field.
"^DD",355.33,355.33,60.06,1,2,"CREATE CONDITION")
N Z S Z=$$PRELCNV^IBCNSP1($P(^IBA(355.33,D0,60),U,6),1),X=(Z'=""&(Z'=$P(^IBA(355.33,D0,60),U,14)))
"^DD",355.33,355.33,60.06,1,2,"CREATE VALUE")
S X=$$PRELCNV^IBCNSP1($P(^IBA(355.33,DA,60),U,6),1)
"^DD",355.33,355.33,60.06,1,2,"DELETE VALUE")
NO EFFECT
"^DD",355.33,355.33,60.06,1,2,"DT")
3071211
"^DD",355.33,355.33,60.06,1,2,"FIELD")
#60.14
"^DD",355.33,355.33,60.06,1,3,0)
^^TRIGGER^355.33^60.05
"^DD",355.33,355.33,60.06,1,3,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^IBA(355.33,D0,60)):^(60),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X=DIV S X=$S(+X=1:$S($G(DUZ("AG"))="V":"v",1:"p"),+X=2:"s",1:"o") X ^DD(355.33,60.06,1,3,1.4)
"^DD",355.33,355.33,60.06,1,3,1.4)
S DIH=$G(^IBA(355.33,DIV(0),60)),DIV=X S $P(^(60),U,5)=DIV,DIH=355.33,DIG=60.05 D ^DICR
"^DD",355.33,355.33,60.06,1,3,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^IBA(355.33,D0,60)):^(60),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X="" S DIH=$G(^IBA(355.33,DIV(0),60)),DIV=X S $P(^(60),U,5)=DIV,DIH=355.33,DIG=60.05 D ^DICR
"^DD",355.33,355.33,60.06,1,3,"%D",0)
^^3^3^3080207^
"^DD",355.33,355.33,60.06,1,3,"%D",1,0)
This trigger will set the WHOSE INSURANCE field
"^DD",355.33,355.33,60.06,1,3,"%D",2,0)
(60.05). WHOSE INSURANCE will no longer be asked
"^DD",355.33,355.33,60.06,1,3,"%D",3,0)
on user interface screens.
"^DD",355.33,355.33,60.06,1,3,"CREATE VALUE")
S X=$S(+X=1:$S($G(DUZ("AG"))="V":"v",1:"p"),+X=2:"s",1:"o")
"^DD",355.33,355.33,60.06,1,3,"DELETE VALUE")
@
"^DD",355.33,355.33,60.06,1,3,"DT")
3080207
"^DD",355.33,355.33,60.06,1,3,"FIELD")
#60.05
"^DD",355.33,355.33,60.06,3)
Enter the code for the patient's relationship to the insured (or policy holder).
"^DD",355.33,355.33,60.06,5,1,0)
355.33^60.14^1
"^DD",355.33,355.33,60.06,12)
Cannot use 09 or 18 anymore
"^DD",355.33,355.33,60.06,12.1)
S DIC("S")="I X'=""09"",X'=""18"""
"^DD",355.33,355.33,60.06,21,0)
^^2^2^3070713^
"^DD",355.33,355.33,60.06,21,1,0)
Enter the code which best describes the patient's relationship to
"^DD",355.33,355.33,60.06,21,2,0)
the person who holds this policy (or insured).
"^DD",355.33,355.33,60.06,"DT")
3080207
"^DD",355.33,355.33,60.14,0)
PT. RELATIONSHIP - HIPAA^S^01:SPOUSE;18:SELF;19:CHILD;20:EMPLOYEE;29:SIGNIFICANT OTHER;32:MOTHER;33:FATHER;39:ORGAN DONOR;41:INJURED PLAINTIFF;53:LIFE PARTNER;G8:OTHER RELATIONSHIP;^60;14^Q
"^DD",355.33,355.33,60.14,1,0)
^.1
"^DD",355.33,355.33,60.14,1,1,0)
^^TRIGGER^355.33^60.06
"^DD",355.33,355.33,60.14,1,1,1)
X ^DD(355.33,60.14,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(355.33,D0,60)):^(60),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X=DIV S X=$$PRELCNV^IBCNSP1($P(^IBA(355.33,DA,60),U,14),0) X ^DD(355.33,60.14,1,1,1.4)
"^DD",355.33,355.33,60.14,1,1,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 N Z S Z=$$PRELCNV^IBCNSP1($P(^IBA(355.33,D0,60),U,14),0),X=(Z'=""&(Z'=$P(^IBA(355.33,D0,60),U,6)))
"^DD",355.33,355.33,60.14,1,1,1.4)
S DIH=$G(^IBA(355.33,DIV(0),60)),DIV=X S $P(^(60),U,6)=DIV,DIH=355.33,DIG=60.06 D ^DICR
"^DD",355.33,355.33,60.14,1,1,2)
Q
"^DD",355.33,355.33,60.14,1,1,"%D",0)
^^1^1^3080204^
"^DD",355.33,355.33,60.14,1,1,"%D",1,0)
Triggers field 60.06 if its value differs from value in this field.
"^DD",355.33,355.33,60.14,1,1,"CREATE CONDITION")
N Z S Z=$$PRELCNV^IBCNSP1($P(^IBA(355.33,D0,60),U,14),0),X=(Z'=""&(Z'=$P(^IBA(355.33,D0,60),U,6)))
"^DD",355.33,355.33,60.14,1,1,"CREATE VALUE")
S X=$$PRELCNV^IBCNSP1($P(^IBA(355.33,DA,60),U,14),0)
"^DD",355.33,355.33,60.14,1,1,"DELETE VALUE")
NO EFFECT
"^DD",355.33,355.33,60.14,1,1,"FIELD")
PT. RELATIONSHIP TO INSURED
"^DD",355.33,355.33,60.14,3)
Enter the HIPAA code which indicates the patient's relationship to the injured party.
"^DD",355.33,355.33,60.14,5,1,0)
355.33^60.06^2
"^DD",355.33,355.33,60.14,21,0)
^^6^6^3080204^
"^DD",355.33,355.33,60.14,21,1,0)
Select the HIPAA relationship code that
"^DD",355.33,355.33,60.14,21,2,0)
describes the relationship this patient has to
"^DD",355.33,355.33,60.14,21,3,0)
the holder of this insurance policy. If the
"^DD",355.33,355.33,60.14,21,4,0)
policy belongs to the patient enter '18' for
"^DD",355.33,355.33,60.14,21,5,0)
SELF. If the policy belongs to the spouse enter
"^DD",355.33,355.33,60.14,21,6,0)
'01' for SPOUSE, etc.
"^DD",355.33,355.33,60.14,"DT")
3080204
"^DD",356,356,1.08,0)
ADDITIONAL COMMENT^F^^1;8^K:$L(X)>80!($L(X)<3) X
"^DD",356,356,1.08,3)
If necessary, use this field for a brief additional explanation of why this case isn't billable.  Answer must be 3-80 characters in length.
"^DD",356,356,1.08,21,0)
^^2^2^3071228^
"^DD",356,356,1.08,21,1,0)
Enter any brief comment about this episode that may explain why
"^DD",356,356,1.08,21,2,0)
a case is not billable.
"^DD",356,356,1.08,"DT")
3071228
"^DD",361.1,361.1,6.03,0)
CORRECTED DATA MESSAGE^F^^6;3^K:$L(X)>190!($L(X)<1) X
"^DD",361.1,361.1,6.03,3)
Answer must be 1-190 characters in length
"^DD",361.1,361.1,6.03,21,0)
^^5^5^3080116^
"^DD",361.1,361.1,6.03,21,1,0)
This is a free text message describing the results of the processing of 
"^DD",361.1,361.1,6.03,21,2,0)
the "06" record type on the incoming 835 transmission.  The "06" record 
"^DD",361.1,361.1,6.03,21,3,0)
type is where the payer can send back the corrected patient name and/or 
"^DD",361.1,361.1,6.03,21,4,0)
the corrected patient ID#.  VistA will accept this information and 
"^DD",361.1,361.1,6.03,21,5,0)
attempt to the update the patient insurance files with this data.
"^DD",361.1,361.1,6.03,"DT")
3080116
"^DD",361.1,361.1,61.01,0)
ORIGINAL 06 RECORD DATA^F^^6.1;E1,200^K:$L(X)>200!($L(X)<1) X
"^DD",361.1,361.1,61.01,3)
Answer must be 1-200 characters in length
"^DD",361.1,361.1,61.01,21,0)
^^3^3^3080117^
"^DD",361.1,361.1,61.01,21,1,0)
This field contains the original "06" record type on the 835 transmission 
"^DD",361.1,361.1,61.01,21,2,0)
from Austin.  It contains the corrected patient name and/or the corrected 
"^DD",361.1,361.1,61.01,21,3,0)
patient ID directly from the payer.
"^DD",361.1,361.1,61.01,"DT")
3080117
"^DD",361.1,361.1,62.01,0)
MAILMAN HEADER INFORMATION^F^^6.2;E1,200^K:$L(X)>200!($L(X)<1) X
"^DD",361.1,361.1,62.01,3)
Answer must be 1-200 characters in length
"^DD",361.1,361.1,62.01,21,0)
^^2^2^3080117^
"^DD",361.1,361.1,62.01,21,1,0)
This field contains MailMan header data which is returned from the 
"^DD",361.1,361.1,62.01,21,2,0)
MailMan utility $$NET^XMRENT.
"^DD",361.1,361.1,62.01,"DT")
3080117
"^DD",364.5,364.5,0)
FIELD^^3^11
"^DD",364.5,364.5,0,"DDA")
N
"^DD",364.5,364.5,0,"DT")
2960311
"^DD",364.5,364.5,0,"ID",.05)
S %I=Y,Y=$S('$D(^(0)):"",$D(^DIC(+$P(^(0),U,5),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(1,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",364.5,364.5,0,"IX","B",364.5,.01)

"^DD",364.5,364.5,0,"NM","IB DATA ELEMENT DEFINITION")

"^DD",364.5,364.5,0,"PT",364.7,.03)

"^DD",364.5,364.5,0,"VRPK")
IB
"^DD",364.5,364.5,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",364.5,364.5,.01,1,0)
^.1
"^DD",364.5,364.5,.01,1,1,0)
364.5^B
"^DD",364.5,364.5,.01,1,1,1)
S ^IBA(364.5,"B",$E(X,1,30),DA)=""
"^DD",364.5,364.5,.01,1,1,2)
K ^IBA(364.5,"B",$E(X,1,30),DA)
"^DD",364.5,364.5,.01,3)
Answer must be 3-30 characters in length.
"^DD",364.5,364.5,.01,21,0)
^^1^1^2951205^
"^DD",364.5,364.5,.01,21,1,0)
The name to be used to uniquely identify this data element.
"^DD",364.5,364.5,.01,"DT")
2951219
"^DD",364.5,364.5,.02,0)
SECURITY LEVEL^RS^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^Q
"^DD",364.5,364.5,.02,21,0)
^^2^2^2960215^^^^
"^DD",364.5,364.5,.02,21,1,0)
If this field is set to N (NATIONAL,NO EDIT), this is a secured data
"^DD",364.5,364.5,.02,21,2,0)
element and will not be allowed to be edited or deleted.
"^DD",364.5,364.5,.02,"DT")
2960215
"^DD",364.5,364.5,.03,0)
TYPE OF ELEMENT^RS^F:NON-MULTIPLE FILEMAN FIELD;E:EXTRACTED VIA CODE;C:CONSTANT VALUE;^0;3^Q
"^DD",364.5,364.5,.03,1,0)
^.1
"^DD",364.5,364.5,.03,1,1,0)
^^TRIGGER^364.5^.04
"^DD",364.5,364.5,.03,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X="FC",Y(1)=X S X=Y(0),X=X S Y=X,X=Y(1),X=X S X=X[Y I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X=DIV S X="I" X ^DD(364.5,.03,1,1,1.4)
"^DD",364.5,364.5,.03,1,1,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,4)=DIV,DIH=364.5,DIG=.04 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.03,1,1,2)
Q
"^DD",364.5,364.5,.03,1,1,3)
DO NOT DELETE
"^DD",364.5,364.5,.03,1,1,"%D",0)
^^1^1^2960215^
"^DD",364.5,364.5,.03,1,1,"%D",1,0)
If TYPE OF ELEMENT is 'F' or 'C' then ELEMENT CATEGORY must be 'I'. 
"^DD",364.5,364.5,.03,1,1,"CREATE CONDITION")
"FC"[INTERNAL(TYPE OF ELEMENT)
"^DD",364.5,364.5,.03,1,1,"CREATE VALUE")
S X="I"
"^DD",364.5,364.5,.03,1,1,"DELETE VALUE")
NO EFFECT
"^DD",364.5,364.5,.03,1,1,"DT")
2960215
"^DD",364.5,364.5,.03,1,1,"FIELD")
ELEMENT CATEGORY
"^DD",364.5,364.5,.03,1,2,0)
^^TRIGGER^364.5^.06
"^DD",364.5,364.5,.03,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0),X=X S X=X'="F" I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" X ^DD(364.5,.03,1,2,1.4)
"^DD",364.5,364.5,.03,1,2,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,6)=DIV,DIH=364.5,DIG=.06 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.03,1,2,2)
Q
"^DD",364.5,364.5,.03,1,2,3)
DO NOT DELETE
"^DD",364.5,364.5,.03,1,2,"%D",0)
^^2^2^2960215^
"^DD",364.5,364.5,.03,1,2,"%D",1,0)
This triggers the FILEMAN FIELD REFERENCE field to null if the element type
"^DD",364.5,364.5,.03,1,2,"%D",2,0)
is not FILEMAN field type of element.
"^DD",364.5,364.5,.03,1,2,"CREATE CONDITION")
INTERNAL(TYPE OF ELEMENT)'="F"
"^DD",364.5,364.5,.03,1,2,"CREATE VALUE")
@
"^DD",364.5,364.5,.03,1,2,"DELETE VALUE")
NO EFFECT
"^DD",364.5,364.5,.03,1,2,"DT")
2960215
"^DD",364.5,364.5,.03,1,2,"FIELD")
FILEMAN FIELD REFERENCE
"^DD",364.5,364.5,.03,1,3,0)
^^TRIGGER^364.5^.08
"^DD",364.5,364.5,.03,1,3,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0),X=X S X=X'="C" I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X="" X ^DD(364.5,.03,1,3,1.4)
"^DD",364.5,364.5,.03,1,3,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,8)=DIV,DIH=364.5,DIG=.08 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.03,1,3,2)
Q
"^DD",364.5,364.5,.03,1,3,3)
DO NOT DELETE
"^DD",364.5,364.5,.03,1,3,"%D",0)
^^2^2^2960215^
"^DD",364.5,364.5,.03,1,3,"%D",1,0)
This triggers the CONSTANT VALUE field to null if the element type is not
"^DD",364.5,364.5,.03,1,3,"%D",2,0)
CONSTANT type of element.
"^DD",364.5,364.5,.03,1,3,"CREATE CONDITION")
INTERNAL(TYPE OF ELEMENT)'="C"
"^DD",364.5,364.5,.03,1,3,"CREATE VALUE")
@
"^DD",364.5,364.5,.03,1,3,"DELETE VALUE")
NO EFFECT
"^DD",364.5,364.5,.03,1,3,"DT")
2960215
"^DD",364.5,364.5,.03,1,3,"FIELD")
CONSTANT VALUE
"^DD",364.5,364.5,.03,1,4,0)
^^TRIGGER^364.5^1
"^DD",364.5,364.5,.03,1,4,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0),X=X S X=X'="E" I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,1)):^(1),1:"") S X=$E(Y(1),1,245),X=X S DIU=X K Y S X="" X ^DD(364.5,.03,1,4,1.4)
"^DD",364.5,364.5,.03,1,4,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),1)):^(1),1:""),DIV=X S DE=0-$L(DIH),DIU=$E(DIH,1,245),Y=$E(DIH,246,999),^(1)=$J("",$S(DE>0:DE,1:0))_DIV_$S(Y?." ":"",1:$J("",245-$L(DIV))_Y),DIH=364.5,DIG=1 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.03,1,4,2)
Q
"^DD",364.5,364.5,.03,1,4,3)
DO NOT DELETE
"^DD",364.5,364.5,.03,1,4,"%D",0)
^^2^2^2960215^
"^DD",364.5,364.5,.03,1,4,"%D",1,0)
This triggers the EXTRACT CODE field to null if the element type is not an
"^DD",364.5,364.5,.03,1,4,"%D",2,0)
EXTRACTED VIA CODE type of element.
"^DD",364.5,364.5,.03,1,4,"CREATE CONDITION")
INTERNAL(TYPE OF ELEMENT)'="E"
"^DD",364.5,364.5,.03,1,4,"CREATE VALUE")
@
"^DD",364.5,364.5,.03,1,4,"DELETE VALUE")
NO EFFECT
"^DD",364.5,364.5,.03,1,4,"DT")
2960215
"^DD",364.5,364.5,.03,1,4,"FIELD")
EXTRACT CODE
"^DD",364.5,364.5,.03,21,0)
^^3^3^2951207^^
"^DD",364.5,364.5,.03,21,1,0)
The type of data element being defined as needed by one or more forms.  This
"^DD",364.5,364.5,.03,21,2,0)
field determines the type of retrieval needed to get the actual data element's
"^DD",364.5,364.5,.03,21,3,0)
value for a given bill.
"^DD",364.5,364.5,.03,"DT")
2960215
"^DD",364.5,364.5,.04,0)
ELEMENT CATEGORY^RSX^I:INDIVIDUAL ELEMENT;G:GROUP ELEMENT;^0;4^I $P($G(^IBA(364.5,DA,0)),U,3)="F",$G(X)="G" K X
"^DD",364.5,364.5,.04,1,0)
^.1
"^DD",364.5,364.5,.04,1,1,0)
^^TRIGGER^364.5^.06
"^DD",364.5,364.5,.04,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0),X=X S X=X="G" I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" X ^DD(364.5,.04,1,1,1.4)
"^DD",364.5,364.5,.04,1,1,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,6)=DIV,DIH=364.5,DIG=.06 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.04,1,1,2)
Q
"^DD",364.5,364.5,.04,1,1,"CREATE CONDITION")
INTERNAL(ELEMENT CATEGORY)="G"
"^DD",364.5,364.5,.04,1,1,"CREATE VALUE")
""
"^DD",364.5,364.5,.04,1,1,"DELETE VALUE")
NO EFFECT
"^DD",364.5,364.5,.04,1,1,"FIELD")
FILEMAN FIELD REFERENCE
"^DD",364.5,364.5,.04,3)
This indicates an INDIVIDUAL or GROUP of elements will be returned.  Group is not valid for Fileman type elements.
"^DD",364.5,364.5,.04,5,1,0)
364.5^.03^1
"^DD",364.5,364.5,.04,21,0)
^^3^3^2951205^
"^DD",364.5,364.5,.04,21,1,0)
This defines whether the data element to be extracted is a single piece of data
"^DD",364.5,364.5,.04,21,2,0)
or is a string of related data.  Fileman field references must be designated as
"^DD",364.5,364.5,.04,21,3,0)
individual elements.
"^DD",364.5,364.5,.04,"DT")
2960215
"^DD",364.5,364.5,.05,0)
BASE FILE^P1'^DIC(^0;5^Q
"^DD",364.5,364.5,.05,3)
Enter the Fileman file to be used as a 'base' to extract the data from.
"^DD",364.5,364.5,.05,21,0)
^^2^2^2960311^
"^DD",364.5,364.5,.05,21,1,0)
This is the number of the Fileman file to be used as a 'base' to extract
"^DD",364.5,364.5,.05,21,2,0)
data for this field.
"^DD",364.5,364.5,.05,"DT")
2960311
"^DD",364.5,364.5,.06,0)
FILEMAN FIELD REFERENCE^FX^^0;6^K:$L(X)>65!($L(X)<1) X I $D(X),$P($G(^IBA(364.5,DA,0)),U,4)="G" K X
"^DD",364.5,364.5,.06,1,0)
^.1
"^DD",364.5,364.5,.06,1,1,0)
^^TRIGGER^364.5^.07
"^DD",364.5,364.5,.06,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0)="" I X S X=DIV S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X="" X ^DD(364.5,.06,1,1,1.4)
"^DD",364.5,364.5,.06,1,1,1.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,7)=DIV,DIH=364.5,DIG=.07 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.06,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^IBA(364.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X="" X ^DD(364.5,.06,1,1,2.4)
"^DD",364.5,364.5,.06,1,1,2.4)
S DIH=$S($D(^IBA(364.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,7)=DIV,DIH=364.5,DIG=.07 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.5,364.5,.06,1,1,"CREATE CONDITION")
FILEMAN FIELD REFERENCE=""
"^DD",364.5,364.5,.06,1,1,"CREATE VALUE")
@
"^DD",364.5,364.5,.06,1,1,"DELETE VALUE")
@
"^DD",364.5,364.5,.06,1,1,"FIELD")
#.07
"^DD",364.5,364.5,.06,3)
Must be a valid Fileman reference and ELEMENT CATEGORY must not be GROUP.
"^DD",364.5,364.5,.06,5,1,0)
364.5^.04^1
"^DD",364.5,364.5,.06,5,2,0)
364.5^.03^2
"^DD",364.5,364.5,.06,21,0)
^^6^6^2951221^^^
"^DD",364.5,364.5,.06,21,1,0)
The valid Fileman field reference or simple Fileman navigation to be used
"^DD",364.5,364.5,.06,21,2,0)
to extract using the $$GET^DIQ utility. Note this will not return true
"^DD",364.5,364.5,.06,21,3,0)
multiple entries.  Word-processing type fields are able to be retrieved,
"^DD",364.5,364.5,.06,21,4,0)
however.  No syntax check is made on this field so the user must be careful
"^DD",364.5,364.5,.06,21,5,0)
to type a valid Fileman expression.  This must be designated as an
"^DD",364.5,364.5,.06,21,6,0)
INDIVIDUAL element, not a group element.
"^DD",364.5,364.5,.06,"DT")
2951221
"^DD",364.5,364.5,.07,0)
FILEMAN RETURN FORMAT^S^I:INTERNAL;E:EXTERNAL;^0;7^Q
"^DD",364.5,364.5,.07,5,1,0)
364.5^.06^1
"^DD",364.5,364.5,.07,21,0)
^^5^5^2951205^
"^DD",364.5,364.5,.07,21,1,0)
This is the format for the retrieved data for Fileman-type data elements.  It
"^DD",364.5,364.5,.07,21,2,0)
is recommended to use Internal format whenever possible to keep the data
"^DD",364.5,364.5,.07,21,3,0)
element definitions in this file as generic as possible to avoid duplication.  
"^DD",364.5,364.5,.07,21,4,0)
The format capabilities of the forms generator should be used to interpret and
"^DD",364.5,364.5,.07,21,5,0)
reformat the data element when needed.
"^DD",364.5,364.5,.07,"DT")
2951205
"^DD",364.5,364.5,.08,0)
CONSTANT VALUE^F^^0;8^K:$L(X)>80!($L(X)<1) X
"^DD",364.5,364.5,.08,3)
Answer must be 1-80 characters in length.
"^DD",364.5,364.5,.08,5,1,0)
364.5^.03^3
"^DD",364.5,364.5,.08,21,0)
^^1^1^2951205^
"^DD",364.5,364.5,.08,21,1,0)
The specific value that this data element should return for this data element.
"^DD",364.5,364.5,.08,"DT")
2951205
"^DD",364.5,364.5,1,0)
EXTRACT CODE^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",364.5,364.5,1,3)
This is Standard MUMPS code.
"^DD",364.5,364.5,1,5,1,0)
364.5^.03^4
"^DD",364.5,364.5,1,9)
@
"^DD",364.5,364.5,1,21,0)
^^7^7^2951207^^^
"^DD",364.5,364.5,1,21,1,0)
The code to be executed by the forms generator to return the value(s) of the
"^DD",364.5,364.5,1,21,2,0)
data element.  If no ARRAY ROOT field is completed for this data element, the
"^DD",364.5,364.5,1,21,3,0)
code should set the variable IBXDATA or the array IBXDATA(1) through IBXDATA(n)
"^DD",364.5,364.5,1,21,4,0)
where n=the total # of iterations of the data element retrieved.  If the ARRAY 
"^DD",364.5,364.5,1,21,5,0)
ROOT field has been completed for this data element, this code should set the
"^DD",364.5,364.5,1,21,6,0)
variable referenced there.  IBXIEN is assumed to be the internal entry number
"^DD",364.5,364.5,1,21,7,0)
of the  file (referenced by the variable IBXFILE) entry.
"^DD",364.5,364.5,1,"DT")
2951205
"^DD",364.5,364.5,2,0)
ARRAY ROOT^F^^2;E1,50^K:$L(X)>50!($L(X)<1) X
"^DD",364.5,364.5,2,3)
Answer must be a valid array root name.
"^DD",364.5,364.5,2,21,0)
^^3^3^2960117^^
"^DD",364.5,364.5,2,21,1,0)
 The local or global base root where multiple-valued output or word processing
"^DD",364.5,364.5,2,21,2,0)
data is to be stored for this data element.  IBXDATA is the default if there
"^DD",364.5,364.5,2,21,3,0)
is no data in this field.  Example of a global array: ^TMP($J)
"^DD",364.5,364.5,2,"DT")
2960117
"^DD",364.5,364.5,3,0)
DESCRIPTION^364.53^^3;0
"^DD",364.5,364.53,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",364.5,364.53,0,"DT")
2951205
"^DD",364.5,364.53,0,"NM","DESCRIPTION")

"^DD",364.5,364.53,0,"UP")
364.5
"^DD",364.5,364.53,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",364.5,364.53,.01,3)
Enter a description of the data element being defined.
"^DD",364.5,364.53,.01,21,0)
^^1^1^2951205^
"^DD",364.5,364.53,.01,21,1,0)
This is a free text description of the data that this data element represents.
"^DD",364.5,364.53,.01,"DT")
2951205
"^DD",364.6,364.6,0)
FIELD^^.13^13
"^DD",364.6,364.6,0,"DDA")
N
"^DD",364.6,364.6,0,"DT")
3071126
"^DD",364.6,364.6,0,"ID",.04)
W "   ",$P(^(0),U,4)
"^DD",364.6,364.6,0,"ID",.05)
W "   ",$P(^(0),U,5)
"^DD",364.6,364.6,0,"ID",.08)
W "   ",$P(^(0),U,8)
"^DD",364.6,364.6,0,"ID",.1)
W "   ",$P(^(0),U,10)
"^DD",364.6,364.6,0,"IX","APAR",364.6,.01)

"^DD",364.6,364.6,0,"IX","APAR1",364.6,.03)

"^DD",364.6,364.6,0,"IX","ASEQ",364.6,.01)

"^DD",364.6,364.6,0,"IX","ASEQ1",364.6,.04)

"^DD",364.6,364.6,0,"IX","ASEQ2",364.6,.05)

"^DD",364.6,364.6,0,"IX","ASEQ3",364.6,.08)

"^DD",364.6,364.6,0,"IX","B",364.6,.01)

"^DD",364.6,364.6,0,"NM","IB FORM SKELETON DEFINITION")
 
"^DD",364.6,364.6,0,"PT",364.6,.03)

"^DD",364.6,364.6,0,"PT",364.7,.01)

"^DD",364.6,364.6,0,"VRPK")
IB
"^DD",364.6,364.6,.01,0)
BILL FORM^RP353'X^IBE(353,^0;1^I $$DUP^IBCEFG0($G(DA),X,1) K X
"^DD",364.6,364.6,.01,1,0)
^.1
"^DD",364.6,364.6,.01,1,1,0)
364.6^B
"^DD",364.6,364.6,.01,1,1,1)
S ^IBA(364.6,"B",$E(X,1,30),DA)=""
"^DD",364.6,364.6,.01,1,1,2)
K ^IBA(364.6,"B",$E(X,1,30),DA)
"^DD",364.6,364.6,.01,1,2,0)
364.6^ASEQ^MUMPS
"^DD",364.6,364.6,.01,1,2,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=$P(Z0,U,4),Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 S ^IBA(364.6,"ASEQ",+X,Z1,Z2,Z3,DA)=""
"^DD",364.6,364.6,.01,1,2,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=$P(Z0,U,4),Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 K ^IBA(364.6,"ASEQ",+X,Z1,Z2,Z3,DA)
"^DD",364.6,364.6,.01,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,2,"%D",0)
^^1^1^2960117^^
"^DD",364.6,364.6,.01,1,2,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.01,1,2,"DT")
2960116
"^DD",364.6,364.6,.01,1,3,0)
364.6^APAR^MUMPS
"^DD",364.6,364.6,.01,1,3,1)
N Z0 S Z0=$P($G(^IBA(364.6,DA,0)),U,3) I Z0,Z0'=X S ^IBA(364.6,"APAR",$E(X,1,30),Z0,DA)=""
"^DD",364.6,364.6,.01,1,3,2)
N Z0 S Z0=$P($G(^IBA(364.6,DA,0)),U,3) I Z0,Z0'=X K ^IBA(364.6,"APAR",$E(X,1,30),Z0,DA)
"^DD",364.6,364.6,.01,1,3,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,3,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.01,1,3,"%D",1,0)
Xref by bill form and associated form field definition.
"^DD",364.6,364.6,.01,1,3,"DT")
2960117
"^DD",364.6,364.6,.01,1,4,0)
^^TRIGGER^364.6^.03
"^DD",364.6,364.6,.01,1,4,1)
X ^DD(364.6,.01,1,4,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=$S('$D(D0):"",D0<0:"",1:D0) X ^DD(364.6,.01,1,4,1.4)
"^DD",364.6,364.6,.01,1,4,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.01,1,4,69.2) S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.01,1,4,1.4)
S DIH=$G(^IBA(364.6,DIV(0),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=364.6,DIG=.03 D ^DICR
"^DD",364.6,364.6,.01,1,4,2)
X ^DD(364.6,.01,1,4,2.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" S DIH=$G(^IBA(364.6,DIV(0),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=364.6,DIG=.03 D ^DICR
"^DD",364.6,364.6,.01,1,4,2.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.01,1,4,79.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.01,1,4,3)
DO NOT DELETE
"^DD",364.6,364.6,.01,1,4,69.2)
S I(0,0)=$G(D0),D0=Y(0) S:'D0!'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$P($G(^DD(353,2.02,0)),U,3),Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"")
"^DD",364.6,364.6,.01,1,4,79.2)
S I(0,0)=$G(D0),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'D0!'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$P($G(^DD(353,2.02,0)),U,3)
"^DD",364.6,364.6,.01,1,4,"%D",0)
^^1^1^3000613^
"^DD",364.6,364.6,.01,1,4,"%D",1,0)
This trigger is needed for the local screen 9 logic to work correctly.
"^DD",364.6,364.6,.01,1,4,"CREATE CONDITION")
BILL FORM:FORMAT TYPE="BILLING SCREEN"
"^DD",364.6,364.6,.01,1,4,"CREATE VALUE")
NUMBER
"^DD",364.6,364.6,.01,1,4,"DELETE CONDITION")
BILL FORM:FORMAT TYPE="BILLING SCREEN"
"^DD",364.6,364.6,.01,1,4,"DELETE VALUE")
@
"^DD",364.6,364.6,.01,1,4,"DT")
3000613
"^DD",364.6,364.6,.01,1,4,"FIELD")
ASSOCIATED FORM DEFINITION
"^DD",364.6,364.6,.01,3)
Enter a BILLING FORM that the data element will appear on.
"^DD",364.6,364.6,.01,21,0)
^^2^2^2960318^^^^
"^DD",364.6,364.6,.01,21,1,0)
Identifies a billing 'form' or 'screen' where the data element is used.
"^DD",364.6,364.6,.01,21,2,0)
The combination of form/page/line/column must be unique.
"^DD",364.6,364.6,.01,"DT")
3000613
"^DD",364.6,364.6,.02,0)
SECURITY LEVEL^SX^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^I X="N",$P($G(^IBA(364.6,DA,0)),U,3) K X
"^DD",364.6,364.6,.02,3)
Enter an N if no editing is allowed, L if editing is OK because this entry is associated with a locally defined form.
"^DD",364.6,364.6,.02,5,1,0)
364.6^.03^7
"^DD",364.6,364.6,.02,21,0)
^.001^4^4^3001030^^
"^DD",364.6,364.6,.02,21,1,0)
This field determines whether or not editing of the entry is allowed.  If
"^DD",364.6,364.6,.02,21,2,0)
the security level of the entry is NATIONAL (N), no local editing is
"^DD",364.6,364.6,.02,21,3,0)
allowed.  If the security level of the entry is LOCAL (L), it may be
"^DD",364.6,364.6,.02,21,4,0)
edited.
"^DD",364.6,364.6,.02,"DT")
2960117
"^DD",364.6,364.6,.03,0)
ASSOCIATED FORM DEFINITION^P364.6'^IBA(364.6,^0;3^Q
"^DD",364.6,364.6,.03,1,0)
^.1
"^DD",364.6,364.6,.03,1,1,0)
364.6^APAR1^MUMPS
"^DD",364.6,364.6,.03,1,1,1)
N Z0 S Z0=+$G(^IBA(364.6,DA,0)) I Z0,Z0'=X S ^IBA(364.6,"APAR",Z0,$E(X,1,30),DA)=""
"^DD",364.6,364.6,.03,1,1,2)
N Z0 S Z0=+$G(^IBA(364.6,DA,0)) I Z0,Z0'=X K ^IBA(364.6,"APAR",Z0,$E(X,1,30),DA)
"^DD",364.6,364.6,.03,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,1,"%D",0)
^^1^1^2960117^^
"^DD",364.6,364.6,.03,1,1,"%D",1,0)
Xref by bill form and associated form field definition.
"^DD",364.6,364.6,.03,1,1,"DT")
2960117
"^DD",364.6,364.6,.03,1,2,0)
^^TRIGGER^364.6^.04
"^DD",364.6,364.6,.03,1,2,1)
X ^DD(364.6,.03,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,2,1.4)
"^DD",364.6,364.6,.03,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,2,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,2,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,4)=DIV,DIH=364.6,DIG=.04 D ^DICR
"^DD",364.6,364.6,.03,1,2,2)
Q
"^DD",364.6,364.6,.03,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,2,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,2,"%D",0)
^.101^2^2^3000424^^
"^DD",364.6,364.6,.03,1,2,"%D",1,0)
If an associated form that is not a screen form, page is taken from the
"^DD",364.6,364.6,.03,1,2,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,2,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,2,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,2,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,2,"DT")
3000405
"^DD",364.6,364.6,.03,1,2,"FIELD")
PAGE OR SEQUENCE
"^DD",364.6,364.6,.03,1,3,0)
^^TRIGGER^364.6^.05
"^DD",364.6,364.6,.03,1,3,1)
X ^DD(364.6,.03,1,3,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,3,1.4)
"^DD",364.6,364.6,.03,1,3,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,3,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,3,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,5)=DIV,DIH=364.6,DIG=.05 D ^DICR
"^DD",364.6,364.6,.03,1,3,2)
Q
"^DD",364.6,364.6,.03,1,3,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,3,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,3,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,3,"%D",1,0)
If an associated form that is not a screen form, line is taken from the
"^DD",364.6,364.6,.03,1,3,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,3,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,3,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,3,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,3,"DT")
3000405
"^DD",364.6,364.6,.03,1,3,"FIELD")
FIRST LINE NUMBER
"^DD",364.6,364.6,.03,1,4,0)
^^TRIGGER^364.6^.08
"^DD",364.6,364.6,.03,1,4,1)
X ^DD(364.6,.03,1,4,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,4,1.4)
"^DD",364.6,364.6,.03,1,4,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,4,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,4,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,8)=DIV,DIH=364.6,DIG=.08 D ^DICR
"^DD",364.6,364.6,.03,1,4,2)
Q
"^DD",364.6,364.6,.03,1,4,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,4,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,4,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,4,"%D",1,0)
If an associated form that is not a screen form, column is taken from the
"^DD",364.6,364.6,.03,1,4,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,4,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,4,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,4,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,4,"DT")
3000405
"^DD",364.6,364.6,.03,1,4,"FIELD")
STARTING COLUMN
"^DD",364.6,364.6,.03,1,5,0)
^^TRIGGER^364.6^.09
"^DD",364.6,364.6,.03,1,5,1)
X ^DD(364.6,.03,1,5,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,5,1.4)
"^DD",364.6,364.6,.03,1,5,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,5,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,5,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,9)=DIV,DIH=364.6,DIG=.09 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,5,2)
Q
"^DD",364.6,364.6,.03,1,5,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,5,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,5,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,5,"%D",1,0)
If an associated form that is not a screen form, length is taken from the
"^DD",364.6,364.6,.03,1,5,"%D",2,0)
associated with field definition.
"^DD",364.6,364.6,.03,1,5,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,5,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,5,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,5,"DT")
3000405
"^DD",364.6,364.6,.03,1,5,"FIELD")
LENGTH
"^DD",364.6,364.6,.03,1,6,0)
^^TRIGGER^364.6^.06
"^DD",364.6,364.6,.03,1,6,1)
X ^DD(364.6,.03,1,6,1.3) I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X="" X ^DD(364.6,.03,1,6,1.4)
"^DD",364.6,364.6,.03,1,6,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(364.6,.03,1,6,69.2) S Y(101)=$S($D(^IBE(353,D0,2)):^(2),1:"") S X=$P($P(Y(102),$C(59)_$P(Y(101),U,2)_":",2),$C(59),1)'="BILLING SCREEN" S D0=I(0,0)
"^DD",364.6,364.6,.03,1,6,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,6)=DIV,DIH=364.6,DIG=.06 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,6,2)
Q
"^DD",364.6,364.6,.03,1,6,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,6,69.2)
S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:""),D0=$P(Y(1),U,1) S:'$D(^IBE(353,+D0,0)) D0=-1 S Y(102)=$C(59)_$S($D(^DD(353,2.02,0)):$P(^(0),U,3),1:"")
"^DD",364.6,364.6,.03,1,6,"%D",0)
^^2^2^3000405^
"^DD",364.6,364.6,.03,1,6,"%D",1,0)
If associated form that is not a screen form, the max number lines is taken
"^DD",364.6,364.6,.03,1,6,"%D",2,0)
from the associated with field definition.
"^DD",364.6,364.6,.03,1,6,"CREATE CONDITION")
BILL FORM:FORMAT TYPE'="BILLING SCREEN"
"^DD",364.6,364.6,.03,1,6,"CREATE VALUE")
@
"^DD",364.6,364.6,.03,1,6,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,6,"DT")
3000405
"^DD",364.6,364.6,.03,1,6,"FIELD")
MAX NUMBER LINES
"^DD",364.6,364.6,.03,1,7,0)
^^TRIGGER^364.6^.02
"^DD",364.6,364.6,.03,1,7,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X="L" X ^DD(364.6,.03,1,7,1.4)
"^DD",364.6,364.6,.03,1,7,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=364.6,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.03,1,7,2)
Q
"^DD",364.6,364.6,.03,1,7,3)
DO NOT DELETE
"^DD",364.6,364.6,.03,1,7,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.03,1,7,"%D",1,0)
Only local entries can be associated.
"^DD",364.6,364.6,.03,1,7,"CREATE VALUE")
"L"
"^DD",364.6,364.6,.03,1,7,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.03,1,7,"DT")
2960117
"^DD",364.6,364.6,.03,1,7,"FIELD")
SECURITY LEVEL
"^DD",364.6,364.6,.03,3)
Enter the form definition record this definition will override.
"^DD",364.6,364.6,.03,5,1,0)
364.6^.01^4
"^DD",364.6,364.6,.03,21,0)
^^1^1^2960117^^
"^DD",364.6,364.6,.03,21,1,0)
The form definition record this definition will override.
"^DD",364.6,364.6,.03,"DT")
3000414
"^DD",364.6,364.6,.04,0)
PAGE OR SEQUENCE^FX^^0;4^K:$L(X)>20!($L(X)<1) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,2) K X
"^DD",364.6,364.6,.04,1,0)
^.1^^-1
"^DD",364.6,364.6,.04,1,1,0)
364.6^ASEQ1^MUMPS
"^DD",364.6,364.6,.04,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 S ^IBA(364.6,"ASEQ",Z1,$E(X,1,30),Z2,Z3,DA)=""
"^DD",364.6,364.6,.04,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,5),Z3=$P(Z0,U,8) I Z1,Z2,Z3 K ^IBA(364.6,"ASEQ",Z1,$E(X,1,30),Z2,Z3,DA)
"^DD",364.6,364.6,.04,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.04,1,1,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.04,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.04,1,1,"DT")
2960117
"^DD",364.6,364.6,.04,3)
This data must be 1-20 char long, can't be an assoc form, and must be a unique form/page/line/column.
"^DD",364.6,364.6,.04,5,1,0)
364.6^.03^2
"^DD",364.6,364.6,.04,21,0)
^^4^4^2960318^^^^
"^DD",364.6,364.6,.04,21,1,0)
This field is used to specify the page, section, transaction segment, etc.
"^DD",364.6,364.6,.04,21,2,0)
that the data element is to be associated with.  This field will be used as
"^DD",364.6,364.6,.04,21,3,0)
the second-level sort field when extracting data fields for this form.
"^DD",364.6,364.6,.04,21,4,0)
The combination of form/page/line/column must be unique.
"^DD",364.6,364.6,.04,"DT")
3000428
"^DD",364.6,364.6,.05,0)
FIRST LINE NUMBER^NJ4,0X^^0;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,3) K X
"^DD",364.6,364.6,.05,.1)
LINE
"^DD",364.6,364.6,.05,1,0)
^.1
"^DD",364.6,364.6,.05,1,1,0)
364.6^ASEQ2^MUMPS
"^DD",364.6,364.6,.05,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,8) I Z1,Z2'="",Z3 S ^IBA(364.6,"ASEQ",Z1,Z2,$E(X,1,30),Z3,DA)=""
"^DD",364.6,364.6,.05,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,8) I Z1,Z2'="",Z3 K ^IBA(364.6,"ASEQ",Z1,Z2,$E(X,1,30),Z3,DA)
"^DD",364.6,364.6,.05,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.05,1,1,"%D",0)
^^1^1^2960117^^^^
"^DD",364.6,364.6,.05,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.05,1,1,"DT")
2960117
"^DD",364.6,364.6,.05,3)
Type a # 0-9999, 0 Decimals, can't be assoc form, need unique form/pg/line/col.
"^DD",364.6,364.6,.05,5,1,0)
364.6^.03^3
"^DD",364.6,364.6,.05,21,0)
^^5^5^2960318^^^
"^DD",364.6,364.6,.05,21,1,0)
If this is a printed form, this is the first line number that this data
"^DD",364.6,364.6,.05,21,2,0)
element will appear on.  For transmitted forms, this is assumed to always
"^DD",364.6,364.6,.05,21,3,0)
be a 1.  This will be used as the third-level sort field when extracting
"^DD",364.6,364.6,.05,21,4,0)
data fields for this form.  The combination of form/page/line/column must
"^DD",364.6,364.6,.05,21,5,0)
be unique.
"^DD",364.6,364.6,.05,"DT")
3000428
"^DD",364.6,364.6,.06,0)
MAX NUMBER LINES^NJ3,0X^^0;6^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X I $D(X),$P($G(^IBA(364.6,DA,0)),U,3) K X
"^DD",364.6,364.6,.06,3)
Type a Number between 0 and 999, 0 Decimal Digits (can't be an associated form).
"^DD",364.6,364.6,.06,5,1,0)
364.6^.03^6
"^DD",364.6,364.6,.06,21,0)
^^2^2^2951205^
"^DD",364.6,364.6,.06,21,1,0)
If a printed form, this is the highest numbered line number that this data
"^DD",364.6,364.6,.06,21,2,0)
element is allowed to print on.
"^DD",364.6,364.6,.06,"DT")
2960117
"^DD",364.6,364.6,.07,0)
LOCAL OVERRIDE ALLOWED^S^0:NO;1:YES;^0;7^Q
"^DD",364.6,364.6,.07,3)
Enter 0 (NO) to prevent local override, 1 to allow local override.
"^DD",364.6,364.6,.07,21,0)
^.001^2^2^3020822^^
"^DD",364.6,364.6,.07,21,1,0)
This controls whether or not the output forms generator will allow for a
"^DD",364.6,364.6,.07,21,2,0)
redefinition of this record via a local override.
"^DD",364.6,364.6,.07,"DT")
2960311
"^DD",364.6,364.6,.08,0)
STARTING COLUMN OR PIECE^NJ3,1X^^0;8^K:+X'=X!(X>999)!(X<0)!($S(X[".":X'?.E1"."1.2N,1:0)) X I $D(X),$S($P($G(^IBE(353,+$G(^IBA(364.6,+DA,0)),2)),U,2)="S":0,1:$P($G(^IBA(364.6,DA,0)),U,3))!$$DUP^IBCEFG0(DA,X,4) K X
"^DD",364.6,364.6,.08,.1)
COLUMN
"^DD",364.6,364.6,.08,1,0)
^.1
"^DD",364.6,364.6,.08,1,1,0)
364.6^ASEQ3^MUMPS
"^DD",364.6,364.6,.08,1,1,1)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,5) I Z1,Z2'="",Z3 S ^IBA(364.6,"ASEQ",Z1,Z2,Z3,$E(X,1,30),DA)=""
"^DD",364.6,364.6,.08,1,1,2)
N Z0,Z1,Z2,Z3 S Z0=$G(^IBA(364.6,DA,0)),Z1=+Z0,Z2=$P(Z0,U,4),Z3=$P(Z0,U,5) I Z1,Z2'="",Z3 K ^IBA(364.6,"ASEQ",Z1,Z2,Z3,$E(X,1,30),DA)
"^DD",364.6,364.6,.08,1,1,3)
DO NOT DELETE
"^DD",364.6,364.6,.08,1,1,"%D",0)
^^1^1^2960117^
"^DD",364.6,364.6,.08,1,1,"%D",1,0)
This xref contains the sequence to use to extract or print the form fields.
"^DD",364.6,364.6,.08,1,1,"DT")
2960117
"^DD",364.6,364.6,.08,1,2,0)
^^TRIGGER^364.6^.11
"^DD",364.6,364.6,.08,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0)["." I X S X=DIV S Y(1)=$S($D(^IBA(364.6,D0,0)):^(0),1:"") S X=$P(Y(1),U,11),X=X S DIU=X K Y S X=DIV S X=1 X ^DD(364.6,.08,1,2,1.4)
"^DD",364.6,364.6,.08,1,2,1.4)
S DIH=$S($D(^IBA(364.6,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,11)=DIV,DIH=364.6,DIG=.11 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",364.6,364.6,.08,1,2,2)
Q
"^DD",364.6,364.6,.08,1,2,3)
DO NOT DELETE
"^DD",364.6,364.6,.08,1,2,"%D",0)
^^2^2^2960126^^^
"^DD",364.6,364.6,.08,1,2,"%D",1,0)
If the starting column or piece is not a whole number, this must be a
"^DD",364.6,364.6,.08,1,2,"%D",2,0)
calculate only field - no output.
"^DD",364.6,364.6,.08,1,2,"CREATE CONDITION")
STARTING COLUMN OR PIECE["."
"^DD",364.6,364.6,.08,1,2,"CREATE VALUE")
S X=1
"^DD",364.6,364.6,.08,1,2,"DELETE VALUE")
NO EFFECT
"^DD",364.6,364.6,.08,1,2,"DT")
2960126
"^DD",364.6,364.6,.08,1,2,"FIELD")
#.11
"^DD",364.6,364.6,.08,3)
Type a # 0-9999, 1-2 Decimals, can't be assoc form, need unique form/pg/line/col.
"^DD",364.6,364.6,.08,5,1,0)
364.6^.03^4
"^DD",364.6,364.6,.08,21,0)
^^5^5^2960318^^^^
"^DD",364.6,364.6,.08,21,1,0)
This is the column on the form, position in the data string (for non-printed
"^DD",364.6,364.6,.08,21,2,0)
forms) -  starting at position 1, or delimited piece that this data element
"^DD",364.6,364.6,.08,21,3,0)
is to be printed or stored in.  This will be used as the fourth-level sort
"^DD",364.6,364.6,.08,21,4,0)
field when extracting data fields for this form.  The combination of
"^DD",364.6,364.6,.08,21,5,0)
form/page/line/column must be unique.
"^DD",364.6,364.6,.08,"DT")
3000428
"^DD",364.6,364.6,.09,0)
LENGTH^NJ3,0X^^0;9^K:+X'=X!(X>250)!(X<1)!(X?.E1"."1N.N) X I $D(X),$P($G(^IBA(364.6,DA,0)),U,3),$P($G(^IBE(353,+^IBA(364.6,DA,0),2)),U,2)'="S" K X
"^DD",364.6,364.6,.09,3)
Type a Number between 1 and 250, 0 Decimal Digits (can't be an associated form).
"^DD",364.6,364.6,.09,5,1,0)
364.6^.03^5
"^DD",364.6,364.6,.09,21,0)
^^3^3^2951205^
"^DD",364.6,364.6,.09,21,1,0)
The length desired for the data element.  If present, this field will be used
"^DD",364.6,364.6,.09,21,2,0)
to truncate or pad the data element to this length after the element has been
"^DD",364.6,364.6,.09,21,3,0)
passed through the routine identified in the FORMAT ROUTINE field.
"^DD",364.6,364.6,.09,"DT")
3000111
"^DD",364.6,364.6,.1,0)
SHORT DESCRIPTION^F^^0;10^K:$L(X)>40!($L(X)<1) X
"^DD",364.6,364.6,.1,3)
Answer must be 1-40 characters in length
"^DD",364.6,364.6,.1,21,0)
^^2^2^3071126^
"^DD",364.6,364.6,.1,21,1,0)
This is a short description of the field that is used as an identifier to
"^DD",364.6,364.6,.1,21,2,0)
make lookups on this file meaningful.
"^DD",364.6,364.6,.1,"DT")
3080310
"^DD",364.6,364.6,.11,0)
CALCULATE ONLY OR OUTPUT^S^1:CALCULATE ONLY;0:OUTPUT;^0;11^Q
"^DD",364.6,364.6,.11,3)
Enter 1 if this field is used for calculation purposes and is not meant to be output
"^DD",364.6,364.6,.11,5,1,0)
364.6^.08^2
"^DD",364.6,364.6,.11,21,0)
^^4^4^2960715^^^^
"^DD",364.6,364.6,.11,21,1,0)
This field is set to 1 if there is a need to do a special extract or
"^DD",364.6,364.6,.11,21,2,0)
calculation at some point in the processing, but no output is desired
"^DD",364.6,364.6,.11,21,3,0)
from the field's code execution.  Used to set up arrays for group elements
"^DD",364.6,364.6,.11,21,4,0)
then the individual elements are output separately.
"^DD",364.6,364.6,.11,"DT")
2960715
"^DD",364.6,364.6,.12,0)
TRANSMIT IGNORES IF NULL^S^0:FALSE;1:TRUE;^0;12^Q
"^DD",364.6,364.6,.12,3)
Enter 1 (TRUE) if there should be no entry made in the output global if the data value of the element is null.
"^DD",364.6,364.6,.12,21,0)
^.001^5^5^3001030^^^
"^DD",364.6,364.6,.12,21,1,0)
This field can be used to suppress output of a field if its value is null.
"^DD",364.6,364.6,.12,21,2,0)
If not suppressed, an entry is made in the output global used by the
"^DD",364.6,364.6,.12,21,3,0)
formatter, regardless of the contents of the data for this field.
"^DD",364.6,364.6,.12,21,4,0)
Supressing the value results in no output to the formatter's output
"^DD",364.6,364.6,.12,21,5,0)
global if the value of the data for this field is determined to be null.
"^DD",364.6,364.6,.12,"DT")
2991006
"^DD",364.6,364.6,.13,0)
DATA REQUIRED FOR FIELD^S^1:YES;0:NO;^0;13^Q
"^DD",364.6,364.6,.13,3)
Enter yes if there should always be data in this field.
"^DD",364.6,364.6,.13,21,0)
^^2^2^3000216^
"^DD",364.6,364.6,.13,21,1,0)
This field is a flag that will stop the output of a record if this field
"^DD",364.6,364.6,.13,21,2,0)
indicates data is required and the data extracted is null.
"^DD",364.6,364.6,.13,"DT")
3000216
"^DD",364.7,364.7,0)
FIELD^^3^12
"^DD",364.7,364.7,0,"DDA")
N
"^DD",364.7,364.7,0,"DT")
2960710
"^DD",364.7,364.7,0,"ID",.03)
S %I=Y,Y=$S('$D(^(0)):"",$D(^IBA(364.5,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(364.5,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",364.7,364.7,0,"IX","AINS",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINS1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP",364.7,.01)

"^DD",364.7,364.7,0,"IX","AINTYP1",364.7,.05)

"^DD",364.7,364.7,0,"IX","AINTYP2",364.7,.06)

"^DD",364.7,364.7,0,"IX","ATYPE",364.7,.01)

"^DD",364.7,364.7,0,"IX","ATYPE1",364.7,.06)

"^DD",364.7,364.7,0,"IX","B",364.7,.01)

"^DD",364.7,364.7,0,"IX","C",364.7,.03)

"^DD",364.7,364.7,0,"NM","IB FORM FIELD CONTENT")
 
"^DD",364.7,364.7,0,"VRPK")
IB
"^DD",364.7,364.7,.01,0)
FORM FIELD REFERENCE^RP364.6'^IBA(364.6,^0;1^Q
"^DD",364.7,364.7,.01,1,0)
^.1
"^DD",364.7,364.7,.01,1,1,0)
364.7^B
"^DD",364.7,364.7,.01,1,1,1)
S ^IBA(364.7,"B",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.01,1,1,2)
K ^IBA(364.7,"B",$E(X,1,30),DA)
"^DD",364.7,364.7,.01,1,2,0)
364.7^ATYPE^MUMPS
"^DD",364.7,364.7,.01,1,2,1)
N Z1,Z0 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3),'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,2,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,6) I Z1'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"ATYPE",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,2,"%D",0)
^^1^1^2980104^^^^
"^DD",364.7,364.7,.01,1,2,"%D",1,0)
Xref by form and bill type
"^DD",364.7,364.7,.01,1,2,"DT")
2960117
"^DD",364.7,364.7,.01,1,3,0)
364.7^AINTYP^MUMPS
"^DD",364.7,364.7,.01,1,3,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) S ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)=""
"^DD",364.7,364.7,.01,1,3,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5),Z2=$P(Z0,U,6) I Z1,Z2'="",$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINTYP",$P(^IBA(364.6,+X,0),U,3),Z1,Z2,DA)
"^DD",364.7,364.7,.01,1,3,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,3,"%D",0)
^^1^1^2971231^^^
"^DD",364.7,364.7,.01,1,3,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.01,1,3,"DT")
2960117
"^DD",364.7,364.7,.01,1,4,0)
364.7^AINS^MUMPS
"^DD",364.7,364.7,.01,1,4,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3),$P(Z0,U,6)="" S ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)=""
"^DD",364.7,364.7,.01,1,4,2)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P(Z0,U,5) I Z1,$P($G(^IBA(364.6,+X,0)),U,3) K ^IBA(364.7,"AINS",$P(^IBA(364.6,+X,0),U,3),Z1,DA)
"^DD",364.7,364.7,.01,1,4,3)
DO NOT DELETE
"^DD",364.7,364.7,.01,1,4,"%D",0)
^^1^1^2971231^^
"^DD",364.7,364.7,.01,1,4,"%D",1,0)
Xref by form field and insurance company
"^DD",364.7,364.7,.01,1,4,"DT")
2960118
"^DD",364.7,364.7,.01,3)
Enter the billing form that this field is associated with
"^DD",364.7,364.7,.01,21,0)
^^2^2^2951207^^^^
"^DD",364.7,364.7,.01,21,1,0)
This is a pointer to the billing form field that this field is associated
"^DD",364.7,364.7,.01,21,2,0)
with.
"^DD",364.7,364.7,.01,"DT")
3000428
"^DD",364.7,364.7,.02,0)
SECURITY LEVEL^S^N:NATIONAL,NO EDIT;L:LOCAL;^0;2^Q
"^DD",364.7,364.7,.02,3)
Enter N for nationally released fields (no edit) or L for locally added fields.
"^DD",364.7,364.7,.02,21,0)
^^3^3^2951219^^^
"^DD",364.7,364.7,.02,21,1,0)
This field determines whether or not editing of the entry is allowed.  For
"^DD",364.7,364.7,.02,21,2,0)
NATIONAL (N) field, no local editing is allowed.  If LOCAL (L) field is
"^DD",364.7,364.7,.02,21,3,0)
created, editing is allowed.
"^DD",364.7,364.7,.02,"DT")
3000428
"^DD",364.7,364.7,.03,0)
DATA ELEMENT^P364.5'^IBA(364.5,^0;3^Q
"^DD",364.7,364.7,.03,1,0)
^.1
"^DD",364.7,364.7,.03,1,1,0)
364.7^C
"^DD",364.7,364.7,.03,1,1,1)
S ^IBA(364.7,"C",$E(X,1,30),DA)=""
"^DD",364.7,364.7,.03,1,1,2)
K ^IBA(364.7,"C",$E(X,1,30),DA)
"^DD",364.7,364.7,.03,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.03,1,1,"%D",0)
^^1^1^2960702^
"^DD",364.7,364.7,.03,1,1,"%D",1,0)
Xref by DATA ELEMENT NAME
"^DD",364.7,364.7,.03,1,1,"DT")
2960702
"^DD",364.7,364.7,.03,3)
Enter the data element that will define this form field.  If used on a screen, it must be a fileman type.
"^DD",364.7,364.7,.03,21,0)
^^1^1^2960627^^^^
"^DD",364.7,364.7,.03,21,1,0)
This identifies the data element that be extracted for this entry.
"^DD",364.7,364.7,.03,23,0)
^^4^4^2960627^^^^
"^DD",364.7,364.7,.03,23,1,0)
This is the data element that will be allowed to be displayed/edited on a
"^DD",364.7,364.7,.03,23,2,0)
screen, extracted for a transmit, or printed on a printed form.  If used on
"^DD",364.7,364.7,.03,23,3,0)
a screen, the data element must be a fileman type and a local field (>10000
"^DD",364.7,364.7,.03,23,4,0)
for ifn and on a node >10000) to be editable.
"^DD",364.7,364.7,.03,"DT")
2960702
"^DD",364.7,364.7,.04,0)
SCREEN PROMPT^FX^^0;4^K:$L(X)>70!($L(X)<1) X I $D(X),$P($G(^IBE(353,+$G(^IBA(364.6,+$G(^IBA(364.7,DA,0)),0)),2)),U,2)'="S" K X
"^DD",364.7,364.7,.04,.1)
 
"^DD",364.7,364.7,.04,1,0)
^.1^^0
"^DD",364.7,364.7,.04,3)
Answer must be 1-70 characters in length.
"^DD",364.7,364.7,.04,21,0)
3^^2^2^2960321^^^^
"^DD",364.7,364.7,.04,21,1,0)
This is used only by screen-type forms to place a prompt on the screen
"^DD",364.7,364.7,.04,21,2,0)
for a particular field.
"^DD",364.7,364.7,.04,23,0)
^^3^3^2960321^^^^
"^DD",364.7,364.7,.04,23,1,0)
This is the prompt that will preceed the data element defined for this
"^DD",364.7,364.7,.04,23,2,0)
entry.  If no data element, this prompt will display.  This field is only
"^DD",364.7,364.7,.04,23,3,0)
used for screen-type forms.
"^DD",364.7,364.7,.04,"DT")
2960321
"^DD",364.7,364.7,.05,0)
INSURANCE COMPANY^P36'^DIC(36,^0;5^Q
"^DD",364.7,364.7,.05,1,0)
^.1
"^DD",364.7,364.7,.05,1,1,0)
364.7^AINS1^MUMPS
"^DD",364.7,364.7,.05,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,$P(Z0,U,6)="" S ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.05,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K ^IBA(364.7,"AINS",Z1,$E(X,1,30),DA) I Z2'="",$D(^IBA(364.7,"AINTYP",Z1,X,Z2,DA)) S ^IBA(364.7,"ATYPE",Z1,Z2,DA)=""
"^DD",364.7,364.7,.05,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,1,"%D",0)
^^1^1^2960118^
"^DD",364.7,364.7,.05,1,1,"%D",1,0)
Xref by form field and insurance company.
"^DD",364.7,364.7,.05,1,1,"DT")
2960118
"^DD",364.7,364.7,.05,1,2,0)
364.7^AINTYP1^MUMPS
"^DD",364.7,364.7,.05,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) I Z1,Z2'="" S ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)="" K ^IBA(364.7,"ATYPE",Z1,Z2,DA),^IBA(364.7,"AINS",Z1,X,DA)
"^DD",364.7,364.7,.05,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,6) K:Z1&(Z2'="") ^IBA(364.7,"AINTYP",Z1,$E(X,1,30),Z2,DA)
"^DD",364.7,364.7,.05,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.05,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.05,1,2,"%D",1,0)
Xref by insurance company and bill type
"^DD",364.7,364.7,.05,1,2,"DT")
2960117
"^DD",364.7,364.7,.05,3)
Enter the name of the insurance company that this field is associated with.
"^DD",364.7,364.7,.05,21,0)
^^2^2^2951207^
"^DD",364.7,364.7,.05,21,1,0)
This is the insurance company who has a need for other than the standard
"^DD",364.7,364.7,.05,21,2,0)
data in this field.
"^DD",364.7,364.7,.05,"DT")
3000428
"^DD",364.7,364.7,.06,0)
BILL TYPE^S^I:INPATIENT;O:OUTPATIENT;^0;6^Q
"^DD",364.7,364.7,.06,1,0)
^.1
"^DD",364.7,364.7,.06,1,1,0)
364.7^ATYPE1^MUMPS
"^DD",364.7,364.7,.06,1,1,1)
N Z0,Z1 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3) I Z1,'$P(Z0,U,5) S ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,1,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1 K ^IBA(364.7,"ATYPE",Z1,$E(X,1,30),DA) I Z2,$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) S ^IBA(364.7,"AINS",Z1,Z2,DA)=""
"^DD",364.7,364.7,.06,1,1,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,1,"%D",0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,1,1,"%D",1,0)
Xref by form and bill type.
"^DD",364.7,364.7,.06,1,1,"DT")
2960117
"^DD",364.7,364.7,.06,1,2,0)
364.7^AINTYP2^MUMPS
"^DD",364.7,364.7,.06,1,2,1)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) I Z1,Z2 K:'$D(^IBA(364.7,"AINTYP",Z1,Z2,X,DA)) ^IBA(364.7,"AINS",Z1,Z2,DA) S ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)=""
"^DD",364.7,364.7,.06,1,2,2)
N Z0,Z1,Z2 S Z0=$G(^IBA(364.7,DA,0)),Z1=+$P($G(^IBA(364.6,+Z0,0)),U,3),Z2=$P(Z0,U,5) K:Z1&Z2 ^IBA(364.7,"AINTYP",Z1,Z2,$E(X,1,30),DA)
"^DD",364.7,364.7,.06,1,2,3)
DO NOT DELETE
"^DD",364.7,364.7,.06,1,2,"%D",0)
^^1^1^2960117^^^^
"^DD",364.7,364.7,.06,1,2,"%D",1,0)
Xref by form, insurance company and bill type
"^DD",364.7,364.7,.06,1,2,"DT")
2960117
"^DD",364.7,364.7,.06,3)
Enter the type of the bill.
"^DD",364.7,364.7,.06,21,0)
^^1^1^2960117^^
"^DD",364.7,364.7,.06,21,1,0)
This is the type of bill that requires this field.
"^DD",364.7,364.7,.06,"DT")
3000428
"^DD",364.7,364.7,.07,0)
PAD CHARACTER^S^ZL:ZERO PAD ON LEFT;ZR:ZERO PAD ON RIGHT;SL:SPACE PAD ON LEFT;SR:SPACE PAD ON RIGHT;N:NO PAD REQUIRED;^0;7^Q
"^DD",364.7,364.7,.07,3)
Enter the code that corresponds to the format and pad character to use for the data output in this field.
"^DD",364.7,364.7,.07,21,0)
^^3^3^2960126^^
"^DD",364.7,364.7,.07,21,1,0)
If present, this defines the character to be used to pad the DATA
"^DD",364.7,364.7,.07,21,2,0)
ELEMENT to its desired length and the orientation of the padding characters
"^DD",364.7,364.7,.07,21,3,0)
to the left or right of the data.  The default is space pad to the right.
"^DD",364.7,364.7,.07,"DT")
2960126
"^DD",364.7,364.7,.08,0)
REQUIRED^S^0:NO;1:YES;^0;8^Q
"^DD",364.7,364.7,.08,3)
Enter 1 (YES) if this data element is on a local screen 9 form and the data is required for the bill to be authorized.
"^DD",364.7,364.7,.08,21,0)
^.001^4^4^3001030^^
"^DD",364.7,364.7,.08,21,1,0)
This field controls the required/not required status of a data element
"^DD",364.7,364.7,.08,21,2,0)
on a local screen 9 form.  If this field is 1 (YES), this data element
"^DD",364.7,364.7,.08,21,3,0)
is always required to have data (not null) in order for a bill to be
"^DD",364.7,364.7,.08,21,4,0)
authorized.
"^DD",364.7,364.7,.08,"DT")
2951207
"^DD",364.7,364.7,.09,0)
EDIT STATUS^S^E:EDITABLE;D:DISPLAY ONLY;^0;9^Q
"^DD",364.7,364.7,.09,3)
Enter 'E' to enable editing for this field, 'D' for a display only field.
"^DD",364.7,364.7,.09,21,0)
^^2^2^2960320^
"^DD",364.7,364.7,.09,21,1,0)
This field is used to control whether or not a data element on a screen is
"^DD",364.7,364.7,.09,21,2,0)
editable or for display-only purposes.
"^DD",364.7,364.7,.09,"DT")
2960320
"^DD",364.7,364.7,.1,0)
EDIT GROUP NUMBER^NJ2,0^^0;10^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",364.7,364.7,.1,3)
 Enter the edit group # that this field will be included in.  Valid #'s are 1-99.
"^DD",364.7,364.7,.1,21,0)
^^6^6^2960321^^
"^DD",364.7,364.7,.1,21,1,0)
This field contains the # of the edit group that the screen data element
"^DD",364.7,364.7,.1,21,2,0)
will be included with.  When this group # is selected on an edit screen,
"^DD",364.7,364.7,.1,21,3,0)
all data elements assigned to this group # on this screen will be presented
"^DD",364.7,364.7,.1,21,4,0)
for editing.  If no # is entered here, this field will not be available for
"^DD",364.7,364.7,.1,21,5,0)
editing.  This field will only apply to screen-type forms' editable data
"^DD",364.7,364.7,.1,21,6,0)
element descriptions.
"^DD",364.7,364.7,.1,"DT")
2960321
"^DD",364.7,364.7,1,0)
FORMAT CODE^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",364.7,364.7,1,3)
This is Standard MUMPS code.
"^DD",364.7,364.7,1,9)
@
"^DD",364.7,364.7,1,21,0)
^^8^8^2951207^
"^DD",364.7,364.7,1,21,1,0)
This is the code that will be xecuted to format the 'raw' data element
"^DD",364.7,364.7,1,21,2,0)
value that is returned from the execution of the DATA ELEMENT's definition.
"^DD",364.7,364.7,1,21,3,0)
This code can assume the variable/array IBXDATA is available as input and
"^DD",364.7,364.7,1,21,4,0)
should set this variable/array as its output.  Standard calls for data
"^DD",364.7,364.7,1,21,5,0)
formatting have been provided.  The variables IBXPG, IBXLN, IBXCOL are the
"^DD",364.7,364.7,1,21,6,0)
only IBX* variables that should be changed in this routine.  These represent
"^DD",364.7,364.7,1,21,7,0)
the page, line, column as the first 3 levels of subscript for the output
"^DD",364.7,364.7,1,21,8,0)
array.
"^DD",364.7,364.7,1,"DT")
2951207
"^DD",364.7,364.7,3,0)
FORMAT CODE DESCRIPTION^364.73^^3;0
"^DD",364.7,364.7,3,21,0)
^.001^1^1^3010102^^
"^DD",364.7,364.7,3,21,1,0)
This field describes the function of the format code entered.
"^DD",364.7,364.7,3,"DT")
2960710
"^DD",364.7,364.73,0)
FORMAT CODE DESCRIPTION SUB-FIELD^^.01^1
"^DD",364.7,364.73,0,"DT")
2960710
"^DD",364.7,364.73,0,"NM","FORMAT CODE DESCRIPTION")
 
"^DD",364.7,364.73,0,"UP")
364.7
"^DD",364.7,364.73,.01,0)
FORMAT CODE DESCRIPTION^W^^0;1^Q
"^DD",364.7,364.73,.01,3)
Enter a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,21,0)
^.001^1^1^3010102^^^^
"^DD",364.7,364.73,.01,21,1,0)
This is a description of the processing logic of the format code.
"^DD",364.7,364.73,.01,"DT")
2960710
"^DD",399,399,28.1,0)
MRA REVIEW STATUS^S^0:NOT BEING REVIEWED;1:REVIEW IN PROCESS;^TX;10^Q
"^DD",399,399,28.1,3)
Enter code indicating whether this MRA claim is being reviewed.
"^DD",399,399,28.1,21,0)
^^1^1^3080102^
"^DD",399,399,28.1,21,1,0)
Select code that indicates whether this MRA claim is under review.
"^DD",399,399,28.1,"DT")
3080102
"^DD",399,399,77,0)
MRA REQUEST CLAIM COMMENTS^399.077DA^^TXC;0
"^DD",399,399,77,21,0)
^^7^7^3071115^
"^DD",399,399,77,21,1,0)
This multiple structure is available only for those claims in a status of 
"^DD",399,399,77,21,2,0)
2 - REQUEST MRA.  This will allow the users to enter comments either in 
"^DD",399,399,77,21,3,0)
TPJI or in the MRA worklist that pertain to this claim during the time 
"^DD",399,399,77,21,4,0)
the MRA request claim is sent to Medicare and before the MRA secondary 
"^DD",399,399,77,21,5,0)
claim is authorized to the secondary payer.
"^DD",399,399,77,21,6,0)
 
"^DD",399,399,77,21,7,0)
Once entered, comments may not be edited or deleted by the users.
"^DD",399,399,77,"DT")
3071105
"^DD",399,399.042,.09,0)
NON-COVERED CHARGE^NJ8,2^^0;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>99999)!(X<0)!(X?.E1"."3.N) X
"^DD",399,399.042,.09,3)
Type a Dollar amount between 0 and 99999, 2 Decimal Digits
"^DD",399,399.042,.09,21,0)
^^3^3^3080204^
"^DD",399,399.042,.09,21,1,0)
This is the amount of the charges that are not covered for this revenue
"^DD",399,399.042,.09,21,2,0)
code line item.  Use to record things such as pass days that need to be
"^DD",399,399.042,.09,21,3,0)
reported but are not chargeable.
"^DD",399,399.042,.09,"DT")
3080204
"^DD",399,399.077,0)
MRA REQUEST CLAIM COMMENTS SUB-FIELD^^.03^3
"^DD",399,399.077,0,"DIK")
IBXX
"^DD",399,399.077,0,"DT")
3071115
"^DD",399,399.077,0,"IX","B",399.077,.01)

"^DD",399,399.077,0,"NM","MRA REQUEST CLAIM COMMENTS")

"^DD",399,399.077,0,"UP")
399
"^DD",399,399.077,.01,0)
COMMENT ENTERED DATE^D^^0;1^S %DT="ESTX" D ^%DT S X=Y K:X<1 X
"^DD",399,399.077,.01,1,0)
^.1^^-1
"^DD",399,399.077,.01,1,1,0)
399.077^B
"^DD",399,399.077,.01,1,1,1)
S ^DGCR(399,DA(1),"TXC","B",$E(X,1,30),DA)=""
"^DD",399,399.077,.01,1,1,2)
K ^DGCR(399,DA(1),"TXC","B",$E(X,1,30),DA)
"^DD",399,399.077,.01,1,2,0)
^^TRIGGER^399.077^.02
"^DD",399,399.077,.01,1,2,1)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^DGCR(399,D0,"TXC",D1,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X=DUZ X ^DD(399.077,.01,1,2,1.4)
"^DD",399,399.077,.01,1,2,1.4)
S DIH=$G(^DGCR(399,DIV(0),"TXC",DIV(1),0)),DIV=X S $P(^(0),U,2)=DIV,DIH=399.077,DIG=.02 D ^DICR
"^DD",399,399.077,.01,1,2,2)
Q
"^DD",399,399.077,.01,1,2,"CREATE VALUE")
S X=DUZ
"^DD",399,399.077,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",399,399.077,.01,1,2,"DT")
3071105
"^DD",399,399.077,.01,1,2,"FIELD")
COMMENT ENTERED BY
"^DD",399,399.077,.01,3)
(No range limit on date)
"^DD",399,399.077,.01,21,0)
^^2^2^3071105^
"^DD",399,399.077,.01,21,1,0)
This is the date/time the comment was entered into the system.  Set 
"^DD",399,399.077,.01,21,2,0)
automatically.  Don't edit through Fileman.
"^DD",399,399.077,.01,"DT")
3071115
"^DD",399,399.077,.02,0)
COMMENT ENTERED BY^P200'^VA(200,^0;2^Q
"^DD",399,399.077,.02,5,1,0)
399.077^.01^2
"^DD",399,399.077,.02,21,0)
^^2^2^3071105^
"^DD",399,399.077,.02,21,1,0)
This is the user who entered the comment.  Set by the system 
"^DD",399,399.077,.02,21,2,0)
automatically.  Don't edit through Fileman.
"^DD",399,399.077,.02,"DT")
3071105
"^DD",399,399.077,.03,0)
COMMENTS^399.0771^^1;0
"^DD",399,399.0771,0)
COMMENTS SUB-FIELD^^.01^1
"^DD",399,399.0771,0,"DT")
3071115
"^DD",399,399.0771,0,"NM","COMMENTS")

"^DD",399,399.0771,0,"UP")
399.077
"^DD",399,399.0771,.01,0)
COMMENTS^W^^0;1
"^DD",399,399.0771,.01,"DT")
3071115
"^DIC",350.8,350.8,0)
IB ERROR
"^DIC",350.8,350.8,0,"GL")
^IBE(350.8,
"^DIC",350.8,350.8,"%D",0)
^^11^11^2940214^^^^
"^DIC",350.8,350.8,"%D",1,0)
This file contains errors for billing functions.  It may be used by
"^DIC",350.8,350.8,"%D",2,0)
applications, IB or AR.  The normal format for a routine to return
"^DIC",350.8,350.8,"%D",3,0)
an error is to return the variable:
"^DIC",350.8,350.8,"%D",4,0)
  Y=1^... a successful event occured
"^DIC",350.8,350.8,"%D",5,0)
  Y=-1^error code[;error code;error code...]^additional text
"^DIC",350.8,350.8,"%D",6,0)
The error messages can be displayed by calling routine ^IBAERR.  If
"^DIC",350.8,350.8,"%D",7,0)
the error occurs in a tasked job ($D(ZTQUEUED)'=0) the routine will
"^DIC",350.8,350.8,"%D",8,0)
put the error message in a bulletin and post it to the group defined
"^DIC",350.8,350.8,"%D",9,0)
in the IB SITE PARAMETER FILE.
"^DIC",350.8,350.8,"%D",10,0)
 
"^DIC",350.8,350.8,"%D",11,0)
Per VHA Directive 10-93-142, this file definition should not be modified.
"^DIC",350.8,"B","IB ERROR",350.8)

"^DIC",364.5,364.5,0)
IB DATA ELEMENT DEFINITION^364.5
"^DIC",364.5,364.5,0,"GL")
^IBA(364.5,
"^DIC",364.5,364.5,"%D",0)
^^8^8^2970606^^^^
"^DIC",364.5,364.5,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.5,364.5,"%D",2,0)
 
"^DIC",364.5,364.5,"%D",3,0)
This file contains the definition of all data elements that are needed for
"^DIC",364.5,364.5,"%D",4,0)
various forms throughout the MCCR DHCP system.  It contains the 'blueprint'
"^DIC",364.5,364.5,"%D",5,0)
for how to extract the data for each data element entry.
"^DIC",364.5,364.5,"%D",6,0)
 
"^DIC",364.5,364.5,"%D",7,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.5,364.5,"%D",8,0)
NATIONAL should not be deleted or edited.
"^DIC",364.5,"B","IB DATA ELEMENT DEFINITION",364.5)

"^DIC",364.6,364.6,0)
IB FORM SKELETON DEFINITION^364.6P
"^DIC",364.6,364.6,0,"GL")
^IBA(364.6,
"^DIC",364.6,364.6,"%D",0)
^^10^10^2970606^^^^
"^DIC",364.6,364.6,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.6,364.6,"%D",2,0)
 
"^DIC",364.6,364.6,"%D",3,0)
This file contains records that define the skeleton makeup of forms for
"^DIC",364.6,364.6,"%D",4,0)
the IB system.  This definition includes the absolute position of every
"^DIC",364.6,364.6,"%D",5,0)
field that can be output on the form, the length each field must be limited
"^DIC",364.6,364.6,"%D",6,0)
to, and some descriptive information.   This includes printed forms,
"^DIC",364.6,364.6,"%D",7,0)
transmittable output files, and special local billing screens.
"^DIC",364.6,364.6,"%D",8,0)
 
"^DIC",364.6,364.6,"%D",9,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.6,364.6,"%D",10,0)
NATIONAL should not be deleted or edited.
"^DIC",364.6,"B","IB FORM SKELETON DEFINITION",364.6)

"^DIC",364.7,364.7,0)
IB FORM FIELD CONTENT^364.7P
"^DIC",364.7,364.7,0,"GL")
^IBA(364.7,
"^DIC",364.7,364.7,"%D",0)
^1.001^9^9^3030331^^^^
"^DIC",364.7,364.7,"%D",1,0)
DO NOT delete entries or edit data in this file with VA File Manager.
"^DIC",364.7,364.7,"%D",2,0)
 
"^DIC",364.7,364.7,"%D",3,0)
This is the file that contains the specific fields to be used to produce
"^DIC",364.7,364.7,"%D",4,0)
the associated form or screen.  If there is no insurance company or bill
"^DIC",364.7,364.7,"%D",5,0)
type specified for an entry, this is assumed to be the default definition
"^DIC",364.7,364.7,"%D",6,0)
of the field.
"^DIC",364.7,364.7,"%D",7,0)
 
"^DIC",364.7,364.7,"%D",8,0)
Entries in this file that are designated as having a SECURITY LEVEL of
"^DIC",364.7,364.7,"%D",9,0)
NATIONAL should not be deleted or edited.
"^DIC",364.7,"B","IB FORM FIELD CONTENT",364.7)

"BLD",6801,6)
^361
**END**
**END**
