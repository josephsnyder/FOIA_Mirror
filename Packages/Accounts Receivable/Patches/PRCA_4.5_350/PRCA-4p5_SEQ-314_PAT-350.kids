Released PRCA*4.5*350 SEQ #314
Extracted from mail message
**KIDS**:PRCA*4.5*350^

**INSTALL NAME**
PRCA*4.5*350
"BLD",11435,0)
PRCA*4.5*350^ACCOUNTS RECEIVABLE^0^3191121^y
"BLD",11435,4,0)
^9.64PA^430^3
"BLD",11435,4,340,0)
340
"BLD",11435,4,340,2,0)
^9.641^340.08^1
"BLD",11435,4,340,2,340.08,0)
TCSP REFERRAL STOP FLAG  (sub-file)
"BLD",11435,4,340,2,340.08,1,0)
^9.6411^^
"BLD",11435,4,340,222)
y^y^p^^^^n^^n
"BLD",11435,4,340,224)

"BLD",11435,4,342,0)
342
"BLD",11435,4,342,2,0)
^9.641^342.02^1
"BLD",11435,4,342,2,342.02,0)
TCSP REFERRAL STOP FLAG  (sub-file)
"BLD",11435,4,342,2,342.02,1,0)
^9.6411^^
"BLD",11435,4,342,222)
y^y^p^^^^n^^n
"BLD",11435,4,342,224)

"BLD",11435,4,430,0)
430
"BLD",11435,4,430,2,0)
^9.641^430^2
"BLD",11435,4,430,2,430,0)
ACCOUNTS RECEIVABLE  (File-top level)
"BLD",11435,4,430,2,430,1,0)
^9.6411^313^1
"BLD",11435,4,430,2,430,1,313,0)
TCSP AGENCY DEBT ID LAST 2
"BLD",11435,4,430,2,430.03,0)
TCSP RE-REFERRAL  (sub-file)
"BLD",11435,4,430,2,430.03,1,0)
^9.6411^^0
"BLD",11435,4,430,222)
y^y^p^^^^n^^n
"BLD",11435,4,430,224)

"BLD",11435,4,"APDD",340,340.08)

"BLD",11435,4,"APDD",342,342.02)

"BLD",11435,4,"APDD",430,430)

"BLD",11435,4,"APDD",430,430,313)

"BLD",11435,4,"APDD",430,430.03)

"BLD",11435,4,"B",340,340)

"BLD",11435,4,"B",342,342)

"BLD",11435,4,"B",430,430)

"BLD",11435,6.3)
66
"BLD",11435,"INIT")
PRCA350P
"BLD",11435,"KRN",0)
^9.67PA^1.5^24
"BLD",11435,"KRN",.4,0)
.4
"BLD",11435,"KRN",.401,0)
.401
"BLD",11435,"KRN",.402,0)
.402
"BLD",11435,"KRN",.403,0)
.403
"BLD",11435,"KRN",.5,0)
.5
"BLD",11435,"KRN",.84,0)
.84
"BLD",11435,"KRN",1.5,0)
1.5
"BLD",11435,"KRN",1.6,0)
1.6
"BLD",11435,"KRN",1.61,0)
1.61
"BLD",11435,"KRN",1.62,0)
1.62
"BLD",11435,"KRN",3.6,0)
3.6
"BLD",11435,"KRN",3.8,0)
3.8
"BLD",11435,"KRN",9.2,0)
9.2
"BLD",11435,"KRN",9.8,0)
9.8
"BLD",11435,"KRN",9.8,"NM",0)
^9.68A^31^20
"BLD",11435,"KRN",9.8,"NM",8,0)
RCMSITE^^0^B15588075
"BLD",11435,"KRN",9.8,"NM",11,0)
RCTCS1^^0^B35389559
"BLD",11435,"KRN",9.8,"NM",12,0)
RCTCSPD^^0^B186732025
"BLD",11435,"KRN",9.8,"NM",13,0)
RCTCSPD0^^0^B50618939
"BLD",11435,"KRN",9.8,"NM",14,0)
RCDPAPLI^^0^B54815509
"BLD",11435,"KRN",9.8,"NM",15,0)
RCDPBPLI^^0^B62077886
"BLD",11435,"KRN",9.8,"NM",16,0)
RCTCSPD4^^0^B137477745
"BLD",11435,"KRN",9.8,"NM",17,0)
RCTCSPU^^0^B158004141
"BLD",11435,"KRN",9.8,"NM",18,0)
PRCAATR^^0^B30173934
"BLD",11435,"KRN",9.8,"NM",19,0)
PRCADR2^^0^B17441606
"BLD",11435,"KRN",9.8,"NM",20,0)
PRCAAPR1^^0^B50745979
"BLD",11435,"KRN",9.8,"NM",21,0)
RCTCSP6^^0^B25942174
"BLD",11435,"KRN",9.8,"NM",22,0)
RCTCSP1^^0^B180726481
"BLD",11435,"KRN",9.8,"NM",23,0)
RCTCSP2^^0^B135224269
"BLD",11435,"KRN",9.8,"NM",24,0)
RCTCSP7^^0^B6178603
"BLD",11435,"KRN",9.8,"NM",27,0)
RCTCSP3^^0^B82194427
"BLD",11435,"KRN",9.8,"NM",28,0)
RCTCSP4^^0^B218661025
"BLD",11435,"KRN",9.8,"NM",29,0)
RCTCSP4E^^0^B93559916
"BLD",11435,"KRN",9.8,"NM",30,0)
PRCABJV^^0^B55801728
"BLD",11435,"KRN",9.8,"NM",31,0)
PRCACDRP^^0^B72854172
"BLD",11435,"KRN",9.8,"NM","B","PRCAAPR1",20)

"BLD",11435,"KRN",9.8,"NM","B","PRCAATR",18)

"BLD",11435,"KRN",9.8,"NM","B","PRCABJV",30)

"BLD",11435,"KRN",9.8,"NM","B","PRCACDRP",31)

"BLD",11435,"KRN",9.8,"NM","B","PRCADR2",19)

"BLD",11435,"KRN",9.8,"NM","B","RCDPAPLI",14)

"BLD",11435,"KRN",9.8,"NM","B","RCDPBPLI",15)

"BLD",11435,"KRN",9.8,"NM","B","RCMSITE",8)

"BLD",11435,"KRN",9.8,"NM","B","RCTCS1",11)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP1",22)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP2",23)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP3",27)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP4",28)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP4E",29)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP6",21)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSP7",24)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSPD",12)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSPD0",13)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSPD4",16)

"BLD",11435,"KRN",9.8,"NM","B","RCTCSPU",17)

"BLD",11435,"KRN",19,0)
19
"BLD",11435,"KRN",19,"NM",0)
^9.68A^44^44
"BLD",11435,"KRN",19,"NM",1,0)
RCTCSP MENU^^0
"BLD",11435,"KRN",19,"NM",2,0)
PRCA SITE PARAMETER^^0
"BLD",11435,"KRN",19,"NM",3,0)
RCTCSP STOP^^0^
"BLD",11435,"KRN",19,"NM",4,0)
RCTCSP RECALLB^^4^
"BLD",11435,"KRN",19,"NM",5,0)
RCTCSP RECALLD^^4^
"BLD",11435,"KRN",19,"NM",6,0)
RCTCSP BILL REPORT^^4^
"BLD",11435,"KRN",19,"NM",7,0)
RCTCSP REPORT^^4^
"BLD",11435,"KRN",19,"NM",8,0)
RCTCSP RECALL REPORT^^4^
"BLD",11435,"KRN",19,"NM",9,0)
RCTCSP REJECT REPORT^^4^
"BLD",11435,"KRN",19,"NM",10,0)
RCTCSP IAI ERROR CODES LIST^^4^
"BLD",11435,"KRN",19,"NM",11,0)
RCTCSP STOP REACTIVATE REPORT^^0^
"BLD",11435,"KRN",19,"NM",12,0)
RCTCSP IAI REPORT^^4^
"BLD",11435,"KRN",19,"NM",13,0)
RCDP TCSP FLAG CONTROL^^4^
"BLD",11435,"KRN",19,"NM",14,0)
RCTCSP RECONCILIATION WORKLIST^^4^
"BLD",11435,"KRN",19,"NM",15,0)
RCTCSP RECONCIL REPORT^^4^
"BLD",11435,"KRN",19,"NM",16,0)
PRCA NOTIFICATION PARAMETERS^^4^
"BLD",11435,"KRN",19,"NM",17,0)
PRCA BIL AGENCY^^4^
"BLD",11435,"KRN",19,"NM",18,0)
PRCAF U ADMIN.RATE^^4^
"BLD",11435,"KRN",19,"NM",19,0)
PRCA DEACTIVATE GROUP^^4^
"BLD",11435,"KRN",19,"NM",20,0)
PRCA RC PARAMETERS^^4^
"BLD",11435,"KRN",19,"NM",21,0)
RCDPE EDI LOCKBOX PARAMETERS^^4^
"BLD",11435,"KRN",19,"NM",22,0)
PRCA CBO PARAMETERS^^4^
"BLD",11435,"KRN",19,"NM",23,0)
RCDPE SITE PARAMETER REPORT^^4^
"BLD",11435,"KRN",19,"NM",24,0)
RCDPE PARAMETER AUDIT REPORT^^4^
"BLD",11435,"KRN",19,"NM",25,0)
RCDPE EXCLUSION AUDIT REPORT^^4^
"BLD",11435,"KRN",19,"NM",26,0)
PRCA STOP SITE^^0
"BLD",11435,"KRN",19,"NM",27,0)
RCTCSP REREFER BILL^^0
"BLD",11435,"KRN",19,"NM",28,0)
RCTCSP REREFER BILL REPORT^^0
"BLD",11435,"KRN",19,"NM",29,0)
PRCA RCDMC REFERRAL MENU^^0
"BLD",11435,"KRN",19,"NM",30,0)
PRCA RCDMC 90 DAY REPORT^^4^
"BLD",11435,"KRN",19,"NM",31,0)
PRCA RCDMC REFERRED RPT^^4^
"BLD",11435,"KRN",19,"NM",32,0)
PRCA RCDMC LESSER WITHHOLDING^^4^
"BLD",11435,"KRN",19,"NM",33,0)
PRCA RCDMC CANCEL^^4^
"BLD",11435,"KRN",19,"NM",34,0)
RCDMCR1 DEBT VALIDITY REPORT^^4^
"BLD",11435,"KRN",19,"NM",35,0)
RCDMCR2 DEBT VALIDITY MGMT RPT^^4^
"BLD",11435,"KRN",19,"NM",36,0)
RCDMCR3 RD ELIG CHANGE REPORT^^4^
"BLD",11435,"KRN",19,"NM",37,0)
RCDMCEDT ENTER/EDIT DMC DEBT ^^4^
"BLD",11435,"KRN",19,"NM",38,0)
RCDMC EDIT RD # OF DAYS PARAME^^4^
"BLD",11435,"KRN",19,"NM",39,0)
RCDMC EDIT DMC REPORT # OF DAY^^4^
"BLD",11435,"KRN",19,"NM",40,0)
RCDMCR4 0-40 PERC SC CHNG RPT^^4^
"BLD",11435,"KRN",19,"NM",41,0)
RCDMCR5 1ST PARTY IB CANC RPT^^4^
"BLD",11435,"KRN",19,"NM",42,0)
RCDMCR7 10-40% COPAY RPT^^4^
"BLD",11435,"KRN",19,"NM",43,0)
RCDMCR6 50-100SC EXMPT RPT^^4^
"BLD",11435,"KRN",19,"NM",44,0)
PRCA CD EXEMPT COPAY CHRG RPT^^0
"BLD",11435,"KRN",19,"NM","B","PRCA BIL AGENCY",17)

"BLD",11435,"KRN",19,"NM","B","PRCA CBO PARAMETERS",22)

"BLD",11435,"KRN",19,"NM","B","PRCA CD EXEMPT COPAY CHRG RPT",44)

"BLD",11435,"KRN",19,"NM","B","PRCA DEACTIVATE GROUP",19)

"BLD",11435,"KRN",19,"NM","B","PRCA NOTIFICATION PARAMETERS",16)

"BLD",11435,"KRN",19,"NM","B","PRCA RC PARAMETERS",20)

"BLD",11435,"KRN",19,"NM","B","PRCA RCDMC 90 DAY REPORT",30)

"BLD",11435,"KRN",19,"NM","B","PRCA RCDMC CANCEL",33)

"BLD",11435,"KRN",19,"NM","B","PRCA RCDMC LESSER WITHHOLDING",32)

"BLD",11435,"KRN",19,"NM","B","PRCA RCDMC REFERRAL MENU",29)

"BLD",11435,"KRN",19,"NM","B","PRCA RCDMC REFERRED RPT",31)

"BLD",11435,"KRN",19,"NM","B","PRCA SITE PARAMETER",2)

"BLD",11435,"KRN",19,"NM","B","PRCA STOP SITE",26)

"BLD",11435,"KRN",19,"NM","B","PRCAF U ADMIN.RATE",18)

"BLD",11435,"KRN",19,"NM","B","RCDMC EDIT DMC REPORT # OF DAY",39)

"BLD",11435,"KRN",19,"NM","B","RCDMC EDIT RD # OF DAYS PARAME",38)

"BLD",11435,"KRN",19,"NM","B","RCDMCEDT ENTER/EDIT DMC DEBT ",37)

"BLD",11435,"KRN",19,"NM","B","RCDMCR1 DEBT VALIDITY REPORT",34)

"BLD",11435,"KRN",19,"NM","B","RCDMCR2 DEBT VALIDITY MGMT RPT",35)

"BLD",11435,"KRN",19,"NM","B","RCDMCR3 RD ELIG CHANGE REPORT",36)

"BLD",11435,"KRN",19,"NM","B","RCDMCR4 0-40 PERC SC CHNG RPT",40)

"BLD",11435,"KRN",19,"NM","B","RCDMCR5 1ST PARTY IB CANC RPT",41)

"BLD",11435,"KRN",19,"NM","B","RCDMCR6 50-100SC EXMPT RPT",43)

"BLD",11435,"KRN",19,"NM","B","RCDMCR7 10-40% COPAY RPT",42)

"BLD",11435,"KRN",19,"NM","B","RCDP TCSP FLAG CONTROL",13)

"BLD",11435,"KRN",19,"NM","B","RCDPE EDI LOCKBOX PARAMETERS",21)

"BLD",11435,"KRN",19,"NM","B","RCDPE EXCLUSION AUDIT REPORT",25)

"BLD",11435,"KRN",19,"NM","B","RCDPE PARAMETER AUDIT REPORT",24)

"BLD",11435,"KRN",19,"NM","B","RCDPE SITE PARAMETER REPORT",23)

"BLD",11435,"KRN",19,"NM","B","RCTCSP BILL REPORT",6)

"BLD",11435,"KRN",19,"NM","B","RCTCSP IAI ERROR CODES LIST",10)

"BLD",11435,"KRN",19,"NM","B","RCTCSP IAI REPORT",12)

"BLD",11435,"KRN",19,"NM","B","RCTCSP MENU",1)

"BLD",11435,"KRN",19,"NM","B","RCTCSP RECALL REPORT",8)

"BLD",11435,"KRN",19,"NM","B","RCTCSP RECALLB",4)

"BLD",11435,"KRN",19,"NM","B","RCTCSP RECALLD",5)

"BLD",11435,"KRN",19,"NM","B","RCTCSP RECONCIL REPORT",15)

"BLD",11435,"KRN",19,"NM","B","RCTCSP RECONCILIATION WORKLIST",14)

"BLD",11435,"KRN",19,"NM","B","RCTCSP REJECT REPORT",9)

"BLD",11435,"KRN",19,"NM","B","RCTCSP REPORT",7)

"BLD",11435,"KRN",19,"NM","B","RCTCSP REREFER BILL",27)

"BLD",11435,"KRN",19,"NM","B","RCTCSP REREFER BILL REPORT",28)

"BLD",11435,"KRN",19,"NM","B","RCTCSP STOP",3)

"BLD",11435,"KRN",19,"NM","B","RCTCSP STOP REACTIVATE REPORT",11)

"BLD",11435,"KRN",19.1,0)
19.1
"BLD",11435,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",11435,"KRN",19.1,"NM",1,0)
PRCA CS STOP SITE^^0
"BLD",11435,"KRN",19.1,"NM","B","PRCA CS STOP SITE",1)

"BLD",11435,"KRN",101,0)
101
"BLD",11435,"KRN",101,"NM",0)
^9.68A^^
"BLD",11435,"KRN",409.61,0)
409.61
"BLD",11435,"KRN",771,0)
771
"BLD",11435,"KRN",779.2,0)
779.2
"BLD",11435,"KRN",870,0)
870
"BLD",11435,"KRN",8989.51,0)
8989.51
"BLD",11435,"KRN",8989.52,0)
8989.52
"BLD",11435,"KRN",8994,0)
8994
"BLD",11435,"KRN","B",.4,.4)

"BLD",11435,"KRN","B",.401,.401)

"BLD",11435,"KRN","B",.402,.402)

"BLD",11435,"KRN","B",.403,.403)

"BLD",11435,"KRN","B",.5,.5)

"BLD",11435,"KRN","B",.84,.84)

"BLD",11435,"KRN","B",1.5,1.5)

"BLD",11435,"KRN","B",1.6,1.6)

"BLD",11435,"KRN","B",1.61,1.61)

"BLD",11435,"KRN","B",1.62,1.62)

"BLD",11435,"KRN","B",3.6,3.6)

"BLD",11435,"KRN","B",3.8,3.8)

"BLD",11435,"KRN","B",9.2,9.2)

"BLD",11435,"KRN","B",9.8,9.8)

"BLD",11435,"KRN","B",19,19)

"BLD",11435,"KRN","B",19.1,19.1)

"BLD",11435,"KRN","B",101,101)

"BLD",11435,"KRN","B",409.61,409.61)

"BLD",11435,"KRN","B",771,771)

"BLD",11435,"KRN","B",779.2,779.2)

"BLD",11435,"KRN","B",870,870)

"BLD",11435,"KRN","B",8989.51,8989.51)

"BLD",11435,"KRN","B",8989.52,8989.52)

"BLD",11435,"KRN","B",8994,8994)

"BLD",11435,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",11435,"QUES",0)
^9.62^^
"BLD",11435,"REQB",0)
^9.611^5^5
"BLD",11435,"REQB",1,0)
PRCA*4.5*337^1
"BLD",11435,"REQB",2,0)
PRCA*4.5*336^1
"BLD",11435,"REQB",3,0)
PRCA*4.5*344^1
"BLD",11435,"REQB",4,0)
PRCA*4.5*341^1
"BLD",11435,"REQB",5,0)
PRCA*4.5*351^1
"BLD",11435,"REQB","B","PRCA*4.5*336",2)

"BLD",11435,"REQB","B","PRCA*4.5*337",1)

"BLD",11435,"REQB","B","PRCA*4.5*341",4)

"BLD",11435,"REQB","B","PRCA*4.5*344",3)

"BLD",11435,"REQB","B","PRCA*4.5*351",5)

"FIA",340)
AR DEBTOR
"FIA",340,0)
^RCD(340,
"FIA",340,0,0)
340V
"FIA",340,0,1)
y^y^p^^^^n^^n
"FIA",340,0,10)

"FIA",340,0,11)

"FIA",340,0,"RLRO")

"FIA",340,0,"VR")
4.5^PRCA
"FIA",340,340)
1
"FIA",340,340,8)

"FIA",340,340.08)
0
"FIA",342)
AR SITE PARAMETER
"FIA",342,0)
^RC(342,
"FIA",342,0,0)
342P
"FIA",342,0,1)
y^y^p^^^^n^^n
"FIA",342,0,10)

"FIA",342,0,11)

"FIA",342,0,"RLRO")

"FIA",342,0,"VR")
4.5^PRCA
"FIA",342,342)
1
"FIA",342,342,40)

"FIA",342,342.02)
0
"FIA",430)
ACCOUNTS RECEIVABLE
"FIA",430,0)
^PRCA(430,
"FIA",430,0,0)
430I
"FIA",430,0,1)
y^y^p^^^^n^^n
"FIA",430,0,10)

"FIA",430,0,11)

"FIA",430,0,"RLRO")

"FIA",430,0,"VR")
4.5^PRCA
"FIA",430,430)
1
"FIA",430,430,159.9)

"FIA",430,430,313)

"FIA",430,430.03)
0
"INIT")
PRCA350P
"KRN",19,1422,-1)
4^18
"KRN",19,1422,0)
PRCAF U ADMIN.RATE
"KRN",19,1502,-1)
4^17
"KRN",19,1502,0)
PRCA BIL AGENCY
"KRN",19,5004,-1)
0^2
"KRN",19,5004,0)
PRCA SITE PARAMETER^Site Parameter Edit^^M^^^^^^^^ACCOUNTS RECEIVABLE
"KRN",19,5004,1,0)
^19.06^4^4^3180731^^^^
"KRN",19,5004,1,1,0)
This option will allow the AR Supervisor to edit the site parameters
"KRN",19,5004,1,2,0)
for the AR Package.  The site parameters allows the system to tailor
"KRN",19,5004,1,3,0)
itself for specific site needs, such as: Number of days to purge
"KRN",19,5004,1,4,0)
Agent Cashier Receipts, When to generate IRS Offset Letters, etc.
"KRN",19,5004,10,0)
^19.01IP^14^14
"KRN",19,5004,10,3,0)
5009^^99
"KRN",19,5004,10,3,"^")
PRCA NOTIFICATION PARAMETERS
"KRN",19,5004,10,4,0)
1502^^40
"KRN",19,5004,10,4,"^")
PRCA BIL AGENCY
"KRN",19,5004,10,5,0)
1422^^45
"KRN",19,5004,10,5,"^")
PRCAF U ADMIN.RATE
"KRN",19,5004,10,6,0)
6306^^10
"KRN",19,5004,10,6,"^")
PRCA DEACTIVATE GROUP
"KRN",19,5004,10,7,0)
7363^^90
"KRN",19,5004,10,7,"^")
PRCA RC PARAMETERS
"KRN",19,5004,10,8,0)
11350^^20
"KRN",19,5004,10,8,"^")
RCDPE EDI LOCKBOX PARAMETERS
"KRN",19,5004,10,9,0)
12139^^5
"KRN",19,5004,10,9,"^")
PRCA CBO PARAMETERS
"KRN",19,5004,10,10,0)
14020^^30
"KRN",19,5004,10,10,"^")
RCDPE SITE PARAMETER REPORT
"KRN",19,5004,10,11,0)
14021^^25
"KRN",19,5004,10,11,"^")
RCDPE PARAMETER AUDIT REPORT
"KRN",19,5004,10,12,0)
14022^^15
"KRN",19,5004,10,12,"^")
RCDPE EXCLUSION AUDIT REPORT
"KRN",19,5004,10,14,0)
14410
"KRN",19,5004,10,14,"^")
PRCA STOP SITE
"KRN",19,5004,99)
65234,52483
"KRN",19,5004,"U")
SITE PARAMETER EDIT
"KRN",19,5009,-1)
4^16
"KRN",19,5009,0)
PRCA NOTIFICATION PARAMETERS
"KRN",19,6306,-1)
4^19
"KRN",19,6306,0)
PRCA DEACTIVATE GROUP
"KRN",19,7187,-1)
4^30
"KRN",19,7187,0)
PRCA RCDMC 90 DAY REPORT
"KRN",19,7188,-1)
4^33
"KRN",19,7188,0)
PRCA RCDMC CANCEL
"KRN",19,7189,-1)
4^32
"KRN",19,7189,0)
PRCA RCDMC LESSER WITHHOLDING
"KRN",19,7190,-1)
0^29
"KRN",19,7190,0)
PRCA RCDMC REFERRAL MENU^DMC Referral Menu^^M^^^^^^^^ACCOUNTS RECEIVABLE
"KRN",19,7190,1,0)
^19.06^2^2^3190905^^^^
"KRN",19,7190,1,1,0)
This menu will be placed on the Supervisor's AR Menu.  It is composed of
"KRN",19,7190,1,2,0)
various options dealing with Debt Management Center (DMC) referral.
"KRN",19,7190,10,0)
^19.01IP^16^15
"KRN",19,7190,10,1,0)
7187^1^1
"KRN",19,7190,10,1,"^")
PRCA RCDMC 90 DAY REPORT
"KRN",19,7190,10,2,0)
7366^2^2
"KRN",19,7190,10,2,"^")
PRCA RCDMC REFERRED RPT
"KRN",19,7190,10,3,0)
7189^3^3
"KRN",19,7190,10,3,"^")
PRCA RCDMC LESSER WITHHOLDING
"KRN",19,7190,10,4,0)
7188^4^4
"KRN",19,7190,10,4,"^")
PRCA RCDMC CANCEL
"KRN",19,7190,10,5,0)
13065^5^5
"KRN",19,7190,10,5,"^")
RCDMCR1 DEBT VALIDITY REPORT
"KRN",19,7190,10,6,0)
13067^6^6
"KRN",19,7190,10,6,"^")
RCDMCR2 DEBT VALIDITY MGMT RPT
"KRN",19,7190,10,7,0)
13069^7^7
"KRN",19,7190,10,7,"^")
RCDMCR3 RD ELIG CHANGE REPORT
"KRN",19,7190,10,8,0)
13064^8^8
"KRN",19,7190,10,8,"^")
RCDMCEDT ENTER/EDIT DMC DEBT 
"KRN",19,7190,10,9,0)
13063^9^9
"KRN",19,7190,10,9,"^")
RCDMC EDIT RD # OF DAYS PARAME
"KRN",19,7190,10,10,0)
13169^10^10
"KRN",19,7190,10,10,"^")
RCDMC EDIT DMC REPORT # OF DAY
"KRN",19,7190,10,11,0)
14386^11^11
"KRN",19,7190,10,11,"^")
RCDMCR4 0-40 PERC SC CHNG RPT
"KRN",19,7190,10,13,0)
14402^14^14
"KRN",19,7190,10,13,"^")
RCDMCR6 50-100SC EXMPT RPT
"KRN",19,7190,10,14,0)
14403^13^13
"KRN",19,7190,10,14,"^")
RCDMCR7 10-40% COPAY RPT
"KRN",19,7190,10,15,0)
14415^15^15
"KRN",19,7190,10,15,"^")
PRCA CD EXEMPT COPAY CHRG RPT
"KRN",19,7190,10,16,0)
14387^12^12
"KRN",19,7190,10,16,"^")
RCDMCR5 1ST PARTY IB CANC RPT
"KRN",19,7190,99)
65290,39178
"KRN",19,7190,"U")
DMC REFERRAL MENU
"KRN",19,7363,-1)
4^20
"KRN",19,7363,0)
PRCA RC PARAMETERS
"KRN",19,7366,-1)
4^31
"KRN",19,7366,0)
PRCA RCDMC REFERRED RPT
"KRN",19,11350,-1)
4^21
"KRN",19,11350,0)
RCDPE EDI LOCKBOX PARAMETERS
"KRN",19,12139,-1)
4^22
"KRN",19,12139,0)
PRCA CBO PARAMETERS
"KRN",19,13063,-1)
4^38
"KRN",19,13063,0)
RCDMC EDIT RD # OF DAYS PARAME
"KRN",19,13064,-1)
4^37
"KRN",19,13064,0)
RCDMCEDT ENTER/EDIT DMC DEBT 
"KRN",19,13065,-1)
4^34
"KRN",19,13065,0)
RCDMCR1 DEBT VALIDITY REPORT
"KRN",19,13067,-1)
4^35
"KRN",19,13067,0)
RCDMCR2 DEBT VALIDITY MGMT RPT
"KRN",19,13069,-1)
4^36
"KRN",19,13069,0)
RCDMCR3 RD ELIG CHANGE REPORT
"KRN",19,13169,-1)
4^39
"KRN",19,13169,0)
RCDMC EDIT DMC REPORT # OF DAY
"KRN",19,14020,-1)
4^23
"KRN",19,14020,0)
RCDPE SITE PARAMETER REPORT
"KRN",19,14021,-1)
4^24
"KRN",19,14021,0)
RCDPE PARAMETER AUDIT REPORT
"KRN",19,14022,-1)
4^25
"KRN",19,14022,0)
RCDPE EXCLUSION AUDIT REPORT
"KRN",19,14125,-1)
0^3
"KRN",19,14125,0)
RCTCSP STOP^Stop/Reactivate TCSP Referral ^^R^^^^^^^^
"KRN",19,14125,1,0)
^^2^2^3190325^
"KRN",19,14125,1,1,0)
This option allows the user to stop or reactivate Cross-Servicing
"KRN",19,14125,1,2,0)
referral(s) for either a Bill or for a Debtor.
"KRN",19,14125,25)
EN^RCTCS1
"KRN",19,14125,"U")
STOP/REACTIVATE TCSP REFERRAL 
"KRN",19,14126,-1)
4^4
"KRN",19,14126,0)
RCTCSP RECALLB
"KRN",19,14127,-1)
4^5
"KRN",19,14127,0)
RCTCSP RECALLD
"KRN",19,14128,-1)
0^1
"KRN",19,14128,0)
RCTCSP MENU^Cross-Servicing Menu^^M^^^^^^^^
"KRN",19,14128,1,0)
^19.06^2^2^3150113^^^^
"KRN",19,14128,1,1,0)
This menu is placed on the AR Supervisor's Menu.  It contains
"KRN",19,14128,1,2,0)
 options for Cross-Servicing.
"KRN",19,14128,10,0)
^19.01IP^47^45
"KRN",19,14128,10,1,0)
14125
"KRN",19,14128,10,1,"^")
RCTCSP STOP
"KRN",19,14128,10,2,0)
14126
"KRN",19,14128,10,2,"^")
RCTCSP RECALLB
"KRN",19,14128,10,3,0)
14127
"KRN",19,14128,10,3,"^")
RCTCSP RECALLD
"KRN",19,14128,10,4,0)
14129
"KRN",19,14128,10,4,"^")
RCTCSP BILL REPORT
"KRN",19,14128,10,5,0)
14130
"KRN",19,14128,10,5,"^")
RCTCSP REPORT
"KRN",19,14128,10,6,0)
14131
"KRN",19,14128,10,6,"^")
RCTCSP RECALL REPORT
"KRN",19,14128,10,9,0)
14134^
"KRN",19,14128,10,9,"^")
RCTCSP REJECT REPORT
"KRN",19,14128,10,10,0)
14135^
"KRN",19,14128,10,10,"^")
RCTCSP IAI ERROR CODES LIST
"KRN",19,14128,10,11,0)
14330
"KRN",19,14128,10,11,"^")
RCTCSP STOP REACTIVATE REPORT
"KRN",19,14128,10,20,0)
14333
"KRN",19,14128,10,20,"^")
RCTCSP IAI REPORT
"KRN",19,14128,10,21,0)
14188
"KRN",19,14128,10,21,"^")
RCDP TCSP FLAG CONTROL
"KRN",19,14128,10,44,0)
14332
"KRN",19,14128,10,44,"^")
RCTCSP RECONCILIATION WORKLIST
"KRN",19,14128,10,45,0)
14133
"KRN",19,14128,10,45,"^")
RCTCSP RECONCIL REPORT
"KRN",19,14128,10,46,0)
14409
"KRN",19,14128,10,46,"^")
RCTCSP REREFER BILL REPORT
"KRN",19,14128,10,47,0)
14413
"KRN",19,14128,10,47,"^")
RCTCSP REREFER BILL
"KRN",19,14128,99)
65115,54524
"KRN",19,14128,99.1)
65338,3609
"KRN",19,14128,"U")
CROSS-SERVICING MENU
"KRN",19,14129,-1)
4^6
"KRN",19,14129,0)
RCTCSP BILL REPORT
"KRN",19,14130,-1)
4^7
"KRN",19,14130,0)
RCTCSP REPORT
"KRN",19,14131,-1)
4^8
"KRN",19,14131,0)
RCTCSP RECALL REPORT
"KRN",19,14133,-1)
4^15
"KRN",19,14133,0)
RCTCSP RECONCIL REPORT
"KRN",19,14134,-1)
4^9
"KRN",19,14134,0)
RCTCSP REJECT REPORT
"KRN",19,14135,-1)
4^10
"KRN",19,14135,0)
RCTCSP IAI ERROR CODES LIST
"KRN",19,14188,-1)
4^13
"KRN",19,14188,0)
RCDP TCSP FLAG CONTROL
"KRN",19,14330,-1)
0^11
"KRN",19,14330,0)
RCTCSP STOP REACTIVATE REPORT^Cross-Servicing Stop Reactivate Report^^R^^^^^^^^
"KRN",19,14330,1,0)
^^7^7^3190503^
"KRN",19,14330,1,1,0)
The Cross-Servicing Stop Reactivate Report lets the User run the report
"KRN",19,14330,1,2,0)
either for Bills or for Debtors.  If Bill Level is selected, the report
"KRN",19,14330,1,3,0)
lists the bills that have been stopped from Cross-Servicing, or 
"KRN",19,14330,1,4,0)
Reactivated, or Both.  If Debtor Level is selected, the report lists the 
"KRN",19,14330,1,5,0)
debtors that have been stopped from Cross-Servicing, or Reactivated, or 
"KRN",19,14330,1,6,0)
Both. The user may select a range of Debtors or all Debtors, and a range 
"KRN",19,14330,1,7,0)
of dates or all dates. Excel CSV output is also supported.
"KRN",19,14330,25)
EN^RCTCSP4
"KRN",19,14330,"U")
CROSS-SERVICING STOP REACTIVAT
"KRN",19,14332,-1)
4^14
"KRN",19,14332,0)
RCTCSP RECONCILIATION WORKLIST
"KRN",19,14333,-1)
4^12
"KRN",19,14333,0)
RCTCSP IAI REPORT
"KRN",19,14386,-1)
4^40
"KRN",19,14386,0)
RCDMCR4 0-40 PERC SC CHNG RPT
"KRN",19,14387,-1)
4^41
"KRN",19,14387,0)
RCDMCR5 1ST PARTY IB CANC RPT
"KRN",19,14402,-1)
4^43
"KRN",19,14402,0)
RCDMCR6 50-100SC EXMPT RPT
"KRN",19,14403,-1)
4^42
"KRN",19,14403,0)
RCDMCR7 10-40% COPAY RPT
"KRN",19,14409,-1)
0^28
"KRN",19,14409,0)
RCTCSP REREFER BILL REPORT^Cross-Servicing Re-Referred Bills Report^^R^^^^^^^^
"KRN",19,14409,25)
MAIN^RCTCSP6
"KRN",19,14409,"U")
CROSS-SERVICING RE-REFERRED BI
"KRN",19,14410,-1)
0^26
"KRN",19,14410,0)
PRCA STOP SITE^Stop/Reactivate New Referrals to TCSP^^R^^PRCA CS STOP SITE^^^^^^
"KRN",19,14410,1,0)
^19.06^2^2^3190523^^^
"KRN",19,14410,1,1,0)
Set a flag that stops sending new TCSP referrals during emergencies or 
"KRN",19,14410,1,2,0)
clear that flag if previously set
"KRN",19,14410,25)
TCSP^RCMSITE
"KRN",19,14410,"U")
STOP/REACTIVATE NEW REFERRALS 
"KRN",19,14413,-1)
0^27
"KRN",19,14413,0)
RCTCSP REREFER BILL^Refer Returned CS Bill^^R^^^^^^^^
"KRN",19,14413,1,0)
^19.06^1^1^3190330^^
"KRN",19,14413,1,1,0)
This option allows user to request a rerefer
"KRN",19,14413,25)
RRSET^RCTCSPU
"KRN",19,14413,"U")
REFER RETURNED CS BILL
"KRN",19,14415,-1)
0^44
"KRN",19,14415,0)
PRCA CD EXEMPT COPAY CHRG RPT^Catastrophically Disabled Exempt Copay Charge Rpt^^R^^^^^^^^
"KRN",19,14415,1,0)
^^3^3^3190429^
"KRN",19,14415,1,1,0)
Catastrophically Disabled Exempt Copayment Charge Report.   This version 
"KRN",19,14415,1,2,0)
displays different data than the other CD report and has different checks 
"KRN",19,14415,1,3,0)
for IB matching
"KRN",19,14415,25)
PRCACDRP
"KRN",19,14415,"U")
CATASTROPHICALLY DISABLED EXEM
"KRN",19.1,734,-1)
0^1
"KRN",19.1,734,0)
PRCA CS STOP SITE^PRCA Site Stop TCSP referrals
"KRN",19.1,734,1,0)
^19.11^1^1^3190321^^
"KRN",19.1,734,1,1,0)
Key to give users access to stop or reactivate site level 
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
350^3191121
"PKG",142,22,1,"PAH",1,1,0)
^^3^3^3190314
"PKG",142,22,1,"PAH",1,1,1,0)
AR Cross Servicing Patch.   Contains two new reports, 2 new options to 
"PKG",142,22,1,"PAH",1,1,2,0)
run them and 4 new routines.   Also will contain more things as B2 goes 
"PKG",142,22,1,"PAH",1,1,3,0)
underway
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
21
"RTN","PRCA350P")
0^^B1908146^n/a
"RTN","PRCA350P",1,0)
PRCA350P ;ALB/YG - POST INSTALL ;04/15/19 3:34 PM
"RTN","PRCA350P",2,0)
 ;;4.5;Accounts Receivable;**350**;Mar 20, 1995;Build 66
"RTN","PRCA350P",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCA350P",4,0)
POSTINIT ;
"RTN","PRCA350P",5,0)
 ;
"RTN","PRCA350P",6,0)
 D BMES^XPDUTL(" >>  Starting the Post-Initialization routine ...")
"RTN","PRCA350P",7,0)
 D MES^XPDUTL(" ")
"RTN","PRCA350P",8,0)
 I '$D(^PRCA(430.3,"B","CS RE-REFER BILL REQUEST")) D
"RTN","PRCA350P",9,0)
 . S DIC="^PRCA(430.3,",DIC(0)="",DLAYGO=430.3 K D0
"RTN","PRCA350P",10,0)
 . S X="CS RE-REFER BILL REQUEST"
"RTN","PRCA350P",11,0)
 . S DIC("DR")="1///RR;2///63;5///0"
"RTN","PRCA350P",12,0)
 . D FILE^DICN
"RTN","PRCA350P",13,0)
 I '$D(^PRCA(430.3,"B","CS DEBTOR RE-REFER BILL")) D
"RTN","PRCA350P",14,0)
 . S DIC="^PRCA(430.3,",DIC(0)="",DLAYGO=430.3 K D0
"RTN","PRCA350P",15,0)
 . S X="CS DEBTOR RE-REFER BILL"
"RTN","PRCA350P",16,0)
 . S DIC("DR")="1///RS;2///64;5///0"
"RTN","PRCA350P",17,0)
 . D FILE^DICN
"RTN","PRCA350P",18,0)
 I '$D(^PRCA(430.3,"B","CS RE-REFER BILL CANCEL")) D
"RTN","PRCA350P",19,0)
 . S DIC="^PRCA(430.3,",DIC(0)="",DLAYGO=430.3 K D0
"RTN","PRCA350P",20,0)
 . S X="CS RE-REFER BILL CANCEL"
"RTN","PRCA350P",21,0)
 . S DIC("DR")="1///RC;2///65;5///0"
"RTN","PRCA350P",22,0)
 . D FILE^DICN
"RTN","PRCA350P",23,0)
 D MES^XPDUTL(" >>  End of the Post-Initialization routine ...")
"RTN","PRCA350P",24,0)
 Q
"RTN","PRCAAPR1")
0^20^B50745979^B49707336
"RTN","PRCAAPR1",1,0)
PRCAAPR1 ;WASH-ISC@ALTOONA,PA/RGY - PATIENT ACCOUNT PROFILE ;2/12/97  11:48 AM
"RTN","PRCAAPR1",2,0)
 ;;4.5;Accounts Receivable;**34,45,108,143,141,206,192,218,276,275,284,303,301,315,350**;Mar 20, 1995;Build 66
"RTN","PRCAAPR1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAAPR1",4,0)
 ;
"RTN","PRCAAPR1",5,0)
HDR ;Head for Account profile
"RTN","PRCAAPR1",6,0)
 S X="",$P(X,"=",23)="" W @IOF,!,X,"   A c c o u n t   P r o f i l e   ",X
"RTN","PRCAAPR1",7,0)
HDR1 N DMC,IBRX,RSN,TOP4,TOP6,DPTFLG,ACCTNUM,RCCV
"RTN","PRCAAPR1",8,0)
 S IBRX=0,DPTFLG=0
"RTN","PRCAAPR1",9,0)
 ;
"RTN","PRCAAPR1",10,0)
 ; PRCAAPR cleans up BILL, COUNT, DEBT, DTOUT, DIC, OUT, PRCADB, SEL, X
"RTN","PRCAAPR1",11,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",12,0)
 I PRCADB["DPT(" S DPTFLG=1,ACCTNUM=$$ACCT(PRCADB)
"RTN","PRCAAPR1",13,0)
 ;
"RTN","PRCAAPR1",14,0)
 W !,$P(DEBT,"^",2) I DPTFLG!(PRCADB["VA(200,") S X=$S(PRCADB["DPT(":$P(^DPT(+PRCADB,0),"^",9),1:$P($G(^VA(200,+PRCADB,1)),"^",9)) W " (",$E(X,1,3),"-",$E(X,4,5),"-",$E(X,6,9),")"
"RTN","PRCAAPR1",15,0)
 W ?53,"Statement Day: ",$S($$PST^RCAMFN01(+DEBT)>0:$$PST^RCAMFN01(+DEBT),1:"N/A")
"RTN","PRCAAPR1",16,0)
 K Y S X("ADD")=$$DADD^RCAMADD(PRCADB)
"RTN","PRCAAPR1",17,0)
 ;
"RTN","PRCAAPR1",18,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",19,0)
 I DPTFLG W !,"Statement Account #: ",ACCTNUM,?52,"Last Statement: "
"RTN","PRCAAPR1",20,0)
 E  W !?52,"Last Statement: "
"RTN","PRCAAPR1",21,0)
 ;
"RTN","PRCAAPR1",22,0)
 S Y=+$$LST^RCFN01(PRCADB,2)
"RTN","PRCAAPR1",23,0)
 I Y>0 S Y("CCPC")=$$FPS^RCCPCFN(+DEBT) S:Y("CCPC") Y=+$P(Y("CCPC"),"^")
"RTN","PRCAAPR1",24,0)
 W $S(Y=-1:"N/A",1:$$SLH^RCFN01(Y))
"RTN","PRCAAPR1",25,0)
 W !,$P(X("ADD"),"^")
"RTN","PRCAAPR1",26,0)
 W:+$G(Y("CCPC")) ?52,"Activity as of: ",$$SLH^RCFN01($$ASOF^RCCPCFN($P(Y("CCPC"),"^",2)))
"RTN","PRCAAPR1",27,0)
 W:$P(X("ADD"),"^",2)]"" !,$P(X("ADD"),"^",2) W:$P(X("ADD"),"^",3)]"" !,$P(X("ADD"),"^",3)
"RTN","PRCAAPR1",28,0)
 W ! W:$P(X("ADD"),"^",4)]"" $P(X("ADD"),"^",4),", ",$P(X("ADD"),"^",5),"  ",$S($P(X("ADD"),"^",6):$P(X("ADD"),"^",6),1:$P(X("ADD"),"^",8))
"RTN","PRCAAPR1",29,0)
 W ?55,"Amount Owed: ",?69,$J(+$G(^TMP("PRCAAPR",$J,"C")),9,2)
"RTN","PRCAAPR1",30,0)
 W !,"Phone #: ",$S($P(X("ADD"),"^",7)]"":$P(X("ADD"),"^",7),1:"N/A")
"RTN","PRCAAPR1",31,0)
 I PRCADB["DPT(" W ?51,"RX Copay Exempt: " S IBRX=$$RXST^IBARXEU(+PRCADB,DT) W $S($P(IBRX,U)=1:"YES",$P(IBRX,U)=0:"NO",1:"N/A")
"RTN","PRCAAPR1",32,0)
 I PRCADB["DPT(" W !?57,"CV Status: " S RCCV=$$CVEDT^DGCV(+PRCADB,DT) W $S($P(RCCV,U,3)>0:"YES",1:"NO") I $P(RCCV,U,2) W !?52,"CV Status Ends: ",$$SLH^RCFN01($P(RCCV,U,2))
"RTN","PRCAAPR1",33,0)
 ; *108 add exemption reason/dmc info
"RTN","PRCAAPR1",34,0)
 I IBRX>0,($P(IBRX,U)=1) S DIC="^IBE(354.2,",DIC(0)="M",X=+$P(IBRX,"^",3) D ^DIC I Y>0 W !,?54,"(",$P(Y,"^",2),")"
"RTN","PRCAAPR1",35,0)
 I $D(^RCD(340,"DMC",1,+DEBT)) S DMC=$G(^RCD(340,+DEBT,3)) D
"RTN","PRCAAPR1",36,0)
 .I $P(DMC,"^",2) W !,"** Account forwarded to DMC: ",$$SLH^RCFN01($P(DMC,"^",2)),?50,"Total DMC Amount: ",?69,$J($P(DMC,"^",5),9,2)
"RTN","PRCAAPR1",37,0)
 .I $P(DMC,"^",9)'="" W !,?49,"Lesser Amt to DMC: ",?69,$J($P(DMC,"^",9),9,2)
"RTN","PRCAAPR1",38,0)
 .Q
"RTN","PRCAAPR1",39,0)
 I $D(^RCD(340,"TOP",+DEBT)) S TOP4=$G(^RCD(340,+DEBT,4)),TOP6=$G(^(6)) D
"RTN","PRCAAPR1",40,0)
 .I +TOP6 W !,"** Account forwarded to TOP: ",$$SLH^RCFN01($P(TOP6,"^")),?45,"Total TOP Amount: ",?65,$J($P(TOP4,"^",3),13,2)
"RTN","PRCAAPR1",41,0)
 .I $P(TOP6,"^",6) W !,?45,"TOP HOLD DATE: ",$$SLH^RCFN01($P(TOP6,"^",6))
"RTN","PRCAAPR1",42,0)
 .Q
"RTN","PRCAAPR1",43,0)
 ; "Put Re-" if rerefer
"RTN","PRCAAPR1",44,0)
 I $D(^RCD(340,"TCSP",+DEBT)) D
"RTN","PRCAAPR1",45,0)
 .;PRCA*4.5*350
"RTN","PRCAAPR1",46,0)
 .W !,"x Debt "_$S($$RRD^RCTCSPU(+DEBT):"Re-",1:"")_"Referred to Cross-Servicing",?45,"Total CS Debt: ",?65,$J($$TOTALB^RCTCSPU(+DEBT),13,2)
"RTN","PRCAAPR1",47,0)
 .Q
"RTN","PRCAAPR1",48,0)
 I $O(^RCD(340,+DEBT,2,0)) D
"RTN","PRCAAPR1",49,0)
 .S Y=0 F X=0:0 S X=$O(^RCD(340,+DEBT,2,X)) Q:'X  W:'Y ! W !,$G(^(X,0)) S Y=Y+1 W:Y=3&$O(^RCD(340,+DEBT,2,X)) "..." Q:Y=3
"RTN","PRCAAPR1",50,0)
 .Q
"RTN","PRCAAPR1",51,0)
 Q
"RTN","PRCAAPR1",52,0)
 ; PRCA*4.5*276 - moved headers right to add EOB indicator to bill #, adjusted at tag BLN accordingly
"RTN","PRCAAPR1",53,0)
 ; PRCA*4.5*275 - moved headers to line up with column changes
"RTN","PRCAAPR1",54,0)
HDR2 W !!,"#",?7,"Bill #",?20,"Est",?31,"Type",?43,"Paid",?52,"Prin",?58,"Int",?64,"Adm",?72,"Balance"
"RTN","PRCAAPR1",55,0)
 Q
"RTN","PRCAAPR1",56,0)
DIS ;Display bill line items
"RTN","PRCAAPR1",57,0)
 NEW STAT1
"RTN","PRCAAPR1",58,0)
 I '$O(^TMP("PRCAAPR",$J,"C",0)) S X="",$P(X,"*",22)="" W !!,X,"  NO ACCOUNT INFORMATION AVAILABLE  ",X G Q1
"RTN","PRCAAPR1",59,0)
 F STAT1=0:0 S STAT1=$O(^TMP("PRCAAPR",$J,"C",STAT1)) Q:'STAT1!$D(OUT)  D BHDR S BILL=0 F  S BILL=$O(^TMP("PRCAAPR",$J,"C",STAT1,BILL)) Q:BILL=""!$D(OUT)  D BLN
"RTN","PRCAAPR1",60,0)
 I '$D(OUT) D READ
"RTN","PRCAAPR1",61,0)
Q1 Q
"RTN","PRCAAPR1",62,0)
BHDR ;Display status line
"RTN","PRCAAPR1",63,0)
 S X=$S(+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2)=99:"PAYMENTS",1:$P($G(^PRCA(430.3,+$O(^PRCA(430.3,"AC",+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2),0)),0)),"^"))
"RTN","PRCAAPR1",64,0)
 S Y=" "_X_" ("_$J(+^TMP("PRCAAPR",$J,"C",STAT1),0,2)_") " W ! F X=1:1:80-$L(Y)/2 W "-"
"RTN","PRCAAPR1",65,0)
 W Y F X=1:1:IOM-$X-1 W "-"
"RTN","PRCAAPR1",66,0)
 Q
"RTN","PRCAAPR1",67,0)
BLN ;
"RTN","PRCAAPR1",68,0)
 N PRCOUT,REJFLAG,CSCSTAT,DEBTOR,CSDATE1,CSDATE2,RCIND
"RTN","PRCAAPR1",69,0)
 I $Y+5>IOSL,COUNT D READ G:$D(OUT) Q2 D HDR,HDR2,BHDR
"RTN","PRCAAPR1",70,0)
 ; PRCA*4.5*276, attach EOB indicator '%' to bill # when applicable
"RTN","PRCAAPR1",71,0)
 S PRCOUT=$$COMP3^PRCAAPR(BILL)
"RTN","PRCAAPR1",72,0)
 I STAT1'=99,PRCOUT'="%" S PRCOUT=$$IBEEOBCK(BILL)
"RTN","PRCAAPR1",73,0)
 ; PRCA*4.5*303 - add reject indicator to kbill if applicable ; #IA 6060
"RTN","PRCAAPR1",74,0)
 S REJFLAG=0 S:STAT1'=99 REJFLAG=$$BILLREJ^IBJTU6($P($P($G(^PRCA(430,BILL,0)),"^"),"-",2))
"RTN","PRCAAPR1",75,0)
 S:STAT1'=99 COUNT=COUNT+1,^TMP("PRCAAPR",$J,"O",COUNT)=BILL S X=$S(STAT1=99:BILL,1:$G(PRCOUT)_$S(REJFLAG:"c",1:"")_$G(^PRCA(430,BILL,0)))
"RTN","PRCAAPR1",76,0)
 ; PRCA*4.5*303 - End
"RTN","PRCAAPR1",77,0)
 ;
"RTN","PRCAAPR1",78,0)
 ; PRCA*4.5*315: AR File #430 - set historical indicator set to "y" if an entry exists in the 
"RTN","PRCAAPR1",79,0)
 ;     ORIGINAL DATE REFERRED TO TCSP (field #156) to CS bill number.  If an entry in the 
"RTN","PRCAAPR1",80,0)
 ;     DATE REFERRED TO TCSP (field #151), then an "x" indicator displays on the bill,          
"RTN","PRCAAPR1",81,0)
 ;     otherwise neither indicator.
"RTN","PRCAAPR1",82,0)
 ;
"RTN","PRCAAPR1",83,0)
 S CSDATE1=$$GET1^DIQ(430,BILL,"DATE BILL REFERRED TO TCSP","I")
"RTN","PRCAAPR1",84,0)
 S CSDATE2=$$GET1^DIQ(430,BILL,"ORIGINAL DATE REFERRED TO TCSP","I")
"RTN","PRCAAPR1",85,0)
 S RCIND=$S(CSDATE1'="":"x",CSDATE2'="":"y",1:"")
"RTN","PRCAAPR1",86,0)
 ;W !,$S(STAT1'=99:COUNT,1:"*"),?4,$P(X,"^") W:STAT1'=99 ?20,$$SLH^RCFN01($P(X,"^",10))
"RTN","PRCAAPR1",87,0)
 I RCIND]"" W !,$S(STAT1'=99:COUNT,1:"*"),?5,$P(RCIND_X,"^") W:STAT1'=99 ?20,$$SLH^RCFN01($P(X,"^",10))
"RTN","PRCAAPR1",88,0)
 I RCIND="" W !,$S(STAT1'=99:COUNT,1:"*"),?6,$P(X,"^") W:STAT1'=99 ?20,$$SLH^RCFN01($P(X,"^",10))
"RTN","PRCAAPR1",89,0)
 W:STAT1'=99 ?31,$S($P(X,"^",2)=31:"TRIC PT",1:$E($P($G(^PRCA(430.2,$S($O(^PRCA(430.2,"AC",24,0))=$P(X,"^",2):+$P(X,"^",16),1:+$P(X,"^",2)),0)),"^"),1,7))  ; PRCA*4.5*192 changed CHMP PT to TRIC PT
"RTN","PRCAAPR1",90,0)
 W:STAT1=99 ?31,"PAYMENT"
"RTN","PRCAAPR1",91,0)
 S X=$S(STAT1=99:"^^^^^^"_^TMP("PRCAAPR",$J,"C",STAT1,BILL),1:$G(^PRCA(430,BILL,7))) W ?39 W:STAT1=99 "-" W $J($P(X,"^",7)+$P(X,"^",8)+$P(X,"^",9)+$P(X,"^",10)+$P(X,"^",11),8,2)
"RTN","PRCAAPR1",92,0)
 W ?48 W:STAT1=99 " " W:STAT1'=99 $S($P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",93,0)
 W $J($P(X,"^"),7,2),?57,$J($P(X,"^",2),5,2),?63,$J($P(X,"^",3),5,2),?69,$S(STAT1=99:"-",$P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",94,0)
 W $S(STAT1=99:$J(^TMP("PRCAAPR",$J,"C",STAT1,BILL),9,2),1:$J($P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5),9,2))
"RTN","PRCAAPR1",95,0)
 K ^TMP("PRCAAPR",$J,"C",STAT1,BILL) K:$O(^TMP("PRCAAPR",$J,"C",STAT1,""))="" ^TMP("PRCAAPR",$J,"C",STAT1)
"RTN","PRCAAPR1",96,0)
Q2 Q
"RTN","PRCAAPR1",97,0)
READ ;Read bill number
"RTN","PRCAAPR1",98,0)
 W !!,"Select 1-",COUNT W:$O(^TMP("PRCAAPR",$J,"C","")) " or return to continue" R ": ",X:DTIME I X["^"!'$T S:'$T DTOUT=1 S OUT=1 G Q3
"RTN","PRCAAPR1",99,0)
 I X["?" W !!,"To see detailed information for a bill number, enter the corresponding '#'",!,"next to the bill.  (Ex: 1 or 1,3)" G READ
"RTN","PRCAAPR1",100,0)
 I X="",'$O(^TMP("PRCAAPR",$J,"C","")) S OUT=1 G Q3
"RTN","PRCAAPR1",101,0)
 G:X="" Q3 S SEL=X
"RTN","PRCAAPR1",102,0)
 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) I Y'?1N.N!'$D(^TMP("PRCAAPR",$J,"O",+Y)) W *7," ??" G READ
"RTN","PRCAAPR1",103,0)
 S OUT=1 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) D EN1^PRCAATR($G(^TMP("PRCAAPR",$J,"O",+Y)))
"RTN","PRCAAPR1",104,0)
Q3 Q
"RTN","PRCAAPR1",105,0)
 ;
"RTN","PRCAAPR1",106,0)
ACCT(DFN) ;Get account number. Join station with DFN (Patch 206)
"RTN","PRCAAPR1",107,0)
 N SITE,ACCT,ACCT1,LEN
"RTN","PRCAAPR1",108,0)
 S DFN=+DFN
"RTN","PRCAAPR1",109,0)
 S LEN=$L(DFN)-1
"RTN","PRCAAPR1",110,0)
 S SITE=$$SITE^RCMSITE                          ;station number
"RTN","PRCAAPR1",111,0)
 S ACCT=$$RJ^XLFSTR(DFN,13,0)                   ;add leading zeroes
"RTN","PRCAAPR1",112,0)
 S ACCT1=SITE_"-"_$E(ACCT,1,$L(ACCT)-$L(DFN))   ;add hyphen
"RTN","PRCAAPR1",113,0)
 S ACCT1=ACCT1_"-"_$E(ACCT,$L(ACCT)-LEN,99)     ;add hyphen
"RTN","PRCAAPR1",114,0)
 S ACCT1=ACCT1_"-"_$E($P($P(DEBT,U,2),","),1,5) ;add last name
"RTN","PRCAAPR1",115,0)
 Q ACCT1
"RTN","PRCAAPR1",116,0)
 ;
"RTN","PRCAAPR1",117,0)
 ; PRCA*4.5*276 -  Use Event Date to find an associated 3rd Party bill with an associated EEOB
"RTN","PRCAAPR1",118,0)
IBEEOBCK(PRCAAR) ; Passed AR Bill
"RTN","PRCAAPR1",119,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",120,0)
 ;
"RTN","PRCAAPR1",121,0)
 ; Find 3rd Party Bills with an Event Date
"RTN","PRCAAPR1",122,0)
 N PRCAREF,PRCAEEOB,PRCADT,DFN,DBTR,X1
"RTN","PRCAAPR1",123,0)
 ; Get DFN
"RTN","PRCAAPR1",124,0)
 S DBTR=+$P($G(^PRCA(430,PRCAAR,0)),U,9)
"RTN","PRCAAPR1",125,0)
 S X1=$P($G(^RCD(340,DBTR,0)),U) I X1'["DPT" Q ""
"RTN","PRCAAPR1",126,0)
 S DFN=+X1
"RTN","PRCAAPR1",127,0)
 S PRCAEEOB=""
"RTN","PRCAAPR1",128,0)
 ; Loop through Xref of ARbill (#430) to Action file (#350)
"RTN","PRCAAPR1",129,0)
 I +$G(PRCAAR) S PRCAREF=0 F  S PRCAREF=$O(^IB("ABIL",$P($G(^PRCA(430,PRCAAR,0)),"^"),PRCAREF)) Q:'PRCAREF  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",130,0)
 . S PRCADT=$P($G(^IB(PRCAREF,0)),"^",17) ;Get event Date
"RTN","PRCAAPR1",131,0)
 . I PRCADT S PRCAEEOB=$$TPEVDT(DFN,PRCADT) Q:PRCAEEOB="%"
"RTN","PRCAAPR1",132,0)
 . I PRCADT S PRCAEEOB=$$TPOPV(DFN,PRCADT)
"RTN","PRCAAPR1",133,0)
 ;
"RTN","PRCAAPR1",134,0)
 Q PRCAEEOB
"RTN","PRCAAPR1",135,0)
 ;
"RTN","PRCAAPR1",136,0)
 ; PRCA*4.5*276 - Traverse all THIRD PARTY bills for a patient with a specific Event Date (399,.03)
"RTN","PRCAAPR1",137,0)
TPEVDT(DFN,EVDT) ;
"RTN","PRCAAPR1",138,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",139,0)
 ; PRCA*4.5*284 - Use the 399,"APDT" (by patient) index instead of the 399,"D" index for efficiency
"RTN","PRCAAPR1",140,0)
 I '$G(DFN)!'$G(EVDT) Q ""
"RTN","PRCAAPR1",141,0)
 N PRCAIFN,PRCAEEOB
"RTN","PRCAAPR1",142,0)
 S PRCAEEOB="",PRCAIFN=""
"RTN","PRCAAPR1",143,0)
 F  S PRCAIFN=$O(^DGCR(399,"APDT",DFN,PRCAIFN),-1) Q:'PRCAIFN  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",144,0)
 . I $D(^DGCR(399,"APDT",DFN,PRCAIFN,9999999-EVDT)) S PRCAEEOB=$$COMP3^PRCAAPR(PRCAIFN)
"RTN","PRCAAPR1",145,0)
 Q PRCAEEOB
"RTN","PRCAAPR1",146,0)
 ;
"RTN","PRCAAPR1",147,0)
 ; PRCA*4.5*276 - Traverse all THIRD PARTY bills for a patient with any Opt Visit Dates same as Event Date (399,43)
"RTN","PRCAAPR1",148,0)
TPOPV(DFN,EVDT) ;
"RTN","PRCAAPR1",149,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",150,0)
 N PRCAIFN,PRCAEEOB
"RTN","PRCAAPR1",151,0)
 S PRCAEEOB=""
"RTN","PRCAAPR1",152,0)
 I +$G(DFN),+$G(EVDT) S PRCAIFN=0 F  S PRCAIFN=$O(^DGCR(399,"AOPV",DFN,EVDT,PRCAIFN)) Q:'PRCAIFN  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",153,0)
 . ; attach EOB indicator '%' to bill # when applicable
"RTN","PRCAAPR1",154,0)
 . S PRCAEEOB=$$COMP3^PRCAAPR(PRCAIFN)
"RTN","PRCAAPR1",155,0)
 Q PRCAEEOB
"RTN","PRCAATR")
0^18^B30173934^B25331554
"RTN","PRCAATR",1,0)
PRCAATR ;WASH-ISC@ALTOONA,PA/RGY - VIEW TRANSACTION FOR BILLS ;2/14/96  2:46 PM
"RTN","PRCAATR",2,0)
V ;;4.5;Accounts Receivable;**36,104,172,138,233,276,303,301,315,350**;Mar 20, 1995;Build 66
"RTN","PRCAATR",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAATR",4,0)
 ;
"RTN","PRCAATR",5,0)
 ; PRCAAPR cleans up DEBT, DTOUT
"RTN","PRCAATR",6,0)
EN1(BILL) ;ENTRY POINT FROM PRCAAPR
"RTN","PRCAATR",7,0)
 NEW X,Y,COUNT,OUT,TRAN,SEL,PRCAATRX,PRCAIO,PRCAIOS,D0,PRCAQUE,POP,PRCAPRT,Y,ZTSK,PRCOUT,PRCA15,REJFLG
"RTN","PRCAATR",8,0)
 NEW CSDATE1,CSDATE2,CSFLG
"RTN","PRCAATR",9,0)
 I '$D(BILL) G Q
"RTN","PRCAATR",10,0)
 I BILL'?1N.N!'$D(^PRCA(430,+BILL,0)) G Q
"RTN","PRCAATR",11,0)
 ; PRCA*4.5*276
"RTN","PRCAATR",12,0)
 S PRCOUT=$$COMP3^PRCAAPR(BILL) ; check for 1st and 3rd party payments
"RTN","PRCAATR",13,0)
 I PRCOUT'="%" S PRCOUT=$$IBEEOBCK^PRCAAPR1(BILL)
"RTN","PRCAATR",14,0)
 S PRCAPRT=1,PRCAIO=IO(0),PRCAIO(0)=IO(0),COUNT=0 K ^TMP("PRCAATR",$J)
"RTN","PRCAATR",15,0)
 D HDR,DIS,^%ZISC
"RTN","PRCAATR",16,0)
Q K ^TMP("PRCAATR",$J),IO("Q") Q
"RTN","PRCAATR",17,0)
HDR ;Header
"RTN","PRCAATR",18,0)
 D HDR^PRCAAPR1
"RTN","PRCAATR",19,0)
 I $P($G(^PRCA(430,BILL,13)),"^") W !,"MEDICARE CONTRACTUAL ADJUSTMENT: ",$J($P($G(^PRCA(430,BILL,13)),"^"),0,2)
"RTN","PRCAATR",20,0)
 I $P($G(^PRCA(430,BILL,13)),"^",2) W !,"UNREIMBURSED MEDICARE EXPENSE: ",$J($P($G(^PRCA(430,BILL,13)),"^",2),0,2)
"RTN","PRCAATR",21,0)
 ; PRCA*4.5*303 - Adding reject indicator, 'x' to bill number when applicable
"RTN","PRCAATR",22,0)
 S REJFLG=$$BILLREJ^IBJTU6($P($P($G(^PRCA(430,BILL,0)),"^"),"-",2)) ; IA# 6060
"RTN","PRCAATR",23,0)
 ; PRCA*4.5*315
"RTN","PRCAATR",24,0)
 S CSDATE1=$$GET1^DIQ(430,BILL,"DATE BILL REFERRED TO TCSP","I")
"RTN","PRCAATR",25,0)
 S CSDATE2=$$GET1^DIQ(430,BILL,"ORIGINAL DATE REFERRED TO TCSP","I")
"RTN","PRCAATR",26,0)
 S CSFLG=$S(CSDATE1'="":"x",CSDATE2'="":"y",1:"")
"RTN","PRCAATR",27,0)
 ; PRCA*4.5*276 - attach EEOB indicator to bill number
"RTN","PRCAATR",28,0)
 ; PRCA*4.5*350 - Re-Referred
"RTN","PRCAATR",29,0)
 I +$G(^PRCA(430,BILL,15)) S PRCA15=^(15) I $P(PRCA15,U)]"" W !,"CS " W:$$RR^RCTCSPU(BILL) "Re-" W "Referred Date: " S Y=$P(PRCA15,U) D DD^%DT W Y  ;prca*4.5*301
"RTN","PRCAATR",30,0)
 S PRCA15=$G(^PRCA(430,BILL,15)) D
"RTN","PRCAATR",31,0)
 .I $P(PRCA15,U,2)]"" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,BILL,154),1,31) W ?51,"CS Recall Date: " S Y=$P(PRCA15,U,3) D DD^%DT W Y Q  ;prca*4.5*301
"RTN","PRCAATR",32,0)
 .I $P(PRCA15,U,4)]"",$P(PRCA15,U,2)="" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,BILL,154),1,31) W ?51,"CS Recall Date: "
"RTN","PRCAATR",33,0)
 ; PRCA*4.5*350 - remove this and put some data from it on next line
"RTN","PRCAATR",34,0)
 ; W ! D PROFRJ^RCTCSJS1(BILL) ; Reject history  ;prca*4.5*301
"RTN","PRCAATR",35,0)
 W !,"Bill #: ",$G(PRCOUT)_CSFLG_$P(^PRCA(430,BILL,0),"^") D @($S($P(^(0),"^",9)'=+DEBT:"DEB",1:"CSREJ")) ; prca*4.5*315, PRCA*4.5*350
"RTN","PRCAATR",36,0)
 I REJFLG W !,"Bill #: ",$G(PRCOUT)_$S(REJFLG:"c",1:"")_$P(^PRCA(430,BILL,0),"^") D @($S($P(^(0),"^",9)'=+DEBT:"DEB",1:"CSREJ")) ; PRCA*4.5*350
"RTN","PRCAATR",37,0)
 W !!,"Bill #",?8,"Tr #",?17,"Type",?52,"Date",?70,"Amount"
"RTN","PRCAATR",38,0)
 S X="",$P(X,"-",IOM)="" W !,X
"RTN","PRCAATR",39,0)
 Q
"RTN","PRCAATR",40,0)
DIS ;Display transactions
"RTN","PRCAATR",41,0)
 W !,?17,"Original Amount",?52,$$SLH^RCFN01($P(^PRCA(430,BILL,0),"^",10)),?65,$J($P(^(0),"^",3),11,2)
"RTN","PRCAATR",42,0)
 I '$O(^PRCA(433,"C",BILL,0)) D
"RTN","PRCAATR",43,0)
 . S X="",$P(X,"*",20)="" W !!,X,"  NO TRANSACTION INFORMATION AVAILABLE  ",X
"RTN","PRCAATR",44,0)
RD . R !!,"Press return to continue: ",X:DTIME S:'$T DTOUT=1 S OUT=1
"RTN","PRCAATR",45,0)
 . I X["?" W !!,"Press the return key to return to menu." G RD
"RTN","PRCAATR",46,0)
 . Q
"RTN","PRCAATR",47,0)
 F TRAN=0:0 S TRAN=$O(^PRCA(433,"C",BILL,TRAN)) Q:'TRAN!$D(OUT)  D TLN
"RTN","PRCAATR",48,0)
 S X=$G(^PRCA(430,BILL,7))
"RTN","PRCAATR",49,0)
 I '$D(OUT) W !?65,"-----------",!,?64,"$",$J($P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5),11,2) D READ
"RTN","PRCAATR",50,0)
 Q
"RTN","PRCAATR",51,0)
TLN ;Display a transaction
"RTN","PRCAATR",52,0)
 N YR
"RTN","PRCAATR",53,0)
 I $Y+5>IOSL,COUNT D READ G:$D(DTOUT)!$D(OUT) Q1 D HDR
"RTN","PRCAATR",54,0)
 S COUNT=COUNT+1,X=$G(^PRCA(433,TRAN,1)),^TMP("PRCAATR",$J,COUNT)=TRAN
"RTN","PRCAATR",55,0)
 W !,COUNT,$S($P(^PRCA(433,TRAN,0),"^",4)=1!$P(^(0),"^",10):"(I)",1:""),?8,TRAN,?17
"RTN","PRCAATR",56,0)
 W $S($P($G(^PRCA(430.3,+$P(X,"^",2),0)),"^",3)=17:$P($G(^PRCA(433,TRAN,5)),"^",2),1:$P($G(^(0)),"^"))
"RTN","PRCAATR",57,0)
 ;  show decrease adjustments as negative (patch 4.5*172)
"RTN","PRCAATR",58,0)
 I $P(X,"^",2)=35 S:$P(X,"^",5)>0 $P(X,"^",5)=-$P(X,"^",5)
"RTN","PRCAATR",59,0)
 W ?52,$S(+X:$$SLH^RCFN01(+X),1:""),?65,$J($P(X,"^",5),11,2)
"RTN","PRCAATR",60,0)
 ;
"RTN","PRCAATR",61,0)
Q1 Q
"RTN","PRCAATR",62,0)
READ ;Read a trans number
"RTN","PRCAATR",63,0)
 I IO'=IO(0) G Q2
"RTN","PRCAATR",64,0)
ASK W !!,"Select 1-",COUNT,$S(PRCAPRT:" or 'P' to Print",1:" to print") W:TRAN " or return to continue" R ": ",X:DTIME I X["^"!'$T S:'$T DTOUT=1 S OUT=1 G Q2
"RTN","PRCAATR",65,0)
 I PRCAPRT,X="P" S %ZIS="MQ" D ^%ZIS D  S PRCAPRT=0,PRCAIO=IO,PRCAIO(0)=IO(0) G:'POP ASK K POP S OUT=1 G Q2
"RTN","PRCAATR",66,0)
 . I $D(IO("S")) S PRCAIOS=ION D ^%ZISC
"RTN","PRCAATR",67,0)
 . Q
"RTN","PRCAATR",68,0)
 I X["?" W !!,"To see detailed information for a transaction number, enter the corresponding '#'",!,"next to the transaction.  (Ex: 1 or 1,3)" G ASK
"RTN","PRCAATR",69,0)
 I X="" S:TRAN="" OUT=1 G Q2
"RTN","PRCAATR",70,0)
 S SEL=X
"RTN","PRCAATR",71,0)
 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) I Y'?1N.N!'$D(^TMP("PRCAATR",$J,+Y)) W *7," ??" G READ
"RTN","PRCAATR",72,0)
 F PRCAATRX=1:1:$L(SEL,",") S Y=$P(SEL,",",PRCAATRX) D VT Q:$D(OUT)
"RTN","PRCAATR",73,0)
 S OUT=1
"RTN","PRCAATR",74,0)
Q2 Q
"RTN","PRCAATR",75,0)
VT ;View a transaction
"RTN","PRCAATR",76,0)
 N IOP,%ZIS,ZTRTN,ZTDESC,ZTSAVE,ZTDTH
"RTN","PRCAATR",77,0)
 S D0=$G(^TMP("PRCAATR",$J,+Y)) G:'D0 Q3
"RTN","PRCAATR",78,0)
 I $D(IO("Q")) S ZTSAVE("D0")="",ZTSAVE("PRCAIO")=IO,ZTSAVE("PRCAIO(0)")=IO(0),ZTRTN="DQ^PRCAATR",ZTDESC="AR TRANS PROFILE",ZTDTH=$H D ^%ZTLOAD W !,"*** Trans # ",D0," REQUEST QUEUED ***" G Q3
"RTN","PRCAATR",79,0)
 I IO'=IO(0) W !,"OK, Printing Transaction # ",D0," ..."
"RTN","PRCAATR",80,0)
 I $D(PRCAIOS) S IOP=PRCAIOS D ^%ZIS
"RTN","PRCAATR",81,0)
 U IO D DQ U IO(0)
"RTN","PRCAATR",82,0)
Q3 Q
"RTN","PRCAATR",83,0)
DQ ;
"RTN","PRCAATR",84,0)
 W @IOF S X="",$P(X,"=",30)="" W !,X," TRANSACTION PROFILE ",X,!!
"RTN","PRCAATR",85,0)
 K DXS D ^PRCATR3 K DXS S X=D0 D ENF^IBOLK
"RTN","PRCAATR",86,0)
RD1 I $E(IOST)="C" R !!,"PRESS <RETURN> TO CONTINUE: ",X:DTIME S:'$T DTOUT=1,OUT=1 I X["?" W !!,"Press return to view next transaction or to continue" G RD1
"RTN","PRCAATR",87,0)
 Q
"RTN","PRCAATR",88,0)
DEB ;View debtor
"RTN","PRCAATR",89,0)
 NEW PRCA
"RTN","PRCAATR",90,0)
 S PRCA=$P(^PRCA(430,BILL,0),"^",9) I PRCA S PRCA=$P(^RCD(340,PRCA,0),"^") W "   ",$P($G(@("^"_$P(PRCA,";",2)_+PRCA_",0)")),"^")
"RTN","PRCAATR",91,0)
 Q
"RTN","PRCAATR",92,0)
CSREJ ; Show last reject ; PRCA*4.5*350
"RTN","PRCAATR",93,0)
 N RJIEN,RJDT,RJCODE,RJZ,I
"RTN","PRCAATR",94,0)
 S RJIEN=0,RJDT="",RJCODE=""
"RTN","PRCAATR",95,0)
 F  S RJDT=$O(^PRCA(430,BILL,18,"B",RJDT)) Q:RJDT=""  Q:$O(^PRCA(430,BILL,18,"B",RJDT))=""
"RTN","PRCAATR",96,0)
 Q:'RJDT
"RTN","PRCAATR",97,0)
 F  S RJIEN=$O(^PRCA(430,BILL,18,"B",RJDT,RJIEN)) Q:RJIEN=""  Q:$O(^PRCA(430,BILL,18,"B",RJDT,RJIEN))=""
"RTN","PRCAATR",98,0)
 Q:'RJIEN
"RTN","PRCAATR",99,0)
 S RJZ=$G(^PRCA(430,BILL,18,RJIEN,0))
"RTN","PRCAATR",100,0)
 F I=3:1:11 I $P(RJZ,"^",I)'="" S RJCODE=$P(RJZ,"^",I)
"RTN","PRCAATR",101,0)
 Q:'RJCODE
"RTN","PRCAATR",102,0)
 W "  Last CS REJECT CODE: ",$P($G(^RC(348.5,RJCODE,0)),"^")
"RTN","PRCAATR",103,0)
 W "  Last CS REJECT DATE: ",$$FMTE^XLFDT(RJDT,"5Z")
"RTN","PRCAATR",104,0)
 Q
"RTN","PRCABJV")
0^30^B55801728^B54348019
"RTN","PRCABJV",1,0)
PRCABJV ;WASH-ISC@ALTOONA,PA/TJK-FILE VERIFICATION FOR BACKGROUND JOB ;4/6/95  10:13 AM
"RTN","PRCABJV",2,0)
V ;;4.5;Accounts Receivable;**1,48,63,114,141,170,176,173,192,220,296,310,315,338,350**;Mar 20, 1995;Build 66
"RTN","PRCABJV",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCABJV",4,0)
 ;;patch 192 changes all occurrences of CHAMPUS to TRICARE
"RTN","PRCABJV",5,0)
EN1(FILE,X1,X2,ERROR) ;
"RTN","PRCABJV",6,0)
 ;FILE IS THE FILE NUMBER
"RTN","PRCABJV",7,0)
 ;X1 AND X2 ARE 3 PART VARIABLES SEPARATED BY SEMI-COLONS WITH
"RTN","PRCABJV",8,0)
 ;THE FORMAT (X-REF INDEX;NODE;PIECE)
"RTN","PRCABJV",9,0)
 ;AN ERROR ARRAY IS SET IF VALIDATION FAILS
"RTN","PRCABJV",10,0)
 NEW LT,CNT,I,I1,I2,I3,REC,IND,ND,PC,DATA,J,LN,FILENT
"RTN","PRCABJV",11,0)
 S LT=$S(FILE[430.3:"TRANST",FILE[430.2:"CAT",1:"EVENT"),CNT=0
"RTN","PRCABJV",12,0)
 F I=1,2 S J=@("X"_I),IND(I)=$P(J,";"),ND(I)=$P(J,";",2),PC(I)=$P(J,";",3)
"RTN","PRCABJV",13,0)
 F I1=1:1 D  Q:(DATA(0)="EOF")!(ERROR)
"RTN","PRCABJV",14,0)
    .S LN=$T(@LT+I1) F I=3:1:6 S DATA(I-3)=$P(LN,";",I)
"RTN","PRCABJV",15,0)
    .Q:DATA(0)="EOF"
"RTN","PRCABJV",16,0)
    .G RC:FILE<430
"RTN","PRCABJV",17,0)
    .I '$D(^PRCA(FILE,"B",DATA(0))) S ERROR=1 Q
"RTN","PRCABJV",18,0)
    .S REC=$O(^PRCA(FILE,"B",DATA(0),0)) I 'REC S ERROR=1 Q
"RTN","PRCABJV",19,0)
    .I DATA(3)'=REC S ERROR=1 Q
"RTN","PRCABJV",20,0)
    .I $P(^PRCA(FILE,REC,0),U)'=DATA(0) S ERROR=1 Q
"RTN","PRCABJV",21,0)
    .G CNT:X1=""
"RTN","PRCABJV",22,0)
    .F I2=1,2 D  Q:ERROR  I I2=1,X2="" Q
"RTN","PRCABJV",23,0)
       ..I '$D(^PRCA(FILE,IND(I2),DATA(I2))) S ERROR=1 G Q2
"RTN","PRCABJV",24,0)
       ..;  do not check if category number is a zero
"RTN","PRCABJV",25,0)
       ..I I2=1,DATA(1)'=0,$O(^PRCA(FILE,IND(I2),DATA(I2),0))'=REC S ERROR=1 G Q2
"RTN","PRCABJV",26,0)
       ..I $P(^PRCA(FILE,REC,ND(I2)),U,PC(I2))'=DATA(I2) S ERROR=1
"RTN","PRCABJV",27,0)
Q2 ..Q
"RTN","PRCABJV",28,0)
CNT .Q:ERROR
"RTN","PRCABJV",29,0)
    .S CNT=CNT+1
"RTN","PRCABJV",30,0)
Q1 .Q
"RTN","PRCABJV",31,0)
RC .I '$D(^RC(FILE,"B",DATA(0))) S ERROR=1 Q
"RTN","PRCABJV",32,0)
    .S REC=$O(^RC(FILE,"B",DATA(0),0)) I 'REC S ERROR=1 Q
"RTN","PRCABJV",33,0)
    .I DATA(3)'=REC S ERROR=1 Q
"RTN","PRCABJV",34,0)
    .I $P(^RC(FILE,REC,0),U)'=DATA(0) S ERROR=1 Q
"RTN","PRCABJV",35,0)
    .G CNT:X1=""
"RTN","PRCABJV",36,0)
    .F I3=1,2 D  Q:ERROR  I I3=1,X2="" Q
"RTN","PRCABJV",37,0)
       ..I '$D(^RC(FILE,IND(I3),DATA(I3))) S ERROR=1 G Q3
"RTN","PRCABJV",38,0)
       ..I $O(^RC(FILE,IND(I3),DATA(I3),0))'=REC S ERROR=1 G Q3
"RTN","PRCABJV",39,0)
       ..I $P(^RC(FILE,REC,ND(I3)),U,PC(I3))'=DATA(I3) S ERROR=1
"RTN","PRCABJV",40,0)
Q3 ..Q
"RTN","PRCABJV",41,0)
    .G CNT
"RTN","PRCABJV",42,0)
 I FILE>429.99,$P(^PRCA(FILE,0),U,4)'=CNT S ERROR=1 G EXIT
"RTN","PRCABJV",43,0)
 G EXIT:FILE>429.99
"RTN","PRCABJV",44,0)
 I $P(^RC(FILE,0),U,4)'=CNT S ERROR=1
"RTN","PRCABJV",45,0)
EXIT Q:'ERROR
"RTN","PRCABJV",46,0)
 S FILENT=$S(FILE>429.99:$P(^PRCA(FILE,0),U,4),1:$P(^RC(FILE,0),U,4))
"RTN","PRCABJV",47,0)
 S ERROR(1)="An error has been detected in the "_$P(^DIC(FILE,0),U)_" File."
"RTN","PRCABJV",48,0)
 I DATA(0)="EOF" S ERROR(2)="There are too many entries in your file."
"RTN","PRCABJV",49,0)
 I DATA(0)'="EOF" S ERROR(2)="The "_DATA(0)_" Entry in your file is missing or corrupted."
"RTN","PRCABJV",50,0)
 Q
"RTN","PRCABJV",51,0)
TRANST ;
"RTN","PRCABJV",52,0)
 ;;ACTIVE;102;A;16
"RTN","PRCABJV",53,0)
 ;;ADD (AMEND);302;AD;37
"RTN","PRCABJV",54,0)
 ;;ADMIN.COST CHARGE;12;AC;12
"RTN","PRCABJV",55,0)
 ;;AMEND;303;AM;38
"RTN","PRCABJV",56,0)
 ;;AMENDED BILL;110;AB;33
"RTN","PRCABJV",57,0)
 ;;ARCHIVED;115;XX;49
"RTN","PRCABJV",58,0)
 ;;BILL INCOMPLETE;201;BI;27
"RTN","PRCABJV",59,0)
 ;;CANCELLATION;111;CN;39
"RTN","PRCABJV",60,0)
 ;;CANCELLED BILL;210;CB;26
"RTN","PRCABJV",61,0)
 ;;CASH COLLECTION BY RC/DOJ;7;CJ;7
"RTN","PRCABJV",62,0)
 ;;CHARGE SUSPENDED;19;CS;47
"RTN","PRCABJV",63,0)
 ;;COLLECTED/CLOSED;108;CC;22
"RTN","PRCABJV",64,0)
 ;;COMMENT;17;CM;45
"RTN","PRCABJV",65,0)
 ;;CS ADD CASE INFO;47;CZ;67
"RTN","PRCABJV",66,0)
 ;;CS ADMIN ADJ TR REV?N;54;AO;76
"RTN","PRCABJV",67,0)
 ;;CS ADMIN ADJ TR REV?Y;53;AN;75
"RTN","PRCABJV",68,0)
 ;;CS ADMIN.COST CHARGE;52;AE;74
"RTN","PRCABJV",69,0)
 ;;CS BILL RECALL;34;CR;53
"RTN","PRCABJV",70,0)
 ;;CS CASE RECALL;45;CO;64
"RTN","PRCABJV",71,0)
 ;;CS DEBTOR NEW BILL;39;CK;85
"RTN","PRCABJV",72,0)
 ;;CS DEBTOR RECALL;35;CE;56
"RTN","PRCABJV",73,0)
 ;;CS DEBTOR RE-REFER BILL;64;RS;87
"RTN","PRCABJV",74,0)
 ;;CS DECR ADJ NOT APP;40;CA;66
"RTN","PRCABJV",75,0)
 ;;CS DECREASE ADJ;49;CY;70
"RTN","PRCABJV",76,0)
 ;;CS DEL BILL RECALL;37;CF;55
"RTN","PRCABJV",77,0)
 ;;CS DEL CASE RECALL;46;CG;65
"RTN","PRCABJV",78,0)
 ;;CS DEL DEBTOR RECALL;38;CL;57
"RTN","PRCABJV",79,0)
 ;;CS INC ADJ TR REV?N;58;AT;80
"RTN","PRCABJV",80,0)
 ;;CS INC ADJ TR REV?Y;57;AS;79
"RTN","PRCABJV",81,0)
 ;;CS INCREASE ADJ;51;AI;73
"RTN","PRCABJV",82,0)
 ;;CS NEW DBTR NEW BILL;48;CH;68
"RTN","PRCABJV",83,0)
 ;;CS PEND RECON;61;RK;83
"RTN","PRCABJV",84,0)
 ;;CS RECALL PLACED;62;CQ;84
"RTN","PRCABJV",85,0)
 ;;CS RECON WORKED;50;CV;71
"RTN","PRCABJV",86,0)
 ;;CS RE-REFER BILL CANCEL;65;RC;88
"RTN","PRCABJV",87,0)
 ;;CS RE-REFER BILL REQUEST;63;RR;86
"RTN","PRCABJV",88,0)
 ;;CS STOP DELETED;36;CD;54
"RTN","PRCABJV",89,0)
 ;;CS STOP PLACED;33;CP;51
"RTN","PRCABJV",90,0)
 ;;CS UPDATE DEBT;41;CU;60
"RTN","PRCABJV",91,0)
 ;;DEBIT VOUCHER (SF 5515);30;DV;30
"RTN","PRCABJV",92,0)
 ;;DECREASE ADJUSTMENT;21;DA;35
"RTN","PRCABJV",93,0)
 ;;DEL REPAY PLAN;31;DP;72
"RTN","PRCABJV",94,0)
 ;;DELETE (AMEND);301;DL;36
"RTN","PRCABJV",95,0)
 ;;EXEMPT INT/ADM. COST;14;E;14
"RTN","PRCABJV",96,0)
 ;;IN-ACTIVE;103;IA;17
"RTN","PRCABJV",97,0)
 ;;INCOMPLETE;101;IN;15
"RTN","PRCABJV",98,0)
 ;;INCREASE ADJUSTMENT;1;AJ;1
"RTN","PRCABJV",99,0)
 ;;INTEREST/ADM. CHARGE;13;IC;13
"RTN","PRCABJV",100,0)
 ;;MARSHAL/COURT COST;15;ML;24
"RTN","PRCABJV",101,0)
 ;;NEW BILL;104;N;18
"RTN","PRCABJV",102,0)
 ;;OLD BILL;106;OB;28
"RTN","PRCABJV",103,0)
 ;;OPEN;112;OP;42
"RTN","PRCABJV",104,0)
 ;;PAYMENT (IN FULL);20;PF;34
"RTN","PRCABJV",105,0)
 ;;PAYMENT (IN PART);2;PP;2
"RTN","PRCABJV",106,0)
 ;;PENDING APPROVAL;205;PA;20
"RTN","PRCABJV",107,0)
 ;;PENDING ARCHIVE;114;X;48
"RTN","PRCABJV",108,0)
 ;;PENDING CALM CODE;107;PC;21
"RTN","PRCABJV",109,0)
 ;;REESTABLISH TO RC/DOJ;5;RR;5
"RTN","PRCABJV",110,0)
 ;;RE-ESTABLISH;250;RW;43
"RTN","PRCABJV",111,0)
 ;;REFER TO DOJ;4;RJ;4
"RTN","PRCABJV",112,0)
 ;;REFER TO RC;3;RC;3
"RTN","PRCABJV",113,0)
 ;;REFUND REVIEW;113;PR;44
"RTN","PRCABJV",114,0)
 ;;REFUNDED;120;RF;41
"RTN","PRCABJV",115,0)
 ;;REPAYMENT PLAN;16;RP;25
"RTN","PRCABJV",116,0)
 ;;RETURNED BY RC/DOJ;6;RD;6
"RTN","PRCABJV",117,0)
 ;;RETURNED FOR AMENDMENT;230;RA;32
"RTN","PRCABJV",118,0)
 ;;RETURNED FROM AR (NEW);220;RT;31
"RTN","PRCABJV",119,0)
 ;;SUSPENDED;240;SP;40
"RTN","PRCABJV",120,0)
 ;;SUSPENSE;105;S;19
"RTN","PRCABJV",121,0)
 ;;TERM.BY COMPROMISE;9;TC;9
"RTN","PRCABJV",122,0)
 ;;TERM.BY FIS.OFFICER;8;TO;8
"RTN","PRCABJV",123,0)
 ;;TERM.BY RC/DOJ;29;TJ;29
"RTN","PRCABJV",124,0)
 ;;UNSUSPENDED;18;US;46
"RTN","PRCABJV",125,0)
 ;;WAIVED IN FULL;10;WF;10
"RTN","PRCABJV",126,0)
 ;;WAIVED IN PART;11;WP;11
"RTN","PRCABJV",127,0)
 ;;WRITE-OFF;109;WO;23
"RTN","PRCABJV",128,0)
 ;;EOF
"RTN","PRCABJV",129,0)
 ;
"RTN","PRCABJV",130,0)
 ;PRCA*4.5*338 - Added and Alphabetized Community Care categories
"RTN","PRCABJV",131,0)
CAT ;patch 192 - ISC-0502-N2803 change Champus to Tricare
"RTN","PRCABJV",132,0)
 ;;ADULT DAY HEALTH CARE;40;AD;33
"RTN","PRCABJV",133,0)
 ;;C (MEANS TEST);24;C;18
"RTN","PRCABJV",134,0)
 ;;CC INPT;65;CJ;63
"RTN","PRCABJV",135,0)
 ;;CC MTF INPT;69;CX;67
"RTN","PRCABJV",136,0)
 ;;CC MTF OPT;86;D3;84
"RTN","PRCABJV",137,0)
 ;;CC MTF RX CO-PAYMENT;70;CY;68
"RTN","PRCABJV",138,0)
 ;;CC MTF THIRD PARTY;53;C4;51
"RTN","PRCABJV",139,0)
 ;;CC NO-FAULT AUTO;60;C8;58
"RTN","PRCABJV",140,0)
 ;;CC NURSING HOME CARE - LTC;71;CL;69
"RTN","PRCABJV",141,0)
 ;;CC OPT;84;D1;82
"RTN","PRCABJV",142,0)
 ;;CC RESPITE CARE;72;CN;70
"RTN","PRCABJV",143,0)
 ;;CC RX CO-PAYMENT;66;CK;64
"RTN","PRCABJV",144,0)
 ;;CC THIRD PARTY;51;C2;49
"RTN","PRCABJV",145,0)
 ;;CC TORT FEASOR;61;C9;59
"RTN","PRCABJV",146,0)
 ;;CC WORKERS' COMP;59;CA;57
"RTN","PRCABJV",147,0)
 ;;CCN INPT;67;CO;65
"RTN","PRCABJV",148,0)
 ;;CCN NO-FAULT AUTO;57;CB;55
"RTN","PRCABJV",149,0)
 ;;CCN NURSING HOME CARE - LTC;73;CR;71
"RTN","PRCABJV",150,0)
 ;;CCN OPT;85;D2;83
"RTN","PRCABJV",151,0)
 ;;CCN RESPITE CARE;74;CU;72
"RTN","PRCABJV",152,0)
 ;;CCN RX CO-PAYMENT;68;CQ;66
"RTN","PRCABJV",153,0)
 ;;CCN THIRD PARTY;52;C3;50
"RTN","PRCABJV",154,0)
 ;;CCN TORT FEASOR;58;CC;56
"RTN","PRCABJV",155,0)
 ;;CCN WORKERS' COMP;56;CD;54
"RTN","PRCABJV",156,0)
 ;;CHAMPVA;36;CV;29
"RTN","PRCABJV",157,0)
 ;;CHAMPVA SUBSISTENCE;34;CS;27
"RTN","PRCABJV",158,0)
 ;;CHAMPVA THIRD PARTY;35;CT;28
"RTN","PRCABJV",159,0)
 ;;CHOICE INPT;63;CF;61
"RTN","PRCABJV",160,0)
 ;;CHOICE NO-FAULT AUTO;54;C5;52
"RTN","PRCABJV",161,0)
 ;;CHOICE NURSING HOME CARE - LTC;75;CH;73
"RTN","PRCABJV",162,0)
 ;;CHOICE OPT;83;CZ;81
"RTN","PRCABJV",163,0)
 ;;CHOICE RESPITE CARE;76;CI;74
"RTN","PRCABJV",164,0)
 ;;CHOICE RX CO-PAYMENT;64;CG;62
"RTN","PRCABJV",165,0)
 ;;CHOICE THIRD PARTY;50;C1;48
"RTN","PRCABJV",166,0)
 ;;CHOICE TORT FEASOR;55;C6;53
"RTN","PRCABJV",167,0)
 ;;CHOICE WORKERS' COMP;62;C7;60
"RTN","PRCABJV",168,0)
 ;;COMP & PEN PROCEEDS;8;CM;43
"RTN","PRCABJV",169,0)
 ;;CRIME OF PER.VIO.;27;CP;8
"RTN","PRCABJV",170,0)
 ;;CURRENT EMP.;14;CE;16
"RTN","PRCABJV",171,0)
 ;;CWT PROCEEDS;7;CW;42
"RTN","PRCABJV",172,0)
 ;;DOMICILIARY;41;DO;34
"RTN","PRCABJV",173,0)
 ;;EMERGENCY/HUMANITARIAN;25;H;2
"RTN","PRCABJV",174,0)
 ;;EMERGENCY/HUMANITARIAN REIMB.;48;HR;46
"RTN","PRCABJV",175,0)
 ;;ENHANCED USE LEASE PROCEEDS;10;EP;44
"RTN","PRCABJV",176,0)
 ;;EX-EMPLOYEE;13;E;15
"RTN","PRCABJV",177,0)
 ;;FEDERAL AGENCIES-REFUND;15;F2;13
"RTN","PRCABJV",178,0)
 ;;FEDERAL AGENCIES-REIMB.;16;F1;14
"RTN","PRCABJV",179,0)
 ;;FEE REIMB INS;47;FR;45
"RTN","PRCABJV",180,0)
 ;;GERIATRIC EVAL-INSTITUTIONAL;44;GE;37
"RTN","PRCABJV",181,0)
 ;;GERIATRIC EVAL-NON-INSTITUTION;45;GN;38
"RTN","PRCABJV",182,0)
 ;;HOSPITAL CARE (NSC);1;HC;5
"RTN","PRCABJV",183,0)
 ;;HOSPITAL CARE PER DIEM;32;HP;25
"RTN","PRCABJV",184,0)
 ;;INELIGIBLE HOSP.;20;I;1
"RTN","PRCABJV",185,0)
 ;;INELIGIBLE HOSP. REIMB.;49;IR;47
"RTN","PRCABJV",186,0)
 ;;INTERAGENCY;19;IA;20
"RTN","PRCABJV",187,0)
 ;;MEDICARE;28;MC;21
"RTN","PRCABJV",188,0)
 ;;MILITARY;17;M;12
"RTN","PRCABJV",189,0)
 ;;NO-FAULT AUTO ACC.;26;NA;7
"RTN","PRCABJV",190,0)
 ;;NURSING HOME CARE PER DIEM;31;NP;24
"RTN","PRCABJV",191,0)
 ;;NURSING HOME CARE(NSC);3;NC;3
"RTN","PRCABJV",192,0)
 ;;NURSING HOME CARE-LTC;46;NL;39
"RTN","PRCABJV",193,0)
 ;;NURSING HOME PROCEEDS;5;NH;40
"RTN","PRCABJV",194,0)
 ;;OUTPATIENT CARE(NSC);2;OC;4
"RTN","PRCABJV",195,0)
 ;;PARKING FEES;6;PF;41
"RTN","PRCABJV",196,0)
 ;;PREPAYMENT;33;PP;26
"RTN","PRCABJV",197,0)
 ;;REIMBURS.HEALTH INS.;21;RI;9
"RTN","PRCABJV",198,0)
 ;;RESPITE CARE-INSTITUTIONAL;42;RC;35
"RTN","PRCABJV",199,0)
 ;;RESPITE CARE-NON-INSTITUTIONAL;43;RN;36
"RTN","PRCABJV",200,0)
 ;;RX CO-PAYMENT/NSC VET;30;PN;23
"RTN","PRCABJV",201,0)
 ;;RX CO-PAYMENT/SC VET;29;PS;22
"RTN","PRCABJV",202,0)
 ;;SHARING AGREEMENTS;18;SA;19
"RTN","PRCABJV",203,0)
 ;;TORT FEASOR;22;TF;10
"RTN","PRCABJV",204,0)
 ;;TRICARE;37;T1;30
"RTN","PRCABJV",205,0)
 ;;TRICARE BLIND REHABILITATION;80;T7;78
"RTN","PRCABJV",206,0)
 ;;TRICARE DENTAL;81;T8;79
"RTN","PRCABJV",207,0)
 ;;TRICARE DES;77;T4;75
"RTN","PRCABJV",208,0)
 ;;TRICARE PATIENT;38;T2;31
"RTN","PRCABJV",209,0)
 ;;TRICARE PHARMACY;82;T9;80
"RTN","PRCABJV",210,0)
 ;;TRICARE SCI;78;T5;76
"RTN","PRCABJV",211,0)
 ;;TRICARE TBI;79;T6;77
"RTN","PRCABJV",212,0)
 ;;TRICARE THIRD PARTY;39;T3;32
"RTN","PRCABJV",213,0)
 ;;VENDOR;11;V;17
"RTN","PRCABJV",214,0)
 ;;WORKMAN'S COMP.;23;WC;6
"RTN","PRCABJV",215,0)
 ;;EOF
"RTN","PRCABJV",216,0)
EVENT ;
"RTN","PRCABJV",217,0)
 ;;CASH PAYMENT;6;;6
"RTN","PRCABJV",218,0)
 ;;CHECK/MO PAYMENT;4;;4
"RTN","PRCABJV",219,0)
 ;;COMMENT;1;;1
"RTN","PRCABJV",220,0)
 ;;CREDIT CARD PAYMENT;7;;7
"RTN","PRCABJV",221,0)
 ;;DEPT OF JUSTICE PAYMENT;5;;5
"RTN","PRCABJV",222,0)
 ;;REGIONAL COUNSEL PAYMENT;3;;3
"RTN","PRCABJV",223,0)
 ;;FOLLOW-UP LETTER;10;;10
"RTN","PRCABJV",224,0)
 ;;IRS PAYMENT;11;;11
"RTN","PRCABJV",225,0)
 ;;PATIENT STATEMENT;2;;2
"RTN","PRCABJV",226,0)
 ;;TDA PAYMENT;8;;8
"RTN","PRCABJV",227,0)
 ;;UB PRINTED;9;;9
"RTN","PRCABJV",228,0)
 ;;LOCKBOX;12;;12
"RTN","PRCABJV",229,0)
 ;;TOP PAYMENT;13;;13
"RTN","PRCABJV",230,0)
 ;;EDI LOCKBOX;14;;14
"RTN","PRCABJV",231,0)
 ;;ADMINISTRATIVE OFFSET;15;;15
"RTN","PRCABJV",232,0)
 ;;PRIVATE COLLECTION AGENCY;16;;16
"RTN","PRCABJV",233,0)
 ;;EOF
"RTN","PRCACDRP")
0^31^B72854172^n/a
"RTN","PRCACDRP",1,0)
PRCACDRP ;ALB/YG - Catastrophically Disabled Exempt Copay Charge Report; July 25, 2019@21:06
"RTN","PRCACDRP",2,0)
 ;;4.5;Accounts Receivable;**350**;Mar 20, 1995;Build 66
"RTN","PRCACDRP",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCACDRP",4,0)
 ;
"RTN","PRCACDRP",5,0)
 ; Routine was cloned from IBOCDRPT and moved to AR (PRCA) namespace
"RTN","PRCACDRP",6,0)
 ;
"RTN","PRCACDRP",7,0)
EN ; - this will produce a report of patient's with charges that are CD.
"RTN","PRCACDRP",8,0)
 ;
"RTN","PRCACDRP",9,0)
 N POP,%ZIS,ZTRTN,ZTDESC,ZTSK,IBEDT,IBBDT,%DT,ZTSAVE,IBEXCEL
"RTN","PRCACDRP",10,0)
 W !!,"*** Print the Catastrophically Disabled Exempt Copay Charge Report ***"
"RTN","PRCACDRP",11,0)
 W !!,"The Catastrophically Disabled legislation effective date is May 5, 2010."
"RTN","PRCACDRP",12,0)
 W !,"You should not enter a date prior to that date, any date entered before"
"RTN","PRCACDRP",13,0)
 W !,"that will be automatically changed to May 5, 2010."
"RTN","PRCACDRP",14,0)
 W !!,"This report includes bills for charges without an IB Status of Cancelled"
"RTN","PRCACDRP",15,0)
 W !,"and with an AR Status of Active, Open, Suspended, Write-Off, Cancellation,"
"RTN","PRCACDRP",16,0)
 W !,"Collected/Closed or with an IB Status of On-Hold, and an episode of care"
"RTN","PRCACDRP",17,0)
 W !,"date on or after the Catastrophically Disabled exemption effective date.",!
"RTN","PRCACDRP",18,0)
 D DATE Q:'IBEDT
"RTN","PRCACDRP",19,0)
 S IBEXCEL=$$EXCEL^PRCACDRP()
"RTN","PRCACDRP",20,0)
 I IBEXCEL D EXMSG
"RTN","PRCACDRP",21,0)
 I 'IBEXCEL D
"RTN","PRCACDRP",22,0)
 . W !!,"This report may take a while to process. It is recommended that you Queue"
"RTN","PRCACDRP",23,0)
 . W !,"this report to a device that is 132 characters wide."
"RTN","PRCACDRP",24,0)
 S %ZIS="QM" D ^%ZIS Q:POP
"RTN","PRCACDRP",25,0)
 I $D(IO("Q")) D  Q
"RTN","PRCACDRP",26,0)
 .S ZTRTN="DQ^PRCACDRP",ZTDESC="Catastrophically Disabled Copay Report"
"RTN","PRCACDRP",27,0)
 .S ZTSAVE("IBEDT")="",ZTSAVE("IBBDT")="",ZTSAVE("IBEXCEL")=""
"RTN","PRCACDRP",28,0)
 .D ^%ZTLOAD D HOME^%ZIS K IO("Q")
"RTN","PRCACDRP",29,0)
 .D MES^XPDUTL("Catastrophically Disabled Copay Report queued #"_ZTSK)
"RTN","PRCACDRP",30,0)
DQ U IO
"RTN","PRCACDRP",31,0)
 ;
"RTN","PRCACDRP",32,0)
 N IBX,IBZ,IBDT,IBDG,DFN,IBP,IBARX,IBARBILL,IBARDATA,IBDPT,IBDDT,IBQUIT,REAS,ARSTAT,EOCDT,FUND,IBDATA,IBSTAT,MCDT,RXDT,PRGRP,CD,CDDATE,PAR,PARZ
"RTN","PRCACDRP",33,0)
 ;
"RTN","PRCACDRP",34,0)
 S (IBP,IBQUIT)=0
"RTN","PRCACDRP",35,0)
 D HEAD
"RTN","PRCACDRP",36,0)
 I IBBDT<3100505 S IBBDT=3100505 ; not before CD effective date
"RTN","PRCACDRP",37,0)
 S IBDDT=IBBDT-1 F  S IBDDT=$O(^IB("D",IBDDT)) Q:'IBDDT!(IBQUIT)  D  Q:IBQUIT
"RTN","PRCACDRP",38,0)
 . S IBX=0 F  S IBX=$O(^IB("D",IBDDT,IBX)) Q:'IBX!(IBQUIT)  D  Q:IBQUIT  ;S ^TMP($J,"PRCACDRP",REAS,IBX)=IBZ,X=$I(^TMP($J,"PRCACDRP",REAS))
"RTN","PRCACDRP",39,0)
 . . S IBZ=$G(^IB(IBX,0)),DFN=+$P(IBZ,"^",2)
"RTN","PRCACDRP",40,0)
 . . S PRGRP=$$PRIORITY^DGENA(DFN)
"RTN","PRCACDRP",41,0)
 . . S IBDT=$S($E($P(IBZ,"^",4),1,2)=52:IBDDT,$P(IBZ,"^",8)="RX COPAYMENT":IBDDT,$P(IBZ,"^",15):$P(IBZ,"^",15),1:$P(IBZ,"^",14))\1
"RTN","PRCACDRP",42,0)
 . . K IBDG
"RTN","PRCACDRP",43,0)
 . . S IBDG=$$GET^DGENCDA(DFN,.IBDG)  ; IA# 4969
"RTN","PRCACDRP",44,0)
 . . ; quit if no date, or pt not CD
"RTN","PRCACDRP",45,0)
 . . S REAS=1
"RTN","PRCACDRP",46,0)
 . . I 'IBDT Q  ; no date
"RTN","PRCACDRP",47,0)
 . . S CDDATE=IBDG("REVDTE")
"RTN","PRCACDRP",48,0)
 . . S CD=$G(IBDG("VCD"))="Y"
"RTN","PRCACDRP",49,0)
 . . ; Business decision is to ignore Billing Exemption file 354.1
"RTN","PRCACDRP",50,0)
 . . ;I 'CD S CDDATE="" F  S CD=$O(^IBA(354.1,"AP",DFN,CD)) Q:'CD  I $P($G(^IBA(354.1,CD,0)),U,5)=12 S CD=1,CDDATE=$P(^(0),U) Q
"RTN","PRCACDRP",51,0)
 . . I 'CD Q
"RTN","PRCACDRP",52,0)
 . . S IBARX=+$O(^PRCA(430,"B",$S($P(IBZ,"^",11):$P(IBZ,"^",11),1:0),0))  ; IA# 389
"RTN","PRCACDRP",53,0)
 . . S IBARBILL=$S(IBARX:$$BILL^RCJIBFN2(IBARX),1:"")  ; IA# 1452
"RTN","PRCACDRP",54,0)
 . . K IBARDATA
"RTN","PRCACDRP",55,0)
 . . I IBARX D DIQ^RCJIBFN2(IBARX,"8,77:79;141;203;255.1","IBARDATA") ; IA# 1452
"RTN","PRCACDRP",56,0)
 . . S IBDATA=$$GETIB^RCDMCR4B(IBX,0)
"RTN","PRCACDRP",57,0)
 . . S MCDT=$P(IBDATA,U,2) I MCDT="" S MCDT=$P(IBDATA,U,3)
"RTN","PRCACDRP",58,0)
 . . S RXDT=$P(IBDATA,U,4)
"RTN","PRCACDRP",59,0)
 . . S EOCDT=$S(RXDT>MCDT:RXDT,1:MCDT)
"RTN","PRCACDRP",60,0)
 . . S IBSTAT=$P(IBDATA,U,5) S:IBSTAT="" IBSTAT=$P(IBZ,U,5)
"RTN","PRCACDRP",61,0)
 . . S ARSTAT=$G(IBARDATA(430,IBARX,8,"E")) I ARSTAT="COLLECTED/CLOSED" S ARSTAT="C/C"
"RTN","PRCACDRP",62,0)
 . . ; quit if status cancelled (ib) or no charge
"RTN","PRCACDRP",63,0)
 . . I IBSTAT=10 Q  ; cancelled
"RTN","PRCACDRP",64,0)
 . . I '$P(IBZ,"^",7) Q  ; no charge
"RTN","PRCACDRP",65,0)
 . . ; quit if AR STATUS is not on the list and IB status is not ON HOLD.  Question - what about CANCELLED BILL (#26)
"RTN","PRCACDRP",66,0)
 . . S REAS=2 I IBARX,$P(IBARBILL,"^",2)=26 Q
"RTN","PRCACDRP",67,0)
 . . ; non inpatient, only talk to parent
"RTN","PRCACDRP",68,0)
 . . S REAS=3 I $P(IBZ,U,4)'?1"405:".E,$P(IBZ,U,4)'?1"45:".E,$$PARENTE^RCDMCR5B(IBX)'=IBX Q
"RTN","PRCACDRP",69,0)
 . . ; inpatient, check if parent event or parent charge is cancelled.
"RTN","PRCACDRP",70,0)
 . . I $P(IBZ,U,4)?1"405:".E!($P(IBZ,U,4)'?1"45:".E) S PAR=$$PARENTE^RCDMCR5B(IBX) I PAR S PARZ=^IB(PAR,0) I $P(PARZ,U,5)=10 Q
"RTN","PRCACDRP",71,0)
 . . I $P(IBZ,U,4)?1"405:".E!($P(IBZ,U,4)'?1"45:".E) S PAR=$$PARENTC^RCDMCR5B(IBX) I PAR S PARZ=^IB(PAR,0) I $P(PARZ,U,5)=10 Q
"RTN","PRCACDRP",72,0)
 . . ; quit if CD effective date not before event date
"RTN","PRCACDRP",73,0)
 . . S REAS=4 Q:IBDT<3100505  Q:IBDT<CDDATE
"RTN","PRCACDRP",74,0)
 . . ; quit if not within specified date range
"RTN","PRCACDRP",75,0)
 . . S REAS=5 Q:IBDT<IBBDT!(IBDT>IBEDT)  Q:EOCDT<IBBDT!(EOCDT>IBEDT)
"RTN","PRCACDRP",76,0)
 . . ; quit if LTC action type
"RTN","PRCACDRP",77,0)
 . . S REAS=6 I $P($G(^IBE(350.1,+$P(IBZ,"^",3),0)),"^")["LTC " Q
"RTN","PRCACDRP",78,0)
 . . S REAS=7 Q:'IBDATA
"RTN","PRCACDRP",79,0)
 . . ; quit if not the right fund
"RTN","PRCACDRP",80,0)
 . . S REAS=8 I IBARX S FUND=$G(IBARDATA(430,IBARX,203,"E")) I FUND'=528703,FUND'=528701 Q
"RTN","PRCACDRP",81,0)
 . . ; quit if AR STATUS is not on the list and IB status is not ON HOLD.  Question - what about CANCELLED BILL (#26)
"RTN","PRCACDRP",82,0)
 . . S REAS=9 I '$F(",16,39,42,40,22,23,",","_$P(IBARBILL,U,2)_","),$P(IBZ,U,5)'=8 Q
"RTN","PRCACDRP",83,0)
 . . S REAS=10 Q:EOCDT<3100505  Q:EOCDT<CDDATE
"RTN","PRCACDRP",84,0)
 . . S IBDPT=$G(^DPT(DFN,0))
"RTN","PRCACDRP",85,0)
 . . I 'IBEXCEL D
"RTN","PRCACDRP",86,0)
 . . . S REAS=0 W !,$E($P(IBDPT,"^"),1,20) ; patient name
"RTN","PRCACDRP",87,0)
 . . . W ?21,$P(IBDPT,"^",9) ; snn
"RTN","PRCACDRP",88,0)
 . . . W ?31,PRGRP ; Priority group
"RTN","PRCACDRP",89,0)
 . . . W ?33,$$FMTE^XLFDT($G(IBDG("REVDTE")),"2DZ") ; Catastrophically Disabled Date, IA# 10103
"RTN","PRCACDRP",90,0)
 . . . W ?42,$E($P($P(IBZ,"^",11),"-",2),1,8) ; ar bill no
"RTN","PRCACDRP",91,0)
 . . . ;IBDATA = 1 ^ Outpatient Date ^ Discharge Date ^ RX/Refill Date ^ IB Status ^ RX NUM ^ RX Name ^ CHGAMT
"RTN","PRCACDRP",92,0)
 . . . W:MCDT'="" ?50,$$FMTE^XLFDT(MCDT,"2DZ") ; Med Care Date
"RTN","PRCACDRP",93,0)
 . . . W:RXDT'="" ?59,$$FMTE^XLFDT(RXDT,"2DZ") ; RX Date
"RTN","PRCACDRP",94,0)
 . . . W ?68,$E($P(IBDATA,U,6),1,8) ; rx #
"RTN","PRCACDRP",95,0)
 . . . W ?77,$E($P(IBDATA,U,7),1,20) ; rx name
"RTN","PRCACDRP",96,0)
 . . . W ?98,$J("$"_$FN($P(IBDATA,U,8),"",2),9) ; charge
"RTN","PRCACDRP",97,0)
 . . . W ?108,$E($P($G(^IBE(350.21,IBSTAT,0)),U),1,10) ; IBSTATUS
"RTN","PRCACDRP",98,0)
 . . . W ?119,$E(ARSTAT,1,13) ; AR Status
"RTN","PRCACDRP",99,0)
 . . . I $Y+3>IOSL D HEAD
"RTN","PRCACDRP",100,0)
 . . I IBEXCEL D
"RTN","PRCACDRP",101,0)
 . . . S REAS=0 W !,"""",$P(IBDPT,"^"),"""" ; patient name
"RTN","PRCACDRP",102,0)
 . . . W U,$P(IBDPT,"^",9) ; snn
"RTN","PRCACDRP",103,0)
 . . . W U,PRGRP ; Priority group
"RTN","PRCACDRP",104,0)
 . . . W U,$$FMTE^XLFDT($G(IBDG("REVDTE")),"2DZ") ; Catastrophically Disabled Date, IA# 10103
"RTN","PRCACDRP",105,0)
 . . . W U,$P($P(IBZ,"^",11),"-",2) ; ar bill no
"RTN","PRCACDRP",106,0)
 . . . ;IBDATA = 1 ^ Outpatient Date ^ Discharge Date ^ RX/Refill Date ^ IB Status ^ RX NUM ^ RX Name ^ CHGAMT
"RTN","PRCACDRP",107,0)
 . . . W U W:MCDT'="" $$FMTE^XLFDT(MCDT,"2DZ") ; Med Care Date
"RTN","PRCACDRP",108,0)
 . . . W U W:RXDT'="" $$FMTE^XLFDT(RXDT,"2DZ") ; RX Date
"RTN","PRCACDRP",109,0)
 . . . W U,$P(IBDATA,U,6) ; rx # (or get it from IBDATA?)
"RTN","PRCACDRP",110,0)
 . . . W U,$P(IBDATA,U,7) ; rx name
"RTN","PRCACDRP",111,0)
 . . . W U,"$",$FN($P(IBDATA,U,8),"",2) ; charge
"RTN","PRCACDRP",112,0)
 . . . W U,$P($G(^IBE(350.21,IBSTAT,0)),U) ; IBSTATUS
"RTN","PRCACDRP",113,0)
 . . . W U,ARSTAT ; AR Status
"RTN","PRCACDRP",114,0)
 I 'IBQUIT,'IBEXCEL,IBP,$E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR I $D(DIRUT) S IBQUIT=1 Q
"RTN","PRCACDRP",115,0)
 D ^%ZISC
"RTN","PRCACDRP",116,0)
EXIT S:$D(ZTQUEUED) ZTREQ="@"
"RTN","PRCACDRP",117,0)
 Q
"RTN","PRCACDRP",118,0)
HEAD ;
"RTN","PRCACDRP",119,0)
 N IBL,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","PRCACDRP",120,0)
 I 'IBEXCEL,IBP,$E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR I $D(DIRUT) S IBQUIT=1 Q
"RTN","PRCACDRP",121,0)
 S IBP=IBP+1
"RTN","PRCACDRP",122,0)
 I 'IBEXCEL D
"RTN","PRCACDRP",123,0)
 . W @IOF,!,"Cross-Servicing Catastrophically Disabled Exempt Copayment Charge Report   --- Run Date: ",$$FMTE^XLFDT($$NOW^XLFDT,"9MP")," ---",?122,"Page: ",IBP
"RTN","PRCACDRP",124,0)
 . W !,"Episode of Care Dates from ",$$FMTE^XLFDT(IBBDT,"9MP")," to ",$$FMTE^XLFDT(IBEDT,"9MP")
"RTN","PRCACDRP",125,0)
 . W !,"                              Pri  CD             Medical   RX Fill                                  Charge"
"RTN","PRCACDRP",126,0)
 . W !,"Patient Name           SSN    Grp  Date   Bill NO Care Date Date    RX #     RX Name                 Amount IB Status  AR Status",!
"RTN","PRCACDRP",127,0)
 I IBEXCEL D
"RTN","PRCACDRP",128,0)
 . W !,"Patient Name",U,"SSN",U,"Pri Grp",U,"CD Date",U,"Bill NO",U,"Medical Care Date",U,"RX Fill Date",U,"RX #",U
"RTN","PRCACDRP",129,0)
 . W "RX Name",U,"Charge Amount",U,"IB Status",U,"AR Status",U
"RTN","PRCACDRP",130,0)
 I 'IBEXCEL F IBL=1:1:$S(IOM:IOM,1:132) W "-"
"RTN","PRCACDRP",131,0)
 Q
"RTN","PRCACDRP",132,0)
EXCEL() ; Export the report to MS Excel?
"RTN","PRCACDRP",133,0)
 ; Function return values:
"RTN","PRCACDRP",134,0)
 ;   0 - User selected "No" at prompt.
"RTN","PRCACDRP",135,0)
 ;   1 - User selected "Yes" at prompt.
"RTN","PRCACDRP",136,0)
 ;   ^ - User aborted.
"RTN","PRCACDRP",137,0)
 ; This function allows the user to indicate whether the report should be
"RTN","PRCACDRP",138,0)
 ; printed in a format that could easily be imported into an Excel
"RTN","PRCACDRP",139,0)
 ; spreadsheet.  If the user wants to print in EXCEL format, the variable 
"RTN","PRCACDRP",140,0)
 ; IBEXCEL will be set to '1', otherwise IBEXCEL will be set to '0' for "No" 
"RTN","PRCACDRP",141,0)
 ; or "^" to abort.
"RTN","PRCACDRP",142,0)
 ;
"RTN","PRCACDRP",143,0)
 N DIR,DIRUT,Y
"RTN","PRCACDRP",144,0)
 S DIR(0)="Y"
"RTN","PRCACDRP",145,0)
 S DIR("A")="Do you want to capture report data for an Excel document"
"RTN","PRCACDRP",146,0)
 I $G(IBEXCEL)=1 S DIR("B")="YES"
"RTN","PRCACDRP",147,0)
 E  S DIR("B")="NO"
"RTN","PRCACDRP",148,0)
 S DIR("?",1)="If you want to capture the output from this report in a format that"
"RTN","PRCACDRP",149,0)
 S DIR("?",2)="could easily be imported into an Excel spreadsheet, then answer YES here."
"RTN","PRCACDRP",150,0)
 S DIR("?")="If you want a normal report output, then answer NO here."
"RTN","PRCACDRP",151,0)
 W !
"RTN","PRCACDRP",152,0)
 D ^DIR
"RTN","PRCACDRP",153,0)
 K DIR
"RTN","PRCACDRP",154,0)
 I $D(DIRUT) Q "^" ; Abort
"RTN","PRCACDRP",155,0)
 Q +Y
"RTN","PRCACDRP",156,0)
DATE ;
"RTN","PRCACDRP",157,0)
 ;  -get beginning and ending dates
"RTN","PRCACDRP",158,0)
 ;  -output in ibbdt - beginning date
"RTN","PRCACDRP",159,0)
 ;             ibedt - ending date
"RTN","PRCACDRP",160,0)
 ;
"RTN","PRCACDRP",161,0)
BDT ;  -get beginning date
"RTN","PRCACDRP",162,0)
 S (IBBDT,IBEDT)=""
"RTN","PRCACDRP",163,0)
 ;S %DT(0)=3100505
"RTN","PRCACDRP",164,0)
 S %DT("B")="May 5, 2010"
"RTN","PRCACDRP",165,0)
 S %DT="AEX",%DT("A")="Start with DATE: " D ^%DT K %DT G DATEQ:Y<0
"RTN","PRCACDRP",166,0)
 S IBBDT=Y
"RTN","PRCACDRP",167,0)
 I IBBDT<3100505 S IBBDT=3100505 ;W !,"Start date changed to 5/5/2010"
"RTN","PRCACDRP",168,0)
 ;
"RTN","PRCACDRP",169,0)
EDT ;  -get ending date
"RTN","PRCACDRP",170,0)
 S %DT="AEX",%DT("A")="Go to DATE: ",%DT("B")="T" D ^%DT S:X=" " X=IBBDT
"RTN","PRCACDRP",171,0)
 G DATEQ:(X="")!(X["^") G EDT:Y<0
"RTN","PRCACDRP",172,0)
 S IBEDT=Y I Y<IBBDT W *7," ??",!,"ENDING DATE must follow BEGINNING DATE." G BDT
"RTN","PRCACDRP",173,0)
 ;
"RTN","PRCACDRP",174,0)
DATEQ K %DT
"RTN","PRCACDRP",175,0)
 Q
"RTN","PRCACDRP",176,0)
EXMSG ;
"RTN","PRCACDRP",177,0)
 W !,"This report may take a while to process.  To capture as an Excel"
"RTN","PRCACDRP",178,0)
 W !,"format, it is recommended that you queue this report to a spool device"
"RTN","PRCACDRP",179,0)
 W !,"with margins of 256 and page length of 99999 (e.g. spoolname;256;99999)."
"RTN","PRCACDRP",180,0)
 W !,"This should help avoid wrapping problems."
"RTN","PRCACDRP",181,0)
 W !!,"Another method would be to set up your terminal to capture the detail"
"RTN","PRCACDRP",182,0)
 W !,"report data.  On some terminals, this can be done by clicking on the "
"RTN","PRCACDRP",183,0)
 W !,"'Tools' menu above, then click on 'Capture Incoming Data' to save to"
"RTN","PRCACDRP",184,0)
 W !,"Desktop.  To avoid undesired wrapping of the data saved to the file,"
"RTN","PRCACDRP",185,0)
 W !,"please enter '0;256;99999' at the 'DEVICE:' prompt."
"RTN","PRCACDRP",186,0)
 Q
"RTN","PRCADR2")
0^19^B17441606^B16711783
"RTN","PRCADR2",1,0)
PRCADR2 ;SF-ISC/YJK-PRINT ADDRESS,TRANS.,BALANCE ;3/19/97  3:19 PM
"RTN","PRCADR2",2,0)
V ;;4.5;Accounts Receivable;**45,104,108,149,141,172,241,233,263,301,350**;Mar 20, 1995;Build 66
"RTN","PRCADR2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCADR2",4,0)
 ;print debtor's /3rd party address,transaction,balances.
"RTN","PRCADR2",5,0)
 N RCDMC,RCTOP
"RTN","PRCADR2",6,0)
WR1 W !!,$P(PRCAGL,U,1),?39,"SOC.SEC.NO.: ",?55,PRCASSN
"RTN","PRCADR2",7,0)
 W:$P(PRCAGL,U,2)'="" !,$P(PRCAGL,U,2)
"RTN","PRCADR2",8,0)
 W !,$P(PRCAGL,U,4),", ",PRCASTE,"  ",$P(PRCAGL,U,6),?39,"DATE OF BIRTH: ",?55,PRCADOB,!,"PHONE NO.: ",$P(PRCAGL,U,9),?39,"DATE POSTED: " S Y=$P($G(^PRCA(430,D0,6)),"^",21) W:'Y "N/A" I Y D DD^%DT W $P(Y,"@")," ",$P(Y,"@",2)
"RTN","PRCADR2",9,0)
 I $G(RCKAT) W !,"EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA"
"RTN","PRCADR2",10,0)
 I $G(RCDMC) W !,"****Debtor's Account Forwarded To DMC****"
"RTN","PRCADR2",11,0)
 I $G(RCTOP) W !,"****Debtor's Account Forwarded To TOP****"
"RTN","PRCADR2",12,0)
 ;PRCA*4.5*350
"RTN","PRCADR2",13,0)
 I $G(RCTCSP) W !,"****Debt ",$S($$RRD^RCTCSPU(Z0):"Re-",1:""),"Referred to Cross-Servicing****"
"RTN","PRCADR2",14,0)
END1 K %,PRCADOB,PRCASSN,PRCASTE,PRCAGL,Z1,Z2,Z0
"RTN","PRCADR2",15,0)
 Q
"RTN","PRCADR2",16,0)
 ;
"RTN","PRCADR2",17,0)
 ;
"RTN","PRCADR2",18,0)
WR2 ;called by EN2^PRCADR
"RTN","PRCADR2",19,0)
 W ! S PRCAGL0=$S($D(^PRCA(433,PRCAEN,0)):^(0),1:""),PRCAG=$S($D(^PRCA(433,PRCAEN,1)):^(1),1:"") Q:(PRCAG="")!(PRCAGL0="")
"RTN","PRCADR2",20,0)
 S PRCATD=$P(PRCAG,U,1),PRCATY=$P(PRCAG,U,2) Q:'$D(^PRCA(430.3,+PRCATY,0))  S PRCATYPE=$P(^(0),U,3) W ?1,$S($P(PRCAGL0,U,10):"*",1:""),?2,+PRCAGL0
"RTN","PRCADR2",21,0)
 I $P(PRCAG,U,3)="" D
"RTN","PRCADR2",22,0)
 .W:PRCATYPE=17 ?12,$P($G(^PRCA(433,PRCAEN,5)),"^",2)
"RTN","PRCADR2",23,0)
 .W:(PRCATYPE=1)!(PRCATYPE=21) ?12,$P(PRCAG,U,4)
"RTN","PRCADR2",24,0)
 I $P(PRCAG,U,3)'="" W ?12,$P(PRCAG,U,3)
"RTN","PRCADR2",25,0)
 S:(PRCATYPE=8)!((PRCATYPE=9)!(PRCATYPE=10)) PRCA("WROFF")=PRCAEN
"RTN","PRCADR2",26,0)
 W:PRCATY?1N.N&(PRCATYPE'=17) ?22,$P(^PRCA(430.3,PRCATY,0),U,1) I (PRCATYPE=2)!(PRCATYPE=20),$P(^PRCA(433,PRCAEN,0),U,7)]"" W "(",$P(^(0),U,7),")"
"RTN","PRCADR2",27,0)
 S Y=PRCATD D DD^%DT S Y(1)=$P(Y,", ",2)
"RTN","PRCADR2",28,0)
 S PRCATD=$E(PRCATD,4,5)_"/"_$E(PRCATD,6,7)_"/"_$E(Y(1),3,4)  ;trans date
"RTN","PRCADR2",29,0)
 ;  if a decrease adjustment, show as negative (patch 4.5*172)
"RTN","PRCADR2",30,0)
 I $P(PRCAG,"^",2)=35,$P(PRCAG,"^",5)>0 S $P(PRCAG,"^",5)=-$P(PRCAG,"^",5)
"RTN","PRCADR2",31,0)
 W ?47,PRCATD,?57,$J($P(PRCAG,U,5),11,2) W:+$P(PRCAGL0,U,4)<2 ?67,"INCOMPLETE"
"RTN","PRCADR2",32,0)
END2 K PRCAG,PRCATD,PRCATY,PRCATYPE,PRCAGL0
"RTN","PRCADR2",33,0)
 Q  ;end of WR2
"RTN","PRCADR2",34,0)
 ;
"RTN","PRCADR2",35,0)
 ;
"RTN","PRCADR2",36,0)
WR3 W !,?18,"BALANCES",?31,"PAID"
"RTN","PRCADR2",37,0)
 W !,?44,"LETTER1/ICD:",?58,PRCAL(1)
"RTN","PRCADR2",38,0)
 W !,"PRINCIPAL:",?16,$J(PRCAK("PB"),10,2),?26,$J(PRCAK("PP"),9,2),?44,"LETTER2:",?58,PRCAL(2)
"RTN","PRCADR2",39,0)
 W !,"INTEREST:",?16,$J(PRCAK("IB"),10,2),?26,$J(PRCAK("IP"),9,2),?44,"LETTER3:",?58,PRCAL(3)
"RTN","PRCADR2",40,0)
 W !,"ADMINISTRATIVE:",?16,$J(PRCAK("AB"),10,2),?26,$J(PRCAK("AP"),9,2),?44,"IRS LETTER:",?58,PRCAL(6)
"RTN","PRCADR2",41,0)
 W ! W:PRCAK("MF")>0 "MARSHAL FEE:",?16,$J(PRCAK("MF"),10,2),?26,$J(0,9,2) W ?44,PRCACODE_" REF.DATE:",?62,PRCAL(4)
"RTN","PRCADR2",42,0)
 W:PRCAK("CC")>0 !,"COURT COST:",?16,$J(PRCAK("CC"),10,2),?26,$J(0,9,2)
"RTN","PRCADR2",43,0)
 W !,"CURRENT:",?16,$J(PRCAK("PB")+PRCAK("IB")+PRCAK("AB")+PRCAK("MF")+PRCAK("CC"),10,2),?26,$J(PRCAK("PP")+PRCAK("AP")+PRCAK("IP"),9,2)
"RTN","PRCADR2",44,0)
 K PRCAL I $D(^PRCA(430,D0,6)) S PRCAL=^(6) I $P(PRCAL,"^",15)]"" W !!,"     Date forwarded to IRS: " S Y=$P(PRCAL,"^",15) D DD^%DT W Y
"RTN","PRCADR2",45,0)
 I $D(PRCAL),$P(PRCAL,"^",16)]"" W !,"Prin/Int/Admin IRS balance: " F X=16:1:18 W +$P(PRCAL,"^",X),"/"
"RTN","PRCADR2",46,0)
 K PRCAL I $G(^PRCA(430,D0,12)) S PRCAL=^(12) I $P(PRCAL,U)]"" W !!,"     Date forwarded to DMC: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",47,0)
 I $D(PRCAL),$P(PRCAL,U,2)]"" W !,"Prin/Int/Admin DMC balance: " F X=2:1:4 W +$P(PRCAL,U,X),"/"
"RTN","PRCADR2",48,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),3)),"^",9)'="" W !,"Lesser Withhold Amt to DMC: ",$J($P(^(3),"^",9),0,2)
"RTN","PRCADR2",49,0)
 K PRCAL I $G(^PRCA(430,D0,14)) S PRCAL=^(14) I $P(PRCAL,U)]"" W !!,"Date forwarded to TOP: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",50,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),6)),"^",6)'="" W !,"TOP Hold Date:  " S Y=$P(^(6),"^",6) D DD^%DT W Y
"RTN","PRCADR2",51,0)
 ;PRCA*4.5*350
"RTN","PRCADR2",52,0)
 I $G(^PRCA(430,D0,15)) S PRCAL=^(15) I $P(PRCAL,U)]"" W !!,"CS " W:$$RR^RCTCSPU(D0) "Re-" W "Referred Date: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",53,0)
END3 K PRCAL,PRCACODE,PRCALT,PRCAK,PRCAGL6,PRCAGL7 Q
"RTN","RCDPAPLI")
0^14^B54815509^B53951998
"RTN","RCDPAPLI",1,0)
RCDPAPLI ;WISC/RFJ-account profile top list manager init ;1 Jun 99
"RTN","RCDPAPLI",2,0)
 ;;4.5;Accounts Receivable;**114,141,241,303,301,315,350**;Mar 20, 1995;Build 66
"RTN","RCDPAPLI",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPAPLI",4,0)
 Q
"RTN","RCDPAPLI",5,0)
 ;
"RTN","RCDPAPLI",6,0)
INIT ;  init for list manager screen
"RTN","RCDPAPLI",7,0)
 N DMCDATA,RCBILLDA,RCCOMM,RCDATA,RCDATE,RCLINE,RCSTATDA,RCTOTAL
"RTN","RCDPAPLI",8,0)
 N TOP4,TOP6
"RTN","RCDPAPLI",9,0)
 K ^TMP("RCDPAPLM",$J),^TMP("RCDPAPLMX",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPAPLI",10,0)
 ;
"RTN","RCDPAPLI",11,0)
 ;  fast exit
"RTN","RCDPAPLI",12,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPAPLI",13,0)
 ;
"RTN","RCDPAPLI",14,0)
 I '$G(RCDEBTDA) D  Q
"RTN","RCDPAPLI",15,0)
 .   D SET("",1,1,80)
"RTN","RCDPAPLI",16,0)
 .   D SET("*****  Select an ACCOUNT  *****",2,1,80)
"RTN","RCDPAPLI",17,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",18,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",19,0)
 ;
"RTN","RCDPAPLI",20,0)
 ;  get bills for a debtor
"RTN","RCDPAPLI",21,0)
 D GETBILLS^RCDPAPST(RCDEBTDA)
"RTN","RCDPAPLI",22,0)
 ;
"RTN","RCDPAPLI",23,0)
 I '$O(^TMP("RCDPAPST",$J,0)) D  Q
"RTN","RCDPAPLI",24,0)
 .   D SET("",1,1,80,IORVOFF,IORVOFF)
"RTN","RCDPAPLI",25,0)
 .   D SET("  *****  Account does not have any bills *****",2,1,80)
"RTN","RCDPAPLI",26,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",27,0)
 .   S RCTOTAL(1)=0
"RTN","RCDPAPLI",28,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",29,0)
 ;
"RTN","RCDPAPLI",30,0)
 ;  set the listmanager line number
"RTN","RCDPAPLI",31,0)
 S RCLINE=0
"RTN","RCDPAPLI",32,0)
 ;
"RTN","RCDPAPLI",33,0)
 S RCDATE=9999999 F  S RCDATE=$O(^TMP("RCDPAPST",$J,RCDATE),-1) Q:'RCDATE  D
"RTN","RCDPAPLI",34,0)
 .   S RCSTATDA=0 F  S RCSTATDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA)) Q:'RCSTATDA  D
"RTN","RCDPAPLI",35,0)
 .   .   S RCBILLDA=0 F  S RCBILLDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCDPAPLI",36,0)
 .   .   .   S RCDATA=^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)
"RTN","RCDPAPLI",37,0)
 .   .   .   ;  add up dollars owed by account (all bills)
"RTN","RCDPAPLI",38,0)
 .   .   .   S RCTOTAL(1)=$G(RCTOTAL(1))+$P(RCDATA,"^")
"RTN","RCDPAPLI",39,0)
 .   .   .   S RCTOTAL(2)=$G(RCTOTAL(2))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",40,0)
 .   .   .   S RCTOTAL(3)=$G(RCTOTAL(3))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",41,0)
 .   .   .   ;
"RTN","RCDPAPLI",42,0)
 .   .   .   ;  if not a selected status, do not display
"RTN","RCDPAPLI",43,0)
 .   .   .   I ("^"_$G(^DISV(DUZ,"RCDPAPLM","STATUS"))_"^")'[("^"_RCSTATDA_"^") Q
"RTN","RCDPAPLI",44,0)
 .   .   .   ;
"RTN","RCDPAPLI",45,0)
 .   .   .   ;  display the bill in listmanager if the status selected
"RTN","RCDPAPLI",46,0)
 .   .   .   D SETBILL
"RTN","RCDPAPLI",47,0)
 .   .   .   ;
"RTN","RCDPAPLI",48,0)
 .   .   .   ;  add up dollars owed by account (bills displayed)
"RTN","RCDPAPLI",49,0)
 .   .   .   S RCTOTAL(4)=$G(RCTOTAL(4))+$P(RCDATA,"^")
"RTN","RCDPAPLI",50,0)
 .   .   .   S RCTOTAL(5)=$G(RCTOTAL(5))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",51,0)
 .   .   .   S RCTOTAL(6)=$G(RCTOTAL(6))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",52,0)
 ;
"RTN","RCDPAPLI",53,0)
 ;  show totals of all bills displayed in listmanager
"RTN","RCDPAPLI",54,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",55,0)
 D SET("                                                    --------- -------- --------",RCLINE,1,80)
"RTN","RCDPAPLI",56,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",57,0)
 D SET("   TOTAL BALANCE OWED FOR ALL BILLS DISPLAYED",RCLINE,1,80)
"RTN","RCDPAPLI",58,0)
 D SET($J($G(RCTOTAL(4)),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",59,0)
 D SET($J($G(RCTOTAL(5)),9,2),RCLINE,62,71)
"RTN","RCDPAPLI",60,0)
 D SET($J($G(RCTOTAL(6)),9,2),RCLINE,71,80)
"RTN","RCDPAPLI",61,0)
 ;
"RTN","RCDPAPLI",62,0)
 ;  get the pending payments for the debtor
"RTN","RCDPAPLI",63,0)
 S RCTOTAL("PP")=$$PENDPAY^RCDPURET($P(^RCD(340,RCDEBTDA,0),"^"))
"RTN","RCDPAPLI",64,0)
 I $O(^TMP($J,"RCDPUREC","PP",0)) D
"RTN","RCDPAPLI",65,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",66,0)
 .   S RCLINE=RCLINE+1 D SET("Pending Payments",RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",67,0)
 .   N %,DATA,DATE,RECEIPT,RECTDA,TRANDA,TYPE
"RTN","RCDPAPLI",68,0)
 .   S RECTDA=0 F  S RECTDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA)) Q:'RECTDA  D
"RTN","RCDPAPLI",69,0)
 .   .   S RECEIPT=$P($G(^RCY(344,RECTDA,0)),"^")
"RTN","RCDPAPLI",70,0)
 .   .   S TYPE=$E($P($G(^RC(341.1,+$P(^RCY(344,RECTDA,0),"^",4),0)),"^"),1,14)
"RTN","RCDPAPLI",71,0)
 .   .   S TRANDA=0 F  S TRANDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)) Q:'TRANDA  D
"RTN","RCDPAPLI",72,0)
 .   .   .   S DATA=^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)
"RTN","RCDPAPLI",73,0)
 .   .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",74,0)
 .   .   .   D SET(RECEIPT_"/"_TRANDA,RCLINE,1,80)
"RTN","RCDPAPLI",75,0)
 .   .   .   S DATE=$P(DATA,"^",6)
"RTN","RCDPAPLI",76,0)
 .   .   .   S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",77,0)
 .   .   .   D SET(DATE,RCLINE,13,21)
"RTN","RCDPAPLI",78,0)
 .   .   .   ;  build type of payment display
"RTN","RCDPAPLI",79,0)
 .   .   .   S %=$E(TYPE_"              ",1,14)
"RTN","RCDPAPLI",80,0)
 .   .   .   I $P(DATA,"^",7)'="" S %=%_"/"_$P(DATA,"^",7)  ;  check #
"RTN","RCDPAPLI",81,0)
 .   .   .   I $P(DATA,"^",8)'="" S %=%_"/"_$P(DATA,"^",8)  ;  bank #
"RTN","RCDPAPLI",82,0)
 .   .   .   I $P(DATA,"^",2)'="" S %=%_"/"_$P(DATA,"^",2)  ;  confirmation
"RTN","RCDPAPLI",83,0)
 .   .   .   D SET(%,RCLINE,29,53)
"RTN","RCDPAPLI",84,0)
 .   .   .   ;  show amount paid
"RTN","RCDPAPLI",85,0)
 .   .   .   D SET($J($P(DATA,"^",4),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",86,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",87,0)
 .   D SET("                                                    ---------",RCLINE,1,80)
"RTN","RCDPAPLI",88,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",89,0)
 .   D SET("   TOTAL PENDING PAYMENTS",RCLINE,1,80)
"RTN","RCDPAPLI",90,0)
 .   D SET($J($G(RCTOTAL("PP")),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",91,0)
 .   K ^TMP($J,"RCDPUREC","PP")
"RTN","RCDPAPLI",92,0)
 ;
"RTN","RCDPAPLI",93,0)
 ;  dmc info
"RTN","RCDPAPLI",94,0)
 I $D(^RCD(340,"DMC",1,+RCDEBTDA)) D
"RTN","RCDPAPLI",95,0)
 .   S DMCDATA=$G(^RCD(340,+RCDEBTDA,3))
"RTN","RCDPAPLI",96,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",97,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",98,0)
 .   D SET("** Account forwarded to DMC: "_$S('$P(DMCDATA,"^",2):"",1:$$SLH^RCFN01($P(DMCDATA,"^",2))),RCLINE,1,80)
"RTN","RCDPAPLI",99,0)
 .   D SET("Total DMC Amount: "_$J($P(DMCDATA,"^",5),9,2),RCLINE,50,80)
"RTN","RCDPAPLI",100,0)
 .   I $P(DMCDATA,"^",9)'="" D
"RTN","RCDPAPLI",101,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",102,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",103,0)
 .   .   D SET("Lesser Amt to DMC: "_$J($P(DMCDATA,"^",9),9,2),RCLINE,49,80)
"RTN","RCDPAPLI",104,0)
 ;   top info
"RTN","RCDPAPLI",105,0)
 I $D(^RCD(340,"TOP",+RCDEBTDA)) D
"RTN","RCDPAPLI",106,0)
 .   S TOP6=$G(^RCD(340,+RCDEBTDA,6)),TOP4=$G(^(4))
"RTN","RCDPAPLI",107,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",108,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",109,0)
 .   D SET("** Account forwarded to TOP: "_$S('$P(TOP6,"^"):"",1:$$SLH^RCFN01($P(TOP6,"^"))),RCLINE,1,80)
"RTN","RCDPAPLI",110,0)
 .   D SET("Total TOP Amount: "_$J($P(TOP4,"^",3),13,2),RCLINE,45,80)
"RTN","RCDPAPLI",111,0)
 .   I $P(TOP6,"^",6)'="" D
"RTN","RCDPAPLI",112,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",113,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",114,0)
 .   .   D SET("TOP Hold Date: "_$$SLH^RCFN01($P(TOP6,"^",6)),RCLINE,45,80)
"RTN","RCDPAPLI",115,0)
 ;
"RTN","RCDPAPLI",116,0)
 ;   cross-servicing info
"RTN","RCDPAPLI",117,0)
 I $D(^RCD(340,"TCSP",+RCDEBTDA)) D
"RTN","RCDPAPLI",118,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",119,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",120,0)
 .   ; PRCA*4.5*350
"RTN","RCDPAPLI",121,0)
 .   D SET^RCDPBPLM("Debt "_$S($$RRD^RCTCSPU(+RCDEBTDA):"Re-",1:"")_"Referred to Cross-Servicing",RCLINE,1,80)
"RTN","RCDPAPLI",122,0)
 .   D SET("Total CS Debt: "_$J($$TOTALB^RCTCSPU(+RCDEBTDA),13,2),RCLINE,45,80)
"RTN","RCDPAPLI",123,0)
 ;
"RTN","RCDPAPLI",124,0)
 ;  show if hurricane katrina vet
"RTN","RCDPAPLI",125,0)
 I $P(^RCD(340,+RCDEBTDA,0),U)["DPT(" S DFN=+^(0) D
"RTN","RCDPAPLI",126,0)
 .   Q:$$EMGRES^DGUTL(DFN)'["K"
"RTN","RCDPAPLI",127,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",128,0)
 .   D SET("EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA",RCLINE,1,80)
"RTN","RCDPAPLI",129,0)
 ;
"RTN","RCDPAPLI",130,0)
 ;  show comments if they exist
"RTN","RCDPAPLI",131,0)
 I $O(^RCD(340,RCDEBTDA,2,0)) D
"RTN","RCDPAPLI",132,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",133,0)
 .   S RCLINE=RCLINE+1 D SET("Comments",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPAPLI",134,0)
 .   S RCCOMM=0 F  S RCCOMM=$O(^RCD(340,RCDEBTDA,2,RCCOMM)) Q:'RCCOMM  D
"RTN","RCDPAPLI",135,0)
 .   .   S RCLINE=RCLINE+1 D SET(^RCD(340,RCDEBTDA,2,RCCOMM,0),RCLINE,1,80)
"RTN","RCDPAPLI",136,0)
 ;
"RTN","RCDPAPLI",137,0)
 K ^TMP("RCDPAPST",$J)
"RTN","RCDPAPLI",138,0)
 ;
"RTN","RCDPAPLI",139,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPAPLI",140,0)
 S VALMCNT=RCLINE
"RTN","RCDPAPLI",141,0)
 D HDR^RCDPAPLM
"RTN","RCDPAPLI",142,0)
 Q
"RTN","RCDPAPLI",143,0)
 ;
"RTN","RCDPAPLI",144,0)
 ;
"RTN","RCDPAPLI",145,0)
SETBILL ;  set a bill on the listmanager line
"RTN","RCDPAPLI",146,0)
 N DATE,IBCNDATA,RCDPDATA,REJECT,VALUE
"RTN","RCDPAPLI",147,0)
 D DIQ430^RCDPBPLM(RCBILLDA,".01;2;3;8;60;")
"RTN","RCDPAPLI",148,0)
 ;
"RTN","RCDPAPLI",149,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",150,0)
 ;
"RTN","RCDPAPLI",151,0)
 ;  create an index array for bill lookup in list
"RTN","RCDPAPLI",152,0)
 S ^TMP("RCDPAPLM",$J,"IDX",RCLINE,RCLINE)=RCBILLDA
"RTN","RCDPAPLI",153,0)
 ;
"RTN","RCDPAPLI",154,0)
 ;  bill number
"RTN","RCDPAPLI",155,0)
 ;PRCA*4.5*303 - add reject indicator to kbill ; IA# 6060
"RTN","RCDPAPLI",156,0)
 S REJECT=$$BILLREJ^IBJTU6($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2))
"RTN","RCDPAPLI",157,0)
 D SET(RCLINE,RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",158,0)
 D SET($S(REJECT:"c",1:"")_$E($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2)_"       ",1,7),RCLINE,7,14,0) ;PRCA*3.5*315 increase left margin
"RTN","RCDPAPLI",159,0)
 ;PRCA*4.5*303 - End
"RTN","RCDPAPLI",160,0)
 ;
"RTN","RCDPAPLI",161,0)
 ; PRCA*4.5*315 - add "x" or "y" indicator to kbill
"RTN","RCDPAPLI",162,0)
 N CSDATE1,CSDATE2,RCIND
"RTN","RCDPAPLI",163,0)
 S CSDATE1=$$GET1^DIQ(430,RCBILLDA,"DATE BILL REFERRED TO TCSP","I")
"RTN","RCDPAPLI",164,0)
 S CSDATE2=$$GET1^DIQ(430,RCBILLDA,"ORIGINAL DATE REFERRED TO TCSP","I")
"RTN","RCDPAPLI",165,0)
 D SET(RCLINE,RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",166,0)
 S RCIND=$S(CSDATE1'="":"x",CSDATE2'="":"y",1:"")
"RTN","RCDPAPLI",167,0)
 I RCIND]"" D SET(RCIND_$E($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2)_"       ",1,7),RCLINE,7,15,0)
"RTN","RCDPAPLI",168,0)
 I RCIND="" D SET(RCIND_$E($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2)_"       ",1,7),RCLINE,8,15,0)
"RTN","RCDPAPLI",169,0)
 ;PRCA*4.5*315 End
"RTN","RCDPAPLI",170,0)
 ;
"RTN","RCDPAPLI",171,0)
 ;  get date of care
"RTN","RCDPAPLI",172,0)
 D DIQ399^RCXFMSUR(RCBILLDA)
"RTN","RCDPAPLI",173,0)
 S DATE=$G(IBCNDATA(399,RCBILLDA,151,"I"))
"RTN","RCDPAPLI",174,0)
 I 'DATE S DATE=$G(RCDPDATA(430,RCBILLDA,60,"I"))
"RTN","RCDPAPLI",175,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",176,0)
 ;D SET(DATE,RCLINE,13,21,0)
"RTN","RCDPAPLI",177,0)
 D SET(DATE,RCLINE,17,24,0) ;PRCA*4.5*315
"RTN","RCDPAPLI",178,0)
 ;
"RTN","RCDPAPLI",179,0)
 ;  status (field 8)
"RTN","RCDPAPLI",180,0)
 ;D SET("",RCLINE,23,26,8)
"RTN","RCDPAPLI",181,0)
 D SET("",RCLINE,27,30,8) ;PRCA*4.5*315
"RTN","RCDPAPLI",182,0)
 ;
"RTN","RCDPAPLI",183,0)
 ;  type of care
"RTN","RCDPAPLI",184,0)
 ;D SET("",RCLINE,29,71,2)
"RTN","RCDPAPLI",185,0)
 D SET("",RCLINE,33,53,2) ;PRCA*4.5*315
"RTN","RCDPAPLI",186,0)
 ;
"RTN","RCDPAPLI",187,0)
 ;  principle, interest, admin
"RTN","RCDPAPLI",188,0)
 D SET($J($P(RCDATA,"^"),9,2),RCLINE,53,62,0)
"RTN","RCDPAPLI",189,0)
 D SET($J($P(RCDATA,"^",2),9,2),RCLINE,62,71,0)
"RTN","RCDPAPLI",190,0)
 D SET($J($P(RCDATA,"^",3),9,2),RCLINE,71,80,0)
"RTN","RCDPAPLI",191,0)
 Q
"RTN","RCDPAPLI",192,0)
 ;
"RTN","RCDPAPLI",193,0)
 ;
"RTN","RCDPAPLI",194,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPAPLI",195,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPAPLI",196,0)
 I STRING="",'$G(FIELD) D SET^VALM10(LINE,$J("",80)) Q
"RTN","RCDPAPLI",197,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPAPLI",198,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPAPLI",199,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPAPLI",200,0)
 Q
"RTN","RCDPBPLI")
0^15^B62077886^B60001669
"RTN","RCDPBPLI",1,0)
RCDPBPLI ;WISC/RFJ-bill profile (build array cont employee/vendor) ;1 Jun 99
"RTN","RCDPBPLI",2,0)
 ;;4.5;Accounts Receivable;**114,153,301,315,350**;Mar 20, 1995;Build 66
"RTN","RCDPBPLI",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPBPLI",4,0)
 ;
"RTN","RCDPBPLI",5,0)
 Q
"RTN","RCDPBPLI",6,0)
 ;
"RTN","RCDPBPLI",7,0)
 ;
"RTN","RCDPBPLI",8,0)
INIT ;  initialization for list manager list
"RTN","RCDPBPLI",9,0)
 ;  report type for employee or vendor, show description field 106
"RTN","RCDPBPLI",10,0)
 N COMMDA,DATA,DESCDA,TEXT
"RTN","RCDPBPLI",11,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",12,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Date    ",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",13,0)
 D SET^RCDPBPLM("Description",RCLINE,12,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",14,0)
 D SET^RCDPBPLM("Quantity",RCLINE,35,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",15,0)
 D SET^RCDPBPLM("Units",RCLINE,46,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",16,0)
 D SET^RCDPBPLM("Cost",RCLINE,54,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",17,0)
 D SET^RCDPBPLM("Total Cost",RCLINE,64,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",18,0)
 S DESCDA=0 F  S DESCDA=$O(^PRCA(430,RCBILLDA,101,DESCDA)) Q:'DESCDA  D
"RTN","RCDPBPLI",19,0)
 .   S DATA=$G(^PRCA(430,RCBILLDA,101,DESCDA,0)) I DATA="" Q
"RTN","RCDPBPLI",20,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPBPLI",21,0)
 .   D SET^RCDPBPLM($E($P(DATA,U),4,5)_"/"_$E($P(DATA,U),6,7)_"/"_$E($P(DATA,U),2,3),RCLINE,1,80)
"RTN","RCDPBPLI",22,0)
 .   D SET^RCDPBPLM($J($P(DATA,U,3),8,2),RCLINE,35,80)
"RTN","RCDPBPLI",23,0)
 .   D SET^RCDPBPLM($J($P($G(^PRCD(420.5,+$P(DATA,U,5),0)),U),5),RCLINE,46,80)
"RTN","RCDPBPLI",24,0)
 .   D SET^RCDPBPLM($J($P(DATA,U,4),0,4),RCLINE,54,80)
"RTN","RCDPBPLI",25,0)
 .   D SET^RCDPBPLM($J($P(DATA,U,6),10,2),RCLINE,64,80)
"RTN","RCDPBPLI",26,0)
 .   ;  show description
"RTN","RCDPBPLI",27,0)
 .   S DATA=""
"RTN","RCDPBPLI",28,0)
 .   S COMMDA=0 F  S COMMDA=$O(^PRCA(430,RCBILLDA,101,DESCDA,1,COMMDA)) Q:'COMMDA  D
"RTN","RCDPBPLI",29,0)
 .   .   S TEXT=$G(^PRCA(430,RCBILLDA,101,DESCDA,1,COMMDA,0)) I TEXT="" Q
"RTN","RCDPBPLI",30,0)
 .   .   I $L(DATA_TEXT)>240 D SETDESC(11)
"RTN","RCDPBPLI",31,0)
 .   .   S DATA=DATA_$S(DATA="":"",1:" ")_TEXT
"RTN","RCDPBPLI",32,0)
 .   I DATA'="" D SETDESC(11)
"RTN","RCDPBPLI",33,0)
 .   ;  make sure all data is processed
"RTN","RCDPBPLI",34,0)
 .   I DATA'="" D SETDESC(11)
"RTN","RCDPBPLI",35,0)
 Q
"RTN","RCDPBPLI",36,0)
 ;
"RTN","RCDPBPLI",37,0)
 ;
"RTN","RCDPBPLI",38,0)
SETDESC(STARTCOL) ;  set the description line starting in column startcol+1
"RTN","RCDPBPLI",39,0)
 N %,LENGTH,SPACE
"RTN","RCDPBPLI",40,0)
 S LENGTH=80-STARTCOL-1
"RTN","RCDPBPLI",41,0)
 S SPACE="",$P(SPACE," ",80)=""
"RTN","RCDPBPLI",42,0)
 ;  break text at space if possible
"RTN","RCDPBPLI",43,0)
 I $L(DATA)>LENGTH D
"RTN","RCDPBPLI",44,0)
 .   F %=LENGTH-1:-1:0 Q:$E(DATA,%)=" "
"RTN","RCDPBPLI",45,0)
 .   I % S LENGTH=%
"RTN","RCDPBPLI",46,0)
 ;  set line
"RTN","RCDPBPLI",47,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM($E(SPACE,1,STARTCOL)_$E(DATA,1,LENGTH),RCLINE,1,80)
"RTN","RCDPBPLI",48,0)
 S DATA=$E(DATA,LENGTH+1,255)
"RTN","RCDPBPLI",49,0)
 I $L(DATA)>LENGTH D SETDESC(STARTCOL)
"RTN","RCDPBPLI",50,0)
 Q
"RTN","RCDPBPLI",51,0)
 ;
"RTN","RCDPBPLI",52,0)
 ;
"RTN","RCDPBPLI",53,0)
TRANINIT ;  initialization for transaction and ib data display
"RTN","RCDPBPLI",54,0)
 N BILLCAT,DATA,IBDA,RCDATE,RCLIST,RCTOTAL,RCTRANDA,X
"RTN","RCDPBPLI",55,0)
 ;  get the bill category
"RTN","RCDPBPLI",56,0)
 S BILLCAT=$P($G(^PRCA(430,RCBILLDA,0)),U,2)
"RTN","RCDPBPLI",57,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",58,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",59,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Trans    Date      Type                Amount  Description                  User",RCLINE,1,80,0,IOUON,IOUOFF)  ;PRCA*4.5*315 Display User Ini
"RTN","RCDPBPLI",60,0)
 S RCTOTAL=$$GETTRANS^RCDPBTLM(RCBILLDA)
"RTN","RCDPBPLI",61,0)
 S RCDATE=0 F  S RCDATE=$O(RCLIST(RCDATE)) Q:'RCDATE  D
"RTN","RCDPBPLI",62,0)
 .   S RCTRANDA=0 F  S RCTRANDA=$O(RCLIST(RCDATE,RCTRANDA)) Q:'RCTRANDA  D
"RTN","RCDPBPLI",63,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPBPLI",64,0)
 .   .   D SET^RCDPBPLM(RCTRANDA,RCLINE,1,80)
"RTN","RCDPBPLI",65,0)
 .   .   D SET^RCDPBPLM($E(RCDATE,4,5)_"/"_$E(RCDATE,6,7)_"/"_$E(RCDATE,2,3),RCLINE,10,20)
"RTN","RCDPBPLI",66,0)
 .   .   D SET^RCDPBPLM($E($P(RCLIST(RCDATE,RCTRANDA),U),1,14),RCLINE,20,34)  ;PRCA*4.5*315
"RTN","RCDPBPLI",67,0)
 .   .   S X=$P(RCLIST(RCDATE,RCTRANDA),U,2)+$P(RCLIST(RCDATE,RCTRANDA),U,3)+$P(RCLIST(RCDATE,RCTRANDA),U,4)+$P(RCLIST(RCDATE,RCTRANDA),U,5)+$P(RCLIST(RCDATE,RCTRANDA),U,6)
"RTN","RCDPBPLI",68,0)
 .   .   D SET^RCDPBPLM($J(X,10,2),RCLINE,36,75)  ;PRCA*4.5*315
"RTN","RCDPBPLI",69,0)
 .   .   S X=$P(RCLIST(RCDATE,RCTRANDA),U,7)  ;PRCA*4.5*315
"RTN","RCDPBPLI",70,0)
 .   .   D SET^RCDPBPLM(X,RCLINE,77,80)  ;PRCA*4.5*315
"RTN","RCDPBPLI",71,0)
 .   .   ;
"RTN","RCDPBPLI",72,0)
 .   .   ;  for category c-means test, rx copay (sc/nsc)
"RTN","RCDPBPLI",73,0)
 .   .   I BILLCAT=18!(BILLCAT=22)!(BILLCAT=23) D
"RTN","RCDPBPLI",74,0)
 .   .   .   D STMT^IBRFN1(RCTRANDA)
"RTN","RCDPBPLI",75,0)
 .   .   .   I '$D(^TMP("IBRFN1",$J)) Q
"RTN","RCDPBPLI",76,0)
 .   .   .   S IBDA=0 F  S IBDA=$O(^TMP("IBRFN1",$J,IBDA)) Q:'IBDA  D
"RTN","RCDPBPLI",77,0)
 .   .   .   .   S DATA=^TMP("IBRFN1",$J,IBDA)
"RTN","RCDPBPLI",78,0)
 .   .   .   .   ;  show rx
"RTN","RCDPBPLI",79,0)
 .   .   .   .   I BILLCAT=22!(BILLCAT=23) D  Q
"RTN","RCDPBPLI",80,0)
 .   .   .   .   .   D SET^RCDPBPLM("RX "_$P(DATA,U,2),RCLINE,48,58)  ;PRCA*4.5*315 Spacing changed next several lines
"RTN","RCDPBPLI",81,0)
 .   .   .   .   .   D SET^RCDPBPLM($P(DATA,U,3),RCLINE,60,75)
"RTN","RCDPBPLI",82,0)
 .   .   .   .   .   ; D SET^RCDPBPLM("Qty "_$P(DATA,U,6),RCLINE,77,80)
"RTN","RCDPBPLI",83,0)
 .   .   .   .   ;  show outpatient (type of care 430.2 = 4 outpatient care)
"RTN","RCDPBPLI",84,0)
 .   .   .   .   I $P(^PRCA(430,RCBILLDA,0),U,16)=4 D  Q
"RTN","RCDPBPLI",85,0)
 .   .   .   .   .   D SET^RCDPBPLM("Outpatient Visit Date: "_$E($P(DATA,U,2),4,5)_"/"_$E($P(DATA,U,2),6,7)_"/"_$E($P(DATA,U,2),2,3),RCLINE,48,80)
"RTN","RCDPBPLI",86,0)
 .   .   .   .   ;  show inpatient
"RTN","RCDPBPLI",87,0)
 .   .   .   .   D SET^RCDPBPLM("Inpatient Adm Date: "_$E($P(DATA,U,2),4,5)_"/"_$E($P(DATA,U,2),6,7)_"/"_$E($P(DATA,U,2),2,3),RCLINE,48,80)
"RTN","RCDPBPLI",88,0)
 .   .   .   K ^TMP("IBRFN1",$J)
"RTN","RCDPBPLI",89,0)
 Q
"RTN","RCDPBPLI",90,0)
 ;
"RTN","RCDPBPLI",91,0)
REJECT ;  ; prca*4.5*301 ; LEG
"RTN","RCDPBPLI",92,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",93,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",94,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("CS Reject Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",95,0)
 D PROFRJA^RCTCSJS1(RCBILLDA,.RCLINE,.OUTARY)
"RTN","RCDPBPLI",96,0)
 M @VALMAR=OUTARY
"RTN","RCDPBPLI",97,0)
 K OUTARY
"RTN","RCDPBPLI",98,0)
 Q
"RTN","RCDPBPLI",99,0)
 ;
"RTN","RCDPBPLI",100,0)
 ;
"RTN","RCDPBPLI",101,0)
 ;
"RTN","RCDPBPLI",102,0)
REPAY ;  show repayment plan
"RTN","RCDPBPLI",103,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",104,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Repayment Plan Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",105,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("     Repayment Plan Date",RCLINE,1,80,41)
"RTN","RCDPBPLI",106,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Day of Month Payment Due",RCLINE,1,80,42)
"RTN","RCDPBPLI",107,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("    Repayment Amount Due",RCLINE,1,80,43)
"RTN","RCDPBPLI",108,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("      Number of Payments",RCLINE,1,80,44)
"RTN","RCDPBPLI",109,0)
 Q
"RTN","RCDPBPLI",110,0)
 ;
"RTN","RCDPBPLI",111,0)
 ;
"RTN","RCDPBPLI",112,0)
IRS ;  irs data
"RTN","RCDPBPLI",113,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",114,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to IRS",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",115,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("On Date",RCLINE,40,80,68.7)
"RTN","RCDPBPLI",116,0)
 D SET^RCDPBPLM("Amount",RCLINE,65,80,68.92)
"RTN","RCDPBPLI",117,0)
 S DATA=$G(^PRCA(430,RCBILLDA,6))
"RTN","RCDPBPLI",118,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("       Principal Balance: "_$J($P(DATA,U,16),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",119,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Interest Balance: "_$J($P(DATA,U,17),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",120,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("  Administrative Balance: "_$J($P(DATA,U,18),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",121,0)
 Q
"RTN","RCDPBPLI",122,0)
 ;
"RTN","RCDPBPLI",123,0)
 ;
"RTN","RCDPBPLI",124,0)
DMC ;  dmc data
"RTN","RCDPBPLI",125,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",126,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to DMC",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",127,0)
 D SET^RCDPBPLM("On Date",RCLINE,40,80,121)
"RTN","RCDPBPLI",128,0)
 S DATA=$G(^PRCA(430,RCBILLDA,12))
"RTN","RCDPBPLI",129,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("       Principal Balance: "_$J($P(DATA,U,2),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",130,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Interest Balance: "_$J($P(DATA,U,3),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",131,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("  Administrative Balance: "_$J($P(DATA,U,4),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",132,0)
 Q
"RTN","RCDPBPLI",133,0)
 ;
"RTN","RCDPBPLI",134,0)
 ;
"RTN","RCDPBPLI",135,0)
TOP ;  top data
"RTN","RCDPBPLI",136,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",137,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to TOP",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",138,0)
 D SET^RCDPBPLM("On Date",RCLINE,40,80,141)
"RTN","RCDPBPLI",139,0)
 S DATA=$G(^RCD(340,+RCDPDATA(430,RCBILLDA,9,"I"),6))
"RTN","RCDPBPLI",140,0)
 I $P(DATA,U,6) D
"RTN","RCDPBPLI",141,0)
 .   S Y=$P(DATA,U,6) D DD^%DT
"RTN","RCDPBPLI",142,0)
 .   S RCLINE=RCLINE+1 D SET^RCDPBPLM("  TOP Hold Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLI",143,0)
 Q
"RTN","RCDPBPLI",144,0)
 ;
"RTN","RCDPBPLI",145,0)
 ;
"RTN","RCDPBPLI",146,0)
TCSP ;  cross-servicing data referral
"RTN","RCDPBPLI",147,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",148,0)
 ; PRCA*4.5*350
"RTN","RCDPBPLI",149,0)
 N DEBTOR S DEBTOR=+$G(RCDPDATA(430,RCBILLDA,9,"I"))
"RTN","RCDPBPLI",150,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Debt "_$S($$RRD^RCTCSPU($G(DEBTOR)):"Re-",1:"")_"Referred to Cross-Servicing",RCLINE,1,80)
"RTN","RCDPBPLI",151,0)
 D SET^RCDPBPLM("  CS "_$S($$RR^RCTCSPU($G(RCBILLDA)):"Re-",1:"")_"Referred Date",RCLINE,45,80,151)
"RTN","RCDPBPLI",152,0)
 Q
"RTN","RCDPBPLI",153,0)
 ;
"RTN","RCDPBPLI",154,0)
 ;
"RTN","RCDPBPLI",155,0)
TCSPRC ;  cross-servicing data recall
"RTN","RCDPBPLI",156,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",157,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("CS Recall Reason:",RCLINE,1,80)
"RTN","RCDPBPLI",158,0)
 D SET^RCDPBPLM("",RCLINE,19,80,154)
"RTN","RCDPBPLI",159,0)
 D SET^RCDPBPLM("  CS Recall Date",RCLINE,50,80,153)
"RTN","RCDPBPLI",160,0)
 Q
"RTN","RCDPBPLI",161,0)
 ;
"RTN","RCDPBPLI",162,0)
 ;
"RTN","RCDPBPLI",163,0)
INSUR ;  show insurance data
"RTN","RCDPBPLI",164,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",165,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Insurance Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",166,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("         Insured Name",RCLINE,1,80,239)
"RTN","RCDPBPLI",167,0)
 D SET^RCDPBPLM("Sex",RCLINE,50,80,240)
"RTN","RCDPBPLI",168,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("            ID Number",RCLINE,1,80,242)
"RTN","RCDPBPLI",169,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("           Group Name",RCLINE,1,80,243)
"RTN","RCDPBPLI",170,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("         Group Number",RCLINE,1,80,244)
"RTN","RCDPBPLI",171,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Employer Name",RCLINE,1,80,247)
"RTN","RCDPBPLI",172,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("   Employee ID Number",RCLINE,1,80,248)
"RTN","RCDPBPLI",173,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("    Employer Location",RCLINE,1,80,249)
"RTN","RCDPBPLI",174,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Secondary Ins Carrier",RCLINE,1,80,19)
"RTN","RCDPBPLI",175,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" Tertiary Ins Carrier",RCLINE,1,80,19.1)
"RTN","RCDPBPLI",176,0)
 Q
"RTN","RCMSITE")
0^8^B15588075^B10360113
"RTN","RCMSITE",1,0)
RCMSITE ;ALB/RRG - EDIT SITE PARAMETERS ;Jul 02, 2014@15:46:14
"RTN","RCMSITE",2,0)
V ;;4.5;Accounts Receivable;**173,236,253,298,315,350**;Mar 20, 1995;Build 66
"RTN","RCMSITE",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCMSITE",4,0)
 ;
"RTN","RCMSITE",5,0)
BEG ;Start editing site paramters
"RTN","RCMSITE",6,0)
 N DA,DIC,DIE,DLAYGO,DR,X,Y
"RTN","RCMSITE",7,0)
 ; edit SITE field (#.01) in AR SITE PARAMETER file (#342)
"RTN","RCMSITE",8,0)
 S DIC="^RC(342,",DIC(0)="QEAML",DLAYGO=342 D ^DIC I Y>0 S DA=+Y,DR=.01,DIE="^RC(342," D ^DIE
"RTN","RCMSITE",9,0)
 Q
"RTN","RCMSITE",10,0)
 ;
"RTN","RCMSITE",11,0)
ALC ;Edit ALC parameter
"RTN","RCMSITE",12,0)
 NEW DIC,DR,DA,Y
"RTN","RCMSITE",13,0)
 S DIE="^RC(342,",DA=1,DR=".07;31" D ^DIE
"RTN","RCMSITE",14,0)
 Q
"RTN","RCMSITE",15,0)
IRS ;Edit IRS OFFSET site parameters
"RTN","RCMSITE",16,0)
 NEW DIE,DR,DA,Y
"RTN","RCMSITE",17,0)
 I '$D(^RC(342,1,0)) D BEG G:'$D(^RC(342,1,0)) Q
"RTN","RCMSITE",18,0)
 S DA=1,DR="[RCMS IRS]",DIE="^RC(342," D ^DIE
"RTN","RCMSITE",19,0)
Q Q
"RTN","RCMSITE",20,0)
STAT ;Edit NOTIFICATION site parameters
"RTN","RCMSITE",21,0)
 NEW DIE,DR,DA,Y
"RTN","RCMSITE",22,0)
 I '$D(^RC(342,1,0)) D BEG G:'$D(^RC(342,1,0)) Q1
"RTN","RCMSITE",23,0)
 S DA=1,DR="[RCMS NOTIFICATION]",DIE="^RC(342," D ^DIE
"RTN","RCMSITE",24,0)
Q1 Q
"RTN","RCMSITE",25,0)
GRP ;Edit AR Group Parameters
"RTN","RCMSITE",26,0)
 NEW DIE,DR,DA,Y
"RTN","RCMSITE",27,0)
 F  W ! S DIC(0)="QEAML",DIC="^RC(342.1,",DLAYGO=342.1 D ^DIC K DIC G:Y<0 Q3 S DA=+Y,DIE="^RC(342.1,",DR=$P($G(^RC(342.2,+$P(^RC(342.1,+Y,0),"^",2),1)),"^") I DR]"" D ^DIE
"RTN","RCMSITE",28,0)
Q3 Q
"RTN","RCMSITE",29,0)
TCSP ;Edit TCSP Site enable/disable PRCA*4.5*350
"RTN","RCMSITE",30,0)
 N DIE,DR,DA,Y,A,NZ,%
"RTN","RCMSITE",31,0)
 I $O(^RC(342,1,40,0))="" W !,"**** SITE IS ACTIVATED ****" S NZ="",A=0
"RTN","RCMSITE",32,0)
 E  S A=$O(^RC(342,1,40,99999),-1),NZ=^RC(342,1,40,A,0)
"RTN","RCMSITE",33,0)
 I NZ'="" W !,"SITE IS ",$S($P(NZ,U)="S":"STOPPED",1:"REACTIVATED")," as of ",$$FMTE^XLFDT($P(NZ,U,2)\1,"5Z")," by ",$P($G(^VA(200,$P(NZ,U,3),0)),U)
"RTN","RCMSITE",34,0)
 W ! S DIR("A")="Are you sure you want to "_$S(NZ="":"stop",$P(NZ,U)="R":"stop",1:"reactivate")_" site",DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR
"RTN","RCMSITE",35,0)
 I 'Y W !!,"*** NO ACTION TAKEN ***" Q
"RTN","RCMSITE",36,0)
 D NOW^%DTC
"RTN","RCMSITE",37,0)
 S ^RC(342,1,40,A+1,0)=$S($P(NZ,U)="S":"R",1:"S")_U_%_U_DUZ
"RTN","RCMSITE",38,0)
 S ^RC(342,1,40,"B",$S($P(NZ,U)="S":"R",1:"S"),A+1)=""
"RTN","RCMSITE",39,0)
 S $P(^RC(342,1,40,0),U,2)=342.02 S $P(^RC(342,1,40,0),U,3)=A+1,$P(^RC(342,1,40,0),U,4)=$P(^RC(342,1,40,0),U,4)+1
"RTN","RCMSITE",40,0)
 W !!,"**** SITE IS NOW ",$S(NZ="":"STOPPED",$P(NZ,U)="R":"STOPPED",1:"REACTIVATED")," ****"
"RTN","RCMSITE",41,0)
 Q
"RTN","RCMSITE",42,0)
DEA ;Deactive an AR group
"RTN","RCMSITE",43,0)
 NEW DIE,DIC,DA,DR,Y,GRP
"RTN","RCMSITE",44,0)
 S DIC="^RC(342.1,",DIC(0)="QEAM",DIC("S")="I $P(^(0),""^"",2)'=7" D ^DIC Q:Y<0  S GRP=+Y
"RTN","RCMSITE",45,0)
 W ! S DIR("A")="Are you sure you want to Deactive Group '"_$P(^RC(342.1,GRP,0),"^")_"'",DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR
"RTN","RCMSITE",46,0)
 I 'Y W !!,"*** NO ACTION TAKEN ***" Q
"RTN","RCMSITE",47,0)
 I Y S DIE="^RC(342.1,",DA=GRP,DR=".02////^S X=7" D ^DIE W !!,"*** Group Deactivated ***"
"RTN","RCMSITE",48,0)
 Q
"RTN","RCMSITE",49,0)
SITE() ;Return site number
"RTN","RCMSITE",50,0)
 Q +$G(^DIC(4,+$P($G(^RC(342,1,0)),"^"),99))
"RTN","RCMSITE",51,0)
INT ;Print Inter/Admin/Pen effective report
"RTN","RCMSITE",52,0)
 NEW DIC,BY,FR,TO,FLDS,L
"RTN","RCMSITE",53,0)
 S DIC="^RC(342,",BY=.01,(FR,TO)="",FLDS="[RCMS INT/ADM/PEN]",L=0 D EN1^DIP
"RTN","RCMSITE",54,0)
 Q
"RTN","RCMSITE",55,0)
UPINT ;Update Rate site parameters
"RTN","RCMSITE",56,0)
 NEW DIE,DR,DA,Y,IOP
"RTN","RCMSITE",57,0)
 S IOP=ION D INT
"RTN","RCMSITE",58,0)
 I '$D(^XUSEC("PRCAF LATE CHARGES",DUZ)) D BMES^XPDUTL("A Security Key is required to edit the Interest/Admin and Penalty Rates.") Q  ;PRCA*4.5*315 Added Security Key
"RTN","RCMSITE",59,0)
 I '$D(^RC(342,1,0)) D BEG G:'$D(^RC(342,1,0)) Q4
"RTN","RCMSITE",60,0)
 F  W ! S DA=1,DR="[RCMS RATES]",DIE="^RC(342," D ^DIE Q:$D(Y)
"RTN","RCMSITE",61,0)
Q4 Q
"RTN","RCMSITE",62,0)
 ;
"RTN","RCMSITE",63,0)
EDILOCK() ; function, Update EDI Lockbox site parameters
"RTN","RCMSITE",64,0)
 ; returns 1 on success, else "^error message"
"RTN","RCMSITE",65,0)
 N RSLT S RSLT=""
"RTN","RCMSITE",66,0)
 I '$D(^RC(342,1,0)) D BEG
"RTN","RCMSITE",67,0)
 S:'$D(^RC(342,1,0)) RSLT="^no site defined"  ; can't continue
"RTN","RCMSITE",68,0)
 ;
"RTN","RCMSITE",69,0)
 Q:RSLT]"" RSLT
"RTN","RCMSITE",70,0)
 ;
"RTN","RCMSITE",71,0)
 N DA,DIE,DR,Y
"RTN","RCMSITE",72,0)
 S DA=1,DR="[RCMS EDI LOCKBOX]",DIE="^RC(342," D ^DIE
"RTN","RCMSITE",73,0)
 S RSLT=$S($D(Y):"^user aborted",1:1)  ; if Y remains from ^DIE call
"RTN","RCMSITE",74,0)
 ;
"RTN","RCMSITE",75,0)
 Q RSLT  ; success
"RTN","RCMSITE",76,0)
 ;
"RTN","RCMSITE",77,0)
EDITRDDT ;Update # OF DAYS FOR RD ELIG CHG RPT site parameter
"RTN","RCMSITE",78,0)
 ;This is the number of days for the Rated Disability Eligibility
"RTN","RCMSITE",79,0)
 ;Change Report to be used when the report is scheduled to be run
"RTN","RCMSITE",80,0)
 ;on a recurring basis. (Added for Hold Debt to DMC Project)
"RTN","RCMSITE",81,0)
 N DIE,DR,DA,Y
"RTN","RCMSITE",82,0)
 I '$D(^RC(342,1,0)) D BEG G:'$D(^RC(342,1,0)) Q6
"RTN","RCMSITE",83,0)
 S DA=1,DR="8.01",DIE="^RC(342," D ^DIE
"RTN","RCMSITE",84,0)
Q6 Q
"RTN","RCMSITE",85,0)
 ;
"RTN","RCMSITE",86,0)
GETRDDAY() ;Return # OF DAYS FOR RD ELIG CHG RPT site parameter
"RTN","RCMSITE",87,0)
 Q $$GET1^DIQ(342,1_",",8.01)
"RTN","RCMSITE",88,0)
 ;
"RTN","RCMSITE",89,0)
EDITRDAY ;Update NUMBER OF DAYS FOR DMC REPORTS site parameter.
"RTN","RCMSITE",90,0)
 ;This is the number of days in the past bills for episodes
"RTN","RCMSITE",91,0)
 ;of care will be included for the following reports when scheduled by
"RTN","RCMSITE",92,0)
 ;IRM to be run on a recurring basis:
"RTN","RCMSITE",93,0)
 ;   DMC Debt Validity Report
"RTN","RCMSITE",94,0)
 ;   DMC Debt Validity Management Report
"RTN","RCMSITE",95,0)
 ;   Rated Disability Eligibility Change Report
"RTN","RCMSITE",96,0)
 ;The minimum value for this field is 365 days (1 year) and the maximum
"RTN","RCMSITE",97,0)
 ;value is 3650 days (10 years). If no value is added in this field the
"RTN","RCMSITE",98,0)
 ;report will default to 365 days. (Added for Hold Debt to DMC Project)
"RTN","RCMSITE",99,0)
 N DIE,DR,DA,Y
"RTN","RCMSITE",100,0)
 I '$D(^RC(342,1,0)) D BEG G:'$D(^RC(342,1,0)) Q7
"RTN","RCMSITE",101,0)
 S DA=1,DR="8.02",DIE="^RC(342," D ^DIE
"RTN","RCMSITE",102,0)
Q7 Q
"RTN","RCMSITE",103,0)
 ;
"RTN","RCMSITE",104,0)
GETRDAY() ;Return NUMBER OF DAYS FOR DMC REPORTS site parameter
"RTN","RCMSITE",105,0)
 Q $$GET1^DIQ(342,1_",",8.02)
"RTN","RCMSITE",106,0)
 ;
"RTN","RCTCS1")
0^11^B35389559^n/a
"RTN","RCTCS1",1,0)
RCTCS1 ;HAF/ASF-CROSS-SERVICING S/R ;03/17/19 3:34 PM
"RTN","RCTCS1",2,0)
 ;;4.5;Accounts Receivable;**350**;Mar 26, 2019;Build 66
"RTN","RCTCS1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCS1",4,0)
 Q
"RTN","RCTCS1",5,0)
 ;
"RTN","RCTCS1",6,0)
EN ;entry
"RTN","RCTCS1",7,0)
 N %,BILLN,CBAL,CNT,CSTAT,DA,DIC,DIK,DNAME,G1,GOTBILL,HDR1,LASTDT,LASTIEN,LSUB,RCBILLDA,RCG,RCTCB,RCTCNO
"RTN","RCTCS1",8,0)
 N RCTCNO,RCTCNR,RET,SEPLINE,SSN,X,Y
"RTN","RCTCS1",9,0)
 K DIR
"RTN","RCTCS1",10,0)
 S DIR(0)="S^B:Stop/Reactivate TCSP Referral for a Bill;D:Stop/Reactivate TCSP Referral for a Debtor"
"RTN","RCTCS1",11,0)
 S DIR("B")="B" D ^DIR Q:$D(DIRUT)
"RTN","RCTCS1",12,0)
 I Y="B" D STOP^RCTCSPU Q  ;--> out
"RTN","RCTCS1",13,0)
 D DSEL ;select debtor
"RTN","RCTCS1",14,0)
 I DEBTOR="" W !,"Debtor must be selected",! Q  ;--> out
"RTN","RCTCS1",15,0)
 D SHOWB ;disply bills for debtor
"RTN","RCTCS1",16,0)
 D DEBSTAT(DEBTOR) ;get debtor status
"RTN","RCTCS1",17,0)
 Q:'$D(RCDSTAT)  ;required info
"RTN","RCTCS1",18,0)
 D REUPS:$G(RCDSTAT("STOP FLAG"))="S"
"RTN","RCTCS1",19,0)
 D REUPR:$G(RCDSTAT("STOP FLAG"))="R"
"RTN","RCTCS1",20,0)
 D SETS:$G(RCDSTAT("STOP FLAG"))="R"!($G(RCDSTAT("STOP FLAG"))="")
"RTN","RCTCS1",21,0)
 D SETR:$G(RCDSTAT("STOP FLAG"))="S"
"RTN","RCTCS1",22,0)
 Q
"RTN","RCTCS1",23,0)
DSEL ;Pick patient only
"RTN","RCTCS1",24,0)
 S DEBTOR=""
"RTN","RCTCS1",25,0)
 S DIC="^RCD(340,",DIC(0)="AEQZ"
"RTN","RCTCS1",26,0)
 S DIC("V")="I +Y(0)=2"
"RTN","RCTCS1",27,0)
 S DIC("S")="I $P(^(0),U,1)["";DPT("""
"RTN","RCTCS1",28,0)
 D ^DIC Q:Y<0
"RTN","RCTCS1",29,0)
 S DEBTOR=+Y
"RTN","RCTCS1",30,0)
 S SSN=$P(^DPT(+Y(0),0),U,9)
"RTN","RCTCS1",31,0)
 Q
"RTN","RCTCS1",32,0)
SHOWB ;
"RTN","RCTCS1",33,0)
 S RET=0,HDR1=1
"RTN","RCTCS1",34,0)
 S RCTCB=0 F  S RCTCB=$O(^PRCA(430,"C",DEBTOR,RCTCB)) Q:RCTCB'>0!RET  D
"RTN","RCTCS1",35,0)
 . S RCBILLDA=RCTCB,GOTBILL=$P(^PRCA(430,RCTCB,0),U) ;bill
"RTN","RCTCS1",36,0)
 . S CSTAT=$$GET1^DIQ(430,RCTCB_",",8)
"RTN","RCTCS1",37,0)
 . I (CSTAT'="ACTIVE")&(CSTAT'="OPEN") Q  ; only active and open
"RTN","RCTCS1",38,0)
 . I HDR1 D BILLHEAD S HDR1=0
"RTN","RCTCS1",39,0)
 . D DISPLAY ;W !,INFOLN,!?6,INFOLN1
"RTN","RCTCS1",40,0)
 . ;D STOP^RCTCSPU
"RTN","RCTCS1",41,0)
 . ;I $D(DUOUT)  S RET=1
"RTN","RCTCS1",42,0)
 . Q
"RTN","RCTCS1",43,0)
 Q
"RTN","RCTCS1",44,0)
 ;
"RTN","RCTCS1",45,0)
DISPLAY ;Display Info for each BILL
"RTN","RCTCS1",46,0)
 S DNAME=$$GET1^DIQ(430,RCTCB_",",9) W !,DNAME
"RTN","RCTCS1",47,0)
 W ?32,SSN
"RTN","RCTCS1",48,0)
 S BILLN=$$GET1^DIQ(430,RCTCB_",",.01) W ?43,BILLN
"RTN","RCTCS1",49,0)
 W ?58,CSTAT
"RTN","RCTCS1",50,0)
 S CBAL=$$GET1^DIQ(430,RCTCB_",",11) W ?74,CBAL
"RTN","RCTCS1",51,0)
 ;
"RTN","RCTCS1",52,0)
 Q
"RTN","RCTCS1",53,0)
TMP ;
"RTN","RCTCS1",54,0)
 S SEPLINE="-",$P(SEPLINE,"-",80)=""
"RTN","RCTCS1",55,0)
 W !,"Bill",?13,"Debtor",?40,"Current Bal",!?8,"CURRENT STATUS",?30,"CATEGORY",!,SEPLINE
"RTN","RCTCS1",56,0)
 Q
"RTN","RCTCS1",57,0)
BILLHEAD ;bill header
"RTN","RCTCS1",58,0)
 S SEPLINE="-",$P(SEPLINE,"-",80)="" W !,SEPLINE
"RTN","RCTCS1",59,0)
 W !,"Debtor Name",?32,"SSN",?43,"Bill #",?58,"AR Status",?74,"Amount"
"RTN","RCTCS1",60,0)
 W !,SEPLINE
"RTN","RCTCS1",61,0)
 Q
"RTN","RCTCS1",62,0)
DEBSTAT(DEBTOR) ;Debtor TSP Status
"RTN","RCTCS1",63,0)
 K RCDSTAT
"RTN","RCTCS1",64,0)
 S LASTDT=$O(^RCD(340,DEBTOR,8,"C",99999999),-1)
"RTN","RCTCS1",65,0)
 I LASTDT>0 D  ;has new style TCP
"RTN","RCTCS1",66,0)
 . S LASTIEN=$O(^RCD(340,DEBTOR,8,"C",LASTDT,0))
"RTN","RCTCS1",67,0)
 . S G1=^RCD(340,DEBTOR,8,LASTIEN,0)
"RTN","RCTCS1",68,0)
 . S RCDSTAT("STOP FLAG")=$P(G1,U,1)
"RTN","RCTCS1",69,0)
 . S RCDSTAT("DATE")=$P(G1,U,2)
"RTN","RCTCS1",70,0)
 . S RCDSTAT("USER")=$P(G1,U,3)
"RTN","RCTCS1",71,0)
 . S RCDSTAT("REASON")=$P(G1,U,4)
"RTN","RCTCS1",72,0)
 .S RCDSTAT("COMMENT")=$P(G1,U,5)
"RTN","RCTCS1",73,0)
 I LASTDT'>0 D  ;check for old stop
"RTN","RCTCS1",74,0)
 . S RCDSTAT("STOP FLAG")=$$GET1^DIQ(340,DEBTOR_",",6.02)
"RTN","RCTCS1",75,0)
 . S RCDSTAT("DATE")=$$GET1^DIQ(340,DEBTOR_",",6.03)
"RTN","RCTCS1",76,0)
 . ; S RCDSTAT("USER")=$P(G1,U,3)
"RTN","RCTCS1",77,0)
 . S RCDSTAT("REASON")=$$GET1^DIQ(340,DEBTOR_",",6.04)
"RTN","RCTCS1",78,0)
 .S RCDSTAT("COMMENT")=$$GET1^DIQ(340,DEBTOR_",",6.05)
"RTN","RCTCS1",79,0)
 Q  ;RCDSTAT
"RTN","RCTCS1",80,0)
REUPS ;already set to stop
"RTN","RCTCS1",81,0)
 W !!,"Referral to Cross-Servicing has already been stopped for this debtor"
"RTN","RCTCS1",82,0)
 W !,"Stop Cross-Servicing referral effective date: " S Y=RCDSTAT("DATE") X ^DD("DD") W Y
"RTN","RCTCS1",83,0)
 W !,"Stop Cross-Servicing referral reason: "
"RTN","RCTCS1",84,0)
 S X=RCDSTAT("REASON") W $S(X="D":"DMC Eligible",X="H":"High risk veteran",X="B":"Bankruptcy",X="T":"Treasury Error",X="O":"Other",1:1)
"RTN","RCTCS1",85,0)
 I RCDSTAT("REASON")="O" W !,"Stop Cross-Servicing referral reason Other: ",RCDSTAT("COMMENT")
"RTN","RCTCS1",86,0)
 W !,"Cross-Servicing referral stopped by : ",$P(^VA(200,RCDSTAT("USER"),0),U)
"RTN","RCTCS1",87,0)
 Q
"RTN","RCTCS1",88,0)
REUPR ;already re-active
"RTN","RCTCS1",89,0)
 W !!,"Referral to Cross-Servicing has already been reactivated for this debtor"
"RTN","RCTCS1",90,0)
 W !,"Reactivated Cross-Servicing referral effective date: " S Y=RCDSTAT("DATE") X ^DD("DD") W Y
"RTN","RCTCS1",91,0)
 W !,"Cross-Servicing referral reactivated by : ",$P(^VA(200,RCDSTAT("USER"),0),U)
"RTN","RCTCS1",92,0)
 Q
"RTN","RCTCS1",93,0)
SETS ;set the stop
"RTN","RCTCS1",94,0)
 W !!,"Are You Sure You Want To Stop Cross-Servicing Referral for this Debtor?"
"RTN","RCTCS1",95,0)
 K DIR S DIR(0)="Y",DIR("B")="NO" D ^DIR
"RTN","RCTCS1",96,0)
 Q:'Y  ;out if not Y or dirut
"RTN","RCTCS1",97,0)
 K DIR S DIR("A")="Enter Required Stop Reason"
"RTN","RCTCS1",98,0)
 S DIR(0)="S^D:DMC Eligible;H:High risk veteran;B:Bankruptcy;T:Treasury Error;O:Other"
"RTN","RCTCS1",99,0)
 D ^DIR Q:$D(DIRUT)
"RTN","RCTCS1",100,0)
 S RCTCNR=Y,RCTCNO=""
"RTN","RCTCS1",101,0)
 K DIR
"RTN","RCTCS1",102,0)
 I RCTCNR="O" S DIR(0)="F^3:100",DIR("A")="Enter 'Other' Reason" D ^DIR Q:$D(DIRUT)
"RTN","RCTCS1",103,0)
 S RCTCNO=Y
"RTN","RCTCS1",104,0)
 S LSUB=0,CNT=1 F  S LSUB=$O(^RCD(340,DEBTOR,8,LSUB)) Q:LSUB'>0  S CNT=LSUB+1
"RTN","RCTCS1",105,0)
 D NOW^%DTC
"RTN","RCTCS1",106,0)
 S ^RCD(340,DEBTOR,8,CNT,0)="S"_U_%_U_DUZ_U_RCTCNR_U_RCTCNO
"RTN","RCTCS1",107,0)
 S ^RCD(340,DEBTOR,8,0)="^340.08SA"
"RTN","RCTCS1",108,0)
 S ^RCD(340,DEBTOR,8,"C",%,CNT)=""
"RTN","RCTCS1",109,0)
 W !!,"Stop Cross-Servicing Referral Complete"
"RTN","RCTCS1",110,0)
 W !!,"*** End of Stop Cross-Servicing Referral ***"
"RTN","RCTCS1",111,0)
 I $E(IOST,1,2)="C-",'$D(DIRUT) R !!,"Type <Enter> to continue or '^' to exit:",X:DTIME
"RTN","RCTCS1",112,0)
 Q
"RTN","RCTCS1",113,0)
SETR ;reactivate
"RTN","RCTCS1",114,0)
 W !!,"Are You Sure You Want To Reactivate Cross-Servicing Referral for this Debtor?"
"RTN","RCTCS1",115,0)
 K DIR S DIR(0)="Y",DIR("B")="NO" D ^DIR
"RTN","RCTCS1",116,0)
 Q:'Y  ;out if not Y or dirut
"RTN","RCTCS1",117,0)
 S LSUB=0,CNT=1 F  S LSUB=$O(^RCD(340,DEBTOR,8,LSUB)) Q:LSUB'>0  S CNT=LSUB+1
"RTN","RCTCS1",118,0)
 D NOW^%DTC
"RTN","RCTCS1",119,0)
 S ^RCD(340,DEBTOR,8,CNT,0)="R"_U_%_U_DUZ_U
"RTN","RCTCS1",120,0)
 S ^RCD(340,DEBTOR,8,"C",%,CNT)=""
"RTN","RCTCS1",121,0)
 W !!,"Reactivate Cross-Servicing Referral complete"
"RTN","RCTCS1",122,0)
 W !,"All eligible bills for this Debtor are now to be Referred to Cross-Servicing"
"RTN","RCTCS1",123,0)
 W !!,"*** End of Reactivate Cross-Servicing Referral ***"
"RTN","RCTCS1",124,0)
 I $E(IOST,1,2)="C-",'$D(DIRUT) R !!,"Type <Enter> to continue or '^' to exit:",X:DTIME
"RTN","RCTCS1",125,0)
 Q
"RTN","RCTCS1",126,0)
SITE(SITE) ;Status from file 342
"RTN","RCTCS1",127,0)
 N G,EFFEC,RCDT,N,N1,RCSTAT
"RTN","RCTCS1",128,0)
 S RCSTAT=0,RCDT=0
"RTN","RCTCS1",129,0)
 S N1=$O(^RC(342,0)) S N=0,RCDT=0 F  S N=$O(^RC(342,N1,40,N)) Q:N'>0  D
"RTN","RCTCS1",130,0)
 . S G=^RC(342,N1,40,N,0),EFFEC=$P(G,U,2)
"RTN","RCTCS1",131,0)
 . I EFFEC>RCDT S RCDT=EFFEC,RCSTAT=$P(G,U)
"RTN","RCTCS1",132,0)
 Q RCSTAT
"RTN","RCTCS1",133,0)
 ;
"RTN","RCTCSP1")
0^22^B180726481^B180778033
"RTN","RCTCSP1",1,0)
RCTCSP1 ;ALBANY/BDB-CROSS - SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP1",2,0)
 ;;4.5;Accounts Receivable;**301,331,315,339,341,336,350**;Mar 20, 1995;Build 66
"RTN","RCTCSP1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP1",4,0)
 ;
"RTN","RCTCSP1",5,0)
 ;PRCA*4.5*331 Modify code to ensure that the debtor address info
"RTN","RCTCSP1",6,0)
 ;             is correct on transmission of foreign veterans 
"RTN","RCTCSP1",7,0)
 ;             debtor/bills to Treasury.
"RTN","RCTCSP1",8,0)
 ;
"RTN","RCTCSP1",9,0)
 ;PRCA*4.5*336 Remove IOP set from device request as it causes
"RTN","RCTCSP1",10,0)
 ;             issue when set after %ZIS call and then jumping
"RTN","RCTCSP1",11,0)
 ;             to new option using ^%ZIS call.
"RTN","RCTCSP1",12,0)
 ;             Also, Set CS call switch for correct address
"RTN","RCTCSP1",13,0)
 ;             when debtor file (340) does not have address
"RTN","RCTCSP1",14,0)
 ;             node 1. 
"RTN","RCTCSP1",15,0)
 ;             Also, ensure that the phone number defaults
"RTN","RCTCSP1",16,0)
 ;             to 10 spaces if non-numeric.
"RTN","RCTCSP1",17,0)
 ;
"RTN","RCTCSP1",18,0)
 Q
"RTN","RCTCSP1",19,0)
 ;
"RTN","RCTCSP1",20,0)
BILLREP ;Cross-servicing bill report, prints individual bills that make up a cross-servicing account
"RTN","RCTCSP1",21,0)
 N DIC,DEBTOR,ZTSAVE,ZTDESC,ZTRTN,POP,DTFRMTO,PROMPT,EXCEL
"RTN","RCTCSP1",22,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP1",23,0)
 S DIC=340,DIC(0)="AEQM",DIC("S")="I $D(^RCD(340,""TCSP"",+Y))" D ^DIC
"RTN","RCTCSP1",24,0)
 Q:Y<1  S DEBTOR=+Y
"RTN","RCTCSP1",25,0)
 S DTFRMTO=$$DTFRMTO^RCTCSP2 Q:'DTFRMTO  ;Get date range as per PRCA*4.5*315
"RTN","RCTCSP1",26,0)
 S EXCEL=0,PROMPT="CAPTURE Report data to an Excel Document",DIR(0)="Y",DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSP1",27,0)
 S EXCEL=$$SELECT^RCTCSJR(PROMPT,"NO") I "01"'[EXCEL S STOP=1 Q
"RTN","RCTCSP1",28,0)
 I EXCEL=1 D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSP1",29,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP BILLREPQ     ;PRC*4.5*336
"RTN","RCTCSP1",30,0)
 I $D(IO("Q")) D  G BILLREPQ
"RTN","RCTCSP1",31,0)
 .S ZTSAVE("DEBTOR")="",ZTSAVE("DTFRMTO")="",ZTSAVE("EXCEL")=""
"RTN","RCTCSP1",32,0)
 .S ZTRTN="BILLREPP^RCTCSP1",ZTDESC="CROSS-SERVICING BILL REPORT"
"RTN","RCTCSP1",33,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP1",34,0)
 .I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP1",35,0)
 .Q
"RTN","RCTCSP1",36,0)
 ;
"RTN","RCTCSP1",37,0)
BILLREPP ;Call to build array of bills referred
"RTN","RCTCSP1",38,0)
 U IO
"RTN","RCTCSP1",39,0)
 N BILL,B7,B14,B15,B16,D4,FND,BAMT,TAMT,DIRUT,TNM,TID,TDT,DASH,CSTAT,PAGE,DASH,TMP,I,DATE,DTFRM,DTTO,DATDATE
"RTN","RCTCSP1",40,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP1",41,0)
 S DASH="",$P(DASH,"-",78)=""  ;(as per PRCA*4.5*315)
"RTN","RCTCSP1",42,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2)),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP1",43,0)
 S (BAMT,TAMT,BILL,PAGE)=0
"RTN","RCTCSP1",44,0)
 ; rewritten to sort by "TCSP" (#151 date referred to TCSP) not the "AB" xref... PRCA*4.5*315 (TV8)
"RTN","RCTCSP1",45,0)
 F  S BILL=$O(^PRCA(430,"TCSP",BILL)) Q:BILL=""!($D(DIRUT))  D
"RTN","RCTCSP1",46,0)
 .Q:$P($G(^PRCA(430,BILL,0)),U,9)'=DEBTOR
"RTN","RCTCSP1",47,0)
 .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",48,0)
 .S DATDATE=$P($G(^PRCA(430,BILL,15)),U) Q:DATDATE<DTFRM!(DATDATE>DTTO)
"RTN","RCTCSP1",49,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSP1",50,0)
 .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP1",51,0)
 .S TAMT=TAMT+BAMT
"RTN","RCTCSP1",52,0)
 .S ^TMP("RCTCSP1",$J,DEBTOR,BILL)=BAMT
"RTN","RCTCSP1",53,0)
 D BILLREPH
"RTN","RCTCSP1",54,0)
 S DEBTOR="" F  S DEBTOR=$O(^TMP("RCTCSP1",$J,DEBTOR)) Q:'DEBTOR!($D(DIRUT))  D
"RTN","RCTCSP1",55,0)
 . S BILL=0 F  S BILL=$O(^TMP("RCTCSP1",$J,DEBTOR,BILL)) Q:'BILL  D
"RTN","RCTCSP1",56,0)
 ..Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",57,0)
 ..S FND=1 W !,$P(^PRCA(430,BILL,0),U) S CSTAT=$P(^(0),U,8),B7=$G(^(7)),B15=$G(^(15)),B16=$G(^(16))
"RTN","RCTCSP1",58,0)
 ..I 'EXCEL W ?12,$P(^PRCA(430.3,CSTAT,0),U,2)
"RTN","RCTCSP1",59,0)
 ..I EXCEL W U_$P(^PRCA(430.3,CSTAT,0),U,2)
"RTN","RCTCSP1",60,0)
 ..I 'EXCEL W ?15
"RTN","RCTCSP1",61,0)
 ..I EXCEL W U
"RTN","RCTCSP1",62,0)
 ..W $J($P(B16,U,9),8,2)
"RTN","RCTCSP1",63,0)
 ..S BAMT=^TMP("RCTCSP1",$J,DEBTOR,BILL)
"RTN","RCTCSP1",64,0)
 ..I 'EXCEL W ?25
"RTN","RCTCSP1",65,0)
 ..I EXCEL W U
"RTN","RCTCSP1",66,0)
 ..W $J(BAMT,8,2)
"RTN","RCTCSP1",67,0)
 ..I 'EXCEL W $J($P(B7,U,1),9,2),$J($P(B7,U,2),7,2),$J($P(B7,U,3),8,2),$J($P(B7,U,4),8,2)  ;(as per PRCA*4.5*315)
"RTN","RCTCSP1",68,0)
 ..I EXCEL W U,$J($P(B7,U,1),9,2)_U_$J($P(B7,U,2),7,2)_U_$J($P(B7,U,3),7,2)_U_$J($P(B7,U,4),8,2)
"RTN","RCTCSP1",69,0)
 ..S TMP=$$FMTE^XLFDT($P(B15,U,1),"2Z")  ;Format date to n/n/nn  (as per PRCA*4.5*315)
"RTN","RCTCSP1",70,0)
 ..I 'EXCEL W ?67,TMP  ;$P(TMP,", ",1)_","_$P(TMP,", ",2)  ;
"RTN","RCTCSP1",71,0)
 ..I EXCEL W U_TMP
"RTN","RCTCSP1",72,0)
 ..;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP1",73,0)
 ..I ($Y+3)>IOSL D
"RTN","RCTCSP1",74,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR Q:$D(DIRUT)
"RTN","RCTCSP1",75,0)
 ...D BILLREPH
"RTN","RCTCSP1",76,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP1",77,0)
 D ^%ZISC
"RTN","RCTCSP1",78,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP1",79,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP1",80,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP1",81,0)
BILLREPQ Q
"RTN","RCTCSP1",82,0)
 ;
"RTN","RCTCSP1",83,0)
BILLREPH ;header for cross-servicing bill report
"RTN","RCTCSP1",84,0)
 W @IOF
"RTN","RCTCSP1",85,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",86,0)
 I 'EXCEL W "PAGE "_PAGE,?24,"CROSS-SERVICING BILL REPORT",?60,$$FMTE^XLFDT(DT,"2Z"),!,DASH
"RTN","RCTCSP1",87,0)
 I EXCEL W "PAGE "_PAGE_U_"CROSS-SERVICING BILL REPORT"_U_U_$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP1",88,0)
 N RCHDR,RCSSN
"RTN","RCTCSP1",89,0)
 S RCHDR=$$ACCNTHDR^RCDPAPLM(DEBTOR),RCSSN=$S($P(RCHDR,U,2)["P":$E($P(RCHDR,U,2),7,11),1:$E($P(RCHDR,U,2),6,9))  ;Pseudo SSN shouldn't be allowed but we allowed for it to print
"RTN","RCTCSP1",90,0)
 I 'EXCEL D  Q 
"RTN","RCTCSP1",91,0)
 . W !!,"DEBTOR: ",$E($P(RCHDR,U,1),1,18),?22,"SSN: ",RCSSN,?45,"CURRENT CS DEBT: ",$J(TAMT,8,2),!,DASH
"RTN","RCTCSP1",92,0)
 . W !,"BILL NO.",?12,"ST",?15,"ORIG AMT",?25,"CURR AMT",?38,"PRIN",?46,"INT",?52,"ADMIN",?60,"COURT",?67,"CS REF DT" ;(as per PRCA*4.5*315)
"RTN","RCTCSP1",93,0)
 . W !,"---- ---",?12,"--",?15,"---- ---",?25,"---- ---",?38,"----",?46,"---",?52,"-----",?60,"-----",?67,"-- -------"
"RTN","RCTCSP1",94,0)
 W !,"DEBTOR: "_$E($P(RCHDR,U,1),1,18)_U_U_"SSN: "_RCSSN_U_U_U_"CURRENT CS DEBT: "_$J(TAMT,8,2)
"RTN","RCTCSP1",95,0)
 W !,"BILL NO."_U_"ST"_U_"ORIG AMT"_U_"CURR AMT"_U_"PRIN"_U_"INT"_U_"ADMIN"_U_"COURT"_U_"CS REF DATE"
"RTN","RCTCSP1",96,0)
 Q
"RTN","RCTCSP1",97,0)
 ;
"RTN","RCTCSP1",98,0)
CSRPRT ;Print Cross-Servicing Report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSP1",99,0)
 ;
"RTN","RCTCSP1",100,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP1",101,0)
 N DIC,RCSORT,PAGE,DASH,DTOUT,DIRUT,DUOUT,DIROUT,RCIEN,RCDEBTOR,RCREFDT,RCSSN,RCORIG,RCCAMT,RCREFDT,RCBILL,ITEM,DBTR,SDT,SSN,NCIEN,TERMDIG
"RTN","RCTCSP1",102,0)
 S PAGE=0,DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",103,0)
 W !
"RTN","RCTCSP1",104,0)
 S DIR(0)="S^1:Bill Number;2:Debtor Name;3:CS Referred Date",DIR("A")="Sort by" D ^DIR K DIR
"RTN","RCTCSP1",105,0)
 S RCSORT=Y Q:($D(DTOUT)!$D(DUOUT)!$D(DIROUT))
"RTN","RCTCSP1",106,0)
 ; The following sections were rewritten to eliminate using ^DIP - (as per PRCA*4.5*315 reformat dates and SSN)
"RTN","RCTCSP1",107,0)
 S DTFRMTO=$$DTFRMTO^RCTCSP2 Q:'DTFRMTO  ;Get date range as per PRCA*4.5*315
"RTN","RCTCSP1",108,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2)),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP1",109,0)
 S EXCEL=0,PROMPT="CAPTURE Report data to an Excel Document",DIR(0)="Y",DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSP1",110,0)
 S EXCEL=$$SELECT^RCTCSJR(PROMPT,"NO") I "01"'[EXCEL S STOP=1 Q
"RTN","RCTCSP1",111,0)
 I EXCEL=1 D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSP1",112,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS Q:POP     ;PRC*4.5*336
"RTN","RCTCSP1",113,0)
 I $D(IO("Q")) D  Q
"RTN","RCTCSP1",114,0)
 .S ZTSAVE("RCSORT")="",ZTSAVE("DTFRMTO")="",ZTSAVE("EXCEL")="",ZTSAVE("PROMPT")="",ZTSAVE("PAGE")="",ZTSAVE("DASH")=""
"RTN","RCTCSP1",115,0)
 .S ZTRTN="CSRPRTR^RCTCSP1",ZTDESC="PRINT CROSS-SERVICING REPORT"
"RTN","RCTCSP1",116,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP1",117,0)
 .I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP1",118,0)
 .Q
"RTN","RCTCSP1",119,0)
CSRPRTR ; compile/print job - either foreground or background
"RTN","RCTCSP1",120,0)
 U IO
"RTN","RCTCSP1",121,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP1",122,0)
 ;
"RTN","RCTCSP1",123,0)
 I RCSORT=1 D
"RTN","RCTCSP1",124,0)
 . D CSRPRTH1^RCTCSP1A
"RTN","RCTCSP1",125,0)
 . S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2)),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP1",126,0)
 . S RCIEN="" F  S RCIEN=$O(^PRCA(430,"TCSP",RCIEN)) Q:RCIEN=""  D
"RTN","RCTCSP1",127,0)
 .. Q:'$D(^PRCA(430,RCIEN,15))   ;cross servicing data fields
"RTN","RCTCSP1",128,0)
 ..Q:$P($G(^PRCA(430,RCIEN,15)),U)<DTFRM!($P($G(^PRCA(430,RCIEN,15)),U)>DTTO)
"RTN","RCTCSP1",129,0)
 ..K LIST,MSG,RCLIST D GETS^DIQ(430,RCIEN_",",".01;9;121,141,161;169;151;11","IE","LIST","MSG") S RCLIST=$NA(LIST(430,RCIEN_","))
"RTN","RCTCSP1",130,0)
 ..;Q:$G(@RCLIST@(141,"E"))'=""   ;Date sent to TOP
"RTN","RCTCSP1",131,0)
 ..S SSN=$E($$SSN^RCFN01(@RCLIST@(9,"I")),6,9) S SSN=$S(SSN'="":SSN,1:"     "),TERMDIG=$E(@RCLIST@(9,"E"),1)_SSN
"RTN","RCTCSP1",132,0)
 ..I EXCEL D  Q 
"RTN","RCTCSP1",133,0)
 ...S ^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))=@RCLIST@(.01,"E")_U_$E(@RCLIST@(9,"E"),1,19)_U_TERMDIG_U_$J(@RCLIST@(169,"E"),8,2)_U_$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")
"RTN","RCTCSP1",134,0)
 ...S ^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))=^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))_U_$J(@RCLIST@(11,"E"),8,2)
"RTN","RCTCSP1",135,0)
 ...Q
"RTN","RCTCSP1",136,0)
 ..S ^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))=@RCLIST@(.01,"E")_U_$E(@RCLIST@(9,"E"),1,19)_U_SSN_U_$J(@RCLIST@(169,"E"),8,2)_U_$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")
"RTN","RCTCSP1",137,0)
 ..S ^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))=^TMP("RCTCSP1",$J,RCIEN,@RCLIST@(.01,"E"))_U_$J(@RCLIST@(11,"E"),8,2)
"RTN","RCTCSP1",138,0)
 .;
"RTN","RCTCSP1",139,0)
 .; print report for sort 1
"RTN","RCTCSP1",140,0)
 .S (NCIEN,ITEM)="" F  S NCIEN=$O(^TMP("RCTCSP1",$J,NCIEN)) Q:NCIEN=""!$D(DIRUT)  F  S ITEM=$O(^TMP("RCTCSP1",$J,NCIEN,ITEM)) Q:ITEM=""!$D(DIRUT)  D  Q:$D(DIRUT)
"RTN","RCTCSP1",141,0)
 ..I EXCEL W !,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U)_U_$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,2)_U_$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,3)
"RTN","RCTCSP1",142,0)
 ..I EXCEL W U_$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,4)_U_$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,5)_U_$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,6)
"RTN","RCTCSP1",143,0)
 ..I EXCEL Q
"RTN","RCTCSP1",144,0)
 ..; non-Excel output
"RTN","RCTCSP1",145,0)
 ..W !,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U),?14,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,2),?35,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,3),?43
"RTN","RCTCSP1",146,0)
 ..W $P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,4),?58,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,5),?68,$P(^TMP("RCTCSP1",$J,NCIEN,ITEM),U,6)
"RTN","RCTCSP1",147,0)
 ..; page break check
"RTN","RCTCSP1",148,0)
 ..I ($Y+3)>IOSL D
"RTN","RCTCSP1",149,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR Q:$D(DIRUT)
"RTN","RCTCSP1",150,0)
 ...D CSRPRTH1^RCTCSP1A
"RTN","RCTCSP1",151,0)
 ...Q
"RTN","RCTCSP1",152,0)
 ..Q
"RTN","RCTCSP1",153,0)
 .Q
"RTN","RCTCSP1",154,0)
 ;
"RTN","RCTCSP1",155,0)
 I RCSORT=2 D
"RTN","RCTCSP1",156,0)
 . D CSRPRTH2^RCTCSP1A
"RTN","RCTCSP1",157,0)
 . S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP1",158,0)
 . S RCIEN="" F  S RCIEN=$O(^PRCA(430,"TCSP",RCIEN)) Q:RCIEN=""  D
"RTN","RCTCSP1",159,0)
 ..Q:'$D(^PRCA(430,RCIEN,15))   ;cross servicing data fields
"RTN","RCTCSP1",160,0)
 ..Q:$P($G(^PRCA(430,RCIEN,15)),U)<DTFRM!($P($G(^PRCA(430,RCIEN,15)),U)>DTTO)
"RTN","RCTCSP1",161,0)
 ..K LIST,MSG,RCLIST D GETS^DIQ(430,RCIEN_",",".01;9;121,141,161;169;151;11","IE","LIST","MSG") S RCLIST=$NA(LIST(430,RCIEN_","))
"RTN","RCTCSP1",162,0)
 ..;Q:$G(@RCLIST@(121,"E"))'=""   ;Date sent to DMC
"RTN","RCTCSP1",163,0)
 ..;Q:$G(@RCLIST@(141,"E"))'=""   ;Date sent to TOP
"RTN","RCTCSP1",164,0)
 ..S SSN=$E($$SSN^RCFN01(@RCLIST@(9,"I")),6,9) S SSN=$S(SSN'="":SSN,1:"     "),TERMDIG=$E(@RCLIST@(9,"E"),1)_SSN
"RTN","RCTCSP1",165,0)
 ..I EXCEL D  Q
"RTN","RCTCSP1",166,0)
 ...S ^TMP("RCTCSP1",$J,@RCLIST@(9,"E"),RCIEN)=$E(@RCLIST@(9,"E"),1,19)_U_@RCLIST@(.01,"E")_U_TERMDIG_U_$J(@RCLIST@(169,"E"),8,2)_U_$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")_U_$J(@RCLIST@(11,"E"),8,2) Q
"RTN","RCTCSP1",167,0)
 ..S ^TMP("RCTCSP1",$J,@RCLIST@(9,"E"),RCIEN)=$E(@RCLIST@(9,"E"),1,19)_U_@RCLIST@(.01,"E")_U_SSN_U_$J(@RCLIST@(169,"E"),8,2)_U_$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")_U_$J(@RCLIST@(11,"E"),8,2)
"RTN","RCTCSP1",168,0)
 .;
"RTN","RCTCSP1",169,0)
 .; print report for sort 2
"RTN","RCTCSP1",170,0)
 .S (DBTR,NCIEN)="" F  S DBTR=$O(^TMP("RCTCSP1",$J,DBTR)) Q:DBTR=""!$D(DIRUT)  F  S NCIEN=$O(^TMP("RCTCSP1",$J,DBTR,NCIEN)) Q:NCIEN=""!$D(DIRUT)  D  Q:$D(DIRUT)
"RTN","RCTCSP1",171,0)
 ..I EXCEL W !,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,1,4)_U_$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,5)_U_$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,6)
"RTN","RCTCSP1",172,0)
 ..I EXCEL Q
"RTN","RCTCSP1",173,0)
 ..; non-Excel output
"RTN","RCTCSP1",174,0)
 ..W !,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U),?21,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,2),?35,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,3),?43,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,4)
"RTN","RCTCSP1",175,0)
 ..W ?58,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,5),?68,$P(^TMP("RCTCSP1",$J,DBTR,NCIEN),U,6)
"RTN","RCTCSP1",176,0)
 ..; page break check
"RTN","RCTCSP1",177,0)
 ..I ($Y+3)>IOSL D
"RTN","RCTCSP1",178,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR Q:$D(DIRUT)
"RTN","RCTCSP1",179,0)
 ...D CSRPRTH2^RCTCSP1A
"RTN","RCTCSP1",180,0)
 ...Q
"RTN","RCTCSP1",181,0)
 ..Q
"RTN","RCTCSP1",182,0)
 .Q
"RTN","RCTCSP1",183,0)
 ;
"RTN","RCTCSP1",184,0)
 I RCSORT=3 D
"RTN","RCTCSP1",185,0)
 .D CSRPRTH3^RCTCSP1A
"RTN","RCTCSP1",186,0)
 .S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP1",187,0)
 .S RCIEN="" F  S RCIEN=$O(^PRCA(430,"TCSP",RCIEN)) Q:RCIEN=""  D
"RTN","RCTCSP1",188,0)
 ..Q:'$D(^PRCA(430,RCIEN,15))   ;cross servicing data fields
"RTN","RCTCSP1",189,0)
 ..Q:$P(^PRCA(430,RCIEN,15),U)<DTFRM!($P(^PRCA(430,RCIEN,15),U)>DTTO)
"RTN","RCTCSP1",190,0)
 ..K LIST,MSG,RCLIST D GETS^DIQ(430,RCIEN_",",".01;9;121,141,161;169;151;11","IE","LIST","MSG") S RCLIST=$NA(LIST(430,RCIEN_","))
"RTN","RCTCSP1",191,0)
 ..;Q:$G(@RCLIST@(121,"E"))'=""   ;Date sent to DMC
"RTN","RCTCSP1",192,0)
 ..;Q:$G(@RCLIST@(141,"E"))'=""   ;Date sent to TOP
"RTN","RCTCSP1",193,0)
 ..S SSN=$E($$SSN^RCFN01(@RCLIST@(9,"I")),6,9) S SSN=$S(SSN'="":SSN,1:"     "),TERMDIG=$E(@RCLIST@(9,"E"),1)_SSN
"RTN","RCTCSP1",194,0)
 ..I EXCEL S ^TMP("RCTCSP1",$J,@RCLIST@(151,"I"),RCIEN)=$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")_U_$E(@RCLIST@(9,"E"),1,19)_U_@RCLIST@(.01,"E")_U_TERMDIG_U_$J(@RCLIST@(169,"E"),8,2)_U_$J(@RCLIST@(11,"E"),8,2)
"RTN","RCTCSP1",195,0)
 ..I 'EXCEL S ^TMP("RCTCSP1",$J,@RCLIST@(151,"I"),RCIEN)=$$FMTE^XLFDT(@RCLIST@(151,"I"),"2Z")_U_$E(@RCLIST@(9,"E"),1,19)_U_@RCLIST@(.01,"E")_U_SSN_U_$J(@RCLIST@(169,"E"),8,2)_U_$J(@RCLIST@(11,"E"),8,2)
"RTN","RCTCSP1",196,0)
 .;
"RTN","RCTCSP1",197,0)
 .; print report for sort 3
"RTN","RCTCSP1",198,0)
 .S (SDT,NCIEN)="" F  S SDT=$O(^TMP("RCTCSP1",$J,SDT)) Q:SDT=""!$D(DIRUT)  F  S NCIEN=$O(^TMP("RCTCSP1",$J,SDT,NCIEN)) Q:NCIEN=""!$D(DIRUT)  D  Q:$D(DIRUT)
"RTN","RCTCSP1",199,0)
 ..I EXCEL W !,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U)_U_$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,2)_U_$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,3)_U_$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,4)
"RTN","RCTCSP1",200,0)
 ..I EXCEL W U_$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,5)_U_$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,6)
"RTN","RCTCSP1",201,0)
 ..I EXCEL Q
"RTN","RCTCSP1",202,0)
 ..; non-Excel output
"RTN","RCTCSP1",203,0)
 ..W !,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U),?12,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,2),?34,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,3),?49
"RTN","RCTCSP1",204,0)
 ..W $P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,4),?58,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,5),?68,$P(^TMP("RCTCSP1",$J,SDT,NCIEN),U,6)
"RTN","RCTCSP1",205,0)
 ..; page break check
"RTN","RCTCSP1",206,0)
 ..I ($Y+3)>IOSL D
"RTN","RCTCSP1",207,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR Q:$D(DIRUT)
"RTN","RCTCSP1",208,0)
 ...D CSRPRTH3^RCTCSP1A
"RTN","RCTCSP1",209,0)
 ...Q
"RTN","RCTCSP1",210,0)
 ..Q
"RTN","RCTCSP1",211,0)
 .Q
"RTN","RCTCSP1",212,0)
 ;
"RTN","RCTCSP1",213,0)
 ;end of report
"RTN","RCTCSP1",214,0)
 I $E(IOST,1,2)="C-",'$D(DIRUT) R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP1",215,0)
 ;
"RTN","RCTCSP1",216,0)
 K ^TMP("RCTCSP1",$J)          ; kill scratch
"RTN","RCTCSP1",217,0)
 D ^%ZISC                      ; close device
"RTN","RCTCSP1",218,0)
 I $D(ZTQUEUED) S ZTREQ="@"    ; purge the task
"RTN","RCTCSP1",219,0)
 Q
"RTN","RCTCSP1",220,0)
 ;
"RTN","RCTCSP1",221,0)
REC5B ;Create record 5B for Treasury
"RTN","RCTCSP1",222,0)
 ;  trnnum     transaction number file #433 pass in
"RTN","RCTCSP1",223,0)
 ;  trntyp     transaction type pointer to 430.3
"RTN","RCTCSP1",224,0)
 ;  trntypa    aia transaction type  (aio: dmc agency internal offset, abal: decrease adjustment) 
"RTN","RCTCSP1",225,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAMOUNT,TAMTPBAL,TAMTIBAL,TAMTABAL,TAMTFBAL,TAMTCBAL,AMTRFRRD,TRNTYP,TRNTYPA,TRANSNB
"RTN","RCTCSP1",226,0)
 N AMTPBAL,AMTIBAL,AMTABAL,AMTFBAL,AMTCBAL,TRN3,TRNNUME
"RTN","RCTCSP1",227,0)
 S TRNTYPA="AIO"
"RTN","RCTCSP1",228,0)
 S REC="C5B"_ACTION_"3636001200"_"DM1D "_"L"
"RTN","RCTCSP1",229,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP1",230,0)
 ;S DEBTNR=$E(SITE,1,3)_$$RJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP1",231,0)
 S DEBTNR=$$AGDEBTID^RCTCSPD,REC=REC_DEBTNR ; PRCA*4.5*350
"RTN","RCTCSP1",232,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP1",233,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP1",234,0)
 S TRNTYP=$P($G(^PRCA(433,TRNNUM,1)),U,2) I ",35,73,74,"[TRNTYP S TRNTYPA="ABAL"
"RTN","RCTCSP1",235,0)
 S REC=REC_$$LJSF(TRNTYPA,9)
"RTN","RCTCSP1",236,0)
 S TRNNUME=$$RJZF(TRNNUM,10)
"RTN","RCTCSP1",237,0)
 S TRNNUME=$E(TRNNUME,5,10) ;max is 999999
"RTN","RCTCSP1",238,0)
 I TRNNUME="000000" S TRNNUME="000001" ;min is 1
"RTN","RCTCSP1",239,0)
 S REC=REC_$$RJZF(TRNNUME,10)
"RTN","RCTCSP1",240,0)
 S REC=REC_$$DATE8(DT)
"RTN","RCTCSP1",241,0)
 S TRANSNB=$E(SITE,1,3)_$TR($J(TRNNUM,12)," ",0)
"RTN","RCTCSP1",242,0)
 S REC=REC_TRANSNB
"RTN","RCTCSP1",243,0)
 S REC=REC_$$BLANK(9)
"RTN","RCTCSP1",244,0)
 S TRN3=$G(^PRCA(433,TRNNUM,3))
"RTN","RCTCSP1",245,0)
 S TAMTPBAL=$P(TRN3,U,1) ;transaction principle balance
"RTN","RCTCSP1",246,0)
 S TAMTIBAL=$P(TRN3,U,2) ;transaction interest balance
"RTN","RCTCSP1",247,0)
 S TAMTABAL=$P(TRN3,U,3) ;transaction administrative balance
"RTN","RCTCSP1",248,0)
 S TAMTFBAL=$P(TRN3,U,4) ;transaction marshal fee
"RTN","RCTCSP1",249,0)
 S TAMTCBAL=$P(TRN3,U,5) ;transaction court cost
"RTN","RCTCSP1",250,0)
 I (TAMTPBAL+TAMTIBAL+TAMTABAL+TAMTFBAL+TAMTCBAL)=0 S TAMTPBAL=TRNAMT
"RTN","RCTCSP1",251,0)
 S TAMOUNT=$$AMOUNT(TAMTPBAL,TRNTYP)
"RTN","RCTCSP1",252,0)
 S TAMOUNT=TAMOUNT_$$AMOUNT(TAMTIBAL,TRNTYP)
"RTN","RCTCSP1",253,0)
 S TAMOUNT=TAMOUNT_$$AMOUNT(TAMTABAL,TRNTYP)
"RTN","RCTCSP1",254,0)
 S TAMOUNT=TAMOUNT_$$AMOUNT(TAMTFBAL+TAMTCBAL,TRNTYP)
"RTN","RCTCSP1",255,0)
 S REC=REC_TAMOUNT
"RTN","RCTCSP1",256,0)
 S REC=REC_$$AMOUNT(TRNAMT,TRNTYP)
"RTN","RCTCSP1",257,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP1",258,0)
 S AMTPBAL=$P(B7,U,1) ;principle balance
"RTN","RCTCSP1",259,0)
 S AMTIBAL=$P(B7,U,2) ;interest balance
"RTN","RCTCSP1",260,0)
 S AMTABAL=$P(B7,U,3) ;administrative balance
"RTN","RCTCSP1",261,0)
 S AMTFBAL=$P(B7,U,4) ;marshal fee
"RTN","RCTCSP1",262,0)
 S AMTCBAL=$P(B7,U,5) ;court cost
"RTN","RCTCSP1",263,0)
 S AMTRFRRD=AMTPBAL+AMTIBAL+AMTABAL+AMTFBAL+AMTCBAL
"RTN","RCTCSP1",264,0)
 I ACTION="U" S $P(^PRCA(430,BILL,16),U,10)=AMTRFRRD
"RTN","RCTCSP1",265,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"5B",TRNNUM)=REC
"RTN","RCTCSP1",266,0)
 S ^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL)=$$TAXID(DEBTOR)_"^"_$S(TRNTYP=73!(TRNTYP=74):"",1:"-")_+$E(REC,174,184)_"."_$E(REC,185,186)
"RTN","RCTCSP1",267,0)
 Q
"RTN","RCTCSP1",268,0)
 ;
"RTN","RCTCSP1",269,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP1",270,0)
 I +X S X=X+17000000
"RTN","RCTCSP1",271,0)
 S X=$E(X,1,8)
"RTN","RCTCSP1",272,0)
 Q X
"RTN","RCTCSP1",273,0)
 ;
"RTN","RCTCSP1",274,0)
AMOUNT(X,TT) ;changes amount to zero filled, right justified
"RTN","RCTCSP1",275,0)
 ;Zeroes are positive
"RTN","RCTCSP1",276,0)
 ;Increase adjustment are positive (TT=73,74)
"RTN","RCTCSP1",277,0)
 ;All other tranactions are negative (reduce bill balance)
"RTN","RCTCSP1",278,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP1",279,0)
 S X=$E($S(+X=0:0,TT=73!(TT=74):0,1:"-")_"00000000000",1,14-$L(X))_X
"RTN","RCTCSP1",280,0)
 Q X
"RTN","RCTCSP1",281,0)
 ;
"RTN","RCTCSP1",282,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP1",283,0)
 N BLANK
"RTN","RCTCSP1",284,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP1",285,0)
 Q BLANK
"RTN","RCTCSP1",286,0)
 ;
"RTN","RCTCSP1",287,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP1",288,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP1",289,0)
 Q X
"RTN","RCTCSP1",290,0)
 ;
"RTN","RCTCSP1",291,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP1",292,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP1",293,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP1",294,0)
 Q X
"RTN","RCTCSP1",295,0)
 ;
"RTN","RCTCSP1",296,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP1",297,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP1",298,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP1",299,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP1",300,0)
 Q TAXID
"RTN","RCTCSP1",301,0)
 ;
"RTN","RCTCSP1",302,0)
ADDR(RCDFN,RCCSW) ; returns patient file address
"RTN","RCTCSP1",303,0)
 N DFN,ADDRCS,STATEIEN,STATEAB,VAPA,ADDR340,PRCAYY
"RTN","RCTCSP1",304,0)
 S DFN=RCDFN
"RTN","RCTCSP1",305,0)
 D ADD^VADPT
"RTN","RCTCSP1",306,0)
 S STATEIEN=+VAPA(5),STATEAB=$$GET1^DIQ(5,STATEIEN,1)
"RTN","RCTCSP1",307,0)
 S PRCAYY="" F I=1:1:$L(VAPA(8)) I $E(VAPA(8),I)?1N S PRCAYY=PRCAYY_$E(VAPA(8),I)
"RTN","RCTCSP1",308,0)
 S VAPA(8)=PRCAYY I $L(VAPA(8))'=10 S VAPA(8)="          "    ;PRCA*4.5*336
"RTN","RCTCSP1",309,0)
 S ADDRCS=VAPA(1)_U_VAPA(2)_U_VAPA(4)_U_STATEAB_U_VAPA(6)_U_VAPA(8)_U_+VAPA(25)
"RTN","RCTCSP1",310,0)
 S ADDR340=$P($$DADD^RCAMADD(DEBTOR,,RCCSW),U,1,8)     ;PRCA*4.5*336
"RTN","RCTCSP1",311,0)
 I $P(ADDRCS,U,7)>2 S $P(ADDR340,U,6)="     "    ;PRCA*4.5*331/336
"RTN","RCTCSP1",312,0)
 S ADDR340=$P(ADDR340,U,1,2)_"^"_$P(ADDR340,U,4,7)_U_$S($P(ADDRCS,U,7)'="":$P(ADDRCS,U,7),1:1)    ;PRCA*4.5*331        
"RTN","RCTCSP1",313,0)
 I $P(ADDR340,U,7)="" S $P(ADDR340,U,7)=$P(ADDRCS,U,7)     ;PRCA*4.5*331
"RTN","RCTCSP1",314,0)
 I $P(ADDR340,U,7)>2 S $P(ADDR340,U,4)="  "     ;PRCA*4.5*331/336
"RTN","RCTCSP1",315,0)
 S ADDRCS=ADDR340
"RTN","RCTCSP1",316,0)
 Q ADDRCS
"RTN","RCTCSP1",317,0)
 ;
"RTN","RCTCSP1",318,0)
DEM(RCDFN) ; returns patient file gender and dob
"RTN","RCTCSP1",319,0)
 N DFN,VADM
"RTN","RCTCSP1",320,0)
 S DFN=RCDFN
"RTN","RCTCSP1",321,0)
 D DEM^VADPT
"RTN","RCTCSP1",322,0)
 ; return string   sex:m/f ^ dob: yyyymmdd ^ ssn ^ deceased
"RTN","RCTCSP1",323,0)
 Q $P(VADM(5),U,1)_U_$P(VADM(3),U,1)_U_$P(VADM(2),U,1)_U_VADM(6)
"RTN","RCTCSP2")
0^23^B135224269^B135421242
"RTN","RCTCSP2",1,0)
RCTCSP2 ;ALBANY/BDB - CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP2",2,0)
 ;;4.5;Accounts Receivable;**301,315,339,340,344,350**;Mar 20, 1995;Build 66
"RTN","RCTCSP2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP2",4,0)
 ;
"RTN","RCTCSP2",5,0)
 ;PRCA*4.5*344 Added total record control (>50) to 5B transaction
"RTN","RCTCSP2",6,0)
 ;             handler to insure mail messages stay within a
"RTN","RCTCSP2",7,0)
 ;             record count of 50 transactions.
"RTN","RCTCSP2",8,0)
 ;
"RTN","RCTCSP2",9,0)
 Q
"RTN","RCTCSP2",10,0)
 ;
"RTN","RCTCSP2",11,0)
COMPILE ;
"RTN","RCTCSP2",12,0)
 N RCMSG,BCNTR,REC,RECC,AMOUNT,RCNTR,ACTION,SEQ
"RTN","RCTCSP2",13,0)
 S BCNTR=0,REC=0,RECC=0,AMOUNT=0,SEQ=0
"RTN","RCTCSP2",14,0)
 F  S BCNTR=$O(^XTMP("RCTCSPD",$J,BCNTR)) Q:+BCNTR'>0  D
"RTN","RCTCSP2",15,0)
 .I REC>50 D
"RTN","RCTCSP2",16,0)
 ..D TRAILER^RCTCSP1A
"RTN","RCTCSP2",17,0)
 ..D AITCMSG
"RTN","RCTCSP2",18,0)
 ..S REC=0,RECC=0
"RTN","RCTCSP2",19,0)
 ..Q
"RTN","RCTCSP2",20,0)
 .S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",21,0)
 ..I REC=0 D HEADER^RCTCSP1A
"RTN","RCTCSP2",22,0)
 ..F RCNTR=1,2,"2A","2C",3 I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR)) D
"RTN","RCTCSP2",23,0)
 ...S REC=REC+1
"RTN","RCTCSP2",24,0)
 ...S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",25,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),1,225)_$C(94)
"RTN","RCTCSP2",26,0)
 ...S REC=REC+1
"RTN","RCTCSP2",27,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),226,999)_$C(126)
"RTN","RCTCSP2",28,0)
 ...I $E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),2)="1" S AMOUNT=AMOUNT+$E(^(RCNTR),91,104)
"RTN","RCTCSP2",29,0)
 ...Q
"RTN","RCTCSP2",30,0)
 ..I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B")) D
"RTN","RCTCSP2",31,0)
 ...N TRNNUM
"RTN","RCTCSP2",32,0)
 ...S TRNNUM=0
"RTN","RCTCSP2",33,0)
 ...F  S TRNNUM=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM)) Q:TRNNUM'?1N.N  D
"RTN","RCTCSP2",34,0)
 ....I REC>50 D    ;PRCA*4.5*344
"RTN","RCTCSP2",35,0)
 .....D TRAILER^RCTCSP1A
"RTN","RCTCSP2",36,0)
 .....D AITCMSG
"RTN","RCTCSP2",37,0)
 .....S REC=0,RECC=0
"RTN","RCTCSP2",38,0)
 .....Q
"RTN","RCTCSP2",39,0)
 ....I REC=0 D HEADER^RCTCSP1A   ;PRCA*4.5*344
"RTN","RCTCSP2",40,0)
 ....S REC=REC+1
"RTN","RCTCSP2",41,0)
 ....S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",42,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),1,225)_$C(94)
"RTN","RCTCSP2",43,0)
 ....S REC=REC+1
"RTN","RCTCSP2",44,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),226,999)_$C(126)
"RTN","RCTCSP2",45,0)
 ....S AMOUNT=AMOUNT+$TR($E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),173,186),"-")
"RTN","RCTCSP2",46,0)
 ....Q
"RTN","RCTCSP2",47,0)
 ...Q
"RTN","RCTCSP2",48,0)
 ..Q
"RTN","RCTCSP2",49,0)
 .Q
"RTN","RCTCSP2",50,0)
 D TRAILER^RCTCSP1A
"RTN","RCTCSP2",51,0)
 D AITCMSG
"RTN","RCTCSP2",52,0)
 D USRMSG
"RTN","RCTCSP2",53,0)
 Q
"RTN","RCTCSP2",54,0)
 ;
"RTN","RCTCSP2",55,0)
RCLLCHK(BILL) ;
"RTN","RCTCSP2",56,0)
 N TOTAL
"RTN","RCTCSP2",57,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSP2",58,0)
 I $P(B15,U,2),'$P(B15,U,3) D  ;recall bill
"RTN","RCTCSP2",59,0)
 .N ACTION,BILLCSL
"RTN","RCTCSP2",60,0)
 .S ACTION="L"
"RTN","RCTCSP2",61,0)
 .S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",62,0)
 .S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",63,0)
 .S $P(^PRCA(430,BILL,15),U,5)=$$GET1^DIQ(430,BILL,11) ;set the recall amount to the current amount
"RTN","RCTCSP2",64,0)
 .S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",65,0)
 .S BILLCSL=BILL ;last cs bill
"RTN","RCTCSP2",66,0)
 .D REC1^RCTCSPD
"RTN","RCTCSP2",67,0)
 .K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",68,0)
 .D RCLL^RCTCSPD4 ; set bill recall non-financial transaction PRCA*4.5*315
"RTN","RCTCSP2",69,0)
 ;
"RTN","RCTCSP2",70,0)
 ;recall bill if total <$25
"RTN","RCTCSP2",71,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP2",72,0)
 I TOTAL<25 D  Q 0
"RTN","RCTCSP2",73,0)
 .N X1,X2,P366DT,X,PRCAEN,I,RECALL
"RTN","RCTCSP2",74,0)
 .S RECALL=0
"RTN","RCTCSP2",75,0)
 .S X1=DT,X2=-366 D C^%DTC S P366DT=X
"RTN","RCTCSP2",76,0)
 .S PRCAEN=0 F I=0:0 S PRCAEN=$O(^PRCA(433,"C",BILL,PRCAEN)) Q:'PRCAEN  S:$P($G(^PRCA(433,PRCAEN,1)),U,1)>P366DT RECALL=1
"RTN","RCTCSP2",77,0)
 .I RECALL=0 D  Q
"RTN","RCTCSP2",78,0)
 ..S ACTION="L"
"RTN","RCTCSP2",79,0)
 ..S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",80,0)
 ..S $P(^PRCA(430,BILL,15),U,2)=1 ;set the recall flag
"RTN","RCTCSP2",81,0)
 ..S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",82,0)
 ..S $P(^PRCA(430,BILL,15),U,4)="07" ;set the recall reason
"RTN","RCTCSP2",83,0)
 ..S $P(^PRCA(430,BILL,15),U,5)=$P($G(^PRCA(430,BILL,16)),U,10) ;set the recall amount to the current tcsp amount
"RTN","RCTCSP2",84,0)
 ..S $P(^PRCA(430,BILL,15),U,7)=1 ;set the stop flag
"RTN","RCTCSP2",85,0)
 ..S $P(^PRCA(430,BILL,15),U,8)=DT ;set the stop date
"RTN","RCTCSP2",86,0)
 ..S $P(^PRCA(430,BILL,15),U,9)="O" ;set the stop date
"RTN","RCTCSP2",87,0)
 ..S $P(^PRCA(430,BILL,15),U,10)="AUTORECALL <$25" ;set the stop reason
"RTN","RCTCSP2",88,0)
 ..S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",89,0)
 ..D REC1^RCTCSPD,RCLL^RCTCSPD4 ; set CS Bill Recall transaction PRCA*4.5*315
"RTN","RCTCSP2",90,0)
 ..K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",91,0)
 ..S $P(^PRCA(430,BILL,19),U,10)=1 ;stop interest admin calc
"RTN","RCTCSP2",92,0)
 ..S B19=$G(^PRCA(430,BILL,19))
"RTN","RCTCSP2",93,0)
 ..Q
"RTN","RCTCSP2",94,0)
 .Q
"RTN","RCTCSP2",95,0)
 Q 0
"RTN","RCTCSP2",96,0)
 ;
"RTN","RCTCSP2",97,0)
RCRPRT ;Reconciliation report
"RTN","RCTCSP2",98,0)
 N ZTDESC,ZTRTN,POP,%ZIS,DTFRMTO,DTFRM,DTTO,PROMPT,EXCEL,DATE
"RTN","RCTCSP2",99,0)
 S DTFRMTO=$$DTFRMTO Q:'DTFRMTO  ;Get date range as per PRCA*4.5*315
"RTN","RCTCSP2",100,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3),CURDT=0
"RTN","RCTCSP2",101,0)
 S EXCEL=0,PROMPT="CAPTURE Report data to an Excel Document",DIR(0)="Y",DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSP2",102,0)
 S EXCEL=$$SELECT^RCTCSJR(PROMPT,"NO") I "01"'[EXCEL S STOP=1 Q
"RTN","RCTCSP2",103,0)
 I EXCEL=1 D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSP2",104,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS Q:POP
"RTN","RCTCSP2",105,0)
 I $D(IO("Q")) D  Q  ;
"RTN","RCTCSP2",106,0)
 .S ZTSAVE("DTFRMTO")="",ZTSAVE("EXCEL")=""
"RTN","RCTCSP2",107,0)
 .S ZTRTN="RCRPRTP^RCTCSP2",ZTDESC="RECONCILIATION REPORT"
"RTN","RCTCSP2",108,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP2",109,0)
 .I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP2",110,0)
 .Q
"RTN","RCTCSP2",111,0)
 ;
"RTN","RCTCSP2",112,0)
RCRPRTP ;print the - reconciliation report, call to build array of bills returned
"RTN","RCTCSP2",113,0)
 U IO
"RTN","RCTCSP2",114,0)
 N DASH,PAGE,DBTR,DBTRN,RCOUT,CURDT,RC18,RCRTCD,BILLIEN,DATE
"RTN","RCTCSP2",115,0)
 K ^TMP("RCTCSP2",$J)
"RTN","RCTCSP2",116,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3),CURDT=0
"RTN","RCTCSP2",117,0)
 F  S DATE=$O(^PRCA(430,"AN",DATE)),BILLIEN=0 Q:DATE=""!(DATE>DTTO)  D  ;Use new AN xref PRCA*4.5*315
"RTN","RCTCSP2",118,0)
 . F  S BILLIEN=$O(^PRCA(430,"AN",DATE,BILLIEN)) Q:BILLIEN=""  D
"RTN","RCTCSP2",119,0)
 ..I +$P($G(^PRCA(430,BILLIEN,30)),U,1)=0 Q   ;Returned date is NULL
"RTN","RCTCSP2",120,0)
 ..S DBTR=$P($G(^PRCA(430,BILLIEN,0)),U,9),DBTRN=$$GET1^DIQ(430,BILLIEN,9)
"RTN","RCTCSP2",121,0)
 ..Q:DBTRN']""
"RTN","RCTCSP2",122,0)
 ..S ^TMP("RCTCSP2",$J,DBTRN,DBTR)=""   ; store scratch by Debtor Name, Debtor IEN
"RTN","RCTCSP2",123,0)
 S PAGE=0,RCOUT=0
"RTN","RCTCSP2",124,0)
 S DASH="",$P(DASH,"-",78)=""
"RTN","RCTCSP2",125,0)
 D RCRPRTH2
"RTN","RCTCSP2",126,0)
 ;
"RTN","RCTCSP2",127,0)
 ;New fields added in PRCA*4.5*315:
"RTN","RCTCSP2",128,0)
 ;AMTREF:(#310) REC ORIGINAL TCSP AMOUNT stored in ^PRCA(430,BILL,30), piece 10
"RTN","RCTCSP2",129,0)
 ;CORDT:(#312) REC TCSP RECALL EFF. DATE stored in ^PRCA(430,BILL,30), piece 12
"RTN","RCTCSP2",130,0)
 ;DTREJ: (#172) REJECT DATE (multiple)
"RTN","RCTCSP2",131,0)
 ;See RCTCSPRS for more information on these fields
"RTN","RCTCSP2",132,0)
 ;
"RTN","RCTCSP2",133,0)
 S DBTRN=0
"RTN","RCTCSP2",134,0)
 F  S DBTRN=$O(^TMP("RCTCSP2",$J,DBTRN)) Q:DBTRN=""!RCOUT  S DBTR=0 F  S DBTR=$O(^TMP("RCTCSP2",$J,DBTRN,DBTR)) Q:'DBTR!RCOUT  D  Q:RCOUT
"RTN","RCTCSP2",135,0)
 .S BILL=0
"RTN","RCTCSP2",136,0)
 .F  S BILL=$O(^PRCA(430,"C",DBTR,BILL)) Q:BILL'?1N.N  D  Q:RCOUT
"RTN","RCTCSP2",137,0)
 ..N B0,B30,AMTREF,DTRET,CORDT,SSN
"RTN","RCTCSP2",138,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B30=$G(^PRCA(430,BILL,30))
"RTN","RCTCSP2",139,0)
 ..S AMTREF=$J($P(B30,U,10),8,2)
"RTN","RCTCSP2",140,0)
 ..S DEBTOR=$P(B0,U,9),SSN=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),SSN=$S(SSN=-1:"",1:$E(DBTRN))_$E(SSN,6,9)
"RTN","RCTCSP2",141,0)
 ..S CORDT=$$FMTE^XLFDT($P(B30,U,12),"2Z"),DTRET=""
"RTN","RCTCSP2",142,0)
 ..S DTRET=$P(B30,U) I DTRET S DTRET=$$FMTE^XLFDT(DTRET,"2Z")
"RTN","RCTCSP2",143,0)
 ..I +$P(B30,U,1)=0 Q
"RTN","RCTCSP2",144,0)
 ..I 'EXCEL W $E(DBTRN,1,16)
"RTN","RCTCSP2",145,0)
 ..I EXCEL W !,$E(DBTRN,1,14)
"RTN","RCTCSP2",146,0)
 ..I 'EXCEL W ?17,$P(B0,U,1),?29,SSN,?35,AMTREF,?44,CORDT,?53,DTRET,!
"RTN","RCTCSP2",147,0)
 ..I EXCEL W U_$P($P(B0,U,1),"-",2)_U_SSN_U_AMTREF_U_CORDT_U_DTRET
"RTN","RCTCSP2",148,0)
 ..S RCRTCD=$P(B30,U,2)
"RTN","RCTCSP2",149,0)
 ..I 'EXCEL D
"RTN","RCTCSP2",150,0)
 ...D  ;Display return reason code
"RTN","RCTCSP2",151,0)
 ....I RCRTCD="" W ?6,"NO RETURN REASON CODE",! Q
"RTN","RCTCSP2",152,0)
 ....W:$D(^PRCA(430.5,RCRTCD,0)) ?6,$P(^PRCA(430.5,RCRTCD,0),U,2),!
"RTN","RCTCSP2",153,0)
 ....W:'$D(^PRCA(430.5,RCRTCD,0)) ?6,"UNKNOWN RETURN REASON CODE: ",RCRTCD,!
"RTN","RCTCSP2",154,0)
 ....W:RCRTCD=14 ?7,"Compromise, Please write this bill off by the manual process",!,?8,"Amount (not collected): "_$J($P(B30,U,4),9,2),!  ;Added PRCA*4.5*315
"RTN","RCTCSP2",155,0)
 ....W:RCRTCD=2 ?8,"Date of Death:  "_$$FMTE^XLFDT($P(B30,U,7),"2Z"),!  ;date type (as per PRCA*4.5*315)
"RTN","RCTCSP2",156,0)
 ....W:RCRTCD=3 ?8,"Bankruptcy Date:  "_$$FMTE^XLFDT($P(B30,U,6),"2Z"),!
"RTN","RCTCSP2",157,0)
 ...W:+$P(B30,U,8) ?6,"Date of Dissolution:  "_$$FMTE^XLFDT($P(B30,U,8),"2Z"),!
"RTN","RCTCSP2",158,0)
 ..I EXCEL D
"RTN","RCTCSP2",159,0)
 ...I RCRTCD=14 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_U_"AMT NOT COLL"_U_$P(B30,U,4)
"RTN","RCTCSP2",160,0)
 ...I $P(B30,U,3)="Y" W U_"CP"_U_$J($P(B30,U,4),4,2) Q
"RTN","RCTCSP2",161,0)
 ...I RCRTCD=2 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_" "_$$FMTE^XLFDT($P(B30,U,7),"2Z") Q
"RTN","RCTCSP2",162,0)
 ...I RCRTCD=3 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_" "_$$FMTE^XLFDT($P(B30,U,6),"2Z") Q
"RTN","RCTCSP2",163,0)
 ...I RCRTCD]"" W U_$S($D(^PRCA(430.5,RCRTCD,0)):$$GET1^DIQ(430.5,RCRTCD,1),1:RCRTCD) Q
"RTN","RCTCSP2",164,0)
 ..;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP2",165,0)
 ..I 'EXCEL W ! I ($Y+5)>IOSL D
"RTN","RCTCSP2",166,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S RCOUT=1 K X,Y,DIRUT,DTOUT,DUOUT,DIROUT Q
"RTN","RCTCSP2",167,0)
 ...D RCRPRTH2
"RTN","RCTCSP2",168,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP2",169,0)
 D ^%ZISC
"RTN","RCTCSP2",170,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP2",171,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP2",172,0)
 K ^TMP("RCTCSP2",$J)
"RTN","RCTCSP2",173,0)
 Q
"RTN","RCTCSP2",174,0)
 ;
"RTN","RCTCSP2",175,0)
RCRPRTH2 ;header for reconciliation report print report 2
"RTN","RCTCSP2",176,0)
 W @IOF
"RTN","RCTCSP2",177,0)
 S PAGE=PAGE+1
"RTN","RCTCSP2",178,0)
 I 'EXCEL W "PAGE "_PAGE,?12,"RECONCILIATION REPORT ",?65,$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP2",179,0)
 I 'EXCEL D  Q
"RTN","RCTCSP2",180,0)
 .W !,DASH
"RTN","RCTCSP2",181,0)
 .W !,"DEBTOR",?17,"BILL NO.",?29,"Pt ID",?35,"Amount",?44,"Recall",?53,"Date",!
"RTN","RCTCSP2",182,0)
 .W ?35,"Refer",?44,"Eff. Dt",?53,"Return"
"RTN","RCTCSP2",183,0)
 .W !,"----------------",?17,"-----------",?29,"-----",?35,"--------",?44,"--------",?53,"--------",!
"RTN","RCTCSP2",184,0)
 ;EXCEL FORMAT
"RTN","RCTCSP2",185,0)
 W "PAGE "_PAGE_U_"RECONCILIATION REPORT "_U_$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP2",186,0)
 W !,"DEBTOR"_U_"BILL #"_U_"PT ID"_U_"AMT REF"_U_"DT RCL"_U_"DT RET"_U_"COMMENT"
"RTN","RCTCSP2",187,0)
 Q
"RTN","RCTCSP2",188,0)
 ;
"RTN","RCTCSP2",189,0)
AITCMSG ;
"RTN","RCTCSP2",190,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,CNTLID,SYSTYP
"RTN","RCTCSP2",191,0)
 S SYSTYP=$$PROD^XUPROD(1)
"RTN","RCTCSP2",192,0)
 S CNTLID=$$JD^RCTCSP1A()_$$RJZF^RCTCSP1(SEQ,4)
"RTN","RCTCSP2",193,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",194,0)
 I SYSTYP S XMY("XXX@Q-TPC.DOMAIN.EXT")=""
"RTN","RCTCSP2",195,0)
 I 'SYSTYP S XMY("XXX@Q-TXC.DOMAIN.EXT")=""
"RTN","RCTCSP2",196,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",197,0)
 S XMSUB=SITE_"/CS TRANSMISSION/BATCH#: "_CNTLID
"RTN","RCTCSP2",198,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_","""_SEQ_""",""BUILD"","
"RTN","RCTCSP2",199,0)
 D ^XMD
"RTN","RCTCSP2",200,0)
 Q
"RTN","RCTCSP2",201,0)
 ;
"RTN","RCTCSP2",202,0)
USRMSG ;sends mailman message of documents sent to user
"RTN","RCTCSP2",203,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,X,RCNT,RCDAT1,RCDAT2
"RTN","RCTCSP2",204,0)
 S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",205,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",206,0)
 .S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",207,0)
 .S XMY("G.TCSP")=""
"RTN","RCTCSP2",208,0)
 .S XMSUB="CS "_$S(ACTION="A":"ADD REFERRAL",ACTION="U":"UPDATES",ACTION="L":"RECALLS",ACTION="B":"EXISTING DEBTOR",1:"UNKNOWN")_" SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_" BATCH ID: "_CNTLID
"RTN","RCTCSP2",209,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",1)="Bill#     TIN        TYPE       AMOUNT"
"RTN","RCTCSP2",210,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",2)="-----     ---        ----       ------"
"RTN","RCTCSP2",211,0)
 .S X=0,RCNT=2 F  S X=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION,X)) Q:X=""  D
"RTN","RCTCSP2",212,0)
 ..S RCNT=RCNT+1
"RTN","RCTCSP2",213,0)
 ..S RCDAT1=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,1)
"RTN","RCTCSP2",214,0)
 ..S RCDAT2=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,2)
"RTN","RCTCSP2",215,0)
 ..S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT)=$$RJZF($P($G(^PRCA(430,X,0)),U,1),7)_$$BLANK(22)_RCDAT1_"     "_ACTION_"        "_$S(RCDAT2]"":RCDAT2,1:"")
"RTN","RCTCSP2",216,0)
 ..Q
"RTN","RCTCSP2",217,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT+1)="Total Bills: "_(RCNT-2)
"RTN","RCTCSP2",218,0)
 .S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""BILL"",""MSG"","
"RTN","RCTCSP2",219,0)
 .D ^XMD
"RTN","RCTCSP2",220,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",221,0)
 Q
"RTN","RCTCSP2",222,0)
 ;
"RTN","RCTCSP2",223,0)
THIRD ;sends mailman message to user if no third letter found
"RTN","RCTCSP2",224,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"THIRD"))
"RTN","RCTCSP2",225,0)
 N XMY,XMDUZ,XMSUB,XMTEXT
"RTN","RCTCSP2",226,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",227,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",228,0)
 N TCT,TDEB,TDEB0,TBIL,TSP,FST
"RTN","RCTCSP2",229,0)
 S XMSUB="TCSP QUALIFIED/NO 3RD LETTER SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSP2",230,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",1)="The following list of debtor bills were not sent to TCSP."
"RTN","RCTCSP2",231,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",2)="Please review debtor's account to determine why the third"
"RTN","RCTCSP2",232,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",3)="notice letter has not been sent:"
"RTN","RCTCSP2",233,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",4)="Name       Bill #"
"RTN","RCTCSP2",234,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",5)="----       ------"
"RTN","RCTCSP2",235,0)
 S TCT=6,TSP=0,TDEB=""
"RTN","RCTCSP2",236,0)
 F  S TDEB=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB)) Q:TDEB=""  D
"RTN","RCTCSP2",237,0)
 .S FST=1,TBIL=""
"RTN","RCTCSP2",238,0)
 .I FST,TCT'=6 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="",TCT=TCT+1,TSP=TSP+1
"RTN","RCTCSP2",239,0)
 .F  S TBIL=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB,TBIL)) Q:TBIL=""  D
"RTN","RCTCSP2",240,0)
 ..S TDEB0=$S(FST:TDEB,1:"")
"RTN","RCTCSP2",241,0)
 ..S ^XTMP("RCTCSPD",$J,"THIRD",TCT)=TDEB0_$J(" ",35-$L(TDEB0))_TBIL
"RTN","RCTCSP2",242,0)
 ..S TCT=TCT+1,FST=0
"RTN","RCTCSP2",243,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="Total records: "_(TCT-(6+TSP))
"RTN","RCTCSP2",244,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""THIRD"","
"RTN","RCTCSP2",245,0)
 D ^XMD
"RTN","RCTCSP2",246,0)
 K ^XTMP("RCTCSPD",$J,"THIRD")
"RTN","RCTCSP2",247,0)
THIRDQ Q
"RTN","RCTCSP2",248,0)
 ;
"RTN","RCTCSP2",249,0)
REC3 ;
"RTN","RCTCSP2",250,0)
 N REC,KNUM,DEBTNR,DEBTORNB
"RTN","RCTCSP2",251,0)
 S REC="C3 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSP2",252,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP2",253,0)
 ;S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP2",254,0)
 S DEBTNR=$$AGDEBTID^RCTCSPD,REC=REC_DEBTNR ; PRCA*4.5*350
"RTN","RCTCSP2",255,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP2",256,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP2",257,0)
 S REC=REC_$S(ACTION="L":"15",1:"  ")
"RTN","RCTCSP2",258,0)
 S REC=REC_"SLF"
"RTN","RCTCSP2",259,0)
 S REC=REC_$$BLANK(8)
"RTN","RCTCSP2",260,0)
 S REC=REC_$$AMOUNT(0)
"RTN","RCTCSP2",261,0)
 S REC=REC_$$BLANK(16)
"RTN","RCTCSP2",262,0)
 S REC=REC_"SLFIND"
"RTN","RCTCSP2",263,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP2",264,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,3)=REC
"RTN","RCTCSP2",265,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSP2",266,0)
 Q
"RTN","RCTCSP2",267,0)
 ;
"RTN","RCTCSP2",268,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP2",269,0)
 I +X S X=X+17000000
"RTN","RCTCSP2",270,0)
 S X=$E(X,1,8)
"RTN","RCTCSP2",271,0)
 Q X
"RTN","RCTCSP2",272,0)
 ;
"RTN","RCTCSP2",273,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP2",274,0)
 S:X<0 X=-X
"RTN","RCTCSP2",275,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP2",276,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP2",277,0)
 Q X
"RTN","RCTCSP2",278,0)
 ;
"RTN","RCTCSP2",279,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP2",280,0)
 N BLANK
"RTN","RCTCSP2",281,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP2",282,0)
 Q BLANK
"RTN","RCTCSP2",283,0)
 ;
"RTN","RCTCSP2",284,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP2",285,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP2",286,0)
 Q X
"RTN","RCTCSP2",287,0)
 ;
"RTN","RCTCSP2",288,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP2",289,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP2",290,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP2",291,0)
 Q X
"RTN","RCTCSP2",292,0)
 ;
"RTN","RCTCSP2",293,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP2",294,0)
 S X=X_"0000000000"
"RTN","RCTCSP2",295,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP2",296,0)
 Q X
"RTN","RCTCSP2",297,0)
 ;
"RTN","RCTCSP2",298,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP2",299,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP2",300,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP2",301,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP2",302,0)
 Q TAXID
"RTN","RCTCSP2",303,0)
 ;
"RTN","RCTCSP2",304,0)
DTFRMTO(PROMPT) ;Get from and to dates  (added as per PRCA*4.5*315 to be able to sort by dates for reports)
"RTN","RCTCSP2",305,0)
 ;INPUT:
"RTN","RCTCSP2",306,0)
 ;   PROMPT - Message to display prior to prompting for dates
"RTN","RCTCSP2",307,0)
 ;OUTPUT:
"RTN","RCTCSP2",308,0)
 ;    1^BEGDT^ENDDT - Data found
"RTN","RCTCSP2",309,0)
 ;    0     - User up arrowed or timed out
"RTN","RCTCSP2",310,0)
 ;
"RTN","RCTCSP2",311,0)
 N %DT,Y,X,BEGDT,ENDDT,DTOUT,OUT,DIRUT,DUOUT,DIROUT,DTFROM,DTTO
"RTN","RCTCSP2",312,0)
 S OUT=0
"RTN","RCTCSP2",313,0)
 W !,$G(PROMPT)
"RTN","RCTCSP2",314,0)
 S %DT="AEX"
"RTN","RCTCSP2",315,0)
 S %DT("A")="Date Range: FROM: " ;Enter Beginning Date: "
"RTN","RCTCSP2",316,0)
 S %DT("B")="T-30"
"RTN","RCTCSP2",317,0)
 W !
"RTN","RCTCSP2",318,0)
 D ^%DT
"RTN","RCTCSP2",319,0)
 K %DT
"RTN","RCTCSP2",320,0)
 Q:Y<0 OUT  ;Quit if user time out or didn't enter valid date
"RTN","RCTCSP2",321,0)
 S DTFROM=+Y
"RTN","RCTCSP2",322,0)
 S %DT="AEX"
"RTN","RCTCSP2",323,0)
 S %DT("A")="      TO:   ",%DT("B")="T" ;"TODAY"
"RTN","RCTCSP2",324,0)
 D ^%DT
"RTN","RCTCSP2",325,0)
 K %DT
"RTN","RCTCSP2",326,0)
 ;Quit if user time out or didn't enter valid date
"RTN","RCTCSP2",327,0)
 Q:Y<0 OUT
"RTN","RCTCSP2",328,0)
 S DTTO=+Y
"RTN","RCTCSP2",329,0)
 S OUT=1_U_DTFROM_U_DTTO
"RTN","RCTCSP2",330,0)
 ;Switch dates if Begin Date is more recent than End Date
"RTN","RCTCSP2",331,0)
 S:DTFROM>DTTO OUT=1_U_DTTO_U_DTFROM
"RTN","RCTCSP2",332,0)
 Q OUT
"RTN","RCTCSP2",333,0)
 ;
"RTN","RCTCSP3")
0^27^B82194427^B80430487
"RTN","RCTCSP3",1,0)
RCTCSP3 ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP3",2,0)
 ;;4.5;Accounts Receivable;**301,315,350**;Mar 20, 1995;Build 66
"RTN","RCTCSP3",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP3",4,0)
 ;
"RTN","RCTCSP3",5,0)
 Q
"RTN","RCTCSP3",6,0)
 ;
"RTN","RCTCSP3",7,0)
ENTER ;Entry point from the post initialization
"RTN","RCTCSP3",8,0)
RCCSTUP I '$D(^XTMP("REJCDCONV")) D
"RTN","RCTCSP3",9,0)
 . D NOW^%DTC S RCCSTART=%
"RTN","RCTCSP3",10,0)
 . S ^XTMP("REJCDCONV","START COMPILE")=RCCSTART
"RTN","RCTCSP3",11,0)
 . S ^XTMP("REJCDCONV","STATUS")="RUNNING"
"RTN","RCTCSP3",12,0)
 . S ^XTMP("REJCDCONV",0)=$$FMADD^XLFDT(RCCSTART,730)_"^"_RCCSTART
"RTN","RCTCSP3",13,0)
 S RCCCMPLT=0 I $G(^XTMP("REJCDCONV","STATUS"))="COMPLETE" S RCCCMPLT=1
"RTN","RCTCSP3",14,0)
AA N DEBTOR
"RTN","RCTCSP3",15,0)
 S DEBTOR=0
"RTN","RCTCSP3",16,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTCSP3",17,0)
 .N X,RCDFN,DEMCS,DEBTOR0,DEBTOR1,DEBTOR7,BILL
"RTN","RCTCSP3",18,0)
 .S DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR1=$G(^(1)),DEBTOR7=$G(^(7))
"RTN","RCTCSP3",19,0)
 .S RCDFN=+DEBTOR0
"RTN","RCTCSP3",20,0)
 .S DEMCS=$$DEM^RCTCSP1(RCDFN) Q:$E($P(DEMCS,U,3),1,5)="00000"
"RTN","RCTCSP3",21,0)
 .Q:+$P(DEMCS,U,4)  ;deceased patient
"RTN","RCTCSP3",22,0)
 .S BILL=0
"RTN","RCTCSP3",23,0)
 .F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSP3",24,0)
 ..N B0,B6,B7,B14,CAT,TOTAL
"RTN","RCTCSP3",25,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B6=$G(^(6)),B7=$G(^(7)),B14=$G(^(14))
"RTN","RCTCSP3",26,0)
 ..I 'RCCCMPLT,$D(^PRCA(430,BILL,18)) D REJCODE
"RTN","RCTCSP3",27,0)
 ..I $D(^PRCA(430,"TCSP",BILL)) Q  ;no dpn for cs bills
"RTN","RCTCSP3",28,0)
 ..Q:'$P(B0,U,2)  ;no category
"RTN","RCTCSP3",29,0)
 ..S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTCSP3",30,0)
 ..Q:'CAT
"RTN","RCTCSP3",31,0)
 ..I ",4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,33,34,35,36,37,38,39,"[(","_CAT_",") Q  ;1st party check
"RTN","RCTCSP3",32,0)
 ..I +$P(B14,U,1) Q  ;bill referred to TOP
"RTN","RCTCSP3",33,0)
 ..S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",34,0)
 ..I TOTAL'>0 Q  ;total must be greater than zero
"RTN","RCTCSP3",35,0)
 ..I '$P(B0,U,8) Q  ;if no current status
"RTN","RCTCSP3",36,0)
 ..I $P(B0,U,8)=23 Q  ;quit if write-off
"RTN","RCTCSP3",37,0)
 ..I $P(B0,U,8)=26 Q  ;quit if cancelled
"RTN","RCTCSP3",38,0)
 ..I $P(B0,U,8)=39 Q  ;quit if cancellation
"RTN","RCTCSP3",39,0)
 ..I TOTAL<25 S $P(^PRCA(430,BILL,20),U,3,8)="1^^^^^" ;set dpn flag
"RTN","RCTCSP3",40,0)
 ..Q
"RTN","RCTCSP3",41,0)
 .Q
"RTN","RCTCSP3",42,0)
 I RCCCMPLT'=1 D
"RTN","RCTCSP3",43,0)
 . D NOW^%DTC S RCCEND=%
"RTN","RCTCSP3",44,0)
 . S ^XTMP("REJCDCONV","END REJ CODE CONV")=RCCEND
"RTN","RCTCSP3",45,0)
 . S ^XTMP("REJCDCONV","STATUS")="COMPLETE"
"RTN","RCTCSP3",46,0)
 Q
"RTN","RCTCSP3",47,0)
 ;  
"RTN","RCTCSP3",48,0)
DUEPROC ; called from rctcspd
"RTN","RCTCSP3",49,0)
 N TOTAL
"RTN","RCTCSP3",50,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",51,0)
 I TOTAL<25 Q  ;no dpn record for bills less than $25
"RTN","RCTCSP3",52,0)
 I $P($G(DEBTOR3),U,10) Q  ;check site delete flag null
"RTN","RCTCSP3",53,0)
 I +$P(B12,U,1) Q  ;check date bill sent to dmc
"RTN","RCTCSP3",54,0)
 I $P(B6,U,4),($P(B6,U,5)="DOJ") Q  ;bill referred to doj
"RTN","RCTCSP3",55,0)
 I $P(B0,U,8)'=16 Q  ;status active
"RTN","RCTCSP3",56,0)
 I '$P(B6,U,3) Q  ;must have a 3rd letter
"RTN","RCTCSP3",57,0)
 D RECDPN ;create a dpn record
"RTN","RCTCSP3",58,0)
 Q
"RTN","RCTCSP3",59,0)
 ;
"RTN","RCTCSP3",60,0)
RECDPN ;
"RTN","RCTCSP3",61,0)
 N KNUM,NAME
"RTN","RCTCSP3",62,0)
 S REC="C"
"RTN","RCTCSP3",63,0)
 S REC=REC_$$RJZF(BILL,10)
"RTN","RCTCSP3",64,0)
 S REC=REC_$$TAXID(DEBTOR)
"RTN","RCTCSP3",65,0)
 S NAME=$$NAMEFF(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSP3",66,0)
 S REC=REC_$$LJSF(NAME,30)
"RTN","RCTCSP3",67,0)
 S RCDFN=+DEBTOR0
"RTN","RCTCSP3",68,0)
 S ADDRCS=$$ADDR(RCDFN)
"RTN","RCTCSP3",69,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,1),35)_$$LJSF($P(ADDRCS,U,2),35)_$$LJSF($P(ADDRCS,U,3),15)
"RTN","RCTCSP3",70,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,8),20)
"RTN","RCTCSP3",71,0)
 S REC=REC_$$BLANK(5)
"RTN","RCTCSP3",72,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,4),2)_$$LJSF($P(ADDRCS,U,5),9)
"RTN","RCTCSP3",73,0)
 S REC=REC_$$COUNTRY^RCTCSP1A($P(ADDRCS,U,7))  ;Changed routine due to SACC size issue PRCA*4.5*315
"RTN","RCTCSP3",74,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",75,0)
 S REC=REC_$$BLANK(9)
"RTN","RCTCSP3",76,0)
 S REC=REC_$$DATE8(+$P(B6,U,21))
"RTN","RCTCSP3",77,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP3",78,0)
 S REC=REC_$E(SITE,1,3)_$$LJSF(KNUM,7)
"RTN","RCTCSP3",79,0)
 S REC=REC_$$AMOUNT9(TOTAL)
"RTN","RCTCSP3",80,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,9),10)
"RTN","RCTCSP3",81,0)
 S REC=REC_$S($P(ADDRCS,U,9)="":" ",$P(ADDRCS,U,9)="US":" ",1:"F")
"RTN","RCTCSP3",82,0)
 S REC=REC_$$BLANK(250-$L(REC))
"RTN","RCTCSP3",83,0)
 S $P(^PRCA(430,BILL,20),U,4)=DT ;set the dpn request date
"RTN","RCTCSP3",84,0)
 S $P(^PRCA(430,BILL,20),U,5,8)="^^^" ;clear the print date and error codes
"RTN","RCTCSP3",85,0)
 S ^XTMP("RCTCSPDN",$J,BILL,"DPN",1)=REC
"RTN","RCTCSP3",86,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","DPN",BILL)=$$TAXID(DEBTOR)_"^"_+$E(REC,201,207)_"."_$E(REC,208,209) ;sends mailman message of documents sent to user
"RTN","RCTCSP3",87,0)
 Q
"RTN","RCTCSP3",88,0)
 ;
"RTN","RCTCSP3",89,0)
COMPILED ;
"RTN","RCTCSP3",90,0)
 N RCMSG,BCNTR,REC,RECC,AMOUNT,AMOUNT,RCNTR,ACTION,SEQ,EOF
"RTN","RCTCSP3",91,0)
 S BCNTR=0,REC=0,RECC=0,AMOUNT=0,SEQ=0,EOF=0
"RTN","RCTCSP3",92,0)
 F  S BCNTR=$O(^XTMP("RCTCSPDN",$J,BCNTR)) S:+BCNTR'>0 EOF=1 Q:+BCNTR'>0  D
"RTN","RCTCSP3",93,0)
 .I REC>120 D
"RTN","RCTCSP3",94,0)
 ..D TRAILERD
"RTN","RCTCSP3",95,0)
 ..D AITCMSGD
"RTN","RCTCSP3",96,0)
 ..S REC=0,RECC=0
"RTN","RCTCSP3",97,0)
 ..Q
"RTN","RCTCSP3",98,0)
 .S ACTION="DPN"
"RTN","RCTCSP3",99,0)
 .I REC=0 D HEADERD
"RTN","RCTCSP3",100,0)
 .S RCNTR=1 I $D(^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR)) D
"RTN","RCTCSP3",101,0)
 ..S REC=REC+1
"RTN","RCTCSP3",102,0)
 ..S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP3",103,0)
 ..S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR)_$C(126)
"RTN","RCTCSP3",104,0)
 ..S AMOUNT=AMOUNT+$E(^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR),201,209)
"RTN","RCTCSP3",105,0)
 ..Q
"RTN","RCTCSP3",106,0)
 .Q
"RTN","RCTCSP3",107,0)
 D TRAILERD
"RTN","RCTCSP3",108,0)
 D AITCMSGD
"RTN","RCTCSP3",109,0)
 D USRMSGD
"RTN","RCTCSP3",110,0)
 Q
"RTN","RCTCSP3",111,0)
 ;
"RTN","RCTCSP3",112,0)
AITCMSGD ;
"RTN","RCTCSP3",113,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,SYSTYP
"RTN","RCTCSP3",114,0)
 S SYSTYP=$$PROD^XUPROD(1) ; PRCA*4.5*350
"RTN","RCTCSP3",115,0)
 Q:'$D(^XTMP("RCTCSPDN",$J))
"RTN","RCTCSP3",116,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",117,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP3",118,0)
 I SYSTYP S XMY("XXX@Q-TPL.DOMAIN.EXT")=""
"RTN","RCTCSP3",119,0)
 I 'SYSTYP S XMY("XXX@Q-TXL.DOMAIN.EXT")=""
"RTN","RCTCSP3",120,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP3",121,0)
 S XMSUB=SITE_"/DPN TRANSMISSION/BATCH#: "_CNTLID
"RTN","RCTCSP3",122,0)
 S XMTEXT="^XTMP(""RCTCSPDN"","_$J_","""_SEQ_""",""BUILD"","
"RTN","RCTCSP3",123,0)
 D ^XMD
"RTN","RCTCSP3",124,0)
 Q
"RTN","RCTCSP3",125,0)
 ;
"RTN","RCTCSP3",126,0)
USRMSGD ;sends mailman message of documents sent to user
"RTN","RCTCSP3",127,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,X,RCNT,RCDAT1,RCDAT2
"RTN","RCTCSP3",128,0)
 Q:'$D(^XTMP("RCTCSPDN",$J))
"RTN","RCTCSP3",129,0)
 S ACTION="DPN"
"RTN","RCTCSP3",130,0)
 K ^XTMP("RCTCSPDN",$J,"BILL","MSG")
"RTN","RCTCSP3",131,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP3",132,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP3",133,0)
 S XMSUB="CS DUE PROCESS"_" SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_" BATCH ID: "_CNTLID
"RTN","RCTCSP3",134,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",1)="Bill#                            TIN         TYPE       AMOUNT"
"RTN","RCTCSP3",135,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",2)="-----                            ---         ----       ------"
"RTN","RCTCSP3",136,0)
 S X=0,RCNT=2 F  S X=$O(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X)) Q:X=""  D
"RTN","RCTCSP3",137,0)
 .S RCNT=RCNT+1
"RTN","RCTCSP3",138,0)
 .S RCDAT1=$P(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X),U,1)
"RTN","RCTCSP3",139,0)
 .S RCDAT2=$P(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X),U,2)
"RTN","RCTCSP3",140,0)
 .S ^XTMP("RCTCSPDN",$J,"BILL","MSG",RCNT)=$$RJZF($P($G(^PRCA(430,X,0)),U,1),7)_$$BLANK(22)_RCDAT1_"   "_ACTION_"        "_$S(RCDAT2]"":RCDAT2,1:"")
"RTN","RCTCSP3",141,0)
 .Q
"RTN","RCTCSP3",142,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",RCNT+1)="Total Bills: "_(RCNT-2)
"RTN","RCTCSP3",143,0)
 S XMTEXT="^XTMP(""RCTCSPDN"","_$J_",""BILL"",""MSG"","
"RTN","RCTCSP3",144,0)
 Q:$G(ONEBILL)
"RTN","RCTCSP3",145,0)
 D ^XMD
"RTN","RCTCSP3",146,0)
 K ^XTMP("RCTCSPDN",$J,"BILL","MSG")
"RTN","RCTCSP3",147,0)
 Q
"RTN","RCTCSP3",148,0)
 ;
"RTN","RCTCSP3",149,0)
HEADERD ;
"RTN","RCTCSP3",150,0)
 ;increment batch sequence number, build new header
"RTN","RCTCSP3",151,0)
 N RCMSG
"RTN","RCTCSP3",152,0)
 S SEQ=SEQ+1
"RTN","RCTCSP3",153,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",154,0)
 K ^XTMP("RCTCSPDN",$J,ACTION,"BUILD",SEQ)
"RTN","RCTCSP3",155,0)
 S RCMSG="H"_CNTLID_$$BLANK(14)_"3636001200" ;header is record type H
"RTN","RCTCSP3",156,0)
 S RCMSG=RCMSG_$$BLANK(250-$L(RCMSG))
"RTN","RCTCSP3",157,0)
 S REC=REC+1
"RTN","RCTCSP3",158,0)
 S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=RCMSG_$C(126)
"RTN","RCTCSP3",159,0)
 Q
"RTN","RCTCSP3",160,0)
 ;
"RTN","RCTCSP3",161,0)
TRAILERD ;
"RTN","RCTCSP3",162,0)
 ;trailer is type Z record
"RTN","RCTCSP3",163,0)
 I REC=0 K ^XTMP("RCTCSPDN",$J,SEQ,"BUILD") Q  ;delete batch if no records processed
"RTN","RCTCSP3",164,0)
 N RCMSG
"RTN","RCTCSP3",165,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",166,0)
 S RCMSG="Z"_$$RJZF(RECC,8)_$$AMOUNT(AMOUNT/100)_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP3",167,0)
 S RCMSG=RCMSG_$$BLANK(250-$L(RCMSG))
"RTN","RCTCSP3",168,0)
 S:EOF $E(RCMSG,229,236)="0001"_$$RJZF(SEQ,4)
"RTN","RCTCSP3",169,0)
 S REC=REC+1
"RTN","RCTCSP3",170,0)
 S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=RCMSG_$C(126)
"RTN","RCTCSP3",171,0)
 S REC=0,RECC=0,AMOUNT=0
"RTN","RCTCSP3",172,0)
 Q
"RTN","RCTCSP3",173,0)
 ;
"RTN","RCTCSP3",174,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP3",175,0)
 I +X S X=X+17000000
"RTN","RCTCSP3",176,0)
 S X=$E(X,1,8)
"RTN","RCTCSP3",177,0)
 Q X
"RTN","RCTCSP3",178,0)
 ;
"RTN","RCTCSP3",179,0)
AMOUNT(X) ;changes amount to zero filled, right justified, 14 characters
"RTN","RCTCSP3",180,0)
 S:X<0 X=-X
"RTN","RCTCSP3",181,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3",182,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP3",183,0)
 Q X
"RTN","RCTCSP3",184,0)
 ;
"RTN","RCTCSP3",185,0)
AMOUNT9(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP3",186,0)
 S:X<0 X=-X
"RTN","RCTCSP3",187,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3",188,0)
 S X=$E("000000000000",1,9-$L(X))_X
"RTN","RCTCSP3",189,0)
 Q X
"RTN","RCTCSP3",190,0)
 ;
"RTN","RCTCSP3",191,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP3",192,0)
 N BLANK
"RTN","RCTCSP3",193,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP3",194,0)
 Q BLANK
"RTN","RCTCSP3",195,0)
 ;
"RTN","RCTCSP3",196,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP3",197,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP3",198,0)
 Q X
"RTN","RCTCSP3",199,0)
 ;
"RTN","RCTCSP3",200,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP3",201,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP3",202,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP3",203,0)
 Q X
"RTN","RCTCSP3",204,0)
 ;
"RTN","RCTCSP3",205,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP3",206,0)
 S X=X_"0000000000"
"RTN","RCTCSP3",207,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP3",208,0)
 Q X
"RTN","RCTCSP3",209,0)
 ;
"RTN","RCTCSP3",210,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP3",211,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP3",212,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP3",213,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP3",214,0)
 Q TAXID
"RTN","RCTCSP3",215,0)
 ;
"RTN","RCTCSP3",216,0)
JD() ; returns today's Julian date YDOY
"RTN","RCTCSP3",217,0)
 N XMDDD,XMNOW,XMDT
"RTN","RCTCSP3",218,0)
 S XMNOW=$$NOW^XLFDT
"RTN","RCTCSP3",219,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","RCTCSP3",220,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","RCTCSP3",221,0)
 Q $E(DT,3)_XMDDD
"RTN","RCTCSP3",222,0)
 ;
"RTN","RCTCSP3",223,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSP3",224,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSP3",225,0)
 S NM=""
"RTN","RCTCSP3",226,0)
 D DEM^VADPT
"RTN","RCTCSP3",227,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSP3",228,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSP3",229,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSP3",230,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSP3",231,0)
 S DOCNM=LN_", "_FN_" "_MN
"RTN","RCTCSP3",232,0)
 Q DOCNM
"RTN","RCTCSP3",233,0)
 ;
"RTN","RCTCSP3",234,0)
ADDR(RCDFN) ; returns patient file address
"RTN","RCTCSP3",235,0)
 N DFN,ADDRCS,STATEIEN,STATEAB,VAPA
"RTN","RCTCSP3",236,0)
 S DFN=RCDFN
"RTN","RCTCSP3",237,0)
 D ADD^VADPT
"RTN","RCTCSP3",238,0)
 S STATEIEN=+VAPA(5),STATEAB=$$GET1^DIQ(5,STATEIEN,1)
"RTN","RCTCSP3",239,0)
 S ADDRCS=VAPA(1)_U_VAPA(2)_U_VAPA(4)_U_STATEAB_U_VAPA(6)_U_VAPA(8)_U_+VAPA(25)_U_VAPA(23)_U_VAPA(24) ;25-country,23-province,24-postal code
"RTN","RCTCSP3",240,0)
 I $L(DEBTOR1)>0 I $P(DEBTOR1,U,1,5)'?1"^"."^" D
"RTN","RCTCSP3",241,0)
 .N ADDR340
"RTN","RCTCSP3",242,0)
 .S ADDR340=$P($$DADD^RCAMADD(DEBTOR),U,1,7)_"^"_1
"RTN","RCTCSP3",243,0)
 .S ADDR340=$P(ADDR340,U,1,2)_"^"_$P(ADDR340,U,4,99)
"RTN","RCTCSP3",244,0)
 .I $P(ADDR340,U,6)="" S $P(ADDR340,U,6)=$P(ADDRCS,U,6)
"RTN","RCTCSP3",245,0)
 .S ADDRCS=ADDR340
"RTN","RCTCSP3",246,0)
 Q ADDRCS
"RTN","RCTCSP3",247,0)
 ;
"RTN","RCTCSP3",248,0)
REJCODE ;Converts AITC reject codes in reject multiple to pointer to file 348.5
"RTN","RCTCSP3",249,0)
 N RRI,REJI,REJCD,HREJREC,REJREC S RRI=0
"RTN","RCTCSP3",250,0)
REJA S RRI=$O(^PRCA(430,BILL,18,RRI)) Q:'RRI
"RTN","RCTCSP3",251,0)
 S REJREC=$G(^PRCA(430,BILL,18,RRI,0)),HREJREC=REJREC,REJI=3 G REJA:REJREC=""
"RTN","RCTCSP3",252,0)
 I $D(^XTMP("REJCDCONV","BB",BILL,18,RRI,0)) G REJA
"RTN","RCTCSP3",253,0)
 F REJI=REJI:1:13 S REJCD=$P(REJREC,U,REJI) I REJCD'="" D
"RTN","RCTCSP3",254,0)
 . I REJI=12,$D(^RC(348.7,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.7,"B",REJCD,0)) Q
"RTN","RCTCSP3",255,0)
 . I REJI=13,$D(^RC(348.6,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.6,"B",REJCD,0)) Q
"RTN","RCTCSP3",256,0)
 . I REJI>11 S ^XTMP("REJCDCONV","XX",BILL,18,RRI,0)=REJI_U_HREJREC Q
"RTN","RCTCSP3",257,0)
 . I REJCD>9,REJCD<100 Q
"RTN","RCTCSP3",258,0)
 . I REJCD?1.N,((REJCD>"00")&(REJCD<"10"))!((+REJCD>0)&(+REJCD<10)) S $P(REJREC,U,REJI)=+REJCD Q
"RTN","RCTCSP3",259,0)
 . I $D(^RC(348.5,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.5,"B",REJCD,0)) Q
"RTN","RCTCSP3",260,0)
 . S $P(REJREC,U,REJI)=298,^XTMP("REJCDCONV","ZZ",BILL,18,RRI,0)=$P(HREJREC,U,REJI)
"RTN","RCTCSP3",261,0)
 . Q
"RTN","RCTCSP3",262,0)
 I HREJREC'=REJREC S ^XTMP("REJCDCONV","BB",BILL,18,RRI,0)=HREJREC,^XTMP("REJCDCONV","BB",BILL,18,RRI,1)=REJREC,^PRCA(430,BILL,18,RRI,0)=REJREC
"RTN","RCTCSP3",263,0)
 G REJA
"RTN","RCTCSP4")
0^28^B218661025^B221716971
"RTN","RCTCSP4",1,0)
RCTCSP4 ;HAF/ASF - CS Debt Referral Stop Reactivate Report ;6/1/2017
"RTN","RCTCSP4",2,0)
 ;;4.5;Accounts Receivable;**315,339,350**;Mar 25, 2019;Build 66
"RTN","RCTCSP4",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP4",4,0)
 ;
"RTN","RCTCSP4",5,0)
 Q
"RTN","RCTCSP4",6,0)
 ;
"RTN","RCTCSP4",7,0)
EN ; main report entry point
"RTN","RCTCSP4",8,0)
 ;
"RTN","RCTCSP4",9,0)
 N BILLDATA,CRT,DEBRANGE,DEBTDATA,DEBTOR,DIC,DIV1,DLEVEL,DV,G,IENS,N1,NN,PTID,RCDT,RCTC,RCTCDATE
"RTN","RCTCSP4",10,0)
 N RCTCDB,RCTCDEBT1,RCTCDEBT2,RCTCDIV,RCTCDIVN,RCTCEXCEL,RCTCFLG,RCTCSP4,RCTCSTOP,RTCN,REASON,RCTN,SEPLINE,SR,SRDT,SSN,TRANDATA,USER,XDATE
"RTN","RCTCSP4",11,0)
 ;
"RTN","RCTCSP4",12,0)
 D FLAGGED(.RCTCFLG) Q:RCTCFLG=""
"RTN","RCTCSP4",13,0)
 D DEBBILL Q:RCTCDB=""
"RTN","RCTCSP4",14,0)
 I RCTCDB="D" D DLEVEL^RCTCSP4E Q
"RTN","RCTCSP4",15,0)
 D DEBTORS Q:$D(DIRUT)
"RTN","RCTCSP4",16,0)
 D DATES Q:'$D(RCTCDATE)!$D(DIRUT)
"RTN","RCTCSP4",17,0)
 S RCTCDIV="" I RCTCDB="B" D DIVSEL Q:RCTCDIV=""
"RTN","RCTCSP4",18,0)
 D FORMAT Q:RCTCEXCEL=""
"RTN","RCTCSP4",19,0)
 D DEVICE
"RTN","RCTCSP4",20,0)
 D COMP
"RTN","RCTCSP4",21,0)
 K ^TMP("RCTCSP4",$J)             ; kill scratch global at end
"RTN","RCTCSP4",22,0)
 D ^%ZISC                         ; close the device
"RTN","RCTCSP4",23,0)
 Q
"RTN","RCTCSP4",24,0)
 ;
"RTN","RCTCSP4",25,0)
EX ; main report exit point
"RTN","RCTCSP4",26,0)
 Q
"RTN","RCTCSP4",27,0)
 ;
"RTN","RCTCSP4",28,0)
STOP() ; Determine if user wants to exit out of the option entirely
"RTN","RCTCSP4",29,0)
 ; 1=yes, get out entirely
"RTN","RCTCSP4",30,0)
 ; 0=no, just go back to the previous question
"RTN","RCTCSP4",31,0)
 ;
"RTN","RCTCSP4",32,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","RCTCSP4",33,0)
 ;
"RTN","RCTCSP4",34,0)
 S DIR(0)="Y"
"RTN","RCTCSP4",35,0)
 S DIR("A")="Do you want to exit out of this option entirely"
"RTN","RCTCSP4",36,0)
 S DIR("B")="YES"
"RTN","RCTCSP4",37,0)
 S DIR("?",1)="  Enter YES to immediately exit out of this option."
"RTN","RCTCSP4",38,0)
 S DIR("?")="  Enter NO to return to the previous question."
"RTN","RCTCSP4",39,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",40,0)
 I $D(DIRUT) S Y=1
"RTN","RCTCSP4",41,0)
 Q Y
"RTN","RCTCSP4",42,0)
 ;
"RTN","RCTCSP4",43,0)
FLAGGED(RCTCFLG) ; capture if the user wants bills with a current flag, reactivated, or both
"RTN","RCTCSP4",44,0)
 ; RCTCFLG=C meaning data is currently present in the STOP TCSP REFERRAL FLAG field (430,157)
"RTN","RCTCSP4",45,0)
 ; RCTCFLG=R meaning data is currently blank in the STOP TCSP REFERRAL FLAG field (430,157)
"RTN","RCTCSP4",46,0)
 ; RCTCFLG=B meaning either is wanted
"RTN","RCTCSP4",47,0)
 ; pass parameter by reference
"RTN","RCTCSP4",48,0)
 ;
"RTN","RCTCSP4",49,0)
 N RET,DIR,X,Y
"RTN","RCTCSP4",50,0)
 S RCTCFLG="",RET=1
"RTN","RCTCSP4",51,0)
 S DIR(0)="S"
"RTN","RCTCSP4",52,0)
 S $P(DIR(0),U,2)="C:Currently Flagged;R:Reactivated;B:Both"
"RTN","RCTCSP4",53,0)
 S DIR("A")="Run the Report for"
"RTN","RCTCSP4",54,0)
 S DIR("B")="B"
"RTN","RCTCSP4",55,0)
 S DIR("?",1)="Select 'Currently Flagged' to see bills which currently have the Cross-"
"RTN","RCTCSP4",56,0)
 S DIR("?",2)="Servicing activity stop flag set."
"RTN","RCTCSP4",57,0)
 S DIR("?",3)="Select 'Reactivated' to see bills in which the stop flag is not currently"
"RTN","RCTCSP4",58,0)
 S DIR("?",4)="set, but was once set in the past."
"RTN","RCTCSP4",59,0)
 S DIR("?")="Select 'Both' to see bills of both types."
"RTN","RCTCSP4",60,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",61,0)
 I $D(DIRUT)!(Y="") S RET=0 W $C(7) G FLX
"RTN","RCTCSP4",62,0)
 S RCTCFLG=Y
"RTN","RCTCSP4",63,0)
FLX ;
"RTN","RCTCSP4",64,0)
 Q RET
"RTN","RCTCSP4",65,0)
 ;
"RTN","RCTCSP4",66,0)
DEBBILL ;
"RTN","RCTCSP4",67,0)
 ; RCTCDB=C meaning data is currently present in the STOP TCSP REFERRAL FLAG field (430,157)
"RTN","RCTCSP4",68,0)
 ; RCTCDB=R meaning data is currently blank in the STOP TCSP REFERRAL FLAG field (430,157)
"RTN","RCTCSP4",69,0)
 ;
"RTN","RCTCSP4",70,0)
 N RET,DIR,X,Y
"RTN","RCTCSP4",71,0)
 S RCTCDB="",RET=1
"RTN","RCTCSP4",72,0)
 S DIR(0)="S"
"RTN","RCTCSP4",73,0)
 S $P(DIR(0),U,2)="B:Bill Level;D:Debtor Level;"
"RTN","RCTCSP4",74,0)
 S DIR("A")="Run the Report for"
"RTN","RCTCSP4",75,0)
 S DIR("B")="Debtor"
"RTN","RCTCSP4",76,0)
 S DIR("?")="Select 'Bills' to see selected bills"
"RTN","RCTCSP4",77,0)
 S DIR("?",1)="Select 'Debtors' to see selected debtors"
"RTN","RCTCSP4",78,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",79,0)
 I $D(DIRUT)!(Y="") S RET=0 W $C(7) Q
"RTN","RCTCSP4",80,0)
 S RCTCDB=Y
"RTN","RCTCSP4",81,0)
 Q
"RTN","RCTCSP4",82,0)
DIVSEL ;
"RTN","RCTCSP4",83,0)
 N RET,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,DIC
"RTN","RCTCSP4",84,0)
 S RCTCDIV="",RET=1
"RTN","RCTCSP4",85,0)
 K RCTC("DIVS")
"RTN","RCTCSP4",86,0)
 S DIR(0)="S"
"RTN","RCTCSP4",87,0)
 S $P(DIR(0),U,2)="A:All;D:Division"
"RTN","RCTCSP4",88,0)
 S DIR("A")="Run the Report for"
"RTN","RCTCSP4",89,0)
 S DIR("B")="All"
"RTN","RCTCSP4",90,0)
 S DIR("?")="Select 'All' to see all bills, Select Division to see only bills from a single division."
"RTN","RCTCSP4",91,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",92,0)
 I $D(DIRUT)!(Y="") S RET=0 W $C(7) G FLX
"RTN","RCTCSP4",93,0)
 S RCTCDIV=Y
"RTN","RCTCSP4",94,0)
 Q:RCTCDIV="A"
"RTN","RCTCSP4",95,0)
 S DIC=40.8,DIC(0)="AEQZ" F  D ^DIC Q:Y'>0  S RCTC("DIVS",$P(Y(0),U,7))="",RCTC("DIVN",$P(Y(0),U))=$P(Y(0),U,2) ;ASF 5/6/19
"RTN","RCTCSP4",96,0)
 Q
"RTN","RCTCSP4",97,0)
 ;
"RTN","RCTCSP4",98,0)
DEBTORS ; select debtor range
"RTN","RCTCSP4",99,0)
DEBTFR ; start with debtor
"RTN","RCTCSP4",100,0)
 N RET,DIR,X,Y
"RTN","RCTCSP4",101,0)
 S RCTCDEBT1="",RET=1
"RTN","RCTCSP4",102,0)
 S DIR(0)="F^1:50"
"RTN","RCTCSP4",103,0)
 S DIR("A")="Start with Debtor"
"RTN","RCTCSP4",104,0)
 S DIR("B")="FIRST"
"RTN","RCTCSP4",105,0)
 S DIR("?",1)="If you want to specify a range of AR debtor names, enter the beginning"
"RTN","RCTCSP4",106,0)
 S DIR("?",2)="debtor name here. If you want to include all debtors, accept the default"
"RTN","RCTCSP4",107,0)
 S DIR("?")="value of FIRST here."
"RTN","RCTCSP4",108,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",109,0)
 I $D(DIRUT)!(Y="") S RET=0 W $C(7) Q
"RTN","RCTCSP4",110,0)
 S RCTCDEBT1=Y
"RTN","RCTCSP4",111,0)
 ;
"RTN","RCTCSP4",112,0)
DEBTTO ; go to debtor
"RTN","RCTCSP4",113,0)
 N RET,DIR,X,Y
"RTN","RCTCSP4",114,0)
DBT1 S RCTCDEBT2="",RET=1
"RTN","RCTCSP4",115,0)
 S DIR(0)="F^1:50"
"RTN","RCTCSP4",116,0)
 S DIR("A")="     Go to Debtor"
"RTN","RCTCSP4",117,0)
 S DIR("B")="LAST"
"RTN","RCTCSP4",118,0)
 S DIR("?",1)="If you want to specify a range of AR debtor names, enter the ending debtor"
"RTN","RCTCSP4",119,0)
 S DIR("?",2)="name here. If you want to include all debtors, accept the default value of"
"RTN","RCTCSP4",120,0)
 S DIR("?")="LAST here."
"RTN","RCTCSP4",121,0)
 D ^DIR K DIR
"RTN","RCTCSP4",122,0)
 I $D(DIRUT)!(Y="") S RET=0 W $C(7) Q
"RTN","RCTCSP4",123,0)
 S RCTCDEBT2=Y
"RTN","RCTCSP4",124,0)
 I RCTCDEBT1'="FIRST",RCTCDEBT2'="LAST",RCTCDEBT1]RCTCDEBT2 W $C(7),!!,"You must enter something after '",RCTCDEBT1,"'!",! G DBT1
"RTN","RCTCSP4",125,0)
 Q
"RTN","RCTCSP4",126,0)
 ;
"RTN","RCTCSP4",127,0)
DATES ; all dates or a date range - also capture from and thru dates
"RTN","RCTCSP4",128,0)
 ; RCTCDATE="A" or "R" if user wants All Dates or to select a Date Range
"RTN","RCTCSP4",129,0)
 ; RCTCDATE("BEGIN")=starting FM date
"RTN","RCTCSP4",130,0)
 ; RCTCDATE("END")=ending FM date
"RTN","RCTCSP4",131,0)
 ;
"RTN","RCTCSP4",132,0)
 N RET,DIR,X,Y
"RTN","RCTCSP4",133,0)
 K RCTCDATE
"RTN","RCTCSP4",134,0)
 S RET=1
"RTN","RCTCSP4",135,0)
 S DIR(0)="S^A:All Dates;R:Date Range"
"RTN","RCTCSP4",136,0)
 S DIR("A")="Include All Dates or Select by Date Range"
"RTN","RCTCSP4",137,0)
 S DIR("B")="Date Range"
"RTN","RCTCSP4",138,0)
 S DIR("?",1)="If you want to include all transaction entered dates, please select 'A' -"
"RTN","RCTCSP4",139,0)
 S DIR("?",2)="All Dates here.  But if you want to specify a date range for the"
"RTN","RCTCSP4",140,0)
 S DIR("?",3)="transaction entered dates, then enter 'R' here and then choose the from and"
"RTN","RCTCSP4",141,0)
 S DIR("?")="through dates."
"RTN","RCTCSP4",142,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",143,0)
 I $D(DIRUT)!(Y="") S ZZRET=0 W $C(7) Q
"RTN","RCTCSP4",144,0)
 S RCTCDATE=Y
"RTN","RCTCSP4",145,0)
 I RCTCDATE="A" S RCTCDATE("END")=DT_.9,RCTCDATE("BEGIN")=2840101 Q
"RTN","RCTCSP4",146,0)
 ;
"RTN","RCTCSP4",147,0)
 S DIR(0)="DA^:DT:EX"
"RTN","RCTCSP4",148,0)
 S DIR("A")="Date Entered From: "
"RTN","RCTCSP4",149,0)
 S DIR("?",1)="The From and To dates for this report refer to the date that the AR"
"RTN","RCTCSP4",150,0)
 S DIR("?")="transaction was entered."
"RTN","RCTCSP4",151,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",152,0)
 I $D(DIRUT)!'Y S RET=0 W $C(7) K RCTCDATE Q
"RTN","RCTCSP4",153,0)
 S RCTCDATE("BEGIN")=Y
"RTN","RCTCSP4",154,0)
 ;
"RTN","RCTCSP4",155,0)
 S DIR(0)="DA^"_RCTCDATE("BEGIN")_":DT:EX"
"RTN","RCTCSP4",156,0)
 S DIR("A")="  Date Entered To: "
"RTN","RCTCSP4",157,0)
 S DIR("B")="T"
"RTN","RCTCSP4",158,0)
 S DIR("?",1)="The From and To dates for this report refer to the date that the AR"
"RTN","RCTCSP4",159,0)
 S DIR("?")="transaction was entered."
"RTN","RCTCSP4",160,0)
 D ^DIR K DIR
"RTN","RCTCSP4",161,0)
 I $D(DIRUT)!'Y S RET=0 W $C(7) K RCTCDATE Q
"RTN","RCTCSP4",162,0)
 S RCTCDATE("END")=Y
"RTN","RCTCSP4",163,0)
 Q
"RTN","RCTCSP4",164,0)
 ;
"RTN","RCTCSP4",165,0)
FORMAT ; output format is Excel format or normal report output
"RTN","RCTCSP4",166,0)
 ; RCTCEXCEL=0 for normal report output
"RTN","RCTCSP4",167,0)
 ; RCTCEXCEL=1 for Excel output
"RTN","RCTCSP4",168,0)
 ; pass parameter by reference
"RTN","RCTCSP4",169,0)
 ;
"RTN","RCTCSP4",170,0)
 N RET,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","RCTCSP4",171,0)
 S RCTCEXCEL="",RET=1
"RTN","RCTCSP4",172,0)
 S DIR(0)="Y"
"RTN","RCTCSP4",173,0)
 S DIR("A")="Do you want to capture the output in Excel format"
"RTN","RCTCSP4",174,0)
 S DIR("B")="NO"
"RTN","RCTCSP4",175,0)
 S DIR("?",1)="If you want to capture the output from this report in a format which can"
"RTN","RCTCSP4",176,0)
 S DIR("?",2)="easily be imported into Excel, then answer YES here."
"RTN","RCTCSP4",177,0)
 S DIR("?",3)=" "
"RTN","RCTCSP4",178,0)
 S DIR("?")="If you just want a normal report output, then answer NO here."
"RTN","RCTCSP4",179,0)
 W ! D ^DIR K DIR
"RTN","RCTCSP4",180,0)
 I $D(DIRUT) S RET=0 W $C(7) Q
"RTN","RCTCSP4",181,0)
 S RCTCEXCEL=Y
"RTN","RCTCSP4",182,0)
 Q
"RTN","RCTCSP4",183,0)
 ;
"RTN","RCTCSP4",184,0)
DEVICE() ; Device Selection
"RTN","RCTCSP4",185,0)
 N ZTRTN,ZTDESC,ZTSAVE,POP,RET,ZTSK,DIR,X,Y
"RTN","RCTCSP4",186,0)
 S RET=1
"RTN","RCTCSP4",187,0)
 I 'RCTCEXCEL W !!,"It is recommended that you Queue this report to a device ",!,"that is 132 characters wide",!
"RTN","RCTCSP4",188,0)
 I RCTCEXCEL D
"RTN","RCTCSP4",189,0)
 . W !!,"To capture as an Excel format, it is recommended that you queue this report to"
"RTN","RCTCSP4",190,0)
 . W !,"a spool device with margins of 256 and page length of 99999,"
"RTN","RCTCSP4",191,0)
 . W !,"(e.g. spoolname;256;99999).This should help avoid wrapping problems.",!
"RTN","RCTCSP4",192,0)
 . W !,"Another method would be to set up your terminal to capture the detail report"
"RTN","RCTCSP4",193,0)
 . W !,"data. On some terminals, this can be done by clicking on the 'Tools' menu above,"
"RTN","RCTCSP4",194,0)
 . W !,"then click on 'Capture Incoming Data' to save to Desktop."
"RTN","RCTCSP4",195,0)
 . W !,"To avoid undesired wrapping of the data saved to the file,"
"RTN","RCTCSP4",196,0)
 . W !,"please enter '0;256;99999' at the 'DEVICE:' prompt."
"RTN","RCTCSP4",197,0)
 ;
"RTN","RCTCSP4",198,0)
 S ZTRTN="COMPILE^RCTCSP4"
"RTN","RCTCSP4",199,0)
 S ZTDESC="RCTC AR Cross-Servicing Stop Reactivate Report"
"RTN","RCTCSP4",200,0)
 S ZTSAVE("RCTC(")=""
"RTN","RCTCSP4",201,0)
 S ZTSAVE("RCTCDB")=""
"RTN","RCTCSP4",202,0)
 S ZTSAVE("RCTCDIV")=""
"RTN","RCTCSP4",203,0)
 S ZTSAVE("RCTCFLG")=""
"RTN","RCTCSP4",204,0)
 S ZTSAVE("RCTCDEBT1")=""
"RTN","RCTCSP4",205,0)
 S ZTSAVE("RCTCDEBT2")=""
"RTN","RCTCSP4",206,0)
 S ZTSAVE("RCTCDATE")=""
"RTN","RCTCSP4",207,0)
 S ZTSAVE("RCTCDATE(")=""
"RTN","RCTCSP4",208,0)
 S ZTSAVE("RCTCEXCEL")=""
"RTN","RCTCSP4",209,0)
 S ZTSAVE("DEBRANGE")=""
"RTN","RCTCSP4",210,0)
 S ZTSAVE("DLEVEL")=""
"RTN","RCTCSP4",211,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE,"QM",1)
"RTN","RCTCSP4",212,0)
 I POP S RET=0
"RTN","RCTCSP4",213,0)
 I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP4",214,0)
 Q RET
"RTN","RCTCSP4",215,0)
 ;
"RTN","RCTCSP4",216,0)
 ;
"RTN","RCTCSP4",217,0)
COMPILE ; entry point for the report compile to build the scratch global
"RTN","RCTCSP4",218,0)
 ; may be a background task if job queued
"RTN","RCTCSP4",219,0)
 ;
"RTN","RCTCSP4",220,0)
 I '$D(ZTQUEUED) W !!,"Compiling Cross-Servicing Stop Reactivate Report.  Please wait ... "
"RTN","RCTCSP4",221,0)
 ;
"RTN","RCTCSP4",222,0)
 D COMP                           ; build scratch global
"RTN","RCTCSP4",223,0)
 D PRINT                          ; print the report
"RTN","RCTCSP4",224,0)
 D ^%ZISC                         ; close the device
"RTN","RCTCSP4",225,0)
 I $D(ZTQUEUED) S ZTREQ="@"       ; purge the task
"RTN","RCTCSP4",226,0)
COMIPLX ;
"RTN","RCTCSP4",227,0)
 Q
"RTN","RCTCSP4",228,0)
 ;
"RTN","RCTCSP4",229,0)
COMP ; compile data into scratch global
"RTN","RCTCSP4",230,0)
 N ARTTIEN,RCTCTT,RCTCDTENT,RC433,P0,RCIBN,USER,RCTTNAME,RC340,DEBTNAME,FLAG,RCDEBTOR,RCBILLNUM
"RTN","RCTCSP4",231,0)
 ;
"RTN","RCTCSP4",232,0)
 ; first identify the AR Transaction types eligible for this report (CS STOP PLACED or CS STOP DELETED)
"RTN","RCTCSP4",233,0)
 ; load into the RCTCTT local array
"RTN","RCTCSP4",234,0)
 S ARTTIEN=0 F  S ARTTIEN=$O(^PRCA(430.3,ARTTIEN)) Q:'ARTTIEN  I $P($G(^PRCA(430.3,ARTTIEN,0)),U,1)["CS STOP" S RCTCTT(ARTTIEN)=""
"RTN","RCTCSP4",235,0)
 ;
"RTN","RCTCSP4",236,0)
 ; if no end date specified then assume all dates are OK
"RTN","RCTCSP4",237,0)
 I '$G(RCTCDATE("END")) S RCTCDATE("END")=9999999
"RTN","RCTCSP4",238,0)
 ;
"RTN","RCTCSP4",239,0)
 ; start loop
"RTN","RCTCSP4",240,0)
 S ARTTIEN=0 F  S ARTTIEN=$O(RCTCTT(ARTTIEN)) Q:'ARTTIEN  D
"RTN","RCTCSP4",241,0)
 . ;
"RTN","RCTCSP4",242,0)
 . ; determine date to start looping based on if the user specified a start date or not
"RTN","RCTCSP4",243,0)
 . S RCTCDTENT=0
"RTN","RCTCSP4",244,0)
 . I $G(RCTCDATE("BEGIN")) S RCTCDTENT=$O(^PRCA(433,"AT",ARTTIEN,RCTCDATE("BEGIN")),-1)   ; get one day earlier to start
"RTN","RCTCSP4",245,0)
 . ;
"RTN","RCTCSP4",246,0)
 . F  S RCTCDTENT=$O(^PRCA(433,"AT",ARTTIEN,RCTCDTENT)) Q:'RCTCDTENT!(RCTCDTENT>RCTCDATE("END"))  D
"RTN","RCTCSP4",247,0)
 .. S RC433=0 F  S RC433=$O(^PRCA(433,"AT",ARTTIEN,RCTCDTENT,RC433)) Q:'RC433  D
"RTN","RCTCSP4",248,0)
 ... S P0=$G(^PRCA(433,RC433,0))
"RTN","RCTCSP4",249,0)
 ... S RCIBN=+$P(P0,U,2) Q:'RCIBN                 ; bill# ien
"RTN","RCTCSP4",250,0)
 ... S USER=$P($G(^VA(200,+$P(P0,U,9),0)),U,1)    ; processed by user
"RTN","RCTCSP4",251,0)
 ... S RCTTNAME=$$GET1^DIQ(433,RC433,12)          ; trans type name
"RTN","RCTCSP4",252,0)
 ... ; now get some bill data from 430
"RTN","RCTCSP4",253,0)
 ... S RC340=+$P($G(^PRCA(430,RCIBN,0)),U,9)      ; ar debtor ien
"RTN","RCTCSP4",254,0)
 ... Q:'RC340
"RTN","RCTCSP4",255,0)
 ... Q:^RCD(340,RC340,0)'?.N1";DPT".E             ; only patients
"RTN","RCTCSP4",256,0)
 ... S DEBTNAME=$$GET1^DIQ(340,RC340,.01)         ; external ar debtor name
"RTN","RCTCSP4",257,0)
 ... Q:DEBTNAME=""
"RTN","RCTCSP4",258,0)
 ... ;
"RTN","RCTCSP4",259,0)
 ... ; check report filter on debtor name  ASF
"RTN","RCTCSP4",260,0)
 ... ;I RCTCDB'="B",'$D(RCTCSP4("DEBTOR",DEBTNAME)) Q
"RTN","RCTCSP4",261,0)
 ... I RCTCDEBT1'="FIRST",RCTCDEBT1'=DEBTNAME,RCTCDEBT1]DEBTNAME Q    ; before name range
"RTN","RCTCSP4",262,0)
 ... I RCTCDEBT2'="LAST",RCTCDEBT2'=DEBTNAME,DEBTNAME]RCTCDEBT2 Q     ; after name range
"RTN","RCTCSP4",263,0)
 ... ;
"RTN","RCTCSP4",264,0)
 ... ; Division filter
"RTN","RCTCSP4",265,0)
 ... S RCTCDIVN=$$GET1^DIQ(430,RCIBN_",",12,"I")
"RTN","RCTCSP4",266,0)
 ... I RCTCDIV="D",RCTCDIVN="" Q
"RTN","RCTCSP4",267,0)
 ... I RCTCDIV="D",'$D(RCTC("DIVS",RCTCDIVN)) Q
"RTN","RCTCSP4",268,0)
 ... ;
"RTN","RCTCSP4",269,0)
 ... ; get the current flag value and check report filter
"RTN","RCTCSP4",270,0)
 ... S FLAG=+$P($G(^PRCA(430,RCIBN,15)),U,7)      ; stop tcsp referral flag field (430,157)  1:flag set
"RTN","RCTCSP4",271,0)
 ... I RCTCFLG="R",FLAG Q                         ; user wants only Reactivated bills and this one is still flagged
"RTN","RCTCSP4",272,0)
 ... I RCTCFLG="C",'FLAG Q                        ; user wants only currently flagged bills and this flag is clear
"RTN","RCTCSP4",273,0)
 ... ;
"RTN","RCTCSP4",274,0)
 ... S RCDEBTOR=DEBTNAME_U_RC340                  ; debtor name^debtor ien (used in subscript)
"RTN","RCTCSP4",275,0)
 ... S RCBILLNUM=$$GET1^DIQ(430,RCIBN,.01)        ; bill#
"RTN","RCTCSP4",276,0)
 ... Q:RCBILLNUM=""
"RTN","RCTCSP4",277,0)
 ... ;
"RTN","RCTCSP4",278,0)
 ... ; store data at the debtor level if not already there
"RTN","RCTCSP4",279,0)
 ... I '$D(^TMP("RCTCSP4",$J,RCDEBTOR)) D
"RTN","RCTCSP4",280,0)
 .... N RCDV,SSN,PTID
"RTN","RCTCSP4",281,0)
 .... S (SSN,PTID)=""
"RTN","RCTCSP4",282,0)
 .... S SSN=$$SSN^RCFN01(RC340)
"RTN","RCTCSP4",283,0)
 .... S PTID=$E(DEBTNAME,1)_$S(SSN'="":$E(SSN,6,9),1:"0000")            ; patient id
"RTN","RCTCSP4",284,0)
 .... S ^TMP("RCTCSP4",$J,RCDEBTOR)=PTID_U_DEBTNAME_U_$S(SSN?.E9N.E:SSN,1:"")          ; save into scratch
"RTN","RCTCSP4",285,0)
 .... Q
"RTN","RCTCSP4",286,0)
 ... ;
"RTN","RCTCSP4",287,0)
 ... ; store data at the bill# level if not already there
"RTN","RCTCSP4",288,0)
 ... I '$D(^TMP("RCTCSP4",$J,RCDEBTOR,RCBILLNUM)) D
"RTN","RCTCSP4",289,0)
 .... N RCX,CAT
"RTN","RCTCSP4",290,0)
 .... S RCX=RCBILLNUM                                        ; bill#
"RTN","RCTCSP4",291,0)
 .... S $P(RCX,U,2)=$$GET1^DIQ(430,RCIBN,11)                 ; current balance
"RTN","RCTCSP4",292,0)
 .... S $P(RCX,U,3)=$$GET1^DIQ(430,RCIBN,8)                  ; current ar status name
"RTN","RCTCSP4",293,0)
 .... S $P(RCX,U,4)=$$GET1^DIQ(430,RCIBN,2)                  ; ar category name
"RTN","RCTCSP4",294,0)
 .... S $P(RCX,U,5)=$$GET1^DIQ(430,RCIBN,61,"I")             ; letter1 date FM format
"RTN","RCTCSP4",295,0)
 .... S $P(RCX,U,6)=$$GET1^DIQ(430,RCIBN,158,"I")            ; stop tcsp referral eff. date FM format
"RTN","RCTCSP4",296,0)
 .... S $P(RCX,U,7)=$$GET1^DIQ(430,RCIBN,159)                ; stop tcsp referral reason desc
"RTN","RCTCSP4",297,0)
 .... S CAT=+$P($G(^PRCA(430,RCIBN,0)),U,2)                  ; ar category ien
"RTN","RCTCSP4",298,0)
 .... S $P(RCX,U,8)=$$GET1^DIQ(430.2,CAT,1)                  ; ar category abbreviation
"RTN","RCTCSP4",299,0)
 .... S $P(RCX,U,9)=$$GET1^DIQ(430,RCIBN,12,"I")             ;site
"RTN","RCTCSP4",300,0)
 .... S ^TMP("RCTCSP4",$J,RCDEBTOR,RCBILLNUM)=RCX
"RTN","RCTCSP4",301,0)
 ... ;
"RTN","RCTCSP4",302,0)
 ... ; now we can store the AR transaction data
"RTN","RCTCSP4",303,0)
 ... S ^TMP("RCTCSP4",$J,RCDEBTOR,RCBILLNUM,RC433)=RCTTNAME_U_RCTCDTENT_U_USER
"RTN","RCTCSP4",304,0)
 . Q
"RTN","RCTCSP4",305,0)
 Q
"RTN","RCTCSP4",306,0)
 ;
"RTN","RCTCSP4",307,0)
 ;
"RTN","RCTCSP4",308,0)
PRINT ; entry point for printing the report
"RTN","RCTCSP4",309,0)
 N CRT,PAGE,RCTCSTOP,SEPLINE,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y,RCD,DEBTDATA,BILL,BILLDATA,RC433,TRANDATA
"RTN","RCTCSP4",310,0)
 S CRT=$S(IOST["C-":1,1:0)
"RTN","RCTCSP4",311,0)
 I RCTCEXCEL S IOSL=999999        ; long screen length for Excel output
"RTN","RCTCSP4",312,0)
 S PAGE=0,RCTCSTOP=0,$P(SEPLINE,"-",133)=""
"RTN","RCTCSP4",313,0)
 ;
"RTN","RCTCSP4",314,0)
 I '$D(^TMP("RCTCSP4",$J)) D HDR^RCTCSP4E W !!?5,"No data found for this report." Q
"RTN","RCTCSP4",315,0)
 I $G(ZTSTOP) D HDR^RCTCSP4E W !!?5,"This report was halted during compilation by TaskManager Request." D PX
"RTN","RCTCSP4",316,0)
 D HDR^RCTCSP4E I RCTCSTOP D PX ; display headers first for both types of output
"RTN","RCTCSP4",317,0)
 ;
"RTN","RCTCSP4",318,0)
 ; loop thru scratch, check for RCTCSTOP as we go
"RTN","RCTCSP4",319,0)
 ;
"RTN","RCTCSP4",320,0)
 S RCD="" F  S RCD=$O(^TMP("RCTCSP4",$J,RCD)) Q:RCD=""!RCTCSTOP  D
"RTN","RCTCSP4",321,0)
 . S DEBTDATA=$G(^TMP("RCTCSP4",$J,RCD))
"RTN","RCTCSP4",322,0)
 . S BILL="" F  S BILL=$O(^TMP("RCTCSP4",$J,RCD,BILL)) Q:BILL=""!RCTCSTOP  D
"RTN","RCTCSP4",323,0)
 .. S BILLDATA=$G(^TMP("RCTCSP4",$J,RCD,BILL))
"RTN","RCTCSP4",324,0)
 .. S RC433=0 F  S RC433=$O(^TMP("RCTCSP4",$J,RCD,BILL,RC433)) Q:'RC433!RCTCSTOP  D
"RTN","RCTCSP4",325,0)
 ... S TRANDATA=$G(^TMP("RCTCSP4",$J,RCD,BILL,RC433))
"RTN","RCTCSP4",326,0)
 ... D RPTLN
"RTN","RCTCSP4",327,0)
 ... Q
"RTN","RCTCSP4",328,0)
 .. Q
"RTN","RCTCSP4",329,0)
 . Q
"RTN","RCTCSP4",330,0)
 I RCTCSTOP Q  ; get out right away if stop flag is set
"RTN","RCTCSP4",331,0)
 ;
"RTN","RCTCSP4",332,0)
 I $Y+3>IOSL D HDR^RCTCSP4E I RCTCSTOP Q
"RTN","RCTCSP4",333,0)
 W !!?5,"*** End of Report ***"
"RTN","RCTCSP4",334,0)
 ;
"RTN","RCTCSP4",335,0)
PX ;
"RTN","RCTCSP4",336,0)
 I CRT,'$D(ZTQUEUED) S DIR(0)="E" D ^DIR
"RTN","RCTCSP4",337,0)
PRINTX ;
"RTN","RCTCSP4",338,0)
 Q
"RTN","RCTCSP4",339,0)
 ;
"RTN","RCTCSP4",340,0)
 I $Y+3>IOSL D HDR^RCTCSP4E I RCTCSTOP D PRINTX
"RTN","RCTCSP4",341,0)
 W !!?5,"*** End of Report ***"
"RTN","RCTCSP4",342,0)
 Q
"RTN","RCTCSP4",343,0)
 ;
"RTN","RCTCSP4",344,0)
RPTLN ; display one line on the report - either normal or Excel
"RTN","RCTCSP4",345,0)
 N TT
"RTN","RCTCSP4",346,0)
 ;
"RTN","RCTCSP4",347,0)
 ; for Excel output, print a line and get out
"RTN","RCTCSP4",348,0)
 I RCTCEXCEL D EXCELN^RCTCSP4E Q
"RTN","RCTCSP4",349,0)
 ;
"RTN","RCTCSP4",350,0)
 ; page break check
"RTN","RCTCSP4",351,0)
 I $Y+3>IOSL D HDR^RCTCSP4E I RCTCSTOP G RPTLNX
"RTN","RCTCSP4",352,0)
 ;
"RTN","RCTCSP4",353,0)
 ; write a line of report data
"RTN","RCTCSP4",354,0)
 W !,$E($P(DEBTDATA,U,2),1,27)                               ; debtor name
"RTN","RCTCSP4",355,0)
 W ?28,$P(BILLDATA,U,9),"  "                                 ;division
"RTN","RCTCSP4",356,0)
 W ?34,$P(DEBTDATA,U,1)                                      ; Pt ID
"RTN","RCTCSP4",357,0)
 ;W ?38,$P(DEBTDATA,U,3)                                     ;SSN 
"RTN","RCTCSP4",358,0)
 W ?41,$P(BILLDATA,U,1)                                      ; bill#
"RTN","RCTCSP4",359,0)
 ;W ?34,$$RJ^XLFSTR($FN($P(BILLDATA,U,2),"",2),10)           ; current balance
"RTN","RCTCSP4",360,0)
 W ?54,$E($P(BILLDATA,U,3),1,12)                             ; current status
"RTN","RCTCSP4",361,0)
 ;W ?64,$P(BILLDATA,U,8)                                     ; category abbr
"RTN","RCTCSP4",362,0)
 W ?67,$$FMTE^XLFDT($P(BILLDATA,U,5),"2Z")                   ; letter 1 date
"RTN","RCTCSP4",363,0)
 W ?77,$$FMTE^XLFDT($P(BILLDATA,U,6),"2Z")                   ; stop date
"RTN","RCTCSP4",364,0)
 W ?86,$E($P(BILLDATA,U,7),1,10)                             ; stop reason
"RTN","RCTCSP4",365,0)
 S TT=$P(TRANDATA,U,1)
"RTN","RCTCSP4",366,0)
 W ?100,$S(TT["DELETED":"DEL",TT["PLACED":"ADD",1:"UNK")     ; transaction type
"RTN","RCTCSP4",367,0)
 ;W ?105,$$FMTE^XLFDT($P(TRANDATA,U,2),"2Z")                 ; date entered
"RTN","RCTCSP4",368,0)
 W ?105,$E($P(TRANDATA,U,3),1,17)                            ; user
"RTN","RCTCSP4",369,0)
 Q
"RTN","RCTCSP4",370,0)
RPTLNDIV ;Lines for division
"RTN","RCTCSP4",371,0)
 N TT
"RTN","RCTCSP4",372,0)
 ;
"RTN","RCTCSP4",373,0)
 ; for Excel output, print a line and get out
"RTN","RCTCSP4",374,0)
 I RCTCEXCEL D EXCELN^RCTCSP4E Q
"RTN","RCTCSP4",375,0)
 ;
"RTN","RCTCSP4",376,0)
 ; page break check
"RTN","RCTCSP4",377,0)
 I $Y+3>IOSL D HDR^RCTCSP4E I RCTCSTOP G RPTLNX
"RTN","RCTCSP4",378,0)
 ;
"RTN","RCTCSP4",379,0)
 ; write a line of report data
"RTN","RCTCSP4",380,0)
 W !,$P(DEBTDATA,U,2)                                        ; debtor name
"RTN","RCTCSP4",381,0)
 W ?32,$P(BILLDATA,U,9),"  "                                  ;division
"RTN","RCTCSP4",382,0)
 W ?37,$P(DEBTDATA,U,1)                                      ; Pt ID
"RTN","RCTCSP4",383,0)
 W ?46,$P($P(BILLDATA,U,1),"-",2)                           ; bill#
"RTN","RCTCSP4",384,0)
 W ?55,$P(BILLDATA,U,8)                                      ; category abbr
"RTN","RCTCSP4",385,0)
 W ?59,$$FMTE^XLFDT($P(BILLDATA,U,5),"2Z")                   ; letter 1 date
"RTN","RCTCSP4",386,0)
 W ?69,$$FMTE^XLFDT($P(BILLDATA,U,6),"2Z")                   ; stop date
"RTN","RCTCSP4",387,0)
 W ?79,$E($P(BILLDATA,U,7),1,10)                             ; stop reason
"RTN","RCTCSP4",388,0)
 S TT=$P(TRANDATA,U,1)
"RTN","RCTCSP4",389,0)
 W ?91,$S(TT["DELETED":"DEL",TT["PLACED":"ADD",1:"UNK")     ; transaction type
"RTN","RCTCSP4",390,0)
 W ?99,$$FMTE^XLFDT($P(TRANDATA,U,2),"2Z")                  ; date entered
"RTN","RCTCSP4",391,0)
 W ?109,$E($P(TRANDATA,U,3),1,17)                            ; user
"RTN","RCTCSP4",392,0)
 ;
"RTN","RCTCSP4",393,0)
RPTLNX ;X
"RTN","RCTCSP4",394,0)
 Q
"RTN","RCTCSP4E")
0^29^B93559916^n/a
"RTN","RCTCSP4E",1,0)
RCTCSP4E ;HAF/ASF - CS Debt Referral Stop Reactivate Report ;6/1/2017
"RTN","RCTCSP4E",2,0)
 ;;4.5;Accounts Receivable;**350**;Mar 26, 2019;Build 66
"RTN","RCTCSP4E",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP4E",4,0)
 ;
"RTN","RCTCSP4E",5,0)
 Q
"RTN","RCTCSP4E",6,0)
 ;
"RTN","RCTCSP4E",7,0)
HDR ; report header
"RTN","RCTCSP4E",8,0)
 ;
"RTN","RCTCSP4E",9,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y,RCSR
"RTN","RCTCSP4E",10,0)
 ;
"RTN","RCTCSP4E",11,0)
 S CRT=0 S:IOST?1"C".E CRT=1
"RTN","RCTCSP4E",12,0)
 ; Do an end of page reader call if page# exists and device is the screen
"RTN","RCTCSP4E",13,0)
 I PAGE,CRT S DIR(0)="E" D ^DIR K DIR I 'Y S RCTCSTOP=1 G HDRX
"RTN","RCTCSP4E",14,0)
 ;
"RTN","RCTCSP4E",15,0)
 ; If screen output or page# exists, do a form feed
"RTN","RCTCSP4E",16,0)
 I PAGE!CRT W @IOF
"RTN","RCTCSP4E",17,0)
 ;
"RTN","RCTCSP4E",18,0)
 ; First printer/file page - do a left margin reset
"RTN","RCTCSP4E",19,0)
 I 'PAGE,'CRT W $C(13)
"RTN","RCTCSP4E",20,0)
 ;
"RTN","RCTCSP4E",21,0)
 S PAGE=PAGE+1    ; increment page#
"RTN","RCTCSP4E",22,0)
 ;
"RTN","RCTCSP4E",23,0)
 ; For Excel format, display the column headers only
"RTN","RCTCSP4E",24,0)
 ;
"RTN","RCTCSP4E",25,0)
 ; Display the report headers
"RTN","RCTCSP4E",26,0)
 ;
"RTN","RCTCSP4E",27,0)
 D DLHDR:RCTCDB="D",DIVHDR:RCTCDB="B"
"RTN","RCTCSP4E",28,0)
 Q  ;
"RTN","RCTCSP4E",29,0)
 W ?47,"Cross-Servicing Stop Reactivate Report by ",$S(RCTCDIV="D":"Division",1:"Debtor"),?122,"Page: ",PAGE
"RTN","RCTCSP4E",30,0)
 ;
"RTN","RCTCSP4E",31,0)
 W !,"Date Range: "
"RTN","RCTCSP4E",32,0)
 I RCTCDATE="A" W "ALL"
"RTN","RCTCSP4E",33,0)
 E  D
"RTN","RCTCSP4E",34,0)
 . W $$FMTE^XLFDT($G(RCTCDATE("BEGIN")),"2Z")," - "
"RTN","RCTCSP4E",35,0)
 . W $$FMTE^XLFDT($G(RCTCDATE("END")),"2Z")
"RTN","RCTCSP4E",36,0)
 . Q
"RTN","RCTCSP4E",37,0)
 W "  Currently Flagged, Reactivated, or Both: "
"RTN","RCTCSP4E",38,0)
 W $S(RCTCFLG="C":"Currently Flagged",RCTCFLG="R":"Reactivated",1:"Both")
"RTN","RCTCSP4E",39,0)
 I RCTCDIV="D" W "  Division: " S DIV1=0 F  S DIV1=$O(RCTC("DIVS",DIV1)) Q:DIV1'>0  W " "_DIV1
"RTN","RCTCSP4E",40,0)
 E  W "  Division: All"
"RTN","RCTCSP4E",41,0)
 W ?111,$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","RCTCSP4E",42,0)
 W !,"Debtors: "
"RTN","RCTCSP4E",43,0)
 I RCTCDB="B"!'$D(RCTCSP4("DEBTOR")) W "ALL"
"RTN","RCTCSP4E",44,0)
 E  D
"RTN","RCTCSP4E",45,0)
 . S RTCN="" F  S RTCN=$O(RCTCSP4("DEBTOR",RTCN)) Q:RTCN=""  W RTCN_" "
"RTN","RCTCSP4E",46,0)
 . Q
"RTN","RCTCSP4E",47,0)
 ;
"RTN","RCTCSP4E",48,0)
 W !,SEPLINE
"RTN","RCTCSP4E",49,0)
 W:RCTCDIV="D" !,"Debtor Name",?32,"Pt ID",?39,"Bill#",?49,"Cat",?59,"Letter1",?69,"StopDate",?79,"Reason",?89,"CS STOP",?99,"Entered",?109,"User"
"RTN","RCTCSP4E",50,0)
 W !,SEPLINE
"RTN","RCTCSP4E",51,0)
 ;
"RTN","RCTCSP4E",52,0)
 ; check for a TaskManager stop request
"RTN","RCTCSP4E",53,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD() D  G HDRX
"RTN","RCTCSP4E",54,0)
 . S (ZTSTOP,RCTCSTOP)=1
"RTN","RCTCSP4E",55,0)
 . W !!!?5,"*** Report Halted by TaskManager Request ***"
"RTN","RCTCSP4E",56,0)
 . Q
"RTN","RCTCSP4E",57,0)
 ;
"RTN","RCTCSP4E",58,0)
HDRX ;
"RTN","RCTCSP4E",59,0)
 Q
"RTN","RCTCSP4E",60,0)
 ;
"RTN","RCTCSP4E",61,0)
EXCELHD ; print an Excel header record (only 1 Excel header should print for the whole report)
"RTN","RCTCSP4E",62,0)
 ;W !,"Debtor Name",?28,"Division",?37,"Pt ID",?46,"Bill#",?55,"Status",?67,"Letter1",?77,"StopDate",?89,"Reason",?99,"CS STOP",?109,"User"
"RTN","RCTCSP4E",63,0)
 N RCH
"RTN","RCTCSP4E",64,0)
 S RCH=$$CSV("","Debtor Name")
"RTN","RCTCSP4E",65,0)
 S RCH=$$CSV(RCH,"Division")
"RTN","RCTCSP4E",66,0)
 ;S RCH=$$CSV(RCH,"Patient ID")
"RTN","RCTCSP4E",67,0)
 S RCH=$$CSV(RCH,"Pt ID")
"RTN","RCTCSP4E",68,0)
 ;S RCH=$$CSV(RCH,"SSN")
"RTN","RCTCSP4E",69,0)
 ;S RCH=$$CSV(RCH,"Bill Number")
"RTN","RCTCSP4E",70,0)
 S RCH=$$CSV(RCH,"Bill#")
"RTN","RCTCSP4E",71,0)
 ;S RCH=$$CSV(RCH,"Current Balance")
"RTN","RCTCSP4E",72,0)
 ;S RCH=$$CSV(RCH,"Current Status")
"RTN","RCTCSP4E",73,0)
 S RCH=$$CSV(RCH,"Status")
"RTN","RCTCSP4E",74,0)
 ;S RCH=$$CSV(RCH,"Category Name")
"RTN","RCTCSP4E",75,0)
 ;S RCH=$$CSV(RCH,"Category Abbr")
"RTN","RCTCSP4E",76,0)
 ;S RCH=$$CSV(RCH,"Letter1 Date")
"RTN","RCTCSP4E",77,0)
 S RCH=$$CSV(RCH,"Letter1")
"RTN","RCTCSP4E",78,0)
 S RCH=$$CSV(RCH,"StopDate")
"RTN","RCTCSP4E",79,0)
 ;S RCH=$$CSV(RCH,"Stop Reason")
"RTN","RCTCSP4E",80,0)
 S RCH=$$CSV(RCH,"Reason")
"RTN","RCTCSP4E",81,0)
 ;S RCH=$$CSV(RCH,"Transaction Type")
"RTN","RCTCSP4E",82,0)
 ;S RCH=$$CSV(RCH,"Transaction Date Entered")
"RTN","RCTCSP4E",83,0)
 ;S RCH=$$CSV(RCH,"Transaction Processed By")
"RTN","RCTCSP4E",84,0)
 S RCH=$$CSV(RCH,"CS STOP")
"RTN","RCTCSP4E",85,0)
 S RCH=$$CSV(RCH,"User")
"RTN","RCTCSP4E",86,0)
 W RCH
"RTN","RCTCSP4E",87,0)
 Q
"RTN","RCTCSP4E",88,0)
 ;
"RTN","RCTCSP4E",89,0)
EXCELN ; write a line of Excel data
"RTN","RCTCSP4E",90,0)
 N RCZ
"RTN","RCTCSP4E",91,0)
 S RCZ=$$CSV("",$P(DEBTDATA,U,2))                         ; AR Debtor Name
"RTN","RCTCSP4E",92,0)
 S RCZ=$$CSV(RCZ,$P(BILLDATA,U,9))                        ; Division
"RTN","RCTCSP4E",93,0)
 S RCZ=$$CSV(RCZ,$P(DEBTDATA,U,1))                        ; patient ID
"RTN","RCTCSP4E",94,0)
 ;S RCZ=$$CSV(RCZ,$P(DEBTDATA,U,3))                        ; SSN
"RTN","RCTCSP4E",95,0)
 S RCZ=$$CSV(RCZ,$P(BILLDATA,U,1))                        ; bill#
"RTN","RCTCSP4E",96,0)
 ;S RCZ=$$CSV(RCZ,+$P(BILLDATA,U,2))                       ; current balance
"RTN","RCTCSP4E",97,0)
 S RCZ=$$CSV(RCZ,$P(BILLDATA,U,3))                        ; AR status name
"RTN","RCTCSP4E",98,0)
 ;S RCZ=$$CSV(RCZ,$P(BILLDATA,U,4))                        ; AR category name
"RTN","RCTCSP4E",99,0)
 ;S RCZ=$$CSV(RCZ,$P(BILLDATA,U,8))                        ; AR category abbr
"RTN","RCTCSP4E",100,0)
 S RCZ=$$CSV(RCZ,$$FMTE^XLFDT($P(BILLDATA,U,5),"2Z"))     ; letter1 date
"RTN","RCTCSP4E",101,0)
 S RCZ=$$CSV(RCZ,$$FMTE^XLFDT($P(BILLDATA,U,6),"2Z"))     ; stop flag effective date
"RTN","RCTCSP4E",102,0)
 S RCZ=$$CSV(RCZ,$P(BILLDATA,U,7))                        ; stop flag reason
"RTN","RCTCSP4E",103,0)
 S TT=$P(TRANDATA,U,1)
"RTN","RCTCSP4E",104,0)
 S RCZ=$$CSV(RCZ,$S(TT["DELETED":"DEL",TT["PLACED":"ADD",1:"UNK"))
"RTN","RCTCSP4E",105,0)
 ;S RCZ=$$CSV(RCZ,$P(TRANDATA,U,1))                        ; ar transaction type desc
"RTN","RCTCSP4E",106,0)
 ;S RCZ=$$CSV(RCZ,$$FMTE^XLFDT($P(TRANDATA,U,2),"2Z"))     ; transaction date entered
"RTN","RCTCSP4E",107,0)
 S RCZ=$$CSV(RCZ,$P(TRANDATA,U,3))                        ; trans user
"RTN","RCTCSP4E",108,0)
 W !,RCZ
"RTN","RCTCSP4E",109,0)
 Q
"RTN","RCTCSP4E",110,0)
 ;
"RTN","RCTCSP4E",111,0)
CSV(STRING,DATA) ; build the Excel data string format
"RTN","RCTCSP4E",112,0)
 S STRING=$S(STRING="":DATA,1:STRING_U_DATA)
"RTN","RCTCSP4E",113,0)
 Q STRING
"RTN","RCTCSP4E",114,0)
 ; 
"RTN","RCTCSP4E",115,0)
DIVHDR ;
"RTN","RCTCSP4E",116,0)
 I RCTCEXCEL D EXCELHD Q
"RTN","RCTCSP4E",117,0)
 W !,"Date Range: "
"RTN","RCTCSP4E",118,0)
 I RCTCDATE("BEGIN")=2840101 W "All"
"RTN","RCTCSP4E",119,0)
 I RCTCDATE("BEGIN")'=2840101 W $$FMTE^XLFDT($G(RCTCDATE("BEGIN")),"2Z")," - ",$$FMTE^XLFDT($G(RCTCDATE("END")),"2Z")
"RTN","RCTCSP4E",120,0)
 W ?47,"Cross-Servicing Stop Reactivate Report by Bill",?122,"Page: ",PAGE
"RTN","RCTCSP4E",121,0)
 W ! I RCTCDIV="A" W "Division(s): All"
"RTN","RCTCSP4E",122,0)
 W ?45,"  Currently Flagged, Reactivated, or Both: "
"RTN","RCTCSP4E",123,0)
 W $S(RCTCFLG="C":"Currently Flagged",RCTCFLG="R":"Reactivated",1:"Both")
"RTN","RCTCSP4E",124,0)
 W ?111,$P($$FMTE^XLFDT($$NOW^XLFDT),":",1,2)
"RTN","RCTCSP4E",125,0)
 I RCTCDIV'="A" D
"RTN","RCTCSP4E",126,0)
 . W !,"Division(s): " S DV="",DV1="" F  S DV=$O(RCTC("DIVN",DV)) Q:DV=""  S DV1=DV1_RCTC("DIVN",DV)_"-"_DV_", "
"RTN","RCTCSP4E",127,0)
 . W $E(DV1,1,$L(DV1)-2)
"RTN","RCTCSP4E",128,0)
 W !,"Debtor Range: "
"RTN","RCTCSP4E",129,0)
 I RCTCDEBT1=("FIRST")&(RCTCDEBT2="LAST") W "ALL"
"RTN","RCTCSP4E",130,0)
 E  W RCTCDEBT1,":",RCTCDEBT2
"RTN","RCTCSP4E",131,0)
 W !,SEPLINE
"RTN","RCTCSP4E",132,0)
 W !,"Debtor Name",?24,"Division",?34,"Pt ID",?44,"Bill#",?55,"Status",?67,"Letter1",?77,"StopDate",?89,"Reason",?99,"CS STOP",?109,"User"
"RTN","RCTCSP4E",133,0)
 W !,SEPLINE
"RTN","RCTCSP4E",134,0)
 Q
"RTN","RCTCSP4E",135,0)
DLEVEL ; stop/reactivate report at 340 debtor level
"RTN","RCTCSP4E",136,0)
 K ^TMP("RCTC",$J)
"RTN","RCTCSP4E",137,0)
 D DEBTORS^RCTCSP4 Q:$D(DIRUT)
"RTN","RCTCSP4E",138,0)
 S DEBRANGE=RCTCDEBT1_":"_RCTCDEBT2
"RTN","RCTCSP4E",139,0)
 D DATES^RCTCSP4 Q:'$D(RCTCDATE)!$D(DIRUT)
"RTN","RCTCSP4E",140,0)
 S PAGE=0,RCTCSTOP=0,$P(SEPLINE,"-",133)=""
"RTN","RCTCSP4E",141,0)
 D FORMAT^RCTCSP4 Q:RCTCEXCEL=""
"RTN","RCTCSP4E",142,0)
 D DEVICE
"RTN","RCTCSP4E",143,0)
 Q
"RTN","RCTCSP4E",144,0)
QENT ;queue ENTRY
"RTN","RCTCSP4E",145,0)
 S PAGE=0,RCTCSTOP=0,$P(SEPLINE,"-",133)=""
"RTN","RCTCSP4E",146,0)
 D HDR
"RTN","RCTCSP4E",147,0)
 K ^TMP("RCTC",$J)
"RTN","RCTCSP4E",148,0)
 S DEBTOR=0 F  S DEBTOR=$O(^RCD(340,DEBTOR)) Q:DEBTOR'>0  D DSR
"RTN","RCTCSP4E",149,0)
 D PRINT
"RTN","RCTCSP4E",150,0)
 Q
"RTN","RCTCSP4E",151,0)
DSR Q:^RCD(340,DEBTOR,0)'?.E1"DPT(".E  ;only top level debtors
"RTN","RCTCSP4E",152,0)
 S DEBTNAME=$$GET1^DIQ(340,DEBTOR,.01)
"RTN","RCTCSP4E",153,0)
 I RCTCDEBT1'="FIRST",RCTCDEBT1'=DEBTNAME,RCTCDEBT1]DEBTNAME Q  ; before name range
"RTN","RCTCSP4E",154,0)
 I RCTCDEBT2'="LAST",RCTCDEBT2'=DEBTNAME,DEBTNAME]RCTCDEBT2 Q   ; after name range
"RTN","RCTCSP4E",155,0)
 S SRDT="" F  S SRDT=$O(^RCD(340,DEBTOR,8,"C",SRDT)) Q:SRDT'>0  D
"RTN","RCTCSP4E",156,0)
 . Q:(RCTCDATE("BEGIN")\1)>SRDT  ;check date range
"RTN","RCTCSP4E",157,0)
 . Q:(RCTCDATE("END")_.99)<SRDT
"RTN","RCTCSP4E",158,0)
 . S N1=0 F  S N1=$O(^RCD(340,DEBTOR,8,"C",SRDT,N1)) Q:N1'>0  D
"RTN","RCTCSP4E",159,0)
 .. S NN=DEBTNAME
"RTN","RCTCSP4E",160,0)
 .. S G=^RCD(340,DEBTOR,8,N1,0),RCDT=$P(G,U,2),RCSR=$P(G,U),G(N1)=G
"RTN","RCTCSP4E",161,0)
 .. I RCTCFLG="R"&(RCSR="R") S ^TMP("RCTC",$J,NN,DEBTOR,RCDT)=N1  ;Filter stops
"RTN","RCTCSP4E",162,0)
 .. I RCTCFLG="C"&(RCSR="S") S ^TMP("RCTC",$J,NN,DEBTOR,RCDT)=N1 ;Filter reactivates
"RTN","RCTCSP4E",163,0)
 .. I RCTCFLG="B" S ^TMP("RCTC",$J,NN,DEBTOR,RCDT)=N1
"RTN","RCTCSP4E",164,0)
 Q
"RTN","RCTCSP4E",165,0)
PRINT ;print for debtor level
"RTN","RCTCSP4E",166,0)
 S NN="" F  S NN=$O(^TMP("RCTC",$J,NN)) Q:NN=""  Q:RCTCSTOP  S DEBTOR=0 F  S DEBTOR=$O(^TMP("RCTC",$J,NN,DEBTOR)) Q:DEBTOR'>0  D
"RTN","RCTCSP4E",167,0)
 . S RCDT=0 F  S RCDT=$O(^TMP("RCTC",$J,NN,DEBTOR,RCDT)) Q:RCDT'>0  Q:RCTCSTOP  D
"RTN","RCTCSP4E",168,0)
 .. S N1=^TMP("RCTC",$J,NN,DEBTOR,RCDT)
"RTN","RCTCSP4E",169,0)
 .. S SSN=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP4E",170,0)
 .. S PTID=$E(NN,1)_$S(SSN'="":$E(SSN,6,9),1:"0000")            ; patient id
"RTN","RCTCSP4E",171,0)
 .. S IENS=N1_","_DEBTOR_"," S REASON=$$GET1^DIQ(340.08,IENS,.04) ; REason
"RTN","RCTCSP4E",172,0)
 .. S G=^RCD(340,DEBTOR,8,N1,0)
"RTN","RCTCSP4E",173,0)
 .. S SR=$P(G,U)
"RTN","RCTCSP4E",174,0)
 .. S XDATE=$E($P(G,U,2),1,12) S XDATE=$E(XDATE,4,5)_"/"_$E(XDATE,6,7)_"/"_$E(XDATE,2,3)  ;_"@"_$P(XDATE,".",2)
"RTN","RCTCSP4E",175,0)
 .. S USER=$P(G,U,3) S USER=$$GET1^DIQ(200,USER_",",.01)
"RTN","RCTCSP4E",176,0)
 .. I RCTCEXCEL D DEXLN Q
"RTN","RCTCSP4E",177,0)
 .. W !,NN ;NAME
"RTN","RCTCSP4E",178,0)
 .. W ?35,PTID
"RTN","RCTCSP4E",179,0)
 .. W ?42,SSN
"RTN","RCTCSP4E",180,0)
 .. W ?54,SR
"RTN","RCTCSP4E",181,0)
 .. W ?57,XDATE
"RTN","RCTCSP4E",182,0)
 .. W ?75,REASON
"RTN","RCTCSP4E",183,0)
 .. ;W ?85,$P(G,U,5) ;COMMENT
"RTN","RCTCSP4E",184,0)
 .. W ?107,USER
"RTN","RCTCSP4E",185,0)
 .. W *7 I $Y+3>IOSL D HDR^RCTCSP4E ;I RCTCSTOP Q
"RTN","RCTCSP4E",186,0)
 W !!,?20,"*** ",$S($G(RCTCSTOP):"Report Ended",1:"End of Report")," ***"
"RTN","RCTCSP4E",187,0)
 I $E(IOST,1,2)="C-",'$D(DIRUT),'$G(RCTCSTOP) R !!,"Type <Enter> to continue or '^' to exit:",X:DTIME W @IOF
"RTN","RCTCSP4E",188,0)
 Q
"RTN","RCTCSP4E",189,0)
DLHDR ;Debtor Level Header
"RTN","RCTCSP4E",190,0)
 I RCTCEXCEL=1 D DLXHD Q
"RTN","RCTCSP4E",191,0)
 W !,"Date Range: "
"RTN","RCTCSP4E",192,0)
 I RCTCDATE="A" W "All"
"RTN","RCTCSP4E",193,0)
 E  W $$FMTE^XLFDT($G(RCTCDATE("BEGIN")),"2Z")," - ",$$FMTE^XLFDT($G(RCTCDATE("END")),"2Z")
"RTN","RCTCSP4E",194,0)
 W ?35,"Cross-Servicing Stop Reactivate Report at Debtor Level",?122,"Page: ",PAGE
"RTN","RCTCSP4E",195,0)
 W !?33,"  Currently Flagged, Reactivated, or Both: "
"RTN","RCTCSP4E",196,0)
 W $S(RCTCFLG="C":"Currently Flagged",RCTCFLG="R":"Reactivated",1:"Both")
"RTN","RCTCSP4E",197,0)
 W !,"Debtor Range: ",DEBRANGE
"RTN","RCTCSP4E",198,0)
 W ?111,$P($$FMTE^XLFDT($$NOW^XLFDT),":",1,2)
"RTN","RCTCSP4E",199,0)
 W !,SEPLINE
"RTN","RCTCSP4E",200,0)
 W !,"Debtor Name",?35,"Pt ID",?42,"SSN",?53,"S/R",?57,"Date",?75,"Reason",?107,"User"
"RTN","RCTCSP4E",201,0)
 W !,SEPLINE
"RTN","RCTCSP4E",202,0)
 Q
"RTN","RCTCSP4E",203,0)
DEVICE() ; Device Selection
"RTN","RCTCSP4E",204,0)
 N ZTRTN,ZTDESC,ZTSAVE,POP,RET,ZTSK,DIR,X,Y
"RTN","RCTCSP4E",205,0)
 S RET=1
"RTN","RCTCSP4E",206,0)
 I 'RCTCEXCEL W !!,"It is recommended that you Queue this report to a device ",!,"that is 132 characters wide",!
"RTN","RCTCSP4E",207,0)
 I RCTCEXCEL D
"RTN","RCTCSP4E",208,0)
 . W !!,"To capture as an Excel format, it is recommended that you queue this report to"
"RTN","RCTCSP4E",209,0)
 . W !,"a spool device with margins of 256 and page length of 99999,"
"RTN","RCTCSP4E",210,0)
 . W !,"(e.g. spoolname;256;99999).This should help avoid wrapping problems.",!
"RTN","RCTCSP4E",211,0)
 . W !,"Another method would be to set up your terminal to capture the detail report"
"RTN","RCTCSP4E",212,0)
 . W !,"data. On some terminals, this can be done by clicking on the 'Tools' menu above,"
"RTN","RCTCSP4E",213,0)
 . W !,"then click on 'Capture Incoming Data' to save to Desktop."
"RTN","RCTCSP4E",214,0)
 . W !,"To avoid undesired wrapping of the data saved to the file,"
"RTN","RCTCSP4E",215,0)
 . W !,"please enter '0;256;99999' at the 'DEVICE:' prompt."
"RTN","RCTCSP4E",216,0)
 ;
"RTN","RCTCSP4E",217,0)
 S ZTRTN="QENT^RCTCSP4E"
"RTN","RCTCSP4E",218,0)
 S ZTDESC="RCTC AR Cross-Servicing Stop Reactivate Report DEBTOR LEVEL"
"RTN","RCTCSP4E",219,0)
 S ZTSAVE("RCTC(")=""
"RTN","RCTCSP4E",220,0)
 S ZTSAVE("RCTCDB")=""
"RTN","RCTCSP4E",221,0)
 S ZTSAVE("RCTCDIV")=""
"RTN","RCTCSP4E",222,0)
 S ZTSAVE("RCTCFLG")=""
"RTN","RCTCSP4E",223,0)
 S ZTSAVE("RCTCDEBT1")=""
"RTN","RCTCSP4E",224,0)
 S ZTSAVE("RCTCDEBT2")=""
"RTN","RCTCSP4E",225,0)
 S ZTSAVE("RCTCDATE")=""
"RTN","RCTCSP4E",226,0)
 S ZTSAVE("RCTCDATE(")=""
"RTN","RCTCSP4E",227,0)
 S ZTSAVE("RCTCEXCEL")=""
"RTN","RCTCSP4E",228,0)
 S ZTSAVE("DEBRANGE")=""
"RTN","RCTCSP4E",229,0)
 S ZTSAVE("DLEVEL")=""
"RTN","RCTCSP4E",230,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE,"QM",1)
"RTN","RCTCSP4E",231,0)
 I POP S RET=0
"RTN","RCTCSP4E",232,0)
 I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP4E",233,0)
 Q RET
"RTN","RCTCSP4E",234,0)
 ;
"RTN","RCTCSP4E",235,0)
DLXHD ; print an Excel header record DEBTOR level
"RTN","RCTCSP4E",236,0)
 N RCH
"RTN","RCTCSP4E",237,0)
 S RCH=$$CSV("","Debtor Name")
"RTN","RCTCSP4E",238,0)
 S RCH=$$CSV(RCH,"Pt ID")
"RTN","RCTCSP4E",239,0)
 S RCH=$$CSV(RCH,"SSN")
"RTN","RCTCSP4E",240,0)
 S RCH=$$CSV(RCH,"S/R")
"RTN","RCTCSP4E",241,0)
 S RCH=$$CSV(RCH,"Date")
"RTN","RCTCSP4E",242,0)
 S RCH=$$CSV(RCH,"Reason")
"RTN","RCTCSP4E",243,0)
 S RCH=$$CSV(RCH,"User")
"RTN","RCTCSP4E",244,0)
 W RCH
"RTN","RCTCSP4E",245,0)
 Q
"RTN","RCTCSP4E",246,0)
DEXLN ; write a line of Excel data for debtor
"RTN","RCTCSP4E",247,0)
 N RCZ
"RTN","RCTCSP4E",248,0)
 S RCZ=$$CSV("",NN)                         ; AR Debtor Name
"RTN","RCTCSP4E",249,0)
 S RCZ=$$CSV(RCZ,PTID)                        ; patient ID
"RTN","RCTCSP4E",250,0)
 S RCZ=$$CSV(RCZ,SSN)                        ; SSN
"RTN","RCTCSP4E",251,0)
 S RCZ=$$CSV(RCZ,SR)                        ; SR
"RTN","RCTCSP4E",252,0)
 S RCZ=$$CSV(RCZ,XDATE)                       ; Date
"RTN","RCTCSP4E",253,0)
 S RCZ=$$CSV(RCZ,REASON)                       ; reason
"RTN","RCTCSP4E",254,0)
 S RCZ=$$CSV(RCZ,USER)                        ; CLERK
"RTN","RCTCSP4E",255,0)
 W !,RCZ
"RTN","RCTCSP4E",256,0)
 Q
"RTN","RCTCSP6")
0^21^B25942174^n/a
"RTN","RCTCSP6",1,0)
RCTCSP6 ;ALB/YG - Cross-Servicing Re-Referred Bills Report;03/15/14 3:34 PM
"RTN","RCTCSP6",2,0)
 ;;4.5;Accounts Receivable;**350**;Mar 20, 1995;Build 66
"RTN","RCTCSP6",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP6",4,0)
 ;
"RTN","RCTCSP6",5,0)
 ;
"RTN","RCTCSP6",6,0)
MAIN ;PRCA*4.5*350
"RTN","RCTCSP6",7,0)
 ;
"RTN","RCTCSP6",8,0)
BILLREP ;Cross-servicing bill report, prints individual bills that make up a cross-servicing account
"RTN","RCTCSP6",9,0)
 N DIC,DEBTOR,ZTSAVE,ZTDESC,ZTRTN,POP,DTFRMTO,PROMPT,EXCEL,RUNDATE,PAGE,DFN
"RTN","RCTCSP6",10,0)
 S RUNDATE=$$FMTE^XLFDT($$NOW^XLFDT,"9MP")
"RTN","RCTCSP6",11,0)
 K ^TMP("RCTCSP1",$J)
"RTN","RCTCSP6",12,0)
 S PAGE=0
"RTN","RCTCSP6",13,0)
 W !,"*** Cross-Servicing Re-Referred Bills Report ***",!
"RTN","RCTCSP6",14,0)
 W !,"The Cross-Servicing Re-Referred Bills Report provides a list of all bills"
"RTN","RCTCSP6",15,0)
 W !,"that have been re-referred to Cross-Servicing.",!
"RTN","RCTCSP6",16,0)
 ;S DIC=340,DIC(0)="AEQM",DIC("S")="I $D(^RCD(340,""TCSP"",+Y))" D ^DIC
"RTN","RCTCSP6",17,0)
 ;Q:Y<1  S DEBTOR=+Y
"RTN","RCTCSP6",18,0)
 ;S DTFRMTO=$$DTFRMTO^RCTCSP2 Q:'DTFRMTO  ;Get date range as per PRCA*4.5*315
"RTN","RCTCSP6",19,0)
 S DTFRMTO=$$DATE2^RCDMCUT2("  Enter the Date Range for Bills that have been Re-Referred for Cross-Servicing:  ",,"T-7")
"RTN","RCTCSP6",20,0)
 S EXCEL=0,PROMPT="CAPTURE Report data to an Excel Document",DIR(0)="Y",DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSP6",21,0)
 ;S EXCEL=$$SELECT^RCTCSJR(PROMPT,"NO") 
"RTN","RCTCSP6",22,0)
 S EXCEL=$$EXCEL^RCDMCUT2
"RTN","RCTCSP6",23,0)
 I "01"'[EXCEL Q
"RTN","RCTCSP6",24,0)
 I EXCEL D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSP6",25,0)
 I 'EXCEL W !,"It is recommended that you Queue this report to a device that is 132 characters wide. "
"RTN","RCTCSP6",26,0)
 S %ZIS="MQ" D ^%ZIS G:POP BILLREPQ     ;PRC*4.5*336
"RTN","RCTCSP6",27,0)
 I $D(IO("Q")) D  G BILLREPQ
"RTN","RCTCSP6",28,0)
 .S ZTSAVE("DEBTOR")="",ZTSAVE("DTFRMTO")="",ZTSAVE("EXCEL")=""
"RTN","RCTCSP6",29,0)
 .S ZTRTN="BILLREPP^RCTCSP6",ZTDESC="CROSS-SERVICING BILL REPORT"
"RTN","RCTCSP6",30,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP6",31,0)
 .I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP6",32,0)
 .Q
"RTN","RCTCSP6",33,0)
 ;
"RTN","RCTCSP6",34,0)
BILLREPP ;Call to build array of bills referred
"RTN","RCTCSP6",35,0)
 U IO
"RTN","RCTCSP6",36,0)
 N BILL,B7,B14,B15,B16,D4,FND,BAMT,DIRUT,TNM,TID,TDT,DASH,CSTAT,PAGE,DASH,TMP,I,DATE,DTFRM,DTTO,DATDATE,REASON,COMMENT,USER,OAMT,LIEN,NAME,NODE,SSN
"RTN","RCTCSP6",37,0)
 K ^TMP("RCTCSP6",$J)
"RTN","RCTCSP6",38,0)
 S DASH="",$P(DASH,"-",78)=""  ;(as per PRCA*4.5*315)
"RTN","RCTCSP6",39,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2)),DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSP6",40,0)
 S (BAMT,BILL,PAGE)=0
"RTN","RCTCSP6",41,0)
 ; rewritten to sort by "TCSP" (#151 date referred to TCSP) not the "AB" xref... PRCA*4.5*315 (TV8)
"RTN","RCTCSP6",42,0)
 F  S BILL=$O(^PRCA(430,"TCSP",BILL)) Q:BILL=""!($D(DIRUT))  D:$$RR^RCTCSPU(BILL)
"RTN","RCTCSP6",43,0)
 .S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9)
"RTN","RCTCSP6",44,0)
 .S DFN=$P($G(^RCD(340,DEBTOR,0)),U) Q:DFN'[";DPT" 
"RTN","RCTCSP6",45,0)
 .S DFN=+DFN
"RTN","RCTCSP6",46,0)
 .D DEM^VADPT
"RTN","RCTCSP6",47,0)
 .I $G(VAERR)>0 D KVAR^VADPT Q
"RTN","RCTCSP6",48,0)
 .S NAME=$G(VADM(1))
"RTN","RCTCSP6",49,0)
 .I NAME']"" D KVAR^VADPT Q
"RTN","RCTCSP6",50,0)
 .S SSN=$P(VADM(2),U,1)
"RTN","RCTCSP6",51,0)
 .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP6",52,0)
 .S DATDATE=$P($G(^PRCA(430,BILL,15)),U) Q:DATDATE<DTFRM!(DATDATE>DTTO)
"RTN","RCTCSP6",53,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSP6",54,0)
 .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP6",55,0)
 .S ^TMP("RCTCSP6",$J,DEBTOR,BILL)=BAMT_U_NAME_U_SSN
"RTN","RCTCSP6",56,0)
 D BILLREPH
"RTN","RCTCSP6",57,0)
 S DEBTOR="" F  S DEBTOR=$O(^TMP("RCTCSP6",$J,DEBTOR)) Q:'DEBTOR!($D(DIRUT))  D  Q:$D(DIRUT)
"RTN","RCTCSP6",58,0)
 . S BILL=0 F  S BILL=$O(^TMP("RCTCSP6",$J,DEBTOR,BILL)) Q:'BILL  D  Q:$D(DIRUT)
"RTN","RCTCSP6",59,0)
 ..Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP6",60,0)
 ..S NODE=^TMP("RCTCSP6",$J,DEBTOR,BILL),BAMT=$P(NODE,U),NAME=$P(NODE,U,2),SSN=$P(NODE,U,3)
"RTN","RCTCSP6",61,0)
 ..S FND=1 W !,$P(^PRCA(430,BILL,0),U) ; Bill
"RTN","RCTCSP6",62,0)
 ..S CSTAT=$P(^(0),U,8),B7=$G(^(7)),B15=$G(^(15)),B16=$G(^(16))
"RTN","RCTCSP6",63,0)
 ..I 'EXCEL W ?14,$E(NAME,1,17) ; Name
"RTN","RCTCSP6",64,0)
 ..I EXCEL W U,NAME
"RTN","RCTCSP6",65,0)
 ..I 'EXCEL W ?34,SSN ; SSN
"RTN","RCTCSP6",66,0)
 ..I EXCEL W U,SSN
"RTN","RCTCSP6",67,0)
 ..I 'EXCEL W ?45,$$FMTE^XLFDT($P(B15,U,1),"2Z") ; Rerefer date
"RTN","RCTCSP6",68,0)
 ..I EXCEL W U,$$FMTE^XLFDT($P(B15,U,1),"2Z")
"RTN","RCTCSP6",69,0)
 ..S OAMT=$P(B16,U,9) I OAMT'>0 S OAMT=$P($G(^PRCA(430,BILL,30)),U,10)
"RTN","RCTCSP6",70,0)
 ..I 'EXCEL W ?55,$J("$"_$FN(OAMT,",",2),11) ; Original Amt
"RTN","RCTCSP6",71,0)
 ..I EXCEL W U,"$"_$FN(OAMT,",",2)
"RTN","RCTCSP6",72,0)
 ..I 'EXCEL W ?70,$J("$"_$FN(BAMT,",",2),11) ; Curr Amt
"RTN","RCTCSP6",73,0)
 ..I EXCEL W U,"$"_$FN(BAMT,",",2)
"RTN","RCTCSP6",74,0)
 ..I 'EXCEL,OAMT-BAMT'=0 W ?85,$J("$"_$FN(OAMT-BAMT,",",2),11) ; diff amt
"RTN","RCTCSP6",75,0)
 ..I EXCEL W U W:OAMT-BAMT'=0 "$",$FN(OAMT-BAMT,",",2)
"RTN","RCTCSP6",76,0)
 ..S LIEN=$O(^PRCA(430,BILL,15.5,"B",0,""),-1)
"RTN","RCTCSP6",77,0)
 ..S REASON=$P(^PRCA(430,BILL,15.5,LIEN,0),U,4)
"RTN","RCTCSP6",78,0)
 ..S REASON=$S(REASON="T":"Treas RVSL",REASON="R":"Recall Error",REASON="D":"DFLT RPP",REASON="O":"Other")
"RTN","RCTCSP6",79,0)
 ..S USER=$P(^PRCA(430,BILL,15.5,LIEN,0),U,3),USER=$P(^VA(200,USER,0),U)
"RTN","RCTCSP6",80,0)
 ..I 'EXCEL W ?100,$E(REASON,1,15)
"RTN","RCTCSP6",81,0)
 ..I EXCEL W U,REASON
"RTN","RCTCSP6",82,0)
 ..I 'EXCEL W ?116,$E(USER,1,16)
"RTN","RCTCSP6",83,0)
 ..I EXCEL W U,USER
"RTN","RCTCSP6",84,0)
 ..;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP6",85,0)
 ..I ($Y+3)>IOSL D
"RTN","RCTCSP6",86,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR Q:$D(DIRUT)
"RTN","RCTCSP6",87,0)
 ...D BILLREPH
"RTN","RCTCSP6",88,0)
 I $E(IOST,1,2)="C-",'$D(DIRUT) R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP6",89,0)
 D ^%ZISC
"RTN","RCTCSP6",90,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP6",91,0)
 K ^TMP("RCTCSP6",$J)
"RTN","RCTCSP6",92,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP6",93,0)
BILLREPQ Q
"RTN","RCTCSP6",94,0)
 ;
"RTN","RCTCSP6",95,0)
BILLREPH ;header for cross-servicing bill report
"RTN","RCTCSP6",96,0)
 W @IOF
"RTN","RCTCSP6",97,0)
 S PAGE=PAGE+1
"RTN","RCTCSP6",98,0)
 I 'EXCEL D
"RTN","RCTCSP6",99,0)
 . W @IOF,"Cross-Servicing Re-Referred Bills Report   -- Run Date: ",RUNDATE," --"
"RTN","RCTCSP6",100,0)
 . W ?122,"Page "_PAGE
"RTN","RCTCSP6",101,0)
 . W !,"    Re-Referred Dates from ",$$FMTE^XLFDT(DTFRM,"9D")," to ",$$FMTE^XLFDT(DTTO,"9D")
"RTN","RCTCSP6",102,0)
 . W !
"RTN","RCTCSP6",103,0)
 ;I 'EXCEL W "PAGE "_PAGE,?24,"CROSS-SERVICING BILL REPORT",?60,$$FMTE^XLFDT(DT,"2Z"),!,DASH
"RTN","RCTCSP6",104,0)
 ;I EXCEL W "PAGE "_PAGE_U_"CROSS-SERVICING BILL REPORT"_U_U_$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP6",105,0)
 ;N RCHDR,RCSSN
"RTN","RCTCSP6",106,0)
 ;S RCHDR=$$ACCNTHDR^RCDPAPLM(DEBTOR),RCSSN=$S($P(RCHDR,U,2)["P":$E($P(RCHDR,U,2),7,11),1:$E($P(RCHDR,U,2),6,9))  ;Pseudo SSN shouldn't be allowed but we allowed for it to print
"RTN","RCTCSP6",107,0)
 I EXCEL W !,"Bill #",U,"Debtor Name",U,"SSN",U,"Re-Refer Date",U,"Orig Amt",U,"Curr Amt",U,"Diff Amt",U,"Reason",U,"User ID" Q
"RTN","RCTCSP6",108,0)
 W !,"Bill #",?19,"Debtor Name",?37,"SSN",?43,"Re-Refer Date",?57,"Orig Amt",?72,"Curr Amt",?87,"Diff Amt",?102,"Reason",?120,"User ID"
"RTN","RCTCSP6",109,0)
 D ULINE^RCDMCUT2("=",$G(IOM))
"RTN","RCTCSP6",110,0)
 Q
"RTN","RCTCSP6",111,0)
 ;
"RTN","RCTCSP7")
0^24^B6178603^B6169401
"RTN","RCTCSP7",1,0)
RCTCSP7 ;ALBANY/RGB-CROSS - SERVICING TRANSMISSION CONT'D ;08/03/17 3:34 PM
"RTN","RCTCSP7",2,0)
 ;;4.5;Accounts Receivable;**327,315,336,350**;Mar 20, 1995;Build 66
"RTN","RCTCSP7",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP7",4,0)
 ;
"RTN","RCTCSP7",5,0)
 ;PRCA*4.5*327 Moved rec code from RCTCSPD to create room
"RTN","RCTCSP7",6,0)
 ;             for batch mods.
"RTN","RCTCSP7",7,0)
 ;
"RTN","RCTCSP7",8,0)
 ;PRCA*4.5*336 Set CS call switch for address setup
"RTN","RCTCSP7",9,0)
 ;             Also, ensure that pos 260 & 275 are set
"RTN","RCTCSP7",10,0)
 ;             to 10 spaces for non-numeric phone number
"RTN","RCTCSP7",11,0)
 ;
"RTN","RCTCSP7",12,0)
REC2C ;
"RTN","RCTCSP7",13,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAXID,RCDFN,PHONE,ADDRCS
"RTN","RCTCSP7",14,0)
 S REC="C2C"_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSP7",15,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP7",16,0)
 ;S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP7",17,0)
 S DEBTNR=$$AGDEBTID^RCTCSPD,REC=REC_DEBTNR ; PRCA*4.5*350
"RTN","RCTCSP7",18,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP7",19,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP7",20,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSP7",21,0)
 S REC=REC_TAXID
"RTN","RCTCSP7",22,0)
 S REC=REC_"SLFIND"
"RTN","RCTCSP7",23,0)
 S REC=REC_$$BLANK(20)
"RTN","RCTCSP7",24,0)
 S RCDFN=+DEBTOR0
"RTN","RCTCSP7",25,0)
 S REC=REC_$$LJSF($$NAMEFF(RCDFN),60)_"Y"
"RTN","RCTCSP7",26,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN,1),PHONE=$P(ADDRCS,U,6)    ;PRCA*4.5*336
"RTN","RCTCSP7",27,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,1),35)_$$LJSF($P(ADDRCS,U,2),35)_$$LJSF($P(ADDRCS,U,3),15)_$$LJSF($P(ADDRCS,U,4),2)_$$LJSF($P(ADDRCS,U,5),9)
"RTN","RCTCSP7",28,0)
 S REC=REC_$$COUNTRY^RCTCSP1A($P(ADDRCS,U,7)) ;COUNTRY label moved due to routine size PRCA*4.5*315/DRF
"RTN","RCTCSP7",29,0)
 S REC=REC_"Y"
"RTN","RCTCSP7",30,0)
 S REC=REC_$S(+PHONE:"P",1:" ")         ;PRCA*4.5*336
"RTN","RCTCSP7",31,0)
 S REC=REC_$$LJSF($TR(PHONE,"() -"),10)_$$BLANK(4)
"RTN","RCTCSP7",32,0)
 S REC=REC_$S(+PHONE:"Y",1:" ")         ;PRCA*4.5*336
"RTN","RCTCSP7",33,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP7",34,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"2C")=REC
"RTN","RCTCSP7",35,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSP7",36,0)
 D CLR19(BILL,4)
"RTN","RCTCSP7",37,0)
 Q
"RTN","RCTCSP7",38,0)
 ;
"RTN","RCTCSP7",39,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSP7",40,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSP7",41,0)
 S NM=""
"RTN","RCTCSP7",42,0)
 D DEM^VADPT
"RTN","RCTCSP7",43,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSP7",44,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSP7",45,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSP7",46,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSP7",47,0)
 S DOCNM=LN_" "_FN_" "_MN
"RTN","RCTCSP7",48,0)
 Q DOCNM
"RTN","RCTCSP7",49,0)
 ;
"RTN","RCTCSP7",50,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP7",51,0)
 N BLANK
"RTN","RCTCSP7",52,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP7",53,0)
 Q BLANK
"RTN","RCTCSP7",54,0)
 ;
"RTN","RCTCSP7",55,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP7",56,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP7",57,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP7",58,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP7",59,0)
 Q TAXID
"RTN","RCTCSP7",60,0)
 ;
"RTN","RCTCSP7",61,0)
LJSF(X,Y) ;x left justified, y space filled
"RTN","RCTCSP7",62,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP7",63,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP7",64,0)
 Q X
"RTN","RCTCSP7",65,0)
 ;
"RTN","RCTCSP7",66,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP7",67,0)
 S X=X_"0000000000"
"RTN","RCTCSP7",68,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP7",69,0)
 Q X
"RTN","RCTCSP7",70,0)
 ;
"RTN","RCTCSP7",71,0)
CLR19(BILL,X) ; clear the send flag
"RTN","RCTCSP7",72,0)
 S $P(^PRCA(430,BILL,19),U,X)=""
"RTN","RCTCSP7",73,0)
 ;
"RTN","RCTCSPD")
0^12^B186732025^B171015277
"RTN","RCTCSPD",1,0)
RCTCSPD ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSPD",2,0)
 ;;4.5;Accounts Receivable;**301,327,315,336,338,351,350**;Mar 20, 1995;Build 66
"RTN","RCTCSPD",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPD",4,0)
 ;
"RTN","RCTCSPD",5,0)
 ;PRCA*4.5*327 a. Add check to insure debtor exists to prevent 
"RTN","RCTCSPD",6,0)
 ;                undefined error and set in XTMP work global to
"RTN","RCTCSPD",7,0)
 ;                be reported via 'TCSP' mailgroup.
"RTN","RCTCSPD",8,0)
 ;             b. Added process controls throughout entire batch
"RTN","RCTCSPD",9,0)
 ;                run and message to mail group 'TCSP' batch run
"RTN","RCTCSPD",10,0)
 ;                is complete
"RTN","RCTCSPD",11,0)
 ;             c. Move SETUP/FINISH to new routine RCTCSPD0
"RTN","RCTCSPD",12,0)
 ;                due to SACC size constraints
"RTN","RCTCSPD",13,0)
 ;             d. Move REC2C tag/code to RCTCSP7 to create space
"RTN","RCTCSPD",14,0)
 ;                for debtor undefined logic
"RTN","RCTCSPD",15,0)
 ;
"RTN","RCTCSPD",16,0)
 ;PRCA*4.5*336 a. Shift code to handle 5B transactions ahead
"RTN","RCTCSPD",17,0)
 ;                of other processing that could cause a 5B
"RTN","RCTCSPD",18,0)
 ;                record to not be sent in batch run at tag 
"RTN","RCTCSPD",19,0)
 ;                $$UPDCHK(BILL), EXCEPT FOR RECALL CHECK.
"RTN","RCTCSPD",20,0)
 ;             b. Ensure address calls to RCTCSP1 include flag
"RTN","RCTCSPD",21,0)
 ;                to handle missing debtor node 1 correctly when
"RTN","RCTCSPD",22,0)
 ;                building address for CS transactions
"RTN","RCTCSPD",23,0)
 ;
"RTN","RCTCSPD",24,0)
ENTER ;          Entry point from nightly process PRCABJ
"RTN","RCTCSPD",25,0)
 N DEBTOR,P150DT,RC181DT,PRIN,INT,ADMIN,TDEB,TFIL,RCDFN,CNTR,SITE,LN,FN,MN,SITE,F60DT,VADM,PHONE,QUIT,TOTAL,ZIPCODE,FULLNM,RCNT,REPAY,X1,X2,ERROR,ADDR,CAT,BILLDT,CURRTOT,SITECD
"RTN","RCTCSPD",26,0)
 N SEQ,CNTLID,PREPDT,X1,X2,X,DELDT,ACTDT,SITE40
"RTN","RCTCSPD",27,0)
 D SETUP^RCTCSPD0
"RTN","RCTCSPD",28,0)
 S (DEBTOR,RCNT)=0,SEQ=0
"RTN","RCTCSPD",29,0)
RSDEBTOR ;
"RTN","RCTCSPD",30,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTCSPD",31,0)
 .D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZBDEBTOR")=%_U_DEBTOR
"RTN","RCTCSPD",32,0)
 .N X,RCDFN,DEMCS,DOB,GNDR,DEBTOR0,DEBTOR1,DEBTOR3,DEBTOR7,DEBTOR8,BILL
"RTN","RCTCSPD",33,0)
 .I '$D(^RCD(340,DEBTOR,0)) S ^XTMP("RCTCSPD",$J,"ZZUNDEF",DEBTOR)="" Q
"RTN","RCTCSPD",34,0)
 .S DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR1=$G(^(1)),DEBTOR3=$G(^(3)),DEBTOR7=$G(^(7))
"RTN","RCTCSPD",35,0)
 .S DEBTOR8=$O(^RCD(340,DEBTOR,8,"A"),-1) I DEBTOR8?1.N S DEBTOR8=$P($G(^RCD(340,DEBTOR,8,DEBTOR8,0)),U)
"RTN","RCTCSPD",36,0)
 .S RCDFN=+DEBTOR0
"RTN","RCTCSPD",37,0)
 .S DEMCS=$$DEM^RCTCSP1(RCDFN)
"RTN","RCTCSPD",38,0)
 .S DOB=$P(DEMCS,U,2)
"RTN","RCTCSPD",39,0)
 .S GNDR=$P(DEMCS,U,1) S:"MF"'[GNDR GNDR="U"
"RTN","RCTCSPD",40,0)
 .I $P(DEBTOR7,U,2) I '+$P(DEBTOR7,U,3) D  ;send type 2 recall record
"RTN","RCTCSPD",41,0)
 ..N ACTION,B0,B15,BILL
"RTN","RCTCSPD",42,0)
 ..S ACTION="L"
"RTN","RCTCSPD",43,0)
 ..S B0="",B15="",BILL=0
"RTN","RCTCSPD",44,0)
 ..; The code below is designed to get ONLY one bill #.  It is not a bug! As per VA SME contacts.
"RTN","RCTCSPD",45,0)
 ..F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  I $D(^PRCA(430,"TCSP",BILL)) I $P(^PRCA(430,BILL,15),U,7)'=1 S B0=$G(^PRCA(430,BILL,0)),B15=$G(^(15)) Q  ;get one bill
"RTN","RCTCSPD",46,0)
 ..I BILL="" S BILL=0 S $P(^RCD(340,DEBTOR,7),U,2,4)="^^",$P(DEBTOR7,U,2,4)="^^" Q  ;cs debtor with no cs bill, clear the debtor recall flag, quit
"RTN","RCTCSPD",47,0)
 ..D REC2
"RTN","RCTCSPD",48,0)
 ..S $P(^RCD(340,DEBTOR,7),U,3)=DT
"RTN","RCTCSPD",49,0)
 ..S DEBTOR7=^RCD(340,DEBTOR,7)
"RTN","RCTCSPD",50,0)
 ..S BILL=0 ;set debtor cross-serviced bills as recalled
"RTN","RCTCSPD",51,0)
 ..F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPD",52,0)
 ...D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZCRBILL")=%_U_BILL
"RTN","RCTCSPD",53,0)
 ...I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP
"RTN","RCTCSPD",54,0)
 ....S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSPD",55,0)
 ....S $P(^PRCA(430,BILL,15),U,2)=1 ;set the recall flag
"RTN","RCTCSPD",56,0)
 ....S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSPD",57,0)
 ....S $P(^PRCA(430,BILL,15),U,4)=$P(DEBTOR7,U,4) ;set the recall reason
"RTN","RCTCSPD",58,0)
 ....S $P(^PRCA(430,BILL,15),U,5)=$$GET1^DIQ(430,BILL,11) ;set the recall amount to the current amount
"RTN","RCTCSPD",59,0)
 ....K ^PRCA(430,"TCSP",BILL) ;kill the cross-servicing cross reference
"RTN","RCTCSPD",60,0)
 ....D RCRSD^RCTCSPD4 ; set debtor recall non-financial transaction PRCA*4.5*315
"RTN","RCTCSPD",61,0)
 .S (BILL,TOTAL,REPAY)=0
"RTN","RCTCSPD",62,0)
RSBILL .F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPD",63,0)
 ..I $G(ONEBILL)'="",BILL'=ONEBILL Q  ; Test single bill ; PRCA*4.5*350
"RTN","RCTCSPD",64,0)
 ..D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZCTRACKER")=%_U_DEBTOR_U_BILL
"RTN","RCTCSPD",65,0)
 ..N B0,B4,B6,B7,B9,B12,B121,B14,B15,B16,B19,B20,ACTION,RR
"RTN","RCTCSPD",66,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B9=$G(^(9)),B12=$G(^(12)),B121=$G(^(12.1)),B14=$G(^(14)),B15=$G(^(15)),B16=$G(^(16)),B19=$G(^(19)),B20=$G(^(20))
"RTN","RCTCSPD",67,0)
 ..S RR=$$RR^RCTCSPU(BILL) ;PRCA*4.5*350
"RTN","RCTCSPD",68,0)
 ..Q:($P(B6,U,21)\1)<ACTDT  ;cs activation date cutoff
"RTN","RCTCSPD",69,0)
 ..I $D(^PRCA(430,"TCSP",BILL)),$$RCLLCHK^RCTCSP2(BILL) Q  ;bill previously sent to TCSP
"RTN","RCTCSPD",70,0)
 ..I $$UPDCHK(BILL) Q
"RTN","RCTCSPD",71,0)
 ..Q:B4  ;repayment plan
"RTN","RCTCSPD",72,0)
 ..; Do we clear stop flag if RR TBD ; PRCA*4.5*350
"RTN","RCTCSPD",73,0)
 ..I +$P(B15,U,7),RR'=0 Q  ;quit if bill is stopped
"RTN","RCTCSPD",74,0)
 ..Q:+$P(B14,U,1)  ;bill referred to TOP
"RTN","RCTCSPD",75,0)
 ..Q:$P(DEBTOR1,"^",9)=1  ;quit if debtor address marked unknown
"RTN","RCTCSPD",76,0)
 ..Q:$E($P(DEMCS,U,3),1,5)="00000"  ;quit if the ssn is not valid
"RTN","RCTCSPD",77,0)
 ..Q:DEBTOR8="S"  ;quit if debtor is stopped PRCA*4.5*350
"RTN","RCTCSPD",78,0)
 ..Q:SITE40="S"  ; quit if site is stopped PRCA*4.5*350
"RTN","RCTCSPD",79,0)
 ..I +$P(B12,U,1) Q  ;check date bill sent to dmc
"RTN","RCTCSPD",80,0)
 ..Q:($P(B121,U,1)="N")!($P(B121,U,1)="P")  ;dmc debt valid
"RTN","RCTCSPD",81,0)
 ..I $P(B6,U,4),($P(B6,U,5)="DOJ") Q
"RTN","RCTCSPD",82,0)
 ..Q:+$P(DEMCS,U,4)  ;deceased patient
"RTN","RCTCSPD",83,0)
 ..Q:'$P(B0,U,2)  ;no category
"RTN","RCTCSPD",84,0)
 ..S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTCSPD",85,0)
 ..Q:'CAT
"RTN","RCTCSPD",86,0)
 ..;PRCA*4.5*338 - Use RFCHK^RCTOPD to determine if the Category can be referred
"RTN","RCTCSPD",87,0)
 ..;               using the new date based algorithm.
"RTN","RCTCSPD",88,0)
 ..Q:'$$RFCHK^RCTOPD(CAT,"N",1.03,$P(B6,U,21))
"RTN","RCTCSPD",89,0)
 ..;end PRCA*4.5*338 ..;dpn checks
"RTN","RCTCSPD",90,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,'$P(B20,U,4) D DUEPROC^RCTCSP3 Q  ;check to send dpn file to aitc
"RTN","RCTCSPD",91,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),'$P(B20,U,5) Q  ;check for print letter date
"RTN","RCTCSPD",92,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),$P(B20,U,5) D  I X<60 Q  ;check for 60 day wait from print letter date
"RTN","RCTCSPD",93,0)
 ...N X1,X2
"RTN","RCTCSPD",94,0)
 ...S X1=DT,X2=$P(B20,U,5) D ^%DTC
"RTN","RCTCSPD",95,0)
 ...I X'<60 S $P(B20,U,6)=DT,^PRCA(430,BILL,20)=B20 ;set the bill referral date to the current date
"RTN","RCTCSPD",96,0)
 ..S BILLDT=$P(B6,U,21),PREPDT=$P(B0,U,10)
"RTN","RCTCSPD",97,0)
 ..I BILLDT>P150DT Q  ;150 day old check
"RTN","RCTCSPD",98,0)
 ..;S BILLDT=$P(B6,U,1),PREPDT=$P(B0,U,10) ; PRCA*4.5*343 - change BILLDT from DATE ACCOUNT ACTIVATED (#60) to LETTER1(#61)
"RTN","RCTCSPD",99,0)
 ..;I BILLDT>RC181DT Q  ; PRCA*4.5*343 - Must be 181 days or more after LETTER1 date
"RTN","RCTCSPD",100,0)
 ..I ($P(B0,U,8)=16),('$P(B6,U,3)) D  Q
"RTN","RCTCSPD",101,0)
 ...;no 3rd letter being sent
"RTN","RCTCSPD",102,0)
 ...N DNM
"RTN","RCTCSPD",103,0)
 ...S DNM=$$NAMEFF(+DEBTOR0),^XTMP("RCTCSPD",$J,"THIRD",DNM,$P(B0,U))=""
"RTN","RCTCSPD",104,0)
 ..I $P(B0,U,8)=16 I $$ADDCHKND(BILL) Q
"RTN","RCTCSPD",105,0)
 ..I $P(B0,U,8)=16 I $$ADDCHKNB(BILL) Q
"RTN","RCTCSPD",106,0)
 ..Q
"RTN","RCTCSPD",107,0)
 .Q
"RTN","RCTCSPD",108,0)
 ;
"RTN","RCTCSPD",109,0)
 D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZDEND")=%
"RTN","RCTCSPD",110,0)
 D THIRD^RCTCSP2
"RTN","RCTCSPD",111,0)
 D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZETRANSMIT CS RECS")=%
"RTN","RCTCSPD",112,0)
 D COMPILE^RCTCSP2 ;compile cross-serviced records
"RTN","RCTCSPD",113,0)
 D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZFTRANSMIT DPN")=%
"RTN","RCTCSPD",114,0)
 D COMPILED^RCTCSP3 ;compile the aitc due process notification records
"RTN","RCTCSPD",115,0)
 D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZGTRANSMIT FINISHED")=%
"RTN","RCTCSPD",116,0)
 D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZHCOMPLETE")=%
"RTN","RCTCSPD",117,0)
 D FINISH^RCTCSPD0
"RTN","RCTCSPD",118,0)
 Q
"RTN","RCTCSPD",119,0)
 ;
"RTN","RCTCSPD",120,0)
ADDCHKND(BILL) ;add a new bill referral, new debtor
"RTN","RCTCSPD",121,0)
 N TOTAL,ACTION,X
"RTN","RCTCSPD",122,0)
 S ACTION="A"
"RTN","RCTCSPD",123,0)
 I $D(^RCD(340,"TCSP",DEBTOR)) Q 0 ;check debtor previously referred
"RTN","RCTCSPD",124,0)
 I $P(DEBTOR7,U,2) Q 0 ;check debtor recall
"RTN","RCTCSPD",125,0)
 I $D(^PRCA(430,"TCSP",BILL)) Q 0 ;bill previously sent to TCSP
"RTN","RCTCSPD",126,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",127,0)
 I TOTAL<25 Q 1 ;no adds for bills less than $25
"RTN","RCTCSPD",128,0)
 I RR=0 D RRMARK^RCTCSPD0 ; PRCA*4.5*350
"RTN","RCTCSPD",129,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSPD",130,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",131,0)
 D REC1,REC2,REC2A
"RTN","RCTCSPD",132,0)
 S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",133,0)
 S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",134,0)
 D REC2C^RCTCSP7    ;PRCA*4.5*327
"RTN","RCTCSPD",135,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN,1)     ;PRCA*4.5*336
"RTN","RCTCSPD",136,0)
 S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=$P(ADDRCS,U,6),$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",137,0)
 S B16=^PRCA(430,BILL,16)
"RTN","RCTCSPD",138,0)
 D REC3^RCTCSP2
"RTN","RCTCSPD",139,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",140,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",141,0)
 S $P(^PRCA(430,BILL,15),U,1)=DT,$P(^(16),U,1)=TAXID,$P(^(16),U,2)=NAME
"RTN","RCTCSPD",142,0)
 S X1=BILLDT,X2=+30 D C^%DTC S DELDT=X
"RTN","RCTCSPD",143,0)
 S $P(^PRCA(430,BILL,16),U,3)=DELDT,^PRCA(430,"TCSP",BILL)=""
"RTN","RCTCSPD",144,0)
 I $P($G(^PRCA(430,BILL,21)),U)="" S $P(^PRCA(430,BILL,21),U)=DT    ;PRCA*4.5*336
"RTN","RCTCSPD",145,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) S $P(^RCD(340,DEBTOR,7),U,5)=DT,^RCD(340,"TCSP",DEBTOR)=""
"RTN","RCTCSPD",146,0)
 D:RR'=0 NEWDEBTR^RCTCSPD4  D:RR=0 RRSEND^RCTCSPD4 ; set CS new debtor new bill non-financial transaction PRCA*4.5*315
"RTN","RCTCSPD",147,0)
 Q 1
"RTN","RCTCSPD",148,0)
 ;
"RTN","RCTCSPD",149,0)
ADDCHKNB(BILL) ;add a new bill referral, existing debtor
"RTN","RCTCSPD",150,0)
 N TOTAL,ACTION,TAXID,NAME,ADDRCS,X
"RTN","RCTCSPD",151,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) Q 0 ;check debtor previously referred
"RTN","RCTCSPD",152,0)
 I $D(^PRCA(430,"TCSP",BILL)) Q 0 ;bill previously sent to TCSP
"RTN","RCTCSPD",153,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",154,0)
 I TOTAL<25 Q 0 ;no adds for bills less than $25
"RTN","RCTCSPD",155,0)
 I RR=0 D RRMARK^RCTCSPD0 ; PRCA*4.5*350
"RTN","RCTCSPD",156,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",157,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSPD",158,0)
 S ACTION="A" D REC1
"RTN","RCTCSPD",159,0)
 S ACTION="B" D REC2
"RTN","RCTCSPD",160,0)
 S ACTION="A" D REC3^RCTCSP2
"RTN","RCTCSPD",161,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",162,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",163,0)
 S $P(^PRCA(430,BILL,15),U,1)=DT,$P(^(16),U,1)=TAXID,$P(^(16),U,2)=NAME,$P(^(16),U,3)=BILLDT,^PRCA(430,"TCSP",BILL)=""
"RTN","RCTCSPD",164,0)
 I $P($G(^PRCA(430,BILL,21)),U)="" S $P(^PRCA(430,BILL,21),U)=DT    ;PRCA*4.5*336
"RTN","RCTCSPD",165,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN,1)     ;PRCA*4.5*336
"RTN","RCTCSPD",166,0)
 S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=$P(ADDRCS,U,6),$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",167,0)
 S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",168,0)
 S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",169,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) S $P(^RCD(340,DEBTOR,7),U,5)=DT,^RCD(340,"TCSP",DEBTOR)=""
"RTN","RCTCSPD",170,0)
 D:RR'=0 DEBTOR^RCTCSPD4 D:RR=0 RRSEND^RCTCSPD4 ; set CS debtor new bill non-financial transaction PRCA*4.5*315, PRCA*4.5*350
"RTN","RCTCSPD",171,0)
 Q 1
"RTN","RCTCSPD",172,0)
 ;
"RTN","RCTCSPD",173,0)
UPDCHK(BILL) ;update 5b or existing bill
"RTN","RCTCSPD",174,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",175,0)
 N TOTAL,TAXID,OTAXID,NAME,ONAME,ADDR,OADDR,ADDRCS,COUNTRY,OCOUNTRY,OPHONE,ODOB,OGNDR,TRNIDX,TRN1,TRN8,TRNAMT,TRNNUM,TRNFLG,FIVBFLG
"RTN","RCTCSPD",176,0)
 ;5b check
"RTN","RCTCSPD",177,0)
 S FIVBFLG=0
"RTN","RCTCSPD",178,0)
 S TRNIDX=0 F  S TRNIDX=$O(^PRCA(430,BILL,17,TRNIDX)) Q:+TRNIDX=0  D
"RTN","RCTCSPD",179,0)
 .S TRNNUM=$P($G(^PRCA(430,BILL,17,TRNIDX,0)),U,1),TRNFLG=$P($G(^PRCA(430,BILL,17,TRNIDX,0)),U,2)
"RTN","RCTCSPD",180,0)
 .Q:+TRNFLG=0
"RTN","RCTCSPD",181,0)
 .S TRN1=$G(^PRCA(433,TRNNUM,1)),TRNAMT=$P(TRN1,U,5) S:TRNAMT<0 TRNAMT=-TRNAMT
"RTN","RCTCSPD",182,0)
 .S TRN8=$G(^PRCA(433,TRNNUM,8))
"RTN","RCTCSPD",183,0)
 .S ACTION="U"
"RTN","RCTCSPD",184,0)
 .D REC5B^RCTCSP1
"RTN","RCTCSPD",185,0)
 .S $P(^PRCA(430,BILL,17,TRNIDX,0),U,2)=""
"RTN","RCTCSPD",186,0)
 .S FIVBFLG=1
"RTN","RCTCSPD",187,0)
 I '$D(^PRCA(430,BILL,16)) Q 0 ;quit null node 16 old address   ;PRCA*4.5*336
"RTN","RCTCSPD",188,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag               ;PRCA*4.5*336
"RTN","RCTCSPD",189,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",190,0)
 I FIVBFLG,(TOTAL=0) S DR="151///@",DIE="^PRCA(430,",DA=BILL D ^DIE K DR,DIE,DA
"RTN","RCTCSPD",191,0)
 I $P(B19,U,1)=1 S ACTION="U" D REC1 S $P(B19,U,1)="" S $P(^PRCA(430,BILL,19),U,1)=""
"RTN","RCTCSPD",192,0)
 I $P(B19,U,2)=1 S ACTION="U" D REC2 S $P(B19,U,2)="" S $P(^PRCA(430,BILL,19),U,2)=""
"RTN","RCTCSPD",193,0)
 I $P(B19,U,3)=1 S ACTION="U" D REC2A S $P(B19,U,3)="" S $P(^PRCA(430,BILL,19),U,3)=""
"RTN","RCTCSPD",194,0)
 I $P(B19,U,4)=1 S ACTION="A" D REC2C^RCTCSP7 S $P(B19,U,4)="" S $P(^PRCA(430,BILL,19),U,4)="" ;PRCA*4.5*327
"RTN","RCTCSPD",195,0)
 I FIVBFLG=1 Q 1 ;if 5b sent, then do not continue to referral check
"RTN","RCTCSPD",196,0)
 I '$D(^PRCA(430,"TCSP",BILL)) Q 0 ;if not cross-serviced, then continue referral check
"RTN","RCTCSPD",197,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",198,0)
 S OTAXID=$P(B16,U,1)
"RTN","RCTCSPD",199,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",200,0)
 S ONAME=$P(B16,U,2)
"RTN","RCTCSPD",201,0)
 I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I (NAME'=ONAME)!(TAXID'=OTAXID) D
"RTN","RCTCSPD",202,0)
 .S ACTION="U"
"RTN","RCTCSPD",203,0)
 .D REC2
"RTN","RCTCSPD",204,0)
 .S $P(^PRCA(430,BILL,16),U,1)=TAXID,$P(^(16),U,2)=NAME,$P(^(19),U,2)="",$P(B19,U,2)=""
"RTN","RCTCSPD",205,0)
 S OADDR=$P(^PRCA(430,BILL,16),U,4,8),OPHONE=$P(^(16),U,11),OCOUNTRY=$P(^(16),U,12)
"RTN","RCTCSPD",206,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN,1),PHONE=$P(ADDRCS,U,6),COUNTRY=$P(ADDRCS,U,7)     ;PRCA*4.5*336
"RTN","RCTCSPD",207,0)
 I $P(DEBTOR1,"^",9)'=1 D  ;if debtor address is not marked unknown, then check address
"RTN","RCTCSPD",208,0)
 .I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I ($P(ADDRCS,U,1,5)'=$P(OADDR,U,1,5))!(PHONE'=OPHONE)!(COUNTRY'=OCOUNTRY) D
"RTN","RCTCSPD",209,0)
 ..S ACTION="A" ;2c records have action code 'a'
"RTN","RCTCSPD",210,0)
 ..D REC2C^RCTCSP7
"RTN","RCTCSPD",211,0)
 ..S $P(B19,U,4)=""
"RTN","RCTCSPD",212,0)
 ..S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=PHONE,$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",213,0)
 S B16=^PRCA(430,BILL,16)
"RTN","RCTCSPD",214,0)
 S ODOB=$P(^PRCA(430,BILL,16),U,13)
"RTN","RCTCSPD",215,0)
 S OGNDR=$P(^PRCA(430,BILL,15),U,14)
"RTN","RCTCSPD",216,0)
 I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I (DOB'=ODOB)!(GNDR'=OGNDR) D
"RTN","RCTCSPD",217,0)
 .S ACTION="U"
"RTN","RCTCSPD",218,0)
 .D REC2A
"RTN","RCTCSPD",219,0)
 .S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",220,0)
 .S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",221,0)
 .Q
"RTN","RCTCSPD",222,0)
 Q 1 ;bill is cross-serviced so do not continue referral check
"RTN","RCTCSPD",223,0)
 ;
"RTN","RCTCSPD",224,0)
REC1 ;record type 1
"RTN","RCTCSPD",225,0)
 N REC,KNUM,DEBTNR,AMTORIG,AMTPBAL,AMTIBAL,AMTABAL,AMTFBAL,AMTCBAL,AMTRFRRD,AMOUNT,DELDT,X,X1,X2,BILLDT,PREPDT
"RTN","RCTCSPD",226,0)
 S REC="C1 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",227,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",228,0)
 ;S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR_" "
"RTN","RCTCSPD",229,0)
 S DEBTNR=$$AGDEBTID,REC=REC_DEBTNR_" " ; PRCA*4.5*350
"RTN","RCTCSPD",230,0)
 S REC=REC_"I   A MSCC"
"RTN","RCTCSPD",231,0)
 S BILLDT=$P(B6,U,21),PREPDT=$P(B0,U,10)
"RTN","RCTCSPD",232,0)
 S REC=REC_$$DATE8(PREPDT)
"RTN","RCTCSPD",233,0)
 S X1=BILLDT,X2=+30 D C^%DTC S DELDT=X
"RTN","RCTCSPD",234,0)
 S REC=REC_$$DATE8(DELDT)
"RTN","RCTCSPD",235,0)
 S AMTPBAL=$P(B7,U,1) ;principle balance
"RTN","RCTCSPD",236,0)
 S AMTIBAL=$P(B7,U,2) ;interest balance
"RTN","RCTCSPD",237,0)
 S AMTABAL=$P(B7,U,3) ;administrative balance
"RTN","RCTCSPD",238,0)
 S AMTFBAL=$P(B7,U,4) ;marshal fee
"RTN","RCTCSPD",239,0)
 S AMTCBAL=$P(B7,U,5) ;court cost
"RTN","RCTCSPD",240,0)
 S AMTRFRRD=AMTPBAL+AMTIBAL+AMTABAL+AMTFBAL+AMTCBAL
"RTN","RCTCSPD",241,0)
 S AMTORIG=$P(B0,U,3)
"RTN","RCTCSPD",242,0)
 D  ;
"RTN","RCTCSPD",243,0)
 .I ACTION="A" S REC=REC_$$AMOUNT(AMTRFRRD)_$$AMOUNT(AMTRFRRD) Q
"RTN","RCTCSPD",244,0)
 .I ACTION="L" S AMTRFRRD=0 S REC=REC_$$AMOUNT(AMTRFRRD)_$$AMOUNT(AMTRFRRD) Q
"RTN","RCTCSPD",245,0)
 .S REC=REC_$$BLANK(28)
"RTN","RCTCSPD",246,0)
 S REC=REC_"                                             N        "
"RTN","RCTCSPD",247,0)
 S AMOUNT=$$AMOUNT(AMTPBAL)_$$AMOUNT(AMTIBAL)_$$AMOUNT(AMTABAL)_$$AMOUNT(AMTFBAL+AMTCBAL)
"RTN","RCTCSPD",248,0)
 I ACTION="L" S AMOUNT=$$AMOUNT(0)_$$AMOUNT(0)_$$AMOUNT(0)_$$AMOUNT(0) ;by iai spec
"RTN","RCTCSPD",249,0)
 I ACTION="U" S AMOUNT=$$BLANK(56) ;by iai spec
"RTN","RCTCSPD",250,0)
 S REC=REC_AMOUNT
"RTN","RCTCSPD",251,0)
 I ACTION="L" D
"RTN","RCTCSPD",252,0)
 .S REC=REC_$$BLANK(252-$L(REC))
"RTN","RCTCSPD",253,0)
 .S RCD=$P(B15,U,4)
"RTN","RCTCSPD",254,0)
 .S REC=REC_$S(RCD="01":"01",RCD="07":"07",RCD="08":"08",RCD="15":"01",RCD="03":"01",RCD="05":"01",RCD="06":"01",1:"01")
"RTN","RCTCSPD",255,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",256,0)
 I ACTION="A" S $P(^PRCA(430,BILL,16),U,9)=AMTRFRRD,$P(^(16),U,10)=AMTRFRRD
"RTN","RCTCSPD",257,0)
 I ACTION="L" S $P(^PRCA(430,BILL,16),U,9)="",$P(^(16),U,10)=""
"RTN","RCTCSPD",258,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,1)=REC
"RTN","RCTCSPD",259,0)
 S ^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL)=$$TAXID(DEBTOR)_"^"_+$E(REC,91,102)_"."_$E(REC,103,104) ;sends mailman message of documents sent to user
"RTN","RCTCSPD",260,0)
 D CLR19(BILL,1)
"RTN","RCTCSPD",261,0)
 Q
"RTN","RCTCSPD",262,0)
 ;
"RTN","RCTCSPD",263,0)
REC2 ;
"RTN","RCTCSPD",264,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAXID,NAME,RCD
"RTN","RCTCSPD",265,0)
 S REC="C2 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",266,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",267,0)
 ;S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSPD",268,0)
 S DEBTNR=$$AGDEBTID,REC=REC_DEBTNR ; PRCA*4.5*350
"RTN","RCTCSPD",269,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSPD",270,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSPD",271,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",272,0)
 S REC=REC_TAXID_"SSN"
"RTN","RCTCSPD",273,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",274,0)
 S REC=REC_NAME_$$BLANK(5)_"I"
"RTN","RCTCSPD",275,0)
 I ACTION="L" D
"RTN","RCTCSPD",276,0)
 .S REC=REC_$$BLANK(232-$L(REC))
"RTN","RCTCSPD",277,0)
 .S RCD=$P(B15,U,4)
"RTN","RCTCSPD",278,0)
 .S REC=REC_$S(RCD="01":"12",RCD="07":"12",RCD="08":"12",RCD="15":"12",RCD="03":"03",RCD="05":"05",RCD="06":"06",1:"12")
"RTN","RCTCSPD",279,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",280,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,2)=REC
"RTN","RCTCSPD",281,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSPD",282,0)
 D CLR19(BILL,2)
"RTN","RCTCSPD",283,0)
 Q
"RTN","RCTCSPD",284,0)
 ;
"RTN","RCTCSPD",285,0)
REC2A ;
"RTN","RCTCSPD",286,0)
 N REC,KNUM,DEBTNR,DEBTORNB
"RTN","RCTCSPD",287,0)
 S REC="C2A"_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",288,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",289,0)
 S DEBTNR=$$AGDEBTID,REC=REC_DEBTNR ; PRCA*4.5*350
"RTN","RCTCSPD",290,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSPD",291,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSPD",292,0)
 S REC=REC_$$BLANK(3)
"RTN","RCTCSPD",293,0)
 S REC=REC_GNDR
"RTN","RCTCSPD",294,0)
 S REC=REC_$$DATE8($P(DEMCS,U,2))
"RTN","RCTCSPD",295,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",296,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"2A")=REC
"RTN","RCTCSPD",297,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSPD",298,0)
 D CLR19(BILL,3)
"RTN","RCTCSPD",299,0)
 Q
"RTN","RCTCSPD",300,0)
AGDEBTID() ; Return Agency Debt ID accoring to new logic PRCA*4.5*350
"RTN","RCTCSPD",301,0)
 ; Input: SITE,KNUM,BILL,B15
"RTN","RCTCSPD",302,0)
 N TRAIL S TRAIL=$P($G(^PRCA(430,BILL,21)),U,2)
"RTN","RCTCSPD",303,0)
 I TRAIL="" Q $E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0)
"RTN","RCTCSPD",304,0)
 Q $E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,18)," ",0)_TRAIL
"RTN","RCTCSPD",305,0)
 ;
"RTN","RCTCSPD",306,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSPD",307,0)
 I +X S X=X+17000000
"RTN","RCTCSPD",308,0)
 S X=$E(X,1,8)
"RTN","RCTCSPD",309,0)
 Q X
"RTN","RCTCSPD",310,0)
 ;
"RTN","RCTCSPD",311,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSPD",312,0)
 S:X<0 X=-X
"RTN","RCTCSPD",313,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSPD",314,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSPD",315,0)
 Q X
"RTN","RCTCSPD",316,0)
 ;
"RTN","RCTCSPD",317,0)
NAME(DFN) ;returns name for document and name in file
"RTN","RCTCSPD",318,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSPD",319,0)
 S NM=""
"RTN","RCTCSPD",320,0)
 D DEM^VADPT
"RTN","RCTCSPD",321,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSPD",322,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSPD",323,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSPD",324,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSPD",325,0)
 S DOCNM=$$LJ^XLFSTR($E(LN,1,35),35)_$$LJ^XLFSTR($E(FN,1,35),35)_$$LJ^XLFSTR($E(MN,1,35),35)
"RTN","RCTCSPD",326,0)
 Q DOCNM
"RTN","RCTCSPD",327,0)
 ;
"RTN","RCTCSPD",328,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSPD",329,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSPD",330,0)
 S NM=""
"RTN","RCTCSPD",331,0)
 D DEM^VADPT
"RTN","RCTCSPD",332,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSPD",333,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSPD",334,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSPD",335,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSPD",336,0)
 S DOCNM=LN_" "_FN_" "_MN
"RTN","RCTCSPD",337,0)
 Q DOCNM
"RTN","RCTCSPD",338,0)
 ;
"RTN","RCTCSPD",339,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSPD",340,0)
 N BLANK
"RTN","RCTCSPD",341,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSPD",342,0)
 Q BLANK
"RTN","RCTCSPD",343,0)
 ;
"RTN","RCTCSPD",344,0)
NOW() ;compiles current date,time
"RTN","RCTCSPD",345,0)
 N X,Y,%,%H
"RTN","RCTCSPD",346,0)
 S %H=$H D YX^%DTC
"RTN","RCTCSPD",347,0)
 Q Y
"RTN","RCTCSPD",348,0)
 ;
"RTN","RCTCSPD",349,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSPD",350,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSPD",351,0)
 Q X
"RTN","RCTCSPD",352,0)
 ;
"RTN","RCTCSPD",353,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSPD",354,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSPD",355,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSPD",356,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSPD",357,0)
 Q TAXID
"RTN","RCTCSPD",358,0)
 ;
"RTN","RCTCSPD",359,0)
LJSF(X,Y) ;x left justified, y space filled
"RTN","RCTCSPD",360,0)
 S X=$E(X,1,Y)
"RTN","RCTCSPD",361,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSPD",362,0)
 Q X
"RTN","RCTCSPD",363,0)
 ;
"RTN","RCTCSPD",364,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSPD",365,0)
 S X=X_"0000000000"
"RTN","RCTCSPD",366,0)
 S X=$E(X,X,Y)
"RTN","RCTCSPD",367,0)
 Q X
"RTN","RCTCSPD",368,0)
 ;
"RTN","RCTCSPD",369,0)
RECALL(BILL) ; set the recall flag
"RTN","RCTCSPD",370,0)
 S $P(^PRCA(430,BILL,15),U,2)=1
"RTN","RCTCSPD",371,0)
 Q
"RTN","RCTCSPD",372,0)
 ;
"RTN","RCTCSPD",373,0)
CLR19(BILL,X) ; clear the send flag
"RTN","RCTCSPD",374,0)
 S $P(^PRCA(430,BILL,19),U,X)=""
"RTN","RCTCSPD",375,0)
 ;
"RTN","RCTCSPD0")
0^13^B50618939^B8551366
"RTN","RCTCSPD0",1,0)
RCTCSPD0 ;ALBANY/RGB-CROSS-SERVICING TRANSMISSION START ;06/15/17 3:34 PM
"RTN","RCTCSPD0",2,0)
 ;;4.5;Accounts Receivable;**327,337,350**;Mar 20, 1995;Build 66
"RTN","RCTCSPD0",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPD0",4,0)
 ;
"RTN","RCTCSPD0",5,0)
 ;PRCA*4.5*327 new setup/finish extraction from RCTCSPD and
"RTN","RCTCSPD0",6,0)
 ;             modify XTMP file kill to work correctly for
"RTN","RCTCSPD0",7,0)
 ;             5 days after Tuesday run.
"RTN","RCTCSPD0",8,0)
 ;             Also, send mail message to 'TCSP' mailgroup
"RTN","RCTCSPD0",9,0)
 ;             to report any missing/corrupted debtor entries.
"RTN","RCTCSPD0",10,0)
 ;
"RTN","RCTCSPD0",11,0)
 ;PRCA*4.5*337 Modify the top node of ^XTMP work files
"RTN","RCTCSPD0",12,0)
 ;             to have ONLY ^XTMP(namespace,0) to insure
"RTN","RCTCSPD0",13,0)
 ;             correct purging outcome.
"RTN","RCTCSPD0",14,0)
 ;PRCA*4.5*350 Added RS1 tag to have non-global variables setup
"RTN","RCTCSPD0",15,0)
 ;
"RTN","RCTCSPD0",16,0)
SETUP ;Entry point from nightly process PRCABJ
"RTN","RCTCSPD0",17,0)
 ;
"RTN","RCTCSPD0",18,0)
 ;initialize temporary global, variables
"RTN","RCTCSPD0",19,0)
 ;
"RTN","RCTCSPD0",20,0)
 K ^TMP("RCTCSPD",$J)
"RTN","RCTCSPD0",21,0)
 K ^XTMP("RCTCSPD")
"RTN","RCTCSPD0",22,0)
 K ^XTMP("RCTCSPDN")
"RTN","RCTCSPD0",23,0)
 S ^XTMP("RCTCSPD",0)=$$FMADD^XLFDT(DT,5)_"^"_DT
"RTN","RCTCSPD0",24,0)
 S ^XTMP("RCTCSPDN",0)=$$FMADD^XLFDT(DT,5)_"^"_DT
"RTN","RCTCSPD0",25,0)
RESTART D NOW^%DTC S ^XTMP("RCTCSPD",$J,"ZZASTART")=%
"RTN","RCTCSPD0",26,0)
RS1 S SITE=$E($$SITE^RCMSITE(),1,3),SITECD=$P(^RC(342,1,3),U,5)
"RTN","RCTCSPD0",27,0)
 S ACTDT=3150801 ;activation date for all sites except beckley, little rock, upstate ny 
"RTN","RCTCSPD0",28,0)
 S:SITE=598 ACTDT=3150201 ;activation date for little rock
"RTN","RCTCSPD0",29,0)
 S:SITE=517 ACTDT=3150201 ;activation date for beckley
"RTN","RCTCSPD0",30,0)
 S:SITE=528 ACTDT=3150201 ;activation date for upstate ny
"RTN","RCTCSPD0",31,0)
 S SITE40=$O(^RC(342,1,40,"A"),-1) I SITE40?1.N S SITE40=$P($G(^RC(342,1,40,SITE40,0)),U)
"RTN","RCTCSPD0",32,0)
 S X1=DT,X2=-150 D C^%DTC S P150DT=X
"RTN","RCTCSPD0",33,0)
 S X1=DT,X2=+60 D C^%DTC S F60DT=X
"RTN","RCTCSPD0",34,0)
 S (CNTR(1),CNTR(2),CNTR("2A"),CNTR("2C"),CNTR(3),CNTR("5A"),CNTR("5B"))=0
"RTN","RCTCSPD0",35,0)
 Q
"RTN","RCTCSPD0",36,0)
FINISH ;sends mailman message to TCSP mail group to show batch fully completed
"RTN","RCTCSPD0",37,0)
 I $D(^XTMP("RCTCSPD",$J,"ZZUNDEF")) D UNDEF
"RTN","RCTCSPD0",38,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,BMSG
"RTN","RCTCSPD0",39,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSPD0",40,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSPD0",41,0)
 S XMSUB="*** Batch Completion Notice ***"
"RTN","RCTCSPD0",42,0)
 S BMSG(1)="The batch run and transmission completed on "_(17000000+^XTMP("RCTCSPD",$J,"ZZHCOMPLETE"))
"RTN","RCTCSPD0",43,0)
 S XMTEXT="BMSG("
"RTN","RCTCSPD0",44,0)
 Q:$G(ONEBILL)
"RTN","RCTCSPD0",45,0)
 D ^XMD
"RTN","RCTCSPD0",46,0)
 K ^TMP("RCTCSPD",$J)
"RTN","RCTCSPD0",47,0)
 Q
"RTN","RCTCSPD0",48,0)
UNDEF ;send message to mail group for any undefined debtor entries found
"RTN","RCTCSPD0",49,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,BMSG,IEN,CTR
"RTN","RCTCSPD0",50,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSPD0",51,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSPD0",52,0)
 S XMSUB="**** FAILED DEBTOR ACTION NOTICE ***"
"RTN","RCTCSPD0",53,0)
 S BMSG(1)="The following corrupted debtor records were found during the batch run."
"RTN","RCTCSPD0",54,0)
 S BMSG(2)="They can be found in xref ^PRCA(430,_""C""_) and have no file 340 entry or a"
"RTN","RCTCSPD0",55,0)
 S BMSG(3)="corrupted entry (missing node 0 or 1)."
"RTN","RCTCSPD0",56,0)
 s BMSG(4)=" "
"RTN","RCTCSPD0",57,0)
 S BMSG(97)=" "
"RTN","RCTCSPD0",58,0)
 S BMSG(98)="*** These corrupt debtor file records must be reported to ***"
"RTN","RCTCSPD0",59,0)
 S BMSG(99)="*** region IT staff to be corrected immediately !!        ***"
"RTN","RCTCSPD0",60,0)
 S IEN=0,CTR=4 F  S IEN=$O(^XTMP("RCTCSPD",$J,"ZZUNDEF",IEN)) Q:'IEN  D
"RTN","RCTCSPD0",61,0)
 . S CTR=CTR+1,BMSG(CTR)="CORRUPT DEBTOR INTERNAL: "_IEN
"RTN","RCTCSPD0",62,0)
 S XMTEXT="BMSG("
"RTN","RCTCSPD0",63,0)
 Q:$G(ONEBILL)
"RTN","RCTCSPD0",64,0)
 D ^XMD
"RTN","RCTCSPD0",65,0)
 Q
"RTN","RCTCSPD0",66,0)
RSBILCHK(BILL,NOCHK) ; PRCA*4.5*350
"RTN","RCTCSPD0",67,0)
 ; Input: BILL - IEN for 430
"RTN","RCTCSPD0",68,0)
 ;        NOCHK - Comma separated value 
"RTN","RCTCSPD0",69,0)
 ; Output: 1 - bill passed
"RTN","RCTCSPD0",70,0)
 ;         0^fail#^message - bill failed^fail number^fail message
"RTN","RCTCSPD0",71,0)
 ; *************************************************************************
"RTN","RCTCSPD0",72,0)
 ; This is a copy of bill sending logic from RSBILL, except that it only checks if the bill passes or not and doesn't send any messages.
"RTN","RCTCSPD0",73,0)
 ; If you are updating RSBILL, please update this as well.   Alternatively, RSBILL can be rewritten.
"RTN","RCTCSPD0",74,0)
 ; *************************************************************************
"RTN","RCTCSPD0",75,0)
 N B0,B4,B6,B7,B9,B12,B121,B14,B15,B16,B19,B20,ACTION,TOTAL,CAT
"RTN","RCTCSPD0",76,0)
 N ACTDT,RC181DT,F60DT,X1,X2,SITE,CNTR,DEBTOR,DEBTOR0,DEBTOR1,DEBTOR3,DEBTOR7,DEBTOR8,RCDFN,DEMCS
"RTN","RCTCSPD0",77,0)
 S NOCHK=","_$G(NOCHK)_","
"RTN","RCTCSPD0",78,0)
 S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B9=$G(^(9)),B12=$G(^(12)),B121=$G(^(12.1)),B14=$G(^(14)),B15=$G(^(15)),B16=$G(^(16)),B19=$G(^(19)),B20=$G(^(20))
"RTN","RCTCSPD0",79,0)
 S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9)
"RTN","RCTCSPD0",80,0)
 I 'DEBTOR,NOCHK'[",0," Q "0^0^Bill has no debtor"
"RTN","RCTCSPD0",81,0)
 I NOCHK'[",0,",'$D(^RCD(340,DEBTOR,0)) Q "0^0^Bill has bad debtor"
"RTN","RCTCSPD0",82,0)
 S DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR1=$G(^(1)),DEBTOR3=$G(^(3)),DEBTOR7=$G(^(7))
"RTN","RCTCSPD0",83,0)
 S DEBTOR8=$O(^RCD(340,DEBTOR,8,"A"),-1) I DEBTOR8?1.N S DEBTOR8=$P($G(^RCD(340,DEBTOR,8,DEBTOR8,0)),U)
"RTN","RCTCSPD0",84,0)
 D RS1^RCTCSPD0
"RTN","RCTCSPD0",85,0)
 S RCDFN=+DEBTOR0
"RTN","RCTCSPD0",86,0)
 S DEMCS=$$DEM^RCTCSP1(RCDFN)
"RTN","RCTCSPD0",87,0)
 I ($P(B6,U,21)\1)<ACTDT,NOCHK'[",1," Q "0^1^Bill's DATE ACCOUNT ACTIVATED "_$$FMTE^XLFDT($P(B6,U,21),"5D")_" is before site CS activation date" ;cs activation date cutoff
"RTN","RCTCSPD0",88,0)
 ;Not needed, we can't quit here.  RCLLCHK sends recalls for recall request bills and <$25 bills.
"RTN","RCTCSPD0",89,0)
 ;It could also set 15 fields from 1 to 10
"RTN","RCTCSPD0",90,0)
 ;I $D(^PRCA(430,"TCSP",BILL)),$$RCLLCHK^RCTCSP2(BILL) Q  ;bill previously sent to TCSP
"RTN","RCTCSPD0",91,0)
 ;This looks to be updates to currently referred bill.  It sends potentially 2, 2A, 2C or 5B, none of which matters for debt.
"RTN","RCTCSPD0",92,0)
 ;I $$UPDCHK(BILL) Q
"RTN","RCTCSPD0",93,0)
 I +$P(B14,U,1),NOCHK'[",4," Q "0^4^Bill was referred to TOP on "_$$FMTE^XLFDT($P(B14,U),"5D")
"RTN","RCTCSPD0",94,0)
 I +$P(B12,U,1),NOCHK'[",7," Q "0^7^DATE SENT TO DMC "_$$FMTE^XLFDT($P(B4,U),"5D")_" is set for the bill"
"RTN","RCTCSPD0",95,0)
 I $P(B121,U,1)="N",NOCHK'[",8," Q "0^8^DMC DEBT is not valid"
"RTN","RCTCSPD0",96,0)
 I $P(B121,U,1)="P",NOCHK'[",9," Q "0^9^DMC DEBT is pending"
"RTN","RCTCSPD0",97,0)
 I $P(B6,U,4),($P(B6,U,5)="DOJ"),NOCHK'[",10," Q "0^10^Bill has been referred to DOJ on "_$$FMTE^XLFDT($P(B6,U,4),"5D")
"RTN","RCTCSPD0",98,0)
 I +$P(DEMCS,U,4),NOCHK'[",11," Q "0^11^Debtor is deceased"
"RTN","RCTCSPD0",99,0)
 ; Patch PRCA*4.5*338 (and maybe 351) will be replacing logic for errors 12, 13 and 14 with this:
"RTN","RCTCSPD0",100,0)
 ;Q:'$$RFCHK^RCTOPD(CAT,"N",1.03,$P(B6,U,21)) ;PRCA*4.5*338 - Use RFCHK^RCTOPD to determine if the Category can be referred using the new date based algorithm.
"RTN","RCTCSPD0",101,0)
 I '$P(B0,U,2),NOCHK'[",12," Q "0^12^Bill has no CATEGORY"
"RTN","RCTCSPD0",102,0)
 S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTCSPD0",103,0)
 I 'CAT,NOCHK'[",13," Q "0^13^Bill CATEGORY has no CATEGORY NUMBER"
"RTN","RCTCSPD0",104,0)
 I '$$RFCHK^RCTOPD(CAT,"N",1.03,$P(B6,U,21)),NOCHK'[",14," Q "0^14^Bill CATEGORY number "_CAT_" is not TCSP referable"
"RTN","RCTCSPD0",105,0)
 I B4,NOCHK'[",2," Q "0^2^Bill is on repayment plan started "_$$FMTE^XLFDT($P(B4,U),"5D")
"RTN","RCTCSPD0",106,0)
 I +$P(B15,U,7),NOCHK'[",3," Q "0^3^Bill has STOP FLAG set"
"RTN","RCTCSPD0",107,0)
 I DEBTOR8="S",NOCHK'[",26," Q "0^26^Debtor has STOP FLAG set" ;quit if debtor is stopped PRCA*4.5*350
"RTN","RCTCSPD0",108,0)
 I SITE40="S",NOCHK'[",27," Q "0^27^Site is stopped from sending referrals" ; quit if site is stopped PRCA*4.5*350
"RTN","RCTCSPD0",109,0)
 ;dpn checks
"RTN","RCTCSPD0",110,0)
 I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,'$P(B20,U,4),NOCHK'[",15," Q "0^15^DPN request not made yet"
"RTN","RCTCSPD0",111,0)
 I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),'$P(B20,U,5),NOCHK'[",16," Q "0^16^DPN letter is not printed yet"
"RTN","RCTCSPD0",112,0)
 I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),$P(B20,U,5) D  I X<60,NOCHK'[",17," Q "0^17^Less than 60 days from DPN letter printed date "_$$FMTE^XLFDT($P(B20,U,5),"5D")
"RTN","RCTCSPD0",113,0)
 .N X1,X2
"RTN","RCTCSPD0",114,0)
 .S X1=DT,X2=$P(B20,U,5) D ^%DTC
"RTN","RCTCSPD0",115,0)
 S BILLDT=$P(B6,U,21),PREPDT=$P(B0,U,10)
"RTN","RCTCSPD0",116,0)
 I BILLDT>P150DT,NOCHK'[",18," Q "0^18^Must be 150 days or more after LETTER1 date "_$$FMTE^XLFDT($P(B6,U),"5D")
"RTN","RCTCSPD0",117,0)
 I $P(DEBTOR1,"^",9)=1,NOCHK'[",5," Q "0^5^Debtor address marked unknown"
"RTN","RCTCSPD0",118,0)
 I $E($P(DEMCS,U,3),1,5)="00000",NOCHK'[",6," Q "0^6^SSN "_$P(DEMCS,U,3)_" is not valid"
"RTN","RCTCSPD0",119,0)
 I $P(B0,U,8)'=16,NOCHK'[",19," Q "0^19^Bill is not set to ACTIVE"
"RTN","RCTCSPD0",120,0)
 ; For rerefer, error 20 is not a showstopper.
"RTN","RCTCSPD0",121,0)
 I $P(B15,U,2),NOCHK'[",20," Q "0^20^Bill is marked as recalled"
"RTN","RCTCSPD0",122,0)
 ; Note: that is not a showstopper for re-refer, I think, but it is for refer.
"RTN","RCTCSPD0",123,0)
 I $D(^PRCA(430,"TCSP",BILL)),NOCHK'[",21," Q "0^21^Bill previously sent to TCSP"
"RTN","RCTCSPD0",124,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD0",125,0)
 I TOTAL<25,NOCHK'[",22," Q "0^22^Bills less than $25 can't be referred"
"RTN","RCTCSPD0",126,0)
 I $D(^PRCA(430,"TCSP",BILL)),NOCHK'[",23," Q "0^23^Bill is already referred"
"RTN","RCTCSPD0",127,0)
 I '$P(B6,U,3),NOCHK'[",24," Q "0^24^Third Letter has not been sent"
"RTN","RCTCSPD0",128,0)
 Q 1
"RTN","RCTCSPD0",129,0)
RRMARK ;
"RTN","RCTCSPD0",130,0)
 N I
"RTN","RCTCSPD0",131,0)
 F I=2,3,4,5,7,8,9,10 S $P(B15,U,I)="",$P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPD0",132,0)
 I $P($G(^PRCA(430,BILL,30)),U) K ^PRCA(430,"AN",$P(^PRCA(430,BILL,30),U),BILL) S $P(^PRCA(430,BILL,30),U)="" S $P(^PRCA(430,BILL,30),U,9)=1
"RTN","RCTCSPD0",133,0)
 S I=$O(^PRCA(430,BILL,15.5,99999),-1)
"RTN","RCTCSPD0",134,0)
 S $P(^PRCA(430,BILL,15.5,0),U,2)=430.03
"RTN","RCTCSPD0",135,0)
 S $P(^PRCA(430,BILL,15.5,0),U,3)=I+1
"RTN","RCTCSPD0",136,0)
 S $P(^PRCA(430,BILL,15.5,0),U,4)=$P(^PRCA(430,BILL,15.5,0),U,4)+1
"RTN","RCTCSPD0",137,0)
 S ^PRCA(430,BILL,15.5,I+1,0)=1_U_DT_U_$P($G(^PRCA(430,BILL,15.5,I,0)),U,3)
"RTN","RCTCSPD0",138,0)
 S ^PRCA(430,BILL,15.5,"B",1,I)=""
"RTN","RCTCSPD0",139,0)
 D NEWADI
"RTN","RCTCSPD0",140,0)
 Q
"RTN","RCTCSPD0",141,0)
NEWADI ;Make new Agency Debt ID trailer PRCA*4.5*350
"RTN","RCTCSPD0",142,0)
 N TRAIL,CHK
"RTN","RCTCSPD0",143,0)
 S TRAIL=$P($G(^PRCA(430,BILL,21)),U,2)
"RTN","RCTCSPD0",144,0)
 I TRAIL="" S TRAIL="AA"
"RTN","RCTCSPD0",145,0)
 E  S CHK=($A(TRAIL)-65)*26+($A(TRAIL,2)-65)+1,TRAIL=$C(CHK\26+65)_$C(CHK#26+65)
"RTN","RCTCSPD0",146,0)
 S $P(B15,U,15)=TRAIL,$P(^PRCA(430,BILL,21),U,2)=TRAIL
"RTN","RCTCSPD0",147,0)
 Q
"RTN","RCTCSPD4")
0^16^B137477745^B88898329
"RTN","RCTCSPD4",1,0)
RCTCSPD4 ;ALB/LMH-CROSS-SERVICING NON-FINANCIAL TRANSACTIONS ;03/15/14 3:34 PM
"RTN","RCTCSPD4",2,0)
 ;;4.5;Accounts Receivable;**315,339,350**;Mar 20, 1995;Build 66
"RTN","RCTCSPD4",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPD4",4,0)
 ;
"RTN","RCTCSPD4",5,0)
 Q 
"RTN","RCTCSPD4",6,0)
 ;
"RTN","RCTCSPD4",7,0)
STOP ; CS stop placed non-financial tx
"RTN","RCTCSPD4",8,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",9,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",10,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",11,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",12,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",13,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",14,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",15,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",16,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",33,0)) ;Transaction Type
"RTN","RCTCSPD4",17,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",18,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",19,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",20,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",21,0)
 S DR=DR_";5.02///CS STOP PLACED" D ^DIE
"RTN","RCTCSPD4",22,0)
 Q
"RTN","RCTCSPD4",23,0)
 ;
"RTN","RCTCSPD4",24,0)
DELSTOP ; CS delete stop non-financial tx
"RTN","RCTCSPD4",25,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",26,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",27,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",28,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",29,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",30,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",31,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",32,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",33,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",36,0)) ;Transaction Type
"RTN","RCTCSPD4",34,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",35,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",36,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",37,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",38,0)
 S DR=DR_";5.02///CS STOP DELETED" D ^DIE
"RTN","RCTCSPD4",39,0)
 Q
"RTN","RCTCSPD4",40,0)
 ;
"RTN","RCTCSPD4",41,0)
RCLL ; Recall from Cross-Servicing non-financial tx
"RTN","RCTCSPD4",42,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,DUZ
"RTN","RCTCSPD4",43,0)
 ;DUZ is reserved, but in this case DUZ may be undefined due to batch background job
"RTN","RCTCSPD4",44,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",45,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",46,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",47,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",48,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",49,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",50,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",51,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",34,0)) ;Transaction Type
"RTN","RCTCSPD4",52,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",53,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",54,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",55,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",56,0)
 S DR=DR_";5.02///CS BILL RECALL" D ^DIE
"RTN","RCTCSPD4",57,0)
 Q
"RTN","RCTCSPD4",58,0)
 ;
"RTN","RCTCSPD4",59,0)
DELRCLL ; Cross-Servicing Delete Bill Recall non-financial tx
"RTN","RCTCSPD4",60,0)
 ;
"RTN","RCTCSPD4",61,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",62,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",63,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",64,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",65,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",66,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",67,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",68,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",69,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",37,0)) ;Transaction Type
"RTN","RCTCSPD4",70,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",71,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",72,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",73,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",74,0)
 S DR=DR_";5.02///CS DEL BILL RECALL" D ^DIE
"RTN","RCTCSPD4",75,0)
 Q
"RTN","RCTCSPD4",76,0)
 ;
"RTN","RCTCSPD4",77,0)
NEWDEBTR ; CS add new debtor non-financial tx
"RTN","RCTCSPD4",78,0)
 ;         Called by RCTCSPD
"RTN","RCTCSPD4",79,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,X,PRCABN
"RTN","RCTCSPD4",80,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",81,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",82,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",83,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",84,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",85,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",86,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",87,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",48,0)) ;Transaction Type
"RTN","RCTCSPD4",88,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",89,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",90,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",91,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",92,0)
 S DR=DR_";5.02///CS NEW DBTR NEW BILL" D ^DIE
"RTN","RCTCSPD4",93,0)
 Q
"RTN","RCTCSPD4",94,0)
 ;
"RTN","RCTCSPD4",95,0)
RCRSD ; CS Debtor Recall non-financial tx
"RTN","RCTCSPD4",96,0)
 ; Set this debtor for Recall from Cross-Servicing
"RTN","RCTCSPD4",97,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,X
"RTN","RCTCSPD4",98,0)
 ;DUZ is reserved, but in this case DUZ may be undefined due to batch background job
"RTN","RCTCSPD4",99,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",100,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",101,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",102,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",103,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",104,0)
 S DR=".03///"_PRCABN ; BILL NUMBER
"RTN","RCTCSPD4",105,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",106,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",35,0)) ;Transaction Type
"RTN","RCTCSPD4",107,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",108,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",109,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",110,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",111,0)
 S DR=DR_";5.02///CS DEBTOR RECALL" D ^DIE
"RTN","RCTCSPD4",112,0)
 Q
"RTN","RCTCSPD4",113,0)
 ;
"RTN","RCTCSPD4",114,0)
DELSETD(BILL) ; CS Delete Debtor Recall non-financial tx
"RTN","RCTCSPD4",115,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSERX
"RTN","RCTCSPD4",116,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",117,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",118,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",119,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",120,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",121,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",122,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",123,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",38,0)) ;Transaction Type
"RTN","RCTCSPD4",124,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",125,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",126,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",127,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",128,0)
 S DR=DR_";5.02///CS DEL DEBTOR RECALL" D ^DIE
"RTN","RCTCSPD4",129,0)
 Q
"RTN","RCTCSPD4",130,0)
 ;
"RTN","RCTCSPD4",131,0)
DEBTOR ; CS New Bill Existing Debtor non-financial tx
"RTN","RCTCSPD4",132,0)
 ;
"RTN","RCTCSPD4",133,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,PRCABN
"RTN","RCTCSPD4",134,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",135,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",136,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",137,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",138,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",139,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",140,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",141,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",39,0)) ;Transaction Type
"RTN","RCTCSPD4",142,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",143,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",144,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",145,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",146,0)
 S DR=DR_";5.02///CS DEBTOR NEW BILL" D ^DIE ; Revised as requested
"RTN","RCTCSPD4",147,0)
 Q
"RTN","RCTCSPD4",148,0)
 ;
"RTN","RCTCSPD4",149,0)
CSCASE ;  Add Case Info non-financial tx 
"RTN","RCTCSPD4",150,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",151,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",152,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",153,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",154,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",155,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",156,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",157,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",158,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",47,0)) ;Transaction Type
"RTN","RCTCSPD4",159,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",160,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",161,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",162,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",163,0)
 S DR=DR_";5.02///CS ADD CASE INFO" D ^DIE
"RTN","RCTCSPD4",164,0)
 Q
"RTN","RCTCSPD4",165,0)
 ;
"RTN","RCTCSPD4",166,0)
DELSETC ; Cross-Servicing delete case recall non-financial tx
"RTN","RCTCSPD4",167,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",168,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",169,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",170,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",171,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",172,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",173,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",174,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",175,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",46,0)) ;Transaction Type
"RTN","RCTCSPD4",176,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",177,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",178,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",179,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",180,0)
 S DR=DR_";5.02///CS DEL CASE RECALL" D ^DIE
"RTN","RCTCSPD4",181,0)
 Q
"RTN","RCTCSPD4",182,0)
 ;
"RTN","RCTCSPD4",183,0)
DECADJ ; non-financial decrease adjustment transaction for 5b cross-servicing record
"RTN","RCTCSPD4",184,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",185,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",186,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",187,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",188,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",189,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",190,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",191,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",192,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",49,0)) ;Transaction Type
"RTN","RCTCSPD4",193,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",194,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",195,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",196,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",197,0)
 S DR=DR_";5.02///CS DECREASE ADJ" D ^DIE
"RTN","RCTCSPD4",198,0)
 Q 
"RTN","RCTCSPD4",199,0)
 ;
"RTN","RCTCSPD4",200,0)
DECADJ0 ; decrease adjustment transaction deletes cs date
"RTN","RCTCSPD4",201,0)
 ; 5B tx takes bal. of bill to 0 
"RTN","RCTCSPD4",202,0)
 ; if node 7 balances = 0.  Called by RCTCSPD
"RTN","RCTCSPD4",203,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",204,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",205,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",206,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",207,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",208,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",209,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",210,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",211,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",40,0)) ;Transaction Type
"RTN","RCTCSPD4",212,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",213,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",214,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",215,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",216,0)
 S DR=DR_";5.02///CS DECR ADJ NOT APP" D ^DIE
"RTN","RCTCSPD4",217,0)
 D CHKS
"RTN","RCTCSPD4",218,0)
 Q 
"RTN","RCTCSPD4",219,0)
 ;
"RTN","RCTCSPD4",220,0)
RCRSC ; Cross-Servicing case recall non-financial tx
"RTN","RCTCSPD4",221,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER
"RTN","RCTCSPD4",222,0)
 ;DUZ is reserved, but in this case DUZ may be undefined due to batch background job
"RTN","RCTCSPD4",223,0)
 S PRCABN=BILL,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",224,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",225,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",226,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",227,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",228,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",229,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",230,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",45,0)) ;Transaction Type
"RTN","RCTCSPD4",231,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",232,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",233,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",234,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",235,0)
 S DR=DR_";5.02///CS CASE RECALL" D ^DIE
"RTN","RCTCSPD4",236,0)
 Q
"RTN","RCTCSPD4",237,0)
RRREQ ; CS RE-REFER BILL REQUEST non-financial tx
"RTN","RCTCSPD4",238,0)
 ; Request a referral ;PRCA*4.5*350
"RTN","RCTCSPD4",239,0)
 ; INPUT: BILL,REASON,COMMENT
"RTN","RCTCSPD4",240,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,X
"RTN","RCTCSPD4",241,0)
 Q:$G(REASON)=""
"RTN","RCTCSPD4",242,0)
 S PRCABN=BILL ;,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",243,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",244,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",245,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",246,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",247,0)
 S DR=".03///"_PRCABN ; BILL NUMBER
"RTN","RCTCSPD4",248,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",249,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",63,0)) ;Transaction Type
"RTN","RCTCSPD4",250,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",251,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",252,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",253,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",254,0)
 S DR=DR_";5.02///CS RE-REFER BILL REQUEST"
"RTN","RCTCSPD4",255,0)
 S DR=DR_";41///"_$S(REASON="R":"Recall in error",REASON="T":"Treasury reversal",REASON="D":"Defaulted RPP",REASON="O":"Other: "_$G(COMMENT),1:" ")
"RTN","RCTCSPD4",256,0)
 D ^DIE
"RTN","RCTCSPD4",257,0)
 Q
"RTN","RCTCSPD4",258,0)
RRCAN ; CS RE-REFER BILL CANCEL non-financial tx
"RTN","RCTCSPD4",259,0)
 ; Cancel a referral request;PRCA*4.5*350
"RTN","RCTCSPD4",260,0)
 ; INPUT: BILL
"RTN","RCTCSPD4",261,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,X
"RTN","RCTCSPD4",262,0)
 S PRCABN=BILL ;,DUZ=.5,DUZ(0)="@",DUZ(2)=1 ; Server has no DUZ, use Postmaster
"RTN","RCTCSPD4",263,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",264,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",265,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",266,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",267,0)
 S DR=".03///"_PRCABN ; BILL NUMBER
"RTN","RCTCSPD4",268,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",269,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",65,0)) ;Transaction Type
"RTN","RCTCSPD4",270,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",271,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",272,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",273,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",274,0)
 S DR=DR_";5.02///CS RE-REFER BILL CANCEL"
"RTN","RCTCSPD4",275,0)
 D ^DIE
"RTN","RCTCSPD4",276,0)
 Q
"RTN","RCTCSPD4",277,0)
RRSEND ; CS New Bill Existing Debtor non-financial tx ; PRCA*4.5*350
"RTN","RCTCSPD4",278,0)
 ;
"RTN","RCTCSPD4",279,0)
 N PRCAEN,PRCAA1,DR,DIE,DA,D0,PRCAD,RCASK,PRCAA2,PRCA,PRCATY,RCUSER,PRCABN,DUZ,I
"RTN","RCTCSPD4",280,0)
 S PRCABN=BILL
"RTN","RCTCSPD4",281,0)
 S I=$O(^PRCA(430,BILL,15.5,99999),-1)
"RTN","RCTCSPD4",282,0)
 I I'="" S DUZ=$P($G(^PRCA(430,BILL,15.5,I,0)),U,3)
"RTN","RCTCSPD4",283,0)
 S:'$G(DUZ) DUZ=.5 ; Server has no DUZ, use Postmaster if can't find it
"RTN","RCTCSPD4",284,0)
 S DUZ(0)="@",DUZ(2)=1
"RTN","RCTCSPD4",285,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL Q:'$D(PRCAEN)
"RTN","RCTCSPD4",286,0)
 S PRCAA1=$S($D(^PRCA(433,PRCAEN,4,0)):+$P(^(0),U,4),1:0)
"RTN","RCTCSPD4",287,0)
 Q:PRCAA1'>0  S PRCAA2=$P(^(0),U,3)
"RTN","RCTCSPD4",288,0)
 S DIE="^PRCA(433,",DA=PRCAEN
"RTN","RCTCSPD4",289,0)
 S DR=".03///"_PRCABN ;Bill Number
"RTN","RCTCSPD4",290,0)
 S DR=DR_";3///0" ;Calm Code Done
"RTN","RCTCSPD4",291,0)
 S DR=DR_";12///"_$O(^PRCA(430.3,"AC",64,0)) ;Transaction Type
"RTN","RCTCSPD4",292,0)
 S DR=DR_";15///0" ;Transaction Amount
"RTN","RCTCSPD4",293,0)
 S DR=DR_";42///"_DUZ ;Processed by user
"RTN","RCTCSPD4",294,0)
 S DR=DR_";11///"_DT ;Transaction date
"RTN","RCTCSPD4",295,0)
 S DR=DR_";4///2" ;Transaction status (complete)
"RTN","RCTCSPD4",296,0)
 S DR=DR_";5.02///CS DEBTOR RE-REFER BILL" D ^DIE ; Revised as requested
"RTN","RCTCSPD4",297,0)
 Q 
"RTN","RCTCSPD4",298,0)
 ;
"RTN","RCTCSPD4",299,0)
CHKS ;Leave validation checks in place
"RTN","RCTCSPD4",300,0)
 I $P($G(^PRCA(433,PRCAEN,5)),"^",2)=""!'$P(^PRCA(433,PRCAEN,1),"^") S PRCACOMM="TRANSACTION INCOMPLETE" D DELETE^PRCAWO1 K PRCACOMM Q
"RTN","RCTCSPD4",301,0)
 I '$D(PRCAD("DELETE")) S RCASK=1 D TRANUP^PRCAUTL,UPPRIN^PRCADJ
"RTN","RCTCSPD4",302,0)
 I $P($G(^RCD(340,+$P(^PRCA(430,PRCABN,0),"^",9),0)),"^")[";DPT(" D
"RTN","RCTCSPD4",303,0)
 .;Ensure comment does not appear on patient statement
"RTN","RCTCSPD4",304,0)
 .S $P(^PRCA(433,PRCAEN,0),"^",10)=1
"RTN","RCTCSPD4",305,0)
 Q
"RTN","RCTCSPD4",306,0)
 ; End of RCTCSPD4
"RTN","RCTCSPU")
0^17^B158004141^B79474233
"RTN","RCTCSPU",1,0)
RCTCSPU ;ALBANY/BDB-CROSS-SERVICING UTILITIES ;03/15/14 3:34 PM
"RTN","RCTCSPU",2,0)
 ;;4.5;Accounts Receivable;**301,315,350**;Mar 20, 1995;Build 66
"RTN","RCTCSPU",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPU",4,0)
 Q
"RTN","RCTCSPU",5,0)
 ;
"RTN","RCTCSPU",6,0)
 ;total amount of bills for a debtor
"RTN","RCTCSPU",7,0)
TOTALB(DEBTOR) ;
"RTN","RCTCSPU",8,0)
 N TOTAL,BILL,B7
"RTN","RCTCSPU",9,0)
 S TOTAL=0,BILL=0
"RTN","RCTCSPU",10,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",11,0)
 .Q:'$D(^PRCA(430,"TCSP",BILL))
"RTN","RCTCSPU",12,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSPU",13,0)
 .S TOTAL=TOTAL+$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPU",14,0)
 Q TOTAL
"RTN","RCTCSPU",15,0)
 ;
"RTN","RCTCSPU",16,0)
 ;stop TCSP referral on a bill
"RTN","RCTCSPU",17,0)
STOP ;stop Cross-Servicing referral
"RTN","RCTCSPU",18,0)
 N DIC,DIE,DA,DR,DIR,Y,BILL,REASON,COMMENT,EFFDT
"RTN","RCTCSPU",19,0)
 I $G(GOTBILL) S BILL=RCBILLDA  ;PRCA*4.5*315
"RTN","RCTCSPU",20,0)
 I '$G(GOTBILL) S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0  ;PRCA*4.5*315
"RTN","RCTCSPU",21,0)
 I '$G(GOTBILL) S BILL=+Y  ;PRCA*4.5*315
"RTN","RCTCSPU",22,0)
 I $P($G(^PRCA(430,BILL,15)),U,7) G DELSTOP
"RTN","RCTCSPU",23,0)
 W !,"Stop flag for Cross-Servicing Referral set? : NO"
"RTN","RCTCSPU",24,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to stop the Cross-Servicing Referral for this bill" D ^DIR
"RTN","RCTCSPU",25,0)
 I $G(GOTBILL),$D(DIRUT) S RCDPGQ=1      ; account profile listman quit flag  *315
"RTN","RCTCSPU",26,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",27,0)
 ;
"RTN","RCTCSPU",28,0)
REASON ;ask referral reason
"RTN","RCTCSPU",29,0)
 K DIR S DIR("A")="Enter Stop Cross-Servicing Reason ",DA=BILL,DIR(0)="430,159" D ^DIR
"RTN","RCTCSPU",30,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",31,0)
 S REASON=Y I REASON="O" D  Q:COMMENT=U  G REASON:COMMENT=""
"RTN","RCTCSPU",32,0)
 .S COMMENT="",DIR("A")="Enter Stop Reason Comment ",DA=BILL,DIR(0)="430,159.1" D ^DIR S COMMENT=Y
"RTN","RCTCSPU",33,0)
 .I COMMENT="" W !,"A Reason of Other requires a comment to be entered"
"RTN","RCTCSPU",34,0)
 .Q
"RTN","RCTCSPU",35,0)
 I REASON'="O",$P($G(^PRCA(430,BILL,15)),U,10)'="" S $P(^(15),U,10)=""
"RTN","RCTCSPU",36,0)
 ;
"RTN","RCTCSPU",37,0)
 ;ask effective date
"RTN","RCTCSPU",38,0)
 ;
"RTN","RCTCSPU",39,0)
 S DIR(0)="430,158",DA=BILL,DIR("A")="Enter Effective Date " D ^DIR G:Y=U STOPQ S EFFDT=Y
"RTN","RCTCSPU",40,0)
 ;
"RTN","RCTCSPU",41,0)
STOPFILE ;set stop referral data in file 430
"RTN","RCTCSPU",42,0)
 S $P(^PRCA(430,BILL,15),U,7,10)="1^"_EFFDT_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPU",43,0)
 ;
"RTN","RCTCSPU",44,0)
 W !,"Stop Cross-Servicing Referral complete"
"RTN","RCTCSPU",45,0)
 D STOP^RCTCSPD4 ; *315 Create CS Stop Placed comment tx in 433
"RTN","RCTCSPU",46,0)
 G STOPQ
"RTN","RCTCSPU",47,0)
 ;
"RTN","RCTCSPU",48,0)
DELSTOP ;Allows Cross-Servicing Referral to be re-instituted for bill
"RTN","RCTCSPU",49,0)
 N I
"RTN","RCTCSPU",50,0)
 W !!,*7,"Referral to Cross-Servicing has already been stopped for this bill."
"RTN","RCTCSPU",51,0)
 W !,"Stop Cross-Servicing referral effective date: ",$$GET1^DIQ(430,BILL,158,"E")
"RTN","RCTCSPU",52,0)
 W !,"Stop Cross-Servicing referral reason        : ",$$GET1^DIQ(430,BILL,159,"E")
"RTN","RCTCSPU",53,0)
 I $$GET1^DIQ(430,BILL,159,"E")="OTHER" W !,"Stop Cross-Servicing referral comment       : ",$$GET1^DIQ(430,BILL,159.1,"E")
"RTN","RCTCSPU",54,0)
 S DIR(0)="Y",DIR("A")="Do you wish to re-institute Cross-Servicing Referral for this bill",DIR("B")="NO"
"RTN","RCTCSPU",55,0)
 D ^DIR
"RTN","RCTCSPU",56,0)
 I $G(GOTBILL),$D(DIRUT) S RCDPGQ=1 G STOPQ        ; account profile listman quit flag  *315
"RTN","RCTCSPU",57,0)
 G EDSTOP:'Y
"RTN","RCTCSPU",58,0)
 ;
"RTN","RCTCSPU",59,0)
 ;reset file to allow cross-servicing referral to be re-started
"RTN","RCTCSPU",60,0)
 F I=7:1:10 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",61,0)
 W !!,"Bill is now eligible to be Referred to Cross-Servicing" D DELSTOP^RCTCSPD4 G STOPQ ; *315 create CS Stop Deleted transaction
"RTN","RCTCSPU",62,0)
 ;
"RTN","RCTCSPU",63,0)
EDSTOP S DIR(0)="Y",DIR("A")="Do you wish to edit the Stop Referral Data for this bill",DIR("B")="NO" D ^DIR G REASON:Y
"RTN","RCTCSPU",64,0)
STOPQ Q
"RTN","RCTCSPU",65,0)
 ;
"RTN","RCTCSPU",66,0)
 ;Set Cross-Servicing recall for a bill
"RTN","RCTCSPU",67,0)
RCLLSETB ;Set Cross-Servicing recall
"RTN","RCTCSPU",68,0)
 N DIC,DIE,DA,DR,DIR,Y,BILL,REASON
"RTN","RCTCSPU",69,0)
 I '$G(GOTBILL) S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",70,0)
 I '$G(GOTBILL) S BILL=+Y
"RTN","RCTCSPU",71,0)
 I $G(GOTBILL) S BILL=RCBILLDA
"RTN","RCTCSPU",72,0)
 I $P($G(^PRCA(430,BILL,15)),U,2) G DELSETB
"RTN","RCTCSPU",73,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to set this bill to be recalled from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",74,0)
 I $G(GOTBILL),$D(DIRUT) S RCDPGQ=1        ; account profile listman quit flag  *315
"RTN","RCTCSPU",75,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",76,0)
 I '$D(^PRCA(430,"TCSP",BILL)) W !,*7,"No action taken.  Bill has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",77,0)
 ; 
"RTN","RCTCSPU",78,0)
RCRSB ;ask recall reason
"RTN","RCTCSPU",79,0)
 K DIR S DIR(0)="S^01:DEBT REFERRED IN ERROR;07:AGENCY IS FORGIVING DEBT;08:AGENCY CAN COLLECT THROUGH INTERNAL OFFSET" D ^DIR
"RTN","RCTCSPU",80,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",81,0)
 ;set recall data in file 430
"RTN","RCTCSPU",82,0)
 S REASON=Y
"RTN","RCTCSPU",83,0)
 S $P(^PRCA(430,BILL,15),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",84,0)
 D CSRCLPL^RCTCSPD5 ; *315 CS Recall Placed comment tx in 433
"RTN","RCTCSPU",85,0)
 W !,"Setting this bill for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",86,0)
 G SETBQ
"RTN","RCTCSPU",87,0)
 ;
"RTN","RCTCSPU",88,0)
RRSET ; Set rerefer for bills PRCA*4.5*350
"RTN","RCTCSPU",89,0)
 N BILL,STOP
"RTN","RCTCSPU",90,0)
 S STOP=0
"RTN","RCTCSPU",91,0)
 F  D RRSETB Q:BILL=""  Q:STOP
"RTN","RCTCSPU",92,0)
 Q
"RTN","RCTCSPU",93,0)
 ; Set rerefer for bill PRCA*4.5*350
"RTN","RCTCSPU",94,0)
RRSETB ;
"RTN","RCTCSPU",95,0)
 N DIC,DIE,DA,DR,DIR,Y,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCTCSPU",96,0)
 N WR,EXE,DEBTOR,CHECK,REASON,COMMENT,LIEN,QUIT,FIXABLE
"RTN","RCTCSPU",97,0)
 S BILL="",LIEN="",QUIT=""
"RTN","RCTCSPU",98,0)
 ; Still experimenting if to use DIC or DIR
"RTN","RCTCSPU",99,0)
 S DIC=430,DIC(0)="AEQMS",DIC("A")="Enter Bill Number for re-referral: "
"RTN","RCTCSPU",100,0)
 ; we will allow selection of bills here and show error message if we don't like bill.
"RTN","RCTCSPU",101,0)
 ;S DIC("S")="I $D(^PRCA(430,Y,15))" 
"RTN","RCTCSPU",102,0)
 D ^DIC
"RTN","RCTCSPU",103,0)
 S BILL=+Y S:Y=-1 STOP=1
"RTN","RCTCSPU",104,0)
 I STOP Q
"RTN","RCTCSPU",105,0)
 S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9)
"RTN","RCTCSPU",106,0)
 I $$RR^RCTCSPU(BILL)=0 D  Q:STOP  Q:QUIT
"RTN","RCTCSPU",107,0)
 . N NZ,REASON,COMMENT
"RTN","RCTCSPU",108,0)
 . W !!,"Re-Referral has already been requested",!
"RTN","RCTCSPU",109,0)
 . S LIEN=$O(^PRCA(430,BILL,15.5,99999),-1)
"RTN","RCTCSPU",110,0)
 . S NZ=^PRCA(430,BILL,15.5,LIEN,0),REASON=$P(NZ,U,4),COMMENT=$P(NZ,U,5)
"RTN","RCTCSPU",111,0)
 . W !,"By ",$P(^VA(200,$P(NZ,U,3),0),U)," on ",$$FMTE^XLFDT($P(NZ,U,2),"5Z"),"   Reason: "
"RTN","RCTCSPU",112,0)
 . W $S(REASON="R":"Recall in error",REASON="T":"Treasury reversal",REASON="D":"Defaulted RPP",REASON="O":"Other: "_COMMENT,1:""),!
"RTN","RCTCSPU",113,0)
 . K DIR S DIR("A")="Do you want to Cancel this Re-Referral",DIR("B")="NO",DIR(0)="Y" D ^DIR
"RTN","RCTCSPU",114,0)
 . I X="" S STOP=1 Q
"RTN","RCTCSPU",115,0)
 . I $G(DTOUT) S STOP=1 Q
"RTN","RCTCSPU",116,0)
 . I $G(DIROUT) S STOP=1 Q 
"RTN","RCTCSPU",117,0)
 . I $G(DUOUT) S STOP=1 Q
"RTN","RCTCSPU",118,0)
 . I Y D  S QUIT=1 Q
"RTN","RCTCSPU",119,0)
 . . ; remove LIEN from 15.5.   Use DIK?
"RTN","RCTCSPU",120,0)
 . . I LIEN=1 K ^PRCA(430,BILL,15.5,0)
"RTN","RCTCSPU",121,0)
 . . E  S $P(^PRCA(430,BILL,15.5,0),U,2)=430.03,$P(^PRCA(430,BILL,15.5,0),U,3)=LIEN-1,$P(^PRCA(430,BILL,15.5,0),U,4)=$P(^PRCA(430,BILL,15.5,0),U,4)-1
"RTN","RCTCSPU",122,0)
 . . K ^PRCA(430,BILL,15.5,LIEN)
"RTN","RCTCSPU",123,0)
 . . K ^PRCA(430,BILL,15.5,"B",0,LIEN)
"RTN","RCTCSPU",124,0)
 . . D RRCAN^RCTCSPD4
"RTN","RCTCSPU",125,0)
 . . W !!,"*** Re-Referral has been cancelled for this bill ***"
"RTN","RCTCSPU",126,0)
 . . Q
"RTN","RCTCSPU",127,0)
 . K DIR S DIR("A")="Do you want to Update this Re-Referral",DIR("B")="NO",DIR(0)="Y" D ^DIR
"RTN","RCTCSPU",128,0)
 . I X="" S QUIT=1 Q
"RTN","RCTCSPU",129,0)
 . I $G(DTOUT) S STOP=1 Q
"RTN","RCTCSPU",130,0)
 . I $G(DIROUT) S STOP=1 Q 
"RTN","RCTCSPU",131,0)
 . I $G(DUOUT) S STOP=1 Q
"RTN","RCTCSPU",132,0)
 . I X?1"N".E!(X?1"n".E) W !!,"*** No changes applied to this re-referral ***",! S QUIT=1 Q
"RTN","RCTCSPU",133,0)
 D
"RTN","RCTCSPU",134,0)
 . S CHECK=1
"RTN","RCTCSPU",135,0)
 . I 'DEBTOR S CHECK="0^0^Bill has no debtor" Q
"RTN","RCTCSPU",136,0)
 . I '$P($G(^PRCA(430,BILL,30)),U),'$P($G(^PRCA(430,BILL,15)),U,3) S CHECK="0^0^Bill is not Returned or Recalled, so can't re-refer" Q
"RTN","RCTCSPU",137,0)
 . ; Disabling Stop flag is OK for now, but we will need to clear it at some point.   Batch Job?
"RTN","RCTCSPU",138,0)
 . S CHECK=$$RSBILCHK^RCTCSPD0(BILL,"3,20")
"RTN","RCTCSPU",139,0)
 I 'CHECK D  Q
"RTN","RCTCSPU",140,0)
 . S FIXABLE=$F(",0,3,5,6,12,15,16,19,20,21,24,26,27,",","_$P(CHECK,U,2)_",")
"RTN","RCTCSPU",141,0)
 . I 'FIXABLE W !!,"Unable to complete the re-referral process",!,$P(CHECK,U,3) Q
"RTN","RCTCSPU",142,0)
 . W !!,"This bill has issues and will not make it through re-referral process because:",!,$P(CHECK,U,3)
"RTN","RCTCSPU",143,0)
 . W !!,"PLEASE CORRECT THIS ISSUE AND THEN RE-REFER THE BILL AGAIN",!
"RTN","RCTCSPU",144,0)
 . K DIR S DIR(0)="FO",DIR("A")="Press <ENTER> to continue " D ^DIR
"RTN","RCTCSPU",145,0)
 . I (Y=U)!$G(DTOUT)!$G(DUOUT) S STOP=1
"RTN","RCTCSPU",146,0)
 ; Ask Rerefer Reason and description if O=Other
"RTN","RCTCSPU",147,0)
 K DIR S DIR(0)="S^R:Recall in error;T:Treasury reversal;D:Defaulted RPP;O:Other"
"RTN","RCTCSPU",148,0)
 S DIR("A")="Select Reason for this re-referral"
"RTN","RCTCSPU",149,0)
 D ^DIR
"RTN","RCTCSPU",150,0)
 I (Y="")!(Y=U)!$G(DTOUT)!$G(DUOUT) S STOP=1 Q
"RTN","RCTCSPU",151,0)
 W !
"RTN","RCTCSPU",152,0)
 S REASON=Y
"RTN","RCTCSPU",153,0)
 I REASON="O" K DIR S DIR(0)="F^1:30",DIR("A")="Enter ""Other"" description " D ^DIR Q:Y=""  Q:Y=U  S COMMENT=Y
"RTN","RCTCSPU",154,0)
 ; Are you sure (do we want to ask this for update to rereferral?)
"RTN","RCTCSPU",155,0)
 K DIR S DIR("A")="Are you sure you want to Re-refer this bill for Cross-Servicing",DIR(0)="Y",DIR("B")="YES"
"RTN","RCTCSPU",156,0)
 D ^DIR
"RTN","RCTCSPU",157,0)
 I (Y=U)!$G(DTOUT)!$G(DUOUT) S STOP=1 Q
"RTN","RCTCSPU",158,0)
 I 'Y W !!,"*** No updates applied ***" Q
"RTN","RCTCSPU",159,0)
 ; user, date, status of rerefer
"RTN","RCTCSPU",160,0)
 I LIEN'="" D
"RTN","RCTCSPU",161,0)
 . ; That should be all we need for update of last IEN
"RTN","RCTCSPU",162,0)
 . S ^PRCA(430,BILL,15.5,LIEN,0)=0_U_DT_U_DUZ_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPU",163,0)
 I LIEN="" D
"RTN","RCTCSPU",164,0)
 . S LIEN=$O(^PRCA(430,BILL,15.5,99999),-1)+1
"RTN","RCTCSPU",165,0)
 . S $P(^PRCA(430,BILL,15.5,0),U,2)=430.03
"RTN","RCTCSPU",166,0)
 . S $P(^PRCA(430,BILL,15.5,0),U,3)=LIEN
"RTN","RCTCSPU",167,0)
 . S $P(^PRCA(430,BILL,15.5,0),U,4)=$P(^PRCA(430,BILL,15.5,0),U,4)+1
"RTN","RCTCSPU",168,0)
 . S ^PRCA(430,BILL,15.5,LIEN,0)=0_U_DT_U_DUZ_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPU",169,0)
 . S ^PRCA(430,BILL,15.5,"B",0,LIEN)=""
"RTN","RCTCSPU",170,0)
 W !!,"Bill is set to be re-referred to Cross-Servicing in the next weekly transmission"
"RTN","RCTCSPU",171,0)
 W !
"RTN","RCTCSPU",172,0)
 ; file Rerefer Request transaction
"RTN","RCTCSPU",173,0)
 D RRREQ^RCTCSPD4
"RTN","RCTCSPU",174,0)
 K DIR S DIR(0)="FO",DIR("A")="Press <ENTER> to continue " D ^DIR
"RTN","RCTCSPU",175,0)
 W !
"RTN","RCTCSPU",176,0)
 I (Y=U)!$G(DTOUT)!$G(DUOUT) S STOP=1 Q
"RTN","RCTCSPU",177,0)
 Q
"RTN","RCTCSPU",178,0)
RR(BILL) ; PRCA*4.5*350
"RTN","RCTCSPU",179,0)
 ; Return: Null = no RR, 0 = RR Requested, 1 = RR Performed
"RTN","RCTCSPU",180,0)
 N LIEN
"RTN","RCTCSPU",181,0)
 Q:BILL="" ""
"RTN","RCTCSPU",182,0)
 S LIEN=$O(^PRCA(430,BILL,15.5,99999),-1)
"RTN","RCTCSPU",183,0)
 I LIEN<1 Q ""
"RTN","RCTCSPU",184,0)
 Q $P(^PRCA(430,BILL,15.5,LIEN,0),U)
"RTN","RCTCSPU",185,0)
 ;
"RTN","RCTCSPU",186,0)
RRD(DEBTOR) ; PRCA*4.5*350
"RTN","RCTCSPU",187,0)
 ; Return: 0 = Debtor has no RR bills, 1 = Debtor has RR bills
"RTN","RCTCSPU",188,0)
 Q:DEBTOR="" 0
"RTN","RCTCSPU",189,0)
 N BILL,OUT
"RTN","RCTCSPU",190,0)
 S BILL="",OUT=0
"RTN","RCTCSPU",191,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL=""  I $$RR(BILL) S OUT=1 Q
"RTN","RCTCSPU",192,0)
 Q OUT
"RTN","RCTCSPU",193,0)
 ;
"RTN","RCTCSPU",194,0)
DELSETB ;Allows Cross-Servicing Recall to be deleted for bill
"RTN","RCTCSPU",195,0)
 W !!,*7,"This bill has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",196,0)
 I +$P($G(^PRCA(430,BILL,15)),U,3) W !!,"Not available for reactivation.  The Recall request has already been processed." G SETBQ
"RTN","RCTCSPU",197,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this bill",DIR("B")="NO"
"RTN","RCTCSPU",198,0)
 D ^DIR
"RTN","RCTCSPU",199,0)
 I $G(GOTBILL),$D(DIRUT) S RCDPGQ=1 G SETBQ         ; account profile listman quit flag  *315
"RTN","RCTCSPU",200,0)
 G EDSETB:'Y
"RTN","RCTCSPU",201,0)
 ;
"RTN","RCTCSPU",202,0)
 ;delete the recall
"RTN","RCTCSPU",203,0)
 F I=2:1:5 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",204,0)
 D DELRCLL^RCTCSPD4 ; *315 Create CS Delete Recall comment tx in 433
"RTN","RCTCSPU",205,0)
 W !!,"Recall from Cross-Servicing has been deleted for this bill."
"RTN","RCTCSPU",206,0)
 G SETBQ
"RTN","RCTCSPU",207,0)
 ;
"RTN","RCTCSPU",208,0)
EDSETB S DIR(0)="Y",DIR("A")="Do you wish to edit the Recall data for this bill",DIR("B")="NO" D ^DIR G RCRSB:Y
"RTN","RCTCSPU",209,0)
SETBQ Q
"RTN","RCTCSPU",210,0)
 ;
"RTN","RCTCSPU",211,0)
 ;Set Cross-Servicing recall for a debtor
"RTN","RCTCSPU",212,0)
RCLLSETD ;Set Cross-Servicing debtor recall
"RTN","RCTCSPU",213,0)
 N DIC,DIE,DA,DR,DIR,Y,DEBTOR,REASON,BILL
"RTN","RCTCSPU",214,0)
 ; GOTDEBT, RCDEBTDA  - are defined if called from List Manager
"RTN","RCTCSPU",215,0)
 I '$G(GOTDEBT) S DIC=340,DIC(0)="AEQM" D ^DIC Q:Y<0      ; *315
"RTN","RCTCSPU",216,0)
 I '$G(GOTDEBT) S DEBTOR=+Y                               ; *315
"RTN","RCTCSPU",217,0)
 I $G(GOTDEBT) S DEBTOR=RCDEBTDA                          ; *315  
"RTN","RCTCSPU",218,0)
 I $P($G(^RCD(340,DEBTOR,7)),U,2),'$P($G(^RCD(340,DEBTOR,7)),U,3) G DELSETD
"RTN","RCTCSPU",219,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to recall this debtor and bills from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",220,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",221,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) W !,*7,"No action taken.  Debtor has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",222,0)
 ;
"RTN","RCTCSPU",223,0)
RCRSD ;ask debtor recall reason
"RTN","RCTCSPU",224,0)
 K DIR S DIR(0)="340,7.04" D ^DIR
"RTN","RCTCSPU",225,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",226,0)
 ;set debtor recall data in file 340
"RTN","RCTCSPU",227,0)
 S REASON=Y
"RTN","RCTCSPU",228,0)
 S $P(^RCD(340,DEBTOR,7),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",229,0)
 ;go through debtor bills and set reason in the bill recall reason
"RTN","RCTCSPU",230,0)
 S BILL=0
"RTN","RCTCSPU",231,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",232,0)
 .I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP
"RTN","RCTCSPU",233,0)
 ..S $P(^PRCA(430,BILL,15),U,2,4)="1^^"_REASON ;set the recall flag and reason (TV9)
"RTN","RCTCSPU",234,0)
 ..D CSRCLPL^RCTCSPD5 ; *315 Create CS RECALL PLACED tx in 433
"RTN","RCTCSPU",235,0)
 W !,"Setting this debtor for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",236,0)
 G SETDQ
"RTN","RCTCSPU",237,0)
 ;
"RTN","RCTCSPU",238,0)
DELSETD ;Allows Cross-Servicing Recall to be deleted for debtor
"RTN","RCTCSPU",239,0)
 W !!,*7,"This debtor has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",240,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this debtor",DIR("B")="NO" D ^DIR G EDSETD:'Y
"RTN","RCTCSPU",241,0)
 ;
"RTN","RCTCSPU",242,0)
 ;delete the recall in file 340
"RTN","RCTCSPU",243,0)
 F I=2:1:4 S $P(^RCD(340,DEBTOR,7),U,I)=""
"RTN","RCTCSPU",244,0)
 ;go through debtor bills and delete the recall flag & reason
"RTN","RCTCSPU",245,0)
 S BILL=0
"RTN","RCTCSPU",246,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",247,0)
 .I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP 
"RTN","RCTCSPU",248,0)
 ..S $P(^PRCA(430,BILL,15),U,2)="" ; delete the recall flag PRCA*4.5*315 
"RTN","RCTCSPU",249,0)
 ..S $P(^PRCA(430,BILL,15),U,4)="" ; delete the recall reason
"RTN","RCTCSPU",250,0)
 ..D DELRCLL^RCTCSPD4 ; *315 CS DEL BILL RECALL in 433
"RTN","RCTCSPU",251,0)
 ;
"RTN","RCTCSPU",252,0)
 W !!,"Recall from Cross-Servicing has been deleted for this debtor."
"RTN","RCTCSPU",253,0)
 G SETDQ
"RTN","RCTCSPU",254,0)
 ;
"RTN","RCTCSPU",255,0)
EDSETD S DIR(0)="Y",DIR("A")="Do you wish to edit the Recall data for this debtor",DIR("B")="NO" D ^DIR G RCRSD:Y
"RTN","RCTCSPU",256,0)
SETDQ Q
"RTN","RCTCSPU",257,0)
 ;
"RTN","RCTCSPU",258,0)
DECADJ(RCBILLDA,RCTRANDA) ;decrease adjustment transaction history for 5b cross-servicing record
"RTN","RCTCSPU",259,0)
 ;rcbillda - file 430 bill ien
"RTN","RCTCSPU",260,0)
 ;rctranda - file 433 transaction ien
"RTN","RCTCSPU",261,0)
 N BILL,DIC,DA,DIE,DR,Y,X
"RTN","RCTCSPU",262,0)
 I '$D(RCBILLDA)!('$D(RCTRANDA)) Q
"RTN","RCTCSPU",263,0)
 S X=RCTRANDA
"RTN","RCTCSPU",264,0)
 S DIC="^PRCA(430,"_RCBILLDA_",17,",DIC(0)="L"
"RTN","RCTCSPU",265,0)
 I '$D(^PRCA(430,RCBILLDA,17,0)) S ^PRCA(430,RCBILLDA,17,0)="^430.0171PA^0^0"
"RTN","RCTCSPU",266,0)
 S DIC("P")=$P(^PRCA(430,RCBILLDA,17,0),"^",2)
"RTN","RCTCSPU",267,0)
 S DA(1)=RCBILLDA
"RTN","RCTCSPU",268,0)
 S BILL=RCBILLDA
"RTN","RCTCSPU",269,0)
 D ^DIC I Y=-1 K DIC,DA Q
"RTN","RCTCSPU",270,0)
 S DIE=DIC K DIC
"RTN","RCTCSPU",271,0)
 S DA=+Y
"RTN","RCTCSPU",272,0)
 S DR="1////1" D ^DIE ; Reinstated the 4 slashes
"RTN","RCTCSPU",273,0)
 Q
"RTN","RCTCSPU",274,0)
 ;
"RTN","RCTCSPU",275,0)
INCADJ(RCBILLDA,RCTRANDA) ;increase adjustment transaction history for 5b cross-servicing record 315/DRF
"RTN","RCTCSPU",276,0)
 ;rcbillda - file 430 bill ien
"RTN","RCTCSPU",277,0)
 ;rctranda - file 433 transaction ien
"RTN","RCTCSPU",278,0)
 N DIC,DA,DIE,DR,Y,X
"RTN","RCTCSPU",279,0)
 I '$D(RCBILLDA)!('$D(RCTRANDA)) Q
"RTN","RCTCSPU",280,0)
 S X=RCTRANDA
"RTN","RCTCSPU",281,0)
 S DIC="^PRCA(430,"_RCBILLDA_",17,",DIC(0)="L"
"RTN","RCTCSPU",282,0)
 I '$D(^PRCA(430,RCBILLDA,17,0)) S ^PRCA(430,RCBILLDA,17,0)="^430.0171PA^0^0"
"RTN","RCTCSPU",283,0)
 S DIC("P")=$P(^PRCA(430,RCBILLDA,17,0),"^",2)
"RTN","RCTCSPU",284,0)
 S DA(1)=RCBILLDA
"RTN","RCTCSPU",285,0)
 D ^DIC I Y=-1 K DIC,DA Q
"RTN","RCTCSPU",286,0)
 S DIE=DIC K DIC
"RTN","RCTCSPU",287,0)
 S DA=+Y
"RTN","RCTCSPU",288,0)
 S DR="1////1" D ^DIE
"RTN","RCTCSPU",289,0)
 Q
"RTN","RCTCSPU",290,0)
 ;
"RTN","RCTCSPU",291,0)
RCLLSETC ;Set Cross-Servicing recall for a case
"RTN","RCTCSPU",292,0)
 N DIC,DIE,DA,DR,DIR,Y,BILL,REASON
"RTN","RCTCSPU",293,0)
 S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",294,0)
 S BILL=+Y
"RTN","RCTCSPU",295,0)
 I $P($G(^PRCA(430,BILL,15)),U,11) G DELSETC
"RTN","RCTCSPU",296,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to set this case to be recalled from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",297,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",298,0)
 I '$D(^PRCA(430,"TCSP",BILL)) W !,*7,"No action taken.  Case has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",299,0)
 ; 
"RTN","RCTCSPU",300,0)
RCRSC ;set case recall reason
"RTN","RCTCSPU",301,0)
 ;set recall data in file 430 for the bill and the case
"RTN","RCTCSPU",302,0)
 S REASON=15
"RTN","RCTCSPU",303,0)
 S $P(^PRCA(430,BILL,15),U,11,13)="1^^"_REASON
"RTN","RCTCSPU",304,0)
 S $P(^PRCA(430,BILL,15),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",305,0)
 ;
"RTN","RCTCSPU",306,0)
 D RCRSC^RCTCSPD4 ; *315 CS CASE RECALL tx
"RTN","RCTCSPU",307,0)
 W !,"Setting this case for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",308,0)
 G SETCQ
"RTN","RCTCSPU",309,0)
 ;
"RTN","RCTCSPU",310,0)
DELSETC ;Allows Cross-Servicing Recall to be deleted for case
"RTN","RCTCSPU",311,0)
 W !!,*7,"This case has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",312,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this case",DIR("B")="NO" D ^DIR G SETCQ:'Y
"RTN","RCTCSPU",313,0)
 ;
"RTN","RCTCSPU",314,0)
 ;delete the case recall
"RTN","RCTCSPU",315,0)
 F I=11:1:13 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",316,0)
 F I=2:1:5 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",317,0)
 D DELSETC^RCTCSPD4 ; *315 Create CS Delete Case Recall comment tx in 433 
"RTN","RCTCSPU",318,0)
 W !!,"Recall from Cross-Servicing has been deleted for this case."
"RTN","RCTCSPU",319,0)
 G SETCQ
"RTN","RCTCSPU",320,0)
 ;
"RTN","RCTCSPU",321,0)
SETCQ Q
"RTN","RCTCSPU",322,0)
 ;
"RTN","RCTCSPU",323,0)
SSN(DEBT) ;Get SSN for debtor
"RTN","RCTCSPU",324,0)
 ;Input Debtor (340)
"RTN","RCTCSPU",325,0)
 ;Output: SSN # or null
"RTN","RCTCSPU",326,0)
 NEW Y
"RTN","RCTCSPU",327,0)
 S Y=-1 G:'$G(DEBT) Q1
"RTN","RCTCSPU",328,0)
 S:DEBT?1N.N DEBT=$P($G(^RCD(340,DEBT,0)),"^")
"RTN","RCTCSPU",329,0)
 I DEBT[";DPT(" S Y=$P($G(^DPT(+DEBT,0)),"^",9)
"RTN","RCTCSPU",330,0)
 I DEBT[";VA(200," S Y=$P($G(^VA(200,+DEBT,1)),"^",9)
"RTN","RCTCSPU",331,0)
Q1 Q Y
"RTN","RCTCSPU",332,0)
 ;
"RTN","RCTCSPU",333,0)
 Q
"UP",340,340.08,-1)
340^8
"UP",340,340.08,0)
340.08
"UP",342,342.02,-1)
342^40
"UP",342,342.02,0)
342.02
"UP",430,430.03,-1)
430^15.5
"UP",430,430.03,0)
430.03
"VER")
8.0^22.2
"^DD",340,340,8,0)
TCSP REFERRAL STOP FLAG^340.08SA^^8;0
"^DD",340,340,8,21,0)
^.001^1^1^3190325^^^^
"^DD",340,340,8,21,1,0)
This multiple is for stoping and reactivating TCSP referrals for debtor
"^DD",340,340,8,"DT")
3190321
"^DD",340,340.08,0)
TCSP REFERRAL STOP FLAG SUB-FIELD^^.05^5
"^DD",340,340.08,0,"DT")
3190325
"^DD",340,340.08,0,"IX","B",340.08,.01)

"^DD",340,340.08,0,"IX","C",340.08,.02)

"^DD",340,340.08,0,"NM","TCSP REFERRAL STOP FLAG")

"^DD",340,340.08,0,"UP")
340
"^DD",340,340.08,.01,0)
TCSP REFERRAL STOP FLAG^S^S:STOP DEBTOR;R:REACTIVATE DEBTOR;^0;1^Q
"^DD",340,340.08,.01,1,0)
^.1
"^DD",340,340.08,.01,1,1,0)
340.08^B
"^DD",340,340.08,.01,1,1,1)
S ^RCD(340,DA(1),8,"B",$E(X,1,30),DA)=""
"^DD",340,340.08,.01,1,1,2)
K ^RCD(340,DA(1),8,"B",$E(X,1,30),DA)
"^DD",340,340.08,.01,3)
Enter "S" to stop debtor, "R" to reactivate debtor
"^DD",340,340.08,.01,21,0)
^.001^2^2^3190324^^^
"^DD",340,340.08,.01,21,1,0)
If set to "S", then debtor is stopped from referring new debt.   If set 
"^DD",340,340.08,.01,21,2,0)
to "R" then debtor is reactivated and can send new debt again
"^DD",340,340.08,.01,"DT")
3190324
"^DD",340,340.08,.02,0)
TCSP REFERRAL DATE^RD^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",340,340.08,.02,1,0)
^.1
"^DD",340,340.08,.02,1,1,0)
340.08^C
"^DD",340,340.08,.02,1,1,1)
S ^RCD(340,DA(1),8,"C",$E(X,1,30),DA)=""
"^DD",340,340.08,.02,1,1,2)
K ^RCD(340,DA(1),8,"C",$E(X,1,30),DA)
"^DD",340,340.08,.02,1,1,"%D",0)
^^1^1^3190320^
"^DD",340,340.08,.02,1,1,"%D",1,0)
Cross-reference of TCSP suspension or resumption by date
"^DD",340,340.08,.02,1,1,"DT")
3190320
"^DD",340,340.08,.02,3)
Enter Date and time when the debtor was stopped or reactivated
"^DD",340,340.08,.02,21,0)
^^1^1^3190325^
"^DD",340,340.08,.02,21,1,0)
Date and time when the debtor was stopped or reactivated
"^DD",340,340.08,.02,"DT")
3190325
"^DD",340,340.08,.03,0)
USER MAKING CHANGE^RP200'^VA(200,^0;3^Q
"^DD",340,340.08,.03,3)
Enter user who is making change to debtor status
"^DD",340,340.08,.03,21,0)
^.001^1^1^3190321^^
"^DD",340,340.08,.03,21,1,0)
User who made status change
"^DD",340,340.08,.03,"DT")
3190321
"^DD",340,340.08,.04,0)
TCSP REFERRAL STOP REASON^S^D:DMC Eligible;H:High risk veteran;B:Bankruptcy;T:Treasury Error;O:Other;^0;4^Q
"^DD",340,340.08,.04,3)
Enter reason for stopping
"^DD",340,340.08,.04,21,0)
^^1^1^3190321^
"^DD",340,340.08,.04,21,1,0)
User-selected reason why debtor was stopped
"^DD",340,340.08,.04,"DT")
3190321
"^DD",340,340.08,.05,0)
TCSP REFERRAL STOP COMMENT^FJ100^^0;5^K:$L(X)>100!($L(X)<1) X
"^DD",340,340.08,.05,3)
Answer must be 1-100 characters in length.
"^DD",340,340.08,.05,21,0)
^^1^1^3190321^
"^DD",340,340.08,.05,21,1,0)
Comment required if TCSP REFERRAL STOP REASON is Other
"^DD",340,340.08,.05,"DT")
3190321
"^DD",342,342,40,0)
TCSP REFERRAL STOP FLAG^342.02SA^^40;0
"^DD",342,342,40,21,0)
^.001^1^1^3190325^^^
"^DD",342,342,40,21,1,0)
Stop flag to stop or reactivate TCSP referrals for site
"^DD",342,342,40,"DT")
3190321
"^DD",342,342.02,0)
TCSP REFERRAL STOP FLAG SUB-FIELD^^.04^4
"^DD",342,342.02,0,"DT")
3190325
"^DD",342,342.02,0,"IX","B",342.02,.01)

"^DD",342,342.02,0,"NM","TCSP REFERRAL STOP FLAG")

"^DD",342,342.02,0,"UP")
342
"^DD",342,342.02,.01,0)
TCSP REFERRAL STOP FLAG^RS^S:Stop Site;R:Reactivate Site;^0;1^Q
"^DD",342,342.02,.01,1,0)
^.1
"^DD",342,342.02,.01,1,1,0)
342.02^B
"^DD",342,342.02,.01,1,1,1)
S ^RC(342,DA(1),40,"B",$E(X,1,30),DA)=""
"^DD",342,342.02,.01,1,1,2)
K ^RC(342,DA(1),40,"B",$E(X,1,30),DA)
"^DD",342,342.02,.01,3)
Enter S to stop this site, R to reactivate it
"^DD",342,342.02,.01,21,0)
^^2^2^3190321^
"^DD",342,342.02,.01,21,1,0)
Code of S indicates that the site was stopped from sending TCSP Referrals.
"^DD",342,342.02,.01,21,2,0)
Code of R indicates that the site reactivated sending TCSP Referrals.
"^DD",342,342.02,.01,"DT")
3190321
"^DD",342,342.02,.02,0)
TCSP REFERRAL CHANGE DATE^RD^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",342,342.02,.02,3)
Enter date and time when site got stopped or reactivated
"^DD",342,342.02,.02,21,0)
^.001^1^1^3190325^^
"^DD",342,342.02,.02,21,1,0)
Date and time when site referrals to TCSP got stopped or reactivated
"^DD",342,342.02,.02,"DT")
3190325
"^DD",342,342.02,.03,0)
USER MAKING CHANGE^RP200'^VA(200,^0;3^Q
"^DD",342,342.02,.03,3)
Enter user making change
"^DD",342,342.02,.03,21,0)
^^1^1^3190320^
"^DD",342,342.02,.03,21,1,0)
User who stopped or reactivated sending TCSP referrals from this site
"^DD",342,342.02,.03,"DT")
3190320
"^DD",342,342.02,.04,0)
TCSP REFERRAL COMMENT^FJ100^^0;4^K:$L(X)>100!($L(X)<1) X
"^DD",342,342.02,.04,3)
Answer must be 1-100 characters in length.
"^DD",342,342.02,.04,21,0)
^^1^1^3190320^
"^DD",342,342.02,.04,21,1,0)
Comment about reason why site stopped sending TCSP referrals
"^DD",342,342.02,.04,"DT")
3190320
"^DD",430,430,159.9,0)
TCSP RE-REFERRAL^430.03S^^15.5;0
"^DD",430,430,159.9,21,0)
^^3^3^3190418^
"^DD",430,430,159.9,21,1,0)
Subfile containing Re-Referral status, including requests (and details of
"^DD",430,430,159.9,21,2,0)
those requests) and completed Re-Referrals performed during weekly batch
"^DD",430,430,159.9,21,3,0)
job run.
"^DD",430,430,313,0)
TCSP AGENCY DEBT ID LAST 2^FJ2^^21;2^K:$L(X)>2!($L(X)<2)!'(X?2A) X
"^DD",430,430,313,3)
Answer must be 2 characters in length.
"^DD",430,430,313,21,0)
^^2^2^3190414^
"^DD",430,430,313,21,1,0)
Last two characters for Agency Debt ID field in IAI records for 
"^DD",430,430,313,21,2,0)
referral.  Must be alphabetic or blank.
"^DD",430,430,313,"DT")
3190414
"^DD",430,430.03,0)
TCSP RE-REFERRAL SUB-FIELD^^.05^5
"^DD",430,430.03,0,"DT")
3190418
"^DD",430,430.03,0,"IX","B",430.03,.01)

"^DD",430,430.03,0,"NM","TCSP RE-REFERRAL")

"^DD",430,430.03,0,"UP")
430
"^DD",430,430.03,.01,0)
TCSP RE-REFERRAL^S^0:RE-REFERRAL REQUESTED;1:RE-REFERRED;^0;1^Q
"^DD",430,430.03,.01,1,0)
^.1
"^DD",430,430.03,.01,1,1,0)
430.03^B
"^DD",430,430.03,.01,1,1,1)
S ^PRCA(430,DA(1),15.5,"B",$E(X,1,30),DA)=""
"^DD",430,430.03,.01,1,1,2)
K ^PRCA(430,DA(1),15.5,"B",$E(X,1,30),DA)
"^DD",430,430.03,.01,3)
Enter Re-Referral Request
"^DD",430,430.03,.01,21,0)
^^2^2^3190329^
"^DD",430,430.03,.01,21,1,0)
Indicates status of Re-Referral.  0 is Re-Referral requested, 1 is
"^DD",430,430.03,.01,21,2,0)
Re-Referral performed.
"^DD",430,430.03,.01,"DT")
3190329
"^DD",430,430.03,.02,0)
TCSP RE-REFERRAL DATE^RD^^0;2^S %DT="ER" D ^%DT S X=Y K:X<1 X
"^DD",430,430.03,.02,3)
Enter Date when Re-Referral was requested or sent
"^DD",430,430.03,.02,21,0)
^^1^1^3190329^
"^DD",430,430.03,.02,21,1,0)
Date when Re-Referral Request occurred or when Re-Refferal was sent out
"^DD",430,430.03,.02,"DT")
3190329
"^DD",430,430.03,.03,0)
TCSP RE-REFERRAL USER^P200'^VA(200,^0;3^Q
"^DD",430,430.03,.03,3)
Enter User ID of user requesting Re-Referral
"^DD",430,430.03,.03,21,0)
^^2^2^3190329^
"^DD",430,430.03,.03,21,1,0)
User requesting Re-Referral.   Will also be stamped with requester user ID
"^DD",430,430.03,.03,21,2,0)
when Re-Referral is actually sent
"^DD",430,430.03,.03,"DT")
3190329
"^DD",430,430.03,.04,0)
TCSP RE-REFERRAL REASON^S^R:Recall In Error;T:Treasury Reversal;D:Defaulted RPP;O:Other;^0;4^Q
"^DD",430,430.03,.04,3)
Enter reason why Re-Referral was requested
"^DD",430,430.03,.04,21,0)
^^1^1^3190329^
"^DD",430,430.03,.04,21,1,0)
Reason why Re-Referral was requested
"^DD",430,430.03,.04,"DT")
3190329
"^DD",430,430.03,.05,0)
TCSP RE-REFERRAL COMMENT^FJ30^^0;5^K:$L(X)>30!($L(X)<1) X
"^DD",430,430.03,.05,3)
Explain why Re-Referral was requested, 1 to 30 characters
"^DD",430,430.03,.05,21,0)
^.001^2^2^3190418^^
"^DD",430,430.03,.05,21,1,0)
If TCSP RE-REFERRAL REASON is Other, then this comment explains why
"^DD",430,430.03,.05,21,2,0)
Re-Referral was requested
"^DD",430,430.03,.05,"DT")
3190418
"BLD",11435,6)
^314
**END**
**END**

