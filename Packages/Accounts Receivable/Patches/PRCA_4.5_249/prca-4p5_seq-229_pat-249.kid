Released PRCA*4.5*249 SEQ #229
Extracted from mail message
**KIDS**:PRCA*4.5*249^

**INSTALL NAME**
PRCA*4.5*249
"BLD",7304,0)
PRCA*4.5*249^ACCOUNTS RECEIVABLE^0^3070706^y
"BLD",7304,1,0)
^^8^8^3070706^
"BLD",7304,1,1,0)
This patch addresses 5 issues. The first issue is regarding the OBR
"BLD",7304,1,2,0)
(AR/FMS) data that has been incorrectly deleted in the OBR Reconciliation
"BLD",7304,1,3,0)
report. The secondary issue is about the coding error in routine RCDPEX32.
"BLD",7304,1,4,0)
The third issue is regarding the billing information that was missing in
"BLD",7304,1,5,0)
the transmission message that is sent to the department of Justice or
"BLD",7304,1,6,0)
Regional Counsel. The fourth issue is regarding the <UNDEFINED> error at
"BLD",7304,1,7,0)
line Q3+2^PRCASVC when returns a bill's FMS fund code. The last issue
"BLD",7304,1,8,0)
is about the SSN showing on the reprint of the statements at site.
"BLD",7304,4,0)
^9.64PA^^
"BLD",7304,6.3)
2
"BLD",7304,"KRN",0)
^9.67PA^8989.52^19
"BLD",7304,"KRN",.4,0)
.4
"BLD",7304,"KRN",.401,0)
.401
"BLD",7304,"KRN",.402,0)
.402
"BLD",7304,"KRN",.403,0)
.403
"BLD",7304,"KRN",.5,0)
.5
"BLD",7304,"KRN",.84,0)
.84
"BLD",7304,"KRN",3.6,0)
3.6
"BLD",7304,"KRN",3.8,0)
3.8
"BLD",7304,"KRN",9.2,0)
9.2
"BLD",7304,"KRN",9.8,0)
9.8
"BLD",7304,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",7304,"KRN",9.8,"NM",1,0)
PRCASVC^^0^B9379242
"BLD",7304,"KRN",9.8,"NM",2,0)
RCRCXM1^^0^B17272658
"BLD",7304,"KRN",9.8,"NM",3,0)
PRCAGST^^0^B11632133
"BLD",7304,"KRN",9.8,"NM",4,0)
PRCAGST1^^0^B9197569
"BLD",7304,"KRN",9.8,"NM",5,0)
RCFMOBR^^0^B17653139
"BLD",7304,"KRN",9.8,"NM",6,0)
RCDPEX32^^0^B30120865
"BLD",7304,"KRN",9.8,"NM","B","PRCAGST",3)

"BLD",7304,"KRN",9.8,"NM","B","PRCAGST1",4)

"BLD",7304,"KRN",9.8,"NM","B","PRCASVC",1)

"BLD",7304,"KRN",9.8,"NM","B","RCDPEX32",6)

"BLD",7304,"KRN",9.8,"NM","B","RCFMOBR",5)

"BLD",7304,"KRN",9.8,"NM","B","RCRCXM1",2)

"BLD",7304,"KRN",19,0)
19
"BLD",7304,"KRN",19.1,0)
19.1
"BLD",7304,"KRN",101,0)
101
"BLD",7304,"KRN",409.61,0)
409.61
"BLD",7304,"KRN",771,0)
771
"BLD",7304,"KRN",870,0)
870
"BLD",7304,"KRN",8989.51,0)
8989.51
"BLD",7304,"KRN",8989.52,0)
8989.52
"BLD",7304,"KRN",8994,0)
8994
"BLD",7304,"KRN","B",.4,.4)

"BLD",7304,"KRN","B",.401,.401)

"BLD",7304,"KRN","B",.402,.402)

"BLD",7304,"KRN","B",.403,.403)

"BLD",7304,"KRN","B",.5,.5)

"BLD",7304,"KRN","B",.84,.84)

"BLD",7304,"KRN","B",3.6,3.6)

"BLD",7304,"KRN","B",3.8,3.8)

"BLD",7304,"KRN","B",9.2,9.2)

"BLD",7304,"KRN","B",9.8,9.8)

"BLD",7304,"KRN","B",19,19)

"BLD",7304,"KRN","B",19.1,19.1)

"BLD",7304,"KRN","B",101,101)

"BLD",7304,"KRN","B",409.61,409.61)

"BLD",7304,"KRN","B",771,771)

"BLD",7304,"KRN","B",870,870)

"BLD",7304,"KRN","B",8989.51,8989.51)

"BLD",7304,"KRN","B",8989.52,8989.52)

"BLD",7304,"KRN","B",8994,8994)

"BLD",7304,"QUES",0)
^9.62^^
"BLD",7304,"REQB",0)
^9.611^6^6
"BLD",7304,"REQB",1,0)
PRCA*4.5*189^2
"BLD",7304,"REQB",2,0)
PRCA*4.5*138^2
"BLD",7304,"REQB",3,0)
PRCA*4.5*190^2
"BLD",7304,"REQB",4,0)
PRCA*4.5*53^2
"BLD",7304,"REQB",5,0)
PRCA*4.5*176^2
"BLD",7304,"REQB",6,0)
PRCA*4.5*173^2
"BLD",7304,"REQB","B","PRCA*4.5*138",2)

"BLD",7304,"REQB","B","PRCA*4.5*173",6)

"BLD",7304,"REQB","B","PRCA*4.5*176",5)

"BLD",7304,"REQB","B","PRCA*4.5*189",1)

"BLD",7304,"REQB","B","PRCA*4.5*190",3)

"BLD",7304,"REQB","B","PRCA*4.5*53",4)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
249^3070706
"PKG",142,22,1,"PAH",1,1,0)
^^8^8^3070706
"PKG",142,22,1,"PAH",1,1,1,0)
This patch addresses 5 issues. The first issue is regarding the OBR
"PKG",142,22,1,"PAH",1,1,2,0)
(AR/FMS) data that has been incorrectly deleted in the OBR Reconciliation
"PKG",142,22,1,"PAH",1,1,3,0)
report. The secondary issue is about the coding error in routine RCDPEX32.
"PKG",142,22,1,"PAH",1,1,4,0)
The third issue is regarding the billing information that was missing in
"PKG",142,22,1,"PAH",1,1,5,0)
the transmission message that is sent to the department of Justice or
"PKG",142,22,1,"PAH",1,1,6,0)
Regional Counsel. The fourth issue is regarding the <UNDEFINED> error at
"PKG",142,22,1,"PAH",1,1,7,0)
line Q3+2^PRCASVC when returns a bill's FMS fund code. The last issue
"PKG",142,22,1,"PAH",1,1,8,0)
is about the SSN showing on the reprint of the statements at site.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PRCAGST")
0^3^B11632133^B11437502
"RTN","PRCAGST",1,0)
PRCAGST ;WASH-ISC@ALTOONA,PA/CMS-Print Patient Statement ;12/12/96  9:39 AM
"RTN","PRCAGST",2,0)
V ;;4.5;Accounts Receivable;**34,181,190,249**;Mar 20, 1995;Build 2
"RTN","PRCAGST",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAGST",4,0)
 ;ENTRY WITH DEBTOR PRINT STATEMENT
"RTN","PRCAGST",5,0)
EN(DEB,TBAL,PDAT,PBAL,LDT) ;
"RTN","PRCAGST",6,0)
 NEW ADD,DA,LN,NAM,PAGE,SSN,X,X1,X2,Y
"RTN","PRCAGST",7,0)
 I '$D(SITE) D SITE^PRCAGU
"RTN","PRCAGST",8,0)
 S SSN=$$SSN^RCFN01(DEB),SSN=$S(SSN=-1:"XXXXXXXXX",1:SSN)
"RTN","PRCAGST",9,0)
 S ADD=$$SADD^RCFN01(8) I ADD="" S ADD=$$SADD^RCFN01(1)
"RTN","PRCAGST",10,0)
 S X=0 F Y=1:1:3 I $P(ADD,U,Y)]"" S X=X+1 S ADD(X)=$P(ADD,U,Y)
"RTN","PRCAGST",11,0)
 S X=X+1,ADD(X)=$P(ADD,U,4)_", "_$P(ADD,U,5)_"  "_$P(ADD,U,6)
"RTN","PRCAGST",12,0)
 S X=X+1,ADD(X)=$P(ADD,U,7)
"RTN","PRCAGST",13,0)
 W @IOF
"RTN","PRCAGST",14,0)
 W !!,"Department of Veterans Affairs",?50,"Acct No.: ",$P($$SITE^VASITE(),U,3)_"/"_$E(SSN,6,9)
"RTN","PRCAGST",15,0)
 W !,$G(ADD(1))
"RTN","PRCAGST",16,0)
 S Y=$$FPS^RCAMFN01($S($G(LDT)>0:$E(LDT,1,5),1:$E(DT,1,5))_$TR($J($$PST^RCAMFN01(DEB),2)," ",0),$S(+$E($G(LDT),6,7)>$$STD^RCCPCFN:2,1:1)) D DD^%DT
"RTN","PRCAGST",17,0)
 W !,$G(ADD(2)),?50 I TBAL>0 W "Due: UPON RECEIPT"
"RTN","PRCAGST",18,0)
 W !,$G(ADD(3)),?50,$S(TBAL>0:"Amount Due: $"_$J(TBAL,0,2),1:"NO AMOUNT DUE")
"RTN","PRCAGST",19,0)
 W !,$G(ADD(4)),?50,$S(TBAL'>0:"*THIS IS NOT A BILL*",1:"Amount Paid: _____________")
"RTN","PRCAGST",20,0)
 W !,$G(ADD(5)),?50,"Today's Date: " S Y=DT D DD^%DT W Y
"RTN","PRCAGST",21,0)
 I TBAL'>0 D MES G LB
"RTN","PRCAGST",22,0)
 W !!,?2,"Please Make your Check or Money Order payable to the ""Department of Veterans"
"RTN","PRCAGST",23,0)
 W !,?2,"Affairs"" and send payment to the above address.  If you have any questions"
"RTN","PRCAGST",24,0)
 W !,?2,"regarding this statement, please call the number listed above.",!!!
"RTN","PRCAGST",25,0)
LB K ADD S NAM=$$NAM^RCFN01(DEB)
"RTN","PRCAGST",26,0)
 W !,?7,NAM
"RTN","PRCAGST",27,0)
 S ADD=$$DADD^RCAMADD(DEB,1) ; Get debtor address, confidential if applicable
"RTN","PRCAGST",28,0)
 S X=0 F Y=1:1:3 I $P(ADD,U,Y)]"" S X=X+1 S ADD(X)=$P(ADD,U,Y)
"RTN","PRCAGST",29,0)
 S X=X+1,ADD(X)=$P(ADD,U,4)_", "_$P(ADD,U,5)_"  "_$P(ADD,U,6)
"RTN","PRCAGST",30,0)
 F X=0:0 S X=$O(ADD(X)) Q:'X  W !,?7,$E(ADD(X),1,40) I X=1 W ?50 X $G(SITE("SCAN"))
"RTN","PRCAGST",31,0)
 W !
"RTN","PRCAGST",32,0)
 I $G(SITE("COM1"))'="" W !,?2,SITE("COM1")
"RTN","PRCAGST",33,0)
 I $$GMT(DEB) W !,?2,"REDUCTION OF INPATIENT COPAYMENT DUE TO GEOGRAPHIC MEANS TEST STATUS"
"RTN","PRCAGST",34,0)
 W !! I TBAL>0 W !,?10,"Please Detach and Return Top Portion with Payment"
"RTN","PRCAGST",35,0)
 S Y="",$P(Y,"=",80)="" W !,Y
"RTN","PRCAGST",36,0)
 W !,"IMPORTANT: Please read the Notice of Rights accompanying this statement!",!
"RTN","PRCAGST",37,0)
 D ^PRCAGST1
"RTN","PRCAGST",38,0)
 Q
"RTN","PRCAGST",39,0)
MES ;text for no amount due
"RTN","PRCAGST",40,0)
 W !!,?2,"This statement is being sent to you to provide you with information"
"RTN","PRCAGST",41,0)
 W !,?2,"concerning transactions affecting your account. If a prepayment offset"
"RTN","PRCAGST",42,0)
 W !,?2,"a bill or you have made one or more payments or charges were removed,"
"RTN","PRCAGST",43,0)
 W !,?2,"from your account, you are being sent this statement to confirm these actions.",!!
"RTN","PRCAGST",44,0)
 Q
"RTN","PRCAGST",45,0)
 ;
"RTN","PRCAGST",46,0)
 ; Detect GMT-related status for the statement (fetch all patient's bills)
"RTN","PRCAGST",47,0)
 ; Input: Temporary global ^TMP("PRCAGT",$J,PRDEB)
"RTN","PRCAGST",48,0)
 ; Output: 1 - 'Yes', 0 - 'No'
"RTN","PRCAGST",49,0)
GMT(PRDEB) N PRDAT,PRBN,PRGMT
"RTN","PRCAGST",50,0)
 S PRGMT=0 ; Default
"RTN","PRCAGST",51,0)
 I $G(PRDEB)'="" S PRDAT=0 F  S PRDAT=$O(^TMP("PRCAGT",$J,PRDEB,PRDAT)) Q:'PRDAT  D  Q:PRGMT
"RTN","PRCAGST",52,0)
 . S PRBN=0 F  S PRBN=$O(^TMP("PRCAGT",$J,PRDEB,PRDAT,PRBN)) Q:'PRBN  D  Q:PRGMT
"RTN","PRCAGST",53,0)
 .. I $$ISGMTBIL^IBAGMT($P($G(^PRCA(430,PRBN,0)),U,1)) S PRGMT=1
"RTN","PRCAGST",54,0)
 Q PRGMT
"RTN","PRCAGST1")
0^4^B9197569^B8911193
"RTN","PRCAGST1",1,0)
PRCAGST1 ;WASH-ISC@ALTOONA,PA/CMS-Print Patient Statement Bottom ;10/16/96  11:13 AM
"RTN","PRCAGST1",2,0)
V ;;4.5;Accounts Receivable;**2,48,104,176,249**;Mar 20, 1995;Build 2
"RTN","PRCAGST1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAGST1",4,0)
 ;ENTRY FROM PRCAGST PAGE 1
"RTN","PRCAGST1",5,0)
 NEW AMT,BN,DAT,DESC,I,REF,THNK,TN,TTY,X,Y,RCTOTAL
"RTN","PRCAGST1",6,0)
 D HDR
"RTN","PRCAGST1",7,0)
 S DESC(1)="Previous Balance",REF="" D WRL(PDAT,.DESC,PBAL,REF)
"RTN","PRCAGST1",8,0)
 S DAT=0
"RTN","PRCAGST1",9,0)
 F  S DAT=$O(^TMP("PRCAGT",$J,DEB,DAT)) Q:'DAT  S BN=0 F  S BN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN)) Q:'BN  D
"RTN","PRCAGST1",10,0)
 . S REF=$P($G(^PRCA(430,BN,0)),"^") ; Get Bill Name
"RTN","PRCAGST1",11,0)
 . I $D(^TMP("PRCAGT",$J,DEB,DAT,BN,0)) S AMT=+^(0) I AMT D  Q
"RTN","PRCAGST1",12,0)
 .. D BILLDESC(BN,.DESC)  ; Compile bill description
"RTN","PRCAGST1",13,0)
 .. D WRL(DAT,.DESC,AMT,REF) ; Print the item
"RTN","PRCAGST1",14,0)
 . S TN=0 F  S TN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN,TN)) Q:'TN  S AMT=^(TN) D
"RTN","PRCAGST1",15,0)
 .. S TTY=$P(AMT,U,2) S AMT=+AMT
"RTN","PRCAGST1",16,0)
 .. D AMOUNT(TN,TTY,.AMT,.THNK) ; Adjust Amount sign (+/-) and "Thank You" flag
"RTN","PRCAGST1",17,0)
 .. D TRANDESC(TN,.DESC) ; Compile description
"RTN","PRCAGST1",18,0)
 .. D WRL(DAT,.DESC,AMT,REF) ; Print the item
"RTN","PRCAGST1",19,0)
 I ($Y+9)>(IOSL-2) D  D HDR
"RTN","PRCAGST1",20,0)
 . W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",21,0)
 D SUM^PRCAGST2
"RTN","PRCAGST1",22,0)
 Q
"RTN","PRCAGST1",23,0)
WRL(DAT,DESC,AMT,REF) ;Write transaction
"RTN","PRCAGST1",24,0)
 NEW LN,I,X,Y
"RTN","PRCAGST1",25,0)
 S LN=1,X=0 F  S X=$O(DESC(X)) Q:'X  S LN=$G(LN)+1
"RTN","PRCAGST1",26,0)
 I ($Y+LN)>(IOSL-2) D  D HDR
"RTN","PRCAGST1",27,0)
 . W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",28,0)
 W !,"|",$S($G(DAT):$$DAT(DAT),1:""),?12,"|",DESC(1),?58,"|",$J(AMT,8,2),?67,"|",?68,$G(REF),?79,"|"
"RTN","PRCAGST1",29,0)
 F X=1:0 S X=$O(DESC(X)) Q:'X  W !,"|",?12,"|",DESC(X),?58,"|",?67,"|",?79,"|"
"RTN","PRCAGST1",30,0)
 Q
"RTN","PRCAGST1",31,0)
 ;
"RTN","PRCAGST1",32,0)
 ; Get transaction description array
"RTN","PRCAGST1",33,0)
TRANDESC(PRTRAN,RCDESC) N RCTOTAL
"RTN","PRCAGST1",34,0)
 ; RCTOTAL not used in reprinted statements.
"RTN","PRCAGST1",35,0)
 K RCDESC
"RTN","PRCAGST1",36,0)
 D TRANDESC^RCCPCPS1(PRTRAN,45) ; returns RCDESC() array (max. length 45 characters)
"RTN","PRCAGST1",37,0)
 Q
"RTN","PRCAGST1",38,0)
 ;
"RTN","PRCAGST1",39,0)
AMOUNT(BN,TTY,AMT,THNK) ;Adjust (+/-) amount depending on Transaction Type
"RTN","PRCAGST1",40,0)
 N BN0,CAT,TS
"RTN","PRCAGST1",41,0)
 S BN0=$G(^PRCA(430,BN,0)),CAT=$$CATN^PRCAFN(+$P(BN0,U,2))
"RTN","PRCAGST1",42,0)
 I ",2,8,9,10,11,14,19,47,34,35,29,"[(","_TTY_",") I AMT'<0 S AMT=-AMT
"RTN","PRCAGST1",43,0)
 I ",2,8,9,10,11,12,14,19,47,34,35,29,"'[(","_TTY_",") I AMT<0 S AMT=-AMT
"RTN","PRCAGST1",44,0)
 I +CAT=33,TTY=1 I AMT<0 S AMT=-AMT
"RTN","PRCAGST1",45,0)
 I +CAT=33,TTY=35 I AMT>0 S AMT=-AMT
"RTN","PRCAGST1",46,0)
 S TS=$P($G(^PRCA(430.3,TTY,0)),U,3) I '$D(THNK),(TS=2!(TS=20)) S THNK=1
"RTN","PRCAGST1",47,0)
 Q
"RTN","PRCAGST1",48,0)
 ; Description for bills
"RTN","PRCAGST1",49,0)
 ; Input: PRBILL - Bill IEN
"RTN","PRCAGST1",50,0)
 ; Output: RCDESC(1..n) - Description Array
"RTN","PRCAGST1",51,0)
BILLDESC(PRBILL,RCDESC) K RCDESC
"RTN","PRCAGST1",52,0)
 D BILLDESC^RCCPCPS1(PRBILL,45) ; returns RCDESC() array (max. length 45 characters)
"RTN","PRCAGST1",53,0)
 Q
"RTN","PRCAGST1",54,0)
DAT(DAT) ;slash date
"RTN","PRCAGST1",55,0)
 I 'DAT Q ""
"RTN","PRCAGST1",56,0)
 Q $$SLH^RCFN01(DAT,"/")
"RTN","PRCAGST1",57,0)
HDR ;statement transaction header
"RTN","PRCAGST1",58,0)
 NEW I,Y
"RTN","PRCAGST1",59,0)
 S PAGE=$G(PAGE)+1
"RTN","PRCAGST1",60,0)
 I PAGE>1 W @IOF I $G(^RC(342,1,5))]"" F I=1:1:18 W !
"RTN","PRCAGST1",61,0)
 W !,"Department of Veterans Affairs",?50,"Acct No.:",$P($$SITE^VASITE(),U,3)_"/"_$E(SSN,6,9)
"RTN","PRCAGST1",62,0)
 W !,NAM,?50,"Page ",PAGE
"RTN","PRCAGST1",63,0)
 S Y="",$P(Y,"_",80)="" W !,Y
"RTN","PRCAGST1",64,0)
 W !,"|Date Posted|",?13,"     Description",?58,"| Amount ",?67,"| Reference |"
"RTN","PRCAGST1",65,0)
 W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",66,0)
 Q
"RTN","PRCASVC")
0^1^B9379242^B9280061
"RTN","PRCASVC",1,0)
PRCASVC ;SF-ISC/YJK-ACCEPT, AMMEND AND CANCEL AR BILL ;9/6/95  2:09 PM
"RTN","PRCASVC",2,0)
V ;;4.5;Accounts Receivable;**1,21,48,90,136,138,249**;Mar 20, 1995;Build 2
"RTN","PRCASVC",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCASVC",4,0)
REL ;Accept bill into AR
"RTN","PRCASVC",5,0)
 N X,Y
"RTN","PRCASVC",6,0)
 D ^PRCASVC6 G:$D(PRCAERR) Q3 S PRCADEBT=$O(^RCD(340,"B",PRCASV("DEBTOR"),0)) I 'PRCADEBT K DD,DO S DIC="^RCD(340,",DIC(0)="QL",X=PRCASV("DEBTOR"),DLAYGO=340 D FILE^DICN K DIC,DLAYGO,DO Q:Y<0  S PRCADEBT=+Y
"RTN","PRCASVC",7,0)
 D FY S PRCAT=$P(^PRCA(430.2,PRCASV("CAT"),0),"^",6) F Y="IDNO^4","GPNO^6","GPNM^5","INPA^1" S:$D(PRCASV($P(Y,"^"))) $P(^PRCA(430,PRCASV("ARREC"),202),"^",$P(Y,"^",2))=PRCASV($P(Y,"^"))
"RTN","PRCASVC",8,0)
 S DIE="^PRCA(430,",DR="[PRCASV REL]",DA=PRCASV("ARREC") D ^DIE
"RTN","PRCASVC",9,0)
Q3 K PRCAT,PRCAORA,PRCADEBT,DIE,DR,%
"RTN","PRCASVC",10,0)
 ;  set the fund for the bill (set in routine rcxfmsuf)
"RTN","PRCASVC",11,0)
 S:'$G(DA) DA=PRCASV("ARREC") S %=$$GETFUNDB^RCXFMSUF(DA)
"RTN","PRCASVC",12,0)
 I "^27^28^"[("^"_PRCASV("CAT")_"^") D
"RTN","PRCASVC",13,0)
 .N P
"RTN","PRCASVC",14,0)
 .F P=6,8,10,15 S $P(^PRCA(430,DA,11),"^",P)=$S(P=6:1000,P=8:$G(PRCASV("SITE")),P=10:9,1:$P($G(PRCASV("FY")),"^"))
"RTN","PRCASVC",15,0)
 .S $P(^PRCA(430,DA,11),"^",18,999)=""
"RTN","PRCASVC",16,0)
 I PRCASV("CAT")=27 S $P(^PRCA(430,+PRCASV("ARREC"),0),"^",5)=$O(^PRCA(430.6,"B","CHMPV",0))
"RTN","PRCASVC",17,0)
 I PRCASV("CAT")=29 S $P(^PRCA(430,DA,11),"^",18,999)=""
"RTN","PRCASVC",18,0)
 I "^30^31^32^"[("^"_PRCASV("CAT")_"^") D
"RTN","PRCASVC",19,0)
 .N RCCARE,P
"RTN","PRCASVC",20,0)
 .F P=8,9,10,15 S $P(^PRCA(430,DA,11),"^",P)=$S(P=8:$P(^PRCA(430,DA,0),"^",12),P=9:1,P=10:"02",1:$P($G(PRCASV("FY")),"^"))
"RTN","PRCASVC",21,0)
 .S $P(^PRCA(430,DA,11),"^",18)=""
"RTN","PRCASVC",22,0)
 .S RCCARE=$$TYP^IBRFN(DA),RCCARE(1)=$S(RCCARE="I":8028,RCCARE="O":8029,1:8030),$P(^PRCA(430,DA,11),"^",6)=RCCARE(1)
"RTN","PRCASVC",23,0)
 I $G(PRCASV("MEDCA"))!$G(PRCASV("MEDURE")) D MEDICARE
"RTN","PRCASVC",24,0)
 K DA
"RTN","PRCASVC",25,0)
 Q
"RTN","PRCASVC",26,0)
 ;
"RTN","PRCASVC",27,0)
 ;
"RTN","PRCASVC",28,0)
FY K:$D(^PRCA(430,PRCASV("ARREC"),2)) ^(2) S PRCAK1=1,PRCAORA=0,^PRCA(430,PRCASV("ARREC"),2,0)="^430.01IA^^"
"RTN","PRCASVC",29,0)
 F J=1:1 S X=$P(PRCASV("FY"),U,PRCAK1),PRCAMT=+$P(PRCASV("FY"),U,PRCAK1+1) D FY1 S PRCAK1=PRCAK1+2 Q:$P(PRCASV("FY"),U,PRCAK1)=""
"RTN","PRCASVC",30,0)
EXITFY K PRCAK1,J,PRCAMT Q
"RTN","PRCASVC",31,0)
FY1 S DA(1)=PRCASV("ARREC"),DIC="^PRCA(430,"_DA(1)_",2,",DIC(0)="QL",DLAYGO=430 D ^DIC K DIC,DLAYGO Q:Y<0  S DA=+Y
"RTN","PRCASVC",32,0)
 S PRCAORA=PRCAORA+PRCAMT,$P(^PRCA(430,PRCASV("ARREC"),0),"^",3)=PRCAORA,$P(^(7),"^")=PRCAORA,$P(^(2,DA,0),U,2)=PRCAMT,$P(^(0),"^",8)=PRCAMT
"RTN","PRCASVC",33,0)
 K DA Q
"RTN","PRCASVC",34,0)
 ;
"RTN","PRCASVC",35,0)
MEDICARE ;Setup Medicare Supplemental amounts
"RTN","PRCASVC",36,0)
 N DR,DIE
"RTN","PRCASVC",37,0)
 I $G(PRCASV("MEDCA")) S DIE="^PRCA(430,",DR="131////"_PRCASV("MEDCA") D ^DIE
"RTN","PRCASVC",38,0)
 I $G(PRCASV("MEDURE")) S DIE="^PRCA(430,",DR="132////"_PRCASV("MEDURE") D ^DIE
"RTN","PRCASVC",39,0)
 K PRCASV("MEDCA"),PRCASV("MEDURE")
"RTN","PRCASVC",40,0)
 Q  ;MEDICARE
"RTN","PRCASVC",41,0)
 ;
"RTN","RCDPEX32")
0^6^B30120865^B30118420
"RTN","RCDPEX32",1,0)
RCDPEX32 ;ALB/TMK - ELECTRONIC EOB EXCEPTION PROCESSING - FILE 344.4 ;10-OCT-02
"RTN","RCDPEX32",2,0)
 ;;4.5;Accounts Receivable;**173,249**;Mar 20, 1995;Build 2
"RTN","RCDPEX32",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPEX32",4,0)
 ;
"RTN","RCDPEX32",5,0)
EDITNUM ; Edit invalid claim # to valid, refile EOB
"RTN","RCDPEX32",6,0)
 N RC,RC0,RCDA,RCXDA,RCXDA1,RCSAVE,RCEOB,RCWARN,Q,Q0,DA,DR,DIE,DIC,DIR,X,Y,RCBILL,RCCHG
"RTN","RCDPEX32",7,0)
 D FULL^VALM1
"RTN","RCDPEX32",8,0)
 D SEL^RCDPEX3(.RCDA)
"RTN","RCDPEX32",9,0)
 G:'$O(RCDA(0)) EDITNQ
"RTN","RCDPEX32",10,0)
 ;
"RTN","RCDPEX32",11,0)
 S RC=0 F  S RC=$O(RCDA(RC)) Q:'RC  D  L -^RCY(344.4,RCXDA1,1,RCXDA,0)
"RTN","RCDPEX32",12,0)
 . S RCXDA1=+RCDA(RC),RCXDA=+$P(RCDA(RC),U,2),RCSAVE=""
"RTN","RCDPEX32",13,0)
 . I '$$LOCK^RCDPEX31(RCXDA1,RCXDA,1) D  Q
"RTN","RCDPEX32",14,0)
 .. S DIR(0)="EA",DIR("A",1)="**Selection #"_RC_" is being edited by another user - ... please try again later",DIR("A")="PRESS RETURN TO CONTINUE" D ^DIR K DIR
"RTN","RCDPEX32",15,0)
 . S RC0=$G(^RCY(344.4,RCXDA1,1,RCXDA,0))
"RTN","RCDPEX32",16,0)
 . I $P(RC0,U,5)="" D  Q
"RTN","RCDPEX32",17,0)
 .. S DIR(0)="EA",DIR("A",1)="The claim for selection #"_RC_" can't be edited as the bill # is not invalid",DIR("A")="PRESS RETURN TO CONTINUE" D ^DIR K DIR
"RTN","RCDPEX32",18,0)
 . I $P(RC0,U,9) D  Q
"RTN","RCDPEX32",19,0)
 .. S DIR(0)="EA",DIR("A",1)="The claim for selection #"_RC_" can't be edited as the claim has already",DIR("A")="been transferred to another site - PRESS RETURN TO CONTINUE" W ! D ^DIR K DIR
"RTN","RCDPEX32",20,0)
 . ;
"RTN","RCDPEX32",21,0)
 . I $D(^RCY(344.49,RCXDA1)) D
"RTN","RCDPEX32",22,0)
 .. N X
"RTN","RCDPEX32",23,0)
 .. S X=$G(^RCY(344,+$P($G(^RCY(344.49,RCXDA1,0)),U,2),0))
"RTN","RCDPEX32",24,0)
 .. W !!,*7,"Warning: EEOB Worklist entry #"_RCXDA1_$S($P(X,U)'="":" and receipt "_$P(X,U),1:"")_" exist for this EEOB"
"RTN","RCDPEX32",25,0)
 .. I X="" W !,"You should refresh the worklist entry to include the new claim #",!," before creating the receipt",!
"RTN","RCDPEX32",26,0)
 . I $P($G(^RCY(344.4,RCXDA1,0)),U,8) D
"RTN","RCDPEX32",27,0)
 .. W !,"Since the receipt for this EEOB ("_$P($G(^RCY(344,+$P($G(^RCY(344.4,RCXDA1,0)),U,8),0)),U)_") already exists"
"RTN","RCDPEX32",28,0)
 .. I '$P($G(^RCY(344,+$P($G(^RCY(344.4,RCXDA1,0)),U,8),0)),U,14) W !," and is closed, you will need to use link payment to apply the payment",!," to the correct account",! Q
"RTN","RCDPEX32",29,0)
 .. W !," you should edit the receipt and change the claim # so it posts to the",!," correct account",!
"RTN","RCDPEX32",30,0)
 . ;
"RTN","RCDPEX32",31,0)
 . I $P(RC0,U,17)="" S RCSAVE=$P(RC0,U,5)
"RTN","RCDPEX32",32,0)
 . W !,"Selection #: "_RC_$J("",5)_$P(RC0,U,5)
"RTN","RCDPEX32",33,0)
 . S DIC("A")="Select A/R Bill this EEOB is actually paying on: ",DIC="^PRCA(430,",DIC(0)="AEMQ",DIC("S")="I $D(^DGCR(399,+Y,0))" W ! D ^DIC K DIC
"RTN","RCDPEX32",34,0)
 . Q:Y'>0
"RTN","RCDPEX32",35,0)
 . S RCBILL=+Y,RCBILL(1)=$P($G(^PRCA(430,RCBILL,0)),U),RCWARN=0
"RTN","RCDPEX32",36,0)
 . I $P($G(^RCY(344.4,RCXDA1,0)),U,14) S RCWARN=RCWARN+1,DIR("A",RCWARN+1)=$J("",4)_"THE RECEIPT FOR THIS EEOB HAS ALREADY BEEN POSTED."
"RTN","RCDPEX32",37,0)
 . I $P($G(^PRCA(430.3,+$P($G(^PRCA(430,RCBILL,0)),U,8),0)),U,3)'=102 S RCWARN=RCWARN+1,DIR("A",RCWARN+1)=$J("",4)_"THIS IS NOT AN ACTIVE ACCOUNTS RECEIVABLE."
"RTN","RCDPEX32",38,0)
 . I RCWARN D  I Y'=1 Q
"RTN","RCDPEX32",39,0)
 .. S DIR("A",1)="** WARNING"_$S(RCWARN>1:"S",1:"")_":"
"RTN","RCDPEX32",40,0)
 .. S DIR("A",RCWARN+1)=" "
"RTN","RCDPEX32",41,0)
 .. S DIR(0)="YA",DIR("A")="ARE YOU SURE YOU WANT TO FILE THIS EEOB FOR CLAIM #: "_RCBILL(1)_"?: ",DIR("B")="NO" W ! D ^DIR K DIR
"RTN","RCDPEX32",42,0)
 .. ;
"RTN","RCDPEX32",43,0)
 . ; File EOB for new claim #
"RTN","RCDPEX32",44,0)
 . K ^TMP($J,"RCDP-EOB"),^TMP($J,"RCDPEOB","HDR")
"RTN","RCDPEX32",45,0)
 . S Q=0 F  S Q=$O(^RCY(344.4,RCXDA1,1,RCXDA,1,Q)) Q:'Q  S Q0=$G(^(Q,0)) D
"RTN","RCDPEX32",46,0)
 .. I $P(Q0,U)["835ERA" S ^TMP($J,"RCDPEOB","HDR")=Q0
"RTN","RCDPEX32",47,0)
 .. I $P(Q0,U,2)=$P(RC0,U,5) S $P(Q0,U,2)=RCBILL(1)
"RTN","RCDPEX32",48,0)
 .. S ^TMP($J,"RCDP-EOB",1,Q,0)=Q0
"RTN","RCDPEX32",49,0)
 . S ^TMP($J,"RCDP-EOB",1,.5,0)="835ERA"
"RTN","RCDPEX32",50,0)
 . S RCEOB=$$DUP^IBCEOB("^TMP("_$J_",""RCDP-EOB"",1)",RCBILL) ; IA 4042
"RTN","RCDPEX32",51,0)
 . K ^TMP($J,"RCDP-EOB",1,.5,0)
"RTN","RCDPEX32",52,0)
 . I RCEOB D  Q
"RTN","RCDPEX32",53,0)
 .. N RCWHY S RCWHY(1)="EEOB already found on file while trying to change claim # and filing into IB"
"RTN","RCDPEX32",54,0)
 .. D STORACT^RCDPEX31(RCXDA1,RCXDA,.RCWHY)
"RTN","RCDPEX32",55,0)
 .. S RCCHG=1,DA(1)=RCXDA1,DA=RCXDA D CHGED(.DA,RCEOB,RCSAVE)
"RTN","RCDPEX32",56,0)
 .. S DIR(0)="YA",DIR("A",1)="EEOB detail is already on file for "_RCBILL(1)_" - Exception removed",DIR("A")="PRESS RETURN TO CONTINUE" D ^DIR K DIR
"RTN","RCDPEX32",57,0)
 . ;
"RTN","RCDPEX32",58,0)
 . ; Add stub rec to 361.1 if not there
"RTN","RCDPEX32",59,0)
 . S RCEOB=+$$ADD3611^IBCEOB(+$P($G(^RCY(344.4,RCXDA1,0)),U,12),"","",RCBILL,1,"^TMP("_$J_",""RCDP-EOB"",1)") ; IA 4042
"RTN","RCDPEX32",60,0)
 . ;
"RTN","RCDPEX32",61,0)
 . I RCEOB<0 D  Q
"RTN","RCDPEX32",62,0)
 .. N RCWHY S RCWHY(1)="Error encountered trying to change claim # and file into IB"
"RTN","RCDPEX32",63,0)
 .. D STORACT^RCDPEX31(RCXDA1,RCXDA,.RCWHY)
"RTN","RCDPEX32",64,0)
 .. S DIR("A")="EA",DIR("A",1)="Error - EEOB detail not added to IB for bill "_RCBILL(1),DIR("A")="PRESS RETURN TO CONTINUE" D ^DIR K DIR
"RTN","RCDPEX32",65,0)
 . ;
"RTN","RCDPEX32",66,0)
 . ; Update EOB in file 361.1
"RTN","RCDPEX32",67,0)
 . ; Call needs ^TMP arrays: $J,"RCDPEOB","HDR" and $J,"RCDP-EOB"
"RTN","RCDPEX32",68,0)
 . D UPD3611^IBCEOB(RCEOB,1,1) ; IA 4042
"RTN","RCDPEX32",69,0)
 . ; errors in ^TMP("RCDPERR-EOB",$J
"RTN","RCDPEX32",70,0)
 . I $O(^TMP("RCDPERR-EOB",$J,0)) D
"RTN","RCDPEX32",71,0)
 .. D ERRUPD^IBCEOB(RCEOB,"RCDPERR-EOB") ; Adds error msgs to IB file 361.1 ; IA 4042
"RTN","RCDPEX32",72,0)
 . ;
"RTN","RCDPEX32",73,0)
 . S RCCHG=1
"RTN","RCDPEX32",74,0)
 . N RCWHY S RCWHY(1)="EEOB claim # changed and filed into IB under new claim #"
"RTN","RCDPEX32",75,0)
 . D STORACT^RCDPEX31(RCXDA1,RCXDA,.RCWHY)
"RTN","RCDPEX32",76,0)
 . S DA(1)=RCXDA1,DA=RCXDA
"RTN","RCDPEX32",77,0)
 . D CHGED(.DA,RCEOB,RCSAVE)
"RTN","RCDPEX32",78,0)
 . S DIE="^RCY(344.4,"_DA(1)_",1,",DR="1///@" D ^DIE
"RTN","RCDPEX32",79,0)
 . S DIR("A",1)="EEOB Filed.  Its detail may be viewed using Third Party Joint Inquiry",DIR("A")="PRESS RETURN TO CONTINUE ",DIR(0)="EA"
"RTN","RCDPEX32",80,0)
 . W ! D ^DIR K DIR
"RTN","RCDPEX32",81,0)
 . S VALMBG=1
"RTN","RCDPEX32",82,0)
 ;
"RTN","RCDPEX32",83,0)
EDITNQ I $G(RCCHG) D BLD^RCDPEX2
"RTN","RCDPEX32",84,0)
 K ^TMP($J,"RCDP-EOB"),^TMP($J,"RCDPEOB","HDR"),^TMP("RCDPERR-EOB",$J)
"RTN","RCDPEX32",85,0)
 S VALMBCK="R"
"RTN","RCDPEX32",86,0)
 Q
"RTN","RCDPEX32",87,0)
 ;
"RTN","RCDPEX32",88,0)
CHGED(DA,RCEOB,RCSAVE) ;  Change bad bill # to good one for EOB
"RTN","RCDPEX32",89,0)
 ; DA = DA and DA(1) to use for DIE call
"RTN","RCDPEX32",90,0)
 ; RCEOB = the ien of the entry in file 361.1
"RTN","RCDPEX32",91,0)
 ; RCSAVE = the free text of the original bill #
"RTN","RCDPEX32",92,0)
 N DIE,DR,X,Y
"RTN","RCDPEX32",93,0)
 S DIE="^RCY(344.4,"_DA(1)_",1,",DR=".05///@;.02////"_RCEOB_";.13////1"_$S(RCSAVE'="":";.17////"_RCSAVE,1:"")_";.07///@" D ^DIE
"RTN","RCDPEX32",94,0)
 Q
"RTN","RCDPEX32",95,0)
 ;
"RTN","RCFMOBR")
0^5^B17653139^B17029551
"RTN","RCFMOBR",1,0)
RCFMOBR ;WASH-ISC@ALTOONA,PA/RWT-BILL RECONCILIATIONS LIST ;11/20/96  2:30 PM
"RTN","RCFMOBR",2,0)
V ;;4.5;Accounts Receivable;**2,20,40,53,249**;Mar 20, 1995;Build 2
"RTN","RCFMOBR",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCFMOBR",4,0)
EN ;Creates report from OBR data in file 423.6
"RTN","RCFMOBR",5,0)
 ;
"RTN","RCFMOBR",6,0)
 ;      OBR Data Structure used by this routine
"RTN","RCFMOBR",7,0)
 ; ^TMP("OBR",$J,SITE,"NOT IN AR")=NextRec^TotalItems^TotalFMSAmt
"RTN","RCFMOBR",8,0)
 ; ^TMP("OBR",$J,SITE,"NOT IN FMS")=NextRec^TotalItems^TotalARAmt
"RTN","RCFMOBR",9,0)
 ; ^TMP("OBR",$J,SITE,"DISCREPANCY")=NextRec^TotalItems^TotalFMSAmt^TotalARAmt
"RTN","RCFMOBR",10,0)
 ; ^TMP("OBR",$J,"BN",BILLNUMBER)=[423.6 rec] <-- x-ref of FMS Bills
"RTN","RCFMOBR",11,0)
 ; ^TMP("OBR",$J,"REPORT","1")="LINE 1"
"RTN","RCFMOBR",12,0)
 ; ^TMP("OBR",$J","REPORT,"2")="LINE 2"
"RTN","RCFMOBR",13,0)
 ;
"RTN","RCFMOBR",14,0)
 ; Descriptions of modules:
"RTN","RCFMOBR",15,0)
 ;    PROCFMS  -  loop through FMS bills (^PRCF(423.6)) updating
"RTN","RCFMOBR",16,0)
 ;                global ^TMP("OBR",$J,"BN") while also checking
"RTN","RCFMOBR",17,0)
 ;                for invalid AR bills
"RTN","RCFMOBR",18,0)
 ;    PROCAR   -  loop through all Active AR Bills comparing amounts
"RTN","RCFMOBR",19,0)
 ;                and looking for Detail bills not found in FMS
"RTN","RCFMOBR",20,0)
 ;    BUILDRPT -  Prepares report in global ^TMP("OBR",$J,"REPORT")
"RTN","RCFMOBR",21,0)
 ;
"RTN","RCFMOBR",22,0)
 N X,Y,OBR,A0,ERR
"RTN","RCFMOBR",23,0)
 K ^TMP("OBR",$J)
"RTN","RCFMOBR",24,0)
 ;
"RTN","RCFMOBR",25,0)
 I $G(PRCADA) D PROCESS(PRCADA) G Q1
"RTN","RCFMOBR",26,0)
 S OBR="OBR-",ERR=-1
"RTN","RCFMOBR",27,0)
 F  S OBR=$O(^PRCF(423.6,"B",OBR)) Q:OBR=""!(OBR'["OBR-")  D
"RTN","RCFMOBR",28,0)
    .I $O(^PRCF(423.6,"B",OBR))'["OBR-" D  Q
"RTN","RCFMOBR",29,0)
       ..S A0=$O(^PRCF(423.6,"B",OBR,0))
"RTN","RCFMOBR",30,0)
       ..S ERR=0 D PROCESS(A0)
"RTN","RCFMOBR",31,0)
 I ERR D PROCESS(ERR)
"RTN","RCFMOBR",32,0)
Q1 K ^TMP("OBR",$J)
"RTN","RCFMOBR",33,0)
 Q
"RTN","RCFMOBR",34,0)
PROCESS(A0) N X,X1,X2,Y,SN,PARENT,XMTEXT,XMSUB,XMSENDER,XMDUZ,ERR,DATE,FMSDATE
"RTN","RCFMOBR",35,0)
 S ERR=0 D
"RTN","RCFMOBR",36,0)
   .I '$D(^PRCF(423.6,A0,0)) S ERR=-1 Q
"RTN","RCFMOBR",37,0)
   .I $E(^PRCF(423.6,A0,0),1,3)'["OBR" S ERR=-1 Q
"RTN","RCFMOBR",38,0)
   .S X=$P(^PRCF(423.6,A0,0),"-",2)
"RTN","RCFMOBR",39,0)
   .S X=$E(X,5,6)_"-"_$E(X,7,8)_"-"_$E(X,1,4) D ^%DT ;Y is defined
"RTN","RCFMOBR",40,0)
   .S PARENT=$P($P(^PRCF(423.6,A0,0),"-",5),U)
"RTN","RCFMOBR",41,0)
   .;
"RTN","RCFMOBR",42,0)
   .D PROCFMS^RCFMOBR1(A0)
"RTN","RCFMOBR",43,0)
   .D PROCAR^RCFMOBR1(A0)
"RTN","RCFMOBR",44,0)
   .D BUILDRPT^RCFMOBR2(PARENT)
"RTN","RCFMOBR",45,0)
 ;
"RTN","RCFMOBR",46,0)
 I '$D(PARENT) S PARENT=$$SITE^RCMSITE
"RTN","RCFMOBR",47,0)
 S PARENT=$P(^DIC(4,+$O(^DIC(4,"D",PARENT,0)),0),U)
"RTN","RCFMOBR",48,0)
 ;
"RTN","RCFMOBR",49,0)
 I '$D(Y) S Y=DT  ;Y may be defined from %DT call above
"RTN","RCFMOBR",50,0)
 S X1=Y,X2=($E(Y,6,7)+1)*-1 D C^%DTC,YX^%DTC
"RTN","RCFMOBR",51,0)
 S FMSDATE=$P(Y,"@"),FMSDATE=$E(FMSDATE,1,4)_$E(FMSDATE,9,12)
"RTN","RCFMOBR",52,0)
 D NOW^%DTC S DATE=$E(X,4,5)_"-"_$E(X,6,7)_"-"_$E(X,2,3)
"RTN","RCFMOBR",53,0)
 ; - Transmits report via e-mail to FMS mail group
"RTN","RCFMOBR",54,0)
 S XMSUB="FMS "_FMSDATE_" RECONCILIATION ("_DATE_") "
"RTN","RCFMOBR",55,0)
 S XMSUB=XMSUB_PARENT
"RTN","RCFMOBR",56,0)
 I ERR D
"RTN","RCFMOBR",57,0)
   .S ^TMP("OBR",$J,"REPORT",1)="Date of Report: "_DATE
"RTN","RCFMOBR",58,0)
   .S ^TMP("OBR",$J,"REPORT",2)="NOTE: This report compares your current A/R records with data received from"
"RTN","RCFMOBR",59,0)
   .S ^TMP("OBR",$J,"REPORT",3)="      FMS on the last day of the previous accounting period."
"RTN","RCFMOBR",60,0)
   .S ^TMP("OBR",$J,"REPORT",4)=""
"RTN","RCFMOBR",61,0)
   .S ^TMP("OBR",$J,"REPORT",5)="No FMS data exists to reconcile!"
"RTN","RCFMOBR",62,0)
 S XMTEXT="^TMP(""OBR"",$J,""REPORT"","
"RTN","RCFMOBR",63,0)
 S XMDUZ="Accounts Receivable Package",XMY("G.FMS")="",XMY(DUZ)="" D ^XMD
"RTN","RCFMOBR",64,0)
 Q
"RTN","RCFMOBR",65,0)
EN2 ;Entry point from Regenerate Prior Month OBRs option
"RTN","RCFMOBR",66,0)
 N DIR,PRCADA,Y
"RTN","RCFMOBR",67,0)
 W !!,"This option will transmit the OBR report(s) to you and members"
"RTN","RCFMOBR",68,0)
 W !,"of the G.FMS mail group."
"RTN","RCFMOBR",69,0)
 W !!,"NOTE: Depending on the number of active AR bills in your system,"
"RTN","RCFMOBR",70,0)
 W !,"      this may take awhile to run.",!
"RTN","RCFMOBR",71,0)
 S DIR(0)="YO",DIR("A")="Are you sure you want to do this",DIR("B")="NO"
"RTN","RCFMOBR",72,0)
 D ^DIR Q:Y'=1  S ZTRTN="EN^RCFMOBR",ZTDESC="Prior Month OBRs"
"RTN","RCFMOBR",73,0)
 S ZTIO="" D ^%ZTLOAD Q
"RTN","RCFMOBR",74,0)
 ;
"RTN","RCFMOBR",75,0)
EN3 ;Deletes OBRs over 60 days old
"RTN","RCFMOBR",76,0)
 N A0,A1,A2,DA,DIK,X,X1,X2
"RTN","RCFMOBR",77,0)
 S A0="OBR-" F  S A0=$O(^PRCF(423.6,"B",A0)) Q:A0=""!(A0'["OBR-")  S A1=$E($P(A0,"-",2),1,8),A2=0 F  S A2=$O(^PRCF(423.6,"B",A0,A2)) Q:+A2=0  D
"RTN","RCFMOBR",78,0)
 .S X1=DT,X2=$$RCDT(A1) D ^%DTC I X>60 S DIK="^PRCF(423.6,",DA=A2 D ^DIK
"RTN","RCFMOBR",79,0)
 Q
"RTN","RCFMOBR",80,0)
RCDT(A1) ;Convert yyyymmdd to FM date
"RTN","RCFMOBR",81,0)
 N X,Y
"RTN","RCFMOBR",82,0)
 S X=A1,X=$E(X,5,6)_" "_$E(X,7,8)_", "_$E(X,1,4)
"RTN","RCFMOBR",83,0)
 D ^%DT
"RTN","RCFMOBR",84,0)
 Q Y
"RTN","RCFMOBR",85,0)
PURGE ;purge unprocessed document file
"RTN","RCFMOBR",86,0)
 N DIR,Y,X,X1,X2,RCDT
"RTN","RCFMOBR",87,0)
 S DIR("A")="How many days worth of DATA do you want to retain"
"RTN","RCFMOBR",88,0)
 S DIR(0)="N",DIR("?")="This is the number of days entries will remain in the file."
"RTN","RCFMOBR",89,0)
 D ^DIR
"RTN","RCFMOBR",90,0)
 I +Y<0!(Y="")!($E(Y,1)="^") G POUT
"RTN","RCFMOBR",91,0)
 S X1=DT,X2=-(+Y) D C^%DTC S RCDT=X
"RTN","RCFMOBR",92,0)
 S ZTRTN="QPURGE^RCFMOBR",ZTSAVE("RCDT")="",ZTDESC="Purge unprocessed document list",ZTIO="" D ^%ZTLOAD
"RTN","RCFMOBR",93,0)
POUT K DIRUT,DIROUT,DTOUT,DUOUT Q
"RTN","RCFMOBR",94,0)
 ;
"RTN","RCFMOBR",95,0)
QPURGE N DA,DIK
"RTN","RCFMOBR",96,0)
 S DIK="^RC(347,"
"RTN","RCFMOBR",97,0)
 Q:'$D(^RC(347))
"RTN","RCFMOBR",98,0)
 S DA=0 F  S DA=$O(^RC(347,DA)) Q:'DA  I $P(^(DA,0),U,5)<RCDT D ^DIK
"RTN","RCFMOBR",99,0)
 K RCDT
"RTN","RCFMOBR",100,0)
 Q
"RTN","RCRCXM1")
0^2^B17272658^B17252116
"RTN","RCRCXM1",1,0)
RCRCXM1 ;ALB/CMS - AR/RC ORIGINAL TRANSMISSION SET ;09/08/97
"RTN","RCRCXM1",2,0)
V ;;4.5;Accounts Receivable;**63,122,189,249**;Mar 20, 1995;Build 2
"RTN","RCRCXM1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCXM1",4,0)
 ;
"RTN","RCRCXM1",5,0)
 Q
"RTN","RCRCXM1",6,0)
 ;
"RTN","RCRCXM1",7,0)
IBS ;Set the IB Bill Information data line from RCRCVXM
"RTN","RCRCXM1",8,0)
 ;Return: ^TMP("RCRCVL",$J,"XM")
"RTN","RCRCXM1",9,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,1,1)="BN1^BILL#^CAT.ABB^STATUS.ABB^CURRENT BALANCE^BILL TYPE^FORM TYPE^BILL DATE FROM^BILL DATE TO"
"RTN","RCRCXM1",10,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,1,2)="BN2^TOTAL BILL CHARGES^OFFSET AMT^OFFSET DESC.^DATE FIRST PRINTED^TAX ID^REFERRAL REASON CODE^REFERRAL COMMENT"
"RTN","RCRCXM1",11,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,2,1)="BINS^NAME OF INSURED^SUBSCRIBER ID#^RELATIONSHIP TO INSURED^CONDITION RELATED TO^"
"RTN","RCRCXM1",12,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,3,1)="PAT^PAT NAME^SSN^DOB^SEX^SENSITIVE RECORD Y/N^ADD1^ADD2^ADD3^CITY^STATE^ZIP"
"RTN","RCRCXM1",13,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,4,1)="INS^INSURER NAME^ADD1^ADD2^ADD3^CITY^STATE^ZIP^PHONE^PROVIDER ID#^GROUP NAME^GROUP #"
"RTN","RCRCXM1",14,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,5,1)="INSUP^DEBTNAME^DEBT ADD1^DEBT ADD2^DEBT ADD3^CITY^STATE^ZIP^PHONE
"RTN","RCRCXM1",15,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,6,1)="OPV^1^OPV DATE1"
"RTN","RCRCXM1",16,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,6,2)="OPV^2^OPV DATE2"
"RTN","RCRCXM1",17,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,7,1)="DXS^1^DIAGNOSIS CODE^DESCRIPTION"
"RTN","RCRCXM1",18,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,7,2)="DXS^2^DIAGNOSIS CODE^DESCRIPTION"
"RTN","RCRCXM1",19,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,8,1)="RVC^1^REVENUE CODE^DESCRIPTION^RATE^UNITS^TOTAL CHARGES"
"RTN","RCRCXM1",20,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,8,2)="RVC^2^REVENUE CODE^DESCRIPTION^RATE^UNITS^TOTAL CHARGES"
"RTN","RCRCXM1",21,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,9,1)="PRC^1^PROCEDURE CODE^PROCEDURE DATE^PLACE OF SERVICE CODE^PLACE OF SERVICE^TYPE OF SERVICE CODE^TYPE OF SERVICE"
"RTN","RCRCXM1",22,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,9,2)="PRC^2^PROCEDURE CODE^PROCEDURE DATE^PLACE OF SERVICE CODE^PLACE OF SERVICE^TYPE OF SERVICE CODE^TYPE OF SERVICE"
"RTN","RCRCXM1",23,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,10,1)="RXF^1^RX #^REFILL DATE^DRUG^NAME^DAYS SUPPLY^QUANTITY^NDC NUMBER"
"RTN","RCRCXM1",24,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,10,2)="RXF^2^RX #^REFILL DATE^DRUG^NAME^DAYS SUPPLY^QUANTITY^NDC NUMBER"
"RTN","RCRCXM1",25,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,11,1)="PRD^1^PROSTHETIC DEVICE NAME^DELIVERY DATE"
"RTN","RCRCXM1",26,0)
 ;S ^TMP("RCRCVL",$J,"XM",PRCABN,11,2)="PRD^2^PROSTHETIC DEVICE NAME^DELIVERY DATE"
"RTN","RCRCXM1",27,0)
 ;
"RTN","RCRCXM1",28,0)
 N RCDR,RCI,RCIB,RCUNK S RCIB=""
"RTN","RCRCXM1",29,0)
 D BILL^IBRFN3(PRCABN,.RCIB)
"RTN","RCRCXM1",30,0)
 S RCUNK="UNK"
"RTN","RCRCXM1",31,0)
 I RCIB=0 S RCA(PRCABN,RCY)="No IB Bill/Claim Information" G IBSQ
"RTN","RCRCXM1",32,0)
 ; - allow sites to refer bill but not electronically
"RTN","RCRCXM1",33,0)
 I $P($G(RCCAT(+$G(PRCA("CAT")))),U,1)'=1 S ^TMP("RCRCVL",$J,"XM",PRCABN,0)=RCY G IBSQ
"RTN","RCRCXM1",34,0)
 ; - set XM primary bill information 
"RTN","RCRCXM1",35,0)
 S RCCNT=RCCNT+1
"RTN","RCRCXM1",36,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,0)=RCY
"RTN","RCRCXM1",37,0)
 S RCDR="BN1^"_$G(PRCA("BNAME"),RCUNK)_U_$P($G(PRCA("CAT")),U,3)_U_$P($G(PRCA("STATUS")),U,3)_U_+$P($$BILL^RCJIBFN2(PRCABN),U,3)_U_$G(RCIB("TOC"))_U_$G(RCIB("TCF"))_U_$G(RCIB("STF"))_U_$G(RCIB("STT"))
"RTN","RCRCXM1",38,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,1,1)=RCDR S RCDR=""
"RTN","RCRCXM1",39,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,1,2)="BN2^"_$G(RCIB("TCG"))_U_$G(RCIB("DFP"))_U_$G(RCIB("TAX"))_U_$G(PRCA("REF REASON"))
"RTN","RCRCXM1",40,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,2,1)="BINS^"_$P($G(RCIB("PIN")),U,5)_U_$P($G(RCIB("PIN")),U,6)_U_$P($G(RCIB("PIN")),U,7)_U_$S($G(RCIB("CRE"))]"":RCIB("CRE"),$G(RCIB("CRA"))]"":RCIB("CRA"),$G(RCIB("CRO"))]"":RCIB("CRO"),1:"")
"RTN","RCRCXM1",41,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,3,1)="PAT^"_$E($G(VADM(1),RCUNK),1,30)_U_$P($G(VADM(2)),U,1)_U_$P($G(VADM(3)),U,1)_U_$P($G(VADM(5)),U)_U_$G(RCIB("SR"))_U_$G(VAPA(1))_U_$G(VAPA(2))_U_$G(VAPA(3))_U_$G(VAPA(4))_U_$P($G(VAPA(5)),U,2)_U_+$G(VAPA(6))
"RTN","RCRCXM1",42,0)
 S ^TMP("RCRCVL",$J,"XM",PRCABN,4,1)="INS^"_$P($G(RCIB("PIN")),U,1)_U_$G(RCIB("PIN","MMA"))_U_$P($G(RCIB("PIN")),U,2,4)
"RTN","RCRCXM1",43,0)
 ;
"RTN","RCRCXM1",44,0)
 ; - set multiples if defined
"RTN","RCRCXM1",45,0)
 I $O(RCIB("OPV",0)) S RCI=0 F  S RCI=$O(RCIB("OPV",RCI)) Q:'RCI  D
"RTN","RCRCXM1",46,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,6,RCI)="OPV^"_RCI_U_RCIB("OPV",RCI)
"RTN","RCRCXM1",47,0)
 I $O(RCIB("DXS",0)) S RCI=0 F  S RCI=$O(RCIB("DXS",RCI)) Q:'RCI  D
"RTN","RCRCXM1",48,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,7,RCI)="DXS^"_RCI_U_RCIB("DXS",RCI)
"RTN","RCRCXM1",49,0)
 I $O(RCIB("RVC",0)) S RCI=0 F  S RCI=$O(RCIB("RCV",RCI)) Q:'RCI  D
"RTN","RCRCXM1",50,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,8,RCI)="RVC^"_RCI_U_RCIB("RCV",RCI)
"RTN","RCRCXM1",51,0)
 I $O(RCIB("PRC",0)) S RCI=0 F  S RCI=$O(RCIB("PRC",RCI)) Q:'RCI  D
"RTN","RCRCXM1",52,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,9,RCI)="PRC^"_RCI_U_RCIB("PRC",RCI)
"RTN","RCRCXM1",53,0)
 I $O(RCIB("RXF",0)) S RCI=0 F  S RCI=$O(RCIB("RXF",RCI)) Q:'RCI  D
"RTN","RCRCXM1",54,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,10,RCI)="RXF^"_RCI_U_RCIB("RXF",RCI)
"RTN","RCRCXM1",55,0)
 I $O(RCIB("PDR",0)) S RCI=0 F  S RCI=$O(RCIB("PDR",RCI)) Q:'RCI  D
"RTN","RCRCXM1",56,0)
 .S ^TMP("RCRCVL",$J,"XM",PRCABN,11,RCI)="PDR^"_RCI_U_RCIB("PDR",RCI)
"RTN","RCRCXM1",57,0)
 ;
"RTN","RCRCXM1",58,0)
 ; - set Current Debtor Name and Address if different
"RTN","RCRCXM1",59,0)
 S RCI=""
"RTN","RCRCXM1",60,0)
 I $G(PRCA("DEBTNM"))'=$P($G(RCIB("PIN")),U,1) S RCI=1
"RTN","RCRCXM1",61,0)
 I 'RCI,$G(PRCA("DEBTAD1"))'=$P($G(RCIB("PIN","MMA")),U,1) S RCI=1
"RTN","RCRCXM1",62,0)
 I 'RCI,$P($G(PRCA("DEBTADD")),U,7)'=$P($G(PRCA("PIN","MMA")),U,7)
"RTN","RCRCXM1",63,0)
 I RCI S ^TMP("RCRCVL",$J,"XM",PRCABN,5,1)="INSUP^"_$E($G(PRCA("DEBTNM")),1,30)_U_$G(PRCA("DEBTAD1"))_U_$G(PRCA("DEBTAD2"))_U_$G(PRCA("DEBTAD3"))_U_$G(PRCA("DEBTCT"))_U_$G(PRCA("DEBTST"))_U_$G(PRCA("DEBTZIP"))_U_$P($G(PRCA("DEBTADD")),U,7)
"RTN","RCRCXM1",64,0)
 ;
"RTN","RCRCXM1",65,0)
IBSQ K DFN,PRCA,RCCAT,VA,VADM,VAPA
"RTN","RCRCXM1",66,0)
 Q
"RTN","RCRCXM1",67,0)
 ;RCRCXM1
"VER")
8.0^22.0
"BLD",7304,6)
^229
**END**
**END**
