Released OR*3*307 SEQ #278
Extracted from mail message
**KIDS**:OR*3.0*307^

**INSTALL NAME**
OR*3.0*307
"BLD",18785,0)
OR*3.0*307^ORDER ENTRY/RESULTS REPORTING^0^3100205^y
"BLD",18785,1,0)
^^2^2^3090911^
"BLD",18785,1,1,0)
The description of this patch may be found in the National Patch Module
"BLD",18785,1,2,0)
under OR*3*307.
"BLD",18785,4,0)
^9.64PA^101.24^2
"BLD",18785,4,101.24,0)
101.24
"BLD",18785,4,101.24,222)
n^n^f^^y^^y^o^n
"BLD",18785,4,101.24,224)
I Y=1604
"BLD",18785,4,103,0)
103
"BLD",18785,4,103,222)
y^y^f^^^^n
"BLD",18785,4,"B",101.24,101.24)
 
"BLD",18785,4,"B",103,103)
 
"BLD",18785,6)
17^
"BLD",18785,6.3)
60
"BLD",18785,"ABPKG")
n
"BLD",18785,"INID")
^n
"BLD",18785,"INIT")
POST^ORAMY
"BLD",18785,"KRN",0)
^9.67PA^779.2^20
"BLD",18785,"KRN",.4,0)
.4
"BLD",18785,"KRN",.4,"NM",0)
^9.68A^2^2
"BLD",18785,"KRN",.4,"NM",1,0)
ORAM TEAM LIST    FILE #103^103^0
"BLD",18785,"KRN",.4,"NM",2,0)
ORAM TEAM LIST    FILE #100.21^100.21^0
"BLD",18785,"KRN",.4,"NM","B","ORAM TEAM LIST    FILE #100.21",2)
 
"BLD",18785,"KRN",.4,"NM","B","ORAM TEAM LIST    FILE #103",1)
 
"BLD",18785,"KRN",.401,0)
.401
"BLD",18785,"KRN",.401,"NM",0)
^9.68A^2^2
"BLD",18785,"KRN",.401,"NM",1,0)
ORAM NEXT LAB SORT    FILE #103^103^0
"BLD",18785,"KRN",.401,"NM",2,0)
ORAM TEAM LIST    FILE #100.21^100.21^0
"BLD",18785,"KRN",.401,"NM","B","ORAM NEXT LAB SORT    FILE #103",1)
 
"BLD",18785,"KRN",.401,"NM","B","ORAM TEAM LIST    FILE #100.21",2)
 
"BLD",18785,"KRN",.402,0)
.402
"BLD",18785,"KRN",.403,0)
.403
"BLD",18785,"KRN",.5,0)
.5
"BLD",18785,"KRN",.84,0)
.84
"BLD",18785,"KRN",3.6,0)
3.6
"BLD",18785,"KRN",3.8,0)
3.8
"BLD",18785,"KRN",9.2,0)
9.2
"BLD",18785,"KRN",9.8,0)
9.8
"BLD",18785,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",18785,"KRN",9.8,"NM",1,0)
ORAM^^0^B73547514
"BLD",18785,"KRN",9.8,"NM",2,0)
ORAM1^^0^B159543113
"BLD",18785,"KRN",9.8,"NM",3,0)
ORAM2^^0^B120270114
"BLD",18785,"KRN",9.8,"NM",4,0)
ORAM3^^0^B38571379
"BLD",18785,"KRN",9.8,"NM",5,0)
ORAMSET^^0^B40743224
"BLD",18785,"KRN",9.8,"NM",6,0)
ORAMX^^0^B147643525
"BLD",18785,"KRN",9.8,"NM",7,0)
ORAMTTR^^0^B84948729
"BLD",18785,"KRN",9.8,"NM",8,0)
ORWOR^^0^B36027702
"BLD",18785,"KRN",9.8,"NM","B","ORAM",1)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAM1",2)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAM2",3)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAM3",4)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAMSET",5)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAMTTR",7)
 
"BLD",18785,"KRN",9.8,"NM","B","ORAMX",6)
 
"BLD",18785,"KRN",9.8,"NM","B","ORWOR",8)
 
"BLD",18785,"KRN",19,0)
19
"BLD",18785,"KRN",19,"NM",0)
^9.68A^14^14
"BLD",18785,"KRN",19,"NM",1,0)
ORAM ANTICOAGULATION CONTEXT^^0
"BLD",18785,"KRN",19,"NM",2,0)
ORAM ANTICOAGULATION SETUP^^0
"BLD",18785,"KRN",19,"NM",3,0)
ORAM COMPLICATIONS REPORT^^0
"BLD",18785,"KRN",19,"NM",4,0)
ORAM SET TEAMS^^0
"BLD",18785,"KRN",19,"NM",5,0)
ORW PARAM GUI^^2
"BLD",18785,"KRN",19,"NM",6,0)
ORAM DIVISION PARAMETERS^^0
"BLD",18785,"KRN",19,"NM",7,0)
ORAM CLINIC PARAMETERS^^0
"BLD",18785,"KRN",19,"NM",8,0)
ORAM ROSENDAAL SINGLE PT TTR^^0
"BLD",18785,"KRN",19,"NM",9,0)
ORAM ROSENDAAL TTR REPORT^^0
"BLD",18785,"KRN",19,"NM",10,0)
ORAM REPORTS MENU^^0
"BLD",18785,"KRN",19,"NM",11,0)
ORAM PATIENT LIST ALL^^0
"BLD",18785,"KRN",19,"NM",12,0)
ORAM PATIENT LIST COMPLEX^^0
"BLD",18785,"KRN",19,"NM",13,0)
ORAM PATIENT LIST NEXT LAB^^0
"BLD",18785,"KRN",19,"NM",14,0)
ORAM PATIENT LIST MENU^^0
"BLD",18785,"KRN",19,"NM","B","ORAM ANTICOAGULATION CONTEXT",1)
 
"BLD",18785,"KRN",19,"NM","B","ORAM ANTICOAGULATION SETUP",2)
 
"BLD",18785,"KRN",19,"NM","B","ORAM CLINIC PARAMETERS",7)
 
"BLD",18785,"KRN",19,"NM","B","ORAM COMPLICATIONS REPORT",3)
 
"BLD",18785,"KRN",19,"NM","B","ORAM DIVISION PARAMETERS",6)
 
"BLD",18785,"KRN",19,"NM","B","ORAM PATIENT LIST ALL",11)
 
"BLD",18785,"KRN",19,"NM","B","ORAM PATIENT LIST COMPLEX",12)
 
"BLD",18785,"KRN",19,"NM","B","ORAM PATIENT LIST MENU",14)
 
"BLD",18785,"KRN",19,"NM","B","ORAM PATIENT LIST NEXT LAB",13)
 
"BLD",18785,"KRN",19,"NM","B","ORAM REPORTS MENU",10)
 
"BLD",18785,"KRN",19,"NM","B","ORAM ROSENDAAL SINGLE PT TTR",8)
 
"BLD",18785,"KRN",19,"NM","B","ORAM ROSENDAAL TTR REPORT",9)
 
"BLD",18785,"KRN",19,"NM","B","ORAM SET TEAMS",4)
 
"BLD",18785,"KRN",19,"NM","B","ORW PARAM GUI",5)
 
"BLD",18785,"KRN",19.1,0)
19.1
"BLD",18785,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",18785,"KRN",101,0)
101
"BLD",18785,"KRN",409.61,0)
409.61
"BLD",18785,"KRN",771,0)
771
"BLD",18785,"KRN",779.2,0)
779.2
"BLD",18785,"KRN",870,0)
870
"BLD",18785,"KRN",8989.51,0)
8989.51
"BLD",18785,"KRN",8989.51,"NM",0)
^9.68A^45^40
"BLD",18785,"KRN",8989.51,"NM",1,0)
ORAM ADDRESS LINE 1^^0
"BLD",18785,"KRN",8989.51,"NM",2,0)
ORAM ADDRESS LINE 2^^0
"BLD",18785,"KRN",8989.51,"NM",3,0)
ORAM ADDRESS LINE 3^^0
"BLD",18785,"KRN",8989.51,"NM",5,0)
ORAM CLINIC FAX NUMBER^^0
"BLD",18785,"KRN",8989.51,"NM",6,0)
ORAM CLINIC PHONE NUMBER^^0
"BLD",18785,"KRN",8989.51,"NM",7,0)
ORAM CONSULT LINK ENABLED^^0
"BLD",18785,"KRN",8989.51,"NM",8,0)
ORAM CONSULT REQUEST SERVICE^^0
"BLD",18785,"KRN",8989.51,"NM",9,0)
ORAM CPT FOR COMPLEX PHONE^^0
"BLD",18785,"KRN",8989.51,"NM",10,0)
ORAM CPT FOR INITIAL VISIT^^0
"BLD",18785,"KRN",8989.51,"NM",11,0)
ORAM CPT FOR LETTER TO PT^^0
"BLD",18785,"KRN",8989.51,"NM",12,0)
ORAM CPT FOR ORIENTATION^^0
"BLD",18785,"KRN",8989.51,"NM",13,0)
ORAM CPT FOR SIMPLE PHONE^^0
"BLD",18785,"KRN",8989.51,"NM",14,0)
ORAM CPT FOR SUBSEQUENT VISIT^^0
"BLD",18785,"KRN",8989.51,"NM",15,0)
ORAM DISCHARGE NOTE^^0
"BLD",18785,"KRN",8989.51,"NM",16,0)
ORAM DSS ID^^0
"BLD",18785,"KRN",8989.51,"NM",17,0)
ORAM DSS UNIT^^0
"BLD",18785,"KRN",8989.51,"NM",19,0)
ORAM INITIAL NOTE^^0
"BLD",18785,"KRN",8989.51,"NM",21,0)
ORAM INTERIM NOTE^^0
"BLD",18785,"KRN",8989.51,"NM",22,0)
ORAM MEDICAL CENTER NAME^^0
"BLD",18785,"KRN",8989.51,"NM",23,0)
ORAM NON-COUNT LOCATION^^0
"BLD",18785,"KRN",8989.51,"NM",24,0)
ORAM PCE LINK ENABLED^^0
"BLD",18785,"KRN",8989.51,"NM",25,0)
ORAM PHONE CLINIC^^0
"BLD",18785,"KRN",8989.51,"NM",26,0)
ORAM POINT OF CONTACT NAME^^0
"BLD",18785,"KRN",8989.51,"NM",27,0)
ORAM RAV FILE PATH^^0
"BLD",18785,"KRN",8989.51,"NM",28,0)
ORAM SIGNATURE BLOCK NAME^^0
"BLD",18785,"KRN",8989.51,"NM",29,0)
ORAM SIGNATURE BLOCK TITLE^^0
"BLD",18785,"KRN",8989.51,"NM",32,0)
ORAM TEAM LIST (ALL)^^0
"BLD",18785,"KRN",8989.51,"NM",33,0)
ORAM TEAM LIST (COMPLEX)^^0
"BLD",18785,"KRN",8989.51,"NM",34,0)
ORAM VISIT LOCATION^^0
"BLD",18785,"KRN",8989.51,"NM",35,0)
ORAM CLINIC NAME^^0
"BLD",18785,"KRN",8989.51,"NM",36,0)
ORAM DEFAULT PILL STRENGTH^^0
"BLD",18785,"KRN",8989.51,"NM",37,0)
ORAM INCL TIME W/NEXT INR DATE^^0
"BLD",18785,"KRN",8989.51,"NM",38,0)
ORAM TOLL FREE PHONE^^0
"BLD",18785,"KRN",8989.51,"NM",39,0)
ORAM INR QUICK ORDER^^0
"BLD",18785,"KRN",8989.51,"NM",40,0)
ORAM CBC QUICK ORDER^^0
"BLD",18785,"KRN",8989.51,"NM",41,0)
ORAM HCT/HGB REFERENCE^^0
"BLD",18785,"KRN",8989.51,"NM",42,0)
ORAM INDICATIONS FOR CARE^^0
"BLD",18785,"KRN",8989.51,"NM",43,0)
ORAM AUTO PRIMARY INDICATION^^0
"BLD",18785,"KRN",8989.51,"NM",44,0)
ORAM APPT MATCH LOOK-AHEAD^^0
"BLD",18785,"KRN",8989.51,"NM",45,0)
ORAM APPT MATCH LOOK-BACK^^0
"BLD",18785,"KRN",8989.51,"NM","B","ORAM ADDRESS LINE 1",1)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM ADDRESS LINE 2",2)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM ADDRESS LINE 3",3)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM APPT MATCH LOOK-AHEAD",44)

"BLD",18785,"KRN",8989.51,"NM","B","ORAM APPT MATCH LOOK-BACK",45)

"BLD",18785,"KRN",8989.51,"NM","B","ORAM AUTO PRIMARY INDICATION",43)

"BLD",18785,"KRN",8989.51,"NM","B","ORAM CBC QUICK ORDER",40)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CLINIC FAX NUMBER",5)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CLINIC NAME",35)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CLINIC PHONE NUMBER",6)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CONSULT LINK ENABLED",7)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CONSULT REQUEST SERVICE",8)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR COMPLEX PHONE",9)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR INITIAL VISIT",10)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR LETTER TO PT",11)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR ORIENTATION",12)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR SIMPLE PHONE",13)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM CPT FOR SUBSEQUENT VISIT",14)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM DEFAULT PILL STRENGTH",36)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM DISCHARGE NOTE",15)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM DSS ID",16)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM DSS UNIT",17)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM HCT/HGB REFERENCE",41)

"BLD",18785,"KRN",8989.51,"NM","B","ORAM INCL TIME W/NEXT INR DATE",37)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM INDICATIONS FOR CARE",42)

"BLD",18785,"KRN",8989.51,"NM","B","ORAM INITIAL NOTE",19)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM INR QUICK ORDER",39)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM INTERIM NOTE",21)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM MEDICAL CENTER NAME",22)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM NON-COUNT LOCATION",23)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM PCE LINK ENABLED",24)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM PHONE CLINIC",25)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM POINT OF CONTACT NAME",26)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM RAV FILE PATH",27)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM SIGNATURE BLOCK NAME",28)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM SIGNATURE BLOCK TITLE",29)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM TEAM LIST (ALL)",32)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM TEAM LIST (COMPLEX)",33)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM TOLL FREE PHONE",38)
 
"BLD",18785,"KRN",8989.51,"NM","B","ORAM VISIT LOCATION",34)
 
"BLD",18785,"KRN",8989.52,0)
8989.52
"BLD",18785,"KRN",8989.52,"NM",0)
^9.68A^2^2
"BLD",18785,"KRN",8989.52,"NM",1,0)
ORAM CLINIC PARAMETERS^^0
"BLD",18785,"KRN",8989.52,"NM",2,0)
ORAM SITE PARAMETERS^^0
"BLD",18785,"KRN",8989.52,"NM","B","ORAM CLINIC PARAMETERS",1)
 
"BLD",18785,"KRN",8989.52,"NM","B","ORAM SITE PARAMETERS",2)
 
"BLD",18785,"KRN",8994,0)
8994
"BLD",18785,"KRN",8994,"NM",0)
^9.68A^39^35
"BLD",18785,"KRN",8994,"NM",1,0)
ORAM CONCOMP^^0
"BLD",18785,"KRN",8994,"NM",2,0)
ORAM HCT^^0
"BLD",18785,"KRN",8994,"NM",3,0)
ORAM INR^^0
"BLD",18785,"KRN",8994,"NM",6,0)
ORAM PATIENT^^0
"BLD",18785,"KRN",8994,"NM",7,0)
ORAM PROVIDER^^0
"BLD",18785,"KRN",8994,"NM",8,0)
ORAM SIGCHECK^^0
"BLD",18785,"KRN",8994,"NM",9,0)
ORAM1 ACDATA^^0
"BLD",18785,"KRN",8994,"NM",10,0)
ORAM1 ADDTOP^^0
"BLD",18785,"KRN",8994,"NM",11,0)
ORAM1 COMPTEST^^0
"BLD",18785,"KRN",8994,"NM",13,0)
ORAM1 FLOWTT^^0
"BLD",18785,"KRN",8994,"NM",14,0)
ORAM1 GETPT^^0
"BLD",18785,"KRN",8994,"NM",15,0)
ORAM1 LOCK^^0
"BLD",18785,"KRN",8994,"NM",16,0)
ORAM1 LOG^^0
"BLD",18785,"KRN",8994,"NM",17,0)
ORAM1 OUTINR^^0
"BLD",18785,"KRN",8994,"NM",18,0)
ORAM1 PCGOAL^^0
"BLD",18785,"KRN",8994,"NM",19,0)
ORAM1 PTCHECK^^0
"BLD",18785,"KRN",8994,"NM",20,0)
ORAM1 PTENTER^^0
"BLD",18785,"KRN",8994,"NM",21,0)
ORAM1 TERASE^^0
"BLD",18785,"KRN",8994,"NM",22,0)
ORAM1 UNLOCK^^0
"BLD",18785,"KRN",8994,"NM",23,0)
ORAM2 ALLGOAL^^0
"BLD",18785,"KRN",8994,"NM",24,0)
ORAM2 NOACT^^0
"BLD",18785,"KRN",8994,"NM",25,0)
ORAM2 PTAPPT^^0
"BLD",18785,"KRN",8994,"NM",26,0)
ORAM2 REMIND^^0
"BLD",18785,"KRN",8994,"NM",27,0)
ORAM2 SHOWRATE^^0
"BLD",18785,"KRN",8994,"NM",28,0)
ORAM2 TEAMCHK^^0
"BLD",18785,"KRN",8994,"NM",29,0)
ORAM3 COMPENT^^0
"BLD",18785,"KRN",8994,"NM",31,0)
ORAM3 PTADR^^0
"BLD",18785,"KRN",8994,"NM",32,0)
ORAM3 PTFONE^^0
"BLD",18785,"KRN",8994,"NM",33,0)
ORAMSET GET^^0
"BLD",18785,"KRN",8994,"NM",34,0)
ORAMX CONSULT^^0
"BLD",18785,"KRN",8994,"NM",35,0)
ORAMX PCESET^^0
"BLD",18785,"KRN",8994,"NM",36,0)
ORAMSET GETCLINS^^0
"BLD",18785,"KRN",8994,"NM",37,0)
ORAM ORDER^^0
"BLD",18785,"KRN",8994,"NM",38,0)
ORAMSET INDICS^^0
"BLD",18785,"KRN",8994,"NM",39,0)
ORAM APPTMTCH^^0
"BLD",18785,"KRN",8994,"NM","B","ORAM APPTMTCH",39)

"BLD",18785,"KRN",8994,"NM","B","ORAM CONCOMP",1)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM HCT",2)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM INR",3)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM ORDER",37)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM PATIENT",6)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM PROVIDER",7)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM SIGCHECK",8)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 ACDATA",9)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 ADDTOP",10)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 COMPTEST",11)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 FLOWTT",13)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 GETPT",14)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 LOCK",15)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 LOG",16)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 OUTINR",17)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 PCGOAL",18)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 PTCHECK",19)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 PTENTER",20)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 TERASE",21)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM1 UNLOCK",22)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 ALLGOAL",23)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 NOACT",24)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 PTAPPT",25)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 REMIND",26)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 SHOWRATE",27)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM2 TEAMCHK",28)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM3 COMPENT",29)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM3 PTADR",31)
 
"BLD",18785,"KRN",8994,"NM","B","ORAM3 PTFONE",32)
 
"BLD",18785,"KRN",8994,"NM","B","ORAMSET GET",33)
 
"BLD",18785,"KRN",8994,"NM","B","ORAMSET GETCLINS",36)
 
"BLD",18785,"KRN",8994,"NM","B","ORAMSET INDICS",38)

"BLD",18785,"KRN",8994,"NM","B","ORAMX CONSULT",34)
 
"BLD",18785,"KRN",8994,"NM","B","ORAMX PCESET",35)
 
"BLD",18785,"KRN","B",.4,.4)
 
"BLD",18785,"KRN","B",.401,.401)
 
"BLD",18785,"KRN","B",.402,.402)
 
"BLD",18785,"KRN","B",.403,.403)
 
"BLD",18785,"KRN","B",.5,.5)
 
"BLD",18785,"KRN","B",.84,.84)
 
"BLD",18785,"KRN","B",3.6,3.6)
 
"BLD",18785,"KRN","B",3.8,3.8)
 
"BLD",18785,"KRN","B",9.2,9.2)
 
"BLD",18785,"KRN","B",9.8,9.8)
 
"BLD",18785,"KRN","B",19,19)
 
"BLD",18785,"KRN","B",19.1,19.1)
 
"BLD",18785,"KRN","B",101,101)
 
"BLD",18785,"KRN","B",409.61,409.61)
 
"BLD",18785,"KRN","B",771,771)
 
"BLD",18785,"KRN","B",779.2,779.2)
 
"BLD",18785,"KRN","B",870,870)
 
"BLD",18785,"KRN","B",8989.51,8989.51)
 
"BLD",18785,"KRN","B",8989.52,8989.52)
 
"BLD",18785,"KRN","B",8994,8994)
 
"BLD",18785,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",18785,"QUES",0)
^9.62^^
"BLD",18785,"REQB",0)
^9.611^1^1
"BLD",18785,"REQB",1,0)
OR*3.0*243^2
"BLD",18785,"REQB","B","OR*3.0*243",1)
 
"DATA",101.24,1604,0)
ORAM ANTICOAG REPORT^1604^1^2^ORAM2^RPTSTART^1^R^^^^R^203^^^^^^^ORAM2
"DATA",101.24,1604,2)
^^Anticoagulation Flowsheet^Anticoagulation Flowsheet^^RPT^ORAM2
"FIA",101.24)
OE/RR REPORT
"FIA",101.24,0)
^ORD(101.24,
"FIA",101.24,0,0)
101.24I
"FIA",101.24,0,1)
n^n^f^^y^^y^o^n
"FIA",101.24,0,10)

"FIA",101.24,0,11)
I Y=1604
"FIA",101.24,0,"RLRO")

"FIA",101.24,0,"VR")
3.0^OR
"FIA",101.24,101.24)
0
"FIA",101.24,101.241)
0
"FIA",101.24,101.243)
0
"FIA",103)
ORAM FLOWSHEET
"FIA",103,0)
^ORAM(103,
"FIA",103,0,0)
103P
"FIA",103,0,1)
y^y^f^^^^n
"FIA",103,0,10)

"FIA",103,0,11)

"FIA",103,0,"RLRO")

"FIA",103,0,"VR")
3.0^OR
"FIA",103,103)
0
"FIA",103,103.011)
0
"FIA",103,103.0112)
0
"FIA",103,103.021)
0
"FIA",103,103.035)
0
"FIA",103,103.07)
0
"FIA",103,103.08)
0
"FIA",103,103.085)
0
"FIA",103,103.11105)
0
"FIA",103,103.1199)
0
"FRV1",101.24,"1604,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1604,0",13,"F")
;XWB(8994,
"INIT")
POST^ORAMY
"KRN",.4,2013,-1)
0^1
"KRN",.4,2013,0)
ORAM TEAM LIST^3090610.1556^@^103^^@^3091110
"KRN",.4,2013,"F",1)
3;C30;L20;N;S;"(Next Lab Date)"~-2,^DPT(^^S I(0,0)=D0 S DIP(1)=$S($D(^ORAM(103,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1),X=X S D(0)=+X;Z;"PATIENT:"~
"KRN",.4,2013,"F",2)
-2,.01;C1;""~-2,.09;""~-2,"PATIENT PHONE: ";C1;""~-2,.131;C17;""~-2,"PATIENT WORK PHONE: ";C1;""~-2,.132;C22;""~-2,"ADDRESS: ";C1;""~
"KRN",.4,2013,"F",3)
-2,S DIP(101)=$S($D(^DPT(D0,.11)):^(.11),1:"") S X=$P(DIP(101),U,4)_" "_$P($G(^DIC(5,+$P(DIP(101),U,5),0)),U)_" "_$P(DIP(101),U,6) W X K DIP;C12;"";Z;"CITY_" "_STATE_" "_ZIP CODE"~
"KRN",.4,2013,"H")
Anticoagulation Next Lab Report
"KRN",.4,2014,-1)
0^2
"KRN",.4,2014,0)
ORAM TEAM LIST^3090610.1628^@^100.21^^@^3100106
"KRN",.4,2014,"DXS",1,9)
N DIERR X DXS(1,9.2) K DIC S DIC="^DPT(",DIC(0)="MF" D ^DIC S (D,D0,D(0))=+Y S DIP(101)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(DIP(101),U,1) S D0=I(0,0) S D1=I(1,0)
"KRN",.4,2014,"DXS",1,9.2)
S I(1,0)=$G(D1),I(0,0)=$G(D0),DIP(1)=$S($D(^OR(100.21,D0,10,D1,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(100.2101,.01,"",$P(DIP(1),U,1))
"KRN",.4,2014,"F",2)
10,.01;"Patient"~10,-2,^DPT(^^X DXS(1,9);Z;"MEMBER:PATIENT:"~10,-2,.0905;"ID"~10,-2,.1;L10;"Current Ward"~10,-2,.108;L10;"Bed"~
"KRN",.4,2014,"H")
Anticoagulation Team List
"KRN",.401,1290,-1)
0^1
"KRN",.401,1290,0)
ORAM NEXT LAB SORT^3090610.1534^@^103^^@^3090611
"KRN",.401,1290,2,0)
^.4014^1^1
"KRN",.401,1290,2,1,0)
103^3^NEXT LAB^^^^^^^1
"KRN",.401,1290,2,1,"ASK")
1
"KRN",.401,1290,2,1,"F")
3090610.999999^Jun 11,2009^Jun 11,2009
"KRN",.401,1290,2,1,"GET")
S DISX(1)=$P($G(^ORAM(103,D0,0)),U,4)
"KRN",.401,1290,2,1,"IX")
^ORAM(103,"L",^ORAM(103,^2
"KRN",.401,1290,2,1,"QCON")
I (DISX(1)]]3090610.999999)&(DISX(1)']]3090625.24)
"KRN",.401,1290,2,1,"T")
3090625.24^Jun 25,2009@2400^Jun 25,2009@24:00
"KRN",.401,1290,2,1,"TXT")
NEXT LAB from Jun 11,2009 to Jun 25,2009@24:00
"KRN",.401,1290,2,"B",103,1)

"KRN",.401,1290,"%D",0)
^.4012^2^2^3090610^^^
"KRN",.401,1290,"%D",1,0)
This sort template by next lab simplifies prompting for date range for 
"KRN",.401,1290,"%D",2,0)
the Team List Reports.
"KRN",.401,1291,-1)
0^2
"KRN",.401,1291,0)
ORAM TEAM LIST^3090611.0923^@^100.21^^@^3100106
"KRN",.401,1291,2,0)
^.4014^2^2
"KRN",.401,1291,2,1,0)
100.21^.01^NAME^@^^^^^^4
"KRN",.401,1291,2,1,"ASK")
1
"KRN",.401,1291,2,1,"F")
SLC-ANTICOAGULATION (ALL(z^SLC-ANTICOAGULATION (ALL)
"KRN",.401,1291,2,1,"GET")
S DISX(1)=$P($G(^OR(100.21,D0,0)),U)
"KRN",.401,1291,2,1,"IX")
^OR(100.21,"B",^OR(100.21,^2
"KRN",.401,1291,2,1,"QCON")
I DISX(1)="SLC-ANTICOAGULATION (ALL)"
"KRN",.401,1291,2,1,"SER")
100.0000^1.0000
"KRN",.401,1291,2,1,"T")
SLC-ANTICOAGULATION (ALL)^SLC-ANTICOAGULATION (ALL)
"KRN",.401,1291,2,1,"TXT")
NAME equals SLC-ANTICOAGULATION (ALL)
"KRN",.401,1291,2,2,0)
100.2101^^MEMBER^@".01^^^^^^4
"KRN",.401,1291,2,2,1,0)
^.40141^1^1
"KRN",.401,1291,2,2,1,1,0)
100.21^10
"KRN",.401,1291,2,2,1,"B",100.21,1)

"KRN",.401,1291,2,2,"CM")
N DIERR S Y(1)=$S($D(^OR(100.21,D0,10,D1,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(100.2101,.01,"",$P(Y(1),U,1)) I D1>0 S DISX(2)=X
"KRN",.401,1291,2,2,"F")
@z^A
"KRN",.401,1291,2,2,"GET")
N DIERR S Y(1)=$S($D(^OR(100.21,D0,10,D1,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(100.2101,.01,"",$P(Y(1),U,1)) I D1>0 S DISX(2)=X
"KRN",.401,1291,2,2,"QCON")
I (DISX(2)]]"@z")&(DISX(2)']]"Z")
"KRN",.401,1291,2,2,"T")
Z^Z
"KRN",.401,1291,2,2,"TXT")
MEMBER from A to Z
"KRN",.401,1291,2,"B",100.21,1)

"KRN",.401,1291,2,"B",100.2101,2)

"KRN",.401,1291,"%D",0)
^.4012^2^2^3090611^^^^
"KRN",.401,1291,"%D",1,0)
This sort template identifies the list of Complext Anticoagulation 
"KRN",.401,1291,"%D",2,0)
patients.
"KRN",19,10162,-1)
2^5
"KRN",19,10162,0)
ORW PARAM GUI^GUI Parameters^^M^64^^^^^^^22
"KRN",19,10162,10,0)
^19.01IP^13^13
"KRN",19,10162,10,13,0)
12677^COAG
"KRN",19,10162,10,13,"^")
ORAM ANTICOAGULATION SETUP
"KRN",19,10162,"U")
GUI PARAMETERS
"KRN",19,12676,-1)
0^4
"KRN",19,12676,0)
ORAM SET TEAMS^Anticoagulation Background Job^^R^^^^^^^^
"KRN",19,12676,1,0)
^19.06^4^4^3081203^^
"KRN",19,12676,1,1,0)
This non-interactive option is used to set the daily Team Lists for the 
"KRN",19,12676,1,2,0)
Anticoagulation Management Teams. Works with the Anticoagulation 
"KRN",19,12676,1,3,0)
Management software. It should be queued to run daily in the early 
"KRN",19,12676,1,4,0)
morning, before the system is busy or the clinics start.
"KRN",19,12676,25)
TLISTS^ORAM3
"KRN",19,12676,"U")
ANTICOAGULATION BACKGROUND JOB
"KRN",19,12677,-1)
0^2
"KRN",19,12677,0)
ORAM ANTICOAGULATION SETUP^GUI Anticoagulation Parameters^^M^^^^^^^^ANTICOAGULATION MANAGEMENT
"KRN",19,12677,1,0)
^19.06^2^2^3090310^^^^
"KRN",19,12677,1,1,0)
Supports entry and update of the parameters which determine the behavior 
"KRN",19,12677,1,2,0)
of the Anticoagulation Management application.
"KRN",19,12677,10,0)
^19.01IP^2^2
"KRN",19,12677,10,1,0)
12748^D^1
"KRN",19,12677,10,1,"^")
ORAM DIVISION PARAMETERS
"KRN",19,12677,10,2,0)
12747^C^2
"KRN",19,12677,10,2,"^")
ORAM CLINIC PARAMETERS
"KRN",19,12677,99)
61430,45567
"KRN",19,12677,"U")
GUI ANTICOAGULATION PARAMETERS
"KRN",19,12678,-1)
0^3
"KRN",19,12678,0)
ORAM COMPLICATIONS REPORT^Anticoagulation Complication Report^^R^^^^^^^y^
"KRN",19,12678,1,0)
^19.06^2^2^3081218^^^
"KRN",19,12678,1,1,0)
Option to generate a report of complications to patients being tracked by 
"KRN",19,12678,1,2,0)
Anticoagulation Management.
"KRN",19,12678,10.1)
COMPLICATION SEARCH
"KRN",19,12678,25)
COMPRPT^ORAMX
"KRN",19,12678,99.1)
61277,44847
"KRN",19,12678,"U")
ANTICOAGULATION COMPLICATION R
"KRN",19,12679,-1)
0^1
"KRN",19,12679,0)
ORAM ANTICOAGULATION CONTEXT^Broker Context for Anticoagulation^^B^^^^^^^^ORDER ENTRY/RESULTS REPORTING^y
"KRN",19,12679,1,0)
^19.06^1^1^3090812^^^^
"KRN",19,12679,1,1,0)
RPC Context for Anticoagulation Management.
"KRN",19,12679,99.1)
61578,55596
"KRN",19,12679,"RPC",0)
^19.05P^52^46
"KRN",19,12679,"RPC",1,0)
ORAM PATIENT
"KRN",19,12679,"RPC",2,0)
ORAMSET GET
"KRN",19,12679,"RPC",3,0)
ORAM PROVIDER
"KRN",19,12679,"RPC",4,0)
ORAM HCT
"KRN",19,12679,"RPC",5,0)
ORAM INR
"KRN",19,12679,"RPC",6,0)
ORAM SIGCHECK
"KRN",19,12679,"RPC",7,0)
ORAM CONCOMP
"KRN",19,12679,"RPC",12,0)
ORAM1 ADDTOP
"KRN",19,12679,"RPC",13,0)
ORAM1 PTCHECK
"KRN",19,12679,"RPC",14,0)
ORAM1 ACDATA
"KRN",19,12679,"RPC",15,0)
ORAM1 LOCK
"KRN",19,12679,"RPC",16,0)
ORAM1 FLOWTT
"KRN",19,12679,"RPC",17,0)
ORAM1 OUTINR
"KRN",19,12679,"RPC",18,0)
ORAM1 PCGOAL
"KRN",19,12679,"RPC",19,0)
ORAM1 PTENTER
"KRN",19,12679,"RPC",20,0)
ORAM1 COMPTEST
"KRN",19,12679,"RPC",21,0)
ORAM1 TERASE
"KRN",19,12679,"RPC",22,0)
ORAM1 UNLOCK
"KRN",19,12679,"RPC",23,0)
ORAM1 LOG
"KRN",19,12679,"RPC",25,0)
ORAM1 GETPT
"KRN",19,12679,"RPC",26,0)
ORAM2 SHOWRATE
"KRN",19,12679,"RPC",27,0)
ORAM2 ALLGOAL
"KRN",19,12679,"RPC",28,0)
ORAM2 PTAPPT
"KRN",19,12679,"RPC",29,0)
ORAM2 NOACT
"KRN",19,12679,"RPC",30,0)
ORAM2 TEAMCHK
"KRN",19,12679,"RPC",31,0)
ORAM2 REMIND
"KRN",19,12679,"RPC",33,0)
ORAM3 COMPENT
"KRN",19,12679,"RPC",34,0)
ORAM3 PTADR
"KRN",19,12679,"RPC",35,0)
ORAM3 PTFONE
"KRN",19,12679,"RPC",36,0)
ORAMX CONSULT
"KRN",19,12679,"RPC",37,0)
ORWTPP GETCOS
"KRN",19,12679,"RPC",38,0)
ORWTPP GETDCOS
"KRN",19,12679,"RPC",39,0)
TIU SIGN RECORD
"KRN",19,12679,"RPC",40,0)
TIU CREATE RECORD
"KRN",19,12679,"RPC",41,0)
TIU UPDATE RECORD
"KRN",19,12679,"RPC",42,0)
TIU REQUIRES COSIGNATURE
"KRN",19,12679,"RPC",43,0)
TIU DELETE RECORD
"KRN",19,12679,"RPC",44,0)
ORWDX SAVE
"KRN",19,12679,"RPC",45,0)
ORAMX PCESET
"KRN",19,12679,"RPC",46,0)
ORWPCE SCSEL
"KRN",19,12679,"RPC",47,0)
ORAMSET GETCLINS
"KRN",19,12679,"RPC",48,0)
ORWU HASKEY
"KRN",19,12679,"RPC",49,0)
ORAM ORDER
"KRN",19,12679,"RPC",50,0)
ORWPCE SCDIS
"KRN",19,12679,"RPC",51,0)
ORAMSET INDICS
"KRN",19,12679,"RPC",52,0)
ORAM APPTMTCH
"KRN",19,12679,"U")
BROKER CONTEXT FOR ANTICOAGULA
"KRN",19,12747,-1)
0^7
"KRN",19,12747,0)
ORAM CLINIC PARAMETERS^Anticoagulation Clinic Parameters^^R^^^^^^^^ANTICOAGULATION MANAGEMENT
"KRN",19,12747,1,0)
^^2^2^3090310^
"KRN",19,12747,1,1,0)
Supports entry and update of the Clinic parameters which determine the
"KRN",19,12747,1,2,0)
behavior of the Anticoagulation Management application.
"KRN",19,12747,25)
SETCLIN^ORAMSET
"KRN",19,12747,"U")
ANTICOAGULATION CLINIC PARAMET
"KRN",19,12748,-1)
0^6
"KRN",19,12748,0)
ORAM DIVISION PARAMETERS^Division-wide Anticoagulation Parameters^^R^^^^^^^^ANTICOAGULATION MANAGEMENT
"KRN",19,12748,1,0)
^^2^2^3090310^
"KRN",19,12748,1,1,0)
Supports entry and update of the Division-wide parameters which determine
"KRN",19,12748,1,2,0)
the behavior of the Anticoagulation Management application.
"KRN",19,12748,25)
SETDIV^ORAMSET
"KRN",19,12748,"U")
DIVISION-WIDE ANTICOAGULATION 
"KRN",19,12758,-1)
0^9
"KRN",19,12758,0)
ORAM ROSENDAAL TTR REPORT^Calculate TTR (Rosendaal Method)^^R^^^^^^^y^
"KRN",19,12758,1,0)
^19.06^2^2^3090518^^
"KRN",19,12758,1,1,0)
Option to generate a report of the Time in Therapeutic range on both the 
"KRN",19,12758,1,2,0)
facility-wide and clinic-by-clinic basis for Anticoagulation Management.
"KRN",19,12758,10.1)
ROSENDAAL TTR
"KRN",19,12758,25)
MAIN^ORAMTTR
"KRN",19,12758,99.1)
61277,44847
"KRN",19,12758,"U")
CALCULATE TTR (ROSENDAAL METHO
"KRN",19,12759,-1)
0^10
"KRN",19,12759,0)
ORAM REPORTS MENU^Anticoagulation Management Reports^^M^^^^^^^^ANTICOAGULATION MANAGEMENT
"KRN",19,12759,1,0)
^19.06^2^2^3090611^^^
"KRN",19,12759,1,1,0)
This option provides access to the Quality Assurance Reports for the 
"KRN",19,12759,1,2,0)
Anticoagulation Management Program.
"KRN",19,12759,10,0)
^19.01IP^4^4
"KRN",19,12759,10,1,0)
12678^C^1
"KRN",19,12759,10,1,"^")
ORAM COMPLICATIONS REPORT
"KRN",19,12759,10,2,0)
12758^R^2
"KRN",19,12759,10,2,"^")
ORAM ROSENDAAL TTR REPORT
"KRN",19,12759,10,3,0)
12760^S^3
"KRN",19,12759,10,3,"^")
ORAM ROSENDAAL SINGLE PT TTR
"KRN",19,12759,10,4,0)
12768^P^4
"KRN",19,12759,10,4,"^")
ORAM PATIENT LIST MENU
"KRN",19,12759,99)
61523,35142
"KRN",19,12759,99.1)
61696,57601
"KRN",19,12759,"U")
ANTICOAGULATION MANAGEMENT REP
"KRN",19,12760,-1)
0^8
"KRN",19,12760,0)
ORAM ROSENDAAL SINGLE PT TTR^Single Patient TTR^^R^^^^^^^y^
"KRN",19,12760,1,0)
^19.06^2^2^3090518^^
"KRN",19,12760,1,1,0)
Option to generate a report of the Time in Therapeutic range for a single 
"KRN",19,12760,1,2,0)
patient in Anticoagulation Management.
"KRN",19,12760,10.1)
SINGLE PT TTR
"KRN",19,12760,25)
SINGLE^ORAMTTR
"KRN",19,12760,99.1)
61277,44847
"KRN",19,12760,"U")
SINGLE PATIENT TTR
"KRN",19,12765,-1)
0^13
"KRN",19,12765,0)
ORAM PATIENT LIST NEXT LAB^Next Lab Patient List^^R^^^^^^^y^ANTICOAGULATION MANAGEMENT
"KRN",19,12765,1,0)
^^3^3^3090611^
"KRN",19,12765,1,1,0)
This option supports generation of a list of Anticoagulation patients for 
"KRN",19,12765,1,2,0)
a selected Clinic, sorted by Next Lab Date for a user-specified date
"KRN",19,12765,1,3,0)
range.
"KRN",19,12765,25)
NEXTLAB^ORAMX
"KRN",19,12765,"U")
NEXT LAB PATIENT LIST
"KRN",19,12766,-1)
0^12
"KRN",19,12766,0)
ORAM PATIENT LIST COMPLEX^Complex Anticoagulation Patients^^R^^^^^^^y^ANTICOAGULATION MANAGEMENT
"KRN",19,12766,1,0)
^^1^1^3090611^
"KRN",19,12766,1,1,0)
This option prints the list of Complex patients for a selected Clinic.
"KRN",19,12766,25)
TEAMLIST^ORAMX("C")
"KRN",19,12766,"U")
COMPLEX ANTICOAGULATION PATIEN
"KRN",19,12767,-1)
0^11
"KRN",19,12767,0)
ORAM PATIENT LIST ALL^All Anticoagulation Patients^^R^^^^^^^y^ANTICOAGULATION MANAGEMENT
"KRN",19,12767,1,0)
^19.06^1^1^3090611^^
"KRN",19,12767,1,1,0)
This option prints the list of ALL patients for a selected Clinic.
"KRN",19,12767,25)
TEAMLIST^ORAMX("A")
"KRN",19,12767,"U")
ALL ANTICOAGULATION PATIENTS
"KRN",19,12768,-1)
0^14
"KRN",19,12768,0)
ORAM PATIENT LIST MENU^Anticoagulation Patient Lists^^M^^^^^^^^ANTICOAGULATION MANAGEMENT
"KRN",19,12768,1,0)
^19.06^2^2^3090611^^
"KRN",19,12768,1,1,0)
This menu allows printing/display of Patient Lists for Anticoagulation 
"KRN",19,12768,1,2,0)
Management.
"KRN",19,12768,10,0)
^19.01IP^3^3
"KRN",19,12768,10,1,0)
12767^A^1
"KRN",19,12768,10,1,"^")
ORAM PATIENT LIST ALL
"KRN",19,12768,10,2,0)
12766^C^2
"KRN",19,12768,10,2,"^")
ORAM PATIENT LIST COMPLEX
"KRN",19,12768,10,3,0)
12765^N^3
"KRN",19,12768,10,3,"^")
ORAM PATIENT LIST NEXT LAB
"KRN",19,12768,99)
61523,37466
"KRN",19,12768,"U")
ANTICOAGULATION PATIENT LISTS
"KRN",8989.51,509,-1)
0^1
"KRN",8989.51,509,0)
ORAM ADDRESS LINE 1^Address Line 1^0^^Address Line 1
"KRN",8989.51,509,1)
F^1:50^Answer must be 1-50 characters in length.
"KRN",8989.51,509,20,0)
^8989.512^1^1^3090305^^^^
"KRN",8989.51,509,20,1,0)
This is the first line of the Anticoagulation Clinic address.
"KRN",8989.51,509,30,0)
^8989.513I^2^2
"KRN",8989.51,509,30,1,0)
1^44
"KRN",8989.51,509,30,2,0)
2^4
"KRN",8989.51,510,-1)
0^2
"KRN",8989.51,510,0)
ORAM ADDRESS LINE 2^Address Line 2^^^Address Line 2
"KRN",8989.51,510,1)
F^1:30^Answer must be 1-30 characters in length.
"KRN",8989.51,510,20,0)
^^1^1^3081022^
"KRN",8989.51,510,20,1,0)
This is the second line of the Anticoagulation Clinic address.
"KRN",8989.51,510,30,0)
^8989.513I^2^2
"KRN",8989.51,510,30,1,0)
1^44
"KRN",8989.51,510,30,2,0)
2^4
"KRN",8989.51,511,-1)
0^3
"KRN",8989.51,511,0)
ORAM ADDRESS LINE 3^Address Line 3^^^Address Line 3
"KRN",8989.51,511,1)
F^1:60^Answer must be 1-60 characters in length.
"KRN",8989.51,511,20,0)
^^1^1^3081022^
"KRN",8989.51,511,20,1,0)
This is the (optional) third line of the Anticoagulation Clinic address.
"KRN",8989.51,511,30,0)
^8989.513I^2^2
"KRN",8989.51,511,30,1,0)
1^44
"KRN",8989.51,511,30,2,0)
2^4
"KRN",8989.51,512,-1)
0^15
"KRN",8989.51,512,0)
ORAM DISCHARGE NOTE^Anticoagulation Discharge Note^^^Discharge Note Title
"KRN",8989.51,512,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Discharge Note.
"KRN",8989.51,512,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,512,20,0)
^8989.512^3^3^3081021^^
"KRN",8989.51,512,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation
"KRN",8989.51,512,20,2,0)
Discharge Note, which is entered upon the patient's discharge from the
"KRN",8989.51,512,20,3,0)
Anticoagulation clinic.
"KRN",8989.51,512,30,0)
^8989.513I^1^1
"KRN",8989.51,512,30,1,0)
1^4
"KRN",8989.51,513,-1)
0^21
"KRN",8989.51,513,0)
ORAM INTERIM NOTE^Anticoagulation Interim Note^^^Interim Note Title
"KRN",8989.51,513,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Interim Note.
"KRN",8989.51,513,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,513,20,0)
^8989.512^3^3^3081203^^
"KRN",8989.51,513,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation Interim
"KRN",8989.51,513,20,2,0)
Note, which is entered during the patient's ongoing treatment by the
"KRN",8989.51,513,20,3,0)
Anticoagulation clinic.
"KRN",8989.51,513,30,0)
^8989.513I^1^1
"KRN",8989.51,513,30,1,0)
1^4
"KRN",8989.51,514,-1)
0^19
"KRN",8989.51,514,0)
ORAM INITIAL NOTE^Anticoagulation Initial Note^^^Initial Note Title
"KRN",8989.51,514,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Initial Assessment Note.
"KRN",8989.51,514,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,514,20,0)
^8989.512^3^3^3081021^^^
"KRN",8989.51,514,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation Initial
"KRN",8989.51,514,20,2,0)
Assessment Note, which is entered for the patient's first visit upon
"KRN",8989.51,514,20,3,0)
enrollment in the Clinic.
"KRN",8989.51,514,30,0)
^8989.513I^1^1
"KRN",8989.51,514,30,1,0)
1^4
"KRN",8989.51,515,-1)
0^32
"KRN",8989.51,515,0)
ORAM TEAM LIST (ALL)^Anticoagulation Team (All)^^^Anticoagulation Team (All)
"KRN",8989.51,515,1)
P^100.21:AEMQ^Select the Patient Team List for ALL Anticoagulation patients.
"KRN",8989.51,515,20,0)
^8989.512^4^4^3081022^^^
"KRN",8989.51,515,20,1,0)
The ALL Patient list, shows everyone scheduled for that team for that day
"KRN",8989.51,515,20,2,0)
AND any patients NOT completed on previous days.
"KRN",8989.51,515,20,3,0)
                                 
"KRN",8989.51,515,20,4,0)
Patients drop off this list as they are completed in the Anticoagulator.
"KRN",8989.51,515,30,0)
^8989.513I^2^2
"KRN",8989.51,515,30,1,0)
1^44
"KRN",8989.51,515,30,2,0)
2^4
"KRN",8989.51,516,-1)
0^33
"KRN",8989.51,516,0)
ORAM TEAM LIST (COMPLEX)^Anticoagulation Team (Complex)^^^Anticoagulation Team (Complex)
"KRN",8989.51,516,1)
P^100.21:AEMQ^Select the Patient Team List for incomplete Anticoagulation patients.
"KRN",8989.51,516,20,0)
^8989.512^4^4^3081022^^
"KRN",8989.51,516,20,1,0)
The complex patient list pulls out these patients so that they are not
"KRN",8989.51,516,20,2,0)
lost on the larger list (they appear on both lists).
"KRN",8989.51,516,20,3,0)
                                 
"KRN",8989.51,516,20,4,0)
Patients drop off this list as they are completed in the Anticoagulator.
"KRN",8989.51,516,30,0)
^8989.513I^2^2
"KRN",8989.51,516,30,1,0)
1^44
"KRN",8989.51,516,30,2,0)
2^4
"KRN",8989.51,518,-1)
0^5
"KRN",8989.51,518,0)
ORAM CLINIC FAX NUMBER^Clinic FAX Number^^^Clinic FAX Number
"KRN",8989.51,518,1)
F^4:25^Enter the phone number of the clinic (e.g., (###)###-####x####)
"KRN",8989.51,518,2)
K:X'?4.25NAP X
"KRN",8989.51,518,20,0)
^8989.512^2^2^3090309^^
"KRN",8989.51,518,20,1,0)
Telephone number, with extension if needed, for FAXes to be sent to the
"KRN",8989.51,518,20,2,0)
anticoagulation clinic. For patient letters.
"KRN",8989.51,518,30,0)
^8989.513I^2^2
"KRN",8989.51,518,30,1,0)
1^44
"KRN",8989.51,518,30,2,0)
2^4
"KRN",8989.51,519,-1)
0^6
"KRN",8989.51,519,0)
ORAM CLINIC PHONE NUMBER^Clinic Phone Number^^^Clinic Phone Number
"KRN",8989.51,519,1)
F^4:25^Enter the phone number of the clinic (e.g., (###)###-####x####)
"KRN",8989.51,519,2)
K:X'?4.25NAP X
"KRN",8989.51,519,20,0)
^8989.512^2^2^3090309^^
"KRN",8989.51,519,20,1,0)
Telephone number, with extension if needed, for patient to contact the
"KRN",8989.51,519,20,2,0)
anticoagulation clinic. For patient letters.
"KRN",8989.51,519,30,0)
^8989.513I^2^2
"KRN",8989.51,519,30,1,0)
1^44
"KRN",8989.51,519,30,2,0)
2^4
"KRN",8989.51,520,-1)
0^7
"KRN",8989.51,520,0)
ORAM CONSULT LINK ENABLED^Consult Link Enabled^^^Consult Link Enabled
"KRN",8989.51,520,1)
Y^^Indicate whether or not the Consult Linkage should be enabled.
"KRN",8989.51,520,20,0)
^8989.512^2^2^3081023^^
"KRN",8989.51,520,20,1,0)
Indicates if Consult Linker will be used. If NO: prompt will not be seen
"KRN",8989.51,520,20,2,0)
to complete consult.
"KRN",8989.51,520,30,0)
^8989.513I^2^2
"KRN",8989.51,520,30,1,0)
1^44
"KRN",8989.51,520,30,2,0)
2^4
"KRN",8989.51,521,-1)
0^8
"KRN",8989.51,521,0)
ORAM CONSULT REQUEST SERVICE^Consult Request Service Name^^^Consult Request Service Name
"KRN",8989.51,521,1)
P^123.5:AEMQ^Select the Consult Request Service for the Anticoagulation Clinic.
"KRN",8989.51,521,20,0)
^8989.512^3^3^3081211^^^
"KRN",8989.51,521,20,1,0)
This is the reference to the Consult Request Service with which Consult
"KRN",8989.51,521,20,2,0)
data will be associated for the Anticoagulation clinic. It is used only if
"KRN",8989.51,521,20,3,0)
the linkage with the Consult Package is enabled.
"KRN",8989.51,521,30,0)
^8989.513I^2^2
"KRN",8989.51,521,30,1,0)
1^44
"KRN",8989.51,521,30,2,0)
2^4
"KRN",8989.51,522,-1)
0^9
"KRN",8989.51,522,0)
ORAM CPT FOR COMPLEX PHONE^Complex Phone Visit (CPT)^^^Complex Phone Visit (CPT)
"KRN",8989.51,522,1)
P^81:AEMQ^Enter the current CPT code for a Complex Telephone Visit.
"KRN",8989.51,522,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,522,20,0)
^^2^2^3081021^
"KRN",8989.51,522,20,1,0)
This is the CPT code for a Complex Telephone Visit (i.e., HC PRO PHONE
"KRN",8989.51,522,20,2,0)
CALL 21-30 MIN (CPT-4 98968), as of 10/2008).
"KRN",8989.51,522,30,0)
^8989.513I^2^2
"KRN",8989.51,522,30,1,0)
1^44
"KRN",8989.51,522,30,2,0)
2^4
"KRN",8989.51,523,-1)
0^10
"KRN",8989.51,523,0)
ORAM CPT FOR INITIAL VISIT^Initial Office Visit (CPT)^^^Initial Office Visit (CPT)
"KRN",8989.51,523,1)
P^81:AEMQ^Enter the CPT code for the Initial Office Visit
"KRN",8989.51,523,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,523,20,0)
^^2^2^3081021^
"KRN",8989.51,523,20,1,0)
This is the CPT code for the Initial Office Visit (i.e., ANTICOAG MGMT, 
"KRN",8989.51,523,20,2,0)
INIT (CPT-4 99363), as of 10/2008).
"KRN",8989.51,523,30,0)
^8989.513I^2^2
"KRN",8989.51,523,30,1,0)
1^44
"KRN",8989.51,523,30,2,0)
2^4
"KRN",8989.51,524,-1)
0^11
"KRN",8989.51,524,0)
ORAM CPT FOR LETTER TO PT^Letter To Patient (CPT)^^^Letter to Patient (CPT)
"KRN",8989.51,524,1)
P^81:AEMQ^Enter the CPT code for Letter to patient.
"KRN",8989.51,524,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,524,20,0)
^^2^2^3081021^
"KRN",8989.51,524,20,1,0)
This is the CPT code for a Letter to the Patient (i.e., (CPT-4 98966), as
"KRN",8989.51,524,20,2,0)
of 10/2008).
"KRN",8989.51,524,30,0)
^8989.513I^2^2
"KRN",8989.51,524,30,1,0)
1^44
"KRN",8989.51,524,30,2,0)
2^4
"KRN",8989.51,525,-1)
0^12
"KRN",8989.51,525,0)
ORAM CPT FOR ORIENTATION^Orientation Class (CPT)^^^Orientation Class (CPT)
"KRN",8989.51,525,1)
P^81:AEMQ^This is the current CPT code for the Orientation Class Visit.
"KRN",8989.51,525,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,525,20,0)
^^2^2^3081021^
"KRN",8989.51,525,20,1,0)
This is the CPT code for the Orientation Class Visit (i.e., GROUP HEALTH 
"KRN",8989.51,525,20,2,0)
EDUCATION (CPT-4 99078), as of 10/2008).
"KRN",8989.51,525,30,0)
^8989.513I^2^2
"KRN",8989.51,525,30,1,0)
1^44
"KRN",8989.51,525,30,2,0)
2^4
"KRN",8989.51,526,-1)
0^13
"KRN",8989.51,526,0)
ORAM CPT FOR SIMPLE PHONE^Simple Phone Visit (CPT)^^^Simple Telephone Visit (CPT)
"KRN",8989.51,526,1)
P^81:AEMQ^Current CPT code for a Simple Telephone Visit.
"KRN",8989.51,526,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,526,20,0)
^8989.512^2^2^3081022^^^^
"KRN",8989.51,526,20,1,0)
This is the CPT code for a Simple Telephone Visit (i.e., HC PRO PHONE CALL
"KRN",8989.51,526,20,2,0)
5-10 MIN (CPT-4 98966), as of 10/2008).
"KRN",8989.51,526,30,0)
^8989.513I^2^2
"KRN",8989.51,526,30,1,0)
1^44
"KRN",8989.51,526,30,2,0)
2^4
"KRN",8989.51,527,-1)
0^14
"KRN",8989.51,527,0)
ORAM CPT FOR SUBSEQUENT VISIT^Subsequent Visit (CPT)^^^Subsequent Office Visit (CPT)
"KRN",8989.51,527,1)
P^81:AEMQ^Enter the CPT code for a Subsequent Office Visit.
"KRN",8989.51,527,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,527,20,0)
^^2^2^3081021^
"KRN",8989.51,527,20,1,0)
This is the CPT code for Subsequent Anticoagulation Management (i.e.,
"KRN",8989.51,527,20,2,0)
ANTICOAG MGMT, SUBSEQ (CPT-4 99364), as of 10/2008).
"KRN",8989.51,527,30,0)
^8989.513I^2^2
"KRN",8989.51,527,30,1,0)
1^44
"KRN",8989.51,527,30,2,0)
2^4
"KRN",8989.51,528,-1)
0^16
"KRN",8989.51,528,0)
ORAM DSS ID^DSS ID^^^DSS ID
"KRN",8989.51,528,1)
P^40.7:AEMQ^Select the Stop Code for the Anticoagulation Clinic.
"KRN",8989.51,528,20,0)
^^1^1^3081022^
"KRN",8989.51,528,20,1,0)
This is the stop code for the Anticoagulation Clinic.
"KRN",8989.51,528,30,0)
^8989.513I^1^1
"KRN",8989.51,528,30,1,0)
1^4
"KRN",8989.51,529,-1)
0^17
"KRN",8989.51,529,0)
ORAM DSS UNIT^DSS Unit^^^DSS Unit
"KRN",8989.51,529,1)
P^724:AEMQ^Select the DSS Unit for the Anticoagulation Clinic.
"KRN",8989.51,529,20,0)
^^2^2^3081022^
"KRN",8989.51,529,20,1,0)
This is the reference to the DSS Unit to which the anticoagulation data
"KRN",8989.51,529,20,2,0)
will be associated.
"KRN",8989.51,529,30,0)
^8989.513I^1^1
"KRN",8989.51,529,30,1,0)
1^4
"KRN",8989.51,530,-1)
0^41
"KRN",8989.51,530,0)
ORAM HCT/HGB REFERENCE^Hematocrit (HCT) or Hemoglobin (Hgb)^^^Hematocrit (HCT) or Hemoglobin (Hgb)
"KRN",8989.51,530,1)
P^60:AEMQ^Select the Laboratory Test for Hematocrit or Hemoglobin.
"KRN",8989.51,530,3)
I +$$VALIDLAB^ORAMX(+Y)
"KRN",8989.51,530,20,0)
^^3^3^3091214^
"KRN",8989.51,530,20,1,0)
This is the reference to the Lab Test for Hematocrit (HCT) or Hemoglobin 
"KRN",8989.51,530,20,2,0)
(Hgb). It will determine whether the Demographics Tab will display the 
"KRN",8989.51,530,20,3,0)
most recent Hematocrit or the last Hemoglobin.
"KRN",8989.51,530,30,0)
^8989.513I^1^1
"KRN",8989.51,530,30,1,0)
1^4
"KRN",8989.51,532,-1)
0^22
"KRN",8989.51,532,0)
ORAM MEDICAL CENTER NAME^Medical Center Name^^^Medical Center Name
"KRN",8989.51,532,1)
F^3:70^Answer must be 3-70 characters in length.
"KRN",8989.51,532,20,0)
^8989.512^1^1^3090306^^
"KRN",8989.51,532,20,1,0)
Name of medical facility for letter head.
"KRN",8989.51,532,30,0)
^8989.513I^2^2
"KRN",8989.51,532,30,1,0)
1^4
"KRN",8989.51,532,30,2,0)
2^4.2
"KRN",8989.51,533,-1)
0^23
"KRN",8989.51,533,0)
ORAM NON-COUNT LOCATION^Anticoagulation NON-COUNT Clinic^^^Anticoagulation NON-COUNT Clinic
"KRN",8989.51,533,1)
P^44:AEMQ^NON-COUNT Clinic for Anticoagulation.
"KRN",8989.51,533,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,533,20,0)
^8989.512^19^19^3081022^^
"KRN",8989.51,533,20,1,0)
Clinic Locations 
"KRN",8989.51,533,20,2,0)
                                 
"KRN",8989.51,533,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,533,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,533,20,5,0)
Location file.  
"KRN",8989.51,533,20,6,0)
                                 
"KRN",8989.51,533,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,533,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,533,20,9,0)
non-count clinic.  
"KRN",8989.51,533,20,10,0)
                                 
"KRN",8989.51,533,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,533,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,533,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,533,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,533,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,533,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,533,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,533,20,18,0)
                                 
"KRN",8989.51,533,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,533,30,0)
^8989.513I^2^2
"KRN",8989.51,533,30,1,0)
1^44
"KRN",8989.51,533,30,2,0)
2^4
"KRN",8989.51,534,-1)
0^24
"KRN",8989.51,534,0)
ORAM PCE LINK ENABLED^PCE Link Enabled^^^PCE Link Enabled
"KRN",8989.51,534,1)
Y^^Indicate whether the interface to PCE should be enabled.
"KRN",8989.51,534,20,0)
^8989.512^3^3^3081030^^
"KRN",8989.51,534,20,1,0)
Indicates if interface with PCE will be used. If NO: prompt will not be
"KRN",8989.51,534,20,2,0)
seen to enter PCE information, and the information will not be passed to
"KRN",8989.51,534,20,3,0)
the Event Capture system.
"KRN",8989.51,534,30,0)
^8989.513I^2^2
"KRN",8989.51,534,30,1,0)
1^44
"KRN",8989.51,534,30,2,0)
2^4
"KRN",8989.51,535,-1)
0^25
"KRN",8989.51,535,0)
ORAM PHONE CLINIC^Anticoagulation PHONE Clinic Location^^^Anticoagulation PHONE Clinic Location
"KRN",8989.51,535,1)
P^44:AEMQ^Telephone Clinic for Anticoagulation.
"KRN",8989.51,535,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,535,20,0)
^8989.512^19^19^3081022^^
"KRN",8989.51,535,20,1,0)
Clinic Locations 
"KRN",8989.51,535,20,2,0)
                                 
"KRN",8989.51,535,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,535,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,535,20,5,0)
Location file.  
"KRN",8989.51,535,20,6,0)
                                 
"KRN",8989.51,535,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,535,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,535,20,9,0)
non-count clinic.  
"KRN",8989.51,535,20,10,0)
                                 
"KRN",8989.51,535,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,535,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,535,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,535,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,535,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,535,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,535,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,535,20,18,0)
                                 
"KRN",8989.51,535,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,535,30,0)
^8989.513I^2^2
"KRN",8989.51,535,30,1,0)
1^44
"KRN",8989.51,535,30,2,0)
2^4
"KRN",8989.51,536,-1)
0^26
"KRN",8989.51,536,0)
ORAM POINT OF CONTACT NAME^Point of Contact Name^^^Point of Contact Name
"KRN",8989.51,536,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,536,20,0)
^8989.512^2^2^3081022^^
"KRN",8989.51,536,20,1,0)
Name of Contact Person (or Clinic) for the "CALL IF QUESTIONS" block on
"KRN",8989.51,536,20,2,0)
patient letters.
"KRN",8989.51,536,30,0)
^8989.513I^2^2
"KRN",8989.51,536,30,1,0)
1^44
"KRN",8989.51,536,30,2,0)
2^4
"KRN",8989.51,537,-1)
0^27
"KRN",8989.51,537,0)
ORAM RAV FILE PATH^Complete path to network folder^^^Complete path to network folder
"KRN",8989.51,537,1)
F^1:99^Answer must be 1-99 characters in length.
"KRN",8989.51,537,2)
K:X'?1.99ANP X
"KRN",8989.51,537,20,0)
^8989.512^7^7^3090407^^^
"KRN",8989.51,537,20,1,0)
To use the letter programs the Anticoagulator needs to know where to find
"KRN",8989.51,537,20,2,0)
them.  This path is where you put the 2 .rav files (cvisit.rav and
"KRN",8989.51,537,20,3,0)
mappt.rav).  Usually placed in the same network file as the the .EXE file
"KRN",8989.51,537,20,4,0)
for the program for ease of updating, etc.
"KRN",8989.51,537,20,5,0)
                                 
"KRN",8989.51,537,20,6,0)
This field contains the path up to the slash before the exe.  Portland
"KRN",8989.51,537,20,7,0)
example: \\vhaporfpc11\ClinApps\DelphiExe\antiC\
"KRN",8989.51,537,30,0)
^8989.513I^2^2
"KRN",8989.51,537,30,1,0)
1^4
"KRN",8989.51,537,30,2,0)
2^4.2
"KRN",8989.51,538,-1)
0^28
"KRN",8989.51,538,0)
ORAM SIGNATURE BLOCK NAME^Signature Block Name or Clinic^^^Signature Block Name or Clinic
"KRN",8989.51,538,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,538,20,0)
^^1^1^3081022^
"KRN",8989.51,538,20,1,0)
Signing name to be used in the letter signature blocks.
"KRN",8989.51,538,30,0)
^8989.513I^2^2
"KRN",8989.51,538,30,1,0)
1^44
"KRN",8989.51,538,30,2,0)
2^4
"KRN",8989.51,539,-1)
0^29
"KRN",8989.51,539,0)
ORAM SIGNATURE BLOCK TITLE^Signature Block Title^^^Signature Block Title
"KRN",8989.51,539,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,539,20,0)
^8989.512^1^1^3081022^^^
"KRN",8989.51,539,20,1,0)
Title used in letter signature blocks.
"KRN",8989.51,539,30,0)
^8989.513I^2^2
"KRN",8989.51,539,30,1,0)
1^44
"KRN",8989.51,539,30,2,0)
2^4
"KRN",8989.51,540,-1)
0^35
"KRN",8989.51,540,0)
ORAM CLINIC NAME^Clinic Name^^^Clinic Name
"KRN",8989.51,540,1)
F^3:30^Name of the Clinic as it will appear in the Choose Location ComboBox.
"KRN",8989.51,540,20,0)
^^3^3^3090305^
"KRN",8989.51,540,20,1,0)
Specifies the name of the Clinic with which the user may associate the 
"KRN",8989.51,540,20,2,0)
patient whose flowsheet is being viewed/entered (3 - 30 characters in 
"KRN",8989.51,540,20,3,0)
length).
"KRN",8989.51,540,30,0)
^8989.513I^2^2
"KRN",8989.51,540,30,1,0)
1^44
"KRN",8989.51,540,30,2,0)
2^4
"KRN",8989.51,542,-1)
0^34
"KRN",8989.51,542,0)
ORAM VISIT LOCATION^Anticoagulation VISIT Clinic Location^^^Anticoagulation VISIT Clinic Location
"KRN",8989.51,542,1)
P^44:AEMQ^Face-to-face Clinic for Anticoagulation.
"KRN",8989.51,542,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,542,20,0)
^^19^19^3081022^
"KRN",8989.51,542,20,1,0)
Clinic Locations 
"KRN",8989.51,542,20,2,0)
                                 
"KRN",8989.51,542,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,542,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,542,20,5,0)
Location file.  
"KRN",8989.51,542,20,6,0)
                                 
"KRN",8989.51,542,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,542,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,542,20,9,0)
non-count clinic.  
"KRN",8989.51,542,20,10,0)
                                 
"KRN",8989.51,542,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,542,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,542,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,542,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,542,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,542,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,542,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,542,20,18,0)
                                 
"KRN",8989.51,542,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,542,30,0)
^8989.513I^2^2
"KRN",8989.51,542,30,1,0)
1^44
"KRN",8989.51,542,30,2,0)
2^4
"KRN",8989.51,543,-1)
0^36
"KRN",8989.51,543,0)
ORAM DEFAULT PILL STRENGTH^Default Pill Strength^0^^Default Pill Strength
"KRN",8989.51,543,1)
N^2:10:2^This is the default pill strength for your clinic (2-10 mg).
"KRN",8989.51,543,4,0)
^8989.514^2^2
"KRN",8989.51,543,4,1,0)
Anticoagulation
"KRN",8989.51,543,4,2,0)
Strength
"KRN",8989.51,543,4,"B","Anticoagulation",1)

"KRN",8989.51,543,4,"B","Strength",2)

"KRN",8989.51,543,20,0)
^^3^3^3090422^
"KRN",8989.51,543,20,1,0)
This is the default Pill Strength in milligrams for the Clinic in question
"KRN",8989.51,543,20,2,0)
(e.g., 2.5, 5, or 10). If you do not specify a pill strength, the program 
"KRN",8989.51,543,20,3,0)
will default to 5 mg.
"KRN",8989.51,543,30,0)
^8989.513I^1^1
"KRN",8989.51,543,30,1,0)
1^44
"KRN",8989.51,546,-1)
0^37
"KRN",8989.51,546,0)
ORAM INCL TIME W/NEXT INR DATE^Include Time with Next INR Date^0^^Include Time with Next INR
"KRN",8989.51,546,1)
S^0:None;1:Time of Day;2:Morning;3:Afternoon;4:Lab Procedures as Instructed^Will Time of Day be included with INR Draw Date?
"KRN",8989.51,546,20,0)
^^11^11^3090909^
"KRN",8989.51,546,20,1,0)
Please indicate whether time of day will be asked for, and/or included in
"KRN",8989.51,546,20,2,0)
the instructions in Patient Letters, when specifying the Return for INR
"KRN",8989.51,546,20,3,0)
Date.
"KRN",8989.51,546,20,4,0)
 
"KRN",8989.51,546,20,5,0)
The following values may be selected:
"KRN",8989.51,546,20,6,0)
        0 - None (i.e., no time of day will be asked or included)
"KRN",8989.51,546,20,7,0)
        1 - Time of Day (a specific time will be prompted for & included)
"KRN",8989.51,546,20,8,0)
        2 - Morning (pt. will be instructed to arrive in the morning)
"KRN",8989.51,546,20,9,0)
        3 - Afternoon (pt. will be instructed to arrive in the afternoon)
"KRN",8989.51,546,20,10,0)
        4 - Lab Procedures as Instructed (pt. will be instructed to
"KRN",8989.51,546,20,11,0)
              follow local lab procedures)
"KRN",8989.51,546,30,0)
^8989.513I^2^2
"KRN",8989.51,546,30,1,0)
1^44
"KRN",8989.51,546,30,2,0)
2^4
"KRN",8989.51,547,-1)
0^38
"KRN",8989.51,547,0)
ORAM TOLL FREE PHONE^Toll Free Phone Number^0^^Toll Free Phone Number
"KRN",8989.51,547,1)
F^4:25^Enter the toll free phone number for the clinic (e.g., 1-800-###-####)
"KRN",8989.51,547,2)
K:X'?4.25NAP X
"KRN",8989.51,547,20,0)
^^2^2^3090514^
"KRN",8989.51,547,20,1,0)
Toll free telephone number, for patient to contact the anticoagulation
"KRN",8989.51,547,20,2,0)
clinic. For patient letters.
"KRN",8989.51,547,30,0)
^8989.513I^2^2
"KRN",8989.51,547,30,1,0)
1^44
"KRN",8989.51,547,30,2,0)
2^4
"KRN",8989.51,578,-1)
0^39
"KRN",8989.51,578,0)
ORAM INR QUICK ORDER^INR Quick Order^^^INR Quick Order
"KRN",8989.51,578,1)
P^101.41:AEMQ^Select the Quick Order for INR.
"KRN",8989.51,578,3)
I $P($G(^ORD(101.41,+Y,0)),U,3)']""
"KRN",8989.51,578,20,0)
^^17^17^3090805^
"KRN",8989.51,578,20,1,0)
This is the reference to the Quick Order Dialog for the INR (International
"KRN",8989.51,578,20,2,0)
Normalized Ratio) for Prothrombin Times.
"KRN",8989.51,578,20,3,0)
                                 
"KRN",8989.51,578,20,4,0)
INR: International normalized ratio, a system established by the World
"KRN",8989.51,578,20,5,0)
Health Organization (WHO) and the International Committee on Thrombosis
"KRN",8989.51,578,20,6,0)
and Hemostasis for reporting the results of blood coagulation (clotting)
"KRN",8989.51,578,20,7,0)
tests. All results are standardized using the international sensitivity
"KRN",8989.51,578,20,8,0)
index for the particular thromboplastin reagent and instrument combination
"KRN",8989.51,578,20,9,0)
utilized to perform the test.
"KRN",8989.51,578,20,10,0)
                                 
"KRN",8989.51,578,20,11,0)
For example, a person taking the anticoagulant ("blood thinner") warfarin
"KRN",8989.51,578,20,12,0)
(brand name: Coumadin) might optimally maintain a prothrombin time (a "pro
"KRN",8989.51,578,20,13,0)
time" or PT) of 2 to 3 INR. No matter what laboratory checks the
"KRN",8989.51,578,20,14,0)
prothrombin time, the result should be the same even if different
"KRN",8989.51,578,20,15,0)
thromboplastins and instruments are used. This international
"KRN",8989.51,578,20,16,0)
standardization permits the patient on warfarin to travel and still obtain
"KRN",8989.51,578,20,17,0)
comparable test results.
"KRN",8989.51,578,30,0)
^8989.513I^1^1
"KRN",8989.51,578,30,1,0)
1^4
"KRN",8989.51,579,-1)
0^40
"KRN",8989.51,579,0)
ORAM CBC QUICK ORDER^CBC Quick Order^^^CBC Quick Order
"KRN",8989.51,579,1)
P^101.41:AEQM^Choose the Quick Order for CBC.
"KRN",8989.51,579,3)
I $P($G(^ORD(101.41,+Y,0)),U,3)']""
"KRN",8989.51,579,20,0)
^^2^2^3090805^
"KRN",8989.51,579,20,1,0)
This is the reference to the Quick Order Dialog for Complete Blood Count
"KRN",8989.51,579,20,2,0)
(CBC).
"KRN",8989.51,579,30,0)
^8989.513I^1^1
"KRN",8989.51,579,30,1,0)
1^4
"KRN",8989.51,584,-1)
0^42
"KRN",8989.51,584,0)
ORAM INDICATIONS FOR CARE^Indications for Care^1^Indication Text^ICD-9-CM Diagnosis
"KRN",8989.51,584,1)
P^80^Enter the current ICD-9-CM code for the Indicator.
"KRN",8989.51,584,3)
I +$$STATCHK^ICDAPIU($P($G(^ICD9(+Y,0)),U),DT)=1
"KRN",8989.51,584,6)
F^2:30^Please enter the text that will identify the Indicator
"KRN",8989.51,584,20,0)
^8989.512^1^1^3091112^^^^
"KRN",8989.51,584,20,1,0)
These are the Indications for care and their associated ICD-9-CM codes.
"KRN",8989.51,584,30,0)
^8989.513I^2^2
"KRN",8989.51,584,30,1,0)
1^4.2
"KRN",8989.51,584,30,2,0)
2^9.4
"KRN",8989.51,585,-1)
0^43
"KRN",8989.51,585,0)
ORAM AUTO PRIMARY INDICATION^Automatic Indication for Care^0^^Automatic Indication for Care (ICD-9)
"KRN",8989.51,585,1)
P^80:AEMQ^Enter the current ICD-9-CM code for the Indication.
"KRN",8989.51,585,3)
I +$$STATCHK^ICDAPIU($P($G(^ICD9(+Y,0)),U),DT)=1
"KRN",8989.51,585,6)
^^
"KRN",8989.51,585,20,0)
^8989.512^7^7^3091130^^
"KRN",8989.51,585,20,1,0)
This is an Indication for care which will automatically be filed as the 
"KRN",8989.51,585,20,2,0)
Primary Indication for each visit to the applicable Clinic.
"KRN",8989.51,585,20,3,0)
 
"KRN",8989.51,585,20,4,0)
(e.g., if all visits to a non-licensed provider should be filed with 
"KRN",8989.51,585,20,5,0)
V58.83 ENCTR THERAP DRUG MONITOR as the primary indication, you can
"KRN",8989.51,585,20,6,0)
specify that with this parameter, and the user will still be able to 
"KRN",8989.51,585,20,7,0)
select another indication from the list as the secondary indication).
"KRN",8989.51,585,30,0)
^8989.513I^2^2
"KRN",8989.51,585,30,1,0)
1^44
"KRN",8989.51,585,30,2,0)
2^9.4
"KRN",8989.51,627,-1)
0^45
"KRN",8989.51,627,0)
ORAM APPT MATCH LOOK-BACK^Look-back Days for Appointment Matching^0^^Look-back Days for Appointment Matching
"KRN",8989.51,627,1)
N^0:7^This is the inclusive lower limit (0-7 days) for appointment matching.
"KRN",8989.51,627,20,0)
^8989.512^9^9^3100114^^
"KRN",8989.51,627,20,1,0)
This is the whole number of days to look-back when attempting to match the
"KRN",8989.51,627,20,2,0)
Anticoagulation Encounter to a scheduled appointment in the VistA 
"KRN",8989.51,627,20,3,0)
Scheduling Package.
"KRN",8989.51,627,20,4,0)
 
"KRN",8989.51,627,20,5,0)
Please enter a number between 0 and 7, no decimal digits.
"KRN",8989.51,627,20,6,0)
 
"KRN",8989.51,627,20,7,0)
The default will be one (1) day (i.e., yesterday). A value of zero (0)
"KRN",8989.51,627,20,8,0)
will restrict the search to begin with today's appointments (i.e.,
"KRN",8989.51,627,20,9,0)
T@00:00).
"KRN",8989.51,627,30,0)
^8989.513I^2^2
"KRN",8989.51,627,30,1,0)
1^44
"KRN",8989.51,627,30,2,0)
2^4
"KRN",8989.51,628,-1)
0^44
"KRN",8989.51,628,0)
ORAM APPT MATCH LOOK-AHEAD^Look-ahead Days for Appointment Matching^0^^Look-ahead Days for Appointment Matching
"KRN",8989.51,628,1)
N^0:3^This is the inclusive upper limit (0-3 days) for appointment matching.
"KRN",8989.51,628,20,0)
^^8^8^3100114^
"KRN",8989.51,628,20,1,0)
This is the whole number of days to look-ahead (into the future) when
"KRN",8989.51,628,20,2,0)
attempting to match the Anticoagulation Encounter to a scheduled
"KRN",8989.51,628,20,3,0)
appointment in the VistA Scheduling Package.
"KRN",8989.51,628,20,4,0)
 
"KRN",8989.51,628,20,5,0)
Please enter a number between 0 and 3, no decimal digits.
"KRN",8989.51,628,20,6,0)
 
"KRN",8989.51,628,20,7,0)
The default will be one (1) day (i.e., tomorrow). A value of zero (0) will
"KRN",8989.51,628,20,8,0)
restrict the search to end with today's appointments (i.e., T@23:59).
"KRN",8989.51,628,30,0)
^8989.513I^2^2
"KRN",8989.51,628,30,1,0)
1^44
"KRN",8989.51,628,30,2,0)
2^4
"KRN",8989.52,115,-1)
0^2
"KRN",8989.52,115,0)
ORAM SITE PARAMETERS^Anticoagulation Site Params^4
"KRN",8989.52,115,10,0)
^8989.521IA^16^16
"KRN",8989.52,115,10,1,0)
10^ORAM MEDICAL CENTER NAME
"KRN",8989.52,115,10,2,0)
20^ORAM RAV FILE PATH
"KRN",8989.52,115,10,3,0)
30^ORAM INR QUICK ORDER
"KRN",8989.52,115,10,4,0)
40^ORAM CBC QUICK ORDER
"KRN",8989.52,115,10,5,0)
50^ORAM HCT/HGB REFERENCE
"KRN",8989.52,115,10,6,0)
60^ORAM INITIAL NOTE
"KRN",8989.52,115,10,7,0)
70^ORAM INTERIM NOTE
"KRN",8989.52,115,10,8,0)
80^ORAM DISCHARGE NOTE
"KRN",8989.52,115,10,9,0)
90^ORAM CPT FOR SIMPLE PHONE
"KRN",8989.52,115,10,10,0)
100^ORAM CPT FOR COMPLEX PHONE
"KRN",8989.52,115,10,11,0)
110^ORAM CPT FOR LETTER TO PT
"KRN",8989.52,115,10,12,0)
120^ORAM CPT FOR ORIENTATION
"KRN",8989.52,115,10,13,0)
130^ORAM CPT FOR INITIAL VISIT
"KRN",8989.52,115,10,14,0)
140^ORAM CPT FOR SUBSEQUENT VISIT
"KRN",8989.52,115,10,15,0)
150^ORAM DSS UNIT
"KRN",8989.52,115,10,16,0)
160^ORAM DSS ID
"KRN",8989.52,116,-1)
0^1
"KRN",8989.52,116,0)
ORAM CLINIC PARAMETERS^Anticoagulation Clinic Params^44
"KRN",8989.52,116,10,0)
^8989.521IA^29^29
"KRN",8989.52,116,10,1,0)
10^ORAM TEAM LIST (ALL)
"KRN",8989.52,116,10,2,0)
20^ORAM TEAM LIST (COMPLEX)
"KRN",8989.52,116,10,3,0)
30^ORAM ADDRESS LINE 1
"KRN",8989.52,116,10,4,0)
40^ORAM ADDRESS LINE 2
"KRN",8989.52,116,10,5,0)
50^ORAM ADDRESS LINE 3
"KRN",8989.52,116,10,6,0)
60^ORAM CLINIC PHONE NUMBER
"KRN",8989.52,116,10,7,0)
70^ORAM CLINIC FAX NUMBER
"KRN",8989.52,116,10,8,0)
80^ORAM POINT OF CONTACT NAME
"KRN",8989.52,116,10,9,0)
90^ORAM SIGNATURE BLOCK NAME
"KRN",8989.52,116,10,10,0)
100^ORAM SIGNATURE BLOCK TITLE
"KRN",8989.52,116,10,11,0)
110^ORAM CONSULT LINK ENABLED
"KRN",8989.52,116,10,12,0)
120^ORAM CONSULT REQUEST SERVICE
"KRN",8989.52,116,10,13,0)
130^ORAM PCE LINK ENABLED
"KRN",8989.52,116,10,14,0)
140^ORAM VISIT LOCATION
"KRN",8989.52,116,10,15,0)
5^ORAM CLINIC NAME
"KRN",8989.52,116,10,16,0)
150^ORAM PHONE CLINIC
"KRN",8989.52,116,10,17,0)
160^ORAM NON-COUNT LOCATION
"KRN",8989.52,116,10,18,0)
170^ORAM DEFAULT PILL STRENGTH
"KRN",8989.52,116,10,19,0)
75^ORAM TOLL FREE PHONE
"KRN",8989.52,116,10,20,0)
175^ORAM INCL TIME W/NEXT INR DATE
"KRN",8989.52,116,10,21,0)
131^ORAM CPT FOR SIMPLE PHONE
"KRN",8989.52,116,10,22,0)
132^ORAM CPT FOR COMPLEX PHONE
"KRN",8989.52,116,10,23,0)
133^ORAM CPT FOR LETTER TO PT
"KRN",8989.52,116,10,24,0)
134^ORAM CPT FOR ORIENTATION
"KRN",8989.52,116,10,25,0)
135^ORAM CPT FOR INITIAL VISIT
"KRN",8989.52,116,10,26,0)
136^ORAM CPT FOR SUBSEQUENT VISIT
"KRN",8989.52,116,10,27,0)
130.5^ORAM AUTO PRIMARY INDICATION
"KRN",8989.52,116,10,28,0)
180^ORAM APPT MATCH LOOK-BACK
"KRN",8989.52,116,10,29,0)
185^ORAM APPT MATCH LOOK-AHEAD
"KRN",8994,3164,-1)
0^11
"KRN",8994,3164,0)
ORAM1 COMPTEST^COMPTEST^ORAM1^1^P^0^^0
"KRN",8994,3164,1,0)
^^1^1^3090113^
"KRN",8994,3164,1,1,0)
Files complications for the current flowsheet entry.
"KRN",8994,3164,2,0)
^8994.02A^1^1
"KRN",8994,3164,2,1,0)
COMMARR^2^^^1
"KRN",8994,3164,2,"B","COMMARR",1)

"KRN",8994,3164,2,"PARAMSEQ",1,1)

"KRN",8994,3165,-1)
0^20
"KRN",8994,3165,0)
ORAM1 PTENTER^PTENTER^ORAM1^1^P^0^^0
"KRN",8994,3165,1,0)
^^1^1^3090113^
"KRN",8994,3165,1,1,0)
Adds a new patient to the Anticoagulation Flowsheet file (#103).
"KRN",8994,3165,2,0)
^8994.02A^1^1
"KRN",8994,3165,2,1,0)
DFN^1^^^1
"KRN",8994,3165,2,"B","DFN",1)

"KRN",8994,3165,2,"PARAMSEQ",1,1)

"KRN",8994,3166,-1)
0^13
"KRN",8994,3166,0)
ORAM1 FLOWTT^FLOWTT^ORAM1^2^P^0^^0
"KRN",8994,3166,1,0)
^^1^1^3090113^
"KRN",8994,3166,1,1,0)
Retrieves flowsheet data for the current patient.
"KRN",8994,3166,2,0)
^8994.02A^1^1
"KRN",8994,3166,2,1,0)
DFN^1^^^1
"KRN",8994,3166,2,"B","DFN",1)

"KRN",8994,3166,2,"PARAMSEQ",1,1)

"KRN",8994,3167,-1)
0^18
"KRN",8994,3167,0)
ORAM1 PCGOAL^PCGOAL^ORAM1^1^P^0^^0
"KRN",8994,3167,1,0)
^^3^3^3090113^
"KRN",8994,3167,1,1,0)
Calculates percent in goal from filed INR entries for Anticoagulation
"KRN",8994,3167,1,2,0)
Management patients - can do either Stable or all patients (pass 1 as 
"KRN",8994,3167,1,3,0)
second parameter for stable).
"KRN",8994,3167,2,0)
^8994.02A^2^2
"KRN",8994,3167,2,1,0)
DFN^1^^^1
"KRN",8994,3167,2,2,0)
CMPLX^1^^^2
"KRN",8994,3167,2,2,1,0)
^8994.021^2^2^3090113^^
"KRN",8994,3167,2,2,1,1,0)
OPTIONAL,  IF MISSING, CLACULATES ON ALL VISITS; IF 1 ONLY CALCULATES ON 
"KRN",8994,3167,2,2,1,2,0)
NON-COMPLX VISITS
"KRN",8994,3167,2,"B","CMPLX",2)

"KRN",8994,3167,2,"B","DFN",1)

"KRN",8994,3167,2,"PARAMSEQ",1,1)

"KRN",8994,3167,2,"PARAMSEQ",2,2)

"KRN",8994,3168,-1)
0^9
"KRN",8994,3168,0)
ORAM1 ACDATA^ACDATA^ORAM1^2^P^0^^0
"KRN",8994,3168,1,0)
^8994.01^2^2^3090113^^
"KRN",8994,3168,1,1,0)
Retrieves record header information (e.g., indication for treatment,
"KRN",8994,3168,1,2,0)
permissions, risks, goals, etc.) for the current patient.
"KRN",8994,3168,2,0)
^8994.02A^1^1
"KRN",8994,3168,2,1,0)
DFN^1^^^1
"KRN",8994,3168,2,"B","DFN",1)

"KRN",8994,3168,2,"PARAMSEQ",1,1)

"KRN",8994,3169,-1)
0^10
"KRN",8994,3169,0)
ORAM1 ADDTOP^ADDTOP^ORAM1^1^P^0^^0
"KRN",8994,3169,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3169,1,1,0)
Files record header information for the current patient and care episode.
"KRN",8994,3169,2,0)
^8994.02A^1^1
"KRN",8994,3169,2,1,0)
TOPARR^2^^^1
"KRN",8994,3169,2,"B","TOPARR",1)

"KRN",8994,3169,2,"PARAMSEQ",1,1)

"KRN",8994,3170,-1)
0^15
"KRN",8994,3170,0)
ORAM1 LOCK^LOCK^ORAM1^1^P^0^^0
"KRN",8994,3170,1,0)
^^2^2^3090113^
"KRN",8994,3170,1,1,0)
Sets lock in Anticoagulation Flowsheet file (#103) so that only one person
"KRN",8994,3170,1,2,0)
can edit a given patient's record at a time.
"KRN",8994,3170,2,0)
^8994.02A^1^1
"KRN",8994,3170,2,1,0)
DATA^1^^^1
"KRN",8994,3170,2,"B","DATA",1)

"KRN",8994,3170,2,"PARAMSEQ",1,1)

"KRN",8994,3170,3,0)
^^1^1^3050415^
"KRN",8994,3170,3,1,0)
DFN^DUZ
"KRN",8994,3171,-1)
0^16
"KRN",8994,3171,0)
ORAM1 LOG^LOGIT^ORAM1^1^P^0^^0
"KRN",8994,3171,1,0)
^^1^1^3090113^
"KRN",8994,3171,1,1,0)
Updates Anticoagulation Flowsheet file (#103) and adds log entry.
"KRN",8994,3171,2,0)
^8994.02A^2^2
"KRN",8994,3171,2,1,0)
FSARRAY^2^^^1
"KRN",8994,3171,2,2,0)
COMP^1^^^2
"KRN",8994,3171,2,2,1,0)
^8994.021^4^4^3090113^^
"KRN",8994,3171,2,2,1,1,0)
COMP=0 Will remove this entry's complication indication code (instead of
"KRN",8994,3171,2,2,1,2,0)
1= Major Bleed, 2=Clot, 3=Minor Bleed), the original complicatons will 
"KRN",8994,3171,2,2,1,3,0)
stay in the file, but they will no longer be visible or considered in 
"KRN",8994,3171,2,2,1,4,0)
reports based on the COMPLICATION code (104).
"KRN",8994,3171,2,"B","COMP",2)

"KRN",8994,3171,2,"B","FSARRAY",1)

"KRN",8994,3171,2,"PARAMSEQ",1,1)

"KRN",8994,3171,2,"PARAMSEQ",2,2)

"KRN",8994,3172,-1)
0^17
"KRN",8994,3172,0)
ORAM1 OUTINR^OUTINR^ORAM1^2^P^0^^0
"KRN",8994,3172,1,0)
^^2^2^3090113^
"KRN",8994,3172,1,1,0)
Receives outside INR values and returns value^date (in $H format) for 
"KRN",8994,3172,1,2,0)
graphing.
"KRN",8994,3172,2,0)
^8994.02A^1^1
"KRN",8994,3172,2,1,0)
INRSTRING^1^^^1
"KRN",8994,3172,2,"B","INRSTRING",1)

"KRN",8994,3172,2,"PARAMSEQ",1,1)

"KRN",8994,3174,-1)
0^19
"KRN",8994,3174,0)
ORAM1 PTCHECK^PTCHECK^ORAM1^1^P^0^^0
"KRN",8994,3174,1,0)
^^2^2^3090113^
"KRN",8994,3174,1,1,0)
Boolean RPC. Checks to see if patient is in Anticoagulation Flowsheet file
"KRN",8994,3174,1,2,0)
(#103).
"KRN",8994,3174,2,0)
^8994.02A^1^1
"KRN",8994,3174,2,1,0)
DFN^1^^^1
"KRN",8994,3174,2,"B","DFN",1)

"KRN",8994,3174,2,"PARAMSEQ",1,1)

"KRN",8994,3175,-1)
0^14
"KRN",8994,3175,0)
ORAM1 GETPT^GETPT^ORAM1^2^P^0^^0
"KRN",8994,3175,1,0)
^^1^1^3090113^
"KRN",8994,3175,1,1,0)
Returns list of patients from Anticoagulation Flowsheet file (#103).
"KRN",8994,3176,-1)
0^21
"KRN",8994,3176,0)
ORAM1 TERASE^TERASE^ORAM1^1^P^0^^0
"KRN",8994,3176,1,0)
^^1^1^3090113^
"KRN",8994,3176,1,1,0)
Removes a patient from the Anticoagulation Team List.
"KRN",8994,3176,2,0)
^8994.02A^2^2
"KRN",8994,3176,2,1,0)
DFN^1^^^1
"KRN",8994,3176,2,2,0)
COMP^1^^^2
"KRN",8994,3176,2,"B","COMP",2)

"KRN",8994,3176,2,"B","DFN",1)

"KRN",8994,3176,2,"PARAMSEQ",1,1)

"KRN",8994,3176,2,"PARAMSEQ",2,2)

"KRN",8994,3177,-1)
0^22
"KRN",8994,3177,0)
ORAM1 UNLOCK^UNLOCK^ORAM1^1^P^0^^0
"KRN",8994,3177,1,0)
^^1^1^3090113^
"KRN",8994,3177,1,1,0)
Unlocks a patient's record in the Anticoagulation Flowsheet file (#103).
"KRN",8994,3177,2,0)
^8994.02A^1^1
"KRN",8994,3177,2,1,0)
DFN^1^^^1
"KRN",8994,3177,2,"B","DFN",1)

"KRN",8994,3177,2,"PARAMSEQ",1,1)

"KRN",8994,3178,-1)
0^24
"KRN",8994,3178,0)
ORAM2 NOACT^NOACT^ORAM2^2^P^0^^0
"KRN",8994,3178,1,0)
^^2^2^3090113^
"KRN",8994,3178,1,1,0)
Checks Anticoagulation Flowsheet file (#103) for patients not seen within
"KRN",8994,3178,1,2,0)
the user-specified number of days.
"KRN",8994,3178,2,0)
^8994.02A^1^1
"KRN",8994,3178,2,1,0)
DAYS^1^^^1
"KRN",8994,3178,2,"B","DAYS",1)

"KRN",8994,3178,2,"PARAMSEQ",1,1)

"KRN",8994,3179,-1)
0^27
"KRN",8994,3179,0)
ORAM2 SHOWRATE^SHOWRATE^ORAM2^1^P^0^^0
"KRN",8994,3179,1,0)
^^2^2^3090113^
"KRN",8994,3179,1,1,0)
Returns percentage of visits in which the patient was on time or within
"KRN",8994,3179,1,2,0)
one day (before or after) scheduled draw date.
"KRN",8994,3179,2,0)
^8994.02A^1^1
"KRN",8994,3179,2,1,0)
DFN^1^^^1
"KRN",8994,3179,2,"B","DFN",1)

"KRN",8994,3179,2,"PARAMSEQ",1,1)

"KRN",8994,3180,-1)
0^25
"KRN",8994,3180,0)
ORAM2 PTAPPT^PTAPPT^ORAM2^2^P^0^^0
"KRN",8994,3180,1,0)
^^2^2^3090113^
"KRN",8994,3180,1,1,0)
Returns the number of patients scheduled in the Anticoagulation clinic per
"KRN",8994,3180,1,2,0)
day for the next 30 days.  Only days with appointments are displayed.
"KRN",8994,3181,-1)
0^26
"KRN",8994,3181,0)
ORAM2 REMIND^REMIND^ORAM2^1^P^0^^0
"KRN",8994,3181,1,0)
^^2^2^3090113^
"KRN",8994,3181,1,1,0)
Sets date and text for ACM Reminder (can also be set as part of a complete
"KRN",8994,3181,1,2,0)
visit entry).
"KRN",8994,3181,2,0)
^8994.02A^3^3
"KRN",8994,3181,2,1,0)
DFN^1^^^1
"KRN",8994,3181,2,2,0)
DATE^1^^^2
"KRN",8994,3181,2,2,1,0)
^^2^2^3080925^
"KRN",8994,3181,2,2,1,1,0)
Date the patient specific reminder that will start appearing when the
"KRN",8994,3181,2,2,1,2,0)
ANTICOAGULATOR is accessed.
"KRN",8994,3181,2,3,0)
RTEXT^1^^^3
"KRN",8994,3181,2,3,1,0)
^8994.021^1^1^3090113^^
"KRN",8994,3181,2,3,1,1,0)
Actual carrot ('^') deliminated text (by line) of the reminder.
"KRN",8994,3181,2,"B","DATE",2)

"KRN",8994,3181,2,"B","DFN",1)

"KRN",8994,3181,2,"B","RTEXT",3)

"KRN",8994,3181,2,"PARAMSEQ",1,1)

"KRN",8994,3181,2,"PARAMSEQ",2,2)

"KRN",8994,3181,2,"PARAMSEQ",3,3)

"KRN",8994,3182,-1)
0^28
"KRN",8994,3182,0)
ORAM2 TEAMCHK^TEAMCHK^ORAM2^2^P^0^^0
"KRN",8994,3182,1,0)
^^2^2^3090113^
"KRN",8994,3182,1,1,0)
Checks list of teams to be sure they are in the OE/RR LIST file (#100.21),
"KRN",8994,3182,1,2,0)
and returns the IEN and Clinic Name.
"KRN",8994,3182,2,0)
^8994.02A^1^1
"KRN",8994,3182,2,1,0)
TEAMS^2^^^1
"KRN",8994,3182,2,"B","TEAMS",1)

"KRN",8994,3182,2,"PARAMSEQ",1,1)

"KRN",8994,3183,-1)
0^23
"KRN",8994,3183,0)
ORAM2 ALLGOAL^ALLGOAL^ORAM2^2^P^0^^0
"KRN",8994,3183,1,0)
^8994.01^2^2^3091211^^^
"KRN",8994,3183,1,1,0)
Returns the percentage of patients in the Anticoagulation Flowsheet file
"KRN",8994,3183,1,2,0)
(#103) whose last INRs (within the specified number of days) were in-goal.
"KRN",8994,3183,2,0)
^8994.02A^2^2
"KRN",8994,3183,2,1,0)
DAYS^1^^^1
"KRN",8994,3183,2,1,1,0)
^8994.021^1^1^3091211^^^
"KRN",8994,3183,2,1,1,1,0)
NUMBER OF DAYS BACK TO INCLUDE A PT VISIT
"KRN",8994,3183,2,2,0)
CLINIC^1^^^2
"KRN",8994,3183,2,2,1,0)
^^1^1^3091211^
"KRN",8994,3183,2,2,1,1,0)
IEN of Clinic in Hospital Location File.
"KRN",8994,3183,2,"B","CLINIC",2)

"KRN",8994,3183,2,"B","DAYS",1)

"KRN",8994,3183,2,"PARAMSEQ",1,1)

"KRN",8994,3183,2,"PARAMSEQ",2,2)

"KRN",8994,3183,3,0)
^8994.03^1^1^3091211^^^
"KRN",8994,3183,3,1,0)
RETURNS A DELIMINITED LIST OF THOSE PT'S OUT OF RANGE ON THEIR LAST VISIT.
"KRN",8994,3184,-1)
0^31
"KRN",8994,3184,0)
ORAM3 PTADR^PTADR^ORAM3^1^P^0^^0
"KRN",8994,3184,1,0)
^^2^2^3090113^
"KRN",8994,3184,1,1,0)
Retrieves contact information. Will also check for active temporary 
"KRN",8994,3184,1,2,0)
information.
"KRN",8994,3184,2,0)
^8994.02A^1^1
"KRN",8994,3184,2,1,0)
DFN^1^^^1
"KRN",8994,3184,2,"B","DFN",1)

"KRN",8994,3184,2,"PARAMSEQ",1,1)

"KRN",8994,3185,-1)
0^29
"KRN",8994,3185,0)
ORAM3 COMPENT^COMPENT^ORAM3^1^P^0^^0
"KRN",8994,3185,1,0)
^^2^2^3090113^
"KRN",8994,3185,1,1,0)
Enters complication note into the Anticoagulation Flowsheet file (#103).
"KRN",8994,3185,1,2,0)
Can also be entered as part of a complete visit entry.
"KRN",8994,3185,2,0)
^8994.02A^5^5
"KRN",8994,3185,2,1,0)
DFN^1^^^1
"KRN",8994,3185,2,2,0)
DUZ^1^^^2
"KRN",8994,3185,2,3,0)
CCODE^1^^^3
"KRN",8994,3185,2,3,1,0)
^^1^1^3080918^
"KRN",8994,3185,2,3,1,1,0)
CODE TO NOTE IF COMPLICATION IS MAJOR, MINOR OR BOTH
"KRN",8994,3185,2,4,0)
CTEXT^1^^^4
"KRN",8994,3185,2,4,1,0)
^^1^1^3080918^
"KRN",8994,3185,2,4,1,1,0)
Carroted ('^') string of complication types/comments
"KRN",8994,3185,2,5,0)
CDATE^1^^^5
"KRN",8994,3185,2,5,1,0)
^8994.021^4^4^3090113^^
"KRN",8994,3185,2,5,1,1,0)
'ENGLISH' DATE OF THE COMPLICATION;
"KRN",8994,3185,2,5,1,2,0)
This is the date for the flow sheet to put the, probably historic, entry 
"KRN",8994,3185,2,5,1,3,0)
in the proper order in the flow sheet.  DATE/TIME stamp is in the file, 
"KRN",8994,3185,2,5,1,4,0)
but not visible in the flow sheet.
"KRN",8994,3185,2,"B","CCODE",3)

"KRN",8994,3185,2,"B","CDATE",5)

"KRN",8994,3185,2,"B","CTEXT",4)

"KRN",8994,3185,2,"B","DFN",1)

"KRN",8994,3185,2,"B","DUZ",2)

"KRN",8994,3185,2,"PARAMSEQ",1,1)

"KRN",8994,3185,2,"PARAMSEQ",2,2)

"KRN",8994,3185,2,"PARAMSEQ",3,3)

"KRN",8994,3185,2,"PARAMSEQ",4,4)

"KRN",8994,3185,2,"PARAMSEQ",5,5)

"KRN",8994,3185,3,0)
^^1^1^3080918^
"KRN",8994,3185,3,1,0)
Returns a 1 if filed.
"KRN",8994,3187,-1)
0^32
"KRN",8994,3187,0)
ORAM3 PTFONE^PTFONE^ORAM3^1^P^0^^0
"KRN",8994,3187,1,0)
^^1^1^3090113^
"KRN",8994,3187,1,1,0)
Gets home phone^work phone for the patient in question.
"KRN",8994,3187,2,0)
^8994.02A^1^1
"KRN",8994,3187,2,1,0)
DFN^1^^^1
"KRN",8994,3187,2,"B","DFN",1)

"KRN",8994,3187,2,"PARAMSEQ",1,1)

"KRN",8994,3188,-1)
0^1
"KRN",8994,3188,0)
ORAM CONCOMP^CONCOMP^ORAM^1^P^0^^0
"KRN",8994,3188,1,0)
^8994.01^2^2^3090113^^
"KRN",8994,3188,1,1,0)
Receives the Consult Number, the note number and the DUZ; completes the
"KRN",8994,3188,1,2,0)
consult with the note.
"KRN",8994,3188,2,0)
^8994.02A^3^3
"KRN",8994,3188,2,1,0)
ORAMCNUM^1^^^1
"KRN",8994,3188,2,2,0)
ORAMNUM^1^^^2
"KRN",8994,3188,2,3,0)
DUZ^1^^^3
"KRN",8994,3188,2,"B","DUZ",3)

"KRN",8994,3188,2,"B","ORAMCNUM",1)

"KRN",8994,3188,2,"B","ORAMNUM",2)

"KRN",8994,3188,2,"PARAMSEQ",1,1)

"KRN",8994,3188,2,"PARAMSEQ",2,2)

"KRN",8994,3188,2,"PARAMSEQ",3,3)

"KRN",8994,3189,-1)
0^33
"KRN",8994,3189,0)
ORAMSET GET^GET^ORAMSET^2^P^0^^0
"KRN",8994,3189,1,0)
^8994.01^2^2^3090306^^^
"KRN",8994,3189,1,1,0)
Returns the Anticoagulation Manager parameters for the division which the
"KRN",8994,3189,1,2,0)
user is logged into.
"KRN",8994,3189,2,0)
^8994.02A^^0
"KRN",8994,3189,3,0)
^8994.03^3^3^3090306^^^^
"KRN",8994,3189,3,1,0)
SITE NAME^PATIENT LIST ALL #^PT LIST COMPLEX #^START NOTE^INTERIM 
"KRN",8994,3189,3,2,0)
NOTE^D/C NOTE^SIMPLE PHONE PCE CODE^MOD PHONE^ COMPLEX PHONE^CLASS 
"KRN",8994,3189,3,3,0)
ORIENTATIN CODE^OFFICE VISIT CODE^CONSUL LINKER Y/N^PCE Y/N
"KRN",8994,3190,-1)
0^2
"KRN",8994,3190,0)
ORAM HCT^HCT^ORAM^1^P^0^^0
"KRN",8994,3190,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3190,1,1,0)
Returns the patient's most recent Hematocrit (HCT).
"KRN",8994,3190,2,0)
^8994.02A^1^1
"KRN",8994,3190,2,1,0)
DFN^1^^^1
"KRN",8994,3190,2,"B","DFN",1)

"KRN",8994,3190,2,"PARAMSEQ",1,1)

"KRN",8994,3190,3,0)
^^2^2^3050415^
"KRN",8994,3190,3,1,0)
RETURNS
"KRN",8994,3190,3,2,0)
MOST RECENT HCT^DATE^DIFFERENCE BETWEN THIS VALUE AND LAST FLOWSHEET HCT
"KRN",8994,3191,-1)
0^3
"KRN",8994,3191,0)
ORAM INR^INR^ORAM^2^P^0^^0
"KRN",8994,3191,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3191,1,1,0)
Returns last 6 months of INR values and dates.
"KRN",8994,3191,2,0)
^8994.02A^1^1
"KRN",8994,3191,2,1,0)
DFN^1^^^1
"KRN",8994,3191,2,"B","DFN",1)

"KRN",8994,3191,2,"PARAMSEQ",1,1)

"KRN",8994,3191,3,0)
^^3^3^3050415^
"KRN",8994,3191,3,1,0)
ARRAY OF
"KRN",8994,3191,3,2,0)
INR^DATE
"KRN",8994,3191,3,3,0)
FOR LAST 180 DAYS
"KRN",8994,3194,-1)
0^6
"KRN",8994,3194,0)
ORAM PATIENT^PATIENT^ORAM^1^P^0^^0
"KRN",8994,3194,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3194,1,1,0)
Returns the requested patient's Name, Gender, SSN, and Inpatient Status.
"KRN",8994,3194,2,0)
^8994.02A^1^1
"KRN",8994,3194,2,1,0)
DFN^1^^^1
"KRN",8994,3194,2,"B","DFN",1)

"KRN",8994,3194,2,"PARAMSEQ",1,1)

"KRN",8994,3194,3,0)
^8994.03^2^2^3060314^^
"KRN",8994,3194,3,1,0)
RETURNS
"KRN",8994,3194,3,2,0)
DFN^NAME^GENDER^CURRENT ADM
"KRN",8994,3195,-1)
0^7
"KRN",8994,3195,0)
ORAM PROVIDER^PROVIDER^ORAM^1^P^0^^0
"KRN",8994,3195,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3195,1,1,0)
Returns provider DUZ and name.
"KRN",8994,3196,-1)
0^8
"KRN",8994,3196,0)
ORAM SIGCHECK^SIGCHECK^ORAM^1^P^0^^0
"KRN",8994,3196,1,0)
^8994.01^1^1^3090113^^
"KRN",8994,3196,1,1,0)
Validates the Electronic Signature Code entered by the user.
"KRN",8994,3196,2,0)
^8994.02A^1^1
"KRN",8994,3196,2,1,0)
ESCODE^1^^^1
"KRN",8994,3196,2,"B","ESCODE",1)

"KRN",8994,3196,2,"PARAMSEQ",1,1)

"KRN",8994,3197,-1)
0^34
"KRN",8994,3197,0)
ORAMX CONSULT^CONSULT^ORAMX^2^P^0^^0
"KRN",8994,3197,1,0)
^^3^3^3090113^
"KRN",8994,3197,1,1,0)
Send DFN and the name of the Consult Service (from the ORAM CONSULT 
"KRN",8994,3197,1,2,0)
REQUEST SERVICE parameter). Returns pending and active consults which meet
"KRN",8994,3197,1,3,0)
those criteria.
"KRN",8994,3197,2,0)
^8994.02A^2^2
"KRN",8994,3197,2,1,0)
DFN^1^^^1
"KRN",8994,3197,2,2,0)
CNAME^1^^^2
"KRN",8994,3197,2,"B","CNAME",2)

"KRN",8994,3197,2,"B","DFN",1)

"KRN",8994,3197,2,"PARAMSEQ",1,1)

"KRN",8994,3197,2,"PARAMSEQ",2,2)

"KRN",8994,3199,-1)
0^35
"KRN",8994,3199,0)
ORAMX PCESET^PCESET^ORAMX^1^P^0^^0
"KRN",8994,3199,1,0)
^^1^1^3090224^
"KRN",8994,3199,1,1,0)
Checks for service connection, etc, for PCE data call or files PCE data.
"KRN",8994,3199,2,0)
^8994.02A^3^3
"KRN",8994,3199,2,1,0)
DFN^1^^^1
"KRN",8994,3199,2,1,1,0)
^^1^1^3090224^
"KRN",8994,3199,2,1,1,1,0)
The IEN of the Patient in the Patient File (#2).
"KRN",8994,3199,2,2,0)
DATA1^1^^^2
"KRN",8994,3199,2,2,1,0)
^^1^1^3090224^
"KRN",8994,3199,2,2,1,1,0)
Data string from the Anticoagulation Management Program.
"KRN",8994,3199,2,3,0)
HOSLOC^1^^^3
"KRN",8994,3199,2,3,1,0)
^^1^1^3090224^
"KRN",8994,3199,2,3,1,1,0)
Visit location from the Hospital Location File.
"KRN",8994,3199,2,"B","DATA1",2)

"KRN",8994,3199,2,"B","DFN",1)

"KRN",8994,3199,2,"B","HOSLOC",3)

"KRN",8994,3199,2,"PARAMSEQ",1,1)

"KRN",8994,3199,2,"PARAMSEQ",2,2)

"KRN",8994,3199,2,"PARAMSEQ",3,3)

"KRN",8994,3199,3,0)
^^5^5^3090224^
"KRN",8994,3199,3,1,0)
If checking Service Connection/Exposures, returns in this format:
"KRN",8994,3199,3,2,0)
 
"KRN",8994,3199,3,3,0)
 SCSEL|SC^1^0|AO^0^|IR^1^0|EC^1^1|MST^1^0|HNC^0^|CV^0^"
"KRN",8994,3199,3,4,0)
 
"KRN",8994,3199,3,5,0)
'1' indicates that an answer is needed from the provider.
"KRN",8994,3200,-1)
0^36
"KRN",8994,3200,0)
ORAMSET GETCLINS^GETCLINS^ORAMSET^2^S^^^0
"KRN",8994,3200,1,0)
^^2^2^3090306^
"KRN",8994,3200,1,1,0)
This RPC fetches the list of Clinic Names from the configuration of the 
"KRN",8994,3200,1,2,0)
Anticoagulation Management Application.
"KRN",8994,3200,3,0)
^^8^8^3090306^
"KRN",8994,3200,3,1,0)
Returns an array in the following format:
"KRN",8994,3200,3,2,0)
 
"KRN",8994,3200,3,3,0)
RESULT(1)="SLC - Anticoagulation^384;SC("
"KRN",8994,3200,3,4,0)
RESULT(2)="POC - Anticoagulation^386;SC("
"KRN",8994,3200,3,5,0)
RESULT(3)="Ely - Anticoagulation^388;SC("
"KRN",8994,3200,3,6,0)
 
"KRN",8994,3200,3,7,0)
where ^-piece 1 = Clinic Name, and
"KRN",8994,3200,3,8,0)
      ^-piece 2 = Variable pointer to file 44 (Hospital Location)
"KRN",8994,3299,-1)
0^37
"KRN",8994,3299,0)
ORAM ORDER^ORDER^ORAM^1^S^^^0
"KRN",8994,3299,1,0)
^^2^2^3090807^
"KRN",8994,3299,1,1,0)
This RPC supports placing INR and CBC orders from the Anticoagulator 
"KRN",8994,3299,1,2,0)
application.
"KRN",8994,3299,2,0)
^8994.02A^5^5
"KRN",8994,3299,2,1,0)
DFN^1^^1^1
"KRN",8994,3299,2,1,1,0)
^^1^1^3090807^
"KRN",8994,3299,2,1,1,1,0)
This is the patient id (i.e., the entry number of the patient in file 2).
"KRN",8994,3299,2,2,0)
ORDOC^1^^1^2
"KRN",8994,3299,2,2,1,0)
^^1^1^3090807^
"KRN",8994,3299,2,2,1,1,0)
This is the ID of the ordering provider in file 200 (i.e., his "DUZ").
"KRN",8994,3299,2,3,0)
ORQO^1^^1^3
"KRN",8994,3299,2,3,1,0)
^^2^2^3090807^
"KRN",8994,3299,2,3,1,1,0)
This is the internal entry number of the Quick Order to be placed (for 
"KRN",8994,3299,2,3,1,2,0)
either INR or CBC) in the Order Dialog file #101.41.
"KRN",8994,3299,2,4,0)
ORLOC^1^^1^4
"KRN",8994,3299,2,4,1,0)
^^2^2^3090807^
"KRN",8994,3299,2,4,1,1,0)
This is the internal entry number of the ordering location in the 
"KRN",8994,3299,2,4,1,2,0)
Hospital Location file (#42).
"KRN",8994,3299,2,5,0)
ORCDT^1^^1^5
"KRN",8994,3299,2,5,1,0)
^^2^2^3090807^
"KRN",8994,3299,2,5,1,1,0)
This is the expected Collection Date/Time of the lab test being ordered, 
"KRN",8994,3299,2,5,1,2,0)
in external date/time format.
"KRN",8994,3299,2,"B","DFN",1)

"KRN",8994,3299,2,"B","ORCDT",5)

"KRN",8994,3299,2,"B","ORDOC",2)

"KRN",8994,3299,2,"B","ORLOC",4)

"KRN",8994,3299,2,"B","ORQO",3)

"KRN",8994,3299,2,"PARAMSEQ",1,1)

"KRN",8994,3299,2,"PARAMSEQ",2,2)

"KRN",8994,3299,2,"PARAMSEQ",3,3)

"KRN",8994,3299,2,"PARAMSEQ",4,4)

"KRN",8994,3299,2,"PARAMSEQ",5,5)

"KRN",8994,3308,-1)
0^38
"KRN",8994,3308,0)
ORAMSET INDICS^INDICS^ORAMSET^2^S
"KRN",8994,3308,1,0)
^8994.01^2^2^3091112^^
"KRN",8994,3308,1,1,0)
This call populates the list of selectable indications for 
"KRN",8994,3308,1,2,0)
Anticoagulation therapy.
"KRN",8994,3308,3,0)
^8994.03^15^15^3091112^^
"KRN",8994,3308,3,1,0)
The call returns the list of indications defined for the Clinic -> 
"KRN",8994,3308,3,2,0)
Division -> Package (in that precedence) as Name^Value pairs. The default
"KRN",8994,3308,3,3,0)
list (i.e., where Entity = Package) is:
"KRN",8994,3308,3,4,0)
 
"KRN",8994,3308,3,5,0)
RESULT=10
"KRN",8994,3308,3,6,0)
RESULT(1)="A Fib^427.31"
"KRN",8994,3308,3,7,0)
RESULT(2)="A Flutter^427.32"
"KRN",8994,3308,3,8,0)
RESULT(3)="CVA^436."
"KRN",8994,3308,3,9,0)
RESULT(4)="DVT^453.89"
"KRN",8994,3308,3,10,0)
RESULT(5)="Hypercoag State^289.81"
"KRN",8994,3308,3,11,0)
RESULT(6)="L/T (Current) Anticoag Use^V58.61"
"KRN",8994,3308,3,12,0)
RESULT(7)="PE^415.19"
"KRN",8994,3308,3,13,0)
RESULT(8)="TIA^435.9"
"KRN",8994,3308,3,14,0)
RESULT(9)="Valve-Mech^V43.3"
"KRN",8994,3308,3,15,0)
RESULT(10)="Valve-Tissue^V42.2"
"KRN",8994,3354,-1)
0^39
"KRN",8994,3354,0)
ORAM APPTMTCH^APPTMTCH^ORAM^1^S
"KRN",8994,3354,1,0)
^^2^2^3100115^
"KRN",8994,3354,1,1,0)
This RPC supports revision of the appointment match when the user selects 
"KRN",8994,3354,1,2,0)
a new Clinic in Anticoagulator.
"KRN",8994,3354,2,0)
^8994.02A^2^2
"KRN",8994,3354,2,1,0)
ORAMDFN^1^^1^1
"KRN",8994,3354,2,1,1,0)
^^1^1^3100115^
"KRN",8994,3354,2,1,1,1,0)
Patient ID.
"KRN",8994,3354,2,2,0)
ORAMCL^1^^1^2
"KRN",8994,3354,2,2,1,0)
^^2^2^3100115^
"KRN",8994,3354,2,2,1,1,0)
This is the internal entry number of the Clinic in the Hospital Location 
"KRN",8994,3354,2,2,1,2,0)
File (#44).
"KRN",8994,3354,2,"B","ORAMCL",2)

"KRN",8994,3354,2,"B","ORAMDFN",1)

"KRN",8994,3354,2,"PARAMSEQ",1,1)

"KRN",8994,3354,2,"PARAMSEQ",2,2)

"KRN",8994,3354,3,0)
^^3^3^3100115^
"KRN",8994,3354,3,1,0)
A VA FileMan date/time is returned. If a match is found, the date and 
"KRN",8994,3354,3,2,0)
time of the appointment will be returned. Otherwise the system date/time 
"KRN",8994,3354,3,3,0)
at the time the RPC was invoked will be returned.
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"ORD",21,8989.52)
8989.52;21;1;;PAR2E1^XPDTA2;PAR2F1^XPDIA3;PAR2E1^XPDIA3;PAR2F2^XPDIA3;;PAR2DEL^XPDIA3(%)
"ORD",21,8989.52,0)
PARAMETER TEMPLATE
"PGL",101.24,0,13,.13)
RPC^P8994'^XWB(8994,^0;13^Q
"PGL",101.24,0,18,.18)
DETAIL REPORT^*P101.24'^ORD(101.24,^0;18^S DIC("S")="I $P(^(0),""^"",8)=""CD""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"PGL",101.24,0,21,.192)
REPORT COMPONENT^P142.1'^GMT(142.1,^0;21^Q
"PKG",22,-1)
1^1
"PKG",22,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",22,20,0)
^9.402P^^
"PKG",22,22,0)
^9.49I^1^1
"PKG",22,22,1,0)
3.0^2971217^2980204^64
"PKG",22,22,1,"PAH",1,0)
307^3100205
"PKG",22,22,1,"PAH",1,1,0)
^^2^2^3100205
"PKG",22,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the National Patch Module
"PKG",22,22,1,"PAH",1,1,2,0)
under OR*3*307.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","ORAM")
0^1^B73547514^n/a
"RTN","ORAM",1,0)
ORAM ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (1 of 4) ;01/25/10  08:27
"RTN","ORAM",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAM",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM",4,0)
 Q
"RTN","ORAM",5,0)
 ;
"RTN","ORAM",6,0)
PATIENT(RESULT,ORAMDFN) ;Returns current Patient info as:
"RTN","ORAM",7,0)
 ;DFN^NAME^GENDER^ADMISSION^CURRENT DT/TIME (internal)^SSN^CURRENT DT/TIME (external)^CLINIC LOCATION^DTIME
"RTN","ORAM",8,0)
 ;RPC=ORAM PATIENT
"RTN","ORAM",9,0)
 N CURADM,PTNAME,GENDER,ORAMNOW,ORAMRD,ORAMSSN,ORAMPLOC,ORAMVDT
"RTN","ORAM",10,0)
 I '$G(ORAMDFN) D
"RTN","ORAM",11,0)
 . N DIC,X,Y
"RTN","ORAM",12,0)
 . S DIC="^DPT(",DIC(0)="Z",X=" "
"RTN","ORAM",13,0)
 . D ^DIC
"RTN","ORAM",14,0)
 . S ORAMDFN=+$G(Y)
"RTN","ORAM",15,0)
 I ORAMDFN<1 S ORAMDFN=0 G PATIENTQ
"RTN","ORAM",16,0)
 S CURADM=$G(^DPT(ORAMDFN,.105))   ;CHECKS IF PATIENT IS ADMITTED
"RTN","ORAM",17,0)
 S PTNAME=$P(^DPT(ORAMDFN,0),U)
"RTN","ORAM",18,0)
 I $L(PTNAME)>19 D
"RTN","ORAM",19,0)
 . N ORFMT
"RTN","ORAM",20,0)
 . F ORFMT="LAST,FIRST MI","LAST,FI MI" S PTNAME=$$NAME^ORAMX(PTNAME,ORFMT) Q:$L(PTNAME)'>19
"RTN","ORAM",21,0)
 S GENDER=$P(^DPT(ORAMDFN,0),U,2)
"RTN","ORAM",22,0)
 S ORAMSSN=$P(^DPT(ORAMDFN,0),U,9)
"RTN","ORAM",23,0)
 S ORAMNOW=$$NOW^XLFDT S ORAMRD=$$FMTE^XLFDT($E(ORAMNOW,1,12),2)
"RTN","ORAM",24,0)
 S ORAMPLOC=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM",25,0)
 S:+ORAMPLOC>0 ORAMPLOC=ORAMPLOC_";SC("
"RTN","ORAM",26,0)
 S ORAMVDT=$$GETAPPT(ORAMDFN,+ORAMPLOC)
"RTN","ORAM",27,0)
 S:$L($P(ORAMRD,"/",1))=1 $P(ORAMRD,"/",1)="0"_$P(ORAMRD,"/",1)
"RTN","ORAM",28,0)
 S:$L($P(ORAMRD,"/",2))=1 $P(ORAMRD,"/",2)="0"_$P(ORAMRD,"/",2)
"RTN","ORAM",29,0)
 S RESULT=$G(ORAMDFN)_U_$G(PTNAME)_U_$G(GENDER)_U_$G(CURADM)_U_ORAMNOW_U_$G(ORAMSSN)_U_$G(ORAMRD)_U_ORAMPLOC_U_$G(DTIME)_U_ORAMVDT
"RTN","ORAM",30,0)
PATIENTQ Q
"RTN","ORAM",31,0)
 ;
"RTN","ORAM",32,0)
APPTMTCH(RESULT,ORAMDFN,ORAMCL) ; Find appt match on clinic change
"RTN","ORAM",33,0)
 S RESULT=$$GETAPPT(ORAMDFN,+ORAMCL)
"RTN","ORAM",34,0)
 Q
"RTN","ORAM",35,0)
 ;
"RTN","ORAM",36,0)
GETAPPT(ORAMDFN,ORAMCL) ; Find most recent appointment to Clinic from t-1 to t+1 days
"RTN","ORAM",37,0)
 N ORAMC,ORAMEDT,ORAMLDT,ORAMOK,ORAMY,ORAMDIFF,ORAMTCL,ORAMVCL,ORAMLAD,ORAMLBD,ORAMFLTR,ORAMAPPT
"RTN","ORAM",38,0)
 S ORAMOK=0
"RTN","ORAM",39,0)
 S ORAMY=$$NOW^XLFDT
"RTN","ORAM",40,0)
 I +ORAMCL'>0 G GETAPPX
"RTN","ORAM",41,0)
 S ORAMLBD=$$GET^XPAR(ORAMCL_";SC(^ALL","ORAM APPT MATCH LOOK-BACK",1,"I")
"RTN","ORAM",42,0)
 S ORAMDIFF=$S(ORAMLBD]"":-ORAMLBD,1:-1)
"RTN","ORAM",43,0)
 S ORAMEDT=$$FMADD^XLFDT(DT,ORAMDIFF)
"RTN","ORAM",44,0)
 S ORAMLAD=$$GET^XPAR(ORAMCL_";SC(^ALL","ORAM APPT MATCH LOOK-AHEAD",1,"I")
"RTN","ORAM",45,0)
 S ORAMDIFF=$S(ORAMLAD]"":ORAMLAD,1:1)
"RTN","ORAM",46,0)
 S ORAMLDT=$$FMADD^XLFDT(DT,ORAMDIFF)_".2359"
"RTN","ORAM",47,0)
 S ORAMVCL=$$GET^XPAR(ORAMCL_";SC(","ORAM VISIT LOCATION",1,"I")
"RTN","ORAM",48,0)
 S ORAMTCL=$$GET^XPAR(ORAMCL_";SC(","ORAM PHONE CLINIC",1,"I")
"RTN","ORAM",49,0)
 F ORAMC=ORAMVCL,ORAMTCL D
"RTN","ORAM",50,0)
 . N ORAMOK
"RTN","ORAM",51,0)
 . S ORAMFLTR(1)=ORAMEDT_";"_ORAMLDT
"RTN","ORAM",52,0)
 . S ORAMFLTR(2)=ORAMC
"RTN","ORAM",53,0)
 . S ORAMFLTR(3)="R;I;NT"
"RTN","ORAM",54,0)
 . S ORAMFLTR(4)=ORAMDFN
"RTN","ORAM",55,0)
 . S ORAMFLTR("MAX")=-3
"RTN","ORAM",56,0)
 . S ORAMFLTR("FLDS")="1;2;4"
"RTN","ORAM",57,0)
 . S ORAMOK=$$SDAPI^SDAMA301(.ORAMFLTR)
"RTN","ORAM",58,0)
 . I +ORAMOK>0 M ORAMAPPT=^TMP($J,"SDAMA301")
"RTN","ORAM",59,0)
 I +$D(ORAMAPPT)>9 S ORAMY=$$NEAREST($NA(ORAMAPPT(ORAMDFN)))
"RTN","ORAM",60,0)
 K ^TMP($J,"SDAMA301")
"RTN","ORAM",61,0)
GETAPPX Q ORAMY
"RTN","ORAM",62,0)
 ;
"RTN","ORAM",63,0)
NEAREST(APPTS) ; Find the nearest appointment to NOW
"RTN","ORAM",64,0)
 N ORC,ORI,ORY,ORNOW,ORDIFFS S (ORC,ORY)=0,ORNOW=$$NOW^XLFDT
"RTN","ORAM",65,0)
 F  S ORC=$O(@APPTS@(ORC)) Q:+ORC'>0  D
"RTN","ORAM",66,0)
 . N ORDT S ORDT=0
"RTN","ORAM",67,0)
 . F  S ORDT=$O(@APPTS@(ORC,ORDT)) Q:+ORDT'>0  S ORDIFFS($$ABS^XLFMTH($$FMDIFF^XLFDT(ORNOW,ORDT,2)))=ORDT
"RTN","ORAM",68,0)
 S ORI=$O(ORDIFFS(0))
"RTN","ORAM",69,0)
 S:+ORI>0 ORY=ORDIFFS(ORI)
"RTN","ORAM",70,0)
 Q ORY
"RTN","ORAM",71,0)
 ;
"RTN","ORAM",72,0)
PROVIDER(RESULT) ;GETS DUZ/NAME OF PROVIDER WHO IS SIGNED IN
"RTN","ORAM",73,0)
 ;;RPC=ORAM PROVIDER
"RTN","ORAM",74,0)
 N PN,INIT
"RTN","ORAM",75,0)
 S DUZ=$G(DUZ)
"RTN","ORAM",76,0)
 S PN=$P(^VA(200,DUZ,0),U)
"RTN","ORAM",77,0)
 S INIT=$P(^VA(200,DUZ,0),U,2)
"RTN","ORAM",78,0)
 S RESULT=$G(DUZ)_U_PN_U_$G(INIT)
"RTN","ORAM",79,0)
 Q
"RTN","ORAM",80,0)
 ;
"RTN","ORAM",81,0)
INRCHK(ORAMQO) ; Resolve Lab Test id from Quick Order
"RTN","ORAM",82,0)
 N TST,N,ORAM60,ORAMT2,ORAMTT,ORAMPP,ORAMTST,ORAMTSTN,ORAMNEW,ORAML,ORAMT60,ORAMORD,ORY
"RTN","ORAM",83,0)
 S ORAMORD=$$QOORD(ORAMQO),ORY=""
"RTN","ORAM",84,0)
 I +$G(ORAMQO) D
"RTN","ORAM",85,0)
 . N ORAMC
"RTN","ORAM",86,0)
 . S ORAM60=+$P(^ORD(101.43,ORAMORD,0),U,2) Q:'+$G(ORAM60)
"RTN","ORAM",87,0)
 . S ORAMT60=$P($P($G(^LAB(60,ORAM60,0)),U,5),";",2) I +$G(ORAMT60) S ORY=ORAMT60 Q
"RTN","ORAM",88,0)
 . I '$G(ORAMT60),$D(^LAB(60,ORAM60,2,0)) S ORAMC=0 F  S ORAMC=$O(^LAB(60,ORAM60,2,ORAMC)) Q:'+$G(ORAMC)!(+$G(ORY))  D
"RTN","ORAM",89,0)
 .. S ORAMNEW=^LAB(60,ORAM60,2,ORAMC,0) I +ORAMNEW>0,$$ISINR(ORAMNEW) S ORY=$P($P($G(^LAB(60,ORAMNEW,0)),U,5),";",2) Q
"RTN","ORAM",90,0)
 Q ORY
"RTN","ORAM",91,0)
 ;
"RTN","ORAM",92,0)
ISINR(ORTEST) ; Is the lab test an INR?
"RTN","ORAM",93,0)
 N ORY,ORNM S ORY=0
"RTN","ORAM",94,0)
 S ORNM=$P($G(^LAB(60,ORTEST,0)),U)
"RTN","ORAM",95,0)
 S ORY=$S(ORNM["INR":1,(ORNM["INT")&(ORNM["NORM")&(ORNM["RAT"):1,1:0)
"RTN","ORAM",96,0)
 Q ORY
"RTN","ORAM",97,0)
 ;
"RTN","ORAM",98,0)
LABCHK(RESULT) ;
"RTN","ORAM",99,0)
 ;;RPC=ORAM ORDERABLES
"RTN","ORAM",100,0)
 N ORAMINR,ORAMCBC,C,Y S (C,Y)=0,RESULT="0|0"
"RTN","ORAM",101,0)
 S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",102,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR ",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",103,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR/PT",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",104,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","PT",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",105,0)
 S ORAMCBC=0 F  S ORAMCBC=$O(^ORD(101.43,"B","CBC",ORAMCBC)) Q:'+$G(ORAMCBC)!(+$G(Y))  I +$G(ORAMCBC) S $P(RESULT,"|",2)=ORAMCBC,Y=1
"RTN","ORAM",106,0)
 I $G(ORAMCBC)="" S ORAMCBC=$O(^ORD(101.43,"B","CBC ",ORAMCBC)) Q:'+$G(ORAMCBC)!(+$G(Y))  I +$G(ORAMCBC) S $P(RESULT,"|",2)=ORAMCBC,Y=1
"RTN","ORAM",107,0)
 Q
"RTN","ORAM",108,0)
 ;
"RTN","ORAM",109,0)
SIGCHECK(RESULT,ESCODE) ;
"RTN","ORAM",110,0)
 ;;CHECKS SIG CODE
"RTN","ORAM",111,0)
 ;;RPC=ORAM SIGCHECK
"RTN","ORAM",112,0)
 N SUCCESS,X
"RTN","ORAM",113,0)
 S SUCCESS=0
"RTN","ORAM",114,0)
 Q:ESCODE=""
"RTN","ORAM",115,0)
 S X=ESCODE D HASH^XUSHSHP
"RTN","ORAM",116,0)
 I $P($G(^VA(200,DUZ,20)),U,4)=X S SUCCESS=1 ;SIG CODE CORRECT
"RTN","ORAM",117,0)
 S RESULT=$G(SUCCESS)
"RTN","ORAM",118,0)
SIGQ Q
"RTN","ORAM",119,0)
 ;
"RTN","ORAM",120,0)
HCT(RESULT,ORAMDFN) ;GET HCT
"RTN","ORAM",121,0)
 ;;GETS MOST RECENT HCT
"RTN","ORAM",122,0)
 ;;RPC=ORAM HCT
"RTN","ORAM",123,0)
 N HCT,LDATE,HCTDATE,LOOPCNT,HCTDIFF,LRDFN,ORAMS,ORAMHCT,ORAMDNM,OHCT,OHCTD,ORAMFM,ORAMHCTN
"RTN","ORAM",124,0)
 I '$G(ORAMDFN) S RESULT="" Q  ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",125,0)
 S LRDFN=$$LAB($G(ORAMDFN)) Q:'+LRDFN
"RTN","ORAM",126,0)
 S ORAMHCT=$$GET^XPAR("ALL","ORAM HCT/HGB REFERENCE",1,"B")
"RTN","ORAM",127,0)
 I +$G(ORAMHCT)'>0 S RESULT="HCT Param not set." Q
"RTN","ORAM",128,0)
 S ORAMHCTN=$P(ORAMHCT,U,2),ORAMHCT=$P(ORAMHCT,U)
"RTN","ORAM",129,0)
 ; Get Lab Data Name based on IEN in ^LAB(60,
"RTN","ORAM",130,0)
 S ORAMDNM=$P($P(^LAB(60,+ORAMHCT,0),U,5),";",2) Q:ORAMDNM']""
"RTN","ORAM",131,0)
 S LDATE=0 F  SET LDATE=$O(^LR(LRDFN,"CH",LDATE)) S LOOPCNT=0 Q:LDATE=""!(+$G(HCT))  D  Q:LOOPCNT
"RTN","ORAM",132,0)
 . S RESULT=$G(^LR(LRDFN,"CH",LDATE,ORAMDNM))
"RTN","ORAM",133,0)
 . Q:RESULT=""
"RTN","ORAM",134,0)
 . Q:$P(RESULT,U,1)=""  ;QUIT IF NO HCT DATA
"RTN","ORAM",135,0)
 . S HCT=$P(RESULT,U,1)  ;HCT
"RTN","ORAM",136,0)
 . S HCTDATE=9999999-LDATE
"RTN","ORAM",137,0)
 . S LOOPCNT=1
"RTN","ORAM",138,0)
 . Q:+HCT
"RTN","ORAM",139,0)
 I LDATE="" S RESULT="NONE"
"RTN","ORAM",140,0)
 I $D(^ORAM(103,ORAMDFN,6)),($L($P(^ORAM(103,ORAMDFN,6),U,4),"|")=3) D
"RTN","ORAM",141,0)
 . S OHCT=$P($P(^ORAM(103,ORAMDFN,6),U,4),"|"),OHCTD=$P($P(^ORAM(103,ORAMDFN,6),U,4),"|",2)
"RTN","ORAM",142,0)
 . I +$G(OHCT) D DT^DILF(,OHCTD,.ORAMFM)
"RTN","ORAM",143,0)
 I +$G(HCTDATE),$G(ORAMFM)>HCTDATE S HCT=OHCT_" (Outside Lab)",HCTDATE=ORAMFM,ORAMHCTN="HCT"
"RTN","ORAM",144,0)
 I '+$G(HCTDATE) S:+$G(OHCT) HCT=OHCT_" (Outside Lab)",ORAMHCTN="HCT" S:$G(ORAMFM)'="" HCTDATE=ORAMFM
"RTN","ORAM",145,0)
 I +$G(HCTDATE) S HCTDATE=$$FMTE^XLFDT($E(HCTDATE,1,7),2)
"RTN","ORAM",146,0)
 S RESULT=$G(HCT)_U_$G(HCTDATE)_U_ORAMHCTN
"RTN","ORAM",147,0)
 Q
"RTN","ORAM",148,0)
 ;
"RTN","ORAM",149,0)
INR(RESULT,ORAMDFN) ; Gets most recent INR
"RTN","ORAM",150,0)
 ;;RPC=ORAM INR
"RTN","ORAM",151,0)
 N LDATE,INR,INRFD,LRDFN,HDATE,TDIFF,SIXMON,COUNT,SCORE,ORAMITST,INRHD,INRRD
"RTN","ORAM",152,0)
 N ORAMQO
"RTN","ORAM",153,0)
 S RESULT=""
"RTN","ORAM",154,0)
 I '$G(ORAMDFN) Q  ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",155,0)
 S LRDFN=$$LAB($G(ORAMDFN)) Q:'+$G(LRDFN)
"RTN","ORAM",156,0)
 S ORAMQO=$$GET^XPAR("ALL","ORAM INR QUICK ORDER",1,"I") S ORAMITST=$$INRCHK(ORAMQO)
"RTN","ORAM",157,0)
 I +ORAMITST'>0 Q
"RTN","ORAM",158,0)
 S (LDATE,COUNT)=0,SIXMON=$$FMADD^XLFDT(DT,-180)
"RTN","ORAM",159,0)
 F  S LDATE=$O(^LR(LRDFN,"CH",LDATE)) Q:+LDATE'>0!(LDATE>(9999999-SIXMON))  D
"RTN","ORAM",160,0)
 . N SCORE,INR,INRFD,INRHD,INRRD,XDT
"RTN","ORAM",161,0)
 . S SCORE=$G(^LR(LRDFN,"CH",LDATE,ORAMITST))
"RTN","ORAM",162,0)
 . Q:SCORE=""  ;QUIT IF NO INR TEST
"RTN","ORAM",163,0)
 . S INR=$P(SCORE,U)  ;INR
"RTN","ORAM",164,0)
 . Q:INR=""  ;QUIT IF NO INR DATA
"RTN","ORAM",165,0)
 . S INRFD=9999999-LDATE
"RTN","ORAM",166,0)
 . S XDT=$P(INRFD,".") S INRHD=$$FMTH^XLFDT(XDT,1),INRRD=$$FMTE^XLFDT(XDT,"2P")
"RTN","ORAM",167,0)
 . S RESULT(COUNT)=$G(INR)_"^^"_$G(INRRD)_U_$G(INRHD)
"RTN","ORAM",168,0)
 . Q:INRFD<SIXMON  ;Q WHEN SEARCHED LAST 6 MONTHS
"RTN","ORAM",169,0)
 . S COUNT=COUNT+1
"RTN","ORAM",170,0)
 Q
"RTN","ORAM",171,0)
 ;
"RTN","ORAM",172,0)
CONCOMP(RESULT,ORAMCNUM,ORAMNNUM,ORAMDUZ) ;
"RTN","ORAM",173,0)
 ;;BRINGS IN CONSULT NUMBER(ORAMCNUM)
"RTN","ORAM",174,0)
 ;;BRINGS IN NOTE NUMBER(ORAMNNUM), COMPLETES CONSULT
"RTN","ORAM",175,0)
 ;;RPC=ORAM CONCOMP
"RTN","ORAM",176,0)
 N ORAMCST
"RTN","ORAM",177,0)
 S RESULT=0
"RTN","ORAM",178,0)
 S ORAMCST=$S($$STATUS^TIULC(ORAMNNUM)="completed":"COMPLETE",1:"INCOMPLETE")
"RTN","ORAM",179,0)
 D GET^GMRCTIU(ORAMCNUM,ORAMNNUM,ORAMCST,ORAMDUZ)
"RTN","ORAM",180,0)
 S RESULT=1
"RTN","ORAM",181,0)
 Q
"RTN","ORAM",182,0)
 ;
"RTN","ORAM",183,0)
LAB(DFN) ;GET LAB NUMBER
"RTN","ORAM",184,0)
 N LRDFN
"RTN","ORAM",185,0)
 IF 'DFN S LRDFN="" G LABQ ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",186,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","ORAM",187,0)
LABQ Q LRDFN
"RTN","ORAM",188,0)
 ;
"RTN","ORAM",189,0)
ORDER(ORESULT,DFN,ORDOC,ORLOC,ORQO,ORCDT) ; Place Quick Order for INR or CBC
"RTN","ORAM",190,0)
 ; RPC ORAM ORDER
"RTN","ORAM",191,0)
 ;  in: DFN   - pt id file 2
"RTN","ORAM",192,0)
 ;      ORDOC - ordering provider id file 200
"RTN","ORAM",193,0)
 ;      ORLOC - location id file 42
"RTN","ORAM",194,0)
 ;      ORQO  - quick order id file 101.41
"RTN","ORAM",195,0)
 ;      ORCDT - collection date/time
"RTN","ORAM",196,0)
 N ORANS,ORDIALOG,ORDG,ORDLG
"RTN","ORAM",197,0)
 I +$G(DFN)'>0 S ORESULT="0^invalid Patient id" Q
"RTN","ORAM",198,0)
 I +$G(ORDOC)'>0 S ORESULT="0^invalid Provider id" Q
"RTN","ORAM",199,0)
 I +$G(ORLOC)'>0 S ORESULT="0^invalid Location id" Q
"RTN","ORAM",200,0)
 I +$G(ORQO)'>0 S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",201,0)
 I $G(ORCDT)']"" S ORESULT="0^invalid Collection Date/Time" Q
"RTN","ORAM",202,0)
 D GETQDLG^ORCD(ORQO)
"RTN","ORAM",203,0)
 I '$D(ORDIALOG) S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",204,0)
 S ORDLG=$$GET1^DIQ(101.41,+ORDIALOG_",",.01)
"RTN","ORAM",205,0)
 I ORDLG']"" S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",206,0)
 S ORDG=$$GET1^DIQ(101.41,ORQO_",",5,"I")
"RTN","ORAM",207,0)
 I +ORDG'>0 S ORESULT="0^invalid Quick Order id - no Display Group" Q
"RTN","ORAM",208,0)
 S ORDIALOG(6,1)=$$IDATE(ORCDT)
"RTN","ORAM",209,0)
 D SAVE^ORWDX(.ORESULT,DFN,ORDOC,ORLOC,ORDLG,ORDG,ORQO,"",.ORDIALOG) ; Place the order
"RTN","ORAM",210,0)
 Q
"RTN","ORAM",211,0)
IDATE(ORX) ; Convert External Date/time to FM Internal format
"RTN","ORAM",212,0)
 N ORY S ORY=""
"RTN","ORAM",213,0)
 D DT^DILF("T",ORX,.ORY) S:+ORY'>0 ORY=""
"RTN","ORAM",214,0)
 Q ORY
"RTN","ORAM",215,0)
QOORD(ORQO) ; Given Quick Order, find the IEN of the Orderable Item
"RTN","ORAM",216,0)
 N ORI,ORDIALOG,ORY S ORY=0
"RTN","ORAM",217,0)
 D GETQDLG^ORCD(+$G(ORQO))
"RTN","ORAM",218,0)
 I '$D(ORDIALOG) G QOORDX
"RTN","ORAM",219,0)
 S ORI=0
"RTN","ORAM",220,0)
 F  S ORI=$O(ORDIALOG(ORI)) Q:ORI'>0!+ORY>0  D
"RTN","ORAM",221,0)
 . I $G(ORDIALOG(ORI))["ORDERABLE" S ORY=$G(ORDIALOG(ORI,1))
"RTN","ORAM",222,0)
QOORDX Q ORY
"RTN","ORAM1")
0^2^B159543113^n/a
"RTN","ORAM1",1,0)
ORAM1 ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (2 of 4) ;01/22/10  16:13
"RTN","ORAM1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAM1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM1",4,0)
 Q
"RTN","ORAM1",5,0)
 ;
"RTN","ORAM1",6,0)
TERASE(RESULT,ORAMDFN,ORAMCOMP) ; Manage Team Lists
"RTN","ORAM1",7,0)
 N ORAMKEY,ORAMTMP,ORAMCEY,ORAMCLIN,ORAMCLNM,ORAMCOM,ORAMALL,ORAMCPLX,ORAMENT,QQ,DA,DIK,D0
"RTN","ORAM1",8,0)
 Q:'+$G(ORAMDFN)
"RTN","ORAM1",9,0)
 S ORAMCLIN=+$P($G(^ORAM(103,ORAMDFN,6)),U,2),ORAMENT=$S(+ORAMCLIN>0:ORAMCLIN_";SC(",1:"ALL")
"RTN","ORAM1",10,0)
 I +ORAMCLIN S ORAMCLNM=$$EXTERNAL^DILFD(103,101,"",ORAMCLIN)
"RTN","ORAM1",11,0)
 S ORAMALL=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (ALL)",1,"I"),ORAMCPLX=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (COMPLEX)",1,"I")
"RTN","ORAM1",12,0)
 I +$G(ORAMALL) D  I 1
"RTN","ORAM1",13,0)
 . S DA(1)=ORAMALL,DIK="^OR(100.21"_","_DA(1)_",10,"
"RTN","ORAM1",14,0)
 . S ORAMTMP=ORAMDFN_";DPT("
"RTN","ORAM1",15,0)
 . S ORAMKEY=$O(^OR(100.21,ORAMALL,10,"B",ORAMTMP,0)) Q:+ORAMKEY'>0  S DA=ORAMKEY
"RTN","ORAM1",16,0)
 . D ^DIK
"RTN","ORAM1",17,0)
 . K DA,DIK
"RTN","ORAM1",18,0)
 . K D0
"RTN","ORAM1",19,0)
 . S RESULT=1
"RTN","ORAM1",20,0)
 E  S RESULT="0^ORAM TEAM LIST (ALL) not defined for Clinic "_ORAMCLNM_"."
"RTN","ORAM1",21,0)
 I +$G(ORAMCPLX) D  I 1
"RTN","ORAM1",22,0)
 . S DA(1)=ORAMCPLX,DIK="^OR(100.21"_","_DA(1)_",10,"
"RTN","ORAM1",23,0)
 . S ORAMCEY=$O(^OR(100.21,ORAMCPLX,10,"B",ORAMTMP,0)) Q:+ORAMCEY'>0  S DA=ORAMCEY
"RTN","ORAM1",24,0)
 . D ^DIK
"RTN","ORAM1",25,0)
 . K DA,DIK
"RTN","ORAM1",26,0)
 . S:'$D(RESULT) RESULT=1
"RTN","ORAM1",27,0)
 E  S RESULT="0^ORAM TEAM LIST (COMPLEX) not defined for Clinic "_ORAMCLNM_"."
"RTN","ORAM1",28,0)
 Q
"RTN","ORAM1",29,0)
 ;
"RTN","ORAM1",30,0)
ICDCODE(RESULT,ICODE) ; Map ICD Code
"RTN","ORAM1",31,0)
 N ORAMICD
"RTN","ORAM1",32,0)
 S ORAMICD=ICODE_" "
"RTN","ORAM1",33,0)
 S RESULT=$O(^ICD9("AB",ORAMICD,0))
"RTN","ORAM1",34,0)
 Q
"RTN","ORAM1",35,0)
 ;
"RTN","ORAM1",36,0)
PTCHECK(RESULT,ORAMDFN) ; CHECKS TO SEE IF PT IS IN FILE
"RTN","ORAM1",37,0)
 N ORPTLOC
"RTN","ORAM1",38,0)
 Q:'+$G(ORAMDFN)
"RTN","ORAM1",39,0)
 S RESULT=0
"RTN","ORAM1",40,0)
 I $S('$D(^ORAM(103,ORAMDFN)):1,+$O(^ORAM(103,ORAMDFN,3,0))'>0:1,1:0) S RESULT=1 Q
"RTN","ORAM1",41,0)
 S ORPTLOC=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM1",42,0)
 I ORPTLOC']"" S RESULT=2 Q
"RTN","ORAM1",43,0)
 I +ORPTLOC,'$L($$GET^XPAR(ORPTLOC_";SC(^DIV.`"_DUZ(2),"ORAM CLINIC NAME",1,"I")) S RESULT=99
"RTN","ORAM1",44,0)
 Q
"RTN","ORAM1",45,0)
 ;
"RTN","ORAM1",46,0)
PTENTER(RESULT,DFN) ; ENTERS PATIENT INTO FILE WITH ALL DATES = TODAY
"RTN","ORAM1",47,0)
 N DO,DD,DIC,DINUM,X
"RTN","ORAM1",48,0)
 S DIC="^ORAM(103,"
"RTN","ORAM1",49,0)
 S DIC(0)="Z"
"RTN","ORAM1",50,0)
 S (DINUM,X)=DFN
"RTN","ORAM1",51,0)
 D FILE^DICN
"RTN","ORAM1",52,0)
 K DO,DD
"RTN","ORAM1",53,0)
 S RESULT=1
"RTN","ORAM1",54,0)
 Q
"RTN","ORAM1",55,0)
 ;
"RTN","ORAM1",56,0)
ACDATA(RESULT,DFN) ; HEADING DATA
"RTN","ORAM1",57,0)
 N ORAMSTOT,ORAMRTOT,ORAMRAT,ORAMMSGT,ORAMRAT,ORAMBRT,ORAMX,ORI,ORLINE
"RTN","ORAM1",58,0)
 N ORAMD0,ORAMD4,ORAMD5,ORAMD6,ORAMD9,ORAMD15,ORAMD17,ORAMD18
"RTN","ORAM1",59,0)
 N ORAMT4,ORAMT5,ORAMT6,ORAMT9,ORAMT15,ORAMT17,ORAMT18
"RTN","ORAM1",60,0)
 S ORAMX=0
"RTN","ORAM1",61,0)
 I '$D(^ORAM(103,DFN)) D  ;IF NOT IN FILE ALREADY...
"RTN","ORAM1",62,0)
 . N DD,DIC,DINUM,DO,X
"RTN","ORAM1",63,0)
 . S DIC="^ORAM(103,"
"RTN","ORAM1",64,0)
 . S DIC(0)="Z"
"RTN","ORAM1",65,0)
 . S (DINUM,X)=DFN
"RTN","ORAM1",66,0)
 . D FILE^DICN
"RTN","ORAM1",67,0)
 . K DO,DD
"RTN","ORAM1",68,0)
 . S ORAMX=1
"RTN","ORAM1",69,0)
 I ORAMX=1 S RESULT(0)=0 G ACDATAQ
"RTN","ORAM1",70,0)
 S ORAMD0=^ORAM(103,DFN,0)
"RTN","ORAM1",71,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,1,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,1,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMSTOT=$G(ORAMSTOT)_U_ORLINE
"RTN","ORAM1",72,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,2,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,2,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMRTOT=$G(ORAMRTOT)_U_ORLINE
"RTN","ORAM1",73,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,4,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,4,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMMSGT=$G(ORAMMSGT)_U_ORLINE
"RTN","ORAM1",74,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,5,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,5,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMRAT=$G(ORAMRAT)_U_ORLINE
"RTN","ORAM1",75,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,7,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,7,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMBRT=$G(ORAMBRT)_U_ORLINE
"RTN","ORAM1",76,0)
 S RESULT(0)=$G(ORAMSTOT)
"RTN","ORAM1",77,0)
 S RESULT(1)=$G(ORAMRTOT)
"RTN","ORAM1",78,0)
 S RESULT(2)=$G(ORAMMSGT)
"RTN","ORAM1",79,0)
 S RESULT(4)=$G(ORAMRAT)
"RTN","ORAM1",80,0)
 S RESULT(5)=$S($G(ORAMBRT)]"":$P($G(^ORAM(103,DFN,6)),"^",5)_"^"_$P($G(ORAMBRT),"^",2,99),1:"")
"RTN","ORAM1",81,0)
 S ORAMD4=$P(ORAMD0,"^",4),ORAMD5=$P(ORAMD0,"^",5),ORAMD6=$P(ORAMD0,"^",6),ORAMD9=$P(ORAMD0,"^",9),ORAMD15=$P(ORAMD0,"^",15),ORAMD17=$P(ORAMD0,"^",17),ORAMD18=$P(ORAMD0,"^",18)
"RTN","ORAM1",82,0)
 S ORAMT4=$$FMTE^XLFDT($E($G(ORAMD4),1,12),"2P"),ORAMT5=$$FMTE^XLFDT($E($G(ORAMD5),1,12),"2P"),ORAMT6=$$FMTE^XLFDT($E($G(ORAMD6),1,12),"2P"),ORAMT9=$$FMTE^XLFDT($E($G(ORAMD9),1,12),"2P")
"RTN","ORAM1",83,0)
 S ORAMT15=$$FMTE^XLFDT($E($G(ORAMD15),1,12),"2P"),ORAMT17=$$FMTE^XLFDT($E($G(ORAMD17),1,12),"2P"),ORAMT18=$$FMTE^XLFDT($E($G(ORAMD18),1,12),"2P")
"RTN","ORAM1",84,0)
 S:$L($P(ORAMT4,"/",1))=1 $P(ORAMT4,"/",1)="0"_$P(ORAMT4,"/",1)
"RTN","ORAM1",85,0)
 S:$L($P(ORAMT4,"/",2))=1 $P(ORAMT4,"/",2)="0"_$P(ORAMT4,"/",2)
"RTN","ORAM1",86,0)
 S:$L($P(ORAMT15,"/",1))=1 $P(ORAMT15,"/",1)="0"_$P(ORAMT15,"/",1)
"RTN","ORAM1",87,0)
 S:$L($P(ORAMT15,"/",2))=1 $P(ORAMT15,"/",2)="0"_$P(ORAMT15,"/",2)
"RTN","ORAM1",88,0)
 S:$L($P(ORAMT17,"/",1))=1 $P(ORAMT17,"/",1)="0"_$P(ORAMT17,"/",1)
"RTN","ORAM1",89,0)
 S:$L($P(ORAMT17,"/",2))=1 $P(ORAMT17,"/",2)="0"_$P(ORAMT17,"/",2)
"RTN","ORAM1",90,0)
 S:$L($P(ORAMT18,"/",1))=1 $P(ORAMT18,"/",1)="0"_$P(ORAMT18,"/",1)
"RTN","ORAM1",91,0)
 S:$L($P(ORAMT18,"/",2))=1 $P(ORAMT18,"/",2)="0"_$P(ORAMT18,"/",2)
"RTN","ORAM1",92,0)
 S $P(ORAMD0,"^",4)=$G(ORAMT4),$P(ORAMD0,"^",5)=$G(ORAMT5),$P(ORAMD0,"^",6)=$G(ORAMT6),$P(ORAMD0,"^",9)=$G(ORAMT9),$P(ORAMD0,"^",15)=$G(ORAMT15),$P(ORAMD0,"^",17)=$G(ORAMT17),$P(ORAMD0,"^",18)=$G(ORAMT18)
"RTN","ORAM1",93,0)
 S RESULT(3)=ORAMD0 S:$D(^ORAM(103,DFN,6)) RESULT(3)=RESULT(3)_"^"_$P(^ORAM(103,DFN,6),"^")
"RTN","ORAM1",94,0)
ACDATAQ Q
"RTN","ORAM1",95,0)
 ;
"RTN","ORAM1",96,0)
ADDTOP(RESULT,TOPARR) ; File ANTICOAG data
"RTN","ORAM1",97,0)
 N ORAM0,SI,RISK,PEEP,ORAMSIL,ORAMRL,ORAMPEPL,ORAMDAY,ORAMST,ORAMBACK,ORAMSTP,ORAMOR,ORAMFB,ORAMREM,ORAMRML,ORAMR,ORAMC
"RTN","ORAM1",98,0)
 N ORAMBRG,ORAMBRGC,ORAMBRGL,OLDRTN,DFN,R,X
"RTN","ORAM1",99,0)
 D NOW^%DTC S ORAMDAY=X
"RTN","ORAM1",100,0)
 S DFN=TOPARR(0),ORAM0=TOPARR(1),SI=TOPARR(2),RISK=TOPARR(3),PEEP=TOPARR(4),ORAMREM=TOPARR(5)
"RTN","ORAM1",101,0)
 S ORAMBRG=$G(TOPARR(6)),ORAMBRGC=$G(TOPARR(7))
"RTN","ORAM1",102,0)
 S OLDRTN=$P($G(^ORAM(103,DFN,0)),"^",4)
"RTN","ORAM1",103,0)
 I SI'="" K ^ORAM(103,DFN,1) S ORAMSIL=$L(SI,"^"),^ORAM(103,DFN,1,0)="^^"_ORAMSIL_"^"_ORAMSIL_"^"_ORAMDAY_"^" F R=1:1:ORAMSIL D
"RTN","ORAM1",104,0)
 . S ^ORAM(103,DFN,1,R,0)=$P(SI,"^",R)
"RTN","ORAM1",105,0)
 I RISK'="" K ^ORAM(103,DFN,2) S ORAMRL=$L(RISK,"^"),^ORAM(103,DFN,2,0)="^^"_ORAMRL_"^"_ORAMRL_"^"_ORAMDAY_"^" F R=1:1:ORAMRL D
"RTN","ORAM1",106,0)
 . S ^ORAM(103,DFN,2,R,0)=$P(RISK,"^",R)
"RTN","ORAM1",107,0)
 I PEEP'="" K ^ORAM(103,DFN,4) S ORAMPEPL=$L(PEEP,"^"),^ORAM(103,DFN,4,0)="^^"_ORAMPEPL_"^"_ORAMPEPL_"^"_ORAMDAY_"^" F R=1:1:ORAMPEPL D
"RTN","ORAM1",108,0)
 . S ^ORAM(103,DFN,4,R,0)=$P(PEEP,"^",R)
"RTN","ORAM1",109,0)
 K ^ORAM(103,DFN,5)
"RTN","ORAM1",110,0)
 I ORAMREM'="" D
"RTN","ORAM1",111,0)
 . S ORAMRML=$L(ORAMREM,"^"),^ORAM(103,DFN,5,0)="^^"_ORAMRML_"^"_ORAMRML_"^"_ORAMDAY_"^"
"RTN","ORAM1",112,0)
 . F R=1:1:ORAMRML S ^ORAM(103,DFN,5,R,0)=$P(ORAMREM,"^",R)
"RTN","ORAM1",113,0)
 S $P(^ORAM(103,DFN,6),U,5)=+ORAMBRG
"RTN","ORAM1",114,0)
 K ^ORAM(103,DFN,7)
"RTN","ORAM1",115,0)
 I +ORAMBRG,(ORAMBRGC]"") D
"RTN","ORAM1",116,0)
 . S ORAMBRGL=$L(ORAMBRGC,"^"),^ORAM(103,DFN,7,0)="^^"_ORAMBRGL_"^"_ORAMBRGL_"^"_ORAMDAY_"^"
"RTN","ORAM1",117,0)
 . F R=1:1:ORAMBRGL S ^ORAM(103,DFN,7,R,0)=$P(ORAMBRGC,"^",R)
"RTN","ORAM1",118,0)
 I $P($G(ORAM0),"^",4)'="" S X="",ORAMBACK=$P(ORAM0,"^",4) D DT^DILF("TS",ORAMBACK,.X) S $P(ORAM0,"^",4)=X
"RTN","ORAM1",119,0)
 I $P($G(ORAM0),"^",15)'="" S X="",ORAMFB=$P(ORAM0,"^",15) D DT^DILF(,ORAMFB,.X) S $P(ORAM0,"^",15)=X
"RTN","ORAM1",120,0)
 I $P($G(ORAM0),"^",17)'="" S X="",ORAMC=$P(ORAM0,"^",17) D DT^DILF(,ORAMC,.X) S $P(ORAM0,"^",17)=X
"RTN","ORAM1",121,0)
 I $P($G(ORAM0),"^",18)'="" S X="",ORAMR=$P(ORAM0,"^",18) D DT^DILF(,ORAMR,.X) S $P(ORAM0,"^",18)=X
"RTN","ORAM1",122,0)
 I OLDRTN'="" K ^ORAM(103,"L",OLDRTN,DFN)
"RTN","ORAM1",123,0)
 S ^ORAM(103,DFN,0)=ORAM0 S:$P($G(ORAM0),"^",4)'="" ^ORAM(103,"L",$P(ORAM0,"^",4),DFN)=""
"RTN","ORAM1",124,0)
 I $P(^ORAM(103,DFN,0),"^",13)="" S $P(^ORAM(103,DFN,0),"^",13)="SAVE"
"RTN","ORAM1",125,0)
 Q
"RTN","ORAM1",126,0)
 ;
"RTN","ORAM1",127,0)
OUTINR(RESULT,ORAMINR) ; INR VALUES FROM OUTSIDE LAB
"RTN","ORAM1",128,0)
 N ORAMLEN,ORAMPI,ORAMRI,ORAMZANY,ORAMHDT,ORAMNDT
"RTN","ORAM1",129,0)
 S ORAMLEN=$L($G(ORAMINR),"^"),ORAMRI=0
"RTN","ORAM1",130,0)
 F ORAMPI=1:2:ORAMLEN D
"RTN","ORAM1",131,0)
 . N %H,ORAMDT,X
"RTN","ORAM1",132,0)
 . S ORAMDT=$P(ORAMINR,"^",ORAMPI+1) I $L(ORAMDT) D DT^DILF("E",ORAMDT,.ORAMZANY) S X=ORAMZANY D H^%DTC S ORAMHDT=%H,ORAMNDT=$$FMTE^XLFDT(X,"2P")
"RTN","ORAM1",133,0)
 . I $L(ORAMDT) S RESULT(ORAMRI)=$P(ORAMINR,"^",ORAMPI)_"^"_$G(ORAMHDT)_"^"_$G(ORAMNDT)
"RTN","ORAM1",134,0)
 . E  S RESULT(ORAMRI)="^^"
"RTN","ORAM1",135,0)
 . S ORAMRI=ORAMRI+1
"RTN","ORAM1",136,0)
 Q
"RTN","ORAM1",137,0)
 ;
"RTN","ORAM1",138,0)
PCGOAL(RESULT,DFN,CMPLX) ; % of time Pt in current goal
"RTN","ORAM1",139,0)
 N ORAMSNO,ORAMPC,R,ORAMGOOD,ORAMDATE
"RTN","ORAM1",140,0)
 S R=0,ORAMGOOD=0,ORAMDATE=0
"RTN","ORAM1",141,0)
 S ORAMSNO=0 F  S ORAMSNO=$O(^ORAM(103,DFN,3,ORAMSNO)) Q:'ORAMSNO  D
"RTN","ORAM1",142,0)
 . N ORAMD0,ORAMINR,ORAMGOAL,ORAMGLOW,ORAMHIGH,LCNT,ORAMND
"RTN","ORAM1",143,0)
 . S ORAMD0=$G(^ORAM(103,DFN,3,ORAMSNO,0)),LCNT=$P($G(^ORAM(103,DFN,3,ORAMSNO,1,0)),"^",3)-1
"RTN","ORAM1",144,0)
 . I $G(CMPLX)=1,$G(^ORAM(103,DFN,3,ORAMSNO,1,LCNT,0))["COMPLEX PATIENT" Q
"RTN","ORAM1",145,0)
 . S ORAMND=$P(ORAMD0,"^"),ORAMINR=$P(ORAMD0,"^",3),ORAMGOAL=$P(ORAMD0,"^",12),ORAMGLOW=$P(ORAMGOAL,"-"),ORAMHIGH=$P(ORAMGOAL,"-",2) S:ORAMHIGH[" " ORAMHIGH=$P(ORAMHIGH," ",2)
"RTN","ORAM1",146,0)
 . S ORAMGLOW=ORAMGLOW-(.1*ORAMGLOW),ORAMHIGH=ORAMHIGH+(.1*ORAMHIGH)
"RTN","ORAM1",147,0)
 . I (ORAMND'=ORAMDATE)&(ORAMINR) S R=R+1,ORAMDATE=ORAMND I ((ORAMINR'<ORAMGLOW)&(ORAMINR'>ORAMHIGH)) S ORAMGOOD=ORAMGOOD+1
"RTN","ORAM1",148,0)
 I R>0 S ORAMPC=(ORAMGOOD/R)*100,ORAMPC=$E(ORAMPC,1,4)
"RTN","ORAM1",149,0)
 S RESULT=$G(ORAMPC)_"^"_$G(R)
"RTN","ORAM1",150,0)
PCGOALQ Q
"RTN","ORAM1",151,0)
 ;
"RTN","ORAM1",152,0)
COMPTEST(RESULT,COMMARR) ; File Flow Sheet Data
"RTN","ORAM1",153,0)
 ; RPC: ORAM1 COMPTEST
"RTN","ORAM1",154,0)
 N ORAMDFN,ORAMZERO,ORAMCOMM,ORAMDT,ORAMX,ORAMCL,ORAMTEMP,ORAMSAVE,ORAMRD,ORAMCOMPL,ORAMCCNT,DA,DIK,R,X
"RTN","ORAM1",155,0)
 N ORAMICNT,ORAMIOFF
"RTN","ORAM1",156,0)
 S ORAMDFN=COMMARR(0),ORAMZERO=COMMARR(1),ORAMSAVE=COMMARR(2),ORAMRD=COMMARR(3),ORAMCOMPL=COMMARR(4),ORAMCCNT=COMMARR(5)
"RTN","ORAM1",157,0)
 S ORAMIOFF=+ORAMCCNT+6,ORAMICNT=COMMARR(ORAMIOFF)
"RTN","ORAM1",158,0)
 S ORAMTEMP=$P(ORAMZERO,"^",1) D DT^DILF(,ORAMTEMP,.X) S $P(ORAMZERO,"^",1)=X
"RTN","ORAM1",159,0)
 S ORAMDT=$$NOW^XLFDT,$P(ORAMZERO,"^",9)=ORAMDT
"RTN","ORAM1",160,0)
 S ORAMX=$O(^ORAM(103,ORAMDFN,3," "),-1)
"RTN","ORAM1",161,0)
 I 'ORAMX S ORAMX=0
"RTN","ORAM1",162,0)
 I $P(^ORAM(103,ORAMDFN,0),"^",13)="TEMPSAVE" K DIK,DA S DIK="^ORAM(103,"_ORAMDFN_",3,",DA(1)=ORAMDFN,DA=ORAMX D ^DIK
"RTN","ORAM1",163,0)
 I $P(^ORAM(103,ORAMDFN,0),"^",13)="SAVE" S ORAMX=ORAMX+1
"RTN","ORAM1",164,0)
 ; Execute KILL Logic for cross-refs on update
"RTN","ORAM1",165,0)
 I $D(^ORAM(103,ORAMDFN)) D
"RTN","ORAM1",166,0)
 . S DIK="^ORAM(103,"
"RTN","ORAM1",167,0)
 . S DA=ORAMDFN
"RTN","ORAM1",168,0)
 . D IX2^DIK
"RTN","ORAM1",169,0)
 S ^ORAM(103,ORAMDFN,3,0)="^103.011DA^"_ORAMX_"^"_ORAMX
"RTN","ORAM1",170,0)
 S ^ORAM(103,ORAMDFN,3,ORAMX,0)=ORAMZERO
"RTN","ORAM1",171,0)
 I $P(ORAMRD,U,4)]"" S $P(^ORAM(103,ORAMDFN,6),U,1,4)=ORAMRD
"RTN","ORAM1",172,0)
 E  S $P(^ORAM(103,ORAMDFN,6),U,1,3)=$P(ORAMRD,U,1,3)
"RTN","ORAM1",173,0)
 ; If there are comments, file them
"RTN","ORAM1",174,0)
 I +ORAMCCNT>0 F R=1:1:(ORAMCCNT) D
"RTN","ORAM1",175,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,1,R,0)=COMMARR(R+5)
"RTN","ORAM1",176,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,1,0)="^^"_ORAMCCNT_"^"_ORAMCCNT_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",177,0)
 ; If there are complications, file them
"RTN","ORAM1",178,0)
 I $L(ORAMCOMPL)>0 D
"RTN","ORAM1",179,0)
 . N P1,P2,X
"RTN","ORAM1",180,0)
 . S P1=$P(ORAMCOMPL,"|"),P2=$P(ORAMCOMPL,"|",2)
"RTN","ORAM1",181,0)
 . I P1>99 S P1=2 ;CLOT in the 100 range...
"RTN","ORAM1",182,0)
 . E  I P1#10>0 S P1=1 ;MAJOR BLEED
"RTN","ORAM1",183,0)
 . E  I P1=10 S P1=3 ;MINOR BLEED
"RTN","ORAM1",184,0)
 . S:+$G(P1) $P(^ORAM(103,ORAMDFN,3,ORAMX,0),"^",2)=P1
"RTN","ORAM1",185,0)
 . F X=1:1:$L(P2,"^") D
"RTN","ORAM1",186,0)
 .. S ^ORAM(103,ORAMDFN,3,ORAMX,2,X,0)=$P(P2,"^",X)
"RTN","ORAM1",187,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,2,0)="^^"_$L(P2,"^")-1_"^"_$L(P2,"^")-1_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",188,0)
 ; If there are Patient Instructions, file them
"RTN","ORAM1",189,0)
 I +ORAMICNT>0 F R=1:1:(ORAMICNT) D
"RTN","ORAM1",190,0)
 . N ORLINE S ORLINE=COMMARR(R+ORAMIOFF)
"RTN","ORAM1",191,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,3,R,0)=$S(ORLINE="":" ",1:ORLINE)
"RTN","ORAM1",192,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,3,0)="^^"_ORAMICNT_"^"_ORAMICNT_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",193,0)
 S ^ORAM(103,ORAMDFN,3,"B",$P(ORAMZERO,"^",1),ORAMX)=""
"RTN","ORAM1",194,0)
 S $P(^ORAM(103,ORAMDFN,0),"^",13)=ORAMSAVE
"RTN","ORAM1",195,0)
 ; Update all cross-refs for Flow Sheet entry
"RTN","ORAM1",196,0)
 S DIK="^ORAM(103,"
"RTN","ORAM1",197,0)
 S DA=ORAMDFN
"RTN","ORAM1",198,0)
 D IX^DIK
"RTN","ORAM1",199,0)
 S RESULT=1
"RTN","ORAM1",200,0)
 Q
"RTN","ORAM1",201,0)
 ;
"RTN","ORAM1",202,0)
FLOWTT(RESULT,DFN) ; GETS ANTICOAG FLOWSHEET DATA
"RTN","ORAM1",203,0)
 N FSARR,COMARR,ORAMI,ORI,ORX
"RTN","ORAM1",204,0)
 S (ORI,ORAMI,ORX)=0
"RTN","ORAM1",205,0)
 F  S ORI=$O(^ORAM(103,DFN,3,"B",ORI)) Q:+ORI'>0  D
"RTN","ORAM1",206,0)
 . N ORJ S ORJ=0
"RTN","ORAM1",207,0)
 . F  S ORJ=$O(^ORAM(103,DFN,3,"B",ORI,ORJ)) Q:+ORJ'>0  D
"RTN","ORAM1",208,0)
 .. N ORAMACFS,ORAMCOM,ORAMCOMP,ORAMCC,ORAMPROV,ORAMLCNT,ORAMTOT,ORAMT
"RTN","ORAM1",209,0)
 .. S ORAMACFS=^ORAM(103,DFN,3,ORJ,0),ORAMCC=$P(ORAMACFS,U,2)
"RTN","ORAM1",210,0)
 .. S ORAMCOM=$P(ORAMACFS,U),$P(ORAMACFS,U)=$$FMTE^XLFDT(ORAMCOM,"2P"),$P(ORAMACFS,U,2)=ORJ
"RTN","ORAM1",211,0)
 .. S ORAMPROV=$P(ORAMACFS,U,10) I +$G(ORAMPROV) S $P(ORAMACFS,U,10)=$P(^VA(200,ORAMPROV,0),U)
"RTN","ORAM1",212,0)
 .. S ORAMLCNT=+$O(^ORAM(103,DFN,3,ORJ,1,""),-1)
"RTN","ORAM1",213,0)
 .. S ORAMCOMP=$O(^ORAM(103,DFN,3,ORJ,2,""),-1)
"RTN","ORAM1",214,0)
 .. S ORAMT=ORAMLCNT
"RTN","ORAM1",215,0)
 .. S:+$G(ORAMCC) ORAMT=$G(ORAMLCNT)_","_$G(ORAMCOMP)
"RTN","ORAM1",216,0)
 .. S ORAMTOT=$G(ORAMLCNT)+$G(ORAMCOMP)
"RTN","ORAM1",217,0)
 .. I +$G(ORAMTOT) D
"RTN","ORAM1",218,0)
 ... S RESULT(ORAMI)=$G(ORAMT)_"|"_$G(ORAMACFS)
"RTN","ORAM1",219,0)
 ... I +$G(ORAMLCNT) F ORX=(ORAMI+1):1:(ORAMLCNT+ORAMI) S RESULT(ORX)=$G(^ORAM(103,DFN,3,ORJ,1,(ORX-ORAMI),0))
"RTN","ORAM1",220,0)
 ... I +$G(ORAMCC),+$G(ORAMCOMP) D
"RTN","ORAM1",221,0)
 .... S ORAMI=ORX+2,RESULT(ORAMI)="Complications noted:"
"RTN","ORAM1",222,0)
 .... F ORX=(ORAMI+2):1:(ORAMCOMP+ORAMI) D
"RTN","ORAM1",223,0)
 ..... N ORAMCMPL
"RTN","ORAM1",224,0)
 ..... S ORAMCMPL=$G(^ORAM(103,DFN,3,ORJ,2,(ORX-ORAMI),0))
"RTN","ORAM1",225,0)
 ..... S RESULT(ORX)=$S((ORAMCMPL["MB:")!(ORAMCMPL["C:"):$P(ORAMCMPL,":",2),1:ORAMCMPL)
"RTN","ORAM1",226,0)
 .. E  S RESULT(ORAMI+1)="0|"_$G(ORAMACFS)
"RTN","ORAM1",227,0)
 .. S ORAMI=ORX+1
"RTN","ORAM1",228,0)
 Q
"RTN","ORAM1",229,0)
 ;
"RTN","ORAM1",230,0)
LOGIT(RESULT,FSARRAY,ORAMCOMP) ; RPC= ORAM1 LOG
"RTN","ORAM1",231,0)
 N ORAMDATE,ORAMINR,ORAMPTN,ORAMTWD,ORAMLOG,ORAMLOGN,TODAY,TTIME,COUNT,ORAMODFN,ORAMOD,ORAMND,ORAMNEWD,AROW
"RTN","ORAM1",232,0)
 N %,DA,DIK,ORAMDFN,ORAMRSF,R,X
"RTN","ORAM1",233,0)
 S RESULT=0
"RTN","ORAM1",234,0)
 D NOW^%DTC S TODAY=X,TTIME=%
"RTN","ORAM1",235,0)
 ;FIRST GET THE OLD FLOW SHEET DATA AND SAVE TO THE LOG FILE
"RTN","ORAM1",236,0)
 S ORAMDFN=$G(FSARRAY(0)),AROW=$G(FSARRAY(1))
"RTN","ORAM1",237,0)
 S ORAMDATE=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^"),ORAMINR=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",3),ORAMPTN=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",8),ORAMTWD=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",6)
"RTN","ORAM1",238,0)
 S ORAMODFN=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",10),ORAMOD=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",9)
"RTN","ORAM1",239,0)
 S ORAMLOG="Original FS "_AROW_": DATE="_$G(ORAMDATE)_", INR="_$G(ORAMINR)_", PT NOTIFIED="_$G(ORAMPTN)_", TWD="_$G(ORAMTWD)_"; "_ORAMODFN_" ("_ORAMOD_"): EDITED: "_FSARRAY(6)_"("_TODAY_")"
"RTN","ORAM1",240,0)
 S ORAMLOGN=$P($G(^ORAM(103,ORAMDFN,3,AROW,"LOG",0)),"^",3)+1
"RTN","ORAM1",241,0)
 S ^ORAM(103,ORAMDFN,3,AROW,"LOG",ORAMLOGN,0)=ORAMLOG
"RTN","ORAM1",242,0)
 K ^ORAM(103,ORAMDFN,3,"B",$G(ORAMDATE),AROW)
"RTN","ORAM1",243,0)
 F ORAMRSF=1:1:$P($G(^ORAM(103,ORAMDFN,3,AROW,1,0)),"^",3) S COUNT=ORAMLOGN+ORAMRSF,^ORAM(103,ORAMDFN,3,AROW,"LOG",COUNT,0)=^ORAM(103,ORAMDFN,3,AROW,1,ORAMRSF,0)
"RTN","ORAM1",244,0)
 S ^ORAM(103,ORAMDFN,3,AROW,"LOG",0)="^^"_$G(COUNT)_"^"_$G(COUNT)_"^"_TODAY
"RTN","ORAM1",245,0)
 ;NOW SET NEW INFO FOR THE FLOW SHEET ENTRY
"RTN","ORAM1",246,0)
 ;Array order is: DFN;ARow;date;inr;ptnotified;twd;DUZ;#comment lines;comments
"RTN","ORAM1",247,0)
 S ORAMNEWD=$G(FSARRAY(2)) D DT^DILF(,ORAMNEWD,.X) S ORAMNEWD=X
"RTN","ORAM1",248,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^")=$G(ORAMNEWD),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",3)=$G(FSARRAY(3)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",8)=$G(FSARRAY(4)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",6)=$G(FSARRAY(5))
"RTN","ORAM1",249,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^",2)=$G(ORAMCOMP)
"RTN","ORAM1",250,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^",10)=$G(FSARRAY(6)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",9)=TTIME
"RTN","ORAM1",251,0)
 I $G(FSARRAY(7))'="" K ^ORAM(103,ORAMDFN,3,AROW,1) F R=1:1:$G(FSARRAY(7)) D
"RTN","ORAM1",252,0)
 . S ^ORAM(103,ORAMDFN,3,AROW,1,R,0)=$G(FSARRAY(R+7))
"RTN","ORAM1",253,0)
 S ^ORAM(103,ORAMDFN,3,AROW,1,0)="^^"_$G(FSARRAY(7))_"^"_$G(FSARRAY(7))_"^"_TODAY_"^"  ;$E(ORAMDT,1,7)_"^"
"RTN","ORAM1",254,0)
 S ^ORAM(103,ORAMDFN,3,"B",$G(ORAMNEWD),AROW)=""
"RTN","ORAM1",255,0)
 S DIK="^ORAM(103,"
"RTN","ORAM1",256,0)
 S DA(1)=ORAMDFN,DA=AROW
"RTN","ORAM1",257,0)
 D IX^DIK
"RTN","ORAM1",258,0)
 S RESULT=1
"RTN","ORAM1",259,0)
 Q
"RTN","ORAM1",260,0)
 ;
"RTN","ORAM1",261,0)
LOCK(RESULT,DATA) ; Locks form   RPC=ORAM1 LOCK
"RTN","ORAM1",262,0)
 N X
"RTN","ORAM1",263,0)
 S RESULT=0
"RTN","ORAM1",264,0)
 Q:$P($G(DATA),"^")=""
"RTN","ORAM1",265,0)
 Q:$D(^ORAM(103,$P(DATA,"^")))=0
"RTN","ORAM1",266,0)
 D NOW^%DTC N ORAMTDAY S ORAMTDAY=X
"RTN","ORAM1",267,0)
 I $P(^ORAM(103,$P(DATA,"^"),0),"^",18,19)="" S $P(^ORAM(103,$P(DATA,"^"),0),"^",18)="^"
"RTN","ORAM1",268,0)
 S $P(^ORAM(103,$P(DATA,"^"),0),"^",19)=1_"|"_$P(^VA(200,$P(DATA,"^",2),0),"^")_"|"_ORAMTDAY,RESULT=1
"RTN","ORAM1",269,0)
 Q
"RTN","ORAM1",270,0)
 ;
"RTN","ORAM1",271,0)
UNLOCK(RESULT,DFN) ; Unlocks form  RPC=ORAM1 UNLOCK
"RTN","ORAM1",272,0)
 S RESULT=0
"RTN","ORAM1",273,0)
 Q:DFN<1
"RTN","ORAM1",274,0)
 Q:$D(^ORAM(103,DFN))=0
"RTN","ORAM1",275,0)
 S $P(^ORAM(103,DFN,0),"^",19)=0,RESULT=1
"RTN","ORAM1",276,0)
 Q
"RTN","ORAM1",277,0)
 ;
"RTN","ORAM1",278,0)
GETPT(RESULT) ; Get Pt list  RPC=ORAM1 PT LIST
"RTN","ORAM1",279,0)
 N ORAMPT
"RTN","ORAM1",280,0)
 S ORAMPT=0 F  S ORAMPT=$O(^ORAM(103,"B",ORAMPT)) Q:ORAMPT=""  D
"RTN","ORAM1",281,0)
 . S RESULT($G(ORAMPT))=$G(ORAMPT)_"^"_$P(^DPT(ORAMPT,0),"^")_"^"_$E($P(^DPT(ORAMPT,0),"^",9),6,9)
"RTN","ORAM1",282,0)
 Q
"RTN","ORAM1",283,0)
 ;
"RTN","ORAM1",284,0)
SETHCT(RESULT,ORAMORD) ; SET HCT LAB ITEM NUMBER
"RTN","ORAM1",285,0)
 Q:'+$G(ORAMORD)
"RTN","ORAM1",286,0)
 N ORAMX,ORAML60,ORAMCH S ORAMX=0 F  S ORAMX=$O(^ORD(101.43,$G(ORAMORD),10,ORAMX)) Q:'+$G(ORAMX)!+$G(ORAMCH)  D
"RTN","ORAM1",287,0)
 . I $P(^ORD(101.43,$G(ORAMORD),10,ORAMX,0),"^")["HCT" S ORAML60=+$P(^(0),"^",2)
"RTN","ORAM1",288,0)
 . I +$G(ORAML60) S ORAMCH=$P($P(^LAB(60,ORAML60,0),"^",5),";",2) S RESULT=ORAMCH
"RTN","ORAM1",289,0)
 Q
"RTN","ORAM1",290,0)
 ;
"RTN","ORAM2")
0^3^B120270114^n/a
"RTN","ORAM2",1,0)
ORAM2 ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (3 of 4) ;01/29/10  21:37
"RTN","ORAM2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAM2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM2",4,0)
 Q
"RTN","ORAM2",5,0)
 ;
"RTN","ORAM2",6,0)
ALLGOAL(RESULT,DAYS,CLINIC) ; last inr for all pts seen in last x days
"RTN","ORAM2",7,0)
 ;;RPC = ORAM2 ALLGOAL
"RTN","ORAM2",8,0)
 N ORAMDFN,ORAMNOW,ORAMCUT,ORAMCNT,ORAMPC,ORAMGOOD,ORAMBAD,ORAMBL
"RTN","ORAM2",9,0)
 S ORAMDFN=0,ORAMCNT=0,ORAMGOOD=0,ORAMBAD=0
"RTN","ORAM2",10,0)
 S ORAMNOW=$$NOW^XLFDT
"RTN","ORAM2",11,0)
 S ORAMCUT=$$FMADD^XLFDT(ORAMNOW,-DAYS)
"RTN","ORAM2",12,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:'ORAMDFN  D
"RTN","ORAM2",13,0)
 . N ORAMFS,ORAM3D0,ORAMDATE,ORAMCLIN
"RTN","ORAM2",14,0)
 . S ORAMFS=$O(^ORAM(103,ORAMDFN,3," "),-1) Q:$G(ORAMFS)=""
"RTN","ORAM2",15,0)
 . S ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM2",16,0)
 . I +$G(CLINIC),(ORAMCLIN'=CLINIC) Q
"RTN","ORAM2",17,0)
 . S ORAM3D0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0)),ORAMDATE=$P(ORAM3D0,"^")
"RTN","ORAM2",18,0)
 . I ($G(ORAMDATE)>$G(ORAMCUT)) D
"RTN","ORAM2",19,0)
 .. N ORAMINR,ORAMGOAL,ORAMGLO,ORAMGHI
"RTN","ORAM2",20,0)
 .. S ORAMINR=$P(ORAM3D0,"^",3),ORAMGOAL=$P(ORAM3D0,"^",12),ORAMGLO=$P(ORAMGOAL,"-"),ORAMGHI=$P(ORAMGOAL,"-",2) S:ORAMGHI[" " ORAMGHI=$P(ORAMGHI," ",2)
"RTN","ORAM2",21,0)
 .. S ORAMGLO=ORAMGLO-(.1*ORAMGLO),ORAMGHI=ORAMGHI+(.1*ORAMGHI)
"RTN","ORAM2",22,0)
 .. S ORAMCNT=ORAMCNT+1
"RTN","ORAM2",23,0)
 .. I (ORAMINR'<ORAMGLO)&(ORAMINR'>ORAMGHI) S ORAMGOOD=ORAMGOOD+1
"RTN","ORAM2",24,0)
 .. E  D
"RTN","ORAM2",25,0)
 ... N ORAMNAME,ORAMSSN,LINE
"RTN","ORAM2",26,0)
 ... S ORAMBAD=ORAMBAD+1,LINE=""
"RTN","ORAM2",27,0)
 ... S ORAMNAME=$P($P(^DPT(ORAMDFN,0),"^"),","),ORAMSSN=$E($P(^DPT(ORAMDFN,0),"^",9),6,9)
"RTN","ORAM2",28,0)
 ... S LINE=$$SETSTR^VALM1(ORAMNAME,LINE,1,15)
"RTN","ORAM2",29,0)
 ... S LINE=$$SETSTR^VALM1("("_ORAMSSN_")",LINE,17,6)
"RTN","ORAM2",30,0)
 ... S LINE=$$SETSTR^VALM1($S(+ORAMINR>0:ORAMINR,1:"N/A"),LINE,25,5)
"RTN","ORAM2",31,0)
 ... S LINE=$$SETSTR^VALM1("("_ORAMGOAL_")",LINE,32,9)
"RTN","ORAM2",32,0)
 ... S RESULT(ORAMBAD)=LINE
"RTN","ORAM2",33,0)
 I ORAMCNT>0 S ORAMPC=$J(((ORAMGOOD/ORAMCNT)*100),3,1)
"RTN","ORAM2",34,0)
 I ORAMBAD'="" S ORAMBL=$L(ORAMBAD,"^"),$P(ORAMBAD,"^",1)=ORAMBL
"RTN","ORAM2",35,0)
 S RESULT(0)=$G(ORAMPC)
"RTN","ORAM2",36,0)
 Q
"RTN","ORAM2",37,0)
 ;
"RTN","ORAM2",38,0)
PTAPPT(RESULT,CLINIC) ; Counts # of pts/day next 45 days
"RTN","ORAM2",39,0)
 ;RPC=ORAM2 PTAPPT
"RTN","ORAM2",40,0)
 N ORAMFDT,ORAMRDT,ORAMCNT
"RTN","ORAM2",41,0)
 S ORAMFDT=$$FMADD^XLFDT(DT,45)_".2359",ORAMRDT=DT
"RTN","ORAM2",42,0)
 F  S ORAMRDT=$O(^ORAM(103,"L",ORAMRDT)) Q:(+ORAMRDT'>0)!(ORAMRDT>ORAMFDT)  D
"RTN","ORAM2",43,0)
 . N ORAMDT,ORAMRD,ORAMDFN
"RTN","ORAM2",44,0)
 . S ORAMDT=$P(ORAMRDT,"."),ORAMRD=$$FMTE^XLFDT(ORAMDT,"2DF"),ORAMDFN=0
"RTN","ORAM2",45,0)
 . F  S ORAMDFN=$O(^ORAM(103,"L",ORAMRDT,ORAMDFN)) Q:'ORAMDFN  D
"RTN","ORAM2",46,0)
 .. N ORAMCLIN S ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM2",47,0)
 .. Q:ORAMCLIN'=$G(CLINIC)
"RTN","ORAM2",48,0)
 .. S ORAMCNT(ORAMDT)=+$G(ORAMCNT(ORAMDT))+1
"RTN","ORAM2",49,0)
 .. S RESULT(ORAMDT)=ORAMRD_" - "_$G(ORAMCNT(ORAMDT))
"RTN","ORAM2",50,0)
PTAPPTQ Q
"RTN","ORAM2",51,0)
 ;
"RTN","ORAM2",52,0)
NOACT(RESULT,DAYS,CLINIC) ; Finds pts w/o AC activity past X days
"RTN","ORAM2",53,0)
 ;RPC=ORAM2 NOACT
"RTN","ORAM2",54,0)
 N ORAMDT,ORAMFDT,ORAMVST,ORAMDFN,ORAMPT,ORAMSSN,ORAMSTAT,ORAMSORT,ORAMC,ORAMI
"RTN","ORAM2",55,0)
 S ORAMDT=$$NOW^XLFDT,ORAMFDT=$$FMADD^XLFDT(ORAMDT,-DAYS),ORAMDFN=0
"RTN","ORAM2",56,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:+ORAMDFN'>0  D
"RTN","ORAM2",57,0)
 . N ORAMFS,ORAMCLIN S ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM2",58,0)
 . Q:ORAMCLIN'=$G(CLINIC)
"RTN","ORAM2",59,0)
 . S ORAMFS=$O(^ORAM(103,ORAMDFN,3," "),-1) Q:ORAMFS']""
"RTN","ORAM2",60,0)
 . S ORAMSTAT=$P(^ORAM(103,ORAMDFN,0),"^",10),ORAMVST=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),"^")
"RTN","ORAM2",61,0)
 . I ORAMSTAT'=2&(ORAMVST'>ORAMFDT) D
"RTN","ORAM2",62,0)
 . . N LINE S LINE=""
"RTN","ORAM2",63,0)
 . . S ORAMPT=$P(^DPT(ORAMDFN,0),"^"),ORAMPT=$P(ORAMPT,","),ORAMSSN=$E($P(^DPT(ORAMDFN,0),"^",9),6,9)
"RTN","ORAM2",64,0)
 . . S LINE=$$SETSTR^VALM1(ORAMPT,LINE,1,15)
"RTN","ORAM2",65,0)
 . . S LINE=$$SETSTR^VALM1("("_ORAMSSN_")",LINE,17,6)
"RTN","ORAM2",66,0)
 . . S LINE=$$SETSTR^VALM1("Last Seen: "_$$FMTE^XLFDT($P(ORAMVST,"."),"2DF"),LINE,25,19)
"RTN","ORAM2",67,0)
 . . S ORAMSORT($P(ORAMVST,"."),ORAMPT_ORAMSSN)=LINE
"RTN","ORAM2",68,0)
 S (ORAMC,ORAMI)=0
"RTN","ORAM2",69,0)
 F  S ORAMI=$O(ORAMSORT(ORAMI)) Q:+ORAMI'>0  D
"RTN","ORAM2",70,0)
 . N ORAMJ S ORAMJ=""
"RTN","ORAM2",71,0)
 . F  S ORAMJ=$O(ORAMSORT(ORAMI,ORAMJ)) Q:ORAMJ']""  D
"RTN","ORAM2",72,0)
 . . S ORAMC=ORAMC+1,RESULT(ORAMC)=$G(ORAMSORT(ORAMI,ORAMJ))
"RTN","ORAM2",73,0)
 I ORAMC=0 S RESULT(0)="No patients lost to follow-up "_DAYS_" days or longer."
"RTN","ORAM2",74,0)
NOACTQ Q
"RTN","ORAM2",75,0)
 ;
"RTN","ORAM2",76,0)
SHOWRATE(RESULT,DFN) ; CALCULATES SHOWRATE
"RTN","ORAM2",77,0)
 ;;RPC=ORAM2 NOSHOW
"RTN","ORAM2",78,0)
 N ORAMFSDT,ORAMFS,ORAMR,ORAMARR,ORAMPC,ORAMPTT0,ORAMRDT,ORAMRDT0
"RTN","ORAM2",79,0)
 S ORAMR=0,ORAMPTT0=0,ORAMRDT0=""
"RTN","ORAM2",80,0)
 S ORAMFSDT=0 F  S ORAMFSDT=$O(^ORAM(103,DFN,3,"B",ORAMFSDT)) Q:'ORAMFSDT  D
"RTN","ORAM2",81,0)
 . S ORAMFS=0 F  S ORAMFS=$O(^ORAM(103,DFN,3,"B",ORAMFSDT,ORAMFS)) Q:'ORAMFS  D
"RTN","ORAM2",82,0)
 .. N ORAMD0,ORAMSD,ORAMSCR,ORAMPTT,ORAMLCNT,ORAMLLN,ORAMDIFF
"RTN","ORAM2",83,0)
 .. S ORAMD0=$G(^ORAM(103,DFN,3,ORAMFS,0)),ORAMSCR=$P(ORAMD0,"^",13),ORAMSD=$P($P(ORAMD0,"^"),"."),ORAMPTT=$P(ORAMD0,"^",3)
"RTN","ORAM2",84,0)
 .. S ORAMLCNT=$P($G(^ORAM(103,DFN,3,ORAMFS,1,0)),"^",3) Q:'ORAMLCNT
"RTN","ORAM2",85,0)
 .. S ORAMLLN=$G(^ORAM(103,DFN,3,ORAMFS,1,ORAMLCNT,0))
"RTN","ORAM2",86,0)
 .. S ORAMRDT=$S($G(ORAMLLN)["Next draw:":$P($G(ORAMLLN)," ",3),$G(ORAMLLN)["Callback:":"C",$G(ORAMLLN)["Missed Appt;":"M",$G(ORAMLLN)["Edited by:":"E",1:$P($G(ORAMLLN)," "))
"RTN","ORAM2",87,0)
 .. I ORAMRDT="E" S ORAMLCNT=ORAMLCNT-1,ORAMLLN=$G(^ORAM(103,DFN,3,ORAMFS,1,ORAMLCNT,0))
"RTN","ORAM2",88,0)
 .. I  S ORAMRDT=$S($G(ORAMLLN)["Next draw:":$P($G(ORAMLLN)," ",3),$G(ORAMLLN)["Callback:":$P($G(ORAMLLN)," ",2),$G(ORAMLLN)["Missed Appt;":"Q",1:$P($G(ORAMLLN)," "))
"RTN","ORAM2",89,0)
 .. I ORAMRDT="M" S ORAMRDT=$P($G(ORAMLLN)," ",4),ORAMR=ORAMR+1 D DT^DILF("T",ORAMRDT,.ORAMRDT) S ORAMRDT0=ORAMRDT Q  ;NOTE PT MISSED DRAW, ADD ONE TO DENOMINATOR
"RTN","ORAM2",90,0)
 .. I $L(ORAMRDT)>1 D DT^DILF("T",ORAMRDT,.ORAMRDT)
"RTN","ORAM2",91,0)
 .. I ORAMRDT="C" S ORAMRDT=$P($G(ORAMLLN)," ",2) D DT^DILF("T",ORAMRDT,.ORAMRDT) S ORAMRDT=$$FMADD^XLFDT(ORAMRDT,-1)
"RTN","ORAM2",92,0)
 .. I 'ORAMPTT!($G(ORAMPTT0)=$G(ORAMPTT)) S ORAMRDT0=ORAMRDT Q
"RTN","ORAM2",93,0)
 .. S ORAMPTT0=ORAMPTT
"RTN","ORAM2",94,0)
 .. I ORAMRDT0'="" S ORAMDIFF=$$FMDIFF^XLFDT(ORAMSD,ORAMRDT0,2) S ORAMR=ORAMR+1 I ORAMDIFF>-172801&(ORAMDIFF<172801) S ORAMARR(0)=$G(ORAMARR(0))+1
"RTN","ORAM2",95,0)
 .. S ORAMRDT0=ORAMRDT
"RTN","ORAM2",96,0)
 I ORAMR>0 S ORAMPC=($G(ORAMARR(0))/ORAMR)*100,ORAMPC=$E(ORAMPC,1,4)
"RTN","ORAM2",97,0)
 S RESULT=$G(ORAMPC)_"^"_$G(ORAMR)
"RTN","ORAM2",98,0)
 Q
"RTN","ORAM2",99,0)
 ;
"RTN","ORAM2",100,0)
RPTSTART(ROOT,DFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,MAX,ORFHIE) ;
"RTN","ORAM2",101,0)
 ;;
"RTN","ORAM2",102,0)
 D START^ORWRP(80,"RPT^ORAM2(.ROOT,.DFN,.ID,.ALPHA,.OMEGA,.DTRANGE,.REMOTE,.MAX,.ORFHIE)",999)
"RTN","ORAM2",103,0)
 Q
"RTN","ORAM2",104,0)
 ;
"RTN","ORAM2",105,0)
RPT(ROOT,DFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,MAX,ORFHIE) ;
"RTN","ORAM2",106,0)
 N ORAMCNT,ORAMJ,ORAMHCT,ORAMCLIN,ORAMPIND
"RTN","ORAM2",107,0)
 I '$D(^ORAM(103,"B",DFN)) Q
"RTN","ORAM2",108,0)
 W $P(^DPT(DFN,0),"^"),"  ",$E($P(^DPT(DFN,0),"^",9),1,3),"-",$E($P(^DPT(DFN,0),"^",9),4,5),"-",$E($P(^DPT(DFN,0),"^",9),6,9)
"RTN","ORAM2",109,0)
 I $P(^ORAM(103,DFN,0),"^",10)=1 W !,?10,"******* COMPLEX PATIENT *******"
"RTN","ORAM2",110,0)
 S ORAMCLIN=$P($G(^ORAM(103,DFN,6)),U,2),ORAMPIND=""
"RTN","ORAM2",111,0)
 I +ORAMCLIN D
"RTN","ORAM2",112,0)
 . N ICDC
"RTN","ORAM2",113,0)
 . S ICDC=$$GET^XPAR(ORAMCLIN_";SC(","ORAM AUTO PRIMARY INDICATION",1,"E")
"RTN","ORAM2",114,0)
 . I ICDC]"" D
"RTN","ORAM2",115,0)
 . . N ICDD,ICDDL,ICDDESC
"RTN","ORAM2",116,0)
 . . S ICDDL=$$ICDD^ICDCODE(ICDC,"ICDDESC",DT)
"RTN","ORAM2",117,0)
 . . S ORAMPIND=ICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_ICDC_")"
"RTN","ORAM2",118,0)
 I ORAMPIND]"" D
"RTN","ORAM2",119,0)
 . W !!,"Primary Indication: ",$P(ORAMPIND,U,2)
"RTN","ORAM2",120,0)
 . W !,"  Add'l Indication: ",$P($P(^ORAM(103,DFN,0),"^",3),"=")," (",$P($P(^ORAM(103,DFN,0),"^",3),"=",2),")"
"RTN","ORAM2",121,0)
 . W !,"          Goal INR: ",$P(^ORAM(103,DFN,0),"^",2)
"RTN","ORAM2",122,0)
 E  D
"RTN","ORAM2",123,0)
 . W !!,"Primary Indication: ",$P($P(^ORAM(103,DFN,0),"^",3),"=")," (",$P($P(^ORAM(103,DFN,0),"^",3),"=",2),")",?38,"Goal INR: ",$P(^ORAM(103,DFN,0),"^",2)
"RTN","ORAM2",124,0)
 D HCT^ORAM(.ORAMHCT,DFN)
"RTN","ORAM2",125,0)
 I $L(ORAMHCT,U)>1 D  I 1
"RTN","ORAM2",126,0)
 . W !?10,"Last ",$S($$UP^XLFSTR($P(ORAMHCT,U,3))["HGB":"Hgb",$$UP^XLFSTR($P(ORAMHCT,U,3))["HEMOGLOBIN":"Hgb",1:"HCT"),": "
"RTN","ORAM2",127,0)
 . W $S($P(ORAMHCT,U)]"":$P(ORAMHCT,U),1:"No result")," on ",$S($P(ORAMHCT,U,2)]"":$P(ORAMHCT,U,2),1:"file")
"RTN","ORAM2",128,0)
 E  W !?10,ORAMHCT
"RTN","ORAM2",129,0)
 I +$P($G(^ORAM(103,DFN,6)),U,5)!+$O(^ORAM(103,DFN,7,0)) D
"RTN","ORAM2",130,0)
 . W !!,"Patient is Eligible for LMWH Bridging"
"RTN","ORAM2",131,0)
 . I +$O(^ORAM(103,DFN,7,0)) D
"RTN","ORAM2",132,0)
 .. N ORI S ORI=0
"RTN","ORAM2",133,0)
 .. W ":"
"RTN","ORAM2",134,0)
 .. F  S ORI=$O(^ORAM(103,DFN,7,ORI)) Q:+ORI'>0  W !?2,$G(^ORAM(103,DFN,7,ORI,0))
"RTN","ORAM2",135,0)
 . E  W "."
"RTN","ORAM2",136,0)
 I $P($G(^ORAM(103,DFN,1,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,1,0),"^",3) D
"RTN","ORAM2",137,0)
 . W !!,"Special Instructions:"
"RTN","ORAM2",138,0)
 . F ORAMJ=1:1:ORAMCNT W !?2,^ORAM(103,DFN,1,ORAMJ,0)
"RTN","ORAM2",139,0)
 I $P(^ORAM(103,DFN,0),"^",11)=2 W !?2,"Pt has given permission to leave anticoag msg on msg machine."
"RTN","ORAM2",140,0)
 I $P($G(^ORAM(103,DFN,4,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,4,0),"^",3) D
"RTN","ORAM2",141,0)
 . W !?2,"OK to leave anticoagulation message with:"
"RTN","ORAM2",142,0)
 . F ORAMJ=1:1:ORAMCNT W !?4,^ORAM(103,DFN,4,ORAMJ,0)
"RTN","ORAM2",143,0)
 I $P($G(^ORAM(103,DFN,2,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,2,0),"^",3) D
"RTN","ORAM2",144,0)
 . W !!,"Secondary Indication(s)/Risk Factors:"
"RTN","ORAM2",145,0)
 . F ORAMJ=1:1:ORAMCNT W !?2,^ORAM(103,DFN,2,ORAMJ,0)
"RTN","ORAM2",146,0)
 W !
"RTN","ORAM2",147,0)
 I $P(^ORAM(103,DFN,0),"^",5)'="" W !,"Start Date: ",$P(^ORAM(103,DFN,0),"^",5)
"RTN","ORAM2",148,0)
 I $P(^ORAM(103,DFN,0),"^",7)'="" W ?35,"Duration: ",$P(^ORAM(103,DFN,0),"^",7)
"RTN","ORAM2",149,0)
  W !,"==========================================================================="
"RTN","ORAM2",150,0)
  W !,"DATE",?10,"INR",?18,"Notified",?30,"TWD",?36,"Comments:"
"RTN","ORAM2",151,0)
  W !,"---------------------------------------------------------------------------"
"RTN","ORAM2",152,0)
 I $D(^ORAM(103,DFN,3,"B")) D
"RTN","ORAM2",153,0)
 . N ORAMFSD S ORAMFSD=" ",ORAMCNT=0
"RTN","ORAM2",154,0)
 . F  S ORAMFSD=$O(^ORAM(103,DFN,3,ORAMFSD),-1) Q:$G(ORAMFSD)<1  D
"RTN","ORAM2",155,0)
 .. I $$DTCHK(DFN,ALPHA,OMEGA,ORAMFSD)=0 Q  ;need to change this to the new date
"RTN","ORAM2",156,0)
 .. N ORAMDD1,ORAMDOSE,ORAMPS,ORAMPNOT
"RTN","ORAM2",157,0)
 .. I '+$D(^ORAM(103,DFN,3,ORAMFSD,"LOG",0)) W !,$$FMTE^XLFDT($E($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",9),1,7),2)  ;changed from $P(^ORAM(103,DFN,3,ORAMCNT,0),"^")
"RTN","ORAM2",158,0)
 .. I +$D(^ORAM(103,DFN,3,ORAMFSD,"LOG",0)) S ORAMDD1=$P($P(^ORAM(103,DFN,3,ORAMFSD,"LOG",1,0),"(",2),".") Q:'+$G(ORAMDD1)  W !,$$FMTE^XLFDT(ORAMDD1,2)
"RTN","ORAM2",159,0)
 .. S ORAMPNOT=$$WRAP^ORAMX($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",8),11)
"RTN","ORAM2",160,0)
 .. W ?11,$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",3) ;INR
"RTN","ORAM2",161,0)
 .. W ?18,$P(ORAMPNOT,"|") ;Pt Notified
"RTN","ORAM2",162,0)
 .. W ?30,$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",6) ;TWD
"RTN","ORAM2",163,0)
 .. ; Comments
"RTN","ORAM2",164,0)
 .. I $P($G(^ORAM(103,DFN,3,ORAMFSD,1,0)),"^",3)>0 D  I 1
"RTN","ORAM2",165,0)
 ... N ORAMCC,ORAMCLN S (ORAMCC,ORAMCLN)=0
"RTN","ORAM2",166,0)
 ... F  S ORAMCLN=$O(^ORAM(103,DFN,3,ORAMFSD,1,ORAMCLN)) Q:+ORAMCLN'>0  D
"RTN","ORAM2",167,0)
 .... I $P(^ORAM(103,DFN,3,ORAMFSD,0),"^",3)'="",ORAMCLN=2 W ?10,$$FMTE^XLFDT($P(^ORAM(103,DFN,3,ORAMFSD,0),"^"),2)
"RTN","ORAM2",168,0)
 .... W:ORAMCLN>1 ?18,$P(ORAMPNOT,"|",ORAMCLN)
"RTN","ORAM2",169,0)
 .... W ?38,^ORAM(103,DFN,3,ORAMFSD,1,ORAMCLN,0),!
"RTN","ORAM2",170,0)
 .... S ORAMCC=ORAMCC+1
"RTN","ORAM2",171,0)
 ... I $L(ORAMPNOT,"|")>ORAMCC D
"RTN","ORAM2",172,0)
 .... N ORAMI S ORAMI=0 F ORAMI=ORAMCC+1:1:$L(ORAMPNOT,"|") W ?18,$P(ORAMPNOT,"|",ORAMI),!
"RTN","ORAM2",173,0)
 .. E  D  W !
"RTN","ORAM2",174,0)
 ... I $L(ORAMPNOT,"|")>1 D
"RTN","ORAM2",175,0)
 .... N ORAMI S ORAMI=0 F ORAMI=2:1:$L(ORAMPNOT,"|") W ?18,$P(ORAMPNOT,"|",ORAMI),!
"RTN","ORAM2",176,0)
 .. ; Patient Instructions
"RTN","ORAM2",177,0)
 .. I +$O(^ORAM(103,DFN,3,ORAMFSD,3,0)) D
"RTN","ORAM2",178,0)
 ... N ORI S ORI=0
"RTN","ORAM2",179,0)
 ... W !,"Patient Instructions (from Letter):"
"RTN","ORAM2",180,0)
 ... F  S ORI=$O(^ORAM(103,DFN,3,ORAMFSD,3,ORI)) Q:+ORI'>0  D
"RTN","ORAM2",181,0)
 .... N ORPILN,ORJ S ORPILN=$G(^ORAM(103,DFN,3,ORAMFSD,3,ORI,0))
"RTN","ORAM2",182,0)
 .... S:$L(ORPILN)>77 ORPILN=$$WRAP^ORAMX(ORPILN,77)
"RTN","ORAM2",183,0)
 .... F ORJ=1:1:$L(ORPILN,"|") W !?2,$P(ORPILN,"|",ORJ)
"RTN","ORAM2",184,0)
 ... W !
"RTN","ORAM2",185,0)
 .. ; Daily Dosing
"RTN","ORAM2",186,0)
 .. S ORAMDOSE=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",7)
"RTN","ORAM2",187,0)
 .. I $L(ORAMDOSE) D
"RTN","ORAM2",188,0)
 ... N ORAMTP,ORAMTM,ORI
"RTN","ORAM2",189,0)
 ... S ORAMPS=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",5),(ORAMTP,ORAMTM)=0
"RTN","ORAM2",190,0)
 ... W !,"Current Dosing (using ",ORAMPS," mg tab):",!
"RTN","ORAM2",191,0)
 ... W ?4,"Sun",?8,"Mon",?12,"Tue",?16,"Wed",?20,"Thu",?24,"Fri",?28,"Sat",?32,"Tot",!
"RTN","ORAM2",192,0)
 ... W "Tab" F ORI=1:1:$L(ORAMDOSE,"|") S ORAMTP=ORAMTP+($P(ORAMDOSE,"|",ORI)/ORAMPS) W ?(4*ORI),$J(($P(ORAMDOSE,"|",ORI)/ORAMPS),3)
"RTN","ORAM2",193,0)
 ... W ?32,$J(ORAMTP,3),!
"RTN","ORAM2",194,0)
 ... W "mgs" F ORI=1:1:$L(ORAMDOSE,"|") S ORAMTM=ORAMTM+$P(ORAMDOSE,"|",ORI) W ?(4*ORI),$J($P(ORAMDOSE,"|",ORI),3)
"RTN","ORAM2",195,0)
 ... W ?32,$J(ORAMTM,3),!
"RTN","ORAM2",196,0)
 .. ; Complications
"RTN","ORAM2",197,0)
 .. I +$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",2) D
"RTN","ORAM2",198,0)
 ... N ORAMCTXT,ORAMCMPL
"RTN","ORAM2",199,0)
 ... S ORAMCTXT=$S($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",2)=1:"Major Bleed ",$P(^(0),"^",2)=2:"Complication(s) ",$P(^(0),"^",2)=3:"Minor Bleed ",1:"")
"RTN","ORAM2",200,0)
 ... I $D(^ORAM(103,DFN,3,ORAMFSD,2)) N ORAMRSF S ORAMRSF=0 F  S ORAMRSF=$O(^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF)) Q:ORAMRSF<1  D
"RTN","ORAM2",201,0)
 .... N ORI
"RTN","ORAM2",202,0)
 .... I ORAMRSF=1 W ?38,ORAMCTXT,"noted: (",^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF,0),")",! Q
"RTN","ORAM2",203,0)
 .... S ORAMCMPL=^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF,0)
"RTN","ORAM2",204,0)
 .... I $S(ORAMCMPL["MB:":1,ORAMCMPL["C:":1,1:0) S ORAMCMPL=$P(ORAMCMPL,":",2)
"RTN","ORAM2",205,0)
 .... I $L(ORAMCMPL)>37 S ORAMCMPL=$$WRAP^ORAMX(ORAMCMPL,37)
"RTN","ORAM2",206,0)
 .... F ORI=1:1:$L(ORAMCMPL,"|") W ?$S(ORI=1:38,1:40),$P(ORAMCMPL,"|",ORI),!
"RTN","ORAM2",207,0)
 .. W ?38,"-------------------------------------",!
"RTN","ORAM2",208,0)
 Q
"RTN","ORAM2",209,0)
 ;
"RTN","ORAM2",210,0)
 ;
"RTN","ORAM2",211,0)
DTCHK(DFN,ALPHA,OMEGA,ORAMFSD) ; CHECKS DATE RANGE WITH ALPHA AND OMEGA FROM CPRS
"RTN","ORAM2",212,0)
 N ORAMFDT,ORAMVAL
"RTN","ORAM2",213,0)
 S ORAMVAL=0
"RTN","ORAM2",214,0)
 S ORAMFDT=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^")
"RTN","ORAM2",215,0)
 S:ORAMFDT'<ALPHA ORAMVAL=1
"RTN","ORAM2",216,0)
 S:ORAMFDT>OMEGA ORAMVAL=0
"RTN","ORAM2",217,0)
 Q ORAMVAL
"RTN","ORAM2",218,0)
 ;
"RTN","ORAM2",219,0)
TEAMCHK(RESULT,ORAMTMS) ; SET-UP VERIFY NAMES
"RTN","ORAM2",220,0)
 ;RPC=ORAM2 TEAM CHECK
"RTN","ORAM2",221,0)
 N ORAMSKIP,ORAMI,ORAMERR
"RTN","ORAM2",222,0)
 Q:$G(ORAMTMS)=""
"RTN","ORAM2",223,0)
 F ORAMI=1:1:20 S ORAMSKIP=$G(ORAMSKIP)_" "
"RTN","ORAM2",224,0)
 S ORAMERR=0
"RTN","ORAM2",225,0)
 F ORAMI=1:1:$L(ORAMTMS,"^") D
"RTN","ORAM2",226,0)
 . N ORAMN
"RTN","ORAM2",227,0)
 . I $P(ORAMTMS,"^",ORAMI)'="" S ORAMN=$P(ORAMTMS,"^",ORAMI) D
"RTN","ORAM2",228,0)
 .. S RESULT(ORAMI)=ORAMN_$E(ORAMSKIP,1,(20-$L(ORAMN)))
"RTN","ORAM2",229,0)
 .. I $D(^OR(100.21,ORAMN)) S RESULT(ORAMI)=RESULT(ORAMI)_$P(^OR(100.21,ORAMN,0),"^")
"RTN","ORAM2",230,0)
 .. E  S RESULT(ORAMI)=RESULT(ORAMI)_"clinic not found.",ORAMERR=$G(ORAMERR)+1
"RTN","ORAM2",231,0)
 S RESULT(0)=$G(ORAMERR)
"RTN","ORAM2",232,0)
 Q
"RTN","ORAM2",233,0)
 ;
"RTN","ORAM2",234,0)
REMIND(RESULT,ORAMDFN,ORAMDT,ORAMREM) ; RPC=ORAM2 REMINDER
"RTN","ORAM2",235,0)
 N ORAMRML,ORAMDAY,ORAMR,D0,DA,DIK,X
"RTN","ORAM2",236,0)
 Q:'+$G(ORAMDFN)  Q:$G(ORAMDT)=""  Q:$G(ORAMREM)=""
"RTN","ORAM2",237,0)
 S RESULT=0
"RTN","ORAM2",238,0)
 D NOW^%DTC S ORAMDAY=X D DT^DILF(,ORAMDT,.X) S ORAMDT=X
"RTN","ORAM2",239,0)
 S $P(^ORAM(103,ORAMDFN,0),"^",18)=$G(ORAMDT)
"RTN","ORAM2",240,0)
 K ^ORAM(103,ORAMDFN,5)
"RTN","ORAM2",241,0)
 S ORAMRML=$L(ORAMREM,"^"),^ORAM(103,ORAMDFN,5,0)="^^"_ORAMRML_"^"_ORAMRML_"^"_ORAMDAY_"^"
"RTN","ORAM2",242,0)
 F ORAMR=1:1:ORAMRML D
"RTN","ORAM2",243,0)
 . S ^ORAM(103,ORAMDFN,5,ORAMR,0)=$P(ORAMREM,"^",ORAMR)
"RTN","ORAM2",244,0)
 S DIK="^ORAM(103,",DA=ORAMDFN
"RTN","ORAM2",245,0)
 D IX^DIK
"RTN","ORAM2",246,0)
 S RESULT=1
"RTN","ORAM2",247,0)
 Q
"RTN","ORAM3")
0^4^B38571379^n/a
"RTN","ORAM3",1,0)
ORAM3 ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (4 of 4)  ;12/09/09  14:44
"RTN","ORAM3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAM3",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM3",4,0)
 Q
"RTN","ORAM3",5,0)
 ;
"RTN","ORAM3",6,0)
PTADR(RESULT,ORAMDFN) ;GET PT ADDRESS
"RTN","ORAM3",7,0)
 ;;CALLED BY ORAM3 ADDRESS
"RTN","ORAM3",8,0)
 N ORAMADD,ORAMADD2,ORAMADD3,ORAMCITY,ORAMCODE,ORAMST,ORAMZIP,ORAMBAD,ORAMT
"RTN","ORAM3",9,0)
 S ORAMT=.11,ORAMST="",ORAMBAD=0
"RTN","ORAM3",10,0)
 I '$G(ORAMDFN) S RESULT="NONE" Q
"RTN","ORAM3",11,0)
 I $$TMPCHK(ORAMDFN)=1 S ORAMT=.121
"RTN","ORAM3",12,0)
 S ORAMADD=$P($G(^DPT(ORAMDFN,ORAMT)),"^"),ORAMADD2=$P($G(^DPT(ORAMDFN,ORAMT)),"^",2),ORAMADD3=$P($G(^DPT(ORAMDFN,ORAMT)),"^",3)
"RTN","ORAM3",13,0)
 S ORAMCITY=$P($G(^DPT(ORAMDFN,ORAMT)),"^",4),ORAMCODE=$P($G(^DPT(ORAMDFN,ORAMT)),"^",5),ORAMZIP=$P($G(^DPT(ORAMDFN,ORAMT)),"^",6),ORAMBAD=$P($G(^DPT(ORAMDFN,.11)),"^",16)
"RTN","ORAM3",14,0)
 I ORAMCODE S ORAMST=$P($G(^DIC(5,$G(ORAMCODE),0)),"^",2)
"RTN","ORAM3",15,0)
 S:$G(ORAMBAD)="" ORAMBAD=0
"RTN","ORAM3",16,0)
 S RESULT=ORAMADD_"^"_ORAMADD2_"^"_ORAMADD3_"^"_ORAMCITY_"^"_ORAMST_"^"_ORAMZIP_"^"_$G(ORAMBAD)_"^"_$G(ORAMT)
"RTN","ORAM3",17,0)
 Q
"RTN","ORAM3",18,0)
 ;
"RTN","ORAM3",19,0)
PTFONE(RESULT,ORAMDFN) ;GET PT PHONE NUMBERS
"RTN","ORAM3",20,0)
 ;;RPC=ORAM3 PHONE
"RTN","ORAM3",21,0)
 ;;RESULT=HOMEPHONE^WORKPHONE^CELLNUMBER^PAGER^EMAIL
"RTN","ORAM3",22,0)
 N ORAMF1,ORAMF2,ORAMFC,ORAMP,ORAMEM,ORAMT S ORAMT=0
"RTN","ORAM3",23,0)
 I '$G(ORAMDFN) S RESULT="NONE" Q
"RTN","ORAM3",24,0)
 I $$TMPCHK(ORAMDFN)=1 S ORAMT=1
"RTN","ORAM3",25,0)
 I ORAMT=0 D
"RTN","ORAM3",26,0)
 . S ORAMF1=$P($G(^DPT(ORAMDFN,.13)),"^"),ORAMF2=$P($G(^DPT(ORAMDFN,.13)),"^",2)
"RTN","ORAM3",27,0)
 . S ORAMFC=$P($G(^DPT(ORAMDFN,.13)),"^",4),ORAMP=$P($G(^DPT(ORAMDFN,.13)),"^",5),ORAMEM=$P($G(^DPT(ORAMDFN,.13)),"^",3)
"RTN","ORAM3",28,0)
 I ORAMT=1 D
"RTN","ORAM3",29,0)
 . S ORAMF1=$P($G(^DPT(ORAMDFN,.121)),"^",10),ORAMF2=$P($G(^DPT(ORAMDFN,.13)),"^",2)
"RTN","ORAM3",30,0)
 . S ORAMFC=$P($G(^DPT(ORAMDFN,.13)),"^",4),ORAMP=$P($G(^DPT(ORAMDFN,.13)),"^",5),ORAMEM=$P($G(^DPT(ORAMDFN,.13)),"^",3)
"RTN","ORAM3",31,0)
 S RESULT=$G(ORAMF1)_"^"_$G(ORAMF2)_"^"_$G(ORAMFC)_"^"_$G(ORAMP)_"^"_$G(ORAMEM)_"^"_$G(ORAMT)
"RTN","ORAM3",32,0)
 Q
"RTN","ORAM3",33,0)
 ;
"RTN","ORAM3",34,0)
TMPCHK(ORAMDFN) ;
"RTN","ORAM3",35,0)
 ;;
"RTN","ORAM3",36,0)
 N ORAMTMP S ORAMTMP=0
"RTN","ORAM3",37,0)
 I $D(^DPT(ORAMDFN,.121)),$P(^DPT(ORAMDFN,.121),"^",9)="Y" D
"RTN","ORAM3",38,0)
 . Q:$P(^DPT(ORAMDFN,.121),"^",7)>DT  ;START DATE
"RTN","ORAM3",39,0)
 . I $P(^DPT(ORAMDFN,.121),"^",8)'="" Q:DT>$P(^DPT(ORAMDFN,.121),"^",8)  ;END DATE
"RTN","ORAM3",40,0)
 . S ORAMTMP=1
"RTN","ORAM3",41,0)
 Q ORAMTMP
"RTN","ORAM3",42,0)
 ;RSF 10/08/08  CHANGE TO CODE DUE TO NEWLY DISCOVERED PROBLEM WITH 'COMPLICATIONS'
"RTN","ORAM3",43,0)
COMPENT(RESULT,ORAMDFN,ORAMDUZ,ORAMC,ORAMCT,ORAMD2) ;
"RTN","ORAM3",44,0)
 ;RPC=ORAM3 COMPLICATION
"RTN","ORAM3",45,0)
 Q:'+$G(ORAMDFN)
"RTN","ORAM3",46,0)
 Q:'$G(ORAMDUZ)
"RTN","ORAM3",47,0)
 Q:'+$G(ORAMC)
"RTN","ORAM3",48,0)
 Q:$G(ORAMD2)=""
"RTN","ORAM3",49,0)
 N ORAMD3,ORAMX D DT^DILF(,ORAMD2,.ORAMX) S ORAMD3=ORAMX
"RTN","ORAM3",50,0)
 N ORAMNOW,ORAMDAY,X,% D NOW^%DTC S ORAMNOW=%,ORAMDAY=X
"RTN","ORAM3",51,0)
 N ORAMNX S ORAMNX=$O(^ORAM(103,ORAMDFN,3," "),-1)+1
"RTN","ORAM3",52,0)
 N ORAMC2,ORAMLLOC,ORAMPS,ORAMDD,ORAMTWD,ORAML,OERR
"RTN","ORAM3",53,0)
 I '$G(ORAMNX) S ORAMNX=1
"RTN","ORAM3",54,0)
 I ORAMNX>1 D
"RTN","ORAM3",55,0)
 . S ORAML=ORAMNX-1,ORAMLLOC=$P(^ORAM(103,ORAMDFN,3,ORAML,0),"^",4),ORAMPS=$P(^(0),"^",5),ORAMTWD=$P(^(0),"^",6),ORAMDD=$P(^(0),"^",7)
"RTN","ORAM3",56,0)
 I ORAMC>99 S ORAMC2=2  ;CLOT in the 100 range...I P1>100,P1#100>0 S P1=3 Q
"RTN","ORAM3",57,0)
 I ORAMC#10>0 S ORAMC2=1  ;MAJOR BLEED I P1>99 S P1=2 Q
"RTN","ORAM3",58,0)
 I ORAMC=10 S ORAMC2=3  ;MINOR BLEED
"RTN","ORAM3",59,0)
 N DA,IENS,ORAMRSF,ORAMF
"RTN","ORAM3",60,0)
 S IENS="+1,"_ORAMDFN_","
"RTN","ORAM3",61,0)
 S DA=ORAMNX,DA(1)=ORAMDFN
"RTN","ORAM3",62,0)
 S ORAMRSF(103.011,IENS,.01)=ORAMD3  ;COMPLICATION DATE
"RTN","ORAM3",63,0)
 S ORAMRSF(103.011,IENS,30)=ORAMLLOC  ;LAB DRAW LOC
"RTN","ORAM3",64,0)
 S ORAMRSF(103.011,IENS,40)=ORAMPS  ;PILL STRENGTH
"RTN","ORAM3",65,0)
 S ORAMRSF(103.011,IENS,50)=ORAMTWD  ;TOTAL WEEK DOSE
"RTN","ORAM3",66,0)
 S ORAMRSF(103.011,IENS,60)=ORAMDD  ;DAILY DOSING
"RTN","ORAM3",67,0)
 S ORAMRSF(103.011,IENS,80)=ORAMNOW
"RTN","ORAM3",68,0)
 S ORAMRSF(103.011,IENS,90)=ORAMDUZ  ;PROVIDER
"RTN","ORAM3",69,0)
 S ORAMRSF(103.011,IENS,104)=ORAMC2  ;COMPLICATION CODE
"RTN","ORAM3",70,0)
 K ORAMF
"RTN","ORAM3",71,0)
 S ORAMF(ORAMNX)=DA
"RTN","ORAM3",72,0)
 K OERR
"RTN","ORAM3",73,0)
 D UPDATE^DIE("","ORAMRSF","ORAMF","OERR")
"RTN","ORAM3",74,0)
 S ^ORAM(103,ORAMDFN,3,ORAMNX,2,1,0)=ORAMD2
"RTN","ORAM3",75,0)
 I $L(ORAMCT,"^")>0 N ORAMCC F ORAMCC=1:1:$L(ORAMCT,"^") D  S ^ORAM(103,ORAMDFN,3,ORAMNX,2,0)="^^"_ORAMCC_"^"_ORAMCC_"^"_ORAMDAY_"^"
"RTN","ORAM3",76,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMNX,2,ORAMCC+1,0)=$P(ORAMCT,"^",ORAMCC)
"RTN","ORAM3",77,0)
 S RESULT=1
"RTN","ORAM3",78,0)
 Q
"RTN","ORAM3",79,0)
 ;
"RTN","ORAM3",80,0)
TLISTS ; Erases and sets Team Lists for Anticoagulation Clinics
"RTN","ORAM3",81,0)
 ; Option: ORAM SET TEAMS
"RTN","ORAM3",82,0)
 N ORAMLIST  ;ARRAYS OF TEAMS
"RTN","ORAM3",83,0)
 D FTL(.ORAMLIST)
"RTN","ORAM3",84,0)
 I '$D(ORAMLIST) Q  ;No lists defined
"RTN","ORAM3",85,0)
 D ETEAM(.ORAMLIST)  ;ERASE ALL TEAM LISTS
"RTN","ORAM3",86,0)
 D MTEAM(.ORAMLIST)  ;FORM TODAY'S TEAM LISTS
"RTN","ORAM3",87,0)
 Q
"RTN","ORAM3",88,0)
 ;
"RTN","ORAM3",89,0)
FTL(ORAMLIST) ;FIND TEAM LISTS  CALLED FROM TLISTS
"RTN","ORAM3",90,0)
 ;
"RTN","ORAM3",91,0)
 N ORAMI,ORAMCLST S ORAMI=0
"RTN","ORAM3",92,0)
 D GETCLINS^ORAMSET(.ORAMCLST)
"RTN","ORAM3",93,0)
 I +$G(ORAMCLST(0))'>0 Q  ;Site not SET UP
"RTN","ORAM3",94,0)
 ; Loop through Clinics, get team lists for each
"RTN","ORAM3",95,0)
 F  S ORAMI=$O(ORAMCLST(ORAMI)) Q:+ORAMI'>0  D
"RTN","ORAM3",96,0)
 . N ORAMCL,ORAMALL,ORAMCPLX
"RTN","ORAM3",97,0)
 . S ORAMCL=$P($G(ORAMCLST(ORAMI)),U,2) Q:+ORAMCL'>0
"RTN","ORAM3",98,0)
 . S ORAMALL=$$GET^XPAR(ORAMCL,"ORAM TEAM LIST (ALL)",1,"I")
"RTN","ORAM3",99,0)
 . S:ORAMALL]"" ORAMLIST(ORAMCL,"ALL")=ORAMALL
"RTN","ORAM3",100,0)
 . S ORAMCPLX=$$GET^XPAR(ORAMCL,"ORAM TEAM LIST (COMPLEX)",1,"I")
"RTN","ORAM3",101,0)
 . S:ORAMCPLX]"" ORAMLIST(ORAMCL,"COMPLEX")=ORAMCPLX
"RTN","ORAM3",102,0)
 Q
"RTN","ORAM3",103,0)
 ;
"RTN","ORAM3",104,0)
ETEAM(ORAMLIST) ; Remove all Anticoagulation Patients from their respective lists
"RTN","ORAM3",105,0)
 ; called from TLISTS
"RTN","ORAM3",106,0)
 N ORAMI S ORAMI=""
"RTN","ORAM3",107,0)
 F  S ORAMI=$O(ORAMLIST(ORAMI)) Q:ORAMI']""  D
"RTN","ORAM3",108,0)
 . N ORAML S ORAML=""
"RTN","ORAM3",109,0)
 . F  S ORAML=$O(ORAMLIST(ORAMI,ORAML)) Q:ORAML']""  D
"RTN","ORAM3",110,0)
 . . N DO,DA,DIK
"RTN","ORAM3",111,0)
 . . S DA(1)=ORAMLIST(ORAMI,ORAML),DIK="^OR(100.21"_","_DA(1)_",10,"
"RTN","ORAM3",112,0)
 . . S DA=0 F  S DA=$O(^OR(100.21,DA(1),10,DA)) Q:+DA'>0  D
"RTN","ORAM3",113,0)
 . . . D ^DIK
"RTN","ORAM3",114,0)
 Q
"RTN","ORAM3",115,0)
 ;
"RTN","ORAM3",116,0)
MTEAM(ORAMLIST) ; Build Today's Team Lists
"RTN","ORAM3",117,0)
 ; CALLED FROM TLISTS
"RTN","ORAM3",118,0)
 N ORAMCL S ORAMCL=""
"RTN","ORAM3",119,0)
 ; Loop through ORAMLIST by clinic location
"RTN","ORAM3",120,0)
 F  S ORAMCL=$O(ORAMLIST(ORAMCL)) Q:ORAMCL']""  D
"RTN","ORAM3",121,0)
 . N ORAMCN,ORAMCA,ORAMCC,ORAMDFN
"RTN","ORAM3",122,0)
 . S ORAMCN=+ORAMCL                        ; Pointer to file 44
"RTN","ORAM3",123,0)
 . S ORAMCA=$G(ORAMLIST(ORAMCL,"ALL"))     ; Pointer to "All" List
"RTN","ORAM3",124,0)
 . S ORAMCC=$G(ORAMLIST(ORAMCL,"COMPLEX")) ; Pointer to "Complex" List
"RTN","ORAM3",125,0)
 . ; Loop through Anticoagulation Patients by location
"RTN","ORAM3",126,0)
 . S ORAMDFN=0
"RTN","ORAM3",127,0)
 . F  S ORAMDFN=$O(^ORAM(103,"CL",ORAMCN,ORAMDFN)) Q:+ORAMDFN'>0  D
"RTN","ORAM3",128,0)
 . . N ORAMD0,ORAMRDT,ORAMCPLX,ORAMNDCB,ORAMAXDT
"RTN","ORAM3",129,0)
 . . S ORAMD0=$G(^ORAM(103,ORAMDFN,0))
"RTN","ORAM3",130,0)
 . . S ORAMRDT=$P(ORAMD0,U,4)   ; Pt's Return Date
"RTN","ORAM3",131,0)
 . . S ORAMAXDT=DT_".2359"      ; Upper bound for return date range
"RTN","ORAM3",132,0)
 . . S ORAMCPLX=$P(ORAMD0,U,10) ; Pt's Complexity
"RTN","ORAM3",133,0)
 . . S ORAMNDCB=$P(ORAMD0,U,20) ; Next Day Callback
"RTN","ORAM3",134,0)
 . . ; if next day callback, increment return date, disregard time
"RTN","ORAM3",135,0)
 . . I +ORAMNDCB S ORAMRDT=$$FMADD^XLFDT($P(ORAMRDT,"."),1)
"RTN","ORAM3",136,0)
 . . ; if future return date or pt inactive, quit to next pt
"RTN","ORAM3",137,0)
 . . I (ORAMRDT>ORAMAXDT)!(ORAMCPLX=2) Q
"RTN","ORAM3",138,0)
 . . ; otherwise, add pt to appropriate list(s) for location
"RTN","ORAM3",139,0)
 . . D ADDLIST(ORAMDFN,ORAMCA) ; All active pts on "ALL" List
"RTN","ORAM3",140,0)
 . . I ORAMCPLX=1 D ADDLIST(ORAMDFN,ORAMCC) ; Complex pts also on "COMPLEX" List
"RTN","ORAM3",141,0)
 Q
"RTN","ORAM3",142,0)
ADDLIST(ORAMDFN,ORAMLDA) ; Add pt to Team List / Assure record is UNLOCKED
"RTN","ORAM3",143,0)
 N DIC,DA,DO,X,ORAMLR
"RTN","ORAM3",144,0)
 S X=ORAMDFN_";DPT("
"RTN","ORAM3",145,0)
 S DA(1)=ORAMLDA,DIC="^OR(100.21"_","_DA(1)_",10,",DIC(0)="L" D FILE^DICN
"RTN","ORAM3",146,0)
 D UNLOCK^ORAM1(.ORAMLR,ORAMDFN)
"RTN","ORAM3",147,0)
 Q
"RTN","ORAMSET")
0^5^B40743224^n/a
"RTN","ORAMSET",1,0)
ORAMSET ; ISL/JER - Anticoagulation Setup ;12/17/09  08:38
"RTN","ORAMSET",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAMSET",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMSET",4,0)
 Q
"RTN","ORAMSET",5,0)
 ;
"RTN","ORAMSET",6,0)
SET ; Enter Parameters
"RTN","ORAMSET",7,0)
 N ORAMDIV,ORAMPARM,DIRUT,DUOUT,DTOUT,ORT0,ORAMTOUT K DIROUT
"RTN","ORAMSET",8,0)
 S ORAMDIV=$$GETDIV Q:+ORAMDIV'>0
"RTN","ORAMSET",9,0)
 S ORT0=$$NOW^XLFDT
"RTN","ORAMSET",10,0)
 D TED^XPAREDIT("ORAM PARAMETERS","B",ORAMDIV) Q:+$G(DIROUT)!+$$TIMEOUT(ORT0)
"RTN","ORAMSET",11,0)
 ; If Consult Link Enabled, ask Consult Request Service
"RTN","ORAMSET",12,0)
 I +$$GET^XPAR(ORAMDIV,"ORAM CONSULT LINK ENABLED") D  Q:+$D(DUOUT)!+$D(DTOUT)
"RTN","ORAMSET",13,0)
 . S ORAMPARM=+$$GETPARM("ORAM CONSULT REQUEST SERVICE")_U_"Consult Request Service" Q:+ORAMPARM'>0
"RTN","ORAMSET",14,0)
 . D EDIT^XPAREDIT(ORAMDIV,ORAMPARM)
"RTN","ORAMSET",15,0)
 ; Ask PCE Link Enabled
"RTN","ORAMSET",16,0)
 S ORAMPARM=+$$GETPARM("ORAM PCE LINK ENABLED")_U_"PCE Link Enabled" Q:+ORAMPARM'>0
"RTN","ORAMSET",17,0)
 D EDIT^XPAREDIT(ORAMDIV,ORAMPARM) Q:+$G(DIROUT)!+$G(DIRUT)!+$D(DTOUT)
"RTN","ORAMSET",18,0)
 ; Continue with PCE Parameter Template if TRUE
"RTN","ORAMSET",19,0)
 I +$$GET^XPAR(ORAMDIV,"ORAM PCE LINK ENABLED") D  Q:+$G(DIROUT)!+$G(ORAMTOUT)
"RTN","ORAMSET",20,0)
 . S ORT0=$$NOW^XLFDT
"RTN","ORAMSET",21,0)
 . D TED^XPAREDIT("ORAM PCE PARAMETERS","B",ORAMDIV)
"RTN","ORAMSET",22,0)
 . S ORAMTOUT=$$TIMEOUT(ORT0)
"RTN","ORAMSET",23,0)
 ; Continue with Letter Template
"RTN","ORAMSET",24,0)
 D TED^XPAREDIT("ORAM LETTER PARAMETERS","B",ORAMDIV)
"RTN","ORAMSET",25,0)
 Q
"RTN","ORAMSET",26,0)
 ;
"RTN","ORAMSET",27,0)
SETDIV ; Enter Site Parameters
"RTN","ORAMSET",28,0)
 N ORAMDIV,DIRUT,DUOUT,DTOUT K DIROUT
"RTN","ORAMSET",29,0)
 S ORAMDIV=$$GETDIV Q:+ORAMDIV'>0
"RTN","ORAMSET",30,0)
 D TED^XPAREDIT("ORAM SITE PARAMETERS","BA",ORAMDIV)
"RTN","ORAMSET",31,0)
 Q
"RTN","ORAMSET",32,0)
 ;
"RTN","ORAMSET",33,0)
SETCLIN ; Enter Clinic Parameters
"RTN","ORAMSET",34,0)
 N ORAMCLIN,DIRUT,DUOUT,DTOUT K DIROUT
"RTN","ORAMSET",35,0)
 S ORAMCLIN=$$SELLOC Q:+ORAMCLIN'>0
"RTN","ORAMSET",36,0)
 D TED^XPAREDIT("ORAM CLINIC PARAMETERS","BA",ORAMCLIN)
"RTN","ORAMSET",37,0)
 Q
"RTN","ORAMSET",38,0)
 ;
"RTN","ORAMSET",39,0)
TIMEOUT(T0) ; Evaluate whether TED^XPAREDIT timed-out (since it NEWs DTOUT and DIRUT)
"RTN","ORAMSET",40,0)
 Q $S($$FMDIFF^XLFDT($$NOW^XLFDT,T0,2)'<DTIME:1,1:0)
"RTN","ORAMSET",41,0)
 ;
"RTN","ORAMSET",42,0)
GETCLINS(RESULT) ; Get Clinics
"RTN","ORAMSET",43,0)
 N LIST,ERR,ORAME,ORAMI S ORAME="",ORAMI=0
"RTN","ORAMSET",44,0)
 D ENVAL^XPAR(.LIST,"ORAM CLINIC NAME",1,.ERR)
"RTN","ORAMSET",45,0)
 I 'LIST S RESULT(0)=0 Q
"RTN","ORAMSET",46,0)
 F  S ORAME=$O(LIST(ORAME)) Q:ORAME']""  D
"RTN","ORAMSET",47,0)
 . N ORAMV S ORAMV=$G(LIST(ORAME,1)) Q:ORAMV']""
"RTN","ORAMSET",48,0)
 . S ORAMI=ORAMI+1,RESULT(ORAMI)=ORAMV_U_ORAME
"RTN","ORAMSET",49,0)
 . S RESULT(0)=ORAMI
"RTN","ORAMSET",50,0)
 Q
"RTN","ORAMSET",51,0)
 ;
"RTN","ORAMSET",52,0)
CLIN4PT(RESULT,ORAMDFN) ; Get the Clinic which is following the patient
"RTN","ORAMSET",53,0)
 N ORAMCL
"RTN","ORAMSET",54,0)
 S ORAMCL=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAMSET",55,0)
 S RESULT=$S(+ORAMCL>0:ORAMCL_";SC(",1:0)
"RTN","ORAMSET",56,0)
 Q
"RTN","ORAMSET",57,0)
 ;
"RTN","ORAMSET",58,0)
GET(RESULT,ORAMENT) ; Get Parameters
"RTN","ORAMSET",59,0)
 N ADD1,ADD2,ADD3,DNOTE,ENOTE,INOTE,ATEAM,CBCQO,CTEAM,CFAX,CPHONE,ORAMALL
"RTN","ORAMSET",60,0)
 N CENAB,CSVC,CPLXPH,IVST,LTR,ORIENT,SMPLPH,SVST,DSSID,DSSUNIT,HCT,HCTNM,NLABTM,TOLLFREE
"RTN","ORAMSET",61,0)
 N INRQO,MCNM,NCLOC,PCEON,PHCLIN,POCNM,RPATH,SIGNM,SIGTTL,SITENM,VLOC,PILLSTR,ICDC,DPIND
"RTN","ORAMSET",62,0)
 S ORAMENT=$S($G(ORAMENT)]"":$G(ORAMENT),1:"ALL"),DPIND=""
"RTN","ORAMSET",63,0)
 S ORAMALL=$S(ORAMENT["ALL":ORAMENT,1:"ALL^"_ORAMENT)
"RTN","ORAMSET",64,0)
 S ADD1=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 1",1,"I")
"RTN","ORAMSET",65,0)
 S ADD2=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 2",1,"I")
"RTN","ORAMSET",66,0)
 S ADD3=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 3",1,"I")
"RTN","ORAMSET",67,0)
 S DNOTE=$$GET^XPAR(ORAMALL,"ORAM DISCHARGE NOTE",1,"I")
"RTN","ORAMSET",68,0)
 S ENOTE=$$GET^XPAR(ORAMALL,"ORAM INTERIM NOTE",1,"I")
"RTN","ORAMSET",69,0)
 S INOTE=$$GET^XPAR(ORAMALL,"ORAM INITIAL NOTE",1,"I")
"RTN","ORAMSET",70,0)
 S ATEAM=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (ALL)",1,"I")
"RTN","ORAMSET",71,0)
 S CTEAM=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (COMPLEX)",1,"I")
"RTN","ORAMSET",72,0)
 S CBCQO=$$GET^XPAR(ORAMALL,"ORAM CBC QUICK ORDER",1,"I")
"RTN","ORAMSET",73,0)
 S CFAX=$$GET^XPAR(ORAMENT,"ORAM CLINIC FAX NUMBER",1,"I")
"RTN","ORAMSET",74,0)
 S CPHONE=$$GET^XPAR(ORAMENT,"ORAM CLINIC PHONE NUMBER",1,"I")
"RTN","ORAMSET",75,0)
 S TOLLFREE=$$GET^XPAR(ORAMENT,"ORAM TOLL FREE PHONE",1,"I")
"RTN","ORAMSET",76,0)
 S CENAB=$$GET^XPAR(ORAMENT,"ORAM CONSULT LINK ENABLED",1,"I")
"RTN","ORAMSET",77,0)
 S CSVC=$$GET^XPAR(ORAMENT,"ORAM CONSULT REQUEST SERVICE",1,"E")
"RTN","ORAMSET",78,0)
 S CPLXPH=$$GET^XPAR(ORAMALL,"ORAM CPT FOR COMPLEX PHONE",1,"I")
"RTN","ORAMSET",79,0)
 S IVST=$$GET^XPAR(ORAMALL,"ORAM CPT FOR INITIAL VISIT",1,"I")
"RTN","ORAMSET",80,0)
 S LTR=$$GET^XPAR(ORAMALL,"ORAM CPT FOR LETTER TO PT",1,"I")
"RTN","ORAMSET",81,0)
 S ORIENT=$$GET^XPAR(ORAMALL,"ORAM CPT FOR ORIENTATION",1,"I")
"RTN","ORAMSET",82,0)
 S SMPLPH=$$GET^XPAR(ORAMALL,"ORAM CPT FOR SIMPLE PHONE",1,"I")
"RTN","ORAMSET",83,0)
 S SVST=$$GET^XPAR(ORAMALL,"ORAM CPT FOR SUBSEQUENT VISIT",1,"I")
"RTN","ORAMSET",84,0)
 S DSSID=$$GET^XPAR(ORAMALL,"ORAM DSS ID",1,"I")
"RTN","ORAMSET",85,0)
 S DSSUNIT=$$GET^XPAR(ORAMALL,"ORAM DSS UNIT",1,"I")
"RTN","ORAMSET",86,0)
 S HCT=$$GET^XPAR(ORAMALL,"ORAM HCT/HGB REFERENCE",1,"B")
"RTN","ORAMSET",87,0)
 S HCTNM=$P(HCT,U,2)
"RTN","ORAMSET",88,0)
 S HCT=$P(HCT,U)
"RTN","ORAMSET",89,0)
 S INRQO=$$GET^XPAR(ORAMALL,"ORAM INR QUICK ORDER",1,"I")
"RTN","ORAMSET",90,0)
 S MCNM=$$GET^XPAR(ORAMALL,"ORAM MEDICAL CENTER NAME",1,"I")
"RTN","ORAMSET",91,0)
 S NCLOC=$$GET^XPAR(ORAMENT,"ORAM NON-COUNT LOCATION",1,"I")
"RTN","ORAMSET",92,0)
 S PCEON=$$GET^XPAR(ORAMENT,"ORAM PCE LINK ENABLED",1,"I")
"RTN","ORAMSET",93,0)
 S ICDC=$$GET^XPAR(ORAMENT,"ORAM AUTO PRIMARY INDICATION",1,"E")
"RTN","ORAMSET",94,0)
 I ICDC]"" D
"RTN","ORAMSET",95,0)
 . N ICDD,ICDDL,ICDDESC
"RTN","ORAMSET",96,0)
 . S ICDDL=$$ICDD^ICDCODE(ICDC,"ICDDESC",DT)
"RTN","ORAMSET",97,0)
 . S DPIND=ICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_ICDC_")"
"RTN","ORAMSET",98,0)
 S PHCLIN=$$GET^XPAR(ORAMENT,"ORAM PHONE CLINIC",1,"I")
"RTN","ORAMSET",99,0)
 S PILLSTR=$$GET^XPAR(ORAMENT,"ORAM DEFAULT PILL STRENGTH",1,"I")
"RTN","ORAMSET",100,0)
 S NLABTM=$$GET^XPAR(ORAMENT,"ORAM INCL TIME W/NEXT INR DATE",1,"I")
"RTN","ORAMSET",101,0)
 S POCNM=$$GET^XPAR(ORAMENT,"ORAM POINT OF CONTACT NAME",1,"I")
"RTN","ORAMSET",102,0)
 S RPATH=$$GET^XPAR(ORAMALL,"ORAM RAV FILE PATH",1,"I")
"RTN","ORAMSET",103,0)
 S SIGNM=$$GET^XPAR(ORAMENT,"ORAM SIGNATURE BLOCK NAME",1,"I")
"RTN","ORAMSET",104,0)
 S SIGTTL=$$GET^XPAR(ORAMENT,"ORAM SIGNATURE BLOCK TITLE",1,"I")
"RTN","ORAMSET",105,0)
 S SITENM=$$GET^XPAR(ORAMENT,"ORAM CLINIC NAME",1,"I")
"RTN","ORAMSET",106,0)
 S VLOC=$$GET^XPAR(ORAMENT,"ORAM VISIT LOCATION",1,"I")
"RTN","ORAMSET",107,0)
 S RESULT(0)=SITENM_U_ATEAM_U_CTEAM_U_INOTE_U_ENOTE_U_DNOTE_U_SMPLPH_U_SVST_U_CPLXPH_U_ORIENT_U_IVST_U_CENAB_U_PCEON_U_LTR_U_U_ADD1_U_ADD2_U_ADD3
"RTN","ORAMSET",108,0)
 S RESULT(1)=SIGNM_U_SIGTTL_U_POCNM_U_CPHONE_"|"_CFAX_U_MCNM_U_PILLSTR_U_NLABTM_U_TOLLFREE
"RTN","ORAMSET",109,0)
 S RESULT(2)=VLOC_"|"_PHCLIN_"|"_NCLOC_U_INRQO_"|"_CBCQO_U_DUZ(2)_U_DSSUNIT_U_DSSID_U_CSVC_U_HCT_"|"_HCTNM_U_RPATH_U_DPIND
"RTN","ORAMSET",110,0)
 Q
"RTN","ORAMSET",111,0)
 ;
"RTN","ORAMSET",112,0)
INDICS(RESULT) ; RPC To Get indications for care
"RTN","ORAMSET",113,0)
 D GETLST^XPAR(.RESULT,"SYS^PKG","ORAM INDICATIONS FOR CARE","E")
"RTN","ORAMSET",114,0)
 I +RESULT'>0 S RESULT(0)=0
"RTN","ORAMSET",115,0)
 Q
"RTN","ORAMSET",116,0)
 ;
"RTN","ORAMSET",117,0)
GETDIV() ; get division
"RTN","ORAMSET",118,0)
 N DIV,ORAMY
"RTN","ORAMSET",119,0)
 S DIV=$$KSP^XUPARAM("INST"),ORAMY=0
"RTN","ORAMSET",120,0)
 I $$GET1^DIQ(4,DIV_",",5,"I")'="Y" S ORAMY=DIV_";DIC(4," I 1
"RTN","ORAMSET",121,0)
 E  S ORAMY=$$SELDIV
"RTN","ORAMSET",122,0)
 Q ORAMY
"RTN","ORAMSET",123,0)
SELDIV() ; select division
"RTN","ORAMSET",124,0)
 N DIC,X,Y
"RTN","ORAMSET",125,0)
 W !!,"Enter Anticoagulation Management Parameters by Division:",!
"RTN","ORAMSET",126,0)
 S DIC=4,DIC(0)="AEMQ",DIC("S")="I +$O(^DG(40.8,""AD"",+Y,0))"
"RTN","ORAMSET",127,0)
 D ^DIC S:+Y>0 Y=+Y_";DIC(4,"
"RTN","ORAMSET",128,0)
 Q Y
"RTN","ORAMSET",129,0)
SELLOC() ; select hospital location
"RTN","ORAMSET",130,0)
 N DIC,X,Y,TIUAPDT S DIC=44,DIC(0)="AEMQ"
"RTN","ORAMSET",131,0)
 S DIC("A")="Select CLINIC: "
"RTN","ORAMSET",132,0)
 S DIC("S")="I $$GOODLOC^ORAMSET(Y)"
"RTN","ORAMSET",133,0)
 D ^DIC K DIC("S") S:+Y>0 Y=+Y_";SC("
"RTN","ORAMSET",134,0)
 Q Y
"RTN","ORAMSET",135,0)
GOODLOC(LOC) ; Returns 1 if ^SC hospital location IFN LOC is good, else 0
"RTN","ORAMSET",136,0)
 N GOODLOC,INACTIVE,OOS,CLINIC,NONCOUNT S (GOODLOC,INACTIVE,NONCOUNT)=0
"RTN","ORAMSET",137,0)
 I +$G(^SC(LOC,"I"))>0,(+$G(^("I"))'>DT) D
"RTN","ORAMSET",138,0)
 . S INACTIVE=1
"RTN","ORAMSET",139,0)
 . ; check if reactivated:
"RTN","ORAMSET",140,0)
 . I +$P($G(^("I")),U,2)>0,$P($G(^("I")),U,2)'>DT S INACTIVE=0
"RTN","ORAMSET",141,0)
 S OOS=+$D(^SC(LOC,"OOS")) ; Occasion of service
"RTN","ORAMSET",142,0)
 S CLINIC=+($P(^SC(LOC,0),U,3)="C")
"RTN","ORAMSET",143,0)
 S NONCOUNT=$S($P(^SC(LOC,0),U,17)="Y":1,1:0)
"RTN","ORAMSET",144,0)
 I 'INACTIVE,'OOS,'NONCOUNT,CLINIC S GOODLOC=1
"RTN","ORAMSET",145,0)
 Q GOODLOC
"RTN","ORAMSET",146,0)
GETPARM(X) ; Get parameter as IEN^NAME
"RTN","ORAMSET",147,0)
 N DIC,Y S DIC=8989.51,DIC(0)="MQ"
"RTN","ORAMSET",148,0)
 D ^DIC
"RTN","ORAMSET",149,0)
 Q Y
"RTN","ORAMTTR")
0^7^B84948729^n/a
"RTN","ORAMTTR",1,0)
ORAMTTR ; POR/RSF - Rosendaal Calculations, Individual & Group ;11/13/09  10:44
"RTN","ORAMTTR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAMTTR",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMTTR",4,0)
 ;needs testing in system with new file and parameters
"RTN","ORAMTTR",5,0)
 Q
"RTN","ORAMTTR",6,0)
 ;
"RTN","ORAMTTR",7,0)
MAIN ; Rosendaal TTR Option
"RTN","ORAMTTR",8,0)
 N RESULT
"RTN","ORAMTTR",9,0)
 D NROSENT(.RESULT)
"RTN","ORAMTTR",10,0)
 Q
"RTN","ORAMTTR",11,0)
SINGLE ; TTR for Individual
"RTN","ORAMTTR",12,0)
 N ORAMDFN,ORAMED,ORAMSD,DUOUT,DTOUT,DIRUT,RESULT
"RTN","ORAMTTR",13,0)
 S (ORAMED,ORAMSD)=""
"RTN","ORAMTTR",14,0)
 W !!,"Single Patient TRR Calculation (Rosendaal Method):",!
"RTN","ORAMTTR",15,0)
 S ORAMDFN=+$$PATIENT^ORAMX Q:+ORAMDFN'>0
"RTN","ORAMTTR",16,0)
 F  D  Q:+ORAMED>+ORAMSD!$D(DIRUT)
"RTN","ORAMTTR",17,0)
 . W !
"RTN","ORAMTTR",18,0)
 . S ORAMSD=+$$READ^ORAMX("DA^::E","Please Enter START Date: ","T-90","Enter a start date for the report")
"RTN","ORAMTTR",19,0)
 . Q:'ORAMSD
"RTN","ORAMTTR",20,0)
 . S ORAMED=+$$READ^ORAMX("DA^::E","  Please Enter END Date: ","T","Enter an INCLUSIVE end date for the report")
"RTN","ORAMTTR",21,0)
 . Q:'ORAMED
"RTN","ORAMTTR",22,0)
 . I $L(ORAMED,".")=1 S ORAMED=ORAMED_".2359"
"RTN","ORAMTTR",23,0)
 . I ORAMSD>ORAMED W !,"END DATE must be more recent than the START DATE" S (ORAMSD,ORAMED)=""
"RTN","ORAMTTR",24,0)
 Q:$S(+ORAMDFN'>0:1,ORAMED'>0:1,ORAMSD'>0:1,1:0)
"RTN","ORAMTTR",25,0)
 D NRINDV(.RESULT,ORAMDFN,ORAMSD,ORAMED,1)
"RTN","ORAMTTR",26,0)
 Q
"RTN","ORAMTTR",27,0)
NROSENT(RESULT) ;
"RTN","ORAMTTR",28,0)
 N ORAMSD,ORAMED,ORAMDFN,ORAMFSD,ORAMCLIN,ORAMPT,ORAMDATE,LG,HG,V1,V2,D1,D2,ORAMDAYS
"RTN","ORAMTTR",29,0)
 N ORAMDIG,ORAMTD,ORAMCARR,TOTS,CNT,ORSITE
"RTN","ORAMTTR",30,0)
 K ^TMP("ORAM",$J)
"RTN","ORAMTTR",31,0)
 W !!,"Rosendaal method for percentage of INR scores in therapeutic range",!
"RTN","ORAMTTR",32,0)
SD1 ; Get date range for calculations
"RTN","ORAMTTR",33,0)
 S ORAMSD=+$$READ^ORAMX("DA^::E","Please Enter START Date: ","T-90","Enter a start date for the report")
"RTN","ORAMTTR",34,0)
 Q:'ORAMSD
"RTN","ORAMTTR",35,0)
 S ORAMED=+$$READ^ORAMX("DA^::E","  Please Enter END Date: ","T","Enter an INCLUSIVE end date for the report")
"RTN","ORAMTTR",36,0)
 Q:'ORAMED
"RTN","ORAMTTR",37,0)
 I $L(ORAMED,".")=1 S ORAMED=ORAMED_".2359"
"RTN","ORAMTTR",38,0)
 I ORAMSD>ORAMED W !,"END DATE must be more recent than the START DATE" S (ORAMSD,ORAMED)="" G SD1
"RTN","ORAMTTR",39,0)
 S ORAMDFN=0 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:'$G(ORAMDFN)  D
"RTN","ORAMTTR",40,0)
 . N ORAMFS,ORAMDD,PGR
"RTN","ORAMTTR",41,0)
 . Q:'+$D(^ORAM(103,ORAMDFN,3))  ;go to next pt if no flow sheet entries
"RTN","ORAMTTR",42,0)
 . Q:'$D(^ORAM(103,ORAMDFN,6))  Q:$P(^ORAM(103,ORAMDFN,6),U,2)=""  ;QUIT IF NO CLINIC ASSIGNED
"RTN","ORAMTTR",43,0)
 . S ORAMCLIN=$P(^ORAM(103,ORAMDFN,6),U,2)
"RTN","ORAMTTR",44,0)
 . ; 1. Get local labs for patient w/in date range
"RTN","ORAMTTR",45,0)
 . D NGETINR(ORAMDFN,ORAMCLIN,ORAMSD,ORAMED)
"RTN","ORAMTTR",46,0)
 . ; 2. Next, loop thru flow sheets for patient to gather goal ranges
"RTN","ORAMTTR",47,0)
 . S ORAMDD=ORAMSD-.01
"RTN","ORAMTTR",48,0)
 . F  S ORAMDD=$O(^ORAM(103,ORAMDFN,3,"B",ORAMDD)) Q:'+$G(ORAMDD)  D
"RTN","ORAMTTR",49,0)
 .. S ORAMFS=0 F  S ORAMFS=$O(^ORAM(103,ORAMDFN,3,"B",ORAMDD,ORAMFS)) Q:'+$G(ORAMFS)  D
"RTN","ORAMTTR",50,0)
 ... I $G(PGR)="" S PGR=0 I ORAMFS>2 S PGR=$P(^ORAM(103,ORAMDFN,3,(ORAMFS-1),0),U,12) S:$G(PGR)="" PGR=0
"RTN","ORAMTTR",51,0)
 ... S ORAMFSD=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U) Q:$G(ORAMFSD)<ORAMSD  Q:$G(ORAMFSD)>ORAMED  ;OUT OF DATE RANGE
"RTN","ORAMTTR",52,0)
 ... I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,3)="",'+$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) Q
"RTN","ORAMTTR",53,0)
 ... I +$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) S ^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)=$P(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD),U)_U_$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,12)
"RTN","ORAMTTR",54,0)
 ... I '+$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) S ^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,3)_U_$P(^(0),U,12)
"RTN","ORAMTTR",55,0)
 ; 3. Loop thru array of pts & INRs collected in prior steps
"RTN","ORAMTTR",56,0)
 ;    Format: ^TMP("ORAM",$J,CLINIC,DFN,FMDATE)=INR_VALUE ^GOAL RANGE
"RTN","ORAMTTR",57,0)
 S ORAMCLIN=0
"RTN","ORAMTTR",58,0)
 F  S ORAMCLIN=$O(^TMP("ORAM",$J,ORAMCLIN)) Q:$G(ORAMCLIN)=""  D
"RTN","ORAMTTR",59,0)
 . N ORAMPT S ORAMPT=0
"RTN","ORAMTTR",60,0)
 . F  S ORAMPT=$O(^TMP("ORAM",$J,ORAMCLIN,ORAMPT)) Q:'+$G(ORAMPT)  D
"RTN","ORAMTTR",61,0)
 .. N ORAMDATE S ORAMDATE=0
"RTN","ORAMTTR",62,0)
 .. S (LG,HG,V1,V1,D1,D2)=""
"RTN","ORAMTTR",63,0)
 .. F  S ORAMDATE=$O(^TMP("ORAM",$J,ORAMCLIN,ORAMPT,ORAMDATE)) Q:'+$G(ORAMDATE)  D NGETFS(.ORAMCARR,ORAMCLIN,ORAMPT,ORAMDATE,.D1,.D2,.V1,.V2,.PGR,.LG,.HG,.ORAMDIG,.ORAMTD)
"RTN","ORAMTTR",64,0)
 I $G(ORAMDIG)<1 S RESULT="0^0" W !!?2,"Unable to calulate TTR (may be due to a short time frame with few repeat",!?2,"readings on the same patients)."  Q
"RTN","ORAMTTR",65,0)
 S TOTS=$TR($J((ORAMDIG/ORAMTD)*100,8,1)," ","")
"RTN","ORAMTTR",66,0)
 S ORSITE=$$NAME^VASITE
"RTN","ORAMTTR",67,0)
 S:ORSITE']"" ORSITE=$P($$SITE^VASITE,U,2)
"RTN","ORAMTTR",68,0)
 W @IOF,"Results of Rosendaal Method for Time in Therapeutic Range:"
"RTN","ORAMTTR",69,0)
 W !!,"Facility-wide for ",ORSITE," for ",$$FMTE^XLFDT(ORAMSD,2)," - ",$$FMTE^XLFDT(ORAMED,2)
"RTN","ORAMTTR",70,0)
 W !,"TTR = ",TOTS,"% (TOTAL DAYS IN GOAL: ",$TR($J(ORAMDIG,8,1)," ","")," TOTAL DAYS: ",$TR($J(ORAMTD,8,1)," ",""),")"
"RTN","ORAMTTR",71,0)
 I +$O(ORAMCARR(0)) W !!,"Results by Clinic:"
"RTN","ORAMTTR",72,0)
 S CNT=0 F  S CNT=$O(ORAMCARR(CNT)) Q:$G(CNT)=""  D
"RTN","ORAMTTR",73,0)
 . N CTOT S CTOT=$TR($J(($P(ORAMCARR(CNT),U,2)/$P(ORAMCARR(CNT),U))*100,8,1)," ",""),$P(ORAMCARR(CNT),U,2)=$TR($J($P(ORAMCARR(CNT),U,2),8,1)," ",""),$P(ORAMCARR(CNT),U,3)=CTOT
"RTN","ORAMTTR",74,0)
 . W !,$E($P(^SC(CNT,0),U),1,21),": TTR = ",CTOT,"% (Total days in goal: ",$TR($J($P(ORAMCARR(CNT),U,2),8,1)," ","")," TOTAL DAYS: ",$TR($J($P(ORAMCARR(CNT),U),8,1)," ",""),")",!
"RTN","ORAMTTR",75,0)
 . S ORAMCARR(CNT)=$P(^SC(CNT,0),U)_U_$P(ORAMCARR(CNT),U,2,3)
"RTN","ORAMTTR",76,0)
 M RESULT=ORAMCARR
"RTN","ORAMTTR",77,0)
 S RESULT(0)=TOTS_U_$TR($J(ORAMDIG,8,1)," ","")_U_$TR($J(ORAMTD,8,1)," ","")
"RTN","ORAMTTR",78,0)
 K ^TMP("ORAM",$J)
"RTN","ORAMTTR",79,0)
 Q
"RTN","ORAMTTR",80,0)
 ;
"RTN","ORAMTTR",81,0)
NRINDV(RESULT,ORAMDFN,ORAMSD,ORAMED,ORAMWON) ; TTR for single patient
"RTN","ORAMTTR",82,0)
 N ORAMFS,ORAMDD,PGR,ORAMCLIN
"RTN","ORAMTTR",83,0)
 S RESULT="NA"
"RTN","ORAMTTR",84,0)
 K ^TMP("ORAM",$J)
"RTN","ORAMTTR",85,0)
 Q:'+$D(^ORAM(103,ORAMDFN))  ;NOT IN FILE YET
"RTN","ORAMTTR",86,0)
 Q:'+$D(^ORAM(103,ORAMDFN,3))  ;NO FS ENTRIES YET
"RTN","ORAMTTR",87,0)
 Q:'$D(^ORAM(103,ORAMDFN,6))  Q:$P(^ORAM(103,ORAMDFN,6),U,2)=""  ;QUIT IF NO CLINIC ASSIGNED
"RTN","ORAMTTR",88,0)
 S:$G(ORAMSD)="" ORAMSD=$P(^ORAM(103,ORAMDFN,3,1,0),U)  ;IF NO DEFINED START DATE, DO FOR THE WHOLE TIME IN CLINIC.
"RTN","ORAMTTR",89,0)
 S:$G(ORAMED)="" ORAMED=DT
"RTN","ORAMTTR",90,0)
 S:$G(ORAMWON)="" ORAMWON=0  ;IF A NUMBER WILL WRITE RESULTS TO THE SCREEN
"RTN","ORAMTTR",91,0)
 S ORAMCLIN=$P(^ORAM(103,ORAMDFN,6),U,2)
"RTN","ORAMTTR",92,0)
 D NGETINR(ORAMDFN,ORAMCLIN,ORAMSD,ORAMED)  ;GETS LOCAL INR VALUES IN FORM ^TMP("ORAM",$J,CLINIC,DFN,FM_DATE)=VALUE^
"RTN","ORAMTTR",93,0)
 S ORAMDD=ORAMSD-.01
"RTN","ORAMTTR",94,0)
 F  S ORAMDD=$O(^ORAM(103,ORAMDFN,3,"B",ORAMDD)) Q:'+$G(ORAMDD)  D
"RTN","ORAMTTR",95,0)
 . S ORAMFS=0 F  S ORAMFS=$O(^ORAM(103,ORAMDFN,3,"B",ORAMDD,ORAMFS)) Q:'+$G(ORAMFS)  D
"RTN","ORAMTTR",96,0)
 .. N ORAMFSD
"RTN","ORAMTTR",97,0)
 .. I $G(PGR)="" S PGR=0 I ORAMFS>2 S PGR=$P(^ORAM(103,ORAMDFN,3,(ORAMFS-1),0),U,12) S:$G(PGR)="" PGR=0
"RTN","ORAMTTR",98,0)
 .. S ORAMFSD=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U) Q:$G(ORAMFSD)<ORAMSD  Q:$G(ORAMFSD)>ORAMED  ;OUT OF DATE RANGE
"RTN","ORAMTTR",99,0)
 .. I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,3)="",'+$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) Q
"RTN","ORAMTTR",100,0)
 .. I +$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) S ^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)=$P(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD),U)_U_$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,12)
"RTN","ORAMTTR",101,0)
 .. I '+$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)) S ^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMFSD)=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,3)_U_$P(^(0),U,12)
"RTN","ORAMTTR",102,0)
 Q:'$D(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN))
"RTN","ORAMTTR",103,0)
 ;FORMED ARRAY OF PATIENTS AND SCORES IN THE DATE RANGE; FORMAT ^TMP("ORAM",$J,CLINIC,DFN,FMDATE)=INR_VALUE ^ GOAL RANGE.
"RTN","ORAMTTR",104,0)
 N ORAMDATE,LG,HG,V1,V2,D1,D2,ORAMDAYS,ORAMDIG,ORAMTD
"RTN","ORAMTTR",105,0)
 N ORAMC2,ORAMPT,ORAMCARR S ORAMC2=ORAMCLIN,ORAMPT=ORAMDFN
"RTN","ORAMTTR",106,0)
 S ORAMDATE=0 F  S ORAMDATE=$O(^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMDATE)) Q:'+$G(ORAMDATE)  D NGETFS(.ORAMCARR,ORAMCLIN,ORAMDFN,ORAMDATE,.D1,.D2,.V1,.V2,.PGR,.LG,.HG,.ORAMDIG,.ORAMTD)
"RTN","ORAMTTR",107,0)
 I $G(ORAMDIG)<1 S RESULT="0^0" W:+$G(ORAMWON) !!?2,"Unable to calulate TTR (may be due to a short time frame with few repeat",!?2,"readings on the same patient)."  Q
"RTN","ORAMTTR",108,0)
 N TOTS S TOTS=$TR($J((ORAMDIG/ORAMTD)*100,8,1)," ","")
"RTN","ORAMTTR",109,0)
 I +$G(ORAMWON) D
"RTN","ORAMTTR",110,0)
 . W !!,"Rosendaal method for percentage of INR scores in therapeutic range",!
"RTN","ORAMTTR",111,0)
 . W !,?5,$E($P(^DPT($G(ORAMDFN),0),U),1,10)_" ("_$E($P(^(0),U,9),6,9)_") for ",$$FMTE^XLFDT(ORAMSD,2)," - ",$$FMTE^XLFDT(ORAMED,2)
"RTN","ORAMTTR",112,0)
 . W !,?5,"TTR = ",TOTS,"%  (TOTAL DAYS IN GOAL: ",$TR($J(ORAMDIG,8,1)," ",""),"  TOTAL DAYS: ",$TR($J(ORAMTD,8,1)," ",""),")",!
"RTN","ORAMTTR",113,0)
 S RESULT=TOTS_U_$TR($J(ORAMDIG,8,1)," ","")_U_$TR($J(ORAMTD,8,1)," ","")
"RTN","ORAMTTR",114,0)
 K ^TMP("ORAM",$J)
"RTN","ORAMTTR",115,0)
 Q
"RTN","ORAMTTR",116,0)
 ;
"RTN","ORAMTTR",117,0)
NGETINR(ORAMDFN,ORAMCLIN,ORAMSD,ORAMED) ; Get local INRs - sort by clinic, patient, & date
"RTN","ORAMTTR",118,0)
 N LDATE,INR,LRDFN,ORAMITST,ORAMQO,INRHD,INRRD,RSD,RED
"RTN","ORAMTTR",119,0)
 I '$G(ORAMDFN) Q  ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAMTTR",120,0)
 S LRDFN=$G(^DPT(ORAMDFN,"LR")) Q:'+$G(LRDFN)
"RTN","ORAMTTR",121,0)
 S RSD=9999999-(ORAMSD-.01)  ;REVERSE START DATE
"RTN","ORAMTTR",122,0)
 S RED=9999999-ORAMED
"RTN","ORAMTTR",123,0)
 N ORAMITST,ORAMORD S ORAMQO=$$GET^XPAR("ALL","ORAM INR QUICK ORDER",1,"I")
"RTN","ORAMTTR",124,0)
 I +ORAMQO'>0 W !!,"Parameter ORAM QUICK ORDER not yet established. Please contact your CAC.",! Q
"RTN","ORAMTTR",125,0)
 S ORAMITST=$$INRCHK^ORAM(ORAMQO)
"RTN","ORAMTTR",126,0)
 I +ORAMITST'>0 W !!,"Parameter ORAM QUICK ORDER not properly set up. Please contact your CAC.",! Q
"RTN","ORAMTTR",127,0)
 S LDATE=RSD F  SET LDATE=$O(^LR(LRDFN,"CH",LDATE),-1) Q:LDATE<1!(LDATE<RED)  D
"RTN","ORAMTTR",128,0)
 . N SCORE S SCORE=$G(^LR(LRDFN,"CH",LDATE,ORAMITST))  ;648149
"RTN","ORAMTTR",129,0)
 . Q:SCORE=""  ;QUIT IF NO INR TEST
"RTN","ORAMTTR",130,0)
 . Q:$P(SCORE,U,1)=""  ;QUIT IF NO INR DATA
"RTN","ORAMTTR",131,0)
 . S INR=$P(SCORE,U,1)  ;INR
"RTN","ORAMTTR",132,0)
 . N ORAMX S ORAMX=$E((9999999-LDATE),1,7)
"RTN","ORAMTTR",133,0)
 . S ^TMP("ORAM",$J,ORAMCLIN,ORAMDFN,ORAMX)=$G(INR)_U
"RTN","ORAMTTR",134,0)
 Q
"RTN","ORAMTTR",135,0)
 ;
"RTN","ORAMTTR",136,0)
NGETFS(ORAMCARR,ORAMCLIN,ORAMPT,ORAMDATE,D1,D2,V1,V2,PGR,LG,HG,ORAMDIG,ORAMTD) ; Check flow sheet entries vs. goals
"RTN","ORAMTTR",137,0)
 N CG,ORAMZ,ORAMDAYS
"RTN","ORAMTTR",138,0)
 S CG=$P(^TMP("ORAM",$J,ORAMCLIN,ORAMPT,ORAMDATE),U,2),ORAMZ=0
"RTN","ORAMTTR",139,0)
 I $G(CG)="",'+$G(LG) Q:'+$G(PGR)  S CG=PGR  ;BRINGS IN THE LAST GOAL INFO THAT SHOULD BE IN EFFECT FOR THE FIRST SEGMENT
"RTN","ORAMTTR",140,0)
 I $G(CG)'="" S LG=$P(CG,"-"),HG=$P(CG,"-",2)  S:HG[" " HG=$P(HG," ",2)  ;USES NEW ONE IF AVAILABLE
"RTN","ORAMTTR",141,0)
 Q:$P(^TMP("ORAM",$J,ORAMCLIN,ORAMPT,ORAMDATE),U)=""
"RTN","ORAMTTR",142,0)
 N ORAMIV S ORAMIV=$P(^TMP("ORAM",$J,ORAMCLIN,ORAMPT,ORAMDATE),U) S:ORAMIV[">" ORAMIV=$P(ORAMIV,">",2) S:ORAMIV["<" ORAMIV=$P(ORAMIV,"<",2)
"RTN","ORAMTTR",143,0)
 Q:'+ORAMIV  ;QUITS IF NOT A NUMBER AFTER CHECKING FOR > AND < SIGNS
"RTN","ORAMTTR",144,0)
 S D2=ORAMDATE S V2=ORAMIV_U_$S(ORAMIV>HG:"H",ORAMIV<LG:"L",1:"G")  ;IF OUT OF RANGE LISTS H OR L OTHERWISE G
"RTN","ORAMTTR",145,0)
 I $G(D1)="" S ORAMZ=1
"RTN","ORAMTTR",146,0)
 I '+$G(ORAMZ) D
"RTN","ORAMTTR",147,0)
 . S ORAMDAYS=$$FMDIFF^XLFDT(D2,D1,1)  ;DAYS DIFFERENCE BETWEEN THE LAST TWO INRS
"RTN","ORAMTTR",148,0)
 . S ORAMTD=$G(ORAMTD)+ORAMDAYS
"RTN","ORAMTTR",149,0)
 . S $P(ORAMCARR(ORAMCLIN),U)=($P($G(ORAMCARR(ORAMCLIN)),U)+ORAMDAYS)
"RTN","ORAMTTR",150,0)
 . I $P(V1,U,2)=$P(V2,U,2) S:$P(V1,U,2)="G" ORAMDIG=$G(ORAMDIG)+ORAMDAYS,$P(ORAMCARR(ORAMCLIN),U,2)=$P(ORAMCARR(ORAMCLIN),U,2)+ORAMDAYS  ;IF ALL IN GOAL, ALL GOOD, OTHERWISE 0 IN GOAL
"RTN","ORAMTTR",151,0)
 . I $P(V1,U,2)'=$P(V2,U,2) D  ;WAS IN GOAL IN ONLY ONE OF THE READINGS (OR ONE H AND ONE L)
"RTN","ORAMTTR",152,0)
 .. N DIFF S DIFF=$$ABS^XLFMTH($P(V1,U)-$P(V2,U)) N NUMC,NUMPC S:$P(V1,U,2)="G" NUMC=$P(V1,U)_U_$P(V2,U,2) S:$P(V2,U,2)="G" NUMC=$P(V2,U)_U_$P(V1,U,2)
"RTN","ORAMTTR",153,0)
 .. I $G(NUMC)'="" D
"RTN","ORAMTTR",154,0)
 ... I $P(NUMC,U,2)="L" S NUMPC=$$ABS^XLFMTH(LG-$P(NUMC,U)),NUMPC=NUMPC/DIFF
"RTN","ORAMTTR",155,0)
 ... I $P(NUMC,U,2)="H" S NUMPC=$$ABS^XLFMTH(HG-$P(NUMC,U)),NUMPC=NUMPC/DIFF
"RTN","ORAMTTR",156,0)
 .. I $G(NUMC)="" D  ; FOR THE RARE CASE OF A SKIPPED GOAL RANGE, SO NOT =, BUT ONE IS LOW AND THE OTHER HIGH
"RTN","ORAMTTR",157,0)
 ... S NUMPC=$$ABS^XLFMTH(HG-LG),NUMPC=NUMPC/DIFF
"RTN","ORAMTTR",158,0)
 .. S ORAMDIG=$G(ORAMDIG)+$TR($J(NUMPC*ORAMDAYS,8.3)," ","")
"RTN","ORAMTTR",159,0)
 .. S $P(ORAMCARR(ORAMCLIN),U,2)=($P(ORAMCARR(ORAMCLIN),U,2)+$TR($J(NUMPC*ORAMDAYS,8.3)," ",""))
"RTN","ORAMTTR",160,0)
 S D1=D2,V1=V2
"RTN","ORAMTTR",161,0)
 Q
"RTN","ORAMTTR",162,0)
 ;
"RTN","ORAMX")
0^6^B147643525^n/a
"RTN","ORAMX",1,0)
ORAMX ;POR/RSF - ADDITIONAL ANTICOAGULATION CALLS ;12/08/09  16:26
"RTN","ORAMX",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAMX",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMX",4,0)
 Q
"RTN","ORAMX",5,0)
 ;
"RTN","ORAMX",6,0)
COMPRPT  ; Complications Report [ORAM COMPLICATIONS REPORT]
"RTN","ORAMX",7,0)
 N DIRUT,ORAMSDT,ORAMEDT,ORAMSD,ORAMED,ORAMM,ORAMDL,ORAMT,ORAFMT,ORAMDFN,ORAMCNT,ORAMARR,ORAMINCM,ORAMSORT
"RTN","ORAMX",8,0)
 S (ORAMED,ORAMSD)="",ORAMINCM=1
"RTN","ORAMX",9,0)
 W !!,"Anticoagulation Complications Report",!
"RTN","ORAMX",10,0)
 F  D  Q:+ORAMED>+ORAMSD!+$G(DIRUT)
"RTN","ORAMX",11,0)
 . S ORAMSD=+$$READ("DA^::E","    Please Enter START Date: ","T-90","Enter a start date for the report")
"RTN","ORAMX",12,0)
 . Q:'ORAMSD
"RTN","ORAMX",13,0)
 . S ORAMED=+$$READ("DA^::E","      Please Enter END Date: ","T","Enter an INCLUSIVE end date for the report")
"RTN","ORAMX",14,0)
 . Q:'ORAMED
"RTN","ORAMX",15,0)
 . I $L(ORAMED,".")=1 S ORAMED=ORAMED_".2359"
"RTN","ORAMX",16,0)
 . I ORAMSD>ORAMED W !,"END DATE must be more recent than the START DATE" S (ORAMSD,ORAMED)=""
"RTN","ORAMX",17,0)
 Q:$S(ORAMSD'>0:1,ORAMED'>0:1,1:0)
"RTN","ORAMX",18,0)
 S ORAMSDT=$$FMTE^XLFDT(ORAMSD,2),ORAMEDT=$$FMTE^XLFDT(ORAMED,2)
"RTN","ORAMX",19,0)
 W ! S ORAFMT=$$READ("SA^r:Report;e:Export to Spreadsheet","      Please Specify Format: ","Report")
"RTN","ORAMX",20,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",21,0)
 S:"Ee"[$P(ORAFMT,U) ORAMDL=1 S:"Rr"[$P(ORAFMT,U) ORAMDL=0
"RTN","ORAMX",22,0)
 W ! S ORAMSORT=$$READ("SA^c:Clinic;d:Division","              Sort/Tally By: ","Clinic")
"RTN","ORAMX",23,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",24,0)
 S ORAMSORT=$P(ORAMSORT,U)
"RTN","ORAMX",25,0)
 W ! S ORAMINCM=+$$READ("YA","Include Minor Complications? ","YES")
"RTN","ORAMX",26,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",27,0)
 S (ORAMCNT,ORAMDFN)=0
"RTN","ORAMX",28,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:'$G(ORAMDFN)  D
"RTN","ORAMX",29,0)
 . N ORAMFS S ORAMFS=" "
"RTN","ORAMX",30,0)
 . F  S ORAMFS=$O(^ORAM(103,ORAMDFN,3,ORAMFS),-1) Q:'+$G(ORAMFS)  D
"RTN","ORAMX",31,0)
 .. N ORAMCP
"RTN","ORAMX",32,0)
 .. I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)<ORAMSD Q
"RTN","ORAMX",33,0)
 .. I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)>ORAMED Q
"RTN","ORAMX",34,0)
 .. S ORAMCP=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,2)
"RTN","ORAMX",35,0)
 .. I +$G(ORAMCP) D
"RTN","ORAMX",36,0)
 ... N ORAMLOC,ORAMM,ORAMCLNO,ORAMCLNM,ORAMDIVN,ORAMDIV
"RTN","ORAMX",37,0)
 ... I (+ORAMINCM'>0),(ORAMCP>2) Q
"RTN","ORAMX",38,0)
 ... S ORAMCLNO=+$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAMX",39,0)
 ... I ORAMCLNO>0 D
"RTN","ORAMX",40,0)
 .... S ORAMDIVN=+$P($G(^SC(ORAMCLNO,0)),U,15)
"RTN","ORAMX",41,0)
 .... S ORAMCLNM=$$EXTERNAL^DILFD(103,101,"",ORAMCLNO) S:$G(ORAMCLNM)="" ORAMCLNM="CLINIC UNKNOWN"
"RTN","ORAMX",42,0)
 .... S ORAMDIV=$$EXTERNAL^DILFD(44,3.5,"",ORAMDIVN) S:$G(ORAMDIV)="" ORAMDIV="DIVISION UNKNOWN"
"RTN","ORAMX",43,0)
 ... E  S ORAMCLNM="CLINIC UNKNOWN",ORAMDIV="DIVISION UNKNOWN"
"RTN","ORAMX",44,0)
 ... S ORAMLOC=$S(ORAMSORT="c":ORAMCLNM,1:ORAMDIV)
"RTN","ORAMX",45,0)
 ... S ORAMARR(ORAMLOC,0)=$G(ORAMARR(ORAMLOC,0))+1
"RTN","ORAMX",46,0)
 ... S ORAMM=$E($P(^DPT($G(ORAMDFN),0),U),1,10)_" ("_$E($P(^(0),U,9),6,9)_")"
"RTN","ORAMX",47,0)
 ... I ORAMCP=1!(+ORAMINCM&(ORAMCP=3)) D
"RTN","ORAMX",48,0)
 .... S ORAMARR(ORAMLOC,"B",0)=$G(ORAMARR(ORAMLOC,"B",0))+1
"RTN","ORAMX",49,0)
 .... S ORAMARR(ORAMLOC,"B",ORAMDFN,$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)_ORAMFS,1)=ORAMM_": INR Draw date - "_$$FMTE^XLFDT($P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U),"2P")
"RTN","ORAMX",50,0)
 .... N ORAMJ S ORAMJ=0
"RTN","ORAMX",51,0)
 .... F  S ORAMJ=$O(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ)) Q:+ORAMJ'>0  D
"RTN","ORAMX",52,0)
 ..... N ORAMCMPL,ORAMFS0
"RTN","ORAMX",53,0)
 ..... S ORAMFS0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0))
"RTN","ORAMX",54,0)
 ..... S ORAMCMPL=$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ,0))
"RTN","ORAMX",55,0)
 ..... S:$L(ORAMCMPL,":")>1 ORAMCMPL=$S($P(ORAMCMPL,":")="MB":"Major Bleed: ",$P(ORAMCMPL,":")="C":"  ",1:ORAMCMPL)_$P(ORAMCMPL,":",2)
"RTN","ORAMX",56,0)
 ..... S ORAMARR(ORAMLOC,"B",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,1_"."_ORAMJ)=$S(ORAMJ=1:"Complication date: ",1:"")_ORAMCMPL
"RTN","ORAMX",57,0)
 ..... S ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=$TR(ORAMLOC,";",",")_";"_$S(ORAMCP=3:"Minor Bleed",1:"Hemorrhagic")_";"_ORAMM_";"_$$FMTE^XLFDT($P(ORAMFS0,U),"2P")_";"
"RTN","ORAMX",58,0)
 ..... S ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)_$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,1,0))
"RTN","ORAMX",59,0)
 ... I ORAMCP=2 D
"RTN","ORAMX",60,0)
 .... S ORAMARR(ORAMLOC,"C",0)=$G(ORAMARR(ORAMLOC,"C",0))+1
"RTN","ORAMX",61,0)
 .... S ORAMARR(ORAMLOC,"C",ORAMDFN,$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)_ORAMFS,1)=ORAMM_": INR Draw date - "_$$FMTE^XLFDT($P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U),"2P")
"RTN","ORAMX",62,0)
 .... N ORAMJ S ORAMJ=0
"RTN","ORAMX",63,0)
 .... F  S ORAMJ=$O(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ)) Q:'+$G(ORAMJ)  D
"RTN","ORAMX",64,0)
 ..... N ORAMCMPL,ORAMFS0
"RTN","ORAMX",65,0)
 ..... S ORAMFS0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0))
"RTN","ORAMX",66,0)
 ..... S ORAMCMPL=^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ,0)
"RTN","ORAMX",67,0)
 ..... S:$L(ORAMCMPL,":")>1 ORAMCMPL=$S($P(ORAMCMPL,":")="MB":"Major Bleed: ",$P(ORAMCMPL,":")="C":"  ",1:ORAMCMPL)_$P(ORAMCMPL,":",2)
"RTN","ORAMX",68,0)
 ..... S ORAMARR(ORAMLOC,"C",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,1_"."_ORAMJ)=$S(ORAMJ=1:"Complication date: ",1:"")_ORAMCMPL
"RTN","ORAMX",69,0)
 ..... S ORAMARR(ORAMLOC,"CX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=$TR(ORAMLOC,";",",")_";Thrombotic;"_ORAMM_";"_$$FMTE^XLFDT($P(ORAMFS0,U),"2P")_";"_$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,1,0))
"RTN","ORAMX",70,0)
 I ORAMDL=0 D COMP0(.ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM)
"RTN","ORAMX",71,0)
 I ORAMDL=1 D COMP1(.ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM,ORAMSORT)
"RTN","ORAMX",72,0)
 Q
"RTN","ORAMX",73,0)
COMP0(ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM) ; Print Report Format
"RTN","ORAMX",74,0)
 N OCLINIC
"RTN","ORAMX",75,0)
 W @IOF,"COMPLICATIONS REPORT - ANTICOAGULATION: ",ORAMSDT," - ",ORAMEDT,!,$S('ORAMINCM:"  (** EXCLUDING MINOR COMPLICATIONS **)"_$C(13)_$C(10),1:"")
"RTN","ORAMX",76,0)
 I '$D(ORAMARR) W !,?5,"No Complications Noted."  Q
"RTN","ORAMX",77,0)
 S OCLINIC=""
"RTN","ORAMX",78,0)
 F  S OCLINIC=$O(ORAMARR(OCLINIC)) Q:OCLINIC']""  D
"RTN","ORAMX",79,0)
 . W !!,?5,OCLINIC,": Total Complications - ",ORAMARR(OCLINIC,0)
"RTN","ORAMX",80,0)
 . I $G(ORAMARR(OCLINIC,"B",0))>0 D  ;BLEEDS FOR THIS CLINIC
"RTN","ORAMX",81,0)
 .. N ODFN
"RTN","ORAMX",82,0)
 .. W !!,?7," Bleeds (",ORAMARR(OCLINIC,"B",0),")",!
"RTN","ORAMX",83,0)
 .. W !,?7," Details:"
"RTN","ORAMX",84,0)
 .. S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"B",ODFN)) Q:+ODFN'>0  D
"RTN","ORAMX",85,0)
 ... N OCDATE S OCDATE=0
"RTN","ORAMX",86,0)
 ... F  S OCDATE=$O(ORAMARR(OCLINIC,"B",ODFN,OCDATE)) Q:+OCDATE'>0  D
"RTN","ORAMX",87,0)
 .... N OCNT S OCNT=0 W !
"RTN","ORAMX",88,0)
 .... F  S OCNT=$O(ORAMARR(OCLINIC,"B",ODFN,OCDATE,OCNT)) Q:+OCNT'>0  D
"RTN","ORAMX",89,0)
 ..... W !,?8,ORAMARR(OCLINIC,"B",ODFN,OCDATE,OCNT)
"RTN","ORAMX",90,0)
 . I $G(ORAMARR(OCLINIC,"C",0))>0 D  ;CLOTS FOR THIS CLINIC
"RTN","ORAMX",91,0)
 .. N ODFN
"RTN","ORAMX",92,0)
 .. W !!,?7," Clots (",ORAMARR(OCLINIC,"C",0),")",!
"RTN","ORAMX",93,0)
 .. W !,?7," Details:"
"RTN","ORAMX",94,0)
 .. S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"C",ODFN)) Q:+ODFN'>0  D
"RTN","ORAMX",95,0)
 ... N OCDATE S OCDATE=0
"RTN","ORAMX",96,0)
 ... F  S OCDATE=$O(ORAMARR(OCLINIC,"C",ODFN,OCDATE)) Q:+OCDATE'>0  D
"RTN","ORAMX",97,0)
 .... N OCNT S OCNT=0 W !
"RTN","ORAMX",98,0)
 .... F  S OCNT=$O(ORAMARR(OCLINIC,"C",ODFN,OCDATE,OCNT)) Q:+OCNT'>0  D
"RTN","ORAMX",99,0)
 ..... W !,?8,ORAMARR(OCLINIC,"C",ODFN,OCDATE,OCNT)
"RTN","ORAMX",100,0)
 Q
"RTN","ORAMX",101,0)
COMP1(ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM,ORAMSORT) ; Print Export Format
"RTN","ORAMX",102,0)
 N OCLINIC
"RTN","ORAMX",103,0)
 W @IOF,"COMPLICATIONS REPORT - ANTICOAGULATION: ",ORAMSDT," - ",ORAMEDT,!,$S('ORAMINCM:"  (** EXCLUDING MINOR COMPLICATIONS **)"_$C(13)_$C(10),1:"")
"RTN","ORAMX",104,0)
 I '$D(ORAMARR) W !,?5,"No Complications Noted."  Q
"RTN","ORAMX",105,0)
 W !,$S(ORAMSORT="c":"Clinic",1:"Division"),";Event;Patient;INR Draw Date;Complication Date"
"RTN","ORAMX",106,0)
 S OCLINIC="" F  S OCLINIC=$O(ORAMARR(OCLINIC)) Q:OCLINIC']""  D
"RTN","ORAMX",107,0)
 . I $D(ORAMARR(OCLINIC,"BX")) D  ;BLEEDS FOR THIS CLINIC
"RTN","ORAMX",108,0)
 .. N ODFN S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"BX",ODFN)) Q:'+$G(ODFN)  D
"RTN","ORAMX",109,0)
 ... N OCDATE S OCDATE=0 F  S OCDATE=$O(ORAMARR(OCLINIC,"BX",ODFN,OCDATE)) Q:'+$G(OCDATE)  D
"RTN","ORAMX",110,0)
 .... W !,ORAMARR(OCLINIC,"BX",ODFN,OCDATE,99)
"RTN","ORAMX",111,0)
 . I $D(ORAMARR(OCLINIC,"CX")) D  ;CLOTS FOR THIS CLINIC
"RTN","ORAMX",112,0)
 .. N ODFN S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"CX",ODFN)) Q:'+$G(ODFN)  D
"RTN","ORAMX",113,0)
 ... N OCDATE S OCDATE=0 F  S OCDATE=$O(ORAMARR(OCLINIC,"CX",ODFN,OCDATE)) Q:'+$G(OCDATE)  D
"RTN","ORAMX",114,0)
 .... W !,ORAMARR(OCLINIC,"CX",ODFN,OCDATE,99)
"RTN","ORAMX",115,0)
 Q
"RTN","ORAMX",116,0)
 ;
"RTN","ORAMX",117,0)
CONSULT(RESULT,ORAMDFN,ORAMCNM) ; Called from RPC=ORAMX CONSULT
"RTN","ORAMX",118,0)
 I '+$G(ORAMDFN) S RESULT(0)=0 Q
"RTN","ORAMX",119,0)
 I $G(ORAMCNM)="" S RESULT(0)=0 Q
"RTN","ORAMX",120,0)
 N ORAMCLST S ORAMCLST(0)=0
"RTN","ORAMX",121,0)
 D RPCLIST^GMRCTIU(.ORAMCLST,ORAMDFN)
"RTN","ORAMX",122,0)
 Q:ORAMCLST(0)=0  ;SHOULD BE NUMBER IN THE ARRAY
"RTN","ORAMX",123,0)
 I ORAMCLST(0)>0 D
"RTN","ORAMX",124,0)
 . N ORAMC S ORAMC=0 F  S ORAMC=$O(ORAMCLST(ORAMC)) Q:'+$G(ORAMC)  D
"RTN","ORAMX",125,0)
 .. Q:ORAMCNM'=$P(ORAMCLST(ORAMC),U,3)
"RTN","ORAMX",126,0)
 .. N ORAMK S ORAMK=0
"RTN","ORAMX",127,0)
 .. I $P(ORAMCLST(ORAMC),U,5)="PENDING" S ORAMK=1
"RTN","ORAMX",128,0)
 .. I $P(ORAMCLST(ORAMC),U,5)="ACTIVE" S ORAMK=1
"RTN","ORAMX",129,0)
 .. Q:'+ORAMK
"RTN","ORAMX",130,0)
 .. N ORAMD S ORAMD=$$FMTE^XLFDT($P(ORAMCLST(ORAMC),U,2),"2P")
"RTN","ORAMX",131,0)
 .. S RESULT(ORAMC)=ORAMD_":  "_$P(ORAMCLST(ORAMC),U,3)_"  ^"_$P(ORAMCLST(ORAMC),U,1)
"RTN","ORAMX",132,0)
 Q
"RTN","ORAMX",133,0)
PCESET(RESULT,ORAMDFN,ORAMD1,ORAMSC44,ORAMEDT,ORAMSVC,ORAMNARR,ORAMPDX) ; RPC to file PCE Data
"RTN","ORAMX",134,0)
 ; RPC = ORAMX PCESET
"RTN","ORAMX",135,0)
 ; ORAMDFN  = Pt. ID
"RTN","ORAMX",136,0)
 ; ORAMD1   = Data string e.g., 1143|300|99363|427.31|^SC~0^IR~0^EC~1^MST~0^HNC~1^SHAD~0
"RTN","ORAMX",137,0)
 ; ORAMSC44 = Hospital Location IEN
"RTN","ORAMX",138,0)
 ; ORAMEDT  = Encounter Date/Time
"RTN","ORAMX",139,0)
 ; ORAMSVC  = Service Category (e.g., "A"mbulatory or "T"elecommunications)
"RTN","ORAMX",140,0)
 ; ORAMNARR = Provider Narrative for Dx
"RTN","ORAMX",141,0)
 ; ORAMPDX  = Automatic Primary Indication code for Clinic
"RTN","ORAMX",142,0)
 ;
"RTN","ORAMX",143,0)
 I '+$G(ORAMDFN) S RESULT=99 Q
"RTN","ORAMX",144,0)
 I '+$G(ORAMSC44) S RESULT=99 Q
"RTN","ORAMX",145,0)
 I $G(ORAMD1)']"" S RESULT=99 Q
"RTN","ORAMX",146,0)
 N ORAMNOW,ORAMDAY S ORAMNOW=$$NOW^XLFDT
"RTN","ORAMX",147,0)
 S RESULT=0,ORAMEDT=$G(ORAMEDT,ORAMNOW),ORAMDAY=$P(ORAMEDT,"."),ORAMSVC=$G(ORAMSVC,"A")
"RTN","ORAMX",148,0)
 I $G(ORAMD1)'="" D
"RTN","ORAMX",149,0)
 . N ORAMDUZ,ORAMCPT,ORAMSC,ORAMDX,ORAMQ,ORAMVST,ERRARR,ERRPROB,ORAMPDXC,ORAMPDXT,ORAMPDXN
"RTN","ORAMX",150,0)
 . S ORAMDUZ=$P(ORAMD1,"|"),ORAMSC=$P(ORAMD1,"|",2),ORAMCPT=$P(ORAMD1,"|",3),ORAMQ=$P(ORAMD1,"|",5)
"RTN","ORAMX",151,0)
 . S ORAMDX=+$$CODEN^ICDCODE($P(ORAMD1,"|",4),80)
"RTN","ORAMX",152,0)
 . I +ORAMDX'>0 S RESULT=99 Q
"RTN","ORAMX",153,0)
 . I $G(ORAMPDX)]"" D
"RTN","ORAMX",154,0)
 . . S ORAMPDXC=$P(ORAMPDX,U),ORAMPDXT=$P(ORAMPDX,U,2)
"RTN","ORAMX",155,0)
 . . S ORAMPDXN=+$$CODEN^ICDCODE(ORAMPDXC,80)
"RTN","ORAMX",156,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",1,"DIAGNOSIS")=$G(ORAMPDXN)
"RTN","ORAMX",157,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",1,"PRIMARY")="P"
"RTN","ORAMX",158,0)
 . . S:ORAMPDXT]"" ^TMP("ORAMPCE",$J,"DX/PL",1,"NARRATIVE")=ORAMPDXT
"RTN","ORAMX",159,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",2,"DIAGNOSIS")=$G(ORAMDX)
"RTN","ORAMX",160,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",2,"PRIMARY")="S"
"RTN","ORAMX",161,0)
 . . S:$G(ORAMNARR)]"" ^TMP("ORAMPCE",$J,"DX/PL",2,"NARRATIVE")=ORAMNARR
"RTN","ORAMX",162,0)
 . E  D
"RTN","ORAMX",163,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",1,"DIAGNOSIS")=$G(ORAMDX)
"RTN","ORAMX",164,0)
 . . S ^TMP("ORAMPCE",$J,"DX/PL",1,"PRIMARY")="P"
"RTN","ORAMX",165,0)
 . . S:$G(ORAMNARR)]"" ^TMP("ORAMPCE",$J,"DX/PL",1,"NARRATIVE")=ORAMNARR
"RTN","ORAMX",166,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"DSS ID")=$G(ORAMSC)  ;STOP CODE 40.7
"RTN","ORAMX",167,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"ENC D/T")=ORAMEDT
"RTN","ORAMX",168,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"HOS LOC")=ORAMSC44  ;9727 ;8005
"RTN","ORAMX",169,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"PATIENT")=ORAMDFN
"RTN","ORAMX",170,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"ENCOUNTER TYPE")="P"  ;PRIMARY OR ANCILLARY
"RTN","ORAMX",171,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SERVICE CATEGORY")=ORAMSVC
"RTN","ORAMX",172,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"CHECKOUT D/T")=$$NOW^XLFDT
"RTN","ORAMX",173,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"PROCEDURE")=$G(ORAMCPT)
"RTN","ORAMX",174,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"DIAGNOSIS")=$S($G(ORAMPDXN)]"":ORAMPDXN,1:$G(ORAMDX))
"RTN","ORAMX",175,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"EVENT D/T")=ORAMEDT
"RTN","ORAMX",176,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"QTY")=1
"RTN","ORAMX",177,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"ENC PROVIDER")=$G(ORAMDUZ)  ;FILE 200
"RTN","ORAMX",178,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"PRIMARY")=1
"RTN","ORAMX",179,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"DEPARTMENT")=$G(ORAMSC)  ;STOP CODE 40.7
"RTN","ORAMX",180,0)
 . ;comes in like: ^SC~0^IR~0^EC~1^MST~0
"RTN","ORAMX",181,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SC")=""
"RTN","ORAMX",182,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"AO")=""
"RTN","ORAMX",183,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"IR")=""
"RTN","ORAMX",184,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"EC")=""
"RTN","ORAMX",185,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"MST")=""
"RTN","ORAMX",186,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"HNC")=""
"RTN","ORAMX",187,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"CV")=""
"RTN","ORAMX",188,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SHAD")=""
"RTN","ORAMX",189,0)
 . N ORAMCNT,I S ORAMCNT=$L(ORAMQ,U)
"RTN","ORAMX",190,0)
 . I +$G(ORAMCNT) F I=2:1:ORAMCNT D
"RTN","ORAMX",191,0)
 .. N T S T=$P(ORAMQ,U,I) Q:$G(T)=""
"RTN","ORAMX",192,0)
 .. I $P(T,"~",1)'="" S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,$P(T,"~",1))=$P(T,"~",2)
"RTN","ORAMX",193,0)
 . S RESULT=$$DATA2PCE^PXAPI("^TMP(""ORAMPCE"",$J)","ORAM","ORAM ANTICOAGULATION MANAGEMENT PROGRAM",.ORAMVST,DUZ,,.ERRARR,,.ERRPROB)
"RTN","ORAMX",194,0)
 Q
"RTN","ORAMX",195,0)
WRAP(TEXT,LENGTH) ; Breaks text string into substrings of length LENGTH
"RTN","ORAMX",196,0)
 N ORAMI,ORAMJ,LINE,ORAMX,ORAMX1,ORAMX2,ORAMY
"RTN","ORAMX",197,0)
 I $G(TEXT)']"" Q ""
"RTN","ORAMX",198,0)
 F ORAMI=1:1 D  Q:ORAMI=$L(TEXT," ")
"RTN","ORAMX",199,0)
 . S ORAMX=$P(TEXT," ",ORAMI)
"RTN","ORAMX",200,0)
 . I $L(ORAMX)>LENGTH D
"RTN","ORAMX",201,0)
 . . S ORAMX1=$E(ORAMX,1,LENGTH),ORAMX2=$E(ORAMX,LENGTH+1,$L(ORAMX))
"RTN","ORAMX",202,0)
 . . S $P(TEXT," ",ORAMI)=ORAMX1_" "_ORAMX2
"RTN","ORAMX",203,0)
 S LINE=1,ORAMX(1)=$P(TEXT," ")
"RTN","ORAMX",204,0)
 F ORAMI=2:1 D  Q:ORAMI'<$L(TEXT," ")
"RTN","ORAMX",205,0)
 . S:$L($G(ORAMX(LINE))_" "_$P(TEXT," ",ORAMI))>LENGTH LINE=LINE+1,ORAMY=1
"RTN","ORAMX",206,0)
 . S ORAMX(LINE)=$G(ORAMX(LINE))_$S(+$G(ORAMY):"",1:" ")_$P(TEXT," ",ORAMI),ORAMY=0
"RTN","ORAMX",207,0)
 S ORAMJ=0,TEXT="" F ORAMI=1:1 S ORAMJ=$O(ORAMX(ORAMJ)) Q:+ORAMJ'>0  S TEXT=TEXT_$S(ORAMI=1:"",1:"|")_ORAMX(ORAMJ)
"RTN","ORAMX",208,0)
 Q TEXT
"RTN","ORAMX",209,0)
READ(TYPE,PROMPT,DEFAULT,HELP,SCREEN) ; Calls reader, returns response
"RTN","ORAMX",210,0)
 N DIR,X,Y
"RTN","ORAMX",211,0)
 S DIR(0)=TYPE
"RTN","ORAMX",212,0)
 I $D(SCREEN) S DIR("S")=SCREEN
"RTN","ORAMX",213,0)
 I $G(PROMPT)]"" S DIR("A")=PROMPT
"RTN","ORAMX",214,0)
 I $G(DEFAULT)]"" S DIR("B")=DEFAULT
"RTN","ORAMX",215,0)
 I $D(HELP) S DIR("?")=HELP
"RTN","ORAMX",216,0)
 D ^DIR
"RTN","ORAMX",217,0)
 I $G(X)="@" S Y="@" G READX
"RTN","ORAMX",218,0)
 I Y]"",($L($G(Y),U)'=2) S Y=Y_U_$G(Y(0),Y)
"RTN","ORAMX",219,0)
READX Q Y
"RTN","ORAMX",220,0)
NAME(X,FMT) ; Call with X="LAST,FIRST MI", FMT=Return Format ("LAST, FI")
"RTN","ORAMX",221,0)
 N ORLAST,ORLI,ORFIRST,ORFI,ORMI,ORI
"RTN","ORAMX",222,0)
 I X']"" S FMT="" G NAMEX
"RTN","ORAMX",223,0)
 I $S('$D(FMT):1,'$L(FMT):1,1:0) S FMT="LAST,FIRST"
"RTN","ORAMX",224,0)
 S FMT=$$LOW^XLFSTR(FMT)
"RTN","ORAMX",225,0)
 S ORLAST=$P(X,","),ORLI=$E(ORLAST),ORFIRST=$P(X,",",2)
"RTN","ORAMX",226,0)
 S ORFI=$E(ORFIRST)
"RTN","ORAMX",227,0)
 S ORMI=$S($P(ORFIRST," ",2)'="NMI":$E($P(ORFIRST," ",2)),1:"")
"RTN","ORAMX",228,0)
 S ORFIRST=$P(ORFIRST," ")
"RTN","ORAMX",229,0)
 F ORI="last","li","first","fi","mi" I FMT[ORI S FMT=$P(FMT,ORI)_@("OR"_$$UP^XLFSTR(ORI))_$P(FMT,ORI,2)
"RTN","ORAMX",230,0)
NAMEX Q FMT
"RTN","ORAMX",231,0)
PATIENT() ; Select a patient
"RTN","ORAMX",232,0)
 N X,DIC,Y
"RTN","ORAMX",233,0)
 S DIC=2,DIC(0)="AEMQ" D ^DIC
"RTN","ORAMX",234,0)
 Q Y
"RTN","ORAMX",235,0)
VALIDORD(ORDA) ; Screen Orderable for INR
"RTN","ORAMX",236,0)
 N ORDNM,ORY,ORDGDA,ORID S ORDNM="",ORY=0
"RTN","ORAMX",237,0)
 ; if orderable item inactive, exclude it
"RTN","ORAMX",238,0)
 I +$G(^ORD(101.43,+ORDA,.1))>0 G VOX
"RTN","ORAMX",239,0)
 ; if display group is not LABORATORY, exclude it
"RTN","ORAMX",240,0)
 S ORDGDA=$P($G(^ORD(101.43,+ORDA,0)),U,5)
"RTN","ORAMX",241,0)
 I $S(+ORDGDA'>0:1,$P($G(^ORD(100.98,+ORDGDA,0)),U)'="LABORATORY":1,1:0) G VOX
"RTN","ORAMX",242,0)
 ; if ID not valid, exclude it
"RTN","ORAMX",243,0)
 S ORID=+$P($G(^ORD(101.43,+ORDA,0)),U,2)
"RTN","ORAMX",244,0)
 I '$$VALIDLAB(ORID) G VOX
"RTN","ORAMX",245,0)
 ; otherwise, allow selection
"RTN","ORAMX",246,0)
 S ORY=1
"RTN","ORAMX",247,0)
VOX Q ORY
"RTN","ORAMX",248,0)
VALIDLAB(ORID) ; Is lab test valid?
"RTN","ORAMX",249,0)
 N ORY S ORY=0
"RTN","ORAMX",250,0)
 I $S(+ORID'>0:1,'$D(^LAB(60,+ORID,0)):1,1:0) G VLX
"RTN","ORAMX",251,0)
 ; if entry in LABORATORY TEST file (#60) doesn't have a LOCATION (DATA NAME), exclude it
"RTN","ORAMX",252,0)
 I '$L($P($G(^LAB(60,+ORID,0)),U,5)) G VLX
"RTN","ORAMX",253,0)
 ; otherwise, allow selection
"RTN","ORAMX",254,0)
 S ORY=1
"RTN","ORAMX",255,0)
VLX Q ORY
"RTN","ORAMX",256,0)
TEAMLIST(ORLIST) ; Team List Reports
"RTN","ORAMX",257,0)
 N DIC,DHD,FLDS,L,FR,BY,TO,ORCL,ORPAR,ORALIST,ORCLIST
"RTN","ORAMX",258,0)
 S DIC="^OR(100.21,",L=0,FLDS="[ORAM TEAM LIST]",BY="[ORAM TEAM LIST]"
"RTN","ORAMX",259,0)
 W !!,"List of ",$S(ORLIST="A":"ALL",1:"COMPLEX")," Anticoagulation Patients for a Clinic",!
"RTN","ORAMX",260,0)
 S ORCL=$$SELLOC^ORAMSET
"RTN","ORAMX",261,0)
 I +ORCL'>0 D  Q
"RTN","ORAMX",262,0)
 . W $C(7),!!,"You must select a Clinic to proceed...",!
"RTN","ORAMX",263,0)
 D GET^ORAMSET(.ORPAR,ORCL)
"RTN","ORAMX",264,0)
 S ORALIST=$P($G(ORPAR(0)),U,2),ORCLIST=$P($G(ORPAR(0)),U,3)
"RTN","ORAMX",265,0)
 S:+ORALIST ORALIST=$P($G(^OR(100.21,ORALIST,0)),U)
"RTN","ORAMX",266,0)
 S:+ORCLIST ORCLIST=$P($G(^OR(100.21,ORCLIST,0)),U)
"RTN","ORAMX",267,0)
 S (FR,TO,DHD)=$S(ORLIST="A":ORALIST,1:ORCLIST)
"RTN","ORAMX",268,0)
 I FR']"" D  Q
"RTN","ORAMX",269,0)
 . W !,"You must define a list for ",$S(ORLIST="A":"ALL",1:"COMPLEX")," Anticoagulation Patients."
"RTN","ORAMX",270,0)
 . W $$READ("EA","Press Return to Continue...")
"RTN","ORAMX",271,0)
 D EN1^DIP
"RTN","ORAMX",272,0)
 Q
"RTN","ORAMX",273,0)
NEXTLAB ; Next Lab Report
"RTN","ORAMX",274,0)
 N DIC,DHD,FLDS,L,FR,BY,TO,ORCL,OREDT,ORLDT
"RTN","ORAMX",275,0)
 S DIC="^ORAM(103,",L=0,FLDS="[ORAM TEAM LIST]",BY="@CLINIC,NEXT LAB,@PATIENT",(OREDT,ORLDT)=""
"RTN","ORAMX",276,0)
 W !!,"List Anticoagulation Patients with Pending Lab Draws",!
"RTN","ORAMX",277,0)
 S ORCL=$$SELLOC^ORAMSET
"RTN","ORAMX",278,0)
 I +ORCL'>0 D  Q
"RTN","ORAMX",279,0)
 . W $C(7),!!,"You must select a Clinic to proceed...",!
"RTN","ORAMX",280,0)
 S ORCL=$P($G(^SC(+ORCL,0)),U)
"RTN","ORAMX",281,0)
 F  D  Q:+ORLDT>+OREDT!$D(DIRUT)
"RTN","ORAMX",282,0)
 . S OREDT=+$$READ("DA^::E","Please Enter START Date: ","T","Enter a start date for the report")
"RTN","ORAMX",283,0)
 . Q:'OREDT
"RTN","ORAMX",284,0)
 . S ORLDT=+$$READ("DA^::E","  Please Enter END Date: ","T+14","Enter an INCLUSIVE end date for the report")
"RTN","ORAMX",285,0)
 . Q:'ORLDT
"RTN","ORAMX",286,0)
 . I $L(ORLDT,".")=1 S ORLDT=ORLDT_".2359"
"RTN","ORAMX",287,0)
 . I OREDT>ORLDT W !,"END DATE must be more recent than the START DATE" S (OREDT,ORLDT)=""
"RTN","ORAMX",288,0)
 Q:$S(OREDT'>0:1,ORLDT'>0:1,1:0)
"RTN","ORAMX",289,0)
 S OREDT=$$FMTE^XLFDT(OREDT,2),ORLDT=$$FMTE^XLFDT(ORLDT,2)
"RTN","ORAMX",290,0)
 S DHD=ORCL_" Next Lab Report"
"RTN","ORAMX",291,0)
 S FR=ORCL_","_OREDT,TO=ORCL_","_ORLDT
"RTN","ORAMX",292,0)
 D EN1^DIP
"RTN","ORAMX",293,0)
 Q
"RTN","ORAMY")
0^^B23662959^n/a
"RTN","ORAMY",1,0)
ORAMY ; ISL/JER - Anticoagulation Management Installation ;12/16/09  15:31
"RTN","ORAMY",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307**;Dec 17, 1997;Build 60
"RTN","ORAMY",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMY",4,0)
 Q
"RTN","ORAMY",5,0)
POST ; Post-install routine
"RTN","ORAMY",6,0)
 D ATTRPT
"RTN","ORAMY",7,0)
 D REGRPCS
"RTN","ORAMY",8,0)
 D PARAM
"RTN","ORAMY",9,0)
 Q
"RTN","ORAMY",10,0)
ATTRPT ; Set Anticoagulation Flowsheet Report as item in ORRPW REPORT CATEGORIES
"RTN","ORAMY",11,0)
 N ORRIEN,ORRNM,ORERRF,ORFDA,ORAFIEN,ORAFNM,ORLNE
"RTN","ORAMY",12,0)
 N ORMSG,ORTXT
"RTN","ORAMY",13,0)
 K ORMSG
"RTN","ORAMY",14,0)
 D BMES^XPDUTL(" Attaching Anticoagulation Flowsheet to ORRPW REPORT CATEGORIES...")
"RTN","ORAMY",15,0)
 S ORRNM="ORRPW REPORT CATEGORIES"
"RTN","ORAMY",16,0)
 S ORRIEN=$$FIND1^DIC(101.24,"","X",ORRNM,"","","")
"RTN","ORAMY",17,0)
 ;If ORRPW REPORT CATEGORIES not found, error
"RTN","ORAMY",18,0)
 I ORRIEN'>0 D  I 1
"RTN","ORAMY",19,0)
 . S ORMSG(1)="**"
"RTN","ORAMY",20,0)
 . S ORMSG(2)="** "_ORRNM_" not found **"
"RTN","ORAMY",21,0)
 . S ORMSG(3)="**"
"RTN","ORAMY",22,0)
 . D MES^XPDUTL(.ORMSG) K ORMSG
"RTN","ORAMY",23,0)
 . S ORERRF=1
"RTN","ORAMY",24,0)
 ELSE  D
"RTN","ORAMY",25,0)
 . S ORAFNM="ORAM ANTICOAG REPORT"
"RTN","ORAMY",26,0)
 . S ORAFIEN=$$FIND1^DIC(101.24,"","X",ORAFNM,"","","")
"RTN","ORAMY",27,0)
 . ;If ORAM ANTICOAG REPORT not found, error
"RTN","ORAMY",28,0)
 . I ORAFIEN'>0 D  Q
"RTN","ORAMY",29,0)
 . . S ORMSG(1)="**"
"RTN","ORAMY",30,0)
 . . S ORMSG(2)="** "_ORAFNM_" not found **"
"RTN","ORAMY",31,0)
 . . S ORMSG(3)="**"
"RTN","ORAMY",32,0)
 . . D MES^XPDUTL(.ORMSG) K ORMSG
"RTN","ORAMY",33,0)
 . . S ORERRF=1
"RTN","ORAMY",34,0)
 . ;Attach ORAM ANTICOAG REPORT to ORRPW REPORT CATEGORIES
"RTN","ORAMY",35,0)
 . N ORFDA,ORIEN,ORMSG
"RTN","ORAMY",36,0)
 . S ORFDA(101.241,"?+10,"_ORRIEN_",",.01)=ORAFIEN
"RTN","ORAMY",37,0)
 . D UPDATE^DIE("","ORFDA","ORIEN","ORMSG")
"RTN","ORAMY",38,0)
 . ;Check for error
"RTN","ORAMY",39,0)
 . I $D(ORMSG("DIERR")) D  Q
"RTN","ORAMY",40,0)
 . . S ORMSG(1)="**"
"RTN","ORAMY",41,0)
 . . S ORMSG(2)="** Unable to attach "_ORAFNM_" to "_ORRNM_" **"
"RTN","ORAMY",42,0)
 . . S ORMSG(3)="**"
"RTN","ORAMY",43,0)
 . . D MES^XPDUTL(.ORMSG) K ORMSG
"RTN","ORAMY",44,0)
 . . S ORERRF=1
"RTN","ORAMY",45,0)
 . S ORMSG(1)=" "
"RTN","ORAMY",46,0)
 . S ORMSG(2)=" ... "_ORAFNM_$S($G(ORIEN(10,0))="?":" already",1:"")_" attached to "_ORRNM_" ..."
"RTN","ORAMY",47,0)
 . D MES^XPDUTL(.ORMSG) K ORMSG
"RTN","ORAMY",48,0)
 ;Check for error
"RTN","ORAMY",49,0)
 I $G(ORERRF) D
"RTN","ORAMY",50,0)
 . S ORMSG(1)="** Post-installation interrupted"
"RTN","ORAMY",51,0)
 . S ORMSG(2)="** Please contact Enterprise VistA Support"
"RTN","ORAMY",52,0)
 . D MES^XPDUTL(.ORMSG) K ORMSG
"RTN","ORAMY",53,0)
 Q
"RTN","ORAMY",54,0)
 ;
"RTN","ORAMY",55,0)
REGRPCS ; Register RPCS
"RTN","ORAMY",56,0)
 D BMES^XPDUTL(" Registering RPCs with Context Menu ORAM ANTICOAGULATION CONTEXT...")
"RTN","ORAMY",57,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWPCE SCDIS")
"RTN","ORAMY",58,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWPCE SCSEL")
"RTN","ORAMY",59,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWTPP GETCOS")
"RTN","ORAMY",60,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWTPP GETDCOS")
"RTN","ORAMY",61,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","TIU SIGN RECORD")
"RTN","ORAMY",62,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","TIU CREATE RECORD")
"RTN","ORAMY",63,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","TIU DELETE RECORD")
"RTN","ORAMY",64,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","TIU REQUIRES COSIGNATURE")
"RTN","ORAMY",65,0)
 Q
"RTN","ORAMY",66,0)
 ;
"RTN","ORAMY",67,0)
REGISTER(OPTION,RPC) ; Call FM Updater to register each RPC
"RTN","ORAMY",68,0)
 ; Input  -- OPTION   Option file (#19) Name field (#.01)
"RTN","ORAMY",69,0)
 ;           RPC      RPC sub-file (#19.05) RPC field (#.01)
"RTN","ORAMY",70,0)
 ; Output -- None
"RTN","ORAMY",71,0)
 N FDA,FDAIEN,ERR,DIERR
"RTN","ORAMY",72,0)
 S FDA(19,"?1,",.01)=OPTION
"RTN","ORAMY",73,0)
 S FDA(19.05,"?+2,?1,",.01)=RPC
"RTN","ORAMY",74,0)
 D UPDATE^DIE("E","FDA","FDAIEN","ERR")
"RTN","ORAMY",75,0)
 Q
"RTN","ORAMY",76,0)
PARAM ; main (initial) parameter transport routine
"RTN","ORAMY",77,0)
 N ORENT,IDX,ROOT,REF,ORVAL,I
"RTN","ORAMY",78,0)
 D BMES^XPDUTL(" Installing List of Indications for Care...")
"RTN","ORAMY",79,0)
 S ROOT=$NAME(^TMP("ORAMY",$J)) K @ROOT
"RTN","ORAMY",80,0)
 D LOAD(ROOT)
"RTN","ORAMY",81,0)
 S IDX=0,ORENT="PKG.ORDER ENTRY/RESULTS REPORTING"
"RTN","ORAMY",82,0)
 F  S IDX=$O(@ROOT@(IDX)) Q:'IDX  D
"RTN","ORAMY",83,0)
 . N ORPAR,ORINST,ORIVAL,OREVAL,ORERR
"RTN","ORAMY",84,0)
 . S ORPAR=$P(@ROOT@(IDX,"KEY"),U),ORINST=$P(^("KEY"),U,2)
"RTN","ORAMY",85,0)
 . S ORIVAL=$P(@ROOT@(IDX,"VAL"),U),OREVAL=$P(^("VAL"),U,2)
"RTN","ORAMY",86,0)
 . D BMES^XPDUTL(" Installing "_ORINST_" = "_OREVAL)
"RTN","ORAMY",87,0)
 . D EN^XPAR(ORENT,ORPAR,ORINST,ORIVAL,.ORERR)
"RTN","ORAMY",88,0)
 . I +$G(ORERR)>0 D BMES^XPDUTL(" Error Occurred for "_ORINST_" = "_OREVAL_": "_$P(ORERR,U,2))
"RTN","ORAMY",89,0)
 K @ROOT
"RTN","ORAMY",90,0)
 Q
"RTN","ORAMY",91,0)
LOAD(ROOT) ; load data into ^TMP (expects ROOT to be defined)
"RTN","ORAMY",92,0)
 N I,REF
"RTN","ORAMY",93,0)
 S I=1,ROOT=$E(ROOT,1,$L(ROOT)-1)_","
"RTN","ORAMY",94,0)
 F  S REF=$P($T(DATA+I),";",3,999) Q:REF=""  D
"RTN","ORAMY",95,0)
 . N ORVAL
"RTN","ORAMY",96,0)
 . S ORVAL=$P($T(DATA+I+1),";",3,999)
"RTN","ORAMY",97,0)
 . S @(ROOT_REF)=ORVAL,I=I+2
"RTN","ORAMY",98,0)
 Q
"RTN","ORAMY",99,0)
DATA ; parameter data
"RTN","ORAMY",100,0)
 ;;14701,"KEY")
"RTN","ORAMY",101,0)
 ;;ORAM INDICATIONS FOR CARE^A Fib
"RTN","ORAMY",102,0)
 ;;14701,"VAL")
"RTN","ORAMY",103,0)
 ;;`2557^427.31
"RTN","ORAMY",104,0)
 ;;14702,"KEY")
"RTN","ORAMY",105,0)
 ;;ORAM INDICATIONS FOR CARE^A Flutter
"RTN","ORAMY",106,0)
 ;;14702,"VAL")
"RTN","ORAMY",107,0)
 ;;`2558^427.32
"RTN","ORAMY",108,0)
 ;;14703,"KEY")
"RTN","ORAMY",109,0)
 ;;ORAM INDICATIONS FOR CARE^CVA
"RTN","ORAMY",110,0)
 ;;14703,"VAL")
"RTN","ORAMY",111,0)
 ;;`9069^436.
"RTN","ORAMY",112,0)
 ;;14704,"KEY")
"RTN","ORAMY",113,0)
 ;;ORAM INDICATIONS FOR CARE^DVT
"RTN","ORAMY",114,0)
 ;;14704,"VAL")
"RTN","ORAMY",115,0)
 ;;`15011^453.89
"RTN","ORAMY",116,0)
 ;;14705,"KEY")
"RTN","ORAMY",117,0)
 ;;ORAM INDICATIONS FOR CARE^Hypercoag State
"RTN","ORAMY",118,0)
 ;;14705,"VAL")
"RTN","ORAMY",119,0)
 ;;`13798^289.81
"RTN","ORAMY",120,0)
 ;;14706,"KEY")
"RTN","ORAMY",121,0)
 ;;ORAM INDICATIONS FOR CARE^PE
"RTN","ORAMY",122,0)
 ;;14706,"VAL")
"RTN","ORAMY",123,0)
 ;;`13157^415.19
"RTN","ORAMY",124,0)
 ;;14707,"KEY")
"RTN","ORAMY",125,0)
 ;;ORAM INDICATIONS FOR CARE^TIA
"RTN","ORAMY",126,0)
 ;;14707,"VAL")
"RTN","ORAMY",127,0)
 ;;`2591^435.9
"RTN","ORAMY",128,0)
 ;;14708,"KEY")
"RTN","ORAMY",129,0)
 ;;ORAM INDICATIONS FOR CARE^Valve-Tissue
"RTN","ORAMY",130,0)
 ;;14708,"VAL")
"RTN","ORAMY",131,0)
 ;;`11516^V42.2
"RTN","ORAMY",132,0)
 ;;14709,"KEY")
"RTN","ORAMY",133,0)
 ;;ORAM INDICATIONS FOR CARE^Valve-Mech
"RTN","ORAMY",134,0)
 ;;14709,"VAL")
"RTN","ORAMY",135,0)
 ;;`11527^V43.3
"RTN","ORAMY",136,0)
 ;;14710,"KEY")
"RTN","ORAMY",137,0)
 ;;ORAM INDICATIONS FOR CARE^L/T (Current) Anticoag Use
"RTN","ORAMY",138,0)
 ;;14710,"VAL")
"RTN","ORAMY",139,0)
 ;;`13194^V58.61
"RTN","ORAMY",140,0)
 ;;14711,"KEY")
"RTN","ORAMY",141,0)
 ;;ORAM INDICATIONS FOR CARE^Enctr for Tx Drug Monitoring
"RTN","ORAMY",142,0)
 ;;14711,"VAL")
"RTN","ORAMY",143,0)
 ;;`13529^V58.83
"RTN","ORWOR")
0^8^B36027702^B35518390
"RTN","ORWOR",1,0)
ORWOR ; SLC/KCM - Orders Calls;10:54 PM  08/15/2006 ;09/02/09  15:56
"RTN","ORWOR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,132,141,163,187,190,215,243,307**;Dec 17, 1997;Build 60
"RTN","ORWOR",3,0)
 ;
"RTN","ORWOR",4,0)
CURRENT(LST,DFN) ; Get Current Orders for a Patient
"RTN","ORWOR",5,0)
 ; Returns two lists in ^TMP("ORW",$J), fields and text
"RTN","ORWOR",6,0)
 N TM,IEN,X,X0,X3,CTR,IDX,I
"RTN","ORWOR",7,0)
 K ^TMP("ORW",$J)
"RTN","ORWOR",8,0)
 S IDX=0,DFN=DFN_";DPT("
"RTN","ORWOR",9,0)
 S TM=0 F  S TM=$O(^OR(100,"AC",DFN,TM)) Q:TM<1  D
"RTN","ORWOR",10,0)
 . S IEN=0 F  S IEN=$O(^OR(100,"AC",DFN,TM,IEN)) Q:IEN<1  D
"RTN","ORWOR",11,0)
 . . S X0=^OR(100,IEN,0),X3=^(3)
"RTN","ORWOR",12,0)
 . . S X=IEN_U_$P(X0,U,7)_U_$P(X0,U,11)_U_$P(X3,U,6)_U_$P(X3,U,3)
"RTN","ORWOR",13,0)
 . . S ^TMP("ORW",$J,IDX+1)=X
"RTN","ORWOR",14,0)
 . . S (CTR,I)=0,X=""
"RTN","ORWOR",15,0)
 . . F  S I=$O(^OR(100,IEN,1,I)) Q:I<1  D  Q:CTR>244
"RTN","ORWOR",16,0)
 . . . S X=X_$E(^OR(100,IEN,1,I,0),1,(245-CTR)),CTR=$L(X)
"RTN","ORWOR",17,0)
 . . S ^TMP("ORW",$J,IDX+2)=X,IDX=IDX+2
"RTN","ORWOR",18,0)
 ; S LST=$NA(^TMP("ORW",$J))
"RTN","ORWOR",19,0)
 M LST=^TMP("ORW",$J)
"RTN","ORWOR",20,0)
 Q
"RTN","ORWOR",21,0)
DETAIL(LST,ORID,DFN)    ; Return details of ORID (shell to kill VIDEO subs)
"RTN","ORWOR",22,0)
 Q:'+ORID
"RTN","ORWOR",23,0)
 I $G(DFN) N ORVP S ORVP=DFN_";DPT("
"RTN","ORWOR",24,0)
 S LST="^TMP(""ORTXT"",$J)"
"RTN","ORWOR",25,0)
 D DETAIL^ORQ2(.LST,ORID)
"RTN","ORWOR",26,0)
 K @LST@("VIDEO")
"RTN","ORWOR",27,0)
 S LST=$NA(^TMP("ORTXT",$J)),@LST=""
"RTN","ORWOR",28,0)
 Q
"RTN","ORWOR",29,0)
RESULT(REF,DFN,ORID,ID)      ; Return results of order identified by ID
"RTN","ORWOR",30,0)
 K ^TMP("ORXPND",$J)
"RTN","ORWOR",31,0)
 N ORESULTS,ORVP,LCNT S ORESULTS=1,LCNT=0,ORVP=DFN_";DPT("
"RTN","ORWOR",32,0)
 D ORDERS^ORCXPND1
"RTN","ORWOR",33,0)
 K ^TMP("ORXPND",$J,"VIDEO")
"RTN","ORWOR",34,0)
 S REF=$NA(^TMP("ORXPND",$J))
"RTN","ORWOR",35,0)
 Q
"RTN","ORWOR",36,0)
RESHIST(REF,DFN,ORID,ID)      ; Return result history of associated tests identified by ID
"RTN","ORWOR",37,0)
 K ^TMP("ORXPND",$J)
"RTN","ORWOR",38,0)
 N ORESULTS,ORVP,LCNT
"RTN","ORWOR",39,0)
 S ORESULTS=1,LCNT=0,ORVP=DFN_";DPT("
"RTN","ORWOR",40,0)
 D ORDHIST^ORWOR2
"RTN","ORWOR",41,0)
 K ^TMP("ORXPND",$J,"VIDEO")
"RTN","ORWOR",42,0)
 S REF=$NA(^TMP("ORXPND",$J))
"RTN","ORWOR",43,0)
 Q
"RTN","ORWOR",44,0)
TSALL(LST)      ; Return list of treating specialties
"RTN","ORWOR",45,0)
 N Y S Y=0
"RTN","ORWOR",46,0)
 F  S Y=$O(^DIC(45.7,Y)) Q:'Y  I $$ACTIVE^DGACT(45.7,Y) S LST(Y)=Y_U_$P(^DIC(45.7,Y,0),U)
"RTN","ORWOR",47,0)
 Q
"RTN","ORWOR",48,0)
DT(X) ; -- Returns FM date for X (SEE ORCHTAB1)
"RTN","ORWOR",49,0)
 N Y,%DT S %DT="T",Y="" D:X'="" ^%DT
"RTN","ORWOR",50,0)
 Q +Y
"RTN","ORWOR",51,0)
VWSET(ORERR,VIEW)       ; Set the preferred view for orders
"RTN","ORWOR",52,0)
 ; VIEW:  semi-colon delimited record
"RTN","ORWOR",53,0)
 ;        1 - Relative From Date/Time or ""
"RTN","ORWOR",54,0)
 ;        2 - Relative Thru Date/Time or ""
"RTN","ORWOR",55,0)
 ;        3 - Filter
"RTN","ORWOR",56,0)
 ;        4 - Display Group Pointer
"RTN","ORWOR",57,0)
 ;        5 - Format (preserve for list manager)
"RTN","ORWOR",58,0)
 ;        6 - chronological display (R or F)
"RTN","ORWOR",59,0)
 ;        7 - sort by display group
"RTN","ORWOR",60,0)
 N FMT
"RTN","ORWOR",61,0)
 ; use short name for display group instead of pointer
"RTN","ORWOR",62,0)
 I $E($P(VIEW,";",2))="T" S $P(VIEW,";",2)=$P($P(VIEW,";",2),"@") ;allows all orders for Today
"RTN","ORWOR",63,0)
 S $P(VIEW,";",4)=$P($G(^ORD(100.98,+$P(VIEW,";",4),0)),U,3)
"RTN","ORWOR",64,0)
 ; use last saved format, since this is used only by LM
"RTN","ORWOR",65,0)
 S FMT=$P($$GET^XPAR("ALL","ORCH CONTEXT ORDERS",1,"I"),";",5)
"RTN","ORWOR",66,0)
 S:'$L(FMT) FMT="L" S $P(VIEW,";",5)=FMT
"RTN","ORWOR",67,0)
 ; and save the parameter
"RTN","ORWOR",68,0)
 D EN^XPAR(DUZ_";VA(200,","ORCH CONTEXT ORDERS",1,VIEW,.ORERR)
"RTN","ORWOR",69,0)
 Q
"RTN","ORWOR",70,0)
VWGET(REC)      ; Get the preferred view for orders
"RTN","ORWOR",71,0)
 N FROM,THRU,FILTER,DGRP,FRMT,CHRN,BYGRP,S,VNAME,FL
"RTN","ORWOR",72,0)
 S REC=$$GET^XPAR("ALL","ORCH CONTEXT ORDERS",1,"I"),S=";"
"RTN","ORWOR",73,0)
 S FROM=$$DT($P(REC,S)),THRU=$$DT($P(REC,S,2)),FILTER=$P(REC,S,3)
"RTN","ORWOR",74,0)
 S DGRP=$P(REC,S,4),FRMT=$P(REC,S,5),CHRN=$P(REC,S,6),BYGRP=$P(REC,S,7)
"RTN","ORWOR",75,0)
 S:'$L(DGRP) DGRP="ALL" S DGRP=+$O(^ORD(100.98,"B",DGRP,0))
"RTN","ORWOR",76,0)
 I FILTER="" S FILTER=2  ; active orders
"RTN","ORWOR",77,0)
 I CHRN="" S CHRN="R"    ; reverse chronological
"RTN","ORWOR",78,0)
 I BYGRP="" S BYGRP=1    ; sort by display group
"RTN","ORWOR",79,0)
 ; set up view name
"RTN","ORWOR",80,0)
 D REVSTS^ORWORDG(.FL)
"RTN","ORWOR",81,0)
 S I=0 F  S I=$O(FL(I)) Q:'I  Q:+FL(I)=FILTER
"RTN","ORWOR",82,0)
 S VNAME=$P($G(FL(+I)),U,2)
"RTN","ORWOR",83,0)
 I '("^6^8^9^10^19^20^"[(U_FILTER_U)) S VNAME=VNAME_" Orders"
"RTN","ORWOR",84,0)
 I FILTER=2 S VNAME="Active Orders (includes Pending & Recent Activity)"
"RTN","ORWOR",85,0)
 I FILTER=23 S VNAME="Current Orders (Active & Pending Status Only)"
"RTN","ORWOR",86,0)
 S VNAME=VNAME_" - "_$P($G(^ORD(100.98,DGRP,0)),U)
"RTN","ORWOR",87,0)
 I (FROM>0)!(THRU>0) D
"RTN","ORWOR",88,0)
 . S VNAME=VNAME_" ("_$$FMTE^XLFDT(FROM,"2D")_" thru "
"RTN","ORWOR",89,0)
 . S VNAME=VNAME_$S(THRU>0:$$FMTE^XLFDT(THRU,"2D"),1:"")_")"
"RTN","ORWOR",90,0)
 S REC=FROM_S_THRU_S_FILTER_S_DGRP_S_FRMT_S_CHRN_S_BYGRP_S_VNAME
"RTN","ORWOR",91,0)
 Q
"RTN","ORWOR",92,0)
SHEETS(LST,ORVP) ; Return Order Sheets for a patient
"RTN","ORWOR",93,0)
 N ELST,ETYP,ORIFN,TS,I
"RTN","ORWOR",94,0)
 S ORVP=ORVP_";DPT("
"RTN","ORWOR",95,0)
 S ETYP="" F  S ETYP=$O(^OR(100,"AEVNT",ORVP,ETYP)) Q:ETYP=""  D
"RTN","ORWOR",96,0)
 . S ORIFN=0 F  S ORIFN=$O(^OR(100,"AEVNT",ORVP,ETYP,ORIFN)) Q:'ORIFN  D
"RTN","ORWOR",97,0)
 . . I (ETYP="A")!(ETYP="T") S ELST(ETYP,$P($G(^OR(100,+ORIFN,0)),U,13))=""
"RTN","ORWOR",98,0)
 S LST(1)="C;O^Current View",I=1
"RTN","ORWOR",99,0)
 S TS="" F  S TS=$O(ELST("A",TS)) Q:TS=""  D
"RTN","ORWOR",100,0)
 . S I=I+1,LST(I)="A;"_TS_U_"Admit to "_$P($G(^DIC(45.7,TS,0)),U)
"RTN","ORWOR",101,0)
 S I=I+1,LST(I)="A;-1^Admit..."
"RTN","ORWOR",102,0)
 S TS="" F  S TS=$O(ELST("T",TS)) Q:TS=""  D
"RTN","ORWOR",103,0)
 . S I=I+1,LST(I)="T;"_TS_U_"Transfer to "_$P($G(^DIC(45.7,TS,0)),U)
"RTN","ORWOR",104,0)
 I $L($G(^DPT(+ORVP,.1))) D
"RTN","ORWOR",105,0)
 . S I=I+1,LST(I)="T;-1^Transfer..."
"RTN","ORWOR",106,0)
 . S I=I+1,LST(I)="D;0^Discharge"
"RTN","ORWOR",107,0)
 Q
"RTN","ORWOR",108,0)
EVENTS(LST,EVT) ; Return general delayed events categories for a patient
"RTN","ORWOR",109,0)
 N EVTI
"RTN","ORWOR",110,0)
 S EVTI=0
"RTN","ORWOR",111,0)
 S EVTI=EVTI+1,LST(EVTI)="A;-1^Admit..."
"RTN","ORWOR",112,0)
 S EVTI=EVTI+1,LST(EVTI)="T;-1^Transfer..."
"RTN","ORWOR",113,0)
 S EVTI=EVTI+1,LST(EVTI)="D;0^Discharge"
"RTN","ORWOR",114,0)
 Q
"RTN","ORWOR",115,0)
UNSIGN(LST,ORVP,HAVE)   ; Return Unsigned Orders that are not on client
"RTN","ORWOR",116,0)
 N IFN,ACT,X8,ENT,LVL,TM,ILST S ILST=0
"RTN","ORWOR",117,0)
 Q:'$D(^XUSEC("ORES",DUZ))&('$D(^XUSEC("ORELSE",DUZ))&'$D(^ORAM(103,+ORVP)))
"RTN","ORWOR",118,0)
 S ORVP=ORVP_";DPT("
"RTN","ORWOR",119,0)
 S ENT="ALL"_$S($G(^VA(200,DUZ,5)):"^SRV.`"_+^(5),1:"")
"RTN","ORWOR",120,0)
 S LVL=$$GET^XPAR(ENT,"OR UNSIGNED ORDERS ON EXIT")
"RTN","ORWOR",121,0)
 Q:'LVL
"RTN","ORWOR",122,0)
 S TM=0 F  S TM=$O(^OR(100,"AS",ORVP,TM)) Q:TM<1  D
"RTN","ORWOR",123,0)
 . S IFN=0 F  S IFN=$O(^OR(100,"AS",ORVP,TM,IFN)) Q:IFN<1  D
"RTN","ORWOR",124,0)
 . . S ACT=0 F  S ACT=$O(^OR(100,"AS",ORVP,TM,IFN,ACT)) Q:ACT<1  D
"RTN","ORWOR",125,0)
 . . . Q:$D(HAVE(IFN_";"_ACT))                        ;in Changes
"RTN","ORWOR",126,0)
 . . . S X8=$G(^OR(100,IFN,8,ACT,0))
"RTN","ORWOR",127,0)
 . . . I '$S(LVL=1&($P(X8,U,3)=DUZ):1,LVL=2:1,1:0) Q  ;chk user
"RTN","ORWOR",128,0)
 . . . S ILST=ILST+1,LST(ILST)=IFN_";"_ACT_U_$P(X8,U,3)
"RTN","ORWOR",129,0)
 Q
"RTN","ORWOR",130,0)
PKIUSE(RETURN) ; RPC determines user can use PKI Digital Signature
"RTN","ORWOR",131,0)
 S RETURN=0
"RTN","ORWOR",132,0)
 I $$GET^XPAR("ALL^USR.`"_DUZ,"ORWOR PKI USE",1,"Q") S RETURN=1
"RTN","ORWOR",133,0)
 Q
"RTN","ORWOR",134,0)
PKISITE(RETURN) ; RPC determines if PKI is turned on at the site
"RTN","ORWOR",135,0)
 S RETURN=0
"RTN","ORWOR",136,0)
 Q:'$L($T(STORESIG^XUSSPKI))  ;Check for Kernel piece
"RTN","ORWOR",137,0)
 Q:'$L($T(DOSE^PSSOPKI1))  ;Check for Pharmacy piece
"RTN","ORWOR",138,0)
 I $$GET^XPAR("ALL","ORWOR PKI SITE",1,"Q") S RETURN=1
"RTN","ORWOR",139,0)
 Q
"RTN","ORWOR",140,0)
ACTXT(ORY,ORIFN) ;Return detail action information
"RTN","ORWOR",141,0)
 N ORI,CNT,OR0,OR3,OR6
"RTN","ORWOR",142,0)
 K ^TMP("ORACTXT",$J)
"RTN","ORWOR",143,0)
 S ORY="^TMP(""ORACTXT"",$J)",ORI=$P(ORIFN,";",2)
"RTN","ORWOR",144,0)
 S CNT=0,ORIFN=+ORIFN,OR0=$G(^OR(100,ORIFN,0)),OR3=$G(^(3)),OR6=$G(^(6))
"RTN","ORWOR",145,0)
 F  S ORI=$O(^OR(100,+ORIFN,8,ORI)) Q:ORI'>0  S ACTION=$G(^(ORI,0)) D ACT^ORQ20
"RTN","ORWOR",146,0)
 S ORY=$NA(^TMP("ORACTXT",$J)),@ORY=""
"RTN","ORWOR",147,0)
 Q
"RTN","ORWOR",148,0)
EXPIRED(ORY) ;return FM date/time to begin search for expired orders
"RTN","ORWOR",149,0)
 N HRS
"RTN","ORWOR",150,0)
 S HRS=$$GET^XPAR("ALL","ORWOR EXPIRED ORDERS",1,"I")
"RTN","ORWOR",151,0)
 S ORY=$$FMADD^XLFDT($$NOW^XLFDT,"","-"_HRS,"","")
"RTN","ORWOR",152,0)
 Q
"SEC","^DIC",103,103,0,"AUDIT")

"SEC","^DIC",103,103,0,"DD")
@
"SEC","^DIC",103,103,0,"DEL")

"SEC","^DIC",103,103,0,"LAYGO")

"SEC","^DIC",103,103,0,"RD")

"SEC","^DIC",103,103,0,"WR")

"VER")
8.0^22.0
"^DD",101.24,101.24,0)
FIELD^^.491^43
"^DD",101.24,101.24,0,"DDA")
N
"^DD",101.24,101.24,0,"DT")
3080416
"^DD",101.24,101.24,0,"ID",.23)
W:$D(^(2)) "   ",$P(^(2),U,3)
"^DD",101.24,101.24,0,"ID",.24)
W:$D(^(2)) "   ",$P(^(2),U,4)
"^DD",101.24,101.24,0,"IX","AC",101.24,.02)

"^DD",101.24,101.24,0,"IX","B",101.24,.01)

"^DD",101.24,101.24,0,"NM","OE/RR REPORT")

"^DD",101.24,101.24,0,"PT",101.24,.18)

"^DD",101.24,101.24,0,"PT",101.241,.01)

"^DD",101.24,101.24,0,"VRPK")
OR
"^DD",101.24,101.24,0,"VRRV")
1^3070507
"^DD",101.24,101.24,.001,0)
NUMBER^NJ5,0^^ ^K:+X'=X!(X>10000)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.001,3)
Type a Number between 1 and 10000, 0 Decimal Digits
"^DD",101.24,101.24,.001,21,0)
^^1^1^3000921^
"^DD",101.24,101.24,.001,21,1,0)
This is the Number field for the file.
"^DD",101.24,101.24,.001,"DT")
3000920
"^DD",101.24,101.24,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",101.24,101.24,.01,1,0)
^.1^^-1
"^DD",101.24,101.24,.01,1,1,0)
101.24^B
"^DD",101.24,101.24,.01,1,1,1)
S ^ORD(101.24,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.24,.01,1,1,2)
K ^ORD(101.24,"B",$E(X,1,30),DA)
"^DD",101.24,101.24,.01,3)
Answer must be 3-30 characters in length.
"^DD",101.24,101.24,.01,21,0)
^^1^1^3000921^
"^DD",101.24,101.24,.01,21,1,0)
This is the Name of the report.
"^DD",101.24,101.24,.01,"DT")
3010510
"^DD",101.24,101.24,.02,0)
ID^RF^^0;2^K:$L(X)>10!($L(X)<1) X
"^DD",101.24,101.24,.02,1,0)
^.1
"^DD",101.24,101.24,.02,1,1,0)
101.24^AC
"^DD",101.24,101.24,.02,1,1,1)
S ^ORD(101.24,"AC",$E(X,1,30),DA)=""
"^DD",101.24,101.24,.02,1,1,2)
K ^ORD(101.24,"AC",$E(X,1,30),DA)
"^DD",101.24,101.24,.02,1,1,"DT")
3001005
"^DD",101.24,101.24,.02,3)
Answer must be 1-10 characters in length.
"^DD",101.24,101.24,.02,21,0)
^^4^4^3000921^
"^DD",101.24,101.24,.02,21,1,0)
This is the code that identifies the report.  Each tab in CPRS that
"^DD",101.24,101.24,.02,21,2,0)
uses reports looks for this ID in order to process the report.
"^DD",101.24,101.24,.02,21,3,0)
Each tab also uses a unique set of ID's.  An ID of 5 on the Reports
"^DD",101.24,101.24,.02,21,4,0)
Tab may not identify the same report on a different tab.
"^DD",101.24,101.24,.02,"DT")
3001005
"^DD",101.24,101.24,.03,0)
REMOTE^S^1:YES;2:REMOTE ONLY;^0;3^Q
"^DD",101.24,101.24,.03,21,0)
^^2^2^3000921^
"^DD",101.24,101.24,.03,21,1,0)
This field is used to identify which reports allow remote access through
"^DD",101.24,101.24,.03,21,2,0)
Remote Data Views.
"^DD",101.24,101.24,.03,"DT")
3050512
"^DD",101.24,101.24,.04,0)
QUALIFIER^S^1:HSType;2:DateTime;3:Imaging;4:NutrAssess;19:MedicineProcedure;39:ListView;5:HSComponent;6:HSWPComponent;28:Surgery;^0;4^Q
"^DD",101.24,101.24,.04,21,0)
^.001^2^2^3010531^^^
"^DD",101.24,101.24,.04,21,1,0)
This field identifies which qualifier to use when processing the report.
"^DD",101.24,101.24,.04,21,2,0)
Examples of qualifiers are HSType, DateTime, Imaging and NutrAssess.
"^DD",101.24,101.24,.04,"DT")
3011004
"^DD",101.24,101.24,.05,0)
ROUTINE^FI^^0;5^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.05,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.05,8.5)
@
"^DD",101.24,101.24,.05,9)
@
"^DD",101.24,101.24,.05,21,0)
^.001^1^1^3001026^^^
"^DD",101.24,101.24,.05,21,1,0)
This is the routine that is invoked to produce the report.
"^DD",101.24,101.24,.05,23,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.05,23,1,0)
The Labs Tab does not have a value for this field.  The CPRS executable
"^DD",101.24,101.24,.05,23,2,0)
calls separate RPC's for each report.
"^DD",101.24,101.24,.05,"DT")
3040126
"^DD",101.24,101.24,.06,0)
ENTRY POINT^FI^^0;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.06,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.06,8.5)
@
"^DD",101.24,101.24,.06,9)
@
"^DD",101.24,101.24,.06,21,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.06,21,1,0)
This is the entry point for the ROUTINE that is invoked to produce the
"^DD",101.24,101.24,.06,21,2,0)
report.
"^DD",101.24,101.24,.06,23,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.06,23,1,0)
The Labs Tab does not have a value for this field.  The CPRS executable
"^DD",101.24,101.24,.06,23,2,0)
calls separate RPC's for each report.
"^DD",101.24,101.24,.06,"DT")
3040126
"^DD",101.24,101.24,.07,0)
CATEGORY^S^0:FIXED;1:FIXED W/DATE;2:FIXED W/HEADER;3:FIXED W/DATE&HEADER;4:SPECIALIZED;5:GRAPHIC;6:LISTVIEW;^0;7^Q
"^DD",101.24,101.24,.07,3)
Enter a category for this report
"^DD",101.24,101.24,.07,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.07,21,1,0)
This field puts reports into a category that is evaluated by the GUI
"^DD",101.24,101.24,.07,21,2,0)
when the report is processed.
"^DD",101.24,101.24,.07,"DT")
3010215
"^DD",101.24,101.24,.08,0)
TAB^S^R:REPORTS TAB;L:LABS TAB;C:COVER SHEET;CD:COVER SHEET DETAILS;^0;8^Q
"^DD",101.24,101.24,.08,3)
Enter the appropriate code for this report.
"^DD",101.24,101.24,.08,21,0)
^.001^1^1^3001003^^
"^DD",101.24,101.24,.08,21,1,0)
This fields identifies the appropriate tab for a report in CPRS.
"^DD",101.24,101.24,.08,"DT")
3001011
"^DD",101.24,101.24,.09,0)
MIXEDCASE^S^1:YES;^0;9^Q
"^DD",101.24,101.24,.09,3)
Enter YES to display the list in mixed case
"^DD",101.24,101.24,.09,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.09,21,1,0)
This is used in the cover sheet and is used to display the returned
"^DD",101.24,101.24,.09,21,2,0)
list in mixed case.
"^DD",101.24,101.24,.09,"DT")
3001004
"^DD",101.24,101.24,.1,0)
INVERT^S^1:YES;^0;10^Q
"^DD",101.24,101.24,.1,3)
Enter YES to have the returned list inverted.
"^DD",101.24,101.24,.1,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.1,21,1,0)
This field is used to invert a list of data returned in the Cover sheet
"^DD",101.24,101.24,.1,"DT")
3001004
"^DD",101.24,101.24,.11,0)
TEXT COLOR^S^Black:BLACK;Maroon:MAROON;Green:GREEN;Olive:OLIVE;Purple:PURPLE;Teal:TEAL;Red:RED;Lime:LIME;Yellow:YELLOW;Blue:BLUE;Fuchsia:FUCHSIA;Aqua:AQUA;^0;11^Q
"^DD",101.24,101.24,.11,3)
Enter the color for the text
"^DD",101.24,101.24,.11,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.11,21,1,0)
This field determines the text color for the returned data.
"^DD",101.24,101.24,.11,"DT")
3001004
"^DD",101.24,101.24,.12,0)
TYPE^S^R:REPORT;H:HTML;L:LISTMAN ONLY;S:SELECTION LIST;V:LISTVIEW;M:MENU;G:GRAPH;^0;12^Q
"^DD",101.24,101.24,.12,3)
Enter the type for this entry.
"^DD",101.24,101.24,.12,21,0)
^.001^1^1^3001017^^
"^DD",101.24,101.24,.12,21,1,0)
This field identifies the type for an entry.
"^DD",101.24,101.24,.12,"DT")
3041208
"^DD",101.24,101.24,.13,0)
RPC^P8994'^XWB(8994,^0;13^Q
"^DD",101.24,101.24,.13,3)
Select the RPC that produces this report.
"^DD",101.24,101.24,.13,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.13,21,1,0)
This is the RPC that is called inside the GUI to produce the report.
"^DD",101.24,101.24,.13,"DT")
3001004
"^DD",101.24,101.24,.14,0)
DATE FORMAT^S^D:DATE ONLY;T:DATE WITH TIME;^0;14^Q
"^DD",101.24,101.24,.14,3)
Enter the code for the desired date format.
"^DD",101.24,101.24,.14,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.14,21,1,0)
This field determines what kind of format to display date/time fields.
"^DD",101.24,101.24,.14,"DT")
3001004
"^DD",101.24,101.24,.15,0)
DATE PIECE^NJ2,0^^0;15^K:+X'=X!(X>15)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.15,3)
Type a Number between 1 and 15, 0 Decimal Digits
"^DD",101.24,101.24,.15,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.15,21,1,0)
This is used on the Cover Sheet to determine which piece the date field
"^DD",101.24,101.24,.15,21,2,0)
occupies.
"^DD",101.24,101.24,.15,"DT")
3001004
"^DD",101.24,101.24,.16,0)
TAB POSITIONS^F^^0;16^K:$L(X)>15!($L(X)<1) X
"^DD",101.24,101.24,.16,3)
Answer must be 1-15 characters in length.
"^DD",101.24,101.24,.16,21,0)
^^2^2^3001005^
"^DD",101.24,101.24,.16,21,1,0)
This is the value that will be used for the Tab property for the listbox
"^DD",101.24,101.24,.16,21,2,0)
associated with this report on the Cover Sheet.
"^DD",101.24,101.24,.16,"DT")
3001005
"^DD",101.24,101.24,.17,0)
PIECES^F^^0;17^K:$L(X)>20!($L(X)<1) X
"^DD",101.24,101.24,.17,3)
Answer must be 1-20 characters in length.
"^DD",101.24,101.24,.17,21,0)
^^2^2^3001011^
"^DD",101.24,101.24,.17,21,1,0)
This field is used by the Cover Sheet to determine what pieces of data
"^DD",101.24,101.24,.17,21,2,0)
to display in the listbox.
"^DD",101.24,101.24,.17,"DT")
3001011
"^DD",101.24,101.24,.18,0)
DETAIL REPORT^*P101.24'^ORD(101.24,^0;18^S DIC("S")="I $P(^(0),""^"",8)=""CD""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",101.24,101.24,.18,3)
Enter the report to get the details for this report.
"^DD",101.24,101.24,.18,12)
Allow only Cover sheet detail type reports
"^DD",101.24,101.24,.18,12.1)
S DIC("S")="I $P(^(0),""^"",8)=""CD"""
"^DD",101.24,101.24,.18,21,0)
^^1^1^3001011^
"^DD",101.24,101.24,.18,21,1,0)
This field is used to get the details of an item on the cover sheet.
"^DD",101.24,101.24,.18,"DT")
3001011
"^DD",101.24,101.24,.19,0)
REPORT TAG^FI^^0;19^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.19,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.19,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.19,21,1,0)
This is the entry point tag for a report extract.
"^DD",101.24,101.24,.19,"DT")
3080507
"^DD",101.24,101.24,.191,0)
REPORT ROUTINE^FI^^0;20^K:$L(X)>8!($L(X)<3) X
"^DD",101.24,101.24,.191,3)
Answer must be 3-8 characters in length.
"^DD",101.24,101.24,.191,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.191,21,1,0)
This is the routine associated with the REPORT TAG for report extracts.
"^DD",101.24,101.24,.191,"DT")
3070507
"^DD",101.24,101.24,.192,0)
REPORT COMPONENT^P142.1'^GMT(142.1,^0;21^Q
"^DD",101.24,101.24,.192,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.192,21,1,0)
This is the report component associated with this report.
"^DD",101.24,101.24,.192,"DT")
3010503
"^DD",101.24,101.24,.21,0)
PARAM 1^F^^2;1^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.24,.21,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.24,.21,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.21,21,1,0)
This is the 1st parameter passed to the RPC, if needed.
"^DD",101.24,101.24,.21,"DT")
3001004
"^DD",101.24,101.24,.22,0)
PARAM 2^F^^2;2^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.24,.22,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.24,.22,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.22,21,1,0)
This is the 2nd parameter passed to the RPC, if needed.
"^DD",101.24,101.24,.22,"DT")
3001004
"^DD",101.24,101.24,.23,0)
HEADING^F^^2;3^K:$L(X)>75!($L(X)<1) X
"^DD",101.24,101.24,.23,1,0)
^.1^^0
"^DD",101.24,101.24,.23,3)
Answer must be 1-75 characters in length.
"^DD",101.24,101.24,.23,21,0)
^^1^1^3001031^
"^DD",101.24,101.24,.23,21,1,0)
This is the heading used on the Cover sheet for the list of items.
"^DD",101.24,101.24,.23,"DT")
3010510
"^DD",101.24,101.24,.24,0)
DESCRIPTIVE TEXT^RF^^2;4^K:$L(X)>55!($L(X)<2) X
"^DD",101.24,101.24,.24,3)
Answer must be 2-55 characters in length.
"^DD",101.24,101.24,.24,21,0)
^.001^2^2^3010510^^
"^DD",101.24,101.24,.24,21,1,0)
This is a more descriptive name than what might be included in the 
"^DD",101.24,101.24,.24,21,2,0)
NAME field.
"^DD",101.24,101.24,.24,"DT")
3010510
"^DD",101.24,101.24,.25,0)
NODE^F^^2;5^K:$L(X)>10!($L(X)<1) X
"^DD",101.24,101.24,.25,3)
Answer must be 1-10 characters in length.
"^DD",101.24,101.24,.25,21,0)
^^2^2^3001005^
"^DD",101.24,101.24,.25,21,1,0)
This is used by the Cover Sheet routines to define the node in the ^XTMP
"^DD",101.24,101.24,.25,21,2,0)
global to store the data.
"^DD",101.24,101.24,.25,"DT")
3001005
"^DD",101.24,101.24,.26,0)
PRINT TAG^FI^^2;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.26,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.26,21,0)
^^2^2^3010614^
"^DD",101.24,101.24,.26,21,1,0)
This is the entry point tag used when printing reports that do their own
"^DD",101.24,101.24,.26,21,2,0)
Write statements.
"^DD",101.24,101.24,.26,"DT")
3070507
"^DD",101.24,101.24,.27,0)
PRINT ROUTINE^FI^^2;7^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.27,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.27,21,0)
^^2^2^3010614^
"^DD",101.24,101.24,.27,21,1,0)
This is the entry point routine used when printing reports that do their own
"^DD",101.24,101.24,.27,21,2,0)
Write statements.
"^DD",101.24,101.24,.27,"DT")
3070507
"^DD",101.24,101.24,.28,0)
EXTRACT TAG^FI^^2;8^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.28,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.28,21,0)
^^2^2^3010711^
"^DD",101.24,101.24,.28,21,1,0)
This is the entry point for the extract routine that pulls the data from
"^DD",101.24,101.24,.28,21,2,0)
package API's and/or package files.
"^DD",101.24,101.24,.28,"DT")
3080318
"^DD",101.24,101.24,.29,0)
EXTRACT ROUTINE^FI^^2;9^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.29,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.29,21,0)
^^2^2^3010711^
"^DD",101.24,101.24,.29,21,1,0)
This is the extract routine that pulls data from package API's and/or
"^DD",101.24,101.24,.29,21,2,0)
package files.
"^DD",101.24,101.24,.29,"DT")
3070507
"^DD",101.24,101.24,.41,0)
SORT ORDER^F^^4;1^K:$L(X)>15!($L(X)<3)!'(X?1N1":"1N) X
"^DD",101.24,101.24,.41,3)
Answer must be 3-15 characters in length.
"^DD",101.24,101.24,.41,21,0)
^^6^6^3010717^
"^DD",101.24,101.24,.41,21,1,0)
This field is used when sorting columns of data on at grid within CPRS.
"^DD",101.24,101.24,.41,21,2,0)
It determines the sort order to be used in a multi-column sort.  The
"^DD",101.24,101.24,.41,21,3,0)
primary sort column is always the column header clicked on by the user.
"^DD",101.24,101.24,.41,21,4,0)
If this field has values in the form #:#, then a multi-column sort is
"^DD",101.24,101.24,.41,21,5,0)
done, using the column numbers identified in this field for the second
"^DD",101.24,101.24,.41,21,6,0)
and third level sorting.
"^DD",101.24,101.24,.41,"DT")
3010717
"^DD",101.24,101.24,.42,0)
MAXIMUM DAYS BACK^NJ4,0^^4;2^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.42,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",101.24,101.24,.42,21,0)
^^1^1^3011004^
"^DD",101.24,101.24,.42,21,1,0)
This field restricts the report date range to the maximum value specified.
"^DD",101.24,101.24,.42,"DT")
3011004
"^DD",101.24,101.24,.43,0)
FHIE REPORT^F^^4;3^K:$L(X)>10!($L(X)<2) X
"^DD",101.24,101.24,.43,3)
Answer must be 2-10 characters in length.
"^DD",101.24,101.24,.43,21,0)
^.001^3^3^3040126^^^^
"^DD",101.24,101.24,.43,21,1,0)
This field identifies reports that are available through FHIE.
"^DD",101.24,101.24,.43,21,2,0)
The item in this field is the code for the report available through
"^DD",101.24,101.24,.43,21,3,0)
the FHIE server.
"^DD",101.24,101.24,.43,23,0)
^.001^3^3^3040126^^^^
"^DD",101.24,101.24,.43,23,1,0)
This field is not looked at by reports that have a 'listview' format.
"^DD",101.24,101.24,.43,23,2,0)
It is only used by straight text reports that go through the routine:
"^DD",101.24,101.24,.43,23,3,0)
  ORDV01
"^DD",101.24,101.24,.43,"DT")
3031008
"^DD",101.24,101.24,.44,0)
DIRECT^S^0:NO;1:YES;^4;4^Q
"^DD",101.24,101.24,.44,3)
ENTER YES TO MAKE DIRECT REMOTE DATA CALLS
"^DD",101.24,101.24,.44,21,0)
^^4^4^3050201^
"^DD",101.24,101.24,.44,21,1,0)
This field allows a report to make a direct remote data call to
"^DD",101.24,101.24,.44,21,2,0)
a remote site.  Use caution in setting this field to yes.  It has
"^DD",101.24,101.24,.44,21,3,0)
the effect of disabling CPRS until the remote call is finished, but
"^DD",101.24,101.24,.44,21,4,0)
also may speed up the query by bypassing taskman latency.
"^DD",101.24,101.24,.44,"DT")
3050201
"^DD",101.24,101.24,.45,0)
HDR REPORT^S^1:YES;^4;5^Q
"^DD",101.24,101.24,.45,3)
Enter 'YES' if this report comes from the HDR.
"^DD",101.24,101.24,.45,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.45,21,1,0)
This field flags reports that are generated from the HDR.
"^DD",101.24,101.24,.45,"DT")
3051006
"^DD",101.24,101.24,.46,0)
HDR ROUTINE^FI^^4;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.46,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.46,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.46,21,1,0)
This is the HDR routine that modifies HDR data for CPRS.
"^DD",101.24,101.24,.46,"DT")
3080318
"^DD",101.24,101.24,.47,0)
HDR ENTRY POINT^FI^^4;7^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.47,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.47,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.47,21,1,0)
This is the HDR entry point that modifies HDR data for CPRS.
"^DD",101.24,101.24,.47,"DT")
3080318
"^DD",101.24,101.24,.48,0)
FHIE DATA^S^1:YES;^4;8^Q
"^DD",101.24,101.24,.48,3)
Enter YES if this report gets data from DOD/FHIE
"^DD",101.24,101.24,.48,21,0)
^.001^3^3^3070208^^
"^DD",101.24,101.24,.48,21,1,0)
This field is used to tell CPRS that DOD/FHIE data can be accessed
"^DD",101.24,101.24,.48,21,2,0)
for this report.  Special code has to be written by CPRS and DOD
"^DD",101.24,101.24,.48,21,3,0)
for this to happen.
"^DD",101.24,101.24,.48,"DT")
3070208
"^DD",101.24,101.24,.49,0)
FHIE ONLY^S^1:YES;^4;9^Q
"^DD",101.24,101.24,.49,3)
Enter YES if only DOD data should be shown for this report.
"^DD",101.24,101.24,.49,21,0)
^^2^2^3080415^
"^DD",101.24,101.24,.49,21,1,0)
This field determines if a report can show local VA data and Remote DOD
"^DD",101.24,101.24,.49,21,2,0)
data. Enter YES if only DOD data should be shown for this report.
"^DD",101.24,101.24,.49,"DT")
3080415
"^DD",101.24,101.24,.491,0)
DISABLE^S^1:YES;^4;10^Q
"^DD",101.24,101.24,.491,3)
Enter YES to disable this report.
"^DD",101.24,101.24,.491,21,0)
^^1^1^3080416^
"^DD",101.24,101.24,.491,21,1,0)
This field will disable a report.
"^DD",101.24,101.24,.491,"DT")
3080416
"^DD",101.24,101.24,3,0)
COLUMN HEADERS^101.243^^3;0
"^DD",101.24,101.24,10,0)
ITEM^101.241P^^10;0
"^DD",101.24,101.241,0)
ITEM SUB-FIELD^^.03^3
"^DD",101.24,101.241,0,"DT")
3010215
"^DD",101.24,101.241,0,"IX","B",101.241,.01)

"^DD",101.24,101.241,0,"NM","ITEM")

"^DD",101.24,101.241,0,"UP")
101.24
"^DD",101.24,101.241,.01,0)
ITEM^MP101.24^ORD(101.24,^0;1^Q
"^DD",101.24,101.241,.01,1,0)
^.1
"^DD",101.24,101.241,.01,1,1,0)
101.241^B
"^DD",101.24,101.241,.01,1,1,1)
S ^ORD(101.24,DA(1),10,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.241,.01,1,1,2)
K ^ORD(101.24,DA(1),10,"B",$E(X,1,30),DA)
"^DD",101.24,101.241,.01,3)

"^DD",101.24,101.241,.01,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.01,21,1,0)
This is used in building a treeview of reports for CPRS GUI.
"^DD",101.24,101.241,.01,"DT")
3010215
"^DD",101.24,101.241,.02,0)
HEADER TEXT^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.241,.02,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.241,.02,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.02,21,1,0)
This is the header to be used.
"^DD",101.24,101.241,.02,"DT")
3010215
"^DD",101.24,101.241,.03,0)
SEQUENCE^NJ7,1^^0;3^K:+X'=X!(X>99999)!(X<.1)!(X?.E1"."2N.N) X
"^DD",101.24,101.241,.03,3)
Type a Number between .1 and 99999, 1 Decimal Digit
"^DD",101.24,101.241,.03,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.03,21,1,0)
This is the sequence number for this report.
"^DD",101.24,101.241,.03,"DT")
3010215
"^DD",101.24,101.243,0)
COLUMN HEADERS SUB-FIELD^^1^11
"^DD",101.24,101.243,0,"DT")
3051006
"^DD",101.24,101.243,0,"IX","B",101.243,.01)

"^DD",101.24,101.243,0,"IX","C",101.243,.03)

"^DD",101.24,101.243,0,"NM","COLUMN HEADERS")

"^DD",101.24,101.243,0,"UP")
101.24
"^DD",101.24,101.243,.01,0)
COLUMN HEADERS^MF^^0;1^K:$L(X)>60!($L(X)<1) X
"^DD",101.24,101.243,.01,1,0)
^.1
"^DD",101.24,101.243,.01,1,1,0)
101.243^B
"^DD",101.24,101.243,.01,1,1,1)
S ^ORD(101.24,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.243,.01,1,1,2)
K ^ORD(101.24,DA(1),3,"B",$E(X,1,30),DA)
"^DD",101.24,101.243,.01,3)
Answer must be 1-60 characters in length.
"^DD",101.24,101.243,.01,21,0)
^.001^1^1^3010709^^^^
"^DD",101.24,101.243,.01,21,1,0)
These are the column headings used on a report in ListView format.
"^DD",101.24,101.243,.01,"DT")
3010709
"^DD",101.24,101.243,.02,0)
VISIBLE^S^0:YES;1:NO;^0;2^Q
"^DD",101.24,101.243,.02,3)
Set this field to NO to hide the column.
"^DD",101.24,101.243,.02,21,0)
^^1^1^3010420^
"^DD",101.24,101.243,.02,21,1,0)
This field determines the visible property of the column.
"^DD",101.24,101.243,.02,"DT")
3010420
"^DD",101.24,101.243,.03,0)
SEQUENCE^NJ6,1^^0;3^K:+X'=X!(X>9999)!(X<.1)!(X?.E1"."2N.N) X
"^DD",101.24,101.243,.03,1,0)
^.1
"^DD",101.24,101.243,.03,1,1,0)
101.243^C
"^DD",101.24,101.243,.03,1,1,1)
S ^ORD(101.24,DA(1),3,"C",$E(X,1,30),DA)=""
"^DD",101.24,101.243,.03,1,1,2)
K ^ORD(101.24,DA(1),3,"C",$E(X,1,30),DA)
"^DD",101.24,101.243,.03,1,1,"DT")
3010321
"^DD",101.24,101.243,.03,3)
Type a Number between .1 and 9999, 1 Decimal Digit
"^DD",101.24,101.243,.03,21,0)
^^1^1^3010215^
"^DD",101.24,101.243,.03,21,1,0)
This is the sequence for the column header.
"^DD",101.24,101.243,.03,"DT")
3010321
"^DD",101.24,101.243,.04,0)
TYPE^S^0:SINGLE PIECE VALUE;1:WORD PROCESSING;^0;4^Q
"^DD",101.24,101.243,.04,3)
Enter '1' if the value of this column contains multiple lines of text.
"^DD",101.24,101.243,.04,21,0)
^^1^1^3010420^
"^DD",101.24,101.243,.04,21,1,0)
This field identifies columns that contain multiple lines of text.
"^DD",101.24,101.243,.04,"DT")
3010420
"^DD",101.24,101.243,.05,0)
INCLUDE ON DETAIL^S^0:NO;1:YES;^0;5^Q
"^DD",101.24,101.243,.05,3)
Enter YES to include this field in detailed report
"^DD",101.24,101.243,.05,21,0)
^.001^2^2^3010628^^^^
"^DD",101.24,101.243,.05,21,1,0)
This field is used to determine what data to include in the details of
"^DD",101.24,101.243,.05,21,2,0)
a report.
"^DD",101.24,101.243,.05,"DT")
3010628
"^DD",101.24,101.243,.06,0)
PRINT LENGTH^NJ2,0^^0;6^K:+X'=X!(X>20)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.243,.06,3)
Type a Number between 1 and 20, 0 Decimal Digits
"^DD",101.24,101.243,.06,21,0)
^^1^1^3010628^
"^DD",101.24,101.243,.06,21,1,0)
This is the field length used when printing this column on a report.
"^DD",101.24,101.243,.06,"DT")
3010628
"^DD",101.24,101.243,.07,0)
INCLUDE ON PRINT^S^0:NO;1:YES;^0;7^Q
"^DD",101.24,101.243,.07,21,0)
^^2^2^3010628^
"^DD",101.24,101.243,.07,21,1,0)
This field determines which columns are included when a printout is
"^DD",101.24,101.243,.07,21,2,0)
requested.
"^DD",101.24,101.243,.07,"DT")
3010628
"^DD",101.24,101.243,.08,0)
PRINT TITLE^F^^0;8^K:$L(X)>20!($L(X)<1) X
"^DD",101.24,101.243,.08,3)
Answer must be 1-20 characters in length.
"^DD",101.24,101.243,.08,21,0)
^^1^1^3010628^
"^DD",101.24,101.243,.08,21,1,0)
This field is used when printing this field in lieu of the Column Header.
"^DD",101.24,101.243,.08,"DT")
3010628
"^DD",101.24,101.243,.09,0)
DATA TYPE^S^0:FREE TEXT;1:NUMERIC;2:DATE/TIME;^0;9^Q
"^DD",101.24,101.243,.09,3)
Enter the type of data that is in this column.
"^DD",101.24,101.243,.09,21,0)
^.001^3^3^3010718^^
"^DD",101.24,101.243,.09,21,1,0)
This is the data type of the column.  It is used when sorting columns.
"^DD",101.24,101.243,.09,21,2,0)
The default data type is 0 - FREE TEXT.  If no value is entered, it is
"^DD",101.24,101.243,.09,21,3,0)
assumed to be FREE TEXT.
"^DD",101.24,101.243,.09,"DT")
3010718
"^DD",101.24,101.243,.1,0)
WIDTH^NJ4,0^^0;10^K:+X'=X!(X>4000)!(X<-2)!(X?.E1"."1N.N) X
"^DD",101.24,101.243,.1,3)
Type a Number between -2 and 4000, 0 Decimal Digits
"^DD",101.24,101.243,.1,21,0)
^^5^5^3010727^
"^DD",101.24,101.243,.1,21,1,0)
This field is for the column width.  No value needs to be entered because
"^DD",101.24,101.243,.1,21,2,0)
the value is actually obtained from a User level parameter.  The field
"^DD",101.24,101.243,.1,21,3,0)
is defined here to reserve the 10 piece of this node so that future
"^DD",101.24,101.243,.1,21,4,0)
field definitions won't break the RPC used in CPRS to get column properties
"^DD",101.24,101.243,.1,21,5,0)
where the width is stored in the 10 piece.
"^DD",101.24,101.243,.1,"DT")
3010727
"^DD",101.24,101.243,1,0)
HDR MODIFIER^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.24,101.243,1,3)
This is Standard MUMPS code.
"^DD",101.24,101.243,1,9)
@
"^DD",101.24,101.243,1,21,0)
^^5^5^3051006^
"^DD",101.24,101.243,1,21,1,0)
This is code executed when HDR data needs to be modified.
"^DD",101.24,101.243,1,21,2,0)
When this field is executed, the variable ORX will have the value
"^DD",101.24,101.243,1,21,3,0)
passed in from the HDR.  If this value needs to be manipulated, set the
"^DD",101.24,101.243,1,21,4,0)
new value into ORX.  If the value is ignored (not to be displayed),
"^DD",101.24,101.243,1,21,5,0)
then set the value of ORX="-1-"
"^DD",101.24,101.243,1,"DT")
3051006
"^DD",103,103,0)
FIELD^^91^31
"^DD",103,103,0,"DDA")
N
"^DD",103,103,0,"DT")
3091002
"^DD",103,103,0,"IX","B",103,.01)

"^DD",103,103,0,"IX","CL",103,101)

"^DD",103,103,0,"IX","L",103,3)

"^DD",103,103,0,"NM","ORAM FLOWSHEET")

"^DD",103,103,.01,0)
PATIENT^P2X^DPT(^0;1^S DINUM=X
"^DD",103,103,.01,.1)
PATIENT NAME
"^DD",103,103,.01,1,0)
^.1
"^DD",103,103,.01,1,1,0)
103^B
"^DD",103,103,.01,1,1,1)
S ^ORAM(103,"B",$E(X,1,30),DA)=""
"^DD",103,103,.01,1,1,2)
K ^ORAM(103,"B",$E(X,1,30),DA)
"^DD",103,103,.01,3)

"^DD",103,103,.01,21,0)
^^1^1^3080929^
"^DD",103,103,.01,21,1,0)
Patient DFN from file 2
"^DD",103,103,.01,"DT")
3030522
"^DD",103,103,1,0)
GOAL INR^F^^0;2^K:$L(X)>10!($L(X)<1) X
"^DD",103,103,1,3)
Answer must be 1-10 characters in length.
"^DD",103,103,1,21,0)
^^2^2^3080929^
"^DD",103,103,1,21,1,0)
Stores the INR GOAL RANGE set by the user in the ANTICOAGULATOR.  
"^DD",103,103,1,21,2,0)
Contains a free text range, like: 2.0-3.0
"^DD",103,103,1,"DT")
3030520
"^DD",103,103,2,0)
INDICATION^F^^0;3^K:$L(X)>50!($L(X)<1) X
"^DD",103,103,2,3)
Answer must be 1-50 characters in length.
"^DD",103,103,2,21,0)
^^3^3^3080929^
"^DD",103,103,2,21,1,0)
Stores indication set in the Anticoagulator and ICD9 code for the 
"^DD",103,103,2,21,2,0)
indication.
"^DD",103,103,2,21,3,0)
Example: A Flutter=427.32
"^DD",103,103,2,"DT")
3040728
"^DD",103,103,3,0)
NEXT LAB^D^^0;4^S %DT="ETX" D ^%DT S X=Y K:X<1 X
"^DD",103,103,3,1,0)
^.1^^-1
"^DD",103,103,3,1,1,0)
103^L
"^DD",103,103,3,1,1,1)
S ^ORAM(103,"L",$E(X,1,30),DA)=""
"^DD",103,103,3,1,1,2)
K ^ORAM(103,"L",$E(X,1,30),DA)
"^DD",103,103,3,1,1,3)
** DO NOT DELETE **
"^DD",103,103,3,1,1,"%D",0)
^^2^2^3081219^
"^DD",103,103,3,1,1,"%D",1,0)
This REGULAR FileMan cross-reference on NEXT LAB will optimize both 
"^DD",103,103,3,1,1,"%D",2,0)
look-up and sorting by next lab date...
"^DD",103,103,3,1,1,"DT")
3081219
"^DD",103,103,3,3)
(No range limit on date)
"^DD",103,103,3,21,0)
^^1^1^3080929^
"^DD",103,103,3,21,1,0)
Fileman date of the next scheduled INR draw.
"^DD",103,103,3,"DT")
3090513
"^DD",103,103,4,0)
START DATE^F^^0;5^K:$L(X)>15!($L(X)<1) X
"^DD",103,103,4,3)
Answer must be 1-15 characters in length.
"^DD",103,103,4,21,0)
^^4^4^3080929^
"^DD",103,103,4,21,1,0)
Date patient was started in Anticoagulation clinic; in free text format 
"^DD",103,103,4,21,2,0)
(request from the field); contains whatever the operator entered.
"^DD",103,103,4,21,3,0)
example: 09/26/08
"^DD",103,103,4,21,4,0)
example: unknown
"^DD",103,103,4,"DT")
3040308
"^DD",103,103,5,0)
STOP DATE^F^^0;6^K:$L(X)>15!($L(X)<1) X
"^DD",103,103,5,3)
Answer must be 1-15 characters in length.
"^DD",103,103,5,21,0)
^^5^5^3080929^
"^DD",103,103,5,21,1,0)
Date patient was stopped OR expected to be stopped from needing followup
"^DD",103,103,5,21,2,0)
in Anticoagulation clinic; in free text format
"^DD",103,103,5,21,3,0)
(request from the field); contains whatever the operator entered.
"^DD",103,103,5,21,4,0)
example: 09/26/08
"^DD",103,103,5,21,5,0)
example: indefinite
"^DD",103,103,5,"DT")
3030814
"^DD",103,103,6,0)
DURATION^F^^0;7^K:$L(X)>40!($L(X)<1) X
"^DD",103,103,6,3)
Answer must be 1-40 characters in length.
"^DD",103,103,6,21,0)
^^3^3^3080929^
"^DD",103,103,6,21,1,0)
Expected length of time patient will be followed in Anticoagulation 
"^DD",103,103,6,21,2,0)
clinic.
"^DD",103,103,6,21,3,0)
Example: 6 months
"^DD",103,103,6,"DT")
3040728
"^DD",103,103,7,0)
SPECIAL INSTRUCTIONS^103.07^^1;0
"^DD",103,103,7,21,0)
^^4^4^3080929^
"^DD",103,103,7,21,1,0)
Word processing set of special instrections inputted into the
"^DD",103,103,7,21,2,0)
Anticoagulator.
"^DD",103,103,7,21,3,0)
Visible in the Anticoagulator and in the Header of the flow sheet on the 
"^DD",103,103,7,21,4,0)
REPORTS tab.
"^DD",103,103,8,0)
RISK FACTORS^103.08^^2;0
"^DD",103,103,8,21,0)
^^3^3^3080929^
"^DD",103,103,8,21,1,0)
Word processing set of risk factors inputted into the Anticoagulator.  
"^DD",103,103,8,21,2,0)
Visible in the Anticoagulator and in the Header of the flow sheet on the 
"^DD",103,103,8,21,3,0)
REPORTS tab.
"^DD",103,103,9,0)
SIGNED AGREEMENT^S^Y:yes;N:no;^0;8^Q
"^DD",103,103,9,3)
Does the patient has a signed agreement for treatment?
"^DD",103,103,9,21,0)
^.001^2^2^3090513^^^
"^DD",103,103,9,21,1,0)
Stores if patient has a signed agreement
"^DD",103,103,9,21,2,0)
Y=yes; N or ""=No.
"^DD",103,103,9,"DT")
3090513
"^DD",103,103,10,0)
ORIENTATION^F^^0;9^K:$L(X)>8!($L(X)<1) X
"^DD",103,103,10,3)
Answer must be 1-8 characters in length.
"^DD",103,103,10,21,0)
^.001^1^1^3090513^^
"^DD",103,103,10,21,1,0)
Free text entry for date of orientation classs.
"^DD",103,103,10,"DT")
3090513
"^DD",103,103,11,0)
FS DATE^103.011DA^^3;0
"^DD",103,103,15,0)
COMPLEXITY^S^0:STANDARD PT;1:COMPLEX PT;2:INACTIVE PT;^0;10^Q
"^DD",103,103,15,21,0)
^^1^1^3030815^
"^DD",103,103,15,21,1,0)
INDICATES IF PATIENT IS CURRENTLY COMPLEX, STANDARD OR INACTIVE
"^DD",103,103,15,"DT")
3030815
"^DD",103,103,25,0)
MSG-PHONE^S^0:NOT ASKED;1:NO MSGS;2:OK MSG;^0;11^Q
"^DD",103,103,25,21,0)
^^2^2^3080929^
"^DD",103,103,25,21,1,0)
PT PRIVACY ISSUE; indicates if pt approved leaving of msg on phone 
"^DD",103,103,25,21,2,0)
answering machine.
"^DD",103,103,25,"DT")
3030612
"^DD",103,103,35,0)
MSG WITH^103.035^^4;0
"^DD",103,103,35,21,0)
^^3^3^3080929^
"^DD",103,103,35,21,1,0)
If patient allows leaving of anticoagulation messages with others at 
"^DD",103,103,35,21,2,0)
his/her phone number, this indicates WHO is allowed to receive the 
"^DD",103,103,35,21,3,0)
messages.
"^DD",103,103,45,0)
AM MEDS^S^0:PM MEDS;1:AM MEDS;2:UNKNOWN;^0;12^Q
"^DD",103,103,45,"DT")
3030612
"^DD",103,103,55,0)
SAVE STATUS^F^^0;13^K:$L(X)>8!($L(X)<1) X
"^DD",103,103,55,3)
Answer must be 1-8 characters in length.
"^DD",103,103,55,21,0)
^.001^1^1^3090513^^
"^DD",103,103,55,21,1,0)
Indicates if this entry is complete ("SAVE") or incomplete ("TEMPSAVE").
"^DD",103,103,55,"DT")
3090513
"^DD",103,103,60,0)
FEE BASIS^S^0:NO;1:PRIMARY;2:SECONDARY;^0;14^Q
"^DD",103,103,60,21,0)
^^4^4^3080929^
"^DD",103,103,60,21,1,0)
 
"^DD",103,103,60,21,2,0)
****Not in use for export version; here for legacy systems*****
"^DD",103,103,60,21,3,0)
 
"^DD",103,103,60,21,4,0)
RECORDS IF FEE BASIS IS AUTHORIZED AND IF PRIMARY OR SECONDARY STATUS
"^DD",103,103,60,"DT")
3030821
"^DD",103,103,65,0)
FEE BASIS EXPIRATION^D^^0;15^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",103,103,65,21,0)
^^3^3^3080929^
"^DD",103,103,65,21,1,0)
****Not in use for export version; here for legacy systems*****
"^DD",103,103,65,21,2,0)
 
"^DD",103,103,65,21,3,0)
DATE WHICH FEE BASIS QUALIFICATION EXPIRES AND NEEDS TO BE REASSESSED.
"^DD",103,103,65,"DT")
3030821
"^DD",103,103,70,0)
FEE BASIS EVALUATED BY^F^^0;16^K:$L(X)>30!($L(X)<1) X
"^DD",103,103,70,3)
Answer must be 1-30 characters in length.
"^DD",103,103,70,21,0)
^^3^3^3080929^
"^DD",103,103,70,21,1,0)
****Not in use for export version; here for legacy systems*****
"^DD",103,103,70,21,2,0)
 
"^DD",103,103,70,21,3,0)
PERSON WHO EVALUATED PATIENT FOR FEE BASIS
"^DD",103,103,70,"DT")
3030821
"^DD",103,103,75,0)
OUTSIDE LAB^D^^0;17^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",103,103,75,21,0)
^^3^3^3080929^
"^DD",103,103,75,21,1,0)
*****Note in use for exported version*******************
"^DD",103,103,75,21,2,0)
 
"^DD",103,103,75,21,3,0)
expiration date for outside lab agreement.
"^DD",103,103,75,"DT")
3080929
"^DD",103,103,80,0)
Reminder Date^D^^0;18^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",103,103,80,21,0)
^^3^3^3080929^
"^DD",103,103,80,21,1,0)
If reminder is set; this is the first date it will begin to appear when 
"^DD",103,103,80,21,2,0)
the Anticoagulator is accessed.  It is only viewable in the 
"^DD",103,103,80,21,3,0)
Anticoagulator.
"^DD",103,103,80,"DT")
3040728
"^DD",103,103,85,0)
REMINDER^103.085^^5;0
"^DD",103,103,85,21,0)
^^4^4^3080929^
"^DD",103,103,85,21,1,0)
Free text item to remind person who is accessing the Anticoagulator on a 
"^DD",103,103,85,21,2,0)
specific patient that something needs to be done.  Will only appear at or 
"^DD",103,103,85,21,3,0)
after the reminder date (field 80).
"^DD",103,103,85,21,4,0)
example: "CBC due"
"^DD",103,103,90,0)
LOCK^S^0:OPEN;1:LOCKED;^0;19^Q
"^DD",103,103,90,21,0)
^^1^1^3040823^
"^DD",103,103,90,21,1,0)
IF 1; CHART IS IN USE BY SOMEONE ELSE.
"^DD",103,103,90,"DT")
3040823
"^DD",103,103,91,0)
NEXT DAY CALLBACK^S^0:NO;1:YES;^0;20^Q
"^DD",103,103,91,21,0)
^^2^2^3091002^
"^DD",103,103,91,21,1,0)
This Boolean field indicates whether the Clinician should wait until the 
"^DD",103,103,91,21,2,0)
day after the next INR Draw to call the patient.
"^DD",103,103,91,"DT")
3091002
"^DD",103,103,95,0)
RESTRICT LAB DRAWS^F^^6;1^K:$L(X)>5!($L(X)<1) X
"^DD",103,103,95,3)
Answer must be 1-5 characters in length.
"^DD",103,103,95,21,0)
^^2^2^3080929^
"^DD",103,103,95,21,1,0)
Indicates days the patient does not want lab drawn. Represented by a 
"^DD",103,103,95,21,2,0)
string, example: 135 means Mon,Wed,Friday
"^DD",103,103,95,"DT")
3060427
"^DD",103,103,101,0)
CLINIC^*P44'^SC(^6;2^S DIC("S")="I $$GOODLOC^ORAMSET(Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",103,103,101,1,0)
^.1
"^DD",103,103,101,1,1,0)
103^CL
"^DD",103,103,101,1,1,1)
S ^ORAM(103,"CL",$E(X,1,30),DA)=""
"^DD",103,103,101,1,1,2)
K ^ORAM(103,"CL",$E(X,1,30),DA)
"^DD",103,103,101,1,1,3)
** DO NOT DELETE! **
"^DD",103,103,101,1,1,"%D",0)
^.101^2^2^3090710^^^
"^DD",103,103,101,1,1,"%D",1,0)
This REGULAR whole-file cross-reference by Clinic location allows look-up 
"^DD",103,103,101,1,1,"%D",2,0)
and sorting of patients who are being followed by any particular clinic.
"^DD",103,103,101,1,1,"DT")
3090323
"^DD",103,103,101,3)
Enter the Clinic which is following the patient.
"^DD",103,103,101,12)
Only active clinics may be selected.
"^DD",103,103,101,12.1)
S DIC("S")="I $$GOODLOC^ORAMSET(Y)"
"^DD",103,103,101,21,0)
^^7^7^3090306^
"^DD",103,103,101,21,1,0)
Clinic which is currently following the patient.
"^DD",103,103,101,21,2,0)
 
"^DD",103,103,101,21,3,0)
Clinic determines many of the parameters which will determine the 
"^DD",103,103,101,21,4,0)
behavior of the Anticoagulation Management Application (e.g., Team 
"^DD",103,103,101,21,5,0)
List membership, Letterhead values, Visit locations for PCE, etc.).
"^DD",103,103,101,21,6,0)
If clinic is missing, it will be assigned when the user files the first 
"^DD",103,103,101,21,7,0)
flowsheet entry.
"^DD",103,103,101,"DT")
3090323
"^DD",103,103,102,0)
CMPLX^P100.21'^OR(100.21,^6;3^Q
"^DD",103,103,102,21,0)
^^1^1^3080920^
"^DD",103,103,102,21,1,0)
THIS FIELD IS NOT IN USE AT THIS TIME.
"^DD",103,103,102,"DT")
3080920
"^DD",103,103,110,0)
OUTSIDE HCT^F^^6;4^K:$L(X)>20!($L(X)<1) X
"^DD",103,103,110,3)
Answer must be 1-20 characters in length.
"^DD",103,103,110,21,0)
^^5^5^3080929^
"^DD",103,103,110,21,1,0)
Outside HCT lab value, entered by the pharmacist through the GUI, is 
"^DD",103,103,110,21,2,0)
stored here in the following format:
"^DD",103,103,110,21,3,0)
value | DATE 
"^DD",103,103,110,21,4,0)
date is not in fileman format
"^DD",103,103,110,21,5,0)
example: 21.6|9/19/2008
"^DD",103,103,110,"DT")
3080920
"^DD",103,103,111,0)
ELIGIBLE FOR LMWH BRIDGING^S^1:YES;0:NO;^6;5^Q
"^DD",103,103,111,3)
Indicate whether patient is eligible for LMWH Bridging.
"^DD",103,103,111,21,0)
^^2^2^3090501^
"^DD",103,103,111,21,1,0)
Please indicate whether the patient is eligible for perioperative Low
"^DD",103,103,111,21,2,0)
Molecular Weight Heparin bridging.
"^DD",103,103,111,"DT")
3090501
"^DD",103,103,112,0)
BRIDGING COMMENTS^103.0112^^7;0
"^DD",103,103.011,0)
FS DATE SUB-FIELD^^110^16
"^DD",103,103.011,0,"DT")
3090506
"^DD",103,103.011,0,"IX","B",103.011,.01)

"^DD",103,103.011,0,"NM","FS DATE")

"^DD",103,103.011,0,"UP")
103
"^DD",103,103.011,.01,0)
FS DATE^D^^0;1^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",103,103.011,.01,1,0)
^.1
"^DD",103,103.011,.01,1,1,0)
103.011^B
"^DD",103,103.011,.01,1,1,1)
S ^ORAM(103,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",103,103.011,.01,1,1,2)
K ^ORAM(103,DA(1),3,"B",$E(X,1,30),DA)
"^DD",103,103.011,.01,21,0)
^^1^1^3080929^
"^DD",103,103.011,.01,21,1,0)
Fileman date of the flow sheet entry.
"^DD",103,103.011,.01,"DT")
3030520
"^DD",103,103.011,20,0)
INR^F^^0;3^K:$L(X)>6!($L(X)<1) X
"^DD",103,103.011,20,3)
Answer must be 1-6 characters in length.
"^DD",103,103.011,20,21,0)
^^1^1^3080929^
"^DD",103,103.011,20,21,1,0)
INR value from outside lab; entered throught the Anticoagulator.
"^DD",103,103.011,20,"DT")
3030520
"^DD",103,103.011,30,0)
LAB DRAW LOC^F^^0;4^K:$L(X)>10!($L(X)<1) X
"^DD",103,103.011,30,3)
Answer must be 1-10 characters in length.
"^DD",103,103.011,30,21,0)
^^1^1^3080929^
"^DD",103,103.011,30,21,1,0)
Location of lab used for last outside lab draw (HCT or INR)
"^DD",103,103.011,30,"DT")
3030520
"^DD",103,103.011,40,0)
PILL STRENGTH^NJ5,2^^0;5^K:+X'=X!(X>10)!(X<1)!(X?.E1"."3N.N) X
"^DD",103,103.011,40,3)
Type a Number between 1 and 10, 2 Decimal Digits
"^DD",103,103.011,40,21,0)
^^2^2^3080929^
"^DD",103,103.011,40,21,1,0)
Strength of coumadin pill prescribed to patient; in mgs.  Currently 
"^DD",103,103.011,40,21,2,0)
Anticoagulator only supports using one pill strength for each patient.
"^DD",103,103.011,40,"DT")
3030520
"^DD",103,103.011,50,0)
TOTAL WEEKLY DOSE^NJ5,2^^0;6^K:+X'=X!(X>99)!(X<1)!(X?.E1"."3N.N) X
"^DD",103,103.011,50,3)
Type a Number between 1 and 99, 2 Decimal Digits
"^DD",103,103.011,50,21,0)
^^4^4^3080929^
"^DD",103,103.011,50,21,1,0)
Total weekly coumadin dose as established at this flow sheet entry.
"^DD",103,103.011,50,21,2,0)
If "Record Total Weekly dose" is not checked in the ANTICOAGULATER; then 
"^DD",103,103.011,50,21,3,0)
this field will contain '---' and nothing will display in that field on 
"^DD",103,103.011,50,21,4,0)
the flow sheet (on the REPORTS TAB in CPRS).
"^DD",103,103.011,50,"DT")
3030520
"^DD",103,103.011,60,0)
DAILY DOSING^F^^0;7^K:$L(X)>50!($L(X)<1) X
"^DD",103,103.011,60,3)
Answer must be 1-50 characters in length.
"^DD",103,103.011,60,21,0)
^^2^2^3080929^
"^DD",103,103.011,60,21,1,0)
mg of coumadin per day Sun - Sat separated by '|'.
"^DD",103,103.011,60,21,2,0)
example: 5|5|10|5|5|2.5|5
"^DD",103,103.011,60,"DT")
3030520
"^DD",103,103.011,70,0)
PATIENT NOTICE^F^^0;8^K:$L(X)>10!($L(X)<1) X
"^DD",103,103.011,70,3)
Answer must be 1-10 characters in length.
"^DD",103,103.011,70,21,0)
^^2^2^3080929^
"^DD",103,103.011,70,21,1,0)
How patient was contacted at this entry.  Free text and displays in flow 
"^DD",103,103.011,70,21,2,0)
sheet (CPRS REPORTS TAB).
"^DD",103,103.011,70,"DT")
3030520
"^DD",103,103.011,80,0)
D/T STAMP^D^^0;9^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",103,103.011,80,21,0)
^^1^1^3080929^
"^DD",103,103.011,80,21,1,0)
Entry date/time of item into the file.
"^DD",103,103.011,80,"DT")
3030520
"^DD",103,103.011,90,0)
PROVIDER^F^^0;10^K:$L(X)>40!($L(X)<1) X
"^DD",103,103.011,90,3)
Answer must be 1-40 characters in length.
"^DD",103,103.011,90,21,0)
^^1^1^3080929^
"^DD",103,103.011,90,21,1,0)
Provider (from file 200) that made the entry.
"^DD",103,103.011,90,"DT")
3030520
"^DD",103,103.011,92,0)
CURRENT INDICATION^F^^0;11^K:$L(X)>20!($L(X)<1) X
"^DD",103,103.011,92,3)
Answer must be 1-20 characters in length.
"^DD",103,103.011,92,21,0)
^^3^3^3080929^
"^DD",103,103.011,92,21,1,0)
Indication from the Anticoagulator drop down box, or free text. This is 
"^DD",103,103.011,92,21,2,0)
in case the indication changes over the course of treatment.
"^DD",103,103.011,92,21,3,0)
example: A Fib
"^DD",103,103.011,92,"DT")
3030702
"^DD",103,103.011,95,0)
CURRENT GOAL^F^^0;12^K:$L(X)>12!($L(X)<1) X
"^DD",103,103.011,95,3)
Answer must be 1-12 characters in length.
"^DD",103,103.011,95,21,0)
^^5^5^3080929^
"^DD",103,103.011,95,21,1,0)
Current goal range, in case it changed over the course of treatment.  The 
"^DD",103,103.011,95,21,2,0)
current ranges are used to determine the percent in goal, since the 
"^DD",103,103.011,95,21,3,0)
patient may have been in goal until the goal changed.  Only considered out
"^DD",103,103.011,95,21,4,0)
of goal if they are out of range for this reading; not how this visit 
"^DD",103,103.011,95,21,5,0)
compares to the most recent goal range.
"^DD",103,103.011,95,"DT")
3030702
"^DD",103,103.011,99,0)
COMMENTS^103.1199^^1;0
"^DD",103,103.011,99,21,0)
^^1^1^3080929^
"^DD",103,103.011,99,21,1,0)
Free text information for this flow sheet entry.
"^DD",103,103.011,100,0)
SHOW VALUE^S^0:KEPT APPT;1:W/I 1 DAY;2:NO SHOW;^0;13^Q
"^DD",103,103.011,100,21,0)
^^3^3^3031017^
"^DD",103,103.011,100,21,1,0)
RECORDS VALUES FOR A SHOW RATE.  WILL LOOK AT TOTAL VISITS WITH THIS 
"^DD",103,103.011,100,21,2,0)
FIELD COMPLETED CALCULATING PERCENT WITH ON TIME (0) OR WITHIN ONE DAY 
"^DD",103,103.011,100,21,3,0)
(1); SUGGESTS COMPLIANCE.  2= NOSHOW
"^DD",103,103.011,100,"DT")
3031017
"^DD",103,103.011,104,0)
COMPLICATION^S^1:MAJOR BLEED;2:CLOT;3:MINOR BLEED;^0;2^Q
"^DD",103,103.011,104,21,0)
^^3^3^3080929^
"^DD",103,103.011,104,21,1,0)
If present, indicates that a complication was noted.  Often noted 
"^DD",103,103.011,104,21,2,0)
historically, the date will either be the date of the entry OR the 
"^DD",103,103.011,104,21,3,0)
date will be in the COMPLICATIONS word processing fields.
"^DD",103,103.011,104,"DT")
3080920
"^DD",103,103.011,105,0)
COMPLICATION NOTE^103.11105^^2;0
"^DD",103,103.011,105,21,0)
^^1^1^3080929^
"^DD",103,103.011,105,21,1,0)
Free text or selected information on complication.
"^DD",103,103.011,110,0)
PATIENT INSTRUCTIONS^103.021^^3;0
"^DD",103,103.0112,0)
BRIDGING COMMENTS SUB-FIELD^^.01^1
"^DD",103,103.0112,0,"DT")
3090501
"^DD",103,103.0112,0,"NM","BRIDGING COMMENTS")

"^DD",103,103.0112,0,"UP")
103
"^DD",103,103.0112,.01,0)
BRIDGING COMMENTS^WLx^^0;1^Q
"^DD",103,103.0112,.01,3)
Enter comments pertaining to LMWH Bridging.
"^DD",103,103.0112,.01,21,0)
^^2^2^3090501^
"^DD",103,103.0112,.01,21,1,0)
Enter any relevant information pertaining to the LMWH Bridging to be used 
"^DD",103,103.0112,.01,21,2,0)
for this patient.
"^DD",103,103.0112,.01,"DT")
3090501
"^DD",103,103.021,0)
PATIENT INSTRUCTIONS SUB-FIELD^^.01^1
"^DD",103,103.021,0,"DT")
3090506
"^DD",103,103.021,0,"NM","PATIENT INSTRUCTIONS")

"^DD",103,103.021,0,"UP")
103.011
"^DD",103,103.021,.01,0)
PATIENT INSTRUCTIONS^WLx^^0;1^Q
"^DD",103,103.021,.01,3)
Enter patient instructions (from letter)
"^DD",103,103.021,.01,21,0)
^^1^1^3090506^
"^DD",103,103.021,.01,21,1,0)
This is the narrative included in the patient letter for the visit.
"^DD",103,103.021,.01,"DT")
3090506
"^DD",103,103.035,0)
MSG WITH SUB-FIELD^^.01^1
"^DD",103,103.035,0,"NM","MSG WITH")

"^DD",103,103.035,0,"UP")
103
"^DD",103,103.035,.01,0)
MSG WITH^W^^0;1^Q
"^DD",103,103.035,.01,21,0)
^^2^2^3030612^
"^DD",103,103.035,.01,21,1,0)
NAMES OF PEOPLE WHO MAY ANSWER PT PHONE IN WHICH IT IS OK TO LEAVE 
"^DD",103,103.035,.01,21,2,0)
ANTICOAGULATION INFORMATION WITH.
"^DD",103,103.035,.01,"DT")
3030612
"^DD",103,103.07,0)
SPECIAL INSTRUCTIONS SUB-FIELD^^.01^1
"^DD",103,103.07,0,"NM","SPECIAL INSTRUCTIONS")

"^DD",103,103.07,0,"UP")
103
"^DD",103,103.07,.01,0)
SPECIAL INSTRUCTIONS^WL^^0;1^Q
"^DD",103,103.07,.01,"DT")
3031113
"^DD",103,103.08,0)
RISK FACTORS SUB-FIELD^^.01^1
"^DD",103,103.08,0,"NM","RISK FACTORS")

"^DD",103,103.08,0,"UP")
103
"^DD",103,103.08,.01,0)
RISK FACTORS^W^^0;1^Q
"^DD",103,103.08,.01,"DT")
3030520
"^DD",103,103.085,0)
REMINDER SUB-FIELD^^.01^1
"^DD",103,103.085,0,"NM","REMINDER")

"^DD",103,103.085,0,"UP")
103
"^DD",103,103.085,.01,0)
REMINDER^WL^^0;1^Q
"^DD",103,103.085,.01,"DT")
3040726
"^DD",103,103.11105,0)
COMPLICATION NOTE SUB-FIELD^^.01^1
"^DD",103,103.11105,0,"NM","COMPLICATION NOTE")

"^DD",103,103.11105,0,"UP")
103.011
"^DD",103,103.11105,.01,0)
COMPLICATION NOTE^WLx^^0;1^Q
"^DD",103,103.11105,.01,21,0)
^^1^1^3080920^
"^DD",103,103.11105,.01,21,1,0)
Type of complication and any comments.
"^DD",103,103.11105,.01,"DT")
3080920
"^DD",103,103.1199,0)
COMMENTS SUB-FIELD^^.01^1
"^DD",103,103.1199,0,"NM","COMMENTS")

"^DD",103,103.1199,0,"UP")
103.011
"^DD",103,103.1199,.01,0)
COMMENTS^W^^0;1^Q
"^DD",103,103.1199,.01,"DT")
3030520
"^DIC",101.24,101.24,0)
OE/RR REPORT^101.24
"^DIC",101.24,101.24,0,"GL")
^ORD(101.24,
"^DIC",101.24,101.24,"%",0)
^1.005^^0
"^DIC",101.24,101.24,"%D",0)
^1.001^7^7^3020924^^^
"^DIC",101.24,101.24,"%D",1,0)
This file contains definitions and parameters used in various reports
"^DIC",101.24,101.24,"%D",2,0)
within CPRS.
"^DIC",101.24,101.24,"%D",3,0)
 
"^DIC",101.24,101.24,"%D",4,0)
Entry numbers >1000 are reserved for national use.  Any local entries
"^DIC",101.24,101.24,"%D",5,0)
should be added to a number <1000.  If this convention is not followed,
"^DIC",101.24,101.24,"%D",6,0)
you run the risk of having your local entries overwritten by a patch
"^DIC",101.24,101.24,"%D",7,0)
or future release of CPRS.
"^DIC",101.24,"B","OE/RR REPORT",101.24)

"^DIC",103,103,0)
ORAM FLOWSHEET^103
"^DIC",103,103,0,"GL")
^ORAM(103,
"^DIC",103,103,"%",0)
^1.005^^
"^DIC",103,103,"%D",0)
^^8^8^3090113^
"^DIC",103,103,"%D",1,0)
This file captures flowsheet data in support of the the Anticoagulation 
"^DIC",103,103,"%D",2,0)
Management Program (AMP), which is a Joint Commission National Patient
"^DIC",103,103,"%D",3,0)
Safety Goal initiative to use a standardized process for the management of
"^DIC",103,103,"%D",4,0)
their patients on extended anticoagulation therapy.
"^DIC",103,103,"%D",5,0)
 
"^DIC",103,103,"%D",6,0)
AMP runs as a Windows Application from the CPRS Tools menu, and assists 
"^DIC",103,103,"%D",7,0)
Clinicians with the expeditious documentation of visits to Anticoagulation
"^DIC",103,103,"%D",8,0)
Clinics.
"^DIC",103,"B","ORAM FLOWSHEET",103)

"BLD",18785,6)
^278
**END**
**END**
