Released PSJ*5*232 SEQ #203
Extracted from mail message
**KIDS**:PSJ*5.0*232^

**INSTALL NAME**
PSJ*5.0*232
"BLD",7890,0)
PSJ*5.0*232^INPATIENT MEDICATIONS^0^3090910^y
"BLD",7890,1,0)
^^9^9^3090910^^^^
"BLD",7890,1,1,0)
This patch will resolve the following issues:
"BLD",7890,1,2,0)
 
"BLD",7890,1,3,0)
IVP syringe not appearing on Action Profile #2 [PSJU AP-2] with the rest 
"BLD",7890,1,4,0)
of expring orders.
"BLD",7890,1,5,0)
 
"BLD",7890,1,6,0)
Lab QO stuck in a loop.
"BLD",7890,1,7,0)
 
"BLD",7890,1,8,0)
Documentation changes needed for menu option for the option Action 
"BLD",7890,1,9,0)
Profile #1 [PSJU AP-1].
"BLD",7890,4,0)
^9.64PA^^
"BLD",7890,6.3)
2
"BLD",7890,"ABPKG")
n
"BLD",7890,"KRN",0)
^9.67PA^779.2^20
"BLD",7890,"KRN",.4,0)
.4
"BLD",7890,"KRN",.401,0)
.401
"BLD",7890,"KRN",.402,0)
.402
"BLD",7890,"KRN",.403,0)
.403
"BLD",7890,"KRN",.5,0)
.5
"BLD",7890,"KRN",.84,0)
.84
"BLD",7890,"KRN",3.6,0)
3.6
"BLD",7890,"KRN",3.8,0)
3.8
"BLD",7890,"KRN",9.2,0)
9.2
"BLD",7890,"KRN",9.8,0)
9.8
"BLD",7890,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7890,"KRN",9.8,"NM",1,0)
PSGCAPIV^^0^B8173796
"BLD",7890,"KRN",9.8,"NM",2,0)
PSJEEU^^0^B11888100
"BLD",7890,"KRN",9.8,"NM","B","PSGCAPIV",1)

"BLD",7890,"KRN",9.8,"NM","B","PSJEEU",2)

"BLD",7890,"KRN",19,0)
19
"BLD",7890,"KRN",19,"NM",0)
^9.68A^^
"BLD",7890,"KRN",19.1,0)
19.1
"BLD",7890,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",7890,"KRN",101,0)
101
"BLD",7890,"KRN",101,"NM",0)
^9.68A^^
"BLD",7890,"KRN",409.61,0)
409.61
"BLD",7890,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",7890,"KRN",771,0)
771
"BLD",7890,"KRN",771,"NM",0)
^9.68A^^
"BLD",7890,"KRN",779.2,0)
779.2
"BLD",7890,"KRN",779.2,"NM",0)
^9.68A^^
"BLD",7890,"KRN",870,0)
870
"BLD",7890,"KRN",870,"NM",0)
^9.68A^^
"BLD",7890,"KRN",8989.51,0)
8989.51
"BLD",7890,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",7890,"KRN",8989.52,0)
8989.52
"BLD",7890,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",7890,"KRN",8994,0)
8994
"BLD",7890,"KRN",8994,"NM",0)
^9.68A^^
"BLD",7890,"KRN","B",.4,.4)

"BLD",7890,"KRN","B",.401,.401)

"BLD",7890,"KRN","B",.402,.402)

"BLD",7890,"KRN","B",.403,.403)

"BLD",7890,"KRN","B",.5,.5)

"BLD",7890,"KRN","B",.84,.84)

"BLD",7890,"KRN","B",3.6,3.6)

"BLD",7890,"KRN","B",3.8,3.8)

"BLD",7890,"KRN","B",9.2,9.2)

"BLD",7890,"KRN","B",9.8,9.8)

"BLD",7890,"KRN","B",19,19)

"BLD",7890,"KRN","B",19.1,19.1)

"BLD",7890,"KRN","B",101,101)

"BLD",7890,"KRN","B",409.61,409.61)

"BLD",7890,"KRN","B",771,771)

"BLD",7890,"KRN","B",779.2,779.2)

"BLD",7890,"KRN","B",870,870)

"BLD",7890,"KRN","B",8989.51,8989.51)

"BLD",7890,"KRN","B",8989.52,8989.52)

"BLD",7890,"KRN","B",8994,8994)

"BLD",7890,"QUES",0)
^9.62^^
"BLD",7890,"REQB",0)
^9.611^2^2
"BLD",7890,"REQB",1,0)
PSJ*5.0*208^2
"BLD",7890,"REQB",2,0)
PSJ*5.0*169^2
"BLD",7890,"REQB","B","PSJ*5.0*169",2)

"BLD",7890,"REQB","B","PSJ*5.0*208",1)

"MBREQ")
0
"PKG",221,-1)
1^1
"PKG",221,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",221,20,0)
^9.402P^^
"PKG",221,22,0)
^9.49I^1^1
"PKG",221,22,1,0)
5.0^2971215^2981113^1
"PKG",221,22,1,"PAH",1,0)
232^3090910
"PKG",221,22,1,"PAH",1,1,0)
^^9^9^3090910
"PKG",221,22,1,"PAH",1,1,1,0)
This patch will resolve the following issues:
"PKG",221,22,1,"PAH",1,1,2,0)
 
"PKG",221,22,1,"PAH",1,1,3,0)
IVP syringe not appearing on Action Profile #2 [PSJU AP-2] with the rest 
"PKG",221,22,1,"PAH",1,1,4,0)
of expring orders.
"PKG",221,22,1,"PAH",1,1,5,0)
 
"PKG",221,22,1,"PAH",1,1,6,0)
Lab QO stuck in a loop.
"PKG",221,22,1,"PAH",1,1,7,0)
 
"PKG",221,22,1,"PAH",1,1,8,0)
Documentation changes needed for menu option for the option Action 
"PKG",221,22,1,"PAH",1,1,9,0)
Profile #1 [PSJU AP-1].
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSGCAPIV")
0^1^B8173796^B7632761
"RTN","PSGCAPIV",1,0)
PSGCAPIV ;BIR/MV-ACTION PROFILE #2 IV ORDERS ; 8/28/09 12:24pm
"RTN","PSGCAPIV",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**9,58,169,232**;16 DEC 97;Build 2
"RTN","PSGCAPIV",3,0)
 ;
"RTN","PSGCAPIV",4,0)
 ; Reference to ^PS(52.6 is supported by DBIA# 1231
"RTN","PSGCAPIV",5,0)
 ; Reference to ^PS(52.7 is supported by DBIA# 2173
"RTN","PSGCAPIV",6,0)
 ; Reference to ^PS(55 is supported by DBIA# 2191
"RTN","PSGCAPIV",7,0)
 ;
"RTN","PSGCAPIV",8,0)
START ;
"RTN","PSGCAPIV",9,0)
 NEW P,ON,DRG S ON=""
"RTN","PSGCAPIV",10,0)
 ;* S:PSGSS'="P" PSGDT=PSGAPSD-.0001 S:PSGSS="P" STP=9999999
"RTN","PSGCAPIV",11,0)
 S PSGDT=PSGAPSD-.0001
"RTN","PSGCAPIV",12,0)
 F PSGEXPDT=PSGDT:0 S PSGEXPDT=$O(^PS(55,PSGP,"IV","AIT",PST,PSGEXPDT)) Q:$S('PSGEXPDT:1,PSGAPO="E":PSGEXPDT>PSGAPFD,1:0)  F  S ON=$O(^PS(55,PSGP,"IV","AIT",PST,PSGEXPDT,ON)) Q:ON=""  D IV
"RTN","PSGCAPIV",13,0)
 Q
"RTN","PSGCAPIV",14,0)
IV ;
"RTN","PSGCAPIV",15,0)
 N X,ON55 S DFN=PSGP D GT55^PSIVORFB
"RTN","PSGCAPIV",16,0)
 Q:"DE"[P(17)
"RTN","PSGCAPIV",17,0)
 S X=$P(P("MR"),U,2) Q:XTYPE=2&(X["IV")  Q:XTYPE=3&(PST="S")&'($S(X="IV":1,X["IVP":1,1:0))  ;If med route is IVPB or IVP do not quit (PSJ*5*232)
"RTN","PSGCAPIV",18,0)
 S QST=$$ONE^PSJBCMA(DFN,ON,P(9),P(2),P(3))
"RTN","PSGCAPIV",19,0)
 I QST'="O" S QST=$S(P(9)["PRN":"P",1:"C")
"RTN","PSGCAPIV",20,0)
 I DRG S X=$S($G(DRG("AD",1)):DRG("AD",1),1:$G(DRG("SOL",1))),DRG=$S(P(4)="H":"* TPN *",1:$E($$ENPDN^PSGMI($P(X,U,6)),1,20))
"RTN","PSGCAPIV",21,0)
 S ^TMP($J,S1,PSGAPWDN,PN,QST_U_$E(DRG,1,20),ON_"V")=""
"RTN","PSGCAPIV",22,0)
 Q
"RTN","PSGCAPIV",23,0)
PRT(ON) ;*** Print IV orders.
"RTN","PSGCAPIV",24,0)
 NEW TYPE S TYPE=$P(DRG,U),ON=+ON,DCU=0
"RTN","PSGCAPIV",25,0)
 N ON55,DRG,P,PRTST S DFN=PSGP,PRTST=1 D GT55^PSIVORFB
"RTN","PSGCAPIV",26,0)
 F X=2,3 S:P(X) P(X)=$E($$ENDTC^PSGMI(P(X)),1,5)
"RTN","PSGCAPIV",27,0)
 S PSJSI=$$ENSET^PSGSICHK($P(P("OPI"),"^"))
"RTN","PSGCAPIV",28,0)
 ;PSJ*5*169 Set QST so one-time orders will not allow RENEW on report.
"RTN","PSGCAPIV",29,0)
 N QST
"RTN","PSGCAPIV",30,0)
 S QST=$$ONE^PSJBCMA(DFN,ON,P(9),P(2),P(3))
"RTN","PSGCAPIV",31,0)
 I QST'="O" S QST=$S(P(9)["PRN":"P",1:"C")
"RTN","PSGCAPIV",32,0)
 W !,$J(N,3)
"RTN","PSGCAPIV",33,0)
 I '$O(DRG("AD",0)) D PRTST W !
"RTN","PSGCAPIV",34,0)
 I $O(DRG("AD",0)) F X=0:0 S X=$O(DRG("AD",X)) Q:'X  W ?5,$$WRTDRG^PSIVUTL(DRG("AD",X),41) D:X=1 PRTST D DCU("AD",X),NP("AD") G:$G(PSJDLW) EXIT W !
"RTN","PSGCAPIV",35,0)
 W ?5,"in "
"RTN","PSGCAPIV",36,0)
 F X=0:0 S X=$O(DRG("SOL",X)) Q:'X  D:X>1 NP("SOL") W:X>1 ! W ?8,$$WRTDRG^PSIVUTL(DRG("SOL",X),41) D DCU("SOL",X) G:$G(PSJDLW) EXIT
"RTN","PSGCAPIV",37,0)
 W:P(9)]"" " " W P(9)," ",P(8) D:'$G(DRG("AD",1))&PRTST PRTST
"RTN","PSGCAPIV",38,0)
 I PSJSI]"" W !?5,"Special Instructions: " F Y=1:1:$L(PSJSI," ") S Y1=$P(PSJSI," ",Y) W:($L(Y1)+$X)>79 !?27 W Y1_" "
"RTN","PSGCAPIV",39,0)
 W ! D ORDP1^PSGCAPP
"RTN","PSGCAPIV",40,0)
 Q
"RTN","PSGCAPIV",41,0)
PRTST ;*** Print the rest of the 1st line.
"RTN","PSGCAPIV",42,0)
 W:PRTST ?46,TYPE,?49,P(2),?55,P(3),?61,P(17)
"RTN","PSGCAPIV",43,0)
 S PRTST=0
"RTN","PSGCAPIV",44,0)
 Q
"RTN","PSGCAPIV",45,0)
NP(TYPE) ;*** Print end line after order.
"RTN","PSGCAPIV",46,0)
 NEW X
"RTN","PSGCAPIV",47,0)
 D:DRG(TYPE,0)>1&($Y+11>IOSL) NP^PSGCAPP
"RTN","PSGCAPIV",48,0)
 Q
"RTN","PSGCAPIV",49,0)
DCU(TYPE,X) ;*** Calculate drug cost.
"RTN","PSGCAPIV",50,0)
 NEW COST
"RTN","PSGCAPIV",51,0)
 S:TYPE="AD" COST=$P(^PS(52.6,+DRG(TYPE,X),0),U,7)
"RTN","PSGCAPIV",52,0)
 S:TYPE="SOL" COST=$P(^PS(52.7,+DRG(TYPE,X),0),U,7)
"RTN","PSGCAPIV",53,0)
 S DCU=DCU+(COST*+$P(DRG(TYPE,X),U,3))
"RTN","PSGCAPIV",54,0)
 Q
"RTN","PSGCAPIV",55,0)
EXIT ;
"RTN","PSGCAPIV",56,0)
 Q
"RTN","PSJEEU")
0^2^B11888100^B11795573
"RTN","PSJEEU",1,0)
PSJEEU ;BIR/CML3-EXTERNAL ENTRIES UTILITY ; 9/10/09 10:46am
"RTN","PSJEEU",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**3,208,232**;16 DEC 97;Build 2
"RTN","PSJEEU",3,0)
 ;
"RTN","PSJEEU",4,0)
ENSV ; schedule validation
"RTN","PSJEEU",5,0)
 ;K PSJAT,PSJM I $S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",6,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",7,0)
 K PSJAT,PSJM Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  N DIC S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",8,0)
 Q:$D(PSJX)[0  I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",9,0)
 N D,DIC,DIE,Q,QX,SDW,SWD,X,X0,X1,X2,XT,Y,Z D EN^PSJSV Q
"RTN","PSJEEU",10,0)
 ;
"RTN","PSJEEU",11,0)
ENSVI ; standard schedule inquire
"RTN","PSJEEU",12,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",13,0)
 D ENI^PSJSV0
"RTN","PSJEEU",14,0)
 Q
"RTN","PSJEEU",15,0)
 ;
"RTN","PSJEEU",16,0)
ENSPU ; schedule processor (count)
"RTN","PSJEEU",17,0)
 K PSJC S PSJC=-1 I $S('$D(PSJAT):1,'$D(PSJM):1,'$D(PSJSCH):1,'$D(PSJSD):1,1:'$D(PSJFD)) Q
"RTN","PSJEEU",18,0)
 ;the following line is for lab order with no start time PSJ*5.0*208
"RTN","PSJEEU",19,0)
 I PSJPP="LR",PSJSD'["." D
"RTN","PSJEEU",20,0)
 . N HRS,XPSJSD,I
"RTN","PSJEEU",21,0)
 . S XPSJSD=PSJSD
"RTN","PSJEEU",22,0)
 . F I=1:1 Q:'$G(PSJM)  S HRS=(PSJM/60)*I,PSJSD=XPSJSD_"."_$E(0,HRS<10)_HRS Q:PSJSD>$$NOW^XLFDT()
"RTN","PSJEEU",23,0)
 . I ORDUR S PSJFD=$$FMADD^XLFDT(PSJSD,+ORDUR,,-1) ; Calculate the new stopdate/time based on the new start date/time
"RTN","PSJEEU",24,0)
 . I 'ORDUR S X=+$E(ORDUR,2,9) D
"RTN","PSJEEU",25,0)
 .. I PSJM S PSJFD=$$FMADD^XLFDT(PSJSD,,,(PSJM*X)-1) Q  ;X_#times
"RTN","PSJEEU",26,0)
 .. ;no freq in minutes --> day of week
"RTN","PSJEEU",27,0)
 .. N DAYS,LOCMX,SCHMX
"RTN","PSJEEU",28,0)
 .. S LOCMX=$$GET^XPAR("ALL^LOC.`"_+ORL,"LR MAX DAYS CONTINUOUS",1,"Q")
"RTN","PSJEEU",29,0)
 .. S SCHMX=$P(^PS(51.1,PSJY,0),U,7)
"RTN","PSJEEU",30,0)
 .. S DAYS=$S('SCHMX:LOCMX,LOCMX<SCHMX:LOCMX,1:SCHMX)
"RTN","PSJEEU",31,0)
 .. S PSJFD=$$FMADD^XLFDT(PSJSD,DAYS,,-1)
"RTN","PSJEEU",32,0)
 S:'$D(PSJOSD) PSJOSD=PSJSD S:'$D(PSJOFD) PSJOFD=PSJFD N AM,CD,H,HCD,I,J,M,MID,OD,PDL,PLSD,ST,Q,QQ,WD,WDT,WS,WS1,X,X1,X2,XX D EN^PSJSPU Q
"RTN","PSJEEU",33,0)
 ;
"RTN","PSJEEU",34,0)
ENPSJSE ; schedule edit for Inpatient Meds
"RTN","PSJEEU",35,0)
 S PSJPP="PSJ"
"RTN","PSJEEU",36,0)
 ;
"RTN","PSJEEU",37,0)
ENSE ; schedule edit
"RTN","PSJEEU",38,0)
 ;I $S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",39,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",40,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP?.E1C.E:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",41,0)
 I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",42,0)
 F FQ=0:0 K DIC S DIC="^PS(51.1,",DIC(0)="QEASL",DIC("DR")="4////"_PSJPP,DIC("W")="D DICW^PSSJSV0",D="AP"_PSJPP W ! D IX^DIC K DIC Q:Y'>0  S DIE="^PS(51.1,",DA=+Y,DR="[PSSJ "_$S(PSJPP="PSJ":"",1:"EXT ")_"SCHEDULE EDIT]" D ^DIE K DA,DIE,DR,PSJS
"RTN","PSJEEU",43,0)
 K:PSJPP="PSJ" PSJPP K D0,DI,DISYS,DQ,FQ,X,Y
"RTN","PSJEEU",44,0)
 Q
"RTN","PSJEEU",45,0)
 ;
"RTN","PSJEEU",46,0)
ENDSD ; default start date
"RTN","PSJEEU",47,0)
 I $S('$D(PSJSCH):1,'$D(PSJAT):1,1:'$D(PSJTS)) S PSJX="" Q
"RTN","PSJEEU",48,0)
 D ENDSD^PSJSPU0 Q
"RTN","PSJEEU",49,0)
 ;
"RTN","PSJEEU",50,0)
ENPSJSHE ; shift edit for Inpatient Meds
"RTN","PSJEEU",51,0)
 S PSJPP="PSJ"
"RTN","PSJEEU",52,0)
 ;
"RTN","PSJEEU",53,0)
ENSHE ; shift edit
"RTN","PSJEEU",54,0)
 ;I $S('$D(PSJPP):1,PSJPP="":1,PSJPP'?.ANP:1,1:'$D(^DIC(9.4,"C",PSJPP))) Q
"RTN","PSJEEU",55,0)
 ; changed to remove ref to 9.4,"C"
"RTN","PSJEEU",56,0)
 Q:$S('$D(PSJPP):1,PSJPP="":1,PSJPP'?.ANP:1,1:0)  S X=PSJPP,DIC(0)="OX",DIC=9.4,D="C" D IX^DIC I +Y'>0 Q
"RTN","PSJEEU",57,0)
 I $D(PSJW),$S('PSJW:1,1:'$D(^SC(PSJW,0))) K PSJW
"RTN","PSJEEU",58,0)
 F FQ=0:0 K DIC S DIC="^PS(51.15,",DIC(0)="AEQLS",DIC("DR")="4////"_PSJPP,D="AP"_PSJPP W ! D IX^DIC K DIC Q:Y'>0  S DIE="^PS(51.15,",DA=+Y,DR="[PSJ SHIFT EDIT]" D ^DIE K DA,DIE,DR
"RTN","PSJEEU",59,0)
 K FQ,X,Y Q
"RTN","PSJEEU",60,0)
 ;
"RTN","PSJEEU",61,0)
ENATV ; validate admin times
"RTN","PSJEEU",62,0)
 D ENCHK^PSJSV Q
"RTN","PSJEEU",63,0)
 ;
"RTN","PSJEEU",64,0)
ENSHV ;
"RTN","PSJEEU",65,0)
 D ENSHV^PSJSV Q
"VER")
8.0^22.0
"BLD",7890,6)
^203
**END**
**END**
