$TXT Created by               at CLN1G1.AAC.DOMAIN.EXT  (KIDS) on Thursday, 11/14/19 at 11:41
=============================================================================
Run Date: DEC 05, 2019                     Designation: PSJ*5*393
Package : PSJ - INPATIENT MEDICATIONS         Priority: Mandatory
Version : 5       SEQ #337                      Status: Released
                  Compliance Date: JAN 04, 2020
=============================================================================

Associated patches: (v)PSJ*5*327   <<= must be installed BEFORE `PSJ*5*393'
                    (v)PSJ*5*366   <<= must be installed BEFORE `PSJ*5*393'

Subject: ADMIN TIMES LOST WHEN EDITING MED ROUTE/UNIT DOSE ORDER ERROR

Category: 
  - Routine

Description:
============

 This patch will fix the following issues:
 1) INC7196873 - Correct an issue that occurs when the Med Route is
    modified. It causes the Admin Times to disappear.
 2) INC7621396 - Correct an issue that occurs when a starred field is
    edited in a complex order.  User is getting knocked out of the system
    with a hard error.
  
  
 Defect Tracking System Ticket(s) & Overview:
 --------------------------------------------
  
 1. INC7196873 - The ADMIN TIMES (#39) field in the NON-VERIFIED ORDERS 
    (#53.1) file from the continuous schedule is deleted when the MED 
    ROUTE (#3) field in the NON-VERIFIED ORDERS (#53.1) file is changed
  
  
 Problem:
 -------
 The site edits the Med Route via the Inpatient Order Entry [PSJ OE] option
 for a Unit Dose order with a continuous schedule that has admin times
 assigned. When the order is accepted, the admin times are deleted from the
 order. The order is allowed to be verified without administration times.
 The site has the Inpatient Ward Parameter, DEFAULT START DATE CALCULATION,
 set to "USE NOW AS DEFAULT" and the active order appears in the Bar 
 Code Medication Administration (BCMA) application on the Virtual Due List 
 (VDL) with a next dose action that equals the start date/time of the order
 instead of the admin time that was assigned per the schedule assigned to
 the order.
  
 Resolution:
 ----------
 New code was added to the Inpatient Order Entry [PSJ OE] in patch
 PSJ*5.0*366 to determine the correct route. It is modifying the admin
 times unintentionally. NEWed two variables in PSGOE4 to retain the correct
 value of the ADMIN TIMES (#39) field. BCMA now displays the correct first
 dose time.
  
  
 2.  INC7621396 - Pharmacist getting errored out of VistA Unit Dose orders
     INC7327916 (duplicate)-Pharmacist receives an error when changing DRUG
     and TIME.
  
 Problem:
 --------
 When a complex Unit Dose order is being finished in VistA from the
 Inpatient Order Entry [PSJ OE] option, the Pharmacist is getting kicked
 out of the system if they modify a starred field.
  
 Resolution:
 -----------
 The variable ND2P1 is set for the DURATION OF ADMINISTRATION (#137) 
 field in the Pharmacy Patient (#55) file, which is used for medications
 that require removal.  If the complex order does not have removal
 times/duration that variable is not set.
  
 Modified the code in routine PSJCOM1 to ensure the order has a value for 
 the Duration of Administration before writing to the file.
  
  
 Test Sites:
 ----------
 Oklahoma City HCS
 Pittsburgh HCS
  
  
 Patch Installation:
  
 Pre-Installation Instructions:
 ------------------------------
 This patch may be installed with users on the system although it is 
 recommended that it be installed during non-peak hours to minimize
 potential disruption to users.  This patch should take less than 5 minutes
 to install.
  
 Installation Instructions:
 --------------------------
 1.      Choose the PackMan message containing this patch.
  
 2.      Choose the INSTALL/CHECK MESSAGE PackMan option. 
  
 3.      From the Kernel Installation and Distribution System Menu, select 
         the Installation Menu.  From this menu, select Backup a Transport
         Global - This option will create a backup message of any routines
         exported with this patch. It will not backup any other changes
         such as DDs or templates.  When prompted for the INSTALL NAME
         enter the patch number: PSJ*5.0*393.
  
 4.      From the Kernel Installation and Distribution System Menu, 
         select the Installation Menu.  From this menu, you may elect to
         use the following options. When prompted for the INSTALL NAME
         enter the patch number: PSJ*5.0*393.
  
         a.   Compare Transport Global to Current System - This option will
              (allow you to view all changes that will be made when this
              patch is installed.  It compares all components of this patch
              routines, DDs, templates, etc.).
  
         b.   Verify Checksums in Transport Global - This option will allow
              you to ensure the integrity of the routines that are in the
              transport global.
  
 5.      From the Installation Menu, select the Install Package(s) option 
         and choose the patch to install.  When prompted for the INSTALL 
         NAME enter the patch number: PSJ*5.0*393.
  
 6.      When prompted Want KIDS to Rebuild Menu Trees Upon Completion of
         Install? NO//, respond "No".  
  
  
 Post-Installation Instructions:
 -------------------------------
 Successful installation can be verified by reviewing the first 2 lines of 
 the routines contained in the patch. The second line will contain the 
 patch number (393) in the [PATCH LIST] section.
  
  ;;5.0;INPATIENT MEDICATIONS;**[PATCH LIST]**;16 DEC 97;[BUILD #] 
  
 The option Calculate and Show Checksum Values [XTSUMBLD-CHECK] can be run
 to compare the routine checksums to what is documented in the patch
 description.
  
 Back-out/Rollback Strategy:
 ---------------------------
 Back-out will be done only with the concurrence and participation of
 development team and appropriate VA site/region personnel. The decision to
 back-out or rollback software will be a joint decision between development
 team, VA site/region personnel and other appropriate VA personnel.
  
 Prior to installing an updated KIDS package, the site/region should have
 saved a backup of the routines in a mail message using the Backup a
 Transport Global [XPD BACKUP] menu option (this is done at time of
 install). The message containing the backed-up routines can be loaded with
 the "Xtract PackMan" function at the Message Action prompt. The Packman
 function "INSTALL/CHECK MESSAGE" is then used to install the backed up
 routines onto the VistA System. 
  
 The back-out plan is to restore the routines from the backup created.
  
 No data was modified by this patch installation and, therefore, no 
 rollback strategy is required.
  
 Validation of Back-out Procedure:
 ---------------------------------
 The Back-out Procedure can be verified by printing the first 2 lines of
 the PSJ, PSG or PSI Routines contained in this patch using the option
 First Line Routine Print [XU FIRST LINE PRINT]. Once the routines
 contained in the PSJ*5.0*393 patch have been rolled back, the first two
 lines of the Routines will no longer contain the designation of patch
 PSJ*5.0*393 in the patch list section on line 2.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.0;INPATIENT MEDICATIONS ;**[Patch List]**;16 DEC, 1997;Build 5

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSGOE4
    Before: B42442364   After: B44132865  **2,50,64,58,111,113,245,253,
                                           366,393**
Routine Name: PSJCOM1
    Before: B54823711   After: B54961481  **110,127,281,315,327,393**
 
Routine list of preceding patches: 327, 366

=============================================================================
User Information:
Entered By  :                               Date Entered  : OCT 15, 2019
Completed By:                               Date Completed: DEC 04, 2019
Released By :                               Date Released : DEC 05, 2019
=============================================================================


Packman Mail Message:
=====================

$END TXT
