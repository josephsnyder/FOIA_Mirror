$TXT Created by               F at CLN1G1.AAC.DOMAIN.EXT  (KIDS) on Wednesday, 11/20/19 at 08:27
=============================================================================
Run Date: JAN 10, 2020                     Designation: PSJ*5*396
Package : PSJ - INPATIENT MEDICATIONS         Priority: Mandatory
Version : 5       SEQ #338                      Status: Released
                  Compliance Date: FEB 09, 2020
=============================================================================

Associated patches: (v)PSJ*5*380   <<= must be installed BEFORE `PSJ*5*396'

Subject: PSJ*5*380 <SUBSCRIPT> ERROR FIX

Category: 
  - Routine

Description:
============

 This patch will resolve the following issue.
  
 INC8260675 - New Patch PSJ*5.0*380 causing M error when running PSD report
  
 (Duplicate)  INC8364590 - VISTA option [PSJ PDV] "Patients on Specific
                           Drug(s)" generates hard error
                           <SUBSCRIPT>IVSET+7^PSJPDV0 ^SC("")
  
    
 Defect Tracking System Ticket(s) & Overview:
 --------------------------------------------
 INC8260675 - New Patch PSJ*5.0*380 causing M error when running PSD report
  
 (Duplicate)  INC8364590 - VISTA option [PSJ PDV] "Patients on Specific
                           Drug(s)" generates hard error
                           <SUBSCRIPT>IVSET+7^PSJPDV0 ^SC("")
                
 Problem: 
 --------
 The Syracuse Veteran's Administration Medical Center (VAMC) Inpatient
 Pharmacy reported getting a hard error when running the Patients on
 Specific Drug(s) [PSJ PDV] report option for a specific Division. It was
 reported as well that the error started happening after the installation
 of patch PSJ*5.0*380. The HPS Sustainment Team confirmed the problem to be
 caused by the code introduced by PSJ*5.0*380 to resolve a different
 problem in the same report. The code did not take into account that
 not all inpatient orders have a clinic associated with it and that is why the
 software was throwing a <SUBSCRIPT> error.
   
 Resolution:
 -----------
 When the report is run for ALL divisions then all orders, even
 orders without clinics, are shown. However, when the report is run for a
 specific division, only orders with a clinic associated with the order are
 shown.  This patch fixes the code by ignoring orders without a clinic when
 the user runs the report for a specific Division.
  
 Technical Resolution:
 ---------------------
 Changed the lines IVSET+7 and UDSET+7 in the PSJPDV0 routine to skip the order
 if the value of the field CLINIC (#130) in the UNIT DOSE sub-file (#55.06) or
 the value of the field CLINIC (#136) in the IV sub-file (#55.01), both in the
 PHARMACY PATIENT file (#55), are blank and the report is being run for a
 specific Division. 
   
 Patient Safety Issues (PSIs):
 -----------------------------
 N/A
   
         
 Test Sites:
 -----------
 Central Arkansas HCS
 Syracuse VAMC  
    
 Patch Installation:
  
 Pre/Post Installation Overview:
 -------------------------------
 It is not necessary to disable any options.  
  
 Pre-Installation Instructions:
 ------------------------------ 
 This patch should be installed during non-peak hours to minimize potential
 disruption to users. This patch should take less than 2 minutes to install.
   
 Installation Instructions:
 --------------------------
 1. Choose the PackMan message containing this patch.
  
 2. Choose the INSTALL/CHECK MESSAGE PackMan option.
   
 3. From the Kernel Installation and Distribution System Menu, select the  
    Installation Menu.  From this menu, Backup a Transport Global - This
    option will create a backup message of any routines exported with this
    patch.  It will not backup any other changes, such as DDs or 
    templates.  When prompted for the INSTALL NAME enter the patch #  
    (ex. PSJ*5.0*396).
  
 4. From the Kernel Installation and Distribution System Menu, select the  
    Installation Menu.  From this menu, you may elect to use the following
    options.  When prompted for the INSTALL NAME enter the patch #  
    (ex. PSJ*5.0*396):
  
    a. Compare Transport Global to Current System - This option will
       allow you to view all changes that will be made when this patch
       is installed. It compares all components of this patch:  routines,
       DDs, templates, etc.).
       
    b. Verify Checksums in Transport Global - This option will allow you
       to ensure the integrity of the routines that are in the transport
       global.
   
 5. From the Installation Menu, select the Install Package(s) option and
    choose the patch to install.
  
 6. When Prompted "Want KIDS to INHIBIT LOGONs during the install? 
    NO//" respond NO.  
   
 7. When Prompted "Want to DISABLE Scheduled Options, Menu Options, and 
    Protocols? NO//" respond NO.
  
 8. If prompted 'Delay Install (Minutes):  (0-60): 0//' respond 0.
  
  
 Post Installation Instructions:
 -------------------------------
 None.
  
   
 Back-out Procedures:
 --------------------
 Back-out will be done only with the concurrence and participation of 
 development team and appropriate VA site/region personnel. The decision to
 back-out or rollback software will be a joint decision between development
 team, VA site/region personnel and other appropriate VA personnel.
  
 Prior to installing an updated KIDS package, the site/region should have
 saved a backup of the routines in a mail message using the Backup a
 Transport Global [XPD BACKUP] menu option (this is done at time of
 install). The message containing the backed up routines can be loaded with
 the "Xtract PackMan" function at the Message Action prompt. The Packman
 function "INSTALL/CHECK MESSAGE" is then used to install the backed up
 routines onto the VistA System.
  
 The back-out plan is to restore the routines from the backup created.
  
 No data was modified by this patch installation and, therefore, no 
 rollback strategy is required.
  
 Validation of Back-out Procedure:
 ---------------------------------
 The Back-out Procedure can be verified by printing the first 2 lines of
 the routines contained in this patch using the option First Line Routine 
 Print [XU FIRST LINE PRINT]. Once the routines contained in PSJ*5.0*396
 patch have been backed out, the first two lines of the routines will
 no longer contain the designation of this patch in the patch list section
 on line 2.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.0;INPATIENT MEDICATIONS;**[Patch List]**;16 DEC 97;Build 1

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSJPDV0
    Before: B33361495   After: B33661434  **12,22,33,214,380,396**
 
Routine list of preceding patches: 380

=============================================================================
User Information:
Entered By  :                               Date Entered  : NOV 14, 2019
Completed By:                               Date Completed: JAN 08, 2020
Released By :                               Date Released : JAN 10, 2020
=============================================================================


Packman Mail Message:
=====================

$END TXT
