Released RT*2*46 SEQ #43
Extracted from mail message
**KIDS**:RT*2.0*46^

**INSTALL NAME**
RT*2.0*46
"BLD",7618,0)
RT*2.0*46^RECORD TRACKING^0^3100119^y
"BLD",7618,1,0)
^^8^8^3100119^
"BLD",7618,1,1,0)
 This patch addresses an issue reported in the Record Tracking (RT)
"BLD",7618,1,2,0)
 package.  This issue is that the software allows the user to enter
"BLD",7618,1,3,0)
 the Record Tracking Total System Menu [RT OVERALL] menu option 
"BLD",7618,1,4,0)
 without setting the INSTITUTION parameters.  When users try to use 
"BLD",7618,1,5,0)
 the Charge Out Pull List Records [RT PULL-CHARGE-OUT] menu option 
"BLD",7618,1,6,0)
 they receive the following message: "This function requires the 
"BLD",7618,1,7,0)
 user to be signed onto the system with INSTITUTION parameters defined."
"BLD",7618,1,8,0)
 They are then bumped out and are returned to the original menu.
"BLD",7618,4,0)
^9.64PA^^
"BLD",7618,6)
2^
"BLD",7618,6.3)
46
"BLD",7618,"ABPKG")
n
"BLD",7618,"KRN",0)
^9.67PA^8989.52^19
"BLD",7618,"KRN",.4,0)
.4
"BLD",7618,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7618,"KRN",.401,0)
.401
"BLD",7618,"KRN",.402,0)
.402
"BLD",7618,"KRN",.403,0)
.403
"BLD",7618,"KRN",.5,0)
.5
"BLD",7618,"KRN",.84,0)
.84
"BLD",7618,"KRN",3.6,0)
3.6
"BLD",7618,"KRN",3.8,0)
3.8
"BLD",7618,"KRN",3.8,"NM",0)
^9.68A^^
"BLD",7618,"KRN",9.2,0)
9.2
"BLD",7618,"KRN",9.8,0)
9.8
"BLD",7618,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7618,"KRN",9.8,"NM",1,0)
RTPSET^^0^B14774004
"BLD",7618,"KRN",9.8,"NM",2,0)
RTPSET1^^0^B9799403
"BLD",7618,"KRN",9.8,"NM",3,0)
RTP4^^0^B25928182
"BLD",7618,"KRN",9.8,"NM","B","RTP4",3)

"BLD",7618,"KRN",9.8,"NM","B","RTPSET",1)

"BLD",7618,"KRN",9.8,"NM","B","RTPSET1",2)

"BLD",7618,"KRN",19,0)
19
"BLD",7618,"KRN",19,"NM",0)
^9.68A^^0
"BLD",7618,"KRN",19.1,0)
19.1
"BLD",7618,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",7618,"KRN",101,0)
101
"BLD",7618,"KRN",101,"NM",0)
^9.68A^^
"BLD",7618,"KRN",409.61,0)
409.61
"BLD",7618,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",7618,"KRN",771,0)
771
"BLD",7618,"KRN",771,"NM",0)
^9.68A^^
"BLD",7618,"KRN",870,0)
870
"BLD",7618,"KRN",870,"NM",0)
^9.68A^^
"BLD",7618,"KRN",8989.51,0)
8989.51
"BLD",7618,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",7618,"KRN",8989.52,0)
8989.52
"BLD",7618,"KRN",8994,0)
8994
"BLD",7618,"KRN","B",.4,.4)

"BLD",7618,"KRN","B",.401,.401)

"BLD",7618,"KRN","B",.402,.402)

"BLD",7618,"KRN","B",.403,.403)

"BLD",7618,"KRN","B",.5,.5)

"BLD",7618,"KRN","B",.84,.84)

"BLD",7618,"KRN","B",3.6,3.6)

"BLD",7618,"KRN","B",3.8,3.8)

"BLD",7618,"KRN","B",9.2,9.2)

"BLD",7618,"KRN","B",9.8,9.8)

"BLD",7618,"KRN","B",19,19)

"BLD",7618,"KRN","B",19.1,19.1)

"BLD",7618,"KRN","B",101,101)

"BLD",7618,"KRN","B",409.61,409.61)

"BLD",7618,"KRN","B",771,771)

"BLD",7618,"KRN","B",870,870)

"BLD",7618,"KRN","B",8989.51,8989.51)

"BLD",7618,"KRN","B",8989.52,8989.52)

"BLD",7618,"KRN","B",8994,8994)

"BLD",7618,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",7618,"QUES",0)
^9.62^^
"BLD",7618,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",72,-1)
1^1
"PKG",72,0)
RECORD TRACKING^RT^Medical Records and Film Jacket Tracking
"PKG",72,20,0)
^9.402P^^
"PKG",72,22,0)
^9.49I^1^1
"PKG",72,22,1,0)
2.0^2911022
"PKG",72,22,1,"PAH",1,0)
46^3100119
"PKG",72,22,1,"PAH",1,1,0)
^^8^8^3100119
"PKG",72,22,1,"PAH",1,1,1,0)
 This patch addresses an issue reported in the Record Tracking (RT)
"PKG",72,22,1,"PAH",1,1,2,0)
 package.  This issue is that the software allows the user to enter
"PKG",72,22,1,"PAH",1,1,3,0)
 the Record Tracking Total System Menu [RT OVERALL] menu option 
"PKG",72,22,1,"PAH",1,1,4,0)
 without setting the INSTITUTION parameters.  When users try to use 
"PKG",72,22,1,"PAH",1,1,5,0)
 the Charge Out Pull List Records [RT PULL-CHARGE-OUT] menu option 
"PKG",72,22,1,"PAH",1,1,6,0)
 they receive the following message: "This function requires the 
"PKG",72,22,1,"PAH",1,1,7,0)
 user to be signed onto the system with INSTITUTION parameters defined."
"PKG",72,22,1,"PAH",1,1,8,0)
 They are then bumped out and are returned to the original menu.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","RTP4")
0^3^B25928182^B24164160
"RTN","RTP4",1,0)
RTP4 ;MJK/TROY ISC;Charge Out Pull List; ; 5/15/87  11:06 AM ;
"RTN","RTP4",2,0)
 ;;2.0;Record Tracking;**3,46**;10/22/91 ;Build 46
"RTN","RTP4",3,0)
6 ;Charge Out Pull List
"RTN","RTP4",4,0)
 I '$D(RTAPL) D MES Q
"RTN","RTP4",5,0)
 S RTRD(1)="Yes^designate requests as 'not fillable'",RTRD(2)="No^not designate any requests as 'not fillable'",RTRD("B")=2,RTRD(0)="S",RTRD("A")="Do you wish to first designate some requests as 'not fillable'? "
"RTN","RTP4",6,0)
 D SET^RTRD K RTRD Q:$E(X)="^"  I $E(X)="Y" D 5^RTP1
"RTN","RTP4",7,0)
 D DIV G Q:'$D(RTDV) S RTMES="CHARGED OUT" D PULL^RTP6 K RTMES G Q:'$D(RTPULL)
"RTN","RTP4",8,0)
 ;ask holding area
"RTN","RTP4",9,0)
 K RTB D BOR^RTP40 G Q:$D(RTESC) I $D(RTB) S RTHOLD=""
"RTN","RTP4",10,0)
 ;ask for perpetual records if RR
"RTN","RTP4",11,0)
 S (RTYES,RTACCN)=""
"RTN","RTP4",12,0)
 I $D(RTHOLD)!('$D(RTIRE))
"RTN","RTP4",13,0)
 E  D BOR^RTP41 K DIC G Q:$S('$D(RTB):1,RTYES["^":1,RTACCN["^":1,1:0)
"RTN","RTP4",14,0)
 ;
"RTN","RTP4",15,0)
 I RTPULL="ALL" W !!?5,"*** Printing an 'UPDATE' listing maybe a good idea ***",!?5,"*** before charging out these records.             ***"
"RTN","RTP4",16,0)
 S RTRD(1)="Yes^continue charge out process",RTRD(2)="No^stop charge out process",RTRD("A")="Are you sure you want to 'CHARGE OUT' these records? ",RTRD("B")=2,RTRD(0)="S" D SET^RTRD K RTRD G Q:$E(X)'="Y"
"RTN","RTP4",17,0)
 ;
"RTN","RTP4",18,0)
 D NOW^%DTC S RTQUEDT=%,RTVAR="RTACCN^RTFR^RTYES^RTAPL^RTQUEDT^RTDT^RTDV^RTPULL"_$S($D(RTB):"^RTB",1:"")_$S($D(RTIRE):"^RTIRE",1:"")_$S($D(RTHOLD):"^RTHOLD",1:""),RTDESC="Charge Out Pull List",RTPGM="START^RTP4" D ZIS^RTUTL G Q:POP
"RTN","RTP4",19,0)
 ;
"RTN","RTP4",20,0)
START U IO K ^TMP($J),RTP0 S RTBKGRD="",RTALL=+RTPULL,RTBEG=RTDT-.0001,RTEND=$S(RTDT[".":RTDT,1:RTDT_".2359") I $D(RTB),$D(RTHOLD) D ^RTP40 G Q
"RTN","RTP4",21,0)
 I $D(RTB),$D(RTIRE) S ^TMP($J,"RTREQUESTS","RTB")=RTB K RTB
"RTN","RTP4",22,0)
 S RTAG="SCAN" D CHK W @IOF F RTLIST="RTCANCEL","RTMISS" I $D(^TMP($J,RTLIST)) D LIST^RTP41
"RTN","RTP4",23,0)
 W @IOF,!,"PULL LIST CHARGE-OUT LOG" D NOW^%DTC S Y=$E(%,1,12) D D^DIQ W ?51,"RUN DATE: ",Y D LINE^RTUTL3 W ! S RTAG="FILL" D CHK
"RTN","RTP4",24,0)
 ;now go and make perpetual records
"RTN","RTP4",25,0)
 I RTYES,$D(RTIRE),'$D(RTHOLD) D PERP^RTQ41
"RTN","RTP4",26,0)
 ;
"RTN","RTP4",27,0)
Q K RTACCN,RTYES,RTHOLD,DIC,RTAG,DR,RTESC,RTBKGRD,RTPGM,RTPLTY,RTVAR,RTLIST,RTN,RTSSN,RTSTAT,SAVX,RTB,RTC,RTBEG,RTEND,RTDESC,RTALL,RTQUEDT,RTPULL,RTPULL0,RTDV,RTDT,RTDEV
"RTN","RTP4",28,0)
 K ^TMP($J)
"RTN","RTP4",29,0)
 D CLOSE^RTUTL K %DT,DA,D0,DIE,N,A
"RTN","RTP4",30,0)
 K Y,RT,J,RTE,X1,P Q
"RTN","RTP4",31,0)
 ;rtp0,"^",10 is pull list type
"RTN","RTP4",32,0)
CHK I 'RTALL F RTPDT=RTBEG:0 S RTPDT=$O(^RTV(194.2,"C",RTPDT)) Q:'RTPDT!(RTPDT>RTEND)  F RTPULL=0:0 S RTPULL=$O(^RTV(194.2,"C",RTPDT,RTPULL)) Q:'RTPULL  I $D(^RTV(194.2,RTPULL,0)) S RTP0=^(0) I "13"[$E($P(RTP0,"^",10)_"0") D CHKPULL D:Y @RTAG
"RTN","RTP4",33,0)
 I $D(^RTV(194.2,+RTALL,0)) S RTPULL=+RTALL,RTP0=^(0) D CHKPULL D:Y @RTAG
"RTN","RTP4",34,0)
 K RTPULL,RTP0,RTPDT Q
"RTN","RTP4",35,0)
 ;^6 canceled, apl, div
"RTN","RTP4",36,0)
CHKPULL S Y=0,X=RTP0 Q:$S($P(X,"^",6)="x":1,$P(X,"^",15)'=+RTAPL:1,$P(X,"^",12)'=RTDV:1,1:0)  S RTPLTY=$P(X,"^",10)
"RTN","RTP4",37,0)
 I '$D(RTIRE),RTPLTY'=3 S Y=1 Q
"RTN","RTP4",38,0)
 I $D(RTIRE),RTPLTY=3 S Y=1 Q
"RTN","RTP4",39,0)
 Q
"RTN","RTP4",40,0)
SCAN F RTN=0:0 K RT S RTN=$O(^RTV(190.1,"AP",RTPULL,RTN)) Q:'RTN  I $D(^RTV(190.1,RTN,0)) S RTQ=RTN,RTQ0=^(0),RT=+RTQ0 D SET
"RTN","RTP4",41,0)
 Q
"RTN","RTP4",42,0)
 ;
"RTN","RTP4",43,0)
SET I $P(RTQ0,"^",6)="x" S ^TMP($J,"RTCANCEL",$P(RTP0,"^"),RTQ)=RTQ0 Q
"RTN","RTP4",44,0)
 I $D(^RTV(190.2,"AM","m",RT))!($D(^RTV(190.2,"AM","s",RT))) S ^TMP($J,"RTMISS",$P(RTP0,"^"),RTQ)=RTQ0 Q
"RTN","RTP4",45,0)
 S X=+$P(RTQ0,"^",4) Q:'X  S:'$D(^TMP($J,"RTREQUESTS",RT)) ^(RT)=X_"^"_RTQ S:X<^(RT) ^(RT)=X_"^"_RTQ ;;;Q
"RTN","RTP4",46,0)
 ;rte=^(0)^1
"RTN","RTP4",47,0)
 I RTYES,$D(RTIRE),$D(RTPLTY),RTPLTY=3,$D(^RT(RT,0)) S X=$P(^(0),"^") I X]"",'$D(^TMP($J,"RTE",X)) S ^(X)="" Q
"RTN","RTP4",48,0)
 Q
"RTN","RTP4",49,0)
 ;
"RTN","RTP4",50,0)
DIV ;Entry point to determine if pull function is allowed
"RTN","RTP4",51,0)
 ;   with RTAPL and RTDIV defined
"RTN","RTP4",52,0)
 K RTDV,RTDEV I $S('$D(RTDIV):1,'$D(RTFR):1,'$D(^DIC(4,+RTDIV,0)):1,'$D(^DIC(195.1,+RTAPL,"INST",+RTDIV)):1,1:0) D MES Q
"RTN","RTP4",53,0)
 W !!,"Institution: ",$P(^DIC(4,+RTDIV,0),"^") S RTDV=RTDIV,RTDEV=$P(RTFR,"^",6) Q
"RTN","RTP4",54,0)
 ;
"RTN","RTP4",55,0)
MES W !!?3,*7,"This function requires the user to be signed onto the",!?3,"system with INSTITUTION parameters defined.  Please use",!?3,"the Record Tracking Total System Menu to access this option." Q
"RTN","RTP4",56,0)
 ;
"RTN","RTP4",57,0)
FILL S RTCOMR="Pull List: "_$P(RTP0,"^") F RTQ=0:0 S RTQ=$O(^RTV(190.1,"AP",RTPULL,RTQ)) Q:'RTQ  I $D(^RTV(190.1,RTQ,0)),$P(^(0),"^",6)="r" S RTQ0=^(0) D FILL1
"RTN","RTP4",58,0)
 K RTQ,RTQ0,RTCOMR S RTSTAT="c" D STAT^RTP W !?3,"...'",$P(RTP0,"^"),"' pull list has been charged out." Q
"RTN","RTP4",59,0)
 ;
"RTN","RTP4",60,0)
FILL1 Q:$S('$D(^RT(+RTQ0,"CL")):1,+$P(^("CL"),"^",6)>RTQUEDT:1,$P(RTQ0,"^",6)'="r":1,1:0)  I $P(RTP0,"^",16),$P(^("CL"),"^",5)'=$P(RTP0,"^",16) Q
"RTN","RTP4",61,0)
 S RT=+RTQ0 I $D(^TMP($J,"RTREQUESTS",RT)),$P(^(RT),"^",2)=RTQ D:RTPLTY'=3 FILL^RTQ4 D:RTPLTY=3 FILL^RTQ41
"RTN","RTP4",62,0)
 K RT Q
"RTN","RTPSET")
0^1^B14774004^B14570900
"RTN","RTPSET",1,0)
RTPSET ;MJK/TROY ISC;Sign-on Parameter Routine; ; 5/7/87  1:50 PM ;
"RTN","RTPSET",2,0)
 ;;2.0;Record Tracking;**46**;10/22/91 ;Build 46
"RTN","RTPSET",3,0)
 ;
"RTN","RTPSET",4,0)
 ;entry point to set-up variables for application and file room
"RTN","RTPSET",5,0)
 ;X is defined as the application's name
"RTN","RTPSET",6,0)
 I $D(RTSYS),$D(RTAPL),$D(RTFR),$D(RTDIV) K XQUIT Q
"RTN","RTPSET",7,0)
 K RTSYS,RTAPL,RTFR,RTDIV D APL,SET:'$D(XQUIT) K:$D(XQUIT) RTAPL,RTSYS,RTFR,RTDIV Q
"RTN","RTPSET",8,0)
 ;
"RTN","RTPSET",9,0)
DUZ ;sets up RTDUZ variable for template use
"RTN","RTPSET",10,0)
 S RTDUZ=$S($D(DUZ)[0:"",DUZ:DUZ,1:"") Q
"RTN","RTPSET",11,0)
 ;
"RTN","RTPSET",12,0)
SET ;entry point to assign file room parameters; RTAPL defined
"RTN","RTPSET",13,0)
 S X="T",%DT="" D ^%DT S DT=Y K %DT
"RTN","RTPSET",14,0)
 I $D(RTSYS),$D(RTAPL),$D(RTFR),$D(RTDIV) K XQUIT Q
"RTN","RTPSET",15,0)
 K RTDIV,RTFR S XQUIT=""
"RTN","RTPSET",16,0)
 D FR^RTPSET1,DIV:$D(RTFR) I $D(RTFR),$D(RTDIV) D INFO K XQUIT
"RTN","RTPSET",17,0)
 I $D(RTDIV),$D(DUZ(2)),+DUZ(2)'=+RTDIV W !!,*7,"WARNING: User 'institution' and file room's 'institution' are different:",!?20,"USER      : ",$S($D(^DIC(4,+DUZ(2),0)):$P(^(0),"^"),1:DUZ(2)),!?20,"FILE ROOM : ",$P(^DIC(4,RTDIV,0),"^")
"RTN","RTPSET",18,0)
 K F,F1,C,D,I K:'$D(RTFR)!('$D(RTDIV)) RTDIV,RTFR Q
"RTN","RTPSET",19,0)
 ;
"RTN","RTPSET",20,0)
KILL K RTSYS,RTAPL,RTDIV,RTFR,RTC,DICS
"RTN","RTPSET",21,0)
 K D,DO,DGO,DA,D0,DIC,DIC1,DIE,DIY,DIYS,DR,X1,A,F,O,N,I,J,P,V,Z,%,%H,%I,POP,IO("Q") Q
"RTN","RTPSET",22,0)
DIV ;entry point to get file room institution; RTAPL and RTFR defined
"RTN","RTPSET",23,0)
 K RTDIV S X1=+$P(RTFR,"^",2) K RTINST D DIV^RTUTL S:$D(RTINST) RTDIV=RTINST K X1,RTINST Q
"RTN","RTPSET",24,0)
 ;
"RTN","RTPSET",25,0)
DIV1 ;entry point to determine institution for non-file room users
"RTN","RTPSET",26,0)
 K RTDIV I $O(^DIC(195.1,+RTAPL,"INST",0)) S I=+$O(^(0)) I '$O(^(I)),$D(^DIC(4,I,0)) S RTDIV=I Q
"RTN","RTPSET",27,0)
 S DIC(0)="AEMQI",DIC="^DIC(4,",DIC("A")="Select Institution: ",DIC("S")="I $D(^DIC(195.1,"_+RTAPL_",""INST"",Y,0))" S:$S('$D(DUZ(2)):0,$D(^DIC(195.1,+RTAPL,"INST",+DUZ(2),0)):1,1:0) DIC("B")=$P(^DIC(4,+DUZ(2),0),"^")
"RTN","RTPSET",28,0)
 D ^DIC K DIC S:Y>0 RTDIV=+Y Q
"RTN","RTPSET",29,0)
 ;
"RTN","RTPSET",30,0)
APL ;entry point to set-up local variables for application; X is defined as the application's name
"RTN","RTPSET",31,0)
 Q:$D(RTAPL)&($D(RTSYS))  S XQUIT="",DIC(0)="IM",DIC="^DIC(195.1," D ^DIC Q:Y<0  D APL1 K:$D(RTAPL) XQUIT Q
"RTN","RTPSET",32,0)
APL1 K RTAPL,RTSYS Q:'$D(^DIC(195.4,1,0))  S RTSYS=^(0) Q:'$D(^DIC(195.1,+Y,0))  S RTAPL=+Y_";"_^(0) Q
"RTN","RTPSET",33,0)
 ;
"RTN","RTPSET",34,0)
APL2 K RTAPL,RTSYS S XQUIT="",DIC(0)="AEMQI",DIC="^DIC(195.1," D ^DIC Q:Y<0  D APL1 K:$D(RTAPL) XQUIT Q
"RTN","RTPSET",35,0)
 ;
"RTN","RTPSET",36,0)
INFO I $D(RTFR),$D(RTAPL)!($D(RTTY)) W !!,"You are tracking '",$S($D(RTTY):$P($P(RTTY,"^"),";",2)_"S'",1:$P($P(RTAPL,"^"),";",2)_"' records"),!?10,"..."," from the '",$P(^SC(+$P(RTFR,"^",2),0),"^"),"' file room.",! Q
"RTN","RTPSET",37,0)
 ;
"RTN","RTPSET",38,0)
XR S Y=^DIC(195.4,1,"RAD") G SETUP
"RTN","RTPSET",39,0)
MR S Y=^DIC(195.4,1,"MAS")
"RTN","RTPSET",40,0)
SETUP D APL1 S Y=+$P(Y,"^",2) D TYPE1^RTUTL K:'$D(RTAPL)!('$D(RTTY)) RTAPL,RTTY Q
"RTN","RTPSET",41,0)
 ;
"RTN","RTPSET",42,0)
OVERALL ;entry point for RT OVERALL menu
"RTN","RTPSET",43,0)
 Q:$D(RTAPL)&($D(RTSYS))  S XQUIT="",DIC(0)="IAEMQ",DIC="^DIC(195.1," D ^DIC Q:Y<0  K XQUIT D APL1,SET K:'$D(DUOUT) XQUIT K DUOUT Q
"RTN","RTPSET",44,0)
 ;
"RTN","RTPSET",45,0)
TYPE K RTTY,RTDIV,RTFR S XQUIT="",DIC(0)="IAQEMZ",DIC="^DIC(195.2,",DIC("S")="I $S('$D(RTAPL):1,$P(^(0),U,3)=+RTAPL:1,1:0),$S('$D(^(""I"")):1,'^(""I""):1,DT'>+^(""I""):1,1:0)",DIC("A")="Select Record Type: " D ^DIC K DIC Q:Y<0
"RTN","RTPSET",46,0)
 S RTTY=+Y_";"_Y(0) S Y=$S($D(RTAPL):+RTAPL,1:+$P(Y(0),"^",3)) D APL1
"RTN","RTPSET",47,0)
 D FR^RTPSET1:$D(RTAPL),DIV:$D(RTFR) K:'$D(RTDIV)!('$D(RTAPL))!('$D(RTFR))!('$D(RTTY)) RTTY,RTDIV,RTAPL,RTFR K:$D(RTTY) XQUIT Q
"RTN","RTPSET",48,0)
 ;
"RTN","RTPSET",49,0)
MAS S Y=+^DIC(195.4,1,"MAS") D APL1 Q
"RTN","RTPSET",50,0)
RAD S Y=+^DIC(195.4,1,"RAD") D APL1 Q
"RTN","RTPSET1")
0^2^B9799403^B8812220
"RTN","RTPSET1",1,0)
RTPSET1 ;MJK/TROY ISC;Sign-on Parameter Routine; ; 5/26/87  4:13 PM ;
"RTN","RTPSET1",2,0)
 ;;2.0;Record Tracking;**16,46**;10/22/91 ;Build 46
"RTN","RTPSET1",3,0)
FR ;entry point will return RTFR ; RTAPL must be defined ; RTTY is optional
"RTN","RTPSET1",4,0)
 I '($D(DUZ)#2) W !!?5,*7,"User's 'DUZ' is not defined." Q
"RTN","RTPSET1",5,0)
 S %ZIS="L",IOP="HOME" D ^%ZIS K %ZIS,IOP,RTFR S DIC("V")="I $P(Y(0),U,4)=""L"""
"RTN","RTPSET1",6,0)
 S IONSAV=ION I $D(IO("ZIO")),IO("ZIO")'=IO(0) S ION=IO("ZIO")
"RTN","RTPSET1",7,0)
 S DIC("S")="S Z0=^(0) I $P(Z0,U,3)="_+RTAPL_",$P(Z0,U,13)=""F"",$D(^SC(+$P(Z0,U,2),0)),$D(^DIC(195.1,"_+RTAPL_",""INST"",+$P(^(0),U,4),0)),$S('$D(RTTY):1,$D(^DIC(195.2,""AF"",Y,+RTTY)):1,1:0) D DICS^RTDPA31"
"RTN","RTPSET1",8,0)
 I $D(RTSYS),$P(RTSYS,"^",4)="n",$D(^RTV(195.9,"ADEV",ION)) S Y=+$O(^(ION,0)) I $D(^RTV(195.9,Y,0)) X DIC("S") I $T S RTFR=Y_"^"_$P(^RTV(195.9,Y,0),"^",2,99) G FRQ
"RTN","RTPSET1",9,0)
 ;RT*2.0*46 Requires User to enter a valid file room or "^" to exit
"RTN","RTPSET1",10,0)
 D:$D(DUZ(2)) DEF
"RTN","RTPSET1",11,0)
 F  S DIC(0)="IAMEQZ",DIC="^RTV(195.9,",DIC("A")="Select Record Tracking File Room: " D ^DIC S:Y>0 RTFR=+Y_"^"_$P(Y(0),"^",2,99) Q:Y>0!($D(DUOUT))  W !,"Enter a Valid File Room or '^' to Exit",!
"RTN","RTPSET1",12,0)
 K:$D(DUOUT) RTAPL,RTSYS
"RTN","RTPSET1",13,0)
FRQ I $D(RTSYS),$P(RTSYS,"^",4)="e",$D(RTFR) S $P(RTFR,"^",4,6)="^^"
"RTN","RTPSET1",14,0)
 I $D(RTFR),$S('$D(^RTV(195.9,"ADEV",ION)):1,1:+RTFR'=$O(^(ION,0))),$P(RTFR,"^",4,6)'="^^" D ASK S:"N^"[$E(X) $P(RTFR,"^",4,6)="^^"
"RTN","RTPSET1",15,0)
 S ION=IONSAV K IONSAV,DIC Q
"RTN","RTPSET1",16,0)
 ;
"RTN","RTPSET1",17,0)
DEF Q:'$D(^DIC(195.1,+RTAPL,"INST",+DUZ(2),0))  S Y=+$P(^(0),"^",2) I $D(^RTV(195.9,Y,0)),$P(^(0),"^")["SC(",$D(^SC(+^(0),0)) S DIC("B")=$S('+$P(^(0),"^"):$P(^(0),"^"),1:$P(^RTV(195.9,Y,0),"^"))
"RTN","RTPSET1",18,0)
 Q
"RTN","RTPSET1",19,0)
 ;
"RTN","RTPSET1",20,0)
PGM ;Entry point to run a record tracking program for a specific application
"RTN","RTPSET1",21,0)
 ;     RTAPPL = <application name or synonym>   [ex. MAS]
"RTN","RTPSET1",22,0)
 ;     RTPGM  = <program to be executed>        [ex. 1^RTQ]
"RTN","RTPSET1",23,0)
 ;
"RTN","RTPSET1",24,0)
 S IOP="" D ^%ZIS K IOP I $D(RTAPL) S X=RTAPPL D SAVE,APL^RTPSET D:$D(RTAPL) @RTPGM D RESTORE Q
"RTN","RTPSET1",25,0)
 S X=RTAPPL D APL^RTPSET D:$D(RTAPL) @RTPGM K RTAPL,RTSYS Q
"RTN","RTPSET1",26,0)
 ;
"RTN","RTPSET1",27,0)
MAS ;Entry point to run a RT program for 'MAS' application / RTPGM defined
"RTN","RTPSET1",28,0)
 S RTAPPL="MAS" D PGM K RTAPPL,RTPGM Q
"RTN","RTPSET1",29,0)
 ;
"RTN","RTPSET1",30,0)
RAD ;Entry point to run a RT program for 'FILM TRACKING' application / RTPGM defined
"RTN","RTPSET1",31,0)
 S RTAPPL="RAD" D PGM K RTAPPL,RTPGM,RTD,J Q
"RTN","RTPSET1",32,0)
 ;
"RTN","RTPSET1",33,0)
SAVE K RTNEW F I="RTAPL","RTSYS","RTFR","RTDIV" I $D(@I) S RTNEW(I)=@I
"RTN","RTPSET1",34,0)
 Q
"RTN","RTPSET1",35,0)
 ;
"RTN","RTPSET1",36,0)
RESTORE F I="RTAPL","RTSYS","RTFR","RTDIV" I $D(RTNEW(I)) S @I=RTNEW(I)
"RTN","RTPSET1",37,0)
 K RTNEW Q
"RTN","RTPSET1",38,0)
 ;
"RTN","RTPSET1",39,0)
ASK S RTRD(1)="Yes^use default devices",RTRD(2)="No^do not use default devices",RTRD("B")=1,RTRD("A")="Do you want to use the file room's default devices? ",RTRD(0)="S" D SET^RTRD K RTRD Q
"VER")
8.0^22.0
"BLD",7618,6)
^43
**END**
**END**
