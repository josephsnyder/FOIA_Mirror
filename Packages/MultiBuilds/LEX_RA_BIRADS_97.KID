KIDS Distribution saved on Jul 31, 2009@07:31:59
LEX*2.0*55 and RA*5.0*97
**KIDS**:LEX*2.0*55^RA*5.0*97^

**INSTALL NAME**
LEX*2.0*55
"BLD",7029,0)
LEX*2.0*55^LEXICON UTILITY^0^3090731^y
"BLD",7029,1,0)
^9.61A^2^2^3090602^^
"BLD",7029,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",7029,1,2,0)
included in this patch.
"BLD",7029,4,0)
^9.64PA^^
"BLD",7029,6)
^
"BLD",7029,6.3)
11
"BLD",7029,"INIT")
POST^LEX2055P
"BLD",7029,"KRN",0)
^9.67PA^8989.52^19
"BLD",7029,"KRN",.4,0)
.4
"BLD",7029,"KRN",.401,0)
.401
"BLD",7029,"KRN",.402,0)
.402
"BLD",7029,"KRN",.403,0)
.403
"BLD",7029,"KRN",.5,0)
.5
"BLD",7029,"KRN",.84,0)
.84
"BLD",7029,"KRN",3.6,0)
3.6
"BLD",7029,"KRN",3.8,0)
3.8
"BLD",7029,"KRN",9.2,0)
9.2
"BLD",7029,"KRN",9.8,0)
9.8
"BLD",7029,"KRN",9.8,"NM",0)
^9.68A^17^17
"BLD",7029,"KRN",9.8,"NM",1,0)
LEX2055P^^0^B22882820
"BLD",7029,"KRN",9.8,"NM",2,0)
LEX2055A^^0^B55248924
"BLD",7029,"KRN",9.8,"NM",3,0)
LEX2055B^^0^B66701747
"BLD",7029,"KRN",9.8,"NM",4,0)
LEX2055C^^0^B53113878
"BLD",7029,"KRN",9.8,"NM",5,0)
LEX2055D^^0^B68192938
"BLD",7029,"KRN",9.8,"NM",6,0)
LEX2055E^^0^B68482263
"BLD",7029,"KRN",9.8,"NM",7,0)
LEX2055F^^0^B71730942
"BLD",7029,"KRN",9.8,"NM",8,0)
LEX2055G^^0^B75516224
"BLD",7029,"KRN",9.8,"NM",9,0)
LEX2055H^^0^B72557384
"BLD",7029,"KRN",9.8,"NM",10,0)
LEX2055I^^0^B125880515
"BLD",7029,"KRN",9.8,"NM",11,0)
LEXA^^0^B42625550
"BLD",7029,"KRN",9.8,"NM",12,0)
LEXA1^^0^B28014387
"BLD",7029,"KRN",9.8,"NM",13,0)
LEXAL^^0^B37971689
"BLD",7029,"KRN",9.8,"NM",14,0)
LEXAR4^^0^B9905737
"BLD",7029,"KRN",9.8,"NM",15,0)
LEXAR5^^0^B25098898
"BLD",7029,"KRN",9.8,"NM",16,0)
LEXTOLKN^^0^B16578878
"BLD",7029,"KRN",9.8,"NM",17,0)
LEXAR^^0^B17442980
"BLD",7029,"KRN",9.8,"NM","B","LEX2055A",2)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055B",3)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055C",4)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055D",5)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055E",6)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055F",7)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055G",8)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055H",9)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055I",10)

"BLD",7029,"KRN",9.8,"NM","B","LEX2055P",1)

"BLD",7029,"KRN",9.8,"NM","B","LEXA",11)

"BLD",7029,"KRN",9.8,"NM","B","LEXA1",12)

"BLD",7029,"KRN",9.8,"NM","B","LEXAL",13)

"BLD",7029,"KRN",9.8,"NM","B","LEXAR",17)

"BLD",7029,"KRN",9.8,"NM","B","LEXAR4",14)

"BLD",7029,"KRN",9.8,"NM","B","LEXAR5",15)

"BLD",7029,"KRN",9.8,"NM","B","LEXTOLKN",16)

"BLD",7029,"KRN",19,0)
19
"BLD",7029,"KRN",19.1,0)
19.1
"BLD",7029,"KRN",101,0)
101
"BLD",7029,"KRN",409.61,0)
409.61
"BLD",7029,"KRN",771,0)
771
"BLD",7029,"KRN",870,0)
870
"BLD",7029,"KRN",8989.51,0)
8989.51
"BLD",7029,"KRN",8989.52,0)
8989.52
"BLD",7029,"KRN",8994,0)
8994
"BLD",7029,"KRN","B",.4,.4)

"BLD",7029,"KRN","B",.401,.401)

"BLD",7029,"KRN","B",.402,.402)

"BLD",7029,"KRN","B",.403,.403)

"BLD",7029,"KRN","B",.5,.5)

"BLD",7029,"KRN","B",.84,.84)

"BLD",7029,"KRN","B",3.6,3.6)

"BLD",7029,"KRN","B",3.8,3.8)

"BLD",7029,"KRN","B",9.2,9.2)

"BLD",7029,"KRN","B",9.8,9.8)

"BLD",7029,"KRN","B",19,19)

"BLD",7029,"KRN","B",19.1,19.1)

"BLD",7029,"KRN","B",101,101)

"BLD",7029,"KRN","B",409.61,409.61)

"BLD",7029,"KRN","B",771,771)

"BLD",7029,"KRN","B",870,870)

"BLD",7029,"KRN","B",8989.51,8989.51)

"BLD",7029,"KRN","B",8989.52,8989.52)

"BLD",7029,"KRN","B",8994,8994)

"BLD",7029,"QDEF")
^^^^NO^^^^^^NO
"BLD",7029,"QUES",0)
^9.62^^
"BLD",7029,"REQB",0)
^9.611^2^2
"BLD",7029,"REQB",1,0)
LEX*2.0*43^2
"BLD",7029,"REQB",2,0)
LEX*2.0*56^2
"BLD",7029,"REQB","B","LEX*2.0*43",1)

"BLD",7029,"REQB","B","LEX*2.0*56",2)

"INIT")
POST^LEX2055P
"MBREQ")
0
"PKG",353,-1)
1^1
"PKG",353,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.
"PKG",353,20,0)
^9.402P^^
"PKG",353,22,0)
^9.49I^1^1
"PKG",353,22,1,0)
2.0^2960915^2961224^64
"PKG",353,22,1,"PAH",1,0)
55^3090731^4569
"PKG",353,22,1,"PAH",1,1,0)
^^2^2^3090731
"PKG",353,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",353,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
17
"RTN","LEX2055A")
0^2^B55248924
"RTN","LEX2055A",1,0)
LEX2055A ;ISL/KER - Install/Uninstall BI-RADS/FDA Code Set ;11/30/2008
"RTN","LEX2055A",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055A",3,0)
 ;               
"RTN","LEX2055A",4,0)
 ; Global Variables
"RTN","LEX2055A",5,0)
 ;    ^LEX(*              N/A
"RTN","LEX2055A",6,0)
 ;               
"RTN","LEX2055A",7,0)
 ; External References
"RTN","LEX2055A",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055A",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055A",10,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055A",11,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055A",12,0)
 ;               
"RTN","LEX2055A",13,0)
INST ; Install
"RTN","LEX2055A",14,0)
 Q:+($$PATCH^XPDUTL("LEX*2.0*56"))'>0  N DA,DIK,LEX,LEXA,LEXP D SUP,EXP
"RTN","LEX2055A",15,0)
 Q
"RTN","LEX2055A",16,0)
SUP ;   Install Supporting Files
"RTN","LEX2055A",17,0)
 D BMES^XPDUTL(" Updating Supporting Files"),MES^XPDUTL(" =========================")
"RTN","LEX2055A",18,0)
 D INST^LEX2055I,SRB^LEX2055A,SSB^LEX2055A,SRF^LEX2055A,SSF^LEX2055A,SSC^LEX2055A,SST^LEX2055A,SCS^LEX2055A,SSD^LEX2055A
"RTN","LEX2055A",19,0)
 Q
"RTN","LEX2055A",20,0)
EXP ;   Install Expressions
"RTN","LEX2055A",21,0)
 D BMES^XPDUTL(" Updating Terminology Files"),MES^XPDUTL(" ==========================")
"RTN","LEX2055A",22,0)
 D BMES^XPDUTL("   Major Concept Map                                            file #757")
"RTN","LEX2055A",23,0)
 D MES^XPDUTL("   Frequency                                                    file #757.001")
"RTN","LEX2055A",24,0)
 D MES^XPDUTL("   Expressions                                                  file #757.01")
"RTN","LEX2055A",25,0)
 D MES^XPDUTL("   Codes                                                        file #757.02")
"RTN","LEX2055A",26,0)
 D MES^XPDUTL("   Semantic Map                                                 file #757.1")
"RTN","LEX2055A",27,0)
 D INST^LEX2055B,INST^LEX2055C,INST^LEX2055D,INST^LEX2055E,INST^LEX2055F,INST^LEX2055G,INST^LEX2055H,MES^XPDUTL("  ")
"RTN","LEX2055A",28,0)
 Q
"RTN","LEX2055A",29,0)
 ;              
"RTN","LEX2055A",30,0)
UNIN ; Uninstall
"RTN","LEX2055A",31,0)
 Q:+($$PATCH^XPDUTL("LEX*2.0*56"))'>0
"RTN","LEX2055A",32,0)
 N DA,DIK,LEX,LEXA,LEXP
"RTN","LEX2055A",33,0)
 D BMES^XPDUTL(" Updating Terminology Files"),MES^XPDUTL(" =========================="),MES^XPDUTL("   ")
"RTN","LEX2055A",34,0)
 D UNIN^LEX2055B,UNIN^LEX2055C,UNIN^LEX2055D,UNIN^LEX2055E,UNIN^LEX2055F,UNIN^LEX2055G,UNIN^LEX2055H,UNIN^LEX2055I
"RTN","LEX2055A",35,0)
 D BMES^XPDUTL(" Updating Supporting Files"),MES^XPDUTL(" ========================="),MES^XPDUTL("   ")
"RTN","LEX2055A",36,0)
 D USR,USS,USC,UST,UCS,USD,MES^XPDUTL("  ")
"RTN","LEX2055A",37,0)
 Q
"RTN","LEX2055A",38,0)
 ;              
"RTN","LEX2055A",39,0)
 ; Install
"RTN","LEX2055A",40,0)
SRB ;   Sources             File 757.14    2         BI-RADS
"RTN","LEX2055A",41,0)
 D BMES^XPDUTL("   Adding Source for BI-RADS                                    file #757.14")
"RTN","LEX2055A",42,0)
 S DIK="^LEX(757.14,",DA=2 D ^DIK S ^LEX(757.14,DA,0)="BI-RADS^^Breast Imaging Reporting and Data System (BI-RADS) Atlas (ACR)" D IX1^DIK
"RTN","LEX2055A",43,0)
 N LEX S LEX=$O(^LEX(757.14," "),-1) S:+LEX>0 $P(^LEX(757.14,0),"^",3)=+LEX,$P(^LEX(757.14,0),"^",4)=+LEX
"RTN","LEX2055A",44,0)
 Q
"RTN","LEX2055A",45,0)
SSB ;   Categories          File 757.13    488-494   BI-RADS
"RTN","LEX2055A",46,0)
 D BMES^XPDUTL("   Adding Categories for BI-RADS                                file #757.13")
"RTN","LEX2055A",47,0)
 N DIK,DA,LEXA,LEXP S DIK="^LEX(757.13,",LEXA=488 F DA=488,489,490,491,492,493,494,495,496 D ^DIK
"RTN","LEX2055A",48,0)
 D MES^XPDUTL("     Breast Imaging Reporting and Data Systems")
"RTN","LEX2055A",49,0)
 S DA=488,^LEX(757.13,DA,0)="Breast Imaging Reporting and Data Systems^BI000"
"RTN","LEX2055A",50,0)
 S ^LEX(757.13,DA,3)=LEXA_"^"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",51,0)
 D MES^XPDUTL("       MRI Assessment Categories")
"RTN","LEX2055A",52,0)
 S DA=489,LEXP=DA S ^LEX(757.13,DA,0)="MRI^BI100" S ^LEX(757.13,DA,1)=LEXA_"^BI000"
"RTN","LEX2055A",53,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"^"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",54,0)
 S DA=492,LEXP=489 S ^LEX(757.13,DA,0)="MRI Assessment Categories^BI110",^LEX(757.13,DA,1)=LEXP_"^BI100",^LEX(757.13,DA,2)=LEXA_"^BI000"
"RTN","LEX2055A",55,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"~"_DA_"^"_DA_"~"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",56,0)
 D MES^XPDUTL("       Ultrasound Assessment Categories")
"RTN","LEX2055A",57,0)
 S DA=490,LEXP=DA S ^LEX(757.13,DA,0)="Ultrasound^BI200",^LEX(757.13,DA,1)=LEXA_"^BI000"
"RTN","LEX2055A",58,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"^"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",59,0)
 S DA=493,LEXP=490 S ^LEX(757.13,DA,0)="Ultrasound Assessment Categories^BI210",^LEX(757.13,DA,1)=LEXP_"^BI200",^LEX(757.13,DA,2)=LEXA_"^BI000"
"RTN","LEX2055A",60,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"~"_DA_"^"_DA_"~"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",61,0)
 D MES^XPDUTL("       Mammography Assessment Categories")
"RTN","LEX2055A",62,0)
 S DA=491,LEXP=DA S ^LEX(757.13,DA,0)="Mammography^BI300",^LEX(757.13,DA,1)=LEXA_"^BI000",^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"^"_LEXP_"~"_LEXA
"RTN","LEX2055A",63,0)
 S ^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",64,0)
 S DA=494,LEXP=491 S ^LEX(757.13,DA,0)="Mammography Assessment Categories^BI310",^LEX(757.13,DA,1)=LEXP_"^BI300",^LEX(757.13,DA,2)=LEXA_"^BI000"
"RTN","LEX2055A",65,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"~"_DA_"^"_DA_"~"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=2,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",66,0)
 N LEX S LEX=$O(^LEX(757.13," "),-1) S:+LEX>0 $P(^LEX(757.13,0),"^",3)=+LEX,$P(^LEX(757.13,0),"^",4)=+LEX
"RTN","LEX2055A",67,0)
 Q
"RTN","LEX2055A",68,0)
SRF ;   Sources             File 757.14    3         FDA
"RTN","LEX2055A",69,0)
 D BMES^XPDUTL("   Adding Source for Mammography Quality Standards              file #757.14")
"RTN","LEX2055A",70,0)
 S DIK="^LEX(757.14,",DA=3 D ^DIK S ^LEX(757.14,DA,0)="MQSA^^Mammography Quality Standards Act of 1992 (MQSA)" D IX1^DIK
"RTN","LEX2055A",71,0)
 N LEX S LEX=$O(^LEX(757.14," "),-1) S:+LEX>0 $P(^LEX(757.14,0),"^",3)=+LEX,$P(^LEX(757.14,0),"^",4)=+LEX
"RTN","LEX2055A",72,0)
 Q
"RTN","LEX2055A",73,0)
SSF ;   Categories          File 757.13    495-496   FDA
"RTN","LEX2055A",74,0)
 D BMES^XPDUTL("   Adding Categories for Mammography Quality Standards Act      file #757.13")
"RTN","LEX2055A",75,0)
 D MES^XPDUTL("     Quality Standards")
"RTN","LEX2055A",76,0)
 D MES^XPDUTL("       Mammography Assessment Categories")
"RTN","LEX2055A",77,0)
 S DIK="^LEX(757.13," F DA=495,496 D ^DIK
"RTN","LEX2055A",78,0)
 S LEXA=495,DA=495,^LEX(757.13,DA,0)="Quality Standards^FR000"
"RTN","LEX2055A",79,0)
 S ^LEX(757.13,DA,3)=LEXA_"^"_LEXA,^LEX(757.13,DA,4)=3,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",80,0)
 S DA=496,LEXP=DA S ^LEX(757.13,DA,0)="Mammography Assessment Categories^FR12C" S ^LEX(757.13,DA,1)=LEXA_"^FR000"
"RTN","LEX2055A",81,0)
 S ^LEX(757.13,DA,3)=LEXA_"~"_LEXP_"^"_LEXP_"~"_LEXA,^LEX(757.13,DA,4)=3,^LEX(757.13,DA,5)="Radiology" D IX1^DIK
"RTN","LEX2055A",82,0)
 N LEX S LEX=$O(^LEX(757.13," "),-1) S:+LEX>0 $P(^LEX(757.13,0),"^",3)=+LEX,$P(^LEX(757.13,0),"^",4)=+LEX
"RTN","LEX2055A",83,0)
 Q
"RTN","LEX2055A",84,0)
SSC ;   Semantic Class      File 757.11    6
"RTN","LEX2055A",85,0)
 D BMES^XPDUTL("   Updating Semantic Class 'Diseases/Pathologic Processes'      file #757.11")
"RTN","LEX2055A",86,0)
 N DIK,DA S DA(1)=6,DA=17,DIK="^LEX(757.11,"_DA(1)_",2," D ^DIK S ^LEX(757.11,6,2,17,0)="BI-RADS" D IX1^DIK
"RTN","LEX2055A",87,0)
 Q
"RTN","LEX2055A",88,0)
SST ;   Semantic Type       File 757.12    34
"RTN","LEX2055A",89,0)
 D BMES^XPDUTL("   Updating Semantic Type 'Finding'                             file #757.12")
"RTN","LEX2055A",90,0)
 N DIK,DA S DA(1)=33,DA=16,DIK="^LEX(757.12,"_DA(1)_",1," D ^DIK S ^LEX(757.12,DA(1),1,DA,0)="BI-RADS" D IX1^DIK
"RTN","LEX2055A",91,0)
 Q
"RTN","LEX2055A",92,0)
SCS ;   Coding System       File 757.03    57
"RTN","LEX2055A",93,0)
 D BMES^XPDUTL("   Adding BI-RADS Coding System                                 file #757.03")
"RTN","LEX2055A",94,0)
 S DIK="^LEX(757.03,",DA=57 D ^DIK S ^LEX(757.03,DA,0)="BIR^BI-RADS^Breast Imaging Reporting and Data Sys, Assessments^American College of Radiology (ACR)^7^7^3.0" D IX1^DIK
"RTN","LEX2055A",95,0)
 Q
"RTN","LEX2055A",96,0)
SSD ;   Subset Definition   File 757.2     20
"RTN","LEX2055A",97,0)
 D BMES^XPDUTL("   Adding BI-RADS Subset                                        file #757.2")
"RTN","LEX2055A",98,0)
 N DIK,DA S DIK="^LEXT(757.2,",DA=20 D ^DIK
"RTN","LEX2055A",99,0)
 S DA=20,^LEXT(757.2,DA,0)="Brest Imaging Rpt Data Sys BI-RADS",^LEXT(757.2,DA,1)="^LEX(757.01,",^LEXT(757.2,DA,2)="XTLK^LEXHLP",^LEXT(757.2,DA,3)="XTLK^LEXPRNT"
"RTN","LEX2055A",100,0)
 S ^LEXT(757.2,DA,4)="BI1",^LEXT(757.2,DA,5)="BI1^WRD^0^71^RA^0^1^^0",^LEXT(757.2,DA,6)="I +($$SO^LEXU(Y,""BIR"",+($G(LEXVDT))))>0"
"RTN","LEX2055A",101,0)
 S ^LEXT(757.2,DA,7)="BIR",^LEXT(757.2,DA,100,0)="^757.22^3^3^3080124^^^^"
"RTN","LEX2055A",102,0)
 S ^LEXT(757.2,DA,100,1,0)="This subset is artificially created through the use of a"
"RTN","LEX2055A",103,0)
 S ^LEXT(757.2,DA,100,2,0)="filter which will not permit the selection of a term which"
"RTN","LEX2055A",104,0)
 S ^LEXT(757.2,DA,100,3,0)="does not have a valid BI-RAD code assigned."
"RTN","LEX2055A",105,0)
 D IX1^DIK K DIK,DA
"RTN","LEX2055A",106,0)
 Q
"RTN","LEX2055A",107,0)
 ;              
"RTN","LEX2055A",108,0)
 ; Uninstall
"RTN","LEX2055A",109,0)
USR ;   Sources             File 757.14    2,3       BI-RADS/FDA
"RTN","LEX2055A",110,0)
 D MES^XPDUTL("   Removing Sources             BI-RADS and MQSA (FDA)")
"RTN","LEX2055A",111,0)
 N DA,DIK S DIK="^LEX(757.14," F DA=2,3 D ^DIK
"RTN","LEX2055A",112,0)
 Q
"RTN","LEX2055A",113,0)
USS ;   Categories          File 757.13    488-496   BI-RADS/FDA
"RTN","LEX2055A",114,0)
 D MES^XPDUTL("   Removing Source Category     Mammography Assessment Categories")
"RTN","LEX2055A",115,0)
 N DA,DIK S DIK="^LEX(757.13," F DA=488,489,490,491,492,493,494,495,496 D ^DIK
"RTN","LEX2055A",116,0)
 Q
"RTN","LEX2055A",117,0)
USC ;   Semantic Class      File 757.11    6
"RTN","LEX2055A",118,0)
 D MES^XPDUTL("   Updating Semantic Class      Diseases/Pathologic Processes")
"RTN","LEX2055A",119,0)
 N DIK,DA S DA(1)=6,DA=17,DIK="^LEX(757.11,"_DA(1)_",2," D ^DIK
"RTN","LEX2055A",120,0)
 Q
"RTN","LEX2055A",121,0)
UST ;   Semantic Type       File 757.12    33
"RTN","LEX2055A",122,0)
 D MES^XPDUTL("   Updating Semantic Type       Finding")
"RTN","LEX2055A",123,0)
 N DIK,DA S DA(1)=33,DA=16,DIK="^LEX(757.12,"_DA(1)_",1," D ^DIK
"RTN","LEX2055A",124,0)
 Q
"RTN","LEX2055A",125,0)
UCS ;   Coding System       File 757.03    57
"RTN","LEX2055A",126,0)
 D MES^XPDUTL("   Removing Coding System       BI-RADS")
"RTN","LEX2055A",127,0)
 S DIK="^LEX(757.03,",DA=57 D ^DIK
"RTN","LEX2055A",128,0)
 Q
"RTN","LEX2055A",129,0)
USD ;   Subset Definition   File 757.2     20
"RTN","LEX2055A",130,0)
 D MES^XPDUTL("   Removing Subset Definition   BI-RADS")
"RTN","LEX2055A",131,0)
 N DIK,DA S DIK="^LEXT(757.2,",DA=20 D ^DIK
"RTN","LEX2055A",132,0)
 Q
"RTN","LEX2055B")
0^3^B66701747
"RTN","LEX2055B",1,0)
LEX2055B ;ISL/KER - BI-RADS/FDA Category 0 ;11/30/2008
"RTN","LEX2055B",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055B",3,0)
 ;               
"RTN","LEX2055B",4,0)
 ; Global Variables
"RTN","LEX2055B",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055B",6,0)
 ;               
"RTN","LEX2055B",7,0)
 ; External References
"RTN","LEX2055B",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055B",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055B",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055B",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055B",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055B",13,0)
 ;               
"RTN","LEX2055B",14,0)
INST ; Install Category 0
"RTN","LEX2055B",15,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055B",16,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055B",17,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055B",18,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055B",19,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055B",20,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055B",21,0)
 S LEXMC=186436
"RTN","LEX2055B",22,0)
 S LEXME=336107
"RTN","LEX2055B",23,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",24,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055B",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055B",26,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055B",27,0)
 S LEXBIR="Incomplete, need additional imaging evaluation and/or prior Mammograms for comparison"
"RTN","LEX2055B",28,0)
 S LEXFDA="Incomplete: Need Additional Imaging Evaluation"
"RTN","LEX2055B",29,0)
 S LEXCAT="Category 0"
"RTN","LEX2055B",30,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 0")
"RTN","LEX2055B",31,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055B",32,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055B",33,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055B",34,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055B",35,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055B",36,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055B",37,0)
 F LEXEX=79,80 D
"RTN","LEX2055B",38,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",39,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055B",40,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055B",41,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055B",42,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055B",43,0)
BIR ;   BI-RADS  Incomplete, need additional imaging for comparison
"RTN","LEX2055B",44,0)
 D MES^XPDUTL("        BI-RADS  Incomplete, need additional imaging evaluation and/or")
"RTN","LEX2055B",45,0)
 D MES^XPDUTL("                 prior Mammograms for comparison")
"RTN","LEX2055B",46,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055B",47,0)
 S LEXEX=79
"RTN","LEX2055B",48,0)
 S LEXSO=3812
"RTN","LEX2055B",49,0)
 S LEXSM=24592
"RTN","LEX2055B",50,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",51,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055B",52,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055B",53,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055B",54,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055B",55,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055B",56,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055B",57,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055B",58,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055B",59,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055B",60,0)
FDA ;   FDA      Incomplete: Need Additional Imaging Evaluation
"RTN","LEX2055B",61,0)
 D MES^XPDUTL("        FDA      Incomplete: Need Additional Imaging Evaluation")
"RTN","LEX2055B",62,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055B",63,0)
 S LEXEX=80
"RTN","LEX2055B",64,0)
 S LEXSO=3813
"RTN","LEX2055B",65,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055B",66,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055B",67,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055B",68,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055B",69,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055B",70,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055B",71,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055B",72,0)
 Q
"RTN","LEX2055B",73,0)
 ;          
"RTN","LEX2055B",74,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055B",75,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055B",76,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055B",77,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055B",78,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055B",79,0)
 Q
"RTN","LEX2055B",80,0)
DES ;   Description Text
"RTN","LEX2055B",81,0)
 ;;Category 0:  Mammographic assessment is incomplete, need additional
"RTN","LEX2055B",82,0)
 ;;imaging evaluation and/or prior mammograms for comparison.  This
"RTN","LEX2055B",83,0)
 ;;category is for findings where additional imaging evaluations are
"RTN","LEX2055B",84,0)
 ;;needed.  This is almost always used in a screening situation. Under
"RTN","LEX2055B",85,0)
 ;;certain circumstances this category may be used after a full
"RTN","LEX2055B",86,0)
 ;;mammographic work-up.  A recommendation for additional imaging
"RTN","LEX2055B",87,0)
 ;;evaluation may include, but is not limited to the use of spot
"RTN","LEX2055B",88,0)
 ;;compression, magnification, special mammographic views and ultrasound.
"RTN","LEX2055B",89,0)
 ;;Whenever possible, if the study is not negative and does not contain
"RTN","LEX2055B",90,0)
 ;;a typically benign finding, the current examination should be compared
"RTN","LEX2055B",91,0)
 ;;to previous studies. The radiologist should use judgment on how
"RTN","LEX2055B",92,0)
 ;;vigorously to attempt obtaining previous studies. Category 0 should
"RTN","LEX2055B",93,0)
 ;;only be used for old film comparison when such comparison is required
"RTN","LEX2055B",94,0)
 ;;to make a final assessment.
"RTN","LEX2055B",95,0)
 ;;;;
"RTN","LEX2055B",96,0)
 Q
"RTN","LEX2055B",97,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055B",98,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055B",99,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055B",100,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055B",101,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055B",102,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055B",103,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055B",104,0)
 Q
"RTN","LEX2055B",105,0)
SUP ;   Supplemental Words
"RTN","LEX2055B",106,0)
 ;;0
"RTN","LEX2055B",107,0)
 ;;BIRADS
"RTN","LEX2055B",108,0)
 ;;MAMMOGRAM
"RTN","LEX2055B",109,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055B",110,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055B",111,0)
 ;;BREASTS
"RTN","LEX2055B",112,0)
 ;;ASSESSMENT
"RTN","LEX2055B",113,0)
 ;;IS
"RTN","LEX2055B",114,0)
 ;;CATEGORIES
"RTN","LEX2055B",115,0)
 ;;CATEGORY
"RTN","LEX2055B",116,0)
 ;;RESULTS
"RTN","LEX2055B",117,0)
 ;;COMPRESSION
"RTN","LEX2055B",118,0)
 ;;MAGNIFICATION
"RTN","LEX2055B",119,0)
 ;;SPECIAL
"RTN","LEX2055B",120,0)
 ;;ULTRASOUND
"RTN","LEX2055B",121,0)
 ;;COMPARED
"RTN","LEX2055B",122,0)
 ;;PREVIOUS
"RTN","LEX2055B",123,0)
 ;;STUDY
"RTN","LEX2055B",124,0)
 ;;STUDIES
"RTN","LEX2055B",125,0)
 ;;INCONCLUSIVE
"RTN","LEX2055B",126,0)
 ;;CHECK
"RTN","LEX2055B",127,0)
 ;;SPOT
"RTN","LEX2055B",128,0)
 ;;BI
"RTN","LEX2055B",129,0)
 ;;RADS
"RTN","LEX2055B",130,0)
 ;;;;
"RTN","LEX2055B",131,0)
 Q
"RTN","LEX2055B",132,0)
 ;               
"RTN","LEX2055B",133,0)
UNIN ; Un-Install Category 0
"RTN","LEX2055B",134,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 0")
"RTN","LEX2055B",135,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055B",136,0)
 S LEXMC=186436
"RTN","LEX2055B",137,0)
 S LEXME=336107
"RTN","LEX2055B",138,0)
 S LEXMCE=LEXME F LEXEX=79,80 D
"RTN","LEX2055B",139,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",140,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055B",141,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055B",142,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055B",143,0)
 S LEXEX=79
"RTN","LEX2055B",144,0)
 S LEXSO=3812
"RTN","LEX2055B",145,0)
 S LEXSM=24592
"RTN","LEX2055B",146,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055B",147,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055B",148,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055B",149,0)
 S LEXEX=80
"RTN","LEX2055B",150,0)
 S LEXSO=3813
"RTN","LEX2055B",151,0)
 S LEXSM=24593
"RTN","LEX2055B",152,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055B",153,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055B",154,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055B",155,0)
 Q
"RTN","LEX2055B",156,0)
 ;               
"RTN","LEX2055B",157,0)
 ; Miscellaneous
"RTN","LEX2055B",158,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055B",159,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055B",160,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055B",161,0)
 Q X
"RTN","LEX2055B",162,0)
SH ;   Show New Records
"RTN","LEX2055B",163,0)
 N LEXI,LEXNN,LEXNC,LEXIN,LEXIO,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055B",164,0)
 S LEXMC=186436
"RTN","LEX2055B",165,0)
 S LEXME=336107
"RTN","LEX2055B",166,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055B",167,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055B",168,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",169,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055B",170,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055B",171,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055B",172,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055B",173,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055B",174,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",175,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055B",176,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055B",177,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055B",178,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055B",179,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055B",180,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055B",181,0)
 W:LEX>0 !
"RTN","LEX2055B",182,0)
 Q
"RTN","LEX2055C")
0^4^B53113878
"RTN","LEX2055C",1,0)
LEX2055C ;ISL/KER - BI-RADS/FDA Category 1 ;11/30/2008
"RTN","LEX2055C",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055C",3,0)
 ;               
"RTN","LEX2055C",4,0)
 ; Global Variables
"RTN","LEX2055C",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055C",6,0)
 ;               
"RTN","LEX2055C",7,0)
 ; External References
"RTN","LEX2055C",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055C",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055C",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055C",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055C",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055C",13,0)
 ;               
"RTN","LEX2055C",14,0)
 Q
"RTN","LEX2055C",15,0)
INST ; Install Category 1
"RTN","LEX2055C",16,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055C",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055C",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055C",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055C",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055C",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055C",22,0)
 S LEXMC=186437
"RTN","LEX2055C",23,0)
 S LEXME=336108
"RTN","LEX2055C",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055C",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055C",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055C",28,0)
 S LEXBIR="Negative"
"RTN","LEX2055C",29,0)
 S LEXFDA="Negative"
"RTN","LEX2055C",30,0)
 S LEXCAT="Category 1"
"RTN","LEX2055C",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 1")
"RTN","LEX2055C",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055C",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055C",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055C",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055C",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055C",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055C",38,0)
 F LEXEX=81,82 D
"RTN","LEX2055C",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055C",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055C",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055C",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055C",44,0)
BIR ;   BI-RADS  Negative
"RTN","LEX2055C",45,0)
 D MES^XPDUTL("        BI-RADS  Negative")
"RTN","LEX2055C",46,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055C",47,0)
 S LEXEX=81
"RTN","LEX2055C",48,0)
 S LEXSO=3814
"RTN","LEX2055C",49,0)
 S LEXSM=24594
"RTN","LEX2055C",50,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",51,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055C",52,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055C",53,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055C",54,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055C",55,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055C",56,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055C",57,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055C",58,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055C",59,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055C",60,0)
FDA ;   FDA      Negative
"RTN","LEX2055C",61,0)
 D MES^XPDUTL("        FDA      Negative")
"RTN","LEX2055C",62,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055C",63,0)
 S LEXEX=82
"RTN","LEX2055C",64,0)
 S LEXSO=3815
"RTN","LEX2055C",65,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055C",66,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055C",67,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055C",68,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055C",69,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055C",70,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055C",71,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055C",72,0)
 Q
"RTN","LEX2055C",73,0)
 ;          
"RTN","LEX2055C",74,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055C",75,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055C",76,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055C",77,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055C",78,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055C",79,0)
 Q
"RTN","LEX2055C",80,0)
DES ;   Description Text
"RTN","LEX2055C",81,0)
 ;;Category 1:  Mammographic assessment is complete. This category is
"RTN","LEX2055C",82,0)
 ;;used when there is nothing to comment on. The breasts are symmetric
"RTN","LEX2055C",83,0)
 ;;and no masses, architectural distortion or suspicious calcifications
"RTN","LEX2055C",84,0)
 ;;suspicious calcifications are present.
"RTN","LEX2055C",85,0)
 ;;;;
"RTN","LEX2055C",86,0)
 Q
"RTN","LEX2055C",87,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055C",88,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055C",89,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055C",90,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055C",91,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055C",92,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055C",93,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055C",94,0)
 Q
"RTN","LEX2055C",95,0)
SUP ;   Supplemental Words
"RTN","LEX2055C",96,0)
 ;;1
"RTN","LEX2055C",97,0)
 ;;BIRADS
"RTN","LEX2055C",98,0)
 ;;MAMMOGRAM
"RTN","LEX2055C",99,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055C",100,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055C",101,0)
 ;;BREASTS
"RTN","LEX2055C",102,0)
 ;;ASSESSMENT
"RTN","LEX2055C",103,0)
 ;;IS
"RTN","LEX2055C",104,0)
 ;;CATEGORIES
"RTN","LEX2055C",105,0)
 ;;CATEGORY
"RTN","LEX2055C",106,0)
 ;;RESULTS
"RTN","LEX2055C",107,0)
 ;;PRESENT
"RTN","LEX2055C",108,0)
 ;;COMPLETE
"RTN","LEX2055C",109,0)
 ;;FINAL
"RTN","LEX2055C",110,0)
 ;;NORMAL
"RTN","LEX2055C",111,0)
 ;;BI
"RTN","LEX2055C",112,0)
 ;;RADS
"RTN","LEX2055C",113,0)
 ;;;;
"RTN","LEX2055C",114,0)
 Q
"RTN","LEX2055C",115,0)
 ;               
"RTN","LEX2055C",116,0)
UNIN ; Un-Install Category 1
"RTN","LEX2055C",117,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 1")
"RTN","LEX2055C",118,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055C",119,0)
 S LEXMC=186437
"RTN","LEX2055C",120,0)
 S LEXME=336108
"RTN","LEX2055C",121,0)
 S LEXMCE=LEXME F LEXEX=81,82 D
"RTN","LEX2055C",122,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",123,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055C",124,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055C",125,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055C",126,0)
 S LEXEX=81
"RTN","LEX2055C",127,0)
 S LEXSO=3814
"RTN","LEX2055C",128,0)
 S LEXSM=24594
"RTN","LEX2055C",129,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055C",130,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055C",131,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055C",132,0)
 S LEXEX=82
"RTN","LEX2055C",133,0)
 S LEXSO=3815
"RTN","LEX2055C",134,0)
 S LEXSM=24595
"RTN","LEX2055C",135,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055C",136,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055C",137,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055C",138,0)
 Q
"RTN","LEX2055C",139,0)
 ;               
"RTN","LEX2055C",140,0)
 ; Miscellaneous
"RTN","LEX2055C",141,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055C",142,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055C",143,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055C",144,0)
 Q X
"RTN","LEX2055C",145,0)
SH ;   Show New Records
"RTN","LEX2055C",146,0)
 N LEXI,LEXIN,LEXIO,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055C",147,0)
 S LEXMC=186437
"RTN","LEX2055C",148,0)
 S LEXME=336108
"RTN","LEX2055C",149,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055C",150,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055C",151,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",152,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055C",153,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055C",154,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055C",155,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055C",156,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055C",157,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",158,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055C",159,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055C",160,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055C",161,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055C",162,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055C",163,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055C",164,0)
 W:LEX>0 !
"RTN","LEX2055C",165,0)
 Q
"RTN","LEX2055D")
0^5^B68192938
"RTN","LEX2055D",1,0)
LEX2055D ;ISL/KER - BI-RADS/FDA Category 2 ;11/30/2008
"RTN","LEX2055D",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055D",3,0)
 ;               
"RTN","LEX2055D",4,0)
 ; Global Variables
"RTN","LEX2055D",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055D",6,0)
 ;               
"RTN","LEX2055D",7,0)
 ; External References
"RTN","LEX2055D",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055D",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055D",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055D",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055D",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055D",13,0)
 ;               
"RTN","LEX2055D",14,0)
 Q
"RTN","LEX2055D",15,0)
INST ; Install Category 2
"RTN","LEX2055D",16,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055D",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055D",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055D",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055D",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055D",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055D",22,0)
 S LEXMC=186438
"RTN","LEX2055D",23,0)
 S LEXME=336109
"RTN","LEX2055D",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055D",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055D",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055D",28,0)
 S LEXBIR="Benign Finding(s)"
"RTN","LEX2055D",29,0)
 S LEXFDA="Benign"
"RTN","LEX2055D",30,0)
 S LEXCAT="Category 2"
"RTN","LEX2055D",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 2")
"RTN","LEX2055D",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055D",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055D",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055D",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055D",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055D",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055D",38,0)
 F LEXEX=83,84 D
"RTN","LEX2055D",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055D",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055D",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055D",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055D",44,0)
BIR ;   BI-RADS  Benign Finding(s)
"RTN","LEX2055D",45,0)
 D MES^XPDUTL("        BI-RADS  Benign Finding(s)")
"RTN","LEX2055D",46,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055D",47,0)
 S LEXEX=83
"RTN","LEX2055D",48,0)
 S LEXSO=3816
"RTN","LEX2055D",49,0)
 S LEXSM=24596
"RTN","LEX2055D",50,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",51,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055D",52,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055D",53,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055D",54,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055D",55,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055D",56,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055D",57,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055D",58,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055D",59,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055D",60,0)
FDA ;   FDA      Benign
"RTN","LEX2055D",61,0)
 D MES^XPDUTL("        FDA      Benign")
"RTN","LEX2055D",62,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055D",63,0)
 S LEXEX=84
"RTN","LEX2055D",64,0)
 S LEXSO=3817
"RTN","LEX2055D",65,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055D",66,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055D",67,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055D",68,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055D",69,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055D",70,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055D",71,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055D",72,0)
 Q
"RTN","LEX2055D",73,0)
 ;          
"RTN","LEX2055D",74,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055D",75,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055D",76,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055D",77,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055D",78,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055D",79,0)
 Q
"RTN","LEX2055D",80,0)
DES ;   Description Text
"RTN","LEX2055D",81,0)
 ;;Category 2:  Mammographic assessment is complete. This category is
"RTN","LEX2055D",82,0)
 ;;used when the assessment is "normal" but the interpreter chooses
"RTN","LEX2055D",83,0)
 ;;to describe a benign finding in the report.  Involuting, calcified
"RTN","LEX2055D",84,0)
 ;;fibroadenomas, multiple secretory calcifications, fat-containing
"RTN","LEX2055D",85,0)
 ;;lesions and mixed density hamartomas all have benign appearances,
"RTN","LEX2055D",86,0)
 ;;and may be labeled with confidence.  The interpreter may also choose
"RTN","LEX2055D",87,0)
 ;;to describe intramammary lymph nodes, vascular calcifications,
"RTN","LEX2055D",88,0)
 ;;implants or architectural distortion related to surgery and still
"RTN","LEX2055D",89,0)
 ;;concludes that there is no mammographic evidence of malignancy.
"RTN","LEX2055D",90,0)
 ;;Both a "Negative" and a "Benign Finding" assessment indicate no
"RTN","LEX2055D",91,0)
 ;;mammographic evidence of malignancy.  "Benign Finding" should be
"RTN","LEX2055D",92,0)
 ;;used when describing one or more specific benign findings in the
"RTN","LEX2055D",93,0)
 ;;report, whereas "Negative" finding should be used when no such
"RTN","LEX2055D",94,0)
 ;;findings are described.
"RTN","LEX2055D",95,0)
 ;;;;
"RTN","LEX2055D",96,0)
 Q
"RTN","LEX2055D",97,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055D",98,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055D",99,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055D",100,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055D",101,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055D",102,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055D",103,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055D",104,0)
 Q
"RTN","LEX2055D",105,0)
SUP ;   Supplemental Words
"RTN","LEX2055D",106,0)
 ;;2
"RTN","LEX2055D",107,0)
 ;;BIRADS
"RTN","LEX2055D",108,0)
 ;;MAMMOGRAM
"RTN","LEX2055D",109,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055D",110,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055D",111,0)
 ;;BREASTS
"RTN","LEX2055D",112,0)
 ;;ASSESSMENT
"RTN","LEX2055D",113,0)
 ;;IS
"RTN","LEX2055D",114,0)
 ;;CATEGORIES
"RTN","LEX2055D",115,0)
 ;;CATEGORY
"RTN","LEX2055D",116,0)
 ;;RESULTS
"RTN","LEX2055D",117,0)
 ;;PRESENT
"RTN","LEX2055D",118,0)
 ;;COMPLETE
"RTN","LEX2055D",119,0)
 ;;FINAL
"RTN","LEX2055D",120,0)
 ;;NORMAL
"RTN","LEX2055D",121,0)
 ;;CALCIFICATIONS
"RTN","LEX2055D",122,0)
 ;;CALCIFIED
"RTN","LEX2055D",123,0)
 ;;CYSTS
"RTN","LEX2055D",124,0)
 ;;ARCHITECTURAL
"RTN","LEX2055D",125,0)
 ;;CONTAINING
"RTN","LEX2055D",126,0)
 ;;DENSITY
"RTN","LEX2055D",127,0)
 ;;DISTORTION
"RTN","LEX2055D",128,0)
 ;;FAT
"RTN","LEX2055D",129,0)
 ;;FIBROADENOMAS
"RTN","LEX2055D",130,0)
 ;;GALACTOCELES
"RTN","LEX2055D",131,0)
 ;;HAMARTOMAS
"RTN","LEX2055D",132,0)
 ;;IMPLANTS
"RTN","LEX2055D",133,0)
 ;;INTRAMAMMARY
"RTN","LEX2055D",134,0)
 ;;INVOLUTING
"RTN","LEX2055D",135,0)
 ;;LESIONS
"RTN","LEX2055D",136,0)
 ;;LIPOMAS
"RTN","LEX2055D",137,0)
 ;;LYMPH
"RTN","LEX2055D",138,0)
 ;;MIXED
"RTN","LEX2055D",139,0)
 ;;NODES
"RTN","LEX2055D",140,0)
 ;;OIL
"RTN","LEX2055D",141,0)
 ;;SECRETORY
"RTN","LEX2055D",142,0)
 ;;VASCULAR
"RTN","LEX2055D",143,0)
 ;;BI
"RTN","LEX2055D",144,0)
 ;;RADS
"RTN","LEX2055D",145,0)
 ;;;;
"RTN","LEX2055D",146,0)
 Q
"RTN","LEX2055D",147,0)
 ;               
"RTN","LEX2055D",148,0)
UNIN ; Un-Install Category 2
"RTN","LEX2055D",149,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 2")
"RTN","LEX2055D",150,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055D",151,0)
 S LEXMC=186438
"RTN","LEX2055D",152,0)
 S LEXME=336109
"RTN","LEX2055D",153,0)
 S LEXMCE=LEXME F LEXEX=83,84 D
"RTN","LEX2055D",154,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",155,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055D",156,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055D",157,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055D",158,0)
 S LEXEX=83
"RTN","LEX2055D",159,0)
 S LEXSO=3816
"RTN","LEX2055D",160,0)
 S LEXSM=24596
"RTN","LEX2055D",161,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055D",162,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055D",163,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055D",164,0)
 S LEXEX=84
"RTN","LEX2055D",165,0)
 S LEXSO=3817
"RTN","LEX2055D",166,0)
 S LEXSM=24597
"RTN","LEX2055D",167,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055D",168,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055D",169,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055D",170,0)
 Q
"RTN","LEX2055D",171,0)
 ;               
"RTN","LEX2055D",172,0)
 ; Miscellaneous
"RTN","LEX2055D",173,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055D",174,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055D",175,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055D",176,0)
 Q X
"RTN","LEX2055D",177,0)
SH ;   Show New Records
"RTN","LEX2055D",178,0)
 N LEXI,LEXIN,LEXIO,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055D",179,0)
 S LEXMC=186438
"RTN","LEX2055D",180,0)
 S LEXME=336109
"RTN","LEX2055D",181,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055D",182,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055D",183,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",184,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055D",185,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055D",186,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055D",187,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055D",188,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055D",189,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",190,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055D",191,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055D",192,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055D",193,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055D",194,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055D",195,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055D",196,0)
 W:LEX>0 !
"RTN","LEX2055D",197,0)
 Q
"RTN","LEX2055E")
0^6^B68482263
"RTN","LEX2055E",1,0)
LEX2055E ;ISL/KER - BI-RADS/FDA Category 3 ;11/30/2008
"RTN","LEX2055E",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055E",3,0)
 ;               
"RTN","LEX2055E",4,0)
 ; Global Variables
"RTN","LEX2055E",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055E",6,0)
 ;               
"RTN","LEX2055E",7,0)
 ; External References
"RTN","LEX2055E",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055E",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055E",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055E",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055E",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055E",13,0)
 ;               
"RTN","LEX2055E",14,0)
 Q
"RTN","LEX2055E",15,0)
INST ; Install Category 3
"RTN","LEX2055E",16,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055E",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055E",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055E",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055E",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055E",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055E",22,0)
 S LEXMC=186439
"RTN","LEX2055E",23,0)
 S LEXME=336110
"RTN","LEX2055E",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055E",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055E",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055E",28,0)
 S LEXBIR="Probably Benign Finding, Initial Short-Interval Follow-Up Suggested"
"RTN","LEX2055E",29,0)
 S LEXFDA="Probably Benign"
"RTN","LEX2055E",30,0)
 S LEXCAT="Category 3"
"RTN","LEX2055E",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 3")
"RTN","LEX2055E",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055E",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055E",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055E",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055E",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055E",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055E",38,0)
 F LEXEX=85,86 D
"RTN","LEX2055E",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055E",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055E",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055E",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055E",44,0)
BIR ;   BI-RADS  Probably Benign Finding, Follow-Up Suggested
"RTN","LEX2055E",45,0)
 D MES^XPDUTL("        BI-RADS  Probably Benign Finding, Initial Short-Interval")
"RTN","LEX2055E",46,0)
 D MES^XPDUTL("                 Follow-Up Suggested")
"RTN","LEX2055E",47,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055E",48,0)
 S LEXEX=85
"RTN","LEX2055E",49,0)
 S LEXSO=3818
"RTN","LEX2055E",50,0)
 S LEXSM=24598
"RTN","LEX2055E",51,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",52,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055E",53,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055E",54,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055E",55,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055E",56,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055E",57,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055E",58,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055E",59,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055E",60,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055E",61,0)
FDA ;   FDA      Probably Benign
"RTN","LEX2055E",62,0)
 D MES^XPDUTL("        FDA      Probably Benign")
"RTN","LEX2055E",63,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055E",64,0)
 S LEXEX=86
"RTN","LEX2055E",65,0)
 S LEXSO=3819
"RTN","LEX2055E",66,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055E",67,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055E",68,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055E",69,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055E",70,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055E",71,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055E",72,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055E",73,0)
 Q
"RTN","LEX2055E",74,0)
 ;          
"RTN","LEX2055E",75,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055E",76,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055E",77,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055E",78,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055E",79,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055E",80,0)
 Q
"RTN","LEX2055E",81,0)
DES ;   Description Text
"RTN","LEX2055E",82,0)
 ;;Category 3:  Mammographic assessment is complete. This category is
"RTN","LEX2055E",83,0)
 ;;used when there is a less than a 2% risk of malignancy.  It is not
"RTN","LEX2055E",84,0)
 ;;expected to change over the follow-up interval, but the radiologist
"RTN","LEX2055E",85,0)
 ;;would prefer to establish its stability.  Three specific findings
"RTN","LEX2055E",86,0)
 ;;that are described as being probably benign include the noncalcified
"RTN","LEX2055E",87,0)
 ;;circumscribed solid mass, the focal asymmetry and the cluster of
"RTN","LEX2055E",88,0)
 ;;round [punctate] calcifications.  A complete diagnostic imaging
"RTN","LEX2055E",89,0)
 ;;evaluation is needed before making a probably benign (Category 3)
"RTN","LEX2055E",90,0)
 ;;assessment; hence it is inadvisable to render such an assessment when
"RTN","LEX2055E",91,0)
 ;;interpreting a screening examination.  Also, the use of a probably
"RTN","LEX2055E",92,0)
 ;;benign assessment for a palpable lesion is not supported by scientific
"RTN","LEX2055E",93,0)
 ;;data.  Finally, a biopsy, rather than continued follow-up, is needed
"RTN","LEX2055E",94,0)
 ;;when most probably benign findings increase in size or extent.
"RTN","LEX2055E",95,0)
 ;;;;
"RTN","LEX2055E",96,0)
 Q
"RTN","LEX2055E",97,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055E",98,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055E",99,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055E",100,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055E",101,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055E",102,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055E",103,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055E",104,0)
 Q
"RTN","LEX2055E",105,0)
SUP ;   Supplemental Words
"RTN","LEX2055E",106,0)
 ;;3
"RTN","LEX2055E",107,0)
 ;;BIRADS
"RTN","LEX2055E",108,0)
 ;;MAMMOGRAM
"RTN","LEX2055E",109,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055E",110,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055E",111,0)
 ;;BREASTS
"RTN","LEX2055E",112,0)
 ;;ASSESSMENT
"RTN","LEX2055E",113,0)
 ;;IS
"RTN","LEX2055E",114,0)
 ;;CATEGORIES
"RTN","LEX2055E",115,0)
 ;;CATEGORY
"RTN","LEX2055E",116,0)
 ;;RESULTS
"RTN","LEX2055E",117,0)
 ;;PRESENT
"RTN","LEX2055E",118,0)
 ;;COMPLETE
"RTN","LEX2055E",119,0)
 ;;FINAL
"RTN","LEX2055E",120,0)
 ;;CALCIFICATIONS
"RTN","LEX2055E",121,0)
 ;;CALCIFIED
"RTN","LEX2055E",122,0)
 ;;MASSESS
"RTN","LEX2055E",123,0)
 ;;MALIGNANT
"RTN","LEX2055E",124,0)
 ;;MALIGNANCY
"RTN","LEX2055E",125,0)
 ;;EVALUATION
"RTN","LEX2055E",126,0)
 ;;BIOPSY
"RTN","LEX2055E",127,0)
 ;;CIRCUMSCRIBED
"RTN","LEX2055E",128,0)
 ;;CLUSTER
"RTN","LEX2055E",129,0)
 ;;ASYMMETRY
"RTN","LEX2055E",130,0)
 ;;DIAGNOSTIC
"RTN","LEX2055E",131,0)
 ;;FOCAL
"RTN","LEX2055E",132,0)
 ;;IMAGING
"RTN","LEX2055E",133,0)
 ;;PUNCTATE
"RTN","LEX2055E",134,0)
 ;;RISK
"RTN","LEX2055E",135,0)
 ;;ROUND
"RTN","LEX2055E",136,0)
 ;;SOLID
"RTN","LEX2055E",137,0)
 ;;STABILITY
"RTN","LEX2055E",138,0)
 ;;STABLE
"RTN","LEX2055E",139,0)
 ;;UNCALCIFIED
"RTN","LEX2055E",140,0)
 ;;BI
"RTN","LEX2055E",141,0)
 ;;RADS
"RTN","LEX2055E",142,0)
 Q
"RTN","LEX2055E",143,0)
 ;               
"RTN","LEX2055E",144,0)
UNIN ; Un-Install Category 3
"RTN","LEX2055E",145,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 3")
"RTN","LEX2055E",146,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055E",147,0)
 S LEXMC=186439
"RTN","LEX2055E",148,0)
 S LEXME=336110
"RTN","LEX2055E",149,0)
 S LEXMCE=LEXME F LEXEX=85,86 D
"RTN","LEX2055E",150,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",151,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055E",152,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055E",153,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055E",154,0)
 S LEXEX=85
"RTN","LEX2055E",155,0)
 S LEXSO=3818
"RTN","LEX2055E",156,0)
 S LEXSM=24598
"RTN","LEX2055E",157,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055E",158,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055E",159,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055E",160,0)
 S LEXEX=86
"RTN","LEX2055E",161,0)
 S LEXSO=3819
"RTN","LEX2055E",162,0)
 S LEXSM=24599
"RTN","LEX2055E",163,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055E",164,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055E",165,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055E",166,0)
 Q
"RTN","LEX2055E",167,0)
 ;               
"RTN","LEX2055E",168,0)
 ; Miscellaneous
"RTN","LEX2055E",169,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055E",170,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055E",171,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055E",172,0)
 Q X
"RTN","LEX2055E",173,0)
SH ;   Show New Records
"RTN","LEX2055E",174,0)
 N LEXI,LEXIO,LEXIN,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055E",175,0)
 S LEXMC=186439
"RTN","LEX2055E",176,0)
 S LEXME=336110
"RTN","LEX2055E",177,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055E",178,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055E",179,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",180,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055E",181,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055E",182,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055E",183,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055E",184,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055E",185,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",186,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055E",187,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055E",188,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055E",189,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055E",190,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055E",191,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055E",192,0)
 W:LEX>0 !
"RTN","LEX2055E",193,0)
 Q
"RTN","LEX2055F")
0^7^B71730942
"RTN","LEX2055F",1,0)
LEX2055F ;ISL/KER - BI-RADS/FDA Category 4 ;11/30/2008
"RTN","LEX2055F",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055F",3,0)
 ;               
"RTN","LEX2055F",4,0)
 ; Global Variables
"RTN","LEX2055F",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055F",6,0)
 ;               
"RTN","LEX2055F",7,0)
 ; External References
"RTN","LEX2055F",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055F",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055F",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055F",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055F",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055F",13,0)
 ;               
"RTN","LEX2055F",14,0)
 Q
"RTN","LEX2055F",15,0)
INST ; Install Category 4
"RTN","LEX2055F",16,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055F",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055F",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055F",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055F",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055F",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055F",22,0)
 S LEXMC=186440
"RTN","LEX2055F",23,0)
 S LEXME=336111
"RTN","LEX2055F",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055F",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055F",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055F",28,0)
 S LEXBIR="Suspicious Abnormality, Biopsy should be considered"
"RTN","LEX2055F",29,0)
 S LEXFDA="Suspicious"
"RTN","LEX2055F",30,0)
 S LEXCAT="Category 4"
"RTN","LEX2055F",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 4")
"RTN","LEX2055F",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055F",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055F",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055F",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055F",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055F",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055F",38,0)
 F LEXEX=87,88 D
"RTN","LEX2055F",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055F",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055F",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055F",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055F",44,0)
BIR ;   BI-RADS  Suspicious Abnormality, Biopsy should be considered
"RTN","LEX2055F",45,0)
 D MES^XPDUTL("        BI-RADS  Suspicious Abnormality, Biopsy should be considered")
"RTN","LEX2055F",46,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055F",47,0)
 S LEXEX=87
"RTN","LEX2055F",48,0)
 S LEXSO=3820
"RTN","LEX2055F",49,0)
 S LEXSM=24600
"RTN","LEX2055F",50,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",51,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055F",52,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055F",53,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055F",54,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055F",55,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055F",56,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055F",57,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055F",58,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055F",59,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055F",60,0)
FDA ;   FDA      Suspicious
"RTN","LEX2055F",61,0)
 D MES^XPDUTL("        FDA      Suspicious")
"RTN","LEX2055F",62,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055F",63,0)
 S LEXEX=88
"RTN","LEX2055F",64,0)
 S LEXSO=3821
"RTN","LEX2055F",65,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055F",66,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055F",67,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055F",68,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055F",69,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055F",70,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055F",71,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055F",72,0)
 Q
"RTN","LEX2055F",73,0)
 ;          
"RTN","LEX2055F",74,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055F",75,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055F",76,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055F",77,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055F",78,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055F",79,0)
 Q
"RTN","LEX2055F",80,0)
DES ;   Description Text
"RTN","LEX2055F",81,0)
 ;;Category 4:  Mammographic assessment is complete. This category is
"RTN","LEX2055F",82,0)
 ;;used for findings that do not appear to be malignant but have a
"RTN","LEX2055F",83,0)
 ;;probability of malignancy greater than Category 3. Most recommendations
"RTN","LEX2055F",84,0)
 ;;for breast interventional procedures are in this category. There are
"RTN","LEX2055F",85,0)
 ;;three sub-categories:  4A is for a finding needing intervention but
"RTN","LEX2055F",86,0)
 ;;with a low suspicion for malignancy. A malignant pathology report not
"RTN","LEX2055F",87,0)
 ;;expected and a 6-month or routine follow-up after a benign biopsy or
"RTN","LEX2055F",88,0)
 ;;cytology is appropriate.  4B includes lesions with an intermediate
"RTN","LEX2055F",89,0)
 ;;suspicion of malignancy. Findings in this category warrant close
"RTN","LEX2055F",90,0)
 ;;radiologic and pathologic correlation.  Follow-up with a benign
"RTN","LEX2055F",91,0)
 ;;result, in this situation, depends on concordance. 4C includes
"RTN","LEX2055F",92,0)
 ;;findings of moderate concern, but not classic (as in Category 5) for
"RTN","LEX2055F",93,0)
 ;;malignancy. A malignant result in this category is expected.
"RTN","LEX2055F",94,0)
 ;;;;
"RTN","LEX2055F",95,0)
 Q
"RTN","LEX2055F",96,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055F",97,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055F",98,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055F",99,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055F",100,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055F",101,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055F",102,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055F",103,0)
 Q
"RTN","LEX2055F",104,0)
SUP ;   Supplemental Words
"RTN","LEX2055F",105,0)
 ;;4
"RTN","LEX2055F",106,0)
 ;;4A
"RTN","LEX2055F",107,0)
 ;;4B
"RTN","LEX2055F",108,0)
 ;;4C
"RTN","LEX2055F",109,0)
 ;;BIRADS
"RTN","LEX2055F",110,0)
 ;;MAMMOGRAM
"RTN","LEX2055F",111,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055F",112,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055F",113,0)
 ;;BREASTS
"RTN","LEX2055F",114,0)
 ;;ASSESSMENT
"RTN","LEX2055F",115,0)
 ;;IS
"RTN","LEX2055F",116,0)
 ;;CATEGORIES
"RTN","LEX2055F",117,0)
 ;;CATEGORY
"RTN","LEX2055F",118,0)
 ;;RESULTS
"RTN","LEX2055F",119,0)
 ;;PRESENT
"RTN","LEX2055F",120,0)
 ;;COMPLETE
"RTN","LEX2055F",121,0)
 ;;FINAL
"RTN","LEX2055F",122,0)
 ;;CALCIFICATIONS
"RTN","LEX2055F",123,0)
 ;;CALCIFIED
"RTN","LEX2055F",124,0)
 ;;MASSESS
"RTN","LEX2055F",125,0)
 ;;MALIGNANT
"RTN","LEX2055F",126,0)
 ;;MALIGNANCY
"RTN","LEX2055F",127,0)
 ;;EVALUATION
"RTN","LEX2055F",128,0)
 ;;BIOPSY
"RTN","LEX2055F",129,0)
 ;;CIRCUMSCRIBED
"RTN","LEX2055F",130,0)
 ;;CLUSTER
"RTN","LEX2055F",131,0)
 ;;CYSTS
"RTN","LEX2055F",132,0)
 ;;ABSCESS
"RTN","LEX2055F",133,0)
 ;;APPEARANCE
"RTN","LEX2055F",134,0)
 ;;CLASSIC
"RTN","LEX2055F",135,0)
 ;;COMPLICATED
"RTN","LEX2055F",136,0)
 ;;CYTOLOGY
"RTN","LEX2055F",137,0)
 ;;EXCISIONAL
"RTN","LEX2055F",138,0)
 ;;FAT
"RTN","LEX2055F",139,0)
 ;;FEATURES
"RTN","LEX2055F",140,0)
 ;;FIBROADENOMA
"RTN","LEX2055F",141,0)
 ;;LESIONS
"RTN","LEX2055F",142,0)
 ;;LOW
"RTN","LEX2055F",143,0)
 ;;MARGINATED
"RTN","LEX2055F",144,0)
 ;;NECROSIS
"RTN","LEX2055F",145,0)
 ;;OF
"RTN","LEX2055F",146,0)
 ;;PALPABLE
"RTN","LEX2055F",147,0)
 ;;PAPILLOMA
"RTN","LEX2055F",148,0)
 ;;PARTIALLY
"RTN","LEX2055F",149,0)
 ;;PLEOMORPHIC
"RTN","LEX2055F",150,0)
 ;;PROBABLE
"RTN","LEX2055F",151,0)
 ;;SOLID
"RTN","LEX2055F",152,0)
 ;;SUSPICION
"RTN","LEX2055F",153,0)
 ;;ULTRASOUND
"RTN","LEX2055F",154,0)
 ;;BI
"RTN","LEX2055F",155,0)
 ;;RADS
"RTN","LEX2055F",156,0)
 ;;;;
"RTN","LEX2055F",157,0)
 Q
"RTN","LEX2055F",158,0)
 ;               
"RTN","LEX2055F",159,0)
UNIN ; Un-Install Category 4
"RTN","LEX2055F",160,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 4")
"RTN","LEX2055F",161,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055F",162,0)
 S LEXMC=186440
"RTN","LEX2055F",163,0)
 S LEXME=336111
"RTN","LEX2055F",164,0)
 S LEXMCE=LEXME F LEXEX=87,88 D
"RTN","LEX2055F",165,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",166,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055F",167,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055F",168,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055F",169,0)
 S LEXEX=87
"RTN","LEX2055F",170,0)
 S LEXSO=3820
"RTN","LEX2055F",171,0)
 S LEXSM=24600
"RTN","LEX2055F",172,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055F",173,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055F",174,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055F",175,0)
 S LEXEX=88
"RTN","LEX2055F",176,0)
 S LEXSO=3821
"RTN","LEX2055F",177,0)
 S LEXSM=24601
"RTN","LEX2055F",178,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055F",179,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055F",180,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055F",181,0)
 Q
"RTN","LEX2055F",182,0)
 ;               
"RTN","LEX2055F",183,0)
 ; Miscellaneous
"RTN","LEX2055F",184,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055F",185,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055F",186,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055F",187,0)
 Q X
"RTN","LEX2055F",188,0)
SH ;   Show New Records
"RTN","LEX2055F",189,0)
 N LEXI,LEXIO,LEXIN,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055F",190,0)
 S LEXMC=186440
"RTN","LEX2055F",191,0)
 S LEXME=336111
"RTN","LEX2055F",192,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055F",193,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055F",194,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",195,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055F",196,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055F",197,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055F",198,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055F",199,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055F",200,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",201,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055F",202,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055F",203,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055F",204,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055F",205,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055F",206,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055F",207,0)
 W:LEX>0 !
"RTN","LEX2055F",208,0)
 Q
"RTN","LEX2055G")
0^8^B75516224
"RTN","LEX2055G",1,0)
LEX2055G ;ISL/KER - BI-RADS/FDA Category 5 ;11/30/2008
"RTN","LEX2055G",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055G",3,0)
 ;               
"RTN","LEX2055G",4,0)
 ; Global Variables
"RTN","LEX2055G",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055G",6,0)
 ;               
"RTN","LEX2055G",7,0)
 ; External References
"RTN","LEX2055G",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055G",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055G",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055G",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055G",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055G",13,0)
 ;               
"RTN","LEX2055G",14,0)
 Q
"RTN","LEX2055G",15,0)
INST ; Install Category 5
"RTN","LEX2055G",16,0)
 N DA,DIK,LEX,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055G",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055G",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055G",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055G",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055G",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055G",22,0)
 S LEXMC=186441
"RTN","LEX2055G",23,0)
 S LEXME=336112
"RTN","LEX2055G",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055G",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055G",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055G",28,0)
 S LEXBIR="Highly Suggestive of Malignancy, appropriate action should be taken"
"RTN","LEX2055G",29,0)
 S LEXFDA="Highly Suggestive of Malignancy"
"RTN","LEX2055G",30,0)
 S LEXCAT="Category 5"
"RTN","LEX2055G",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 5")
"RTN","LEX2055G",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055G",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055G",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055G",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055G",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055G",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055G",38,0)
 F LEXEX=89,90 D
"RTN","LEX2055G",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055G",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055G",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055G",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055G",44,0)
BIR ;   BI-RADS  Highly Suggestive of Malignancy, appropriate
"RTN","LEX2055G",45,0)
 ;            action should be taken
"RTN","LEX2055G",46,0)
 D MES^XPDUTL("        BI-RADS  Highly Suggestive of Malignancy, appropriate action")
"RTN","LEX2055G",47,0)
 D MES^XPDUTL("                 should be taken")
"RTN","LEX2055G",48,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055G",49,0)
 S LEXEX=89
"RTN","LEX2055G",50,0)
 S LEXSO=3822
"RTN","LEX2055G",51,0)
 S LEXSM=24602
"RTN","LEX2055G",52,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",53,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055G",54,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055G",55,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055G",56,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055G",57,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055G",58,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055G",59,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055G",60,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055G",61,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055G",62,0)
FDA ;   FDA      Highly Suggestive of Malignancy
"RTN","LEX2055G",63,0)
 D MES^XPDUTL("        FDA      Highly Suggestive of Malignancy")
"RTN","LEX2055G",64,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055G",65,0)
 S LEXEX=90
"RTN","LEX2055G",66,0)
 S LEXSO=3823
"RTN","LEX2055G",67,0)
 S LEXND=LEXFDA S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055G",68,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055G",69,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055G",70,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055G",71,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055G",72,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055G",73,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055G",74,0)
 Q
"RTN","LEX2055G",75,0)
 ;          
"RTN","LEX2055G",76,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055G",77,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055G",78,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055G",79,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055G",80,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055G",81,0)
 Q
"RTN","LEX2055G",82,0)
DES ;   Description Text
"RTN","LEX2055G",83,0)
 ;;Category 5:  Mammographic assessment is complete. This category is
"RTN","LEX2055G",84,0)
 ;;used for lesions that have a high probability (95% or greater) of
"RTN","LEX2055G",85,0)
 ;;being cancer.  This category contains lesions for which one-stage
"RTN","LEX2055G",86,0)
 ;;surgical treatment could be considered without preliminary biopsy.
"RTN","LEX2055G",87,0)
 ;;However, current oncologic management may require percutaneous tissue
"RTN","LEX2055G",88,0)
 ;;sampling as, for example, when sentinel node imaging is included in
"RTN","LEX2055G",89,0)
 ;;surgical treatment or when neoadjuvant chemotherapy is administered
"RTN","LEX2055G",90,0)
 ;;at the outset.  This category must be reserved for findings that are
"RTN","LEX2055G",91,0)
 ;;classic breast cancers, with a 95% or greater likelihood of malignancy.
"RTN","LEX2055G",92,0)
 ;;Findings that warrant biopsy but are not classic for malignancy
"RTN","LEX2055G",93,0)
 ;;should be placed in Category 4, ideally in one of the three
"RTN","LEX2055G",94,0)
 ;;subdivisions (4A, 4B or 4c).
"RTN","LEX2055G",95,0)
 ;;;;
"RTN","LEX2055G",96,0)
 Q
"RTN","LEX2055G",97,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055G",98,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055G",99,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055G",100,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055G",101,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055G",102,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055G",103,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055G",104,0)
 Q
"RTN","LEX2055G",105,0)
SUP ;   Supplemental Words
"RTN","LEX2055G",106,0)
 ;;5
"RTN","LEX2055G",107,0)
 ;;BIRADS
"RTN","LEX2055G",108,0)
 ;;MAMMOGRAM
"RTN","LEX2055G",109,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055G",110,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055G",111,0)
 ;;BREASTS
"RTN","LEX2055G",112,0)
 ;;ASSESSMENT
"RTN","LEX2055G",113,0)
 ;;IS
"RTN","LEX2055G",114,0)
 ;;CATEGORIES
"RTN","LEX2055G",115,0)
 ;;CATEGORY
"RTN","LEX2055G",116,0)
 ;;RESULTS
"RTN","LEX2055G",117,0)
 ;;PRESENT
"RTN","LEX2055G",118,0)
 ;;COMPLETE
"RTN","LEX2055G",119,0)
 ;;FINAL
"RTN","LEX2055G",120,0)
 ;;CALCIFICATIONS
"RTN","LEX2055G",121,0)
 ;;CALCIFIED
"RTN","LEX2055G",122,0)
 ;;MASSESS
"RTN","LEX2055G",123,0)
 ;;MALIGNANT
"RTN","LEX2055G",124,0)
 ;;MALIGNANCY
"RTN","LEX2055G",125,0)
 ;;EVALUATION
"RTN","LEX2055G",126,0)
 ;;BIOPSY
"RTN","LEX2055G",127,0)
 ;;MANAGEMENT
"RTN","LEX2055G",128,0)
 ;;ADMINISTERED
"RTN","LEX2055G",129,0)
 ;;ADMINISTRATION
"RTN","LEX2055G",130,0)
 ;;CARCINOMA
"RTN","LEX2055G",131,0)
 ;;EVALUATION
"RTN","LEX2055G",132,0)
 ;;MASTECTOMY
"RTN","LEX2055G",133,0)
 ;;TREATMENT
"RTN","LEX2055G",134,0)
 ;;ONCOLOGY
"RTN","LEX2055G",135,0)
 ;;ONCOLOGIC
"RTN","LEX2055G",136,0)
 ;;THERAPY
"RTN","LEX2055G",137,0)
 ;;THERAPIES
"RTN","LEX2055G",138,0)
 ;;CHEMOTHERAPY
"RTN","LEX2055G",139,0)
 ;;SURIGICAL
"RTN","LEX2055G",140,0)
 ;;EXCISION
"RTN","LEX2055G",141,0)
 ;;RADIATION
"RTN","LEX2055G",142,0)
 ;;TISSUE
"RTN","LEX2055G",143,0)
 ;;SAMPLE
"RTN","LEX2055G",144,0)
 ;;SAMPLING
"RTN","LEX2055G",145,0)
 ;;CANCER
"RTN","LEX2055G",146,0)
 ;;CARCINOMA
"RTN","LEX2055G",147,0)
 ;;ARRANGEMENT
"RTN","LEX2055G",148,0)
 ;;ASSOCIATED
"RTN","LEX2055G",149,0)
 ;;CLASSIC
"RTN","LEX2055G",150,0)
 ;;DENSITY
"RTN","LEX2055G",151,0)
 ;;FIBROADENOMA
"RTN","LEX2055G",152,0)
 ;;FINE
"RTN","LEX2055G",153,0)
 ;;HIGH
"RTN","LEX2055G",154,0)
 ;;IMAGING
"RTN","LEX2055G",155,0)
 ;;IRREGULAR
"RTN","LEX2055G",156,0)
 ;;LINEAR
"RTN","LEX2055G",157,0)
 ;;NEOADJUVANT
"RTN","LEX2055G",158,0)
 ;;NODES
"RTN","LEX2055G",159,0)
 ;;ONE
"RTN","LEX2055G",160,0)
 ;;PERCUTANEOUS
"RTN","LEX2055G",161,0)
 ;;PLEOMORPHIC
"RTN","LEX2055G",162,0)
 ;;PRELIMINARY
"RTN","LEX2055G",163,0)
 ;;SEGMENTAL
"RTN","LEX2055G",164,0)
 ;;SENTINEL
"RTN","LEX2055G",165,0)
 ;;SPICULATED
"RTN","LEX2055G",166,0)
 ;;STAGE
"RTN","LEX2055G",167,0)
 ;;SINGLE
"RTN","LEX2055G",168,0)
 ;;BI
"RTN","LEX2055G",169,0)
 ;;RADS
"RTN","LEX2055G",170,0)
 Q
"RTN","LEX2055G",171,0)
 ;               
"RTN","LEX2055G",172,0)
UNIN ; Un-Install Category 5
"RTN","LEX2055G",173,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 5")
"RTN","LEX2055G",174,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055G",175,0)
 S LEXMC=186441
"RTN","LEX2055G",176,0)
 S LEXME=336112
"RTN","LEX2055G",177,0)
 S LEXMCE=LEXME F LEXEX=89,90 D
"RTN","LEX2055G",178,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",179,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055G",180,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055G",181,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055G",182,0)
 S LEXEX=89
"RTN","LEX2055G",183,0)
 S LEXSO=3822
"RTN","LEX2055G",184,0)
 S LEXSM=24602
"RTN","LEX2055G",185,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055G",186,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055G",187,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055G",188,0)
 S LEXEX=90
"RTN","LEX2055G",189,0)
 S LEXSO=3823
"RTN","LEX2055G",190,0)
 S LEXSM=24603
"RTN","LEX2055G",191,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055G",192,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055G",193,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055G",194,0)
 Q
"RTN","LEX2055G",195,0)
 ;               
"RTN","LEX2055G",196,0)
 ; Miscellaneous
"RTN","LEX2055G",197,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055G",198,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055G",199,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055G",200,0)
 Q X
"RTN","LEX2055G",201,0)
SH ;   Show New Records
"RTN","LEX2055G",202,0)
 N LEXI,LEXIO,LEXIN,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055G",203,0)
 S LEXMC=186441
"RTN","LEX2055G",204,0)
 S LEXME=336112
"RTN","LEX2055G",205,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055G",206,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055G",207,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",208,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055G",209,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055G",210,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055G",211,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055G",212,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055G",213,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",214,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055G",215,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055G",216,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055G",217,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055G",218,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055G",219,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055G",220,0)
 W:LEX>0 !
"RTN","LEX2055G",221,0)
 Q
"RTN","LEX2055H")
0^9^B72557384
"RTN","LEX2055H",1,0)
LEX2055H ;ISL/KER - BI-RADS/FDA Category 6 ;11/30/2008
"RTN","LEX2055H",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055H",3,0)
 ;               
"RTN","LEX2055H",4,0)
 ; Global Variables
"RTN","LEX2055H",5,0)
 ;    ^LEX(757*           N/A
"RTN","LEX2055H",6,0)
 ;               
"RTN","LEX2055H",7,0)
 ; External References
"RTN","LEX2055H",8,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055H",9,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055H",10,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055H",11,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055H",12,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055H",13,0)
 ;               
"RTN","LEX2055H",14,0)
 Q
"RTN","LEX2055H",15,0)
INST ; Install Category 6
"RTN","LEX2055H",16,0)
 N DA,DIK,LEX,LEXA,LEXBC,LEXBIR,LEXBS,LEXC,LEXCAT,LEXE,LEXEX,LEXFC,LEXFDA,LEXFQ,LEXFS,LEXI,LEXL,LEXM,LEXMC,LEXMCE,LEXME,LEXMO,LEXMS,LEXN0,LEXN1,LEXNC,LEXND,LEXNN,LEXPF,LEXPM,LEXSC,LEXSM,LEXSO,LEXST,LEXSY,LEXT,LEXW,X,Y
"RTN","LEX2055H",17,0)
 S LEXSC=$O(^LEX(757.11,"B","DIS",0)) Q:+LEXSC'>0
"RTN","LEX2055H",18,0)
 S LEXST=$O(^LEX(757.12,"E","FINDING",0)) Q:+LEXST'>0
"RTN","LEX2055H",19,0)
 S LEXSY=$O(^LEX(757.03,"ASAB","BIR",0)) Q:+LEXSY'>0
"RTN","LEX2055H",20,0)
 S LEXBS=$O(^LEX(757.14,"B","BI-RADS",0)) Q:+LEXBS'>0
"RTN","LEX2055H",21,0)
 S LEXFS=$O(^LEX(757.14,"B","MQSA",0)) Q:+LEXFS'>0
"RTN","LEX2055H",22,0)
 S LEXMC=186442
"RTN","LEX2055H",23,0)
 S LEXME=336113
"RTN","LEX2055H",24,0)
 S LEXI=0 F  S LEXI=$O(^LEX(757.13,"C","MAMMOGRAPHY ASSESSMENT CATEGORIES",LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",25,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXBS LEXBC=LEXI
"RTN","LEX2055H",26,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXFS LEXFC=LEXI
"RTN","LEX2055H",27,0)
 Q:+($G(LEXBC))'>0  Q:+($G(LEXFC))'>0
"RTN","LEX2055H",28,0)
 S LEXBIR="Known Biopsy, Proven Malignancy, appropriate action should be taken"
"RTN","LEX2055H",29,0)
 S LEXFDA="Known Biopsy Proven Malignancy"
"RTN","LEX2055H",30,0)
 S LEXCAT="Category 6"
"RTN","LEX2055H",31,0)
 D BMES^XPDUTL("     BI-RADS/FDA Mammography Category 6")
"RTN","LEX2055H",32,0)
 D DESC(LEXME),SUPL(LEXME)
"RTN","LEX2055H",33,0)
 F LEXW="ACR","BREAST","IMAGING","REPORTING","AND","DATA","SYTEMS","FDA","MQSA","MAMMOGRAPHY","QUALITY","STANDARDS","ACT","OF","1992","CFR","900.12","C" D
"RTN","LEX2055H",34,0)
 . I '$D(^LEX(757.01,+LEXME,5,"B",LEXW)) D
"RTN","LEX2055H",35,0)
 . . S LEXL=+($O(^LEX(757.01,+LEXME,5," "),-1))+1
"RTN","LEX2055H",36,0)
 . . S ^LEX(757.01,+LEXME,5,LEXL,0)=LEXW,^LEX(757.01,+LEXME,5,"B",LEXW,LEXL)=""
"RTN","LEX2055H",37,0)
 . . S ^LEX(757.01,+LEXME,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055H",38,0)
 F LEXEX=91,92 D
"RTN","LEX2055H",39,0)
 . Q:+LEXME'>0  N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",40,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055H",41,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,+LEXME,LEXI)
"RTN","LEX2055H",42,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055H",43,0)
 S DA=LEXME,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055H",44,0)
BIR ;   BI-RADS  Known Biopsy, Proven Malignancy, appropriate
"RTN","LEX2055H",45,0)
 ;            action should be taken
"RTN","LEX2055H",46,0)
 D MES^XPDUTL("        BI-RADS  Known Biopsy, Proven Malignancy, appropriate action")
"RTN","LEX2055H",47,0)
 D MES^XPDUTL("                 should be taken")
"RTN","LEX2055H",48,0)
 S LEXPF=1,LEXPM=1
"RTN","LEX2055H",49,0)
 S LEXEX=91
"RTN","LEX2055H",50,0)
 S LEXSO=3824
"RTN","LEX2055H",51,0)
 S LEXSM=24604
"RTN","LEX2055H",52,0)
 S LEXND=LEXMC_"^"_LEXSC_"^"_LEXST K LEXA S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXMC,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",53,0)
 . N LEXND S LEXND=$G(^LEX(757.1,LEXI,0)) Q:'$L(LEXND)  S LEXA(LEXND,+LEXI)=""
"RTN","LEX2055H",54,0)
 I '$D(LEXA(LEXND)) S ^LEX(757.1,LEXSM,0)=LEXND S DA=LEXSM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2055H",55,0)
 S LEXND=LEXBIR S ^LEX(757.01,LEXEX,0)=LEXND
"RTN","LEX2055H",56,0)
 S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXBC_"^"_LEXBS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055H",57,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055H",58,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055H",59,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055H",60,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055H",61,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055H",62,0)
FDA ;   FDA      Known Biopsy Proven Malignancy
"RTN","LEX2055H",63,0)
 D MES^XPDUTL("        FDA      Known Biopsy Proven Malignancy")
"RTN","LEX2055H",64,0)
 S LEXPF=0,LEXPM=1
"RTN","LEX2055H",65,0)
 S LEXEX=92
"RTN","LEX2055H",66,0)
 S LEXSO=3825
"RTN","LEX2055H",67,0)
 S LEXND=LEXFDA
"RTN","LEX2055H",68,0)
 S ^LEX(757.01,LEXEX,0)=LEXND S LEXND=LEXMC_"^2^D^12^^^^^^^"_LEXFC_"^"_LEXFS S ^LEX(757.01,LEXEX,1)=LEXND D DESC(LEXEX)
"RTN","LEX2055H",69,0)
 S DA=LEXEX,DIK="^LEX(757.01," D IX1^DIK S LEXEX=DA
"RTN","LEX2055H",70,0)
 S ^LEX(757.02,+LEXSO,0)=LEXEX_"^"_LEXCAT_"^"_LEXSY_"^"_LEXMC_"^"_LEXPF_"^^"_LEXPM
"RTN","LEX2055H",71,0)
 S ^LEX(757.02,+LEXSO,4,0)="^757.28D^1^1"
"RTN","LEX2055H",72,0)
 S ^LEX(757.02,+LEXSO,4,1,0)="3030101^1"
"RTN","LEX2055H",73,0)
 S DA=LEXSO,DIK="^LEX(757.02," D IX1^DIK
"RTN","LEX2055H",74,0)
 Q
"RTN","LEX2055H",75,0)
 ;          
"RTN","LEX2055H",76,0)
DESC(LEXEX) ;   Description
"RTN","LEX2055H",77,0)
 Q:+($G(LEXEX))'>0  K ^LEX(757.01,LEXEX,3) S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055H",78,0)
 . S LEXT="" S LEXE="S LEXT=$T(DES+"_LEXI_")" X LEXE S LEXT=$$TM($P(LEXT,";;",2)) Q:'$L(LEXT)
"RTN","LEX2055H",79,0)
 . S LEXL=+($O(^LEX(757.01,LEXEX,3," "),-1))+1,^LEX(757.01,LEXEX,3,LEXL,0)=LEXT
"RTN","LEX2055H",80,0)
 . S ^LEX(757.01,+LEXEX,3,0)="^^"_LEXL_"^"_LEXL_"^"_$$DT^XLFDT_"^"
"RTN","LEX2055H",81,0)
 Q
"RTN","LEX2055H",82,0)
DES ;   Description Text
"RTN","LEX2055H",83,0)
 ;;Category 6:  Mammographic assessment is complete. This category is
"RTN","LEX2055H",84,0)
 ;;used for breast findings confirmed to be malignant by biopsy prior to
"RTN","LEX2055H",85,0)
 ;;definitive therapies such as surgical excision, radiation therapy,
"RTN","LEX2055H",86,0)
 ;;chemotherapy or mastectomy.  This category is appropriate for second
"RTN","LEX2055H",87,0)
 ;;opinions on findings previously biopsied and shown to be malignant or
"RTN","LEX2055H",88,0)
 ;;for the monitoring of responses to neoadjuvant chemotherapy prior to
"RTN","LEX2055H",89,0)
 ;;surgical excision.  This category is not appropriate after excision
"RTN","LEX2055H",90,0)
 ;;of a malignancy (lumpectomy). A major rationale for adding Category 6
"RTN","LEX2055H",91,0)
 ;;is that examinations meriting this assessment should be excluded from
"RTN","LEX2055H",92,0)
 ;;auditing. Auditing practices that includes such examinations would
"RTN","LEX2055H",93,0)
 ;;inappropriately indicate inflated cancer detection rates, positive
"RTN","LEX2055H",94,0)
 ;;predictive values, and other outcomes parameters.
"RTN","LEX2055H",95,0)
 ;;;;
"RTN","LEX2055H",96,0)
 Q
"RTN","LEX2055H",97,0)
SUPL(LEXEX) ;   Supplemental
"RTN","LEX2055H",98,0)
 Q:+($G(LEXEX))'>0  S LEXC=0,LEXT="" F LEXI=1:1 D  Q:'$L(LEXT)
"RTN","LEX2055H",99,0)
 . S LEXT="" S LEXE="S LEXT=$T(SUP+"_LEXI_")" X LEXE S LEXT=$TR($P(LEXT,";;",2)," ","") Q:'$L(LEXT)
"RTN","LEX2055H",100,0)
 . Q:$D(^LEX(757.01,+LEXEX,5,"B",LEXT))
"RTN","LEX2055H",101,0)
 . S LEXL=+($O(^LEX(757.01,+LEXEX,5," "),-1))+1,^LEX(757.01,+LEXEX,5,LEXL,0)=LEXT,^LEX(757.01,+LEXEX,5,"B",LEXT,LEXL)=""
"RTN","LEX2055H",102,0)
 . S ^LEX(757.01,+LEXEX,5,0)="^757.18^"_LEXL_"^"_LEXL
"RTN","LEX2055H",103,0)
 . K:'$L(LEXL) LEXALL
"RTN","LEX2055H",104,0)
 Q
"RTN","LEX2055H",105,0)
SUP ;   Supplemental Words
"RTN","LEX2055H",106,0)
 ;;6
"RTN","LEX2055H",107,0)
 ;;BIRADS
"RTN","LEX2055H",108,0)
 ;;MAMMOGRAM
"RTN","LEX2055H",109,0)
 ;;MAMMOGRAPHY
"RTN","LEX2055H",110,0)
 ;;MAMMOGRAPHIC
"RTN","LEX2055H",111,0)
 ;;BREASTS
"RTN","LEX2055H",112,0)
 ;;ASSESSMENT
"RTN","LEX2055H",113,0)
 ;;IS
"RTN","LEX2055H",114,0)
 ;;CATEGORIES
"RTN","LEX2055H",115,0)
 ;;CATEGORY
"RTN","LEX2055H",116,0)
 ;;RESULTS
"RTN","LEX2055H",117,0)
 ;;PRESENT
"RTN","LEX2055H",118,0)
 ;;COMPLETE
"RTN","LEX2055H",119,0)
 ;;FINAL
"RTN","LEX2055H",120,0)
 ;;CALCIFICATIONS
"RTN","LEX2055H",121,0)
 ;;CALCIFIED
"RTN","LEX2055H",122,0)
 ;;MASSESS
"RTN","LEX2055H",123,0)
 ;;MALIGNANT
"RTN","LEX2055H",124,0)
 ;;MALIGNANCY
"RTN","LEX2055H",125,0)
 ;;EVALUATION
"RTN","LEX2055H",126,0)
 ;;BIOPSY
"RTN","LEX2055H",127,0)
 ;;MANAGEMENT
"RTN","LEX2055H",128,0)
 ;;ADMINISTERED
"RTN","LEX2055H",129,0)
 ;;ADMINISTRATION
"RTN","LEX2055H",130,0)
 ;;CARCINOMA
"RTN","LEX2055H",131,0)
 ;;EVALUATION
"RTN","LEX2055H",132,0)
 ;;MASTECTOMY
"RTN","LEX2055H",133,0)
 ;;TREATMENT
"RTN","LEX2055H",134,0)
 ;;ONCOLOGY
"RTN","LEX2055H",135,0)
 ;;ONCOLOGIC
"RTN","LEX2055H",136,0)
 ;;THERAPY
"RTN","LEX2055H",137,0)
 ;;THERAPIES
"RTN","LEX2055H",138,0)
 ;;CHEMOTHERAPY
"RTN","LEX2055H",139,0)
 ;;SURIGICAL
"RTN","LEX2055H",140,0)
 ;;EXCISION
"RTN","LEX2055H",141,0)
 ;;RADIATION
"RTN","LEX2055H",142,0)
 ;;TISSUE
"RTN","LEX2055H",143,0)
 ;;SAMPLE
"RTN","LEX2055H",144,0)
 ;;SAMPLING
"RTN","LEX2055H",145,0)
 ;;CANCER
"RTN","LEX2055H",146,0)
 ;;CARCINOMA
"RTN","LEX2055H",147,0)
 ;;CONFIRM
"RTN","LEX2055H",148,0)
 ;;DEFINITIVE
"RTN","LEX2055H",149,0)
 ;;DETECTION
"RTN","LEX2055H",150,0)
 ;;NEOADJUVANT
"RTN","LEX2055H",151,0)
 ;;PREVIOUS
"RTN","LEX2055H",152,0)
 ;;PRIOR
"RTN","LEX2055H",153,0)
 ;;BI
"RTN","LEX2055H",154,0)
 ;;RADS
"RTN","LEX2055H",155,0)
 ;;;;
"RTN","LEX2055H",156,0)
 Q
"RTN","LEX2055H",157,0)
 ;               
"RTN","LEX2055H",158,0)
UNIN ; Un-Install Category 6
"RTN","LEX2055H",159,0)
 D MES^XPDUTL("   Removing BI-RADS/FDA Mammography Category 6")
"RTN","LEX2055H",160,0)
 N DA,DIK,LEXEX,LEXFQ,LEXMC,LEXME,LEXMCE,LEXSM,LEXSO
"RTN","LEX2055H",161,0)
 S LEXMC=186442
"RTN","LEX2055H",162,0)
 S LEXME=336113
"RTN","LEX2055H",163,0)
 S LEXMCE=LEXME F LEXEX=91,92 D
"RTN","LEX2055H",164,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.01,+LEXEX,5,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",165,0)
 . . N LEXW S LEXW=$G(^LEX(757.01,+LEXEX,5,LEXI,0)) Q:'$L(LEXW)
"RTN","LEX2055H",166,0)
 . . K ^LEX(757.01,"AWRD",LEXW,LEXEX,LEXMCE,LEXI)
"RTN","LEX2055H",167,0)
 . . N DA,DIK S DA=LEXI,DA(1)=LEXEX,DIK="^LEX(757.01,"_DA(1)_",5," D ^DIK
"RTN","LEX2055H",168,0)
 S LEXEX=91
"RTN","LEX2055H",169,0)
 S LEXSO=3824
"RTN","LEX2055H",170,0)
 S LEXSM=24604
"RTN","LEX2055H",171,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055H",172,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055H",173,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055H",174,0)
 S LEXEX=92
"RTN","LEX2055H",175,0)
 S LEXSO=3825
"RTN","LEX2055H",176,0)
 S LEXSM=24605
"RTN","LEX2055H",177,0)
 S DA=LEXSM,DIK="^LEX(757.1," D ^DIK
"RTN","LEX2055H",178,0)
 S DA=LEXSO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2055H",179,0)
 S DA=LEXEX,DIK="^LEX(757.01," D ^DIK
"RTN","LEX2055H",180,0)
 Q
"RTN","LEX2055H",181,0)
 ;               
"RTN","LEX2055H",182,0)
 ; Miscellaneous
"RTN","LEX2055H",183,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055H",184,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055H",185,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055H",186,0)
 Q X
"RTN","LEX2055H",187,0)
SH ;   Show New Records
"RTN","LEX2055H",188,0)
 N LEXI,LEXIO,LEXIN,LEXNN,LEXNC,LEXN1,LEXND,LEXM,LEXMC,LEXME,LEX S LEX=0
"RTN","LEX2055H",189,0)
 S LEXMC=186442
"RTN","LEX2055H",190,0)
 S LEXME=336113
"RTN","LEX2055H",191,0)
 S LEXI=LEXMC S LEXNN="^LEX(757,"_LEXI_")",LEXNC="^LEX(757,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055H",192,0)
 W:LEX>0 ! S LEX=0 S LEXI=LEXMC S LEXNN="^LEX(757.001,"_LEXI_")",LEXNC="^LEX(757.001,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055H",193,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.01,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",194,0)
 . S LEXNN="^LEX(757.01,"_LEXI_")",LEXNC="^LEX(757.01,"_LEXI_",",LEXN1="^LEX(757.01,"_LEXI_",1"
"RTN","LEX2055H",195,0)
 . F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055H",196,0)
 . . Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",2,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",3,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",4,"))  Q:'$D(LEXALL)&(LEXNN[(","_LEXI_",5,"))
"RTN","LEX2055H",197,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055H",198,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055H",199,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXIO="",LEXI=0 F  S LEXI=$O(^LEX(757.02,"AMC",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",200,0)
 . S LEXNN="^LEX(757.02,"_LEXI_")",LEXNC="^LEX(757.02,"_LEXI_"," F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2055H",201,0)
 . . Q:'$D(LEXALL)&($P(LEXNN,",",4)="""B""")
"RTN","LEX2055H",202,0)
 . . S LEXIN=+($P(LEXNN,",",2)) I +LEXIN>0,+LEXIN'=+($G(LEXIO)) W ! S LEXIO=+LEXIN
"RTN","LEX2055H",203,0)
 . . W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055H",204,0)
 W:LEX>0 ! S LEXM=LEXMC S LEXI=0 F  S LEXI=$O(^LEX(757.1,"B",LEXM,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055H",205,0)
 . S LEXNN="^LEX(757.1,"_LEXI_")",LEXNC="^LEX(757.1,"_LEXI_",0" F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  W !,LEXNN,"=",@LEXNN S LEX=LEX+1
"RTN","LEX2055H",206,0)
 W:LEX>0 !
"RTN","LEX2055H",207,0)
 Q
"RTN","LEX2055I")
0^10^B125880515
"RTN","LEX2055I",1,0)
LEX2055I ;ISL/KER - BI-RADS/FDA Mammography ;11/30/2008
"RTN","LEX2055I",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055I",3,0)
 ;               
"RTN","LEX2055I",4,0)
 ; Global Variables
"RTN","LEX2055I",5,0)
 ;    None
"RTN","LEX2055I",6,0)
 ;               
"RTN","LEX2055I",7,0)
 ; External References
"RTN","LEX2055I",8,0)
 ;    FILE^DIE            ICR   2053
"RTN","LEX2055I",9,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055I",10,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2055I",11,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055I",12,0)
 ;               
"RTN","LEX2055I",13,0)
 Q
"RTN","LEX2055I",14,0)
INST ; Install
"RTN","LEX2055I",15,0)
 N DA,DIE,DIK,LEXCUR,LEXFDA,LEXI,LEXIEN,LEXIENS,LEXN,LEXO,LEXT,X,Y
"RTN","LEX2055I",16,0)
 D:'$D(LEXUNIN) BMES^XPDUTL("   Updating Existing Mammography Related Expressions            file #757.01")
"RTN","LEX2055I",17,0)
 ;
"RTN","LEX2055I",18,0)
 N LEXO,LEXN,LEXI
"RTN","LEX2055I",19,0)
 ;
"RTN","LEX2055I",20,0)
 S LEXO="Mammogram Assessment Category of Incomplete: Need Additional Imaging Evaluation, Documented (Rad)5"
"RTN","LEX2055I",21,0)
 S LEXN="Mammogram Assessment Category of Incomplete: Need Additional Imaging Evaluation, Documented"
"RTN","LEX2055I",22,0)
 S LEXI=336107
"RTN","LEX2055I",23,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",24,0)
 ;
"RTN","LEX2055I",25,0)
 S LEXO="Mammogram Assessment Category of Negative, Documented (Rad)5"
"RTN","LEX2055I",26,0)
 S LEXN="Mammogram Assessment Category of Negative, Documented"
"RTN","LEX2055I",27,0)
 S LEXI=336108
"RTN","LEX2055I",28,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",29,0)
 ;
"RTN","LEX2055I",30,0)
 S LEXO="Mammogram Assessment Category of Benign, Documented (Rad)5"
"RTN","LEX2055I",31,0)
 S LEXN="Mammogram Assessment Category of Benign, Documented"
"RTN","LEX2055I",32,0)
 S LEXI=336109
"RTN","LEX2055I",33,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",34,0)
 ;
"RTN","LEX2055I",35,0)
 S LEXO="Mammogram Assessment Category of Probably Benign, Documented (Rad)5"
"RTN","LEX2055I",36,0)
 S LEXN="Mammogram Assessment Category of Probably Benign, Documented"
"RTN","LEX2055I",37,0)
 S LEXI=336110
"RTN","LEX2055I",38,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",39,0)
 ;
"RTN","LEX2055I",40,0)
 S LEXO="Mammogram Assessment Category of Suspicious, Documented (Rad)5"
"RTN","LEX2055I",41,0)
 S LEXN="Mammogram Assessment Category of Suspicious, Documented"
"RTN","LEX2055I",42,0)
 S LEXI=336111
"RTN","LEX2055I",43,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",44,0)
 ;
"RTN","LEX2055I",45,0)
 S LEXO="Mammogram Assessment Category of Highly Suggestive of Malignancy, Documented (Rad)5"
"RTN","LEX2055I",46,0)
 S LEXN="Mammogram Assessment Category of Highly Suggestive of Malignancy, Documented"
"RTN","LEX2055I",47,0)
 S LEXI=336112
"RTN","LEX2055I",48,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",49,0)
 ;
"RTN","LEX2055I",50,0)
 S LEXO="Mammogram Assessment Category of Known Biopsy Proven Malignancy, Documented (Rad)5"
"RTN","LEX2055I",51,0)
 S LEXN="Mammogram Assessment Category of Known Biopsy Proven Malignancy, Documented"
"RTN","LEX2055I",52,0)
 S LEXI=336113
"RTN","LEX2055I",53,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",54,0)
 ;
"RTN","LEX2055I",55,0)
 ;------------------------------
"RTN","LEX2055I",56,0)
 S LEXO="BIOPSY Device, 11 Gauge Mammotome Probe with vacuum Cannister"
"RTN","LEX2055I",57,0)
 S LEXN="Biopsy Device, 11 Gauge Mammotome Probe with Vacuum Cannister"
"RTN","LEX2055I",58,0)
 S LEXI=322950
"RTN","LEX2055I",59,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",60,0)
 ;
"RTN","LEX2055I",61,0)
 S LEXO="BIOPSY Device, 14-gauge Mammotome Probe with vacuum Cannister"
"RTN","LEX2055I",62,0)
 S LEXN="Biopsy Device, 14 Gauge Mammotome Probe with Vacuum Cannister"
"RTN","LEX2055I",63,0)
 S LEXI=322952
"RTN","LEX2055I",64,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",65,0)
 ;
"RTN","LEX2055I",66,0)
 S LEXO="BIOPSY Device, Mammotome HH hand-held Probe with Smartvac vacuum System"
"RTN","LEX2055I",67,0)
 S LEXN="Biopsy Device, Mammotome HH Hand-Held Probe with Smartvac Vacuum System"
"RTN","LEX2055I",68,0)
 S LEXI=322949
"RTN","LEX2055I",69,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",70,0)
 ;
"RTN","LEX2055I",71,0)
 S LEXO="Clinician did not provide Care to Patient for the Required time of MAMMOGRAPHY Measure (I.e., Measurement Year or Prior Year)"
"RTN","LEX2055I",72,0)
 S LEXN="Clinician did not provide care to Patient for the required time of Mammography Measure (i.e., Measurement Year or Prior Year)"
"RTN","LEX2055I",73,0)
 S LEXI=333758
"RTN","LEX2055I",74,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",75,0)
 ;
"RTN","LEX2055I",76,0)
 S LEXO="Clinician documented that female Patient was not An Eligible Candidate for MAMMOGRAPHY Measure"
"RTN","LEX2055I",77,0)
 S LEXN="Clinician documented that female Patient was not an eligible candidate for Mammography Measure"
"RTN","LEX2055I",78,0)
 S LEXI=333757
"RTN","LEX2055I",79,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",80,0)
 ;
"RTN","LEX2055I",81,0)
 S LEXO="COMPUTER-AIDED DETECTION WITH FURTHER PHYSICIAN REVIEW FOR INTERPRETATION, WITH OR WITHOUT DIGITIZATION OF FILM RADIOGRAPHIC IMAGES; SCREENING MAMMOGRAPHY"
"RTN","LEX2055I",82,0)
 S LEXN="Computer-Aided Detection with further Physician review for Interpretation, with or without Digitization of Film Radiographic Images; Screening Mammography"
"RTN","LEX2055I",83,0)
 S LEXI=334511
"RTN","LEX2055I",84,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",85,0)
 ;
"RTN","LEX2055I",86,0)
 S LEXO="COMPUTER-AIDED DETECTION WITH FURTHER PHYSICIAN REVIEW FOR INTERPRETATION, WITH OR WITHOUT DIGITIZATION OF FILM RADIOGRAPHIC IMAGES; DIAGNOSTIC MAMMOGRAPHY"
"RTN","LEX2055I",87,0)
 S LEXN="Computer-Aided Detection with further Physician review for Interpretation, with or without Digitization of Film Radiographic Images; Diagnostic Mammography"
"RTN","LEX2055I",88,0)
 S LEXI=334510
"RTN","LEX2055I",89,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",90,0)
 ;
"RTN","LEX2055I",91,0)
 S LEXO="Diagnostic MAMMOGRAPHY, Producing Direct Digital Image, unilateral, ALL views"
"RTN","LEX2055I",92,0)
 S LEXN="Diagnostic Mammography, producing Direct Digital Image, Unilateral, all views"
"RTN","LEX2055I",93,0)
 S LEXI=324482
"RTN","LEX2055I",94,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",95,0)
 ;
"RTN","LEX2055I",96,0)
 S LEXO="Diagnostic MAMMOGRAPHY, Producing Direct Digital Image, Bilateral, ALL views"
"RTN","LEX2055I",97,0)
 S LEXN="Diagnostic Mammography, producing Direct Digital Image, Bilateral, all views"
"RTN","LEX2055I",98,0)
 S LEXI=324481
"RTN","LEX2055I",99,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",100,0)
 ;
"RTN","LEX2055I",101,0)
 S LEXO="Digitization of Film Radiographic Images with Computer Analysis for lesion Detection and further Physician Review for interpretation, MAMMOGRAPHY (List separately in Addition to Code for primary Procedure)"
"RTN","LEX2055I",102,0)
 S LEXN="Digitization of Film Radiographic Images with Computer Analysis for Lesion Detection and further Physician Review for Interpretation, Mammography (list separately in addition to code for primary procedure)"
"RTN","LEX2055I",103,0)
 S LEXI=329114
"RTN","LEX2055I",104,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",105,0)
 ;
"RTN","LEX2055I",106,0)
 S LEXO="Digitization of Film Radiographic Images with Computer Analysis for lesion Detection, or Computer Analysis of Digital Mammogram for lesion Detection, and  further Physician Review for interpretation, Diagnostic MAMMOGRAPHY"
"RTN","LEX2055I",107,0)
 S LEXN="Digitization of Film Radiographic Images with Computer Analysis for Lesion Detection, or Computer Analysis of Digital Mammogram for Lesion Detection, and further Physician Review for Interpretation, Diagnostic Mammography"
"RTN","LEX2055I",108,0)
 S LEXI=329823
"RTN","LEX2055I",109,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",110,0)
 ;
"RTN","LEX2055I",111,0)
 S LEXO="Digitization of Film Radiographic Images with Computer Analysis for lesion detection and further physician review for interpretation, diagnostic mammography"
"RTN","LEX2055I",112,0)
 S LEXN="Digitization of Film Radiographic Images with Computer Analysis for Lesion Detection and further Physician Review for Interpretation, Diagnostic Mammography"
"RTN","LEX2055I",113,0)
 S LEXI=324508
"RTN","LEX2055I",114,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",115,0)
 ;
"RTN","LEX2055I",116,0)
 S LEXO="Digitization of Film Radiographic Images with Computer Analysis for lesion Detection and further Physician Review for interpretation, Screening MAMMOGRAPHY"
"RTN","LEX2055I",117,0)
 S LEXN="Digitization of Film Radiographic Images with Computer Analysis for Lesion Detection and further Physician Review for Interpretation, Screening Mammography"
"RTN","LEX2055I",118,0)
 S LEXI=323830
"RTN","LEX2055I",119,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",120,0)
 ;
"RTN","LEX2055I",121,0)
 S LEXO="Findings from Diagnostic Mammogram Communicated to Practice Managing Patients on-Going Care within 3 Business Days of Exam Interpretation (Rad)5"
"RTN","LEX2055I",122,0)
 S LEXN="Findings from Diagnostic Mammogram Communicated to practice managing Patients on-going care within 3 business days of Exam Interpretation (Rad) 5"
"RTN","LEX2055I",123,0)
 S LEXI=336151
"RTN","LEX2055I",124,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",125,0)
 ;
"RTN","LEX2055I",126,0)
 S LEXO="Findings from Diagnostic Mammogram Communicated to the Patient within 5 Days of Exam Interpretation (Rad)5"
"RTN","LEX2055I",127,0)
 S LEXN="Findings from Diagnostic Mammogram Communicated to the Patient within 5 days of Exam Interpretation (Rad) 5"
"RTN","LEX2055I",128,0)
 S LEXI=336152
"RTN","LEX2055I",129,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",130,0)
 ;
"RTN","LEX2055I",131,0)
 S LEXO="Mammogram Assessment Category [eg, Mqsa, Bi-Rads, or FDA Approved Equivalent] Entered into a Database for Analysis of Abnormal Interpretation Rate (Rad)5"
"RTN","LEX2055I",132,0)
 S LEXN="Mammogram Assessment Category [eg, MQSA, BI-RADS, or FDA Approved Equivalent] Entered into a Database for Analysis of Abnormal Interpretation Rate"
"RTN","LEX2055I",133,0)
 S LEXI=336157,^LEX(757.01,LEXI,5,0)="^757.18^2^2",^LEX(757.01,LEXI,5,1,0)="BIRADS"
"RTN","LEX2055I",134,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",135,0)
 ;
"RTN","LEX2055I",136,0)
 S LEXO="MAMMOGRAPHIC GUIDANCE FOR NEEDLE PLACEMENT, BREAST (EG, FOR WIRE LOCALIZATION OR FOR INJECTION), EACH LESION, RADIOLOGICAL SUPERVISION AND INTERPRETATION"
"RTN","LEX2055I",137,0)
 S LEXN="Mammographic Guidance for Needle Placement, Breast (eg, for wire localization or for injection), each Lesion, Radiological Supervision and Interpretation"
"RTN","LEX2055I",138,0)
 S LEXI=334509
"RTN","LEX2055I",139,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",140,0)
 ;
"RTN","LEX2055I",141,0)
 S LEXO="MAMMOGRAPHY; BILATERAL"
"RTN","LEX2055I",142,0)
 S LEXN="Mammography:  Bilateral"
"RTN","LEX2055I",143,0)
 S LEXI=334515
"RTN","LEX2055I",144,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",145,0)
 ;
"RTN","LEX2055I",146,0)
 S LEXO="MAMMOGRAPHY; UNILATERAL"
"RTN","LEX2055I",147,0)
 S LEXN="Mammography:  Unilateral"
"RTN","LEX2055I",148,0)
 S LEXI=334514
"RTN","LEX2055I",149,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",150,0)
 ;
"RTN","LEX2055I",151,0)
 S LEXO="Patient (female) documented to have Received A Mammogram during the Measurement Year or Prior Year to the Measurement Year"
"RTN","LEX2055I",152,0)
 S LEXN="Patient (female) documented to have received a Mammogram during the Measurement Year or prior Year to the Measurement Year"
"RTN","LEX2055I",153,0)
 S LEXI=333755
"RTN","LEX2055I",154,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",155,0)
 ;
"RTN","LEX2055I",156,0)
 S LEXO="Patient (female) not documented to have Received A Mammogram during the Measurement Year or Prior Year to the Measurement Year"
"RTN","LEX2055I",157,0)
 S LEXN="Patient (female) not documented to have received a Mammogram during the Measurement Year or prior Year to the Measurement Year"
"RTN","LEX2055I",158,0)
 S LEXI=333756
"RTN","LEX2055I",159,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",160,0)
 ;
"RTN","LEX2055I",161,0)
 S LEXO="Patient Information Entered into a Reminder System with a Target due Date for the Next Mammogram (Rad)5"
"RTN","LEX2055I",162,0)
 S LEXN="Patient information entered into a Reminder System with a target due date for the next Mammogram (Rad) 5"
"RTN","LEX2055I",163,0)
 S LEXI=336158
"RTN","LEX2055I",164,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",165,0)
 ;
"RTN","LEX2055I",166,0)
 S LEXO="Screening MAMMOGRAPHY, Producing Direct Digital Image, Bilateral, ALL views"
"RTN","LEX2055I",167,0)
 S LEXN="Screening Mammography, producing Direct Digital Image, Bilateral, all views"
"RTN","LEX2055I",168,0)
 S LEXI=324480
"RTN","LEX2055I",169,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",170,0)
 ;
"RTN","LEX2055I",171,0)
 S LEXO="Screening MAMMOGRAPHY Results documented and Reviewed (PV1)"
"RTN","LEX2055I",172,0)
 S LEXN="Screening Mammography results Documented and Reviewed (PV1)"
"RTN","LEX2055I",173,0)
 S LEXI=333977
"RTN","LEX2055I",174,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",175,0)
 ;
"RTN","LEX2055I",176,0)
 S LEXO="SCREENING MAMMOGRAPHY, BILATERAL (2-VIEW FILM STUDY OF EACH BREAST)"
"RTN","LEX2055I",177,0)
 S LEXN="Screening Mammography, Bilateral (2 view film study of each Breast)"
"RTN","LEX2055I",178,0)
 S LEXI=334516
"RTN","LEX2055I",179,0)
 D ED(LEXI,LEXO,LEXN)
"RTN","LEX2055I",180,0)
 Q
"RTN","LEX2055I",181,0)
 ;               
"RTN","LEX2055I",182,0)
UNIN ; Un-Install
"RTN","LEX2055I",183,0)
 N LEXUNIN S LEXUNIN="" D MES^XPDUTL("   Restoring Mammography Related Expressions"),INST
"RTN","LEX2055I",184,0)
 Q
"RTN","LEX2055I",185,0)
ED(X,LEXO,LEXN) ; Edit
"RTN","LEX2055I",186,0)
 N DA,DIK,DIE,LEXCUR,LEXFDA,LEXIEN,LEXIENS,LEXT
"RTN","LEX2055I",187,0)
 S (DA,LEXIEN)=+($G(X)) Q:'$L(^LEX(757.01,+LEXIEN,0))  S LEXIENS=LEXIEN_",",LEXCUR=$G(^LEX(757.01,+LEXIEN,0))
"RTN","LEX2055I",188,0)
 S LEXO=$G(LEXO) Q:'$L(LEXO)  S LEXN=$G(LEXN) Q:'$L(LEXN)  Q:LEXO=LEXN  I $D(LEXUNIN) S LEXT=LEXO,LEXO=LEXN,LEXN=LEXT
"RTN","LEX2055I",189,0)
 Q:LEXN=LEXCUR  S LEXFDA(757.01,LEXIENS,.01)=LEXN D FILE^DIE("","LEXFDA") S DA=LEXIEN,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055I",190,0)
 Q
"RTN","LEX2055I",191,0)
 ;               
"RTN","LEX2055I",192,0)
 ; Miscellaneous
"RTN","LEX2055I",193,0)
TM(X,Y) ;   Trim Character
"RTN","LEX2055I",194,0)
 S X=$G(X),Y=$G(Y) Q:'$L(X) X  S:'$L(Y) Y=" " F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LEX2055I",195,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LEX2055I",196,0)
 Q X
"RTN","LEX2055P")
0^1^B22882820
"RTN","LEX2055P",1,0)
LEX2055P ;ISL/KER - LEX*2.0*55 Pre/Post Install ;11/30/2008
"RTN","LEX2055P",2,0)
 ;;2.0;LEXICON UTILITY;**55**;Sep 23, 1996;Build 11
"RTN","LEX2055P",3,0)
 ;               
"RTN","LEX2055P",4,0)
 ; Integration Control Registrations/Standards and Conventions
"RTN","LEX2055P",5,0)
 ;               
"RTN","LEX2055P",6,0)
 ;    ^LEX(757            N/A  Major Concept Map
"RTN","LEX2055P",7,0)
 ;    ^LEX(757.001)       N/A  Concept Usage
"RTN","LEX2055P",8,0)
 ;    ^LEX(757.01         N/A  Expressions
"RTN","LEX2055P",9,0)
 ;    ^LEX(757.02)        N/A  Codes
"RTN","LEX2055P",10,0)
 ;    ^LEX(757.03)        N/A  Coding System
"RTN","LEX2055P",11,0)
 ;    ^LEX(757.1)         N/A  Semantic Map
"RTN","LEX2055P",12,0)
 ;    ^LEX(757.11)        N/A  Semantic Class
"RTN","LEX2055P",13,0)
 ;    ^LEX(757.12)        N/A  Semantic Type
"RTN","LEX2055P",14,0)
 ;    ^LEX(757.13)        N/A  Source Categories
"RTN","LEX2055P",15,0)
 ;    ^LEX(757.14)        N/A  Source
"RTN","LEX2055P",16,0)
 ;    ^LEXT(757.2)        N/A  Subset Definition
"RTN","LEX2055P",17,0)
 ;               
"RTN","LEX2055P",18,0)
 ;    ^TMP(               SACC 2.3.2.5.1
"RTN","LEX2055P",19,0)
 ;    ^%ZOSF("TEST")      ICR  10096
"RTN","LEX2055P",20,0)
 ;    ^%ZOSF("DEL")       ICR  10096
"RTN","LEX2055P",21,0)
 ;    ^DIK                ICR  10013
"RTN","LEX2055P",22,0)
 ;    IX1^DIK             ICR  10013
"RTN","LEX2055P",23,0)
 ;    $$GET1^DIQ          ICR   2056
"RTN","LEX2055P",24,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","LEX2055P",25,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEX2055P",26,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEX2055P",27,0)
 ;    $$DTIME^XUP         ICR   4490
"RTN","LEX2055P",28,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2055P",29,0)
 ;    HOME^%ZIS           ICR  10086
"RTN","LEX2055P",30,0)
 ;               
"RTN","LEX2055P",31,0)
 ; Local Variables NEWed or KILLed Elsewhere
"RTN","LEX2055P",32,0)
 ;     DT,DTIME,DUZ,U,XPDABORT,XPDQUIT
"RTN","LEX2055P",33,0)
 ;            
"RTN","LEX2055P",34,0)
ENV ;   Environment Check
"RTN","LEX2055P",35,0)
 N LEXREQP,LEXPAT,LEXI,LEXPN,LEXBUILD S LEXPAT="LEX*2.0*56",LEXBUILD="LEX*2.0*55"
"RTN","LEX2055P",36,0)
 S LEXPN=$$PATCH^XPDUTL(LEXPAT) W !,"    Checking for ",LEXPAT I +LEXPN>0 H 1 W " - installed"
"RTN","LEX2055P",37,0)
 I +LEXPN'>0 D ET(" "),ET((LEXPAT_" not found, please install "_LEXPAT_" before continuing"))
"RTN","LEX2055P",38,0)
 I $D(LEXE) D ABRT Q
"RTN","LEX2055P",39,0)
 Q
"RTN","LEX2055P",40,0)
POK(X) ;   Patch is OK
"RTN","LEX2055P",41,0)
 N LEXPAT S LEXPAT=$G(X) Q:'$L(LEXPAT) 1
"RTN","LEX2055P",42,0)
 S X=+($$PATCH^XPDUTL(LEXPAT))
"RTN","LEX2055P",43,0)
 Q X
"RTN","LEX2055P",44,0)
ET(X) ;   Error Text
"RTN","LEX2055P",45,0)
 N LEXI S LEXI=+($G(LEXE(0))),LEXI=LEXI+1,LEXE(LEXI)="    "_$G(X),LEXE(0)=LEXI
"RTN","LEX2055P",46,0)
 Q
"RTN","LEX2055P",47,0)
ED ;   Error Display
"RTN","LEX2055P",48,0)
 N LEXI S LEXI=0 F  S LEXI=$O(LEXE(LEXI)) Q:+LEXI=0  D MES^XPDUTL(LEXE(LEXI))
"RTN","LEX2055P",49,0)
 D MES^XPDUTL(" ") K LEXE
"RTN","LEX2055P",50,0)
 Q
"RTN","LEX2055P",51,0)
QUIT ;     Quit   Passed Environment Check
"RTN","LEX2055P",52,0)
 K LEXFULL D OK
"RTN","LEX2055P",53,0)
 Q
"RTN","LEX2055P",54,0)
EXIT ;     Exit   Failed Environment Check
"RTN","LEX2055P",55,0)
 D:$D(LEXE) ED S XPDQUIT=2 K LEXE,LEXFULL Q
"RTN","LEX2055P",56,0)
ABRT ;     Abort  Failed Environment Check, KILL the distribution
"RTN","LEX2055P",57,0)
 D:$D(LEXE) ED S XPDABORT=1,XPDQUIT=1,XPDQUIT("LEX*2.0*55")=1
"RTN","LEX2055P",58,0)
 K LEXE,LEXFULL
"RTN","LEX2055P",59,0)
 Q
"RTN","LEX2055P",60,0)
OK ;   Environment is OK
"RTN","LEX2055P",61,0)
 N LEXT S LEXT="  Environment "_$S($L(LEXBUILD):("for patch/build "_LEXBUILD_" "),1:"")_"is ok"
"RTN","LEX2055P",62,0)
 D BMES^XPDUTL(LEXT),MES^XPDUTL(" ")
"RTN","LEX2055P",63,0)
 Q
"RTN","LEX2055P",64,0)
POST ; LEX*2.0*55 Post-Install
"RTN","LEX2055P",65,0)
 N ENV,EXC,LEXBEG,LEXBLD,LEXBUILD,LEXELP,LEXEND,LEXFC,LEXI,LEXID,LEXMOD,LEXMUL,LEXNM,LEXPOST,LEXRTN
"RTN","LEX2055P",66,0)
 N LEXSHORT,LEXSUB,LEXT,LEXTCS,LEXTND,X,ZTQUEUED,ZTREQ
"RTN","LEX2055P",67,0)
 S ENV=$$SET Q:'ENV  S LEXBEG=$$NOW^XLFDT
"RTN","LEX2055P",68,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J),^TMP("LEXINS",$J),^TMP("LEXKID",$J)
"RTN","LEX2055P",69,0)
 D INST I $D(^%ZOSF("DEL")) F LEXRTN="LEX2055A","LEX2055B","LEX2055C","LEX2055D","LEX2055E","LEX2055F","LEX2055G","LEX2055H","LEX2055I" D
"RTN","LEX2055P",70,0)
 . N EXC,X,Y I +($$ROK(LEXRTN))>0 S (EXC,X)=$G(^%ZOSF("DEL")) D ^DIM I $D(X) S X=LEXRTN X EXC
"RTN","LEX2055P",71,0)
 S LEXSHORT=1,(LEXID,LEXSUB)="LEXKID",(LEXBUILD,LEXBLD)="LEX*2.0*55",LEXPOST=1
"RTN","LEX2055P",72,0)
 S LEXEND=$$NOW^XLFDT,LEXELP=$$EP^LEXXII(LEXBEG,LEXEND)
"RTN","LEX2055P",73,0)
 D MSG
"RTN","LEX2055P",74,0)
 Q
"RTN","LEX2055P",75,0)
MSG ;   Send a Install Message
"RTN","LEX2055P",76,0)
 S:$D(ZTQUEUED) ZTREQ="@"  N LEXFC,LEXMOD,LEXMUL,LEXTCS,LEXTND,ZTQUEUED,LEXT,LEXI S LEXMUL=1,(LEXTND,LEXTCS,LEXMOD,LEXFC,ZTQUEUED)=0
"RTN","LEX2055P",77,0)
 D HDR^LEXXFI,EN^LEXXII I $L($G(LEXID)) S LEXI=0 F  S LEXI=$O(^TMP(LEXID,$J,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2055P",78,0)
 . S:$G(^TMP(LEXID,$J,LEXI))=" Lexicon/ICD/CPT Installation" ^TMP(LEXID,$J,LEXI)=" BI-RADS Mammography Assessment Code Set",^TMP(LEXID,$J,(LEXI+1))=" ======================================="
"RTN","LEX2055P",79,0)
 I $G(LEXBEG)?7N1".".N S LEXT="" S LEXT="  Started:     "_$TR($$FMTE^XLFDT($G(LEXBEG),"1Z"),"@"," ") D TL^LEXXII(LEXT)
"RTN","LEX2055P",80,0)
 I $G(LEXEND)?7N1".".N S LEXT="" S LEXT="  Finished:    "_$TR($$FMTE^XLFDT($G(LEXEND),"1Z"),"@"," ") D TL^LEXXII(LEXT)
"RTN","LEX2055P",81,0)
 I $G(LEXBEG)?7N1".".N!$G(LEXEND)?7N1".".N!($L($G(LEXELP))&($G(LEXELP)[":")) S LEXT="" S LEXT="  Elapsed:     "_$$ED^LEXXII($G(LEXELP)) D TL^LEXXII(LEXT),BL^LEXXII
"RTN","LEX2055P",82,0)
 D MAIL^LEXXFI,KILL^LEXXFI
"RTN","LEX2055P",83,0)
 Q
"RTN","LEX2055P",84,0)
INST ; Install Patch LEX*2.0*55
"RTN","LEX2055P",85,0)
 D:+($$ROK("LEX2055A"))>0 INST^LEX2055A D CON
"RTN","LEX2055P",86,0)
 Q
"RTN","LEX2055P",87,0)
ROK(X) ; Routine OK
"RTN","LEX2055P",88,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1
"RTN","LEX2055P",89,0)
 Q 0
"RTN","LEX2055P",90,0)
CON ; Data Convversion
"RTN","LEX2055P",91,0)
 N LEX55W S LEX55W="BARRES~" F  S LEX55W=$O(^LEX(757.01,"AWRD",LEX55W)) Q:'$L(LEX55W)  Q:LEX55W'["BARRET"  D
"RTN","LEX2055P",92,0)
 . N LEX55C S LEX55C=0 F  S LEX55C=$O(^LEX(757.01,"AWRD",LEX55W,LEX55C)) Q:+LEX55C'>0  D
"RTN","LEX2055P",93,0)
 . . N LEX55E S LEX55E=0 F  S LEX55E=$O(^LEX(757.01,"AWRD",LEX55W,LEX55C,LEX55E)) Q:+LEX55E'>0  D
"RTN","LEX2055P",94,0)
 . . . N DA,DIK S DA=LEX55E,DIK="^LEX(757.01," D IX1^DIK
"RTN","LEX2055P",95,0)
 Q
"RTN","LEX2055P",96,0)
SET(X) ; Setup Environment
"RTN","LEX2055P",97,0)
 D HOME^%ZIS S U="^",DT=$$DT^XLFDT,LEXNM=$$GET1^DIQ(200,+($G(DUZ)),.01),DTIME=$$DTIME^XUP(+($G(DUZ))) Q:+($G(DUZ))'>0!('$L(LEXNM)) 0
"RTN","LEX2055P",98,0)
 Q 1
"RTN","LEXA")
0^11^B42625550
"RTN","LEXA",1,0)
LEXA ;ISA/FJF/KER - Look-up (Silent) ;11/30/2008
"RTN","LEXA",2,0)
 ;;2.0;LEXICON UTILITY;**3,4,6,19,25,36,38,43,55**;Sep 23, 1996;Build 11
"RTN","LEXA",3,0)
 ;
"RTN","LEXA",4,0)
 ; External References
"RTN","LEXA",5,0)
 ;   ^TMP(               SACC 2.3.2.5.1
"RTN","LEXA",6,0)
 ;   ^VA(200,            ICR  10060
"RTN","LEXA",7,0)
 ;   ^DIM                ICR  10016
"RTN","LEXA",8,0)
 ;   $$DT^XLFDT          ICR  10103
"RTN","LEXA",9,0)
 ;   $$UP^XLFSTR         ICR  10104
"RTN","LEXA",10,0)
 ;                   
"RTN","LEXA",11,0)
 ; Look-up  D LOOK^LEXA(LEXX,LEXAP,LEXLL,LEXSUB,lexvdt)
"RTN","LEXA",12,0)
 ;                   
"RTN","LEXA",13,0)
 ;         LEXX      User Input
"RTN","LEXA",14,0)
 ;         LEXAP     Application
"RTN","LEXA",15,0)
 ;         LEXLL     Selection List Length
"RTN","LEXA",16,0)
 ;         LEXSUB    Mode/Subset (file 757.2)
"RTN","LEXA",17,0)
 ;         LEXVDT    Date to use for retrieving/displaying codes
"RTN","LEXA",18,0)
 ;         LEXXSR    Source (file 757.14)
"RTN","LEXA",19,0)
 ;         LEXXCT    Category (file 757.13)
"RTN","LEXA",20,0)
 ;                   
"RTN","LEXA",21,0)
 ; 1.  Search parameters ^TMP("LEXSCH",$J,PAR)=VALUE
"RTN","LEXA",22,0)
 ; 2.  Expressions found ^TMP("LEXFND",$J,FQ,IEN)=DT
"RTN","LEXA",23,0)
 ; 3.  Review List       ^TMP("LEXHITS",$J,#)=IEN^DT
"RTN","LEXA",24,0)
 ; 4.  Display List      LEX("LIST",#)
"RTN","LEXA",25,0)
 ;                   
"RTN","LEXA",26,0)
 ;         LEX("LIST",0)=LAST^TOTAL
"RTN","LEXA",27,0)
 ;         LEX("LIST",#)=IEN^DT
"RTN","LEXA",28,0)
 ;                   
"RTN","LEXA",29,0)
LOOK(LEXX,LEXAP,LEXLL,LEXSUB,LEXVDT,LEXXSR,LEXXCT) ; Search for LEXX
"RTN","LEXA",30,0)
 I $G(LEXVDT)="" S LEXVDT=$$DT^XLFDT
"RTN","LEXA",31,0)
 I $L($G(^TMP("LEXSCH",$J,"VDT",0))) S LEXVDT=^TMP("LEXSCH",$J,"VDT",0)
"RTN","LEXA",32,0)
 K DIERR,LEX
"RTN","LEXA",33,0)
 K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","LEXA",34,0)
 K ^TMP("LEXSCH",$J,"EXC"),^TMP("LEXSCH",$J,"EXM")
"RTN","LEXA",35,0)
 K:+$G(^TMP("LEXSCH",$J,"ADF",0))=0 ^TMP("LEXSCH",$J)
"RTN","LEXA",36,0)
 I $D(DIC(0)) D
"RTN","LEXA",37,0)
 .S:DIC(0)["L" DIC(0)=$P(DIC(0),"L",1)_$P(DIC(0),"L",2)
"RTN","LEXA",38,0)
 .S:DIC(0)["I" DIC(0)=$P(DIC(0),"I",1)_$P(DIC(0),"I",2)
"RTN","LEXA",39,0)
 S LEXQ=1,LEXX=$G(LEXX)
"RTN","LEXA",40,0)
 I LEXX=""!(LEXX["^") D EN^LEXAR("^",$G(LEXVDT)) K LEXAP D EXIT Q
"RTN","LEXA",41,0)
 N LEXSC S LEXSC=$$CAT($G(LEXXCT),$G(LEXXSR))
"RTN","LEXA",42,0)
 N LEXXCT,LEXXSR S:+($P(LEXSC,"^",1))>0 LEXXCT=+($P(LEXSC,"^",1)) S:+($P(LEXSC,"^",2))>0 LEXXSR=+($P(LEXSC,"^",2))
"RTN","LEXA",43,0)
 S LEXAP=$$UP^XLFSTR($G(LEXAP))
"RTN","LEXA",44,0)
 S LEXLL=+$G(LEXLL)
"RTN","LEXA",45,0)
 S LEXSUB=$G(LEXSUB)
"RTN","LEXA",46,0)
 S ^TMP("LEXSCH",$J,"APP",0)=+$$AP^LEXDFN2($G(LEXAP))
"RTN","LEXA",47,0)
 S:^TMP("LEXSCH",$J,"APP",0)=0 ^TMP("LEXSCH",$J,"APP",0)=1
"RTN","LEXA",48,0)
 S:LEXSUB="" LEXSUB=^TMP("LEXSCH",$J,"APP",0)
"RTN","LEXA",49,0)
 S:$L($G(DIC("S"))) ^TMP("LEXSCH",$J,"FIL",0)=DIC("S")
"RTN","LEXA",50,0)
 S:LEXLL=0 LEXLL=5
"RTN","LEXA",51,0)
 S ^TMP("LEXSCH",$J,"LEN",0)=LEXLL
"RTN","LEXA",52,0)
X ; Search for X
"RTN","LEXA",53,0)
 I '$L($G(LEXX)) D  D EXIT Q
"RTN","LEXA",54,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",55,0)
 .S LEX("ERR",LEX("ERR",0))="User input LEXX missing or invalid"
"RTN","LEXA",56,0)
APP ; Application
"RTN","LEXA",57,0)
 I +$G(^TMP("LEXSCH",$J,"APP",0))=0!('$D(^LEXT(757.2,+$G(^TMP("LEXSCH",$J,"APP",0)),0))) D  D EXIT Q
"RTN","LEXA",58,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",59,0)
 .S LEX("ERR",LEX("ERR",0))="Calling application identification LEXAP missing or invalid"
"RTN","LEXA",60,0)
USR ; User
"RTN","LEXA",61,0)
 I +$G(DUZ)=0!('$D(^VA(200,+$G(DUZ),0))) D  D EXIT Q
"RTN","LEXA",62,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",63,0)
 .S LEX("ERR",LEX("ERR",0))="User identification DUZ missing or invalid"
"RTN","LEXA",64,0)
 N LEXFND,LEXISCD
"RTN","LEXA",65,0)
 S (LEXFND,LEXISCD)=0
"RTN","LEXA",66,0)
 S ^TMP("LEXSCH",$J,"USR",0)=+$G(DUZ)
"RTN","LEXA",67,0)
 S ^TMP("LEXSCH",$J,"NAR",0)=LEXX
"RTN","LEXA",68,0)
 S ^TMP("LEXSCH",$J,"SCH",0)=$$UP^XLFSTR(LEXX)
"RTN","LEXA",69,0)
DEF ; Defaults                     CONFIG^LEXSET
"RTN","LEXA",70,0)
 N LEXFIL,LEXDSP,LEXFILR S:$L($G(DIC("S"))) LEXFIL=DIC("S")
"RTN","LEXA",71,0)
 I '$L($G(LEXFIL)),$L($G(^TMP("LEXSCH",$J,"FIL",0))) S LEXFIL=^TMP("LEXSCH",$J,"FIL",0)
"RTN","LEXA",72,0)
 N LEXNS,LEXSS
"RTN","LEXA",73,0)
 S LEXNS=$$NS^LEXDFN2(LEXAP)
"RTN","LEXA",74,0)
 S LEXSS=$$MD^LEXDFN2(LEXSUB)
"RTN","LEXA",75,0)
 I +$G(^TMP("LEXSCH",$J,"ADF",0))=0 D CONFIG^LEXSET(LEXNS,LEXSS,$G(LEXVDT))
"RTN","LEXA",76,0)
 I '$L($G(LEXFIL)),$L($G(^TMP("LEXSCH",$J,"FIL",0))) S LEXFIL=^TMP("LEXSCH",$J,"FIL",0)
"RTN","LEXA",77,0)
 S:$L($G(LEXFIL)) LEXFIL=$$FIL(LEXFIL)
"RTN","LEXA",78,0)
 S LEXFIL=$G(LEXFIL)
"RTN","LEXA",79,0)
 K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","LEXA",80,0)
 D MAN
"RTN","LEXA",81,0)
 I $D(LEX("ERR")) D EXIT Q
"RTN","LEXA",82,0)
 D SETUP^LEXAM($G(^TMP("LEXSCH",$J,"VOC",0)))
"RTN","LEXA",83,0)
 I $D(LEX("ERR")) D EXIT Q
"RTN","LEXA",84,0)
LK ; Look-up
"RTN","LEXA",85,0)
IEN ; Look-up by IEN               ADDL^LEXAL PCH 4
"RTN","LEXA",86,0)
 I ^TMP("LEXSCH",$J,"NAR",0)?1"`"1N.N D  I $D(LEX("LIST")) D EXIT Q
"RTN","LEXA",87,0)
 .N LEXE,LEXUN
"RTN","LEXA",88,0)
 .S LEXE=+$E(^TMP("LEXSCH",$J,"NAR",0),2,$L(^TMP("LEXSCH",$J,"NAR",0))) Q:LEXE=0
"RTN","LEXA",89,0)
 .S LEXUN=+$G(^TMP("LEXSCH",$J,"UNR",0))
"RTN","LEXA",90,0)
 .Q:'$D(^LEX(757.01,LEXE,0))
"RTN","LEXA",91,0)
 .D ADDL^LEXAL(LEXE,$$DES^LEXASC(LEXE),$$SO^LEXASO(LEXE,$G(^TMP("LEXSCH",$J,"DIS",0)),1,$G(LEXVDT)))
"RTN","LEXA",92,0)
 .I $D(^TMP("LEXFND",$J)) D BEG^LEXAL
"RTN","LEXA",93,0)
 .I LEXUN>0,$L($G(^TMP("LEXSCH",$J,"NAR",0))) S LEX("NAR")=$G(^TMP("LEXSCH",$J,"NAR",0))
"RTN","LEXA",94,0)
 .I LEXUN>0,$L($G(^LEX(757.01,+$G(LEXE),0))) S LEX("NAR")=$G(^LEX(757.01,+$G(LEXE),0))
"RTN","LEXA",95,0)
SCT ; Look-up by Shortcuts         EN^LEXASC  
"RTN","LEXA",96,0)
 I +$G(^TMP("LEXSCH",$J,"SCT",0)),$D(^LEX(757.41,^TMP("LEXSCH",$J,"SCT",0))) D
"RTN","LEXA",97,0)
 .S LEXFND=$$EN^LEXASC(^TMP("LEXSCH",$J,"SCH",0),^TMP("LEXSCH",$J,"SCT",0),$G(LEXVDT))
"RTN","LEXA",98,0)
 I +LEXFND D EXIT Q
"RTN","LEXA",99,0)
CODE ; Look-up by Code              EN^LEXABC
"RTN","LEXA",100,0)
 S LEXFND=$$EN^LEXABC(^TMP("LEXSCH",$J,"SCH",0),$G(LEXVDT))
"RTN","LEXA",101,0)
 I +LEXFND D EXIT Q
"RTN","LEXA",102,0)
 I +LEXFND'>0,+($G(LEXISCD))>0 D EXIT Q
"RTN","LEXA",103,0)
 ; if code is found but it is inactive
"RTN","LEXA",104,0)
 ;I +$P(LEXFND,"^",2)'=-1 S LEX=0 D EXIT Q
"RTN","LEXA",105,0)
EXACT ; Look-up Exact Match          EN^LEXAB
"RTN","LEXA",106,0)
 S LEXFND=$$EN^LEXAB(^TMP("LEXSCH",$J,"SCH",0),$G(LEXVDT))
"RTN","LEXA",107,0)
 K:+LEXFND=0 ^TMP("LEXFND",$J)
"RTN","LEXA",108,0)
 K ^TMP("LEXHIT",$J)
"RTN","LEXA",109,0)
KEYWRD ; Look-up by word              EN^LEXALK
"RTN","LEXA",110,0)
 D EN^LEXALK
"RTN","LEXA",111,0)
EXIT ; Clean-up and quit
"RTN","LEXA",112,0)
 K LEXQ,LEXDICS,LEXFIL,LEXFILR,LEXDSP,LEXSHOW,LEXSHCT,LEXSUB
"RTN","LEXA",113,0)
 K LEXOVR,LEXUN,LEXLKFL,LEXLKGL,LEXLKIX,LEXLKSH,LEXTKNS,LEXTKN
"RTN","LEXA",114,0)
 K LEXI
"RTN","LEXA",115,0)
 D:$D(LEX("ERR")) CLN
"RTN","LEXA",116,0)
 I $D(LEX),+$G(LEX)=0,'$D(LEX("LIST")),$L($G(LEXX)) D
"RTN","LEXA",117,0)
 .N LEXC,LEXF,LEXV
"RTN","LEXA",118,0)
 .S LEXC=1
"RTN","LEXA",119,0)
 .S LEXF=$G(^TMP("LEXSCH",$J,"FIL",0))
"RTN","LEXA",120,0)
 .S LEXV=$G(^TMP("LEXSCH",$J,"VOC",0))
"RTN","LEXA",121,0)
 .D:+$G(^TMP("LEXSCH",$J,"UNR",0))>0 EN^LEXAR(LEXX,$G(LEXVDT))
"RTN","LEXA",122,0)
 .S LEX("NAR")=LEXX
"RTN","LEXA",123,0)
 .S LEX=0
"RTN","LEXA",124,0)
 .S LEX("HLP",LEXC)="    A suitable term could not be found based on user input"
"RTN","LEXA",125,0)
 .S:LEXF="I 1" LEXF=""
"RTN","LEXA",126,0)
 .I $L(LEXF)!(LEXV'="WRD") D
"RTN","LEXA",127,0)
 ..S LEX("HLP",LEXC)=$G(LEX("HLP",LEXC))_" and "
"RTN","LEXA",128,0)
 ..S LEXC=LEXC+1
"RTN","LEXA",129,0)
 ..S LEX("HLP",LEXC)="    current user defaults"
"RTN","LEXA",130,0)
 ..S LEX("HLP",0)=LEXC
"RTN","LEXA",131,0)
 .S LEX("HLP",LEXC)=$G(LEX("HLP",LEXC))_"."
"RTN","LEXA",132,0)
 Q
"RTN","LEXA",133,0)
CLN ; Clean
"RTN","LEXA",134,0)
 K LEXQ,LEXTKNS,LEXTKN,LEXI
"RTN","LEXA",135,0)
 K ^TMP("LEXSCH",$J),^TMP("LEXHIT",$J),^TMP("LEXFND",$J)
"RTN","LEXA",136,0)
 Q
"RTN","LEXA",137,0)
MAN ; Mandatory variables
"RTN","LEXA",138,0)
 N LEXERR
"RTN","LEXA",139,0)
 F LEXERR="SCH","VOC","APP","USR" D
"RTN","LEXA",140,0)
 .I '$L($G(^TMP("LEXSCH",$J,LEXERR,0))) D
"RTN","LEXA",141,0)
 ..S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",142,0)
 ..S LEX("ERR",LEX("ERR",0))="Mandatory variable ^TMP(""LEXSCH"",$J,"""_LEXERR_""",0) missing or invalid"
"RTN","LEXA",143,0)
 Q
"RTN","LEXA",144,0)
CAT(X,Y) ; Source Category
"RTN","LEXA",145,0)
 N LEX,LEXC,LEXI,LEXO,LEXS,LEXU S (X,LEX)=$G(X) Q:'$L(X) ""  Q:X?1N.N&('$D(^LEX(757.13,+X,0))) ""
"RTN","LEXA",146,0)
 S (LEXS,Y)=$G(Y) S:$L(LEXS) LEXS=$$SRC(LEXS) I X?1N.N,$D(^LEX(757.13,+X,0)) S X=+X S:+LEXS>0 X=X_"^"_+LEXS Q X
"RTN","LEXA",147,0)
 S LEXU=$$UP^XLFSTR(LEX),(X,LEXC)=+($O(^LEX(757.13,"C",LEXU,0))) Q:'$D(^LEX(757.13,"C",LEXU)) ""
"RTN","LEXA",148,0)
 I +LEXC>0,LEXC=+($O(^LEX(757.13,"C",LEXU," "),-1)) S X=+LEXC S:+LEXS>0 X=X_"^"_+LEXS Q X
"RTN","LEXA",149,0)
 S LEXO="",LEXI=0 F  S LEXI=$O(^LEX(757.13,"C",LEXU,LEXI)) Q:+LEXI'>0  D  Q:+LEXO>0
"RTN","LEXA",150,0)
 . S:$P($G(^LEX(757.13,LEXI,4)),"^",1)=LEXS LEXO=LEXI
"RTN","LEXA",151,0)
 S X="" S:+LEXO>0 X=+LEXO S:+LEXO>0&(+LEXS>0) X=X_"^"_+LEXS
"RTN","LEXA",152,0)
 Q X
"RTN","LEXA",153,0)
SRC(X) ; Source
"RTN","LEXA",154,0)
 N LEX,LEXU S (LEX,X)=$TR($G(X),"`","") Q:'$L(LEX) ""  Q:X?1N.N&('$D(^LEX(757.14,+X,0))) ""  Q:X?1N.N&($D(^LEX(757.14,+X,0))) +X
"RTN","LEXA",155,0)
 S LEXU=$$UP^XLFSTR(LEX),X=$O(^LEX(757.14,"B",LEX,0)) Q:+X>0 +X  S X=$O(^LEX(757.14,"B",LEXU,0)) Q:+X>0 +X
"RTN","LEXA",156,0)
 Q ""
"RTN","LEXA",157,0)
FIL(X) ; Validate Filter
"RTN","LEXA",158,0)
 S X=$G(X) N DIC Q:'$L(X) X D ^DIM S:'$D(X) X=""
"RTN","LEXA",159,0)
 Q X
"RTN","LEXA",160,0)
 ;                   
"RTN","LEXA",161,0)
 ; D INFO^LEXA(IEN,DATE)
"RTN","LEXA",162,0)
 ;                   
"RTN","LEXA",163,0)
 ;    IEN   Internal Entry Number in file 757.01
"RTN","LEXA",164,0)
 ;    DATE  Optional - retrieves codes active on a specified date
"RTN","LEXA",165,0)
 ;               
"RTN","LEXA",166,0)
 ; Returns array LEX("SEL") or null
"RTN","LEXA",167,0)
 ;                   
"RTN","LEXA",168,0)
 ;    LEX("SEL","EXP")   Expressions Concepts/Synonyms/Variants
"RTN","LEXA",169,0)
 ;    LEX("SEL","SIG")   Expression definition
"RTN","LEXA",170,0)
 ;    LEX("SEL","SRC")   Classification Codes
"RTN","LEXA",171,0)
 ;    LEX("SEL"."STY")   Semantic Class/Semantic Types
"RTN","LEXA",172,0)
 ;    LEX("SEL","VAS")   VA Classification Sources
"RTN","LEXA",173,0)
 ;                   
"RTN","LEXA",174,0)
INFO(X,LEXVDT) ; Get Information about a Term
"RTN","LEXA",175,0)
 K LEX("SEL") S X=+$G(X) Q:X=0  Q:'$D(^LEX(757.01,X,0))
"RTN","LEXA",176,0)
 N LEXD S LEXD=$G(LEXVDT) S:+LEXD'>0 LEXD=$$DT^XLFDT
"RTN","LEXA",177,0)
 N LEXVDT S LEXVDT=LEXD D SET^LEXAR4(X,LEXVDT)
"RTN","LEXA",178,0)
 Q
"RTN","LEXA1")
0^12^B28014387
"RTN","LEXA1",1,0)
LEXA1 ;ISL/KER - Lexicon Look-up (Loud) ;11/30/2008
"RTN","LEXA1",2,0)
 ;;2.0;LEXICON UTILITY;**3,4,6,11,15,38,55**;Sep 23, 1996;Build 11
"RTN","LEXA1",3,0)
 ;
"RTN","LEXA1",4,0)
EN ; Initialize
"RTN","LEXA1",5,0)
 ; Fileman Inquire Option
"RTN","LEXA1",6,0)
 I $D(DIC(0)),$G(DIC(0))["A" K X
"RTN","LEXA1",7,0)
 ; Date Check
"RTN","LEXA1",8,0)
 N LEXQ S LEXQ=0 I $D(LEXVDT) I $L($G(^TMP("LEXSCH",$J,"VDT",0))) S LEXVDT=^TMP("LEXSCH",$J,"VDT",0)
"RTN","LEXA1",9,0)
 I '$D(LEXVDT) I $L($G(^TMP("LEXSCH",$J,"VDT",0))) N LEXVDT S LEXVDT=^TMP("LEXSCH",$J,"VDT",0)
"RTN","LEXA1",10,0)
 ;
"RTN","LEXA1",11,0)
 ; LEXSUB  Special variable from version 1.0 specifying the
"RTN","LEXA1",12,0)
 ;         vocabulary subset to use during the search.  It is
"RTN","LEXA1",13,0)
 ;         a three character mnemonic taken from the Subset
"RTN","LEXA1",14,0)
 ;         Definition file #757.2.  The default is "WRD"
"RTN","LEXA1",15,0)
 S:'$L($G(LEXSUB)) LEXSUB="WRD"
"RTN","LEXA1",16,0)
 ;
"RTN","LEXA1",17,0)
 ; LEXAP   Special variable from version 1.0 specifying the
"RTN","LEXA1",18,0)
 ;         application using the Lexicon.  It is a pointer
"RTN","LEXA1",19,0)
 ;         value to the Subset Definition file #757.2.
"RTN","LEXA1",20,0)
 ;         The default is 1 (Lexicon)
"RTN","LEXA1",21,0)
 S:'$L($G(LEXAP))&($L($G(^TMP("LEXSCH",$J,"APP",0)))) LEXAP=^TMP("LEXSCH",$J,"APP",0)
"RTN","LEXA1",22,0)
 S:'$L($G(LEXAP)) LEXAP=1
"RTN","LEXA1",23,0)
 ;
"RTN","LEXA1",24,0)
 ; LEXLL   Special variable (new) specifying the length of the
"RTN","LEXA1",25,0)
 ;         displayable list the user is to select from.  Default
"RTN","LEXA1",26,0)
 ;         is 5 (display 5 at a time until the entire list has 
"RTN","LEXA1",27,0)
 ;         been reviewed)
"RTN","LEXA1",28,0)
 S:'$L($G(LEXLL)) LEXLL=5
"RTN","LEXA1",29,0)
 ;
"RTN","LEXA1",30,0)
 ; LEXSRC  Special variable specifying the source of the 
"RTN","LEXA1",31,0)
 ;         vocabulary to use during the search.  It is
"RTN","LEXA1",32,0)
 ;         an Internal Entry Number to the Source File
"RTN","LEXA1",33,0)
 ;         #757.14.  There is no default value.
"RTN","LEXA1",34,0)
 N LEXXSR S:$L($G(LEXSRC)) LEXXSR=$G(LEXSRC)
"RTN","LEXA1",35,0)
 ;         
"RTN","LEXA1",36,0)
 ; LEXCAT  Special variable specifying the source category of
"RTN","LEXA1",37,0)
 ;         the vocabulary to use during the search.  It is
"RTN","LEXA1",38,0)
 ;         an Internal Entry Number in the Source Category
"RTN","LEXA1",39,0)
 ;         file #757.13.  There is no default value.
"RTN","LEXA1",40,0)
 N LEXXCT S:$L($G(LEXCAT)) LEXXCT=$G(LEXCAT)
"RTN","LEXA1",41,0)
 ;         
"RTN","LEXA1",42,0)
 ; Check the DIC variables new LEXUR "user response"
"RTN","LEXA1",43,0)
 N LEXDICA,LEXDICB,LEXO,XTLKGBL,XTLKHLP,XTLKKSCH,XTLKSAY  D CHK N LEXUR
"RTN","LEXA1",44,0)
 ;
"RTN","LEXA1",45,0)
 ; Save the value of X if "Ask" is not specified in DIC(0)
"RTN","LEXA1",46,0)
 I DIC(0)'["A",$L($G(X)) S LEXSAVE=X K X
"RTN","LEXA1",47,0)
 ;
"RTN","LEXA1",48,0)
 ; Save the prompt
"RTN","LEXA1",49,0)
 I $L($G(DIC("A"))) S LEXDICA=DIC("A")
"RTN","LEXA1",50,0)
 ;
"RTN","LEXA1",51,0)
 ; Continue to lookup until the dialog with the application 
"RTN","LEXA1",52,0)
 ; ends.  If there is nothing to lookup (X="") or an uparrow
"RTN","LEXA1",53,0)
 ; is detected, the Lexicon shuts down killing LEX.
"RTN","LEXA1",54,0)
 ;
"RTN","LEXA1",55,0)
 F  D LK Q:'$D(LEX)!($D(LEX("SEL")))
"RTN","LEXA1",56,0)
 G EXIT
"RTN","LEXA1",57,0)
LK ; Start Look-up
"RTN","LEXA1",58,0)
 ; X not provided
"RTN","LEXA1",59,0)
 D:'$D(LEXSAVE) ASK
"RTN","LEXA1",60,0)
 ; X provided
"RTN","LEXA1",61,0)
 S:$D(LEXSAVE) X=LEXSAVE K LEXSAVE
"RTN","LEXA1",62,0)
 ; X was null with a default provided
"RTN","LEXA1",63,0)
 S:$D(DIC("B"))&($G(X)="") X=DIC("B")
"RTN","LEXA1",64,0)
 ; Lookup X - LOOK(LEXX,LEXAP,LEXLL,LEXSUB,LEXVDT,LEXXSR,LEXXCT)
"RTN","LEXA1",65,0)
 D LOOK^LEXA(X,LEXAP,LEXLL,,,$G(LEXXSR),$G(LEXXCT))
"RTN","LEXA1",66,0)
 K DIC("B")
"RTN","LEXA1",67,0)
 ;
"RTN","LEXA1",68,0)
NOTFND ; If X was not found
"RTN","LEXA1",69,0)
 ;
"RTN","LEXA1",70,0)
 ;    Write "??"
"RTN","LEXA1",71,0)
 ;
"RTN","LEXA1",72,0)
 ;    Calling application uses Unresolved Narratives
"RTN","LEXA1",73,0)
 ;      Prompt to "accept or reject" the narrative, if
"RTN","LEXA1",74,0)
 ;      no selection is made continue the search
"RTN","LEXA1",75,0)
 ;
"RTN","LEXA1",76,0)
 ;    Calling application does not use Unresolved Narratives
"RTN","LEXA1",77,0)
 ;      Display help, Re-prompt and Continue search
"RTN","LEXA1",78,0)
 ;
"RTN","LEXA1",79,0)
 I '$D(LEX("LIST")),+($G(LEX))=0,$L(X),X'["^",$E(X,1)'=" " D  K LEX S LEX=0 Q
"RTN","LEXA1",80,0)
 . K DIC("B"),LEX("SEL") I +($G(^TMP("LEXSCH",$J,"UNR",0)))=0 I +($G(X))'=757.01 W "  ??" D:$D(LEX("HLP")) DH^LEXA3 W ! Q
"RTN","LEXA1",81,0)
 . I +($G(^TMP("LEXSCH",$J,"UNR",0)))=1 W "  ??" D EN^LEXA4 W !
"RTN","LEXA1",82,0)
FOUND ; If X was found
"RTN","LEXA1",83,0)
 ;
"RTN","LEXA1",84,0)
 ;    Begin user selection.  Continue to display the list
"RTN","LEXA1",85,0)
 ;    until the dialog with the user is terminated.  The
"RTN","LEXA1",86,0)
 ;    dialog is considered to be terminated if:
"RTN","LEXA1",87,0)
 ;
"RTN","LEXA1",88,0)
 ;      The selection list does not exist  '$D(LEX("LIST"))
"RTN","LEXA1",89,0)
 ;      The user has made a selection       $D(LEX("SEL")
"RTN","LEXA1",90,0)
 ; 
"RTN","LEXA1",91,0)
 I $D(LEX("LIST")) F  Q:+($G(LEX))=0  D SELECT^LEXA2
"RTN","LEXA1",92,0)
 Q:$D(LEX("SEL"))
"RTN","LEXA1",93,0)
 I '$L($G(LEX)) K LEX Q
"RTN","LEXA1",94,0)
 I $L($G(LEX)),'$D(LEX("SEL")),$D(^TMP("LEXSCH",$J)) D
"RTN","LEXA1",95,0)
 . D EN^LEXA4 S:'$D(LEX("SEL")) LEX=0
"RTN","LEXA1",96,0)
 Q
"RTN","LEXA1",97,0)
EXIT ; Set/Kill variables Y, Y(0,0) Y(1) Y(81) from LEX("SEL")
"RTN","LEXA1",98,0)
 S:$L($G(LEXDICA)) DIC("A")=LEXDICA S:$L($G(LEXDICB)) DIC("B")=LEXDICB
"RTN","LEXA1",99,0)
 S:'$D(LEX("SEL","EXP",1)) Y=-1 K Y(1)
"RTN","LEXA1",100,0)
 I $D(LEX("SEL","EXP",1)) S Y=LEX("SEL","EXP",1) D Y1,SSBR S:DIC(0)["Z" Y(0)=^LEX(757.01,+(LEX("SEL","EXP",1)),0),Y(0,0)=$P(^LEX(757.01,+(LEX("SEL","EXP",1)),0),"^",1)
"RTN","LEXA1",101,0)
 D CL
"RTN","LEXA1",102,0)
 Q
"RTN","LEXA1",103,0)
CL ; Clear LEX and Multi-Term Lookup XTLK
"RTN","LEXA1",104,0)
 K LEX,LEXSUB,LEXAP,LEXLL D CLR
"RTN","LEXA1",105,0)
 Q
"RTN","LEXA1",106,0)
CLR ; Clear ^TMP Global
"RTN","LEXA1",107,0)
 K ^TMP("LEXSCH",$J),^TMP("LEXHIT",$J),^TMP("LEXFND",$J)
"RTN","LEXA1",108,0)
 Q
"RTN","LEXA1",109,0)
Y1 ; ICD in Y(1) and CPT in Y(81)
"RTN","LEXA1",110,0)
 N LEXVAS S LEXVAS=0,Y(1)=""
"RTN","LEXA1",111,0)
 F  S LEXVAS=$O(LEX("SEL","VAS","B",80,LEXVAS)) Q:+LEXVAS=0!(Y(1)'="")  D
"RTN","LEXA1",112,0)
 . S Y(1)=$P($G(LEX("SEL","VAS",LEXVAS)),"^",3)
"RTN","LEXA1",113,0)
 S LEXVAS=0,Y(81)="" F  S LEXVAS=$O(LEX("SEL","VAS","B",81,LEXVAS)) Q:+LEXVAS=0!(Y(81)'="")  D
"RTN","LEXA1",114,0)
 . S Y(81)=$P($G(LEX("SEL","VAS",LEXVAS)),"^",3)
"RTN","LEXA1",115,0)
 K:Y(1)="" Y(1) K:Y(81)="" Y(81)
"RTN","LEXA1",116,0)
 I $D(Y(1)) D
"RTN","LEXA1",117,0)
 .W !!,">>>  Code  :  "
"RTN","LEXA1",118,0)
 .I $D(IOINHI)&($D(IOINORM)) W IOINHI,Y(1),IOINORM,! Q 
"RTN","LEXA1",119,0)
 .W Y(1),!
"RTN","LEXA1",120,0)
 Q
"RTN","LEXA1",121,0)
ASK ; Get user input
"RTN","LEXA1",122,0)
 N DIR,DIRUT,DIROUT S:$L($G(LEXDICA)) DIC("A")=LEXDICA
"RTN","LEXA1",123,0)
 S DIR("A")=DIC("A") W:'$L($G(X))&('$L($G(LEXDICB))) !
"RTN","LEXA1",124,0)
 I '$L($G(X)),$L($G(LEXDICB)) S DIR("B")=LEXDICB
"RTN","LEXA1",125,0)
 S DIR("?")="    "_$$SQ^LEXHLP
"RTN","LEXA1",126,0)
 S DIR("??")="^D INPHLP^LEXA1" N Y S DIR(0)="FAO^0:245" K X
"RTN","LEXA1",127,0)
 D ^DIR
"RTN","LEXA1",128,0)
 K DIC("B") D:$E(X,1)=" " RSBR
"RTN","LEXA1",129,0)
 W:$E(X,1)'=" " !
"RTN","LEXA1",130,0)
 F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","LEXA1",131,0)
 W:$D(DTOUT) !,"Try later.",!
"RTN","LEXA1",132,0)
 I $D(DTOUT)!(X="^") S X=""
"RTN","LEXA1",133,0)
 S:X[U DUOUT=1 K DIRUT,DIROUT Q
"RTN","LEXA1",134,0)
INPHLP ; Look-up help
"RTN","LEXA1",135,0)
 N X S X="" S:$L($G(DIR("?"))) X=$G(DIR("?")) S:'$L(X) X="    "_$$SQ^LEXHLP
"RTN","LEXA1",136,0)
 W:$L(X) !!,X,!
"RTN","LEXA1",137,0)
 W !,"    Best results occur using one to three full or partial words without"
"RTN","LEXA1",138,0)
 W !,"    a suffix (i.e., ""DIABETES"",""DIAB MELL"",""DIAB MELL INSUL"") or"
"RTN","LEXA1",139,0)
 W !,"    a classification code (ICD, CPT, HCPCS, etc)"
"RTN","LEXA1",140,0)
 Q
"RTN","LEXA1",141,0)
CHK ; Check Fileman look-up variables
"RTN","LEXA1",142,0)
 K DIC("DR"),DIC("P"),DIC("V"),DLAYGO,DINUM
"RTN","LEXA1",143,0)
 S:$L($G(X)) LEXSAVE=X S:$L($G(DIC("B"))) LEXDICB=DIC("B") K DIC("B")
"RTN","LEXA1",144,0)
 I $L($G(DIC(0))) D
"RTN","LEXA1",145,0)
 . F  Q:DIC(0)'["L"  S DIC(0)=$P(DIC(0),"L",1)_$P(DIC(0),"L",2)
"RTN","LEXA1",146,0)
 . F  Q:DIC(0)'["I"  S DIC(0)=$P(DIC(0),"I",1)_$P(DIC(0),"I",2)
"RTN","LEXA1",147,0)
 S:'$L($G(DIC(0))) DIC(0)="QEAMF" S:'$L($G(DIC)) DIC="^LEX(757.01,"
"RTN","LEXA1",148,0)
 S:DIC(0)'["F" DIC(0)=DIC(0)_"F" S:'$L($G(DIC("A"))) DIC("A")="Enter Term/Concept:  "
"RTN","LEXA1",149,0)
 S LEXDICA=DIC("A")
"RTN","LEXA1",150,0)
 Q
"RTN","LEXA1",151,0)
SSBR ; Store data for Space Bar Return
"RTN","LEXA1",152,0)
 Q:'$L($G(DUZ))  Q:+($G(DUZ))=0  Q:'$L($G(DIC))  Q:$G(DIC)'["757.01,"
"RTN","LEXA1",153,0)
 Q:$G(DIC(0))'["F"  Q:+($G(Y))'>2  Q:$E($G(X),1)=" "  S ^DISV(DUZ,DIC)=+($G(Y))
"RTN","LEXA1",154,0)
 Q
"RTN","LEXA1",155,0)
RSBR ; Retrieve onSpace Bar Return
"RTN","LEXA1",156,0)
 Q:'$L($G(DUZ))  Q:$G(DIC)'="^LEX(757.01,"  Q:$G(DIC(0))'["F"
"RTN","LEXA1",157,0)
 Q:$E($G(X),1)'=" "  S:+($G(^DISV(DUZ,DIC)))>2 X=@(DIC_+($G(^DISV(DUZ,DIC)))_",0)")
"RTN","LEXA1",158,0)
 Q
"RTN","LEXAL")
0^13^B37971689
"RTN","LEXAL",1,0)
LEXAL ;ISL/KER - Look-up List (Global) ;11/30/2008
"RTN","LEXAL",2,0)
 ;;2.0;LEXICON UTILITY;**6,55**;Sep 23, 1996;Build 11
"RTN","LEXAL",3,0)
 ;
"RTN","LEXAL",4,0)
 ; Add to the list
"RTN","LEXAL",5,0)
ADDL(LEXI,LEXDS,LEXDP) ; Add
"RTN","LEXAL",6,0)
 N LEXA S LEXA=$G(LEXI) Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))  S LEXI=$$SIEN(LEXA)
"RTN","LEXAL",7,0)
 S:+LEXI>0&(LEXI'=LEXA) LEXA=LEXI Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))
"RTN","LEXAL",8,0)
 S LEXDS=$G(LEXDS),LEXDP=$G(LEXDP)
"RTN","LEXAL",9,0)
 N LEXF,LEXT,LEXL,LEXC
"RTN","LEXAL",10,0)
 S LEXT=$$DISP(LEXA,LEXDS,LEXDP)
"RTN","LEXAL",11,0)
 S LEXF=$$LSTN(LEXA,"A")
"RTN","LEXAL",12,0)
 S:'$D(^TMP("LEXFND",$J,-LEXF,LEXA)) ^TMP("LEXSCH",$J,"NUM",0)=$G(^TMP("LEXSCH",$J,"NUM",0))+1
"RTN","LEXAL",13,0)
 S ^TMP("LEXFND",$J,-LEXF,LEXA)=LEXT
"RTN","LEXAL",14,0)
 S:+LEXF'=0 ^TMP("LEXFND",$J,0)=LEXF
"RTN","LEXAL",15,0)
 S LEX=$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAL",16,0)
 Q
"RTN","LEXAL",17,0)
ADDN(LEXI,LEXDS,LEXDP) ; Near match
"RTN","LEXAL",18,0)
 N LEXA S LEXA=$G(LEXI) Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))  S LEXI=$$SIEN(LEXA) S:+LEXI>0&(LEXI'=LEXA) LEXA=LEXI Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))
"RTN","LEXAL",19,0)
 N LEXR,LEXN S LEXR=LEXA Q:$D(^TMP("LEXFND",$J,-99999997,LEXA))
"RTN","LEXAL",20,0)
 S LEXN=-99999997
"RTN","LEXAL",21,0)
 F  S LEXN=LEXN+1 Q:'$D(^TMP("LEXFND",$J,LEXN,0))
"RTN","LEXAL",22,0)
 I $P($G(^LEX(757.01,LEXA,1)),"^",2)'=1 D  Q:+LEXA=0
"RTN","LEXAL",23,0)
 . S LEXA=+($G(^LEX(757.01,LEXA,1))),LEXA=+($G(^LEX(757,LEXA,0)))
"RTN","LEXAL",24,0)
 S LEXDS=$G(LEXDS),LEXDP=$G(LEXDP)
"RTN","LEXAL",25,0)
 N LEXT S LEXT=$$DISP(LEXA,LEXDS,LEXDP)
"RTN","LEXAL",26,0)
 S:'$D(^TMP("LEXFND",$J,-LEXF,LEXA)) ^TMP("LEXSCH",$J,"NUM",0)=$G(^TMP("LEXSCH",$J,"NUM",0))+1
"RTN","LEXAL",27,0)
 S ^TMP("LEXFND",$J,LEXN,LEXA)=LEXT
"RTN","LEXAL",28,0)
 S:LEXN<$G(^TMP("LEXFND",$J,0)) ^TMP("LEXFND",$J,0)=LEXN
"RTN","LEXAL",29,0)
 S LEX=$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAL",30,0)
 Q
"RTN","LEXAL",31,0)
ADDE(LEXI,LEXDS,LEXDP) ; Exact match
"RTN","LEXAL",32,0)
 N LEXA S LEXA=$G(LEXI) Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))  S LEXI=$$SIEN(LEXA) S:+LEXI>0&(LEXI'=LEXA) LEXA=LEXI Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))
"RTN","LEXAL",33,0)
 N LEXR,LEXT S LEXR=LEXA,LEXDS=$G(LEXDS),LEXDP=$G(LEXDP),LEXT=$$DISP(LEXA,LEXDS,LEXDP)
"RTN","LEXAL",34,0)
 S:'$D(^TMP("LEXFND",$J,-99999999,LEXA)) ^TMP("LEXSCH",$J,"NUM",0)=$G(^TMP("LEXSCH",$J,"NUM",0))+1
"RTN","LEXAL",35,0)
 S ^TMP("LEXFND",$J,-99999999,LEXA)=LEXT,^TMP("LEXFND",$J,0)=-99999999
"RTN","LEXAL",36,0)
 S LEX=$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAL",37,0)
 Q
"RTN","LEXAL",38,0)
ADDEM(LEXI,LEXDS,LEXDP) ; Exact match Major Concept
"RTN","LEXAL",39,0)
 N LEXA S LEXA=$G(LEXI) Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))  S LEXI=$$SIEN(LEXA) S:+LEXI>0&(LEXI'=LEXA) LEXA=LEXI Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))
"RTN","LEXAL",40,0)
 N LEXR,LEXT S LEXR=LEXA Q:$P($G(^LEX(757.01,LEXA,1)),"^",2)'=1
"RTN","LEXAL",41,0)
 S LEXDS=$G(LEXDS),LEXDP=$G(LEXDP),LEXT=$$DISP(LEXA,LEXDS,LEXDP)
"RTN","LEXAL",42,0)
 S:'$D(^TMP("LEXFND",$J,-99999998,LEXA)) ^TMP("LEXSCH",$J,"NUM",0)=$G(^TMP("LEXSCH",$J,"NUM",0))+1
"RTN","LEXAL",43,0)
 S ^TMP("LEXFND",$J,-99999998,LEXA)=LEXT,^TMP("LEXFND",$J,0)=-99999998,LEX=$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAL",44,0)
 Q
"RTN","LEXAL",45,0)
ADDC(LEXI,LEXDS,LEXDP) ; Code
"RTN","LEXAL",46,0)
 N LEXA S LEXA=$G(LEXI) Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))  S LEXI=$$SIEN(LEXA) S:+LEXI>0&(LEXI'=LEXA) LEXA=LEXI Q:LEXA=0  Q:'$D(^LEX(757.01,LEXA))
"RTN","LEXAL",47,0)
 S LEXDS=$G(LEXDS),LEXDP=$G(LEXDP)
"RTN","LEXAL",48,0)
 N LEXT,LEXF,LEXC S LEXC=+($G(^LEX(757.01,LEXA,1))) Q:LEXC=0
"RTN","LEXAL",49,0)
 S LEXF=$G(^TMP("LEXFND",$J,0)) S:+LEXF=0 LEXF=-999999
"RTN","LEXAL",50,0)
 S LEXF=LEXF+1 S LEXT=$$DISP(LEXA,LEXDS,LEXDP)
"RTN","LEXAL",51,0)
 S:'$D(^TMP("LEXFND",$J,-LEXF,LEXA)) ^TMP("LEXSCH",$J,"NUM",0)=$G(^TMP("LEXSCH",$J,"NUM",0))+1
"RTN","LEXAL",52,0)
 S ^TMP("LEXFND",$J,LEXF,LEXA)=LEXT
"RTN","LEXAL",53,0)
 S ^TMP("LEXFND",$J,0)=LEXF
"RTN","LEXAL",54,0)
 S LEX=$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAL",55,0)
 Q
"RTN","LEXAL",56,0)
DISP(LEXX,LEXDS,LEXDP) ; Display Text
"RTN","LEXAL",57,0)
 S LEXX=$G(^LEX(757.01,LEXX,0))
"RTN","LEXAL",58,0)
 S:$L(LEXDS) LEXX=LEXX_" "_LEXDS
"RTN","LEXAL",59,0)
 S:$L(LEXDP) LEXX=LEXX_" "_LEXDP
"RTN","LEXAL",60,0)
 Q LEXX
"RTN","LEXAL",61,0)
BEG ; Begin List
"RTN","LEXAL",62,0)
 S:+($G(^TMP("LEXSCH",$J,"UNR",0)))>0&($L($G(^TMP("LEXSCH",$J,"NAR",0)))) LEX("NAR")=$G(^TMP("LEXSCH",$J,"NAR",0))
"RTN","LEXAL",63,0)
 Q:'$D(^TMP("LEXFND",$J))
"RTN","LEXAL",64,0)
 N LEXRL,LEXJ,LEXI,LEXA,LEXSTR,LEXDP
"RTN","LEXAL",65,0)
 S LEXRL=0,LEXLL=+($G(^TMP("LEXSCH",$J,"LEN",0)))
"RTN","LEXAL",66,0)
 S:+LEXLL=0 (LEXRL,LEXLL)=5 S LEXJ=0,LEXI=-9999999999
"RTN","LEXAL",67,0)
 ; Hit List      ^TMP("LEXHIT",$J,#)
"RTN","LEXAL",68,0)
 F  S LEXI=$O(^TMP("LEXFND",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXAL",69,0)
 . S LEXA=0
"RTN","LEXAL",70,0)
 . F  S LEXA=$O(^TMP("LEXFND",$J,LEXI,LEXA)) Q:+LEXA=0!(LEXJ=LEXLL)  D  Q:+LEXA=0!(LEXJ=LEXLL)
"RTN","LEXAL",71,0)
 . . S LEXJ=LEXJ+1,LEXDP=^TMP("LEXFND",$J,LEXI,LEXA)
"RTN","LEXAL",72,0)
 . . S ^TMP("LEXHIT",$J,0)=LEXJ
"RTN","LEXAL",73,0)
 . . S ^TMP("LEXHIT",$J,LEXJ)=LEXA_"^"_LEXDP
"RTN","LEXAL",74,0)
 . . S:+($G(^TMP("LEXSCH",$J,"EXM",0)))=+LEXA ^TMP("LEXSCH",$J,"EXM",2)=LEXJ_"^"_$G(^LEX(757.01,+LEXA,0))
"RTN","LEXAL",75,0)
 . . S:+($G(^TMP("LEXSCH",$J,"EXC",0)))=+LEXA ^TMP("LEXSCH",$J,"EXC",2)=LEXJ_"^"_$G(^LEX(757.01,+LEXA,0))
"RTN","LEXAL",76,0)
 . . K ^TMP("LEXFND",$J,LEXI,LEXA)
"RTN","LEXAL",77,0)
 ; List          LEX("LIST")
"RTN","LEXAL",78,0)
 I $D(^TMP("LEXSCH",$J,"NUM",0)) S LEX=+($G(^TMP("LEXSCH",$J,"NUM",0)))
"RTN","LEXAL",79,0)
 I LEXLL>0 D
"RTN","LEXAL",80,0)
 . N LEXI,LEXJ S (LEXJ,LEXI)=0
"RTN","LEXAL",81,0)
 . F  S LEXJ=$O(^TMP("LEXHIT",$J,LEXJ)) Q:+LEXJ=0!(+LEXI=LEXLL)  D  Q:+LEXI=LEXLL
"RTN","LEXAL",82,0)
 . . S LEXI=LEXI+1,LEX("LIST",LEXI)=^TMP("LEXHIT",$J,LEXJ)
"RTN","LEXAL",83,0)
 . . S LEX("LIST",0)=LEXI_"^"_LEXI
"RTN","LEXAL",84,0)
 . . S (LEX("MAX"),^TMP("LEXSCH",$J,"LST",0))=LEXI
"RTN","LEXAL",85,0)
 S ^TMP("LEXSCH",$J,"TOL",0)=0 S:$D(LEX("LIST",1)) ^TMP("LEXSCH",$J,"TOL",0)=1
"RTN","LEXAL",86,0)
 S LEX=+($G(^TMP("LEXSCH",$J,"NUM",0)))
"RTN","LEXAL",87,0)
 S:^TMP("LEXSCH",$J,"TOL",0)=1&(+($G(LEX))>0) LEX("MAT")=+LEX_" match"_$S(+LEX>1:"es",1:"")_" found"
"RTN","LEXAL",88,0)
 ; Establish level of concept (1 = concept, >1= modifier)  PCH 6
"RTN","LEXAL",89,0)
 S LEX("LVL")=+($G(LEX("LVL"))) S:LEX("LVL")=0 LEX("LVL")=1
"RTN","LEXAL",90,0)
 S:+($G(LEX("MAX")))>0 LEX("MIN")=1
"RTN","LEXAL",91,0)
 I $L($G(^TMP("LEXSCH",$J,"EXM",2))) S LEX("EXM")=^TMP("LEXSCH",$J,"EXM",2)
"RTN","LEXAL",92,0)
 I $L($G(^TMP("LEXSCH",$J,"EXC",2))) S LEX("EXC")=^TMP("LEXSCH",$J,"EXC",2)
"RTN","LEXAL",93,0)
 S:+($G(^TMP("LEXSCH",$J,"UNR",0)))>0&($L($G(^TMP("LEXSCH",$J,"NAR",0)))) LEX("NAR")=$G(^TMP("LEXSCH",$J,"NAR",0))
"RTN","LEXAL",94,0)
 Q:'$D(^TMP("LEXFND",$J))  K:+($G(LEXRL))>0 LEXLL
"RTN","LEXAL",95,0)
 Q
"RTN","LEXAL",96,0)
LSTN(LEXA,LEXM) ; List Number
"RTN","LEXAL",97,0)
 N LEXC,LEXL,LEXF,LEXK S LEXK=0
"RTN","LEXAL",98,0)
 S LEXC=+($G(^LEX(757.01,LEXA,1))) Q:LEXC=0 0
"RTN","LEXAL",99,0)
 S LEXL=$L($G(^LEX(757.01,LEXA,0))) Q:LEXL=0 0
"RTN","LEXAL",100,0)
 S LEXL=245-LEXL S:$L(LEXL)=1 LEXL="00"_LEXL
"RTN","LEXAL",101,0)
 S:$L(LEXL)=2 LEXL="0"_LEXL S LEXL=$E(LEXL,1,3)
"RTN","LEXAL",102,0)
 S LEXF=$O(^LEX(757.001,"B",LEXC,0))
"RTN","LEXAL",103,0)
 S:+LEXF>0&($L($G(^LEX(757.001,+LEXF,0)))) LEXF=(+($P($G(^LEX(757.001,LEXF,0)),"^",3))+1)
"RTN","LEXAL",104,0)
 S:+LEXF=0 LEXF=1 I +($G(LEXTKN(0)))>0 D
"RTN","LEXAL",105,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(LEXTKN(LEXI)) Q:+LEXI=0  D
"RTN","LEXAL",106,0)
 . . I $$UP^XLFSTR($G(^LEX(757.01,LEXA,0)))[LEXTKN(LEXI) S:LEXK<8 LEXK=LEXK+1
"RTN","LEXAL",107,0)
 S LEXK=$E(LEXK,1),LEXM=LEXF_"."_LEXK_LEXL
"RTN","LEXAL",108,0)
 Q LEXM
"RTN","LEXAL",109,0)
SIEN(X) ; Sourced IEN (PCH 55)
"RTN","LEXAL",110,0)
 S X=$G(X) Q:+($G(LEXXSR))'>0&(+($G(LEXXCT))'>0) X  Q:+($G(LEXXSR))>0&('$D(^LEX(757.14,+($G(LEXXSR)),0))) X  Q:+($G(LEXXCT))>0&('$D(^LEX(757.13,+($G(LEXXCT)),0))) X
"RTN","LEXAL",111,0)
 N LEXIEN,LEXSX,LEXEX,LEXMC S (X,LEXSX,LEXIEN)=+($G(X)) Q:+LEXIEN'>0 X  Q:'$D(^LEX(757.01,+LEXIEN,1)) X  S LEXMC=+($G(^LEX(757.01,+LEXIEN,1))) Q:+LEXMC'>0 X  Q:'$D(^LEX(757,+LEXMC,0)) X
"RTN","LEXAL",112,0)
 I +LEXXCT>0 D  I LEXSX'=LEXIEN S X=LEXSX Q X
"RTN","LEXAL",113,0)
 . S LEXEX=0 F  S LEXEX=$O(^LEX(757.01,"AMC",+LEXMC,LEXEX)) Q:+LEXEX'>0  D  Q:LEXSX'=LEXIEN
"RTN","LEXAL",114,0)
 . . N LEXC S LEXC=$P($G(^LEX(757.01,+LEXEX,1)),"^",11) S:LEXC=LEXXCT LEXSX=LEXEX
"RTN","LEXAL",115,0)
 I +LEXXSR>0 D  I LEXSX'=LEXIEN S X=LEXSX Q X
"RTN","LEXAL",116,0)
 . S LEXEX=0 F  S LEXEX=$O(^LEX(757.01,"AMC",+LEXMC,LEXEX)) Q:+LEXEX'>0  D  Q:LEXSX'=LEXIEN
"RTN","LEXAL",117,0)
 . . N LEXC S LEXC=$P($G(^LEX(757.01,+LEXEX,1)),"^",12) S:LEXC=LEXXSR LEXSX=LEXEX
"RTN","LEXAL",118,0)
 S X=LEXIEN
"RTN","LEXAL",119,0)
 Q X
"RTN","LEXAR")
0^17^B17442980
"RTN","LEXAR",1,0)
LEXAR ;ISA/FJF/KER-Look-up (Interpret User Response) ;11/30/2008
"RTN","LEXAR",2,0)
 ;;2.0;LEXICON UTILITY;**3,19,25,55**;Sep 23, 1996;Build 11
"RTN","LEXAR",3,0)
 ;
"RTN","LEXAR",4,0)
 ; User Responses
"RTN","LEXAR",5,0)
 ;
"RTN","LEXAR",6,0)
 ; Numeric  -----------------------------------------------
"RTN","LEXAR",7,0)
 ;
"RTN","LEXAR",8,0)
 ; #             Select Entry
"RTN","LEXAR",9,0)
 ;
"RTN","LEXAR",10,0)
 ; Numeric^Comment ----------------------------------------
"RTN","LEXAR",11,0)
 ;
"RTN","LEXAR",12,0)
 ; IEN^COMMENT   Application comment about term
"RTN","LEXAR",13,0)
 ;
"RTN","LEXAR",14,0)
 ; Up-Arrow -----------------------------------------------
"RTN","LEXAR",15,0)
 ;
"RTN","LEXAR",16,0)
 ; ^#            Jump to # on list
"RTN","LEXAR",17,0)
 ; ^             End dialog with the user
"RTN","LEXAR",18,0)
 ; ^^            End dialog with the application
"RTN","LEXAR",19,0)
 ;
"RTN","LEXAR",20,0)
 ; Question -----------------------------------------------
"RTN","LEXAR",21,0)
 ;
"RTN","LEXAR",22,0)
 ; ?             Standard help in LEX("HLP")
"RTN","LEXAR",23,0)
 ; ??            Extended help in LEX("HLP")
"RTN","LEXAR",24,0)
 ; ?#            Definition for # in LEX("HLP")
"RTN","LEXAR",25,0)
 ;
"RTN","LEXAR",26,0)
 ; Null ---------------------------------------------------
"RTN","LEXAR",27,0)
 ;
"RTN","LEXAR",28,0)
 ;               Advance the selection list
"RTN","LEXAR",29,0)
 ;
"RTN","LEXAR",30,0)
 ; String -------------------------------------------------
"RTN","LEXAR",31,0)
 ;
"RTN","LEXAR",32,0)
 ; Narrative     Return and store Unresolved Narrative
"RTN","LEXAR",33,0)
 ;
"RTN","LEXAR",34,0)
 ; --------------------------------------------------------
"RTN","LEXAR",35,0)
EN(LEXUR,LEXVDT) ; Interpret user response
"RTN","LEXAR",36,0)
 I '$D(LEX) D APN Q
"RTN","LEXAR",37,0)
 K LEX("HLP")
"RTN","LEXAR",38,0)
 N LEXLL,LEXMAX
"RTN","LEXAR",39,0)
 I $D(LEX("LIST",0)),+$G(^TMP("LEXSCH",$J,"NUM",0))>0 D
"RTN","LEXAR",40,0)
 .S LEX=+$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAR",41,0)
 I LEXUR="END",+LEX>0 S LEXUR="^"_LEX
"RTN","LEXAR",42,0)
 S LEXLL=+$G(^TMP("LEXSCH",$J,"LEN",0))
"RTN","LEXAR",43,0)
 S:LEXLL=0 LEXLL=5
"RTN","LEXAR",44,0)
 S LEXMAX=+$G(^TMP("LEXSCH",$J,"LST",0))
"RTN","LEXAR",45,0)
 S LEXUR=$G(LEXUR)
"RTN","LEXAR",46,0)
 S (LEX("RES"),^TMP("LEXSCH",$J,"RES",0))=LEXUR
"RTN","LEXAR",47,0)
 S ^TMP("LEXSCH",$J,"RES",1)="User Response"
"RTN","LEXAR",48,0)
 ; Timed out/Quit
"RTN","LEXAR",49,0)
 I LEXUR="DTOUT"!(LEXUR="QUIT") D EDA Q
"RTN","LEXAR",50,0)
 ; Yes/No response list has one entry
"RTN","LEXAR",51,0)
 I $G(LEX)=1,+LEXUR=0,LEXUR'["^" D
"RTN","LEXAR",52,0)
 .I $E(LEXUR,1)="Y"!($E(LEXUR,1)="y") S LEXUR=1 Q
"RTN","LEXAR",53,0)
 .I LEXUR["?" D HLP^LEXAR3 Q
"RTN","LEXAR",54,0)
 .S LEXUR=""
"RTN","LEXAR",55,0)
 ; Null (Page Down)
"RTN","LEXAR",56,0)
 I LEXUR="" D NULL^LEXAR2 D END Q
"RTN","LEXAR",57,0)
 ; Minus (Page Up)
"RTN","LEXAR",58,0)
 I $E(LEXUR,1)="-" D LIST^LEXAL2("PGUP") D END Q
"RTN","LEXAR",59,0)
 ; Help
"RTN","LEXAR",60,0)
 I LEXUR["?" D HLP^LEXAR3 D END Q
"RTN","LEXAR",61,0)
 ; Up Arrow
"RTN","LEXAR",62,0)
 I LEXUR["^",$D(^TMP("LEXSCH",$J)) D UPA^LEXAR2(LEXUR) D END Q
"RTN","LEXAR",63,0)
 ; Select
"RTN","LEXAR",64,0)
 I +LEXUR>0,+LEXUR'>LEXMAX D SEL^LEXAR4(+LEXUR,$G(LEXVDT)) D END Q
"RTN","LEXAR",65,0)
 ; User Unresolved Narrative
"RTN","LEXAR",66,0)
 I LEXUR=$G(^TMP("LEXSCH",$J,"NAR",0)),+$G(^TMP("LEXSCH",$J,"UNR",0))=1 D  D END Q
"RTN","LEXAR",67,0)
 .D SAVE^LEXAR6
"RTN","LEXAR",68,0)
APN ; Application Unresolved Narrative
"RTN","LEXAR",69,0)
 I LEXUR["^",'$D(^TMP("LEXSCH",$J)),+LEXUR>0,$D(^LEX(757.01,+LEXUR,0)),$L($P(LEXUR,"^",2)) D  Q
"RTN","LEXAR",70,0)
 .K LEX
"RTN","LEXAR",71,0)
 .D COM^LEXAR6(LEXUR)
"RTN","LEXAR",72,0)
 D END
"RTN","LEXAR",73,0)
 Q
"RTN","LEXAR",74,0)
END ; End of Interpretation of the Users Response
"RTN","LEXAR",75,0)
 I $D(^TMP("LEXSCH",$J)) D
"RTN","LEXAR",76,0)
 .S (LEX("RES"),^TMP("LEXSCH",$J,"RES",0))=LEXUR
"RTN","LEXAR",77,0)
 .S ^TMP("LEXSCH",$J,"RES",1)="User Response"
"RTN","LEXAR",78,0)
 I $D(LEX("LIST",0)),+$G(^TMP("LEXSCH",$J,"NUM",0))>0 D
"RTN","LEXAR",79,0)
 .S LEX=+$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAR",80,0)
 Q
"RTN","LEXAR",81,0)
SEL ; Selection made
"RTN","LEXAR",82,0)
 K LEX("RES"),LEX("ERR"),LEX("LIST"),LEX("MIN"),LEX("MAX"),LEX("MAT"),LEX("HLP")
"RTN","LEXAR",83,0)
 D NAR,EMF,KLST,KSCH
"RTN","LEXAR",84,0)
 S:$D(LEX("SEL")) LEX=0
"RTN","LEXAR",85,0)
 Q
"RTN","LEXAR",86,0)
EDU ; End Dialog with the User
"RTN","LEXAR",87,0)
 D NAR,EMF,KLST,KARL,KSCH
"RTN","LEXAR",88,0)
 S LEX=0
"RTN","LEXAR",89,0)
 Q
"RTN","LEXAR",90,0)
EDA ; End Dialog with the Application
"RTN","LEXAR",91,0)
 K LEX
"RTN","LEXAR",92,0)
 D KLST,KSCH
"RTN","LEXAR",93,0)
 Q
"RTN","LEXAR",94,0)
LST ; List exist
"RTN","LEXAR",95,0)
 D NAR,MAX,MIN,MAT,EML
"RTN","LEXAR",96,0)
 Q
"RTN","LEXAR",97,0)
 ;
"RTN","LEXAR",98,0)
KLST ; Kill Global List 
"RTN","LEXAR",99,0)
 ;      ^TMP("LEXFND",$J)
"RTN","LEXAR",100,0)
 ;      ^TMP("LEXHIT",$J)
"RTN","LEXAR",101,0)
 K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","LEXAR",102,0)
 Q
"RTN","LEXAR",103,0)
KSCH ; Kill Search Variables
"RTN","LEXAR",104,0)
 ;      ^TMP("LEXSCH",$J)
"RTN","LEXAR",105,0)
 ; PCH 55 - The only way to kill ^TMP("LEXSCH",$J) is exiting LEXA1
"RTN","LEXAR",106,0)
 Q
"RTN","LEXAR",107,0)
KARL ; Kill Array List and supporting variables
"RTN","LEXAR",108,0)
 ;       LEX("LIST"),LEX("MAT"),LEX("MIN"),LEX("MAX")
"RTN","LEXAR",109,0)
 K LEX("LIST"),LEX("MAT"),LEX("MIN"),LEX("MAX")
"RTN","LEXAR",110,0)
 K LEX("EXC"),LEX("EXM")
"RTN","LEXAR",111,0)
 Q
"RTN","LEXAR",112,0)
LEX ; Set LEX to the number of entries on the list
"RTN","LEXAR",113,0)
 S:+$G(^TMP("LEXSCH",$J,"NUM",0))>0 LEX=+$G(^TMP("LEXSCH",$J,"NUM",0))
"RTN","LEXAR",114,0)
 Q
"RTN","LEXAR",115,0)
NAR ; Set LEX("NAR") to the user narrative
"RTN","LEXAR",116,0)
 K LEX("NAR")
"RTN","LEXAR",117,0)
 S:$L($G(^TMP("LEXSCH",$J,"NAR",0))) LEX("NAR")=$G(^TMP("LEXSCH",$J,"NAR",0))
"RTN","LEXAR",118,0)
 Q
"RTN","LEXAR",119,0)
MAX ; Set LEX("MAX") to the last entry reviewed by the user
"RTN","LEXAR",120,0)
 K LEX("MAX")
"RTN","LEXAR",121,0)
 S:+$G(^TMP("LEXSCH",$J,"LST",0))>0 LEX("MAX")=+$G(^TMP("LEXSCH",$J,"LST",0))
"RTN","LEXAR",122,0)
 Q
"RTN","LEXAR",123,0)
MIN ; Set LEX("MIN") to the first entry reviewed by the user
"RTN","LEXAR",124,0)
 K LEX("MIN")
"RTN","LEXAR",125,0)
 S:+$G(LEX("MAX"))>0 LEX("MIN")=1
"RTN","LEXAR",126,0)
 Q
"RTN","LEXAR",127,0)
EML ; Set LEX("EXM") post-selection IEN^Expression text
"RTN","LEXAR",128,0)
 K LEX("EXM")
"RTN","LEXAR",129,0)
 S:$L($G(^TMP("LEXSCH",$J,"EXM",2))) LEX("EXM")=$G(^TMP("LEXSCH",$J,"EXM",2))
"RTN","LEXAR",130,0)
 Q
"RTN","LEXAR",131,0)
EMF ; Set LEX("EXM") pre-selection LIST#^Expression text
"RTN","LEXAR",132,0)
 K LEX("EXM")
"RTN","LEXAR",133,0)
 I $L($G(^TMP("LEXSCH",$J,"EXM",0))),$L($G(^TMP("LEXSCH",$J,"EXM",1))) D
"RTN","LEXAR",134,0)
 .S LEX("EXM")=$G(^TMP("LEXSCH",$J,"EXM",0))_"^"_$G(^TMP("LEXSCH",$J,"EXM",1))
"RTN","LEXAR",135,0)
 Q
"RTN","LEXAR",136,0)
MAT ; Set "matches found" string and top of list flag
"RTN","LEXAR",137,0)
 ;       LEX("MAT")                 # Matches found
"RTN","LEXAR",138,0)
 ;       ^TMP("LEXSCH",$J,"TOL",0)  1 - Top of list
"RTN","LEXAR",139,0)
 ;                                   0 - Not top of list
"RTN","LEXAR",140,0)
 K LEX("MAT")
"RTN","LEXAR",141,0)
 I $D(LEX("SEL"))!('$D(^TMP("LEXSCH",$J)))!('$D(LEX("LIST"))) Q
"RTN","LEXAR",142,0)
 N LEXOL,LEXL
"RTN","LEXAR",143,0)
 S LEXOL=$G(^TMP("LEXSCH",$J,"TOL",0))
"RTN","LEXAR",144,0)
 S LEXL=$O(LEX("LIST",0))
"RTN","LEXAR",145,0)
 I LEXOL'=0,LEXL=1 S ^TMP("LEXSCH",$J,"TOL",0)=1
"RTN","LEXAR",146,0)
 I LEXOL'=0,LEXL'=1 S ^TMP("LEXSCH",$J,"TOL",0)=0
"RTN","LEXAR",147,0)
 I LEXOL=1,$L($G(^TMP("LEXSCH",$J,"MAT",0))) D
"RTN","LEXAR",148,0)
 .S LEX("MAT")=$G(^TMP("LEXSCH",$J,"MAT",0))
"RTN","LEXAR",149,0)
 Q
"RTN","LEXAR4")
0^14^B9905737
"RTN","LEXAR4",1,0)
LEXAR4 ;ISL/KER - Look-up Response (Select Entry) ;11/30/2008
"RTN","LEXAR4",2,0)
 ;;2.0;LEXICON UTILITY;**4,5,6,25,55**;Sep 23, 1996;Build 11
"RTN","LEXAR4",3,0)
 ;
"RTN","LEXAR4",4,0)
 ; External References
"RTN","LEXAR4",5,0)
 ;   DBIA 10086  HOME^%ZIS
"RTN","LEXAR4",6,0)
 ;   DBIA 10063  ^%ZTLOAD
"RTN","LEXAR4",7,0)
 ;   DBIA 10018  ^DIE
"RTN","LEXAR4",8,0)
 ;                    
"RTN","LEXAR4",9,0)
SEL(LEXUR,LEXVDT) ; Select # on list
"RTN","LEXAR4",10,0)
 K LEX("SEL") N LEXLVL,LEXMAX,LEXLF S LEXLF=1,LEXMAX=+($G(^TMP("LEXSCH",$J,"LST",0)))
"RTN","LEXAR4",11,0)
 S LEX=+($G(LEX)),LEXUR=+($G(LEXUR))
"RTN","LEXAR4",12,0)
 I LEXMAX=0!(LEX=0) D EDA^LEXAR G SELQ
"RTN","LEXAR4",13,0)
 K LEX("ERR"),LEX("SEL") I LEXUR'>0!(LEXUR>LEXMAX) D  G SELQ
"RTN","LEXAR4",14,0)
 . S LEX("ERR",0)=+($G(LEX("ERR",0)))+1
"RTN","LEXAR4",15,0)
 . S LEX("ERR",LEX("ERR",0))="User response out of range"
"RTN","LEXAR4",16,0)
 I '$D(^TMP("LEXHIT",$J,LEXUR)) D  G SELQ
"RTN","LEXAR4",17,0)
 . S LEX("ERR",0)=+($G(LEX("ERR",0)))+1
"RTN","LEXAR4",18,0)
 . S LEX("ERR",LEX("ERR",0))="Selection is either out of range or invalid"
"RTN","LEXAR4",19,0)
 N LEXEXP S LEXEXP=+($P(^TMP("LEXHIT",$J,LEXUR),"^",1))
"RTN","LEXAR4",20,0)
 I '$D(^LEX(757.01,LEXEXP,0)) D  G SELQ
"RTN","LEXAR4",21,0)
 . S LEX("ERR",0)=+($G(LEX("ERR",0)))+1
"RTN","LEXAR4",22,0)
 . S LEX("ERR",LEX("ERR",0))="Selection not found in the Lexicon"
"RTN","LEXAR4",23,0)
 ; Set concept level, if modifiers are allowed build list
"RTN","LEXAR4",24,0)
 S LEXLVL=+($G(LEX("LVL"))) I LEXLVL'>1,+LEXEXP>2,$D(^LEX(757.01,+LEXEXP,0)),+($G(^TMP("LEXSCH",$J,"MOD",0)))>0 D EN^LEXAMD(LEXEXP,$G(LEXVDT))
"RTN","LEXAR4",25,0)
 ; Quit if modifiers found at next level
"RTN","LEXAR4",26,0)
 G:+($G(LEX("LVL")))>LEXLVL SELQ
"RTN","LEXAR4",27,0)
 D SET(LEXEXP,$G(LEXVDT)),EDU^LEXAR
"RTN","LEXAR4",28,0)
 G SELQ
"RTN","LEXAR4",29,0)
SET(LEXEXP,LEXVDT) ; Set LEX("SEL") Nodes
"RTN","LEXAR4",30,0)
 K LEX("SEL") D SETEXP^LEXAR5(LEXEXP)
"RTN","LEXAR4",31,0)
 N LEXMC S LEXMC=+($P(^LEX(757.01,LEXEXP,1),"^",1))
"RTN","LEXAR4",32,0)
 ; If selected from the list increment frequency
"RTN","LEXAR4",33,0)
 D:+($G(^TMP("LEXSCH",$J,"LST",0)))>0&(+($G(^TMP("LEXSCH",$J,"APP",0)))>1) INC(LEXMC)
"RTN","LEXAR4",34,0)
 N LEXMCE S LEXMCE=+(^LEX(757,LEXMC,0))
"RTN","LEXAR4",35,0)
 D SETSRC^LEXAR5(LEXEXP,$G(LEXVDT))
"RTN","LEXAR4",36,0)
 D:'$D(LEX("SEL","SRC","D",LEXMCE))&(LEXMCE'=LEXEXP) SETSRC^LEXAR5(LEXMCE,$G(LEXVDT))
"RTN","LEXAR4",37,0)
 D SETDEF^LEXAR5(LEXMCE)
"RTN","LEXAR4",38,0)
 D SETSTY^LEXAR5(LEXMC)
"RTN","LEXAR4",39,0)
 N LEXE S LEXE=0 F  S LEXE=$O(^LEX(757.01,"AMC",LEXMC,LEXE)) Q:+LEXE=0  D
"RTN","LEXAR4",40,0)
 . Q:LEXE=LEXEXP  D SETEXP^LEXAR5(LEXE),SETSRC^LEXAR5(LEXE,$G(LEXVDT))
"RTN","LEXAR4",41,0)
 G:+($G(LEXLF))=0 SELQ
"RTN","LEXAR4",42,0)
 Q
"RTN","LEXAR4",43,0)
INC(LEXMC) ; Increment frequency counter in ^LEX(757)
"RTN","LEXAR4",44,0)
 N LEXF,LEXFQ S LEXMC=+($G(LEXMC)) Q:LEXMC=0  Q:'$D(^LEX(757,LEXMC))
"RTN","LEXAR4",45,0)
 S ZTSAVE("LEXMC")="",ZTRTN="FQ^LEXAR4",ZTDESC="Updating Lexicon Frequencies",ZTIO="",ZTDTH=$H
"RTN","LEXAR4",46,0)
 D ^%ZTLOAD,HOME^%ZIS K Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN
"RTN","LEXAR4",47,0)
 Q
"RTN","LEXAR4",48,0)
FQ ; Edit Concept Frequency
"RTN","LEXAR4",49,0)
 N LEXA,LEXM,LEXQ,LEXS,DA,DIC,DIE S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXAR4",50,0)
 S LEXM=+($G(LEXMC)) Q:LEXM=0  Q:'$D(^LEX(757,LEXM,0))
"RTN","LEXAR4",51,0)
 I '$D(^LEX(757.001,LEXM,0)) D AFQ G FQQ
"RTN","LEXAR4",52,0)
 S LEXQ=+($P($G(^LEX(757.001,LEXM,0)),"^",3)),LEXQ=LEXQ+1
"RTN","LEXAR4",53,0)
 S DA=+($G(LEXM)) Q:+DA=0  Q:'$D(^LEX(757.001,DA,0))
"RTN","LEXAR4",54,0)
 S LEXM=+($G(LEXMC)) Q:'$D(^LEX(757,LEXMC,0))  S LEXA=0
"RTN","LEXAR4",55,0)
 S (DIC,DIE)="^LEX(757.001,",DR="2////^S X=LEXQ"
"RTN","LEXAR4",56,0)
EFQ ; Lock record and edit frequency record
"RTN","LEXAR4",57,0)
 L +^LEX(757.001,+DA):1 I '$T S LEXA=LEXA+1 H 2 G:LEXA<4 EFQ
"RTN","LEXAR4",58,0)
 D:LEXA<4 ^DIE L -^LEX(757.001,+DA)
"RTN","LEXAR4",59,0)
 G FQQ
"RTN","LEXAR4",60,0)
 Q
"RTN","LEXAR4",61,0)
AFQ ; Add frequency record
"RTN","LEXAR4",62,0)
 N DIC,DA S ^LEX(757.001,LEXM,0)=LEXM_"^0^0" S DIC="^LEX(757.001,",DA=LEXM D SET^LEXNDX2 Q
"RTN","LEXAR4",63,0)
 Q
"RTN","LEXAR4",64,0)
FQQ ; Quit Frequency
"RTN","LEXAR4",65,0)
 Q
"RTN","LEXAR4",66,0)
SELQ ; Quit Selection
"RTN","LEXAR4",67,0)
 D:$D(LEX("SEL")) SEL^LEXAR
"RTN","LEXAR4",68,0)
 D:$D(LEX("LIST")) LST^LEXAR
"RTN","LEXAR4",69,0)
 Q
"RTN","LEXAR5")
0^15^B25098898
"RTN","LEXAR5",1,0)
LEXAR5 ;ISL/KER - Look-up Response (Select Entry) ;09/08/2008
"RTN","LEXAR5",2,0)
 ;;2.0;LEXICON UTILITY;**14,25,26,38,55**;Sep 23, 1996;Build 11
"RTN","LEXAR5",3,0)
 ;
"RTN","LEXAR5",4,0)
 ; External References
"RTN","LEXAR5",5,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","LEXAR5",6,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","LEXAR5",7,0)
 ;   DBIA  3992  $$STATCHK^ICDAPIU
"RTN","LEXAR5",8,0)
 ;   DBIA  1997  $$STATCHK^ICPTAPIU
"RTN","LEXAR5",9,0)
 ;   DBIA  1612  ^YSD(627.7,
"RTN","LEXAR5",10,0)
 ;                  
"RTN","LEXAR5",11,0)
SETEXP(LEXX)   ; Set LEX("SEL","EXP")
"RTN","LEXAR5",12,0)
 S LEXX=+($G(LEXX)) Q:LEXX'>0  Q:'$D(^LEX(757.01,LEXX,0))
"RTN","LEXAR5",13,0)
 N LEXYPE S LEXYPE=$$TYPE(LEXX)
"RTN","LEXAR5",14,0)
 N LEXC S LEXC=+($G(LEX("SEL","EXP",0))),LEXC=LEXC+1
"RTN","LEXAR5",15,0)
 S LEX("SEL","EXP",LEXC)=LEXX_"^"_^LEX(757.01,LEXX,0),LEX("SEL","EXP",0)=LEXC
"RTN","LEXAR5",16,0)
 S LEX("SEL","EXP","B",LEXX,LEXC)=""
"RTN","LEXAR5",17,0)
 S:LEXYPE'="" LEX("SEL","EXP","C",LEXYPE,LEXC)=""
"RTN","LEXAR5",18,0)
 Q
"RTN","LEXAR5",19,0)
TYPE(LEXX)     ; Expression Type
"RTN","LEXAR5",20,0)
 N LEXYPE S LEXYPE=$P($G(^LEX(757.01,LEXX,1)),"^",2)
"RTN","LEXAR5",21,0)
 I +LEXYPE'>0!('$D(^LEX(757.011,+LEXYPE,0))) S LEXYPE="OTH"
"RTN","LEXAR5",22,0)
 I +LEXYPE>0,$D(^LEX(757.011,+LEXYPE,0)) D
"RTN","LEXAR5",23,0)
 . S LEXYPE=$P($G(^LEX(757.011,+LEXYPE,0)),"^",1)
"RTN","LEXAR5",24,0)
 . S:$L(LEXYPE)<3 LEXYPE="OTH"
"RTN","LEXAR5",25,0)
 . S LEXYPE=$$UP^XLFSTR($E(LEXYPE,1,3))
"RTN","LEXAR5",26,0)
 S LEXX=LEXYPE Q LEXX
"RTN","LEXAR5",27,0)
SETDEF(LEXX)   ; Set LEX("SEL","SIG")
"RTN","LEXAR5",28,0)
 S LEXX=+($G(LEXX)) Q:LEXX=0
"RTN","LEXAR5",29,0)
 Q:'$D(^LEX(757.01,LEXX,3,1,0))
"RTN","LEXAR5",30,0)
 N LEXC,LEXR S LEXR=0
"RTN","LEXAR5",31,0)
 F  S LEXR=$O(^LEX(757.01,LEXX,3,LEXR)) Q:+LEXR=0  D
"RTN","LEXAR5",32,0)
 . S LEXC=+($G(LEX("SEL","SIG",0))),LEXC=LEXC+1
"RTN","LEXAR5",33,0)
 . S LEX("SEL","SIG",LEXC)=$G(^LEX(757.01,LEXX,3,LEXR,0))
"RTN","LEXAR5",34,0)
 . S LEX("SEL","SIG",0)=LEXC
"RTN","LEXAR5",35,0)
 Q
"RTN","LEXAR5",36,0)
SETSTY(LEXX)   ; Set LEX("SEL","STY")
"RTN","LEXAR5",37,0)
 S LEXX=+($G(LEXX)) Q:LEXX=0
"RTN","LEXAR5",38,0)
 Q:'$D(^LEX(757.1,"B",LEXX))
"RTN","LEXAR5",39,0)
 N LEXC,LEXR,LEXSC,LEXST S LEXR=0
"RTN","LEXAR5",40,0)
 F  S LEXR=$O(^LEX(757.1,"B",LEXX,LEXR)) Q:+LEXR=0  D
"RTN","LEXAR5",41,0)
 . S LEXSC=+($P($G(^LEX(757.1,LEXR,0)),"^",2)) Q:LEXSC=0  Q:'$D(^LEX(757.11,LEXSC))
"RTN","LEXAR5",42,0)
 . S LEXSC=$P($G(^LEX(757.11,LEXSC,0)),"^",2) Q:'$L(LEXSC)
"RTN","LEXAR5",43,0)
 . S LEXST=+($P($G(^LEX(757.1,LEXR,0)),"^",3)) Q:LEXST=0  Q:'$D(^LEX(757.12,LEXST))
"RTN","LEXAR5",44,0)
 . S LEXST=$P($G(^LEX(757.12,LEXST,0)),"^",2) Q:'$L(LEXST)
"RTN","LEXAR5",45,0)
 . S LEXC=+($G(LEX("SEL","STY",0))),LEXC=LEXC+1
"RTN","LEXAR5",46,0)
 . S LEX("SEL","STY",LEXC)=LEXSC_"^"_LEXST
"RTN","LEXAR5",47,0)
 . S LEX("SEL","STY",0)=LEXC
"RTN","LEXAR5",48,0)
 Q
"RTN","LEXAR5",49,0)
SETSRC(LEXX,LEXVDT)     ; Set LEX("SEL","SRC")
"RTN","LEXAR5",50,0)
 N LEXSO,LEXSRC,LEXS,LEXC,LEXLD,LEXLS,LEXSN S LEXS=0
"RTN","LEXAR5",51,0)
 F  S LEXS=$O(^LEX(757.02,"B",LEXX,LEXS)) Q:+LEXS=0  D
"RTN","LEXAR5",52,0)
 . S LEXSN=$G(^LEX(757.02,LEXS,0)),LEXSO=$P(LEXSN,"^",2),LEXSRC=$P(LEXSN,"^",3) Q:LEXSRC=0
"RTN","LEXAR5",53,0)
 . Q:+$$STATCHK^LEXSRC2(LEXSO,LEXVDT)'=1
"RTN","LEXAR5",54,0)
 . Q:'$D(^LEX(757.02,"AVA",(LEXSO_" "),LEXX))
"RTN","LEXAR5",55,0)
 . S LEXSRC=$P(^LEX(757.03,LEXSRC,0),"^",2) Q:'$L(LEXSRC)
"RTN","LEXAR5",56,0)
 . S LEXC=+($G(LEX("SEL","SRC",0))),LEXC=LEXC+1
"RTN","LEXAR5",57,0)
 . S LEX("SEL","SRC",LEXC)=LEXSRC_"^"_LEXSO_"^"_LEXX
"RTN","LEXAR5",58,0)
 . S LEX("SEL","SRC","B",LEXSRC,LEXC)=""
"RTN","LEXAR5",59,0)
 . S LEX("SEL","SRC","C",LEXSO,LEXC)=""
"RTN","LEXAR5",60,0)
 . S LEX("SEL","SRC","D",LEXX,LEXC)=""
"RTN","LEXAR5",61,0)
 . S LEX("SEL","SRC",0)=LEXC
"RTN","LEXAR5",62,0)
 D SETVAS(LEXX,+($G(LEXVDT)))
"RTN","LEXAR5",63,0)
 Q
"RTN","LEXAR5",64,0)
SETVAS(LEXX,LEXVDT)     ; Find VA sources for LEX("SEL","VAS")
"RTN","LEXAR5",65,0)
 N LEXSAB,LEXRTN,LEXR,LEXVP S LEXVDT=$S(+($G(LEXVDT))>0:+($G(LEXVDT)),1:$$DT^XLFDT)
"RTN","LEXAR5",66,0)
 F LEXSAB="ICD","ICP","CPT","DS4" D
"RTN","LEXAR5",67,0)
 . K LEXSRC S LEXRTN=LEXSAB_"^LEXAR5"
"RTN","LEXAR5",68,0)
 . D ALL^LEXSRC(LEXX,LEXSAB,LEXVDT) I +($G(LEXSRC(0)))>0 D @LEXRTN
"RTN","LEXAR5",69,0)
 Q
"RTN","LEXAR5",70,0)
ICD ; Intl' Classification of Diseases (diagnosis)
"RTN","LEXAR5",71,0)
 N LEXO,LEXI,LEXSO,LEXR,LEXVP S LEXI=0 F  S LEXI=$O(LEXSRC(LEXI)) Q:+LEXI=0  D
"RTN","LEXAR5",72,0)
 . S LEXSO=$G(LEXSRC(LEXI)) Q:LEXSO=""
"RTN","LEXAR5",73,0)
 . S LEXO=$$STATCHK^ICDAPIU(LEXSO,+($G(LEXVDT))) Q:+LEXO'>0
"RTN","LEXAR5",74,0)
 . S LEXO=+($P(LEXO,"^",2)) Q:+LEXO'>0  S LEXC=+($G(LEX("SEL","VAS",0)))+1
"RTN","LEXAR5",75,0)
 . S LEXVP=+LEXO_";ICD9(" D VAS("80",LEXSO,LEXX,LEXVP,LEXC)
"RTN","LEXAR5",76,0)
 Q
"RTN","LEXAR5",77,0)
ICP ; Intl' Classification of Diseases (procedures)
"RTN","LEXAR5",78,0)
 N LEXI,LEXSO,LEXR,LEXVP S LEXI=0 F  S LEXI=$O(LEXSRC(LEXI)) Q:+LEXI=0  D
"RTN","LEXAR5",79,0)
 . S LEXSO=$G(LEXSRC(LEXI)) Q:LEXSO=""
"RTN","LEXAR5",80,0)
 . S LEXO=$$STATCHK^ICDAPIU(LEXSO,+($G(LEXVDT))) Q:+LEXO'>0
"RTN","LEXAR5",81,0)
 . S LEXO=+($P(LEXO,"^",2)) Q:+LEXO'>0  S LEXC=+($G(LEX("SEL","VAS",0)))+1
"RTN","LEXAR5",82,0)
 . S LEXVP=+LEXO_";ICD0(" D VAS("80.1",LEXSO,LEXX,LEXVP,LEXC)
"RTN","LEXAR5",83,0)
 Q
"RTN","LEXAR5",84,0)
CPT ; Current Procedural Terminology
"RTN","LEXAR5",85,0)
 N LEXI,LEXSO,LEXR,LEXVP S LEXI=0 F  S LEXI=$O(LEXSRC(LEXI)) Q:+LEXI=0  D
"RTN","LEXAR5",86,0)
 . S LEXSO=$G(LEXSRC(LEXI)) Q:LEXSO=""
"RTN","LEXAR5",87,0)
 . S LEXO=$$STATCHK^ICPTAPIU(LEXSO,+($G(LEXVDT))) Q:+LEXO'>0
"RTN","LEXAR5",88,0)
 . S LEXO=+($P(LEXO,"^",2)) Q:+LEXO'>0  S LEXC=+($G(LEX("SEL","VAS",0)))+1
"RTN","LEXAR5",89,0)
 . S LEXVP=+LEXO_";ICPT(" D VAS("81",LEXSO,LEXX,LEXVP,LEXC)
"RTN","LEXAR5",90,0)
 Q
"RTN","LEXAR5",91,0)
DS4 ; Diagnostic and Statistical Manual of Mental Disorders
"RTN","LEXAR5",92,0)
 Q:'$D(LEXX)  S LEXX=+($G(LEXX)) Q:LEXX=0  Q:'$D(^LEX(757.01,LEXX,0))
"RTN","LEXAR5",93,0)
 N LEXEXP,LEXR,LEXVP,LEXI,LEXSO,LEXVA,LEXIEN,LEXC S LEXEXP=$G(^LEX(757.01,LEXX,0)) Q:'$L(LEXEXP)
"RTN","LEXAR5",94,0)
 S LEXI=0 F  S LEXI=$O(LEXSRC(LEXI)) Q:+LEXI=0  D
"RTN","LEXAR5",95,0)
 . S LEXSO=$G(LEXSRC(LEXI)) Q:LEXSO=""  Q:'$D(^YSD(627.7,"B",LEXSO))  N LEXVA,LEXIEN S (LEXIEN,LEXVA)=0
"RTN","LEXAR5",96,0)
 . F  S LEXVA=$O(^YSD(627.7,"B",LEXSO,LEXVA)) Q:+LEXVA=0  D
"RTN","LEXAR5",97,0)
 . . I $$UP($G(^YSD(627.7,LEXVA,"D")))=$$UP(LEXEXP) S LEXIEN=LEXVA
"RTN","LEXAR5",98,0)
 . Q:LEXIEN=0  S LEXR=LEXIEN,LEXC=+($G(LEX("SEL","VAS",0))),LEXC=LEXC+1
"RTN","LEXAR5",99,0)
 . Q:+LEXR'>0  S LEXVP=LEXR_";YSD(627.7," D VAS("627.7",LEXSO,LEXX,LEXVP,LEXC)
"RTN","LEXAR5",100,0)
 Q
"RTN","LEXAR5",101,0)
VAS(LEXFI,LEXSO,LEXIEN,LEXV,LEXCNT)     ; Set LEX("SEL","VAS")
"RTN","LEXAR5",102,0)
 S LEX("SEL","VAS",LEXCNT)=LEXFI_"^"_LEXV_"^"_LEXSO_"^"_LEXIEN
"RTN","LEXAR5",103,0)
 S LEX("SEL","VAS","B",LEXFI,LEXCNT)=""
"RTN","LEXAR5",104,0)
 S LEX("SEL","VAS","C",LEXSO,LEXCNT)=""
"RTN","LEXAR5",105,0)
 S LEX("SEL","VAS","D",LEXIEN,LEXCNT)=""
"RTN","LEXAR5",106,0)
 S LEX("SEL","VAS","V",LEXV,LEXCNT)=""
"RTN","LEXAR5",107,0)
 S LEX("SEL","VAS",0)=LEXCNT
"RTN","LEXAR5",108,0)
 Q
"RTN","LEXAR5",109,0)
UP(X) ; Uppercase
"RTN","LEXAR5",110,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","LEXTOLKN")
0^16^B16578878
"RTN","LEXTOLKN",1,0)
LEXTOLKN ;ISL Parse term into words ;11/30/2008
"RTN","LEXTOLKN",2,0)
 ;;2.0;LEXICON UTILITY;**4,55**;Sep 23, 1996;Build 11
"RTN","LEXTOLKN",3,0)
 ;
"RTN","LEXTOLKN",4,0)
 ; Returns ^TMP("LEXTKN",$J,#,WORD) containing words
"RTN","LEXTOLKN",5,0)
 ;
"RTN","LEXTOLKN",6,0)
 ; If LEXIDX is set, then the Excluded Words file is used to 
"RTN","LEXTOLKN",7,0)
 ; selectively exclude words from the indexing process.  If
"RTN","LEXTOLKN",8,0)
 ; LEXLOOK is set, then the Excluded Words file is used to 
"RTN","LEXTOLKN",9,0)
 ; selectively exclude words from the look-up process.  If 
"RTN","LEXTOLKN",10,0)
 ; LEXIDX and LEXLOOK do not exist then all words are parsed
"RTN","LEXTOLKN",11,0)
 ; parsed.
"RTN","LEXTOLKN",12,0)
 ;
"RTN","LEXTOLKN",13,0)
PT ; Entry point where DA is defined and X is unknown
"RTN","LEXTOLKN",14,0)
 Q:'$D(DA)  S X=^LEX(757.01,DA,0)
"RTN","LEXTOLKN",15,0)
PTX ; Entry point to parse string (X must exist)
"RTN","LEXTOLKN",16,0)
 N LEXOK,LEXTOKS,LEXTOKS2,LEXTOKI,LEXTOKW,LEXTOLKN,LEXOKC,LEXOKN,LEXOKP,LEXTOKAA,LEXTOKAB,LEXTOKAC K ^TMP("LEXTKN",$J)
"RTN","LEXTOLKN",17,0)
 Q:'$L($G(X))  S LEXTOKS=$TR(X,"-"," "),LEXTOKS=$TR(LEXTOKS,$C(9)," ")
"RTN","LEXTOLKN",18,0)
 ; Remove leading blanks from string
"RTN","LEXTOLKN",19,0)
 F LEXOKP=1:1:$L(LEXTOKS) Q:$E(LEXTOKS,LEXOKP)'[" "
"RTN","LEXTOLKN",20,0)
 S LEXTOKS=$E(LEXTOKS,LEXOKP,$L(LEXTOKS))
"RTN","LEXTOLKN",21,0)
 ; Remove trailing blanks from string
"RTN","LEXTOLKN",22,0)
 F LEXOKP=$L(LEXTOKS):-1:1 Q:$E(LEXTOKS,LEXOKP)'[" "
"RTN","LEXTOLKN",23,0)
 S LEXTOKS=$E(LEXTOKS,1,LEXOKP)
"RTN","LEXTOLKN",24,0)
 ; Remove Punctuation (less slashes)
"RTN","LEXTOLKN",25,0)
 S LEXTOKS=$TR(LEXTOKS,"?`~!@#$%^&*()_-+={}[]\:;,<>","                            ")
"RTN","LEXTOLKN",26,0)
 ; Conditionally remove slashes
"RTN","LEXTOLKN",27,0)
 S:$D(LEXIDX) LEXTOKS=$TR(LEXTOKS,"/"," ")
"RTN","LEXTOLKN",28,0)
 S LEXTOKS=$TR(LEXTOKS,".","")
"RTN","LEXTOLKN",29,0)
 S LEXTOKS=$TR(LEXTOKS,"""","")
"RTN","LEXTOLKN",30,0)
 ; Swtich to UPPERCASE (lower case is not specified by LEXLOW)
"RTN","LEXTOLKN",31,0)
 S:'$D(LEXLOW) LEXTOKS=$$UP^XLFSTR(LEXTOKS)
"RTN","LEXTOLKN",32,0)
 ; Store in temporary array (based on space character)
"RTN","LEXTOLKN",33,0)
 S LEXOKC=0 F LEXTOKI=1:1:$L(LEXTOKS," ") D
"RTN","LEXTOLKN",34,0)
 . N LEXTOKW S LEXTOKW=$P(LEXTOKS," ",LEXTOKI) Q:LEXTOKW=""
"RTN","LEXTOLKN",35,0)
 . I LEXTOKW'["/" D
"RTN","LEXTOLKN",36,0)
 . . S LEXOKC=LEXOKC+1,LEXTOLKN(LEXOKC)=LEXTOKW
"RTN","LEXTOLKN",37,0)
 . . S LEXTOLKN(0)=LEXOKC
"RTN","LEXTOLKN",38,0)
 . I LEXTOKW["/"&('$D(^LEX(757.05,"B",LEXTOKW))) D  Q  ; PCH 4
"RTN","LEXTOLKN",39,0)
 . . N LEXP S LEXP=0 F  S LEXP=LEXP+1 Q:$P(LEXTOKW,"/",LEXP)=""  D
"RTN","LEXTOLKN",40,0)
 . . . S LEXOKC=LEXOKC+1,LEXTOLKN(LEXOKC)=$P(LEXTOKW,"/",LEXP)
"RTN","LEXTOLKN",41,0)
 . . . S LEXTOLKN(0)=LEXOKC
"RTN","LEXTOLKN",42,0)
 . I LEXTOKW["/"&($D(^LEX(757.05,"B",LEXTOKW))) D
"RTN","LEXTOLKN",43,0)
 . . N LEXOKR S LEXOKR=$O(^LEX(757.05,"B",LEXTOKW,0))
"RTN","LEXTOLKN",44,0)
 . . I $P($G(^LEX(757.05,LEXOKR,0)),U,3)="R" D
"RTN","LEXTOLKN",45,0)
 . . . S LEXOKC=LEXOKC+1,LEXTOLKN(LEXOKC)=LEXTOKW
"RTN","LEXTOLKN",46,0)
 . . . S LEXTOLKN(0)=LEXOKC
"RTN","LEXTOLKN",47,0)
 K LEXOKC,LEXOKR
"RTN","LEXTOLKN",48,0)
 I +($G(LEXTOLKN(0)))=0 K LEXTOLKN S ^TMP("LEXTKN",$J,0)=0 G EXIT
"RTN","LEXTOLKN",49,0)
 S LEXTOKW="",LEXOKN=0 F LEXTOKI=1:1:LEXTOLKN(0) D
"RTN","LEXTOLKN",50,0)
 . S LEXTOKW=$G(LEXTOLKN(LEXTOKI))
"RTN","LEXTOLKN",51,0)
 . ; Remove leading blanks
"RTN","LEXTOLKN",52,0)
 . F LEXOKP=1:1:$L(LEXTOKW) Q:$E(LEXTOKW,LEXOKP)'[" "
"RTN","LEXTOLKN",53,0)
 . S LEXTOKW=$E(LEXTOKW,LEXOKP,$L(LEXTOKW))
"RTN","LEXTOLKN",54,0)
 . ; Remove trailing blanks
"RTN","LEXTOLKN",55,0)
 . F LEXOKP=$L(LEXTOKW):-1:1 Q:$E(LEXTOKW,LEXOKP)'[" "
"RTN","LEXTOLKN",56,0)
 . S LEXTOKW=$E(LEXTOKW,1,LEXOKP)
"RTN","LEXTOLKN",57,0)
 . ; Apostrophy "S"
"RTN","LEXTOLKN",58,0)
 . S (LEXTOKAA,LEXTOKAB,LEXTOKAC)="" I $E(LEXTOKW,($L(LEXTOKW)-1),$L(LEXTOKW))["'S" D
"RTN","LEXTOLKN",59,0)
 . . S LEXTOKAA=$TR(LEXTOKW,"'",""),LEXTOKAB=$P(LEXTOKW,"'",1),LEXTOKAC=$P(LEXTOKW,"'",1)_$P(LEXTOKW,"'",2)
"RTN","LEXTOLKN",60,0)
 . ; Pluralized Apostrophy "S"
"RTN","LEXTOLKN",61,0)
 . I '$L((LEXTOKAA_LEXTOKAB_LEXTOKAC)) I $E(LEXTOKW,$L(LEXTOKW))["S",$E(LEXTOKW,($L(LEXTOKW)-1))'["'" D
"RTN","LEXTOLKN",62,0)
 . . N LEXTMP S LEXTMP=$E(LEXTOKW,1,($L(LEXTOKW)-1)) Q:'$L(LEXTMP)  S:$D(^LEX(757.01,"AWRD",LEXTMP)) LEXTOKAA=LEXTMP
"RTN","LEXTOLKN",63,0)
 . ; Apostrophies and spaces
"RTN","LEXTOLKN",64,0)
 . S LEXTOKW=$TR(LEXTOKW,"'",""),LEXTOKW=$TR(LEXTOKW," ","")
"RTN","LEXTOLKN",65,0)
 . ; Numeric only
"RTN","LEXTOLKN",66,0)
 . I $D(LEXIDX) D
"RTN","LEXTOLKN",67,0)
 . . I LEXTOKW'="" S:$D(^LEX(757.04,"ACTION",LEXTOKW,"I")) LEXTOKW=""
"RTN","LEXTOLKN",68,0)
 . . I LEXTOKW'="" S:$D(^LEX(757.04,"ACTION",LEXTOKW,"B")) LEXTOKW=""
"RTN","LEXTOLKN",69,0)
 . I $D(LEXLOOK) D
"RTN","LEXTOLKN",70,0)
 . . I LEXTOKW'="" S:$D(^LEX(757.04,"ACTION",LEXTOKW,"L")) LEXTOKW=""
"RTN","LEXTOLKN",71,0)
 . . I LEXTOKW'="" S:$D(^LEX(757.04,"ACTION",LEXTOKW,"B")) LEXTOKW=""
"RTN","LEXTOLKN",72,0)
 . I $D(LEXIDX),($L($G(LEXTOKAA))!($L($G(LEXTOKAB)))!($L($G(LEXTOKAC)))) D
"RTN","LEXTOLKN",73,0)
 . . I $L(LEXTOKAA) S LEXOKN=+($G(LEXOKN))+1,^TMP("LEXTKN",$J,LEXOKN,LEXTOKAA)=""
"RTN","LEXTOLKN",74,0)
 . . I $L(LEXTOKAB) S LEXOKN=+($G(LEXOKN))+1,^TMP("LEXTKN",$J,LEXOKN,LEXTOKAB)=""
"RTN","LEXTOLKN",75,0)
 . . I $L(LEXTOKAC) S LEXOKN=+($G(LEXOKN))+1,^TMP("LEXTKN",$J,LEXOKN,LEXTOKAC)=""
"RTN","LEXTOLKN",76,0)
 . I $D(LEXOKN),$D(LEXTOKW),LEXTOKW'="" D
"RTN","LEXTOLKN",77,0)
 . . S LEXOKN=+(LEXOKN)+1,^TMP("LEXTKN",$J,LEXOKN,LEXTOKW)=""
"RTN","LEXTOLKN",78,0)
 . S LEXTOKW=""
"RTN","LEXTOLKN",79,0)
 S ^TMP("LEXTKN",$J,0)=LEXOKN
"RTN","LEXTOLKN",80,0)
EXIT ; Clean up and quit
"RTN","LEXTOLKN",81,0)
 K LEXOK,LEXTOKI,LEXOKN,LEXOKP,LEXOKR,LEXTOKS,LEXTOKS2,LEXTOKW,LEXTOLKN,LEXTOKAA,LEXTOKAB,LEXTOKAC
"RTN","LEXTOLKN",82,0)
 Q
"VER")
8.0^22.0
**INSTALL NAME**
RA*5.0*97
"BLD",7281,0)
RA*5.0*97^RADIOLOGY/NUCLEAR MEDICINE^0^3090731^y
"BLD",7281,1,0)
^^1^1^3090526^
"BLD",7281,1,1,0)
Please refer to the Patch Description on FORUM for this build. 
"BLD",7281,4,0)
^9.64PA^78.3^1
"BLD",7281,4,78.3,0)
78.3
"BLD",7281,4,78.3,2,0)
^9.641^78.3^1
"BLD",7281,4,78.3,2,78.3,0)
DIAGNOSTIC CODES  (File-top level)
"BLD",7281,4,78.3,2,78.3,1,0)
^9.6411^6^3
"BLD",7281,4,78.3,2,78.3,1,.001,0)
NUMBER
"BLD",7281,4,78.3,2,78.3,1,.01,0)
DIAGNOSTIC CODE
"BLD",7281,4,78.3,2,78.3,1,6,0)
EXPRESSIONS
"BLD",7281,4,78.3,222)
y^n^p^^^^n^^n
"BLD",7281,4,78.3,224)

"BLD",7281,4,"APDD",78.3,78.3)

"BLD",7281,4,"APDD",78.3,78.3,.001)

"BLD",7281,4,"APDD",78.3,78.3,.01)

"BLD",7281,4,"APDD",78.3,78.3,6)

"BLD",7281,4,"B",78.3,78.3)

"BLD",7281,6.3)
6
"BLD",7281,"ABPKG")
n
"BLD",7281,"INIT")
CRE^RA97PST
"BLD",7281,"KRN",0)
^9.67PA^779.2^20
"BLD",7281,"KRN",.4,0)
.4
"BLD",7281,"KRN",.4,"NM",0)
^9.68A^2^2
"BLD",7281,"KRN",.4,"NM",1,0)
RA IMAGE LOC LIST    FILE #79.1^79.1^0
"BLD",7281,"KRN",.4,"NM",2,0)
RA PROCEDURE LIST    FILE #71^71^0
"BLD",7281,"KRN",.4,"NM","B","RA IMAGE LOC LIST    FILE #79.1",1)

"BLD",7281,"KRN",.4,"NM","B","RA PROCEDURE LIST    FILE #71",2)

"BLD",7281,"KRN",.401,0)
.401
"BLD",7281,"KRN",.402,0)
.402
"BLD",7281,"KRN",.403,0)
.403
"BLD",7281,"KRN",.5,0)
.5
"BLD",7281,"KRN",.84,0)
.84
"BLD",7281,"KRN",3.6,0)
3.6
"BLD",7281,"KRN",3.8,0)
3.8
"BLD",7281,"KRN",9.2,0)
9.2
"BLD",7281,"KRN",9.8,0)
9.8
"BLD",7281,"KRN",9.8,"NM",0)
^9.68A^15^13
"BLD",7281,"KRN",9.8,"NM",2,0)
RA97PST^^0^B30429917
"BLD",7281,"KRN",9.8,"NM",3,0)
RABIRAD^^0^B7783867
"BLD",7281,"KRN",9.8,"NM",4,0)
RADLQ1^^0^B28970876
"BLD",7281,"KRN",9.8,"NM",6,0)
RAO7PC2^^0^B47517488
"BLD",7281,"KRN",9.8,"NM",7,0)
RAPRINT^^0^B31817816
"BLD",7281,"KRN",9.8,"NM",8,0)
RAPRINT1^^0^B27115956
"BLD",7281,"KRN",9.8,"NM",9,0)
RART^^0^B24437904
"BLD",7281,"KRN",9.8,"NM",10,0)
RARTE5^^0^B100088941
"BLD",7281,"KRN",9.8,"NM",11,0)
RARTR1^^0^B53930536
"BLD",7281,"KRN",9.8,"NM",12,0)
RABWORD1^^0^B21044448
"BLD",7281,"KRN",9.8,"NM",13,0)
RA97PST1^^0^B11847551
"BLD",7281,"KRN",9.8,"NM",14,0)
RARTE7^^0^B23848565
"BLD",7281,"KRN",9.8,"NM",15,0)
RAEDCN^^0^B69681618
"BLD",7281,"KRN",9.8,"NM","B","RA97PST",2)

"BLD",7281,"KRN",9.8,"NM","B","RA97PST1",13)

"BLD",7281,"KRN",9.8,"NM","B","RABIRAD",3)

"BLD",7281,"KRN",9.8,"NM","B","RABWORD1",12)

"BLD",7281,"KRN",9.8,"NM","B","RADLQ1",4)

"BLD",7281,"KRN",9.8,"NM","B","RAEDCN",15)

"BLD",7281,"KRN",9.8,"NM","B","RAO7PC2",6)

"BLD",7281,"KRN",9.8,"NM","B","RAPRINT",7)

"BLD",7281,"KRN",9.8,"NM","B","RAPRINT1",8)

"BLD",7281,"KRN",9.8,"NM","B","RART",9)

"BLD",7281,"KRN",9.8,"NM","B","RARTE5",10)

"BLD",7281,"KRN",9.8,"NM","B","RARTE7",14)

"BLD",7281,"KRN",9.8,"NM","B","RARTR1",11)

"BLD",7281,"KRN",19,0)
19
"BLD",7281,"KRN",19.1,0)
19.1
"BLD",7281,"KRN",101,0)
101
"BLD",7281,"KRN",409.61,0)
409.61
"BLD",7281,"KRN",771,0)
771
"BLD",7281,"KRN",779.2,0)
779.2
"BLD",7281,"KRN",870,0)
870
"BLD",7281,"KRN",8989.51,0)
8989.51
"BLD",7281,"KRN",8989.52,0)
8989.52
"BLD",7281,"KRN",8994,0)
8994
"BLD",7281,"KRN","B",.4,.4)

"BLD",7281,"KRN","B",.401,.401)

"BLD",7281,"KRN","B",.402,.402)

"BLD",7281,"KRN","B",.403,.403)

"BLD",7281,"KRN","B",.5,.5)

"BLD",7281,"KRN","B",.84,.84)

"BLD",7281,"KRN","B",3.6,3.6)

"BLD",7281,"KRN","B",3.8,3.8)

"BLD",7281,"KRN","B",9.2,9.2)

"BLD",7281,"KRN","B",9.8,9.8)

"BLD",7281,"KRN","B",19,19)

"BLD",7281,"KRN","B",19.1,19.1)

"BLD",7281,"KRN","B",101,101)

"BLD",7281,"KRN","B",409.61,409.61)

"BLD",7281,"KRN","B",771,771)

"BLD",7281,"KRN","B",779.2,779.2)

"BLD",7281,"KRN","B",870,870)

"BLD",7281,"KRN","B",8989.51,8989.51)

"BLD",7281,"KRN","B",8989.52,8989.52)

"BLD",7281,"KRN","B",8994,8994)

"BLD",7281,"QDEF")
^^^^^^^^^^YES
"BLD",7281,"QUES",0)
^9.62^^
"BLD",7281,"REQB",0)
^9.611^5^4
"BLD",7281,"REQB",1,0)
LEX*2.0*55^2
"BLD",7281,"REQB",2,0)
RA*5.0*95^2
"BLD",7281,"REQB",4,0)
RA*5.0*70^2
"BLD",7281,"REQB",5,0)
RA*5.0*85^2
"BLD",7281,"REQB","B","LEX*2.0*55",1)

"BLD",7281,"REQB","B","RA*5.0*70",4)

"BLD",7281,"REQB","B","RA*5.0*85",5)

"BLD",7281,"REQB","B","RA*5.0*95",2)

"FIA",78.3)
DIAGNOSTIC CODES
"FIA",78.3,0)
^RA(78.3,
"FIA",78.3,0,0)
78.3I
"FIA",78.3,0,1)
y^n^p^^^^n^^n
"FIA",78.3,0,10)

"FIA",78.3,0,11)

"FIA",78.3,0,"RLRO")

"FIA",78.3,0,"VR")
5.0^RA
"FIA",78.3,78.3)
1
"FIA",78.3,78.3,.001)

"FIA",78.3,78.3,.01)

"FIA",78.3,78.3,6)

"INIT")
CRE^RA97PST
"KRN",.4,323,-1)
0^1
"KRN",.4,323,0)
RA IMAGE LOC LIST^3090406.1458^^79.1^^^3090723
"KRN",.4,323,"%D",0)
^^1^1^2940608^
"KRN",.4,323,"%D",1,0)
Generates a list of locations from the Imaging Location file.
"KRN",.4,323,"F",1)
"Location:";C18~.01;C28;""~"Division:";C18~25;C28;""~"Inactivation Date:";C18~19;C37;""~"Imaging Type:";C14~6;C28;""~"Credit Method:";C13~21;C28;""~
"KRN",.4,323,"F",2)
W:$P($G(^RA(79.1,D0,0)),"^",21)="" ?28,"Regular Credit";"";Z;"W:$P($G(^RA(79.1,D0,0)),"^",21)="" ?28,"Regular Credit""~"DSS ID:";C20~22;C28;""~
"KRN",.4,323,"F",3)
"Allow 'Released/Unverified':";C18~17;C47;""~"";S2~"Flash Card Parameters:";C5~"Jacket Label Parameters:";C50~"----------------------";C5~
"KRN",.4,323,"F",4)
"------------------------";C50~"Default Printer:";C5~3;"";C22~"Default Printer :";C50~5;"";C68;L11~"Cards Per Visit:";C5~2;"";C22~
"KRN",.4,323,"F",5)
"Labels Per Visit:";C50~4;"";C68;L11~"Default Format :";C5~7;"";C22~"Default Format  :";C50~11;"";C68;L11~"";S2~"Exam Label Parameters:";C5~
"KRN",.4,323,"F",6)
"Order Parameters:";C50~"----------------------";C5~"-----------------";C50~"Default Printer: [Flash Card Printer]";C5~"Default Printer:";C50~
"KRN",.4,323,"F",7)
16;"";C68;L11~"Labels Per Exam:";C5~8;"";C22~"Cancelation Ptr:";C50~24;"";C68;L11~"Default Format :";C5~9;"";C22~"";S2~"Radiopharmaceutical";C50~
"KRN",.4,323,"F",8)
"Reporting Parameters:";C5~"Dosage Ticket Parameters";C50~"---------------------";C5~"------------------------";C50~"Default Printer:";C5~
"KRN",.4,323,"F",9)
10;"";C22;L25~"Default Printer:";C50~23;"";C68;L11~"Default Header:";C5~12;"";C21~"Default Footer:";C5~13;"";C21~"DX Codes in Rpt:";C5~18;"";C22~
"KRN",.4,323,"F",10)
"Voice Dictation auto-print:";C5~26;"";C33~"";S2~"Allowable Cam/Equip/Rms For This Location:";C5~"------------------------------------------";C5~
"KRN",.4,323,"F",11)
100,.01;"";C10~"";S2~"Default CPT Modifiers for this location:";C5~"----------------------------------------";C5~135,.01;"";C10~
"KRN",.4,323,"F",12)
135,W $P($$MOD^ICPTMOD(X,"I"),"^",3);"";Z;"W $P($$MOD^ICPTMOD(X,"I"),"^",3)"~"";S2~"'Stat' Alert Recipients For This Location:";C5~
"KRN",.4,323,"F",13)
"Urgent Request Alerts?: ";C50~20;"";C75~"------------------------------------------";C5~150,.01;"";C10~
"KRN",.4,323,"H")
Imaging Location List
"KRN",.4,335,-1)
0^2
"KRN",.4,335,0)
RA PROCEDURE LIST^3090406.1442^^71^^^3090406
"KRN",.4,335,"%D",0)
^.4001^1^1^3020603^^^^
"KRN",.4,335,"%D",1,0)
This template is used in the generation of long procedure listings.
"KRN",.4,335,"DXS",1,9)
W:$D(RADIO(0)) !?5,"Default Radiopharmaceutical: ",?39,$$EN1^RAPSAPI(+$P(RADIO(0),"^"),.01)
"KRN",.4,335,"DXS",2,9)
W:$D(RADIO(0)) !?5," Dflt Administration Route : ",?39,$$GET1^DIQ(71.6,+$P(RADIO(0),"^",3)_",",.01)
"KRN",.4,335,"DXS",3,9)
W:$D(RADIO(0)) !?5," Dflt Administration Site  : ",?39,$$GET1^DIQ(71.7,+$P(RADIO(0),"^",4)_",",.01)
"KRN",.4,335,"DXS",4,9)
W:$D(RADIO(0)) !?5," Default Form              : ",?39,$$GET1^DIQ(71.08,D1_","_D0_",",7)
"KRN",.4,335,"DXS",5,9)
W:$D(RAPHARM(0)) !?5,"Default Medication         : ",?39,$$EN1^RAPSAPI(+$P(RAPHARM(0),"^"),.01)
"KRN",.4,335,"DXS",6,9)
S RA1=0 F  S RA1=$O(^RAMIS(71,D0,"MDL",RA1)) Q:'RA1  S RA2=+^(RA1,0) W ?39,$P(^RAMIS(73.1,RA2,0),U),?44,$P(^(0),U,2) W:$O(^RAMIS(71,D0,"MDL",RA1)) !," "
"KRN",.4,335,"F",1)

"KRN",.4,335,"F",2)
S:$P($G(^RA(79.2,+$P($G(^RAMIS(71,D0,0)),"^",12),0)),"^",5)="Y" RADIO="";"";Z;"S:$P($G(^RA(79.2,+$P($G(^RAMIS(71,D0,0)),"^",12),0)),"^",5)="Y" RADIO="""~
"KRN",.4,335,"F",3)
9;C1~.01;C10;"PROCEDURE / CPT MODIFIER";L30~
"KRN",.4,335,"F",4)
175,S DIP(1)=$S($D(^RAMIS(71,D0,2,D1,0)):^(0),1:"") S X=$P(DIP(1),U,1),X=X W X K DIP;C45;X;Z;"INTERNAL(AMIS CODE)"~175,"-";C48;X~175,.01;C50;L30~
"KRN",.4,335,"F",5)
175,2;C85;"MULTIPLIER"~175,3;C100;"BILATERAL"~175,4;C115;"CT HEAD/BODY"~135,.01;C7;""~135,"(";C10~
"KRN",.4,335,"F",6)
135,W $P($$MOD^ICPTMOD(X,"I"),"^",3);C11;"";Z;"W $P($$MOD^ICPTMOD(X,"I"),"^",3)"~135,")";X~
"KRN",.4,335,"F",7)
W !!?5,"Type of Procedure          : ";X;Z;"W !!?5,"Type of Procedure          : ""~6;C40;""~
"KRN",.4,335,"F",8)
D:+$O(^RAMIS(71,D0,"CM",0)) CMDISP^RAMAINP1(D0);"";Z;"D:+$O(^RAMIS(71,D0,"CM",0)) CMDISP^RAMAINP1(D0)"~
"KRN",.4,335,"F",9)
W !?5,"Required Flash Card Printer: ";X;"";Z;"W !?5,"Required Flash Card Printer: ""~3;C40;""~
"KRN",.4,335,"F",10)
W !?5,"Required Flash Card Format : ";X;Z;"W !?5,"Required Flash Card Format : ""~4;C40;""~
"KRN",.4,335,"F",11)
W !?5,"Cost of Procedure          : ";X;Z;"W !?5,"Cost of Procedure          : ""~10;C40;L10;""~
"KRN",.4,335,"F",12)
W !?5,"Health Summary With Request: ";X;Z;"W !?5,"Health Summary With Request: ""~13;C40;""~
"KRN",.4,335,"F",13)
W !?5,"Staff Review of Reports Req: ";X;Z;"W !?5,"Staff Review of Reports Req: ""~7;C40;""~
"KRN",.4,335,"F",14)
W !?5,"Rad Approval of Request Req: ";X;Z;"W !?5,"Rad Approval of Request Req: ""~11;C40;""~
"KRN",.4,335,"F",15)
W !?5,"Type of Imaging            : ";X;Z;"W !?5,"Type of Imaging            : ""~12;C40;""~
"KRN",.4,335,"F",16)
W:$D(RADIO) !?5,"Ask Radiopharmaceutical    :     ";X;Z;"W:$D(RADIO) !?5,"Ask Radiopharmaceutical    :     ""~
"KRN",.4,335,"F",17)
W:$D(RADIO) ?39,$$GET1^DIQ(71,D0_",",2);X;Z;"W:$D(RADIO) ?39,$$GET1^DIQ(71,D0_",",2)"~
"KRN",.4,335,"F",18)
W:$D(RADIO) !?5,"Prompt for Radiopharm RX   : ";X;Z;"W:$D(RADIO) !?5,"Prompt for Radiopharm RX   : ""~
"KRN",.4,335,"F",19)
W:$D(RADIO) ?39,$$GET1^DIQ(71,D0_",",19);X;Z;"W:$D(RADIO) ?39,$$GET1^DIQ(71,D0_",",19)"~
"KRN",.4,335,"F",20)
50,S:$D(RADIO) RADIO(0)=$G(^RAMIS(71,D0,"NUC",D1,0));"";m;Z;"S:$D(RADIO) RADIO(0)=$G(^RAMIS(71,D0,"NUC",D1,0))"~
"KRN",.4,335,"F",21)
50,X DXS(1,9);X;Z;"W:$D(RADIO(0)) !?5,"Default Radiopharmaceutical: ",?39,$$EN1^RAPSAPI(+$P(RADIO(0),"^"),.01)"~
"KRN",.4,335,"F",22)
50,W:$D(RADIO(0)) !?5," Usual Dose                : ",?39,$P(RADIO(0),"^",2);X;Z;"W:$D(RADIO(0)) !?5," Usual Dose                : ",?39,$P(RADIO(0),"^",2)"~
"KRN",.4,335,"F",23)
50,X DXS(2,9);X;Z;"W:$D(RADIO(0)) !?5," Dflt Administration Route : ",?39,$$GET1^DIQ(71.6,+$P(RADIO(0),"^",3)_",",.01)"~
"KRN",.4,335,"F",24)
50,X DXS(3,9);X;Z;"W:$D(RADIO(0)) !?5," Dflt Administration Site  : ",?39,$$GET1^DIQ(71.7,+$P(RADIO(0),"^",4)_",",.01)"~
"KRN",.4,335,"F",25)
50,W:$D(RADIO(0)) !?5," High Adult Dose           : ",?39,$P(RADIO(0),"^",5);X;Z;"W:$D(RADIO(0)) !?5," High Adult Dose           : ",?39,$P(RADIO(0),"^",5)"~
"KRN",.4,335,"F",26)
50,W:$D(RADIO(0)) !?5," Low Adult Dose            : ",?39,$P(RADIO(0),"^",6);X;Z;"W:$D(RADIO(0)) !?5," Low Adult Dose            : ",?39,$P(RADIO(0),"^",6)"~
"KRN",.4,335,"F",27)
50,X DXS(4,9);X;Z;"W:$D(RADIO(0)) !?5," Default Form              : ",?39,$$GET1^DIQ(71.08,D1_","_D0_",",7)"~
"KRN",.4,335,"F",28)
W !?5,"Prompt for Medication?     : ",?39,$$GET1^DIQ(71,D0_",",5);X;Z;"W !?5,"Prompt for Medication?     : ",?39,$$GET1^DIQ(71,D0_",",5)"~
"KRN",.4,335,"F",29)
55,S RAPHARM(0)=$G(^RAMIS(71,D0,"P",D1,0));"";X;Z;"S RAPHARM(0)=$G(^RAMIS(71,D0,"P",D1,0))"~
"KRN",.4,335,"F",30)
55,X DXS(5,9);X;Z;"W:$D(RAPHARM(0)) !?5,"Default Medication         : ",?39,$$EN1^RAPSAPI(+$P(RAPHARM(0),"^"),.01)"~
"KRN",.4,335,"F",31)
55,W:$D(RAPHARM(0)) !?5," Default Dose              : ",?39,$P(RAPHARM(0),"^",2);X;Z;"W:$D(RAPHARM(0)) !?5," Default Dose              : ",?39,$P(RAPHARM(0),"^",2)"~
"KRN",.4,335,"F",32)
W !?5,"Descendents                :";"";X;Z;"W !?5,"Descendents                :""~300,.01;C40;X~300,S RAZ71=+X;"";Z;"S RAZ71=+X"~
"KRN",.4,335,"F",33)
300,D:+$O(^RAMIS(71,RAZ71,"CM",0)) CMDISP^RAMAINP1(RAZ71);"";Z;"D:+$O(^RAMIS(71,RAZ71,"CM",0)) CMDISP^RAMAINP1(RAZ71)"~
"KRN",.4,335,"F",34)
W !?5,"Procedure Message          :";X;Z;"W !?5,"Procedure Message          :""~200,.01;C40;W35;"";X~"Educational Description    :";C6;L28;""~
"KRN",.4,335,"F",35)
500,.01;C40;""~W ?5,"Modality",?32,":";"";Z;"W ?5,"Modality",?32,":""~
"KRN",.4,335,"F",36)
X DXS(6,9);"";X;Z;"S RA1=0 F  S RA1=$O(^RAMIS(71,D0,"MDL",RA1)) Q:'RA1  S RA2=+^(RA1,0) W ?39,$P(^RAMIS(73.1,RA2,0),U),?44,$P(^(0),U,2) W:$O(^RAMIS(71,D0,"MDL",RA1)) !," ""~
"KRN",.4,335,"F",37)
K RAZ71;"";Z;"K RAZ71"~
"KRN",.4,335,"H")
Imaging Procedure List
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3051109^2980407^50
"PKG",18,22,1,"PAH",1,0)
97^3090731
"PKG",18,22,1,"PAH",1,1,0)
^^1^1^3090731
"PKG",18,22,1,"PAH",1,1,1,0)
Please refer to the Patch Description on FORUM for this build. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
13
"RTN","RA97PST")
0^2^B30429917
"RTN","RA97PST",1,0)
RA97PST ;;HINES/RVD Post-init for BI-RADS and File 79.4 ; 10/10/08
"RTN","RA97PST",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**97**;Mar 16, 1998;Build 6
"RTN","RA97PST",3,0)
 ; This is the post-install routine for patch RA*5.0*97
"RTN","RA97PST",4,0)
 ;
"RTN","RA97PST",5,0)
 ; Supported IA's
"RTN","RA97PST",6,0)
 ;    BMES^XPDUTL  =   10141
"RTN","RA97PST",7,0)
 ;    KSP^XUPARAM  =   2541
"RTN","RA97PST",8,0)
 ;    UPDATE^DIE   =   2053
"RTN","RA97PST",9,0)
 ;    GET1^DIQ     =   2056
"RTN","RA97PST",10,0)
 ;    ^XMD         =   10070
"RTN","RA97PST",11,0)
 ;
"RTN","RA97PST",12,0)
 ; Private IA's
"RTN","RA97PST",13,0)
 ;    Set Identifier "WRITE" node          =  5418
"RTN","RA97PST",14,0)
 ;    Insert "I" in ^RA(78.3,0), piece 2   =  5419
"RTN","RA97PST",15,0)
 ;
"RTN","RA97PST",16,0)
 ;1. Add records to file 78.3
"RTN","RA97PST",17,0)
 ; If there are no IENs 1100 thru 1106 and 1200 thru 1202
"RTN","RA97PST",18,0)
 ; then this routine will add records to file #78.3 using
"RTN","RA97PST",19,0)
 ; these IENs and set the 3rd piece of ^RA(78.3,0) to the
"RTN","RA97PST",20,0)
 ; highest IEN under IEN 999.
"RTN","RA97PST",21,0)
 ;
"RTN","RA97PST",22,0)
 ;2. Set the Identifier "WRITE" node for file 78.3's field 6
"RTN","RA97PST",23,0)
 ;
"RTN","RA97PST",24,0)
 ;3. Insert "I" into ^RA(78.3,0), piece 2, after file number
"RTN","RA97PST",25,0)
 Q
"RTN","RA97PST",26,0)
CRE ;create BI-RADS entry in file 78.3
"RTN","RA97PST",27,0)
 I '$D(DUZ)#2 D BMES^XPDUTL("*** Missing DUZ.  Post-init not done. ***") Q
"RTN","RA97PST",28,0)
 N RAIEN,RALEX,RAERR,RA,RAI,RAFLG,RAFDA,RAFAC,RANXT,RAD,RAPA,RAPAPG
"RTN","RA97PST",29,0)
 N RA1,RA2,RA3,RAAA,RACT,RATXT,RAX
"RTN","RA97PST",30,0)
 D BMES^XPDUTL("*** ADDING BI-RADS to file #78.3.")
"RTN","RA97PST",31,0)
 D BIR^RA97PST1("MAMMOGRAM",.RA,"","BIR","MQSA","MAMMOGRAPHY ASSESSMENT CATEGORIES")
"RTN","RA97PST",32,0)
 ;check to see if the facility has records within the 
"RTN","RA97PST",33,0)
 ;1100 thru 1106 and 1200 thru 1202 IEN range within file #78.3,
"RTN","RA97PST",34,0)
 ;the DIAGNOSTIC CODES file. 
"RTN","RA97PST",35,0)
 ;If there are, proceed with the install any way
"RTN","RA97PST",36,0)
 ;but:
"RTN","RA97PST",37,0)
 ;1) DO NOT alter the data (change pointers) in the file at the facility
"RTN","RA97PST",38,0)
 ;2) Send an email to an Outlook mail group identifying the facility 
"RTN","RA97PST",39,0)
 ;   where the conflict occurs.
"RTN","RA97PST",40,0)
 ;If there is no conflict, then add the IEN records to file 78.3
"RTN","RA97PST",41,0)
 ;RAFLG=1 means a record already exist in file 78.3 for the 
"RTN","RA97PST",42,0)
 ;range 1100 thru 1106 and 1200 thru 1202.
"RTN","RA97PST",43,0)
 S RAFLG=0,RANXT=0
"RTN","RA97PST",44,0)
 S RACT=0 ;counts number of successfully added records
"RTN","RA97PST",45,0)
 ;
"RTN","RA97PST",46,0)
 ;example:
"RTN","RA97PST",47,0)
 ; check range 1100 thru 1106 and build RAD array
"RTN","RA97PST",48,0)
 ;    ra(3)="84^Benign ^Category 2"  <-- in
"RTN","RA97PST",49,0)
 ;rad(1102)="84^Benign ^CATEGORY 2"  <-- out
"RTN","RA97PST",50,0)
 ;
"RTN","RA97PST",51,0)
 F RAI=1100:1:1106 D  Q:RAFLG=1
"RTN","RA97PST",52,0)
 .S RANXT=$O(RA(RANXT))
"RTN","RA97PST",53,0)
 .I $D(^RA(78.3,RAI,0)) S RAFLG=1 Q
"RTN","RA97PST",54,0)
 .S RAD(RAI)=RA(RANXT)
"RTN","RA97PST",55,0)
 .S $P(RAD(RAI),U,3)=$$UP^XLFSTR($P(RAD(RAI),U,3))
"RTN","RA97PST",56,0)
 .;remove trailing blank from piece 2
"RTN","RA97PST",57,0)
 .S RAX=$P(RAD(RAI),U,2),RA2=$L(RAX)
"RTN","RA97PST",58,0)
 .S:$E(RAX,RA2)=" " $P(RAD(RAI),U,2)=$E(RAX,1,RA2-1)
"RTN","RA97PST",59,0)
 .Q
"RTN","RA97PST",60,0)
 ; check range 1200 thru 1202
"RTN","RA97PST",61,0)
 I 'RAFLG F RAI=1200:1:1202 D  Q:RAFLG=1
"RTN","RA97PST",62,0)
 .I $D(^RA(78.3,RAI,0)) S RAFLG=1 Q
"RTN","RA97PST",63,0)
 .Q
"RTN","RA97PST",64,0)
 ;
"RTN","RA97PST",65,0)
 ;if RAFLG=1 email Outlook mail group, skip to ID section
"RTN","RA97PST",66,0)
 I RAFLG=1 D  G ID
"RTN","RA97PST",67,0)
 .S RAFAC=$$GET1^DIQ(4,+$$KSP^XUPARAM("INST"),.01)
"RTN","RA97PST",68,0)
 .N XMDUZ,XMSUB,XMTEXT,XMY,XMZ S XMDUZ=.5
"RTN","RA97PST",69,0)
 .S RATXT(1)=RAFAC_" has a conflict with one or more IENS in file 78.3,"
"RTN","RA97PST",70,0)
 .S RATXT(2)="DIAGNOSTIC CODES, in the range 1100-1106 and 1200-1202."
"RTN","RA97PST",71,0)
 .S XMSUB="DIAGNOSTIC CODES file IEN issue @ "_RAFAC,XMTEXT="RATXT("
"RTN","RA97PST",72,0)
 .S XMY(DUZ)=""  ;send Vista email of problem to the patch installer
"RTN","RA97PST",73,0)
 .; Define Outlook mail group to receive email of problem
"RTN","RA97PST",74,0)
 .S XMY("VAOITVHITRadiologyFacilityLevelApplicationIssues@va.gov")=""
"RTN","RA97PST",75,0)
 .NEW DIFROM
"RTN","RA97PST",76,0)
 .D ^XMD,BMES^XPDUTL(.RATXT)
"RTN","RA97PST",77,0)
 .Q
"RTN","RA97PST",78,0)
 ;
"RTN","RA97PST",79,0)
 ; Set up RAAA() for the Abdominal Aortic Aneurysm codes
"RTN","RA97PST",80,0)
 ;raaa(IEN file 78.3)=field .01^field 2^fields 3 and 4
"RTN","RA97PST",81,0)
 F RAI=1:1 S RAX=$T(AAACODE+RAI) Q:RAX=""  D
"RTN","RA97PST",82,0)
 .S RAX=$P(RAX,";;",2) ;redefine RAX
"RTN","RA97PST",83,0)
 .S RA1=$P(RAX,U,1),RA2=$P(RAX,U,2),RA3=$P(RAX,U,3)
"RTN","RA97PST",84,0)
 .S:RA2=1 $P(RAAA(RA1),U,1)=RA3
"RTN","RA97PST",85,0)
 .S:RA2=2 $P(RAAA(RA1),U,2)=RA3
"RTN","RA97PST",86,0)
 .S:RA2=3 $P(RAAA(RA1),U,3)=RA3
"RTN","RA97PST",87,0)
 .Q
"RTN","RA97PST",88,0)
 ;
"RTN","RA97PST",89,0)
 ;Add the BI-RADS codes to file 78.3
"RTN","RA97PST",90,0)
 D
"RTN","RA97PST",91,0)
 .S RAI=0 F  S RAI=$O(RAD(RAI)) Q:RAI=""  D
"RTN","RA97PST",92,0)
 ..S RAPA=$P($P(RAD(RAI),U,3),"CATEGORY ",2)
"RTN","RA97PST",93,0)
 ..;categories 0,3,4,5,6 have alerts
"RTN","RA97PST",94,0)
 ..S RAPAPG="n" S:"^0^3^4^5^6^"[("^"_RAPA_"^") RAPAPG="y"
"RTN","RA97PST",95,0)
 ..S RAFDA(78.3,"+1,",.01)="BI-RADS "_$P(RAD(RAI),U,3)
"RTN","RA97PST",96,0)
 ..S RAFDA(78.3,"+1,",2)=$E($P(RAD(RAI),U,2),1,80)
"RTN","RA97PST",97,0)
 ..S RAFDA(78.3,"+1,",3)=$$UP^XLFSTR(RAPAPG)
"RTN","RA97PST",98,0)
 ..S RAFDA(78.3,"+1,",4)=RAPAPG
"RTN","RA97PST",99,0)
 ..S RAFDA(78.3,"+1,",6)=$P(RAD(RAI),U,1)
"RTN","RA97PST",100,0)
 ..S RAIEN(1)=RAI
"RTN","RA97PST",101,0)
 ..D UPDATE^DIE("","RAFDA","RAIEN","RAERR")
"RTN","RA97PST",102,0)
 ..I $D(RAERR)#2 D
"RTN","RA97PST",103,0)
 ...S RATXT(1)="",RATXT(2)="Error adding "_$P(RAD(RAI),U,3)_" to the"
"RTN","RA97PST",104,0)
 ...S RATXT(3)="local DIAGNOSTIC CODES file #78.3." D BMES^XPDUTL(.RATXT)
"RTN","RA97PST",105,0)
 ..E  S RACT=RACT+1
"RTN","RA97PST",106,0)
 ..K RAFDA,RAIEN,RAERR
"RTN","RA97PST",107,0)
 ..Q
"RTN","RA97PST",108,0)
 .Q
"RTN","RA97PST",109,0)
 ;
"RTN","RA97PST",110,0)
 ; Add the AAA codes to file 78.3
"RTN","RA97PST",111,0)
 D
"RTN","RA97PST",112,0)
 .S RA1=0 F  S RA1=$O(RAAA(RA1)) Q:RA1=""  D
"RTN","RA97PST",113,0)
 ..S RAPAPG=$P(RAAA(RA1),U,3)
"RTN","RA97PST",114,0)
 ..S RAFDA(78.3,"+1,",.01)=$P(RAAA(RA1),U,1)
"RTN","RA97PST",115,0)
 ..S RAFDA(78.3,"+1,",2)=$P(RAAA(RA1),U,2)
"RTN","RA97PST",116,0)
 ..S RAFDA(78.3,"+1,",3)=$$UP^XLFSTR(RAPAPG)
"RTN","RA97PST",117,0)
 ..S RAFDA(78.3,"+1,",4)=RAPAPG
"RTN","RA97PST",118,0)
 ..S RAIEN(1)=RA1
"RTN","RA97PST",119,0)
 ..D UPDATE^DIE("","RAFDA","RAIEN","RAERR")
"RTN","RA97PST",120,0)
 ..I $D(RAERR)#2 D
"RTN","RA97PST",121,0)
 ...S RATXT(1)=""
"RTN","RA97PST",122,0)
 ...S RATXT(2)="Error adding "_$P(RAAA(RA1),U,1)_" to the"
"RTN","RA97PST",123,0)
 ...S RATXT(3)="local DIAGNOSTIC CODES file #78.3." D BMES^XPDUTL(.RATXT)
"RTN","RA97PST",124,0)
 ..E  S RACT=RACT+1
"RTN","RA97PST",125,0)
 ..K RAFDA,RAIEN,RAERR
"RTN","RA97PST",126,0)
 K RATXT
"RTN","RA97PST",127,0)
 S RATXT(1)=""
"RTN","RA97PST",128,0)
 S RATXT(2)="*** "_RACT_" of 10 BI-RADS and Abdominal Aortic Aneurysm codes"
"RTN","RA97PST",129,0)
 S RATXT(3)="have been successfully added to the DIAGNOSTIC CODES file #78.3. ***"
"RTN","RA97PST",130,0)
 D BMES^XPDUTL(.RATXT)
"RTN","RA97PST",131,0)
 ;put 3rd piece of ^RA(78.3,0) to highest value but under 999
"RTN","RA97PST",132,0)
 S RA1=$O(^RA(78.3,999),-1)
"RTN","RA97PST",133,0)
 S $P(^RA(78.3,0),U,3)=RA1
"RTN","RA97PST",134,0)
ID ;set Identifier "WRITE" node and insert "I"
"RTN","RA97PST",135,0)
 I '$D(^DD(78.3,0,"ID","WRITE")) D
"RTN","RA97PST",136,0)
 .S ^DD(78.3,0,"ID","WRITE")="D EN^DDIOL($$EN1^RABIRAD,"""",""?33"")"
"RTN","RA97PST",137,0)
 .D BMES^XPDUTL("*** Identifier ""WRITE"" has been added to file #78.3.")
"RTN","RA97PST",138,0)
 ; set "I" after file number in ^RA(78.3,0)
"RTN","RA97PST",139,0)
 S RA1=$P(^RA(78.3,0),U,2) I RA1=78.3 D
"RTN","RA97PST",140,0)
 .S $P(^RA(78.3,0),U,2)=RA1_"I"
"RTN","RA97PST",141,0)
 .D BMES^XPDUTL("*** ""I"" has been inserted to ^RA(78.3,0).")
"RTN","RA97PST",142,0)
 Q
"RTN","RA97PST",143,0)
AAACODE ; Abdominal Aortic Aneurysm codes
"RTN","RA97PST",144,0)
 ;;1200^1^ABDOMINAL AORTIC ANEURYSM NOT PRESENT
"RTN","RA97PST",145,0)
 ;;1200^2^The maximum width of the infrarenal aorta is less than three centimeters.
"RTN","RA97PST",146,0)
 ;;1200^3^n
"RTN","RA97PST",147,0)
 ;;1201^1^ABDOMINAL AORTIC ANEURYSM PRESENT
"RTN","RA97PST",148,0)
 ;;1201^2^The maximum width of the infrarenal aorta is at least three centimeters.
"RTN","RA97PST",149,0)
 ;;1201^3^y
"RTN","RA97PST",150,0)
 ;;1202^1^DOES NOT SATISFY SCREEN FOR AAA
"RTN","RA97PST",151,0)
 ;;1202^2^Exam is not technically adequate for AAA screening.
"RTN","RA97PST",152,0)
 ;;1202^3^n
"RTN","RA97PST1")
0^13^B11847551
"RTN","RA97PST1",1,0)
RA97PST1 ;HINES/RVD - Radiology BI-RADS ;10/10/08
"RTN","RA97PST1",2,0)
 ;;5.0;RADIOLOGY;**97**;March 16, 1998;Build 6
"RTN","RA97PST1",3,0)
 ;
"RTN","RA97PST1",4,0)
 ;
"RTN","RA97PST1",5,0)
BIR(RAX,RALEX,RALEXDT,RALEXSO,RALEXS,RALEXC) ; Example of 'Silent' Lexicon Call
"RTN","RA97PST1",6,0)
 ; Return List of Categories w/Lexicon Pointers
"RTN","RA97PST1",7,0)
 ;
"RTN","RA97PST1",8,0)
 ; Input Variables
"RTN","RA97PST1",9,0)
 ;
"RTN","RA97PST1",10,0)
 ;     RAX       Text to Search for (Optional)
"RTN","RA97PST1",11,0)
 ;     
"RTN","RA97PST1",12,0)
 ;     RALEX     Array name passed by Reference (Required)
"RTN","RA97PST1",13,0)
 ;     
"RTN","RA97PST1",14,0)
 ;     RALEXDT   Version Date (Optional, default TODAY) 
"RTN","RA97PST1",15,0)
 ;     
"RTN","RA97PST1",16,0)
 ;     RALEXSO   Coding System (file 757.03)  For the purposes
"RTN","RA97PST1",17,0)
 ;             of patch LEX*2.0*55, this may be set to "BIR" 
"RTN","RA97PST1",18,0)
 ;             or <null>  (Optional)
"RTN","RA97PST1",19,0)
 ;         
"RTN","RA97PST1",20,0)
 ;     RALEXS    Source of terminology (file 757.14)  For the
"RTN","RA97PST1",21,0)
 ;             purposes of patch LEX*2.0*55, this may be set 
"RTN","RA97PST1",22,0)
 ;             to "BI-RADS" or "MQSA"  (Optional)
"RTN","RA97PST1",23,0)
 ;         
"RTN","RA97PST1",24,0)
 ;               BI-RADS = Breast Imaging Reporting & Data System 
"RTN","RA97PST1",25,0)
 ;               MQSA    = Mammography Quality Standards Act
"RTN","RA97PST1",26,0)
 ;         
"RTN","RA97PST1",27,0)
 ;     RALEXC    Source Category of the terminology (file 757.13)
"RTN","RA97PST1",28,0)
 ;             Frequently a terminology is broken down into 
"RTN","RA97PST1",29,0)
 ;             categories (example, MRI, Ultrasound and/or 
"RTN","RA97PST1",30,0)
 ;             Mammography)  For the purposes of patch 
"RTN","RA97PST1",31,0)
 ;             LEX*2.0*55, this is set to "MAMMOGRAPHY 
"RTN","RA97PST1",32,0)
 ;             ASSESSMENT CATEGORIES"  (Optional)
"RTN","RA97PST1",33,0)
 ;              
"RTN","RA97PST1",34,0)
 ; Output Variables
"RTN","RA97PST1",35,0)
 ;              
"RTN","RA97PST1",36,0)
 ;     RALEX(0)  Number of entries
"RTN","RA97PST1",37,0)
 ;     RALEX(#)  Lexicon IEN ^ Text (term) ^ Code
"RTN","RA97PST1",38,0)
 ;     LEX       ICR 2950
"RTN","RA97PST1",39,0)
 ;
"RTN","RA97PST1",40,0)
 ; NOTE:  This API mimics code found in CPRS
"RTN","RA97PST1",41,0)
 ;              
"RTN","RA97PST1",42,0)
 ; Global Variables
"RTN","RA97PST1",43,0)
 ;    ^TMP("LEXFND")      ICR   2950
"RTN","RA97PST1",44,0)
 ;    ^TMP("LEXHIT")      ICR   2950
"RTN","RA97PST1",45,0)
 ;    ^TMP("LEXSCH")      ICR   1609
"RTN","RA97PST1",46,0)
 ;               
"RTN","RA97PST1",47,0)
 ; External References
"RTN","RA97PST1",48,0)
 ;    LOOK^LEXA           ICR   2950
"RTN","RA97PST1",49,0)
 ;    CONFIG^LEXSET       ICR   1609
"RTN","RA97PST1",50,0)
 ;    $$DT^XLFDT          ICR  10103
"RTN","RA97PST1",51,0)
 ;    SO^LEXA             ICR   5386
"RTN","RA97PST1",52,0)
 ;              
"RTN","RA97PST1",53,0)
 N DIC,RALEXA,RALEXCAT,RALEXCN,RALEXCT,RALEXI,RALEXIEN,RALEXSRC,RALEXSUB,RALEXT,RALEXVDT
"RTN","RA97PST1",54,0)
 N RALEXX S RALEXSUB="WRD" S:$G(RALEXSO)="BIR" RALEXSUB="BI1"
"RTN","RA97PST1",55,0)
 S (RAX,RALEXX)=$G(RAX) S:'$L(RALEXX) RALEXX="BIRAD" S RALEXVDT=$E($G(RALEXDT),1,7)
"RTN","RA97PST1",56,0)
 S:+RALEXVDT'>0!(RALEXVDT'?7N)!(RALEXVDT<3030101) RALEXVDT=$$DT^XLFDT
"RTN","RA97PST1",57,0)
 S:$L($G(RALEXS)) RALEXSRC=$G(RALEXS) S:$L($G(RALEXC)) RALEXCAT=$G(RALEXC)
"RTN","RA97PST1",58,0)
 K ^TMP("LEXSCH",$J) D CONFIG^LEXSET(RALEXSUB,"WRD",RALEXVDT)
"RTN","RA97PST1",59,0)
 S RALEXSUB="WRD" S:$G(RALEXSO)="BIR" RALEXSUB="BI1" S ^TMP("LEXSCH",$J,"DIS",0)="BIR",^TMP("LEXSCH",$J,"LEN",0)=100
"RTN","RA97PST1",60,0)
 K DIC("S"),^TMP("LEXSCH",$J,"FIL",0)
"RTN","RA97PST1",61,0)
 S:$L($G(RALEXSO)) (DIC("S"),^TMP("LEXSCH",$J,"FIL",0))="I +($$SO^LEXU(Y,"""_RALEXSO_""",+($G(RALEXVDT))))>0"
"RTN","RA97PST1",62,0)
 D LOOK^LEXA(RALEXX,RALEXSUB,100,"",RALEXVDT,$G(RALEXSRC),$G(RALEXCAT))
"RTN","RA97PST1",63,0)
 K ^TMP("LEXSCH",$J),^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","RA97PST1",64,0)
 S RALEXI=0 F  S RALEXI=$O(LEX("LIST",RALEXI)) Q:+RALEXI'>0  D
"RTN","RA97PST1",65,0)
 . N RALEXIEN,RALEXT,RALEXE,RALEXCT,RALEXCN,RALEXN
"RTN","RA97PST1",66,0)
 . S RALEXT=$G(LEX("LIST",RALEXI)),RALEXIEN=+RALEXT Q:RALEXIEN'>0
"RTN","RA97PST1",67,0)
 . S (RALEXE,RALEXT)=$P(RALEXT,"^",2) Q:'$L(RALEXE)
"RTN","RA97PST1",68,0)
 . S RALEXN=$O(RALEXA(" "),-1)+1,RALEXCN=+($E($P(RALEXT,"Category ",2),1)),RALEXCT="Category "_RALEXCN S:RALEXE["(BI" RALEXE=$P(RALEXE,"(BI",1) S:RALEXE[" *" RALEXE=$P(RALEXE," *",1)
"RTN","RA97PST1",69,0)
 . S RALEXCN=+RALEXCN+1 S:$G(RALEXSO)="BIR" RALEXA(RALEXCN)=RALEXIEN_"^"_RALEXE_"^"_RALEXCT S:$G(RALEXSO)'="BIR" RALEXA(RALEXN)=RALEXIEN_"^"_RALEXT
"RTN","RA97PST1",70,0)
 S:+($O(RALEXA(" "),-1))>0 RALEXA(0)=+($O(RALEXA(" "),-1)) K LEX S (RALEXCT,RALEXI)=0 F  S RALEXI=$O(RALEXA(RALEXI)) Q:+RALEXI'>0  D
"RTN","RA97PST1",71,0)
 . Q:'$L($G(RALEXA(RALEXI)))  S RALEXCT=RALEXCT+1,RALEX(RALEXCT)=$G(RALEXA(RALEXI)),RALEX(0)=RALEXCT
"RTN","RA97PST1",72,0)
 Q
"RTN","RABIRAD")
0^3^B7783867
"RTN","RABIRAD",1,0)
RABIRAD ;;HIOFO/SM BI-RADS processing ; 03/18/09 11:50
"RTN","RABIRAD",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**97**;Mar 16, 1998;Build 6
"RTN","RABIRAD",3,0)
 Q
"RTN","RABIRAD",4,0)
EN1() ;called from ^DD(78.3,0,"ID","WRITE") node
"RTN","RABIRAD",5,0)
 ;display file 78.3's EXPRESSION's external form from file 757.01
"RTN","RABIRAD",6,0)
 ; IA 1571
"RTN","RABIRAD",7,0)
 ; ^(0) is ^RA(78.3,-,0)
"RTN","RABIRAD",8,0)
 N RAX,RAY,RA2
"RTN","RABIRAD",9,0)
 S RA2=$P(^(0),U,2) ;fld 2 description
"RTN","RABIRAD",10,0)
 S RAX=$$GET1^DIQ(757.01,+$P(^(0),U,6),.01) ;Ext. expression fld 6
"RTN","RABIRAD",11,0)
 I RAX'="" D  ;assume field 6 has data only for BIRADS records
"RTN","RABIRAD",12,0)
 .S RAY="("_RAX_")"
"RTN","RABIRAD",13,0)
 .Q
"RTN","RABIRAD",14,0)
 E  D  ;display Description only for iens 1200 thru 1202
"RTN","RABIRAD",15,0)
 .S RA2=$S((Y>1199)&(Y<1203):RA2,1:"")
"RTN","RABIRAD",16,0)
 .S RAY=$S(RA2="":"",1:"("_RA2_")")
"RTN","RABIRAD",17,0)
 Q RAY
"RTN","RABIRAD",18,0)
 ;
"RTN","RABIRAD",19,0)
CKREQ ; check if case requires at least one BIRAD code
"RTN","RABIRAD",20,0)
 N RA732,RACPT,RAPROC
"RTN","RABIRAD",21,0)
 S RABIREQ=0 ;=0 not require birad, =1 require birad
"RTN","RABIRAD",22,0)
 S RAPROC=$P(RA7003,U,2)
"RTN","RABIRAD",23,0)
 S RACPT=$P(^RAMIS(71,RAPROC,0),U,9)
"RTN","RABIRAD",24,0)
 S RA732=$O(^RA(73.2,"B",RACPT,0)) Q:RA732=""
"RTN","RABIRAD",25,0)
 I $P(^RA(73.2,RA732,0),U,8)="Y",$P(^(0),U,4)="MAMMOGRAPHY",$P(^(0),U,3)="IMAGING" S RABIREQ=1
"RTN","RABIRAD",26,0)
 Q
"RTN","RABIRAD",27,0)
 ;
"RTN","RABIRAD",28,0)
CKDATA ;check if case has any BIRAD data
"RTN","RABIRAD",29,0)
 Q:'RABIREQ
"RTN","RABIRAD",30,0)
 N RAX,RAX2
"RTN","RABIRAD",31,0)
 S RABIENS="^" ;string of IENS that are BIRAD codes
"RTN","RABIRAD",32,0)
 S RABIDAT=0 ;=0 no birad data, =1 has birad in either prim. or sec. diag
"RTN","RABIRAD",33,0)
 ; find birad iens after ien 1099, look for:
"RTN","RABIRAD",34,0)
 ; piece 1 has "BI-RADS CATEGORY" and piece 6 has numeric data
"RTN","RABIRAD",35,0)
 S RAX=1099
"RTN","RABIRAD",36,0)
 F  S RAX=$O(^RA(78.3,RAX)) Q:'RAX  S RAX2=$G(^(RAX,0)) I $P(RAX2,U)["BI-RADS CATEGORY",+$P(RAX2,U,6)>0 S RABIENS=RABIENS_RAX_"^"
"RTN","RABIRAD",37,0)
 I RABIENS[("^"_$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)_"^") S RABIDAT=1 Q
"RTN","RABIRAD",38,0)
 S RAX=0
"RTN","RABIRAD",39,0)
 F  S RAX=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX","B",RAX)) Q:'RAX  I RABIENS[("^"_RAX_"^") S RABIDAT=1 Q
"RTN","RABIRAD",40,0)
 I 'RABIDAT D WARN
"RTN","RABIRAD",41,0)
 Q
"RTN","RABIRAD",42,0)
WARN ;
"RTN","RABIRAD",43,0)
 I RAFIRST W !!?5,"This exam cannot reach the 'COMPLETE' status until a BI-RADS code is entered.",!
"RTN","RABIRAD",44,0)
 E  W !!?5,"This case requires a BI-RADS code.  It either had a BI-RADS code ",!?5,"that was deleted or never had one.  Please use this option to ",!?5,"re-enter a BI-RADS code.",!
"RTN","RABIRAD",45,0)
 Q
"RTN","RABIRAD",46,0)
ASK() ;
"RTN","RABIRAD",47,0)
 S DIR(0)="Y",DIR("A")="Do you want to re-edit diagnostic codes "
"RTN","RABIRAD",48,0)
 S DIR("B")="NO" D ^DIR K DIR
"RTN","RABIRAD",49,0)
 Q Y
"RTN","RABWORD1")
0^12^B21044448
"RTN","RABWORD1",1,0)
RABWORD1 ;HOIFO/MM-Radiology Billing Awareness ;10/26/04 1:36pm
"RTN","RABWORD1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**41,57,70,97**;Mar 16, 1998;Build 6
"RTN","RABWORD1",3,0)
 ;
"RTN","RABWORD1",4,0)
 ; This routine invokes IA #10082
"RTN","RABWORD1",5,0)
 ; ICDDX^ICDCODE        IA # 3990
"RTN","RABWORD1",6,0)
 Q
"RTN","RABWORD1",7,0)
 ;
"RTN","RABWORD1",8,0)
BADISP(RABWDX) ; Display ICD DX & SC/EI/MST/HNC answers from the Order.
"RTN","RABWORD1",9,0)
 ; Called from BADISP^RAORDU1
"RTN","RABWORD1",10,0)
 I '$D(RABWDX) Q
"RTN","RABWORD1",11,0)
 N I1,RACNT,RAIND
"RTN","RABWORD1",12,0)
 ; Create Temp. Array of the Clinical Indicators.
"RTN","RABWORD1",13,0)
 S RAIND(2)="SC",RAIND(3)="AO",RAIND(4)="IR"
"RTN","RABWORD1",14,0)
 S RAIND(5)="SWAC",RAIND(6)="MST",RAIND(7)="HNC",RAIND(8)="CV",RAIND(9)="SHAD"
"RTN","RABWORD1",15,0)
 ;
"RTN","RABWORD1",16,0)
PRIMDX W:$D(RABWDX(1)) !!,"Primary Ordering ICD-9 Diagnosis: "
"RTN","RABWORD1",17,0)
 N RAICD
"RTN","RABWORD1",18,0)
 I $G(RABWDX(1)) S RAICD=$$ICDDX^ICDCODE($P(RABWDX(1),U),DT,) W $P(RAICD,U,4),"  ",$P(RAICD,U,2)
"RTN","RABWORD1",19,0)
 S RACNT=1 D:$D(RABWDX(1)) BARESP
"RTN","RABWORD1",20,0)
 S Y=1
"RTN","RABWORD1",21,0)
 ;
"RTN","RABWORD1",22,0)
SECDX S I1=1
"RTN","RABWORD1",23,0)
 F  S I1=$O(RABWDX(I1)) Q:'I1  D
"RTN","RABWORD1",24,0)
 .W !!,"Secondary Ordering ICD-9 Diagnosis: "
"RTN","RABWORD1",25,0)
 .S RAICD=$$ICDDX^ICDCODE($P(RABWDX(I1),U),DT,)
"RTN","RABWORD1",26,0)
 .W $P(RAICD,U,4),"  ",$P(RAICD,U,2)
"RTN","RABWORD1",27,0)
 .S RACNT=RACNT+1 D BARESP
"RTN","RABWORD1",28,0)
 Q  ; Quit back to calling routine.
"RTN","RABWORD1",29,0)
 ;
"RTN","RABWORD1",30,0)
BARESP ; Display the SC/EC/EI/MST/HNC responses associated to each ICD Dx.
"RTN","RABWORD1",31,0)
 ; Current Question Sequence is:  SC, CV, AO, IR, SWAC, SHAD, MST, HNC
"RTN","RABWORD1",32,0)
 N I0,I2,RA1,RABA S I2=0
"RTN","RABWORD1",33,0)
 F I0=2:1:9 D
"RTN","RABWORD1",34,0)
 .S RABA=$S(I0=2:2,I0=3:8,I0=9:9,1:I0-1)
"RTN","RABWORD1",35,0)
 .S RA1=$P(RABWDX(RACNT),U,RABA)
"RTN","RABWORD1",36,0)
 .Q:RA1=""
"RTN","RABWORD1",37,0)
 .I I2=0 W !?5
"RTN","RABWORD1",38,0)
 .S I2=I2+1 I I2>2 S I2=1 W !?5
"RTN","RABWORD1",39,0)
 .I I2>1 W ?40
"RTN","RABWORD1",40,0)
 .W RAIND(RABA)," Related? ",$S(RA1=0:"NO",RA1=1:"YES",1:"")
"RTN","RABWORD1",41,0)
 Q
"RTN","RABWORD1",42,0)
 ;
"RTN","RABWORD1",43,0)
SENDCPRS(RAO) ; Send Billing Aware Ordering ICD Dx data to CPRS.
"RTN","RABWORD1",44,0)
 ; Called from EN1+n^RAO7NEW.
"RTN","RABWORD1",45,0)
 ; RABWDX1 variable comes from RAO7NEW routine.
"RTN","RABWORD1",46,0)
 Q:'$$PATCH^XPDUTL("OR*3.0*190")  ;check for required BA-OR patch
"RTN","RABWORD1",47,0)
 N I,II,RA1,RA2,RA2A,RACNT,RACNT1,RAICD1,RAICD3
"RTN","RABWORD1",48,0)
 I '$D(^RAO(75.1,RAO,0)) Q
"RTN","RABWORD1",49,0)
 S RA1=$G(^RAO(75.1,RAO,"BA")) I +RA1<1 Q
"RTN","RABWORD1",50,0)
 S (RACNT,RACNT1)=0
"RTN","RABWORD1",51,0)
 S RA2=^RAO(75.1,RAO,"BA") D SEND1
"RTN","RABWORD1",52,0)
 S RA1=0
"RTN","RABWORD1",53,0)
 F  S RA1=$O(^RAO(75.1,RAO,"BAS",RA1)) Q:+RA1<1  S RA2=^(RA1,0) D SEND1
"RTN","RABWORD1",54,0)
 Q
"RTN","RABWORD1",55,0)
 ;
"RTN","RABWORD1",56,0)
SEND1 S RAICD1=$P(^ICD9(+RA2,0),U,1),RAICD3=$P($$ICDDX^ICDCODE(+RA2),U,4)
"RTN","RABWORD1",57,0)
 S RACNT=RACNT+1
"RTN","RABWORD1",58,0)
 S RABWDX1(RACNT)="DG1"_RAHLFS_RACNT_RAHLFS_RAHLFS_+RA2_RAECH(1)_RAICD3_RAECH(1)_"80"_RAECH(1)_RAICD1_RAECH(1)_RAICD3_RAECH(1)_"ICD9"
"RTN","RABWORD1",59,0)
 S RACNT1=RACNT
"RTN","RABWORD1",60,0)
 F I=2:1:9 D
"RTN","RABWORD1",61,0)
 .S II=$S(I=2:3,I=3:4,I=4:2,1:I),RA2A=$P(RA2,U,II)
"RTN","RABWORD1",62,0)
 .S RACNT1=RACNT1+.1
"RTN","RABWORD1",63,0)
 .S RABWDX1(RACNT1)="ZCL"_RAHLFS_RACNT_RAHLFS_(I-1)_RAHLFS_RA2A
"RTN","RABWORD1",64,0)
 Q
"RTN","RABWORD1",65,0)
 ;
"RTN","RABWORD1",66,0)
GETCPRS ; Retrieve and Store Ordering ICD Dx data from CPRS DG1 & ZCL Segments.
"RTN","RABWORD1",67,0)
 ; Called from EN1+n^RAO7RON.
"RTN","RABWORD1",68,0)
 I '$D(RADATA) Q
"RTN","RABWORD1",69,0)
 N I,RA1
"RTN","RABWORD1",70,0)
 I RAHDR="DG1" D  ; Ordering ICD Dx.
"RTN","RABWORD1",71,0)
 .I +RADATA=1 S RANEW(75.1,"+1,",91)=+$P(RADATA,RAHLFS,3)
"RTN","RABWORD1",72,0)
 .E  S RANEW(75.13,"+1"_(+RADATA)_",+1,",.01)=+$P(RADATA,RAHLFS,3)
"RTN","RABWORD1",73,0)
 I RAHDR="ZCL" D  ; Ordering ICD Dx related SC/EI/MST/HNC.
"RTN","RABWORD1",74,0)
 .F I=2,3 S RA1(I)=$P(RADATA,RAHLFS,I)
"RTN","RABWORD1",75,0)
 .S RA1(2)=$S(RA1(2)=3:1,RA1(2)=1:2,RA1(2)=2:3,1:RA1(2))
"RTN","RABWORD1",76,0)
 .; adjust for CV and SHAD since fld no. 98 is skipped, SWM20070702
"RTN","RABWORD1",77,0)
 .I +RADATA=1 S:RA1(2)>6 RA1(2)=RA1(2)+1 S RANEW(75.1,"+1,",(91+RA1(2)))=RA1(3)
"RTN","RABWORD1",78,0)
 .E  S RANEW(75.13,"+1"_(+RADATA)_",+1,",(1+RA1(2)))=RA1(3)
"RTN","RABWORD1",79,0)
 Q
"RTN","RABWORD1",80,0)
CPRSUPD(RADFN,RAITEM,RAORIEN,RADX,RASCEI) ;Update Order DXs edited during SignOff in CPRS
"RTN","RABWORD1",81,0)
 ; PFSS 1B Requirement 1
"RTN","RABWORD1",82,0)
 ; Radiology backdoor orders normally cannot be changed from CPRS GUI.
"RTN","RABWORD1",83,0)
 ; The exceptions are TELEPHONE and VERBAL orders which were entered
"RTN","RABWORD1",84,0)
 ; from "backdoor" Vista Radiology, and changed later in CPRS GUI.  However,
"RTN","RABWORD1",85,0)
 ; only the Diagnoses and Clinical Indicators for the order can be changed.
"RTN","RABWORD1",86,0)
 ; The change from the CPRS GUI can occur before or after the exam has been
"RTN","RABWORD1",87,0)
 ; completed.
"RTN","RABWORD1",88,0)
 ;
"RTN","RABWORD1",89,0)
 ; For PFSS, we do NOT want to get another account number when the back door
"RTN","RABWORD1",90,0)
 ; order has been edited.  Thus we need to flag that we're processing a CPRS
"RTN","RABWORD1",91,0)
 ; update before calling FILEDX^RABWORD from this routine.
"RTN","RABWORD1",92,0)
 ;
"RTN","RABWORD1",93,0)
 N RAMSG,RADXIN,RADTI,RACNI,RAUPD,RASCEII S RAMSG=1,(RADXIN,RAUPD)=0,(RADTI,RACNI)=""
"RTN","RABWORD1",94,0)
 N RACPRS S RACPRS=1 ; flag CPRS update
"RTN","RABWORD1",95,0)
 I $P($G(^RAO(75.1,+RAITEM,0)),U,7)'=+RAORIEN D
"RTN","RABWORD1",96,0)
 .S RAMSG="0^Order #"_RAORIEN_" does not match Radiology Order #"_RAITEM
"RTN","RABWORD1",97,0)
 I RAMSG&($P($G(^RAO(75.1,+RAITEM,0)),U)'=RADFN) D
"RTN","RABWORD1",98,0)
 .S RAMSG="0^Order #"_RAORIEN_"'s DFN="_RADFN_", but Radiology Order #"_RAITEM_"'s DFN="_$P(^RAO(75.1,+RAITEM,0),U)
"RTN","RABWORD1",99,0)
 I RAMSG D
"RTN","RABWORD1",100,0)
 .K DIK,DA S DA(1)=RAITEM,DA=0,DIK="^RAO(75.1,"_DA(1)_",""BAS"","        ;Delete old DXs
"RTN","RABWORD1",101,0)
 .F  S DA=$O(^RAO(75.1,RAITEM,"BAS",DA)) Q:DA=""  D
"RTN","RABWORD1",102,0)
 ..D ^DIK
"RTN","RABWORD1",103,0)
 .K DIK,DA
"RTN","RABWORD1",104,0)
 .;Build the DX array and file
"RTN","RABWORD1",105,0)
 .S RASCEII=RASCEI,$P(RASCEII,U,2)=$P(RASCEI,U),$P(RASCEII,U,3)=$P(RASCEI,U,2),$P(RASCEII,U)=$P(RASCEI,U,3)
"RTN","RABWORD1",106,0)
 .F  S RADXIN=$O(RADX(RADXIN)) Q:RADXIN=""  D
"RTN","RABWORD1",107,0)
 ..S RABWDX(RADXIN)=RADX(RADXIN)_"^"_RASCEII
"RTN","RABWORD1",108,0)
 .I $D(RABWDX) D
"RTN","RABWORD1",109,0)
 ..S:$P($G(^RAO(75.1,RAITEM,0)),U,5)=2 RAUPD=1
"RTN","RABWORD1",110,0)
 ..D FILEDX^RABWORD(RADFN,RAITEM)
"RTN","RABWORD1",111,0)
 ..I RAUPD D
"RTN","RABWORD1",112,0)
 ...S RADTI=$O(^RADPT("AO",RAITEM,RADFN,RADTI)) Q:'RADTI
"RTN","RABWORD1",113,0)
 ...S RACNI=$O(^RADPT("AO",RAITEM,RADFN,RADTI,RACNI)) Q:'RACNI
"RTN","RABWORD1",114,0)
 ...S ZTQUEUED=1
"RTN","RABWORD1",115,0)
 ...D UNCOMPL^RAPCE1(RADFN,RADTI,RACNI)
"RTN","RABWORD1",116,0)
 ...D:$P($G(^RADPT(RADFN,"DT",0)),U,5) COMPLETE^RAPCE(RADFN,RADTI,RACNI)
"RTN","RABWORD1",117,0)
 K RADFN,RAITEM,RAORIEN,RASCEI,RABWDX,RADX
"RTN","RABWORD1",118,0)
 Q RAMSG
"RTN","RABWORD1",119,0)
 ;Explanation of vars, fields, pieces, etc. by Clin. Ind., SWM20070702
"RTN","RABWORD1",120,0)
 ;     CL     INT     File  File   Sub-   Sub-   RASEQ1    RASEQ2
"RTN","RABWORD1",121,0)
 ;   ^SDCO21  from    75.1  75.1   file   file   from      its'the
"RTN","RABWORD1",122,0)
 ;            ZCL     "BA"  Field  75.13  75.13  BAQUES    piece
"RTN","RABWORD1",123,0)
 ;            |rec    node  No.    "BAS"  Field  ^RABWORD  no. in
"RTN","RABWORD1",124,0)
 ;            |int          Prim.  node   No.              RABWDX
"RTN","RABWORD1",125,0)
 ;            |value        DXs           Sec.             (racnt)
"RTN","RABWORD1",126,0)
 ;                                        DXs
"RTN","RABWORD1",127,0)
 ;AO    1       1      ;3    93     ;3      3       1        3
"RTN","RABWORD1",128,0)
 ;IR    2       2      ;4    94     ;4      4       2        4
"RTN","RABWORD1",129,0)
 ;SC    3       3      ;2    92     ;2      2       3        2
"RTN","RABWORD1",130,0)
 ;SWAC  4       4      ;5    95     ;5      5       4        5
"RTN","RABWORD1",131,0)
 ;MST   5       5      ;6    96     ;6      6       5        6
"RTN","RABWORD1",132,0)
 ;HNC   6       6      ;7    97     ;7      7       6        7
"RTN","RABWORD1",133,0)
 ;CV    7       7      ;8    99     ;8      8       7        8
"RTN","RABWORD1",134,0)
 ;SHAD  8       8      ;9    100    ;9      9       8        9
"RTN","RABWORD1",135,0)
 ;
"RTN","RABWORD1",136,0)
 ;Sample format of ZCL segments from CPRS GUI base on
"RTN","RABWORD1",137,0)
 ;Clinical indicators associated with Ordering Diagnoses:
"RTN","RABWORD1",138,0)
 ;
"RTN","RABWORD1",139,0)
 ;Primary Ordering Diag.    First Secondary Diag.   Next Secondary Diag.
"RTN","RABWORD1",140,0)
 ;ZCL|1|1|0 <-- AO          ZCL|2|1|                ZCL|3|1|
"RTN","RABWORD1",141,0)
 ;ZCL|1|2|1     IR          ZCL|2|2|1               ZCL|3|2|
"RTN","RABWORD1",142,0)
 ;ZCL|1|3|1     SC          ZCL|2|3|1               ZCL|3|3|1
"RTN","RABWORD1",143,0)
 ;ZCL|1|4|0     SWAC        ZCL|2|4|                ZCL|3|4|
"RTN","RABWORD1",144,0)
 ;ZCL|1|5|0     MST         ZCL|2|5|                ZCL|3|5|
"RTN","RABWORD1",145,0)
 ;ZCL|1|6|      HNC         ZCL|2|6|                ZCL|3|6|
"RTN","RABWORD1",146,0)
 ;ZCL|1|7|1     CV          ZCL|2|7|                ZCL|3|7|
"RTN","RABWORD1",147,0)
 ;ZCL|1|8|      SHAD        ZCL|3|8|                ZCL|3|8|
"RTN","RADLQ1")
0^4^B28970876
"RTN","RADLQ1",1,0)
RADLQ1 ;HISC/GJC AISC/MJK,RMO-Delq Status/Incomplete Rpt's ;10/30/97  15:02
"RTN","RADLQ1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**15,97**;Mar 16, 1998;Build 6
"RTN","RADLQ1",3,0)
 ;'RALL' will be defined in the entry action of RA INCOMPLETE
"RTN","RADLQ1",4,0)
 I $D(DUZ),($O(RACCESS(DUZ,""))']"") D CHECK^RADLQ3(DUZ)
"RTN","RADLQ1",5,0)
 S X=$$DIVLOC^RAUTL7() K ^TMP($J,"RADLQ")
"RTN","RADLQ1",6,0)
 I X K:$D(RAPSTX) RAPSTX K RAQUIT,X,I,POP Q  ; Selection process aborted.
"RTN","RADLQ1",7,0)
 S INVMAXDT=9999999.9999,RAXIT=0
"RTN","RADLQ1",8,0)
 S RAHD(0)=$S($D(RALL):"Incomplete Exam",1:"Delinquent Status")
"RTN","RADLQ1",9,0)
 S RAHD(0)=RAHD(0)_" Report" W @IOF,!?(IOM-$L(RAHD(0))\2),RAHD(0)
"RTN","RADLQ1",10,0)
 D DISPXAM^RADLQ3 ; Display xam statuses
"RTN","RADLQ1",11,0)
 I RAXIT D EXIT^RADLQ3 Q
"RTN","RADLQ1",12,0)
DEV D DATE^RAUTL I RAPOP D EXIT^RADLQ3 Q  ; Quit if device not selected
"RTN","RADLQ1",13,0)
 S RABEG=INVMAXDT-ENDDATE,RAEND=INVMAXDT-BEGDATE K DIR,X,Y
"RTN","RADLQ1",14,0)
 S DIR(0)="SO^I:INPATIENT;O:OUTPATIENT;B:BOTH"
"RTN","RADLQ1",15,0)
 S DIR("?",1)="This report can be broken out by"
"RTN","RADLQ1",16,0)
 S DIR("?")="Outpatient, Inpatient, or Both."
"RTN","RADLQ1",17,0)
 S DIR("A")="Report to include" D ^DIR K DIR
"RTN","RADLQ1",18,0)
 I $D(DIRUT) D EXIT^RADLQ3 Q
"RTN","RADLQ1",19,0)
 S RASORT1=Y
"RTN","RADLQ1",20,0)
 W !!?5,"Now that you have selected ",Y(0)
"RTN","RADLQ1",21,0)
 W " do you want to sort by",!?5,"Patient or Date ?" K X,Y
"RTN","RADLQ1",22,0)
 S DIR(0)="SO^P:PATIENT;D:DATE"
"RTN","RADLQ1",23,0)
 S DIR("?",1)="This allows you the flexibility to further"
"RTN","RADLQ1",24,0)
 S DIR("?")="sort the report by Patient or Date." D ^DIR K DIR
"RTN","RADLQ1",25,0)
 I $D(DIRUT) D EXIT^RADLQ3 Q
"RTN","RADLQ1",26,0)
 S RASORT2=Y D ZEROUT^RADLQ3("RADLQ")
"RTN","RADLQ1",27,0)
 I '$D(^TMP($J,"RADLQ")) D EXIT^RADLQ3 Q
"RTN","RADLQ1",28,0)
 K RACCESS(DUZ,"DIV-IMG") W !
"RTN","RADLQ1",29,0)
 S ZTRTN="START^RADLQ1" S:$D(RALL) ZTSAVE("RALL")=""
"RTN","RADLQ1",30,0)
 F RASV="RAHD(","RACRT(","RABEG","RAEND","RASORT1","RASORT2","INVMAXDT","RAXIT","RADIVNM" D
"RTN","RADLQ1",31,0)
 . S ZTSAVE(RASV)=""
"RTN","RADLQ1",32,0)
 . Q
"RTN","RADLQ1",33,0)
 S ZTSAVE("^TMP($J,""RA D-TYPE"",")=""
"RTN","RADLQ1",34,0)
 S ZTSAVE("^TMP($J,""RADLQ"",")=""
"RTN","RADLQ1",35,0)
 S ZTSAVE("^TMP($J,""RA I-TYPE"",")=""
"RTN","RADLQ1",36,0)
 D ZIS^RAUTL I RAPOP D EXIT^RADLQ3 Q
"RTN","RADLQ1",37,0)
START ; start processing here
"RTN","RADLQ1",38,0)
 U IO S $P(RALN1,"-",(IOM+1))=""
"RTN","RADLQ1",39,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RADLQ1",40,0)
 S $P(RALN2,"=",(IOM+1))="",(RAPG,RASTI)=0
"RTN","RADLQ1",41,0)
 F  S RASTI=$O(^RADPT("AS",RASTI)) Q:'RASTI  D  Q:RAXIT
"RTN","RADLQ1",42,0)
 . D RADFN:$S($D(RALL):1,$D(RACRT(RASTI)):1,1:0)
"RTN","RADLQ1",43,0)
 . Q
"RTN","RADLQ1",44,0)
 K RADIV("I") D:'RAXIT PRINT^RADLQ2
"RTN","RADLQ1",45,0)
 I 'RAXIT D
"RTN","RADLQ1",46,0)
 . S RADIVNM=$$DIVTOT^RACMP("RADLQ") Q:'RADIVNM
"RTN","RADLQ1",47,0)
 . S RAXIT=$$EOS^RAUTL5() Q:RAXIT  S RAFLAG="" D HDR^RADLQ2
"RTN","RADLQ1",48,0)
 . D:'RAXIT LIST^RADLQ3
"RTN","RADLQ1",49,0)
 . Q
"RTN","RADLQ1",50,0)
 S RAXIT=$$EOS^RAUTL5() ;cause screen pause for user
"RTN","RADLQ1",51,0)
 D EXIT^RADLQ3
"RTN","RADLQ1",52,0)
 Q
"RTN","RADLQ1",53,0)
RADFN ; $ order through rad patients ien's
"RTN","RADLQ1",54,0)
 S RADFN=0
"RTN","RADLQ1",55,0)
 F  S RADFN=$O(^RADPT("AS",RASTI,RADFN)) Q:'RADFN  D  Q:RAXIT
"RTN","RADLQ1",56,0)
 . F RADTI=RABEG-1:0 S RADTI=$O(^RADPT("AS",RASTI,RADFN,RADTI)) Q:'RADTI!(RADTI>RAEND)  D  Q:RAXIT
"RTN","RADLQ1",57,0)
 .. S RADTE=INVMAXDT-RADTI D RACNI
"RTN","RADLQ1",58,0)
 .. Q
"RTN","RADLQ1",59,0)
 . Q
"RTN","RADLQ1",60,0)
 Q
"RTN","RADLQ1",61,0)
RACNI ; $ order through case #
"RTN","RADLQ1",62,0)
 S RACNI=0
"RTN","RADLQ1",63,0)
 F  S RACNI=$O(^RADPT("AS",RASTI,RADFN,RADTI,RACNI)) Q:'RACNI  D SORT  Q:RAXIT
"RTN","RADLQ1",64,0)
 Q
"RTN","RADLQ1",65,0)
SORT ; sort logic
"RTN","RADLQ1",66,0)
 S RAREGEX(0)=$G(^RADPT(RADFN,"DT",RADTI,0)) Q:RAREGEX(0)']""
"RTN","RADLQ1",67,0)
 S RADIV("I")=+$P(RAREGEX(0),"^",3) Q:RADIV("I")=0
"RTN","RADLQ1",68,0)
 S RADIV("I")=$S($D(^RA(79,RADIV("I"),0)):$P(^(0),"^"),1:0)
"RTN","RADLQ1",69,0)
 S RADIV=$S($D(^DIC(4,RADIV("I"),0)):$P(^(0),"^"),1:0)
"RTN","RADLQ1",70,0)
 Q:'$D(^TMP($J,"RA D-TYPE",RADIV))
"RTN","RADLQ1",71,0)
 S RADIV=RADIV("I"),RAPAT(0)=$G(^DPT(RADFN,0))
"RTN","RADLQ1",72,0)
 S RANME=$S($P(RAPAT(0),"^")]"":$P(RAPAT(0),"^"),1:"Unknown")
"RTN","RADLQ1",73,0)
 S RASSN=$$SSN^RAUTL
"RTN","RADLQ1",74,0)
 S RAEXAM(0)=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)) Q:RAEXAM(0)']""
"RTN","RADLQ1",75,0)
 S RAIPHY="Unknown"
"RTN","RADLQ1",76,0)
 S:$P(RAEXAM(0),"^",15)]"" RAIPHY=$P($G(^VA(200,+$P(RAEXAM(0),"^",15),0)),"^")
"RTN","RADLQ1",77,0)
 S:$P(RAEXAM(0),"^",12)]""&(RAIPHY="Unknown") RAIPHY=$P($G(^VA(200,+$P(RAEXAM(0),"^",12),0)),"^")
"RTN","RADLQ1",78,0)
 K RATECH S RATD4=+$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"TC",0))
"RTN","RADLQ1",79,0)
 I RATD4 D  ; Obtain the first 'tech' encountered
"RTN","RADLQ1",80,0)
 . S RATECH=$E($$GET1^DIQ(200,+$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"TC",RATD4,0))_",",.01),1,15)
"RTN","RADLQ1",81,0)
 . Q
"RTN","RADLQ1",82,0)
 K RATD4 S:'$L($G(RATECH)) RATECH="Unknown"
"RTN","RADLQ1",83,0)
 S RACN=+$P(RAEXAM(0),"^"),RAPRC=+$P(RAEXAM(0),"^",2)
"RTN","RADLQ1",84,0)
 S RAPRC=$S($D(^RAMIS(71,RAPRC,0)):$P(^(0),"^"),1:"Unknown")
"RTN","RADLQ1",85,0)
 S RAST=+$P(RAEXAM(0),"^",3),RADT=$P(RADTE,".")
"RTN","RADLQ1",86,0)
 S RAITYPE("I")=$S($D(^RA(72,RAST,0)):+$P(^(0),"^",7),1:0)
"RTN","RADLQ1",87,0)
 S RAITYPE=$S($D(^RA(79.2,RAITYPE("I"),0)):$P(^(0),"^"),1:"Unknown")
"RTN","RADLQ1",88,0)
 Q:'$D(^TMP($J,"RA I-TYPE",RAITYPE))
"RTN","RADLQ1",89,0)
 S:'$D(^RA(72,RAST,0)) RAST="Unknown"
"RTN","RADLQ1",90,0)
 S:$D(^RA(72,RAST,0)) RAST=$P(^(0),"^")
"RTN","RADLQ1",91,0)
 S RADT=$E(RADT,4,5)_"/"_$E(RADT,6,7)_"/"_$E(RADT,2,3)
"RTN","RADLQ1",92,0)
 ; 6th piece: Ward Location          <-> 8th piece: Principal Clinic
"RTN","RADLQ1",93,0)
 ; 9th piece: Contact/Sharing Source <-> 17th piece: Report Text
"RTN","RADLQ1",94,0)
 F RA=6,8,9,17 S RA(RA)=+$P(RAEXAM(0),"^",RA)
"RTN","RADLQ1",95,0)
 S RA("R")=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"R"))
"RTN","RADLQ1",96,0)
 S RAWHE=$S($D(^DIC(42,RA(6),0)):$P(^(0),"^"),$D(^SC(RA(8),0)):$P(^(0),"^"),$D(^DIC(34,RA(9),0)):$P(^(0),"^"),RA("R")]"":RA("R"),1:"Unknown")
"RTN","RADLQ1",97,0)
 S RAVAR=$S($D(^DIC(42,RA(6),0)):"I",1:"O")
"RTN","RADLQ1",98,0)
 Q:RASORT1'="B"&(RASORT1'=RAVAR)
"RTN","RADLQ1",99,0)
 S RARP=$S(+$O(^RARPT(RA(17),"R",0)):"Yes",+$O(^RARPT(RA(17),"I",0)):"Yes",1:"No")
"RTN","RADLQ1",100,0)
 S RAVRFIED=$P($G(^RARPT(RA(17),0)),U,5) S RAVRFIED=$S(RAVRFIED="D":"Draft",RAVRFIED="R":"Released",RAVRFIED="PD":"Prb Drft",RAVRFIED="V":"Verified",RAVRFIED="EF":"Elec. F.",1:"No Rpt")
"RTN","RADLQ1",101,0)
 I $D(ZTQUEUED) D STOPCHK^RAUTL9 S:$G(ZTSTOP)=1 RAXIT=1 Q:RAXIT
"RTN","RADLQ1",102,0)
 S ^TMP($J,"RADLQ",RADIV,RAITYPE,RAVAR,$S(RASORT2="P":RANME,1:$P(RADTE,".")),$S(RASORT2="P":$P(RADTE,"."),1:RANME),RACN)=RACN_"^"_RAPRC_"^"_RAST_"^"_RADT_"^"_RAWHE_"^"_RARP_"^"_RASSN_"^"_RAVRFIED_"^"_RAIPHY_"^"_RATECH
"RTN","RADLQ1",103,0)
 S ^TMP($J,"RADLQ")=+$G(^TMP($J,"RADLQ"))+1
"RTN","RADLQ1",104,0)
 S ^TMP($J,"RADLQ",RADIV)=+$G(^TMP($J,"RADLQ",RADIV))+1
"RTN","RADLQ1",105,0)
 S ^TMP($J,"RADLQ",RADIV,RAITYPE)=+$G(^TMP($J,"RADLQ",RADIV,RAITYPE))+1
"RTN","RADLQ1",106,0)
 S ^TMP($J,"RADLQ",RADIV,RAITYPE,RAVAR)=+$G(^TMP($J,"RADLQ",RADIV,RAITYPE,RAVAR))+1
"RTN","RADLQ1",107,0)
 Q
"RTN","RAEDCN")
0^15^B69681618
"RTN","RAEDCN",1,0)
RAEDCN ;HISC/CAH,FPT,GJC,SS AISC/MJK,RMO-Edit Exams by Case Number ;1/11/02  11:15
"RTN","RAEDCN",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**5,13,10,18,28,31,34,45,85,97**;Mar 16, 1998;Build 6
"RTN","RAEDCN",3,0)
 ;
"RTN","RAEDCN",4,0)
 ; 06/11/2007 KAM/BAY RA*5*85 Remedy Call 174790 Change Exam Cancel
"RTN","RAEDCN",5,0)
 ;            to allow only descendent exams with stub report
"RTN","RAEDCN",6,0)
 ;
"RTN","RAEDCN",7,0)
 ;last modified by SS JUNE 21,2000 for P18
"RTN","RAEDCN",8,0)
START D SET^RAPSET1 I $D(XQUIT) K XQUIT,RAFLG,RADR,POP,RAQUICK Q
"RTN","RAEDCN",9,0)
START1 ;
"RTN","RAEDCN",10,0)
 N RAERR
"RTN","RAEDCN",11,0)
 D ^RACNLU S RAERR=0 G Q:X="^"
"RTN","RAEDCN",12,0)
 I RADR="[RA DIAGNOSTIC BY CASE]" D  I RAERR R !?5,"Press RETURN to exit:",RAXIT:DTIME G Q
"RTN","RAEDCN",13,0)
 .N RAPRTSET,RAMEMARR,RA3,RA7003,RA17
"RTN","RAEDCN",14,0)
 .D EN2^RAUTL20(.RAMEMARR)
"RTN","RAEDCN",15,0)
 .S RA3=99
"RTN","RAEDCN",16,0)
 .; disallow case that is a member of a printset, fld 25 = 2
"RTN","RAEDCN",17,0)
 .I RAPRTSET W ! D WHYMSG2^RASTED S RAERR=1 Q
"RTN","RAEDCN",18,0)
 .S RA7003=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0))
"RTN","RAEDCN",19,0)
 .S RA17=$P(RA7003,U,17)
"RTN","RAEDCN",20,0)
 .; disallow case that has no report or has stub report
"RTN","RAEDCN",21,0)
 .I 'RA17!($$STUB^RAEDCN1(+RA17)) S RAERR=1 W !?3,$C(7),"No report has been entered yet for this exam, therefore it cannot be edited.",! Q
"RTN","RAEDCN",22,0)
 .; disallow case that has an elec. filed report
"RTN","RAEDCN",23,0)
 .I $P($G(^RARPT(+RA17,0)),U,5)="EF" S RAERR=1 D WARN1 Q
"RTN","RAEDCN",24,0)
 .Q
"RTN","RAEDCN",25,0)
 I $D(^RA(72,"AA",RAIMGTY,9,+RAST)),'$D(^XUSEC("RA MGR",+$G(DUZ))) W !!?3,$C(7),"You do not have the appropriate access privileges to edit completed exams." G START1
"RTN","RAEDCN",26,0)
 I $D(^RA(72,"AA",RAIMGTY,0,+RAST)) W !!?3,$C(7),"Exam has been 'cancelled' therefore it cannot be edited." G START1
"RTN","RAEDCN",27,0)
 I RADR="[RA DIAGNOSTIC BY CASE]",$D(^RARPT(RARPT,0)),$P(^(0),"^",5)="V" W !!?3,$C(7),"A report has been verified for this exam, therefore it cannot be edited.",! G START
"RTN","RAEDCN",28,0)
 S DA=RADFN,DIE("NO^")="OUTOK",DIE="^RADPT(",DR=RADR
"RTN","RAEDCN",29,0)
 I $D(RAFLG("EDIT"))!($D(RAFLG("DIAG"))) D  G:+$G(RAXIT) START1
"RTN","RAEDCN",30,0)
 . S RADADA=RADTI,RADIE="^RADPT("_RADFN_",""DT"","
"RTN","RAEDCN",31,0)
 . S RAXIT=$$LOCK^RAUTL12(RADIE,RADADA)
"RTN","RAEDCN",32,0)
 . Q
"RTN","RAEDCN",33,0)
 I RADR="[RA EXAM EDIT]" D
"RTN","RAEDCN",34,0)
 . N RADISPLY
"RTN","RAEDCN",35,0)
 . S RADISPLY=$G(^RAMIS(71,+$P($G(^RADPT(+RADFN,"DT",+RADTI,"P",+RACNI,0)),U,2),0)) ; set $ZR to 71 for prccpt^radd1, not call raprod since diff col
"RTN","RAEDCN",36,0)
 . S RADISPLY=$$PRCCPT^RADD1()
"RTN","RAEDCN",37,0)
 . W !,?24,RADISPLY
"RTN","RAEDCN",38,0)
 .;
"RTN","RAEDCN",39,0)
 .;save 'before' CM data value to compare against the possible 'after'
"RTN","RAEDCN",40,0)
 .;value
"RTN","RAEDCN",41,0)
 .D TRK70CMB^RAMAINU(RADFN,RADTI,RACNI,.RATRKCMB) ;RA*5*45
"RTN","RAEDCN",42,0)
 .;
"RTN","RAEDCN",43,0)
 . Q
"RTN","RAEDCN",44,0)
 D:RADR'="[RA NO PURGE SPECIFICATION]" SVBEFOR^RAO7XX(RADFN,RADTI,RACNI) ;P18 save before edit to compare it in RAUTL1 later
"RTN","RAEDCN",45,0)
 D ^DIE K DIE("NO^"),DE,DQ,DIE,DR,RAZCM
"RTN","RAEDCN",46,0)
 D:RADR'="[RA NO PURGE SPECIFICATION]" UP1^RAUTL1
"RTN","RAEDCN",47,0)
 ;
"RTN","RAEDCN",48,0)
 ;1) check data consistency between 'CONTRAST MEDIA USED' & 'CONTRAST
"RTN","RAEDCN",49,0)
 ;MEDIA'
"RTN","RAEDCN",50,0)
 ;2) check 'before' CM data against 'after' CM data, file in audit log
"RTN","RAEDCN",51,0)
 ;if necessary. Remember, contrast media asked when in input template:
"RTN","RAEDCN",52,0)
 ;RA EXAM EDIT (RA*5*45)
"RTN","RAEDCN",53,0)
 I RADR="[RA EXAM EDIT]" D
"RTN","RAEDCN",54,0)
 .S RACMDA=RACNI,RACMDA(1)=RADTI,RACMDA(2)=RADFN
"RTN","RAEDCN",55,0)
 .D XCMINTEG^RAMAINU1(.RACMDA) ;1
"RTN","RAEDCN",56,0)
 .D TRK70CMA^RAMAINU(RADFN,RADTI,RACNI,RATRKCMB) ;2
"RTN","RAEDCN",57,0)
 .K RACMDA Q
"RTN","RAEDCN",58,0)
 ;
"RTN","RAEDCN",59,0)
 I $D(RAFLG("EDIT"))!($D(RAFLG("DIAG"))) D UNLOCK^RAUTL12(RADIE,RADADA)
"RTN","RAEDCN",60,0)
 K RATRKCMB,RADUZ,RAZZ W ! G START1:'+$G(RAXIT)
"RTN","RAEDCN",61,0)
 ;
"RTN","RAEDCN",62,0)
Q K %,%DT,%W,%X,%Y,%Y1,A,C,D0,D1,D2,DA,DIC,DIE,DIV,DK,I,ORIFN,ORVP,POP,RACN,RACNI,RACS,RACT,RADADA,RADATE,RADFN,RADIE,RADIV,RADR,RADTE,RADTI,RAEXFM,RAEXLBLS,RAFIN,RAFL,RAFLG,RAFLH,RAFLHFL,RAHEAD,RAI,RAJ
"RTN","RAEDCN",63,0)
 K RAMES,RANME,RANUM,RAOIFN,RAOR,RAORDIFN,RAOREA,RAORIFN,RAOSEL,RAOSTS,RAPOP,RAPRI,RAPRC,RAQUICK,RAPRIT,RARPT,RARPTZ,RASN,RASSN,RAST,RASTI,RAVW,X,XQUIT,VAINDT,VADMVT,Y,^TMP($J,"RAEX")
"RTN","RAEDCN",64,0)
 K %H,%I,D,D3,DDER,DI,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,GMRAL
"RTN","RAEDCN",65,0)
 K J,SDCLST,R1,RA,RACANC,RACN0,RACPT,RACPTNDE,RADA,RAEND,RAFELIG,RAFST
"RTN","RAEDCN",66,0)
 K RAIX,RAN,RAOBR4,RAPRCNDE,RAPROC,RAPROCIT,RAPRV,RAXIT,VA,VADM,VAERR,Z
"RTN","RAEDCN",67,0)
 K DFN,DIPGM,DISYS,DQ,DR,HLN,HLRESLT,HLSAN,RAAFTER,RABEFORE,X0
"RTN","RAEDCN",68,0)
 K DLAYGO,DDH,RADFLTP
"RTN","RAEDCN",69,0)
 Q
"RTN","RAEDCN",70,0)
 ;
"RTN","RAEDCN",71,0)
DIAG N RADIAG,RAXIT
"RTN","RAEDCN",72,0)
 S RAXIT=0,RAFLG("DIAG")="",RADR="[RA DIAGNOSTIC BY CASE]" G START
"RTN","RAEDCN",73,0)
 ;
"RTN","RAEDCN",74,0)
SAVE S RADR="[RA NO PURGE SPECIFICATION]" G START
"RTN","RAEDCN",75,0)
 ;
"RTN","RAEDCN",76,0)
EDIT ; Case No. Exam Edit
"RTN","RAEDCN",77,0)
 N RAEDIT,RAXIT
"RTN","RAEDCN",78,0)
 N RAREM,RANUZD1,RAPSDRUG,RA00,RADIOPH,RALOW,RAHI,RADRAWN,RAASK,RADOSE,RASKMEDS,RAWHICH ;these are used by the edit template
"RTN","RAEDCN",79,0)
 S RAXIT=0,RAFLG("EDIT")="",RAQUICK=1,RADR="[RA EXAM EDIT]" G START
"RTN","RAEDCN",80,0)
 ;
"RTN","RAEDCN",81,0)
CANCEL D SET^RAPSET1 I $D(XQUIT) K XQUIT Q
"RTN","RAEDCN",82,0)
 S RAXIT=$$CKREASON^RAEDCN1("C") I RAXIT K RAXIT Q  ;P18
"RTN","RAEDCN",83,0)
 D ^RACNLU G Q:X="^" I $D(^RA(72,"AA",RAIMGTY,0,+RAST)) W !?3,$C(7),"This exam has already been cancelled!" G Q
"RTN","RAEDCN",84,0)
 I $D(^RA(72,+RAST,0)),$P(^(0),"^",6)'="y" W !?3,$C(7),"This exam is in the '",$P(^(0),"^"),"' status and cannot be 'CANCELLED'." G Q
"RTN","RAEDCN",85,0)
 ; 06/11/2007 KAM/BAY *85 Added descendent check to next line
"RTN","RAEDCN",86,0)
ASKIMG I RARPT,($$STUB^RAEDCN1(RARPT)),($$PSET^RAEDCN1(RADFN,RADTI,RACNI)) D  G:"Nn"[$E(X) Q G:"Yy"[$E(X) ASKCAN W:X'["?" $C(7) W !!?3,"Enter 'YES' to cancel a descendent exam with images, or 'NO' not to." G ASKIMG
"RTN","RAEDCN",87,0)
 . S X=RANME_"'s Case No. "_$E(RADTE,4,7)_$E(RADTE,1,2)_"-"_RACN
"RTN","RAEDCN",88,0)
 . W !!?10,"----------------------------------",$C(7)
"RTN","RAEDCN",89,0)
 . W !?10,X
"RTN","RAEDCN",90,0)
 . W !?10,"This descendent exam has associated images.",$C(7)
"RTN","RAEDCN",91,0)
 . W !?10,"----------------------------------",$C(7)
"RTN","RAEDCN",92,0)
 . I '$D(^XUSEC("RA MGR",DUZ)) D  S X="N" Q
"RTN","RAEDCN",93,0)
 .. W !!?3,"** You do not have the  RA MGR  key to cancel an exam with images. **",$C(7)
"RTN","RAEDCN",94,0)
 .. R !!?10,"Press RETURN to continue.",X:DTIME
"RTN","RAEDCN",95,0)
 .. Q
"RTN","RAEDCN",96,0)
 . R !!,"Do you really want to cancel this exam with images? NO//",X:DTIME S:'$T!(X="")!(X["^") X="N"
"RTN","RAEDCN",97,0)
 . Q
"RTN","RAEDCN",98,0)
 I RARPT W !?3,$C(7),"A report has been filed for this case. Therefore cancellation is not allowed!" G Q
"RTN","RAEDCN",99,0)
ASKCAN R !!,"Do you wish to cancel this exam now? NO// ",X:DTIME S:'$T!(X="")!(X["^") X="N" G Q:"Nn"[$E(X) I "Yy"'[$E(X) W:X'["?" $C(7) W !!?3,"Enter 'YES' to cancel this exam, or 'NO' not to." G ASKCAN
"RTN","RAEDCN",100,0)
 N REM ;used for remarks within edit template
"RTN","RAEDCN",101,0)
 L +^RADPT(RADFN):1 I '$T W !,$C(7),"Someone else is editing the patient you selected",!,"Please try later" K RADTE,RACN,RAPOP,RADUZ G Q
"RTN","RAEDCN",102,0)
 S DA=RADFN,DR="[RA CANCEL]",DIE="^RADPT(" D ^DIE K DE,DQ,DIE,DR
"RTN","RAEDCN",103,0)
 K RADTE,RACN,RAPOP,RADUZ ;moved from edit template
"RTN","RAEDCN",104,0)
PACS I '$D(Y),$D(RAFIN) W !?10,"...cancellation complete." D DELPNT^RAUTL20(RADFN,RADTI,RACNI),^RAORDC,CANCEL^RAHLRPC
"RTN","RAEDCN",105,0)
 L -^RADPT(RADFN)
"RTN","RAEDCN",106,0)
 G Q
"RTN","RAEDCN",107,0)
 ;
"RTN","RAEDCN",108,0)
DUP ; Option: RA FLASH
"RTN","RAEDCN",109,0)
 N RAREGX,RAYN D SET^RAPSET1 I $D(XQUIT) K XQUIT,POP Q
"RTN","RAEDCN",110,0)
DUP1 D ^RACNLU G Q:X="^"
"RTN","RAEDCN",111,0)
 G Q:'$D(^RADPT(RADFN,"DT",RADTI,0))
"RTN","RAEDCN",112,0)
 S RAREGX(0)=$G(^RADPT(RADFN,"DT",RADTI,0))
"RTN","RAEDCN",113,0)
 S RAREGX(4)=+$P(RAREGX(0),"^",4)
"RTN","RAEDCN",114,0)
 I +$G(RAMLC)'=RAREGX(4) D  I $P(RAYN,"^",2) D Q QUIT
"RTN","RAEDCN",115,0)
 . W !!?3,"Your sign-on location is: "
"RTN","RAEDCN",116,0)
 . W $P($G(^SC(+$G(^RA(79.1,+$G(RAMLC),0)),0)),"^")_".  The location"
"RTN","RAEDCN",117,0)
 . W !?3,"of case ",RACN," is "
"RTN","RAEDCN",118,0)
 . W $P($G(^SC(+$G(^RA(79.1,RAREGX(4),0)),0)),"^"),".",!
"RTN","RAEDCN",119,0)
 . K DIR,DIROUT,DIRUT,DTOUT,DUOUT S DIR(0)="Y",DIR("B")="Yes"
"RTN","RAEDCN",120,0)
 . S DIR("?")="Enter 'Y'es to switch locations or 'N'o exit the option."
"RTN","RAEDCN",121,0)
 . S DIR("A")="Do you wish to switch Imaging Locations" D ^DIR
"RTN","RAEDCN",122,0)
 . S RAYN=+Y_"^"_$S($D(DIRUT):1,1:0)
"RTN","RAEDCN",123,0)
 . K DIR,DIROUT,DIRUT,DTOUT,DUOUT  Q:'+RAYN  ; quit if no
"RTN","RAEDCN",124,0)
 . D KILL^RAPSET1,SET^RAPSET1 ; else switch locations
"RTN","RAEDCN",125,0)
 . I $D(XQUIT) S $P(RAYN,"^",2)=1 K XQUIT
"RTN","RAEDCN",126,0)
 . Q
"RTN","RAEDCN",127,0)
 S ION=$P(RAMLC,"^",3) ; imaging location flash card printer (if any)
"RTN","RAEDCN",128,0)
 G Q:'$D(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)) S Y=^(0),Y=$S($D(^RAMIS(71,+$P(Y,"^",2),0)):$P(^(0),"^",3),1:"")
"RTN","RAEDCN",129,0)
 ; if Y, then convert the pointer value 'Y' to the .01 value of
"RTN","RAEDCN",130,0)
 ; the procedure flash card printer (if any)
"RTN","RAEDCN",131,0)
 I Y]"",$D(^%ZIS(1,+Y,0)) D
"RTN","RAEDCN",132,0)
 . S Y(0)=$$GET1^DIQ(3.5,+Y,.01) ; .01 value for proc flash card printer
"RTN","RAEDCN",133,0)
 . S:Y(0)'=$P(RAMLC,"^",3) ION=Y(0) K Y(0)
"RTN","RAEDCN",134,0)
 . ; if flash card printer for the imaging location differs from
"RTN","RAEDCN",135,0)
 . ; the procedure flash card printer, default (print to) to the flash
"RTN","RAEDCN",136,0)
 . ; card printer for the procedure.
"RTN","RAEDCN",137,0)
 . Q
"RTN","RAEDCN",138,0)
 S RAMES="W !!,""Duplicates queued to print on "",ION,"".""",RAFLH=$S($P(RAMLC,"^",7):$P(RAMLC,"^",7),1:1),RAEXFM=$S($P(RAMLC,"^",9):$P(RAMLC,"^",9),1:1),RAFLHFL=RACNI
"RTN","RAEDCN",139,0)
FLH ; Flash Cards
"RTN","RAEDCN",140,0)
 R !,"How many flash cards? 1// ",X:DTIME G DUP1:'$T!(X["^") S:X="" X=1 S RANUM=X I '(RANUM?.N)!(RANUM>20) W !?3,$C(7),"Must be a whole number less than 21!" G FLH
"RTN","RAEDCN",141,0)
EXM ; Exam Labels
"RTN","RAEDCN",142,0)
 R !,"How many exam labels? 1// ",X:DTIME G DUP1:'$T!(X["^") S:X="" X=1 S RAEXLBLS=X I '(RAEXLBLS?.N)!(RAEXLBLS>20) W !?3,$C(7),"Must be a whole number less than 21!" G EXM
"RTN","RAEDCN",143,0)
 S IOP="Q" S:ION]"" RADFLTP=ION
"RTN","RAEDCN",144,0)
 K RAFL D Q^RAFLH,Q G DUP1
"RTN","RAEDCN",145,0)
 ;
"RTN","RAEDCN",146,0)
SETVARS ; Setup key Rad/Nuc Med variables
"RTN","RAEDCN",147,0)
 I $O(RACCESS(DUZ,""))="" D SETVARS^RAPSET1(0)
"RTN","RAEDCN",148,0)
 Q:'($D(RACCESS(DUZ))\10)  ; user does not have location access
"RTN","RAEDCN",149,0)
 I $G(RAIMGTY)="" D SETVARS^RAPSET1(1) K:$G(RAIMGTY)="" XQUIT
"RTN","RAEDCN",150,0)
 Q
"RTN","RAEDCN",151,0)
WARN1 W !?3,"An electronically filed report has already been entered for this case.",!?3,"Please use the 'Outside Report Entry/Edit' option to change or enter",!?3,"diagnostic code for this case.",!!
"RTN","RAEDCN",152,0)
 Q
"RTN","RAO7PC2")
0^6^B47517488
"RTN","RAO7PC2",1,0)
RAO7PC2 ;HISC/GJC-Part two for Return Narrative (EN3^RAO7PC1) ;8/18/08  09:47
"RTN","RAO7PC2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**1,11,14,16,22,27,45,75,56,95,97**;Mar 16, 1998;Build 6
"RTN","RAO7PC2",3,0)
 ;Supported IA #1571 ^LEX(757.01
"RTN","RAO7PC2",4,0)
 ;Supported IA #10104 UP^XLFSTR
"RTN","RAO7PC2",5,0)
 ;Supported IA #2055 EXTERNAL^DILFD
"RTN","RAO7PC2",6,0)
 ;Supported IA #10060 ^VA(200
"RTN","RAO7PC2",7,0)
CASE(Y) ; Retrieve exam data for specified inverse exam date range.
"RTN","RAO7PC2",8,0)
 ; 'Y'-> Exam node IEN
"RTN","RAO7PC2",9,0)
 N RABNOR,RACNT,RAEXAM,RAI,RAIMPRES,RAINCLUD,RAOPRC,RAORD,RAPDIAG
"RTN","RAO7PC2",10,0)
 N RAPIST,RAPIRE,RAPROC,RARDE,RADTI,RACNI,RADUPHX,RAREASDY
"RTN","RAO7PC2",11,0)
 N RARPT,RARPTST,RARPTXT,RASBN,RASDIAG,RAVER,RAERRFLG,Z,Z1,Z2,RATMP
"RTN","RAO7PC2",12,0)
 S RACNT=1
"RTN","RAO7PC2",13,0)
 S RAEXAM(0)=$G(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,0)) Q:RAEXAM(0)']""
"RTN","RAO7PC2",14,0)
 S:$P(RAEXAM(0),"^",25)=2 RAPSET=1
"RTN","RAO7PC2",15,0)
 S:RAPSET=1 ^TMP($J,"RAE2",RADFN,"PRINT_SET")="" ; xam set with same rpt
"RTN","RAO7PC2",16,0)
 S RAPROC(0)=$G(^RAMIS(71,+$P(RAEXAM(0),"^",2),0))
"RTN","RAO7PC2",17,0)
 S RAPROC=$S($P(RAPROC(0),"^")]"":$P(RAPROC(0),"^"),1:"Unknown")
"RTN","RAO7PC2",18,0)
 S RAORD(0)=$G(^RAO(75.1,+$P(RAEXAM(0),"^",11),0))
"RTN","RAO7PC2",19,0)
 S RAORD(7)=$P(RAORD(0),"^",7) ; CPRS order ien
"RTN","RAO7PC2",20,0)
 S RAREASDY=$P($G(^RAO(75.1,+$P(RAEXAM(0),"^",11),.1)),"^") ;REASON FOR STUDY
"RTN","RAO7PC2",21,0)
 S RAOPRC(0)=$G(^RAMIS(71,+$P(RAORD(0),"^",2),0))
"RTN","RAO7PC2",22,0)
 S RAOPRC=$S($P(RAOPRC(0),"^")]"":$P(RAOPRC(0),"^"),1:"Unknown")
"RTN","RAO7PC2",23,0)
 S RAPDIAG(0)=$G(^RA(78.3,+$P(RAEXAM(0),"^",13),0))
"RTN","RAO7PC2",24,0)
 S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+$P(RAEXAM(0),U,13),0)),U,6),.01)
"RTN","RAO7PC2",25,0)
 S RAPDIAG=$P(RAPDIAG(0),"^")_$S(RATMP="":"",1:" ("_RATMP_")")
"RTN","RAO7PC2",26,0)
 S RARPT=+$P(RAEXAM(0),"^",17)
"RTN","RAO7PC2",27,0)
 ; RARPTST="NO REPORT" if no ^RARPT(ien) OR no data for Report Status
"RTN","RAO7PC2",28,0)
 S RARPT(0)=$G(^RARPT(RARPT,0)),RARPTST=$$UL^RAO7PC1A($$RSTAT^RAO7PC1A())
"RTN","RAO7PC2",29,0)
 ; set the following flag variable: RAINCLUD
"RTN","RAO7PC2",30,0)
 ; RAINCLUD=1 includes V, R, EF <-- patch 95
"RTN","RAO7PC2",31,0)
 S RAINCLUD=$S("RVE"[$E(RARPTST):1,1:0)
"RTN","RAO7PC2",32,0)
 I $E(RARPTST)="V",(RAPSET'<0) D
"RTN","RAO7PC2",33,0)
 . S RAVER=$P(RARPT(0),"^",9),RASBN=$P($G(^VA(200,+RAVER,20)),"^",2)
"RTN","RAO7PC2",34,0)
 . S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"V")=RAVER_"^"_RASBN
"RTN","RAO7PC2",35,0)
 . Q
"RTN","RAO7PC2",36,0)
 S RABNOR=$$UP^XLFSTR($P(RAPDIAG(0),"^",4)) S:RABNOR'="Y" RABNOR=""
"RTN","RAO7PC2",37,0)
 I RAPDIAG]"",(RAINCLUD),(RAPSET'<0) D  ; if diag & verif'd or released/unverif'd & first pass if part of xam set (many xams - one rpt)
"RTN","RAO7PC2",38,0)
 . S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"D",RACNT)=RAPDIAG
"RTN","RAO7PC2",39,0)
 . Q
"RTN","RAO7PC2",40,0)
 S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"RFS")=RAREASDY ;REASON FOR STUDY
"RTN","RAO7PC2",41,0)
 ; 1st, get clnhist from file70. 2nd, get addl clnhist form file74
"RTN","RAO7PC2",42,0)
 ; 1st:
"RTN","RAO7PC2",43,0)
 I +$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"H",0)) D
"RTN","RAO7PC2",44,0)
 . N RAI S (RAI,Z)=0
"RTN","RAO7PC2",45,0)
 . F  S Z=$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"H",Z)) Q:Z'>0  D
"RTN","RAO7PC2",46,0)
 .. S RAI=RAI+1
"RTN","RAO7PC2",47,0)
 .. S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"H",RAI)=$G(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"H",Z,0))
"RTN","RAO7PC2",48,0)
 .. Q
"RTN","RAO7PC2",49,0)
 . Q
"RTN","RAO7PC2",50,0)
 ;2nd:
"RTN","RAO7PC2",51,0)
 S RADTI=RAINVXDT,RACNI=Y D CHKDUPHX^RART1 ;chk if file74 clnhist is dupl
"RTN","RAO7PC2",52,0)
 I 'RADUPHX,$O(^RARPT(RARPT,"H",0)) S Z="H" D RPTXT(RARPT,Z)
"RTN","RAO7PC2",53,0)
 ;
"RTN","RAO7PC2",54,0)
 I +$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"M",0)) D  ; save modifiers
"RTN","RAO7PC2",55,0)
 . N RAI S (RAI,Z)=0
"RTN","RAO7PC2",56,0)
 . F  S Z=$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"M",Z)) Q:Z'>0  D
"RTN","RAO7PC2",57,0)
 .. S RAI=RAI+1
"RTN","RAO7PC2",58,0)
 .. S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"M",RAI)=$P($G(^RAMIS(71.2,+$G(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"M",Z,0)),0)),"^")
"RTN","RAO7PC2",59,0)
 .. Q
"RTN","RAO7PC2",60,0)
 . Q
"RTN","RAO7PC2",61,0)
 I +$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"DX",0)),(RAPSET'<0) D
"RTN","RAO7PC2",62,0)
 . S Z=0 F  S Z=$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"DX",Z)) Q:Z'>0  D
"RTN","RAO7PC2",63,0)
 .. S RASDIAG=+$G(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"DX",Z,0))
"RTN","RAO7PC2",64,0)
 .. S RASDIAG(0)=$G(^RA(78.3,RASDIAG,0))
"RTN","RAO7PC2",65,0)
 .. S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RASDIAG,0)),U,6),.01)
"RTN","RAO7PC2",66,0)
 .. S RASDIAG(1)=$P(RASDIAG(0),"^")_$S(RATMP="":"",1:" ("_RATMP_")")
"RTN","RAO7PC2",67,0)
 .. I RASDIAG(1)]"",(RAINCLUD) D
"RTN","RAO7PC2",68,0)
 ... S RACNT=RACNT+1,^TMP($J,"RAE2",RADFN,Y,RAPROC,"D",RACNT)=RASDIAG(1)
"RTN","RAO7PC2",69,0)
 ... I RABNOR'="Y" D
"RTN","RAO7PC2",70,0)
 .... S RABNOR=$$UP^XLFSTR($P(RASDIAG(0),"^",4)) S:RABNOR'="Y" RABNOR=""
"RTN","RAO7PC2",71,0)
 .... Q
"RTN","RAO7PC2",72,0)
 ... Q
"RTN","RAO7PC2",73,0)
 .. Q
"RTN","RAO7PC2",74,0)
 . Q
"RTN","RAO7PC2",75,0)
 I RAINCLUD,(RAPSET'<0) D
"RTN","RAO7PC2",76,0)
 . I +$O(^RARPT(RARPT,"I",0)) S Z="I" D RPTXT(RARPT,Z)
"RTN","RAO7PC2",77,0)
 . I +$O(^RARPT(RARPT,"R",0)) S Z="R" D RPTXT(RARPT,Z)
"RTN","RAO7PC2",78,0)
 . Q
"RTN","RAO7PC2",79,0)
 I $P(RAEXAM(0),"^",25) S ^TMP($J,"RAE2",RADFN,"ORD")=RAOPRC
"RTN","RAO7PC2",80,0)
 I '$P(RAEXAM(0),"^",25) S ^TMP($J,"RAE2",RADFN,"ORD",Y)=RAOPRC
"RTN","RAO7PC2",81,0)
 ;
"RTN","RAO7PC2",82,0)
 ; Check to see if amended report
"RTN","RAO7PC2",83,0)
 I RAPSET'<0,+$O(^RARPT(RARPT,"ERR",0)) S RAERRFLG="A"
"RTN","RAO7PC2",84,0)
 ;
"RTN","RAO7PC2",85,0)
 S:RAPSET'<0 ^TMP($J,"RAE2",RADFN,Y,RAPROC)=RARPTST_"^"_$G(RABNOR)_"^"_$G(RAORD(7))_"^"_$G(RAERRFLG)
"RTN","RAO7PC2",86,0)
 S:RAPSET<0 ^TMP($J,"RAE2",RADFN,Y,RAPROC)=""
"RTN","RAO7PC2",87,0)
 S:RAPSET=1 RAPSET=-1
"RTN","RAO7PC2",88,0)
 ;
"RTN","RAO7PC2",89,0)
 I RARPTST'="No Report" D
"RTN","RAO7PC2",90,0)
 .; Add Prim Int Staff, Prim Int Resident & Reported Date
"RTN","RAO7PC2",91,0)
 .S RAPIST=$P(RAEXAM(0),"^",15)
"RTN","RAO7PC2",92,0)
 .S RAPIRE=$P(RAEXAM(0),"^",12)
"RTN","RAO7PC2",93,0)
 .S RARDE=$P(RARPT(0),"^",8)
"RTN","RAO7PC2",94,0)
 .S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"P")=RAPIST_"^"_RAPIRE_"^"_RARDE
"RTN","RAO7PC2",95,0)
 ;If contrast media was involved in the exam pass that information.
"RTN","RAO7PC2",96,0)
 I +$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"CM",0)) S (RACNT,RAI)=0 D
"RTN","RAO7PC2",97,0)
 .F  S RAI=$O(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"CM",RAI)) Q:'RAI  D
"RTN","RAO7PC2",98,0)
 ..S RACNT=RACNT+1
"RTN","RAO7PC2",99,0)
 ..S RAI(0)=$G(^RADPT(RADFN,"DT",RAINVXDT,"P",Y,"CM",RAI,0))
"RTN","RAO7PC2",100,0)
 ..S ^TMP($J,"RAE2",RADFN,Y,RAPROC,"CM",RACNT)=$P(RAI(0),U)_"^"_$$EXTERNAL^DILFD(70.3225,.01,"",$P(RAI(0),U))
"RTN","RAO7PC2",101,0)
 ..Q
"RTN","RAO7PC2",102,0)
 Q
"RTN","RAO7PC2",103,0)
 ;
"RTN","RAO7PC2",104,0)
RPTXT(RARPT,Z) ; Retrieve report text & store in ^TMP
"RTN","RAO7PC2",105,0)
 ; 'RARPT' -> Report IEN
"RTN","RAO7PC2",106,0)
 ; 'Z'     -> "I":Impression Text <> "R":Report Text
"RTN","RAO7PC2",107,0)
 S (Z1,Z2)=0
"RTN","RAO7PC2",108,0)
 ;file 74's "H" nodes are now additional clinical history
"RTN","RAO7PC2",109,0)
 I Z="H" S Z2=$O(^TMP($J,"RAE2",RADFN,Y,RAPROC,Z,""),-1) I $O(^RARPT(RARPT,Z,Z1)) S Z2=Z2+1,^TMP($J,"RAE2",RADFN,Y,RAPROC,Z,Z2)="Additional Clinical History:"
"RTN","RAO7PC2",110,0)
 F  S Z1=$O(^RARPT(RARPT,Z,Z1)) Q:Z1'>0  D
"RTN","RAO7PC2",111,0)
 . S Z1(0)=$G(^RARPT(RARPT,Z,Z1,0)),Z2=Z2+1
"RTN","RAO7PC2",112,0)
 . S ^TMP($J,"RAE2",RADFN,Y,RAPROC,Z,Z2)=Z1(0)
"RTN","RAO7PC2",113,0)
 . Q
"RTN","RAO7PC2",114,0)
 Q
"RTN","RAO7PC2",115,0)
 ;
"RTN","RAO7PC2",116,0)
CLIN(DFN,PROCLIST) ;Radiology and Clinical Reminders API
"RTN","RAO7PC2",117,0)
 ;
"RTN","RAO7PC2",118,0)
 ; Created by Cameron Taylor March 1999
"RTN","RAO7PC2",119,0)
 ; 
"RTN","RAO7PC2",120,0)
 ; This API recieves a patient and a list of procedures. For each 
"RTN","RAO7PC2",121,0)
 ; Procedure, the details of the last 'complete' procedure and/or the
"RTN","RAO7PC2",122,0)
 ; last 'cancelled' & 'in progress' procedure details and returns them 
"RTN","RAO7PC2",123,0)
 ; in ^TMP($J,"RADPROC"
"RTN","RAO7PC2",124,0)
 N XX,PROC,DATE,STATUS,PROVIDER,EXAM,X,Y,EXAMIEN,RADPTIEN,ORDER,SUCCESS
"RTN","RAO7PC2",125,0)
 ; 
"RTN","RAO7PC2",126,0)
 S DFN=$G(DFN)  ; Patient Name
"RTN","RAO7PC2",127,0)
 S PROCLIST=$G(PROCLIST)  ; List of Procedures (separated by '^')
"RTN","RAO7PC2",128,0)
 K ^TMP($J,"RADPROC")
"RTN","RAO7PC2",129,0)
 ;
"RTN","RAO7PC2",130,0)
 S RADPTIEN=$O(^RADPT("B",DFN,""))
"RTN","RAO7PC2",131,0)
 I (RADPTIEN="")!(RADPTIEN=0) D  Q
"RTN","RAO7PC2",132,0)
 .S ^TMP($J,"RADPROC")="Invalid/Unknown Radiology Patient"
"RTN","RAO7PC2",133,0)
 ;
"RTN","RAO7PC2",134,0)
 F XX=1:1 S PROC=$P(PROCLIST,U,XX) Q:PROC=""  D
"RTN","RAO7PC2",135,0)
 .S SUCCESS=0  ; Quit searching if SUCCESS=3 (comp, canc & in prog)
"RTN","RAO7PC2",136,0)
 .S DATE=0 F  S DATE=$O(^RADPT(RADPTIEN,"DT",DATE)) Q:DATE'?7N1".".N!(SUCCESS=3)  D
"RTN","RAO7PC2",137,0)
 ..S EXAMIEN=0 F  S EXAMIEN=$O(^RADPT(RADPTIEN,"DT",DATE,"P",EXAMIEN)) Q:'EXAMIEN!(SUCCESS=3)  D
"RTN","RAO7PC2",138,0)
 ...S EXAM=$G(^RADPT(RADPTIEN,"DT",DATE,"P",EXAMIEN,0))
"RTN","RAO7PC2",139,0)
 ...Q:$P(EXAM,U,2)'=PROC
"RTN","RAO7PC2",140,0)
 ...;
"RTN","RAO7PC2",141,0)
 ...; Continue, get STATUS and ORDER 
"RTN","RAO7PC2",142,0)
 ...; (0 is cancelled, 1-8 in progress & 9 is COMPLETE)
"RTN","RAO7PC2",143,0)
 ...; (ignore if null)
"RTN","RAO7PC2",144,0)
 ...;
"RTN","RAO7PC2",145,0)
 ...S STATUS=$P(EXAM,U,3)
"RTN","RAO7PC2",146,0)
 ...I STATUS'="" D
"RTN","RAO7PC2",147,0)
 ....S ORDER=$P(^RA(72,STATUS,0),U,3)
"RTN","RAO7PC2",148,0)
 ....S STATUS=$P(^RA(72,STATUS,0),U) ; description
"RTN","RAO7PC2",149,0)
 ...; 
"RTN","RAO7PC2",150,0)
 ...; Only one of each type (ORDER)
"RTN","RAO7PC2",151,0)
 ...;
"RTN","RAO7PC2",152,0)
 ...Q:ORDER=""
"RTN","RAO7PC2",153,0)
 ...I ORDER=0 Q:$D(^TMP($J,"RADPROC",RADPTIEN,PROC,"CANCELLED"))  S ORDER="CANCELLED"
"RTN","RAO7PC2",154,0)
 ...I ORDER=9 Q:$D(^TMP($J,"RADPROC",RADPTIEN,PROC,"COMPLETE"))  S ORDER="COMPLETE"
"RTN","RAO7PC2",155,0)
 ...I ORDER<9,ORDER>0 Q:$D(^TMP($J,"RADPROC",RADPTIEN,PROC,"IN PROGRESS"))  S ORDER="IN PROGRESS"
"RTN","RAO7PC2",156,0)
 ...;
"RTN","RAO7PC2",157,0)
 ...; Now for the PROVIDER. Check PRIMARY INTERPRETING STAFF 
"RTN","RAO7PC2",158,0)
 ...; if none, then default to PRIMARY INTERPRETING RESIDENT.
"RTN","RAO7PC2",159,0)
 ...;
"RTN","RAO7PC2",160,0)
 ...S PROVIDER=$P(EXAM,U,15)
"RTN","RAO7PC2",161,0)
 ...S:PROVIDER="" PROVIDER=$P(EXAM,U,12)
"RTN","RAO7PC2",162,0)
 ...S:PROVIDER'="" PROVIDER=$P($G(^VA(200,PROVIDER,0)),U,1) ; description
"RTN","RAO7PC2",163,0)
 ...;
"RTN","RAO7PC2",164,0)
 ...; Create return info. on ^TMP (1st manipulate DATE)
"RTN","RAO7PC2",165,0)
 ...;
"RTN","RAO7PC2",166,0)
 ...S Y=9999999.9999-DATE
"RTN","RAO7PC2",167,0)
 ...S ^TMP($J,"RADPROC",RADPTIEN,PROC,ORDER)=Y_U_STATUS_U_PROVIDER
"RTN","RAO7PC2",168,0)
 ...S SUCCESS=SUCCESS+1
"RTN","RAO7PC2",169,0)
 .;
"RTN","RAO7PC2",170,0)
 .; Finished searching Patient file. Any Procedures with no activity?
"RTN","RAO7PC2",171,0)
 .;
"RTN","RAO7PC2",172,0)
 .I '$D(^TMP($J,"RADPROC",RADPTIEN,PROC)) S ^TMP($J,"RADPROC",RADPTIEN,PROC,"NONE")=""
"RTN","RAO7PC2",173,0)
 Q
"RTN","RAO7PC2",174,0)
 ;
"RTN","RAPRINT")
0^7^B31817816
"RTN","RAPRINT",1,0)
RAPRINT ;HISC/FPT AISC/DMK-Abnormal Exam Report ; 5/5/09 2:25pm
"RTN","RAPRINT",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**97**;Mar 16, 1998;Build 6
"RTN","RAPRINT",3,0)
 ;
"RTN","RAPRINT",4,0)
 ; This report uses the 'AD' cross reference on File 70 to create a
"RTN","RAPRINT",5,0)
 ; report of exams that use certain diagnostic codes. The Diagnostic
"RTN","RAPRINT",6,0)
 ; Codes file (78.3) has a field named PRINT ON ABNORMAL RPT. If this
"RTN","RAPRINT",7,0)
 ; field is set to YES and the user enters that diagnostic code for an
"RTN","RAPRINT",8,0)
 ; exam, then an entry is made in the 'AD' cross reference.
"RTN","RAPRINT",9,0)
 ;
"RTN","RAPRINT",10,0)
 I $O(RACCESS(DUZ,""))="" D SETVARS^RAPSET1(0) S RAPSTX=""
"RTN","RAPRINT",11,0)
 W !!,?10,"ABNORMAL EXAM REPORT",!
"RTN","RAPRINT",12,0)
 ; Select Imaging Type, if exists
"RTN","RAPRINT",13,0)
 S RAXIT=$$SETUPDI^RAUTL7() I RAXIT G END
"RTN","RAPRINT",14,0)
 K ^TMP($J,"RA D-TYPE"),^TMP($J,"RA I-TYPE"),^TMP($J,"RADLY")
"RTN","RAPRINT",15,0)
 D SELDIV^RAUTL7 ; Select division(s)
"RTN","RAPRINT",16,0)
 I '$D(^TMP($J,"RA D-TYPE"))!($G(RAQUIT)) D KILL^RADLY1 G END
"RTN","RAPRINT",17,0)
 D SELIMG^RAUTL7 ; Select I-Type(s)
"RTN","RAPRINT",18,0)
 I '$D(^TMP($J,"RA I-TYPE"))!($G(RAQUIT)) D KILL^RADLY1 G END
"RTN","RAPRINT",19,0)
 S X="" F  S X=$O(RACCESS(DUZ,"DIV-IMG",X)) Q:X']""  D
"RTN","RAPRINT",20,0)
 . Q:'$D(^TMP($J,"RA D-TYPE",X))  S Y=""
"RTN","RAPRINT",21,0)
 . F  S Y=$O(RACCESS(DUZ,"DIV-IMG",X,Y)) Q:Y']""  D
"RTN","RAPRINT",22,0)
 .. S:$D(^TMP($J,"RA I-TYPE",Y)) ^TMP($J,"RADLY",X,Y)=0
"RTN","RAPRINT",23,0)
 .. Q
"RTN","RAPRINT",24,0)
 . Q
"RTN","RAPRINT",25,0)
 K ^TMP($J,"RA DX CODES") D OMADX(1)
"RTN","RAPRINT",26,0)
 I '$D(^TMP($J,"RA DX CODES")) D  D END Q
"RTN","RAPRINT",27,0)
 . W !!?3,"No Diagnostic Codes selected, try again later."
"RTN","RAPRINT",28,0)
 . Q
"RTN","RAPRINT",29,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","RAPRINT",30,0)
 S DIR("A")="Enter type of reporting"
"RTN","RAPRINT",31,0)
 S DIR(0)="S^V:VA RADIOLOGIST;E:ELECTRONICALLY FILED;A:ALL"
"RTN","RAPRINT",32,0)
 S DIR("B")="A"
"RTN","RAPRINT",33,0)
 S DIR("?",1)="  Select one of the following:"
"RTN","RAPRINT",34,0)
 S DIR("?",2)="",DIR("?",3)=""
"RTN","RAPRINT",35,0)
 S DIR("?")="       V     VA Radiologist       to include in-house "
"RTN","RAPRINT",36,0)
 S DIR("?",4)=DIR("?")_"reports only,"
"RTN","RAPRINT",37,0)
 S DIR("?")="       E     Electronically Filed to include "
"RTN","RAPRINT",38,0)
 S DIR("?",5)=DIR("?")_"Electronically Filed reports only,"
"RTN","RAPRINT",39,0)
 S DIR("?")="       A     ALL                  to include All reports."
"RTN","RAPRINT",40,0)
 S DIR("B")="ALL"
"RTN","RAPRINT",41,0)
 D ^DIR
"RTN","RAPRINT",42,0)
 I $D(DIRUT) D END Q
"RTN","RAPRINT",43,0)
 Q:$D(DIRUT)
"RTN","RAPRINT",44,0)
 ;RATRPTG is Type of Reporting
"RTN","RAPRINT",45,0)
 S RATRPTG=$S(Y="V":"VA Radiologist",Y="E":"Electronically Filed",1:"VA Radiologist and Electronically Filed")_" Reports"
"RTN","RAPRINT",46,0)
 ;RATYPE is "V", "E", or "A"
"RTN","RAPRINT",47,0)
 S RATYPE=Y
"RTN","RAPRINT",48,0)
 ;
"RTN","RAPRINT",49,0)
 W !
"RTN","RAPRINT",50,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","RAPRINT",51,0)
 S DIR(0)="Y",DIR("A")="Print only those exams not yet printed",DIR("B")="Yes",DIR("?")="Enter 'Yes' to print only those exams not yet printed, 'No' to print all." D ^DIR K DIR
"RTN","RAPRINT",52,0)
 I $D(DIRUT) D END Q
"RTN","RAPRINT",53,0)
 S RASW=$S(+Y=1:0,1:1),ZTRTN="START^RAPRINT",ZTSAVE("BEGDATE")="",ZTSAVE("ENDDATE")="",ZTSAVE("RASW")="",ZTSAVE("RAT*")="",ZTSAVE("^TMP($J,""RA D-TYPE"",")="",ZTSAVE("^TMP($J,""RA I-TYPE"",")="",ZTSAVE("^TMP($J,""RADLY"",")=""
"RTN","RAPRINT",54,0)
 S ZTSAVE("^TMP($J,""RA DX CODES"",")=""
"RTN","RAPRINT",55,0)
 D DATE^RAUTL G END:RAPOP S BEGDATE=9999999.9999-BEGDATE,ENDDATE=9999999.9999-ENDDATE
"RTN","RAPRINT",56,0)
 W ! D ZIS^RAUTL G:RAPOP END
"RTN","RAPRINT",57,0)
START ;
"RTN","RAPRINT",58,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RAPRINT",59,0)
 U IO K I S CNT=0,RAOUT=0,PDATE=+$E(DT,4,5)_"/"_+$E(DT,6,7)_"/"_$E(DT,2,3) S RAEND=ENDDATE-1,QQ="",$P(QQ,"=",80)="=",I1("DIV")="",I1("IT")="",I1("DX")=""
"RTN","RAPRINT",60,0)
 D HDR^RAPRINT1 G:RAOUT END
"RTN","RAPRINT",61,0)
 F I=0:0 S I=$O(^RADPT("AD",I)) Q:I'>0!(RAOUT)  I $D(^RA(78.3,I,0)),($D(^TMP($J,"RA DX CODES",$P(^RA(78.3,I,0),"^")))) F J=0:0 S J=$O(^RADPT("AD",I,J)) Q:J'>0!(RAOUT)  F K=RAEND:0 S K=$O(^RADPT("AD",I,J,K)) Q:K'>0!(K>BEGDATE)!(RAOUT)  D PAT1
"RTN","RAPRINT",62,0)
 D DIV^RAPRINT1,NEGRPT
"RTN","RAPRINT",63,0)
END ;
"RTN","RAPRINT",64,0)
 K ^TMP($J),BEGDATE,CNT,DIR,DIROUT,DIRUT,DTOUT,DUOUT,ENDDATE,I,I1,J,K,L,PDATE,POP,QQ
"RTN","RAPRINT",65,0)
 K RACASE,RADIC,RADFN,RADIAG,RADIVNME,RADIVNUM,RADXCODE,RAEND,RAEXAM,RAEXDT,RAITNAME,RAITNUM,RAMD,RAOUT,RAPAT,RAPATNME,RAPOP,RAPROC,RAQUIT,RASDXDTE,RASDXIEN,RASSN,RASW,RATRPTG,RATYPE,RAUTIL,RAWARD,RAXIT,X,Y
"RTN","RAPRINT",66,0)
 K POP,ZTRTN,ZTSAVE,RAMES,ZTDESC
"RTN","RAPRINT",67,0)
 K:$D(RAPSTX) RACCESS,RAPSTX
"RTN","RAPRINT",68,0)
 D CLOSE^RAUTL
"RTN","RAPRINT",69,0)
 Q
"RTN","RAPRINT",70,0)
PAT1 N RATMP
"RTN","RAPRINT",71,0)
 F L=0:0 S L=$O(^RADPT("AD",I,J,K,L)) Q:L'>0!(RAOUT)  D
"RTN","RAPRINT",72,0)
 . I '$D(^RADPT(J,"DT",K,"P",L,0)) Q
"RTN","RAPRINT",73,0)
 . S RATMP=$P(^RADPT(J,"DT",K,"P",L,0),U,17)
"RTN","RAPRINT",74,0)
 . I RATMP]"" S RATMP=$P($G(^RARPT(RATMP,0)),U,5)
"RTN","RAPRINT",75,0)
 . I RATMP="" D BTG Q
"RTN","RAPRINT",76,0)
 . I $G(RATYPE)="V",RATMP="EF" Q
"RTN","RAPRINT",77,0)
 . I $G(RATYPE)="E",RATMP'="EF" Q
"RTN","RAPRINT",78,0)
 . D BTG
"RTN","RAPRINT",79,0)
 . Q
"RTN","RAPRINT",80,0)
 Q
"RTN","RAPRINT",81,0)
BTG ; build tmp global
"RTN","RAPRINT",82,0)
 I $D(ZTQUEUED) D STOPCHK^RAUTL9 S:$G(ZTSTOP)=1 RAOUT=1 Q:RAOUT
"RTN","RAPRINT",83,0)
 S RARE(0)=$G(^RADPT(J,"DT",K,0))
"RTN","RAPRINT",84,0)
 S RADIVNUM=+$P(RARE(0),U,3),RADIVNME=$P($G(^DIC(4,RADIVNUM,0)),U)
"RTN","RAPRINT",85,0)
 I RADIVNME]"",('$D(^TMP($J,"RA D-TYPE",RADIVNME))) Q
"RTN","RAPRINT",86,0)
 S RADIVNME=$S(RADIVNME]"":RADIVNME,1:"Unknown")
"RTN","RAPRINT",87,0)
 S RAITNUM=+$P(RARE(0),U,2),RAITNAME=$P($G(^RA(79.2,RAITNUM,0)),U)
"RTN","RAPRINT",88,0)
 I RAITNAME]"",('$D(^TMP($J,"RA I-TYPE",RAITNAME))) Q
"RTN","RAPRINT",89,0)
 S RAITNAME=$S(RAITNAME]"":RAITNAME,1:"Unknown")
"RTN","RAPRINT",90,0)
 K RARE(0)
"RTN","RAPRINT",91,0)
 Q:'$D(^TMP($J,"RADLY",RADIVNME,RAITNAME))
"RTN","RAPRINT",92,0)
 S RAPATNME=$P($G(^DPT(J,0)),U,1) S:RAPATNME="" RAPATNME="UNKNOWN"
"RTN","RAPRINT",93,0)
 S ^TMP($J,RADIVNME,RAITNAME,I,RAPATNME,J,K,L)=""
"RTN","RAPRINT",94,0)
 Q
"RTN","RAPRINT",95,0)
NEGRPT ; negative reports
"RTN","RAPRINT",96,0)
 Q:+$G(RAOUT)
"RTN","RAPRINT",97,0)
 I $D(ZTQUEUED) D STOPCHK^RAUTL9 S:$G(ZTSTOP)=1 RAOUT=1 Q:RAOUT
"RTN","RAPRINT",98,0)
 S RADIVNME="",RAOUT=0
"RTN","RAPRINT",99,0)
 F  S RADIVNME=$O(^TMP($J,"RADLY",RADIVNME)) Q:RADIVNME=""!(RAOUT=1)  S RAITNAME="" F  S RAITNAME=$O(^TMP($J,"RADLY",RADIVNME,RAITNAME)) Q:RAITNAME=""!(RAOUT=1)  I +^TMP($J,"RADLY",RADIVNME,RAITNAME)=0 D
"RTN","RAPRINT",100,0)
 .D:CNT>0 HANG^RAPRINT1 Q:RAOUT=1
"RTN","RAPRINT",101,0)
 .D:CNT>0 HDR^RAPRINT1 Q:RAOUT
"RTN","RAPRINT",102,0)
 .W !?22,"Division: ",RADIVNME,!?18,"Imaging Type: ",RAITNAME,!
"RTN","RAPRINT",103,0)
 .W !?32,"***********************"
"RTN","RAPRINT",104,0)
 .W !?32,"*  No Abnormal Exams  *"
"RTN","RAPRINT",105,0)
 .W !?32,"***********************",!
"RTN","RAPRINT",106,0)
 .S CNT=1
"RTN","RAPRINT",107,0)
 Q
"RTN","RAPRINT",108,0)
OMADX(RAAB) ; One-Many-All selector for Dx codes.
"RTN","RAPRINT",109,0)
 ; Input : RAAB=0 - doesn't need 'Print On Abnormal Rpts' set to 'yes'
"RTN","RAPRINT",110,0)
 ;         RAAB=1 - must have 'Print On Abnormal Rpts' set to 'yes'
"RTN","RAPRINT",111,0)
 N RADIC,RAQUIT,RAUTIL
"RTN","RAPRINT",112,0)
 S RADIC="^RA(78.3,",RADIC(0)="QEANZ",RAUTIL="RA DX CODES"
"RTN","RAPRINT",113,0)
 S RADIC("A")="Select Diagnostic Codes: ",RADIC("B")="All"
"RTN","RAPRINT",114,0)
 S:RAAB RADIC("S")="I $P(^(0),""^"",3)=""Y"""
"RTN","RAPRINT",115,0)
 W ! D EN1^RASELCT(.RADIC,RAUTIL)
"RTN","RAPRINT",116,0)
 Q
"RTN","RAPRINT1")
0^8^B27115956
"RTN","RAPRINT1",1,0)
RAPRINT1 ;HISC/FPT-Abnormal Exam Report (cont.) ;4/5/96  10:49
"RTN","RAPRINT1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**34,97**;Mar 16, 1998;Build 6
"RTN","RAPRINT1",3,0)
DIV ; walk through tmp global, start with 'division'
"RTN","RAPRINT1",4,0)
 Q:'$D(^TMP($J))
"RTN","RAPRINT1",5,0)
 N RAFIRST,RAPRTSET,RASAME,RACURR,RAPREV,L1
"RTN","RAPRINT1",6,0)
 S RADIVNME=""
"RTN","RAPRINT1",7,0)
 F  S RADIVNME=$O(^TMP($J,RADIVNME)) Q:RADIVNME=""!(RAOUT)  D IT
"RTN","RAPRINT1",8,0)
 Q
"RTN","RAPRINT1",9,0)
IT ; imaging type
"RTN","RAPRINT1",10,0)
 S RAITNAME=""
"RTN","RAPRINT1",11,0)
 F  S RAITNAME=$O(^TMP($J,RADIVNME,RAITNAME)) Q:RAITNAME=""!(RAOUT)  D DXNUM
"RTN","RAPRINT1",12,0)
 Q
"RTN","RAPRINT1",13,0)
DXNUM ; diagnostic code number
"RTN","RAPRINT1",14,0)
 S RAPREV="" ; Determine If Next Line Item is Related to Previous Line.
"RTN","RAPRINT1",15,0)
 S I=0
"RTN","RAPRINT1",16,0)
 F  S I=$O(^TMP($J,RADIVNME,RAITNAME,I)) Q:I'>0!(RAOUT)  D PATNAME
"RTN","RAPRINT1",17,0)
 Q
"RTN","RAPRINT1",18,0)
PATNAME ; patient name
"RTN","RAPRINT1",19,0)
 S RAPATNME=""
"RTN","RAPRINT1",20,0)
 F  S RAPATNME=$O(^TMP($J,RADIVNME,RAITNAME,I,RAPATNME)) Q:RAPATNME=""!(RAOUT)  D PATIEN
"RTN","RAPRINT1",21,0)
 Q
"RTN","RAPRINT1",22,0)
PATIEN ; patient internal entry number
"RTN","RAPRINT1",23,0)
 S J=0
"RTN","RAPRINT1",24,0)
 F  S J=$O(^TMP($J,RADIVNME,RAITNAME,I,RAPATNME,J)) Q:J'>0!(RAOUT)  D EXAMDATE
"RTN","RAPRINT1",25,0)
 Q
"RTN","RAPRINT1",26,0)
EXAMDATE ; exam date
"RTN","RAPRINT1",27,0)
 S K=0
"RTN","RAPRINT1",28,0)
 F  S K=$O(^TMP($J,RADIVNME,RAITNAME,I,RAPATNME,J,K)) Q:K'>0!(RAOUT)  D CASENUM
"RTN","RAPRINT1",29,0)
 Q
"RTN","RAPRINT1",30,0)
CASENUM ; case number
"RTN","RAPRINT1",31,0)
 S (RAPRTSET,RAFIRST)=0 ; Group PrintSet Exams for Printing.
"RTN","RAPRINT1",32,0)
 S RASAME=0 ; Group Multiple Diagnoses of Same Exam for Printing.
"RTN","RAPRINT1",33,0)
 S L1=$O(^TMP($J,RADIVNME,RAITNAME,I,RAPATNME,J,K,0))
"RTN","RAPRINT1",34,0)
 I L1>0,$P(^RADPT(J,"DT",K,"P",L1,0),U,25)=2 S RAFIRST=1 D
"RTN","RAPRINT1",35,0)
 .I $O(^RADPT(J,"DT",K,"P",L1),-1) S RAFIRST=2 ; Not First PrintSet Exam.
"RTN","RAPRINT1",36,0)
 S L=0
"RTN","RAPRINT1",37,0)
 F  S L=$O(^TMP($J,RADIVNME,RAITNAME,I,RAPATNME,J,K,L)) Q:L'>0!(RAOUT)  D
"RTN","RAPRINT1",38,0)
 .D DECIDE S (RAFIRST,RAPRTSET)=0
"RTN","RAPRINT1",39,0)
 .S RAPREV=J_U_K_U_L ; This Represents Last Line Printed.
"RTN","RAPRINT1",40,0)
 Q
"RTN","RAPRINT1",41,0)
DECIDE ; decide which entries to print
"RTN","RAPRINT1",42,0)
 S RAEXAM(0)=^RADPT(J,"DT",K,"P",L,0)
"RTN","RAPRINT1",43,0)
 I 'RAFIRST,$P(RAEXAM(0),U,25)=2 S RAPRTSET=1 ; Determine Descendants.
"RTN","RAPRINT1",44,0)
 S RACURR=J_U_K_U_L ; Save Current Line Info to be Printed.
"RTN","RAPRINT1",45,0)
 S RADIAG=$P(^RA(78.3,I,0),U)
"RTN","RAPRINT1",46,0)
 S RADXCODE=$S($P(RAEXAM(0),U,13)=I:"(P)",1:"(S)")
"RTN","RAPRINT1",47,0)
 I RASW D PRINT Q
"RTN","RAPRINT1",48,0)
 I RADXCODE="(P)",$P(RAEXAM(0),U,20) Q
"RTN","RAPRINT1",49,0)
 I RADXCODE="(P)",'$P(RAEXAM(0),U,20) D PRINT Q
"RTN","RAPRINT1",50,0)
 I '$D(^RADPT(J,"DT",K,"P",L,"DX")) Q
"RTN","RAPRINT1",51,0)
 S RASDXIEN=$O(^RADPT(J,"DT",K,"P",L,"DX","B",I,0)) I RASDXIEN'>0 Q
"RTN","RAPRINT1",52,0)
 S RASDXDTE=$P(^RADPT(J,"DT",K,"P",L,"DX",RASDXIEN,0),U,2)
"RTN","RAPRINT1",53,0)
 I RASDXDTE="" D PRINT
"RTN","RAPRINT1",54,0)
 Q
"RTN","RAPRINT1",55,0)
PRINT ; print entries
"RTN","RAPRINT1",56,0)
 I $Y+5>IOSL D HANG Q:RAOUT  D HDR Q:RAOUT
"RTN","RAPRINT1",57,0)
 I I1("DIV")="" W !?22,"Division: ",RADIVNME S I1("DIV")=RADIVNME
"RTN","RAPRINT1",58,0)
 I I1("IT")="" W !?18,"Imaging Type: ",RAITNAME S I1("IT")=RAITNAME
"RTN","RAPRINT1",59,0)
 I I1("DIV")'=RADIVNME!(I1("IT")'=RAITNAME) D HANG Q:RAOUT  D HDR Q:RAOUT  S I1("DIV")=RADIVNME S I1("IT")=RAITNAME D
"RTN","RAPRINT1",60,0)
 .W !?22,"Division: ",RADIVNME
"RTN","RAPRINT1",61,0)
 .W !?18,"Imaging Type: ",RAITNAME
"RTN","RAPRINT1",62,0)
 .I I1("DX")=I W !?15,"Diagnostic Code: ",RADIAG W !?15,"----------------" D EXPRESS
"RTN","RAPRINT1",63,0)
 I I1("DX")'=I W !?15,"Diagnostic Code: ",RADIAG W !?15,"----------------" D EXPRESS
"RTN","RAPRINT1",64,0)
 S RADFN=J,RAPAT=$S($D(^DPT(J,0)):^(0),1:""),RASSN=$$SSN^RAUTL(RADFN,1)
"RTN","RAPRINT1",65,0)
 S RAPAT=$S($P(RAPAT,U)]"":$P(RAPAT,U),1:"Not Found")
"RTN","RAPRINT1",66,0)
 S Y=9999999.9999-K X ^DD("DD") S RAEXDT=Y
"RTN","RAPRINT1",67,0)
 S RACASE=$P(RAEXAM(0),U)
"RTN","RAPRINT1",68,0)
 S RAWARD=$S($P(RAEXAM(0),U,6):$P(RAEXAM(0),U,6),1:"")
"RTN","RAPRINT1",69,0)
 I RAWARD]"" S RAWARD=$S($D(^DIC(42,RAWARD,0)):$P(^(0),U),1:"")
"RTN","RAPRINT1",70,0)
 I RAWARD']"" S RAWARD=$S($P(RAEXAM(0),U,8):$P(RAEXAM(0),U,8),1:"") I RAWARD]"" S RAWARD=$S($D(^SC(RAWARD,0)):$P(^(0),U),1:"Unknown")
"RTN","RAPRINT1",71,0)
 S RAPROC=$P(RAEXAM(0),U,2)
"RTN","RAPRINT1",72,0)
 S RAPROC=$S($D(^RAMIS(71,RAPROC,0)):$P(^(0),U),1:"Unknown")
"RTN","RAPRINT1",73,0)
 S RAMD=$P(RAEXAM(0),U,14)
"RTN","RAPRINT1",74,0)
 S RAMD=$S(RAMD="":"Unknown",$D(^VA(200,RAMD,0)):$P(^(0),U),1:"Unknown")
"RTN","RAPRINT1",75,0)
 I RADXCODE="(S)",'$D(RASDXIEN) D SDX I '$D(RASDXDTE) K RADXCODE,RASDXDTE,RASDXIEN G PQ
"RTN","RAPRINT1",76,0)
 I RAFIRST!'RAPRTSET D  ; Print Patient Header Once for PrintSets.
"RTN","RAPRINT1",77,0)
 .I RAPREV=RACURR Q  ; Print Patient Header Once for Multiple Dx.
"RTN","RAPRINT1",78,0)
 .W !!
"RTN","RAPRINT1",79,0)
 .I RADXCODE="(P)" W $S($P(RAEXAM(0),U,20):"*",1:"")
"RTN","RAPRINT1",80,0)
 .I RADXCODE="(S)" W $S(RASDXDTE]"":"*",1:"")
"RTN","RAPRINT1",81,0)
 .W $E(RAPAT,1,30)_" -"_RASSN,?38,RADXCODE,?42,$E(RAWARD,1,15),?58,$E(RAMD,1,21)
"RTN","RAPRINT1",82,0)
 ; Print Pat. Case# Once for Single Exam with Multiple Dx or
"RTN","RAPRINT1",83,0)
 ; Once for PrintSets.
"RTN","RAPRINT1",84,0)
 ; Once for different DX though same pat. case#
"RTN","RAPRINT1",85,0)
 I (RAPREV'=RACURR)!(I1("DX")'=I)!RAPRTSET D
"RTN","RAPRINT1",86,0)
 .W !?2 W:RAFIRST=1 "(+)" I (RAFIRST=2)!RAPRTSET W "(.)"
"RTN","RAPRINT1",87,0)
 .W ?6,"Case #",RACASE,?20,$E(RAPROC,1,39),?60,RAEXDT
"RTN","RAPRINT1",88,0)
 I RADXCODE="(P)",'$P(^RADPT(J,"DT",K,"P",L,0),U,20) S $P(^(0),U,20)=DT
"RTN","RAPRINT1",89,0)
 I RADXCODE="(S)",'$P(^RADPT(J,"DT",K,"P",L,"DX",RASDXIEN,0),U,2) S $P(^(0),U,2)=DT
"RTN","RAPRINT1",90,0)
 S ^TMP($J,"RADLY",RADIVNME,RAITNAME)=+^TMP($J,"RADLY",RADIVNME,RAITNAME)+1,CNT=CNT+1
"RTN","RAPRINT1",91,0)
PQ S I1("DX")=I
"RTN","RAPRINT1",92,0)
 K RADXCODE,RASDXDTE,RASDXIEN
"RTN","RAPRINT1",93,0)
 Q
"RTN","RAPRINT1",94,0)
EXPRESS ;output expression text
"RTN","RAPRINT1",95,0)
 N RAXPRESS
"RTN","RAPRINT1",96,0)
 S RAXPRESS=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+I,0)),U,6),.01)
"RTN","RAPRINT1",97,0)
 I RAXPRESS'="" W ?32,"(",RAXPRESS,")"
"RTN","RAPRINT1",98,0)
 Q
"RTN","RAPRINT1",99,0)
HDR ; header
"RTN","RAPRINT1",100,0)
 W:$Y>0 @IOF
"RTN","RAPRINT1",101,0)
 W !?20,"<<<< ABNORMAL DIAGNOSTIC REPORT >>>>",?58,"Print Date: ",PDATE
"RTN","RAPRINT1",102,0)
 W !?13,"(P=Primary Dx, S=Secondary Dx / '*' represents reprint)"
"RTN","RAPRINT1",103,0)
 W !?(80-$L($G(RATRPTG))\2),$G(RATRPTG)
"RTN","RAPRINT1",104,0)
 W !,"Patient Name",?42,"Ward/Clinic",?58,"Requesting Physician"
"RTN","RAPRINT1",105,0)
 W !?20,"Procedure",?60,"Exam Date",!,QQ
"RTN","RAPRINT1",106,0)
 S I1("DIV")="",I1("IT")=""
"RTN","RAPRINT1",107,0)
 I $D(ZTQUEUED) D STOPCHK^RAUTL9 S:$G(ZTSTOP)=1 RAOUT=1
"RTN","RAPRINT1",108,0)
 Q
"RTN","RAPRINT1",109,0)
HANG ; hold screen
"RTN","RAPRINT1",110,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","RAPRINT1",111,0)
 I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR
"RTN","RAPRINT1",112,0)
 S:$D(DIRUT) RAOUT=1
"RTN","RAPRINT1",113,0)
 Q
"RTN","RAPRINT1",114,0)
SDX ; secondary dx ien and date
"RTN","RAPRINT1",115,0)
 I '$D(^RADPT(J,"DT",K,"P",L,"DX")) Q
"RTN","RAPRINT1",116,0)
 S RASDXIEN=$O(^RADPT(J,"DT",K,"P",L,"DX","B",I,0))
"RTN","RAPRINT1",117,0)
 Q:RASDXIEN'>0
"RTN","RAPRINT1",118,0)
 S RASDXDTE=$P(^RADPT(J,"DT",K,"P",L,"DX",RASDXIEN,0),U,2)
"RTN","RAPRINT1",119,0)
 Q
"RTN","RART")
0^9^B24437904
"RTN","RART",1,0)
RART ;HISC/CAH,FPT,GJC AISC/MJK,TMP,RMO-Reporting Menu ;11/16/98  15:02
"RTN","RART",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**2,5,15,18,43,82,56,97**;Mar 16, 1998;Build 6
"RTN","RART",3,0)
 ;Supported IA #1571 ^LEX(757.01
"RTN","RART",4,0)
 ;Private IA #4793 CREATE^WVRALINK
"RTN","RART",5,0)
 ;Supoprted IA #3544 ^VA(200,"ARC"
"RTN","RART",6,0)
 ;;last modification by SS for P18 June 15, 2000
"RTN","RART",7,0)
3 ;;Verify a Report
"RTN","RART",8,0)
 N I5
"RTN","RART",9,0)
 D SET^RAPSET1 I $D(XQUIT) K XQUIT Q
"RTN","RART",10,0)
 I $D(RANOSCRN) S X=$$DIVLOC^RAUTL7() I X D Q QUIT
"RTN","RART",11,0)
 G:$D(^VA(200,"ARC","S",DUZ))!($D(^XUSEC("RA VERIFY",DUZ))) 30
"RTN","RART",12,0)
 G:$P(RAMDV,"^",18)=1 30
"RTN","RART",13,0)
 G:'$D(^VA(200,"ARC","R",DUZ)) 30
"RTN","RART",14,0)
 I $P(RAMDV,"^",18)'=1 W !!,$C(7),"Interpreting Residents are not allowed to verify reports." G Q
"RTN","RART",15,0)
30 K RAUP S RAPGM=30,RAREPORT=1 D ^RACNLU G Q:X="^" I '$D(^RARPT(+RARPT,0)) W !!?2,$C(7),"No report available!" G 30
"RTN","RART",16,0)
 S I5=$P(^RARPT(+RARPT,0),"^",5) I "^V^EF^"[("^"_I5_"^") W !!?2,$C(7),"Report already ",$S(I5="V":"verified",1:"electronically filed") G 30
"RTN","RART",17,0)
SS1 Q:$$VERONLY^RAUTL11=-1  ;P18 case info 
"RTN","RART",18,0)
31 S DIE("NO^")="",DA=RARPT,DR="[RA VERIFY REPORT ONLY]",DIE="^RARPT("
"RTN","RART",19,0)
 S RAIMGTYI=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,2),RAIMGTYJ=$P($G(^RA(79.2,+RAIMGTYI,0)),U)
"RTN","RART",20,0)
 I RAIMGTYJ']"" W !,"Error: Cannot determine imaging type of exam.",! K RAIMGTYI,RAIMGTYJ G @RAPGM
"RTN","RART",21,0)
 ; must lock both report AND case together, so to ensure 
"RTN","RART",22,0)
 ; that a verified report has the correct diagnostic codes
"RTN","RART",23,0)
 S RAXIT=$$LOCK^RAUTL12(DIE,DA) ; lock Report
"RTN","RART",24,0)
 I RAXIT K RAXIT G @RAPGM
"RTN","RART",25,0)
 S RASAVDIE="^RADPT("_RADFN_",""DT"","_RADTI_",""P"",",RASAVDA(2)=RADFN,RASAVDA(1)=RADTI,RASAVDA=RACNI
"RTN","RART",26,0)
 ; rpt exists & locked, thus no need to lock at "DT" level because users
"RTN","RART",27,0)
 ; can only use 'report entry/edit' option to enter dx's for printsets
"RTN","RART",28,0)
 S RAXIT=$$LOCK^RAUTL12(RASAVDIE,.RASAVDA) ; lock case before asking REPORT STATUS
"RTN","RART",29,0)
 I RAXIT K RAXIT G @RAPGM
"RTN","RART",30,0)
 D ^DIE K DE,DQ,DR D UNLOCK^RAUTL12(DIE,DA) ; unlock Report
"RTN","RART",31,0)
 K DIE,RAXIT
"RTN","RART",32,0)
 S X=+$O(^RA(72,"AA",RAIMGTYJ,9,0)),DA(2)=RADFN,DA(1)=RADTI,DA=RACNI,DIE="^RADPT("_DA(2)_",""DT"","_DA(1)_",""P"","
"RTN","RART",33,0)
 S DR=13_$S(RACT'="V":"",'$D(^RA(72,X,.1)):"",$P(^(.1),"^",5)'="Y":"",1:"R")_";I $D(^RA(78.3,+X,0)),$P(^(0),""^"",4)=""y"" S RAAB=1 "
"RTN","RART",34,0)
 I RACT="V",($P($G(^RA(72,+X,.1)),"^",5)="Y") S DIE("NO^")="BACK"
"RTN","RART",35,0)
 D ^DIE
"RTN","RART",36,0)
 K DA,DE,DQ,DIE,DR
"RTN","RART",37,0)
 I $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)="" G UNL31
"RTN","RART",38,0)
 S DR="50///"_RACN
"RTN","RART",39,0)
 S DR(2,70.03)=13.1
"RTN","RART",40,0)
 S DR(3,70.14)=.01_";I $D(^RA(78.3,+X,0)),$P(^(0),""^"",4)=""y"" S RAAB=1"
"RTN","RART",41,0)
 S DA(1)=RADFN,DA=RADTI,DIE="^RADPT("_DA(1)_",""DT"","
"RTN","RART",42,0)
 D ^DIE
"RTN","RART",43,0)
UNL31 ; copy then unlock
"RTN","RART",44,0)
 N:'$D(RAPRTSET) RAPRTSET N:'$D(RAMEMARR) RAMEMARR
"RTN","RART",45,0)
 D EN2^RAUTL20(.RAMEMARR)
"RTN","RART",46,0)
 I RAPRTSET S RADRS=1,RAXIT=0 D COPY^RARTE2 ; copy diagnoses
"RTN","RART",47,0)
 D UNLOCK^RAUTL12(RASAVDIE,.RASAVDA) ; use params from PrimDiag's lock
"RTN","RART",48,0)
 K RASAVDIE,RASAVDA
"RTN","RART",49,0)
 K DA,DE,DQ,DIE,DR
"RTN","RART",50,0)
32 K RAXIT
"RTN","RART",51,0)
 I $G(RAPGM)="GETRPT^RARTVER" I $E(RACT'="V"),($P(^RARPT(RARPT,0),U,14)]"") D RETURN^RARTVER2
"RTN","RART",52,0)
PACS I (RACT="V")!(RACT="R") D TASK^RAHLO4
"RTN","RART",53,0)
 I "^V^EF^"[("^"_RACT_"^"),$T(CREATE^WVRALINK)]"" D CREATE^WVRALINK(RADFN,RADTI,RACNI) ;women's health
"RTN","RART",54,0)
 ;
"RTN","RART",55,0)
 I RAPGM="NXT^RABTCH1" G @RAPGM
"RTN","RART",56,0)
TIME D:RACT="V"
"RTN","RART",57,0)
 .N RAHLTCPB S RAHLTCPB=1 D UPSTAT^RAUTL0 K RAAB
"RTN","RART",58,0)
 I $G(RARDX)="S" D
"RTN","RART",59,0)
 . D SAVE^RARTVER2
"RTN","RART",60,0)
 . I $G(RAPGM)="GETRPT^RARTVER" D
"RTN","RART",61,0)
 .. ; for 'On-line Verifying of Reports' default device selection is the
"RTN","RART",62,0)
 .. ; "REPORT PRINTER NAME"
"RTN","RART",63,0)
 .. S %ZIS("B")=$P($G(RAMLC),"^",10) K:%ZIS("B")']"" %ZIS("B")
"RTN","RART",64,0)
 .. Q
"RTN","RART",65,0)
 . D Q^RARTR,RESTORE^RARTVER2
"RTN","RART",66,0)
 . K:$D(%ZIS("B")) %ZIS("B")
"RTN","RART",67,0)
 . Q
"RTN","RART",68,0)
 G @RAPGM
"RTN","RART",69,0)
Q K %,%DT,%X,C,D,D0,D1,DA,DIC,RACN,RACNI,RACT,RADATE,RADFN,RADTE,RADTI,RADUZ,RAHEAD,RAI,RAIMGTYI,RAIMGTYJ,RANME,RANUM,RAOR,RAPGM,RAPRC,RAQUIT,RAREPORT,RARPT,RASET,RASN,RASSN,RAST,RASTI,RAUP,RAVER,X,Y,^TMP($J,"RAEX")
"RTN","RART",70,0)
 K %W,%Y,%Y1,DDER,DI,DIROUT,DIRUT,DLAYGO,DTOUT,DUOUT,RACI,ZTSK,POP,DDH
"RTN","RART",71,0)
 Q
"RTN","RART",72,0)
OERR1 ; Jump to 'OERR1^RART1' This is necessary to support the reference to
"RTN","RART",73,0)
 ; this line label in the OE/RR Notifications file.
"RTN","RART",74,0)
 G OERR1^RART1 Q
"RTN","RART",75,0)
 ;
"RTN","RART",76,0)
PRTDX ; print dx codes on report display (called from RART1)
"RTN","RART",77,0)
 N RATMP
"RTN","RART",78,0)
 K RAFLG D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF))
"RTN","RART",79,0)
 Q:X="^"!(X="T")!(X="P")
"RTN","RART",80,0)
 S RADXCODE=$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)
"RTN","RART",81,0)
 W !?3,"Primary Diagnostic Code: ",!?2,$S($D(^RA(78.3,+RADXCODE,0)):$P(^(0),U,1),1:"") K RAFLG
"RTN","RART",82,0)
 S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RART",83,0)
 W:RATMP]"" " (",RATMP,")"
"RTN","RART",84,0)
 D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF)) Q:X="^"!(X="T")!(X="P")
"RTN","RART",85,0)
 I '$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0)) W ! Q
"RTN","RART",86,0)
 W !!?3,"Secondary Diagnostic Codes: "
"RTN","RART",87,0)
 S RADXCODE=0
"RTN","RART",88,0)
 F  S RADXCODE=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX","B",RADXCODE)) Q:RADXCODE'>0!('$D(^RA(78.3,+RADXCODE,0)))!($D(RAOOUT))  K RAFLG D WAIT^RART1:($Y+6)>IOSL&('$D(RARTVERF)) Q:X="^"!(X="T")!(X="P")  D
"RTN","RART",89,0)
 . W !?2,$P(^RA(78.3,RADXCODE,0),U,1)
"RTN","RART",90,0)
 . S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RART",91,0)
 . W:RATMP]"" " (",RATMP,")"
"RTN","RART",92,0)
 W !
"RTN","RART",93,0)
 Q
"RTN","RART",94,0)
EXIT ; Kill variables created when user prints 'Abnormal Rad/Nuc Med Report
"RTN","RART",95,0)
 ; Alert'.  Variables are created when 'PRT^RARTR' is called.
"RTN","RART",96,0)
 K %X,%XX,%Y,%YY,A,DDER,DFN,DI,DIR,DIW,DIWI,DIWT,DIWTC,DIWX,DLAYGO
"RTN","RART",97,0)
 K DN,RACI,RACN0,RACPT,RACPTNDE,RADTE0,RADTV,RAN,RAOBR4,RAPRCNDE
"RTN","RART",98,0)
 K RAPROC,RAPROCIT,RAPRV,RARPT0,VA,VADM,VAERR,X2,ZTSK
"RTN","RART",99,0)
 Q
"RTN","RARTE5")
0^10^B100088941
"RTN","RARTE5",1,0)
RARTE5 ;HISC/SWM AISC/MJK,RMO-Enter/Edit Outside Reports ;1/26/09  11:36
"RTN","RARTE5",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**56,95,97**;Mar 16, 1998;Build 6
"RTN","RARTE5",3,0)
 ;Private IA #4793 CREATE^WVRALINK
"RTN","RARTE5",4,0)
 ;Controlled IA #3544 ^VA(200
"RTN","RARTE5",5,0)
 ;Supported IA #2056 GET1^DIQ
"RTN","RARTE5",6,0)
 ;Supported IA #10013 IX1^DIK
"RTN","RARTE5",7,0)
 ;Supported IA #10141 MES^XPDUTL
"RTN","RARTE5",8,0)
 ; adapted from RARTE, RARTE1, RARTE4
"RTN","RARTE5",9,0)
 F I=1:1:10 W !?3,$P($T(INTRO+I),";;",2)
"RTN","RARTE5",10,0)
 W ! D SET^RAPSET1 I $D(XQUIT) K XQUIT Q
"RTN","RARTE5",11,0)
 N RAXIT,RASUBY0,RA18EX,RAPRTSET,RAMEMARR,RA1,RA7003
"RTN","RARTE5",12,0)
 S RAXIT=0
"RTN","RARTE5",13,0)
 K RASSS,RASSSX ;clear HL7 exclusion vars
"RTN","RARTE5",14,0)
 I $D(RANOSCRN) S X=$$DIVLOC^RAUTL7() I X D Q1 QUIT
"RTN","RARTE5",15,0)
 ;
"RTN","RARTE5",16,0)
 ; only require any Radiology Classification in New Person file
"RTN","RARTE5",17,0)
 S X=0 F I="C","R","S","T" S:$D(^VA(200,"ARC",I,DUZ)) X=1
"RTN","RARTE5",18,0)
 I 'X W !,"Your user account is missing a Radiology classification.",! D INCRPT Q
"RTN","RARTE5",19,0)
 ;
"RTN","RARTE5",20,0)
START S RAFIRST=0 ;=1 for 1st time rpt given "EF" rpt status
"RTN","RARTE5",21,0)
 K RAVER S RAVW="",RAREPORT=1 D ^RACNLU G Q1:"^"[X
"RTN","RARTE5",22,0)
 ; RACNLU defines RADFN, RADTI, RACNI, RARPT
"RTN","RARTE5",23,0)
 S RASUBY0=Y(0) ; save value of y(0)
"RTN","RARTE5",24,0)
 G:$P(^RA(72,+RAST,0),"^",3)>0 CONTIN
"RTN","RARTE5",25,0)
 I $D(^XUSEC("RA MGR",DUZ)) G CONTIN
"RTN","RARTE5",26,0)
 G:$P(RAMDV,"^",22)=1 CONTIN
"RTN","RARTE5",27,0)
 W $C(7),!!,"The STATUS for this case is CANCELLED. You may not enter a report.",!! D INCRPT G START
"RTN","RARTE5",28,0)
 ;
"RTN","RARTE5",29,0)
CONTIN ; continue
"RTN","RARTE5",30,0)
 S RAXIT=0 D DISPLAY^RARTE6
"RTN","RARTE5",31,0)
 I RA18EX=-1 D INCRPT G START
"RTN","RARTE5",32,0)
 ; raprtset is defined in display^rarte6
"RTN","RARTE5",33,0)
 S RAPNODE="^RADPT("_RADFN_",""DT"","_RADTI_",""P"","
"RTN","RARTE5",34,0)
 S RA7003=@(RAPNODE_RACNI_",0)")
"RTN","RARTE5",35,0)
 S RAXIT=$$LOCK^RARTE6(RAPNODE,RACNI) I RAXIT D INCRPT G START
"RTN","RARTE5",36,0)
 ;
"RTN","RARTE5",37,0)
 ; Real rpt must have fld 5="EF" & fld 18 w/ data.  Stub rpt allowed
"RTN","RARTE5",38,0)
 I $D(^RARPT(+RARPT,0)),(($P(^(0),"^",5)'="EF")!($P(^(0),"^",18)="")),'$$STUB^RAEDCN1(+RARPT) W !?3,$C(7),"Only Electronically Filed reports can be selected!",! D UNLOCK^RAUTL12(RAPNODE,RACNI) D INCRPT G START
"RTN","RARTE5",39,0)
 ;Create new rpt, or skip to IN to edit existing report
"RTN","RARTE5",40,0)
 G IN:$D(^RARPT(+RARPT,0))
"RTN","RARTE5",41,0)
 ;
"RTN","RARTE5",42,0)
 G:'RAPRTSET NEW G:$P(^RA(72,+RAST,0),"^",3)>0 NEW
"RTN","RARTE5",43,0)
 ; case is part of a print set, AND is cancelled
"RTN","RARTE5",44,0)
 N RA2 S (RA1,RA2)=""
"RTN","RARTE5",45,0)
 F  S RA1=$O(RAMEMARR(RA1)) Q:RA1=""  S:$P(RAMEMARR(RA1),"^",3)]"" RA2=$P(RAMEMARR(RA1),"^",3)
"RTN","RARTE5",46,0)
 G:RA2="" NEW
"RTN","RARTE5",47,0)
 W !!,$C(7),"Other cases of this cancelled case ",RACN,"'s print set are entered in a report already",!!,"You may NOT create a new report for this cancelled case,",!,"but you may include this cancelled case in the existing report."
"RTN","RARTE5",48,0)
 W !!,"Do you want to include this cancelled case in the same report",!,"as the others in the print set ?"
"RTN","RARTE5",49,0)
 S %=2 D YN^DICN
"RTN","RARTE5",50,0)
 W:%>0 "...",$S(%=1:"Include",1:"Skip")," this case"
"RTN","RARTE5",51,0)
 I %=1 S $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),"^",17)=RA2,RARPT=RA2,RARPTN=$P(^RARPT(RARPT,0),"^"),RA1=RACN D INSERT^RARTE2
"RTN","RARTE5",52,0)
 D UNLOCK^RAUTL12(RAPNODE,RACNI) D INCRPT G START
"RTN","RARTE5",53,0)
NEW G:'RAPRTSET NEW1
"RTN","RARTE5",54,0)
 L +^RADPT(RADFN,"DT",RADTI):DILOCKTM G:$T NEW1
"RTN","RARTE5",55,0)
 W !!?10,$C(7),"** This case belongs to a printset, and someone else is",?68,"**",!?10,"** editing another case from this printset, or entering",?68,"**"
"RTN","RARTE5",56,0)
 W !?10,"** a report for this printset, so you may not enter a",?68,"**",!?10,"** new report.",?68,"**"
"RTN","RARTE5",57,0)
 H 2 D UNLOCK^RAUTL12(RAPNODE,RACNI) D INCRPT G START
"RTN","RARTE5",58,0)
 ;
"RTN","RARTE5",59,0)
NEW1 S RARPTN=$E(RADTE,4,7)_$E(RADTE,2,3)_"-"_RACN
"RTN","RARTE5",60,0)
 W !?3,"...report not entered for this exam...",!?10,"...will now initialize report entry..."
"RTN","RARTE5",61,0)
 S I=+$P(^RARPT(0),"^",3)
"RTN","RARTE5",62,0)
 ;
"RTN","RARTE5",63,0)
LOCK ;Try to lock next avail IEN, if locked - fail, if used - increment again
"RTN","RARTE5",64,0)
 S I=I+1 S RAXIT=$$LOCK^RARTE6("^RARPT(",I) I RAXIT D UNLOCK2^RARTE4 D INCRPT G START
"RTN","RARTE5",65,0)
 ;don't check ^RARPT("B",RARPTN) due cloaked deleted reports
"RTN","RARTE5",66,0)
 I $D(^RARPT(I)) D UNLOCK^RAUTL12("^RARPT(",I) G LOCK
"RTN","RARTE5",67,0)
 S ^RARPT(I,0)=RARPTN,RARPT=I,^(0)=$P(^RARPT(0),"^",1,2)_"^"_I_"^"_($P(^(0),"^",4)+1),^DISV($S($D(DUZ)#2:DUZ,1:0),"^RARPT(")=I S:'$D(^RARPT(RARPT,"T")) ^("T")=""
"RTN","RARTE5",68,0)
 S ^RARPT(RARPT,0)=RARPTN_"^"_RADFN_"^"_RADTE_"^"_RACN_"^EF",DIK="^RARPT(",DA=RARPT D IX1^DIK
"RTN","RARTE5",69,0)
 K %,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RARTE5",70,0)
 S DA(2)=RADFN,DA(1)=RADTI,DA=RACNI
"RTN","RARTE5",71,0)
 S DIE="^RADPT("_RADFN_",""DT"","_RADTI_",""P"","
"RTN","RARTE5",72,0)
 S DR="17////"_RARPT D ^DIE
"RTN","RARTE5",73,0)
 K %,D,D0,DA,DI,DIC,DIE,DQ,DR,RAY1,X,Y
"RTN","RARTE5",74,0)
 ;if printset -- set pc 17 in subfile 70.03 and subrec in subfile 74.05
"RTN","RARTE5",75,0)
 I RAPRTSET D PTR^RARTE2
"RTN","RARTE5",76,0)
 I RAXIT D UNLOCK2^RARTE4,UNLOCK^RAUTL12("^RARPT(",RARPT) G Q1
"RTN","RARTE5",77,0)
 W !,RAI
"RTN","RARTE5",78,0)
 G IN0
"RTN","RARTE5",79,0)
IN ;edit existing rpt, so lock rpt fr the 1st time
"RTN","RARTE5",80,0)
 S RAXIT=$$LOCK^RARTE6("^RARPT(",RARPT) I RAXIT D UNLOCK2^RARTE4 G Q1
"RTN","RARTE5",81,0)
IN0 ;skip to here if rpt created in this session and already locked
"RTN","RARTE5",82,0)
 ; Flag first time EF report is made if piece 18 has no data  yet
"RTN","RARTE5",83,0)
 I $P(^RARPT(RARPT,0),U,18)="" S RAFIRST=1
"RTN","RARTE5",84,0)
 ; save DXs before edit
"RTN","RARTE5",85,0)
 S RANY1=$$ANYDX^RARTE7(.RAA1) ;1=has DXs, 0=no DXs, RAA1() stores DXs
"RTN","RARTE5",86,0)
 ; Ask if copy standard report
"RTN","RARTE5",87,0)
 I $P(RAMDV,"^",12) D STD^RARTE1 I X="^" S RAXIT=1 G UNCASE
"RTN","RARTE5",88,0)
 ;  Ask Report Date
"RTN","RARTE5",89,0)
 S DR="8",DA=RARPT,DIE="^RARPT(" D ^DIE K DE,DQ
"RTN","RARTE5",90,0)
 ; y is defined if user "^" out
"RTN","RARTE5",91,0)
 I $D(Y) K Y G UNCASE
"RTN","RARTE5",92,0)
 ;   Display Clinical History
"RTN","RARTE5",93,0)
 D CHPRINT^RAUTL9
"RTN","RARTE5",94,0)
 ; report status before editing
"RTN","RARTE5",95,0)
 S RACT=$P(^RARPT(RARPT,0),U,5)
"RTN","RARTE5",96,0)
 ; Edit Report Text and enter Diagnostic code(s)
"RTN","RARTE5",97,0)
 D ERPT
"RTN","RARTE5",98,0)
 ; Resident and Staff not asked and not copied to other cases of printset
"RTN","RARTE5",99,0)
 ; continue to check sufficient data even if RAXIT=1 at this point
"RTN","RARTE5",100,0)
UNCASE ; 
"RTN","RARTE5",101,0)
 D UNLOCK^RAUTL12(RAPNODE,RACNI) ;unlock case
"RTN","RARTE5",102,0)
 ; copy diags to other cases of printset
"RTN","RARTE5",103,0)
 ; and unlock case "DT" level after copying is done
"RTN","RARTE5",104,0)
 I RAPRTSET S RADRS=1,RAXIT=0 D COPY^RARTE2 L -^RADPT(RADFN,"DT",RADTI)
"RTN","RARTE5",105,0)
 ; first time EF rpt made -- del rpt & xrefs if no rpt txt & impression
"RTN","RARTE5",106,0)
 I RAFIRST S RAXIT=$$CCAN(RARPT)
"RTN","RARTE5",107,0)
 D UNLOCK^RAUTL12("^RARPT(",RARPT) ;unlock report
"RTN","RARTE5",108,0)
 G:RAXIT PRT
"RTN","RARTE5",109,0)
 ;
"RTN","RARTE5",110,0)
 ;  "EF" was stuffed in LOCK+5 for new rpts but not stub rpt yet
"RTN","RARTE5",111,0)
 I $P(^RARPT(RARPT,0),U,5)'="EF" D SETFF^RARTE6(74,5,RARPT,"EF")
"RTN","RARTE5",112,0)
 W !!?5,"Report status is stored as ""Electronically Filed""."
"RTN","RARTE5",113,0)
 ; Stuff in initial entry date only once
"RTN","RARTE5",114,0)
 I RAFIRST D SETFF^RARTE6(74,18,RARPT,"NOW","E")
"RTN","RARTE5",115,0)
 ;   Stuff in Activity Log subfile at all times
"RTN","RARTE5",116,0)
 D SETALOG^RARTE6("+1,"_RARPT_",","F","")
"RTN","RARTE5",117,0)
 ;
"RTN","RARTE5",118,0)
 ; transmit to women's health each time this point is reached
"RTN","RARTE5",119,0)
 ; COPY^WVRALINK will stop if the same case number is already in 790.1
"RTN","RARTE5",120,0)
 ;
"RTN","RARTE5",121,0)
 I $P(^RARPT(RARPT,0),U,5)="EF",$T(CREATE^WVRALINK)]"" D CREATE^WVRALINK(RADFN,RADTI,RACNI) ; women's health
"RTN","RARTE5",122,0)
 ;
"RTN","RARTE5",123,0)
PRT I RAXIT S RAXIT=0 D UNLOCK2^RARTE4 D INCRPT G START
"RTN","RARTE5",124,0)
 ;
"RTN","RARTE5",125,0)
 ; report status after editing
"RTN","RARTE5",126,0)
 S RACT=$P(^RARPT(RARPT,0),U,5)
"RTN","RARTE5",127,0)
 ; ---
"RTN","RARTE5",128,0)
 ; set RAHLTCPB to prevent broadcast ORM messages
"RTN","RARTE5",129,0)
 N RAHLTCPB S RAHLTCPB=1
"RTN","RARTE5",130,0)
 ;
"RTN","RARTE5",131,0)
 ; update case's exam status only if exam status isn't COMPLETE
"RTN","RARTE5",132,0)
 ; and isn't CANCEL
"RTN","RARTE5",133,0)
 ; and ((birads not required) or (birads required and entered))
"RTN","RARTE5",134,0)
 S RA2=$$GET1^DIQ(72,+$P(RA7003,U,3)_",",3)
"RTN","RARTE5",135,0)
 I RA2'=9,(RA2'=0) D
"RTN","RARTE5",136,0)
 .I 'RABIREQ D UP1^RAUTL1 Q
"RTN","RARTE5",137,0)
 .I RABIDAT D UP1^RAUTL1 Q
"RTN","RARTE5",138,0)
 .E  W !!?5,"Exam status not recalculated due to missing BI-RADS code."
"RTN","RARTE5",139,0)
 .Q
"RTN","RARTE5",140,0)
 S RANY2=$$ANYDX^RARTE7(.RAA2) ;RAA2() store DXs after edit
"RTN","RARTE5",141,0)
 ; check if new/changed diagnostic codes, send alert if nec.
"RTN","RARTE5",142,0)
 D ALERT^RARTE7
"RTN","RARTE5",143,0)
 K RAAB
"RTN","RARTE5",144,0)
 ; broadcast if EF rpt made first time, or any DX changed/added/del'd
"RTN","RARTE5",145,0)
 I $O(RAA2(0))!(RAFIRST) D
"RTN","RARTE5",146,0)
 .D HLXMSG ;find VR subscribers to exclude
"RTN","RARTE5",147,0)
 .D RPT^RAHLRPC
"RTN","RARTE5",148,0)
 .Q
"RTN","RARTE5",149,0)
PRT1 R !!,"Do you wish to print this report? No// ",X:DTIME S:'$T!(X["^") X="N" S:X="" X="N" ;030497
"RTN","RARTE5",150,0)
 I "Nn"[$E(X) D INCRPT G START
"RTN","RARTE5",151,0)
 I "Yy"'[$E(X) W:X'["?" $C(7) W !!?3,"Enter 'YES' to print this report, or 'NO' not to." G PRT1
"RTN","RARTE5",152,0)
 S ION=$P(RAMLC,"^",10),IOP=$S(ION]"":"Q;"_ION,1:"Q")
"RTN","RARTE5",153,0)
 S RAMES="W !!?3,""Report has been queued for printing on device "",ION,""."""
"RTN","RARTE5",154,0)
 D Q^RARTR D INCRPT G START ; queue rpt, cleanup, startover
"RTN","RARTE5",155,0)
 ;
"RTN","RARTE5",156,0)
Q1 K %,%DT,%W,%Y,%Y1,C,D0,D1,DA,DIC,DIE,DR,OREND,RABTCH,RABTCHN,RACN,RACNI,RACOPY,RACS,RACT,RADATE,RADFN,RADTE,RADTI,RADUZ,RAELESIG,RAFIN,RAHEAD,RAI,RAJ1
"RTN","RARTE5",157,0)
 K RALI,RALR,RANME,RANUM,RAOR,RAORDIFN,RAPNODE,RAPRC,RAPRIT,RAQUIT,RAREPORT,RARES,RARPDT,RARPT,RARPTN,RARPTZ,RARTPN,RASET,RASI,RASIG,RASN,RASSN,RAST,RAST1,RASTI,RASTFF,RAVW,XQUIT,W,X,Y
"RTN","RARTE5",158,0)
 K D,D2,DDER,DI,DIPGM,DLAYGO,J,RAEND,RAF5,RAFL,RAFST,RAIX,RAPOP,RAY1
"RTN","RARTE5",159,0)
 K ^TMP($J,"RAEX")
"RTN","RARTE5",160,0)
 K POP,DUOUT,RAFDA,RATEXT,RADIR0,RAXIT
"RTN","RARTE5",161,0)
 D INCRPT
"RTN","RARTE5",162,0)
 Q
"RTN","RARTE5",163,0)
INCRPT ; Kill extraneous variables to avoid collisions.
"RTN","RARTE5",164,0)
 ; Incomplete report information, select another case #.
"RTN","RARTE5",165,0)
 K DA,DIE,DR,RATXT
"RTN","RARTE5",166,0)
 K %,%DT,D,D0,D1,D2,DI,DIC,DIWT,DN,I,J,RAA1,RAA2
"RTN","RARTE5",167,0)
 K RABIENS,RABIDAT,RABIREQ,RACN,RACNI,RACT
"RTN","RARTE5",168,0)
 K RADATE,RADRS,RADTE,RADTI,RAFIN,RAFIRST,RAI,RALI,RALR,RANME,RAPRC,RARPT
"RTN","RARTE5",169,0)
 K RARPTN,RASSN,RAST,RAVW,RASSS,RASSSX,X
"RTN","RARTE5",170,0)
 Q
"RTN","RARTE5",171,0)
CCAN(IEN74) ;Check canned report for Outside Reporting
"RTN","RARTE5",172,0)
 ; adapted from EN3^RAUTL15
"RTN","RARTE5",173,0)
 ; outputs:  0 if report is kept
"RTN","RARTE5",174,0)
 ;           1 if report is deleted due to no canned text entered
"RTN","RARTE5",175,0)
 ;
"RTN","RARTE5",176,0)
 N RAPRG74,RATXT
"RTN","RARTE5",177,0)
 ; keep report if it is linked to images
"RTN","RARTE5",178,0)
 I $O(^RARPT(IEN74,2005,0))>0 Q 0
"RTN","RARTE5",179,0)
 ;
"RTN","RARTE5",180,0)
 ;del canned report if missing both REPORT TEXT and IMPRESSION TEXT
"RTN","RARTE5",181,0)
 I '$O(^RARPT(IEN74,"I",0)),'$O(^RARPT(IEN74,"R",0)) D  Q 1
"RTN","RARTE5",182,0)
 .; un-link rpt from other cases of printset
"RTN","RARTE5",183,0)
 .D DEL17^RARTE2(IEN74)
"RTN","RARTE5",184,0)
 .; exec field's xrefs' KILL logic
"RTN","RARTE5",185,0)
 .S DA(2)=RADFN,DA(1)=RADTI,DA=RACNI
"RTN","RARTE5",186,0)
 .D ENKILL^RAXREF(70.03,17,IEN74,.DA)
"RTN","RARTE5",187,0)
 .;
"RTN","RARTE5",188,0)
 .;del piece 17 from case record
"RTN","RARTE5",189,0)
 .S $P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),"^",17)="" K DA,X
"RTN","RARTE5",190,0)
 .;
"RTN","RARTE5",191,0)
 .; Del report ptr from batch and distribution files
"RTN","RARTE5",192,0)
 .D UPDTPNT^RAUTL9(IEN74)
"RTN","RARTE5",193,0)
 .;
"RTN","RARTE5",194,0)
 .; Del entry from Report file
"RTN","RARTE5",195,0)
 .S DA=IEN74,DIK="^RARPT(" D ^DIK
"RTN","RARTE5",196,0)
 .S RATXT(1)=" "
"RTN","RARTE5",197,0)
 .S RATXT(2)="   Outside canned report not complete.  Must Delete......deletion complete!"
"RTN","RARTE5",198,0)
 .S RATXT(3)=$C(7) D MES^XPDUTL(.RATXT)
"RTN","RARTE5",199,0)
 .; also delete any diagnostic codes from case record
"RTN","RARTE5",200,0)
 .I RAPRTSET D DELDXPRT ;del DXs from printset cases
"RTN","RARTE5",201,0)
 .I 'RAPRTSET D DELDX ;del DXs from standalone case
"RTN","RARTE5",202,0)
 .Q
"RTN","RARTE5",203,0)
 Q 0
"RTN","RARTE5",204,0)
ERPT ; Edit report text, impression, and enter/edit diagnostic codes
"RTN","RARTE5",205,0)
 ;remove lock case commands here since case is still locked
"RTN","RARTE5",206,0)
 S $P(RATXT,"+",52)=""
"RTN","RARTE5",207,0)
 W !!?5,RATXT,!?8,"Required:  REPORT TEXT and/or IMPRESSION TEXT",!?5,RATXT
"RTN","RARTE5",208,0)
 S RAXIT=0 ; here, =1 means user "^" out
"RTN","RARTE5",209,0)
 S DA=RARPT,DIE="^RARPT("
"RTN","RARTE5",210,0)
 S DR="200;I X=""^"" S Y=""@8"";300;I X'=""^"" S Y=""@9"";@8;S RAXIT=1;@9"
"RTN","RARTE5",211,0)
 D ^DIE
"RTN","RARTE5",212,0)
 ; subseq edit -- Report Text and Impression Text cannot both be empty
"RTN","RARTE5",213,0)
 I 'RAFIRST,'$O(^RARPT(RARPT,"I",0)),'$O(^RARPT(RARPT,"R",0)) G ERPT
"RTN","RARTE5",214,0)
 ; dont quit on "^" if mammography study
"RTN","RARTE5",215,0)
 D CKREQ^RABIRAD ;check if BIRADS diag is required
"RTN","RARTE5",216,0)
 I RAXIT=1,'RABIREQ Q
"RTN","RARTE5",217,0)
DIAG ; Diagnostic codes
"RTN","RARTE5",218,0)
 ; (code taken from routine RARTE1)
"RTN","RARTE5",219,0)
 S RAIMGTYI=$P($G(^RADPT(RADFN,"DT",RADTI,0)),U,2),RAIMGTYJ=$P($G(^RA(79.2,+RAIMGTYI,0)),U)
"RTN","RARTE5",220,0)
 S X=+$O(^RA(72,"AA",RAIMGTYJ,9,0)),DA(2)=RADFN,DA(1)=RADTI,DA=RACNI,DIE="^RADPT("_DA(2)_",""DT"","_DA(1)_",""P""," K RAIMGTYI,RAIMGTYJ
"RTN","RARTE5",221,0)
 ; ask Prim. Diag, required if site require diag, don't ck abnormal here
"RTN","RARTE5",222,0)
 S DR=13_$S('$D(^RA(72,X,.1)):"",$P(^(.1),"^",5)'="Y":"",1:"R")
"RTN","RARTE5",223,0)
 ; allow user to "^" exit
"RTN","RARTE5",224,0)
 D ^DIE K DA,DE,DQ,DIE,DR
"RTN","RARTE5",225,0)
 I ($P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)="")!($D(Y)) S RAXIT=0 G PACS
"RTN","RARTE5",226,0)
 S DR="50///"_RACN
"RTN","RARTE5",227,0)
 S DR(2,70.03)=13.1
"RTN","RARTE5",228,0)
 S DR(3,70.14)=.01 ; don't ck abnormal here
"RTN","RARTE5",229,0)
 S DA(1)=RADFN,DA=RADTI,DIE="^RADPT("_DA(1)_",""DT"","
"RTN","RARTE5",230,0)
 D ^DIE K DA,DE,DQ,DIE,DR
"RTN","RARTE5",231,0)
 I $D(Y) K Y S RAXIT=1 ;$D(Y) means user "^" out
"RTN","RARTE5",232,0)
PACS ; do not broadcast ORU message at this point
"RTN","RARTE5",233,0)
 ;
"RTN","RARTE5",234,0)
 ; if BIRADS required, ck if BIRADS entered, if not, go back to ask diag
"RTN","RARTE5",235,0)
 I RABIREQ D CKDATA^RABIRAD I 'RABIDAT I $$ASK^RABIRAD G DIAG
"RTN","RARTE5",236,0)
 ; move WV outside of this in case rpt is deleted due insufficient data
"RTN","RARTE5",237,0)
 Q
"RTN","RARTE5",238,0)
 ;
"RTN","RARTE5",239,0)
HLXMSG ; set up RASSSX() of VR subscribers to exclude from ORM msg broadcast
"RTN","RARTE5",240,0)
 N RA,XX
"RTN","RARTE5",241,0)
 ; q if there are no HL applications that use the 4 RA HL7 protocols
"RTN","RARTE5",242,0)
 Q:'$$GETAP^RAHLRS1(.XX)
"RTN","RARTE5",243,0)
 S RA=$NA(XX)
"RTN","RARTE5",244,0)
 F  S RA=$Q(@RA) Q:RA=""  I RA'["RA-TALK",(RA'["RA-PSCRIBE"),(RA'["RA-SCIMAGE"),(RA'["RA-RADWHERE") S RASSS(@RA)=""
"RTN","RARTE5",245,0)
 ; RASSS(ien #771)
"RTN","RARTE5",246,0)
 ; RASSSX(ien #101 driver, ien #101 subscriber)=".01 value of driver"
"RTN","RARTE5",247,0)
 D:$D(RASSS)>1 GETSUB^RAHLRS1(.RASSS,.RASSSX)
"RTN","RARTE5",248,0)
 Q
"RTN","RARTE5",249,0)
DELDX ; del any Prim. and Sec. DXs from standalone case
"RTN","RARTE5",250,0)
 S RAFDA(70.03,RACNI_","_RADTI_","_RADFN_",",13)="@" ;Prim DX
"RTN","RARTE5",251,0)
 D FILE^DIE("","RAFDA")
"RTN","RARTE5",252,0)
 K RAFDA
"RTN","RARTE5",253,0)
 D KILSEC^RARTE7(70.14,RACNI)
"RTN","RARTE5",254,0)
 Q
"RTN","RARTE5",255,0)
DELDXPRT ;del any Prim. and Sec. DXs from all cases in printset
"RTN","RARTE5",256,0)
 S RA1=0
"RTN","RARTE5",257,0)
 F  S RA1=$O(RAMEMARR(RA1)) Q:RA1=""  D
"RTN","RARTE5",258,0)
 .S RAFDA(70.03,RA1_","_RADTI_","_RADFN_",",13)="@" ;Prim DX
"RTN","RARTE5",259,0)
 .D FILE^DIE("","RAFDA")
"RTN","RARTE5",260,0)
 .K RAFDA
"RTN","RARTE5",261,0)
 .D KILSEC^RARTE7(70.14,RA1)
"RTN","RARTE5",262,0)
 .Q
"RTN","RARTE5",263,0)
 Q
"RTN","RARTE5",264,0)
INTRO ;
"RTN","RARTE5",265,0)
 ;;+--------------------------------------------------------+
"RTN","RARTE5",266,0)
 ;;|                                                        |
"RTN","RARTE5",267,0)
 ;;|  This option is for entering canned text for           |
"RTN","RARTE5",268,0)
 ;;|  outside work:  interpreted report done outside,       |
"RTN","RARTE5",269,0)
 ;;|  and images made outside this facility.                |
"RTN","RARTE5",270,0)
 ;;|                                                        |
"RTN","RARTE5",271,0)
 ;;|  For a printset, the canned text must apply to all     |
"RTN","RARTE5",272,0)
 ;;|  cases within the printset.                            |
"RTN","RARTE5",273,0)
 ;;|                                                        |
"RTN","RARTE5",274,0)
 ;;+--------------------------------------------------------+
"RTN","RARTE7")
0^14^B23848565
"RTN","RARTE7",1,0)
RARTE7 ;HISC/SM continuation - Delete a Report, Outside Rpt misc;10/10/08 16:05
"RTN","RARTE7",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**56,95,97**;Mar 16, 1998;Build 6
"RTN","RARTE7",3,0)
 ;Supported IA #2053 NOW^XLFDT, FILE^DIE, UPDATE^DIE
"RTN","RARTE7",4,0)
 ;Supported IA #2052 GET1^DID
"RTN","RARTE7",5,0)
 ;Supported IA #2055 ROOT^DILFD
"RTN","RARTE7",6,0)
 Q
"RTN","RARTE7",7,0)
MARKDEL ; set field 5 to "X" to mark rpt as deleted
"RTN","RARTE7",8,0)
 ; also update activity log, send report deletion bulletin, store then delete
"RTN","RARTE7",9,0)
 ; associated DX, Staff, Resident data
"RTN","RARTE7",10,0)
 N DA,DIK,RA1,RA2,RAA,RAFDA,RAIEN2,RAIENDX,RAIENL,RACLOAK
"RTN","RARTE7",11,0)
 N RAMEMARR,RAMSG,RAOUT,RAPRTSET,RASAVE,RAX,RA7003
"RTN","RARTE7",12,0)
 N RAF1,RAF2,RAF3,RAIENS
"RTN","RARTE7",13,0)
 ;
"RTN","RARTE7",14,0)
 ;PART 1 - mark report as deleted
"RTN","RARTE7",15,0)
 ;
"RTN","RARTE7",16,0)
 S RASAVE=$P(^RARPT(RAIEN,0),U,5) ;save current rpt status
"RTN","RARTE7",17,0)
 S RAFDA(74,RAIEN_",",5)="X" ;change rpt status
"RTN","RARTE7",18,0)
 D FILE^DIE("","RAFDA")
"RTN","RARTE7",19,0)
 K RAFDA
"RTN","RARTE7",20,0)
 ;
"RTN","RARTE7",21,0)
 ;PART 2 - add new entry to ACTIVITY LOG and store primary data
"RTN","RARTE7",22,0)
 ;
"RTN","RARTE7",23,0)
 S RA7003=^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)
"RTN","RARTE7",24,0)
 S RAIENL="+1,"_RAIEN_","
"RTN","RARTE7",25,0)
 S RAFDA(74.01,RAIENL,.01)=+$E($$NOW^XLFDT(),1,12)
"RTN","RARTE7",26,0)
 S RAFDA(74.01,RAIENL,2)="X"
"RTN","RARTE7",27,0)
 S RAFDA(74.01,RAIENL,3)=$G(DUZ)
"RTN","RARTE7",28,0)
 S RAFDA(74.01,RAIENL,4)=RASAVE ;store before-delete rpt status
"RTN","RARTE7",29,0)
 S RAFDA(74.01,RAIENL,5)=$P(RA7003,U,13) ; store Prim DX code
"RTN","RARTE7",30,0)
 S RAFDA(74.01,RAIENL,7)=$P(RA7003,U,15) ; store Prim Staff
"RTN","RARTE7",31,0)
 S RAFDA(74.01,RAIENL,9)=$P(RA7003,U,12) ; store Prim Resident
"RTN","RARTE7",32,0)
 D UPDATE^DIE(,"RAFDA","RAOUT","RAMSG")
"RTN","RARTE7",33,0)
 W:$D(RAMSG("DIERR")) !!,"Could not update deleted Report's Activity Log."
"RTN","RARTE7",34,0)
 K RAFDA
"RTN","RARTE7",35,0)
 ;
"RTN","RARTE7",36,0)
 ; store Secondary DXs/Staff/Residents under this ACTIVITY LOG
"RTN","RARTE7",37,0)
 ; if printset, no need to store each case's sec DX, they should be same
"RTN","RARTE7",38,0)
 Q:'RAOUT(1)  ;no record set in 74.01
"RTN","RARTE7",39,0)
 S RAIEN2=RAOUT(1)
"RTN","RARTE7",40,0)
 ;
"RTN","RARTE7",41,0)
 ;PART 3 - send report deletion bulletin
"RTN","RARTE7",42,0)
 ;
"RTN","RARTE7",43,0)
 D CLOAK^RABUL3 ; requires RAIEN and RAIEN2
"RTN","RARTE7",44,0)
 ;
"RTN","RARTE7",45,0)
 ;PART 4 - store secondary DX, Staff, Resident data
"RTN","RARTE7",46,0)
 ;
"RTN","RARTE7",47,0)
 ;don't need separate logic for printset for storing identical data
"RTN","RARTE7",48,0)
 F RAFLD=5,7,9 D SET7401(RAFLD)
"RTN","RARTE7",49,0)
 ;
"RTN","RARTE7",50,0)
 ;PART 5 - remove Prim. and Sec.  DX, Staff, Resident from case record
"RTN","RARTE7",51,0)
 ;
"RTN","RARTE7",52,0)
 D EN2^RAUTL20(.RAMEMARR) ; is case part of a printset?
"RTN","RARTE7",53,0)
 G:RAPRTSET PSET
"RTN","RARTE7",54,0)
 ;
"RTN","RARTE7",55,0)
 ; single case
"RTN","RARTE7",56,0)
 ;
"RTN","RARTE7",57,0)
 ; delete primaries
"RTN","RARTE7",58,0)
 S RAFDA(70.03,RACNI_","_RADTI_","_RADFN_",",13)="@" ;Prim. DX
"RTN","RARTE7",59,0)
 S RAFDA(70.03,RACNI_","_RADTI_","_RADFN_",",15)="@" ;Prim. Staff
"RTN","RARTE7",60,0)
 S RAFDA(70.03,RACNI_","_RADTI_","_RADFN_",",12)="@" ;Prim. Resident
"RTN","RARTE7",61,0)
 D FILE^DIE("","RAFDA")
"RTN","RARTE7",62,0)
 K RAFDA
"RTN","RARTE7",63,0)
 ;
"RTN","RARTE7",64,0)
 ; delete secondaries
"RTN","RARTE7",65,0)
 F RASUB=70.14,70.11,70.09 D KILSEC(RASUB,RACNI)
"RTN","RARTE7",66,0)
 Q
"RTN","RARTE7",67,0)
 ;
"RTN","RARTE7",68,0)
 ; cases from printset
"RTN","RARTE7",69,0)
 ;
"RTN","RARTE7",70,0)
PSET ;delete primary and secondary data
"RTN","RARTE7",71,0)
 S RA1=0
"RTN","RARTE7",72,0)
 F  S RA1=$O(RAMEMARR(RA1)) Q:RA1=""  D
"RTN","RARTE7",73,0)
 .; delete primary from 70.03
"RTN","RARTE7",74,0)
 .S RAFDA(70.03,RA1_","_RADTI_","_RADFN_",",13)="@" ;Prim. DX
"RTN","RARTE7",75,0)
 .S RAFDA(70.03,RA1_","_RADTI_","_RADFN_",",15)="@" ;Prim. Staff
"RTN","RARTE7",76,0)
 .S RAFDA(70.03,RA1_","_RADTI_","_RADFN_",",12)="@" ;Prim. Resident
"RTN","RARTE7",77,0)
 .D FILE^DIE("","RAFDA")
"RTN","RARTE7",78,0)
 .K RAFDA
"RTN","RARTE7",79,0)
 .F RASUB=70.14,70.11,70.09 D KILSEC(RASUB,RA1)
"RTN","RARTE7",80,0)
 Q
"RTN","RARTE7",81,0)
KILSEC(RAF2,RAC1) ;kill secondary data
"RTN","RARTE7",82,0)
 ;RAF2 subfile number from file 70's secondaries
"RTN","RARTE7",83,0)
 ;RAC1 ien for subfile 70.03
"RTN","RARTE7",84,0)
 N RAA,RAROOT
"RTN","RARTE7",85,0)
 K DA,DIK
"RTN","RARTE7",86,0)
 S RAIENS=1_","_RAC1_","_RADTI_","_RADFN_","
"RTN","RARTE7",87,0)
 S RAROOT=$$ROOT^DILFD(RAF2,RAIENS,1) ; closed root
"RTN","RARTE7",88,0)
 M RAA=@RAROOT
"RTN","RARTE7",89,0)
 Q:$O(RAA(0))'>0  ;no secondaries
"RTN","RARTE7",90,0)
 D DA^DILF(RAIENS,.DA) ;get the DA array
"RTN","RARTE7",91,0)
 S DIK=$$ROOT^DILFD(RAF2,RAIENS)
"RTN","RARTE7",92,0)
 S RA2=0
"RTN","RARTE7",93,0)
 F  S RA2=$O(RAA(RA2)) Q:'RA2  S DA=RA2 D ^DIK
"RTN","RARTE7",94,0)
 K DIK
"RTN","RARTE7",95,0)
 Q
"RTN","RARTE7",96,0)
SET7401(X) ; use this for DX, Staff, Resident secondaries 
"RTN","RARTE7",97,0)
 ; set activity log's subfiles to store any secondaries
"RTN","RARTE7",98,0)
 K RAFDA,RAMSG,RAA
"RTN","RARTE7",99,0)
 ; X is the Field number from subfile 74.01:
"RTN","RARTE7",100,0)
 ; 5 = BEFORE DELETION PRIM. DX CODE
"RTN","RARTE7",101,0)
 ; 7 = BEFORE DELETION PRIM. STAFF
"RTN","RARTE7",102,0)
 ; 9 = BEFORE DELETION PRIM. RESIDENT
"RTN","RARTE7",103,0)
 ;
"RTN","RARTE7",104,0)
 ; RAF1 = subfile number from file 74's activity log
"RTN","RARTE7",105,0)
 ; RAF2 = subfile number from file 70's secondaries
"RTN","RARTE7",106,0)
 ; RAF3 = subfile number pointed to from file 70's secondaries
"RTN","RARTE7",107,0)
 ;
"RTN","RARTE7",108,0)
 S RAF1=$S(X=5:74.16,X=7:74.18,X=9:74.19,1:"") Q:RAF1=""
"RTN","RARTE7",109,0)
 S RAF2=$S(X=5:70.14,X=7:70.11,X=9:70.09,1:"") Q:RAF2=""
"RTN","RARTE7",110,0)
 S RAIENS=1_","_RACNI_","_RADTI_","_RADFN_","
"RTN","RARTE7",111,0)
 S RAROOT=$$ROOT^DILFD(RAF2,RAIENS,1) ; closed root, file 70's secondaries
"RTN","RARTE7",112,0)
 M RAA=@RAROOT
"RTN","RARTE7",113,0)
 Q:$O(RAA(0))'>0  ; no secondaries
"RTN","RARTE7",114,0)
 ;
"RTN","RARTE7",115,0)
 S RAF3=$$GET1^DID(RAF2,.01,"","POINTER")
"RTN","RARTE7",116,0)
 ; extract file number from RAF3
"RTN","RARTE7",117,0)
 S RAF3=$TR(RAF3,$TR(RAF3,"0123456789."))
"RTN","RARTE7",118,0)
 ;
"RTN","RARTE7",119,0)
 ; store Secondary DXs
"RTN","RARTE7",120,0)
 S RA1=0
"RTN","RARTE7",121,0)
 S RAIENDX="+2,"_RAIEN2_","_RAIEN_","
"RTN","RARTE7",122,0)
 F  S RA1=$O(RAA(RA1)) Q:'RA1  S RAX=$G(RAA(RA1,0)) D:RAX
"RTN","RARTE7",123,0)
 .S RAFDA(RAF1,RAIENDX,.01)=RAX
"RTN","RARTE7",124,0)
 .D UPDATE^DIE(,"RAFDA",,"RAMSG")
"RTN","RARTE7",125,0)
 .W:$D(RAMSG("DIERR")) !!,"Could not store ",$$GET1^DID(RAF2,.01,"","LABEL"),"'s value: ",$$GET1^DIQ(RAF3,RAX,.01)
"RTN","RARTE7",126,0)
 .K RAFDA,RAMSG
"RTN","RARTE7",127,0)
 .Q
"RTN","RARTE7",128,0)
 Q
"RTN","RARTE7",129,0)
ANYDX(ARRAY) ; called from RARTE5
"RTN","RARTE7",130,0)
 ; input ARRAY name to store all DXs for this case
"RTN","RARTE7",131,0)
 ; output:
"RTN","RARTE7",132,0)
 ;  =1 if one or more diag codes
"RTN","RARTE7",133,0)
 ;  =0 if no diag code
"RTN","RARTE7",134,0)
 ;  ARRAY() stores diag codes as merged from case
"RTN","RARTE7",135,0)
 Q:'$D(RADFN)!('$D(RADTI))!('$D(RACNI))
"RTN","RARTE7",136,0)
 K ARRAY
"RTN","RARTE7",137,0)
 M ARRAY=^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX") ;Sec Diags
"RTN","RARTE7",138,0)
 S ARRAY(9999,0)=$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13) ;Prim Diag
"RTN","RARTE7",139,0)
 I $O(ARRAY(0)) Q 1
"RTN","RARTE7",140,0)
 Q 0
"RTN","RARTE7",141,0)
 ;
"RTN","RARTE7",142,0)
ALERT ; for Outside Report, ck if new/changed diags require alert
"RTN","RARTE7",143,0)
 ; this is called from RARTE5 each time an outside report is edited
"RTN","RARTE7",144,0)
 Q:'$D(RADFN)!('$D(RADTI))!('$D(RACNI))
"RTN","RARTE7",145,0)
 N RASAVE,RAY3,X
"RTN","RARTE7",146,0)
 ; set RASAVE() for OENOTE^RAUTL00
"RTN","RARTE7",147,0)
 S RASAVE("RADFN")=RADFN,RASAVE("RADTI")=RADTI,RASAVE("RACNI")=RACNI
"RTN","RARTE7",148,0)
 ;
"RTN","RARTE7",149,0)
 N I
"RTN","RARTE7",150,0)
 Q:(RANY1=0)&(RANY2=0)  ;no diags before and after edit
"RTN","RARTE7",151,0)
 S I=0
"RTN","RARTE7",152,0)
 ; loop RAA2 
"RTN","RARTE7",153,0)
 F  S I=$O(RAA2(I)) Q:'I  K:RAA2(I,0)=$G(RAA1(I,0)) RAA2(I,0)
"RTN","RARTE7",154,0)
 Q:'$O(RAA2(0))
"RTN","RARTE7",155,0)
 K RAAB
"RTN","RARTE7",156,0)
 S I=0 F  S I=$O(RAA2(I)) Q:'I  D
"RTN","RARTE7",157,0)
 .I $D(^RA(78.3,+RAA2(I,0),0)),($P(^(0),U,4)="y") S RAAB=1
"RTN","RARTE7",158,0)
 .Q
"RTN","RARTE7",159,0)
 ; invoke notification for either condition:
"RTN","RARTE7",160,0)
 ; (1) new EF report is made --> non-critical imaging alert
"RTN","RARTE7",161,0)
 ; (2) old/new EF report w abnormal DX --> abnormal alert
"RTN","RARTE7",162,0)
 ; either of the above alert may be from an amended report or not
"RTN","RARTE7",163,0)
 I $G(RAAB)!RAFIRST D
"RTN","RARTE7",164,0)
 .S RAY3=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0))
"RTN","RARTE7",165,0)
 .S X=RAY3 ; X is input to OENOTE
"RTN","RARTE7",166,0)
 .D OENOTE^RAUTL00
"RTN","RARTE7",167,0)
 Q
"RTN","RARTR1")
0^11^B53930536
"RTN","RARTR1",1,0)
RARTR1 ;HISC/FPT,GJC-Queue/print Radiology Reports (cont.) ;1/8/97  08:08
"RTN","RARTR1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**8,18,56,97**;Mar 16, 1998;Build 6
"RTN","RARTR1",3,0)
 ;Supported IA #1571 ^LEX(757.01
"RTN","RARTR1",4,0)
 ;Supported IA #10104 REPEAT^XLFSTR
"RTN","RARTR1",5,0)
 ;Supported IA #10060 and #2056 $$GET1^DIQ for file 200
"RTN","RARTR1",6,0)
 ;last modification by SS for P18 JUNE 29,00
"RTN","RARTR1",7,0)
PRTDX ; print dx codes on report
"RTN","RARTR1",8,0)
 N RATMP,RATMP1
"RTN","RARTR1",9,0)
 I '$D(RAUTOE) D HANG^RARTR2:($Y+RAFOOT+4)>IOSL Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",10,0)
 S RADXCODE=$P(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0),U,13)
"RTN","RARTR1",11,0)
 I '$D(RAUTOE) D
"RTN","RARTR1",12,0)
 . W !?RATAB,"Primary Diagnostic Code: ",!?RATAB+4
"RTN","RARTR1",13,0)
 . W $S($D(^RA(78.3,+RADXCODE,0)):$P(^(0),U,1),1:"")
"RTN","RARTR1",14,0)
 . S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RARTR1",15,0)
 . W:RATMP]"" " (",RATMP,")"
"RTN","RARTR1",16,0)
 . Q
"RTN","RARTR1",17,0)
 I $D(RAUTOE) D
"RTN","RARTR1",18,0)
 . S RATMP1="    Primary Diagnostic Code: "
"RTN","RARTR1",19,0)
 . S RATMP1=RATMP1_$S($D(^RA(78.3,+RADXCODE,0)):$P(^(0),U,1),1:"")
"RTN","RARTR1",20,0)
 . S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RARTR1",21,0)
 . I RATMP]"" S RATMP1=RATMP1_" ("_RATMP_")"
"RTN","RARTR1",22,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=RATMP1
"RTN","RARTR1",23,0)
 . Q
"RTN","RARTR1",24,0)
 I '$D(RAUTOE) D HANG^RARTR2:($Y+RAFOOT+4)>IOSL Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",25,0)
 I '$D(RAUTOE),('$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0))) W ! Q
"RTN","RARTR1",26,0)
 I '$D(RAUTOE),($O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0))) D  Q
"RTN","RARTR1",27,0)
 . W !!?RATAB,"Secondary Diagnostic Codes: "
"RTN","RARTR1",28,0)
 . S RADXCODE=0
"RTN","RARTR1",29,0)
 . F  S RADXCODE=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX","B",RADXCODE)) Q:RADXCODE'>0!('$D(^RA(78.3,+RADXCODE,0)))!($D(RAOOUT))  D
"RTN","RARTR1",30,0)
 .. D HANG^RARTR2:($Y+RAFOOT+4)>IOSL Q:$D(RAOOUT)
"RTN","RARTR1",31,0)
 .. D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",32,0)
 .. W !?RATAB+4,$P(^RA(78.3,RADXCODE,0),U,1)
"RTN","RARTR1",33,0)
 .. S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RARTR1",34,0)
 .. W:RATMP]"" " (",RATMP,")"
"RTN","RARTR1",35,0)
 .. Q
"RTN","RARTR1",36,0)
 . K RADXCODE W !
"RTN","RARTR1",37,0)
 . Q
"RTN","RARTR1",38,0)
 I $D(RAUTOE),('$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0))) D  Q
"RTN","RARTR1",39,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR1",40,0)
 . Q
"RTN","RARTR1",41,0)
 I $D(RAUTOE),($O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX",0))) D
"RTN","RARTR1",42,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="    Secondary Diagnostic Codes: "
"RTN","RARTR1",43,0)
 . S RADXCODE=0
"RTN","RARTR1",44,0)
 . F  S RADXCODE=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"DX","B",RADXCODE)) Q:RADXCODE'>0  D
"RTN","RARTR1",45,0)
 .. Q:'$D(^RA(78.3,+$G(RADXCODE),0))#2
"RTN","RARTR1",46,0)
 .. S RATMP=$$GET1^DIQ(757.01,$P($G(^RA(78.3,+RADXCODE,0)),U,6),.01)
"RTN","RARTR1",47,0)
 .. S RATMP1="      "_$P(^RA(78.3,+$G(RADXCODE),0),U)
"RTN","RARTR1",48,0)
 .. S RATMP1=RATMP1_$S(RATMP="":"",1:" ("_RATMP_")")
"RTN","RARTR1",49,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=RATMP1
"RTN","RARTR1",50,0)
 .. Q
"RTN","RARTR1",51,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR1",52,0)
 . Q
"RTN","RARTR1",53,0)
 Q
"RTN","RARTR1",54,0)
WARNING ; this printed report should not be used for charting
"RTN","RARTR1",55,0)
 S RARPTSTT=$$RSTAT^RAO7PC1A()
"RTN","RARTR1",56,0)
 S:RARPTSTT="NO REPORT" RARPTSTT="REPORT STATUS UNKNOWN"
"RTN","RARTR1",57,0)
 S:RAST="R" RARPTSTT="("_RARPTSTT_")"
"RTN","RARTR1",58,0)
 S RAPOSITN=(80-$L(RARPTSTT)\2)
"RTN","RARTR1",59,0)
 I '$D(RAUTOE) D  ;P18 modif
"RTN","RARTR1",60,0)
 . W !?RAPOSITN-1,$$REPEAT^XLFSTR("*",$L(RARPTSTT)+2)
"RTN","RARTR1",61,0)
 . W:RAST="R" !?(80-$L(RARPTSTT)\2)-1,"*  PRELIMINARY REPORT   *" ;P18
"RTN","RARTR1",62,0)
 . W !?(80-$L(RARPTSTT)\2)-1,"*"_RARPTSTT_"*",!?RAPOSITN-1,$$REPEAT^XLFSTR("*",$L(RARPTSTT)+2)
"RTN","RARTR1",63,0)
 . Q
"RTN","RARTR1",64,0)
 I $D(RAUTOE) D
"RTN","RARTR1",65,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=$$REPEAT^XLFSTR("*",$L(RARPTSTT)+2)
"RTN","RARTR1",66,0)
 . I RAST="R" S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="*  PRELIMINARY REPORT   *" ;P18
"RTN","RARTR1",67,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="*"_RARPTSTT_"*" ;P18
"RTN","RARTR1",68,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=$$REPEAT^XLFSTR("*",$L(RARPTSTT)+2)
"RTN","RARTR1",69,0)
 . S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))=""
"RTN","RARTR1",70,0)
 . Q
"RTN","RARTR1",71,0)
 K RAPOSITN,RARPTSTT
"RTN","RARTR1",72,0)
 Q
"RTN","RARTR1",73,0)
SECRES ; Print from the secondary resident multiple
"RTN","RARTR1",74,0)
 Q:'$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SRR",0))  ; no data, quit
"RTN","RARTR1",75,0)
 N RASR,RASRSBN,RASRSBT,DIERR,RAZ
"RTN","RARTR1",76,0)
 I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",77,0)
 W:'$D(RAUTOE) !,"Secondary Interpreting Resident:"
"RTN","RARTR1",78,0)
 S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="Secondary Interpreting Resident:"
"RTN","RARTR1",79,0)
 S RASR=0
"RTN","RARTR1",80,0)
 F  S RASR=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SRR",RASR)) Q:RASR'>0  D
"RTN","RARTR1",81,0)
 . S RASR(0)=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SRR",RASR,0))
"RTN","RARTR1",82,0)
 . S RAZ=$$GET1^DIQ(200,+RASR(0)_",",.01)
"RTN","RARTR1",83,0)
 . Q:RAZ=""
"RTN","RARTR1",84,0)
 . S RASRSBN=$E($$GET1^DIQ(200,+RASR(0)_",",20.2),1,25)
"RTN","RARTR1",85,0)
 . S:RASRSBN']"" RASRSBN=$E(RAZ,1,25)
"RTN","RARTR1",86,0)
 . S RASRSBT=$$GET1^DIQ(200,+RASR(0)_",",20.3) ; max:; 50 chars
"RTN","RARTR1",87,0)
 . I RASRSBT']"" S RASRSBT=$$TITLE^RARTR0(+RASR(0))
"RTN","RARTR1",88,0)
 . I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",89,0)
 . W:'$D(RAUTOE) !?2,$S(RASRSBN]"":RASRSBN,1:"Unknown"),", ",$E(RASRSBT,1,((IOM-$X)-16))
"RTN","RARTR1",90,0)
 . ; The '-16' above is derived from $L("(Pre-Verifier)")+1 FORMATTING
"RTN","RARTR1",91,0)
 . I $D(RAUTOE) D
"RTN","RARTR1",92,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="  "_$S(RASRSBN]"":RASRSBN,1:"Unknown")
"RTN","RARTR1",93,0)
 .. N RALEN S RALEN=$L(^TMP($J,"RA AUTOE",RAACNT))
"RTN","RARTR1",94,0)
 .. S ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_", "_$E(RASRSBT,1,((80-RALEN)-16))
"RTN","RARTR1",95,0)
 .. Q
"RTN","RARTR1",96,0)
 . I '$D(RAVERFND),(RAVERF=+RASR(0)) D
"RTN","RARTR1",97,0)
 .. S RAVERFND=""
"RTN","RARTR1",98,0)
 .. I $G(RARPT(10))']"",('$D(RAUTOE)) D  Q
"RTN","RARTR1",99,0)
 ... W:RAWHOVER=+RASR(0) !?10,"(Verifier, no e-sig)"
"RTN","RARTR1",100,0)
 ... W:RAWHOVER'=+RASR(0) !?10,"Verified by transcriptionist for "_RASRSBN  ;Removed RA*5*8 _", M.D."
"RTN","RARTR1",101,0)
 ... Q
"RTN","RARTR1",102,0)
 .. I $G(RARPT(10))']"",($D(RAUTOE)) D  Q
"RTN","RARTR1",103,0)
 ... S:RAWHOVER=+RASR(0) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="          (Verifier, no e-sig)"
"RTN","RARTR1",104,0)
 ... S:RAWHOVER'=+RASR(0) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="          Verified by transcriptionist for "_RASRSBN  ;Removed RA*5*8 _", M.D."
"RTN","RARTR1",105,0)
 ... Q
"RTN","RARTR1",106,0)
 .. W:'$D(RAUTOE) " (Verifier)"
"RTN","RARTR1",107,0)
 .. S:$D(RAUTOE) ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_" (Verifier)"
"RTN","RARTR1",108,0)
 .. Q
"RTN","RARTR1",109,0)
 . I RAPVERF=+RASR(0) W:'$D(RAUTOE) " (Pre-Verifier)" S:$D(RAUTOE) ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_" (Pre-Verifier)"
"RTN","RARTR1",110,0)
 . Q
"RTN","RARTR1",111,0)
 Q
"RTN","RARTR1",112,0)
SECSTF ; Print from the secondary staff multiple
"RTN","RARTR1",113,0)
 Q:'$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SSR",0))  ; no data, quit
"RTN","RARTR1",114,0)
 N RASS,RASSSBN,RASSSBT,DIERR,RAZ
"RTN","RARTR1",115,0)
 I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",116,0)
 W:'$D(RAUTOE) !,"Secondary Interpreting Staff:"
"RTN","RARTR1",117,0)
 S:$D(RAUTOE) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="Secondary Interpreting Staff:"
"RTN","RARTR1",118,0)
 S RASS=0
"RTN","RARTR1",119,0)
 F  S RASS=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SSR",RASS)) Q:RASS'>0  D
"RTN","RARTR1",120,0)
 . S RASS(0)=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"SSR",RASS,0))
"RTN","RARTR1",121,0)
 . S RAZ=$$GET1^DIQ(200,+RASS(0)_",",.01)
"RTN","RARTR1",122,0)
 . Q:RAZ=""
"RTN","RARTR1",123,0)
 . S RASSSBN=$E($$GET1^DIQ(200,+RASS(0)_",",20.2),1,25)
"RTN","RARTR1",124,0)
 . S:RASSSBN="" RASSSBN=$E(RAZ,1,25)
"RTN","RARTR1",125,0)
 . S RASSSBT=$$GET1^DIQ(200,+RASS(0)_",",20.3) ; max: 50 chars
"RTN","RARTR1",126,0)
 . I RASSSBT']"" S RASSSBT=$$TITLE^RARTR0(+RASS(0))
"RTN","RARTR1",127,0)
 . I '$D(RAUTOE) D:($Y+RAFOOT+4)>IOSL HANG^RARTR2 Q:$D(RAOOUT)  D HD^RARTR:($Y+RAFOOT+4)>IOSL
"RTN","RARTR1",128,0)
 . W:'$D(RAUTOE) !?2,$S(RASSSBN]"":RASSSBN,1:"Unknown"),", ",$E(RASSSBT,1,((IOM-$X)-16))
"RTN","RARTR1",129,0)
 . ; The '-16' above is derived from $L("(Pre-Verifier)")+1 FORMATTING
"RTN","RARTR1",130,0)
 . I $D(RAUTOE) D
"RTN","RARTR1",131,0)
 .. S ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="  "_$S(RASSSBN]"":RASSSBN,1:"Unknown")
"RTN","RARTR1",132,0)
 .. N RALEN S RALEN=$L(^TMP($J,"RA AUTOE",RAACNT))
"RTN","RARTR1",133,0)
 .. S ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_", "_$E(RASSSBT,1,((80-RALEN)-16))
"RTN","RARTR1",134,0)
 .. Q
"RTN","RARTR1",135,0)
 . I '$D(RAVERFND),(RAVERF=+RASS(0)) D
"RTN","RARTR1",136,0)
 .. S RAVERFND=""
"RTN","RARTR1",137,0)
 .. I $G(RARPT(10))']"",('$D(RAUTOE)) D  Q
"RTN","RARTR1",138,0)
 ... W:RAWHOVER=+RASS(0) !?10,"(Verifier, no e-sig)"
"RTN","RARTR1",139,0)
 ... W:RAWHOVER'=+RASS(0) !?10,"Verified by transcriptionist for "_RASSSBN  ;Removed RA*5*8 _", M.D."
"RTN","RARTR1",140,0)
 ... Q
"RTN","RARTR1",141,0)
 .. I $G(RARPT(10))']"",($D(RAUTOE)) D  Q
"RTN","RARTR1",142,0)
 ... S:RAWHOVER=+RASS(0) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="          (Verifier, no e-sig)"
"RTN","RARTR1",143,0)
 ... S:RAWHOVER'=+RASS(0) ^TMP($J,"RA AUTOE",$$INCR^RAUTL4(RAACNT))="          Verified by transcriptionist for "_RASSSBN  ;Removed RA*5*8 _", M.D."
"RTN","RARTR1",144,0)
 ... Q
"RTN","RARTR1",145,0)
 .. W:'$D(RAUTOE) " (Verifier)"
"RTN","RARTR1",146,0)
 .. S:$D(RAUTOE) ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_" (Verifier)"
"RTN","RARTR1",147,0)
 .. Q
"RTN","RARTR1",148,0)
 . I RAPVERF=+RASS(0) W:'$D(RAUTOE) " (Pre-Verifier)" S:$D(RAUTOE) ^TMP($J,"RA AUTOE",RAACNT)=^TMP($J,"RA AUTOE",RAACNT)_" (Pre-Verifier)"
"RTN","RARTR1",149,0)
 . Q
"RTN","RARTR1",150,0)
 Q
"VER")
8.0^22.0
"^DD",78.3,78.3,.001,0)
NUMBER^NJ3,0^^ ^K:+X'=X!(X>998)!(X<1)!(X?.E1"."1N.N) X
"^DD",78.3,78.3,.001,.1)
NUMBER OF THIS DIAGNOSTIC CODE
"^DD",78.3,78.3,.001,3)
Type a Number between 1 and 998, 0 Decimal Digits
"^DD",78.3,78.3,.001,10)
SYSTEM GENERATED
"^DD",78.3,78.3,.001,21,0)
^.001^11^11^3090422^^
"^DD",78.3,78.3,.001,21,1,0)
This field contains the number of this diagnostic code.  This provides
"^DD",78.3,78.3,.001,21,2,0)
a way to do quick look-ups of a diagnostic code by its number.
"^DD",78.3,78.3,.001,21,3,0)
 
"^DD",78.3,78.3,.001,21,4,0)
Diagnostic code numbers are assigned by the system and are between 1 and
"^DD",78.3,78.3,.001,21,5,0)
998.  Diagnostic codes above 998 are assigned by Radiology patches.
"^DD",78.3,78.3,.001,21,6,0)
 
"^DD",78.3,78.3,.001,21,7,0)
    Code Number     Usage
"^DD",78.3,78.3,.001,21,8,0)
    -----------     -------------------------
"^DD",78.3,78.3,.001,21,9,0)
     999-1003       Nat'l Teleradiology Prog.
"^DD",78.3,78.3,.001,21,10,0)
    1100-1106       BI-RADS
"^DD",78.3,78.3,.001,21,11,0)
    1200-1202       Abdominal Aortic Aneurysm
"^DD",78.3,78.3,.001,23,0)
^^1^1^3090422^
"^DD",78.3,78.3,.001,23,1,0)
The maximum limit for this field is set to 998 by patch RA*5.0*97.
"^DD",78.3,78.3,.001,"DT")
3090317
"^DD",78.3,78.3,.01,0)
DIAGNOSTIC CODE^RFI^^0;1^K:$L(X)>60!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",78.3,78.3,.01,.1)
NAME OF THE DIAGNOSTIC CODE
"^DD",78.3,78.3,.01,1,0)
^.1
"^DD",78.3,78.3,.01,1,1,0)
78.3^B
"^DD",78.3,78.3,.01,1,1,1)
S ^RA(78.3,"B",$E(X,1,30),DA)=""
"^DD",78.3,78.3,.01,1,1,2)
K ^RA(78.3,"B",$E(X,1,30),DA)
"^DD",78.3,78.3,.01,1,1,"%D",0)
^^1^1^2940518^
"^DD",78.3,78.3,.01,1,1,"%D",1,0)
     Regular 'B' cross reference assigned by FileMan.
"^DD",78.3,78.3,.01,3)
Enter a short diagnostic code, between 3 and 60 characters in length, to indicate the results of the image analysis.
"^DD",78.3,78.3,.01,4)

"^DD",78.3,78.3,.01,10)
RAD/NUC MED COORDINATOR
"^DD",78.3,78.3,.01,21,0)
^^9^9^3090730^
"^DD",78.3,78.3,.01,21,1,0)
This field contains a short diagnostic code to indicate the results of
"^DD",78.3,78.3,.01,21,2,0)
the interpreting physician's analysis of the images.  Diagnostic codes
"^DD",78.3,78.3,.01,21,3,0)
can be between 3 and 60 characters in length and can be used as a basis
"^DD",78.3,78.3,.01,21,4,0)
for database searches.  (ie. How many 'Normal' chest exams were performed
"^DD",78.3,78.3,.01,21,5,0)
during a specific time period?)
"^DD",78.3,78.3,.01,21,6,0)
 
"^DD",78.3,78.3,.01,21,7,0)
Eight diagnostic codes are included with the original package.  Other
"^DD",78.3,78.3,.01,21,8,0)
site-specific diagnostic codes may be entered by the rad/nuc med
"^DD",78.3,78.3,.01,21,9,0)
coordinator at each site.
"^DD",78.3,78.3,.01,23,0)
^^6^6^3090730^
"^DD",78.3,78.3,.01,23,1,0)
This field is made uneditable by patch RA*5*97.
"^DD",78.3,78.3,.01,23,2,0)
 
"^DD",78.3,78.3,.01,23,3,0)
Patch RA*5.0*97 adds BI-RADS codes to IEN 1100 thru 1106, and AAA codes 
"^DD",78.3,78.3,.01,23,4,0)
to IEN 1200 thru 1202.  Routine RABIRAD builds a string of BI-RADS IENs 
"^DD",78.3,78.3,.01,23,5,0)
based upon the exact spelling of the first two words in this field, eg.
"^DD",78.3,78.3,.01,23,6,0)
"BI-RADS CATEGORY". 
"^DD",78.3,78.3,.01,"DEL",1,0)
I 1 D EN^DDIOL("Diagnostic Codes cannot be deleted. Inactivate to remove.",,"!,$C(7)")
"^DD",78.3,78.3,.01,"DT")
3090317
"^DD",78.3,78.3,6,0)
EXPRESSION^P757.01'I^LEX(757.01,^0;6^Q
"^DD",78.3,78.3,6,3)
Data for this field must be entered by a Radiology patch.
"^DD",78.3,78.3,6,21,0)
^^9^9^3090730^
"^DD",78.3,78.3,6,21,1,0)
This field is associated with the .01 field used for BI-RADS codes under 
"^DD",78.3,78.3,6,21,2,0)
the MQSA coding system mandated by the FDA.  Whenever the BI-RADS codes 
"^DD",78.3,78.3,6,21,3,0)
from field .01 is displayed, this field will be used to retrieve the 
"^DD",78.3,78.3,6,21,4,0)
current FDA-mandated wording for .01 field values of "BI-RADS CATEGORY 0" 
"^DD",78.3,78.3,6,21,5,0)
through "BI-RADS CATEGORY 6", which are in record numbers 1100 through 
"^DD",78.3,78.3,6,21,6,0)
1106.  The retrieved value will be displayed next to the .01 field 
"^DD",78.3,78.3,6,21,7,0)
value.  This field is initially populated by patch RA*5.0*97.  The 
"^DD",78.3,78.3,6,21,8,0)
Radiology application does not prompt the user for this field.  Changes 
"^DD",78.3,78.3,6,21,9,0)
to data in this field will be made by future Radiology patches.
"^DD",78.3,78.3,6,23,0)
^.001^1^1^3090730^^^^
"^DD",78.3,78.3,6,23,1,0)
This field was added and made uneditable by patch RA*5.0*97.
"^DD",78.3,78.3,6,"DT")
3090506
**END**
**END**
