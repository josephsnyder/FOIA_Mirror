Released XU*8*511 SEQ #412
Extracted from mail message
**KIDS**:XU*8.0*511^

**INSTALL NAME**
XU*8.0*511
"BLD",1094,0)
XU*8.0*511^KERNEL^0^3081028^y^^
"BLD",1094,1,0)
^^3^3^3081008^
"BLD",1094,1,1,0)
Please see the patch description on FORUM, in the National
"BLD",1094,1,2,0)
 Patch Module.
"BLD",1094,1,3,0)

"BLD",1094,4,0)
^9.64PA^9.4^1
"BLD",1094,4,9.4,0)
9.4
"BLD",1094,4,9.4,2,0)
^9.641^9.4014^2
"BLD",1094,4,9.4,2,9.4,0)
PACKAGE  (File-top level)
"BLD",1094,4,9.4,2,9.4,1,0)
^9.6411^1^1
"BLD",1094,4,9.4,2,9.4,1,1,0)
PREFIX
"BLD",1094,4,9.4,2,9.4014,0)
ADDITIONAL PREFIXES  (sub-file)
"BLD",1094,4,9.4,2,9.4014,1,0)
^9.6411^^0
"BLD",1094,4,9.4,222)
y^n^p^^^^n^^n
"BLD",1094,4,9.4,224)

"BLD",1094,4,"APDD",9.4,9.4)

"BLD",1094,4,"APDD",9.4,9.4,1)

"BLD",1094,4,"APDD",9.4,9.4014)

"BLD",1094,4,"B",9.4,9.4)

"BLD",1094,6.3)
5
"BLD",1094,"ABPKG")
n
"BLD",1094,"INIT")
POST^XU8P511
"BLD",1094,"KRN",0)
^9.67PA^779.2^20
"BLD",1094,"KRN",.4,0)
.4
"BLD",1094,"KRN",.401,0)
.401
"BLD",1094,"KRN",.402,0)
.402
"BLD",1094,"KRN",.403,0)
.403
"BLD",1094,"KRN",.403,"NM",0)
^9.68A^1^1
"BLD",1094,"KRN",.403,"NM",1,0)
XPD EDIT BUILD    FILE #9.6^9.6^0
"BLD",1094,"KRN",.403,"NM","B","XPD EDIT BUILD    FILE #9.6",1)

"BLD",1094,"KRN",.5,0)
.5
"BLD",1094,"KRN",.84,0)
.84
"BLD",1094,"KRN",3.6,0)
3.6
"BLD",1094,"KRN",3.8,0)
3.8
"BLD",1094,"KRN",9.2,0)
9.2
"BLD",1094,"KRN",9.8,0)
9.8
"BLD",1094,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",1094,"KRN",9.8,"NM",1,0)
XPDUTL^^0^B23402759
"BLD",1094,"KRN",9.8,"NM",2,0)
XPDTC^^0^B45497905
"BLD",1094,"KRN",9.8,"NM",3,0)
XPDT^^0^B79741055
"BLD",1094,"KRN",9.8,"NM",4,0)
XPDV^^0^B37369398
"BLD",1094,"KRN",9.8,"NM",5,0)
XPDDCS^^0^B18646094
"BLD",1094,"KRN",9.8,"NM","B","XPDDCS",5)

"BLD",1094,"KRN",9.8,"NM","B","XPDT",3)

"BLD",1094,"KRN",9.8,"NM","B","XPDTC",2)

"BLD",1094,"KRN",9.8,"NM","B","XPDUTL",1)

"BLD",1094,"KRN",9.8,"NM","B","XPDV",4)

"BLD",1094,"KRN",19,0)
19
"BLD",1094,"KRN",19.1,0)
19.1
"BLD",1094,"KRN",101,0)
101
"BLD",1094,"KRN",409.61,0)
409.61
"BLD",1094,"KRN",771,0)
771
"BLD",1094,"KRN",779.2,0)
779.2
"BLD",1094,"KRN",870,0)
870
"BLD",1094,"KRN",8989.51,0)
8989.51
"BLD",1094,"KRN",8989.52,0)
8989.52
"BLD",1094,"KRN",8994,0)
8994
"BLD",1094,"KRN","B",.4,.4)

"BLD",1094,"KRN","B",.401,.401)

"BLD",1094,"KRN","B",.402,.402)

"BLD",1094,"KRN","B",.403,.403)

"BLD",1094,"KRN","B",.5,.5)

"BLD",1094,"KRN","B",.84,.84)

"BLD",1094,"KRN","B",3.6,3.6)

"BLD",1094,"KRN","B",3.8,3.8)

"BLD",1094,"KRN","B",9.2,9.2)

"BLD",1094,"KRN","B",9.8,9.8)

"BLD",1094,"KRN","B",19,19)

"BLD",1094,"KRN","B",19.1,19.1)

"BLD",1094,"KRN","B",101,101)

"BLD",1094,"KRN","B",409.61,409.61)

"BLD",1094,"KRN","B",771,771)

"BLD",1094,"KRN","B",779.2,779.2)

"BLD",1094,"KRN","B",870,870)

"BLD",1094,"KRN","B",8989.51,8989.51)

"BLD",1094,"KRN","B",8989.52,8989.52)

"BLD",1094,"KRN","B",8994,8994)

"BLD",1094,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",1094,"QUES",0)
^9.62^^
"BLD",1094,"REQB",0)
^9.611^3^3
"BLD",1094,"REQB",1,0)
XU*8.0*393^1
"BLD",1094,"REQB",2,0)
XU*8.0*463^1
"BLD",1094,"REQB",3,0)
XU*8.0*491^1
"BLD",1094,"REQB","B","XU*8.0*393",1)

"BLD",1094,"REQB","B","XU*8.0*463",2)

"BLD",1094,"REQB","B","XU*8.0*491",3)

"FIA",9.4)
PACKAGE
"FIA",9.4,0)
^DIC(9.4,
"FIA",9.4,0,0)
9.4I
"FIA",9.4,0,1)
y^n^p^^^^n^^n
"FIA",9.4,0,10)

"FIA",9.4,0,11)

"FIA",9.4,0,"RLRO")

"FIA",9.4,0,"VR")
8.0^XU
"FIA",9.4,9.4)
1
"FIA",9.4,9.4,1)

"FIA",9.4,9.4,14)

"FIA",9.4,9.4014)
0
"INIT")
POST^XU8P511
"KRN",.403,1,-1)
0^1
"KRN",.403,1,0)
XPD EDIT BUILD^#^^^2931104^^^9.6^0^0^1
"KRN",.403,1,40,0)
^.4031I^17^16
"KRN",.403,1,40,1,0)
1^^1,1^4^17
"KRN",.403,1,40,1,1)
Page 1
"KRN",.403,1,40,1,40,0)
^.4032PI^2^2
"KRN",.403,1,40,1,40,1,0)
XPD EDIT BUILD HDR^1^1,1^d
"KRN",.403,1,40,1,40,2,0)
XPD EDIT BUILD1^2^1,1^e
"KRN",.403,1,40,2,0)
2^^1,1^14^4
"KRN",.403,1,40,2,1)
Page 2
"KRN",.403,1,40,2,12)

"KRN",.403,1,40,2,40,0)
^.4032PI^13^3
"KRN",.403,1,40,2,40,1,0)
XPD EDIT BUILD HDR^1^1,1^d
"KRN",.403,1,40,2,40,3,0)
XPD EDIT BUILD2^2^1,1^e
"KRN",.403,1,40,2,40,13,0)
XPD EDIT BUILD30^3^5,1^e
"KRN",.403,1,40,2,40,13,2)
12^^f^1
"KRN",.403,1,40,3,0)
3^^5,1^^^1^17,79
"KRN",.403,1,40,3,1)
Kernel File^1,3,2
"KRN",.403,1,40,3,40,0)
^.4032PI^9^2
"KRN",.403,1,40,3,40,4,0)
XPD EDIT BUILD3^1^3,2^e
"KRN",.403,1,40,3,40,4,2)
9^^n
"KRN",.403,1,40,3,40,9,0)
XPD EDIT BUILD31^2^1,2^d
"KRN",.403,1,40,4,0)
4^^1,1^2^1
"KRN",.403,1,40,4,1)
File^
"KRN",.403,1,40,4,40,0)
^.4032PI^15^3
"KRN",.403,1,40,4,40,1,0)
XPD EDIT BUILD HDR^1^1,1^d
"KRN",.403,1,40,4,40,14,0)
XPD EDIT BUILD40^2^5,1^e
"KRN",.403,1,40,4,40,14,2)
12^^n
"KRN",.403,1,40,4,40,15,0)
XPD EDIT BUILD41^3^1,1^d
"KRN",.403,1,40,5,0)
5^^6,3^^^1^17,77
"KRN",.403,1,40,5,1)
Record Merge^2,2,8
"KRN",.403,1,40,5,40,0)
^.4032PI^6^1
"KRN",.403,1,40,5,40,6,0)
XPD EDIT BUILD5^1^1,3^e
"KRN",.403,1,40,7,0)
7^^5,1^^^1^17,78
"KRN",.403,1,40,7,1)
Entries^
"KRN",.403,1,40,7,40,0)
^.4032PI^5^1
"KRN",.403,1,40,7,40,5,0)
XPD EDIT BUILD4^2^1,1^e
"KRN",.403,1,40,8,0)
8^^5,2^^^1^15,78
"KRN",.403,1,40,8,1)
Package file
"KRN",.403,1,40,8,11)

"KRN",.403,1,40,8,40,0)
^.4032PI^23^3
"KRN",.403,1,40,8,40,7,0)
XPD EDIT BUILD6^2^3,2^e
"KRN",.403,1,40,8,40,7,1)
1
"KRN",.403,1,40,8,40,10,0)
XPD EDIT BUILD8^3^8,2^e
"KRN",.403,1,40,8,40,23,0)
XPD EDIT BUILD60^4^1,2^d
"KRN",.403,1,40,9,0)
9^^4,3^^^1^16,77
"KRN",.403,1,40,9,1)
Page 9
"KRN",.403,1,40,9,12)

"KRN",.403,1,40,9,40,0)
^.4032PI^24^2
"KRN",.403,1,40,9,40,11,0)
XPD EDIT BUILD9^1^1,2^e
"KRN",.403,1,40,9,40,24,0)
XPD EDIT BUILD9A^2^8,2^e
"KRN",.403,1,40,9,40,24,2)
4
"KRN",.403,1,40,10,0)
10^^5,4^^^1^9,76
"KRN",.403,1,40,10,1)
A/B namespace^
"KRN",.403,1,40,10,11)

"KRN",.403,1,40,10,12)

"KRN",.403,1,40,10,40,0)
^.4032PI^25^2
"KRN",.403,1,40,10,40,12,0)
XPD EDIT BUILD10^1^1,3^e
"KRN",.403,1,40,10,40,25,0)
XPD EDIT BUILD10A^2^2,2^e
"KRN",.403,1,40,10,40,25,2)
2
"KRN",.403,1,40,11,0)
11^^6,2^^^1^16,77
"KRN",.403,1,40,11,1)
Sub DD
"KRN",.403,1,40,11,40,0)
^.4032PI^18^2
"KRN",.403,1,40,11,40,16,0)
XPD EDIT BUILD42^1^2,3^e
"KRN",.403,1,40,11,40,16,2)
6^!IEN^n^^
"KRN",.403,1,40,11,40,18,0)
XPD EDIT BUILD44^2^1,3^d
"KRN",.403,1,40,12,0)
12^^7,3^^^1^15,76
"KRN",.403,1,40,12,1)
Sub Field
"KRN",.403,1,40,12,40,0)
^.4032PI^19^2
"KRN",.403,1,40,12,40,17,0)
XPD EDIT BUILD43^1^2,3^e
"KRN",.403,1,40,12,40,17,2)
6^!IEN^n
"KRN",.403,1,40,12,40,19,0)
XPD EDIT BUILD45^2^1,2^d
"KRN",.403,1,40,13,0)
13^^6,2^^^1^16,77
"KRN",.403,1,40,13,1)
Page 13
"KRN",.403,1,40,13,40,0)
^.4032PI^20^1
"KRN",.403,1,40,13,40,20,0)
XPD EDIT BUILD46^1^1,1^e
"KRN",.403,1,40,14,0)
14^^1,1^17^2
"KRN",.403,1,40,14,1)
Page 14
"KRN",.403,1,40,14,40,0)
^.4032PI^65^4
"KRN",.403,1,40,14,40,1,0)
XPD EDIT BUILD HDR^1^1,1^d
"KRN",.403,1,40,14,40,21,0)
XPD EDIT BUILD11^4^1,1^e
"KRN",.403,1,40,14,40,22,0)
XPD EDIT BUILD12^2^5,1^e
"KRN",.403,1,40,14,40,22,2)
4^^n
"KRN",.403,1,40,14,40,65,0)
XPD EDIT BUILD52^3^10,1^e
"KRN",.403,1,40,14,40,65,2)
4
"KRN",.403,1,40,15,0)
15^^2,1^^^1^17,79
"KRN",.403,1,40,15,1)
Install questions
"KRN",.403,1,40,15,40,0)
^.4032PI^8^1
"KRN",.403,1,40,15,40,8,0)
XPD EDIT BUILD7^1^1,1^e
"KRN",.403,1,40,16,0)
16^XPD EDIT BUILD HDR^1,1
"KRN",.403,1,40,16,1)
Page 16
"KRN",.403,1,40,17,0)
17^^1,1^1^14
"KRN",.403,1,40,17,1)
Page 17
"KRN",.403,1,40,17,15,0)
^^1^1^3070620^
"KRN",.403,1,40,17,15,1,0)
This is the page to edit the KIDS install QUESTIONS default values.
"KRN",.403,1,40,17,40,0)
^.4032IP^218^2
"KRN",.403,1,40,17,40,1,0)
XPD EDIT BUILD HDR^1^1,1^e
"KRN",.403,1,40,17,40,218,0)
XPD EDIT BUILD5D^2^1,1^e
"KRN",.404,1,0)
XPD EDIT BUILD HDR^9.6
"KRN",.404,1,40,0)
^.4044I^5^5
"KRN",.404,1,40,1,0)
1^Edit a Build^1^
"KRN",.404,1,40,1,2)
^^1,28^
"KRN",.404,1,40,2,0)
7^Name^3^
"KRN",.404,1,40,2,1)
.01
"KRN",.404,1,40,2,2)
2,7^30^2,1
"KRN",.404,1,40,2,4)
^^^1
"KRN",.404,1,40,3,0)
3^PAGE   OF 5^1^
"KRN",.404,1,40,3,2)
^^1,66
"KRN",.404,1,40,4,0)
4^!M^1^
"KRN",.404,1,40,4,.1)
S $P(Y,"-",80)=""
"KRN",.404,1,40,4,2)
^^3,1^
"KRN",.404,1,40,5,0)
8^TYPE^3
"KRN",.404,1,40,5,1)
2
"KRN",.404,1,40,5,2)
2,51^14^2,45
"KRN",.404,1,40,5,4)
^^^1
"KRN",.404,2,0)
XPD EDIT BUILD1^9.6
"KRN",.404,2,12)

"KRN",.404,2,40,0)
^.4044I^19^13
"KRN",.404,2,40,1,0)
2^Name^3^
"KRN",.404,2,40,1,1)
.01
"KRN",.404,2,40,1,2)
5,29^50^5,23
"KRN",.404,2,40,5,0)
5^Environment Check Routine^3^
"KRN",.404,2,40,5,1)
913
"KRN",.404,2,40,5,2)
11,29^8^11,2
"KRN",.404,2,40,6,0)
7^Post-Install Routine^3^
"KRN",.404,2,40,6,1)
914
"KRN",.404,2,40,6,2)
15,29^17^15,7
"KRN",.404,2,40,7,0)
6^Pre-Install Routine^3^
"KRN",.404,2,40,7,1)
916
"KRN",.404,2,40,7,2)
13,29^17^13,8
"KRN",.404,2,40,11,0)
4^Description^3^
"KRN",.404,2,40,11,1)
3
"KRN",.404,2,40,11,2)
9,29^1^9,16
"KRN",.404,2,40,12,0)
1^1^1^
"KRN",.404,2,40,12,2)
^^1,71^
"KRN",.404,2,40,13,0)
3^Date Distributed^3
"KRN",.404,2,40,13,1)
.02
"KRN",.404,2,40,13,2)
7,29^11^7,11
"KRN",.404,2,40,14,0)
8^Pre-Transportation Routine^3
"KRN",.404,2,40,14,1)
900
"KRN",.404,2,40,14,2)
17,29^17^17,1
"KRN",.404,2,40,15,0)
11^Delete Routine^1
"KRN",.404,2,40,15,2)
^^9,57
"KRN",.404,2,40,16,0)
12^after install^1
"KRN",.404,2,40,16,2)
^^10,58
"KRN",.404,2,40,17,0)
13^Y/N^3
"KRN",.404,2,40,17,1)
913.1
"KRN",.404,2,40,17,2)
11,64^1^11,59
"KRN",.404,2,40,17,11)
N % S %(1)="Be VERY careful setting this to yes" D HLP^DDSUTL(.%)
"KRN",.404,2,40,18,0)
14^Y/N^3
"KRN",.404,2,40,18,1)
916.1
"KRN",.404,2,40,18,2)
13,64^1^13,59
"KRN",.404,2,40,18,11)
N % S %(1)="Be VERY careful setting this to yes" D HLP^DDSUTL(.%)
"KRN",.404,2,40,19,0)
15^Y/N^3
"KRN",.404,2,40,19,1)
914.1
"KRN",.404,2,40,19,2)
15,64^1^15,59
"KRN",.404,2,40,19,11)
N % S %(1)="Be VERY careful setting this to yes" D HLP^DDSUTL(.%)
"KRN",.404,3,0)
XPD EDIT BUILD2^9.6
"KRN",.404,3,12)

"KRN",.404,3,40,0)
^.4044I^2^2
"KRN",.404,3,40,1,0)
99^3^1^
"KRN",.404,3,40,1,2)
^^1,71^
"KRN",.404,3,40,2,0)
2^Build Components^1^
"KRN",.404,3,40,2,2)
^^4,28^1
"KRN",.404,4,0)
XPD EDIT BUILD3^9.68
"KRN",.404,4,40,0)
^.4044I^2^2
"KRN",.404,4,40,1,0)
1^^3^
"KRN",.404,4,40,1,1)
.01
"KRN",.404,4,40,1,2)
1,2^45
"KRN",.404,4,40,2,0)
2^^3
"KRN",.404,4,40,2,1)
.03
"KRN",.404,4,40,2,2)
1,50^26
"KRN",.404,4,40,2,3)
SEND TO SITE
"KRN",.404,4,40,2,4)
1
"KRN",.404,5,0)
XPD EDIT BUILD4^9.64
"KRN",.404,5,40,0)
^.4044I^18^7
"KRN",.404,5,40,1,0)
1^ DD Export Options ^1^
"KRN",.404,5,40,1,2)
^^1,27^1
"KRN",.404,5,40,2,0)
2^File^3^
"KRN",.404,5,40,2,1)
.01
"KRN",.404,5,40,2,2)
3,30^45^3,24
"KRN",.404,5,40,7,0)
7^Data Comes With File...^3^
"KRN",.404,5,40,7,1)
222.7
"KRN",.404,5,40,7,2)
12,33^3^12,8
"KRN",.404,5,40,7,3)
NO
"KRN",.404,5,40,7,10)
S:X="y" DDSSTACK=13
"KRN",.404,5,40,7,13)
D:X="y" PUT^DDSVAL(DIE,.DA,222.3,"f","","I")
"KRN",.404,5,40,13,0)
6^Screen to Determine DD Update^3
"KRN",.404,5,40,13,1)
223
"KRN",.404,5,40,13,2)
10,2^76^9,2^1
"KRN",.404,5,40,14,0)
5^Send Security Code^3
"KRN",.404,5,40,14,1)
222.2
"KRN",.404,5,40,14,2)
7,62^3^7,42
"KRN",.404,5,40,14,3)
YES
"KRN",.404,5,40,16,0)
4^Update the Data Dictionary^3
"KRN",.404,5,40,16,1)
222.1
"KRN",.404,5,40,16,2)
7,30^3^7,2
"KRN",.404,5,40,16,3)
YES
"KRN",.404,5,40,18,0)
3^Send Full or Partial DD...^3
"KRN",.404,5,40,18,1)
222.3
"KRN",.404,5,40,18,2)
5,33^7^5,5
"KRN",.404,5,40,18,3)
FULL
"KRN",.404,5,40,18,10)
S:X="p" DDSSTACK=11
"KRN",.404,5,40,18,13)
D:X="p" PAR964^XPDET
"KRN",.404,6,0)
XPD EDIT BUILD5^9.402
"KRN",.404,6,40,0)
^.4044I^4^4
"KRN",.404,6,40,1,0)
1^ Affects Record Merge ^1^
"KRN",.404,6,40,1,2)
^^1,23^1
"KRN",.404,6,40,2,0)
2^File Affected^3^
"KRN",.404,6,40,2,1)
.01
"KRN",.404,6,40,2,2)
3,16^45^3,1
"KRN",.404,6,40,3,0)
3^Name of Merge Routine^3^
"KRN",.404,6,40,3,1)
3
"KRN",.404,6,40,3,2)
5,24^8^5,1
"KRN",.404,6,40,4,0)
4^Record has Package Data^3^
"KRN",.404,6,40,4,1)
4
"KRN",.404,6,40,4,2)
10,1^70^8,21^1
"KRN",.404,7,0)
XPD EDIT BUILD6^9.4
"KRN",.404,7,11)
I $G(XPDBR) S DDSBR="COM" K XPDBR
"KRN",.404,7,40,0)
^.4044I^5^2
"KRN",.404,7,40,2,0)
2^Select Affects Record Merge^3^
"KRN",.404,7,40,2,1)
20
"KRN",.404,7,40,2,2)
5,31^30^5,2
"KRN",.404,7,40,5,0)
1^Primary Help Frame^3
"KRN",.404,7,40,5,1)
12
"KRN",.404,7,40,5,2)
3,31^30^3,11
"KRN",.404,8,0)
XPD EDIT BUILD7^9.62
"KRN",.404,8,40,0)
^.4044I^10^10
"KRN",.404,8,40,1,0)
2^Name^3^
"KRN",.404,8,40,1,1)
.01
"KRN",.404,8,40,1,2)
2,12^30^2,6
"KRN",.404,8,40,2,0)
3^DIR(0)^3^
"KRN",.404,8,40,2,1)
1
"KRN",.404,8,40,2,2)
4,12^65^4,4
"KRN",.404,8,40,3,0)
4^DIR(A)^3^
"KRN",.404,8,40,3,1)
2
"KRN",.404,8,40,3,2)
6,12^65^6,4
"KRN",.404,8,40,4,0)
5^DIR(A,#)^3^
"KRN",.404,8,40,4,1)
3
"KRN",.404,8,40,4,2)
7,12^1^7,2
"KRN",.404,8,40,5,0)
6^DIR(B)^3^
"KRN",.404,8,40,5,1)
4
"KRN",.404,8,40,5,2)
9,12^65^9,4
"KRN",.404,8,40,6,0)
7^DIR(?)^3^
"KRN",.404,8,40,6,1)
5
"KRN",.404,8,40,6,2)
11,12^65^11,4
"KRN",.404,8,40,7,0)
8^DIR(?,#)^3^
"KRN",.404,8,40,7,1)
6
"KRN",.404,8,40,7,2)
12,12^1^12,2
"KRN",.404,8,40,8,0)
9^DIR(??)^3^
"KRN",.404,8,40,8,1)
7
"KRN",.404,8,40,8,2)
13,12^64^13,3
"KRN",.404,8,40,9,0)
10^M Code^3
"KRN",.404,8,40,9,1)
10
"KRN",.404,8,40,9,2)
15,12^65^15,4
"KRN",.404,8,40,10,0)
1^ Install Questions ^1^
"KRN",.404,8,40,10,2)
^^1,27^1
"KRN",.404,9,0)
XPD EDIT BUILD31^9.67
"KRN",.404,9,40,0)
^.4044I^1^1
"KRN",.404,9,40,1,0)
1^!M^1^
"KRN",.404,9,40,1,.1)
S Y=" "_$P($G(^DIC(D1,0)),U)_" "
"KRN",.404,9,40,1,2)
^^1,27^
"KRN",.404,10,0)
XPD EDIT BUILD8^9.6
"KRN",.404,10,11)

"KRN",.404,10,40,0)
^.4044I^1^1
"KRN",.404,10,40,1,0)
1^Alpha/Beta Testing...^3
"KRN",.404,10,40,1,1)
20
"KRN",.404,10,40,1,2)
2,31^3^2,8
"KRN",.404,10,40,1,3)
NO
"KRN",.404,10,40,1,10)
S:X="y" DDSSTACK="9"
"KRN",.404,11,0)
XPD EDIT BUILD9^9.6
"KRN",.404,11,40,0)
^.4044I^5^4
"KRN",.404,11,40,1,0)
2^Installation Message^3
"KRN",.404,11,40,1,1)
21
"KRN",.404,11,40,1,2)
3,30^3^3,8
"KRN",.404,11,40,1,3)
NO
"KRN",.404,11,40,2,0)
3^Address for Usage Reporting^3
"KRN",.404,11,40,2,1)
22
"KRN",.404,11,40,2,2)
5,30^44^5,1
"KRN",.404,11,40,4,0)
1^ Alpha/Beta Testing ^1^
"KRN",.404,11,40,4,2)
^^1,26^1
"KRN",.404,11,40,5,0)
4^Package Namespace or Prefix:^1
"KRN",.404,11,40,5,2)
^^7,1
"KRN",.404,12,0)
XPD EDIT BUILD10^9.66
"KRN",.404,12,40,0)
^.4044I^1^1
"KRN",.404,12,40,1,0)
1^ Exclude Namespace or Prefix ^1
"KRN",.404,12,40,1,2)
^^1,20^1
"KRN",.404,13,0)
XPD EDIT BUILD30^9.67
"KRN",.404,13,40,0)
^.4044I^2^2
"KRN",.404,13,40,1,0)
1^^3
"KRN",.404,13,40,1,1)
.01
"KRN",.404,13,40,1,2)
2,1^24
"KRN",.404,13,40,1,4)
^^^2
"KRN",.404,13,40,1,10)
S DDSSTACK=3
"KRN",.404,13,40,2,0)
2^^4
"KRN",.404,13,40,2,2)
2,27^5
"KRN",.404,13,40,2,4)
^^1
"KRN",.404,13,40,2,30)
S Y="("_+$P($G(^XPD(9.6,DA(1),"KRN",DA,"NM",0)),U,4)_")"
"KRN",.404,14,0)
XPD EDIT BUILD40^9.64
"KRN",.404,14,40,0)
^.4044I^1^1
"KRN",.404,14,40,1,0)
1^^3
"KRN",.404,14,40,1,1)
.01
"KRN",.404,14,40,1,2)
2,7^45
"KRN",.404,14,40,1,10)
S DDSSTACK=7
"KRN",.404,15,0)
XPD EDIT BUILD41^9.6
"KRN",.404,15,40,0)
^.4044I^3^2
"KRN",.404,15,40,1,0)
1^2^1^
"KRN",.404,15,40,1,2)
^^1,71^
"KRN",.404,15,40,3,0)
2^File List  (Name or Number)^1
"KRN",.404,15,40,3,2)
^^4,28
"KRN",.404,16,0)
XPD EDIT BUILD42^9.641
"KRN",.404,16,40,0)
^.4044I^1^1
"KRN",.404,16,40,1,0)
1^^3
"KRN",.404,16,40,1,1)
.01
"KRN",.404,16,40,1,2)
1,1^45
"KRN",.404,16,40,1,10)
S DDSSTACK=12
"KRN",.404,17,0)
XPD EDIT BUILD43^9.6411
"KRN",.404,17,40,0)
^.4044I^1^1
"KRN",.404,17,40,1,0)
1^^3
"KRN",.404,17,40,1,1)
.01
"KRN",.404,17,40,1,2)
1,1^45
"KRN",.404,18,0)
XPD EDIT BUILD44^9.64
"KRN",.404,18,40,0)
^.4044I^1^1
"KRN",.404,18,40,1,0)
1^ Data Dictionary Number ^1^
"KRN",.404,18,40,1,2)
^^1,24^1
"KRN",.404,19,0)
XPD EDIT BUILD45^9.641
"KRN",.404,19,40,0)
^.4044I^1^1
"KRN",.404,19,40,1,0)
1^ Field Number ^1^
"KRN",.404,19,40,1,2)
^^1,24^1
"KRN",.404,20,0)
XPD EDIT BUILD46^9.64
"KRN",.404,20,40,0)
^.4044I^7^6
"KRN",.404,20,40,1,0)
1^ Data Export Options ^1^
"KRN",.404,20,40,1,2)
^^1,29^1
"KRN",.404,20,40,2,0)
2^Site's Data^3
"KRN",.404,20,40,2,1)
222.8
"KRN",.404,20,40,2,2)
3,21^15^3,8
"KRN",.404,20,40,2,3)
OVERWRITE
"KRN",.404,20,40,3,0)
5^Data List^3
"KRN",.404,20,40,3,1)
222.6
"KRN",.404,20,40,3,2)
7,21^30^7,10
"KRN",.404,20,40,4,0)
3^Resolve Pointers^3
"KRN",.404,20,40,4,1)
222.5
"KRN",.404,20,40,4,2)
5,21^3^5,3
"KRN",.404,20,40,4,3)
NO
"KRN",.404,20,40,5,0)
4^May User Override Data Update^3
"KRN",.404,20,40,5,1)
222.9
"KRN",.404,20,40,5,2)
5,68^3^5,37
"KRN",.404,20,40,5,3)
NO
"KRN",.404,20,40,7,0)
6^Screen to Select Data^3
"KRN",.404,20,40,7,1)
224
"KRN",.404,20,40,7,2)
10,3^72^9,3^1
"KRN",.404,21,0)
XPD EDIT BUILD11^9.6
"KRN",.404,21,40,0)
^.4044I^5^5
"KRN",.404,21,40,1,0)
1^4^1^
"KRN",.404,21,40,1,2)
^^1,71^
"KRN",.404,21,40,2,0)
7^Package File Link...^3
"KRN",.404,21,40,2,1)
1
"KRN",.404,21,40,2,2)
15,27^30^15,5
"KRN",.404,21,40,2,10)
S:X]"" DDSSTACK=8
"KRN",.404,21,40,3,0)
8^Track Package Nationally^3
"KRN",.404,21,40,3,1)
5
"KRN",.404,21,40,3,2)
17,27^3^17,1
"KRN",.404,21,40,3,3)
NO
"KRN",.404,21,40,3,11)
S:$$GET^DDSVAL(DIE,.DA,1)="" DDSBR="^^COM"
"KRN",.404,21,40,4,0)
2^Install Questions^1^
"KRN",.404,21,40,4,2)
^^4,28^1
"KRN",.404,21,40,5,0)
5^Required Builds^1
"KRN",.404,21,40,5,2)
^^9,28
"KRN",.404,22,0)
XPD EDIT BUILD12^9.62
"KRN",.404,22,40,0)
^.4044I^1^1
"KRN",.404,22,40,1,0)
1^^3
"KRN",.404,22,40,1,1)
.01
"KRN",.404,22,40,1,2)
1,3^30
"KRN",.404,22,40,1,10)
S DDSSTACK=15
"KRN",.404,23,0)
XPD EDIT BUILD60^9.6
"KRN",.404,23,40,0)
^.4044I^3^3
"KRN",.404,23,40,1,0)
1^ Edit PACKAGE File ^1^
"KRN",.404,23,40,1,2)
^^1,26^1
"KRN",.404,23,40,2,0)
2^Name^3
"KRN",.404,23,40,2,1)
.01
"KRN",.404,23,40,2,2)
2,8^30^2,2
"KRN",.404,23,40,3,0)
3^!M^1^
"KRN",.404,23,40,3,.1)
S $P(Y,"-",76)=""
"KRN",.404,23,40,3,2)
^^3,1^
"KRN",.404,24,0)
XPD EDIT BUILD9A^9.66
"KRN",.404,24,40,0)
^.4044I^1^1
"KRN",.404,24,40,1,0)
1^^3
"KRN",.404,24,40,1,1)
.01
"KRN",.404,24,40,1,2)
2,2^4
"KRN",.404,24,40,1,10)
S DDSSTACK=10
"KRN",.404,25,0)
XPD EDIT BUILD10A^9.661
"KRN",.404,25,40,0)
^.4044I^1^1
"KRN",.404,25,40,1,0)
1^^3
"KRN",.404,25,40,1,1)
.01
"KRN",.404,25,40,1,2)
1,2^4
"KRN",.404,65,0)
XPD EDIT BUILD52^9.611
"KRN",.404,65,40,0)
^.4044I^2^2
"KRN",.404,65,40,1,0)
2^^3
"KRN",.404,65,40,1,1)
.01
"KRN",.404,65,40,1,2)
1,3^40
"KRN",.404,65,40,2,0)
3^^3
"KRN",.404,65,40,2,1)
1
"KRN",.404,65,40,2,2)
1,49^30
"KRN",.404,65,40,2,4)
1
"KRN",.404,218,0)
XPD EDIT BUILD5D^9.6
"KRN",.404,218,40,0)
^.4044I^5^5
"KRN",.404,218,40,1,0)
1^Rebuild Menu Tree Upon Completion^3^^XPO1
"KRN",.404,218,40,1,1)
51.09
"KRN",.404,218,40,1,2)
6,36^3^6,1
"KRN",.404,218,40,2,0)
2^Want KIDS to INHIBIT LOGONs^3^^XPI1
"KRN",.404,218,40,2,1)
51.05
"KRN",.404,218,40,2,2)
8,36^3^8,7
"KRN",.404,218,40,3,0)
3^Want to DISABLE Scheduled Options^3^^XPZ1
"KRN",.404,218,40,3,1)
51.11
"KRN",.404,218,40,3,2)
10,36^3^10,1
"KRN",.404,218,40,4,0)
4^Change the 'NO' defaults the sites will see when KIDS asks these questions!^1
"KRN",.404,218,40,4,2)
^^4,3
"KRN",.404,218,40,5,0)
5^5^1
"KRN",.404,218,40,5,2)
^^1,71
"MBREQ")
0
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^3080616^3080616^6
"PKG",3,22,1,"PAH",1,0)
511^3081028
"PKG",3,22,1,"PAH",1,1,0)
^^3^3^3081028
"PKG",3,22,1,"PAH",1,1,1,0)
Please see the patch description on FORUM, in the National
"PKG",3,22,1,"PAH",1,1,2,0)
 Patch Module.
"PKG",3,22,1,"PAH",1,1,3,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","XPDDCS")
0^5^B18646094^B17950481
"RTN","XPDDCS",1,0)
XPDDCS ;SFISC/RSD - Display Checksum for a package ;05/05/2008
"RTN","XPDDCS",2,0)
 ;;8.0;KERNEL;**2,44,108,202,393,511**;Jul 10, 1995;Build 5
"RTN","XPDDCS",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XPDDCS",4,0)
 Q
"RTN","XPDDCS",5,0)
EN1 ;Verify checksums in Transport Global
"RTN","XPDDCS",6,0)
 N D0,DIC,X,XPD,XPDS,XPDST,XPDT,Y,Z
"RTN","XPDDCS",7,0)
 ;S DIC="^XPD(9.7,",DIC(0)="AEQMZ",DIC("S")="I $D(^XTMP(""XPDI"",Y))"
"RTN","XPDDCS",8,0)
 ;D ^DIC Q:Y<0
"RTN","XPDDCS",9,0)
 S XPDS="I $D(^XTMP(""XPDI"",Y))"
"RTN","XPDDCS",10,0)
 S XPDST=$$LOOK^XPDI1(XPDS) Q:XPDST'>0
"RTN","XPDDCS",11,0)
 S XPDSHW=$$ASK Q:$D(DIRUT)
"RTN","XPDDCS",12,0)
 S XPD("XPDT(")="",XPD("XPDST")="",XPD("XPDSHW")="",X="XUTMDEVQ"
"RTN","XPDDCS",13,0)
 ;during Virgin install, XUTMDEVQ might not exists
"RTN","XPDDCS",14,0)
 X ^%ZOSF("TEST") E  D  Q
"RTN","XPDDCS",15,0)
 .S IOSL=99999,IOM=80,IOF="#",IOST="",$Y=0 D LST1(9.7)
"RTN","XPDDCS",16,0)
 S Y="LST1^XPDDCS(9.7)",Z="Checksum Print"
"RTN","XPDDCS",17,0)
 ;p345-rename AND* to XPD* - Patch was Cancelled keep code for future.
"RTN","XPDDCS",18,0)
 I '$G(XPDAUTO) D EN^XUTMDEVQ(Y,Z,.XPD)
"RTN","XPDDCS",19,0)
 I $G(XPDAUTO) S IO=XPDDEV U XPDDEV D LST1^XPDDCS(9.7)
"RTN","XPDDCS",20,0)
 Q
"RTN","XPDDCS",21,0)
 ;
"RTN","XPDDCS",22,0)
ASK() ;Ask if want each routine listed
"RTN","XPDDCS",23,0)
 N DIR
"RTN","XPDDCS",24,0)
 I $D(XPDAUTO) Q 1
"RTN","XPDDCS",25,0)
 S DIR(0)="YAO",DIR("A")="Want each Routine Listed with Checksums: ",DIR("A",1)="",DIR("B")="Yes"
"RTN","XPDDCS",26,0)
 D ^DIR
"RTN","XPDDCS",27,0)
 Q Y
"RTN","XPDDCS",28,0)
 ;
"RTN","XPDDCS",29,0)
EN2 ;print from build (system)
"RTN","XPDDCS",30,0)
 N D0,DIC,XPD,XPDT,XPDST,Y,Z
"RTN","XPDDCS",31,0)
 ;S DIC="^XPD(9.6,",DIC(0)="AEQMZ"
"RTN","XPDDCS",32,0)
 ;D ^DIC Q:Y<0
"RTN","XPDDCS",33,0)
 S XPDST=$$LOOK^XPDB1() Q:XPDST'>0
"RTN","XPDDCS",34,0)
 S XPDSHW=$$ASK Q:$D(DIRUT)
"RTN","XPDDCS",35,0)
 S XPD("XPDT(")="",XPD("XPDSHW")="",Y="LST1^XPDDCS(9.6)",Z="Checksum Print"
"RTN","XPDDCS",36,0)
 ;p345-rename AND* to XPD*- Patch was Cancelled keep code for future.
"RTN","XPDDCS",37,0)
 I '$G(XPDAUTO) D EN^XUTMDEVQ(Y,Z,.XPD)
"RTN","XPDDCS",38,0)
 I $G(XPDAUTO) S:'$D(XPDDEV) XPDDEV=0 U XPDDEV D LST1^XPDDCS(9.6)
"RTN","XPDDCS",39,0)
 Q
"RTN","XPDDCS",40,0)
 ;
"RTN","XPDDCS",41,0)
LST1(FILE) ;Print group
"RTN","XPDDCS",42,0)
 N XPDI S XPDI=0
"RTN","XPDDCS",43,0)
 F  S XPDI=$O(XPDT(XPDI)) Q:XPDI'>0  S D0=+XPDT(XPDI) D PNT(FILE)
"RTN","XPDDCS",44,0)
 Q
"RTN","XPDDCS",45,0)
 ;
"RTN","XPDDCS",46,0)
PNT(XPDFIL) ;print
"RTN","XPDDCS",47,0)
 N XPD0,XPDC,XPDDT,XPDE,XPDI,XPDJ,XPDPG,XPDQ,XPDUL,X
"RTN","XPDDCS",48,0)
 Q:'$D(^XPD(XPDFIL,D0,0))  S XPD0=^(0),XPDPG=1,$P(XPDUL,"-",IOM)="",XPDDT=$$HTE^XLFDT($H,"1PM")
"RTN","XPDDCS",49,0)
 W:$E(IOST,1,2)="C-" @IOF D HDR
"RTN","XPDDCS",50,0)
 W !
"RTN","XPDDCS",51,0)
 S XPDI="",(XPDQ,XPDE)=0
"RTN","XPDDCS",52,0)
 ;XPDFIL=9.7  use transport global exists
"RTN","XPDDCS",53,0)
 I XPDFIL=9.7 D
"RTN","XPDDCS",54,0)
 .I '$D(^XTMP("XPDI",D0)) W !!," ** Transport Global doesn't exist **" S XPDQ=1 Q
"RTN","XPDDCS",55,0)
 .;check for missing nodes in transport global
"RTN","XPDDCS",56,0)
 .I '$D(^XTMP("XPDI",D0,"BLD"))="" W !!," **Transport Global corrupted, please reload **" S XPDQ=1 Q
"RTN","XPDDCS",57,0)
 .F XPDC=0:1 S XPDI=$O(^XTMP("XPDI",D0,"RTN",XPDI)) Q:XPDI=""  S XPDJ=$G(^(XPDI)) D  Q:XPDQ
"RTN","XPDDCS",58,0)
 ..I XPDJ="" W !," **Transport Global corrupted, please reload **" S XPDQ=1 Q
"RTN","XPDDCS",59,0)
 ..;if deleting at site, there is no checksum
"RTN","XPDDCS",60,0)
 ..I +XPDJ=1 S XPDC=XPDC-1 Q
"RTN","XPDDCS",61,0)
 ..D SUM(XPDI,$NA(^XTMP("XPDI",D0,"RTN",XPDI)),$P(XPDJ,U,3),$P(XPDJ,U,4))
"RTN","XPDDCS",62,0)
 ..S XPDQ=$$CHK(4)
"RTN","XPDDCS",63,0)
 ;check build file
"RTN","XPDDCS",64,0)
 E  D
"RTN","XPDDCS",65,0)
 .F XPDC=0:1 S XPDI=$O(^XPD(9.6,D0,"KRN",9.8,"NM","B",XPDI)) Q:XPDI=""  S XPDJ=$O(^(XPDI,0)) D  Q:XPDQ
"RTN","XPDDCS",66,0)
 ..Q:'$D(^XPD(9.6,D0,"KRN",9.8,"NM",+XPDJ,0))  S XPDJ=$P(^(0),U,4)
"RTN","XPDDCS",67,0)
 ..;quit if no checksum, routine wasn't loaded
"RTN","XPDDCS",68,0)
 ..I XPDJ="" S XPDC=XPDC-1 Q
"RTN","XPDDCS",69,0)
 ..N DIF,XCNP,%N
"RTN","XPDDCS",70,0)
 ..S X=XPDI,DIF="^TMP($J,""RTN"",XPDI,",XCNP=0
"RTN","XPDDCS",71,0)
 ..X ^%ZOSF("TEST") E  W !,XPDI,?10,"Doesn't Exist" Q
"RTN","XPDDCS",72,0)
 ..X ^%ZOSF("LOAD")
"RTN","XPDDCS",73,0)
 ..D SUM(XPDI,$NA(^TMP($J,"RTN",XPDI)),XPDJ,"")
"RTN","XPDDCS",74,0)
 ..S XPDQ=$$CHK(4)
"RTN","XPDDCS",75,0)
 Q:XPDQ
"RTN","XPDDCS",76,0)
 W !!?3,XPDC," Routine"_$S(XPDC>1:"s",1:"")_" checked, ",XPDE," failed.",!
"RTN","XPDDCS",77,0)
 ;p345-rename AND* to XPD*-Patch was Cancelled keep code for future.
"RTN","XPDDCS",78,0)
 I $G(XPDAUTO) S XPDCHKSM=XPDE
"RTN","XPDDCS",79,0)
 Q
"RTN","XPDDCS",80,0)
 ;
"RTN","XPDDCS",81,0)
 ;XPDR=routine name, Z=global root, XPD=check sum, XPDBS=before Checksum from FORUM
"RTN","XPDDCS",82,0)
SUM(XPDR,Z,XPD,XPDBS) ;check checksum
"RTN","XPDDCS",83,0)
 N Y
"RTN","XPDDCS",84,0)
 ;See if we have a before checksum and compare.
"RTN","XPDDCS",85,0)
 I $L(XPDBS) D BEFORE(XPDR,XPDBS)
"RTN","XPDDCS",86,0)
 ;first char. is the sum tag used in XPDRSUM
"RTN","XPDDCS",87,0)
 I XPD'?1U1.N W !,XPDR,?10,"ERROR in Checksum" S XPDE=XPDE+1 Q
"RTN","XPDDCS",88,0)
 S @("Y=$$SUM"_$E(XPD)_"^XPDRSUM(Z)"),XPD=$E(XPD,2,255)
"RTN","XPDDCS",89,0)
 I Y=XPD,XPDSHW W !,XPDR,?10,"Calculated "_$J(XPD,10)
"RTN","XPDDCS",90,0)
 I Y'=XPD W !,XPDR,?10,"Calculated "_$C(7)_$J(Y,10)_", expected value "_XPD S XPDE=XPDE+1
"RTN","XPDDCS",91,0)
 Q
"RTN","XPDDCS",92,0)
 ;
"RTN","XPDDCS",93,0)
BEFORE(RN,SUM) ;Check a before Checksum
"RTN","XPDDCS",94,0)
 N DIF,XCNP,%N,X
"RTN","XPDDCS",95,0)
 I SUM'?1U1.N Q
"RTN","XPDDCS",96,0)
 K ^TMP($J,"XPDDCS",RN) ;patch 511
"RTN","XPDDCS",97,0)
 S X=RN,DIF="^TMP($J,""XPDDCS"",RN,",XCNP=0
"RTN","XPDDCS",98,0)
 X ^%ZOSF("TEST") E  W !,RN,?10,"Not on current system." Q
"RTN","XPDDCS",99,0)
 X ^%ZOSF("LOAD")
"RTN","XPDDCS",100,0)
 S DIF=$NA(^TMP($J,"XPDDCS",RN))
"RTN","XPDDCS",101,0)
 S @("Y=$$SUM"_$E(SUM)_"^XPDRSUM(DIF)"),SUM=$E(SUM,2,255)
"RTN","XPDDCS",102,0)
 I Y'=SUM W !,RN,?10,"Before Checksum Calculated "_Y_" expected value "_SUM
"RTN","XPDDCS",103,0)
 Q
"RTN","XPDDCS",104,0)
 ;
"RTN","XPDDCS",105,0)
CHK(Y) ;Y=excess lines, return 1 to exit
"RTN","XPDDCS",106,0)
 Q:$Y<(IOSL-Y) 0
"RTN","XPDDCS",107,0)
 I $E(IOST,1,2)="C-" D  Q:'Y 1
"RTN","XPDDCS",108,0)
 .N DIR,I,J,K,X
"RTN","XPDDCS",109,0)
 .S DIR(0)="E" D ^DIR
"RTN","XPDDCS",110,0)
 S XPDPG=XPDPG+1
"RTN","XPDDCS",111,0)
 W @IOF D HDR
"RTN","XPDDCS",112,0)
 Q 0
"RTN","XPDDCS",113,0)
 ;
"RTN","XPDDCS",114,0)
HDR W !,"PACKAGE: ",$P(XPD0,U),"     ",XPDDT,?70,"PAGE ",XPDPG,!,XPDUL,!
"RTN","XPDDCS",115,0)
 Q
"RTN","XPDT")
0^3^B79741055^B73091341
"RTN","XPDT",1,0)
XPDT ;SFISC/RSD - Transport a package ;10/15/2008
"RTN","XPDT",2,0)
 ;;8.0;KERNEL;**2,10,28,41,44,51,58,66,68,85,100,108,393,511**;Jul 10, 1995;Build 5
"RTN","XPDT",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XPDT",4,0)
EN ;build XTMP("XPDT",ien, XPDA=ien,XPDNM=name
"RTN","XPDT",5,0)
 ;XPDT(seq #)=ien^name^1=use current transport global on system
"RTN","XPDT",6,0)
 ;XPDT("DA",ien)=seq #
"RTN","XPDT",7,0)
 ;XPDVER=version number^package name
"RTN","XPDT",8,0)
 ;XPDGP=flag;global^flag;global^...  flag=1 replace global at site
"RTN","XPDT",9,0)
 N DIR,DIRUT,I,POP,XPD,XPDA,XPDERR,XPDGP,XPDGREF,XPDH,XPDH1,XPDHD,XPDI,XPDNM,XPDSEQ,XPDSIZ,XPDSIZA,XPDT,XPDTP,XPDVER
"RTN","XPDT",10,0)
 N XPDFMSG,X,Y,Z
"RTN","XPDT",11,0)
 K ^TMP($J,"XPD")
"RTN","XPDT",12,0)
 S XPD="First Package Name: ",DIR(0)="Y",DIR("A")="   Use this Transport Global",DIR("?")="Yes, will use the current Transport Global on your system. No, will create a new one.",XPDT=0
"RTN","XPDT",13,0)
 W !!,"Enter the Package Names to be transported. The order in which",!,"they are entered will be the order in which they are installed.",!!
"RTN","XPDT",14,0)
 F  S XPDA=$$DIC^XPDE("AEMQZ",XPD) Q:'XPDA  D  Q:$D(DIRUT)!$D(XPDERR)
"RTN","XPDT",15,0)
 .S:'XPDT XPD="Another Package Name: "
"RTN","XPDT",16,0)
 .;XPDI=name^1=use current transport global
"RTN","XPDT",17,0)
 .S XPDI=$P(Y(0),U)_"^"
"RTN","XPDT",18,0)
 .I $D(XPDT("DA",XPDA)) W "   ",$P(Y(0),U)," already listed",! Q
"RTN","XPDT",19,0)
 .;if type is Global Package, set DIRUT if there is other packages
"RTN","XPDT",20,0)
 .I $P(Y(0),U,3)=2 W "   GLOBAL PACKAGE" D  Q
"RTN","XPDT",21,0)
 ..;if there is already a package in distribution, abort
"RTN","XPDT",22,0)
 ..I XPDT S DIRUT=1 W !,"A GLOBAL PACKAGE cannot be sent with any other packages" Q
"RTN","XPDT",23,0)
 ..I $D(^XTMP("XPDT",XPDA)) W "  **Cannot have a pre-existing Transport Global**" S DIRUT=1 Q
"RTN","XPDT",24,0)
 ..W !?10,"will transport the following globals:",! S X=0,XPDGP=""
"RTN","XPDT",25,0)
 ..F  S X=$O(^XPD(9.6,XPDA,"GLO",X)) Q:'X  S Z=$G(^(X,0)) I $P(Z,U)]"" S XPDGP=XPDGP_($P(Z,U,2)="y")_";"_$P(Z,U)_"^" W ?12,$P(Z,U),!
"RTN","XPDT",26,0)
 ..;XPDERR is set to quit loop, so no other packages can be added
"RTN","XPDT",27,0)
 ..S XPDERR=1,XPDT=XPDT+1,XPDT(XPDT)=XPDA_U_XPDI,XPDT("DA",XPDA)=XPDT
"RTN","XPDT",28,0)
 .Q:$D(XPDERR)
"RTN","XPDT",29,0)
 .D PCK(XPDA,XPDI)
"RTN","XPDT",30,0)
 .;multi-package
"RTN","XPDT",31,0)
 .Q:$P(Y(0),U,3)'=1
"RTN","XPDT",32,0)
 .W "   (Multi-Package)" S X=0
"RTN","XPDT",33,0)
 .I XPDT>1 S DIRUT=1 W !,"A Master Build must be the first/only package in a transport" Q
"RTN","XPDT",34,0)
 .F  S X=$O(^XPD(9.6,XPDA,10,X)) Q:'X  S Z=$P($G(^(X,0)),U),Z1=$P($G(^(0)),U,2) D:Z]""
"RTN","XPDT",35,0)
 ..N XPDA,X
"RTN","XPDT",36,0)
 ..W !?3,Z S XPDA=$O(^XPD(9.6,"B",Z,0))
"RTN","XPDT",37,0)
 ..I 'XPDA W "  **Can't find definition in Build file**" Q
"RTN","XPDT",38,0)
 ..I $D(XPDT("DA",XPDA)) W "  already listed" Q
"RTN","XPDT",39,0)
 ..D PCK(XPDA,Z,Z1)
"RTN","XPDT",40,0)
 .S XPDERR=1 ;XPDERR is set to quit loop, so no other packages can be added
"RTN","XPDT",41,0)
 .Q
"RTN","XPDT",42,0)
 G:'XPDT!$D(DIRUT) QUIT K XPDERR
"RTN","XPDT",43,0)
 W !!,"ORDER   PACKAGE",!
"RTN","XPDT",44,0)
 F XPDT=1:1:XPDT S Y=$P(XPDT(XPDT),U,2) W ?2,XPDT,?7,Y D  W !
"RTN","XPDT",45,0)
 .W:$P(XPDT(XPDT),U,3) "     **will use current Transport Global**"
"RTN","XPDT",46,0)
 .;check if New Version and single package, has Package File Link, Package App. History
"RTN","XPDT",47,0)
 .Q:Y["*"!'$$PAH(+XPDT(XPDT))
"RTN","XPDT",48,0)
 .S DIR(0)="Y",DIR("A")="Send the PATCH APPLICATION HISTORY from the PACKAGE file",DIR("B")="YES"
"RTN","XPDT",49,0)
 .W !! D ^DIR I 'Y S $P(XPDT(XPDT),U,5)=1
"RTN","XPDT",50,0)
 S DIR(0)="Y",DIR("A")="OK to continue",DIR("B")="YES",XPDH=""
"RTN","XPDT",51,0)
 W !! D ^DIR G:$D(DIRUT)!'Y QUIT K DIR
"RTN","XPDT",52,0)
 I $G(XPDTP),XPDT>1 W !!,"You cannot send multiple Builds through PackMan."
"RTN","XPDT",53,0)
 S DIR(0)="SAO^HF:Host File"_$S(XPDT=1:";PM:PackMan",1:"")
"RTN","XPDT",54,0)
 S DIR("A")="Transport through (HF)Host File"_$S(XPDT=1:" or (PM)PackMan: ",1:": ")
"RTN","XPDT",55,0)
 S DIR("?")="Enter the method of transport for the package(s)."
"RTN","XPDT",56,0)
 D ^DIR G:$D(DTOUT)!$D(DUOUT) QUIT K DIR
"RTN","XPDT",57,0)
 I Y="" W !,"No Transport Method selected, will only write Transport Global to ^XTMP." S XPDH=""
"RTN","XPDT",58,0)
 ;XPDTP = transports using Packman
"RTN","XPDT",59,0)
 S:Y="PM" XPDTP=1
"RTN","XPDT",60,0)
 I $D(XPDGP),Y'="HF" W !,"**Global Package can only be sent with a Host File, Transport ABORTED**" Q
"RTN","XPDT",61,0)
 I Y="HF" D DEV G:POP QUIT
"RTN","XPDT",62,0)
 W !!
"RTN","XPDT",63,0)
 F XPDT=1:1:XPDT S XPDA=XPDT(XPDT),XPDNM=$P(XPDA,U,2) D  G:$D(XPDERR) ABORT
"RTN","XPDT",64,0)
 .W !?5,XPDNM,"..." S XPDGREF="^XTMP(""XPDT"","_+XPDA_",""TEMP"")"
"RTN","XPDT",65,0)
 .;if using current transport global, run pre-transp routine and quit
"RTN","XPDT",66,0)
 .I $P(XPDA,U,3) S XPDA=+XPDA D PRET Q
"RTN","XPDT",67,0)
 .;if package file link then set XPDVER=version number^package name
"RTN","XPDT",68,0)
 .S XPDA=+XPDA,XPDVER=$S($P(^XPD(9.6,XPDA,0),U,2):$$VER^XPDUTL(XPDNM)_U_$$PKG^XPDUTL(XPDNM),1:"")
"RTN","XPDT",69,0)
 .;Inc the Build number
"RTN","XPDT",70,0)
 .S $P(^XPD(9.6,XPDA,6.3),U)=$G(^XPD(9.6,XPDA,6.3))+1
"RTN","XPDT",71,0)
 .K ^XTMP("XPDT",XPDA)
"RTN","XPDT",72,0)
 .;GLOBAL PACKAGE
"RTN","XPDT",73,0)
 .I $D(XPDGP) D  S XPDT=1 Q
"RTN","XPDT",74,0)
 ..;can't send global package in packman message
"RTN","XPDT",75,0)
 ..I $G(XPDTP) S XPDERR=1 Q
"RTN","XPDT",76,0)
 ..;verify global package
"RTN","XPDT",77,0)
 ..I '$$GLOPKG^XPDV(XPDA) S XPDERR=1 Q
"RTN","XPDT",78,0)
 ..;get Environment check and Post Install routines
"RTN","XPDT",79,0)
 ..F Y="PRE","INIT" I $G(^XPD(9.6,XPDA,Y))]"" S X=^(Y) D
"RTN","XPDT",80,0)
 ...S ^XTMP("XPDT",XPDA,Y)=X,X=$P(X,U,$L(X,U)),%=$$LOAD^XPDTA(X,"0^")
"RTN","XPDT",81,0)
 ..D BLD^XPDTC,PRET
"RTN","XPDT",82,0)
 .F X="DD^XPDTC","KRN^XPDTC","QUES^XPDTC","INT^XPDTC","BLD^XPDTC" D @X Q:$D(XPDERR)
"RTN","XPDT",83,0)
 .D:'$D(XPDERR) PRET
"RTN","XPDT",84,0)
 ;XPDTP - call ^XPDTP to build Packman message
"RTN","XPDT",85,0)
 I $G(XPDTP) S XPDA=+XPDT(XPDT) D ^XPDTP G QUIT
"RTN","XPDT",86,0)
 I $L(XPDH) D GO G QUIT
"RTN","XPDT",87,0)
 ;if no device then just create transport global
"RTN","XPDT",88,0)
 W !! F XPDT=1:1:XPDT W "Transport Global ^XTMP(""XPDT"","_+XPDT(XPDT)_") created for ",$P(XPDT(XPDT),U,2),!
"RTN","XPDT",89,0)
 Q
"RTN","XPDT",90,0)
DEV N FIL,DIR,IOP,X,Y,%ZIS W !
"RTN","XPDT",91,0)
 D HOME^%ZIS
"RTN","XPDT",92,0)
 S DIR(0)="F^3:245",DIR("A")="Enter a Host File",DIR("?")="Enter a filename and/or path to output package(s).",POP=0
"RTN","XPDT",93,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S POP=1 Q
"RTN","XPDT",94,0)
 ;if no file, then quit
"RTN","XPDT",95,0)
 Q:Y=""  S FIL=Y
"RTN","XPDT",96,0)
 S DIR(0)="F^3:80",DIR("A")="Header Comment",DIR("?")="Enter a comment between 3 and 80 charaters."
"RTN","XPDT",97,0)
 D ^DIR I $D(DIRUT) S POP=1 Q
"RTN","XPDT",98,0)
 S XPDH=Y,%ZIS="",%ZIS("HFSNAME")=FIL,%ZIS("HFSMODE")="W",IOP="HFS",(XPDSIZ,XPDSIZA)=0,XPDSEQ=1
"RTN","XPDT",99,0)
 D ^%ZIS I POP W !!,"**Incorrect Host File name**",!,$C(7) Q
"RTN","XPDT",100,0)
 ;write date and comment header
"RTN","XPDT",101,0)
 S XPDHD="KIDS Distribution saved on "_$$HTE^XLFDT($H)
"RTN","XPDT",102,0)
 U IO W $$SUM(XPDHD),!,$$SUM(XPDH),!
"RTN","XPDT",103,0)
 S XPDFMSG=1 ;Send mail to forum of routines in HFS.
"RTN","XPDT",104,0)
 ;U IO(0) is to insure I am writing to the terminal
"RTN","XPDT",105,0)
 U IO(0) Q
"RTN","XPDT",106,0)
 ;
"RTN","XPDT",107,0)
GO S I=1,Y="",XPDH1="**KIDS**:" U IO
"RTN","XPDT",108,0)
 ;Global Package, header is different and there is only 1 package
"RTN","XPDT",109,0)
 I $D(XPDGP) W $$SUM("**KIDS**GLOBALS:"_$P(XPDT(1),U,2)_U_XPDGP),! G GO1
"RTN","XPDT",110,0)
 ;write header that maintains package list, keep less than 255 char
"RTN","XPDT",111,0)
 F  D  W $$SUM(XPDH1_Y),! Q:I=XPDT  S Y="",I=I+1,XPDH1="**KIDS**"
"RTN","XPDT",112,0)
 .F I=I:1 S Y=Y_$P(XPDT(I),U,2)_"^" Q:$L(Y)>200!(I=XPDT)
"RTN","XPDT",113,0)
 ;after the package list write an extra line feed
"RTN","XPDT",114,0)
GO1 W ! S XPDSIZA=XPDSIZA+2
"RTN","XPDT",115,0)
 N XMSUB,XMY,XMTEXT
"RTN","XPDT",116,0)
 ;loop thru & write global, don't kill if set to permanent, set in XPDIU
"RTN","XPDT",117,0)
 F XPDT=1:1:XPDT S XPDA=+XPDT(XPDT),XPDNM=$P(XPDT(XPDT),U,2) D GW,XM K:'$G(^XTMP("XPDT",XPDA)) ^(XPDA)
"RTN","XPDT",118,0)
 W "**END**",!
"RTN","XPDT",119,0)
 ;GLOBAL PACKAGE there could only be one package, write globals
"RTN","XPDT",120,0)
 I $D(XPDGP) D GPW W "**END**",!
"RTN","XPDT",121,0)
 ;we're done with device, close it
"RTN","XPDT",122,0)
 W "**END**",! D ^%ZISC
"RTN","XPDT",123,0)
 W !!,"Package Transported Successfully",!
"RTN","XPDT",124,0)
 Q
"RTN","XPDT",125,0)
GW ;global write
"RTN","XPDT",126,0)
 N GR,GCK,GL
"RTN","XPDT",127,0)
 S GCK="^XTMP(""XPDT"","_XPDA,GR=GCK_")",GCK=GCK_",",GL=$L(GCK)
"RTN","XPDT",128,0)
 ;INSTALL NAME line will mark the begining of global for all lines until
"RTN","XPDT",129,0)
 ;the next INSTALL NAME
"RTN","XPDT",130,0)
 W $$SUM("**INSTALL NAME**",1),!,$$SUM(XPDNM),!
"RTN","XPDT",131,0)
 F  Q:$D(DIRUT)  S GR=$Q(@GR) Q:GR=""!($E(GR,1,GL)'=GCK)  W $$SUM($P(GR,GCK,2),1),!,$$SUM(@GR),!
"RTN","XPDT",132,0)
 Q
"RTN","XPDT",133,0)
XM ;Send HFS checksum message
"RTN","XPDT",134,0)
 Q:'$G(XPDFMSG)
"RTN","XPDT",135,0)
 N XMTEXT,C,RN,X,X2
"RTN","XPDT",136,0)
 K ^TMP($J)
"RTN","XPDT",137,0)
 S XMSUB="**KIDS** Checksum for "_XPDNM,XMTEXT="^TMP($J)"
"RTN","XPDT",138,0)
 I $G(^XMB("NETNAME"))["VA.GOV" S XMY("S.A1AE HFS CHKSUM SVR@FORUM.VA.GOV")=""
"RTN","XPDT",139,0)
 E  S X=$$GET^XPAR("PKG","XPD PATCH HFS SERVER",1,"Q") S:$L(X) XMY(X)=""
"RTN","XPDT",140,0)
 I '$D(XMY) Q  ;No one to send it to.
"RTN","XPDT",141,0)
 S C=1,@XMTEXT@(1,0)="~~1:"_XPDNM
"RTN","XPDT",142,0)
 I XPDT=1,$O(XPDT(1)) D
"RTN","XPDT",143,0)
 . S RN=1 F  S RN=$O(XPDT(RN)) Q:'RN  S C=C+1,@XMTEXT@(C,0)="~~2:"_$P(XPDT(RN),"^",2)
"RTN","XPDT",144,0)
 S RN="" ;Send full RTN node
"RTN","XPDT",145,0)
 F  S RN=$O(^XTMP("XPDT",XPDA,"RTN",RN)) Q:'$L(RN)  S X=^(RN),X2=$G(^(RN,2,0)),C=C+1,@XMTEXT@(C,0)="~~3:"_RN_"^"_X_"^"_$P(X2,";",5)
"RTN","XPDT",146,0)
 S C=C+1,@XMTEXT@(C,0)="~~8:"_$G(^XMB("NETNAME"))
"RTN","XPDT",147,0)
 S C=C+1,@XMTEXT@(C,0)="~~9:Save"
"RTN","XPDT",148,0)
 S XMTEXT="^TMP($J,"
"RTN","XPDT",149,0)
 D ^XMD
"RTN","XPDT",150,0)
 Q
"RTN","XPDT",151,0)
GPW ;global package write
"RTN","XPDT",152,0)
 N I,G,GR,GCK,GL
"RTN","XPDT",153,0)
 W !
"RTN","XPDT",154,0)
 F I=1:1 S G=$P(XPDGP,U,I) Q:G=""  D
"RTN","XPDT",155,0)
 .S GR="^"_$P(G,";",2),GCK=$S(GR[")":$E(GR,1,$L(GR)-1)_",",1:GR_"("),GL=$L(GCK)
"RTN","XPDT",156,0)
 .;GLOBAL line will mark the begining of global for all lines until
"RTN","XPDT",157,0)
 .;the next GLOBAL
"RTN","XPDT",158,0)
 .W $$SUM("**GLOBAL**",1),!,$$SUM(GR),!
"RTN","XPDT",159,0)
 .F  Q:$D(DIRUT)  S GR=$Q(@GR) Q:GR=""!($E(GR,1,GL)'=GCK)  W $$SUM($P(GR,GCK,2),1),!,$$SUM(@GR),!
"RTN","XPDT",160,0)
 Q
"RTN","XPDT",161,0)
QUIT F XPDT=1:1:XPDT L -^XPD(9.6,+XPDT(XPDT))
"RTN","XPDT",162,0)
 Q
"RTN","XPDT",163,0)
ABORT W !!,"**TRANSPORT ABORTED**",*7
"RTN","XPDT",164,0)
 D QUIT
"RTN","XPDT",165,0)
 F XPDT=1:1:XPDT K ^XTMP("XPDT",+XPDT(XPDT))
"RTN","XPDT",166,0)
 D ^%ZISC
"RTN","XPDT",167,0)
 Q
"RTN","XPDT",168,0)
 ;
"RTN","XPDT",169,0)
PCK(XPDA,XPDNM,XPDREQ) ;XPDA=Build ien, XPDNM=Build name, XPDREQ=Required
"RTN","XPDT",170,0)
 N Y
"RTN","XPDT",171,0)
 S XPDT=XPDT+1,XPDT(XPDT)=XPDA_U_XPDNM,XPDT("DA",XPDA)=XPDT
"RTN","XPDT",172,0)
 S:'$G(XPDREQ) XPDREQ=0
"RTN","XPDT",173,0)
 S $P(XPDT(XPDT),U,4)=XPDREQ
"RTN","XPDT",174,0)
 Q:'$D(^XTMP("XPDT",XPDA))  S Y=$G(^(XPDA))
"RTN","XPDT",175,0)
 W "     **Transport Global exists**"
"RTN","XPDT",176,0)
 ;Y=1 if TG is permanet
"RTN","XPDT",177,0)
 I Y S $P(XPDT(XPDT),U,3)=1 Q
"RTN","XPDT",178,0)
 ;ask if they want to use TG
"RTN","XPDT",179,0)
 D ^DIR S $P(XPDT(XPDT),U,3)=Y
"RTN","XPDT",180,0)
 Q
"RTN","XPDT",181,0)
 ;
"RTN","XPDT",182,0)
SUM(X,Z) ;X=string to write, Z 0=don't check size
"RTN","XPDT",183,0)
 S XPDSIZA=XPDSIZA+$L(X)+2
"RTN","XPDT",184,0)
 Q X
"RTN","XPDT",185,0)
 ;
"RTN","XPDT",186,0)
PAH(XPDA) ;check for PATCH APPLICATION HISTORY in Package file
"RTN","XPDT",187,0)
 N Y,Z
"RTN","XPDT",188,0)
 S Y=^XPD(9.6,XPDA,0),Z=$$VER^XPDUTL($P(Y,U))
"RTN","XPDT",189,0)
 ;Single Package, Version multiple, PAH multiple
"RTN","XPDT",190,0)
 I $P(Y,U,3)=0,$D(^DIC(9.4,+$P(Y,U,2),22)),Z S Z=$O(^(22,"B",Z,0)) I Z,$O(^DIC(9.4,+$P(Y,U,2),22,Z,"PAH",0)) Q 1
"RTN","XPDT",191,0)
 Q 0
"RTN","XPDT",192,0)
 ;
"RTN","XPDT",193,0)
PRET ;Pre-Transport Routine
"RTN","XPDT",194,0)
 N Y,Z
"RTN","XPDT",195,0)
 S Y=$G(^XPD(9.6,XPDA,"PRET")) Q:Y=""
"RTN","XPDT",196,0)
 I '$$RTN^XPDV(Y,.Z) W !!,"Pre-Transportation Routine ",Y,Z,*7 Q
"RTN","XPDT",197,0)
 S Y=$S(Y["^":Y,1:"^"_Y) W !,"Running Pre-Transportation Routine ",Y
"RTN","XPDT",198,0)
 D @Y Q
"RTN","XPDT",199,0)
 ;
"RTN","XPDT",200,0)
 ;
"RTN","XPDT",201,0)
 ;FROM DEV
"RTN","XPDT",202,0)
 ;if MSM and HFS file is on device A or B, then get size for floppy disk
"RTN","XPDT",203,0)
 ;XPDSIZ=disk size, XPDSIZA=accummulated size,XPDSEQ=disk sequence number
"RTN","XPDT",204,0)
 I ^%ZOSF("OS")["MSM",FIL?1(1"A",1"B")1":"1.E D  Q:POP
"RTN","XPDT",205,0)
 .S DIR(0)="N^0:5000",DIR("A")="Size of Diskette (1K blocks)",DIR("B")=1400,DIR("?")="Enter the number of 1K blocks which each diskette will hold, 0 means unlimited space"
"RTN","XPDT",206,0)
 .D ^DIR I $D(DIRUT) S POP=1 Q
"RTN","XPDT",207,0)
 .S XPDSIZ=$S(Y:Y*1024,1:0)
"RTN","XPDT",208,0)
 ;FROM SUM
"RTN","XPDT",209,0)
 ;ask for next disk
"RTN","XPDT",210,0)
 ;this code is for MSM system only
"RTN","XPDT",211,0)
 I $G(Z),XPDSIZ,XPDSIZ-XPDSIZA<1024 D
"RTN","XPDT",212,0)
 .;write continue flag at end of this file
"RTN","XPDT",213,0)
 .W "**CONTINUE**",!,"**END**",!
"RTN","XPDT",214,0)
 .;should call %ZIS HFS utilities to close and open file
"RTN","XPDT",215,0)
 .X "C IO" U IO(0)
"RTN","XPDT",216,0)
 .N DIR,G,GR,GCK,GL,I,X,Y
"RTN","XPDT",217,0)
 .W !!,"Diskette #",XPDSEQ," is full."
"RTN","XPDT",218,0)
 .S DIR(0)="E",DIR("A")="Insert the next diskette and Press the return key",DIR("?")="The current diskette is full, insert a new diskette to continue."
"RTN","XPDT",219,0)
 .;$D(DIRUT)=the user aborted the distribution
"RTN","XPDT",220,0)
 .D ^DIR I $D(DIRUT) D ABORT Q
"RTN","XPDT",221,0)
 .W ! S XPDSEQ=XPDSEQ+1,XPDSIZA=0
"RTN","XPDT",222,0)
 .;MSM specific code to open HFS
"RTN","XPDT",223,0)
 .X "O IO:IOPAR" U IO
"RTN","XPDT",224,0)
 .W $$SUM("Continuation #"_XPDSEQ_" of "_XPDHD),!,$$SUM(XPDH),!,$$SUM("**SEQ**:"_XPDSEQ),!!
"RTN","XPDT",225,0)
 .S XPDSIZA=XPDSIZA+2
"RTN","XPDTC")
0^2^B45497905^B41887454
"RTN","XPDTC",1,0)
XPDTC ;SFISC/RSD - Transport calls ;10/15/2008
"RTN","XPDTC",2,0)
 ;;8.0;KERNEL;**10,15,21,39,41,44,58,83,92,95,100,108,124,131,463,511**;Jul 10, 1995;Build 5
"RTN","XPDTC",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XPDTC",4,0)
 Q
"RTN","XPDTC",5,0)
 ;^XTMP("XPDT",XPDA,data type,file #,
"RTN","XPDTC",6,0)
 ;XPDA=ien of File 9.6, XPDNM=.01 field
"RTN","XPDTC",7,0)
DD ;build DD
"RTN","XPDTC",8,0)
 N FILE,FGR,FNAM,Z2,Z3,Z4
"RTN","XPDTC",9,0)
 S FILE=0,FGR="^XTMP(""XPDT"",XPDA)",FNAM=$NA(^XPD(9.6,XPDA,4,"APDD"))
"RTN","XPDTC",10,0)
 F  S FILE=$O(^XPD(9.6,XPDA,4,FILE)) Q:'FILE  D
"RTN","XPDTC",11,0)
 .S Z2=$G(^XPD(9.6,XPDA,4,FILE,222)),Z3=$G(^(223)),Z4=$G(^(224))
"RTN","XPDTC",12,0)
 .Q:'$$DATA^XPDV(FILE,Z2)
"RTN","XPDTC",13,0)
 .D FIA^DIFROMSU(FILE,"",FNAM,FGR,Z2,Z3,Z4,XPDVER),DIERR:$D(DIERR)
"RTN","XPDTC",14,0)
 Q:'$D(^XTMP("XPDT",XPDA,"FIA"))
"RTN","XPDTC",15,0)
 ;send DD and Data
"RTN","XPDTC",16,0)
 D DDOUT^DIFROMS("","","",FGR),DIERR:$D(DIERR),DATAOUT^DIFROMS("","","",FGR),DIERR:$D(DIERR)
"RTN","XPDTC",17,0)
 Q
"RTN","XPDTC",18,0)
 ;XPDERR is checked in XPDT and will abort transport
"RTN","XPDTC",19,0)
DIERR ;record error
"RTN","XPDTC",20,0)
 D MSG^DIALOG("EW",.XPD) S XPDERR=1
"RTN","XPDTC",21,0)
 Q
"RTN","XPDTC",22,0)
KRN ;build Kernel Files
"RTN","XPDTC",23,0)
 ;XPDFILE=file #, XPDOLDA=ien in Build file
"RTN","XPDTC",24,0)
 N %,%1,%2,DA,EACT,FACT,FGR,XPDFILE,XPDFL,XPDOLDA,XPDI
"RTN","XPDTC",25,0)
 F XPDFILE=1:1 S Y0=$P($T(FILES+XPDFILE^XPDE),";;",2,99) Q:Y0=""  S XPDI(+Y0)=Y0
"RTN","XPDTC",26,0)
 ;XPDI(XPDFILE)=file;order;x-ref;fact;eact;fpre;epre;fpos;epos;fdel
"RTN","XPDTC",27,0)
 S XPDFILE=0
"RTN","XPDTC",28,0)
 F  S XPDFILE=$O(^XPD(9.6,XPDA,"KRN",XPDFILE)) Q:'XPDFILE  S XPDI=$G(XPDI(XPDFILE)) I XPDI S FACT=$P(XPDI,";",4),EACT=$P(XPDI,";",5) D  Q:$D(XPDERR)  D:FACT]"" ACT(FACT)
"RTN","XPDTC",29,0)
 .;need to add code to check if File and data is already being sent in the File
"RTN","XPDTC",30,0)
 .;mult. If it is, don't bother sending it again.  DTL(XPDFILE)
"RTN","XPDTC",31,0)
 .S XPDOLDA=0,FGR=$$FILE^XPDV(XPDFILE) I FGR="" S XPDERR=1 Q
"RTN","XPDTC",32,0)
 .K ^TMP($J,"XPD")
"RTN","XPDTC",33,0)
 .F  S XPDOLDA=$O(^XPD(9.6,XPDA,"KRN",XPDFILE,"NM",XPDOLDA)) Q:'XPDOLDA  S Y0=$G(^(XPDOLDA,0)) D
"RTN","XPDTC",34,0)
 ..;XPDFL= 0-send,1-delete,2-link,3-merge,4-attach,5-disable
"RTN","XPDTC",35,0)
 ..S XPDFL=$P(Y0,U,3)
"RTN","XPDTC",36,0)
 ..;If deleting at site get an unused DA
"RTN","XPDTC",37,0)
 ..I XPDFL=1 S DA=$O(@FGR@(" "),-1)+1 F DA=DA:1 Q:'$D(^XTMP("XPDT",XPDA,"KRN",XPDFILE,DA))
"RTN","XPDTC",38,0)
 ..;$P(Y0,U,2) is file # for this template, reset Y0 before getting DA
"RTN","XPDTC",39,0)
 ..E  S:$P(Y0,U,2) $P(Y0,U)=$P(Y0,"    FILE #") S DA=$$ENTRY^XPDV(Y0)
"RTN","XPDTC",40,0)
 ..I 'DA S XPDERR=1 Q
"RTN","XPDTC",41,0)
 ..;(-1)=action ^ ien in Build file
"RTN","XPDTC",42,0)
 ..S ^XTMP("XPDT",XPDA,"KRN",XPDFILE,DA,-1)=+XPDFL_"^"_XPDOLDA
"RTN","XPDTC",43,0)
 ..;action 2 - verify children, 4 - verify parent
"RTN","XPDTC",44,0)
 ..I XPDFL=2!(XPDFL=4),'$$MENU^XPDV(XPDFILE,DA,XPDFL) S XPDERR=1 Q
"RTN","XPDTC",45,0)
 ..;if action is 1,4 or 5 then only send .01 field and set checksum to ""
"RTN","XPDTC",46,0)
 ..I XPDFL=1!(XPDFL>3) S ^XTMP("XPDT",XPDA,"KRN",XPDFILE,DA,0)=$P(Y0,U),$P(^XPD(9.6,XPDA,"KRN",XPDFILE,"NM",XPDOLDA,0),U,4)="" Q
"RTN","XPDTC",47,0)
 ..M ^XTMP("XPDT",XPDA,"KRN",XPDFILE,DA)=@FGR@(DA)
"RTN","XPDTC",48,0)
 ..;execute entry build action
"RTN","XPDTC",49,0)
 ..D:EACT]"" ACT(EACT)
"RTN","XPDTC",50,0)
 .;quit if no entries were saved
"RTN","XPDTC",51,0)
 .Q:'$O(^XTMP("XPDT",XPDA,"KRN",XPDFILE,0))
"RTN","XPDTC",52,0)
 .;XPDI=XPDI(XPDFILE), build x-ref of order to install
"RTN","XPDTC",53,0)
 .S %=$P(^DIC(XPDFILE,0),U),^XTMP("XPDT",XPDA,"ORD",+$P(XPDI,";",2),XPDFILE)=XPDI,^(XPDFILE,0)=%
"RTN","XPDTC",54,0)
 .Q
"RTN","XPDTC",55,0)
 Q
"RTN","XPDTC",56,0)
QUES ;build from Install Questions multiple
"RTN","XPDTC",57,0)
 N I,J,K,X,%
"RTN","XPDTC",58,0)
 S X=""
"RTN","XPDTC",59,0)
 ;the "B" x-ref will give me the order of the questions
"RTN","XPDTC",60,0)
 F  S X=$O(^XPD(9.6,XPDA,"QUES","B",X)) Q:X=""  S I=$$QUES^XPDV(X) S:'I XPDERR=1 D:I
"RTN","XPDTC",61,0)
 .S J=0 F  S J=$O(^XPD(9.6,XPDA,"QUES",I,J)) Q:J=""  D
"RTN","XPDTC",62,0)
 ..;tranform J to DIR subscripts
"RTN","XPDTC",63,0)
 ..I $L(J)=1!(J="QQ") S ^XTMP("XPDT",XPDA,"QUES",X,$TR(J,"1ABQ","0AB?"))=^(J) Q  ;^(J) ref to ^XPD(9.6,XPDA,"QUES",I,J)
"RTN","XPDTC",64,0)
 ..;set the word processing fields into DIR("?",#) structure
"RTN","XPDTC",65,0)
 ..F %=1:1 Q:'$D(^XPD(9.6,XPDA,"QUES",I,J,%,0))  S ^XTMP("XPDT",XPDA,"QUES",X,$TR(J,"AQ10","A?"),%)=^(0)
"RTN","XPDTC",66,0)
 ;send the File questions
"RTN","XPDTC",67,0)
 S K=$G(^XPD(9.6,XPDA,"QDEF")) ;Developer Defaults for Questions
"RTN","XPDTC",68,0)
 F I=1:2 S X=$P($T(QUESTION+I),";;",2,99) Q:X=""  S Y=$P($T(QUESTION+I+1),";;",2) D
"RTN","XPDTC",69,0)
 .S ^XTMP("XPDT",XPDA,"QUES",$P(X,";"),0)=$P(X,";",2),^("A")=$P(X,";",3),^("B")=$S($L($P(K,U,I)):$P(K,U,I),1:$P(X,";",4)),^("??")=$P(X,";",5) S:Y]"" ^("M")=Y
"RTN","XPDTC",70,0)
 Q
"RTN","XPDTC",71,0)
INT ;build pre,post, & enviroment init routines
"RTN","XPDTC",72,0)
 N %,I,R,X,Z
"RTN","XPDTC",73,0)
 F I="PRE","INI","INIT" I $G(^XPD(9.6,XPDA,I))]"" S X=^(I) D
"RTN","XPDTC",74,0)
 .;remove parameters and seperate routine name from tag^routine
"RTN","XPDTC",75,0)
 .S ^XTMP("XPDT",XPDA,I)=X,X=$P(X,"("),R=$P(X,U,$L(X,U)) Q:$D(^("RTN",R))
"RTN","XPDTC",76,0)
 .I '$$RTN^XPDV(X,.Z) W !,"Routine ",X,Z S XPDERR=1 Q
"RTN","XPDTC",77,0)
 .S %=$$LOAD^XPDTA(R,"0^")
"RTN","XPDTC",78,0)
 Q
"RTN","XPDTC",79,0)
BLD ;build Build file, Package file and Order Parameter file
"RTN","XPDTC",80,0)
 N %,DIC,X,XPD,XPDI,XPDV,Y
"RTN","XPDTC",81,0)
 ;Update the 'Date Distributed' field
"RTN","XPDTC",82,0)
 S XPD(9.6,XPDA_",",.02)=$$DT^XLFDT()
"RTN","XPDTC",83,0)
 D FILE^DIE("","XPD") K XPD
"RTN","XPDTC",84,0)
 ;save version of kernel and fm
"RTN","XPDTC",85,0)
 S ^XTMP("XPDT",XPDA,"VER")=$$VERSION^XPDUTL("XU")_U_$$VERSION^XPDUTL("VA FILEMAN")
"RTN","XPDTC",86,0)
 S ^XTMP("XPDT",XPDA,"MBREQ")=$P($G(XPDT(XPDT)),U,4)
"RTN","XPDTC",87,0)
 M ^XTMP("XPDT",XPDA,"BLD",XPDA)=^XPD(9.6,XPDA)
"RTN","XPDTC",88,0)
 ;check national package file pointer
"RTN","XPDTC",89,0)
 S XPDI=$P(^XPD(9.6,XPDA,0),U,2)
"RTN","XPDTC",90,0)
 I XPDI="" W !,"No Package File Link" Q
"RTN","XPDTC",91,0)
 S $P(^XTMP("XPDT",XPDA,"BLD",XPDA,0),U,2)=$$PT^XPDTA("^DIC(9.4)",XPDI)
"RTN","XPDTC",92,0)
 ;quit if no pointer to package file
"RTN","XPDTC",93,0)
 I '$D(^DIC(9.4,XPDI)) W !,"Package File Link is corrupted" S XPDERR=1 Q
"RTN","XPDTC",94,0)
 ;update version multiple in package file,XPD=version^date distributed
"RTN","XPDTC",95,0)
 S XPD=$$VER^XPDUTL(XPDNM)_U_$P(^XTMP("XPDT",XPDA,"BLD",XPDA,0),U,4)
"RTN","XPDTC",96,0)
 ;XPD(1)=root of description field
"RTN","XPDTC",97,0)
 S:$D(^XTMP("XPDT",XPDA,"BLD",XPDA,1)) XPD(1)=$NA(^(1))
"RTN","XPDTC",98,0)
 S ^XTMP("XPDT",XPDA,"PKG",XPDI,0)=^DIC(9.4,XPDI,0),^XTMP("XPDT",XPDA,"PKG",XPDI,22,0)="^"_$P(^DD(9.4,22,0),U,2)_"^1^1"
"RTN","XPDTC",99,0)
 ;add node 20 to XTMP for Patient Merge
"RTN","XPDTC",100,0)
 M ^XTMP("XPDT",XPDA,"PKG",XPDI,20)=^DIC(9.4,XPDI,20)
"RTN","XPDTC",101,0)
 ;XPDNM'["*" is a version release
"RTN","XPDTC",102,0)
 I XPDNM'["*" D
"RTN","XPDTC",103,0)
 .S XPDV=$$PKGVER^XPDIP(XPDI,.XPD)
"RTN","XPDTC",104,0)
 .;Merge is used to set single nodes and merge multiples
"RTN","XPDTC",105,0)
 .F %=1,5,7,20,"DEV","VERSION" M ^XTMP("XPDT",XPDA,"PKG",XPDI,%)=^DIC(9.4,XPDI,%)
"RTN","XPDTC",106,0)
 .;XPDV=ien of Version Multiple
"RTN","XPDTC",107,0)
 .I $D(^DIC(9.4,XPDI,22,XPDV))'>9 W !!,"**Version multiple in Package file wasn't updated**",!! S XPDERR=1 Q
"RTN","XPDTC",108,0)
 .;get just the current version multiple and make it the first entry in version multiple
"RTN","XPDTC",109,0)
 .M ^XTMP("XPDT",XPDA,"PKG",XPDI,22,1)=^DIC(9.4,XPDI,22,XPDV)
"RTN","XPDTC",110,0)
 .;check if SEND PATCH HISTORY is NO, kill PAH
"RTN","XPDTC",111,0)
 .I $P(XPDT(XPDT),U,5) K ^XTMP("XPDT",XPDA,"PKG",XPDI,22,1,"PAH")
"RTN","XPDTC",112,0)
 ;this is a patch, %=version number, $P(XPD,U)=patch number
"RTN","XPDTC",113,0)
 E  D
"RTN","XPDTC",114,0)
 .S %=$P(XPD,U),$P(XPD,U)=$P(XPDNM,"*",3),XPDV=$$PKGPAT^XPDIP(XPDI,%,.XPD)
"RTN","XPDTC",115,0)
 .S ^XTMP("XPDT",XPDA,"PKG",XPDI,22,1,0)=^DIC(9.4,XPDI,22,+XPDV,0)
"RTN","XPDTC",116,0)
 .I $D(^DIC(9.4,XPDI,22,+XPDV,"PAH",+$P(XPDV,U,2)))'>9 W !!,"**Patch multiple in Package file wasn't updated**",!! S XPDERR=1 Q
"RTN","XPDTC",117,0)
 .M ^XTMP("XPDT",XPDA,"PKG",XPDI,22,1,"PAH",1)=^DIC(9.4,XPDI,22,+XPDV,"PAH",+$P(XPDV,U,2))
"RTN","XPDTC",118,0)
 ;save the version ien^patch ien on -1 node
"RTN","XPDTC",119,0)
 S ^XTMP("XPDT",XPDA,"PKG",XPDI,-1)="1^1"
"RTN","XPDTC",120,0)
 ;resolve Primary Help Frame (0;4)
"RTN","XPDTC",121,0)
 S %=+$P(^DIC(9.4,XPDI,0),U,4) S:% $P(^XTMP("XPDT",XPDA,"PKG",XPDI,0),U,4)=$$PT^XPDTA("^DIC(9.2)",%)
"RTN","XPDTC",122,0)
 Q
"RTN","XPDTC",123,0)
 ;
"RTN","XPDTC",124,0)
ACT(%) ;execute action
"RTN","XPDTC",125,0)
 ;user can count on DA,XPDFILE,XPDFL,XPDNM,XPDOLDA being around
"RTN","XPDTC",126,0)
 ;DA=ien in ^XTMP("XPDT",XPDA,"KRN",XPDFILE,DA)
"RTN","XPDTC",127,0)
 ;XPDOLDA=ien in ^XPD(9.6,XPDA,"KRN",XPDIFLE,"NM",XPDOLDA)
"RTN","XPDTC",128,0)
 N EACT,FACT,FGR,K0,Y0
"RTN","XPDTC",129,0)
 S:%'["^" %="^"_%
"RTN","XPDTC",130,0)
 D @% Q
"RTN","XPDTC",131,0)
 ;
"RTN","XPDTC",132,0)
 ;the following are the default questions for the INSTALL QUESTIONS
"RTN","XPDTC",133,0)
 ;in file 9.6, the format is:
"RTN","XPDTC",134,0)
 ;;field .01;field 1;field 2;field 4;field 7
"RTN","XPDTC",135,0)
 ;;field 10
"RTN","XPDTC",136,0)
QUESTION ;package install questions
"RTN","XPDTC",137,0)
 ;;XPF1;Y;Shall I write over your |FLAG| File;YES;^D REP^XPDH
"RTN","XPDTC",138,0)
 ;;D XPF1^XPDIQ
"RTN","XPDTC",139,0)
 ;;XPF2;Y;Want my data |FLAG| yours;YES;^D DTA^XPDH
"RTN","XPDTC",140,0)
 ;;D XPF2^XPDIQ
"RTN","XPDTC",141,0)
 ;;XPI1;YO;Want KIDS to INHIBIT LOGONs during the install;NO;^D INHIBIT^XPDH
"RTN","XPDTC",142,0)
 ;;D XPI1^XPDIQ
"RTN","XPDTC",143,0)
 ;;XPM1;PO^VA(200,:EM;Enter the Coordinator for Mail Group '|FLAG|';;^D MG^XPDH
"RTN","XPDTC",144,0)
 ;;D XPM1^XPDIQ
"RTN","XPDTC",145,0)
 ;;XPO1;Y;Want KIDS to Rebuild Menu Trees Upon Completion of Install;NO;^D MENU^XPDH
"RTN","XPDTC",146,0)
 ;;D XPO1^XPDIQ
"RTN","XPDTC",147,0)
 ;;XPZ1;Y;Want to DISABLE Scheduled Options, Menu Options, and Protocols;NO;^D OPT^XPDH
"RTN","XPDTC",148,0)
 ;;D XPZ1^XPDIQ
"RTN","XPDTC",149,0)
 ;;XPZ2;Y;Want to MOVE routines to other CPUs;NO;^D RTN^XPDH
"RTN","XPDTC",150,0)
 ;;D XPZ2^XPDIQ
"RTN","XPDUTL")
0^1^B23402759^B22402525
"RTN","XPDUTL",1,0)
XPDUTL ;SFISC/RSD - KIDS utilities ;10/15/2008
"RTN","XPDUTL",2,0)
 ;;8.0;KERNEL;**21,28,39,81,100,108,137,181,275,491,511**;Jul 10, 1995;Build 5
"RTN","XPDUTL",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XPDUTL",4,0)
 Q
"RTN","XPDUTL",5,0)
VERSION(X) ;Get current version from Package file, X=package name or
"RTN","XPDUTL",6,0)
 ;package namespace
"RTN","XPDUTL",7,0)
 N I
"RTN","XPDUTL",8,0)
 S I=$$LKPKG(X) Q:'I ""
"RTN","XPDUTL",9,0)
 Q $P($G(^DIC(9.4,+I,"VERSION")),"^")
"RTN","XPDUTL",10,0)
 ;
"RTN","XPDUTL",11,0)
VER(X) ;returns version number from Build file, X=build name
"RTN","XPDUTL",12,0)
 Q:X["*" $P(X,"*",2)
"RTN","XPDUTL",13,0)
 Q $P(X," ",$L(X," "))
"RTN","XPDUTL",14,0)
 ;
"RTN","XPDUTL",15,0)
STATUS(IEN) ;returns status from Install File, IEN=Install File IEN
"RTN","XPDUTL",16,0)
 I '$D(^XPD(9.7,IEN,0)) Q -1
"RTN","XPDUTL",17,0)
 Q $P(^XPD(9.7,IEN,0),U,9)
"RTN","XPDUTL",18,0)
 ;
"RTN","XPDUTL",19,0)
PKG(X) ;returns package name from Build file, X=build name
"RTN","XPDUTL",20,0)
 Q $S(X["*":$P(X,"*"),1:$P(X," ",1,$L(X," ")-1))
"RTN","XPDUTL",21,0)
 ;
"RTN","XPDUTL",22,0)
LAST(PKG,VER) ;returns last patch applied for a Package, PATCH^DATE
"RTN","XPDUTL",23,0)
 ;        Patch includes Seq # if Released
"RTN","XPDUTL",24,0)
 N PKGIEN,VERIEN,LATEST,PATCH,SUBIEN
"RTN","XPDUTL",25,0)
 I $G(VER)="" S VER=$$VERSION^XPDUTL(PKG) Q:'VER -1
"RTN","XPDUTL",26,0)
 S PKGIEN=$O(^DIC(9.4,"B",PKG,"")) Q:'PKGIEN -1
"RTN","XPDUTL",27,0)
 S VERIEN=$O(^DIC(9.4,PKGIEN,22,"B",VER,"")) Q:'VERIEN -1
"RTN","XPDUTL",28,0)
 S LATEST=-1,PATCH=-1,SUBIEN=0
"RTN","XPDUTL",29,0)
 F  S SUBIEN=$O(^DIC(9.4,PKGIEN,22,VERIEN,"PAH",SUBIEN)) Q:SUBIEN'>0  D
"RTN","XPDUTL",30,0)
 . I $P(^DIC(9.4,PKGIEN,22,VERIEN,"PAH",SUBIEN,0),U,2)>LATEST S LATEST=$P(^(0),U,2),PATCH=$P(^(0),U)
"RTN","XPDUTL",31,0)
 Q PATCH_U_LATEST
"RTN","XPDUTL",32,0)
 ;
"RTN","XPDUTL",33,0)
PATCH(X) ;return 1 if patch X was installed, X=aaaa*nn.nn*nnn
"RTN","XPDUTL",34,0)
 Q:X'?1.4UN1"*"1.2N1"."1.2N.1(1"V",1"T").2N1"*"1.3N 0
"RTN","XPDUTL",35,0)
 N %,I,J
"RTN","XPDUTL",36,0)
 S I=$$LKPKG($P(X,"*")) Q:'I 0
"RTN","XPDUTL",37,0)
 S J=$O(^DIC(9.4,I,22,"B",$P(X,"*",2),0)),X=$P(X,"*",3) Q:'J 0
"RTN","XPDUTL",38,0)
 ;check if patch is just a number
"RTN","XPDUTL",39,0)
 Q:$O(^DIC(9.4,I,22,J,"PAH","B",X,0)) 1
"RTN","XPDUTL",40,0)
 S %=$O(^DIC(9.4,I,22,J,"PAH","B",X_" SEQ"))
"RTN","XPDUTL",41,0)
 Q (X=+%)
"RTN","XPDUTL",42,0)
 ;
"RTN","XPDUTL",43,0)
INSTALDT(INSTALL,RESULT) ;returns number of installs, 0 if not installed or doesn't exist
"RTN","XPDUTL",44,0)
 ;input: INSTALL=required, Install name; RESULT=required, passed by reference
"RTN","XPDUTL",45,0)
 ;output: RESULT=number in RESULT array; RESULT(FM date/time)=TEST# ^ SEQ#
"RTN","XPDUTL",46,0)
 N CNT,DATE,IEN
"RTN","XPDUTL",47,0)
 K RESULT
"RTN","XPDUTL",48,0)
 S (IEN,CNT,RESULT)=0
"RTN","XPDUTL",49,0)
 I $G(INSTALL)="" Q 0
"RTN","XPDUTL",50,0)
 F  S IEN=$O(^XPD(9.7,"B",INSTALL,IEN)) Q:'IEN  D
"RTN","XPDUTL",51,0)
 .S DATE=$P($G(^XPD(9.7,IEN,1)),U,3) Q:'DATE
"RTN","XPDUTL",52,0)
 .S RESULT(DATE)=$G(^XPD(9.7,IEN,6)),CNT=CNT+1
"RTN","XPDUTL",53,0)
 S RESULT=CNT
"RTN","XPDUTL",54,0)
 Q CNT
"RTN","XPDUTL",55,0)
 ;
"RTN","XPDUTL",56,0)
NEWCP(XPD,XPDC,XPDP) ;create new check point, returns 0=error or ien
"RTN","XPDUTL",57,0)
 ;XPD=name, XPDC=call back, XPDP=parameters
"RTN","XPDUTL",58,0)
 Q:$G(XPD)="" 0
"RTN","XPDUTL",59,0)
 N %,XPDI,XPDJ,XPDF,XPDY
"RTN","XPDUTL",60,0)
 ;XPDCP="INI"=Pre-init, "INIT"=Post-init
"RTN","XPDUTL",61,0)
 S XPDI=$S(XPDCP="INIT":9.716,1:9.713)
"RTN","XPDUTL",62,0)
 S %=$$FIND1^DIC(XPDI,","_XPDA_",","X",XPD) Q:% %
"RTN","XPDUTL",63,0)
 S XPDF="+1,"_XPDA_",",XPDJ(XPDI,XPDF,.01)=XPD
"RTN","XPDUTL",64,0)
 S:$D(XPDC) XPDJ(XPDI,XPDF,2)=XPDC
"RTN","XPDUTL",65,0)
 S:$D(XPDP) XPDJ(XPDI,XPDF,3)=XPDP
"RTN","XPDUTL",66,0)
 D UPDATE^DIE("","XPDJ","XPDY")
"RTN","XPDUTL",67,0)
 Q $G(XPDY(1))
"RTN","XPDUTL",68,0)
 ;
"RTN","XPDUTL",69,0)
UPCP(XPD,XPDP) ;update check point, returns 0=error or ien
"RTN","XPDUTL",70,0)
 ;XPD=name, XPDP=parameters
"RTN","XPDUTL",71,0)
 N XPDI,XPDJ,XPDF,XPDY
"RTN","XPDUTL",72,0)
 ;XPDCP="INI"=Pre-init, "INIT"=Post-init
"RTN","XPDUTL",73,0)
 S XPDI=$S(XPDCP="INIT":9.716,1:9.713),XPDY=$$DICCP($G(XPD))
"RTN","XPDUTL",74,0)
 Q:'XPDY 0
"RTN","XPDUTL",75,0)
 S XPDF=XPDY_","_XPDA_","
"RTN","XPDUTL",76,0)
 S:$D(XPDP) XPDJ(XPDI,XPDF,3)=XPDP
"RTN","XPDUTL",77,0)
 D FILE^DIE("","XPDJ")
"RTN","XPDUTL",78,0)
 Q XPDY
"RTN","XPDUTL",79,0)
 ;
"RTN","XPDUTL",80,0)
COMCP(XPD) ;complete check point, returns 0=error or date/time
"RTN","XPDUTL",81,0)
 ;XPD=name
"RTN","XPDUTL",82,0)
 N XPDD,XPDI,XPDJ,XPDY
"RTN","XPDUTL",83,0)
 S XPDI=$S(XPDCP="INIT":9.716,1:9.713),XPDY=$$DICCP($G(XPD))
"RTN","XPDUTL",84,0)
 Q:'XPDY 0
"RTN","XPDUTL",85,0)
 S XPDD=$$NOW^XLFDT,XPDJ(XPDI,XPDY_","_XPDA_",",1)=XPDD
"RTN","XPDUTL",86,0)
 D FILE^DIE("","XPDJ")
"RTN","XPDUTL",87,0)
 Q XPDD
"RTN","XPDUTL",88,0)
 ;
"RTN","XPDUTL",89,0)
VERCP(XPD) ;verify check point, returns 1=completed, 0=not
"RTN","XPDUTL",90,0)
 ;-1=doesn't exist
"RTN","XPDUTL",91,0)
 ;XPD=name
"RTN","XPDUTL",92,0)
 N XPDI,XPDY
"RTN","XPDUTL",93,0)
 S XPDI=$S(XPDCP="INIT":9.716,1:9.713),XPDY=$$DICCP($G(XPD))
"RTN","XPDUTL",94,0)
 Q:'XPDY -1
"RTN","XPDUTL",95,0)
 Q ''$$GET1^DIQ(XPDI,XPDY_","_XPDA_",",1,"I")
"RTN","XPDUTL",96,0)
 ;
"RTN","XPDUTL",97,0)
PARCP(XPD,XPDF) ;returns parameters of check point
"RTN","XPDUTL",98,0)
 ;XPD=name, XPDF="PRE"
"RTN","XPDUTL",99,0)
 N XPDI,XPDY
"RTN","XPDUTL",100,0)
 I $G(XPDF)="PRE" N XPDCP S XPDCP="INI"
"RTN","XPDUTL",101,0)
 S XPDI=$S(XPDCP="INIT":9.716,1:9.713),XPDY=$$DICCP($G(XPD))
"RTN","XPDUTL",102,0)
 Q:'XPDY 0
"RTN","XPDUTL",103,0)
 Q $$GET1^DIQ(XPDI,XPDY_","_XPDA_",",3,"I")
"RTN","XPDUTL",104,0)
 ;
"RTN","XPDUTL",105,0)
CURCP(XPDF) ;returns current check point
"RTN","XPDUTL",106,0)
 ;XPDF flag - 0=externel, 1=internal
"RTN","XPDUTL",107,0)
 Q $S($G(XPDF):XPDCHECK,1:XPDCHECK(0))
"RTN","XPDUTL",108,0)
 ;
"RTN","XPDUTL",109,0)
WP(X) ;X=global ref
"RTN","XPDUTL",110,0)
 N %
"RTN","XPDUTL",111,0)
 Q:'$D(@X)
"RTN","XPDUTL",112,0)
 F %=1:1 Q:'$D(@X@(%))  W !,@X@(%)
"RTN","XPDUTL",113,0)
 Q:'$G(XPDA)  D WP^DIE(9.7,XPDA_",",20,"A",X)
"RTN","XPDUTL",114,0)
 Q
"RTN","XPDUTL",115,0)
MES(X) ;record message, X=message or an array passed by reference
"RTN","XPDUTL",116,0)
 N %
"RTN","XPDUTL",117,0)
 I $D(X)#2 S %=X K X S X(1)=%
"RTN","XPDUTL",118,0)
 ;write message
"RTN","XPDUTL",119,0)
 F %=1:1 Q:'$D(X(%))  W !,X(%)
"RTN","XPDUTL",120,0)
 Q:'$G(XPDA)  D WP^DIE(9.7,XPDA_",",20,"A","X")
"RTN","XPDUTL",121,0)
 Q
"RTN","XPDUTL",122,0)
BMES(X) ;add blank line before message
"RTN","XPDUTL",123,0)
 N %
"RTN","XPDUTL",124,0)
 I $D(X)#2 S %=X K X S X(1)=" ",X(2)=%
"RTN","XPDUTL",125,0)
 D MES(.X)
"RTN","XPDUTL",126,0)
 Q
"RTN","XPDUTL",127,0)
RTNUP(X,Y) ;update routine action, X=routine, Y=action
"RTN","XPDUTL",128,0)
 ;actions:  1=delete, 2=skip
"RTN","XPDUTL",129,0)
 N %
"RTN","XPDUTL",130,0)
 ;set action to Y
"RTN","XPDUTL",131,0)
 Q:'$G(Y)!'$D(^XTMP("XPDI",$G(XPDA),"RTN",X)) 0 S $P(^(X),U)=+Y
"RTN","XPDUTL",132,0)
 Q 1
"RTN","XPDUTL",133,0)
 ;get Build ien
"RTN","XPDUTL",134,0)
 S Y=$O(^XTMP("XPDI",XPDA,"BLD",0))
"RTN","XPDUTL",135,0)
 ;remove checksum when updating action, since action can only be
"RTN","XPDUTL",136,0)
 ;delete or skip, not sure if we want to do this
"RTN","XPDUTL",137,0)
 S:$P(%,U,2) $P(^XTMP("XPDI",XPDA,"BLD",Y,"KRN",9.8,"NM",$P(%,U,2),0),U,4)=""
"RTN","XPDUTL",138,0)
 Q 1
"RTN","XPDUTL",139,0)
 ;
"RTN","XPDUTL",140,0)
RTNLOG(X) ;Enter/Update routine in the Routine File
"RTN","XPDUTL",141,0)
 N Y,FDA,IEN
"RTN","XPDUTL",142,0)
 S Y=$O(^DIC(9.8,"B",X,0))
"RTN","XPDUTL",143,0)
 I Y'>0 S IEN="?+1,",FDA(9.8,IEN,1)="R"
"RTN","XPDUTL",144,0)
 I Y>0 S IEN=(+Y)_","
"RTN","XPDUTL",145,0)
 S FDA(9.8,IEN,.01)=X,FDA(9.8,IEN,7.4)=$$NOW^XLFDT
"RTN","XPDUTL",146,0)
 D UPDATE^DIE("","FDA","IEN")
"RTN","XPDUTL",147,0)
 Q
"RTN","XPDUTL",148,0)
 ;
"RTN","XPDUTL",149,0)
DICCP(X) ;lookup check point, returns ien or 0
"RTN","XPDUTL",150,0)
 Q:$G(X)="" 0
"RTN","XPDUTL",151,0)
 ;if they pass ien, fail if can't find
"RTN","XPDUTL",152,0)
 I X=+X S Y=X Q:'$D(^XPD(9.7,XPDA,XPDCP,Y,0)) 0
"RTN","XPDUTL",153,0)
 E  S Y=$$FIND1^DIC(XPDI,","_XPDA_",","X",X)
"RTN","XPDUTL",154,0)
 Q Y
"RTN","XPDUTL",155,0)
 ;
"RTN","XPDUTL",156,0)
PRODE(XPDN,XPD) ;enable/disable protocols, return 1 for success
"RTN","XPDUTL",157,0)
 ;XPDN=protocol name, XPD=1-enable, 0-disable
"RTN","XPDUTL",158,0)
 Q:$G(XPDN)="" 0
"RTN","XPDUTL",159,0)
 S XPD=+$G(XPD)
"RTN","XPDUTL",160,0)
 D KIDS^XQOO1($P(XPDSET,U,2),101,XPDN,.XPD)
"RTN","XPDUTL",161,0)
 Q $S(XPD<0:0,1:1)
"RTN","XPDUTL",162,0)
 ;
"RTN","XPDUTL",163,0)
OPTDE(XPDN,XPD) ;enable/disable options, return 1 for success
"RTN","XPDUTL",164,0)
 ;XPDN=protocol name, XPD=1-enable, 0-disable
"RTN","XPDUTL",165,0)
 Q:$G(XPDN)="" 0
"RTN","XPDUTL",166,0)
 S XPD=+$G(XPD)
"RTN","XPDUTL",167,0)
 D KIDS^XQOO1($P(XPDSET,U,2),19,XPDN,.XPD)
"RTN","XPDUTL",168,0)
 Q $S(XPD<0:0,1:1)
"RTN","XPDUTL",169,0)
 ;
"RTN","XPDUTL",170,0)
BUILD(XPDN,XPD) ;check if a build exists, return 1 for success
"RTN","XPDUTL",171,0)
 ;XPDN=build name, XPD=1-exist, 0-been removed
"RTN","XPDUTL",172,0)
 S XPD=$D(XPDT("NM",XPDN))
"RTN","XPDUTL",173,0)
 Q XPD
"RTN","XPDUTL",174,0)
 ;
"RTN","XPDUTL",175,0)
MAILGRP(X) ;Return mail group for package, X=package name or namespace
"RTN","XPDUTL",176,0)
 N XD,DIC,DR,DA,DIQ
"RTN","XPDUTL",177,0)
 S DA=$$LKPKG(X) Q:'DA ""
"RTN","XPDUTL",178,0)
 S DIC="^DIC(9.4,",DR=1938,DIQ="XD" D EN^DIQ1
"RTN","XPDUTL",179,0)
 Q $S($G(XD(9.4,DA,1938))="":"",1:"G."_XD(9.4,DA,1938))
"RTN","XPDUTL",180,0)
 ;
"RTN","XPDUTL",181,0)
LKPKG(X) ;Return Package ien,  X=package name or namespace
"RTN","XPDUTL",182,0)
 Q:$G(X)="" 0
"RTN","XPDUTL",183,0)
 N DA
"RTN","XPDUTL",184,0)
 I $L(X)<5 D  Q:DA +DA
"RTN","XPDUTL",185,0)
 .S DA=$O(^DIC(9.4,"C",X,0))
"RTN","XPDUTL",186,0)
 .S:'DA DA=$O(^DIC(9.4,"C2",X,0))
"RTN","XPDUTL",187,0)
 I $L(X)>3 S DA=$O(^DIC(9.4,"B",X,0))
"RTN","XPDUTL",188,0)
 Q +DA
"RTN","XPDV")
0^4^B37369398^B33811883
"RTN","XPDV",1,0)
XPDV ;SFISC/RSD - Verify Build ;10/15/2008
"RTN","XPDV",2,0)
 ;;8.0;KERNEL;**30,44,58,108,511**;Jul 10, 1995;Build 5
"RTN","XPDV",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XPDV",4,0)
 ;checks that everything is ready to do a build
"RTN","XPDV",5,0)
 ;XPDA=build ien, loop thru all nodes in ^XPD(9.6,XPDA and verify data
"RTN","XPDV",6,0)
EN ;check a build
"RTN","XPDV",7,0)
 N DA,ERR,FGR,TYPE,XPDFILE,XPDOLDA,Y0,Y2 K ^TMP($J)
"RTN","XPDV",8,0)
 S Y0=$G(^XPD(9.6,XPDA,0)),TYPE=$P(Y0,U,3)
"RTN","XPDV",9,0)
 I $P(Y0,U,2)="" W !,"No Package File Link"
"RTN","XPDV",10,0)
 I '$P(Y0,U,2) W !,$P(Y0,U,2)," in Package File Link field is freetext, not a pointer"
"RTN","XPDV",11,0)
 I $P(Y0,U,2),'$D(^DIC(9.4,$P(Y0,U,2),0)) W !,$P(Y0,U,2)," in PACKAGE File  ** NOT FOUND **",*7
"RTN","XPDV",12,0)
 ;type is global package goto CONT
"RTN","XPDV",13,0)
 G CONT:TYPE=2
"RTN","XPDV",14,0)
 I TYPE=1 S Y0=$$MULT(XPDA) G DONE
"RTN","XPDV",15,0)
 S XPDFILE=0
"RTN","XPDV",16,0)
 ;check DD being sent
"RTN","XPDV",17,0)
 F  S XPDFILE=$O(^XPD(9.6,XPDA,4,XPDFILE)) Q:'XPDFILE  D
"RTN","XPDV",18,0)
 .Q:$$FILE(XPDFILE)=""
"RTN","XPDV",19,0)
 .S Y0=0,Y2=$G(^XPD(9.6,XPDA,4,XPDFILE,222))
"RTN","XPDV",20,0)
 .Q:'$$DATA(XPDFILE,Y2)
"RTN","XPDV",21,0)
 .F  S Y0=$O(^XPD(9.6,XPDA,4,XPDFILE,2,Y0)) Q:'Y0  D
"RTN","XPDV",22,0)
 ..I '$D(^DD(Y0)) W !," SubDD #",Y0," in File #",XPDFILE,"  ** NOT FOUND **" Q
"RTN","XPDV",23,0)
 ..S XPDOLDA=0
"RTN","XPDV",24,0)
 ..;check fields being sent for partial DD
"RTN","XPDV",25,0)
 ..F  S XPDOLDA=$O(^XPD(9.6,XPDA,4,XPDFILE,2,Y0,1,XPDOLDA)) Q:'XPDOLDA  D
"RTN","XPDV",26,0)
 ...I '$D(^DD(Y0,XPDOLDA)) W !,"Field #",XPDOLDA," in SubDD #",Y0," in File #",XPDFILE,"  ** NOT FOUND **" Q
"RTN","XPDV",27,0)
 ;
"RTN","XPDV",28,0)
 ;build components files
"RTN","XPDV",29,0)
 S XPDFILE=0
"RTN","XPDV",30,0)
 F  S XPDFILE=$O(^XPD(9.6,XPDA,"KRN",XPDFILE)) Q:'XPDFILE  D
"RTN","XPDV",31,0)
 .;if file doesn't exist, save in ^TMP and deleted at end
"RTN","XPDV",32,0)
 .S FGR=$$FILE(XPDFILE),XPDOLDA=0 I FGR="" S ^TMP($J,XPDFILE)="" Q
"RTN","XPDV",33,0)
 .F  S XPDOLDA=$O(^XPD(9.6,XPDA,"KRN",XPDFILE,"NM",XPDOLDA)) Q:'XPDOLDA  S Y0=$G(^(XPDOLDA,0)) D
"RTN","XPDV",34,0)
 ..;check action, quit if deleting at site
"RTN","XPDV",35,0)
 ..Q:$P(Y0,U,3)=1
"RTN","XPDV",36,0)
 ..;check that entry exist
"RTN","XPDV",37,0)
 ..S:$P(Y0,U,2) $P(Y0,U)=$P(Y0,"    FILE #") S DA=$$ENTRY(Y0)
"RTN","XPDV",38,0)
 ..Q:'$P(Y0,U,3)!($P(Y0,U,3)#2)
"RTN","XPDV",39,0)
 ..;if attach check that parent is sent, if link check that child is sent
"RTN","XPDV",40,0)
 ..Q:'$$MENU(XPDFILE,DA,$P(Y0,U,3))
"RTN","XPDV",41,0)
 ;check Install Questions
"RTN","XPDV",42,0)
 S XPDOLDA=0
"RTN","XPDV",43,0)
 F  S XPDOLDA=$O(^XPD(9.6,XPDA,"QUES",XPDOLDA)) Q:'XPDOLDA  S Y0=$G(^(XPDOLDA,0)),Y2=$G(^(1)) D
"RTN","XPDV",44,0)
 .I $P(Y0,U)="" W !,"Zero node doesn't exist for INSTALL QUESTION #",XPDOLDA Q
"RTN","XPDV",45,0)
 .I Y2="" W !,"DIR(0) field is not defined for INSTALL QUESTION ",$P(Y0,U)
"RTN","XPDV",46,0)
 I $O(^XPD(9.6,XPDA,"GLO",0)) W !,"Package cannot contain Globals, Files, & Components."
"RTN","XPDV",47,0)
 ;check for PRE & POST routines
"RTN","XPDV",48,0)
 F DA="INI","INIT" S Y0=$G(^XPD(9.6,XPDA,DA)),ERR="" I Y0]"",'$$RTN(Y0,.ERR) W !,"Routine ",Y0,ERR
"RTN","XPDV",49,0)
CONT ;
"RTN","XPDV",50,0)
 ;check Environment Check routine
"RTN","XPDV",51,0)
 S Y0=$G(^XPD(9.6,XPDA,"PRE")),ERR="" I Y0]"",'$$RTN(Y0.ERR) W !,"Routine ",Y0,ERR
"RTN","XPDV",52,0)
 I TYPE=2 S Y0=$$GLOPKG(XPDA)
"RTN","XPDV",53,0)
DONE I $O(^TMP($J,0)) D
"RTN","XPDV",54,0)
 .N DA,DIK,DIR,DIRUT,Y
"RTN","XPDV",55,0)
 .S DIR(0)="Y",DIR("A")="Do you want to remove the missing Files",DIR("B")="NO"
"RTN","XPDV",56,0)
 .S DIR("?")="Yes means that the missing Files will be removed and you can transport this Build"
"RTN","XPDV",57,0)
 .D ^DIR Q:'Y!$D(DIRUT)
"RTN","XPDV",58,0)
 .S DIK="^XPD(9.6,"_XPDA_",""KRN"",",DA(1)=XPDA,DA=0 F  S DA=$O(^TMP($J,DA)) Q:'DA  D ^DIK
"RTN","XPDV",59,0)
 W !!,"  ** DONE **"
"RTN","XPDV",60,0)
 Q
"RTN","XPDV",61,0)
GLOPKG(X) ;GLOBAL PACKAGE
"RTN","XPDV",62,0)
 ;returns 1 if ok, 0 if failed
"RTN","XPDV",63,0)
 N I,J,Y,Z S Z=1
"RTN","XPDV",64,0)
 I $O(^XPD(9.6,X,4,0)) W !,"GLOBAL PACKAGE cannot contain Files" S Z=0
"RTN","XPDV",65,0)
 S I=0 F  S I=$O(^XPD(9.6,X,"KRN",I)) Q:'I  D:$O(^(I,"NM",0))
"RTN","XPDV",66,0)
 .W !,"GLOBAL PACKAGE cannot contain ",$P(^DIC(I,0),U) S Z=0
"RTN","XPDV",67,0)
 I $O(^XPD(9.6,X,"QUES",0)) W !,"GLOBAL PACKAGE cannot contain Install Questions" S Z=0
"RTN","XPDV",68,0)
 I $G(^XPD(9.6,X,"INI"))]"" W !,"GLOBAL PACKAGE cannot have a Pre-Install Routine" S Z=0
"RTN","XPDV",69,0)
 ;I $G(^XPD(9.6,X,"INIT"))]"" W !,"GLOBAL PACKAGE cannot have a Post-Install Routine" S Z=0
"RTN","XPDV",70,0)
 S I=0 F J=0:1 S I=$O(^XPD(9.6,X,"GLO",I)) Q:'I  S Y=$G(^(I,0)) D
"RTN","XPDV",71,0)
 .I $P(Y,U)]"",'$D(@("^"_$P(Y,U))) W !,"Global ",Y," doesn't exist." S Z=0
"RTN","XPDV",72,0)
 I 'J W !,"No Globals to transport" S Z=0
"RTN","XPDV",73,0)
 Q Z
"RTN","XPDV",74,0)
 ;
"RTN","XPDV",75,0)
QUES(X) ;X=.01 of INSTALL QUESTION multiple
"RTN","XPDV",76,0)
 ;returns ien or 0 if failed
"RTN","XPDV",77,0)
 N Y
"RTN","XPDV",78,0)
 S Y=+$O(^XPD(9.6,XPDA,"QUES","B",X,0))
"RTN","XPDV",79,0)
 I '$D(^XPD(9.6,XPDA,"QUES",Y,0)) W !,"Zero node doesn't exist for INSTALL QUESTION ",X Q 0
"RTN","XPDV",80,0)
 I '$D(^XPD(9.6,XPDA,"QUES",Y,1)) W !,"DIR(0) field is not defined for INSTALL QUESTION ",X Q 0
"RTN","XPDV",81,0)
 Q Y
"RTN","XPDV",82,0)
 ;
"RTN","XPDV",83,0)
FILE(X) ;check file # X
"RTN","XPDV",84,0)
 ;returns global ref or "" if failed
"RTN","XPDV",85,0)
 N %,Y
"RTN","XPDV",86,0)
 S Y=$G(^DIC(X,0,"GL"))
"RTN","XPDV",87,0)
 I Y="" W !," File #",X,"  ** NOT FOUND **" Q ""
"RTN","XPDV",88,0)
 S %=$E(Y,$L(Y)),X=$E(Y,1,$L(Y)-1)_$S(%="(":"",1:")")
"RTN","XPDV",89,0)
 Q X
"RTN","XPDV",90,0)
 ;
"RTN","XPDV",91,0)
 ;Z only contains the file # for Fileman templates and forms
"RTN","XPDV",92,0)
 ;XPDFILE=file #,FGR=file global ref
"RTN","XPDV",93,0)
ENTRY(Z) ;check entry, Z=name^file
"RTN","XPDV",94,0)
 ;returns ien or 0 if failed
"RTN","XPDV",95,0)
 N F,X,Y
"RTN","XPDV",96,0)
 ;check for X, name, in "B" x-ref of file.
"RTN","XPDV",97,0)
 S X=$P(Z,U),Y=0 F  S Y=$O(@FGR@("B",X,Y)) D  Q:X=""
"RTN","XPDV",98,0)
 .I 'Y W !?3,X,"  in ",$P(^DIC(XPDFILE,0),U)," File   ** NOT FOUND **",*7 S X="" Q
"RTN","XPDV",99,0)
 .;if Y is in x-ref but node doesn't exist, quit and try another
"RTN","XPDV",100,0)
 .;if this is a fileman template, the file associated with it is piece 2 of Z
"RTN","XPDV",101,0)
 .;if Form file check piece 8 else 4
"RTN","XPDV",102,0)
 .Q:'$D(@FGR@(Y,0))  I $P(Z,U,2) S F=^(0) S:$P(Z,U,2)=$P(F,U,(4+(4*(FGR["DIST")))) X="" Q
"RTN","XPDV",103,0)
 .;if it is routine file,9.8, check that routine exist
"RTN","XPDV",104,0)
 .I XPDFILE=9.8 S F="" I '$$RTN(X,.F) W !,"Routine ",X,F S X="",Y=0 Q
"RTN","XPDV",105,0)
 .;if this is not a fileman template or routine we found Y
"RTN","XPDV",106,0)
 .S X="" Q
"RTN","XPDV",107,0)
 Q +Y
"RTN","XPDV",108,0)
 ;
"RTN","XPDV",109,0)
DATA(F,Y) ;
"RTN","XPDV",110,0)
 ;return 1 if ok or 0 if failed
"RTN","XPDV",111,0)
 I $P(Y,U,3)="p",$P(Y,U,7)="y" W !,"You can only send Data with a Full Data Dictionary,",!,"** File #",F," cannot be Sent **" Q 0
"RTN","XPDV",112,0)
 Q 1
"RTN","XPDV",113,0)
 ;
"RTN","XPDV",114,0)
RTN(X,MSG) ;verify tag^routine
"RTN","XPDV",115,0)
 ;INPUT: X=[tag^]routine, MSG(passed by reference)
"RTN","XPDV",116,0)
 ;OUTPUT: returns 1=exists, 0=doesn't; MSG=error message
"RTN","XPDV",117,0)
 N T,R
"RTN","XPDV",118,0)
 S MSG=""
"RTN","XPDV",119,0)
 I X["(" S X=$P(X,"(") ;Handle tag^rtn(param) rwf
"RTN","XPDV",120,0)
 I X["^" S T=$P(X,"^"),R=$P(X,"^",2)
"RTN","XPDV",121,0)
 E  S T="",R=X
"RTN","XPDV",122,0)
 I (R'?1A.E) S MSG=" Name violates the SAC!!" Q 0
"RTN","XPDV",123,0)
 I $T(^@R)="" S MSG=" DOESN'T EXIST!!" Q 0
"RTN","XPDV",124,0)
 ;2nd line must begin with " ;;n[n.nn];"
"RTN","XPDV",125,0)
 I $T(+2^@R)'?1" ;;"1.2N.1".".2N1";".E S MSG=" 2nd line violates the SAC!!" Q 0
"RTN","XPDV",126,0)
 ;if no tag or tag^routine exists, then return 1
"RTN","XPDV",127,0)
 Q:T="" 1 Q:$T(@T^@R)]"" 1
"RTN","XPDV",128,0)
 S MSG=" Tag DOESN'T EXIST!!" Q 0
"RTN","XPDV",129,0)
 ;
"RTN","XPDV",130,0)
MULT(DA) ;multi-package
"RTN","XPDV",131,0)
 ;returns 1 if ok or 0 if failed
"RTN","XPDV",132,0)
 N I,J,X,Y,Z
"RTN","XPDV",133,0)
 S I=0,Z=1
"RTN","XPDV",134,0)
 F J=0:1 S I=$O(^XPD(9.6,DA,10,I)) Q:'I  S X=$P($G(^(I,0)),U),Y=0 D
"RTN","XPDV",135,0)
 .S:X]"" Y=$O(^XPD(9.6,"B",X,0))
"RTN","XPDV",136,0)
 .I Y,$D(^XPD(9.6,Y,0)) Q
"RTN","XPDV",137,0)
 .W !,"Package ",X," doesn't exist." S Z=0
"RTN","XPDV",138,0)
 I 'J W !,"No Packages to transport" S Z=0
"RTN","XPDV",139,0)
 Q Z
"RTN","XPDV",140,0)
MENU(F,X,Y) ;check for Parent or Children, F=file (19 or 101), X=ien,
"RTN","XPDV",141,0)
 ;Y=action (2=link or 4=attach)
"RTN","XPDV",142,0)
 ;returns 1 if ok or 0 if failed
"RTN","XPDV",143,0)
 Q:'X 0
"RTN","XPDV",144,0)
 N I,J,GR,Z
"RTN","XPDV",145,0)
 S GR=$S(F=19:"^DIC(19)",1:"^ORD(101)"),(I,Z)=0
"RTN","XPDV",146,0)
 ;link, check that at least 1 menu item was sent
"RTN","XPDV",147,0)
 I Y=2 F  S I=$O(@GR@(X,10,"B",I)) Q:'I  S J=$P($G(@GR@(I,0)),U) I J]"",$D(^XPD(9.6,XPDA,"KRN",F,"NM","B",J)) S Z=1 Q
"RTN","XPDV",148,0)
 ;attach, check that the parent was sent
"RTN","XPDV",149,0)
 I Y=4 F  S I=$O(@GR@("AD",X,I)) Q:'I  S J=$P($G(@GR@(I,0)),U) I J]"",$D(^XPD(9.6,XPDA,"KRN",F,"NM","B",J)) S Z=1 Q
"RTN","XPDV",150,0)
 D:'Z
"RTN","XPDV",151,0)
 .W !,$S(F=19:"Option ",1:"Protocol "),$P($G(@GR@(X,0)),U)," has an Action of "
"RTN","XPDV",152,0)
 .W:Y=2 "'USE AS LINK FOR MENU ITEMS' and no 'Menu Items' were sent."
"RTN","XPDV",153,0)
 .W:Y=4 "'ATTACH TO MENU' and a 'Parent Menu' wasn't sent."
"RTN","XPDV",154,0)
 Q Z
"RTN","XU8P511")
0^^B339118^n/a
"RTN","XU8P511",1,0)
XU8P511 ;ISF/RD - Patch XU*8*511 Post-init ;10/15/2008
"RTN","XU8P511",2,0)
 ;;8.0;KERNEL;**511**;Jul 10, 1995;Build 5
"RTN","XU8P511",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","XU8P511",4,0)
 Q
"RTN","XU8P511",5,0)
 ;
"RTN","XU8P511",6,0)
POST ; kill "C" & "C2" x-ref in Package file and re-index
"RTN","XU8P511",7,0)
 N DIC,DIK,DA
"RTN","XU8P511",8,0)
 S DIK="^DIC(9.4,",DIK(1)=1
"RTN","XU8P511",9,0)
 K ^DIC(9.4,"C"),^("C2")
"RTN","XU8P511",10,0)
 ;re-index the PREFIX field, #1
"RTN","XU8P511",11,0)
 D ENALL^DIK
"RTN","XU8P511",12,0)
 ;re-index the ADDITIONAL PREFIX field, #14
"RTN","XU8P511",13,0)
 K DA,DIK
"RTN","XU8P511",14,0)
 S DIK="^DIC(9.4,DA(1),14,",DIK(1)=".01^C2",DA(1)=0
"RTN","XU8P511",15,0)
 F  S DA(1)=$O(^DIC(9.4,DA(1))) Q:'DA(1)  D ENALL^DIK
"RTN","XU8P511",16,0)
 Q
"UP",9.4,9.4014,-1)
9.4^14
"UP",9.4,9.4014,0)
9.4014
"VER")
8.0^22.0
"^DD",9.4,9.4,1,0)
PREFIX^RFX^^0;2^K:$L(X)>4!(X'?1U1.3NU) X I $D(X) N %,%1,%2 S %="^DIC(9.4)" F %1="C","C2" S %2=$O(@%@(%1,X,0)) I %2>0,%2-DA K X Q
"^DD",9.4,9.4,1,.1)
NAMESPACE
"^DD",9.4,9.4,1,1,0)
^.1
"^DD",9.4,9.4,1,1,1,0)
9.4^C
"^DD",9.4,9.4,1,1,1,1)
S ^DIC(9.4,"C",X,DA)=""
"^DD",9.4,9.4,1,1,1,2)
K ^DIC(9.4,"C",X,DA)
"^DD",9.4,9.4,1,3)
Please enter the unique namespace prefix (2-4 characters, starting with an alpha).
"^DD",9.4,9.4,1,21,0)
^^4^4^2940627^^^^
"^DD",9.4,9.4,1,21,1,0)
This is the unique namespace prefix assigned to the Package, e.g. XM for
"^DD",9.4,9.4,1,21,2,0)
the MailMan routines and globals, DI for the FileMan routines, etc.
"^DD",9.4,9.4,1,21,3,0)
This field is appended to letters (like "INIT") to be used as the
"^DD",9.4,9.4,1,21,4,0)
names of INIT routines.
"^DD",9.4,9.4,1,"DT")
2890223
"^DD",9.4,9.4,14,0)
ADDITIONAL PREFIXES^9.4014^^14;0
"^DD",9.4,9.4,14,"DT")
2990302
"^DD",9.4,9.4014,0)
ADDITIONAL PREFIXES SUB-FIELD^^.01^1
"^DD",9.4,9.4014,0,"DT")
2990127
"^DD",9.4,9.4014,0,"IX","B",9.4014,.01)

"^DD",9.4,9.4014,0,"NM","ADDITIONAL PREFIXES")

"^DD",9.4,9.4014,0,"UP")
9.4
"^DD",9.4,9.4014,.01,0)
ADDITIONAL PREFIXES^MFX^^0;1^K:$L(X)>4!($L(X)<2)!'(X?1U1.3UN) X I $D(X) N %,%1,%2 S %="^DIC(9.4)" F %1="C","C2" S %2=$O(@%@(%1,X,0)) I %2>0,%2-DA(1) K X Q
"^DD",9.4,9.4014,.01,1,0)
^.1
"^DD",9.4,9.4014,.01,1,1,0)
9.4014^B
"^DD",9.4,9.4014,.01,1,1,1)
S ^DIC(9.4,DA(1),14,"B",$E(X,1,30),DA)=""
"^DD",9.4,9.4014,.01,1,1,2)
K ^DIC(9.4,DA(1),14,"B",$E(X,1,30),DA)
"^DD",9.4,9.4014,.01,1,2,0)
9.4^C2^MUMPS
"^DD",9.4,9.4014,.01,1,2,1)
S ^DIC(9.4,"C2",X,DA(1),DA)=1
"^DD",9.4,9.4014,.01,1,2,2)
K ^DIC(9.4,"C2",X,DA(1),DA)
"^DD",9.4,9.4014,.01,1,2,3)
Keep
"^DD",9.4,9.4014,.01,1,2,"%D",0)
^.101^2^2^3080603^^^
"^DD",9.4,9.4014,.01,1,2,"%D",1,0)
This X-ref sets the additional PREFIX into the "C" index
"^DD",9.4,9.4014,.01,1,2,"%D",2,0)
so the standard lookup will find the pachage with the PREFIX.
"^DD",9.4,9.4014,.01,1,2,"DT")
2990127
"^DD",9.4,9.4014,.01,3)
Answer must be 2-4 uppercase characters in length.
"^DD",9.4,9.4014,.01,21,0)
^^1^1^2990127^
"^DD",9.4,9.4014,.01,21,1,0)
This multiple is to record additional PREFIXs that a package may have.
"^DD",9.4,9.4014,.01,"DT")
2990602
"BLD",1094,6)
^412
**END**
**END**
