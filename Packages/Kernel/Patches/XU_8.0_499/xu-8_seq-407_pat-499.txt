$TXT Created by FORT,WALLY at NXT.FO-OAKLAND.MED.VA.GOV  (KIDS) on Tuesday, 10/14/08 at 14:34
=============================================================================
Run Date: NOV 10, 2008                     Designation: XU*8*499
Package : XU - KERNEL                         Priority: Mandatory
Version : 8       SEQ #407                      Status: Released
                  Compliance Date: DEC 11, 2008
=============================================================================

Associated patches: (v)XU*8*120    <<= must be installed BEFORE `XU*8*499'
                    (v)XU*8*385    <<= must be installed BEFORE `XU*8*499'
                    (v)XU*8*440    <<= must be installed BEFORE `XU*8*499'

Subject: Get Client IP when connecting via SSH.

Category: 
  - Routine
  - Data Dictionary
  - Other

Description:
============

 Patch Tracking #: 48752273
 Test Sites: Puget Sound HCS, Minneapolis VAMC, Dublin, GA VAMC,
 Bedford VAMC, Detroit VAMC, COLUMBUS, OH
  
 Blood Bank Clearance: 9/3/2008
  
 HD245595
 With the use of SSH to get a secure connection from the client to the
 server, $ZIO no longer holds the IP address of the client.
 The SSH service does put it in the local VMS job table.
 The fix is to have %ZIS4 check and get this value.
 To test: connect with Reflections thru a SECURE SHELL then 
 from programmer mode enter the following:
 K  S %ZIS="L" D ^%ZIS ZW IO
 Before IO("IP") will be empty, after it will have the client IP address.
  
 HD261231
 When queuing across OS systems the device handler would setup the HFS
 path for the current system and this bad path would get saved by TaskMan.
 This would cause the task to fail to open the device.
 Fix: Don't set IO("HFSIO") if IO("Q") is set. Build it a run time.
  
 HD254027
 Cache changed the text returned by the $ZV variable between 5.0 and 5.2.
 This causes Cache on Windows to not add the default HFS directory in 
 Cache 5.2. 
 Fix: Have %ZISF just look for "Windows" instead of "NT" as it did before.
 Only Minneapolis or the other sites in Minnesota, North and South Dakota.
 can test.
  
 HD252856, HD249607
 The form for editing the Kernel system parameters (8989.3) had the 
 Secondary HFS field (320.2) set as required when the form started. Unless 
 the curser was moved to the MIXED OS field (.05) the form could not be 
 saved. 
 Fix: Do not have the Secondary HFS field set as required. 
 To test run the "Enter/Edit Kernel Site Parameters" [XUSITEPARM] option, 
 just change any field on the first page and <PF1>E to save and exit.  
 Before it will say that the Secondary HFS field is required.
 After it will just save and exit.
  
 HD247402
 The %Z editor would not setup the correct IO variables if started with a
 empty symbol table.
 Fix: Setup the correct IO variables.
 To test "K  ZL ZTEDIT X ^%Z" edit line % it will use a replace/with format.
 After it will do line editing.
  
 Internal testing.
 We found that CCOW authentication did not work through a SSH tunnel because
 the peer IP address was now 127.0.0.1.  Made a change to use the IP address
 sent by the client if the peer address is in a table.  Added a check for the
 client name if the IP address is not the same. 
 To Test: Connect with a CCOW application, Start a second CCOW application and 
 see if you have to sign-on again.
  
 New field PEER (#250) in the Kernel System Parameters file (#8989.3) that 
 holds a list of TCP IP peer addresses not to switch to.  It is used by the 
 GETPEER^%ZOSV function. This was added during the transition from the 
 152.*.*.* to 10.*.*.* addresses.
  
 The option "Where am I?" [XUSERWHERE] was changed to show the IP address.
 =========================================================================
 Installation:
  
 >>>Users may remain on the system.
 >>>*****  Allow KIDS to INHIBIT new sign-ons. *****
 >>>TaskMan does *not* need to be stopped.
  
   1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
       option will load the KIDS package onto your system.
  
   2.  The patch has now been loaded into a Transport global on your
       system. You now need to use KIDS to install the Transport global.
       On the KIDS menu, under the 'Installation' menu, use the following
       options:
  
          Verify Checksums in Transport Global
          Print Transport Global
          Compare Transport Global to Current System
          Backup a Transport Global
  
   3.  Users can remain on the system. This patch can be loaded any
       non-peak time.
       This patch CAN NOT be queued.
       TaskMan can remain running.
  
   4.  Installation will take less than 2 minutes.
       In a client/server environment
          Install Package(s)  'XU*8.0*499'
                               ==========
  
       Accept the following defaults:
  
       Want KIDS to Rebuild Menu Trees Upon Completion of Install? NO// 
       
       Want KIDS to INHIBIT LOGONs during the install? YES//
  
       Want to DISABLE Scheduled Options, Menu Options, and Protocols? NO//
  
       RELOAD^ZTMGRSET will automatically run as part of the post-init.
       Patch number to load: 499
                             ===
 EXAMPLE of RELOAD^ZTMGRSET:
 ==========================
  
 Running Post-Install Routine: POST^XU8P499
  
  
 ZTMGRSET Version 8.0 Patch level **34,36,69,94,121,127,136,191,275,355**
 HELLO! I exist to assist you in correctly initializing the current 
 account.
  
 This is namespace or uci ISC,ISC.
 Should I continue? N//y
                       =
 I think you are using OpenM-NT
 Which MUMPS system should I install?
  
 1 = VAX DSM(V6), VAX DSM(V7)
 2 = MSM-PC/PLUS, MSM for NT or UNIX
 3 = Cache (VMS, NT, Linux), OpenM-NT
 4 = Datatree, DTM-PC, DT-MAX
 5 = 
 6 = 
 7 = GT.M (VMS)
 8 = GT.M (Unix)
 System: 3// (accept default for Cache, OpenM-NT)
         =
 Patch number to load: 499
                       ===
 I will now rename a group of routines specific to your operating system.
 Routine: ZOSVONT      Loaded, Saved as %ZOSV
 Routine: 
 Routine: ZIS4ONT      Loaded, Saved as %ZIS4
 Routine: ZISFONT      Loaded, Saved as %ZISF
 Routine: ZISHONT
 Routine: XUCIONT
 Routine: 
 Routine: ZISTCPS
 Routine: ZTMDCL
 Routine: ZOSVKRO
 Routine: ZOSVKSOE
 Routine: ZOSVKSOS
 Routine: ZOSVKSD
  
 Now to load routines common to all systems.
 Routine: ZTLOAD
 Routine: ZTLOAD1
 Routine: ZTLOAD2
 Routine: ZTLOAD3
 Routine: ZTLOAD4
 Routine: ZTLOAD5
 Routine: ZTLOAD6
 Routine: ZTLOAD7
 Routine: ZTM
 Routine: ZTM0
 Routine: ZTM1
 Routine: ZTM2
 Routine: ZTM3
 Routine: ZTM4
 Routine: ZTM5
 Routine: ZTM6
 Routine: ZTMS
 Routine: ZTMS0
 Routine: ZTMS1
 Routine: ZTMS2
 Routine: ZTMS3
 Routine: ZTMS4
 Routine: ZTMS5
 Routine: ZTMS7
 Routine: ZTMSH
 Routine: ZTER
 Routine: ZTER1
 Routine: ZIS          Loaded, Saved as %ZIS
 Routine: ZIS1         Loaded, Saved as %ZIS1
 Routine: ZIS2
 Routine: ZIS3         Loaded, Saved as %ZIS3
 Routine: ZIS5         Loaded, Saved as %ZIS5
 Routine: ZIS6
 Routine: ZIS7
 Routine: ZISC
 Routine: ZISP
 Routine: ZISS
 Routine: ZISS1
 Routine: ZISS2
 Routine: ZISTCP
 Routine: ZISUTL
 Routine: ZTPP
 Routine: ZTP1
 Routine: ZTPTCH
 Routine: ZTRDEL
 Routine: ZTMOVE
 Installing ^%Z editor
 ALL DONE
  
  Updating Routine file...
  
  Updating KIDS files...
  
  XU*8.0*499 Installed. 
                Oct 16, 2008@14:58:13
  
 ...... 
  
 ==========================================================================

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;8.0;KERNEL;**[Patch List]**;Jul 10, 1995;Build 14

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: XU8P499
    Before:       n/a   After:   B213938  **499**
Routine Name: XUSRB4
    Before: B12816308   After: B15887142  **150,337,395,419,437,499**
Routine Name: ZIS
    Before: B20530056   After: B20827574  **18,23,69,112,199,191,275,363,
                                           440,499**
Routine Name: ZIS1
    Before: B24679317   After: B26102976  **18,49,69,104,112,199,391,440,499**
Routine Name: ZIS3
    Before: B13908684   After: B14236085  **18,36,69,104,391,440,499**
Routine Name: ZIS4GTM
    Before: B19862476   After: B20384143  **275,425,440,499**
Routine Name: ZIS4ONT
    Before: B27677822   After: B29872561  **34,59,69,191,278,293,440,499**
Routine Name: ZIS5
    Before: B13100730   After: B13269875  **18,24,69,499**
Routine Name: ZISFGTM
    Before:  B9168627   After:  B8623260  **275,499**
Routine Name: ZISFONT
    Before:  B9426543   After:  B9782391  **34,191,271,385,499**
Routine Name: ZOSVGTM
    Before: B14594340   After: B14876188  **275,425,499**
Routine Name: ZOSVGUX
    Before: B36401450   After: B33819105  **275,425,499**
Routine Name: ZOSVONT
    Before: B22002850   After: B22340698  **34,94,107,118,136,215,293,
                                           284,385,425,440,499**
Routine Name: ZTEDIT2
    Before: B16132418   After: B16339351  **9,16,120,499**
 
Routine list of preceding patches: 120, 437, 440

=============================================================================
User Information:
Entered By  : FORT,WALLY                    Date Entered  : APR 16, 2008
Completed By: SINGH,GURBIR                  Date Completed: NOV 03, 2008
Released By : TILLIS,LEWIS                  Date Released : NOV 10, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
