$TXT Created by RANDALL,SHERRY at DAYT17.FO-BAYPINES.MED.VA.GOV  (KIDS) on Friday, 10/31/08 at 12:43
=============================================================================
Run Date: APR 01, 2009                     Designation: USR*1*29
Package : USR - AUTHORIZATION/SUBSCRIPTION    Priority: Mandatory
Version : 1        SEQ #31                      Status: Released
                  Compliance Date: MAY 02, 2009
=============================================================================

Associated patches: (v)USR*1*7     <<= must be installed BEFORE `USR*1*29'
                    (v)USR*1*20    <<= must be installed BEFORE `USR*1*29'
                    (v)USR*1*28    <<= must be installed BEFORE `USR*1*29'

Subject: GRAMMAR GENERATOR ALLOWS BAD BUSINESS RULES TO BE CREATED

Category: 
  - Routine
  - Data Dictionary
  - Input Template

Description:
============

 Description:
 ============
 This patch will make updates to how a Business Rule may be defined.
  
 Currently, the only required field when creating a Business Rule is the 
 DOCUMENT DEFINITION.  This patch will make the STATUS field (#.02) and 
 ACTION field (#.03) required fields in the USR AUTHORIZATION/SUBSCRIPTION
 file (#8930.1).  In the event that a USER CLASS (#.04) and a USER ROLE 
 (#.06) are entered but no AND FLAG (#.05) is entered, the system will
 assume a value of 'OR' for AND FLAG.
  
 This patch  will prevent incomplete business rules and duplicate business 
 rules from being created.  
  
 This patch will also correct the document hierarchy issue which allowed
 user access to a note due to a rule at a higher level.  
  
 And finally, this patch will prevent the error "Already a member of this
 class" from being generated when the search string matches a member
 already in that class.
  
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
 1.  HD00000067699 - Grammar Generator Problem?
 2.  HD00000139146 - Having difficulty creating 2 rules that utilize User 
                     Role
 3.  HD00000067537 - ADDING MEMBERS TO AN EXISTING CLASS
  
  
 PARTICIPATING TEST SITES:
 =========================
 Hines VAMC
 Pittsburg HCS
 Wilmington VAMC
  
  
 REMEDY OVERVIEW:
 ================
 1.  HD00000067699 - Grammar Generator Problem
  
     Problem:
     --------
     When creating a new Business Rule, if the "AND FLAG" prompt was left
     blank, and both User Role and User Class were entered, an incomplete
     Business rule was created.
  
     In testing, it was found that business rules were being created
     without required fields STATUS (#.02) and ACTION (#.03).
  
     Exiting with "^" would exit out of the option but would save nulls for
     any fields not entered.
  
     Also, duplicate Business Rules were able to be created by adding new 
     or editing existing rules.
  
     Resolution:
     -----------
     Routines USRAEDT and USRLA have been modified to follow the ASU User 
     Manual. The code will assume "OR'  when the "AND FLAG" prompt is left
     blank and a USER ROLE is entered.  
  
     Routine USRRULA and input template USR DEFINE AUTHORIZATIONS have 
     been modified to make fields STATUS (#.02) and ACTION (#.03) in USR
     AUTHORIZATION/SUBSCRIPTION file (#8930.1) required fields and to
     perform requirement matching on fields USER CLASS (#.04), AND FLAG
     (#.05), and USER ROLE (#.06) to prevent duplicate rules from being
     created.
  
  
 2.  HD00000139146 - Having difficulty creating 2 rules that utilize User
                     Role
  
     Problem:
     --------
     Higher Document Definition levels are still checked when there is a 
     Business Rule at the current level that should prevent the user from
     viewing the note.
  
     Resolution:
     -----------
     Modify USRLA to stop looking for a rule at a higher level to allow
     that action, if there is a match at the current level for document,
     status, and action.
  
  
 3.  HD00000067537 - ADDING MEMBERS TO AN EXISTING CLASS   
  
     Problem:
     --------
     When adding Members to a Class, if the search string entered matches 
     an already existing Member, the error "Already a member of this class"
     is displayed for all existing members that matched the name/partial
     name entered.  Then, any other matching users would be displayed for
     selection except for the case where only a single non-member matched
     and it would automatically be selected to be added to the class.  In 
     this case, the system would display "Already a member of this class"
     followed by any remaining characters of the member selected.  If only
     one existing member matched the name/partial name, the error "Already
     a member of this class" was displayed twice.
  
     Resolution:
     -----------
     Modify ADD^USRMEMBR to display all matches of the name/partial name
     for selection.  If the user selects an existing member, the error
     message "Already a member of this class" is displayed and the user is 
     given the opportunity to select a new person to be added.
  
  
 INSTALLATION INSTRUCTIONS
 =========================
 This patch can be loaded with users in the system.  Installation time
 will be less than 2 minutes.
  
   1.  Choose the PackMan message containing this patch and invoke the 
       INSTALL/CHECK MESSAGE PackMan option.  
  
   2.  Start up the Kernel Installation and Distribution System Menu
       [XPD MAIN]: 
  
           Edits and Distribution ...  
           Utilities ...  
           Installation ...  
  
       Select Kernel Installation & Distribution System Option: Install
                                                                ---
           1      Load a Distribution
           2      Verify Checksums in Transport Global
           3      Print Transport Global
           4      Compare Transport Global to Current System
           5      Backup a Transport Global
           6      Install Package(s)
                  Restart Install of Package(s)
                  Unload a Distribution
  
   3.  From this menu, you may elect to use the following options
       (When prompted for the INSTALL NAME, enter "USR*1.0*29"):
      
       a.  Backup a Transport Global - This option will create a backup
           message of any routines exported with this patch. It will
           not backup any other changes such as DD's or templates.
       b.  Compare Transport Global to Current System - This option
           will allow you to view all changes that will be made when
           this patch is installed.  It compares all components of this
           patch (routines, DD's, templates, etc.).
       c.  Verify Checksums in Transport Global - This option will
           allow you to ensure the integrity of the routines that are
           in the transport global.
  
   4.  Use the Install Package(s) option and select the package.
  
       a.  When prompted "Want KIDS to INHIBIT LOGONs during the
           install? NO//", answer NO.
       b.  When prompted "Want to DISABLE Scheduled Options and Menu 
           Options and Protocols? NO//", answer NO.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;1.0;AUTHORIZATION/SUBSCRIPTION;**[Patch List]**;Jun 20, 1997;Build 7

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: USRAEDT
    Before:  B5583272   After:  B5903950  **15,29**
Routine Name: USRLA
    Before:  B8083219   After:  B8914879  **15,20,29**
Routine Name: USRMEMBR
    Before: B24315676   After: B24265517  **2,3,6,7,29**
Routine Name: USRRULA
    Before: B11780179   After: B24614630  **3,28,29**
 
Routine list of preceding patches: 7, 20, 28

=============================================================================
User Information:
Entered By  : BROWN,MICHAEL D               Date Entered  : JAN 11, 2006
Completed By: WERNER,GARY                   Date Completed: MAR 05, 2009
Released By : SAUNDERS,TOM                  Date Released : APR 01, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
