Released SD*5.3*114 SEQ #100
Extracted from mail message
**KIDS**:SD*5.3*114^

**INSTALL NAME**
SD*5.3*114
"BLD",419,0)
SD*5.3*114^SCHEDULING^0^2970401^n
"BLD",419,1,0)
^^2^2^2970331^
"BLD",419,1,1,0)
This patch corrects a problem with the cancellation of the PCMM Patient
"BLD",419,1,2,0)
w/Team Assignments report.  See NPM for complete details.
"BLD",419,4,0)
^9.64PA^^
"BLD",419,"ABPKG")
n
"BLD",419,"KRN",0)
^9.67PA^19^18
"BLD",419,"KRN",.4,0)
.4
"BLD",419,"KRN",.401,0)
.401
"BLD",419,"KRN",.402,0)
.402
"BLD",419,"KRN",.403,0)
.403
"BLD",419,"KRN",.5,0)
.5
"BLD",419,"KRN",.84,0)
.84
"BLD",419,"KRN",3.6,0)
3.6
"BLD",419,"KRN",3.8,0)
3.8
"BLD",419,"KRN",9.2,0)
9.2
"BLD",419,"KRN",9.8,0)
9.8
"BLD",419,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",419,"KRN",9.8,"NM",1,0)
SCRPTA^^0^B28296685
"BLD",419,"KRN",9.8,"NM","B","SCRPTA",1)

"BLD",419,"KRN",19,0)
19
"BLD",419,"KRN",19.1,0)
19.1
"BLD",419,"KRN",101,0)
101
"BLD",419,"KRN",409.61,0)
409.61
"BLD",419,"KRN",771,0)
771
"BLD",419,"KRN",869.2,0)
869.2
"BLD",419,"KRN",870,0)
870
"BLD",419,"KRN",8994,0)
8994
"BLD",419,"KRN","B",.4,.4)

"BLD",419,"KRN","B",.401,.401)

"BLD",419,"KRN","B",.402,.402)

"BLD",419,"KRN","B",.403,.403)

"BLD",419,"KRN","B",.5,.5)

"BLD",419,"KRN","B",.84,.84)

"BLD",419,"KRN","B",3.6,3.6)

"BLD",419,"KRN","B",3.8,3.8)

"BLD",419,"KRN","B",9.2,9.2)

"BLD",419,"KRN","B",9.8,9.8)

"BLD",419,"KRN","B",19,19)

"BLD",419,"KRN","B",19.1,19.1)

"BLD",419,"KRN","B",101,101)

"BLD",419,"KRN","B",409.61,409.61)

"BLD",419,"KRN","B",771,771)

"BLD",419,"KRN","B",869.2,869.2)

"BLD",419,"KRN","B",870,870)

"BLD",419,"KRN","B",8994,8994)

"BLD",419,"QUES",0)
^9.62^^
"BLD",419,"REQB",0)
^9.611^3^3
"BLD",419,"REQB",1,0)
SD*5.3*41^1
"BLD",419,"REQB",2,0)
SD*5.3*48^1
"BLD",419,"REQB",3,0)
SD*5.3*52^1
"BLD",419,"REQB","B","SD*5.3*41",1)

"BLD",419,"REQB","B","SD*5.3*48",2)

"BLD",419,"REQB","B","SD*5.3*52",3)

"OER",16,0)
16^SD^^M.A.S.^
"OER",16,1,0)
^100.9951PA^2^2
"OER",16,1,1,0)
103
"OER",16,1,1,1,0)
^100.99511PA^1^1
"OER",16,1,1,1,1,0)
101
"OER",16,1,2,0)
645
"OER",16,1,2,1,0)
^100.99511PA^1^1
"OER",16,1,2,1,1,0)
121
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
114^2970401
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^2970331
"PKG",16,22,1,"PAH",1,1,1,0)
This patch corrects a problem with the cancellation of the PCMM Patient
"PKG",16,22,1,"PAH",1,1,2,0)
w/Team Assignments report.  See NPM for complete details.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SCRPTA")
0^1^B28296685
"RTN","SCRPTA",1,0)
SCRPTA ;ALB/CMM - Patient Listing w/Team Assignment Data ;02/22/96
"RTN","SCRPTA",2,0)
 ;;5.3;Scheduling;**41,48,52,114**;AUG 13, 1993
"RTN","SCRPTA",3,0)
 ;
"RTN","SCRPTA",4,0)
 ;Patient Listing w/Team Assignment Data Report
"RTN","SCRPTA",5,0)
 ;
"RTN","SCRPTA",6,0)
PROMPTS ;
"RTN","SCRPTA",7,0)
 ;Prompt for Institution, Team, Role, Practitioner and Print device
"RTN","SCRPTA",8,0)
 ;
"RTN","SCRPTA",9,0)
 N PRNT,QTIME,NUMBER
"RTN","SCRPTA",10,0)
 K VAUTD,VAUTT,VAUTR,VAUTP,VAUTPP,SCUP
"RTN","SCRPTA",11,0)
 S QTIME=""
"RTN","SCRPTA",12,0)
 D INST^SCRPU1 I Y=-1 G ERR
"RTN","SCRPTA",13,0)
 K Y D PRMTT^SCRPU1 I '$D(VAUTT) G ERR
"RTN","SCRPTA",14,0)
 K Y D ROLE^SCRPU1 I '$D(VAUTR) G ERR
"RTN","SCRPTA",15,0)
 K Y S VAUTPP="" D PRACT^SCRPU1 K VAUTPP I '$D(VAUTP) G ERR
"RTN","SCRPTA",16,0)
 S PRNT=$$PDEVICE^SCRPU3()
"RTN","SCRPTA",17,0)
 I PRNT=-1 G ERR
"RTN","SCRPTA",18,0)
 I PRNT["Q;" S QTIME=$$GETTIME^SCRPU3()
"RTN","SCRPTA",19,0)
 I QTIME=-1 G ERR
"RTN","SCRPTA",20,0)
 I PRNT'?1"Q;".E S PRNT="Q;"_PRNT
"RTN","SCRPTA",21,0)
 K Y
"RTN","SCRPTA",22,0)
 S NUMBER=$$ENTRY2(.VAUTD,.VAUTT,.VAUTR,.VAUTP,PRNT,QTIME)
"RTN","SCRPTA",23,0)
 I NUMBER>0 W !!,"Print queued, task number: ",NUMBER
"RTN","SCRPTA",24,0)
 Q
"RTN","SCRPTA",25,0)
 ;
"RTN","SCRPTA",26,0)
ENTRY2(INST,TEAM,ROLE,PRACT,IOP,ZTDTH) ;
"RTN","SCRPTA",27,0)
 ;Second entry point for GUI to use
"RTN","SCRPTA",28,0)
 ;Input Parameters:
"RTN","SCRPTA",29,0)
 ;INST - institutions selected (variable and array)
"RTN","SCRPTA",30,0)
 ;TEAM - teams selected (variable and array)
"RTN","SCRPTA",31,0)
 ;ROLE - roles selected (variable and array)
"RTN","SCRPTA",32,0)
 ;PRACT - practitioners selected (variable and array)
"RTN","SCRPTA",33,0)
 ;IOP - print device
"RTN","SCRPTA",34,0)
 ;ZTDTH - queue time (optional)
"RTN","SCRPTA",35,0)
 ;
"RTN","SCRPTA",36,0)
 ;validate parameters
"RTN","SCRPTA",37,0)
 I '$D(INST)!'$D(TEAM)!'$D(ROLE)!'$D(PRACT)!'$D(IOP)!(IOP="") Q
"RTN","SCRPTA",38,0)
 ;
"RTN","SCRPTA",39,0)
 N NUMBER
"RTN","SCRPTA",40,0)
 S IOST=$P(IOP,"^",2),IOP=$P(IOP,"^")
"RTN","SCRPTA",41,0)
 I IOP?1"Q;".E S IOP=$P(IOP,"Q;",2)
"RTN","SCRPTA",42,0)
 I IOST?1"C-".E D QENTRY G RET
"RTN","SCRPTA",43,0)
 I ZTDTH="" S ZTDTH=$H
"RTN","SCRPTA",44,0)
 S ZTRTN="QENTRY^SCRPTA"
"RTN","SCRPTA",45,0)
 S ZTDESC="Patient Listing w/Team Assignment",ZTIO=IOP
"RTN","SCRPTA",46,0)
 N II
"RTN","SCRPTA",47,0)
 F II="INST","TEAM","ROLE","INST(","TEAM(","PRACT","PRACT(","ROLE(","IOP" S ZTSAVE(II)=""
"RTN","SCRPTA",48,0)
 D ^%ZTLOAD
"RTN","SCRPTA",49,0)
RET S NUMBER=0
"RTN","SCRPTA",50,0)
 I $D(ZTSK) S NUMBER=ZTSK
"RTN","SCRPTA",51,0)
 D EXIT1
"RTN","SCRPTA",52,0)
 Q NUMBER
"RTN","SCRPTA",53,0)
 ;
"RTN","SCRPTA",54,0)
QENTRY ;
"RTN","SCRPTA",55,0)
 ;driver entry point
"RTN","SCRPTA",56,0)
 S TITL="Patient Listing w/Team Assignment Data"
"RTN","SCRPTA",57,0)
 S STORE="^TMP("_$J_",""SCRPTA"")"
"RTN","SCRPTA",58,0)
 K @STORE
"RTN","SCRPTA",59,0)
 S @STORE=0
"RTN","SCRPTA",60,0)
 I TEAM=1 D TALL^SCRPPAT3 S TEAM=0
"RTN","SCRPTA",61,0)
 D FIND
"RTN","SCRPTA",62,0)
 I $O(@STORE@(0))="" S NODATA=$$NODATA^SCRPU3(TITL)
"RTN","SCRPTA",63,0)
 I '$D(NODATA) D PRINTIT(STORE,IOP,TITL)
"RTN","SCRPTA",64,0)
 D EXIT2
"RTN","SCRPTA",65,0)
 Q
"RTN","SCRPTA",66,0)
 ;
"RTN","SCRPTA",67,0)
ERR ;
"RTN","SCRPTA",68,0)
EXIT1 ;
"RTN","SCRPTA",69,0)
 K ZTDTH,ZTRTN,ZTDESC,ZTSK,ZTIO,ZTSAVE,Y,SCUP
"RTN","SCRPTA",70,0)
 Q
"RTN","SCRPTA",71,0)
 ;
"RTN","SCRPTA",72,0)
EXIT2 ;
"RTN","SCRPTA",73,0)
 K @STORE
"RTN","SCRPTA",74,0)
 K STOP,STORE,TITL,IOP,TEAM,INST,ROLE,NODATA,PRACT
"RTN","SCRPTA",75,0)
 Q
"RTN","SCRPTA",76,0)
 ;
"RTN","SCRPTA",77,0)
FIND ;
"RTN","SCRPTA",78,0)
 N NXT,TLIST,TERR,CNT,ERR1,TNODE,NODE1,PIEN,PTAIEN
"RTN","SCRPTA",79,0)
 S NXT=0,TLIST="^TMP("_$J_",""SCRPTA"",""LIST1"")",TERR="ERR1"
"RTN","SCRPTA",80,0)
 K @TLIST,@TERR
"RTN","SCRPTA",81,0)
 F  S NXT=$O(TEAM(NXT)) Q:NXT=""!(NXT'?.N)  D
"RTN","SCRPTA",82,0)
 .S ERR1=$$PTTM^SCAPMC2(NXT,,.TLIST,.TERR) ;Patients assigned to team NXT
"RTN","SCRPTA",83,0)
 .Q:ERR1=0
"RTN","SCRPTA",84,0)
 .S CNT=0
"RTN","SCRPTA",85,0)
 .F  S CNT=$O(@TLIST@(CNT)) Q:CNT=""!(CNT'?.N)  D
"RTN","SCRPTA",86,0)
 ..S TNODE=$G(@TLIST@(CNT))
"RTN","SCRPTA",87,0)
 ..Q:TNODE=""
"RTN","SCRPTA",88,0)
 ..S PIEN=+$P(TNODE,"^") ;patient ien
"RTN","SCRPTA",89,0)
 ..S PTAIEN=+$P(TNODE,"^",3) ;ien Patient Team Assignment #404.42
"RTN","SCRPTA",90,0)
 ..D CHK^SCRPTA2(PTAIEN,PIEN)
"RTN","SCRPTA",91,0)
 .K @TLIST,@TERR
"RTN","SCRPTA",92,0)
 K @TLIST,@TERR
"RTN","SCRPTA",93,0)
 Q
"RTN","SCRPTA",94,0)
 ;
"RTN","SCRPTA",95,0)
PRINTIT(STORE,IOP,TITL) ;
"RTN","SCRPTA",96,0)
 D OPEN^SCRPU3
"RTN","SCRPTA",97,0)
 Q:$G(POP)
"RTN","SCRPTA",98,0)
 N NXT,PAGE,NPAGE,INTN,TMN,INT,TM,PRN,PR,NEW,POS
"RTN","SCRPTA",99,0)
 S (NPAGE,STOP)=0,PAGE=1,(INTN,NEW)=""
"RTN","SCRPTA",100,0)
 D SHEAD ;setup headers
"RTN","SCRPTA",101,0)
 D TITLE^SCRPU3(.PAGE,TITL) ;write title
"RTN","SCRPTA",102,0)
 F  S INTN=$O(@STORE@("I",INTN)) Q:INTN=""!(STOP)  D
"RTN","SCRPTA",103,0)
 .S INT=$O(@STORE@("I",INTN,"")) ;institution
"RTN","SCRPTA",104,0)
 .Q:INT=""
"RTN","SCRPTA",105,0)
 .I '$D(NEW),(IOST'?1"C-".E) D NEWP1^SCRPU3(.PAGE,TITL)
"RTN","SCRPTA",106,0)
 .I '$D(NEW),(IOST?1"C-".E) D HOLD^SCRPU3(.PAGE,TITL)
"RTN","SCRPTA",107,0)
 .Q:STOP
"RTN","SCRPTA",108,0)
 .W !,$G(@STORE@(INT))
"RTN","SCRPTA",109,0)
 .K NEW
"RTN","SCRPTA",110,0)
 .S TMN=""
"RTN","SCRPTA",111,0)
 .F  S TMN=$O(@STORE@("T",INT,TMN)) Q:TMN=""!(STOP)  D
"RTN","SCRPTA",112,0)
 ..S TM=$O(@STORE@("T",INT,TMN,"")) ;team
"RTN","SCRPTA",113,0)
 ..Q:TM=""
"RTN","SCRPTA",114,0)
 ..I (IOST'?1"C-".E),$Y>(IOSL-8) D NEWP1^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT))
"RTN","SCRPTA",115,0)
 ..I (IOST?1"C-".E),$Y>(IOSL-8) D HOLD^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT))
"RTN","SCRPTA",116,0)
 ..Q:STOP
"RTN","SCRPTA",117,0)
 ..W !!,$G(@STORE@(INT,TM))
"RTN","SCRPTA",118,0)
 ..I (IOST'?1"C-".E),$Y>(IOSL-10) D NEWP1^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT)),!!,$G(@STORE@(INT,TM))
"RTN","SCRPTA",119,0)
 ..I (IOST?1"C-".E),$Y>(IOSL-10) D HOLD^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT)),!!,$G(@STORE@(INT,TM))
"RTN","SCRPTA",120,0)
 ..Q:STOP
"RTN","SCRPTA",121,0)
 ..S PRN=""
"RTN","SCRPTA",122,0)
 ..D HEADER
"RTN","SCRPTA",123,0)
 ..F  S PRN=$O(@STORE@("P",INT,TM,PRN)) Q:PRN=""!(STOP)  D
"RTN","SCRPTA",124,0)
 ...S PR=$O(@STORE@("P",INT,TM,PRN,"")) ;practitioner
"RTN","SCRPTA",125,0)
 ...Q:PR=""
"RTN","SCRPTA",126,0)
 ...S POS=""
"RTN","SCRPTA",127,0)
 ...F  S POS=$O(@STORE@("P",INT,TM,PRN,PR,POS)) Q:POS=""!(STOP)  D
"RTN","SCRPTA",128,0)
 ....D PRNT(INT,TM,PR,POS)
"RTN","SCRPTA",129,0)
 D CLOSE^SCRPU3
"RTN","SCRPTA",130,0)
 Q
"RTN","SCRPTA",131,0)
 ;
"RTN","SCRPTA",132,0)
PRNT(INT,TM,PR,POS) ;
"RTN","SCRPTA",133,0)
 ;INT - institution ien
"RTN","SCRPTA",134,0)
 ;TM - team ien
"RTN","SCRPTA",135,0)
 ;PR - practitioner ien
"RTN","SCRPTA",136,0)
 ;POS - position ien
"RTN","SCRPTA",137,0)
 ;
"RTN","SCRPTA",138,0)
 N PTIEN
"RTN","SCRPTA",139,0)
 S PTIEN=""
"RTN","SCRPTA",140,0)
 F  S PTIEN=$O(@STORE@(INT,TM,PR,POS,PTIEN)) Q:PTIEN=""!(STOP)  D
"RTN","SCRPTA",141,0)
 .I (IOST'?1"C-".E),$Y>(IOSL-4) D NEWP1^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT)),!!,$G(@STORE@(INT,TM)) D:'STOP HEADER
"RTN","SCRPTA",142,0)
 .I (IOST?1"C-".E),$Y>(IOSL-4) D HOLD^SCRPU3(.PAGE,TITL) W:'STOP !,$G(@STORE@(INT)),!!,$G(@STORE@(INT,TM)) D:'STOP HEADER
"RTN","SCRPTA",143,0)
 .Q:STOP
"RTN","SCRPTA",144,0)
 .W !,$G(@STORE@(INT,TM,PR,POS,PTIEN))
"RTN","SCRPTA",145,0)
 Q
"RTN","SCRPTA",146,0)
 ;
"RTN","SCRPTA",147,0)
HEADER ;
"RTN","SCRPTA",148,0)
 ;write column headers
"RTN","SCRPTA",149,0)
 N EN
"RTN","SCRPTA",150,0)
 W !
"RTN","SCRPTA",151,0)
 F EN="H1","H2","H3" D
"RTN","SCRPTA",152,0)
 .W !,$G(@STORE@(EN))
"RTN","SCRPTA",153,0)
 Q
"RTN","SCRPTA",154,0)
SHEAD ;
"RTN","SCRPTA",155,0)
 ;setup column headers
"RTN","SCRPTA",156,0)
 S @STORE@("H2")="Pt Name"
"RTN","SCRPTA",157,0)
 S $E(@STORE@("H2"),23)="Pt ID"
"RTN","SCRPTA",158,0)
 S $E(@STORE@("H2"),30)="Practitioner"
"RTN","SCRPTA",159,0)
 S $E(@STORE@("H2"),52)="Position"
"RTN","SCRPTA",160,0)
 S $E(@STORE@("H1"),70)="Date"
"RTN","SCRPTA",161,0)
 S $E(@STORE@("H2"),70)="Assigned"
"RTN","SCRPTA",162,0)
 S $P(@STORE@("H3"),"=",81)=""
"RTN","SCRPTA",163,0)
 Q
"VER")
8.0^21.0
**END**
**END**
