Released SD*5.3*521 SEQ #428
Extracted from mail message
**KIDS**:SD*5.3*521^

**INSTALL NAME**
SD*5.3*521
"BLD",7349,0)
SD*5.3*521^SCHEDULING^0^3070731^y
"BLD",7349,1,0)
^^1^1^3070731^
"BLD",7349,1,1,0)
Fix problem with ACRP transmission validation logic.
"BLD",7349,4,0)
^9.64PA^^
"BLD",7349,6.3)
1
"BLD",7349,"ABPKG")
n
"BLD",7349,"KRN",0)
^9.67PA^8989.52^19
"BLD",7349,"KRN",.4,0)
.4
"BLD",7349,"KRN",.401,0)
.401
"BLD",7349,"KRN",.402,0)
.402
"BLD",7349,"KRN",.403,0)
.403
"BLD",7349,"KRN",.5,0)
.5
"BLD",7349,"KRN",.84,0)
.84
"BLD",7349,"KRN",3.6,0)
3.6
"BLD",7349,"KRN",3.8,0)
3.8
"BLD",7349,"KRN",9.2,0)
9.2
"BLD",7349,"KRN",9.8,0)
9.8
"BLD",7349,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7349,"KRN",9.8,"NM",1,0)
SCMSVUT2^^0^B31686454
"BLD",7349,"KRN",9.8,"NM","B","SCMSVUT2",1)

"BLD",7349,"KRN",19,0)
19
"BLD",7349,"KRN",19.1,0)
19.1
"BLD",7349,"KRN",101,0)
101
"BLD",7349,"KRN",409.61,0)
409.61
"BLD",7349,"KRN",771,0)
771
"BLD",7349,"KRN",870,0)
870
"BLD",7349,"KRN",8989.51,0)
8989.51
"BLD",7349,"KRN",8989.52,0)
8989.52
"BLD",7349,"KRN",8994,0)
8994
"BLD",7349,"KRN","B",.4,.4)

"BLD",7349,"KRN","B",.401,.401)

"BLD",7349,"KRN","B",.402,.402)

"BLD",7349,"KRN","B",.403,.403)

"BLD",7349,"KRN","B",.5,.5)

"BLD",7349,"KRN","B",.84,.84)

"BLD",7349,"KRN","B",3.6,3.6)

"BLD",7349,"KRN","B",3.8,3.8)

"BLD",7349,"KRN","B",9.2,9.2)

"BLD",7349,"KRN","B",9.8,9.8)

"BLD",7349,"KRN","B",19,19)

"BLD",7349,"KRN","B",19.1,19.1)

"BLD",7349,"KRN","B",101,101)

"BLD",7349,"KRN","B",409.61,409.61)

"BLD",7349,"KRN","B",771,771)

"BLD",7349,"KRN","B",870,870)

"BLD",7349,"KRN","B",8989.51,8989.51)

"BLD",7349,"KRN","B",8989.52,8989.52)

"BLD",7349,"KRN","B",8994,8994)

"BLD",7349,"QUES",0)
^9.62^^
"BLD",7349,"REQB",0)
^9.611^1^1
"BLD",7349,"REQB",1,0)
SD*5.3*466^2
"BLD",7349,"REQB","B","SD*5.3*466",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
521^3070731
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3070731
"PKG",16,22,1,"PAH",1,1,1,0)
Fix problem with ACRP transmission validation logic.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SCMSVUT2")
0^1^B31686454^B30881760
"RTN","SCMSVUT2",1,0)
SCMSVUT2 ;ALB/JLU;Utility routine for AMBCARE;06/28/99
"RTN","SCMSVUT2",2,0)
 ;;5.3;Scheduling;**66,180,254,293,325,466,521**;AUG 13,1993;Build 1
"RTN","SCMSVUT2",3,0)
 ;06/28/99 ACS Added CPT modifier validation
"RTN","SCMSVUT2",4,0)
 ;
"RTN","SCMSVUT2",5,0)
COUNT(VALER) ;counts the number of errored encounters found.
"RTN","SCMSVUT2",6,0)
 ;INPUT VALER - The array containing the errors.
"RTN","SCMSVUT2",7,0)
 ;OUTPUT the number of errors
"RTN","SCMSVUT2",8,0)
 ;
"RTN","SCMSVUT2",9,0)
 N VAR,CNT
"RTN","SCMSVUT2",10,0)
 S VAR="",CNT=0
"RTN","SCMSVUT2",11,0)
 F  S VAR=$O(@VALER@(VAR)) Q:VAR']""  S CNT=CNT+1
"RTN","SCMSVUT2",12,0)
 Q CNT
"RTN","SCMSVUT2",13,0)
 ;
"RTN","SCMSVUT2",14,0)
IPERR(VALER) ;counts the number of inpatient errored encounters found.
"RTN","SCMSVUT2",15,0)
 ;INPUT VALER - The array containing the errors.
"RTN","SCMSVUT2",16,0)
 ;OUTPUT the number of errors
"RTN","SCMSVUT2",17,0)
 ;
"RTN","SCMSVUT2",18,0)
 N VAR,CNT
"RTN","SCMSVUT2",19,0)
 S VAR="",CNT=0
"RTN","SCMSVUT2",20,0)
 F  S VAR=$O(@VALER@(VAR)) Q:VAR']""  D
"RTN","SCMSVUT2",21,0)
 .I $$INPATENC^SCDXUTL(VAR) S CNT=CNT+1
"RTN","SCMSVUT2",22,0)
 Q CNT
"RTN","SCMSVUT2",23,0)
 ;
"RTN","SCMSVUT2",24,0)
FILEVERR(PTR,VALERR) ;files the errors found for an encounter
"RTN","SCMSVUT2",25,0)
 ;INPUT  PTR - The pointer to the entry in the transmission file 409.73
"RTN","SCMSVUT2",26,0)
 ;      VALERR - The array holding the errors for the encounter.
"RTN","SCMSVUT2",27,0)
 ;OUTPUT  0 - did not file
"RTN","SCMSVUT2",28,0)
 ;        1 - did file
"RTN","SCMSVUT2",29,0)
 N SEG,FILE
"RTN","SCMSVUT2",30,0)
 I '$D(VALERR) Q 0
"RTN","SCMSVUT2",31,0)
 S SEG="",FILE=-1
"RTN","SCMSVUT2",32,0)
 F  S SEG=$O(@VALERR@(SEG)) Q:SEG']""  D FILE(VALERR,SEG,PTR,.FILE)
"RTN","SCMSVUT2",33,0)
 Q $S(FILE=1:1,1:0)
"RTN","SCMSVUT2",34,0)
 ;
"RTN","SCMSVUT2",35,0)
FILE(VALERR,SEG,PTR,FILE) ;
"RTN","SCMSVUT2",36,0)
 N NBR
"RTN","SCMSVUT2",37,0)
 S NBR=0
"RTN","SCMSVUT2",38,0)
 F  S NBR=$O(@VALERR@(SEG,NBR)) Q:'NBR  DO
"RTN","SCMSVUT2",39,0)
 .N CODPTR,CODE
"RTN","SCMSVUT2",40,0)
 .S CODE=$G(@VALERR@(SEG,NBR))
"RTN","SCMSVUT2",41,0)
 .I CODE']"" Q
"RTN","SCMSVUT2",42,0)
 .S CODPTR=$O(^SD(409.76,"B",CODE,""))
"RTN","SCMSVUT2",43,0)
 .I 'CODPTR Q
"RTN","SCMSVUT2",44,0)
 .I $D(^SD(409.75,"AER",PTR,CODPTR)) S FILE=1 Q
"RTN","SCMSVUT2",45,0)
 .S FILE=$$CRTERR^SCDXFU02(PTR,CODE)
"RTN","SCMSVUT2",46,0)
 .Q
"RTN","SCMSVUT2",47,0)
 Q
"RTN","SCMSVUT2",48,0)
 ;
"RTN","SCMSVUT2",49,0)
VALWL(CLIN) ;WORKLOAD VALIDATION AT CHECK OUT
"RTN","SCMSVUT2",50,0)
 ;INPUT CLIN - IEN OF CLINIC
"RTN","SCMSVUT2",51,0)
 ;OUTPUT 0 - DO NOT VALIDATE WORKLOAD
"RTN","SCMSVUT2",52,0)
 ;       1 - VALIDATE CLINIC WORKLOAD
"RTN","SCMSVUT2",53,0)
 N A1
"RTN","SCMSVUT2",54,0)
 I '$D(CLIN) S CLIN=0
"RTN","SCMSVUT2",55,0)
 S A1=$P($G(^SC(+CLIN,0)),U,30)
"RTN","SCMSVUT2",56,0)
 Q $S(A1=1:1,1:0)
"RTN","SCMSVUT2",57,0)
 ;
"RTN","SCMSVUT2",58,0)
VALIDATE(XMITPTR) ;validates data that has a entry in the transmit file.
"RTN","SCMSVUT2",59,0)
 ;
"RTN","SCMSVUT2",60,0)
 ;INPUT    XMITPTR - This is the point to an entry in file 409.73.
"RTN","SCMSVUT2",61,0)
 ;
"RTN","SCMSVUT2",62,0)
 ;OUTPUT    -1 - the was a problem with the inputs
"RTN","SCMSVUT2",63,0)
 ;           0 - no errors were found
"RTN","SCMSVUT2",64,0)
 ;           1 - errors were found
"RTN","SCMSVUT2",65,0)
 ;
"RTN","SCMSVUT2",66,0)
 N VALERR,ERR,HL,HLEID,DFN
"RTN","SCMSVUT2",67,0)
 S ANS=-1
"RTN","SCMSVUT2",68,0)
 S XMITPTR=+$G(XMITPTR)
"RTN","SCMSVUT2",69,0)
 I $G(^SD(409.73,XMITPTR,0))']"" G VALQ
"RTN","SCMSVUT2",70,0)
 D PATDFN^SCDXUTL2(XMITPTR)
"RTN","SCMSVUT2",71,0)
 ;
"RTN","SCMSVUT2",72,0)
 S HL7XMIT="^TMP(""HLS"","_$J_")",VALERR="^TMP(""SCDXVALID"","_$J_","_XMITPTR_")"
"RTN","SCMSVUT2",73,0)
 ;Initialze HL7 variables
"RTN","SCMSVUT2",74,0)
 S HLEID=+$O(^ORD(101,"B","SCDX AMBCARE SEND SERVER FOR ADT-Z00",0))
"RTN","SCMSVUT2",75,0)
 I ('HLEID) G VALQ
"RTN","SCMSVUT2",76,0)
 D INIT^HLFNC2(HLEID,.HL)
"RTN","SCMSVUT2",77,0)
 I ($O(HL(""))="") G VALQ
"RTN","SCMSVUT2",78,0)
 ;
"RTN","SCMSVUT2",79,0)
 S ERR=$$BUILDHL7^SCDXMSG0(XMITPTR,.HL,1,HL7XMIT,1,VALERR)
"RTN","SCMSVUT2",80,0)
 ;
"RTN","SCMSVUT2",81,0)
 I ERR<0,$O(@VALERR@(0))']"" D VALIDATE^SCMSVUT0("INTERNAL","","V900",VALERR,0)
"RTN","SCMSVUT2",82,0)
 S ANS=0
"RTN","SCMSVUT2",83,0)
 D DELAERR^SCDXFU02(XMITPTR,0)
"RTN","SCMSVUT2",84,0)
 D DEMUPDT(DFN,VALERR,"DEMO")
"RTN","SCMSVUT2",85,0)
 I $O(@VALERR@(0))]"" DO
"RTN","SCMSVUT2",86,0)
 .N FILE
"RTN","SCMSVUT2",87,0)
 .S ANS=1
"RTN","SCMSVUT2",88,0)
 .S FILE=$$FILEVERR(XMITPTR,VALERR)
"RTN","SCMSVUT2",89,0)
 .Q
"RTN","SCMSVUT2",90,0)
 ;
"RTN","SCMSVUT2",91,0)
 K @VALERR,@HL7XMIT
"RTN","SCMSVUT2",92,0)
 ;
"RTN","SCMSVUT2",93,0)
VALQ Q ANS
"RTN","SCMSVUT2",94,0)
 ;
"RTN","SCMSVUT2",95,0)
DEMUPDT(DFN,VALERR,TYP) ;
"RTN","SCMSVUT2",96,0)
 ;This entry point updates all the other encoutners for this patient
"RTN","SCMSVUT2",97,0)
 ;that HAVE errors with a new set or demographic errors or deletes all
"RTN","SCMSVUT2",98,0)
 ;the demographic errors if none were found.
"RTN","SCMSVUT2",99,0)
 ;INPUT DFN - The patient's DFN
"RTN","SCMSVUT2",100,0)
 ;   VALERR - errors to log
"RTN","SCMSVUT2",101,0)
 ;      TYP - The type of errors to delete and log.
"RTN","SCMSVUT2",102,0)
 ;            Right now demographic errors are the only kind "DEMO"
"RTN","SCMSVUT2",103,0)
 ;
"RTN","SCMSVUT2",104,0)
 S DFN=$G(DFN),TYP=$G(TYP),VALERR=$G(VALERR)
"RTN","SCMSVUT2",105,0)
 I DFN=""!(TYP="")!(VALERR="") Q
"RTN","SCMSVUT2",106,0)
 N PTRS,RNG,LP,PTR
"RTN","SCMSVUT2",107,0)
 S RNG=$P($T(@(TYP)),";;",2),PTRS=""
"RTN","SCMSVUT2",108,0)
 D CLEAN(DFN,RNG,.PTRS)
"RTN","SCMSVUT2",109,0)
 I '$D(@VALERR@("PID")) Q
"RTN","SCMSVUT2",110,0)
 I PTRS']"" Q
"RTN","SCMSVUT2",111,0)
 F LP=1:1 S PTR=$P(PTRS,U,LP) Q:PTR']""  DO
"RTN","SCMSVUT2",112,0)
 .I '$D(^SD(409.73,PTR,0)) Q
"RTN","SCMSVUT2",113,0)
 .N FILE
"RTN","SCMSVUT2",114,0)
 .D FILE(VALERR,"PID",PTR,.FILE)
"RTN","SCMSVUT2",115,0)
 .Q
"RTN","SCMSVUT2",116,0)
 Q
"RTN","SCMSVUT2",117,0)
 ;
"RTN","SCMSVUT2",118,0)
CLEAN(DFN,RNG,PTRS) ;This subroutine cleans out all errors for a pateint
"RTN","SCMSVUT2",119,0)
 ;and returns a string of which entries in 409.73 were cleaned of errors
"RTN","SCMSVUT2",120,0)
 ;
"RTN","SCMSVUT2",121,0)
 N LP,COD,LP2,IEN
"RTN","SCMSVUT2",122,0)
 F LP=1:1 S COD=$P(RNG,U,LP) Q:COD']""  I $D(^SD(409.75,"ACOD",DFN,COD)) S IEN="" F LP2=1:1 S IEN=$O(^SD(409.75,"ACOD",DFN,COD,IEN)) Q:IEN']""  DO
"RTN","SCMSVUT2",123,0)
 .N VAR,RES
"RTN","SCMSVUT2",124,0)
 .S VAR=$P($G(^SD(409.75,IEN,0)),U,1)_"^"
"RTN","SCMSVUT2",125,0)
 .I $P(VAR,U,1)="" S PTR="" Q
"RTN","SCMSVUT2",126,0)
 .S RES=$$DELERR^SCDXFU02(IEN)
"RTN","SCMSVUT2",127,0)
 .I PTRS[VAR Q
"RTN","SCMSVUT2",128,0)
 .S PTRS=PTRS_VAR
"RTN","SCMSVUT2",129,0)
 .Q
"RTN","SCMSVUT2",130,0)
 Q
"RTN","SCMSVUT2",131,0)
 ;
"RTN","SCMSVUT2",132,0)
MODCODE(DATA,ENCDT) ;
"RTN","SCMSVUT2",133,0)
 ;
"RTN","SCMSVUT2",134,0)
 ;---------------------------------------------------------------
"RTN","SCMSVUT2",135,0)
 ;    VALIDATE MODIFIER AND CPT+MODIFIER COMBINATION
"RTN","SCMSVUT2",136,0)
 ;
"RTN","SCMSVUT2",137,0)
 ; INPUT: DATA - The procedure and modifier code to be checked 
"RTN","SCMSVUT2",138,0)
 ;               format: CPT~modifier
"RTN","SCMSVUT2",139,0)
 ;       ENCDT - The date of the encounter
"RTN","SCMSVUT2",140,0)
 ;
"RTN","SCMSVUT2",141,0)
 ;OUTPUT:    1 - valid modifier and CPT+modifier combination
"RTN","SCMSVUT2",142,0)
 ;           0 - invalid modifier or CPT+modifier combination
"RTN","SCMSVUT2",143,0)
 ;
"RTN","SCMSVUT2",144,0)
 ;**NOTE**   This call makes the assumption that leading zeros are
"RTN","SCMSVUT2",145,0)
 ;           intact in the input.
"RTN","SCMSVUT2",146,0)
 ;---------------------------------------------------------------
"RTN","SCMSVUT2",147,0)
 ;
"RTN","SCMSVUT2",148,0)
 ;- validate modifier only
"RTN","SCMSVUT2",149,0)
 N DATAMOD
"RTN","SCMSVUT2",150,0)
 S DATAMOD=$P(DATA,"~",2)
"RTN","SCMSVUT2",151,0)
 I '$D(DATAMOD) Q 0
"RTN","SCMSVUT2",152,0)
 I $$MOD^ICPTMOD(DATAMOD,"E",ENCDT,1)'>0 Q 0
"RTN","SCMSVUT2",153,0)
 ;
"RTN","SCMSVUT2",154,0)
 ;- validate CPT+modifier pair
"RTN","SCMSVUT2",155,0)
 N DATAPROC
"RTN","SCMSVUT2",156,0)
 S DATAPROC=$P(DATA,"~",1)
"RTN","SCMSVUT2",157,0)
 I '$D(DATAPROC) Q 0
"RTN","SCMSVUT2",158,0)
 I $$MODP^ICPTMOD(DATAPROC,DATAMOD,"E",ENCDT,1)'>0 Q 0
"RTN","SCMSVUT2",159,0)
 Q 1
"RTN","SCMSVUT2",160,0)
 ;
"RTN","SCMSVUT2",161,0)
MODMETH(DATA) ;
"RTN","SCMSVUT2",162,0)
 ;
"RTN","SCMSVUT2",163,0)
 ;---------------------------------------------------------------
"RTN","SCMSVUT2",164,0)
 ;    VALIDATE MODIFIER CODING METHOD
"RTN","SCMSVUT2",165,0)
 ;
"RTN","SCMSVUT2",166,0)
 ; INPUT: DATA - The modifier coding method to be checked 
"RTN","SCMSVUT2",167,0)
 ;
"RTN","SCMSVUT2",168,0)
 ;OUTPUT:    1 - valid modifier coding method
"RTN","SCMSVUT2",169,0)
 ;           0 - invalid modifier coding method
"RTN","SCMSVUT2",170,0)
 ;
"RTN","SCMSVUT2",171,0)
 ; Valid modifier coding methods: C and H
"RTN","SCMSVUT2",172,0)
 ;---------------------------------------------------------------
"RTN","SCMSVUT2",173,0)
 ;
"RTN","SCMSVUT2",174,0)
 I '$D(DATA) Q 0
"RTN","SCMSVUT2",175,0)
 S DATA=","_DATA_","
"RTN","SCMSVUT2",176,0)
 I ",C,H,"'[DATA Q 0
"RTN","SCMSVUT2",177,0)
 Q 1
"RTN","SCMSVUT2",178,0)
 ;
"RTN","SCMSVUT2",179,0)
ETHNIC(DATA)    ;
"RTN","SCMSVUT2",180,0)
 ;INPUT  DATA - the ethnicity code to be validated (NNNN-C-XXX)
"RTN","SCMSVUT2",181,0)
 ;
"RTN","SCMSVUT2",182,0)
 N VAL,MTHD
"RTN","SCMSVUT2",183,0)
 I '$D(DATA) Q 0
"RTN","SCMSVUT2",184,0)
 I DATA="" Q 1
"RTN","SCMSVUT2",185,0)
 S VAL=$P(DATA,"-",1,2)
"RTN","SCMSVUT2",186,0)
 S MTHD=$P(DATA,"-",3)
"RTN","SCMSVUT2",187,0)
 I VAL'?4N1"-"1N Q 0
"RTN","SCMSVUT2",188,0)
 I ",SLF,UNK,PRX,OBS,"'[MTHD Q 0
"RTN","SCMSVUT2",189,0)
 Q 1
"RTN","SCMSVUT2",190,0)
CONFDT(DATA,SUB)    ;CONFIDENTIAL ADDRESS START/STOP DATE
"RTN","SCMSVUT2",191,0)
 N X,Y,%DT,DTOUT,STDT,ENDT
"RTN","SCMSVUT2",192,0)
 I '$D(DATA) Q 0
"RTN","SCMSVUT2",193,0)
 S STDT=$P(DATA,SUB,1)
"RTN","SCMSVUT2",194,0)
 S ENDT=$P(DATA,SUB,2)
"RTN","SCMSVUT2",195,0)
 I STDT="" Q 0
"RTN","SCMSVUT2",196,0)
 S STDT=$$FMDATE^HLFNC(STDT)
"RTN","SCMSVUT2",197,0)
 S X=STDT,%DT="X" D ^%DT I Y=-1 Q 0  ;SD/521 added %DT
"RTN","SCMSVUT2",198,0)
 I ENDT="" Q 1
"RTN","SCMSVUT2",199,0)
 S ENDT=$$FMDATE^HLFNC(ENDT)
"RTN","SCMSVUT2",200,0)
 S X=ENDT,%DT="X" D ^%DT I Y=-1 Q 0  ;SD/521 added %DT
"RTN","SCMSVUT2",201,0)
 I $$FMDIFF^XLFDT(ENDT,STDT,1)<0 Q 0
"RTN","SCMSVUT2",202,0)
 Q 1
"RTN","SCMSVUT2",203,0)
 ;
"RTN","SCMSVUT2",204,0)
CONFCAT(DATA)             ;CONFIDENTIAL ADDRESS CATEGORY TYPE
"RTN","SCMSVUT2",205,0)
 I '$D(DATA) Q 0
"RTN","SCMSVUT2",206,0)
 I DATA="" Q 0
"RTN","SCMSVUT2",207,0)
 N VAL,GOOD
"RTN","SCMSVUT2",208,0)
 S GOOD=0
"RTN","SCMSVUT2",209,0)
 F VAL="VACAA","VACAC","VACAE","VACAM","VACAO" I DATA=VAL S GOOD=1 Q
"RTN","SCMSVUT2",210,0)
 Q GOOD
"RTN","SCMSVUT2",211,0)
 ;
"RTN","SCMSVUT2",212,0)
CVEDT(DATA) ;Combat vet end date (ZEL.38)
"RTN","SCMSVUT2",213,0)
 ;Input  : DATA - CombatVetIndicator ^ CombatVetEndDate
"RTN","SCMSVUT2",214,0)
 ;Output : 1 = Good / 0 = Bad
"RTN","SCMSVUT2",215,0)
 ;
"RTN","SCMSVUT2",216,0)
 N CVI,CVEDT
"RTN","SCMSVUT2",217,0)
 S DATA=$G(DATA)
"RTN","SCMSVUT2",218,0)
 S CVI=$P(DATA,"^",1)
"RTN","SCMSVUT2",219,0)
 S CVEDT=$P(DATA,"^",2)
"RTN","SCMSVUT2",220,0)
 I 'CVI Q $S(CVEDT="":1,1:0)
"RTN","SCMSVUT2",221,0)
 Q CVEDT?8N
"RTN","SCMSVUT2",222,0)
 ;
"RTN","SCMSVUT2",223,0)
CLCV(DATA,SDOE) ;Cross check for combat vet classification question
"RTN","SCMSVUT2",224,0)
 ;Input  : DATA - Answer to classification question
"RTN","SCMSVUT2",225,0)
 ;         SDOE - Pointer to encounter (file # 409.68)
"RTN","SCMSVUT2",226,0)
 ;Output : 1 = Good / 0 = Bad
"RTN","SCMSVUT2",227,0)
 ;
"RTN","SCMSVUT2",228,0)
 S DATA=$G(DATA)
"RTN","SCMSVUT2",229,0)
 Q:(DATA'=1) 1
"RTN","SCMSVUT2",230,0)
 N VET,SDDT,SDOE0
"RTN","SCMSVUT2",231,0)
 S SDOE=$G(SDOE) Q:'SDOE 0
"RTN","SCMSVUT2",232,0)
 S SDOE0=$G(^SCE(SDOE,0))
"RTN","SCMSVUT2",233,0)
 S SDDT=+SDOE0 Q:'SDDT 0
"RTN","SCMSVUT2",234,0)
 S DFN=+$P(SDOE0,"^",2) Q:'DFN 0
"RTN","SCMSVUT2",235,0)
 S VET=$P($$EL^SDCO22(DFN,SDOE),"^",5)
"RTN","SCMSVUT2",236,0)
 I VET'="Y" Q 0
"RTN","SCMSVUT2",237,0)
 S VET=+$$CVEDT^DGCV(DFN,SDDT)
"RTN","SCMSVUT2",238,0)
 Q $S(VET=1:1,1:0)
"RTN","SCMSVUT2",239,0)
 ;
"RTN","SCMSVUT2",240,0)
DEMO ;;2000^2030^2050^2100^2150^2200^2210^2220^2230^2240^2250^2300^2330^2360
"VER")
8.0^22.0
"BLD",7349,6)
^428
**END**
**END**
