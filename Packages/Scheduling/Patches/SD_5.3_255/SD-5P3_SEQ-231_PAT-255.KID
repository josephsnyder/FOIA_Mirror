Released SD*5.3*255 SEQ #231
Extracted from mail message
**KIDS**:SD*5.3*255^

**INSTALL NAME**
SD*5.3*255
"BLD",3640,0)
SD*5.3*255^SCHEDULING^0^3011022^y
"BLD",3640,4,0)
^9.64PA^^
"BLD",3640,"KRN",0)
^9.67PA^8989.52^19
"BLD",3640,"KRN",.4,0)
.4
"BLD",3640,"KRN",.401,0)
.401
"BLD",3640,"KRN",.402,0)
.402
"BLD",3640,"KRN",.403,0)
.403
"BLD",3640,"KRN",.5,0)
.5
"BLD",3640,"KRN",.84,0)
.84
"BLD",3640,"KRN",3.6,0)
3.6
"BLD",3640,"KRN",3.8,0)
3.8
"BLD",3640,"KRN",9.2,0)
9.2
"BLD",3640,"KRN",9.8,0)
9.8
"BLD",3640,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",3640,"KRN",9.8,"NM",1,0)
SCUTBK11^^0^B27718164
"BLD",3640,"KRN",9.8,"NM","B","SCUTBK11",1)

"BLD",3640,"KRN",19,0)
19
"BLD",3640,"KRN",19.1,0)
19.1
"BLD",3640,"KRN",101,0)
101
"BLD",3640,"KRN",409.61,0)
409.61
"BLD",3640,"KRN",771,0)
771
"BLD",3640,"KRN",870,0)
870
"BLD",3640,"KRN",8989.51,0)
8989.51
"BLD",3640,"KRN",8989.52,0)
8989.52
"BLD",3640,"KRN",8994,0)
8994
"BLD",3640,"KRN","B",.4,.4)

"BLD",3640,"KRN","B",.401,.401)

"BLD",3640,"KRN","B",.402,.402)

"BLD",3640,"KRN","B",.403,.403)

"BLD",3640,"KRN","B",.5,.5)

"BLD",3640,"KRN","B",.84,.84)

"BLD",3640,"KRN","B",3.6,3.6)

"BLD",3640,"KRN","B",3.8,3.8)

"BLD",3640,"KRN","B",9.2,9.2)

"BLD",3640,"KRN","B",9.8,9.8)

"BLD",3640,"KRN","B",19,19)

"BLD",3640,"KRN","B",19.1,19.1)

"BLD",3640,"KRN","B",101,101)

"BLD",3640,"KRN","B",409.61,409.61)

"BLD",3640,"KRN","B",771,771)

"BLD",3640,"KRN","B",870,870)

"BLD",3640,"KRN","B",8989.51,8989.51)

"BLD",3640,"KRN","B",8989.52,8989.52)

"BLD",3640,"KRN","B",8994,8994)

"BLD",3640,"QUES",0)
^9.62^^
"BLD",3640,"REQB",0)
^9.611^1^1
"BLD",3640,"REQB",1,0)
SD*5.3*209^2
"BLD",3640,"REQB","B","SD*5.3*209",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
255^3011022^1934
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SCUTBK11")
0^1^B27718164
"RTN","SCUTBK11",1,0)
SCUTBK11 ;ALB/SCK - Scheduling Broker Utilities; 2/2/96 ; 10/3/01 4:30pm
"RTN","SCUTBK11",2,0)
 ;;5.3;Scheduling;**41,54,86,148,177,205,209,255**;AUG 13, 1993
"RTN","SCUTBK11",3,0)
 ;
"RTN","SCUTBK11",4,0)
 Q
"RTN","SCUTBK11",5,0)
PARSE(SC) ;
"RTN","SCUTBK11",6,0)
 S SCDFN=$G(SC("DFN"),"")
"RTN","SCUTBK11",7,0)
 S SCPIEN=$G(SC("PIEN"),"")
"RTN","SCUTBK11",8,0)
 S:$D(SC("TEAM")) SCTM=$G(SC("TEAM"))
"RTN","SCUTBK11",9,0)
 S:$D(SC("BEGIN")) SCDT("BEGIN")=$G(SC("BEGIN"))
"RTN","SCUTBK11",10,0)
 S:$D(SC("END")) SCDT("END")=$G(SC("END"))
"RTN","SCUTBK11",11,0)
 I $D(SC("END")) S SCDT("INCL")=0
"RTN","SCUTBK11",12,0)
 S SCFILE=$G(SC("FILE"))
"RTN","SCUTBK11",13,0)
 S SCIEN=$G(SC("IEN"))
"RTN","SCUTBK11",14,0)
 S SCFIELD=$G(SC("FIELD"))
"RTN","SCUTBK11",15,0)
 S SCVAL=$G(SC("VALUE"))
"RTN","SCUTBK11",16,0)
 Q
"RTN","SCUTBK11",17,0)
 ;
"RTN","SCUTBK11",18,0)
TMLST(SCDATA,SC) ;
"RTN","SCUTBK11",19,0)
 ;  -- Return a list of teams for a patient.  Pass in the DFN and
"RTN","SCUTBK11",20,0)
 ;     optionally a date range and/or a team purpose to restrict the
"RTN","SCUTBK11",21,0)
 ;     team look up.  Return only the team entry, strip out any other
"RTN","SCUTBK11",22,0)
 ;     array items.
"RTN","SCUTBK11",23,0)
 ;
"RTN","SCUTBK11",24,0)
 N DFN,SCDT,SCPURP,SCLIST,SCER1,SCOK,SCD
"RTN","SCUTBK11",25,0)
 ;
"RTN","SCUTBK11",26,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",27,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",28,0)
 ;
"RTN","SCUTBK11",29,0)
 S DFN=$G(SC("DFN"))
"RTN","SCUTBK11",30,0)
 S SCDT("BEGIN")=$G(SC("BEGIN"),"")
"RTN","SCUTBK11",31,0)
 I $L(SCDT("BEGIN"))>2 S SCDT("INCL")=$G(SC("INCL"),0)
"RTN","SCUTBK11",32,0)
 S SCDT("END")=$G(SC("END"),"")
"RTN","SCUTBK11",33,0)
 S SCPURP=$G(SC("PURP"),"")
"RTN","SCUTBK11",34,0)
 ;
"RTN","SCUTBK11",35,0)
 S SCOK=$$TMPT^SCAPMC3(DFN,"SCDT","","SCD","SCER1")
"RTN","SCUTBK11",36,0)
 ;
"RTN","SCUTBK11",37,0)
 S I=0 F  S I=$O(SCD(I)) Q:'I  S SCDATA(I)=SCD(I)
"RTN","SCUTBK11",38,0)
TMQ Q
"RTN","SCUTBK11",39,0)
 ;
"RTN","SCUTBK11",40,0)
FINDP(SCOUT,SCIN) ; patient lookup used by SC PATIENT LOOKUP rpc
"RTN","SCUTBK11",41,0)
 ; input:
"RTN","SCUTBK11",42,0)
 ;   SCIN("VALUE") = value to lookup
"RTN","SCUTBK11",43,0)
 ;     Lookup uses multiple index lookup of File #2
"RTN","SCUTBK11",44,0)
 ; output:
"RTN","SCUTBK11",45,0)
 ;   SCOUT = location of data = ^TMP("DILIST",$J,i,0)
"RTN","SCUTBK11",46,0)
 ;   for i=1:number of records returned: 
"RTN","SCUTBK11",47,0)
 ;    DFN^patient name^DOB^PID
"RTN","SCUTBK11",48,0)
 ;     1        2       3   4
"RTN","SCUTBK11",49,0)
 ;
"RTN","SCUTBK11",50,0)
 ;bp/cmf 205 original code next line
"RTN","SCUTBK11",51,0)
 ;D FIND^DIC(2,,".01;.03;.363;.09","MPS",SCIN("VALUE"),500)
"RTN","SCUTBK11",52,0)
 ;bp/cmf 205 change code next line
"RTN","SCUTBK11",53,0)
 D FIND^DIC(2,,".01;.03;.363;.09","PS",SCIN("VALUE"),300,"B^BS^BS5^SSN")
"RTN","SCUTBK11",54,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","SCUTBK11",55,0)
 N SCOUNT S SCOUNT=+^TMP("DILIST",$J,0)
"RTN","SCUTBK11",56,0)
 N SC F SC=1:1:SCOUNT D
"RTN","SCUTBK11",57,0)
 . N NODE,SSN,DSSN,PLID
"RTN","SCUTBK11",58,0)
 . S NODE=^TMP("DILIST",$J,SC,0)
"RTN","SCUTBK11",59,0)
 . ;Apply DOB screen
"RTN","SCUTBK11",60,0)
 . S $P(NODE,U,3)=$$DOB^DPTLK1(+NODE)
"RTN","SCUTBK11",61,0)
 . ;Apply SSN screen
"RTN","SCUTBK11",62,0)
 . S SSN=$$SSN^DPTLK1(+NODE)
"RTN","SCUTBK11",63,0)
 . S DSSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,11)
"RTN","SCUTBK11",64,0)
 . S PLID=$P(NODE,U,4)
"RTN","SCUTBK11",65,0)
 . I $E(SSN,1,9)'?9N S (DSSN,PLID)=SSN
"RTN","SCUTBK11",66,0)
 . S $P(NODE,U,4)=$S($L(PLID)>5:PLID,1:DSSN)
"RTN","SCUTBK11",67,0)
 . ;Move screened data back into output global
"RTN","SCUTBK11",68,0)
 . S ^TMP("DILIST",$J,SC,0)=$P(NODE,U,1,4)
"RTN","SCUTBK11",69,0)
 K ^TMP("DILIST",$J,0)
"RTN","SCUTBK11",70,0)
 K SCOUT S SCOUT="^TMP(""DILIST"","_$J_")"
"RTN","SCUTBK11",71,0)
 Q
"RTN","SCUTBK11",72,0)
PSLST(SCDATA,SC) ;
"RTN","SCUTBK11",73,0)
 ;
"RTN","SCUTBK11",74,0)
 ;  - Returns a array of positions that show the person currently
"RTN","SCUTBK11",75,0)
 ;    assigned to the position, the preceptor for that position,
"RTN","SCUTBK11",76,0)
 ;    for the patient is assigned to.
"RTN","SCUTBK11",77,0)
 ;
"RTN","SCUTBK11",78,0)
 ;    Pass in the Patient's DFN
"RTN","SCUTBK11",79,0)
 ;    To restrict to specific entries, pass in the following:
"RTN","SCUTBK11",80,0)
 ;      Beginning and Ending Date Range 
"RTN","SCUTBK11",81,0)
 ;      A specific Team Position
"RTN","SCUTBK11",82,0)
 ;      A Specific User entry (8930)
"RTN","SCUTBK11",83,0)
 ;      A specific Team Purpose.  (Read SCAPMC23 for how it exclude
"RTN","SCUTBK11",84,0)
 ;        a specific team purpose.
"RTN","SCUTBK11",85,0)
 ;      A specific role
"RTN","SCUTBK11",86,0)
 ;      Flag whether to include patients associated by enrollement
"RTN","SCUTBK11",87,0)
 ;    
"RTN","SCUTBK11",88,0)
 N SCDT,SCD,SCER1,SCDFN,SCPRP,SCPST,SCRLE,SCIND,SCUSR,SCTM,SCDTE
"RTN","SCUTBK11",89,0)
 ;
"RTN","SCUTBK11",90,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",91,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",92,0)
 ;
"RTN","SCUTBK11",93,0)
 D PARSE(.SC)
"RTN","SCUTBK11",94,0)
 S SCDTE=$G(SCDT("BEGIN"))
"RTN","SCUTBK11",95,0)
 ;
"RTN","SCUTBK11",96,0)
 S CNT=0
"RTN","SCUTBK11",97,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",98,0)
 S SCOK=$$TPPT^SCAPMC(SCDFN,.SCDT,"","","","","","SCD","SCER1")
"RTN","SCUTBK11",99,0)
 S I=0 F  S I=$O(SCD(I)) Q:'I  D
"RTN","SCUTBK11",100,0)
 . I $D(SCTM) D
"RTN","SCUTBK11",101,0)
 .. Q:$P(SCD(I),U,3)'=SCTM
"RTN","SCUTBK11",102,0)
 .. S ^TMP($J,"PSLST",I)=$P($G(SCD(I)),U,3)_U_$P($G(SCD(I)),U,4)_U_$P($G(SCD(I)),U,1,2)_U_$P($G(SCD(I)),U,7,8)
"RTN","SCUTBK11",103,0)
 . ;
"RTN","SCUTBK11",104,0)
 . I '$D(SCTM) D
"RTN","SCUTBK11",105,0)
 .. S ^TMP($J,"PSLST",I)=$P($G(SCD(I)),U,3)_U_$P($G(SCD(I)),U,4)_U_$P($G(SCD(I)),U,1,2)_U_$P($G(SCD(I)),U,7,8)
"RTN","SCUTBK11",106,0)
 ;
"RTN","SCUTBK11",107,0)
 S CNT=0
"RTN","SCUTBK11",108,0)
 S I=""
"RTN","SCUTBK11",109,0)
 F  S I=$O(^TMP($J,"PSLST",I)) Q:'I  D
"RTN","SCUTBK11",110,0)
 . S:'$D(SCDTE) SCDTE=DT
"RTN","SCUTBK11",111,0)
 . S SCPIEN=$P($G(^TMP($J,"PSLST",I)),U,3)
"RTN","SCUTBK11",112,0)
 . S SCDATA(CNT)=^TMP($J,"PSLST",I)_U_$$PSMBR(SCPIEN,SCDTE)_U_+$P($G(^SCPT(404.43,$P($G(^TMP($J,"PSLST",I)),U,2),0)),U,5)_U_+$P($G(^SCTM(404.57,SCPIEN,0)),U,4)
"RTN","SCUTBK11",113,0)
 . S CNT=CNT+1
"RTN","SCUTBK11",114,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",115,0)
 ;
"RTN","SCUTBK11",116,0)
PSLTQ Q
"RTN","SCUTBK11",117,0)
 ;
"RTN","SCUTBK11",118,0)
PSMBR(SCPIEN,SCPDT) ;
"RTN","SCUTBK11",119,0)
 ;
"RTN","SCUTBK11",120,0)
 N SCPRCP,SCMBR,SCPP
"RTN","SCUTBK11",121,0)
 ;
"RTN","SCUTBK11",122,0)
 S SCMBR=$$GETPRTP^SCAPMCU2(SCPIEN,SCPDT)
"RTN","SCUTBK11",123,0)
 S SCMBR=$S(+SCMBR>0:SCMBR,1:U)
"RTN","SCUTBK11",124,0)
 S SCPP=$$OKPREC2^SCMCLK(SCPIEN,SCPDT)
"RTN","SCUTBK11",125,0)
 S SCPRCP=$S(+SCPP>0:SCPP,1:U)
"RTN","SCUTBK11",126,0)
 Q SCMBR_U_SCPRCP
"RTN","SCUTBK11",127,0)
 ;
"RTN","SCUTBK11",128,0)
VFILE(SCOK,SC) ;
"RTN","SCUTBK11",129,0)
 N SCFILE,SCIEN,SCFIELD,SCVAL,SCFDA,SCMSG
"RTN","SCUTBK11",130,0)
 ;
"RTN","SCUTBK11",131,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",132,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",133,0)
 ;
"RTN","SCUTBK11",134,0)
 S SCOK=1
"RTN","SCUTBK11",135,0)
 D PARSE(.SC)
"RTN","SCUTBK11",136,0)
 S SCFDA(SCFILE,""_SCIEN_","_"",SCFIELD)=SCVAL
"RTN","SCUTBK11",137,0)
 ;
"RTN","SCUTBK11",138,0)
 D FILE^DIE("K","SCFDA","SCMSG")
"RTN","SCUTBK11",139,0)
 ;
"RTN","SCUTBK11",140,0)
 I $D(SCMSG("DIERR")) D
"RTN","SCUTBK11",141,0)
 . S SCOK=0
"RTN","SCUTBK11",142,0)
 Q
"RTN","SCUTBK11",143,0)
 ;
"RTN","SCUTBK11",144,0)
SECKEY(SCOK,SCKEY) ;
"RTN","SCUTBK11",145,0)
 ;
"RTN","SCUTBK11",146,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",147,0)
 ;
"RTN","SCUTBK11",148,0)
 S SCOK=$D(^XUSEC(SCKEY,DUZ))
"RTN","SCUTBK11",149,0)
 Q
"RTN","SCUTBK11",150,0)
 ;
"RTN","SCUTBK11",151,0)
PSALST(SCDATA,SC) ;
"RTN","SCUTBK11",152,0)
 ;
"RTN","SCUTBK11",153,0)
 ;  - Returns a array of positions that show the person currently
"RTN","SCUTBK11",154,0)
 ;    assigned to the position, the preceptor for that position,
"RTN","SCUTBK11",155,0)
 ;    for the patient is assigned to.
"RTN","SCUTBK11",156,0)
 ;
"RTN","SCUTBK11",157,0)
 ;    Pass in the Patient's DFN
"RTN","SCUTBK11",158,0)
 ;    To restrict to specific entries, pass in the following:
"RTN","SCUTBK11",159,0)
 ;      Beginning and Ending Date Range 
"RTN","SCUTBK11",160,0)
 ;      A specific Team Position
"RTN","SCUTBK11",161,0)
 ;      A Specific User entry (8930)
"RTN","SCUTBK11",162,0)
 ;      A specific Team Purpose.  (Read SCAPMC23 for how it exclude
"RTN","SCUTBK11",163,0)
 ;        a specific team purpose.
"RTN","SCUTBK11",164,0)
 ;      A specific role
"RTN","SCUTBK11",165,0)
 ;      Flag whether to include patients associated by enrollement
"RTN","SCUTBK11",166,0)
 ;    
"RTN","SCUTBK11",167,0)
 N SCDT,SCD,SCER1,SCDFN,SCPRP,SCPST,SCRLE,SCIND,SCUSR,SCTM,SCDTE,SCPTTMA
"RTN","SCUTBK11",168,0)
 ;
"RTN","SCUTBK11",169,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",170,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",171,0)
 ;
"RTN","SCUTBK11",172,0)
 D PARSE(.SC)
"RTN","SCUTBK11",173,0)
 S SCPTTMA=$G(SC("TEAMASSIGN")) ;NEW JLU
"RTN","SCUTBK11",174,0)
 S SCDTE=$G(SCDT("BEGIN"),DT)   ;bp/cmf 177 added DT for gui
"RTN","SCUTBK11",175,0)
 ;
"RTN","SCUTBK11",176,0)
 S CNT=0
"RTN","SCUTBK11",177,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",178,0)
 S SCOK=$$TPPT^SCAPMC(SCDFN,.SCDT,"","","","","","SCD","SCER1")
"RTN","SCUTBK11",179,0)
 S I=0 F  S I=$O(SCD(I)) Q:'I  D
"RTN","SCUTBK11",180,0)
 .Q:$P(SCD(I),U,11)'=SCPTTMA
"RTN","SCUTBK11",181,0)
 .S ^TMP($J,"PSLST",I)=$P($G(SCD(I)),U,3)_U_$P($G(SCD(I)),U,4)_U_$P($G(SCD(I)),U,1,2)_U_$P($G(SCD(I)),U,7,8)
"RTN","SCUTBK11",182,0)
 ;
"RTN","SCUTBK11",183,0)
 S CNT=0
"RTN","SCUTBK11",184,0)
 S I=""
"RTN","SCUTBK11",185,0)
 F  S I=$O(^TMP($J,"PSLST",I)) Q:'I  D
"RTN","SCUTBK11",186,0)
 . S:'$D(SCDTE) SCDTE=DT
"RTN","SCUTBK11",187,0)
 . S SCPIEN=$P($G(^TMP($J,"PSLST",I)),U,3)
"RTN","SCUTBK11",188,0)
 . S SCDATA(CNT)=^TMP($J,"PSLST",I)_U_$$PSMBR(SCPIEN,SCDTE)_U_+$P($G(^SCPT(404.43,$P($G(^TMP($J,"PSLST",I)),U,2),0)),U,5)_U_+$P($G(^SCTM(404.57,SCPIEN,0)),U,4)
"RTN","SCUTBK11",189,0)
 . S CNT=CNT+1
"RTN","SCUTBK11",190,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",191,0)
 ;
"RTN","SCUTBK11",192,0)
PSALSTQ Q
"VER")
8.0^22
**END**
**END**
