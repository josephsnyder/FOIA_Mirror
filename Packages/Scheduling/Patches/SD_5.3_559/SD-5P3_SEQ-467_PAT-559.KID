Released SD*5.3*559 SEQ #467
Extracted from mail message
**KIDS**:SD*5.3*559^

**INSTALL NAME**
SD*5.3*559
"BLD",8107,0)
SD*5.3*559^SCHEDULING^0^3100721^y
"BLD",8107,1,0)
^^2^2^3090804^
"BLD",8107,1,1,0)
Patch fixes 2 discrepancies with the ACRP Ad Hoc report.
"BLD",8107,1,2,0)
.
"BLD",8107,4,0)
^9.64PA^^
"BLD",8107,6)
2^
"BLD",8107,6.3)
10
"BLD",8107,"ABPKG")
n
"BLD",8107,"KRN",0)
^9.67PA^779.2^20
"BLD",8107,"KRN",.4,0)
.4
"BLD",8107,"KRN",.401,0)
.401
"BLD",8107,"KRN",.402,0)
.402
"BLD",8107,"KRN",.403,0)
.403
"BLD",8107,"KRN",.5,0)
.5
"BLD",8107,"KRN",.84,0)
.84
"BLD",8107,"KRN",3.6,0)
3.6
"BLD",8107,"KRN",3.8,0)
3.8
"BLD",8107,"KRN",9.2,0)
9.2
"BLD",8107,"KRN",9.8,0)
9.8
"BLD",8107,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8107,"KRN",9.8,"NM",1,0)
SCRPW26^^0^B70913616
"BLD",8107,"KRN",9.8,"NM","B","SCRPW26",1)

"BLD",8107,"KRN",19,0)
19
"BLD",8107,"KRN",19.1,0)
19.1
"BLD",8107,"KRN",101,0)
101
"BLD",8107,"KRN",409.61,0)
409.61
"BLD",8107,"KRN",771,0)
771
"BLD",8107,"KRN",779.2,0)
779.2
"BLD",8107,"KRN",870,0)
870
"BLD",8107,"KRN",8989.51,0)
8989.51
"BLD",8107,"KRN",8989.52,0)
8989.52
"BLD",8107,"KRN",8994,0)
8994
"BLD",8107,"KRN","B",.4,.4)

"BLD",8107,"KRN","B",.401,.401)

"BLD",8107,"KRN","B",.402,.402)

"BLD",8107,"KRN","B",.403,.403)

"BLD",8107,"KRN","B",.5,.5)

"BLD",8107,"KRN","B",.84,.84)

"BLD",8107,"KRN","B",3.6,3.6)

"BLD",8107,"KRN","B",3.8,3.8)

"BLD",8107,"KRN","B",9.2,9.2)

"BLD",8107,"KRN","B",9.8,9.8)

"BLD",8107,"KRN","B",19,19)

"BLD",8107,"KRN","B",19.1,19.1)

"BLD",8107,"KRN","B",101,101)

"BLD",8107,"KRN","B",409.61,409.61)

"BLD",8107,"KRN","B",771,771)

"BLD",8107,"KRN","B",779.2,779.2)

"BLD",8107,"KRN","B",870,870)

"BLD",8107,"KRN","B",8989.51,8989.51)

"BLD",8107,"KRN","B",8989.52,8989.52)

"BLD",8107,"KRN","B",8994,8994)

"BLD",8107,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8107,"QUES",0)
^9.62^^
"BLD",8107,"REQB",0)
^9.611^1^1
"BLD",8107,"REQB",1,0)
SD*5.3*461^2
"BLD",8107,"REQB","B","SD*5.3*461",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
559^3100721^123457115
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^3100721
"PKG",16,22,1,"PAH",1,1,1,0)
Patch fixes 2 discrepancies with the ACRP Ad Hoc report.
"PKG",16,22,1,"PAH",1,1,2,0)
.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SCRPW26")
0^1^B70913616^B65015009
"RTN","SCRPW26",1,0)
SCRPW26 ;RENO/KEITH - ACRP Ad Hoc Report (cont.) ; 18 Nov 98  3:31 PM
"RTN","SCRPW26",2,0)
 ;;5.3;Scheduling;**144,166,370,461,559**;AUG 13, 1993;Build 10
"RTN","SCRPW26",3,0)
RPT I '$D(ZTQUEUED),$E(IOST)="C" D WAIT^DICD
"RTN","SCRPW26",4,0)
 D BLD^SCRPW21 S SDXY=^%ZOSF("XY")
"RTN","SCRPW26",5,0)
 F SDI="DSV","M1","MASTER","TOT","RPT","DET","RPTAP","RPTDX","RPTTAP","RPTTDX" K ^TMP("SCRPW",$J,SDI)
"RTN","SCRPW26",6,0)
 S T="~",(SDSTOP,SDOUT)=0,SDT=$P(SDPAR("L",1),U),SDO(1)=$P(SDPAR("O",1),U) F SDI=1:1:6 S SDF(SDI)=$P($G(SDPAR("F",SDI)),U)
"RTN","SCRPW26",7,0)
 S SDI=2 F  S SDI=$O(SDPAR("L",SDI)) Q:'SDI  S SDX=$P(SDPAR("L",SDI),U)_$P(SDPAR("L",SDI,1),U),SDPAR("LPX",SDX,SDI)=""
"RTN","SCRPW26",8,0)
 S SDYR=1,SDEDT=$P(SDPAR("L",2),U)+.999999 D R0 G:SDOUT RX
"RTN","SCRPW26",9,0)
 I SDF(2) S SDT=$P(SDPAR("L",1),U)-10000,SDEDT=SDEDT-10000,SDYR=2 D R0 G:SDOUT RX
"RTN","SCRPW26",10,0)
 I SDF(5)>0 D R6 G:SDOUT RX
"RTN","SCRPW26",11,0)
 F SDI="TOT","RPT" Q:SDOUT  D R7,STOP
"RTN","SCRPW26",12,0)
 G:SDOUT RX D R8,STOP G:SDOUT RX G PRT^SCRPW27
"RTN","SCRPW26",13,0)
 ;
"RTN","SCRPW26",14,0)
RX G EXIT^SCRPW27
"RTN","SCRPW26",15,0)
 ;
"RTN","SCRPW26",16,0)
STOP ;Check for stop task request
"RTN","SCRPW26",17,0)
 S:$D(ZTQUEUED) (SDOUT,ZTSTOP)=$S($$S^%ZTLOAD:1,1:0) Q
"RTN","SCRPW26",18,0)
 ;
"RTN","SCRPW26",19,0)
R0 F  S SDT=$O(^SCE("B",SDT)) Q:'SDT!(SDT>SDEDT)!SDOUT  S SDOE=0 F  S SDOE=$O(^SCE("B",SDT,SDOE)) Q:'SDOE!SDOUT  S SDOE0=$$GETOE^SDOE(SDOE) I $P(SDOE0,U,2),$P(SDOE0,U,4),'$P(SDOE0,U,6) D R1
"RTN","SCRPW26",20,0)
 Q
"RTN","SCRPW26",21,0)
R1 ;Evaluate perspective
"RTN","SCRPW26",22,0)
 S SDSTOP=SDSTOP+1 D:SDSTOP#3000=0 STOP Q:SDOUT
"RTN","SCRPW26",23,0)
 ;CHECK FOR TEST PATIENT
"RTN","SCRPW26",24,0)
 I $D(^DPT("ATEST",$P(SDOE0,U,2))) Q
"RTN","SCRPW26",25,0)
 K SDPER Q:'$$EVAL("P",1)  M SDPER=SDX
"RTN","SCRPW26",26,0)
R2 ;Evaluate limitations
"RTN","SCRPW26",27,0)
 ; SD*5.3*559 fixes bug whereby if 2 exclude lists are included for the same Limitation, 2nd exclude is essentially ignored, i.e., Limitation: OE/DV/Exclude list and Limitation: OE/ST/Exclude list.
"RTN","SCRPW26",28,0)
 N SDXPAR,SDXPAR1,SDNN,SDFLAG,SDSAVE
"RTN","SCRPW26",29,0)
 S (SDXPAR,SDXPAR1)="",SDNN=2,SDFLAG=1,SDSAVE=0
"RTN","SCRPW26",30,0)
 I $O(SDPAR("L",SDNN)) S SDNN=$O(SDPAR("L",SDNN)) S:SDNN SDXPAR=$G(SDPAR("L",SDNN)) I SDNN S SDN1=0,SDN1=$O(SDPAR("L",SDNN,SDN1)) S:SDN1 SDXPAR1=$G(SDPAR("L",SDNN,SDN1))  ; SD*559 added 2nd IF and what follows it
"RTN","SCRPW26",31,0)
 S SDFOUND=1,SDS2=2 F  S SDS2=$O(SDPAR("L",SDS2)) Q:'SDS2  D
"RTN","SCRPW26",32,0)
 . I $D(SDXPAR) S:SDXPAR'=$G(SDPAR("L",SDS2)) SDFLAG=0
"RTN","SCRPW26",33,0)
 . I $D(SDXPAR1) S SDN11=0,SDN11=$O(SDPAR("L",SDS2,SDN11)) I SDN11 S:SDXPAR1'=$G(SDPAR("L",SDS2,SDN11)) SDFLAG=0  ; SD*559 added
"RTN","SCRPW26",34,0)
 . S:SDFLAG SDFOUND=1
"RTN","SCRPW26",35,0)
 . S:'$$EVAL("L",SDS2) SDFOUND=0
"RTN","SCRPW26",36,0)
 . I SDFOUND I SDFLAG S SDSAVE=1
"RTN","SCRPW26",37,0)
 . I 'SDFLAG I 'SDFOUND S SDSAVE=0
"RTN","SCRPW26",38,0)
 S:SDSAVE SDFOUND=SDSAVE
"RTN","SCRPW26",39,0)
 Q:'SDFOUND  S (SDTOT,SDI)=0 F  S SDI=$O(SDPER(SDI)) Q:'SDI  S SDPER=SDPER(SDI) S:$G(SDPAR("P",1,6))="D" SDPER=$P(SDPER,U,2)_U_$P(SDPER,U) D R3
"RTN","SCRPW26",40,0)
 K SDXPAR,SDXPAR1,SDNN,SDN1,SDN11,SDFLAG
"RTN","SCRPW26",41,0)
 Q
"RTN","SCRPW26",42,0)
 ;
"RTN","SCRPW26",43,0)
R3 S DFN=$P(SDOE0,U,2)
"RTN","SCRPW26",44,0)
 S:'SDTOT ^TMP("SCRPW",$J,"TOT",SDYR,1,1,DFN,$P(SDT,"."))="",^TMP("SCRPW",$J,"TOT",SDYR,1,1,"ENC")=$G(^TMP("SCRPW",$J,"TOT",SDYR,1,1,"ENC"))+1,SDTOT=1
"RTN","SCRPW26",45,0)
 S ^TMP("SCRPW",$J,"M1",$P(SDPER,U,2),$P(SDPER,U))=""
"RTN","SCRPW26",46,0)
 S ^TMP("SCRPW",$J,"RPT",SDYR,$P(SDPER,U,2),$P(SDPER,U),DFN,$P(SDT,"."))="",^TMP("SCRPW",$J,"RPT",SDYR,$P(SDPER,U,2),$P(SDPER,U),"ENC")=$G(^TMP("SCRPW",$J,"RPT",SDYR,$P(SDPER,U,2),$P(SDPER,U),"ENC"))+1
"RTN","SCRPW26",47,0)
 I $L(SDF(3)),"EB"[SDF(3) S SDPNAM=$P($G(^DPT(DFN,0)),U) I $L(SDPNAM) S ^TMP("SCRPW",$J,"DET",$$DSV(SDPER),SDPNAM,DFN,$P(SDT,"."),SDT,SDOE)=$P(SDOE0,U,4)
"RTN","SCRPW26",48,0)
 Q:(SDF(5)<1)!(SDYR=2)
"RTN","SCRPW26",49,0)
 D APAC^SCRPW24(.SDX) S SDII=0 F  S SDII=$O(SDX(SDII)) Q:'SDII  D R4
"RTN","SCRPW26",50,0)
 D DXPD^SCRPW24(.SDX) S SDII=0 F  S SDII=$O(SDX(SDII)) Q:'SDII  D R5(1)
"RTN","SCRPW26",51,0)
 D DXSD^SCRPW24(.SDX) S SDII=0 F  S SDII=$O(SDX(SDII)) Q:'SDII  D R5(2)
"RTN","SCRPW26",52,0)
 Q
"RTN","SCRPW26",53,0)
 ;
"RTN","SCRPW26",54,0)
R4 S SDX=SDX(SDII) Q:$P(SDX,U)="~~~NONE~~~"  S SDQT=$P(SDX,U,3) S:'SDQT SDQT=1
"RTN","SCRPW26",55,0)
 S ^TMP("SCRPW",$J,"RPTAP",SDYR,$P(SDPER,U,2),$P(SDPER,U),$P(SDX,U,2))=$G(^TMP("SCRPW",$J,"RPTAP",SDYR,$P(SDPER,U,2),$P(SDPER,U),$P(SDX,U,2)))+SDQT Q
"RTN","SCRPW26",56,0)
 ;
"RTN","SCRPW26",57,0)
R5(SDZ) S SDX=SDX(SDII) Q:$P(SDX,U)="~~~NONE~~~"
"RTN","SCRPW26",58,0)
 F SDIII=SDZ,3 S $P(^TMP("SCRPW",$J,"RPTDX",SDYR,$P(SDPER,U,2),$P(SDPER,U),$P(SDX,U,2)),U,SDIII)=$P($G(^TMP("SCRPW",$J,"RPTDX",SDYR,$P(SDPER,U,2),$P(SDPER,U),$P(SDX,U,2))),U,SDIII)+1
"RTN","SCRPW26",59,0)
 Q
"RTN","SCRPW26",60,0)
 ;
"RTN","SCRPW26",61,0)
DSV(SDPER) ;Encrypt detail sort values
"RTN","SCRPW26",62,0)
 N SDX S SDX=$G(^TMP("SCRPW",$J,"DSV",$P(SDPER,U,2),$P(SDPER,U))) Q:SDX SDX
"RTN","SCRPW26",63,0)
 S (SDX,^TMP("SCRPW",$J,"DSV",0))=$G(^TMP("SCRPW",$J,"DSV",0))+1
"RTN","SCRPW26",64,0)
 S ^TMP("SCRPW",$J,"DSV",$P(SDPER,U,2),$P(SDPER,U))=SDX Q SDX
"RTN","SCRPW26",65,0)
 ;
"RTN","SCRPW26",66,0)
R6 S SDS1="" F  S SDS1=$O(^TMP("SCRPW",$J,"RPTAP",SDS1)) Q:SDS1=""  S SDS2="" F  S SDS2=$O(^TMP("SCRPW",$J,"RPTAP",SDS1,SDS2)) Q:SDS2=""  D R6A
"RTN","SCRPW26",67,0)
 D STOP Q:SDOUT
"RTN","SCRPW26",68,0)
 S SDS1="" F  S SDS1=$O(^TMP("SCRPW",$J,"RPTDX",SDS1)) Q:SDS1=""  S SDS2="" F  S SDS2=$O(^TMP("SCRPW",$J,"RPTDX",SDS1,SDS2)) Q:SDS2=""  D R6B
"RTN","SCRPW26",69,0)
 D STOP Q
"RTN","SCRPW26",70,0)
 ;
"RTN","SCRPW26",71,0)
R6A S SDS3="" F  S SDS3=$O(^TMP("SCRPW",$J,"RPTAP",SDS1,SDS2,SDS3)) Q:SDS3=""  S SDS4="" F  S SDS4=$O(^TMP("SCRPW",$J,"RPTAP",SDS1,SDS2,SDS3,SDS4)) Q:SDS4=""  D R6AS
"RTN","SCRPW26",72,0)
 Q
"RTN","SCRPW26",73,0)
R6AS S SDQT=^TMP("SCRPW",$J,"RPTAP",SDS1,SDS2,SDS3,SDS4),^TMP("SCRPW",$J,"RPTTAP",SDS1,SDS2,SDS3,SDQT,SDS4)=""
"RTN","SCRPW26",74,0)
 Q
"RTN","SCRPW26",75,0)
 ;
"RTN","SCRPW26",76,0)
R6B S SDS3="" F  S SDS3=$O(^TMP("SCRPW",$J,"RPTDX",SDS1,SDS2,SDS3)) Q:SDS3=""  S SDS4="" F  S SDS4=$O(^TMP("SCRPW",$J,"RPTDX",SDS1,SDS2,SDS3,SDS4)) Q:SDS4=""  D R6BS
"RTN","SCRPW26",77,0)
 Q
"RTN","SCRPW26",78,0)
R6BS S SDQT=$P(^TMP("SCRPW",$J,"RPTDX",SDS1,SDS2,SDS3,SDS4),U,3),^TMP("SCRPW",$J,"RPTTDX",SDS1,SDS2,SDS3,SDQT,SDS4)=""
"RTN","SCRPW26",79,0)
 Q
"RTN","SCRPW26",80,0)
 ;
"RTN","SCRPW26",81,0)
R7 S SDYR=0 F  S SDYR=$O(^TMP("SCRPW",$J,SDI,SDYR)) Q:'SDYR  S SDS1="" F  S SDS1=$O(^TMP("SCRPW",$J,SDI,SDYR,SDS1)) Q:SDS1=""  S SDS2="" F  S SDS2=$O(^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2)) Q:SDS2=""  D R7A
"RTN","SCRPW26",82,0)
 Q
"RTN","SCRPW26",83,0)
 ;
"RTN","SCRPW26",84,0)
R7A S DFN=0 F  S DFN=$O(^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,DFN)) Q:'DFN  S ^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,"UNI")=$G(^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,"UNI"))+1 D R7B
"RTN","SCRPW26",85,0)
 Q
"RTN","SCRPW26",86,0)
 ;
"RTN","SCRPW26",87,0)
R7B S SDT=0 F  S SDT=$O(^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,DFN,SDT)) Q:'SDT  S ^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,"VIS")=$G(^TMP("SCRPW",$J,SDI,SDYR,SDS1,SDS2,"VIS"))+1
"RTN","SCRPW26",88,0)
 Q
"RTN","SCRPW26",89,0)
 ;
"RTN","SCRPW26",90,0)
R8 S SDORD=$E($P(SDPAR("O",1),U,2),1,3),SDS1="" F  S SDS1=$O(^TMP("SCRPW",$J,"M1",SDS1)) Q:SDS1=""  S SDS2="" F  S SDS2=$O(^TMP("SCRPW",$J,"M1",SDS1,SDS2)) Q:SDS2=""  D R8A
"RTN","SCRPW26",91,0)
 Q
"RTN","SCRPW26",92,0)
R8A S SDORDV=$S(SDORD="ALP":SDS1,1:+$G(^TMP("SCRPW",$J,"RPT",1,SDS1,SDS2,SDORD))),^TMP("SCRPW",$J,"MASTER",SDORDV,SDS1,SDS2)="" Q
"RTN","SCRPW26",93,0)
 ;
"RTN","SCRPW26",94,0)
EVAL(SDS1,SDS2) ;Evaluate item
"RTN","SCRPW26",95,0)
 D GID(SDS1,SDS2) K SDX X $P(SD(1),T,7)
"RTN","SCRPW26",96,0)
 I SDS1="P",SDF(1)="S" D EVIL Q $D(SDX)>1
"RTN","SCRPW26",97,0)
 D EV0(SDS1,SDS2) D:SDS1="P" EVIL
"RTN","SCRPW26",98,0)
 Q $D(SDX)>1
"RTN","SCRPW26",99,0)
 ;
"RTN","SCRPW26",100,0)
EV0(SDS1,SDS2) N X,Y,SDR1,SDR2,SDZ S SDZ=SD(3)="E",SDI=0 F  S SDI=$O(SDX(SDI)) Q:'SDI  S X=$P(SDX(SDI),U) D EV1
"RTN","SCRPW26",101,0)
 Q
"RTN","SCRPW26",102,0)
 ;
"RTN","SCRPW26",103,0)
EV1 I "LN"[SD(2) K:('SDZ&'$D(SDPAR(SDS1,SDS2,5,X))) SDX(SDI) K:(SDZ&$D(SDPAR(SDS1,SDS2,5,X))) SDX Q
"RTN","SCRPW26",104,0)
 S Y=$S(SD(6)="D":1,+$P(SDX(SDI),U,2)=$P(SDX(SDI),U,2):1,1:0),SDR1=$O(SDPAR(SDS1,SDS2,(4+Y),"")),SDR2=$O(SDPAR(SDS1,SDS2,(4+Y),""),-1)
"RTN","SCRPW26",105,0)
 I Y S:(SD(6)="D"&(SDR2#1=0)) SDR2=SDR2+.9999 K:('SDZ&(X<SDR1!(X>SDR2))) SDX(SDI) K:(SDZ&(X'<SDR1&(X'>SDR2))) SDX Q
"RTN","SCRPW26",106,0)
 I SD(0)="DXAD" S X=$P(SDX(SDI),U,2) D DXRNGE Q  ;SD*5.3*559
"RTN","SCRPW26",107,0)
 S X=$P(SDX(SDI),U,2) K:('SDZ&(SDR1]X!(X]SDR2))) SDX(SDI) K:(SDZ&(SDR1']X&(X']SDR2))) SDX Q
"RTN","SCRPW26",108,0)
 ;
"RTN","SCRPW26",109,0)
EVIL ;Evaluate item limitations
"RTN","SCRPW26",110,0)
 N SDS2 I $D(SDX)>1 S S1=SD(0),S2=$P(SD(1),T,10) F S0=S1,S2 I $L(S0) S SDS2=0 F  S SDS2=$O(SDPAR("LPX",S0,SDS2)) Q:'SDS2  D GID("L",SDS2),EV0("L",SDS2)
"RTN","SCRPW26",111,0)
 Q
"RTN","SCRPW26",112,0)
 ;
"RTN","SCRPW26",113,0)
GID(SDS1,SDS2) ;Get item data
"RTN","SCRPW26",114,0)
 ;Required input: SDS1,SDS2=subscript values in SDPAR array.
"RTN","SCRPW26",115,0)
 K SD
"RTN","SCRPW26",116,0)
 S SD(0)=$P(SDPAR(SDS1,SDS2),U)_$P(SDPAR(SDS1,SDS2,1),U),SD(1)=^TMP("SCRPW",$J,"ACT",SD(0))
"RTN","SCRPW26",117,0)
 F SDI=2,3,6 S SD(SDI)=$P($G(SDPAR(SDS1,SDS2,SDI)),U)
"RTN","SCRPW26",118,0)
 Q
"RTN","SCRPW26",119,0)
 ;
"RTN","SCRPW26",120,0)
DXRNGE ; added per SD*5.3*461
"RTN","SCRPW26",121,0)
 N SDFLG1,SDS22,SDS23
"RTN","SCRPW26",122,0)
 S SDFLG1=0
"RTN","SCRPW26",123,0)
 S SDS22=2
"RTN","SCRPW26",124,0)
 F  S SDS22=$O(SDPAR(SDS1,SDS22)) Q:'SDS22  D
"RTN","SCRPW26",125,0)
 .S SDS23=1,SDS23=$O(SDPAR(SDS1,SDS22,SDS23)) Q:'SDS23  Q:$P($G(SDPAR(SDS1,SDS22,SDS23)),U,1)'="R"   ;SD*5.3*559 Quit if 2nd limitation for DX List
"RTN","SCRPW26",126,0)
 .S SDR1=$O(SDPAR(SDS1,SDS22,(4+Y),"")),SDR2=$O(SDPAR(SDS1,SDS22,(4+Y),""),-1)
"RTN","SCRPW26",127,0)
 .I ('SDZ&(SDR1']X&(X']SDR2))) S SDFLG1=1
"RTN","SCRPW26",128,0)
 K:'SDFLG1 SDX(SDI)
"RTN","SCRPW26",129,0)
 K SDFLG1,SDS22,SDS23
"RTN","SCRPW26",130,0)
 Q
"RTN","SCRPW26",131,0)
 ;
"RTN","SCRPW26",132,0)
TEST K DIC,DIR D BLD^SCRPW21 S DIC="^SCE(",DIC(0)="AEMQZ" D ^DIC Q:$D(DTOUT)!$D(DUOUT)  Q:'Y  S SDOE=+Y,SDOE0=Y(0),T="~",DIR(0)="E"
"RTN","SCRPW26",133,0)
 S SDI="" F  S SDI=$O(^TMP("SCRPW",$J,"ACT",SDI)) Q:SDI=""  S SDA=^TMP("SCRPW",$J,"ACT",SDI) W !!,$P(SDA,T) D TEST1 W ! ;D ^DIR Q:'Y
"RTN","SCRPW26",134,0)
 D R1
"RTN","SCRPW26",135,0)
 Q
"RTN","SCRPW26",136,0)
TEST1 X $P(SDA,T,7) S SDII="" F  S SDII=$O(SDX(SDII)) Q:'SDII  W !?5,SDX(SDII)
"RTN","SCRPW26",137,0)
 Q
"RTN","SCRPW26",138,0)
 ;
"RTN","SCRPW26",139,0)
INTRO ;Intro. text
"RTN","SCRPW26",140,0)
 W !!?10,"This report can be used to produce information from the ACRP",!?10,"databases in a variety of ways.  Parameter selection will",!?10,"determine how to count and screen the information."
"RTN","SCRPW26",141,0)
 W !!?10,"The report user is prompted for report parameters in the",!?10,"following categories:",!!?10,$$XY^SCRPW20(IORVON),"FORMAT",$$XY^SCRPW20(IORVOFF)," - determines the style of report to be printed."
"RTN","SCRPW26",142,0)
 W !!?10,$$XY^SCRPW20(IORVON),"PERSPECTIVE",$$XY^SCRPW20(IORVOFF)," - the element that the report will be organized",!?10,"and sub-totaled by."
"RTN","SCRPW26",143,0)
 W !!?10,$$XY^SCRPW20(IORVON),"LIMITATIONS",$$XY^SCRPW20(IORVOFF)," - elements that can be used to narrow the scope"
"RTN","SCRPW26",144,0)
 W !?10,"of the report to only include (or exclude) specified data.",!!?10,$$XY^SCRPW20(IORVON),"OUTPUT ORDER, PRINT FIELDS",$$XY^SCRPW20(IORVOFF)," - determines the order of output;"
"RTN","SCRPW26",145,0)
 W !?10,"allows selection of print fields for detailed patient lists." Q
"VER")
8.0^22.0
"BLD",8107,6)
^467
**END**
**END**
