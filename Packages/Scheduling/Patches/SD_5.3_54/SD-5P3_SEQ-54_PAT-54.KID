Released SD*5.3*54 SEQ #54
Extracted from mail message
**KIDS**:SD*5.3*54^

**INSTALL NAME**
SD*5.3*54
"BLD",172,0)
SD*5.3*54^SCHEDULING^0^2960918^n
"BLD",172,1,0)
^^5^5^2960918^^
"BLD",172,1,1,0)
This contains fixes for the PCMM RPC, the SC PATIENT LOOKUP.
"BLD",172,1,2,0)
It used to error out when value entered resulted in a large list of
"BLD",172,1,3,0)
patients (e.g.'SMITH').  Now the limit is 500.
"BLD",172,1,4,0)
 
"BLD",172,1,5,0)
For a complete description, see NPM.
"BLD",172,4,0)
^9.64PA^^
"BLD",172,"KRN",0)
^9.67PA^8994^14
"BLD",172,"KRN",.4,0)
.4
"BLD",172,"KRN",.401,0)
.401
"BLD",172,"KRN",.402,0)
.402
"BLD",172,"KRN",.403,0)
.403
"BLD",172,"KRN",.5,0)
.5
"BLD",172,"KRN",.84,0)
.84
"BLD",172,"KRN",3.6,0)
3.6
"BLD",172,"KRN",9.2,0)
9.2
"BLD",172,"KRN",9.8,0)
9.8
"BLD",172,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",172,"KRN",9.8,"NM",1,0)
SD5354EN^^0^B2713613
"BLD",172,"KRN",9.8,"NM",2,0)
SCUTBK11^^0^B13842181
"BLD",172,"KRN",9.8,"NM","B","SCUTBK11",2)

"BLD",172,"KRN",9.8,"NM","B","SD5354EN",1)

"BLD",172,"KRN",19,0)
19
"BLD",172,"KRN",19.1,0)
19.1
"BLD",172,"KRN",101,0)
101
"BLD",172,"KRN",409.61,0)
409.61
"BLD",172,"KRN",8994,0)
8994
"BLD",172,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",172,"KRN",8994,"NM",1,0)
SC PATIENT LOOKUP^^0
"BLD",172,"KRN",8994,"NM","B","SC PATIENT LOOKUP",1)

"BLD",172,"KRN","B",.4,.4)

"BLD",172,"KRN","B",.401,.401)

"BLD",172,"KRN","B",.402,.402)

"BLD",172,"KRN","B",.403,.403)

"BLD",172,"KRN","B",.5,.5)

"BLD",172,"KRN","B",.84,.84)

"BLD",172,"KRN","B",3.6,3.6)

"BLD",172,"KRN","B",9.2,9.2)

"BLD",172,"KRN","B",9.8,9.8)

"BLD",172,"KRN","B",19,19)

"BLD",172,"KRN","B",19.1,19.1)

"BLD",172,"KRN","B",101,101)

"BLD",172,"KRN","B",409.61,409.61)

"BLD",172,"KRN","B",8994,8994)

"BLD",172,"PRE")
SD5354EN
"BLD",172,"QUES",0)
^9.62^^
"KRN",8994,34,-1)
0^1
"KRN",8994,34,0)
SC PATIENT LOOKUP^FINDP^SCUTBK11^4^R^^^1
"KRN",8994,34,1,0)
^^6^6^2960918^^^^
"KRN",8994,34,1,1,0)
Patient lookup.  This is intended as a temporary RPC until a VA or
"KRN",8994,34,1,2,0)
FileMan component is available.  Does a Multiple index lookup on
"KRN",8994,34,1,3,0)
the PATIENT file (#2).  This does not invoke DPTLK.  Given lookup
"KRN",8994,34,1,4,0)
value, this returns a list of the form DFN^patient name^DOB^PID.
"KRN",8994,34,1,5,0)
 
"KRN",8994,34,1,6,0)
Only the first 500 records that match the value are returned.
"KRN",8994,34,2,0)
^8994.02A^1^1
"KRN",8994,34,2,1,0)
LIST ATTRIBUTES^2^512^1
"KRN",8994,34,2,"B","LIST ATTRIBUTES",1)

"OER",16,0)
16^SD^^M.A.S.^
"OER",16,1,0)
^100.9951PA^2^2
"OER",16,1,1,0)
103
"OER",16,1,1,1,0)
^100.99511PA^1^1
"OER",16,1,1,1,1,0)
101
"OER",16,1,2,0)
645
"OER",16,1,2,1,0)
^100.99511PA^1^1
"OER",16,1,2,1,1,0)
121
"ORD",12,8994)
8994;12;1;;;;;;;RPCDEL^XPDIA1
"ORD",12,8994,0)
REMOTE PROCEDURE
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
54^2960918
"PKG",16,22,1,"PAH",1,1,0)
^^5^5^2960918
"PKG",16,22,1,"PAH",1,1,1,0)
This contains fixes for the PCMM RPC, the SC PATIENT LOOKUP.
"PKG",16,22,1,"PAH",1,1,2,0)
It used to error out when value entered resulted in a large list of
"PKG",16,22,1,"PAH",1,1,3,0)
patients (e.g.'SMITH').  Now the limit is 500.
"PKG",16,22,1,"PAH",1,1,4,0)
 
"PKG",16,22,1,"PAH",1,1,5,0)
For a complete description, see NPM.
"PRE")
SD5354EN
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SCUTBK11")
0^2^B13842181
"RTN","SCUTBK11",1,0)
SCUTBK11 ;ALB/SCK - Scheduling Broker Utilities; 2/2/96 ;9/7/96  17:28
"RTN","SCUTBK11",2,0)
 ;;5.3;Scheduling;**41,54**;AUG 13, 1993
"RTN","SCUTBK11",3,0)
 ;;1T1;
"RTN","SCUTBK11",4,0)
 ;
"RTN","SCUTBK11",5,0)
 Q
"RTN","SCUTBK11",6,0)
PARSE(SC) ;
"RTN","SCUTBK11",7,0)
 S SCDFN=$G(SC("DFN"),"")
"RTN","SCUTBK11",8,0)
 S SCPIEN=$G(SC("PIEN"),"")
"RTN","SCUTBK11",9,0)
 S:$D(SC("TEAM")) SCTM=$G(SC("TEAM"))
"RTN","SCUTBK11",10,0)
 S:$D(SC("BEGIN")) SCDT("BEGIN")=$G(SC("BEGIN"))
"RTN","SCUTBK11",11,0)
 S:$D(SC("END")) SCDT("END")=$G(SC("END"))
"RTN","SCUTBK11",12,0)
 I $D(SC("END")) S SCDT("INCL")=0
"RTN","SCUTBK11",13,0)
 S SCFILE=$G(SC("FILE"))
"RTN","SCUTBK11",14,0)
 S SCIEN=$G(SC("IEN"))
"RTN","SCUTBK11",15,0)
 S SCFIELD=$G(SC("FIELD"))
"RTN","SCUTBK11",16,0)
 S SCVAL=$G(SC("VALUE"))
"RTN","SCUTBK11",17,0)
 Q
"RTN","SCUTBK11",18,0)
 ;
"RTN","SCUTBK11",19,0)
TMLST(SCDATA,SC) ;
"RTN","SCUTBK11",20,0)
 ;  -- Return a list of teams for a patient.  Pass in the DFN and
"RTN","SCUTBK11",21,0)
 ;     optionally a date range and/or a team purpose to restrict the
"RTN","SCUTBK11",22,0)
 ;     team look up.  Return only the team entry, strip out any other
"RTN","SCUTBK11",23,0)
 ;     array items.
"RTN","SCUTBK11",24,0)
 ;
"RTN","SCUTBK11",25,0)
 N DFN,SCDT,SCPURP,SCLIST,SCER1,SCOK,SCD
"RTN","SCUTBK11",26,0)
 ;
"RTN","SCUTBK11",27,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",28,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",29,0)
 ;
"RTN","SCUTBK11",30,0)
 S DFN=$G(SC("DFN"))
"RTN","SCUTBK11",31,0)
 S SCDT("BEGIN")=$G(SC("BEGIN"),"")
"RTN","SCUTBK11",32,0)
 I $L(SCDT("BEGIN"))>2 S SCDT("INCL")=$G(SC("INCL"),0)
"RTN","SCUTBK11",33,0)
 S SCDT("END")=$G(SC("END"),"")
"RTN","SCUTBK11",34,0)
 S SCPURP=$G(SC("PURP"),"")
"RTN","SCUTBK11",35,0)
 ;
"RTN","SCUTBK11",36,0)
 S SCOK=$$TMPT^SCAPMC3(DFN,"SCDT","","SCD","SCER1")
"RTN","SCUTBK11",37,0)
 ;
"RTN","SCUTBK11",38,0)
 S I=0 F  S I=$O(SCD(I)) Q:'I  S SCDATA(I)=SCD(I)
"RTN","SCUTBK11",39,0)
TMQ Q
"RTN","SCUTBK11",40,0)
 ;
"RTN","SCUTBK11",41,0)
FINDP(SCOUT,SCIN) ; patient lookup used by SC PATIENT LOOKUP rpc
"RTN","SCUTBK11",42,0)
 ;  -from SF/TOAD's modifications using ^TMP instead of SC
"RTN","SCUTBK11",43,0)
 ; input:
"RTN","SCUTBK11",44,0)
 ;   SCIN("VALUE") = value to lookup
"RTN","SCUTBK11",45,0)
 ;     Lookup uses multiple index lookup of File #2
"RTN","SCUTBK11",46,0)
 ; output:
"RTN","SCUTBK11",47,0)
 ;   SCOUT = location of data = ^TMP("DILIST",$J,i,0)
"RTN","SCUTBK11",48,0)
 ;   for i=1:number of records returned: 
"RTN","SCUTBK11",49,0)
 ;    DFN^patient name^DOB^PID
"RTN","SCUTBK11",50,0)
 ;     1        2       3   4
"RTN","SCUTBK11",51,0)
 ;
"RTN","SCUTBK11",52,0)
 D FIND^DIC(2,,".01;.03;.363","MPS",SCIN("VALUE"),500)
"RTN","SCUTBK11",53,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","SCUTBK11",54,0)
 N SCOUNT S SCOUNT=+^TMP("DILIST",$J,0)
"RTN","SCUTBK11",55,0)
 N SC F SC=1:1:SCOUNT D
"RTN","SCUTBK11",56,0)
 . S $P(^(0),"^",4,999)=$P(^TMP("DILIST",$J,SC,0),"^",4)
"RTN","SCUTBK11",57,0)
 K ^TMP("DILIST",$J,0)
"RTN","SCUTBK11",58,0)
 K SCOUT S SCOUT="^TMP(""DILIST"","_$J_")"
"RTN","SCUTBK11",59,0)
 Q
"RTN","SCUTBK11",60,0)
PSLST(SCDATA,SC) ;
"RTN","SCUTBK11",61,0)
 ;
"RTN","SCUTBK11",62,0)
 ;  - Returns a array of positions that show the person currently
"RTN","SCUTBK11",63,0)
 ;    assigned to the position, the preceptor for that position,
"RTN","SCUTBK11",64,0)
 ;    for the patient is assigned to.
"RTN","SCUTBK11",65,0)
 ;
"RTN","SCUTBK11",66,0)
 ;    Pass in the Patient's DFN
"RTN","SCUTBK11",67,0)
 ;    To restrict to specific entries, pass in the following:
"RTN","SCUTBK11",68,0)
 ;      Beginning and Ending Date Range 
"RTN","SCUTBK11",69,0)
 ;      A specific Team Position
"RTN","SCUTBK11",70,0)
 ;      A Specific User entry (8930)
"RTN","SCUTBK11",71,0)
 ;      A specific Team Purpose.  (Read SCAPMC23 for how it exclude
"RTN","SCUTBK11",72,0)
 ;        a specific team purpose.
"RTN","SCUTBK11",73,0)
 ;      A specific role
"RTN","SCUTBK11",74,0)
 ;      Flag whether to include patients associated by enrollement
"RTN","SCUTBK11",75,0)
 ;    
"RTN","SCUTBK11",76,0)
 N SCDT,SCD,SCER1,SCDFN,SCPRP,SCPST,SCRLE,SCIND,SCUSR,SCTM,SCDTE
"RTN","SCUTBK11",77,0)
 ;
"RTN","SCUTBK11",78,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",79,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",80,0)
 ;
"RTN","SCUTBK11",81,0)
 D PARSE(.SC)
"RTN","SCUTBK11",82,0)
 S SCDTE=$G(SCDT("BEGIN"))
"RTN","SCUTBK11",83,0)
 ;
"RTN","SCUTBK11",84,0)
 S CNT=0
"RTN","SCUTBK11",85,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",86,0)
 S SCOK=$$TPPT^SCAPMC(SCDFN,.SCDT,"","","","","","SCD","SCER1")
"RTN","SCUTBK11",87,0)
 S I=0 F  S I=$O(SCD(I)) Q:'I  D
"RTN","SCUTBK11",88,0)
 . I $D(SCTM) D
"RTN","SCUTBK11",89,0)
 .. Q:$P(SCD(I),U,3)'=SCTM
"RTN","SCUTBK11",90,0)
 .. S ^TMP($J,"PSLST",I)=$P($G(SCD(I)),U,3)_U_$P($G(SCD(I)),U,4)_U_$P($G(SCD(I)),U,1,2)_U_$P($G(SCD(I)),U,7,8)
"RTN","SCUTBK11",91,0)
 . ;
"RTN","SCUTBK11",92,0)
 . I '$D(SCTM) D
"RTN","SCUTBK11",93,0)
 .. S ^TMP($J,"PSLST",I)=$P($G(SCD(I)),U,3)_U_$P($G(SCD(I)),U,4)_U_$P($G(SCD(I)),U,1,2)_U_$P($G(SCD(I)),U,7,8)
"RTN","SCUTBK11",94,0)
 ;
"RTN","SCUTBK11",95,0)
 S CNT=0
"RTN","SCUTBK11",96,0)
 S I=""
"RTN","SCUTBK11",97,0)
 F  S I=$O(^TMP($J,"PSLST",I)) Q:'I  D
"RTN","SCUTBK11",98,0)
 . S:'$D(SCDTE) SCDTE=DT
"RTN","SCUTBK11",99,0)
 . S SCPIEN=$P($G(^TMP($J,"PSLST",I)),U,3)
"RTN","SCUTBK11",100,0)
 . S SCDATA(CNT)=^TMP($J,"PSLST",I)_U_$$PSMBR(SCPIEN,SCDTE)_U_+$P($G(^SCPT(404.43,$P($G(^TMP($J,"PSLST",I)),U,2),0)),U,5)_U_+$P($G(^SCTM(404.57,SCPIEN,0)),U,4)
"RTN","SCUTBK11",101,0)
 . S CNT=CNT+1
"RTN","SCUTBK11",102,0)
 K ^TMP($J,"PSLST")
"RTN","SCUTBK11",103,0)
 ;
"RTN","SCUTBK11",104,0)
PSLTQ Q
"RTN","SCUTBK11",105,0)
 ;
"RTN","SCUTBK11",106,0)
PSMBR(SCPIEN,SCPDT) ;
"RTN","SCUTBK11",107,0)
 ;
"RTN","SCUTBK11",108,0)
 N SCPRCP,SCMBR,SCPP
"RTN","SCUTBK11",109,0)
 ;
"RTN","SCUTBK11",110,0)
 S SCMBR=$$GETPRTP^SCAPMCU2(SCPIEN,SCPDT)
"RTN","SCUTBK11",111,0)
 ;
"RTN","SCUTBK11",112,0)
 S SCPP=+$P($G(^SCTM(404.57,SCPIEN,0)),U,10)
"RTN","SCUTBK11",113,0)
 S SCPRCP=$S(SCPP>0:$$GETPRTP^SCAPMCU2(SCPP,SCPDT),1:"^")
"RTN","SCUTBK11",114,0)
 Q SCMBR_U_SCPRCP
"RTN","SCUTBK11",115,0)
 ;
"RTN","SCUTBK11",116,0)
VFILE(SCOK,SC) ;
"RTN","SCUTBK11",117,0)
 N SCFILE,SCIEN,SCFIELD,SCVAL,SCFDA,SCMSG
"RTN","SCUTBK11",118,0)
 ;
"RTN","SCUTBK11",119,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",120,0)
 D TMP^SCUTBK
"RTN","SCUTBK11",121,0)
 ;
"RTN","SCUTBK11",122,0)
 S SCOK=1
"RTN","SCUTBK11",123,0)
 D PARSE(.SC)
"RTN","SCUTBK11",124,0)
 S SCFDA(SCFILE,""_SCIEN_","_"",SCFIELD)=SCVAL
"RTN","SCUTBK11",125,0)
 ;
"RTN","SCUTBK11",126,0)
 D FILE^DIE("K","SCFDA","SCMSG")
"RTN","SCUTBK11",127,0)
 ;
"RTN","SCUTBK11",128,0)
 I $D(SCMSG("DIERR")) D
"RTN","SCUTBK11",129,0)
 . S SCOK=0
"RTN","SCUTBK11",130,0)
 Q
"RTN","SCUTBK11",131,0)
 ;
"RTN","SCUTBK11",132,0)
SECKEY(SCOK,SCKEY) ;
"RTN","SCUTBK11",133,0)
 ;
"RTN","SCUTBK11",134,0)
 D CHK^SCUTBK
"RTN","SCUTBK11",135,0)
 ;
"RTN","SCUTBK11",136,0)
 S SCOK=$D(^XUSEC(SCKEY,DUZ))
"RTN","SCUTBK11",137,0)
 Q
"RTN","SD5354EN")
0^1^B2713613
"RTN","SD5354EN",1,0)
SD5354EN ;ALB/REW - SD*5.3*54 Environment Checker ; 7 JUN 1996
"RTN","SD5354EN",2,0)
 ;;5.3;Scheduling;**54**;AUG 13, 1993
"RTN","SD5354EN",3,0)
EN ;entry point
"RTN","SD5354EN",4,0)
 W !,"SD*5.3*54 Installation Requirements:",!
"RTN","SD5354EN",5,0)
 IF $D(XPDABORT)#2 W !!?4,"*** Warning: Because variable XPDABORT exists, SD*5.3*54 will not install."
"RTN","SD5354EN",6,0)
 N SCX,SCPATCH,SCROUT,SCCOMM,SC2LINE,SC2DATA,SCGLOB,SC2CHECK,SCARR,SCSUB
"RTN","SD5354EN",7,0)
 W !,">>> Checking Programmer Variables:"
"RTN","SD5354EN",8,0)
 IF +$G(DUZ)'>0!($G(DUZ(0))'="@")!($G(U)'="^")!('$D(DT)) D  Q
"RTN","SD5354EN",9,0)
 . S XPDABORT=2
"RTN","SD5354EN",10,0)
 . W !,"You must first initialize Programmer Environment by running ^XUP",!
"RTN","SD5354EN",11,0)
 ELSE  D
"RTN","SD5354EN",12,0)
 . W " ...Ok"
"RTN","SD5354EN",13,0)
PKGCHK ;check package file entries
"RTN","SD5354EN",14,0)
 W !,">>> Checking PACKAGE File Entries:"
"RTN","SD5354EN",15,0)
 F SCX=1:1 S SCPATCH=$P($T(PACKAGE+SCX),";;",2) Q:'$L(SCPATCH)  D
"RTN","SD5354EN",16,0)
 .N SCPKG,SCVER,SCPTC,SCPKGI,SCVERI
"RTN","SD5354EN",17,0)
 .W !,?5,SCPATCH
"RTN","SD5354EN",18,0)
 .IF '$$PATCH^XPDUTL(SCPATCH) D
"RTN","SD5354EN",19,0)
 ..S XPDABORT=2
"RTN","SD5354EN",20,0)
 ..W:$G(XPDABORT) !,"Missing Required (Package/Patch) Entry: ",SCPATCH
"RTN","SD5354EN",21,0)
 .ELSE  D
"RTN","SD5354EN",22,0)
 ..W " ...Ok"
"RTN","SD5354EN",23,0)
 ;check patched routines
"RTN","SD5354EN",24,0)
 W:$D(XPDABORT) !,">>> SD*5.3*54 Aborted in Environment Checker"
"RTN","SD5354EN",25,0)
 W:'$D(XPDABORT) !!,">>> Environment is Ok"
"RTN","SD5354EN",26,0)
 Q
"RTN","SD5354EN",27,0)
 ;
"RTN","SD5354EN",28,0)
PACKAGE ;
"RTN","SD5354EN",29,0)
 ;;SD*5.3*41
"RTN","SD5354EN",30,0)
 ;;XU*8.0*32
"VER")
8.0^21.0
**END**
**END**
