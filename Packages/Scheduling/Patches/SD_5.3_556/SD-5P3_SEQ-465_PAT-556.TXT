$TXT Created by HARRIS,DONNA H at MNTVLL.FO-ALBANY.MED.VA.GOV  (KIDS) on Wednesday, 02/24/10 at 12:55
=============================================================================
Run Date: NOV 10, 2010                     Designation: SD*5.3*556
Package : SD - SCHEDULING                     Priority: Mandatory
Version : 5.3       SEQ #465                    Status: Released
                  Compliance Date: DEC 11, 2010
=============================================================================

Associated patches: (v)SD*5.3*131  <<= must be installed BEFORE `SD*5.3*556'
                    (v)SD*5.3*132  <<= must be installed BEFORE `SD*5.3*556'
                    (v)SD*5.3*159  <<= must be installed BEFORE `SD*5.3*556'
                    (v)SD*5.3*180  <<= must be installed BEFORE `SD*5.3*556'
                    (v)SD*5.3*317  <<= must be installed BEFORE `SD*5.3*556'

Subject: REVISIONS FOR UNSUPPORTED FIELDS 

Category: 
  - Routine

Description:
============

    This patch addresses the upcoming deletion of unsupported fields in
    the ICD DIAGNOSIS File (#80), and the CPT File (#81). Modifications are
    being made to affected scheduling routines to replace unsupported calls
    to the deleted data fields with the appropriate supported API.
    
     CPT File (#81), ^ICPT
     ---------------------
     The following fields are deleted:
   
     2     0;2   SHORT NAME          Free Text 1-28
     5     0;4   INACTIVE FLAG       Set of Codes 1 = Inactive Code
     7     0;7   INACTIVE DATE       Date
     8     0;8   ACTIVE DATE         Date
   
     Replace with API: $$CPT^ICPTCOD,   DBIA#1995 - CPT Code APIs, Supported
   
     50    D;0   DESCRIPTION         Multiple (81.01)
      .01  0;1   DESCRIPTION         Free Text 1-80
   
     Replace with API: CPTD^ICPTCOD,   DBIA#1995 - CPT Code APIs, Supported
   
   
     ICD DIAGNOSIS File (#80), ^ICD9(
     --------------------------------
     The following fields are deleted:
   
     3     0;3   DIAGNOSIS          Free Text 2-30
     16    0;16  ACTIVATION DATE    Date
     100   0;9   INACTIVE FLAG      Set of Codes 1= Inactive Code
     102   0;11  INACTIVE DATE      Date
   
     Replace with API: $$ICDDX^IDCCODE,     DBIA#3990 - ICD Code APIs, 
     Supported
   
     10    1;1    DESCRIPTION       Free Text 1-245
   
     Replace with API: ICDD^ICDCODE,     DBIA#3990 - ICD Code APIs, Supported
   
   
     Problem:
     The Scheduling package uses a number of unsupported calls to retrieve CPT 
     or Diagnosis values directly from the respective files, or to check data 
     integrity.  These unsupported calls will cause errors once the respective 
     fields are deleted from the files. 
   
     Solution: 
     Modify the unsupported calls with the appropriate API call in routines
     SCRPW40, SDAMBAE3, SDAMBMR, SDAMODO2, and SDOEDX.
  
  
 ASSOCIATED NEW SERVICE REQUEST(NSR):
 ======================================
  
 There are no NSR associated with this patch.
  
  
  
 ASSOCIATED REMEDY TICKET(S):
 ============================
 There are no Remedy tickets associated with this patch.
  
  
 PARTICIPATING TEST SITES:
 ========================
 Bay Pines FL
 Montana HCS
 New Jersey HCS  
  
  
  
 ===================== INSTALLATION INSTRUCTIONS ==========================
   
  If installed during the normal workday, it is recommended that the 
 following entries in the OPTION file (#19) be disabled to prevent possible
 conflicts while running the KIDS Install. Other VISTA users will not be 
 affected.
  
       [SDAM APPT MGT]     Appointment Management
       [SDAM PROVIDER/DIAGNOSIS REPORT] Provider/Diagnosis Report
       [SD AMB PROC MANAGEMENT REPORT]  Management Report for Ambulatory
                                        Procedures
       [SCRPW DX/CPT FREQUENCY REPORT]  Outpatient Diagnosis/Procedure
                                        Frequency Report
  
  Users may remain on the system during the installation.
  
  Install Time - less than 5 minutes
   
   
  1.  LOAD TRANSPORT GLOBAL 
      ---------------------
      Choose the PackMan message containing this patch and invoke the 
      INSTALL/CHECK MESSAGE PackMan option.  
               
  2.  START UP KIDS 
      -------------
      Start up the Kernel Installation and Distribution System Menu 
      [XPD MAIN]: 
     
           Edits and Distribution ...  
           Utilities ...  
           Installation ...  
     
  Select Kernel Installation & Distribution System Option: INStallation 
                                                           ---
           Load a Distribution 
           Print Transport Global 
           Compare Transport Global to Current System 
           Verify Checksums in Transport Global 
           Install Package(s) 
           Restart Install of Package(s) 
           Unload a Distribution 
           Backup a Transport Global 
     
  Select Installation Option: 
     
  3.  Select Installation Option: 
      ---------------------------
      NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
             NAME, enter SD*5.3*556):
        
      a.  Backup a Transport Global - This option will create a backup
          message of any routines exported with this patch. It will not
          backup any other changes such as DD's or templates.
      b.  Compare Transport Global to Current System - This option will
          allow you to view all changes that will be made when this patch
          is installed.  It compares all components of this patch
          (routines, DD's, templates, etc.).
      c.  Verify Checksums in Transport Global - This option will allow
          you to ensure the integrity of the routines that are in the
          transport global.
       
  4.  Select Installation Option: Install Package(s) 
                                  ------------------
      **This is the step to start the installation of this KIDS patch: 
     
      a.  Choose the Install Package(s) option to start the patch
          install.
      b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
          YES//' answer NO
      c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
          Options, and Protocols? YES//' answer YES
      d.  When prompted 'Enter options you wish to mark as 'Out Of
          Order':'  Enter the following options:
    
          [SDAM APPT MGT]                  Appointment Management 
          [SDAM PROVIDER/DIAGNOSIS REPORT] Provider/Diagnosis Report
          [SD AMB PROC MANAGEMENT REPORT]  Management Report for Ambulatory
                                           Procedures
          [SCRPW DX/CPT FREQUENCY REPORT]  Outpatient Diagnosis/Procedure
                                           Frequency Report
  
      e.  When prompted 'Enter protocols you wish to mark as 'Out Of
          Order':'  
  
          [SDAM DIAGNOSIS]                 Diagnosis Update

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.3;Scheduling;**[Patch List]**;AUG 13, 1993;Build 3

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: SCRPW40
    Before: B69084359   After: B69722600  **144,180,556**
 Description of Changes:
  Before
  ======
   
  102 DXP1   S SDI=0 F  S SDI=$O(^TMP("SCRPW",$J,SDIV,"DX",2,SDORD,SDI)) Q:'SDI!S
              DOUT!(SDCT>(SD("FREQ")-1))  S SDDX0=$G(^ICD9(SDI,0)) I $L(SDDX0) S 
              SDDXC=$P(SDDX0,U),SDDXN=$P(SDDX0,U,3) D DXP2
  103        Q
  104        ;
   
   
  After
  =====
   
  103 DXP1   S SDI=0 F  S SDI=$O(^TMP("SCRPW",$J,SDIV,"DX",2,SDORD,SDI)) Q:'SDI!S
              DOUT!(SDCT>(SD("FREQ")-1))  S SDDX0=$$ICDDX^ICDCODE(SDI) I $L(SDDX0
              ) S SDDXC=$P(SDDX0,U,2),SDDXN=$P(SDDX0,U,4) D DXP2
  104        Q
  105        ;

Routine Name: SDAMBAE3
    Before:  B2632564   After:  B2667789  **18,29,40,111,132,556**
 Description of Changes:
  Before
  ======
   
   19 ID     ; -- DIC("W") logic for amb proc look-ups
   20        N SDICPT,SDICPT1,SDIX
   21        S SDICPT1=$$CPT^ICPTCOD(Y,D)
   22        Q:SDICPT1<0
   23        W ?4,$P(SDICPT1,U,3)
   24        I '$P(SDICPT1,U,7) W !?10,"** INACTIVE **"
   25        ;
   26        ;  print code description
   27        S SDICPT=$$CPTD^ICPTCOD(Y,"SDICPT") F SDIX=1:1:SDICPT W !?10,SDICPT(
              SDIX)
   28        ;  set $TEST
   29        W !?9 I $D(^ICPT(Y,0))
   30        Q
   31        ;
   
  After
  =====
   
   21 ID     ; -- DIC("W") logic for amb proc look-ups
   22        N SDICPT,SDICPT1,SDIX
   23        S SDICPT1=$$CPT^ICPTCOD(Y,D)
   24        Q:SDICPT1<0
   25        W ?4,$P(SDICPT1,U,3)
   26        I '$P(SDICPT1,U,7) W !?10,"** INACTIVE **"
   27        ;
   28        ;  print code description
   29        S SDICPT=$$CPTD^ICPTCOD(Y,"SDICPT") F SDIX=1:1:SDICPT W !?10,SDICPT(
              SDIX)
   30        ;  set $TEST
   31        W !?9 I +$$CPT^ICPTCOD(Y)>0
   32        Q

Routine Name: SDAMBMR
    Before: B29170892   After: B29279736  **140,132,159,180,556**
 Description of Changes:
  Before
  ======
   
   17 7      S VAUTNI=1 D PATIENT^VAUTOMA G Q:Y<0 D MOD G 9
   18 8      S DIC="^ICPT(",DIC("S")="I '$P(^(0),U,4)",VAUTNI=1,VAUTSTR="CPT code
              ",VAUTVB="SD" D FIRST^VAUTOMA G Q:Y<0 S SDP=SD
   19        I $D(SD) F I=0:0 S I=$O(SD(I)) Q:I'?5AN  S SDP(SD(I))=I K SD(I)
   
  After
  =====
   
   17 7      S VAUTNI=1 D PATIENT^VAUTOMA G Q:Y<0 D MOD G 9
   18 8      S DIC="^ICPT(",DIC("S")="I $P($$CPT^ICPTCOD(Y),U,7)",VAUTNI=1,VAUTST
              R="CPT code",VAUTVB="SD" D FIRST^VAUTOMA G Q:Y<0 S SDP=SD
   19        I $D(SD) F I=0:0 S I=$O(SD(I)) Q:I'?5AN  S SDP(SD(I))=I K SD(I)

Routine Name: SDAMODO2
    Before: B22614966   After: B22975014  **11,25,49,132,159,556**
 Description of Changes:
  Before
  ======
   
  117 DX1(OEN) --
              ; -- get list of dxs for encounter
  118        N SD,Y,XX,XDX,XDN,QFLAG,SDVPOV,SDVPOVS
  119        S XX=0,XDN="",QFLAG=0
  120        D GETDX^SDOE(OEN,"SDVPOVS")
  121        S SDVPOV=0
  122        F  S SDVPOV=$O(SDVPOVS(SDVPOV)) Q:'SDVPOV  D  Q:QFLAG
  123        . S XX=+SDVPOVS(SDVPOV)
  124        . I $D(PDIAG),'PDIAG,'$D(PDIAG(XX)) Q
  125        . S XDN=XDN_$S($D(^ICD9(XX,0)):$P(^(0),U)_U,1:"NOT SPECIFIED^")
  126        . S:$L(XDN)>250 QFLAG=1
  127        S:XDN']"" XDN="NOT SPECIFIED"
  128        Q XDN
   
   
  After
  =====
   
  117 DX1(OEN) --
              ; -- get list of dxs for encounter
  118        N SD,Y,XX,XDX,XDN,QFLAG,SDVPOV,SDVPOVS,SDICD9
  119        S XX=0,XDN="",QFLAG=0
  120        D GETDX^SDOE(OEN,"SDVPOVS")
  121        S SDVPOV=0
  122        F  S SDVPOV=$O(SDVPOVS(SDVPOV)) Q:'SDVPOV  D  Q:QFLAG
  123        . S XX=+SDVPOVS(SDVPOV)
  124        . I $D(PDIAG),'PDIAG,'$D(PDIAG(XX)) Q
  125        . S SDICD9=$$ICDDX^ICDCODE(XX)
  126        . S XDN=XDN_$S($D(SDICD9):$P(SDICD9,U,2)_U,1:"NOT SPECIFIED^")
  127        . S:$L(XDN)>250 QFLAG=1
  128        S:XDN']"" XDN="NOT SPECIFIED"
  129        Q XDN

Routine Name: SDOEDX
    Before:  B9561426   After:  B9649480  **131,556**
 Description of Changes:
  Before
  ======
   
   85 VALDX(SDDXID,SDERR) --
              ; -- validate dx input
   86        ;
   87        ; -- do checks
   88        IF SDDXID,$D(^ICD9(SDDXID,0)) Q 1
   89        ;
   90        ; -- build error msg
   
   
  After
  =====
   
   85 VALDX(SDDXID,SDERR) --
              ; -- validate dx input
   86        ;
   87        ; -- do checks
   88        ;IF SDDXID,$D(^ICD9(SDDXID,0)) Q 1
   89        I SDDXID,+$$ICDDX^ICDCODE(SDDXID)>0 Q 1
   90        ;
   91        ; -- build error msg

 
Routine list of preceding patches: 131, 180

=============================================================================
User Information:
Entered By  : KOPECKY,STEPHEN C.            Date Entered  : APR 13, 2009
Completed By: BARBER,HAROLDINE              Date Completed: OCT 04, 2010
Released By : DANE,SIDNEY                   Date Released : NOV 10, 2010
=============================================================================


Packman Mail Message:
=====================

$END TXT
