Released SD*5.3*505 SEQ #441
Extracted from mail message
**KIDS**:SD*5.3*505^

**INSTALL NAME**
SD*5.3*505
"BLD",6685,0)
SD*5.3*505^SCHEDULING^0^3080822^y
"BLD",6685,1,0)
^^1^1^3080226^
"BLD",6685,1,1,0)
PCMM Phase III Enhancements.
"BLD",6685,4,0)
^9.64PA^^
"BLD",6685,6)
9^
"BLD",6685,6.3)
20
"BLD",6685,"ABPKG")
n
"BLD",6685,"KRN",0)
^9.67PA^8989.52^19
"BLD",6685,"KRN",.4,0)
.4
"BLD",6685,"KRN",.401,0)
.401
"BLD",6685,"KRN",.402,0)
.402
"BLD",6685,"KRN",.402,"NM",0)
^9.68A^^
"BLD",6685,"KRN",.403,0)
.403
"BLD",6685,"KRN",.5,0)
.5
"BLD",6685,"KRN",.84,0)
.84
"BLD",6685,"KRN",3.6,0)
3.6
"BLD",6685,"KRN",3.8,0)
3.8
"BLD",6685,"KRN",9.2,0)
9.2
"BLD",6685,"KRN",9.8,0)
9.8
"BLD",6685,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",6685,"KRN",9.8,"NM",1,0)
SCMCHLM^^0^B42881929
"BLD",6685,"KRN",9.8,"NM",2,0)
SCMCHLR1^^0^B6890622
"BLD",6685,"KRN",9.8,"NM",3,0)
SCMCHLR2^^0^B33674081
"BLD",6685,"KRN",9.8,"NM",4,0)
SCMCHLR4^^0^B66053379
"BLD",6685,"KRN",9.8,"NM",5,0)
SDWLI^^0^B73452514
"BLD",6685,"KRN",9.8,"NM",6,0)
SDWLRSR^^0^B53084626
"BLD",6685,"KRN",9.8,"NM",7,0)
SCRPO5^^0^B23882615
"BLD",6685,"KRN",9.8,"NM",8,0)
SCMCHLR3^^0^B34485398
"BLD",6685,"KRN",9.8,"NM","B","SCMCHLM",1)

"BLD",6685,"KRN",9.8,"NM","B","SCMCHLR1",2)

"BLD",6685,"KRN",9.8,"NM","B","SCMCHLR2",3)

"BLD",6685,"KRN",9.8,"NM","B","SCMCHLR3",8)

"BLD",6685,"KRN",9.8,"NM","B","SCMCHLR4",4)

"BLD",6685,"KRN",9.8,"NM","B","SCRPO5",7)

"BLD",6685,"KRN",9.8,"NM","B","SDWLI",5)

"BLD",6685,"KRN",9.8,"NM","B","SDWLRSR",6)

"BLD",6685,"KRN",19,0)
19
"BLD",6685,"KRN",19.1,0)
19.1
"BLD",6685,"KRN",101,0)
101
"BLD",6685,"KRN",101,"NM",0)
^9.68A^^
"BLD",6685,"KRN",409.61,0)
409.61
"BLD",6685,"KRN",409.61,"NM",0)
^9.68A^1^1
"BLD",6685,"KRN",409.61,"NM",1,0)
SCMC PCMM TRANSMISSION ERRORS^^0
"BLD",6685,"KRN",409.61,"NM","B","SCMC PCMM TRANSMISSION ERRORS",1)

"BLD",6685,"KRN",771,0)
771
"BLD",6685,"KRN",870,0)
870
"BLD",6685,"KRN",8989.51,0)
8989.51
"BLD",6685,"KRN",8989.52,0)
8989.52
"BLD",6685,"KRN",8994,0)
8994
"BLD",6685,"KRN","B",.4,.4)

"BLD",6685,"KRN","B",.401,.401)

"BLD",6685,"KRN","B",.402,.402)

"BLD",6685,"KRN","B",.403,.403)

"BLD",6685,"KRN","B",.5,.5)

"BLD",6685,"KRN","B",.84,.84)

"BLD",6685,"KRN","B",3.6,3.6)

"BLD",6685,"KRN","B",3.8,3.8)

"BLD",6685,"KRN","B",9.2,9.2)

"BLD",6685,"KRN","B",9.8,9.8)

"BLD",6685,"KRN","B",19,19)

"BLD",6685,"KRN","B",19.1,19.1)

"BLD",6685,"KRN","B",101,101)

"BLD",6685,"KRN","B",409.61,409.61)

"BLD",6685,"KRN","B",771,771)

"BLD",6685,"KRN","B",870,870)

"BLD",6685,"KRN","B",8989.51,8989.51)

"BLD",6685,"KRN","B",8989.52,8989.52)

"BLD",6685,"KRN","B",8994,8994)

"BLD",6685,"QUES",0)
^9.62^^
"BLD",6685,"REQB",0)
^9.611^7^6
"BLD",6685,"REQB",2,0)
SD*5.3*210^1
"BLD",6685,"REQB",3,0)
SD*5.3*297^1
"BLD",6685,"REQB",4,0)
SD*5.3*177^1
"BLD",6685,"REQB",5,0)
SD*5.3*524^1
"BLD",6685,"REQB",6,0)
SD*5.3*272^2
"BLD",6685,"REQB",7,0)
SD*5.3*458^1
"BLD",6685,"REQB","B","SD*5.3*177",4)

"BLD",6685,"REQB","B","SD*5.3*210",2)

"BLD",6685,"REQB","B","SD*5.3*272",6)

"BLD",6685,"REQB","B","SD*5.3*297",3)

"BLD",6685,"REQB","B","SD*5.3*458",7)

"BLD",6685,"REQB","B","SD*5.3*524",5)

"KRN",409.61,432,-1)
0^1
"KRN",409.61,432,0)
SCMC PCMM TRANSMISSION ERRORS^1^^160^6^17^1^1^Transmission Error^SCMC LE PCMM TRANSMISSION ERRORS MENU^PCMM Transmission Errors^1^999^1
"KRN",409.61,432,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,432,"ARRAY")
 ^TMP("SCERR",$J)
"KRN",409.61,432,"COL",0)
^409.621^9^9
"KRN",409.61,432,"COL",1,0)
NUMBER^1^5^^^0
"KRN",409.61,432,"COL",2,0)
PATIENT^8^19^Patient Name
"KRN",409.61,432,"COL",3,0)
PATID^29^5^PATID
"KRN",409.61,432,"COL",4,0)
DATE^36^12^Date Rec'd
"KRN",409.61,432,"COL",5,0)
PROV^48^11^Provider
"KRN",409.61,432,"COL",6,0)
TYPE^67^4^Type
"KRN",409.61,432,"COL",7,0)
STATUS^73^7^EP Stat
"KRN",409.61,432,"COL",8,0)
RETRANS^7^1
"KRN",409.61,432,"COL",9,0)
INST^59^6^Institution
"KRN",409.61,432,"COL","AIDENT",0,1)

"KRN",409.61,432,"COL","B","DATE",4)

"KRN",409.61,432,"COL","B","INST",9)

"KRN",409.61,432,"COL","B","NUMBER",1)

"KRN",409.61,432,"COL","B","PATID",3)

"KRN",409.61,432,"COL","B","PATIENT",2)

"KRN",409.61,432,"COL","B","PROV",5)

"KRN",409.61,432,"COL","B","RETRANS",8)

"KRN",409.61,432,"COL","B","STATUS",7)

"KRN",409.61,432,"COL","B","TYPE",6)

"KRN",409.61,432,"FNL")
D EXIT^SCMCHLR1
"KRN",409.61,432,"HDR")
D HDR^SCMCHLR1
"KRN",409.61,432,"HLP")
D HELP^SCMCHLR1
"KRN",409.61,432,"INIT")
D INIT^SCMCHLR1
"MBREQ")
0
"ORD",17,409.61)
409.61;17;1;;;;;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813^2930930
"PKG",16,22,1,"PAH",1,0)
505^3080822^520651044
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3080822
"PKG",16,22,1,"PAH",1,1,1,0)
PCMM Phase III Enhancements.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","SCMCHLM")
0^1^B42881929^B19344144
"RTN","SCMCHLM",1,0)
SCMCHLM ;BP/DJB - PCMM HL7 Mail Msgs ; 6/28/99 10:16am
"RTN","SCMCHLM",2,0)
 ;;5.3;Scheduling;**177,210,505**;AUG 13, 1993;Build 20
"RTN","SCMCHLM",3,0)
 ;
"RTN","SCMCHLM",4,0)
 ;Reference routine: SCDXMSG2
"RTN","SCMCHLM",5,0)
CMPLBULL(SENT,ERRCNT,VALER) ;Send completion bulletin
"RTN","SCMCHLM",6,0)
 ;
"RTN","SCMCHLM",7,0)
 ;Input  : SENT   - Number of messages sent to NPCD. Default=0.
"RTN","SCMCHLM",8,0)
 ;         ERRCNT - Number of errored messages.
"RTN","SCMCHLM",9,0)
 ;         VALER  - Array containing error messages.
"RTN","SCMCHLM",10,0)
 ;Output : None
"RTN","SCMCHLM",11,0)
 ;
"RTN","SCMCHLM",12,0)
 ;Check input
"RTN","SCMCHLM",13,0)
 S SENT=+$G(SENT)
"RTN","SCMCHLM",14,0)
 S ERRCNT=$G(ERRCNT)
"RTN","SCMCHLM",15,0)
 S VALER=$G(VALER)
"RTN","SCMCHLM",16,0)
 ;
"RTN","SCMCHLM",17,0)
 ;Declare variables
"RTN","SCMCHLM",18,0)
 NEW MSGTXT,XMB,XMTEXT,XMY,XMDUZ,XMDT,XMZ,XMITPTR,LINE
"RTN","SCMCHLM",19,0)
 NEW ENCPTR,DELPTR,ENCDATE,ENCLOC,NAME,TMP,ENCZERO,SSN,PATZERO
"RTN","SCMCHLM",20,0)
 ;
"RTN","SCMCHLM",21,0)
 S MSGTXT="^TMP(""SCMC-XMIT-BLD"","_$J_",""BULLETIN"")"
"RTN","SCMCHLM",22,0)
 KILL @MSGTXT
"RTN","SCMCHLM",23,0)
 ;
"RTN","SCMCHLM",24,0)
 ;Put number of messages transmitted into message text
"RTN","SCMCHLM",25,0)
 S @MSGTXT@(1)="Transmission of PCMM Primary Care data to the NPCD has completed."
"RTN","SCMCHLM",26,0)
 S @MSGTXT@(2)=""
"RTN","SCMCHLM",27,0)
 S @MSGTXT@(3)="A total of "_SENT_" messages were sent."
"RTN","SCMCHLM",28,0)
 ;Put number of nontransmitted messages into message text
"RTN","SCMCHLM",29,0)
 S @MSGTXT@(4)="A total of "_ERRCNT_" messages were not sent."
"RTN","SCMCHLM",30,0)
 S @MSGTXT@(5)=""
"RTN","SCMCHLM",31,0)
 S @MSGTXT@(6)="Please review the IEMM Error listing for further detail."
"RTN","SCMCHLM",32,0)
 ;
"RTN","SCMCHLM",33,0)
 ;Set bulletin subject
"RTN","SCMCHLM",34,0)
 S XMB(1)="Transmission of data to NPCDB completed"
"RTN","SCMCHLM",35,0)
 ;Deliver bulletin
"RTN","SCMCHLM",36,0)
 S XMB="PCMM PRIMARY CARE DATA TO NPCDB SUMMARY"
"RTN","SCMCHLM",37,0)
 S XMTEXT=$P(MSGTXT,")",1)_","
"RTN","SCMCHLM",38,0)
 D ^XMB
"RTN","SCMCHLM",39,0)
 ;Done - clean up and quit
"RTN","SCMCHLM",40,0)
 KILL @MSGTXT
"RTN","SCMCHLM",41,0)
 Q
"RTN","SCMCHLM",42,0)
 ;
"RTN","SCMCHLM",43,0)
ERRBULL(REASON) ;Send error bulletin
"RTN","SCMCHLM",44,0)
 ;
"RTN","SCMCHLM",45,0)
 ;Input  : REASON - Why transmission of data could not be completed
"RTN","SCMCHLM",46,0)
 ;Output : None
"RTN","SCMCHLM",47,0)
 ;
"RTN","SCMCHLM",48,0)
 ;Check input
"RTN","SCMCHLM",49,0)
 S REASON=$G(REASON)
"RTN","SCMCHLM",50,0)
 ;
"RTN","SCMCHLM",51,0)
 ;Declare variables
"RTN","SCMCHLM",52,0)
 NEW MSGTXT,XMB,XMTEXT,XMY,XMDUZ,XMDT,XMZ
"RTN","SCMCHLM",53,0)
 ;
"RTN","SCMCHLM",54,0)
 ;Set message text
"RTN","SCMCHLM",55,0)
 S MSGTXT(1)="Transmission of PCMM Primary Care data to the CDCO"
"RTN","SCMCHLM",56,0)
 S MSGTXT(2)=" "
"RTN","SCMCHLM",57,0)
 S MSGTXT(3)="could not be completed for the following reason:"
"RTN","SCMCHLM",58,0)
 S MSGTXT(4)=" "
"RTN","SCMCHLM",59,0)
 S MSGTXT(5)="  "_REASON
"RTN","SCMCHLM",60,0)
 ;
"RTN","SCMCHLM",61,0)
 ;Set bulletin subject
"RTN","SCMCHLM",62,0)
 S XMB(1)="** TRANSMISSION OF DATA TO NPCDB NOT COMPLETED **"
"RTN","SCMCHLM",63,0)
 ;Deliver bulletin
"RTN","SCMCHLM",64,0)
 S XMB="PCMM PRIMARY CARE DATA TO NPCDB SUMMARY"
"RTN","SCMCHLM",65,0)
 S XMTEXT="MSGTXT("
"RTN","SCMCHLM",66,0)
 D ^XMB
"RTN","SCMCHLM",67,0)
 ;
"RTN","SCMCHLM",68,0)
 ;Done
"RTN","SCMCHLM",69,0)
 Q
"RTN","SCMCHLM",70,0)
 ;
"RTN","SCMCHLM",71,0)
NOTIFY ; Description: This is used to send a message to local mail group.
"RTN","SCMCHLM",72,0)
 ; The notification message is used to alert users at the local site
"RTN","SCMCHLM",73,0)
 ; that new PCMM HL7 Transmission errors were received from the CDCO.
"RTN","SCMCHLM",74,0)
 ;
"RTN","SCMCHLM",75,0)
 ;Reference routine: SCMCHLRR
"RTN","SCMCHLM",76,0)
 ;
"RTN","SCMCHLM",77,0)
 ;  Input: None
"RTN","SCMCHLM",78,0)
 ; Output: None
"RTN","SCMCHLM",79,0)
 ;
"RTN","SCMCHLM",80,0)
 ;Init variables
"RTN","SCMCHLM",81,0)
 N ACK,SCBEG,SCCNT,SCEND,SCTLIEN,SCSTAT
"RTN","SCMCHLM",82,0)
 N SCAIEN,SCADFN,SCBIEN,SCCX,SCCY,SCGLB,SCCIENB,SCCIENA,SCTPSS
"RTN","SCMCHLM",83,0)
 N SCTPOS,SCY,SCX,SCINNAM
"RTN","SCMCHLM",84,0)
 N SCHLIEN,SCHLIEN1,SCHLIEN2,SCHLIEN3,SCHLIEN4,SCHLIEN5,SCINT
"RTN","SCMCHLM",85,0)
 N SCMCIDX,SCMCIE,SCMCTMX,SCMCTPX,SCMCX,SCMGIEN,SCTP
"RTN","SCMCHLM",86,0)
 S (SCTLIEN,SCBEG,SCEND,SCCNT)=0 K ^XTMP("SCMCHLM")
"RTN","SCMCHLM",87,0)
 S ^XTMP("SCMCHLM",0)=DT_U_DT
"RTN","SCMCHLM",88,0)
 ;
"RTN","SCMCHLM",89,0)
 ;Get data from PCMM HL7 Trans Log file for records that have
"RTN","SCMCHLM",90,0)
 ;have a status of 'rejected' and 'marked for re-transmit'
"RTN","SCMCHLM",91,0)
 F SCSTAT="M","RJ" D
"RTN","SCMCHLM",92,0)
 .F  S SCTLIEN=$O(^SCPT(404.471,"ASTAT",SCSTAT,SCTLIEN)) Q:SCTLIEN=""  D
"RTN","SCMCHLM",93,0)
 ..;
"RTN","SCMCHLM",94,0)
 ..;if Included In Reject Bulletin? field is not 'YES'
"RTN","SCMCHLM",95,0)
 ..I $$INCLUDE^SCMCHLA(SCTLIEN)'="Y" D
"RTN","SCMCHLM",96,0)
 ...;
"RTN","SCMCHLM",97,0)
 ...;count rejects received
"RTN","SCMCHLM",98,0)
 ...S SCCNT=SCCNT+1
"RTN","SCMCHLM",99,0)
 ...;
"RTN","SCMCHLM",100,0)
 ...;get institution,team,position and message ID
"RTN","SCMCHLM",101,0)
 ...S (SCTPOS,SCTPSS,SCINNAM,SCTP)="UNK"
"RTN","SCMCHLM",102,0)
 ...S SCAIEN=$G(^SCPT(404.471,SCTLIEN,0)) D
"RTN","SCMCHLM",103,0)
 ....S SCADFN=$P(SCAIEN,U,2),SCMGIEN=$P(SCAIEN,U),SCHLIEN=0
"RTN","SCMCHLM",104,0)
 ....F  S SCHLIEN=$O(^SCPT(404.471,SCTLIEN,"ZPC",SCHLIEN)) Q:SCHLIEN=""  D
"RTN","SCMCHLM",105,0)
 .....S SCHLIEN1=$G(^SCPT(404.471,SCTLIEN,"ZPC",SCHLIEN,0)) Q:SCHLIEN1=""
"RTN","SCMCHLM",106,0)
 .....S SCHLIEN2=$P(SCHLIEN1,U,2),SCHLIEN3=+$G(^SCPT(404.49,SCHLIEN2,0))
"RTN","SCMCHLM",107,0)
 .....S SCHLIEN4=$G(^SCPT(404.43,SCHLIEN3,0)) Q:SCHLIEN4=""
"RTN","SCMCHLM",108,0)
 .....S SCHLIEN5=$G(^SCPT(404.42,+SCHLIEN4,0)) Q:SCHLIEN5=""
"RTN","SCMCHLM",109,0)
 .....S SCTPOS=$P(SCHLIEN4,U,2),SCTPSS=$G(^SCTM(404.57,+SCTPOS,0))
"RTN","SCMCHLM",110,0)
 .....S SCTP=$P(SCTPSS,U,2),SCY=$G(^SCTM(404.51,+SCTP,0)),SCINT=$P(SCY,U,7)
"RTN","SCMCHLM",111,0)
 .....S SCINNAM=$$GET1^DIQ(4,+SCINT_",",.01)
"RTN","SCMCHLM",112,0)
 .....I '$D(^XTMP("SCMCHLM",$J,+SCINT,+SCAIEN)) D
"RTN","SCMCHLM",113,0)
 ......S ^XTMP("SCMCHLM",$J,+SCINT,+SCAIEN,+SCHLIEN)=SCINNAM_"^"_$P(SCTPSS,U)_"^"_$P(SCY,U)
"RTN","SCMCHLM",114,0)
 ...;get date/time of 'earliest' and 'latest' reject msg
"RTN","SCMCHLM",115,0)
 ...S ACK=$$ACK^SCMCHLA(SCTLIEN)
"RTN","SCMCHLM",116,0)
 ...I 'SCBEG S SCBEG=ACK
"RTN","SCMCHLM",117,0)
 ...I ACK<SCBEG S SCBEG=ACK
"RTN","SCMCHLM",118,0)
 ...I 'SCEND S SCEND=ACK
"RTN","SCMCHLM",119,0)
 ...I ACK>SCEND S SCEND=ACK
"RTN","SCMCHLM",120,0)
 ...;
"RTN","SCMCHLM",121,0)
 ...;set Included In Reject Bulletin? field of record to 'YES'
"RTN","SCMCHLM",122,0)
 ...I $$UPDINCL^SCMCHLA(SCTLIEN,"Y")
"RTN","SCMCHLM",123,0)
 ;
"RTN","SCMCHLM",124,0)
 ;If reject msgs, then send notification message
"RTN","SCMCHLM",125,0)
 I SCCNT D SEND(SCBEG,SCEND,SCCNT)
"RTN","SCMCHLM",126,0)
 Q
"RTN","SCMCHLM",127,0)
 ;
"RTN","SCMCHLM",128,0)
SEND(SCBEG,SCEND,SCCNT) ;
"RTN","SCMCHLM",129,0)
 ; Description: Used to send PCMM Transmission Errors Received
"RTN","SCMCHLM",130,0)
 ; notification message.
"RTN","SCMCHLM",131,0)
 ;
"RTN","SCMCHLM",132,0)
 ;  Input:
"RTN","SCMCHLM",133,0)
 ;   SCBEG - internal FM date/time earliest error received
"RTN","SCMCHLM",134,0)
 ;   SCEND - internal FM date/time latest error received
"RTN","SCMCHLM",135,0)
 ;   SCCNT - count of errors received
"RTN","SCMCHLM",136,0)
 ;
"RTN","SCMCHLM",137,0)
 ; Output: None
"RTN","SCMCHLM",138,0)
 ;
"RTN","SCMCHLM",139,0)
 N SCRANGE,TEXT,XMDUN,XMDUZ,XMTEXT,XMROU,XMSTRIP,XMSUB,XMY,XMZ
"RTN","SCMCHLM",140,0)
 ;
"RTN","SCMCHLM",141,0)
 ;Init subj/sender
"RTN","SCMCHLM",142,0)
 S XMSUB="PCMM Transmission Errors Received"
"RTN","SCMCHLM",143,0)
 S (XMDUN,XMDUZ)="PCMM Module"
"RTN","SCMCHLM",144,0)
 ;
"RTN","SCMCHLM",145,0)
 ;Recipient (mail group)
"RTN","SCMCHLM",146,0)
 S XMY("G.PCMM TRANSMISSION ERRORS")=""
"RTN","SCMCHLM",147,0)
 ;
"RTN","SCMCHLM",148,0)
 ;Message body
"RTN","SCMCHLM",149,0)
 S XMTEXT="TEXT("
"RTN","SCMCHLM",150,0)
 S TEXT(1)="PCMM reject transmissions have been received from the Corporate"
"RTN","SCMCHLM",151,0)
 S TEXT(2)="Data Center Operations (CDCO)."
"RTN","SCMCHLM",152,0)
 S TEXT(3)=""
"RTN","SCMCHLM",153,0)
 S SCRANGE=" Reject Transmissions Received: "_$$FMTE^XLFDT($G(SCBEG),"2P")_" thru "_$$FMTE^XLFDT($G(SCEND),"2P")
"RTN","SCMCHLM",154,0)
 S TEXT(4)=SCRANGE
"RTN","SCMCHLM",155,0)
 S TEXT(5)="  Total Transmissions Rejected: "_$G(SCCNT)
"RTN","SCMCHLM",156,0)
 S TEXT(6)=""
"RTN","SCMCHLM",157,0)
 S TEXT(7)="Please use the PCMM Transmission Error Processing option for a"
"RTN","SCMCHLM",158,0)
 S TEXT(8)="list of the errors associated with these rejected transmissions."
"RTN","SCMCHLM",159,0)
 S TEXT(9)=""
"RTN","SCMCHLM",160,0)
 S TEXT(10)="Institution              Message ID        Team             Position"
"RTN","SCMCHLM",161,0)
 S TEXT(11)="===========              ==========        ====             ========"
"RTN","SCMCHLM",162,0)
 S TEXT(12)=""
"RTN","SCMCHLM",163,0)
 N SCMCID,SCMCIN,SCMCIDN,SCMCTM,SCMCTP,SCMCINNM,SCMCL
"RTN","SCMCHLM",164,0)
 S SCMCL=12
"RTN","SCMCHLM",165,0)
 S SCMCIN=0 F  S SCMCIN=$O(^XTMP("SCMCHLM",$J,SCMCIN)) Q:SCMCIN=""  D
"RTN","SCMCHLM",166,0)
 .S SCMCID=0 F  S SCMCID=$O(^XTMP("SCMCHLM",$J,SCMCIN,SCMCID)) Q:SCMCID=""  D
"RTN","SCMCHLM",167,0)
 ..S SCMCIE=0 F  S SCMCIE=$O(^XTMP("SCMCHLM",$J,SCMCIN,SCMCID,SCMCIE)) Q:SCMCIE<1  D
"RTN","SCMCHLM",168,0)
 ...S SCMCIDN=$G(^XTMP("SCMCHLM",$J,SCMCIN,SCMCID,SCMCIE))
"RTN","SCMCHLM",169,0)
 ...S SCMCINNM=$E($P(SCMCIDN,U,1),1,17),SCMCTM=$E($P(SCMCIDN,U,2),1,20)
"RTN","SCMCHLM",170,0)
 ...S SCMCTP=$E($P(SCMCIDN,U,3),1,20),SCMCL=SCMCL+1
"RTN","SCMCHLM",171,0)
 ...S SCMCX=SCMCINNM_$E("                    ",1,20-$L(SCMCINNM))
"RTN","SCMCHLM",172,0)
 ...S SCMCIDX=$E("                    ",1,15-$L(SCMCID))_SCMCID
"RTN","SCMCHLM",173,0)
 ...S SCMCX=SCMCX_SCMCIDX
"RTN","SCMCHLM",174,0)
 ...S SCMCTMX=$E("                     ",1,17-$L(SCMCTM))_SCMCTM
"RTN","SCMCHLM",175,0)
 ...S SCMCX=SCMCX_SCMCTMX
"RTN","SCMCHLM",176,0)
 ...S SCMCTPX=$E("                     ",1,17-$L(SCMCTP))_SCMCTP
"RTN","SCMCHLM",177,0)
 ...S SCMCX=SCMCX_SCMCTPX
"RTN","SCMCHLM",178,0)
 ...S TEXT(SCMCL)=SCMCX
"RTN","SCMCHLM",179,0)
 ;
"RTN","SCMCHLM",180,0)
 ;Mailman delivery
"RTN","SCMCHLM",181,0)
 D ^XMD
"RTN","SCMCHLM",182,0)
 K ^XTMP("SCMCHLM")
"RTN","SCMCHLM",183,0)
 Q
"RTN","SCMCHLR1")
0^2^B6890622^B6518401
"RTN","SCMCHLR1",1,0)
SCMCHLR1 ;ALB/KCL - PCMM HL7 Reject Processing - List Manager Screen ; 10-JAN-2000
"RTN","SCMCHLR1",2,0)
 ;;5.3;Scheduling;**210,505**;AUG 13, 1993;Build 20
"RTN","SCMCHLR1",3,0)
 ;
"RTN","SCMCHLR1",4,0)
EN ; Description: Main entry point for SCMC PCMM TRANSMISSION ERRORS. Used
"RTN","SCMCHLR1",5,0)
 ; to invoke LM and load list template.
"RTN","SCMCHLR1",6,0)
 ;
"RTN","SCMCHLR1",7,0)
 ;  Input: None
"RTN","SCMCHLR1",8,0)
 ; Output: None
"RTN","SCMCHLR1",9,0)
 ;
"RTN","SCMCHLR1",10,0)
 ;Invoke list template
"RTN","SCMCHLR1",11,0)
 D EN^VALM("SCMC PCMM TRANSMISSION ERRORS")
"RTN","SCMCHLR1",12,0)
 Q
"RTN","SCMCHLR1",13,0)
 ;
"RTN","SCMCHLR1",14,0)
 ;
"RTN","SCMCHLR1",15,0)
HDR ; Description: Header code to display text in header area.
"RTN","SCMCHLR1",16,0)
 ;
"RTN","SCMCHLR1",17,0)
 ;Sort by
"RTN","SCMCHLR1",18,0)
 S VALMHDR(1)="Sort By: "_$S(SCSORTBY="N":"Patient Name",SCSORTBY="D":"Date Error Received",SCSORTBY="P":"Provider",SCSORTBY="I":"Institution",1:"Unknown")
"RTN","SCMCHLR1",19,0)
 ;
"RTN","SCMCHLR1",20,0)
 ;Date range
"RTN","SCMCHLR1",21,0)
 I $G(SCBEG),($G(SCEND)) D
"RTN","SCMCHLR1",22,0)
 .S VALMHDR(1)=$$SETSTR^VALM1("Date Range: "_$$FDATE^VALM1(SCBEG)_" to "_$$FDATE^VALM1(SCEND),VALMHDR(1),46,80)
"RTN","SCMCHLR1",23,0)
 E  D
"RTN","SCMCHLR1",24,0)
 .S VALMHDR(1)=$$SETSTR^VALM1("Date Range: "_$$DRMSG,VALMHDR(1),46,80)
"RTN","SCMCHLR1",25,0)
 ;
"RTN","SCMCHLR1",26,0)
 ;Error processing status
"RTN","SCMCHLR1",27,0)
 S VALMHDR(2)="Error Processing Status: "_$S(SCEPS=1:"New",SCEPS=2:"Checked",SCEPS=3:"New/Checked",1:"Unknown")
"RTN","SCMCHLR1",28,0)
 ;
"RTN","SCMCHLR1",29,0)
 ;Indicates marked for re-transmit
"RTN","SCMCHLR1",30,0)
 S VALMHDR(2)=$$SETSTR^VALM1($$MRKMSG,VALMHDR(2),46,80)
"RTN","SCMCHLR1",31,0)
 ;
"RTN","SCMCHLR1",32,0)
 Q
"RTN","SCMCHLR1",33,0)
 ;
"RTN","SCMCHLR1",34,0)
 ;
"RTN","SCMCHLR1",35,0)
INIT ; Description: Initialize variables and list array for building list.
"RTN","SCMCHLR1",36,0)
 ;
"RTN","SCMCHLR1",37,0)
 K SCBEG,SCEND,SCEPS,SCSORTBY
"RTN","SCMCHLR1",38,0)
 K VALMBEG,VALMEND,VALMSG
"RTN","SCMCHLR1",39,0)
 ;
"RTN","SCMCHLR1",40,0)
 ;Display custom message in LM display window
"RTN","SCMCHLR1",41,0)
 ;S VALMSG=$$MRKMSG
"RTN","SCMCHLR1",42,0)
 ;
"RTN","SCMCHLR1",43,0)
 ;Set sort by = 'Patient Name'
"RTN","SCMCHLR1",44,0)
 S SCSORTBY="N"
"RTN","SCMCHLR1",45,0)
 ;
"RTN","SCMCHLR1",46,0)
 ;Set error processing status = both 'New/Checked'
"RTN","SCMCHLR1",47,0)
 S SCEPS=3
"RTN","SCMCHLR1",48,0)
 ;
"RTN","SCMCHLR1",49,0)
 ;Init date range, list all errors
"RTN","SCMCHLR1",50,0)
 S SCBEG=0
"RTN","SCMCHLR1",51,0)
 S SCEND=DT
"RTN","SCMCHLR1",52,0)
 ;
"RTN","SCMCHLR1",53,0)
 ;Build PCMM transmission errors screen
"RTN","SCMCHLR1",54,0)
 D BUILD
"RTN","SCMCHLR1",55,0)
 Q
"RTN","SCMCHLR1",56,0)
 ;
"RTN","SCMCHLR1",57,0)
 ;
"RTN","SCMCHLR1",58,0)
BUILD ; Description: Used to build PCMM error transmission screen.
"RTN","SCMCHLR1",59,0)
 ;
"RTN","SCMCHLR1",60,0)
 ;Kill the array related data before building the list
"RTN","SCMCHLR1",61,0)
 D CLEAN^VALM10
"RTN","SCMCHLR1",62,0)
 ;
"RTN","SCMCHLR1",63,0)
 K SCARY,VALMHDR
"RTN","SCMCHLR1",64,0)
 S SCARY="SCERR" ; set global array subscript
"RTN","SCMCHLR1",65,0)
 K ^TMP(SCARY_"SRT",$J),^TMP(SCARY_"IDX",$J)
"RTN","SCMCHLR1",66,0)
 S VALMBG=1 ;  init list start line
"RTN","SCMCHLR1",67,0)
 S VALMCNT=0 ; init # of lines in list
"RTN","SCMCHLR1",68,0)
 ;
"RTN","SCMCHLR1",69,0)
 ;Builder header area
"RTN","SCMCHLR1",70,0)
 D HDR
"RTN","SCMCHLR1",71,0)
 ;
"RTN","SCMCHLR1",72,0)
 ;Build list area for transmission log errors
"RTN","SCMCHLR1",73,0)
 D EN^SCMCHLR2(SCARY,SCBEG,SCEND,SCEPS,SCSORTBY,.VALMCNT)
"RTN","SCMCHLR1",74,0)
 Q
"RTN","SCMCHLR1",75,0)
 ;
"RTN","SCMCHLR1",76,0)
 ;
"RTN","SCMCHLR1",77,0)
MRKMSG() ; Description: Returns custom message for list manager header
"RTN","SCMCHLR1",78,0)
 ;
"RTN","SCMCHLR1",79,0)
 Q "* - Marked for re-transmit"
"RTN","SCMCHLR1",80,0)
 ;
"RTN","SCMCHLR1",81,0)
 ;
"RTN","SCMCHLR1",82,0)
DRMSG() ; Description: Returns custom message for date range in list manager header.
"RTN","SCMCHLR1",83,0)
 ;
"RTN","SCMCHLR1",84,0)
 Q "(None) List All Errors"
"RTN","SCMCHLR1",85,0)
 ;
"RTN","SCMCHLR1",86,0)
 ;
"RTN","SCMCHLR1",87,0)
HELP ; Description: This entry point provides custom help code when user
"RTN","SCMCHLR1",88,0)
 ;  enters a '?' at the menu prompt.
"RTN","SCMCHLR1",89,0)
 ;
"RTN","SCMCHLR1",90,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","SCMCHLR1",91,0)
 Q
"RTN","SCMCHLR1",92,0)
 ;
"RTN","SCMCHLR1",93,0)
 ;
"RTN","SCMCHLR1",94,0)
EXIT ; Description: This is used to cleanup variables and do other exit processing.
"RTN","SCMCHLR1",95,0)
 ;
"RTN","SCMCHLR1",96,0)
 D CLEAR^VALM1
"RTN","SCMCHLR1",97,0)
 D CLEAN^VALM10
"RTN","SCMCHLR1",98,0)
 K SCBEG,SCEND,SCEPS,SCSORTBY,VALMSG
"RTN","SCMCHLR1",99,0)
 K ^TMP(SCARY_"SRT",$J),^TMP(SCARY_"IDX",$J),X
"RTN","SCMCHLR1",100,0)
 Q
"RTN","SCMCHLR1",101,0)
 ;
"RTN","SCMCHLR1",102,0)
 ;
"RTN","SCMCHLR1",103,0)
EXPND ;Expand code
"RTN","SCMCHLR1",104,0)
 Q
"RTN","SCMCHLR2")
0^3^B33674081^B22282774
"RTN","SCMCHLR2",1,0)
SCMCHLR2 ;ALB/KCL - PCMM HL7 Reject Processing - Build List Area; 10-JAN-2000
"RTN","SCMCHLR2",2,0)
 ;;5.3;Scheduling;**210,272,297,458,505**;AUG 13, 1993;Build 20
"RTN","SCMCHLR2",3,0)
 ;
"RTN","SCMCHLR2",4,0)
EN(SCARY,SCBEG,SCEND,SCEPS,SCSORTBY,SCCNT) ;
"RTN","SCMCHLR2",5,0)
 ; Description: This entry point is used to build list area for
"RTN","SCMCHLR2",6,0)
 ; PCMM Transmission Errors.
"RTN","SCMCHLR2",7,0)
 ;
"RTN","SCMCHLR2",8,0)
 ; The following variables are 'system wide variables' in the
"RTN","SCMCHLR2",9,0)
 ; PCMM Transmission Error Processing List Manager application:
"RTN","SCMCHLR2",10,0)
 ;  Input:
"RTN","SCMCHLR2",11,0)
 ;      SCARY - Global array subscript
"RTN","SCMCHLR2",12,0)
 ;      SCBEG - Begin date for date range
"RTN","SCMCHLR2",13,0)
 ;      SCEND - End date for date range
"RTN","SCMCHLR2",14,0)
 ;      SCEPS - Error processing statuses
"RTN","SCMCHLR2",15,0)
 ;                1 -> New
"RTN","SCMCHLR2",16,0)
 ;                2 -> Checked
"RTN","SCMCHLR2",17,0)
 ;                3 -> Both
"RTN","SCMCHLR2",18,0)
 ;   SCSORTBY - Sort by criteria
"RTN","SCMCHLR2",19,0)
 ;                N -> Patient Name
"RTN","SCMCHLR2",20,0)
 ;                D -> Date/Time Ack Received
"RTN","SCMCHLR2",21,0)
 ;                P -> Provider
"RTN","SCMCHLR2",22,0)
 ;                I -> Institution
"RTN","SCMCHLR2",23,0)
 ;
"RTN","SCMCHLR2",24,0)
 ; Output:
"RTN","SCMCHLR2",25,0)
 ;  SCCNT - Contains number of lines in the list, pass by reference
"RTN","SCMCHLR2",26,0)
 ;
"RTN","SCMCHLR2",27,0)
 ;Display FM wait msg
"RTN","SCMCHLR2",28,0)
 D WAIT^DICD
"RTN","SCMCHLR2",29,0)
 ;
"RTN","SCMCHLR2",30,0)
 ;Get PCMM HL7 Trans Log errors
"RTN","SCMCHLR2",31,0)
 D GET(SCARY,SCBEG,SCEND,SCEPS,SCSORTBY)
"RTN","SCMCHLR2",32,0)
 ;
"RTN","SCMCHLR2",33,0)
 ;Build list area for PCMM HL7 Trans Log errors
"RTN","SCMCHLR2",34,0)
 D BLDLIST^SCMCHLR3(SCSORTBY,SCEPS,.SCCNT)
"RTN","SCMCHLR2",35,0)
 ;
"RTN","SCMCHLR2",36,0)
 ;If no PCMM HL7 Trans Log errors, display msg in list area
"RTN","SCMCHLR2",37,0)
 I 'SCCNT D
"RTN","SCMCHLR2",38,0)
 .D SET^SCMCHLR3(SCARY,1,"",1,36,0,,,,.SCCNT)
"RTN","SCMCHLR2",39,0)
 .D SET^SCMCHLR3(SCARY,2,"No 'PCMM Transmission Errors' to display.",4,41,0,,,,.SCCNT)
"RTN","SCMCHLR2",40,0)
 Q
"RTN","SCMCHLR2",41,0)
 ;
"RTN","SCMCHLR2",42,0)
 ;
"RTN","SCMCHLR2",43,0)
GET(SCARY,SCBEG,SCEND,SCEPS,SCSORTBY) ;
"RTN","SCMCHLR2",44,0)
 ; Description: Get PCMM HL7 Transmission Log errors.
"RTN","SCMCHLR2",45,0)
 ;
"RTN","SCMCHLR2",46,0)
 ;  Input:
"RTN","SCMCHLR2",47,0)
 ;      SCARY - Global array subscript
"RTN","SCMCHLR2",48,0)
 ;      SCBEG - Begin date for date range
"RTN","SCMCHLR2",49,0)
 ;      SCEND - End date for date range
"RTN","SCMCHLR2",50,0)
 ;      SCEPS - Error processing status
"RTN","SCMCHLR2",51,0)
 ;   SCSORTBY - Sort by criteria
"RTN","SCMCHLR2",52,0)
 ;
"RTN","SCMCHLR2",53,0)
 ; Output:
"RTN","SCMCHLR2",54,0)
 ;  PCMM transmission log error list sorted by:
"RTN","SCMCHLR2",55,0)
 ;
"RTN","SCMCHLR2",56,0)
 ;   Patient Name: ^TMP("SCERRSRT",$J,<sort by>,<patient name>,<trans log IEN>,<err code ien>)
"RTN","SCMCHLR2",57,0)
 ; OR,
"RTN","SCMCHLR2",58,0)
 ;   Date/Time Ack Rec'd: ^TMP("SCERRSRT",$J,<sort by>,<date/time ack rec'd>,<trans log IEN>,<err code ien>)
"RTN","SCMCHLR2",59,0)
 ; OR,
"RTN","SCMCHLR2",60,0)
 ;   Provider: ^TMP("SCERRSRT",$J,<sort by>,<provider>,<trans log IEN>,<err code ien>)
"RTN","SCMCHLR2",61,0)
 ; OR,
"RTN","SCMCHLR2",62,0)
 ;   INSTITUTION: ^TMP("SCERRSRT",$J,<sort by>,<institution>,<trans log IEN>,<err code ien>)
"RTN","SCMCHLR2",63,0)
 ;   (INSTITUTION SORT INTRO. IN SD*5.3*505)
"RTN","SCMCHLR2",64,0)
 ;
"RTN","SCMCHLR2",65,0)
 N SCDFN,SCDTR,SCERIEN,SCTLIEN,SCSTAT,SCHLIEN,SCHLIEN1,SCHLIEN2
"RTN","SCMCHLR2",66,0)
 N SCHLIEN3,SCHLIEN4,SCHLIEN5,SCTP,SCTPOS,SCTPSS
"RTN","SCMCHLR2",67,0)
 ;
"RTN","SCMCHLR2",68,0)
 ;Loop thru PCMM HL7 Trans Log for selected date range
"RTN","SCMCHLR2",69,0)
 F SCDTR=SCBEG:0 S SCDTR=$O(^SCPT(404.471,"AST",SCDTR)) Q:'SCDTR!($P(SCDTR,".")>SCEND)  D
"RTN","SCMCHLR2",70,0)
 .;loop thru status
"RTN","SCMCHLR2",71,0)
 .S SCSTAT=0
"RTN","SCMCHLR2",72,0)
 .F  S SCSTAT=$O(^SCPT(404.471,"AST",SCDTR,SCSTAT)) Q:SCSTAT=""  D
"RTN","SCMCHLR2",73,0)
 ..;loop thru patients
"RTN","SCMCHLR2",74,0)
 ..S SCDFN=0
"RTN","SCMCHLR2",75,0)
 ..F  S SCDFN=$O(^SCPT(404.471,"AST",SCDTR,SCSTAT,SCDFN)) Q:SCDFN=""  D
"RTN","SCMCHLR2",76,0)
 ...;loop through (#404.471) ien's
"RTN","SCMCHLR2",77,0)
 ...S SCTLIEN=0
"RTN","SCMCHLR2",78,0)
 ...F  S SCTLIEN=$O(^SCPT(404.471,"AST",SCDTR,SCSTAT,SCDFN,SCTLIEN)) Q:'SCTLIEN  D
"RTN","SCMCHLR2",79,0)
 ....;loop thru ien's of error code mult. and setup sort array
"RTN","SCMCHLR2",80,0)
 ....S SCERIEN=0
"RTN","SCMCHLR2",81,0)
 ....F  S SCERIEN=$O(^SCPT(404.471,SCTLIEN,"ERR",SCERIEN)) Q:'SCERIEN  D SORT(SCSORTBY,SCDTR,SCDFN,SCEPS,SCTLIEN,SCERIEN)
"RTN","SCMCHLR2",82,0)
 ;
"RTN","SCMCHLR2",83,0)
 Q
"RTN","SCMCHLR2",84,0)
 ;
"RTN","SCMCHLR2",85,0)
 ;
"RTN","SCMCHLR2",86,0)
SORT(SCSORTBY,SCDTR,SCDFN,SCEPS,SCTLIEN,SCERIEN) ;
"RTN","SCMCHLR2",87,0)
 ; Description: Used to set up sort array based on 'Sort Criteria' and
"RTN","SCMCHLR2",88,0)
 ; 'Error Processing Status' for PCMM Transmission Errors list display.
"RTN","SCMCHLR2",89,0)
 ;
"RTN","SCMCHLR2",90,0)
 ;  Input:
"RTN","SCMCHLR2",91,0)
 ;   SCSORTBY - Sort by criteria
"RTN","SCMCHLR2",92,0)
 ;      SCDTR - PCMM transmission log date/time ack received
"RTN","SCMCHLR2",93,0)
 ;      SCDFN - Patient IEN
"RTN","SCMCHLR2",94,0)
 ;      SCEPS - Error processing status
"RTN","SCMCHLR2",95,0)
 ;    SCTLIEN - PCMM transmission log IEN
"RTN","SCMCHLR2",96,0)
 ;    SCERIEN - IEN of record in Error Code (#404.47142) multiple
"RTN","SCMCHLR2",97,0)
 ;
"RTN","SCMCHLR2",98,0)
 ; Output: None
"RTN","SCMCHLR2",99,0)
 ;
"RTN","SCMCHLR2",100,0)
 N SCTLOG
"RTN","SCMCHLR2",101,0)
 ;
"RTN","SCMCHLR2",102,0)
 ;If sort by criteria is 'Date/Time Ack Received'
"RTN","SCMCHLR2",103,0)
 I SCSORTBY="D" D
"RTN","SCMCHLR2",104,0)
 .;get data from PCMM HL7 Trans Log
"RTN","SCMCHLR2",105,0)
 .I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D
"RTN","SCMCHLR2",106,0)
 ..;if Error Proc Status matches selected Error Proc Status
"RTN","SCMCHLR2",107,0)
 ..I (SCEPS=$G(SCTLOG("ERR","EPS"))!(SCEPS>2)) D
"RTN","SCMCHLR2",108,0)
 ...;setup ^tmp array sorted by date/time ack rec'd
"RTN","SCMCHLR2",109,0)
 ...S ^TMP("SCERRSRT",$J,SCSORTBY,SCDTR,SCTLIEN,SCERIEN)=""
"RTN","SCMCHLR2",110,0)
 ;
"RTN","SCMCHLR2",111,0)
 ;If sort by criteria is 'Provider'
"RTN","SCMCHLR2",112,0)
 I SCSORTBY="P" D
"RTN","SCMCHLR2",113,0)
 .N SCPTR,SCPROV,SCHL
"RTN","SCMCHLR2",114,0)
 .;get data from PCMM HL7 Trans Log
"RTN","SCMCHLR2",115,0)
 .I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D
"RTN","SCMCHLR2",116,0)
 ..;if Error Proc Status matches selected Error Proc Status
"RTN","SCMCHLR2",117,0)
 ..I (SCEPS=$G(SCTLOG("ERR","EPS"))!(SCEPS>2)) D
"RTN","SCMCHLR2",118,0)
 ...;get data from PCMM HL7 ID file
"RTN","SCMCHLR2",119,0)
 ...I $$GETHL7ID^SCMCHLA2($G(SCTLOG("ERR","ZPCID")),.SCHL) D
"RTN","SCMCHLR2",120,0)
 ....;get provider from POSITION ASSIGNMENT HISTORY file
"RTN","SCMCHLR2",121,0)
 ....S SCPTR=$P($G(SCHL("HL7ID")),"-",2)  ; pointer to PCMM HL7 ID file
"RTN","SCMCHLR2",122,0)
 ....I $G(SCTLOG("WORK")) S SCPROV=$$PROV^SCMCHLP(SCTLOG("WORK"))
"RTN","SCMCHLR2",123,0)
 ....I '$G(SCTLOG("WORK")) S SCPROV=$P($G(^SCTM(404.52,+SCPTR,0)),"^",3)
"RTN","SCMCHLR2",124,0)
 ....;setup ^tmp array sorted by provider
"RTN","SCMCHLR2",125,0)
 ....S ^TMP("SCERRSRT",$J,SCSORTBY,$S($G(SCPROV)'="":$$EXTERNAL^DILFD(404.52,.03,,SCPROV),1:"ZZZUNKNOWN"),SCTLIEN,SCERIEN)=""
"RTN","SCMCHLR2",126,0)
 ;
"RTN","SCMCHLR2",127,0)
 ;If sort by criteria is 'Patient' (default)
"RTN","SCMCHLR2",128,0)
 I SCSORTBY="N" D
"RTN","SCMCHLR2",129,0)
 .;get data from PCMM HL7 Trans Log
"RTN","SCMCHLR2",130,0)
 .I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D
"RTN","SCMCHLR2",131,0)
 ..;if Error Proc Status matches selected Error Proc Status
"RTN","SCMCHLR2",132,0)
 ..I (SCEPS=$G(SCTLOG("ERR","EPS"))!(SCEPS>2)) D
"RTN","SCMCHLR2",133,0)
 ...;setup ^tmp array sorted by patient
"RTN","SCMCHLR2",134,0)
 ...I SCDFN="W" I $G(SCTLOG("WORK"))="" S SCDFN=""
"RTN","SCMCHLR2",135,0)
 ...S ^TMP("SCERRSRT",$J,SCSORTBY,$S($P($G(^DPT(+SCDFN,0)),U)'="":$P(^(0),U),SCDFN="W":"Workload Message",1:"UNKNOWN"),SCTLIEN,SCERIEN)=""
"RTN","SCMCHLR2",136,0)
 ;
"RTN","SCMCHLR2",137,0)
 ;If sort by criteria is 'Institution" SD*5.3*505
"RTN","SCMCHLR2",138,0)
 I SCSORTBY="I" D
"RTN","SCMCHLR2",139,0)
 .;get data from PCMM HL7 Trans Log
"RTN","SCMCHLR2",140,0)
 .I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D
"RTN","SCMCHLR2",141,0)
 ..I (SCEPS=$G(SCTLOG("ERR","EPS"))!(SCEPS>2)) D
"RTN","SCMCHLR2",142,0)
 ...;setup ^tmp array sorted by institution
"RTN","SCMCHLR2",143,0)
 ...S SCHLIEN=0
"RTN","SCMCHLR2",144,0)
 ...F  S SCHLIEN=$O(^SCPT(404.471,SCTLIEN,"ZPC",SCHLIEN)) Q:SCHLIEN=""  D
"RTN","SCMCHLR2",145,0)
 ....S SCHLIEN1=$G(^SCPT(404.471,SCTLIEN,"ZPC",SCHLIEN,0)) Q:SCHLIEN<1  D
"RTN","SCMCHLR2",146,0)
 .....S SCHLIEN2=$P(SCHLIEN1,U,2),SCHLIEN3=+$G(^SCPT(404.49,SCHLIEN2,0))
"RTN","SCMCHLR2",147,0)
 .....S SCHLIEN4=$G(^SCPT(404.43,SCHLIEN3,0)) Q:SCHLIEN4=""  D
"RTN","SCMCHLR2",148,0)
 ......S SCHLIEN5=$G(^SCPT(404.42,+SCHLIEN4,0)) Q:SCHLIEN5=""  D
"RTN","SCMCHLR2",149,0)
 .......S SCTPOS=$P(SCHLIEN4,U,2),SCTPSS=$G(^SCTM(404.57,+SCTPOS,0))
"RTN","SCMCHLR2",150,0)
 .......S SCTP=$P(SCTPSS,U,2),SCY=$G(^SCTM(404.51,+SCTP,0)),SCINT=$P(SCY,U,7)
"RTN","SCMCHLR2",151,0)
 .......S SCINNAM=$$GET1^DIQ(4,+SCINT_",",99)
"RTN","SCMCHLR2",152,0)
 .......S ^TMP("SCERRSRT",$J,SCSORTBY,$S($G(SCINNAM)'="":SCINNAM,1:"UNK"),SCTLIEN,SCERIEN)=""
"RTN","SCMCHLR2",153,0)
 .......K SCTP,SCTPOS,SCTPSS,SCTP,SCY,SCINNAM,SCINT
"RTN","SCMCHLR2",154,0)
 Q
"RTN","SCMCHLR3")
0^8^B34485398^B31487264
"RTN","SCMCHLR3",1,0)
SCMCHLR3 ;ALB/KCL - PCMM HL7 Reject Processing - Build List Area con't; 10-JAN-2000
"RTN","SCMCHLR3",2,0)
 ;;5.3;Scheduling;**210,272,505**;AUG 13, 1993;Build 20
"RTN","SCMCHLR3",3,0)
 ;
"RTN","SCMCHLR3",4,0)
BLDLIST(SCSORTBY,SCEPS,SCCNT) ; Description: Build list area for for PCMM Transmission errors.
"RTN","SCMCHLR3",5,0)
 ;
"RTN","SCMCHLR3",6,0)
 ;  Input:
"RTN","SCMCHLR3",7,0)
 ;   SCSORTBY - Sort by criteria
"RTN","SCMCHLR3",8,0)
 ;               N -> Patient Name
"RTN","SCMCHLR3",9,0)
 ;               D -> Date/Time Ack Received
"RTN","SCMCHLR3",10,0)
 ;               P -> Provider
"RTN","SCMCHLR3",11,0)
 ;               I -> Institution
"RTN","SCMCHLR3",12,0)
 ;      SCEPS -  Error processing status
"RTN","SCMCHLR3",13,0)
 ;
"RTN","SCMCHLR3",14,0)
 ; Output:
"RTN","SCMCHLR3",15,0)
 ;  SCCNT - Number of lines in the list
"RTN","SCMCHLR3",16,0)
 ;
"RTN","SCMCHLR3",17,0)
 N DFN,SCSUB,SCTEXT,SCTLIEN,SCERIEN,SCTLOG,SCHL
"RTN","SCMCHLR3",18,0)
 ;
"RTN","SCMCHLR3",19,0)
 ;Init line counter and selection number
"RTN","SCMCHLR3",20,0)
 S (SCLINE,SCNUM)=0
"RTN","SCMCHLR3",21,0)
 ;
"RTN","SCMCHLR3",22,0)
 ;Quit if unable to determine col/width for caption flds in List Template
"RTN","SCMCHLR3",23,0)
 Q:'$$CAPFLD(.SCCOL,.SCWID)
"RTN","SCMCHLR3",24,0)
 ;
"RTN","SCMCHLR3",25,0)
 ;Loop thru sort array by pat name, OR date ack rec'd, OR provider, OR Institution
"RTN","SCMCHLR3",26,0)
 S SCSUB=$S(SCSORTBY="N":"",SCSORTBY="P":"",SCSORTBY="I":"",1:0)
"RTN","SCMCHLR3",27,0)
 F  S SCSUB=$O(^TMP("SCERRSRT",$J,SCSORTBY,SCSUB)) Q:SCSUB=""  D
"RTN","SCMCHLR3",28,0)
 .;loop through PCMM HL7 Transmission Log ien(s)
"RTN","SCMCHLR3",29,0)
 .S SCTLIEN=0
"RTN","SCMCHLR3",30,0)
 .F  S SCTLIEN=$O(^TMP("SCERRSRT",$J,SCSORTBY,SCSUB,SCTLIEN)) Q:'SCTLIEN  D
"RTN","SCMCHLR3",31,0)
 ..;loop through Error Code subfile ien(s)
"RTN","SCMCHLR3",32,0)
 ..S SCERIEN=0
"RTN","SCMCHLR3",33,0)
 ..F  S SCERIEN=$O(^TMP("SCERRSRT",$J,SCSORTBY,SCSUB,SCTLIEN,SCERIEN)) Q:'SCERIEN  D
"RTN","SCMCHLR3",34,0)
 ...;
"RTN","SCMCHLR3",35,0)
 ...;write dot to screen as list is being built (every 50 lines) 
"RTN","SCMCHLR3",36,0)
 ...W:'(SCLINE#50) "."
"RTN","SCMCHLR3",37,0)
 ...;
"RTN","SCMCHLR3",38,0)
 ...;get data for PCMM HL7 Trans Log entry
"RTN","SCMCHLR3",39,0)
 ...I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D
"RTN","SCMCHLR3",40,0)
 ....;
"RTN","SCMCHLR3",41,0)
 ....;increment selection number
"RTN","SCMCHLR3",42,0)
 ....S SCNUM=SCNUM+1
"RTN","SCMCHLR3",43,0)
 ....;
"RTN","SCMCHLR3",44,0)
 ....;increment line counter
"RTN","SCMCHLR3",45,0)
 ....S SCLINE=SCLINE+1
"RTN","SCMCHLR3",46,0)
 ....;
"RTN","SCMCHLR3",47,0)
 ....;set selection number in display array
"RTN","SCMCHLR3",48,0)
 ....D SET(SCARY,SCLINE,SCNUM,SCCOL("NUM"),SCWID("NUM"),SCNUM,SCTLIEN,SCTLOG("DFN"),SCERIEN,.SCCNT)
"RTN","SCMCHLR3",49,0)
 ....;
"RTN","SCMCHLR3",50,0)
 ....;set retransmit flag in display array
"RTN","SCMCHLR3",51,0)
 ....S SCTEXT=$S($G(SCTLOG("STATUS"))="M":"*",1:" ")
"RTN","SCMCHLR3",52,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("RET"),SCWID("RET"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",53,0)
 ....;set patient name in display array
"RTN","SCMCHLR3",54,0)
 ....S SCTEXT=$$LOWER^VALM1($S($G(SCTLOG("WORK")):"WORKLOAD",$G(SCTLOG("DFN")):$P($G(^DPT(SCTLOG("DFN"),0)),"^",1),1:"UNKNOWN"))
"RTN","SCMCHLR3",55,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("PAT"),SCWID("PAT"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",56,0)
 ....;
"RTN","SCMCHLR3",57,0)
 ....;set patient id in display array
"RTN","SCMCHLR3",58,0)
 ....S DFN=+SCTLOG("DFN") D PID^VADPT
"RTN","SCMCHLR3",59,0)
 ....D SET(SCARY,SCLINE,VA("BID"),SCCOL("PATID"),SCWID("PATID"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",60,0)
 ....;
"RTN","SCMCHLR3",61,0)
 ....;set date ack received in display array
"RTN","SCMCHLR3",62,0)
 ....S SCTEXT=$$LOWER^VALM1($S($G(SCTLOG("ACK DT/TM")):$E($$FDATE^VALM1(SCTLOG("ACK DT/TM")),1,8),1:"UNKNOWN"))
"RTN","SCMCHLR3",63,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("DTR"),SCWID("DTR"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",64,0)
 ....;
"RTN","SCMCHLR3",65,0)
 ....;set provider in display array
"RTN","SCMCHLR3",66,0)
 ....S SCPROV=""
"RTN","SCMCHLR3",67,0)
 ....K SCHL
"RTN","SCMCHLR3",68,0)
 ....;I workload get provider
"RTN","SCMCHLR3",69,0)
 ....I $G(SCTLOG("WORK")) S SCPROV=$$PROV^SCMCHLP(SCTLOG("WORK"))
"RTN","SCMCHLR3",70,0)
 ....;get provider if ZPC segment error
"RTN","SCMCHLR3",71,0)
 ....I $G(SCTLOG("ERR","SEG"))="ZPC" D
"RTN","SCMCHLR3",72,0)
 .....I $$GETHL7ID^SCMCHLA2($G(SCTLOG("ERR","ZPCID")),.SCHL)
"RTN","SCMCHLR3",73,0)
 .....S SCPTR=$P($G(SCHL("HL7ID")),"-",2)
"RTN","SCMCHLR3",74,0)
 .....S SCPROV=$P($G(^SCTM(404.52,+$G(SCPTR),0)),"^",3)
"RTN","SCMCHLR3",75,0)
 ....S SCTEXT=$$LOWER^VALM1($S($G(SCPROV)'="":$$EXTERNAL^DILFD(404.52,.03,,SCPROV),1:"N/A"))
"RTN","SCMCHLR3",76,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("PROV"),SCWID("PROV"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",77,0)
 ....;
"RTN","SCMCHLR3",78,0)
 ....;set provider type in display array
"RTN","SCMCHLR3",79,0)
 ....S SCTYPE=$P($G(SCHL("HL7ID")),"-",4)
"RTN","SCMCHLR3",80,0)
 ....I $G(SCTLOG("WORK")) S SCTYPE="PC"
"RTN","SCMCHLR3",81,0)
 ....S SCTEXT=$S(SCTYPE'="":SCTYPE,1:"N/A")
"RTN","SCMCHLR3",82,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("TYPE"),SCWID("TYPE"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",83,0)
 ....;
"RTN","SCMCHLR3",84,0)
 ....;set error processing status in display array
"RTN","SCMCHLR3",85,0)
 ....S SCTEXT=$$LOWER^VALM1($S($G(SCTLOG("ERR","EPS")):$$EXTERNAL^DILFD(404.47142,.06,,SCTLOG("ERR","EPS")),1:"UNKNOWN"))
"RTN","SCMCHLR3",86,0)
 ....D SET(SCARY,SCLINE,SCTEXT,SCCOL("STA"),SCWID("STA"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",87,0)
 ....;
"RTN","SCMCHLR3",88,0)
 ....;set INSTITUTION in display array
"RTN","SCMCHLR3",89,0)
 ....I SCSORTBY="I" D
"RTN","SCMCHLR3",90,0)
 .....;numeric version of institution SD*5.3*505
"RTN","SCMCHLR3",91,0)
 .....S SCTEXT=$G(SCSUB)
"RTN","SCMCHLR3",92,0)
 .....D SET(SCARY,SCLINE,SCTEXT,SCCOL("INST"),SCWID("INST"),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",93,0)
 ....;increment line counter
"RTN","SCMCHLR3",94,0)
 ....S SCLINE=SCLINE+1
"RTN","SCMCHLR3",95,0)
 ....;
"RTN","SCMCHLR3",96,0)
 ....;set error code/desc in display array
"RTN","SCMCHLR3",97,0)
 ....I $$GETEC^SCMCHLA2($G(SCTLOG("ERR","CODE")),.SCERR)
"RTN","SCMCHLR3",98,0)
 ....S SCTEXT="Error: "_$S($G(SCERR("CODE"))'="":SCERR("CODE")_" - "_$G(SCERR("SHORT")),1:$$LOWER^VALM1("UNKNOWN"))
"RTN","SCMCHLR3",99,0)
 ....K X S $P(X," ",160)=""
"RTN","SCMCHLR3",100,0)
 ....S SCTEXT=$E(SCTEXT_X,1,150)
"RTN","SCMCHLR3",101,0)
 ....D SET(SCARY,SCLINE,SCTEXT,10,$L(SCTEXT),SCNUM,,,,.SCCNT)
"RTN","SCMCHLR3",102,0)
 ;
"RTN","SCMCHLR3",103,0)
 Q
"RTN","SCMCHLR3",104,0)
 ;
"RTN","SCMCHLR3",105,0)
 ;
"RTN","SCMCHLR3",106,0)
SET(SCARY,SCLINE,SCTEXT,SCCOL,SCWID,SCNUM,SCTLIEN,SCDFN,SCERIEN,SCCNT) ;
"RTN","SCMCHLR3",107,0)
 ; Description: Set display array.
"RTN","SCMCHLR3",108,0)
 ;
"RTN","SCMCHLR3",109,0)
 ;  Input:
"RTN","SCMCHLR3",110,0)
 ;     SCARY - Global array subscript
"RTN","SCMCHLR3",111,0)
 ;    SCLINE - Line number
"RTN","SCMCHLR3",112,0)
 ;    SCTEXT - Text
"RTN","SCMCHLR3",113,0)
 ;     SCCOL - Column to start at
"RTN","SCMCHLR3",114,0)
 ;     SCWID - Column or text width
"RTN","SCMCHLR3",115,0)
 ;     SCNUM - Selection number
"RTN","SCMCHLR3",116,0)
 ;   SCTLIEN - PCMM HL7 Transmission Log IEN
"RTN","SCMCHLR3",117,0)
 ;   SCERIEN - IEN of record in Error Code (#404.47142) multiple
"RTN","SCMCHLR3",118,0)
 ;     SCDFN   Patient IEN
"RTN","SCMCHLR3",119,0)
 ;
"RTN","SCMCHLR3",120,0)
 ; Output:
"RTN","SCMCHLR3",121,0)
 ;  SCCNT - Number of lines in the list
"RTN","SCMCHLR3",122,0)
 ;
"RTN","SCMCHLR3",123,0)
 N X
"RTN","SCMCHLR3",124,0)
 S:SCLINE>SCCNT SCCNT=SCLINE
"RTN","SCMCHLR3",125,0)
 S X=$S($D(^TMP(SCARY,$J,SCLINE,0)):^(0),1:"")
"RTN","SCMCHLR3",126,0)
 S ^TMP(SCARY,$J,SCLINE,0)=$$SETSTR^VALM1(SCTEXT,X,SCCOL,SCWID)
"RTN","SCMCHLR3",127,0)
 S ^TMP(SCARY,$J,"IDX",SCLINE,SCNUM)=""
"RTN","SCMCHLR3",128,0)
 ;
"RTN","SCMCHLR3",129,0)
 ;Set special index used in retransmitting patient
"RTN","SCMCHLR3",130,0)
 I $G(SCTLIEN),$G(SCERIEN) D
"RTN","SCMCHLR3",131,0)
 .I '$G(SCTLOG("WORK")) Q:'SCDFN
"RTN","SCMCHLR3",132,0)
 .S ^TMP(SCARY_"IDX",$J,SCNUM)=SCLINE_"^"_SCTLIEN_"^"_SCERIEN
"RTN","SCMCHLR3",133,0)
 .S ^TMP(SCARY_"IDX",$J,"PT",$S(SCDFN:SCDFN,1:"W"),SCLINE)=SCTLIEN_"^"_SCERIEN
"RTN","SCMCHLR3",134,0)
 Q
"RTN","SCMCHLR3",135,0)
 ;
"RTN","SCMCHLR3",136,0)
 ;
"RTN","SCMCHLR3",137,0)
CAPFLD(SCCOL,SCWID) ; Description: Used to determine column/width of caption fields in the List Template.
"RTN","SCMCHLR3",138,0)
 ;
"RTN","SCMCHLR3",139,0)
 ;  Input:
"RTN","SCMCHLR3",140,0)
 ;   VALMDDF - Array available at run-time of list template. This array
"RTN","SCMCHLR3",141,0)
 ;             is subscripted by caption field name of List Template.
"RTN","SCMCHLR3",142,0)
 ;
"RTN","SCMCHLR3",143,0)
 ; Output:
"RTN","SCMCHLR3",144,0)
 ;  Function value: Returns 1 on success, 0 on failure
"RTN","SCMCHLR3",145,0)
 ;  SCCOL - array subscripted by abbreviation of caption field name containing the column number where the data/caption starts, pass by reference
"RTN","SCMCHLR3",146,0)
 ;  SCWID - array subscripted by abbreviation of caption field name containing the number of charaters the data/caption will use, pass by reference 
"RTN","SCMCHLR3",147,0)
 ;
"RTN","SCMCHLR3",148,0)
 ;Quit if VALMDDF array is not defined
"RTN","SCMCHLR3",149,0)
 Q:'$D(VALMDDF) 0
"RTN","SCMCHLR3",150,0)
 ;
"RTN","SCMCHLR3",151,0)
 N X
"RTN","SCMCHLR3",152,0)
 S X=VALMDDF("NUMBER"),SCCOL("NUM")=$P(X,"^",2),SCWID("NUM")=$P(X,"^",3)
"RTN","SCMCHLR3",153,0)
 S X=VALMDDF("RETRANS"),SCCOL("RET")=$P(X,"^",2),SCWID("RET")=$P(X,"^",3)
"RTN","SCMCHLR3",154,0)
 S X=VALMDDF("PATIENT"),SCCOL("PAT")=$P(X,"^",2),SCWID("PAT")=$P(X,"^",3)
"RTN","SCMCHLR3",155,0)
 S X=VALMDDF("PATID"),SCCOL("PATID")=$P(X,"^",2),SCWID("PATID")=$P(X,"^",3)
"RTN","SCMCHLR3",156,0)
 S X=VALMDDF("DATE"),SCCOL("DTR")=$P(X,"^",2),SCWID("DTR")=$P(X,"^",3)
"RTN","SCMCHLR3",157,0)
 S X=VALMDDF("PROV"),SCCOL("PROV")=$P(X,"^",2),SCWID("PROV")=$P(X,"^",3)
"RTN","SCMCHLR3",158,0)
 S X=VALMDDF("TYPE"),SCCOL("TYPE")=$P(X,"^",2),SCWID("TYPE")=$P(X,"^",3)
"RTN","SCMCHLR3",159,0)
 S X=VALMDDF("STATUS"),SCCOL("STA")=$P(X,"^",2),SCWID("STA")=$P(X,"^",3)
"RTN","SCMCHLR3",160,0)
 S X=VALMDDF("INST"),SCCOL("INST")=$P(X,"^",2),SCWID("INST")=$P(X,"^",3)
"RTN","SCMCHLR3",161,0)
 Q 1
"RTN","SCMCHLR4")
0^4^B66053379^B65400046
"RTN","SCMCHLR4",1,0)
SCMCHLR4 ;ALB/KCL - PCMM HL7 Reject Processing - Protocols; 10-JAN-2000
"RTN","SCMCHLR4",2,0)
 ;;5.3;Scheduling;**210,272,505**;AUG 13, 1993;Build 20
"RTN","SCMCHLR4",3,0)
 ;
"RTN","SCMCHLR4",4,0)
 ;This routine contains the PCMM Transmission Error processing protocols.
"RTN","SCMCHLR4",5,0)
 ;See EN^SCMCHLR2 for additional documentation on 'system wide' variables
"RTN","SCMCHLR4",6,0)
 ;used in this routine.
"RTN","SCMCHLR4",7,0)
 ;
"RTN","SCMCHLR4",8,0)
CS ; Description: Entry point for SCMC LE CHANGE STATUS protocol.
"RTN","SCMCHLR4",9,0)
 ;
"RTN","SCMCHLR4",10,0)
 ;  Input:
"RTN","SCMCHLR4",11,0)
 ;   SCEPS - Error Processing Status
"RTN","SCMCHLR4",12,0)
 ;               1 -> New
"RTN","SCMCHLR4",13,0)
 ;               2 -> Checked
"RTN","SCMCHLR4",14,0)
 ;               3 -> Both
"RTN","SCMCHLR4",15,0)
 ;
"RTN","SCMCHLR4",16,0)
 ; Output:
"RTN","SCMCHLR4",17,0)
 ;    SCEPS - Error Processing Status
"RTN","SCMCHLR4",18,0)
 ;                1 -> New
"RTN","SCMCHLR4",19,0)
 ;                2 -> Checked
"RTN","SCMCHLR4",20,0)
 ;                3 -> Both
"RTN","SCMCHLR4",21,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",22,0)
 ;
"RTN","SCMCHLR4",23,0)
 N DIR,DTOUT,DUOUT,Y
"RTN","SCMCHLR4",24,0)
 ;
"RTN","SCMCHLR4",25,0)
 ;Set screen to full scrolling region
"RTN","SCMCHLR4",26,0)
 D FULL^VALM1
"RTN","SCMCHLR4",27,0)
 N DIRUT,SCBEG,SCEND,SCEPS,SCSORTBY
"RTN","SCMCHLR4",28,0)
 ;
"RTN","SCMCHLR4",29,0)
 ;Ask user to select error processing status
"RTN","SCMCHLR4",30,0)
 S DIR(0)="SMO^1:New;2:Checked;3:Both"
"RTN","SCMCHLR4",31,0)
 S DIR("A")="Select Error Processing Status"
"RTN","SCMCHLR4",32,0)
 D ^DIR
"RTN","SCMCHLR4",33,0)
 ;
"RTN","SCMCHLR4",34,0)
 ;Process user response
"RTN","SCMCHLR4",35,0)
 I Y D
"RTN","SCMCHLR4",36,0)
 .S SCEPS=Y
"RTN","SCMCHLR4",37,0)
 .;rebuild error list for selected error processing status
"RTN","SCMCHLR4",38,0)
 .D BUILD^SCMCHLR1
"RTN","SCMCHLR4",39,0)
 ;
"RTN","SCMCHLR4",40,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",41,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",42,0)
 ;
"RTN","SCMCHLR4",43,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",44,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",45,0)
 Q
"RTN","SCMCHLR4",46,0)
 ;
"RTN","SCMCHLR4",47,0)
 ;
"RTN","SCMCHLR4",48,0)
CD ; Description: Entry point for SCMC LE CHANGE DATE RANGE protocol.
"RTN","SCMCHLR4",49,0)
 ;
"RTN","SCMCHLR4",50,0)
 ;  Input:
"RTN","SCMCHLR4",51,0)
 ;   SCBEG - Begin date for date range
"RTN","SCMCHLR4",52,0)
 ;   SCEND - End date for date range
"RTN","SCMCHLR4",53,0)
 ;
"RTN","SCMCHLR4",54,0)
 ; Output:
"RTN","SCMCHLR4",55,0)
 ;    SCBEG - Begin date for date range
"RTN","SCMCHLR4",56,0)
 ;    SCEND - End date for date range
"RTN","SCMCHLR4",57,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",58,0)
 ;
"RTN","SCMCHLR4",59,0)
 N VALMB,VALMBEG,VALMEND,X,X1,X2
"RTN","SCMCHLR4",60,0)
 ;
"RTN","SCMCHLR4",61,0)
 ;Ask user for date range (default 2 wks prior to today)
"RTN","SCMCHLR4",62,0)
 S X1=DT,X2=-14
"RTN","SCMCHLR4",63,0)
 D C^%DTC
"RTN","SCMCHLR4",64,0)
 S VALMB=X
"RTN","SCMCHLR4",65,0)
 D RANGE^VALM1
"RTN","SCMCHLR4",66,0)
 ;
"RTN","SCMCHLR4",67,0)
 ;Process user response
"RTN","SCMCHLR4",68,0)
 I 'VALMBEG!('VALMEND)!((SCBEG=VALMBEG)&(SCEND=VALMEND)) D
"RTN","SCMCHLR4",69,0)
 .W !!,"Date Range was not changed."
"RTN","SCMCHLR4",70,0)
 .D PAUSE^VALM1
"RTN","SCMCHLR4",71,0)
 .S VALMBCK=""
"RTN","SCMCHLR4",72,0)
 E  D
"RTN","SCMCHLR4",73,0)
 .S SCBEG=VALMBEG,SCEND=VALMEND
"RTN","SCMCHLR4",74,0)
 .;rebuild error list for selected date range
"RTN","SCMCHLR4",75,0)
 .D BUILD^SCMCHLR1
"RTN","SCMCHLR4",76,0)
 .;Refresh screen when returning from action
"RTN","SCMCHLR4",77,0)
 .S VALMBCK="R"
"RTN","SCMCHLR4",78,0)
 ;
"RTN","SCMCHLR4",79,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",80,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",81,0)
 ;
"RTN","SCMCHLR4",82,0)
 Q
"RTN","SCMCHLR4",83,0)
 ;
"RTN","SCMCHLR4",84,0)
 ;
"RTN","SCMCHLR4",85,0)
SL ; Description: Entry point for SCMC LE SORT LIST protocol.
"RTN","SCMCHLR4",86,0)
 ;
"RTN","SCMCHLR4",87,0)
 ;  Input:
"RTN","SCMCHLR4",88,0)
 ;   SCSORTBY - Sort by criteria
"RTN","SCMCHLR4",89,0)
 ;
"RTN","SCMCHLR4",90,0)
 ; Output:
"RTN","SCMCHLR4",91,0)
 ;  SCSORTBY - Sort by criteria
"RTN","SCMCHLR4",92,0)
 ;   VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",93,0)
 ;
"RTN","SCMCHLR4",94,0)
 N DIR,DTOUT,DUOUT,Y
"RTN","SCMCHLR4",95,0)
 ;
"RTN","SCMCHLR4",96,0)
 ;Sets screen to full scrolling region
"RTN","SCMCHLR4",97,0)
 D FULL^VALM1
"RTN","SCMCHLR4",98,0)
 ;
"RTN","SCMCHLR4",99,0)
 ;Ask user to select sort by criteria
"RTN","SCMCHLR4",100,0)
 S DIR(0)="SMO^N:Patient Name;D:Date Error Received;P:Provider;I:Institution"
"RTN","SCMCHLR4",101,0)
 S DIR("A")="Select Sort By"
"RTN","SCMCHLR4",102,0)
 D ^DIR
"RTN","SCMCHLR4",103,0)
 ;
"RTN","SCMCHLR4",104,0)
 ;Process user response
"RTN","SCMCHLR4",105,0)
 I "^N^D^P^I^"[("^"_Y_"^"),SCSORTBY'=Y D
"RTN","SCMCHLR4",106,0)
 .S SCSORTBY=Y
"RTN","SCMCHLR4",107,0)
 .;rebuild error list for selected sort criteria
"RTN","SCMCHLR4",108,0)
 .D BUILD^SCMCHLR1
"RTN","SCMCHLR4",109,0)
 ;
"RTN","SCMCHLR4",110,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",111,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",112,0)
 ;
"RTN","SCMCHLR4",113,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",114,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",115,0)
 Q
"RTN","SCMCHLR4",116,0)
 ;
"RTN","SCMCHLR4",117,0)
 ;
"RTN","SCMCHLR4",118,0)
CE ; Description: Entry point for SCMC LE CHECK ERROR OFF LIST protocol.
"RTN","SCMCHLR4",119,0)
 ;
"RTN","SCMCHLR4",120,0)
 ;  Input: None
"RTN","SCMCHLR4",121,0)
 ;
"RTN","SCMCHLR4",122,0)
 ; Output:
"RTN","SCMCHLR4",123,0)
 ;   VALMSG - Custom message
"RTN","SCMCHLR4",124,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",125,0)
 ;
"RTN","SCMCHLR4",126,0)
 N NODE,SCLINE,SCNUM,SCTLIEN,SCERIEN,VALMY
"RTN","SCMCHLR4",127,0)
 ;
"RTN","SCMCHLR4",128,0)
 ;Ask user to select transmission errors to check off the list
"RTN","SCMCHLR4",129,0)
 D EN^VALM2(XQORNOD(0))
"RTN","SCMCHLR4",130,0)
 D FULL^VALM1
"RTN","SCMCHLR4",131,0)
 ;
"RTN","SCMCHLR4",132,0)
 ;Process user selection
"RTN","SCMCHLR4",133,0)
 S SCNUM=0
"RTN","SCMCHLR4",134,0)
 F  S SCNUM=$O(VALMY(SCNUM)) Q:'SCNUM  D
"RTN","SCMCHLR4",135,0)
 .;invoke call to check error off list
"RTN","SCMCHLR4",136,0)
 .I $D(^TMP(SCARY_"IDX",$J,SCNUM)) D
"RTN","SCMCHLR4",137,0)
 ..S NODE=$G(^TMP(SCARY_"IDX",$J,SCNUM))
"RTN","SCMCHLR4",138,0)
 ..S SCLINE=+NODE,SCTLIEN=+$P(NODE,"^",2),SCERIEN=+$P(NODE,"^",3)
"RTN","SCMCHLR4",139,0)
 ..D CHKERR(SCARY,SCLINE,SCTLIEN,SCERIEN)
"RTN","SCMCHLR4",140,0)
 ;
"RTN","SCMCHLR4",141,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",142,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",143,0)
 ;
"RTN","SCMCHLR4",144,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",145,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",146,0)
 Q
"RTN","SCMCHLR4",147,0)
 ;
"RTN","SCMCHLR4",148,0)
 ;
"RTN","SCMCHLR4",149,0)
RP ; Description: Entry point for SCMC LE RETRANSMIT PATIENT protocol.
"RTN","SCMCHLR4",150,0)
 ;
"RTN","SCMCHLR4",151,0)
 ;  Input: None
"RTN","SCMCHLR4",152,0)
 ;
"RTN","SCMCHLR4",153,0)
 ; Output: 
"RTN","SCMCHLR4",154,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",155,0)
 ;
"RTN","SCMCHLR4",156,0)
 N NODE,SCLINE,SCNUM,SCTLIEN,SCTLOG,VALMY
"RTN","SCMCHLR4",157,0)
 ;
"RTN","SCMCHLR4",158,0)
 ;Ask user to select transmission errors to retransmit patient
"RTN","SCMCHLR4",159,0)
 D EN^VALM2(XQORNOD(0))
"RTN","SCMCHLR4",160,0)
 D FULL^VALM1
"RTN","SCMCHLR4",161,0)
 ;
"RTN","SCMCHLR4",162,0)
 ;Process user selections
"RTN","SCMCHLR4",163,0)
 S SCNUM=0
"RTN","SCMCHLR4",164,0)
 F  S SCNUM=$O(VALMY(SCNUM)) Q:'SCNUM  D
"RTN","SCMCHLR4",165,0)
 .;
"RTN","SCMCHLR4",166,0)
 .I $D(^TMP(SCARY_"IDX",$J,SCNUM)) D
"RTN","SCMCHLR4",167,0)
 ..S NODE=$G(^TMP(SCARY_"IDX",$J,SCNUM))
"RTN","SCMCHLR4",168,0)
 ..S SCLINE=+NODE,SCTLIEN=+$P(NODE,"^",2),SCERIEN=+$P(NODE,"^",3)
"RTN","SCMCHLR4",169,0)
 ..;get information for PCMM HL7 Transmission Log entry and invoke code
"RTN","SCMCHLR4",170,0)
 ..;to set patient to 'retransmit'.
"RTN","SCMCHLR4",171,0)
 ..I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D SETPAT(SCARY,SCLINE,.SCTLOG)
"RTN","SCMCHLR4",172,0)
 ;
"RTN","SCMCHLR4",173,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",174,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",175,0)
 ;
"RTN","SCMCHLR4",176,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",177,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",178,0)
 Q
"RTN","SCMCHLR4",179,0)
 ;
"RTN","SCMCHLR4",180,0)
 ;
"RTN","SCMCHLR4",181,0)
PE ; Description: Entry point for SCMC LE PRINT ERROR CODES protocol.
"RTN","SCMCHLR4",182,0)
 ;
"RTN","SCMCHLR4",183,0)
 ;  Input: None
"RTN","SCMCHLR4",184,0)
 ;
"RTN","SCMCHLR4",185,0)
 ; Output:
"RTN","SCMCHLR4",186,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",187,0)
 ;
"RTN","SCMCHLR4",188,0)
 ;Sets screen to full scrolling region
"RTN","SCMCHLR4",189,0)
 D FULL^VALM1
"RTN","SCMCHLR4",190,0)
 ;
"RTN","SCMCHLR4",191,0)
 ;Print PCMM Transmission Error Code Report
"RTN","SCMCHLR4",192,0)
 D ECRPRT^SCMCHLR7
"RTN","SCMCHLR4",193,0)
 D PAUSE^VALM1
"RTN","SCMCHLR4",194,0)
 ;
"RTN","SCMCHLR4",195,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",196,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",197,0)
 ;
"RTN","SCMCHLR4",198,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",199,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",200,0)
 Q
"RTN","SCMCHLR4",201,0)
 ;
"RTN","SCMCHLR4",202,0)
 ;
"RTN","SCMCHLR4",203,0)
RA ; Description: Entry point for SCMC LE RETRANSMIT ALL protocol.
"RTN","SCMCHLR4",204,0)
 ;
"RTN","SCMCHLR4",205,0)
 ;  Input: None
"RTN","SCMCHLR4",206,0)
 ;
"RTN","SCMCHLR4",207,0)
 ; Output:
"RTN","SCMCHLR4",208,0)
 ;  VALMBCK - 'R'=Refresh screen
"RTN","SCMCHLR4",209,0)
 ;
"RTN","SCMCHLR4",210,0)
 N DIR,DTOUT,DUOUT,Y
"RTN","SCMCHLR4",211,0)
 ;
"RTN","SCMCHLR4",212,0)
 ;Sets screen to full scrolling region
"RTN","SCMCHLR4",213,0)
 D FULL^VALM1
"RTN","SCMCHLR4",214,0)
 ;
"RTN","SCMCHLR4",215,0)
 ;Ask user if they want to retransmit all patients
"RTN","SCMCHLR4",216,0)
 S DIR(0)="Y"
"RTN","SCMCHLR4",217,0)
 S DIR("A")="Mark all patients for re-transmission"
"RTN","SCMCHLR4",218,0)
 S DIR("A",1)="This action will allow all patients to be marked for re-transmission."
"RTN","SCMCHLR4",219,0)
 S DIR("A",2)="The error processing status for all patients will be marked as checked."
"RTN","SCMCHLR4",220,0)
 S DIR("B")="NO"
"RTN","SCMCHLR4",221,0)
 D ^DIR
"RTN","SCMCHLR4",222,0)
 ;
"RTN","SCMCHLR4",223,0)
 ;Process user response
"RTN","SCMCHLR4",224,0)
 I '$D(DIRUT) D
"RTN","SCMCHLR4",225,0)
 .I +Y D
"RTN","SCMCHLR4",226,0)
 ..;set all patients as re-transmit
"RTN","SCMCHLR4",227,0)
 ..D UPDALL
"RTN","SCMCHLR4",228,0)
 ;
"RTN","SCMCHLR4",229,0)
 ;Place custom msg in msg window
"RTN","SCMCHLR4",230,0)
 ;S VALMSG=$$MRKMSG^SCMCHLR1
"RTN","SCMCHLR4",231,0)
 ;
"RTN","SCMCHLR4",232,0)
 ;Refresh screen when returning from action
"RTN","SCMCHLR4",233,0)
 S VALMBCK="R"
"RTN","SCMCHLR4",234,0)
 Q
"RTN","SCMCHLR4",235,0)
 ;
"RTN","SCMCHLR4",236,0)
 ;
"RTN","SCMCHLR4",237,0)
CHKERR(SCARY,SCLINE,SCTLIEN,SCERIEN) ;
"RTN","SCMCHLR4",238,0)
 ; Description: Used to check an error off the list.
"RTN","SCMCHLR4",239,0)
 ;
"RTN","SCMCHLR4",240,0)
 ;  Input:
"RTN","SCMCHLR4",241,0)
 ;     SCARY - Global array subscript
"RTN","SCMCHLR4",242,0)
 ;    SCLINE - Line number
"RTN","SCMCHLR4",243,0)
 ;   SCTLIEN - PCMM HL7 Transmission Log IEN
"RTN","SCMCHLR4",244,0)
 ;   SCERIEN - IEN of record in Error Code (#404.47142) multiple
"RTN","SCMCHLR4",245,0)
 ;
"RTN","SCMCHLR4",246,0)
 ; Output: None
"RTN","SCMCHLR4",247,0)
 ;
"RTN","SCMCHLR4",248,0)
 N SCERMSG
"RTN","SCMCHLR4",249,0)
 ;
"RTN","SCMCHLR4",250,0)
 I $$UPDEPS^SCMCHLA(SCTLIEN,SCERIEN,2,.SCERMSG) D
"RTN","SCMCHLR4",251,0)
 .D FLDTEXT^VALM10(SCLINE,"STATUS","Checked")
"RTN","SCMCHLR4",252,0)
 .D FLDCTRL^VALM10(SCLINE,"STATUS",IOINHI,IOINORM)
"RTN","SCMCHLR4",253,0)
 E  D
"RTN","SCMCHLR4",254,0)
 .W !,^TMP(SCARY,$J,SCLINE,0)
"RTN","SCMCHLR4",255,0)
 .W:$G(SCERMSG)'="" !,"...",$$LOWER^VALM1(SCERMSG)
"RTN","SCMCHLR4",256,0)
 .W !,"...Unable to check error off list"
"RTN","SCMCHLR4",257,0)
 .D PAUSE^VALM1
"RTN","SCMCHLR4",258,0)
 Q
"RTN","SCMCHLR4",259,0)
 ;
"RTN","SCMCHLR4",260,0)
 ;
"RTN","SCMCHLR4",261,0)
SETPAT(SCARY,SCLINE,SCTLOG) ; Description: Used to set patient to marked for re-transmit.
"RTN","SCMCHLR4",262,0)
 ;
"RTN","SCMCHLR4",263,0)
 ;  Input:
"RTN","SCMCHLR4",264,0)
 ;    SCARY - Global array subscript
"RTN","SCMCHLR4",265,0)
 ;   SCLINE - Line number
"RTN","SCMCHLR4",266,0)
 ;   SCTLOG - Transmission log entry array
"RTN","SCMCHLR4",267,0)
 ;
"RTN","SCMCHLR4",268,0)
 ; Output: None
"RTN","SCMCHLR4",269,0)
 ;
"RTN","SCMCHLR4",270,0)
 N SCERROR
"RTN","SCMCHLR4",271,0)
 ;
"RTN","SCMCHLR4",272,0)
 ;Set patient to marked for re-transmit
"RTN","SCMCHLR4",273,0)
 I $$UPDSTAT^SCMCHLA(SCTLIEN,"M",.SCERROR) D
"RTN","SCMCHLR4",274,0)
 .D UPDPAT(SCARY,$S($G(SCTLOG("DFN")):SCTLOG("DFN"),1:"W"),$S('$G(SCTLOG("DFN")):SCLINE,1:""))
"RTN","SCMCHLR4",275,0)
 E  D
"RTN","SCMCHLR4",276,0)
 .W !,^TMP(SCARY,$J,SCLINE,0)
"RTN","SCMCHLR4",277,0)
 .W:$G(SCERMSG)'="" !,"...",$$LOWER^VALM1(SCERROR)
"RTN","SCMCHLR4",278,0)
 .W !,"...Unable to mark patient for re-transmit"
"RTN","SCMCHLR4",279,0)
 .D PAUSE^VALM1
"RTN","SCMCHLR4",280,0)
 Q
"RTN","SCMCHLR4",281,0)
 ;
"RTN","SCMCHLR4",282,0)
 ;
"RTN","SCMCHLR4",283,0)
UPDPAT(SCARY,SCDFN,LINE) ; Description: Update all PCMM HL7 Transmission Log
"RTN","SCMCHLR4",284,0)
 ; entries in the list for the patient as 'marked for re-transmit'.
"RTN","SCMCHLR4",285,0)
 ;
"RTN","SCMCHLR4",286,0)
 ;  Input:
"RTN","SCMCHLR4",287,0)
 ;   SCARY - Global array subscript
"RTN","SCMCHLR4",288,0)
 ;   SCDFN - Patient IEN
"RTN","SCMCHLR4",289,0)
 ;
"RTN","SCMCHLR4",290,0)
 ; Output: None
"RTN","SCMCHLR4",291,0)
 ;
"RTN","SCMCHLR4",292,0)
 N SCLINE,SCTLIEN
"RTN","SCMCHLR4",293,0)
 S:'$G(LINE) LINE=9999999
"RTN","SCMCHLR4",294,0)
 ;
"RTN","SCMCHLR4",295,0)
 ;Loop thru entries in the list for the patient
"RTN","SCMCHLR4",296,0)
 S SCLINE=0
"RTN","SCMCHLR4",297,0)
 I SCDFN="W",LINE'=9999999 S SCLINE=LINE-.01
"RTN","SCMCHLR4",298,0)
 F  S SCLINE=$O(^TMP(SCARY_"IDX",$J,"PT",SCDFN,SCLINE)) Q:(('SCLINE)!(SCLINE>LINE))  S SCTLIEN=+^(SCLINE) D
"RTN","SCMCHLR4",299,0)
 .;update entry as marked for re-transmit
"RTN","SCMCHLR4",300,0)
 .D FLDTEXT^VALM10(SCLINE,"RETRANS","*")
"RTN","SCMCHLR4",301,0)
 .D FLDCTRL^VALM10(SCLINE,"RETRANS",IOINHI,IOINORM)
"RTN","SCMCHLR4",302,0)
 .;invoke code to check error off the list
"RTN","SCMCHLR4",303,0)
 .D CHKERR(SCARY,SCLINE,SCTLIEN,SCERIEN)
"RTN","SCMCHLR4",304,0)
 Q
"RTN","SCMCHLR4",305,0)
 ;
"RTN","SCMCHLR4",306,0)
 ;
"RTN","SCMCHLR4",307,0)
UPDALL ; Description: Update all PCMM HL7 Transmission Log
"RTN","SCMCHLR4",308,0)
 ; entries in the list as 'marked for re-transmit'.
"RTN","SCMCHLR4",309,0)
 ;
"RTN","SCMCHLR4",310,0)
 ;  Input: None
"RTN","SCMCHLR4",311,0)
 ; Output: None
"RTN","SCMCHLR4",312,0)
 ;
"RTN","SCMCHLR4",313,0)
 N SCLINE,SCTLIEN,SCDFN
"RTN","SCMCHLR4",314,0)
 ;
"RTN","SCMCHLR4",315,0)
 ;Loop thru entries in the list for all patients
"RTN","SCMCHLR4",316,0)
 S SCDFN=""
"RTN","SCMCHLR4",317,0)
 F  S SCDFN=$O(^TMP(SCARY_"IDX",$J,"PT",SCDFN)) Q:'SCDFN  D
"RTN","SCMCHLR4",318,0)
 .;Loop thru entries in the list for the patient
"RTN","SCMCHLR4",319,0)
 .S SCLINE=0
"RTN","SCMCHLR4",320,0)
 .F  S SCLINE=$O(^TMP(SCARY_"IDX",$J,"PT",SCDFN,SCLINE)) Q:'SCLINE  D
"RTN","SCMCHLR4",321,0)
 ..S NODE=^TMP(SCARY_"IDX",$J,"PT",SCDFN,SCLINE)
"RTN","SCMCHLR4",322,0)
 ..S SCTLIEN=+NODE,SCERIEN=+$P(NODE,"^",2)
"RTN","SCMCHLR4",323,0)
 ..;
"RTN","SCMCHLR4",324,0)
 ..;get information for PCMM HL7 Transmission Log entry and invoke code
"RTN","SCMCHLR4",325,0)
 ..;to set patient to 'retransmit'.
"RTN","SCMCHLR4",326,0)
 ..I $$GETLOG^SCMCHLA(SCTLIEN,SCERIEN,.SCTLOG) D SETPAT(SCARY,SCLINE,.SCTLOG)
"RTN","SCMCHLR4",327,0)
 ..;
"RTN","SCMCHLR4",328,0)
 ..;update entry as marked for re-transmit
"RTN","SCMCHLR4",329,0)
 ..D FLDTEXT^VALM10(SCLINE,"RETRANS","*")
"RTN","SCMCHLR4",330,0)
 ..D FLDCTRL^VALM10(SCLINE,"RETRANS",IOINHI,IOINORM)
"RTN","SCMCHLR4",331,0)
 ..;invoke code to check error off the list
"RTN","SCMCHLR4",332,0)
 ..D CHKERR(SCARY,SCLINE,SCTLIEN,SCERIEN)
"RTN","SCMCHLR4",333,0)
 ;
"RTN","SCMCHLR4",334,0)
 Q
"RTN","SCRPO5")
0^7^B23882615^B20128686
"RTN","SCRPO5",1,0)
SCRPO5 ;BP-CIOFO/KEITH - Historical Patient Assignment Detail ; 01 Jul 99  9:30 PM
"RTN","SCRPO5",2,0)
 ;;5.3;Scheduling;**177,505**;AUG 13, 1993;Build 20
"RTN","SCRPO5",3,0)
 ;
"RTN","SCRPO5",4,0)
PTDET N DIC,SC,DFN,SCPT0,X,Y,SCDT,DTOUT,DUOUT
"RTN","SCRPO5",5,0)
 D TITL^SCRPW50("Historical Patient Assignment Detail")
"RTN","SCRPO5",6,0)
 S DIC="^DPT(",DIC(0)="AEMQZ" D ^DIC I $D(DTOUT)!$D(DUOUT) G EXIT
"RTN","SCRPO5",7,0)
 G:Y<1 EXIT S DFN=+Y,SCPT0=Y(0),SC="SC",SCDT("B")="TODAY"
"RTN","SCRPO5",8,0)
 G:'$$DTR^SCRPO(.SC,.SCDT,.SCDT) EXIT
"RTN","SCRPO5",9,0)
 N ZTSAVE F X="DFN","SCPT0","SC(" S ZTSAVE(X)=""
"RTN","SCRPO5",10,0)
 W ! D EN^XUTMDEVQ("RUN^SCRPO5","Historical Patient Assignment Detail",.ZTSAVE)
"RTN","SCRPO5",11,0)
EXIT D DISP0^SCRPW23,END^SCRPW50 Q
"RTN","SCRPO5",12,0)
 ;
"RTN","SCRPO5",13,0)
RUN ;Print report
"RTN","SCRPO5",14,0)
 N SCI,SCPNOW,SCLINE,SCPAGE,SCSUB,SCFF,SCFOUND,SCLN,SCAGE,SCDATA
"RTN","SCRPO5",15,0)
 N SCDOB,SCGEND,SCIFN,SCOUT,SCPNAME,SCREC,SCSH,SCSSN,SCTITL,SCDT
"RTN","SCRPO5",16,0)
 N SCEU,SCEUNM,SCLEBNM,SCLEDT,SCSTAT,SCSTNM,SCX,SCY
"RTN","SCRPO5",17,0)
 K ^TMP("SCRPT",$J) M SCDT=SC("DTR") S SCDT="SCDT"
"RTN","SCRPO5",18,0)
 S SCI=$$GETALL^SCAPMCA(DFN,.SCDT),SCSUB="",(SCFF,SCLN,SCFOUND,SCOUT)=0
"RTN","SCRPO5",19,0)
 F  S SCSUB=$O(^TMP("SC",$J,DFN,SCSUB)) Q:SCSUB=""!(SCSUB]"PCTM")  D
"RTN","SCRPO5",20,0)
 .S SCX=$P($T(@SCSUB),";;",2) F SCI=1:1:9 S SCX(SCI)=$P(SCX,U,SCI)
"RTN","SCRPO5",21,0)
 .S ^TMP("SCRPT",$J,SCX(1))=SCX(2),SCX(3)=U_SCX(3)
"RTN","SCRPO5",22,0)
 .S SCI=0 F  S SCI=$O(^TMP("SC",$J,DFN,SCSUB,SCI)) Q:'SCI  D
"RTN","SCRPO5",23,0)
 ..S SCDATA=^TMP("SC",$J,DFN,SCSUB,SCI)
"RTN","SCRPO5",24,0)
 ..S SCNAME=$P(SCDATA,U,SCX(8))  ;provider/position/team name
"RTN","SCRPO5",25,0)
 ..S SCIFN=$P(SCDATA,U,SCX(4))  ;history record ifn
"RTN","SCRPO5",26,0)
 ..S SCACT=$P(SCDATA,U,SCX(5))  ;active date
"RTN","SCRPO5",27,0)
 ..Q:'SCACT
"RTN","SCRPO5",28,0)
 ..S SCINAC=$P(SCDATA,U,SCX(6))  ;inactive date
"RTN","SCRPO5",29,0)
 ..S SCREC=$G(@SCX(3)@(SCIFN,0))  ;history record
"RTN","SCRPO5",30,0)
 ..Q:'$L(SCREC)
"RTN","SCRPO5",31,0)
 ..S SCUSER=$P(SCREC,U,SCX(7))  ;user duz
"RTN","SCRPO5",32,0)
 ..S SCDENT=$P(SCREC,U,SCX(9))  ;date entered
"RTN","SCRPO5",33,0)
 ..S SCEU=$P(SCREC,U,6),SCEUNM=$$GET1^DIQ(200,SCEU_",",.01)  ;editing user
"RTN","SCRPO5",34,0)
 ..S SCSTAT=$P(SCREC,U,12),SCSTNM=$$GET1^DIQ(404.43,SCIFN_",",.12)  ;status
"RTN","SCRPO5",35,0)
 ..S SCLEDT=$P(SCREC,U,8),SCLEBNM=$$GET1^DIQ(200,SCLEDT_",",.01)  ;last edited by
"RTN","SCRPO5",36,0)
 ..D SLINE(SCX(1),SCNAME,SCACT,SCINAC,SCUSER,SCDENT,SCEUNM,SCSTNM,SCLEBNM,.SCLN)
"RTN","SCRPO5",37,0)
 ..Q
"RTN","SCRPO5",38,0)
 .Q
"RTN","SCRPO5",39,0)
 S SCTITL(1)="<*>  HISTORICAL PATIENT ASSIGNMENT DETAIL  <*>"
"RTN","SCRPO5",40,0)
 S SCTITL(2)="For assignments effective "_SC("DTR","PBDT")_" to "_SC("DTR","PEDT")
"RTN","SCRPO5",41,0)
 S SCLINE="",$P(SCLINE,"-",81)="",SCPAGE=1
"RTN","SCRPO5",42,0)
 S Y=$$NOW^XLFDT() X ^DD("DD") S SCPNOW=$P(Y,":",1,2)
"RTN","SCRPO5",43,0)
 S SCPNAME=$P(SCPT0,U),SCSSN=$P(SCPT0,U,9)
"RTN","SCRPO5",44,0)
 S SCGEND=$S($P(SCPT0,U,2)="M":"MALE",1:"FEMALE")
"RTN","SCRPO5",45,0)
 S (Y,SCAGE)=$P(SCPT0,U,3) X ^DD("DD") S SCDOB=Y
"RTN","SCRPO5",46,0)
 S SCAGE=$E(DT,1,3)-$E(SCAGE,1,3)-($E(DT,4,7)<$E(SCAGE,4,7))
"RTN","SCRPO5",47,0)
 D:$E(IOST)="C" DISP0^SCRPW23 D HDR^SCRPO(.SCTITL,80),SHDR
"RTN","SCRPO5",48,0)
 W:'SCFOUND !!?21,"No assignments found for this patient."
"RTN","SCRPO5",49,0)
 I SCFOUND S SCSUB=0 F  S SCSUB=$O(^TMP("SCRPT",$J,SCSUB)) Q:'SCSUB!SCOUT  D
"RTN","SCRPO5",50,0)
 .D:$Y>(IOSL-5) HDR^SCRPO(.SCTITL,80),SHDR Q:SCOUT
"RTN","SCRPO5",51,0)
 .S SCSH=^TMP("SCRPT",$J,SCSUB)
"RTN","SCRPO5",52,0)
 .W:SCSUB>1 ! D SSHDR(SCSH) S SCACT=""
"RTN","SCRPO5",53,0)
 .I '$O(^TMP("SCRPT",$J,SCSUB,"")) W "  (none found)" Q
"RTN","SCRPO5",54,0)
 .F  S SCACT=$O(^TMP("SCRPT",$J,SCSUB,SCACT)) Q:SCACT=""!SCOUT  D
"RTN","SCRPO5",55,0)
 ..S SCI=0 F  S SCI=$O(^TMP("SCRPT",$J,SCSUB,SCACT,SCI)) Q:'SCI!SCOUT  D
"RTN","SCRPO5",56,0)
 ...D:$Y>(IOSL-3) HDR^SCRPO(.SCTITL,80),SHDR,SSHDR(SCSH,1) Q:SCOUT
"RTN","SCRPO5",57,0)
 ...S SCX=^TMP("SCRPT",$J,SCSUB,SCACT,SCI)
"RTN","SCRPO5",58,0)
 ...W !,$P(SCX,U),?28,$P(SCX,U,2),?40,$P(SCX,U,3),?52,$P(SCX,U,4)
"RTN","SCRPO5",59,0)
 ...I SCSUB=3 D
"RTN","SCRPO5",60,0)
 ....W !,"User Entering: ",$P(SCX,U,6)
"RTN","SCRPO5",61,0)
 ....W !,"Last Edited By: ",$P(SCX,U,7)
"RTN","SCRPO5",62,0)
 ....W !,"Status: ",$P(SCX,U,5)
"RTN","SCRPO5",63,0)
 ...Q
"RTN","SCRPO5",64,0)
 ..Q
"RTN","SCRPO5",65,0)
 .Q
"RTN","SCRPO5",66,0)
 I 'SCOUT,$E(IOST)="C" N DIR S DIR(0)="E" W ! D ^DIR
"RTN","SCRPO5",67,0)
 K ^TMP("SCRPT",$J) Q
"RTN","SCRPO5",68,0)
 ;
"RTN","SCRPO5",69,0)
SHDR ;Subheader
"RTN","SCRPO5",70,0)
 Q:SCOUT
"RTN","SCRPO5",71,0)
 W !,"Patient: ",$E(SCPNAME,1,18),?29,"SSN: ",SCSSN,?46,"DOB: ",SCDOB
"RTN","SCRPO5",72,0)
 W ?64,"AGE: ",SCAGE,?74,$J(SCGEND,6),!,SCLINE
"RTN","SCRPO5",73,0)
 Q:'SCFOUND
"RTN","SCRPO5",74,0)
 W !,"Assignment",?28,"Active",?40,"Inactive",?52,"Assigned by/date"
"RTN","SCRPO5",75,0)
 W !,"--------------------------  ----------  ----------  ----------------------------"
"RTN","SCRPO5",76,0)
 Q
"RTN","SCRPO5",77,0)
 ;
"RTN","SCRPO5",78,0)
SSHDR(X,CONT) ;Subheader
"RTN","SCRPO5",79,0)
 ;Input: X=category
"RTN","SCRPO5",80,0)
 ;Input: CONT='1' for continuation (optional)
"RTN","SCRPO5",81,0)
 W !,X,$S($G(CONT):" (cont.)",1:""),":"
"RTN","SCRPO5",82,0)
 Q
"RTN","SCRPO5",83,0)
 ;
"RTN","SCRPO5",84,0)
SLINE(SCORD,SCNAME,SCACT,SCINAC,SCUSER,SCDENT,SUNM,SCTNM,SCBNM,SCLN) ;Set report global
"RTN","SCRPO5",85,0)
 ;Input: SCORD=output order
"RTN","SCRPO5",86,0)
 ;Input: SCNAME=provider/position/team name
"RTN","SCRPO5",87,0)
 ;Input: SCACT=active date
"RTN","SCRPO5",88,0)
 ;Input: SCINAC=inactive date
"RTN","SCRPO5",89,0)
 ;Input: SCUSER=user duz
"RTN","SCRPO5",90,0)
 ;Input: SCDENT=date entered
"RTN","SCRPO5",91,0)
 ;Input: SUNM=entered by
"RTN","SCRPO5",92,0)
 ;Input: SCTNM=status
"RTN","SCRPO5",93,0)
 ;Input: SCBNM=last edited by
"RTN","SCRPO5",94,0)
 ;
"RTN","SCRPO5",95,0)
 ;N SCX,SCY
"RTN","SCRPO5",96,0)
 S SCFOUND=1,SCLN=SCLN+1
"RTN","SCRPO5",97,0)
 S SCX=$E(SCNAME,1,25)_U_$$SDT(SCACT)_U_$$SDT(SCINAC),SCY=$$SDT(SCDENT)
"RTN","SCRPO5",98,0)
 S:$L(SCY) SCY=" ("_SCY_")"
"RTN","SCRPO5",99,0)
 S SCX=SCX_U_$E($P($G(^VA(200,+SCUSER,0)),U),1,(28-$L(SCY)))_SCY_U_SCTNM_U_SUNM_U_SCBNM
"RTN","SCRPO5",100,0)
 S ^TMP("SCRPT",$J,SCORD,-SCACT,SCLN)=SCX
"RTN","SCRPO5",101,0)
 Q
"RTN","SCRPO5",102,0)
 ;
"RTN","SCRPO5",103,0)
CODE ;Data handling instructions
"RTN","SCRPO5",104,0)
 ;  The following $TEXT lines contain data handling instructions
"RTN","SCRPO5",105,0)
 ;  in the format:  $PIECE 1 = output order
"RTN","SCRPO5",106,0)
 ;                         2 = subtitle
"RTN","SCRPO5",107,0)
 ;                         3 = global reference of history record
"RTN","SCRPO5",108,0)
 ;                         4 = $piece of history record ifn
"RTN","SCRPO5",109,0)
 ;                         5 = $piece of active date
"RTN","SCRPO5",110,0)
 ;                         6 = $piece of inactive date
"RTN","SCRPO5",111,0)
 ;                         7 = $piece of user (in history record)
"RTN","SCRPO5",112,0)
 ;                         8 = $piece of provider/position/team name
"RTN","SCRPO5",113,0)
 ;                         9 = $piece of date entered
"RTN","SCRPO5",114,0)
 ;
"RTN","SCRPO5",115,0)
NPCPOS ;;7^Non-PC Position^SCPT(404.43)^4^5^6^6^2^7
"RTN","SCRPO5",116,0)
NPCPPOS ;;9^Non-PC Preceptor Position^SCTM(404.53)^16^14^15^7^2^8
"RTN","SCRPO5",117,0)
NPCPPR ;;8^Non-PC Preceptor Provider^SCTM(404.52)^11^9^10^7^2^8
"RTN","SCRPO5",118,0)
NPCPR ;;6^Non-PC Provider^SCTM(404.52)^11^9^10^7^2^8
"RTN","SCRPO5",119,0)
NPCTM ;;10^Non-PC Team^SCPT(404.42)^3^4^5^11^2^12
"RTN","SCRPO5",120,0)
PCAP ;;2^PC Associate Provider^SCTM(404.52)^11^9^10^7^2^8
"RTN","SCRPO5",121,0)
PCPOS ;;3^PC Position^SCPT(404.43)^4^5^6^6^2^7
"RTN","SCRPO5",122,0)
PCPPOS ;;4^PC Preceptor Position^SCTM(404.53)^16^14^15^7^2^8
"RTN","SCRPO5",123,0)
PCPR ;;1^PC Provider^SCTM(404.52)^11^9^10^7^2^8
"RTN","SCRPO5",124,0)
PCTM ;;5^PC Team^SCPT(404.42)^3^4^5^11^2^12
"RTN","SCRPO5",125,0)
 ;
"RTN","SCRPO5",126,0)
SDT(X) ;Slashed date
"RTN","SCRPO5",127,0)
 S X=$E(X,1,7) Q:X'?7N ""
"RTN","SCRPO5",128,0)
 Q $E(X,4,5)_"/"_$E(X,6,7)_"/"_(17+$E(X))_$E(X,2,3)
"RTN","SDWLI")
0^5^B73452514^B72458780
"RTN","SDWLI",1,0)
SDWLI ;BPOI/TEH - DISPLAY PENDING APPOINTMENTS;6/1/05
"RTN","SDWLI",2,0)
 ;;5.3;scheduling;**263,327,394,446,524,505**;08/13/93;Build 20
"RTN","SDWLI",3,0)
 ;
"RTN","SDWLI",4,0)
 ;
"RTN","SDWLI",5,0)
 ;******************************************************************
"RTN","SDWLI",6,0)
 ;                             CHANGE LOG
"RTN","SDWLI",7,0)
 ;                                               
"RTN","SDWLI",8,0)
 ;   DATE               PATCH          DESCRIPTION
"RTN","SDWLI",9,0)
 ;   ----             -----             -----------
"RTN","SDWLI",10,0)
 ;   04/22/2005      SD*5.3*327  DISPLAY APPOINTMENT INFORMATION
"RTN","SDWLI",11,0)
 ;   04/22/2005      SD*5.3*327  UNDEFINED ERROR HD+1
"RTN","SDWLI",12,0)
 ;   08/07/2006      SD*5.3*446  proceed only when DFN defined
"RTN","SDWLI",13,0)
 ;   04/14/2006      SD*5.3*446  INTER-FACILITY TRANSFER
"RTN","SDWLI",14,0)
 ;
"RTN","SDWLI",15,0)
 ;
"RTN","SDWLI",16,0)
EN ;NEW AND INITIALIZE VARIABLES
"RTN","SDWLI",17,0)
 S SDWLERR=0 N %DT,DD
"RTN","SDWLI",18,0)
 I $D(SDWLLIST),SDWLLIST D  Q:SDWLERR
"RTN","SDWLI",19,0)
 .I '$G(DFN) S SDWLERR=1 Q
"RTN","SDWLI",20,0)
 .I $D(DFN),DFN'="",'$D(^SDWL(409.3,"B",DFN)) D HD W *7,!,"This Patient has NO entries on the Electronic Wait List." S DIR(0)="E" D ^DIR S DUOUT=1 Q
"RTN","SDWLI",21,0)
 I $D(DUOUT) G END
"RTN","SDWLI",22,0)
 I 'SDWLERR,$D(SDWLLIST),SDWLLIST D 1^VADPT,DEM^VADPT S SDWLDFN=DFN D HD,SEL G END:$D(DUOUT) K DIR,DIC,DR,DIE,VADM S (SDWLBDT,SDWLEDT)="" K ^TMP("SDWLI",$J) G EN1
"RTN","SDWLI",23,0)
 K DIR,DIC,DR,DIE,VADM
"RTN","SDWLI",24,0)
 S (SDWLBDT,SDWLEDT)="" K ^TMP("SDWLI",$J)
"RTN","SDWLI",25,0)
 ;
"RTN","SDWLI",26,0)
 ;OPTION HEADER
"RTN","SDWLI",27,0)
 ;
"RTN","SDWLI",28,0)
 D HD
"RTN","SDWLI",29,0)
 ;
"RTN","SDWLI",30,0)
 ;PATIENT LOOK-UP FROM WAIT LIST PATIENT FILE (^SDWL(409.3,IEN,0).
"RTN","SDWLI",31,0)
 ;
"RTN","SDWLI",32,0)
 D SEL G EN:$D(DUOUT)
"RTN","SDWLI",33,0)
 D PAT Q:'$D(SDWLDFN)
"RTN","SDWLI",34,0)
 G END:SDWLDFN<0,END:SDWLDFN=""
"RTN","SDWLI",35,0)
 Q:$D(DUOUT)
"RTN","SDWLI",36,0)
EN1 K DIR,DIC,DR,DIE,SDWLDRG
"RTN","SDWLI",37,0)
 D GETFILE
"RTN","SDWLI",38,0)
 D DISP G EN:'$D(DUOUT)
"RTN","SDWLI",39,0)
 D END
"RTN","SDWLI",40,0)
 Q
"RTN","SDWLI",41,0)
PAT ;PATIENT LOOK-UP
"RTN","SDWLI",42,0)
 ;PATCH SD*5.3*524 - SET DIC("S") FOR SCREEN OF OPEN/CLOSED ENTRIES
"RTN","SDWLI",43,0)
 K DIC,DIC("S")
"RTN","SDWLI",44,0)
 I $D(SDWLY),SDWLY S DIC("S")="I $P(^SDWL(409.3,+Y,0),U,17)=""O"""
"RTN","SDWLI",45,0)
 S DIC(0)="EMNQA",DIC=409.3 D ^DIC S (SDWLDFN,DFN)=$P(Y,U,2)
"RTN","SDWLI",46,0)
 G PATEND:SDWLDFN=""
"RTN","SDWLI",47,0)
 Q:Y<0
"RTN","SDWLI",48,0)
 Q:$D(DUOUT)
"RTN","SDWLI",49,0)
 D 1^VADPT
"RTN","SDWLI",50,0)
PATEND Q
"RTN","SDWLI",51,0)
 ;
"RTN","SDWLI",52,0)
 ;PROMPT FOR DISPLAY 'OPEN' WAITING LIST ONLY OR PROMPT FOR BEGINNING AND ENDING DATES
"RTN","SDWLI",53,0)
 ;
"RTN","SDWLI",54,0)
SEL K SDWLDRG S DIR(0)="Y" S DIR("A")="Do You Want to View Only 'OPEN' Wait Lists",DIR("B")="YES"
"RTN","SDWLI",55,0)
 S DIR("?")="'Yes' for 'Open' and these Patient Record have not been dispositioned and 'No' for all Records."
"RTN","SDWLI",56,0)
 W ! D ^DIR S SDWLY=Y W !
"RTN","SDWLI",57,0)
 I X["^" S DUOUT=1 Q
"RTN","SDWLI",58,0)
 I SDWLY=0 D SEL1
"RTN","SDWLI",59,0)
 Q
"RTN","SDWLI",60,0)
SEL1 K DIR,%DT(0) S SDWLDISC="",%DT="AE",%DT("A")="Start with Date Entered: " D ^%DT G SEL:Y<1 S SDWLBDT=Y
"RTN","SDWLI",61,0)
 S %DT(0)=SDWLBDT,%DT("A")="End with Date Entered: " D ^%DT G SEL1:Y<1 S SDWLEDT=Y,SDWLDRG="" K %DT(0),%DT("A")
"RTN","SDWLI",62,0)
 Q
"RTN","SDWLI",63,0)
 ;
"RTN","SDWLI",64,0)
GETFILE ;GET DATA - OPTIONAL DATE RANGE IF SDWLDBT AND SDWLEDT VALID DATE RANGE
"RTN","SDWLI",65,0)
 ;
"RTN","SDWLI",66,0)
 K ^TMP("SDWLI",$J),SDWLDISX S SDWLDA=0,SDWLCNT=0 F  S SDWLDA=$O(^SDWL(409.3,"B",SDWLDFN,SDWLDA)) Q:SDWLDA=""  D
"RTN","SDWLI",67,0)
 .S SDWLDATA=$G(^SDWL(409.3,SDWLDA,0)) I '$D(SDWLDRG),SDWLY,$P(SDWLDATA,U,17)["C" Q
"RTN","SDWLI",68,0)
 .I '$P(SDWLDATA,U,3) Q
"RTN","SDWLI",69,0)
 .N SDWLAPP S SDWLAPP="" I $D(^SDWL(409.3,SDWLDA,"SDAPT")) S SDWLAPP=^("SDAPT") D  ;app data
"RTN","SDWLI",70,0)
 ..S SDWLAPP=SDWLAPP_"~"_$P(SDWLDATA,U,23)
"RTN","SDWLI",71,0)
 .N SDOP,SDOP1 S SDOP="" I $D(^SDWL(409.3,SDWLDA,1)) S SDOP=^(1),SDOP1=$$GET1^DIQ(409.3,SDWLDA_",",29),$P(SDOP,U)=SDOP1
"RTN","SDWLI",72,0)
 .I $D(^SDWL(409.3,SDWLDA,"DIS")) D
"RTN","SDWLI",73,0)
 ..S SDWLDISX=$G(^SDWL(409.3,SDWLDA,"DIS")),SDWLDIS=$P(SDWLDISX,U,3),SDWLDDUZ=$P(SDWLDISX,U,2)
"RTN","SDWLI",74,0)
 ..S SDWLDDT=$P(^SDWL(409.3,SDWLDA,"DIS"),U,1)
"RTN","SDWLI",75,0)
 ..S SDWLDIDT="" I SDWLDDT'="" S SDWLDIDT=$E(SDWLDDT,4,5)_"/"_$E(SDWLDDT,6,7)_"/"_$E(SDWLDDT,2,3)
"RTN","SDWLI",76,0)
 .I $D(^SDWL(409.3,SDWLDA,"DNR")) D
"RTN","SDWLI",77,0)
 ..S SDREM=$G(^SDWL(409.3,SDWLDA,"DNR")) S SDREMD=$P(SDWLDATA,U,14),SDREMU=$P(SDWLDATA,U,15)
"RTN","SDWLI",78,0)
 ..S SDREMDD="" I SDREMD'="" S SDREMDD=$E(SDREMD,4,5)_"/"_$E(SDREMD,6,7)_"/"_$E(SDREMD,2,3)
"RTN","SDWLI",79,0)
 ..S SDREMR=$$GET1^DIQ(409.3,SDWLDA_",",18),SDREMRC=$$GET1^DIQ(409.3,SDWLDA_",",18.1,"I")
"RTN","SDWLI",80,0)
 .S SDWLST=$P(SDWLDATA,U,6),SDWLSP=$P(SDWLDATA,U,7),SDWLSS=$P(SDWLDATA,U,8),SDWLSC=$P(SDWLDATA,U,9),SDWLDT=$P(SDWLDATA,U,2)
"RTN","SDWLI",81,0)
 .S SDWLPROV=$P(SDWLDATA,U,13) I $D(SDWLDRG) D  I SDNOK Q
"RTN","SDWLI",82,0)
 ..S SDNOK=0
"RTN","SDWLI",83,0)
 ..I SDWLDT<SDWLBDT!(SDWLDT>SDWLEDT) S SDNOK=1 Q
"RTN","SDWLI",84,0)
 .;
"RTN","SDWLI",85,0)
 .;IF STATUS IS CLOSED DO NOT DISPLAY RECORD
"RTN","SDWLI",86,0)
 .;
"RTN","SDWLI",87,0)
 .S SDWLCNT=SDWLCNT+1,^TMP("SDWLI",$J,SDWLCNT)=SDWLDATA_"~"_SDWLDA
"RTN","SDWLI",88,0)
 .I $D(SDWLDISX) D 
"RTN","SDWLI",89,0)
 ..S ^TMP("SDWLI",$J,SDWLCNT,"DIS")=SDWLDIS_"^"_SDWLDDUZ_"^"_SDWLDIDT
"RTN","SDWLI",90,0)
 ..I SDWLAPP>0 S ^TMP("SDWLI",$J,SDWLCNT,"SDAPT")=SDWLAPP
"RTN","SDWLI",91,0)
 ..I SDOP'="" S ^TMP("SDWLI",$J,SDWLCNT,"SDOP")=SDOP
"RTN","SDWLI",92,0)
 .I $D(SDREM) D
"RTN","SDWLI",93,0)
 ..S ^TMP("SDWLI",$J,SDWLCNT,"REM")=SDREMR_U_SDREMRC_U_SDREMU_U_SDREMDD
"RTN","SDWLI",94,0)
 .S ^TMP("SDWLI",$J)=SDWLCNT
"RTN","SDWLI",95,0)
 .K SDWLDISX,SDREM
"RTN","SDWLI",96,0)
 Q
"RTN","SDWLI",97,0)
 ;
"RTN","SDWLI",98,0)
DISP ;Display Wait List Data
"RTN","SDWLI",99,0)
 S (SDWLDT,SDWLCNT,SDWLCN)="",SDWLCT=$G(^TMP("SDWLI",$J)) I 'SDWLCT W !!,"No 'OPEN' Wait List Records to Display.",!! K DIR S DIR(0)="E" D ^DIR S DUOUT="" Q
"RTN","SDWLI",100,0)
 F  S SDWLCNT=$O(^TMP("SDWLI",$J,SDWLCNT)) Q:SDWLCNT=""  D  I $D(DUOUT) Q
"RTN","SDWLI",101,0)
 .N SDWLDISX,SDWLR,SDWLCLPT
"RTN","SDWLI",102,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"DIS")) S SDWLDISX=$G(^TMP("SDWLI",$J,SDWLCNT,"DIS"))
"RTN","SDWLI",103,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"REM")) S SDWLR=$G(^TMP("SDWLI",$J,SDWLCNT,"REM")) D
"RTN","SDWLI",104,0)
 ..S SDREMR=$P(SDWLR,U),SDREMRC=$P(SDWLR,U,2),SDREMU=$P(SDWLR,U,3),SDREMDD=$P(SDWLR,U,4)
"RTN","SDWLI",105,0)
 .S X=$G(^TMP("SDWLI",$J,SDWLCNT)),SDWLDA=$P(X,"~",2),SDWLIN=$P(X,U,3),SDWLCL=$P(X,U,4),SDWLTY=$P(X,U,5),SDWLPRI=$P(X,U,11)
"RTN","SDWLI",106,0)
 .S SDWLTYP=$S(SDWLTY=1:$P(X,U,6),SDWLTY=2:$P(X,U,7),SDWLTY=3:$P(X,U,8),SDWLTY=4:$P(X,U,9),1:"")
"RTN","SDWLI",107,0)
 .S SDWLTYN=$S(SDWLTY=1:5,SDWLTY=2:6,SDWLTY=3:7,SDWLTY=4:8),SDWLCOM=$P($P(X,U,18),"~",1)
"RTN","SDWLI",108,0)
 .S SDWLDUZ=$P(X,U,10),SDWLPRV=$P(X,U,12),SDWLPROV=$P(X,U,13),SDWLX=$P(X,"~",3) D
"RTN","SDWLI",109,0)
 ..I $D(SDWLDISX) S SDWLDIS=$P(SDWLDISX,U,1),SDWLDDUZ=$P(SDWLDISX,U,2),SDWLDIDT=$P(SDWLDISX,U,3)
"RTN","SDWLI",110,0)
 .S SDWLDT=$P(X,U,2),YY=$E(SDWLDT,1,3)+1700,YY=$E(YY,3,4),MM=$E(SDWLDT,4,5),DD=$E(SDWLDT,6,7),SDWLDTP=MM_"/"_DD_"/"_YY
"RTN","SDWLI",111,0)
 .S SDWLDTD=$P(X,U,16),YY=$E(SDWLDTD,1,3)+1700,YY=$E(YY,3,4),MM=$E(SDWLDTD,4,5),DD=$E(SDWLDTD,6,7),SDWLDTD=MM_"/"_DD_"/"_YY
"RTN","SDWLI",112,0)
 .;PATCH SD*5.3*394 See Note.
"RTN","SDWLI",113,0)
 .N SDWLSCP
"RTN","SDWLI",114,0)
 .S SDWLSCP=+$P($G(^SDWL(409.3,SDWLDA,"SC")),U,2)
"RTN","SDWLI",115,0)
 .W !,"# ",$J(SDWLCNT,3),!
"RTN","SDWLI",116,0)
 .W !,"Wait List - ",$$EXTERNAL^DILFD(409.3,4,,SDWLTY),?55,"Date Entered - ",SDWLDTP
"RTN","SDWLI",117,0)
 .W !,?15 S X=$$EXTERNAL^DILFD(409.3,SDWLTYN,,SDWLTYP) W X
"RTN","SDWLI",118,0)
 .S SDWLP=0 I SDWLPRI W !,"Priority - ",$$EXTERNAL^DILFD(409.3,10,,SDWLPRI) S SDWLP=1
"RTN","SDWLI",119,0)
 .I $D(SDWLSCP) W !,"Service Connected Priority - ",$$EXTERNAL^DILFD(409.3,15,,SDWLSCP)
"RTN","SDWLI",120,0)
 .W:SDWLP ?15 W:'SDWLP ! W "Institution - ",$$EXTERNAL^DILFD(409.3,2,,SDWLIN)
"RTN","SDWLI",121,0)
 .W !,"Entered by - " S X=$$EXTERNAL^DILFD(409.3,9,,SDWLDUZ) W X
"RTN","SDWLI",122,0)
 .S SDWRB=0 I SDWLPRV W !,"Requested By - ",$$EXTERNAL^DILFD(409.3,11,,SDWLPRV),?55,"Date Desired - ",SDWLDTD
"RTN","SDWLI",123,0)
 .I SDWLPRV=1 W !,"Provider - ",$$EXTERNAL^DILFD(409.3,12,,SDWLPROV)
"RTN","SDWLI",124,0)
 .I $D(SDWLCOM),SDWLCOM'="" W !,"Comments - ",SDWLCOM
"RTN","SDWLI",125,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"SDOP")) N SDOP S SDOP=^("SDOP") W !,"Reopen Reason: ",$P(SDOP,U) D
"RTN","SDWLI",126,0)
 ..I $P(SDOP,U,2)'="" W !,"Reopen comment: ",$P(SDOP,U,2)
"RTN","SDWLI",127,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"REM")) W !,"Non Removal Reason - ",SDREMR,!,"Non Remove Reason entered by - ",$$GET1^DIQ(200,SDREMU_",",.01,"I") D
"RTN","SDWLI",128,0)
 ..I $L(SDREMRC)>0 W !,"Non Removal Comment - ",SDREMRC
"RTN","SDWLI",129,0)
 ..W !,"Non Removal entry date - ",SDREMDD
"RTN","SDWLI",130,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"DIS")) W !,"Disposition - ",$$EXTERNAL^DILFD(409.3,21,,SDWLDIS),?51,"Disposition Date - ",SDWLDIDT D 
"RTN","SDWLI",131,0)
 ..W !,"Dispositioned by - ",$$EXTERNAL^DILFD(409.3,20,,SDWLDDUZ)
"RTN","SDWLI",132,0)
 .I $D(^TMP("SDWLI",$J,SDWLCNT,"SDAPT")) N SDAP S SDAP=^("SDAPT") D
"RTN","SDWLI",133,0)
 ..W !,"Appointment scheduled for " S Y=$P(SDAP,"~",2) D DD^%DT W Y
"RTN","SDWLI",134,0)
 ..W !?3,"Made on: " S Y=+SDAP D DD^%DT W Y,?30,"For clinic: " N SDC S SDC=$P(SDAP,U,2) S SDC=$$GET1^DIQ(44,SDC_",",.01) W SDC
"RTN","SDWLI",135,0)
 ..N SDAIN S SDAIN=$P(SDAP,U,3),SDAIN=$$GET1^DIQ(4,SDAIN_",",.01)
"RTN","SDWLI",136,0)
 ..W !?3,"Appt Institution: ",SDAIN
"RTN","SDWLI",137,0)
 ..N SDCR S SDCR=$P(SDAP,U,4),SDCR=$$GET1^DIQ(40.7,SDCR_",",.01)
"RTN","SDWLI",138,0)
 ..W ?40,"Appt Specialty: ",SDCR
"RTN","SDWLI",139,0)
 ..N SAPS S SAPS=$P(SDAP,U,8),SAPS=$P(SAPS,"~") I SAPS="CC" W !,"Appointment Status: Canceled by Clinic"
"RTN","SDWLI",140,0)
 .S SDWLCLPT=$$GET1^DIQ(409.3,SDWLDA,37,"I")  ; SD*5.3*446
"RTN","SDWLI",141,0)
 .D:SDWLCLPT  ; SD*5.3*446
"RTN","SDWLI",142,0)
 ..W !,"Clinic changed from: ",$$GET1^DIQ(409.3,SDWLCLPT,8)
"RTN","SDWLI",143,0)
 ..W:SDWLIN'=$$GET1^DIQ(409.3,SDWLCLPT,2,"I") " (",$$GET1^DIQ(409.3,SDWLCLPT,2),")"
"RTN","SDWLI",144,0)
 ..Q
"RTN","SDWLI",145,0)
 .; Inter-facility Transfer. SD*5.3*446
"RTN","SDWLI",146,0)
 .I $$GETTRN^SDWLIFT1(SDWLDA,.SDWLINNM,.SDWLSTN) D ENS^%ZISS W !,IOINHI,"In transfer to ",SDWLINNM," (",SDWLSTN,")",IOINORM D KILL^%ZISS
"RTN","SDWLI",147,0)
 .D GETS^DIQ(409.3,SDWLDA,"32;33;34;36;38;39","TMP")
"RTN","SDWLI",148,0)
 .K SDWLIN,SDWLCL,SDWLTY,SDWLPRI,SDWLDUZ,SDWLPRV,SDWLDT,SDWLDTD,SDWLDIS,SDWLDIDT,SDWLTYN,SDWLCOM,SDWLPROV,SDWLDISX,DIR,DIE,DR,SDWLINNM,SDWLSTN
"RTN","SDWLI",149,0)
 .W !,"*****",! K DIR S DIR(0)="E" D ^DIR  D
"RTN","SDWLI",150,0)
 ..I X["^" S DUOUT=1 Q
"RTN","SDWLI",151,0)
 ..I 'Y S DUOUT=1 Q
"RTN","SDWLI",152,0)
 ..;I '$G(SDWLLIST) D HD
"RTN","SDWLI",153,0)
 Q
"RTN","SDWLI",154,0)
HD ;Header
"RTN","SDWLI",155,0)
 W:$D(IOF) @IOF W !!,?80-$L("Wait List - Inquiry")\2,"Wait List - Inquiry ",!
"RTN","SDWLI",156,0)
 ;SD*5.3*327 - Correct undefined.
"RTN","SDWLI",157,0)
 I '$D(SDWLDFN) W !! Q 
"RTN","SDWLI",158,0)
 N DFN S DFN=SDWLDFN D DEM^VADPT
"RTN","SDWLI",159,0)
 W:$D(VADM) !,VADM(1),?40 I $D(VA("PID")) W VA("PID")
"RTN","SDWLI",160,0)
 W !!
"RTN","SDWLI",161,0)
 K DUOUT
"RTN","SDWLI",162,0)
 Q
"RTN","SDWLI",163,0)
END ;
"RTN","SDWLI",164,0)
 K DIR,DIC,DR,DIE,SDWLDFN,DUOUT
"RTN","SDWLI",165,0)
 K SDNOK,SDWLBDT,SDWLCL,SDWLCN,SDWLCNT,SDWLCOM,SDWLCT,SDWLDA,SDWLDATA,SDWLDDT,SDWLDDUZ,SDWLDFN,SDWLDIDT,SDWLDIS,SDWLDISX
"RTN","SDWLI",166,0)
 K SDWLDRG,SDWLDT,SDWLDTD,SDWLDTP,SDWLDUZ,SDLWEDT,SDWLIN,SDLWP,SDWLPRI,SDWLPROV,SDLWPRV,SDWLSC,SDWLSP,SDWLSS,SDLWST,SDWLTY
"RTN","SDWLI",167,0)
 K SDWLTYN,SDSWLTYP,SDLWX,SDWLY,SDWRB,SDWLBDT,SDWLDISC,SDWLERR,SDWLPRON,SDXSCAT,SDWLP,SDWLTYP
"RTN","SDWLI",168,0)
 K SDREMD,SDREMDD,SDREMR,SDREMRC,SDREMU,MM,SDWLEDT,SDWLLIST,SDWLST,SDWLX,VA,X,Y,YY
"RTN","SDWLI",169,0)
 Q
"RTN","SDWLRSR")
0^6^B53084626^B42863280
"RTN","SDWLRSR",1,0)
SDWLRSR ;BPOI/TEH - WAIT LIST STAT REPORT;10/01/02 ; 4/1/08 12:52pm
"RTN","SDWLRSR",2,0)
 ;;5.3;scheduling;**263,273,399,412,425,415,446,524,505**;08/13/93;Build 20
"RTN","SDWLRSR",3,0)
 ;
"RTN","SDWLRSR",4,0)
 ; Removed Sort logic as routine exceeded SACC maximum size of 10000
"RTN","SDWLRSR",5,0)
 ; New routine SDWLRSRS was created to perform the Sort functionality
"RTN","SDWLRSR",6,0)
 ;
"RTN","SDWLRSR",7,0)
 ;
"RTN","SDWLRSR",8,0)
EN ;
"RTN","SDWLRSR",9,0)
 N DIR,DUOUT,SDWL,SDWLCL,SDWLCT2,SDWLD,SDWLDATE,SDWLDTP
"RTN","SDWLRSR",10,0)
 N SDWLEXCL,SDWLFG,SDWLFLG,SDWLINS,SDWLPG,SDWLPRI,SDWLSPT,SDWLTY
"RTN","SDWLRSR",11,0)
 N X,Y,SDFLG,SDI
"RTN","SDWLRSR",12,0)
 D INIT G END:$D(DUOUT)  ;SD*5.3*415
"RTN","SDWLRSR",13,0)
 D SORT^SDWLRSRS(SDWLBD,SDWLED,SDWLINS,.SDWL)  ; SD*5.3*415 new routine to perform sort
"RTN","SDWLRSR",14,0)
 D:'$$S^%ZTLOAD PRT  ;SD*5.3*415
"RTN","SDWLRSR",15,0)
 G END
"RTN","SDWLRSR",16,0)
INIT ;
"RTN","SDWLRSR",17,0)
 I $D(CT) S SDWLCT2=CT
"RTN","SDWLRSR",18,0)
 I $D(DATE) S SDWLDATE=DATE
"RTN","SDWLRSR",19,0)
 I $D(INS) S SDWLINS=INS
"RTN","SDWLRSR",20,0)
 I $D(EXCL) S SDWLEXCL=EXCL
"RTN","SDWLRSR",21,0)
 I $D(ZTSAVE) D
"RTN","SDWLRSR",22,0)
 .S SDWLCT=$G(ZTSAVE("CT")),SDWLDATE=$G(ZTSAVE("DATE")),SDWLINS=$G(ZTSAVE("INS")),SDWLEXCL=$G(ZTSAVE("EXCL"))
"RTN","SDWLRSR",23,0)
 I SDWLINS'="ALL" F I=1:1 S SDWL=$P(SDWLINS,";",I) Q:SDWL=""  S SDWL("INS",+SDWL)=""
"RTN","SDWLRSR",24,0)
 S SDWLBD=$P(SDWLDATE,U,1),SDWLED=$P(SDWLDATE,U,2),SDWLPG=0
"RTN","SDWLRSR",25,0)
 D NOW^%DTC S Y=% D DD^%DT S SDWLDTP=Y
"RTN","SDWLRSR",26,0)
 N POP S POP=0  ;SD*5.3*412
"RTN","SDWLRSR",27,0)
 Q
"RTN","SDWLRSR",28,0)
PRT ;PRINT REPORT
"RTN","SDWLRSR",29,0)
 S (GT1,GT2,GT3,GT4,GT5,GT6,GT7,GT8,GT9,GT10,GT11,GT12)=0
"RTN","SDWLRSR",30,0)
 S (TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11,TT12,SDWLPG)=0 D HD,HD1 ;SD*5.3*415
"RTN","SDWLRSR",31,0)
 I '$D(^TMP("SDWLRSR1")) W !!,"No Wait List Data to Report" Q
"RTN","SDWLRSR",32,0)
 S SDWLINS="" F  S SDWLINS=$O(^TMP("SDWLRSR1",$J,SDWLINS)) Q:SDWLINS=""  D  Q:POP  D T2  Q:POP  W !,"________________" I $Y>(IOSL-5) D:$D(SDWLSPT) SCR Q:POP  D HD,HD1  ;SD*5.3*412 added Quit for early exit
"RTN","SDWLRSR",33,0)
 .I $$S^%ZTLOAD S DUOUT="" Q
"RTN","SDWLRSR",34,0)
 .W !!,"INSTITUTION: ",SDWLINS,! K ^XTMP("SDWLRSR")
"RTN","SDWLRSR",35,0)
 .S ^XTMP("SDWLRSR",0)=DT_U_DT
"RTN","SDWLRSR",36,0)
 .S SDWLTY="" F  S SDWLTY=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY)) Q:SDWLTY=""  D  Q:POP  ;SD*5.3*412 added Quit for early exit
"RTN","SDWLRSR",37,0)
 ..S SDWLTNM=$$EXTERNAL^DILFD(409.3,4,,SDWLTY)
"RTN","SDWLRSR",38,0)
 ..S SDWLSCN="" F  S SDWLSCN=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN)) Q:SDWLSCN=""  D  Q:POP  D T1  ;SD*5.3*412 added Quit for early exit
"RTN","SDWLRSR",39,0)
 ...S (T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11,T12)=0 ;SD*5.3*415
"RTN","SDWLRSR",40,0)
 ...S SDWLSCNM="" F  S SDWLSCNM=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM)) Q:SDWLSCNM=""  D  Q:POP  ;SD*5.3*412 added Quit
"RTN","SDWLRSR",41,0)
  ....S SDWLPRI="",SDWLFLG=0 F  S SDWLPRI=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI)) Q:SDWLPRI=""  D  Q:POP  ;SD*5.3*412 added Quit
"RTN","SDWLRSR",42,0)
  .....S SDWLPR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"PR")) I SDWLEXCL,SDWLPR S SDWLFLG=1
"RTN","SDWLRSR",43,0)
 .....S SDWLCL=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"CL")) I 'SDWLFLG,SDWLEXCL,SDWLCL S SDWLFLG=1
"RTN","SDWLRSR",44,0)
 .....S SDWLD=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLD")) I 'SDWLFLG,SDWLEXCL,SDWLD S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",45,0)
 .....S SDWLNC=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLNC")) I 'SDWLFLG,SDWLEXCL,SDWLNC S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",46,0)
 .....S SDWLSA=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLSA")) I 'SDWLFLG,SDWLEXCL,SDWLSA S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",47,0)
 .....S SDWLCC=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLCC")) I 'SDWLFLG,SDWLEXCL,SDWLCC S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",48,0)
 .....S SDWLNN=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLNN")) I 'SDWLFLG,SDWLEXCL,SDWLNN S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",49,0)
 .....S SDWLER=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLER")) I 'SDWLFLG,SDWLEXCL,SDWLER S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",50,0)
 .....S SDWLTR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLTR"))  I 'SDWLFLG,SDWLEXCL,SDWLTR S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",51,0)
 .....S SDWLAD=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"AD")) I 'SDWLFLG,SDWLEXCL,SDWLAD S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",52,0)
 .....S SDWLRR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"RR")) I 'SDWLFLG,SDWLEXCL,SDWLRR S SDWLFLG=1 ;SD*5.3*415
"RTN","SDWLRSR",53,0)
 .....S SDWLNR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"NR")) I 'SDWLFLG,SDWLEXCL,SDWLNR S SDWLFLG=1
"RTN","SDWLRSR",54,0)
 .....K SDFLG F SDI="SDWLPR","SDWLCL","SDWLD","SDWLNC","SDWLSA","SDWLCC","SDWLNN","SDWLER","SDWLTR","SDWLAD","SDWLRR","SDWLNR" D
"RTN","SDWLRSR",55,0)
 ......I @SDI S SDFLG=1
"RTN","SDWLRSR",56,0)
 .....I 'SDWLEXCL,'SDWLFLG S SDWLFLG=1
"RTN","SDWLRSR",57,0)
 .....I SDWLEXCL,'SDWLFLG Q
"RTN","SDWLRSR",58,0)
 .....I SDWLEXCL,'$D(SDFLG) Q
"RTN","SDWLRSR",59,0)
 .....I '$D(^XTMP("SDWLRSR",$J,SDWLTNM)) W !,$E(SDWLTNM,1,15) S ^XTMP("SDWLRSR",$J,SDWLTNM)=""
"RTN","SDWLRSR",60,0)
 .....W !?2,$E(SDWLSCNM_" "_$S(SDWLPRI="A":"ASAP",SDWLPRI="F":"FUTURE",1:""),1,17)
"RTN","SDWLRSR",61,0)
 .....S T1=T1+SDWLPR,TT1=TT1+SDWLPR W ?21,$J(SDWLPR,3)
"RTN","SDWLRSR",62,0)
 .....S GT1=GT1+SDWLPR
"RTN","SDWLRSR",63,0)
 .....S T2=T2+SDWLCL,TT2=TT2+SDWLCL W ?26,$J(SDWLCL,3)
"RTN","SDWLRSR",64,0)
 .....S GT2=GT2+SDWLCL
"RTN","SDWLRSR",65,0)
 .....S T3=T3+SDWLD,TT3=TT3+SDWLD W ?31,$J(SDWLD,3)
"RTN","SDWLRSR",66,0)
 .....S GT3=GT3+SDWLD
"RTN","SDWLRSR",67,0)
 .....S T4=T4+SDWLNC,TT4=TT4+SDWLNC W ?36,$J(SDWLNC,3)
"RTN","SDWLRSR",68,0)
 .....S GT4=GT4+SDWLNC
"RTN","SDWLRSR",69,0)
 .....S T5=T5+SDWLSA,TT5=TT5+SDWLSA W ?41,$J(SDWLSA,3)
"RTN","SDWLRSR",70,0)
 .....S GT5=GT5+SDWLSA
"RTN","SDWLRSR",71,0)
 .....S T6=T6+SDWLCC,TT6=TT6+SDWLCC W ?46,$J(SDWLCC,3)
"RTN","SDWLRSR",72,0)
 .....S GT6=GT6+SDWLCC
"RTN","SDWLRSR",73,0)
 .....S T7=T7+SDWLNN,TT7=TT7+SDWLNN W ?51,$J(SDWLNN,3)
"RTN","SDWLRSR",74,0)
 .....S GT7=GT7+SDWLNN
"RTN","SDWLRSR",75,0)
 .....S T8=T8+SDWLER,TT8=TT8+SDWLER W ?56,$J(SDWLER,3)
"RTN","SDWLRSR",76,0)
 .....S GT8=GT8+SDWLER
"RTN","SDWLRSR",77,0)
 .....S T9=T9+SDWLTR,TT9=TT9+SDWLTR W ?61,$J(SDWLTR,3) ;SD*5.3*415
"RTN","SDWLRSR",78,0)
 .....S GT9=GT9+SDWLTR
"RTN","SDWLRSR",79,0)
 .....S T10=T10+SDWLAD,TT10=TT10+SDWLAD W ?66,$J(SDWLAD,3) ;SD*5.3*415
"RTN","SDWLRSR",80,0)
 .....S GT10=GT10+SDWLAD
"RTN","SDWLRSR",81,0)
 .....S T11=T11+SDWLRR,TT11=TT11+SDWLRR W ?71,$J(SDWLRR,3) ;SD*5.3*415
"RTN","SDWLRSR",82,0)
 .....S GT11=GT11+SDWLRR
"RTN","SDWLRSR",83,0)
 .....S T12=T12+SDWLNR,TT12=TT12+SDWLNR W ?76,$J(SDWLNR,3) ;SD*5.3*415
"RTN","SDWLRSR",84,0)
 .....S GT12=GT12+SDWLNR
"RTN","SDWLRSR",85,0)
 .....I $Y>(IOSL-5) D:$D(SDWLSPT) SCR Q:POP  D HD,HD1  ;SD*5.3*412
"RTN","SDWLRSR",86,0)
 D GT
"RTN","SDWLRSR",87,0)
 Q
"RTN","SDWLRSR",88,0)
SCR S DIR(0)="E" D ^DIR S:X="^" POP=1  ;SD*5.3*412
"RTN","SDWLRSR",89,0)
 Q
"RTN","SDWLRSR",90,0)
T1 ;
"RTN","SDWLRSR",91,0)
 I 'SDWLFLG,SDWLEXCL Q
"RTN","SDWLRSR",92,0)
 W !?20,"---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----"  ;SD*5.3*415
"RTN","SDWLRSR",93,0)
 W !,"Sub-Totals:"
"RTN","SDWLRSR",94,0)
 ;write sub-totals
"RTN","SDWLRSR",95,0)
  W ?21,$J(T1,3),?26,$J(T2,3),?31,$J(T3,3),?36,$J(T4,3),?41,$J(T5,3),?46,$J(T6,3),?51,$J(T7,3),?56,$J(T8,3),?61,$J(T9,3),?66,$J(T10,3),?71,$J(T11,3),?76,$J(T12,3),!  ;SD*5.3*415
"RTN","SDWLRSR",96,0)
 S (T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11,T12)=0  ;SD*5.3*415
"RTN","SDWLRSR",97,0)
 I $Y>(IOSL-5) D:$D(SDWLSPT) SCR Q:POP  D HD,HD1  ;SD*5.3*412
"RTN","SDWLRSR",98,0)
 Q
"RTN","SDWLRSR",99,0)
T2 W !,"Institution Totals:"
"RTN","SDWLRSR",100,0)
 W ?21,$J(TT1,3),?26,$J(TT2,3),?31,$J(TT3,3),?36,$J(TT4,3),?41,$J(TT5,3),?46,$J(TT6,3),?51,$J(TT7,3),?56,$J(TT8,3),?61,$J(TT9,3),?66,$J(TT10,3),?71,$J(TT11,3),?76,$J(TT12,3),!  ;SD*5.3*415
"RTN","SDWLRSR",101,0)
 S (TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11,TT12)=0  ;SD*5.3*415
"RTN","SDWLRSR",102,0)
 I $Y>(IOSL-5) D:$D(SDWLSPT) SCR Q:POP  D HD,HD1  ;SD*5.3*412
"RTN","SDWLRSR",103,0)
 Q
"RTN","SDWLRSR",104,0)
GT ;Grand totals
"RTN","SDWLRSR",105,0)
 W !!,"Grand Totals:"
"RTN","SDWLRSR",106,0)
 W ?21,$J(GT1,3),?26,$J(GT2,3),?31,$J(GT3,3),?36,$J(GT4,3),?41,$J(GT5,3),?46,$J(GT6,3),?51,$J(GT7,3),?56,$J(GT8,3),?61,$J(GT9,3),?66,$J(GT10,3),?71,$J(GT11,3),?76,$J(GT12,3),!
"RTN","SDWLRSR",107,0)
 Q
"RTN","SDWLRSR",108,0)
HD W:$D(IOF) @IOF S SDWLPG=SDWLPG+1 W !!,SDWLDTP,?80-$L("Wait List (Sch/PCMM) Stat Report")\2,"Wait List (Sch/PCMM) Stat Report",?65,"Page: ",SDWLPG
"RTN","SDWLRSR",109,0)
 W !,?80-$L("STARTED Date: ")\2,"STARTED Date: " S Y=$P(SDWLDATE,U,1) D DD^%DT W Y
"RTN","SDWLRSR",110,0)
 W !,?80-$L("FINISHED Date: ")\2,"FINISHED Date: " S Y=$P(SDWLDATE,U,2) D DD^%DT W Y
"RTN","SDWLRSR",111,0)
 Q
"RTN","SDWLRSR",112,0)
HD1 ;
"RTN","SDWLRSR",113,0)
 W !,?20,"PREV"
"RTN","SDWLRSR",114,0)
 W ?65,"#"
"RTN","SDWLRSR",115,0)
 W ?75,"# NOT"
"RTN","SDWLRSR",116,0)
 W !,"WAIT LIST TYPE"
"RTN","SDWLRSR",117,0)
 W ?20,"REMN",?25,"CLSD",?31,"DTH",?37,"NC",?42,"SA",?47,"CC",?52,"NN",?57,"ER",?61,"TR",?65,"ADD",?70,"REMN",?75,"REMVD",!  ;SD*5.3*415
"RTN","SDWLRSR",118,0)
 Q
"RTN","SDWLRSR",119,0)
END D EN^SDWLKIL
"RTN","SDWLRSR",120,0)
 K ^TMP("SDWLRSR1",$J),^TMP("SDWLRSR2",$J),SDWLY1,SDWLX1,SDWLRDT,CT,I
"RTN","SDWLRSR",121,0)
 K T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11,T12,SDWLAD,SDWLBD,SDWLCC,SDWLCT,SDWLDFDT,SDWLDP,SDWLED,SDWLER,SDWLERR,SDWLFLD,X1,X2,DATE  ;SD*5.3*415
"RTN","SDWLRSR",122,0)
 K TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11,TT12,SDWLINSN,SDWLINST,SDWLNC,SDWLNN,SDWLNR,SDWLOFDT,SDWLOK1,SDWLOK2,SDWLTYPN  ;SD*5.3*415
"RTN","SDWLRSR",123,0)
 K SDWLOK3,SDWLPR,SDWLPR,SDWLPROM,SDWLRE,SDWLRFDT,SDWLRR,SDWLSA,SDWLSCN,SDWLSCNM,SDWLTASK,SDWLTK,SDWLTNM,SDWLTYNM,SDWLTYP,X4,SDWLTR  ;SD*5.3*415
"RTN","SDWLRSR",124,0)
 K GT1,GT2,GT3,GT4,GT5,GT6,GT7,GT8,GT9,GT10,GT11,GT12  ;SD*5.3*505
"RTN","SDWLRSR",125,0)
 K ZTSAVE,^XTMP("SDWLRSR"),INS,EXCL
"RTN","SDWLRSR",126,0)
 Q
"VER")
8.0^22.0
**END**
**END**
