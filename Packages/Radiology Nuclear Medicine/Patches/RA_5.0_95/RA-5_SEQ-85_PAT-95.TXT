$TXT Created by MO,SELINA at DEV.DEV.FO-HINES.MED.VA.GOV  (KIDS) on Monday, 01/26/09 at 12:51
=============================================================================
Run Date: JUL 02, 2009                     Designation: RA*5*95
Package : RA - RADIOLOGY/NUCLEAR MEDICINE     Priority: Mandatory
Version : 5        SEQ #85                      Status: Released
                  Compliance Date: AUG 02, 2009
=============================================================================

Associated patches: (v)RA*5*56     <<= must be installed BEFORE `RA*5*95'
                    (v)RA*5*71     <<= must be installed BEFORE `RA*5*95'
                    (v)RA*5*84     <<= must be installed BEFORE `RA*5*95'

Subject: Corrections to Outside Reporting Phase 1

Category: 
  - Routine
  - Data Dictionary

Description:
============

 This patch will be used to correct problems from enhancements made for 
 Outside Reporting - Phase 1.
  
 This patch addresses the following Remedy Ticket(s):
 ----------------------------------------------------
  266728
  269462
  269950 (same as 266728)
  271816 (similar to 269462)
  270261
  270393
  273325 
  290205 (same as 266728 and 269950)
  290250 
  
 Overview of Remedy Ticket(s):
 -----------------------------
 TICKETS:  #266728, #269950
  
   Problem:  The Report Text, Impression, and Diagnostic Codes are 
                not displayed on the CPRS screen for non-Radiology
                users (users without any RAD/NUC MED CLASSIFICATION.)
  
   Resolution:  Modify routine RAO7PC3 to include Report text, Impression, 
                and Diagnostic code in the output ^TMP($J...) nodes for
                reports with Electronically Filed status, regardless of
                RAD/NUC MED CLASSIFICATION.
  
 TICKET:  #270393
  
   Problem:  The following warning message from the 'Outside Report 
                Entry/Edit' [RA OUTSIDE RPTENTRY] option should not be
                displayed as some sites use Regular Credit locations for
                outside reports:
  
               "This option is for Outside work (imaged and read), so the 
                case should be 'No Credit', but this case has a credit
                method of 'Regular Credit'"
  
   Resolution:  Modify routine RARTE5 to omit the warning message.
  
  
 TICKETS:  #269462, #271816, #290205
  
   Problems:  (1) PACS are not receiving the "ORU^R01" HL7 messages when a
                  report is electronically filed.
  
              (2) The 'Resend Radiology HL7 Message' [RA  HL7 MESSAGE 
                  RESEND] and 'Resend Radiology HL7 Messages By Date
                  Range' [RA HL7 RESEND BY DATE RANGE] options do not
                  include electronically filed reports.
  
              (3) When an image is made before the 'Outside Report 
                  Entry/Edit' [RA OUTSIDE RPTENTRY] option is used, the
                  option will not allow the user to enter the outside
                  report.
  
   Resolution:  Modify routine RARTE5 for problems (1) and (3).  Modify 
                routines RAHLRS and RAHLRS1 for problem (2).
  
 TICKET:  #270261
  
   Problem:  'On-line Verifying of Reports' [RA RPTONLINEVERIFY] option is 
                including deleted reports in the verifier's queue.
  
   Resolution:  Modify routine RARTVER to omit deleted reports.  Modify 
                routine RARTRPV which has the same problem in the 'Resident
                On-Line Pre- Verification' [RA RESIDENT PRE-VERIFY] option
                though there is no ticket filed for this option.
  
                Make post install routine RA95PST to clean up left-over 
                cross references, associated with staff and residents, from
                deleted reports.
  
 TICKET:  #273325
  
   Problem:  'Outside Report Entry/Edit' option allowed entry of one case 
              from a printset, if the previous entry was for a standalone
              case and the user didn't exit the option. This resulted in
              printset cases having separate reports instead of sharing
              one report.  Also, the display of case information in the
              beginning of this option included another case that is un-
              related to the selected case, if the previous entry was for
              a case from a printset.
  
   Resolution:  Modify routine RARTE6 to reset variable RAPRTSET each time
                a case is selected.  Also, modify routine RARTE5 to process
                printsets so that all cases of the printset would point to
                the same report and all diagnostic codes from the selected
                case would be copied to the other cases of the printset.
  
 TICKET:  #290250
  
   Problem:  'Outside Report Entry/Edit' option didn't allow "^" out when
 the outside report was being entered the first time for the wrong case.
  
   Resolution:  Modify routine RARTE5 to allow "^" out of this option when 
 neither the REPORT TEXT nor IMPRESSION TEXT have data, but only when the 
 report is being entered the first time.  At all other times, when an 
 outside report is being edited, the "^" isn't allowed if previously 
 entered REPORT TEXT and IMPRESSION TEXT are deleted.  Edited outside 
 reports must have one or both REPORT TEXT and IMPRESSION TEXT.
  
  
 Components Sent With Patch
 --------------------------
  
 The following is the file and field included in this patch:
  
                                       UP    SEND  DATA                USER
                                       DATE  SEC.  COMES   SITE  RSLV  OVER
 FILE #      FILE NAME                 DD    CODE  W/FILE  DATA  PTRS  RIDE
 --------------------------------------------------------------------------
  
 74          RAD/NUC MED REPORTS       YES   NO    NO                  NO
 Partial DD: subDD: 74         fld: 5
  
 Changed components: "ARES" and "ASTF" cross references
                   
 FILE #   FIELD    FIELD NAME           MODIFIED
  74        5      REPORT STATUS        "ARES" cross reference's Set logic:
                                        Do not set this xref for Verified
                                        (V) and Deleted (X) reports.
  
  74        5      REPORT STATUS        "ASTF" cross reference's Set logic:
                                        Do not set this xref for Verified
                                        (V) and Deleted (X) reports. 
  
 Routines modified
 -----------------
  
 Routine RA95PST is made to clean up left-over "ASTF" and "ARES" cross 
   references from deleted reports.  The previous patch RA*5*56's new
   design of keeping deleted reports in the database did not remove these
   cross references.
  
  
 Routine RAHLRS is modified to include electronically filed reports in the 
   'Resend Radiology HL7 Message' [RA HL7 MESSAGE RESEND] option, but only 
   for non-Voice Recognition applications.
  
  
 Routine RAHLRS1 is modified to include electronically filed reports in 
   the 'Resend Radiology HL7 Messages By Date Range' RA HL7 RESEND BY DATE 
   RANGE] option, but only for non-Voice Recognition applications.
  
  
 Routine RAO7PC2 is modified to output the content of REPORT TEXT, 
   IMPRESSION TEXT, PRIMARY DIAGNOSTIC CODE and any SECONDARY DIAGNOSTIC 
   CODE in the ^TMP($J,"RAE2"...) nodes for reports with "Electronically 
   File" status, regardless of the user's RAD/NUC MED CLASSIFICATION.
  
   Previously, if the user doesn't have RAD/NUC MED CLASSIFICATION, then
   this routine outputs the above items only for "Verified" and "Release
   /Not Verified" reports.
  
  
 Routine RAO7PC3 is modified to output the content of REPORT TEXT, 
   IMPRESSION TEXT, PRIMARY DIAGNOSTIC CODE and any SECONDARY DIAGNOSTIC 
   CODE in the ^TMP($J,"RAE3"...) nodes for reports with "Electronically  
   Filed" status, regardless of the user's RAD/NUC MED CLASSIFICATION.
  
   Previously, if the user doesn't have RAD/NUC MED CLASSIFICATION, then
   this routine outputs the above items only for "Verified" and
   "Release/Not Verified" reports.  This routine is used by CPRS to show
   the content of a patient's report from the RAD/NUC MED REPORTS file
   (#74).
  
  
 Routine RARTE5 is modified to remove a warning message from the 'Outside 
   Report Entry/Edit' [RA OUTSIDE RPTENTRY] option.  Previously, when the 
   case has partial or regular credit method, a warning message is
   displayed.
  
   Another modification is made to correct a misspelled word, 
   "Electronicaly", to "Electronically".
  
   Another modification is made to allow entry of an outside report via 
   the 'Outside Report Entry/Edit' [RA OUTSIDE RPTENTRY] option after an 
   image has been taken.  Previously, the stub report (which links the
   image to the case when no interpreted report has been entered) prevents
   this option from being used.
  
   Another modification is made to send an "ORU^R01" HL7 message to non-VR 
   applications when a report has been assigned the "Electronically Filed" 
   report status the first time, or when that report's diagnostic code(s) 
   have been changed/added/deleted.
  
   Another modification is made to process printsets, so that all cases 
   from the printset would point to the same report, all diagnostic codes
   from the selected case would be copied to the other cases of the 
   printset.  Also add the following to the introductory reminder:
  
        |  For a printset, the canned text must apply to all     |
        |  cases within the printset.                            |
  
   Another modification is made to allow "^" exit from a first time entry 
 of a new outside report, when both the REPORT TEXT and IMPRESSION TEXT 
 aren't entered.  The first time entered partial report will be
 automatically deleted.  Any diagnostic codes entered via that first entry
 will also be automatically deleted.
  
  
 Routine RARTE6 is modified to clarify comments and correct minor coding 
 errors.  The minor errors are: (1) The Activity Log's BEFORE DELETION 
 REPORT STATUS field should only have data when a report is being deleted, 
 not when it is being restored from deleted report status.  (2) The BEFORE 
 DELETION REPORT STATUS field can only have alphabetic, not numeric data.
 Also, the variable RAPRTSET is reset every time a different case is 
 selected, so a case that belongs to a printset would not be mistaken for 
 a standalone case and vice versa.
  
 Routine RARTE7 is modified to new some variables and move the setting of 
 variable RAF1 earlier.  Those variables need to be newed so that they 
 will be cleared from the system table after processing.  The setting of 
 RAF1 is moved earlier to avoid loss/change of its dependent variable X.
  
  
 Routine RARTRPV is modified to exclude deleted reports from the 
   resident's to-verify queue.
  
  
 Routine RARTVER is modified to exclude deleted reports from the staff 
   radiologist's to-verify queue.
  
  
 Summary of options affected by changed routines
 -----------------------------------------------
  
 Option Name                   Option's Menu Text
 ---------------------------   -------------------------------------------
 RA DELETERPT                  Delete a Report
 RA HL7 MESSAGE RESEND         Resend Radiology HL7 Message
 RA HL7 RESEND BY DATE RANGE   Resend Radiology HL7 Messages By Date Range
 RA OUTSIDE RPTENTRY           Outside Report Entry/Edit
 RA RESIDENT PRE-VERIFY        Resident On-Line Pre-Verification
 RA RESTORE REPORT             Restore a Deleted Report
 RA RPTONLINEVERIFY            On-line Verifying of Reports
  
  
 Documentation Retrieval
 -----------------------
  
 Updated documentation describing the functionality introduced by this 
 patch is available in the [ANONYMOUS.SOFTWARE] directories at the 
 following Internet addresses:
  
 Preferred or Specific Server     Internet address
 ----------------------------     -------------------------
 First available ftp server       download.vista.med.va.gov  <-- preferred
 Albany                           ftp.fo-albany.med.va.gov
 Hines                            ftp.fo-hines.med.va.gov
 Salt Lake City                   ftp.fo-slc.med.va.gov
  
 Below is a list of the documentation files related to this patch and 
 available via the FTP sites listed above.
  
 Document File Description          File Name            FTP Mode
 -------------------------------    -------------        --------------
 Radiology User Manual              RA5_0UM.PDF             binary
  
  
 After this patch is released, the updated manuals may also be retrieved 
 from the Internet at http://www.va.gov/vdl
  
  
 Test Sites
 ----------
    1. Charleston, SC
    2. San Francisco, CA
    3. Atlanta, GA
    4. Martinez, CA
    5. Louisville, KY
    6. Central Plains, IA  
  
 INSTALLATION INSTRUCTIONS
 =========================
  
 The install time for this patch should take less than 5 minutes. Because 
 this patch affects exam status calculation, all Radiology users must be 
 off the system during the installation.
  
  NOTE:  MailMan and Kernel patches must be current on the target system to
         avoid problems loading and installing this patch.
   
  
  1. Use the 'INSTALL/CHECK MESSAGE' option of your PackMan menu to load
     the KIDS distribution onto your system.
   
  2. On the 'Kernel Installation & Distribution System' Menu (KIDS), select
     the 'Installation' menu.
   
     From this menu you may choose the following options prior to
     installing this patch:
  
     - Backup a Transport Global - this option creates a backup message 
 of any routines exported with the patch. It does NOT backup any other 
 changes, such as data dictionaries or templates.
  
     - Compare Transport Global to Current System - this option allows 
 you to view all changes that are made when the patch is installed. It 
 compares all components of the patch (routines, DDs, templates, etc.).
   
     -  Verify Checksums in Transport Global - this option allows you to 
 ensure the integrity of the routine that is in the transport global.
   
  3. Use the 'Install Package(s)' option under the 'Installation' menu.
  
         When prompted for INSTALL NAME, enter: RA*5.0*95.
    
         When prompted "Want KIDS to INHIBIT LOGONs during the install?
         NO//", respond NO.
   
         When prompted "Want to DISABLE Scheduled Options, Menu Options, 
         and Protocols? YES//", respond YES.
  
         When prompted "Enter options you wish to mark as 'Out of Order':",
         enter the following:
      
           RA*
   
         When prompted "Enter protocols you wish to mark as 'Out of 
         Order':", enter the following:
  
                    RA*
  
  4. Verify that the installation of the patch completed correctly by 
 using the
        KIDS 'Utilities...' [XPD UTILITY] option 'Install File Print' [XPD
        PRINT INSTALL FILE] and selecting this patch (RA*5.0*95).

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.0;Radiology/Nuclear Medicine;**[Patch List]**;Mar 16, 1998;Build 7

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: RA95PST
    Before:       n/a   After:  B2926756  **95**
Routine Name: RAHLRS
    Before: B11498651   After: B12807617  **25,54,60,71,82,95**
Routine Name: RAHLRS1
    Before: B57554802   After: B61692156  **80,84,95**
Routine Name: RAO7PC2
    Before: B44753476   After: B45083529  **1,11,14,16,22,27,45,75,56,95**
Routine Name: RAO7PC3
    Before: B41860849   After: B42089217  **16,26,27,56,95**
Routine Name: RARTE5
    Before: B66404814   After: B93390991  **56,95**
Routine Name: RARTE6
    Before:B106132730   After:B105675673  **56,95**
Routine Name: RARTE7
    Before: B23239189   After: B23668703  **56,95**
Routine Name: RARTRPV
    Before: B30787953   After: B30791192  **26,56,95**
Routine Name: RARTVER
    Before: B44139865   After: B44145725  **8,23,26,82,56,95**
 
Routine list of preceding patches: 56, 84

=============================================================================
User Information:
Entered By  : MO,SELINA                     Date Entered  : AUG 14, 2008
Completed By: KEHOE,THOMAS C                Date Completed: APR 08, 2009
Released By : COWNIE,KEVIN                  Date Released : JUL 02, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
