
=============================================================================
Run Date: DEC 18, 2019                     Designation: PSB*3*122
Package : PSB - BAR CODE MED ADMIN            Priority: Mandatory
Version : 3       SEQ #102                      Status: Released
                  Compliance Date: JAN 20, 2020
=============================================================================

Associated patches: (v)PSB*3*102   <<= must be installed BEFORE `PSB*3*122'

Subject: BCBU USER INITIALIZATION ISSUES

Category: 
  - Routine

Description:
============

 This patch will resolve the following issue.
  
 INC3062938 - BCBU/VISTA
     
 Defect Tracking System Ticket(s) & Overview:
 --------------------------------------------
 INC3062938 - BCBU/VISTA
         
 Problem: 
 --------
 The South Texas Veterans Health Care Medical Center reported two problems
 with the Initialize a Backup Workstation with BCMA Users [PSB BCBU USER INIT]
 option:
   1) Users were not able to access the BCBU workstations with their ACCESS/
      VERIFY codes after the option above was run. Their ACCESS/VERIFY
      codes should match what they use in the main VistA account. Usually,
      a re-run of the option resolves the problem, which is not ideal.
   2) If there are two users with similar names (e.g., 'NURSE,USER' and 
      'NURSE,USER A' existed, the user with the shorter name would not be able
      to access the BCBU workstation, even after the second initialization.
      
 Resolution:
 -----------
 1) The setting of cross-references for the newly created users at the
    initialized BCBU workstation was being executed before their ACCESS/
    VERIFY codes were saved. To resolve the problem the cross-references
    setting was moved to run after the ACCESS/VERIFY codes are saved and it
    will address this problem.
 2) The problem happened because the user lookup for 'NURSE,USER' would
    find more than one match, 'NURSE,USER' and 'NURSE,USER A' which would
    prevent it from being updated. To resolve this problem the lookup call
    to find the user record was changed to perform and EXACT match for the
    user name. This way a lookup for 'NURSE,USER' will not find 'NURSE,USER 
    A' as a possible match.
  
 Technical Resolution:
 ---------------------
 1) Moved the call to IX1^DIK from line FILE+19 to FILE+23 in the ALPBGEN1
    routine, which is past the setting of the ACCESS/VERIFY codes.
 2) Changed the DIC(0)="LM" to DIC(0)="LMX" at line FILE+9 in the ALPBGEN1
    routine, which will force an exact match of the user name.
  
  
 Patient Safety Issues (PSIs):
 -----------------------------
 N/A 
         
 Test Sites:
 -----------
 Denver VA Medical Center
 Wilmington VAMC
  
    
 Documentation Retrieval Instructions:
 ------------------------------------ 
 New install guide for Cache version 2017 for BCBU is available. The 
 documentation will be in the form of Adobe Acrobat files.
  
  Documentation can also be found on the VA Software Documentation 
  Library at:
      http://www4.domain.ext/vdl/
  
  Title               File Name                               FTP Mode
  ---------------------------------------------------------------------
  BCBU Cache Installation Guide
                      BCBU_cache_2017_IG.pdf                  binary
    
  
 Pre-Installation Overview:
 --------------------------
 - This patch requires Fileman v22.2 to be installed before this it can be
   installed. Therefore it is important that the BCBU workstations where the
   this patch will be installed already have been updated with the latest
   version of Fileman (v22.2).
 - If your site uses the BCMA Backup System (BCBU) you should install this
   patch in all the BCBU workstations that are currently active at your site.
  
   
 Patch retrieval Instructions: 
 ----------------------------
 1. Retrieve the KIDS distribution host file. This patch will be
    distributed in a host file. The name of the host file is:
  
         PSB_3_122.KID
     
     Files can be obtained from the ANONYMOUS.SOFTWARE directory at one of
     the OI Field Offices. The preferred method is to retrieve the file
     using Secure File Transfer Protocol (SFTP) from
     DOWNLOAD.VISTA.DOMAIN.EXT, which will transmit the file from the first
     available server. 
  
  
 Installation Instructions:
 -------------------------- 
 The BAR CODE MED ADMIN (BCMA) users should not be using the application
 while this patch is being installed. It should take less than 2 minutes
 to install this patch. 
  
    1. From the Kernel Installation & Distribution System menu, select
       the LOAD DISTRIBUTION option and load PSB_3_122.KID  
   
    2. Start up the Kernel Installation and Distribution System Menu
       [XPD MAIN]:
  
        Edits and Distribution ...
        Utilities ...
        Installation ...  
   
    3. From this menu, you may select to use the following options: 
       (when prompted for INSTALL NAME, enter PSB*3.0*122)
   
         a.  Verify Checksums in Transport Global - This option will allow
             you to ensure the integrity of the routines that are in the
             transport global.
         b.  Print Transport Global - This option will allow you to view
             the components of the KIDS build.
         c.  Compare Transport Global to Current System - This option will
             allow you to view all changes that will be made when this 
             patch is installed.  It compares all components of this patch
             (routines, DD's, templates, etc.).
         d.  Backup a Transport Global - This option will create a backup
             message of any routines exported with this patch. It will not
             backup any other changes such as DD's or templates.
   
    4. Use the Install Package(s) option and select the package 
       PSB*3.0*122.
  
    5. When Prompted "Want KIDS to INHIBIT LOGONs during the install? 
       NO//" respond NO.  
   
    6. When Prompted "Want to DISABLE Scheduled Options, Menu Options, and 
       Protocols? NO//" respond NO.
  
  
 Installation Verification
 -------------------------
 Successful installation can be verified by reviewing the first 2 lines of
 the routines contained in the patch. The second line will contain the patch
 number in the [PATCH LIST] section.
   
 3.0;BAR CODE MED ADMIN;**[PATCH LIST]**;MARCH, 2004
    
 The option Calculate and Show Checksum Values [XTSUMBLD-CHECK] can be run to
 compare the routine checksums to what is documented in the patch description.
  
  
 Post-Installation Overview
 --------------------------
 None. 
  
   
 Back-out Procedures
 -------------------
 Back-out will be done only with the concurrence and participation of
 development team and appropriate VA site/region personnel. The decision to
 back-out or rollback software will be a joint decision between development
 team, VA site/region personnel and other appropriate VA personnel.
  
 Prior to installing an updated KIDS package, the site/region should have
 saved a backup of the routines in a mail message using the Backup a
 Transport Global [XPD BACKUP] menu option (this is done at time of install).
 The message containing the backed up routines can be loaded with the "Xtract
 PackMan" function at the Message Action prompt. The Packman function
 "INSTALL/CHECK MESSAGE" is then used to install the backed up routines onto
 the VistA System. 
  
 No data was modified by this patch installation and, therefore, no 
 rollback strategy is required.
  
 Validation of Back Out Procedure
 ---------------------------------
 The Back Out Procedure can be verified by printing the first 2 lines of
 the PSO Routines contained in this patch using the option First Line
 Routine Print [XU FIRST LINE PRINT]. Once the routines contained in the
 PSB*3.0*122 patch have been rolled back, the first two lines of the
 Routines will no longer contain the designation of patch PSB*3.0*122 in
 the patch list section on line 2.

Routine Information:
====================
The second line of each of these routines now looks like:
;;3.0;BAR CODE MED ADMIN;**[Patch List]**;Mar 2004;Build 3

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: ALPBGEN1
    Before: B23958647   After: B23953842  **8,37,102,122**
 
Routine list of preceding patches: 102

=============================================================================
User Information:
Entered By  :                               Date Entered  : AUG 20, 2019
Completed By:                               Date Completed: DEC 16, 2019
Released By :                               Date Released : DEC 18, 2019
=============================================================================


Packman Mail Message:
=====================

No routines included
