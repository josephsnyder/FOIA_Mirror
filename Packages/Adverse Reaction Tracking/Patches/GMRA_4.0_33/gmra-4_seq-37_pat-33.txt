$TXT Created by CROSSMAN,PAMELA at VMPDEV20.FO-BAYPINES.MED.VA.GOV  (KIDS) on Wednesday, 12/12/07 at 10:30
=============================================================================
Run Date: JUN 10, 2008                     Designation: GMRA*4*33
Package : GMRA - ADVERSE REACTION TRACKING    Priority: Mandatory
Version : 4        SEQ #37                      Status: Released
                  Compliance Date: JUL 11, 2008
=============================================================================

Associated patches: (v)GMRA*4*2    <<= must be installed BEFORE `GMRA*4*33'
                    (v)GMRA*4*7    <<= must be installed BEFORE `GMRA*4*33'
                    (v)GMRA*4*30   <<= must be installed BEFORE `GMRA*4*33'

Subject: PREVENT TEST PATIENTS FROM APPEARING ON REPORTS/ALLERGY MAIL BULLETINS

Category: 
  - Routine
  - Sort Template

Description:
============

 1.  HD000000067403
 The site reported that test patients entered in production are appearing
 on the Adverse Reaction Tracking reports, and are also being included in
 report counts.
  
 This patch will update the Adverse Reaction Tracking reports that 
 display the patient name and/or SSN, and reports that produce counts
 of reaction data so that they all exclude test patients.
  
 **WARNING** -- After installing this patch, if the site is performing
 testing using test patients in their production account, and one of the
 reports addressed by this patch is run, the site's test patient will not
 appear on the report unless the site uses a REAL social security number
 for the test patient.  After this patch is installed, using the five
 leading-zeroes social security number that denotes test patients will
 only show test patients on these reports in the test environment.
  
 2. HD000000085125
 The problem occurs when the user answers "No" to verify an observed/drug 
 adverse reaction when it is first entered.  If the user skips the 
 verification step but then uses the Enter/Edit Patient Reaction Data [GMRA
 PATIENT A/AR EDIT] option and edits the existing observed/drug allergy and
 then verifies it (with or without making changes) an additional
 NOTIFICATION OF OBSERVED DRUG REACTION bulletin is triggered.
  
 This patch will modify the logic in the code so that, if the user 
 re-enters the adverse reaction and then verifies it, a second 
 NOTIFICATION OF OBSERVED DRUG REACTION bulletin will not be triggered.
  
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
 1. HD000000067403
    Test patients appearing on live reports
  
 2. HD000000085125
    Allergies: Inconsistency with mail generated based on option
    used to verify the A/AR
  
 ASSOCIATED NSR:
 ===============
 N/A
  
 PARTICIPATING TEST SITES:
 =========================
 HINES,IL
 FARGO, ND
 EASTERN COLORADO
 MINNEAPOLIS, MN
  
 REMEDY OVERVIEW:
 ================
 1.  HD000000067403 - Test patients appearing on live reports.
  
 Problem
 -------
 The sites have reported that test patients have been appearing on their
 live Adverse Reaction Tracking reports, and in some cases have been
 causing their counts to be incorrect.
  
 Resolution
 ----------
 To resolve this problem, the Adverse Reaction Tracking v4.0 package
 reports will be updated to first determine if the report is being run in a
 test or live environment.  Then it will be determined if the patient about
 to print is a live or test patient.
  
 2.  HD000000085125 - Allergies: Inconsistency with mail generated based  
     on option used to verify the A/AR
  
 Problem
 -------
 Prevent generation of NOTIFICATION OF OBSERVED DRUG REACTION bulletin 
 when an Observed Drug Allergy is marked VERIFIED in the Allergy Package.
  
 An Observed Drug Allergy/Adverse Reaction may not be verified based on 
 the following situations:
  
 1) The allergy is not auto-verified based on the GMR ALLERGY SITE 
 PARAMETERS settings (AUTOVERIFY FOOD/DRUG/OTHER and/or AUTOVERIFY 
 OBSERVED/HISTORICAL) 
 2) The allergy in not verified because the initial user in the Allergy
 Package choose to answer "NO" at the prompt "Would you like to 
 verify this Causative Agent now?" when making the initial allergy entry.
  
 Sites may manually verify these non-verified Observed Drug 
 Allergy/Adverse Reactions using the Allergy Package menu option 
 Enter/Edit Patient Reaction Data [GMRA PATIENT A/AR EDIT].  When this 
 manual verification is done a second NOTIFICATION OF OBSERVED DRUG 
 REACTION bulletin is currently being generated.  The first notification 
 bulletin is generated when the observed drug allergy is originally 
 entered.
  
 Resolution
 ----------
 This patch will prevent the second generation of the notification 
 bulletin during the manual verification process.
  
 TECHNICAL DESCRIPTION:
 ======================
 HD000000067403
  
 The routine GMRAUTL1 will be modified with a new subroutine, PRDTST.  This
 new subroutine will be called by the other print report routines and by
 the GMRA SORT AUTOVERIFIED sort template.  The logic is as follows:
 If the DFN is undefined, do not include the patient on the report.
 If it is determined that this is a test environment, all patients will
 be included on the reports.  If it is a live environment and this is a
 test patient, they will not be included on the report.  And finally, if
 it is a live environment and this is not a test patient, they will be
 included on the report.
  
 HD000000085125
 Modify routine GMRAVFY.  Look for the variable GMRANEW.  This variable is 
 set to 1 if the observed/drug adverse reaction is new, otherwise, it is 
 set to 0.  Before sending the NOTIFICATION OF OBSERVED DRUG REACTION, 
 check this variable.  Trigger the bulletin only if this variable equals 1.
  
  
 INSTALL INSTRUCTIONS:
 =====================
 This patch can be installed at any time.  Users do not need to be off
  the system.  Install time will be less than 5 minutes.
       
   1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu. [Note:
      TEXT PRINT/DISPLAY option in the PackMan menu will display the
      patch text only].
       
   2. From the Kernel Installation and Distribution System (KIDS)
      menu, select the Installation menu.
       
   3. From this menu, you may elect to use the following options:
      (when prompted for INSTALL NAME, enter GMRA*4.0*33)
       
      a.  Backup a Transport Global - this option will create a backup
          message of any routines exported with the patch.  It will
          NOT backup any other changes such as DDs or templates.
      b.  Compare Transport Global to Current System  - this option
          will allow you to view all changes that will be made when
          the patch is installed.  It compares all components of the
          patch (routines, DDs, templates, etc.).
      c.  Verify Checksums in Transport Global - this option will
          allow you to ensure the integrity of the routines that are
          in the transport global.
      d.  Print Transport Global - this option will allow you to view
          the components of the KIDS build.
      
   4. Use the Install Package(s) option and select the package
      GMRA*4.0*33.
       
   5. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
      NO//', respond NO.
       
   6. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
      Protocols? NO//', respond NO. 

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;4.0;Adverse Reaction Tracking;**[Patch List]**;Mar 29, 1996;Build 5

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: GMRACMR4
    Before: B14318721   After: B15341070  **33**
Routine Name: GMRADSP5
    Before: B10334980   After: B11081750  **33**
Routine Name: GMRAEF2
    Before:  B2869081   After:  B3678870  **33**
Routine Name: GMRAFDA3
    Before:  B9992068   After: B10993210  **33**
Routine Name: GMRAPFT
    Before: B14140548   After: B15101716  **7,33**
Routine Name: GMRAPL
    Before: B21098149   After: B22333087  **7,33**
Routine Name: GMRAPNA
    Before: B15125034   After: B16195844  **30,33**
Routine Name: GMRAPST1
    Before: B14511271   After: B15567200  **7,33**
Routine Name: GMRAPST2
    Before: B14334176   After: B15458806  **7,33**
Routine Name: GMRAPST3
    Before: B10608431   After: B11734267  **7,33**
Routine Name: GMRAPST4
    Before: B11243207   After: B12376223  **7,33**
Routine Name: GMRAPST5
    Before:  B5617892   After:  B6673341  **7,33**
Routine Name: GMRAPST6
    Before: B17393312   After: B18273904  **7,33**
Routine Name: GMRAPST7
    Before: B21785559   After: B22870635  **7,33**
Routine Name: GMRAPU
    Before: B11907209   After: B12975618  **33**
Routine Name: GMRAUTL1
    Before:  B5655165   After:  B9299732  **33**
Routine Name: GMRAVFY
    Before:  B7615400   After:  B7995418  **2,33**
 
Routine list of preceding patches: 2, 7, 30

=============================================================================
User Information:
Entered By  : CASTLE,JOHN                   Date Entered  : DEC 28, 2005
Completed By: HULET,LEE ANN                 Date Completed: JUN 05, 2008
Released By : CAMPBELL,THOMAS               Date Released : JUN 10, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
