$TXT Created by FRANCE,VENESSA at DAYT17.FO-BAYPINES.MED.VA.GOV  (KIDS) on Wednesday, 07/25/07 at 14:06
=============================================================================
Run Date: MAY 12, 2008                     Designation: PSO*7*246
Package : PSO - OUTPATIENT PHARMACY           Priority: Mandatory
Version : 7       SEQ #255                      Status: Released
                  Compliance Date: JUN 12, 2008
=============================================================================

Associated patches: (v)PSO*7*201   <<= must be installed BEFORE `PSO*7*246'
                    (v)PSO*7*212   <<= must be installed BEFORE `PSO*7*246'
                    (v)PSO*7*233   <<= must be installed BEFORE `PSO*7*246'

Subject: MODIFY PSO COST TO IGNORE BAD XREFS IN FILE 52

Category: 
  - Routine

Description:
============

 This patch will correct the following issues.
  
 1. Modify PSO COST compilers to ignore bad xrefs in the PRESCRIPTION
    file (#52).
  
 2. An undefined error occurs when a large number of prescriptions are
    edited for one patient and the edits cause a new label to be printed.
  
 3. Not sending marked drugs to external interface when option 4 [SEND
    MARKED ORDERS AND PRINT LABEL] is chosen for EXTERNAL DISPENSE field 
    (#5)in the OUTPATIENT SITE file (#59).
  
 4. With the deployment of Cache version 5, it was discovered that the
    short lock timeout values could generate a lock failure. 
  
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
 1.  HD137758 -  VISTA IS LOCKED UP
     Duplicates: HD137842
                 HD137806
 2.  HD129370 -  UNDEF ERROR PSORXED
 3.  HD140579 -  Not sending marked drugs to external interface
     Duplicate:  HD151957
 4.  HD196487 -  LOCKING ISSUE 
  
  
 PARTICIPATING TEST SITES:
 =========================
 Bronx VAMC
 Palo Alto HCS 
  
  
 REMEDY OVERVIEW:
 ================
 1.  HD137758 -  VISTA IS LOCKED UP
  
     Problem:
     --------
     Cache Mumps environments would lock up due to the Cache Journal files 
     filling up with duplicate entries from the Outpatient Pharmacy Cost 
     Compiler Month End run.  Invalid Literal dates in the "AL" and "AM"
     cross references, to the PRESCRIPTION file (#52), were encountered by
     the Month End compiler routine, PSOCSTM.  These literal dates, were
     causing the compiler to restart after it got to the end of the file
     and read the same data over and over again.
  
     Resolution:
     ----------- 
     Change the For loops in the routine PSOCSTM, to recognize literal vs.
     numeric dates, in the cross references, and to quit when gets to the
     end of the valid numeric dates.
  
  
 2.  HD129370 -  UNDEF ERROR PSORXED
  
     Problem:
     --------
     When editing a large number of prescriptions for the same patient, an 
     undefined error occurs when the edits cause a new label to be printed.
  
     Resolution:
     ----------- 
     Allow the edit of an unlimited number of prescriptions for a patient.
  
  
 3.  HD140579 -  Not sending marked drugs to external interface
   
     Problem:
     --------
     Not sending marked drugs to external interface when option 4 (SEND
     MARKED ORDERS AND PRINT LABEL) is chosen for EXTERNAL DISPENSE field
     (#5) in the OUTPATIENT SITE file (#5).
  
     Resolution:
     -----------
     Correct routine PSOLBL4 to setup the array HLRXY correctly with the 
     proper subscripts and to check the Suspense variable PSODBQ properly.
  
  
 4.  HD196487 -  Locking Issue
  
     Problem:
     --------
     With the deployment of Cache version 5, it was discovered that the
     short lock timeout values could generate a lock failure. 
  
     Resolution:
     -----------
     In order to avoid the lock issue in Outpatient Pharmacy, this patch
     modifies one routine (PSORXED) that currently uses a lock timeout
     value of less than 3 seconds to check for the node ^DD("DILOCKTM") 
     and to use the value defined there, otherwise the lock timeout value
     is set to a default value of 3 seconds.
  
  
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch may be installed with users on the system, however, it is
 recommended that this patch be installed after normal business hours.  
 The installation time should be less than 2 minutes.
  
   
 1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu. [Note:
    TEXT PRINT/DISPLAY option in the PackMan menu will display the
    patch text only].
      
 2. From the Kernel Installation and Distribution System (KIDS)
    menu, select the Installation menu.
  
 3. From this menu, you may elect to use the following options:
    (when prompted for INSTALL NAME, enter PSO*7.0*246)
     
    a.  Backup a Transport Global - this option will create a backup
        message of any routines exported with the patch.  It will
        NOT backup any other changes such as DDs or templates.
    b.  Compare Transport Global to Current System  - this option
        will allow you to view all changes that will be made when
        the patch is installed.  It compares all components of the
        patch (routines, DDs, templates, etc.).
    c.  Verify Checksums in Transport Global - this option will
        allow you to ensure the integrity of the routines that are
        in the transport global.
    d.  Print Transport Global - this option will allow you to view
        the components of the KIDS build.
     
 4. Use the Install Package(s) option and select the package PSO*7.0*246
     
 5. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
    NO//', respond NO.
     
 6. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
    Protocols? NO//', respond NO.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;7.0;OUTPATIENT PHARMACY;**[Patch List]**;DEC 1997;Build 12

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSOCSTM
    Before: B44070535   After: B46011931  **4,17,19,28,89,212,246**
Routine Name: PSOLBL4
    Before: B55680785   After: B49309535  **26,70,156,244,233,246**
Routine Name: PSORXED
    Before: B53144628   After: B53805571  **2,16,21,26,56,71,125,201,246**
 
Routine list of preceding patches: 201, 212, 233

=============================================================================
User Information:
Entered By  : NAPOLIELLO,GREG               Date Entered  : MAY 12, 2006
Completed By: WERNER,GARY                   Date Completed: MAY 07, 2008
Released By : VECE,VIRGINIA                 Date Released : MAY 12, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
