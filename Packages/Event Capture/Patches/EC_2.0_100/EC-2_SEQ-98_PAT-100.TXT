$TXT Created by WILBUR,CHARLIE at DEVVJJ.FO-ALBANY.MED.VA.GOV  (KIDS) on Thursday, 11/05/09 at 09:48
=============================================================================
Run Date: JAN 13, 2010                     Designation: EC*2*100
Package : EC - EVENT CAPTURE                  Priority: Mandatory
Version : 2        SEQ #98                      Status: Released
                  Compliance Date: FEB 13, 2010
=============================================================================

Associated patches: (v)EC*2*76     <<= must be installed BEFORE `EC*2*100'
                    (v)EC*2*101    <<= must be installed BEFORE `EC*2*100'
                    (v)EC*2*105    <<= must be installed BEFORE `EC*2*100'

Subject: ECS FY09 ENHANCEMENTS

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Other

Description:
============

 I. OVERVIEW
   
 The Health Administration Center (HAC) DSS Program office annually
 requests modifications to the Event capture System that would provide
 the field with improved data entry capabilities so that accurate
 costing information can be gathered nationally.  This patch contains
 the modifications for Fiscal Year 2009 and Remedy ticket fixes.
  
 This patch addresses the New Service Request (NSR): 20070575
  
 II. FUNCTIONAL OVERVIEW
  
 1.     508 Compliance - Keyboard Shortcuts and Hot Keys - All forms 
        and screens have been checked and updated to make sure all 
        buttons and data entry areas can be accessed via the keyboard 
        without use of the mouse. In certain circumstances,
        the hot key will only be usable if the user is using Screen
        Reader software. 
  
 2.     The EC application will now provide the ability to remove an 
        invalid user from access list to DSS Units.
  
        A one- time check at the time the software is installed will review
        the users granted access in all units. Invalid users are removed
        from the "Included" list.  Since they are terminated, they will not
        appear on the "Excluded" list.
  
        A one-time check at the time the software is installed will review
        the users granted access by unit. Invalid Users will no longer
        appear in the drop down box as a user to whom access can be
        granted.  
     
        An ECS manager's mail group has been established that will receive 
        a list of users whose access has been removed.  The user names 
        will appear by DSS Unit.  The message will be distributed to the 
        ECS managers group using the local VistA MailMan application.  
        Members of the mail group will be holders of the ECXMGR security key.
  
        When a user changes from active to inactive (terminated status in 
        the New Person file, field #200), the ECS system will be notified
        by the Kernel application by an API.  A nightly background job
        will be set.
      
        (a) to have the ECS software remove any users that have been granted 
            access to one or more DSS units and
        (b) to send a notification message to the mailgroup.
  
        This will automatically update the "Grant Access to DSS Unit 
        [specific DSS Unit]" screen.  The result is that the use no longer
        appears in the Excluded List or the Included List.  No manual action 
        is needed by the DSS Unit Manager.    
  
        When a user changes from active to inactive (terminated status in 
        the New Person file, field #200), the user name will not display
        in the drop down box above the DSS Units as a selectable user to
        whom access to DSS Unit(s) can be granted.  Removal of the user
        from the "Included List" in Proposed Change 4, affects the
        display within this list.  The screen affected is "Grant Access
        to DSS Units by User".
  
        The manager of the DSS Unit will be notified when a user is removed. 
        The message used during installation will be used as users are
        excluded, per the nightly job.  It will be sent to the DSS Unit
        Managers mailgroup. It will contain the DSS Unit and then the
        user(s) that have had access removed from the DSS Unit.
  
        If the user is re-activated, the user name will appear in the 
        "Excluded List" on the "Grant Access to DSS Unit [specific DSS Unit]".
  
        If the user is re-activated, the user name will appear in the list 
        of names to be selected in the drop down box above the DSS Units 
        in the screen "Grant Access to DSS Units by User". 
  
 3.     A field has been added to the Management Menu (DSS Units)
        screen to reflect if workload is set to pass to PCE.
  
        A new column "PCE", has been inserted on the screen. The Value is 
        the Sent to PCE indicator which maps to the following values. 
        All - Send All Records
        Outpatient - Send Outpatient Only
        No - Send No Records. 
  
        The column sequences have been revised to be: 
        DSS Unit Name, Unit IEN, Active, PCE, DSS Dept Service, Medical
        Specialty, Cost Center.
  
        Column widths have been updated to improve visual appearance of the
        screen.
  
 4.     DSS Units-Add find button to Management Menu (DSS Units) 
        screen.
  
        Find buttons, search string, and results popup have been added to
        DSS Unit Name and DSS Dept. Users can now type a partial search
        string, press find, and the screen will be positioned to the first
        entry matching their search criteria. The results will be filtered
        according to the Status filter.
  
 5.     DSS Units - Add find or search button to search by IEN
        under DSS Unit list.
  
        Find buttons, search string, and results popup have been added to
        Unit IEN. Users can now type a partial search string, press find,
        and the screen will be positioned to the first entry matching their
        search criteria. The results will be filtered according to the
        Status filter.
  
 6.     DSS Units-New DSS Unit Report to replace old ability.
  
        Users can now opt to display Active or Inactive units only. Print
        functionality has been added. An export option has also been added
        to create an Excel spreadsheet with the data contained in the report.
  
        The export and print function will be active for the following 
        Management Menu screen: DSS Units. But disabled on the following 
        Management Menu screens: Locations, Categories, Procedures, and 
        Event Code.
  
 7.     DSS Units-Show IEN on DSS Unit screen
  
        The column "Unit IEN" has been added after the DSS Unit Name column.
        The column title DSS Number has been changed to DSS Dept. Both of
        these changes have been made on both the display and edit screens. 
  
 8.     DSS Units-Restrict DSS-Only workload to use valid stop 
        codes only.
  
        A Secondary only stop code should not be used in the DSS Unit. 
  
        The EC software has been updated to restrict DSS-Only workload to
        use valid Primary or Either stop codes in the Associated Stop Code
        field. If a DSS Unit contains a Secondary stop code, that stop code
        is removed, however the field is then auto-populated with the next
        (primary or either) stop code in ALPHABETICAL order [e.g.,  NURSING
        (117) becomes NUTRITION (123)] .
  
        To locate DSS Units that have a Secondary associated stop code, the
        option 'DSS Unit List with Secondary Associated Stop Codes' [EC DSS
        UNIT SECONDARY ASSOC] has been exported with this patch.  It may be
        attached as a secondary menu option.
  
        ACTION:
  
        a. Run the 'DSS Unit List with Secondary Associated Stop Codes'
        report option POST PATCH INSTALLATION to identify DSS Units with 
        'secondary' associated stop codes.
  
        b. Review the DSS Unit/s indicated by the report. PAY CLOSE 
        ATTENTION to the Associated Stop Code field as the unit could be
        saved containing an inappropriate stop code.
  
        c. YOU MUST SELECT THE CORRECT STOP CODE PRIOR TO SAVING (clicking
        the OK button). 
  
        This message is intended to alert managers to be careful until
        patch EC*2.0*107 can be released to correct the issue of
        auto-populating the field.
  
 9.     DSS Units-Allow "/" or "-" in DSS Unit Name on Event Code
        Screen 
  
        The Event Code Screen (entered from the Management Menu) has been
        modified to allow the characters "/" and "-" to be entered in the
        search field. 
  
 10.    Default Location to all enter/edit screens and subsequent use. 
  
        On all EC screens the previous Location entry will be "saved" and 
        used as the default on subsequent Location fields. The application
        will allow the "default" Location to be changed. 
  
 11.    Retain Associated Clinic.
  
        The EC application has been modified to remove the auto-population
        of the Associated Clinic on the Event Code Screen. If there is no
        Associated Clinic the field will be left blank. If the user selects
        an Associated Clinic, the application will save that entry for
        future use.  
  
 12.    Time-Out errors
  
        The Queue option on the print Dialog has been fixed to prevent time
        out errors that were occurring. The Last Printer Selected will be
        kept and used on further uses of the screen. 
  
 13.    Data Entry by Patient "NOW" Option
  
        The EC application has been modified to only use full seconds. 
        Previously time was stored in fractions of seconds, resulting in
        some apparent matches not being found.
  
 14.    Nightly data feed to PCE
  
        The Nightly data feed to PCE Option has been removed from the EC
        application. During post install of this patch, all references
        to this option will be removed. 
  
 15.    Event Code Screen design flaw - unable to select, add or
        modify reasons.
  
        The Add Event Code Screen has been modified to incorporate and 
        display, "Already Linked and Reasons / Selected"  in the 
        Reasons / Selected box.
  
 16.    Fix bug on Category Report
  
        The Category report has been fixed to resolve inconsistent Division 
        Names returned. 
  
 17.    Fix bug in Entry by Procedure option
  
        The Entry by Procedure screen has been modified to remove the
        functionality that was setting a default clinic. Users will now have
        to select a Clinic each time the form is opened.
  
 18.    Modify Print Category and Procedure Summary Report
  
        The Print Category and Procedure Summary Report screens have been
        modified to remove the Category Selection requirement. Category is
        not required to print procedures in a DSS unit.
  
 19.    Fix bug - Pass Classifications to PCE
  
        The following screens have been modified to fix a report problem with
        passing entries to PCE. 
  
        Edit Patient Procedure
        Same Procedure/Multiple Patients
        Multiple Procedures/Multiple Patients (Patient Tab)
  
        Some fields like Military Sexual Trauma were inconsistently passed 
        to PCE.  The problem has been resolved. 
  
 20.    Fix bug - need ability to queue reports from Event Capture.
  
        The following reports were not always queuing correctly, the EC 
        application has been modified to correct the problem. 
  
        Patient Summary, DSS Unit Activity, DSS Unit Workload, 
        Provider Summary Report, Ordering Section Summary, 
        Provider [1-7] Summary, PCE Data Summary,
        Inactive Person Class
  
 21.    Fix bug in Grant Access to DSS Unit option.
  
        The EC software has been modified to fix a reported problem that
        not all of the selected units for a user were being applied.
  
 22.    Modify Add Button on Multiple Dates/Multiple Procedures 
        screen.
  
        The Add button on the Multiple Dates/Multiple Procedures screen has
        been renamed to Save to avoid confusion with the Add Patient button.
  
 23.    Fix bug on Multiple Dates/Multiple Procedures screen
  
        The screen has been modified to correct overlapping fields.
  
 24.    Fix bug on Enter/Edit Patient Procedures screen
  
        The screen has been modified to correct the overlapping fields.  
  
 Warning---In rare occasions, user may experience an error if running 
 application during the nightly clean up of ^XTMP.  At most sites, this is 
 run around midnight while minimal users are on the system.  This error 
 will be fixed in EC*2.0*107.
  
 This patch addresses the following Remedy tickets:
 --------------------------------------------------
 HD0000000318592:        List out of Bounds Error
  
  Problem:
  ----------
  A user at the site is getting the List out of Bounds Error when running 
  the DSS Unit Activity Report. The error occurs when there is only one DSS
  Unit assigned to a Location.
  
  Resolution:
  -------------
  The EC GUI Procedure TfrmSelectReport.SetMultDssValues was modified to 
  prevent the List out of Bounds (-1) Error when running the DSS Unit 
  Activity Report.
  
  
 III.  COMPONENTS SENT WITH PATCH
  
       No other components are sent with this patch. 
  
 IV. SOFTWARE AND DOCUMENTATION RETRIEVAL
     The VistA server software for this patch is being distributed through the 
     National Patch Module (NPM). 
  
     The Event Capture GUI client software is being distributed as a self-
     extracting Install Shield executable.  The installed executable for
     this patch is client version 2.1.3.2 with a size of 1,755 KB.
  
   The GUI client software and documentation for this patch
   may be retrieved directly using FTP from the ANONYMOUS.SOFTWARE  
   directory at the following Office of Information (OI) Field Offices:
  
   OIFO               FTP ADDRESS                  DIRECTORY
   ------------       ------------------------     ------------------
   First available    download.vista.med.va.gov    anonymous.software
   Albany             ftp.fo-albany.med.va.gov     anonymous.software
   Hines              ftp.fo-hines.med.va.gov      anonymous.software
   Salt Lake City     ftp.fo-slc.med.va.gov        anonymous.software
  
  The following files will be available:
  
     File Name           Format        Description
     ---------           ------        -----------
     EC2_OP100.EXE       BINARY        EC GUI client installer
  
 The Technical and User Manuals can be obtained via FTP from the
 following ANONYMOUS.SOFTWARE directories:
  
         OI Field Office                 FTP Address
        ---------------                  ------------------------
         Albany                          ftp.fo-albany.med.va.gov
         Hines                           ftp.fo-hines.med.va.gov
         Salt Lake City                  ftp.fo-slc.med.va.gov
   
          File Name           Description
          ----------------    ----------------------------------------
          EC_20_P100_IG.DOC   Installation Guide for ECS FY09 Enhancements
          EC_20_P100_UM.DOC    Updated Event Capture User Manual 
  
   The VistA Documentation Library [VDL] web site will contain the
   updated 'Event Capture User Manual', and 'Event Capture Technical Manual'.
   This web site is usually updated within 1-3 days of the patch release
   date.
  
   The VDL address is http://www.va.gov/vdl/application.asp?appid=39.
  
 V. TEST SITES
  
 The following sites participated in the testing of the EC*2.0*100
 software.
  
  Test Site
  --------------------
  Cincinnati
  Milwaukee
  Las Vegas
  Omaha
  
 VI. INSTALLATION INSTRUCTIONS
  
   ********************* IMPORTANT NOTE ***************************
   This patch updates the software version number of both the VistA
   server software and the Event Capture client GUI to version 2.1.3.2.
   GUI client versions prior to version 2.1.3.2 are not compatible with 
   the VistA server software for this patch.  Therefore, it is crucial
   that the Event Capture client GUI distributed with this patch be
   installed immediately following the VistA server software install
   to minimize service disruption to the Event Capture System users.
  
  
  
  Pre-Installation Items:
  =======================
  
  * Environment Check:
      
     Programmer access is required for installing this patch.
  
     ** NOTE ** -- Prior to installation, the installer must ensure the  
                   DUZ(0) node of the DUZ array is set to the "@" symbol.
   
  * Users On the System:
    
     This patch modifies routines used by the Event Capture application and
     may affect many users.
  
     This patch may be installed with users on the system, but should be
     loaded during non-peak hours to minimize disruption to users and to
     reduce the possibility of errors when the routines are updated.
  
     If installed during the normal workday, it is recommended that the
     following selection(s) in the OPTION (#19) file, and all of their
     descendants be disabled to prevent possible conflicts while running
     the KIDS Install. Other VISTA users will not be affected.
  
           EC GUI Context version 2.1.2.1   ... EC GUI CONTEXT
    
  * Software Installation Time:
  
     The estimated installation time is less than 5 minutes during off peak
     hours.
  
  * Required Builds:
    
     The following is a list of REQUIRED builds for this KIDS
     distribution.  KIDS will not allow the installation of this patch
     without their prior installation.
  
     Required Build(s):
     ------------------
     EC*2.0*76
     EC*2.0*101
     EC*2.0*105
  
  Installation Steps:
  ===================
   1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
       the KIDS distribution included with this message.
  
   2.  From the Kernel Installation and Distribution System Menu, select
       the Installation menu.
  
   3.  From this menu, you may elect to use the following options
       (when prompted for INSTALL NAME, enter EC*2.0*100):
       a. Backup a Transport Global - this option will create a backup
          message of any routines exported with the patch. It will NOT
          backup any other changes such as DDs or templates.
       b. Compare Transport Global to Current System - This option will
          allow you to view all changes that will be made when this patch
          is installed. It compares all components of this patch
          (routines, DD's, templates, etc.).
       c. Verify Checksums in Transport Global - This option will allow
          you to ensure the integrity of the routines that are in the
          transport global.
       d. Print Transport Global - this option will allow you to view the
         components of the KIDS build.
  
   4.  Use the Install Package(s) option and select the package EC*2.0*100.
  
   5.  When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
       Install? YES//'  Answer YES unless your system does this in a
       nightly TaskMan process.
  
   6.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
       YES//' answer NO (unless otherwise indicated).
  
   7.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, 
       and Protocols? YES//' answer YES (unless otherwise indicated)
     
   8.  When prompted 'Enter options you wish to mark as 'Out Of Order':'  
       Enter the following options:
      
       EC GUI Context version 2.1.2.1   ... EC GUI CONTEXT
  
   9.  When prompted 'Enter protocols you wish to mark as 'Out Of
       Order':' press <return>.
  
  10.  The ENV/PRE/POST Installation routine EC2P100 may be deleted
       from your system after successful patch installation and the
       successful population of the 'APRV' index.
  
  11.  Install the Event Capture GUI client software following the
       instructions of the EC GUI Installation Guide found on the VistA
       Documentation Library (VDL) at the following link:
       http://www.va.gov/vdl/application.asp?appid=39
  
  12.  The Event Capture GUI executable file "ECS GUI.exe", that
       is unbundled after running the install in step #7, may be
       copied to another machine without additional supporting files.
  
  
 Post-Installation steps:
 ========================
  
   1.  Queue the new 'Remove Terminated Users Access to DSS Units' 
       [ECDEAL2] option.  Schedule it to run nightly, after 2am. 
  
                           Edit Option Schedule
     Option Name: ECDEAL2                       
     Menu Text: Remove Terminated Users Access t          TASK ID:
 __________________________________________________________________________
  
   QUEUED TO RUN AT WHAT TIME: SEP 1,2009@03:00              
  
 DEVICE FOR QUEUED JOB OUTPUT:                               
  
  QUEUED TO RUN ON VOLUME SET:                      
  
       RESCHEDULING FREQUENCY: 1D                            
  
              TASK PARAMETERS:
  
             SPECIAL QUEUEING:                     
  
 __________________________________________________________________________
  
  
  
   2.  If option 'EC Data Feed to PCE' [EC PCE FEED] is scheduled to run, 
       remove it from your task list.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;2.0; EVENT CAPTURE ;**[Patch List]**;8 May 96;Build 21

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: EC2P100
    Before:       n/a   After: B19451491  **100**
Routine Name: ECDEAL2
    Before:       n/a   After:  B6485318  **100**
Routine Name: ECGTP
    Before:       n/a   After:   B274015  **100**
Routine Name: ECKILL
    Before: B12278874   After: B12351832  **4,5,10,17,18,23,42,54,65,76,100**
Routine Name: ECMFECS
    Before: B37201667   After: B43702074  **25,33,47,55,65,95,100**
Routine Name: ECOB
    Before:       n/a   After: B19937351  **100**
Routine Name: ECOB19
    Before:       n/a   After:  B2105969  **100**
Routine Name: ECOB2
    Before:       n/a   After: B27889135  **100**
Routine Name: ECOB3
    Before:       n/a   After:  B4073607  **100**
Routine Name: ECOB30
    Before:       n/a   After: B11111309  **100**
Routine Name: ECOB31
    Before:       n/a   After: B15085073  **100**
Routine Name: ECOB40
    Before:       n/a   After: B17508001  **100**
Routine Name: ECOB41
    Before:       n/a   After:  B3206658  **100**
Routine Name: ECOBA
    Before:       n/a   After:  B2535954  **100**
Routine Name: ECOBARG
    Before:       n/a   After:  B4723167  **100**
Routine Name: ECOBC
    Before:       n/a   After: B72789394  **100**
Routine Name: ECOBL
    Before:       n/a   After: B38300397  **100**
Routine Name: ECOBM
    Before:       n/a   After:  B1417289  **100**
Routine Name: ECOBMC
    Before:       n/a   After:  B8250173  **100**
Routine Name: ECOBP
    Before:       n/a   After:  B1702030  **100**
Routine Name: ECOBPC
    Before:       n/a   After:  B8756759  **100**
Routine Name: ECOBU
    Before:       n/a   After:B159516513  **100**
Routine Name: ECOBUF
    Before:       n/a   After:  B6151296  **100**
Routine Name: ECOBUL
    Before:       n/a   After: B60319608  **100**
Routine Name: ECOBVST
    Before:       n/a   After: B20262344  **100**
Routine Name: ECOBVSTS
    Before:       n/a   After: B20642496  **100**
Routine Name: ECRRPC
    Before: B12668648   After: B15494219  **25,47,61,72,95,101,100**
Routine Name: ECRRPT1
    Before: B51929894   After: B55152988  **25,32,33,61,78,72,90,95,100**
Routine Name: ECRUTL
    Before: B36031980   After: B36325605  **5,100**
Routine Name: ECSUM1
    Before: B11875694   After: B12652997  **4,19,23,33,47,95,100**
Routine Name: ECUMRPC1
    Before: B63731298   After: B73472186  **25,30,33,72,94,95,105,100**
 
Routine list of preceding patches: 76, 101, 105

=============================================================================
User Information:
Entered By  : YORTY,M ROBERT                Date Entered  : JAN 07, 2009
Completed By: HARRIS,DONNA H                Date Completed: JAN 13, 2010
Released By : HATTER,JACKIE L               Date Released : JAN 13, 2010
=============================================================================


Packman Mail Message:
=====================

$END TXT
