Released DI*22*160 SEQ #141
Extracted from mail message
**KIDS**:DI*22.0*160^

**INSTALL NAME**
DI*22.0*160
"BLD",762,0)
DI*22.0*160^VA FILEMAN^0^3091006^y
"BLD",762,1,0)
^^2^2^3090123^^^
"BLD",762,1,1,0)
See patch DI*22*160 in the National Patch Module on FORUM for complete
"BLD",762,1,2,0)
information on this patch.
"BLD",762,4,0)
^9.64PA^^
"BLD",762,6)
8^
"BLD",762,6.3)
21
"BLD",762,"INID")
n^n
"BLD",762,"INIT")
POSTINIT^DIPR160
"BLD",762,"KRN",0)
^9.67PA^779.2^20
"BLD",762,"KRN",.4,0)
.4
"BLD",762,"KRN",.401,0)
.401
"BLD",762,"KRN",.402,0)
.402
"BLD",762,"KRN",.403,0)
.403
"BLD",762,"KRN",.5,0)
.5
"BLD",762,"KRN",.84,0)
.84
"BLD",762,"KRN",3.6,0)
3.6
"BLD",762,"KRN",3.8,0)
3.8
"BLD",762,"KRN",9.2,0)
9.2
"BLD",762,"KRN",9.8,0)
9.8
"BLD",762,"KRN",9.8,"NM",0)
^9.68A^16^15
"BLD",762,"KRN",9.8,"NM",1,0)
DIPTED^^0^B42280045
"BLD",762,"KRN",9.8,"NM",2,0)
DICATT^^0^B12133640
"BLD",762,"KRN",9.8,"NM",3,0)
DICATTD4^^0^B1867202
"BLD",762,"KRN",9.8,"NM",4,0)
DICATT0^^0^B10735912
"BLD",762,"KRN",9.8,"NM",6,0)
DIBT^^0^B23941529
"BLD",762,"KRN",9.8,"NM",7,0)
DINIT21^^0^B10881037
"BLD",762,"KRN",9.8,"NM",8,0)
DIPZ0^^0^B4318484
"BLD",762,"KRN",9.8,"NM",9,0)
DIU0^^0^B9844434
"BLD",762,"KRN",9.8,"NM",10,0)
DICATTD2^^0^B2690922
"BLD",762,"KRN",9.8,"NM",11,0)
DICATTD1^^0^B5668488
"BLD",762,"KRN",9.8,"NM",12,0)
DIPR160^^0^B9877265
"BLD",762,"KRN",9.8,"NM",13,0)
DIK^^0^B37897212
"BLD",762,"KRN",9.8,"NM",14,0)
DIEV^^0^B33978709
"BLD",762,"KRN",9.8,"NM",15,0)
DDGF0^^0^B25027446
"BLD",762,"KRN",9.8,"NM",16,0)
DIK1^^0^B14750350
"BLD",762,"KRN",9.8,"NM","B","DDGF0",15)

"BLD",762,"KRN",9.8,"NM","B","DIBT",6)

"BLD",762,"KRN",9.8,"NM","B","DICATT",2)

"BLD",762,"KRN",9.8,"NM","B","DICATT0",4)

"BLD",762,"KRN",9.8,"NM","B","DICATTD1",11)

"BLD",762,"KRN",9.8,"NM","B","DICATTD2",10)

"BLD",762,"KRN",9.8,"NM","B","DICATTD4",3)

"BLD",762,"KRN",9.8,"NM","B","DIEV",14)

"BLD",762,"KRN",9.8,"NM","B","DIK",13)

"BLD",762,"KRN",9.8,"NM","B","DIK1",16)

"BLD",762,"KRN",9.8,"NM","B","DINIT21",7)

"BLD",762,"KRN",9.8,"NM","B","DIPR160",12)

"BLD",762,"KRN",9.8,"NM","B","DIPTED",1)

"BLD",762,"KRN",9.8,"NM","B","DIPZ0",8)

"BLD",762,"KRN",9.8,"NM","B","DIU0",9)

"BLD",762,"KRN",19,0)
19
"BLD",762,"KRN",19,"NM",0)
^9.68A^^
"BLD",762,"KRN",19.1,0)
19.1
"BLD",762,"KRN",101,0)
101
"BLD",762,"KRN",409.61,0)
409.61
"BLD",762,"KRN",771,0)
771
"BLD",762,"KRN",779.2,0)
779.2
"BLD",762,"KRN",870,0)
870
"BLD",762,"KRN",8989.51,0)
8989.51
"BLD",762,"KRN",8989.52,0)
8989.52
"BLD",762,"KRN",8994,0)
8994
"BLD",762,"KRN","B",.4,.4)

"BLD",762,"KRN","B",.401,.401)

"BLD",762,"KRN","B",.402,.402)

"BLD",762,"KRN","B",.403,.403)

"BLD",762,"KRN","B",.5,.5)

"BLD",762,"KRN","B",.84,.84)

"BLD",762,"KRN","B",3.6,3.6)

"BLD",762,"KRN","B",3.8,3.8)

"BLD",762,"KRN","B",9.2,9.2)

"BLD",762,"KRN","B",9.8,9.8)

"BLD",762,"KRN","B",19,19)

"BLD",762,"KRN","B",19.1,19.1)

"BLD",762,"KRN","B",101,101)

"BLD",762,"KRN","B",409.61,409.61)

"BLD",762,"KRN","B",771,771)

"BLD",762,"KRN","B",779.2,779.2)

"BLD",762,"KRN","B",870,870)

"BLD",762,"KRN","B",8989.51,8989.51)

"BLD",762,"KRN","B",8989.52,8989.52)

"BLD",762,"KRN","B",8994,8994)

"BLD",762,"PRE")
DIPR160
"BLD",762,"QUES",0)
^9.62^^
"BLD",762,"REQB",0)
^9.611^6^6
"BLD",762,"REQB",1,0)
DI*22.0*97^1
"BLD",762,"REQB",2,0)
DI*22.0*110^1
"BLD",762,"REQB",3,0)
DI*22.0*76^1
"BLD",762,"REQB",4,0)
DI*22.0*109^1
"BLD",762,"REQB",5,0)
DI*22.0*55^1
"BLD",762,"REQB",6,0)
DI*22.0*146^1
"BLD",762,"REQB","B","DI*22.0*109",4)

"BLD",762,"REQB","B","DI*22.0*110",2)

"BLD",762,"REQB","B","DI*22.0*146",6)

"BLD",762,"REQB","B","DI*22.0*55",5)

"BLD",762,"REQB","B","DI*22.0*76",3)

"BLD",762,"REQB","B","DI*22.0*97",1)

"INIT")
POSTINIT^DIPR160
"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
VA FILEMAN^DI^FM INIT
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
22.0^2990330^3080318^1163
"PKG",5,22,1,"PAH",1,0)
160^3091006^1163
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3091006
"PKG",5,22,1,"PAH",1,1,1,0)
See patch DI*22*160 in the National Patch Module on FORUM for complete
"PKG",5,22,1,"PAH",1,1,2,0)
information on this patch.
"PRE")
DIPR160
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
15
"RTN","DDGF0")
0^15^B25027446^B25027473
"RTN","DDGF0",1,0)
DDGF0 ;SFISC/MKO-SETUP, CLEANUP ;09:58 AM  9 Sep 1994
"RTN","DDGF0",2,0)
 ;;22.0;VA FileMan;**160**;Mar 30, 1999;Build 21
"RTN","DDGF0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DDGF0",4,0)
 ;
"RTN","DDGF0",5,0)
 D INIT^DDGLIB0() Q:$G(DIERR)
"RTN","DDGF0",6,0)
 D SET,GETKEY
"RTN","DDGF0",7,0)
 Q
"RTN","DDGF0",8,0)
 ;
"RTN","DDGF0",9,0)
SET ;Setup variables
"RTN","DDGF0",10,0)
 D:$D(DT)[0 DT^DICRW
"RTN","DDGF0",11,0)
 S (DIOVRD,DDGFR)=1,DDGFREF="^TMP(""DDGF"",$J)",DDGFCHG=0
"RTN","DDGF0",12,0)
 K @DDGFREF,DDGFFM
"RTN","DDGF0",13,0)
 Q
"RTN","DDGF0",14,0)
 ;
"RTN","DDGF0",15,0)
END ;Clear screen, clean up variables
"RTN","DDGF0",16,0)
 I $D(DDGFFM)#2 D RECOMP
"RTN","DDGF0",17,0)
KILL ;
"RTN","DDGF0",18,0)
 D:$G(DIERR) MSG^DIALOG("BW")
"RTN","DDGF0",19,0)
 X:$D(DDGLZOSF) DDGLZOSF("EON"),DDGLZOSF("TRMOFF")
"RTN","DDGF0",20,0)
 D KILL^DDGLIB0()
"RTN","DDGF0",21,0)
 K:$D(DDGFREF) @DDGFREF,DDGFREF
"RTN","DDGF0",22,0)
 K ^TMP("DDGFH",$J)
"RTN","DDGF0",23,0)
 K DDGF,DDGFBV,DDGFCHG,DDGFE,DDGFFILE,DDGFFM,DDGFLIM,DDGFMSG
"RTN","DDGF0",24,0)
 K DDGFPG,DDGFR,DDGFWID,DDGFWIDB
"RTN","DDGF0",25,0)
 K DDH
"RTN","DDGF0",26,0)
 Q
"RTN","DDGF0",27,0)
 ;
"RTN","DDGF0",28,0)
RECOMP ;Recompile form
"RTN","DDGF0",29,0)
 N DDGFLIST
"RTN","DDGF0",30,0)
 S DDGFLIST=$NA(^TMP("DDGFOF",$J))
"RTN","DDGF0",31,0)
 D MSG^DDGF("Recompiling ...")
"RTN","DDGF0",32,0)
 ;
"RTN","DDGF0",33,0)
 D GETBLKS(+DDGFFM,DDGFLIST)
"RTN","DDGF0",34,0)
 S DDSQUIET=1 D EN^DDSZ(DDGFFM) K DDSQUIET
"RTN","DDGF0",35,0)
 I $D(@DDGFLIST) D
"RTN","DDGF0",36,0)
 . N DDGFI
"RTN","DDGF0",37,0)
 . S DDGFI=""
"RTN","DDGF0",38,0)
 . F  S DDGFI=$O(@DDGFLIST@(DDGFI)) Q:'DDGFI  D EN^DDSZ(DDGFI)
"RTN","DDGF0",39,0)
 . K @DDGFLIST
"RTN","DDGF0",40,0)
 ;
"RTN","DDGF0",41,0)
 D MSG^DDGF("")
"RTN","DDGF0",42,0)
 S DX=0,DY=IOSL-1 X IOXY
"RTN","DDGF0",43,0)
 Q
"RTN","DDGF0",44,0)
 ;
"RTN","DDGF0",45,0)
GETBLKS(F,L) ;
"RTN","DDGF0",46,0)
 ;Determine if any of the blocks loaded are
"RTN","DDGF0",47,0)
 ;used on other forms.
"RTN","DDGF0",48,0)
 ; L(Form#)=""        Other forms that need recompiling
"RTN","DDGF0",49,0)
 ;
"RTN","DDGF0",50,0)
 N P,B
"RTN","DDGF0",51,0)
 S P=0 F  S P=$O(@DDGFREF@("F",P)) Q:'P  D
"RTN","DDGF0",52,0)
 . S B=0
"RTN","DDGF0",53,0)
 . F  S B=$O(@DDGFREF@("F",P,B)) Q:'B  D:'$D(@L@("B",B))
"RTN","DDGF0",54,0)
 .. S @L@("B",B)=""
"RTN","DDGF0",55,0)
 .. D OTHER(B,F,L)
"RTN","DDGF0",56,0)
 K @L@("B")
"RTN","DDGF0",57,0)
 Q
"RTN","DDGF0",58,0)
 ;
"RTN","DDGF0",59,0)
OTHER(B,F,L) ;
"RTN","DDGF0",60,0)
 ;Return list L of forms other than F that use block B
"RTN","DDGF0",61,0)
 ; L(Form#)=""
"RTN","DDGF0",62,0)
 N F1
"RTN","DDGF0",63,0)
 S F1=""
"RTN","DDGF0",64,0)
 F  S F1=$O(^DIST(.403,"AB",B,F1)) Q:F1=""  I F1'=F S @L@(F1)=""
"RTN","DDGF0",65,0)
 S F1="" F  S F1=$O(^DIST(.403,"AC",B,F1)) Q:F1=""  I F1'=F S @L@(F1)=""
"RTN","DDGF0",66,0)
 Q
"RTN","DDGF0",67,0)
 ;
"RTN","DDGF0",68,0)
GETKEY ;Get key sequences and defaults
"RTN","DDGF0",69,0)
 N AU,AD,AR,AL,F1,F2,F3,F4,I,K,N,T
"RTN","DDGF0",70,0)
 S AU=$P(DDGLKEY,U,2)
"RTN","DDGF0",71,0)
 S AD=$P(DDGLKEY,U,3)
"RTN","DDGF0",72,0)
 S AR=$P(DDGLKEY,U,4)
"RTN","DDGF0",73,0)
 S AL=$P(DDGLKEY,U,5)
"RTN","DDGF0",74,0)
 S F1=$P(DDGLKEY,U,6)
"RTN","DDGF0",75,0)
 S F2=$P(DDGLKEY,U,7)
"RTN","DDGF0",76,0)
 S F3=$P(DDGLKEY,U,8)
"RTN","DDGF0",77,0)
 S F4=$P(DDGLKEY,U,9)
"RTN","DDGF0",78,0)
 ;
"RTN","DDGF0",79,0)
 F N="","S","D" D
"RTN","DDGF0",80,0)
 . S DDGF(N_"IN")="",DDGF(N_"OUT")=""
"RTN","DDGF0",81,0)
 . F I=1:1 S T=$P($T(@(N_"MAP")+I),";;",2,999) Q:T=""  D
"RTN","DDGF0",82,0)
 .. S @("K="_$P(T,";",2))
"RTN","DDGF0",83,0)
 .. I DDGF(N_"IN")'[(U_K) D
"RTN","DDGF0",84,0)
 ... S DDGF(N_"IN")=DDGF(N_"IN")_U_K
"RTN","DDGF0",85,0)
 ... S DDGF(N_"OUT")=DDGF(N_"OUT")_$P(T,";")_U
"RTN","DDGF0",86,0)
 . S DDGF(N_"IN")=DDGF(N_"IN")_U
"RTN","DDGF0",87,0)
 . S DDGF(N_"OUT")=$E(DDGF(N_"OUT"),1,$L(DDGF(N_"OUT"))-1)
"RTN","DDGF0",88,0)
 Q
"RTN","DDGF0",89,0)
 ;
"RTN","DDGF0",90,0)
MAP ;Keys for main screen
"RTN","DDGF0",91,0)
 ;;LNU;AU;          line up
"RTN","DDGF0",92,0)
 ;;LND;AD;          line down
"RTN","DDGF0",93,0)
 ;;CHR;AR;          char right
"RTN","DDGF0",94,0)
 ;;CHL;AL;          char left
"RTN","DDGF0",95,0)
 ;;ELR;$C(9);       element right
"RTN","DDGF0",96,0)
 ;;ELL;"Q";         element left
"RTN","DDGF0",97,0)
 ;;TBR;"S";         tab right
"RTN","DDGF0",98,0)
 ;;TBL;"A";         tab left
"RTN","DDGF0",99,0)
 ;;EXIT;F1_"E";     exit
"RTN","DDGF0",100,0)
 ;;QUIT;F1_"Q";     quit
"RTN","DDGF0",101,0)
 ;;ROWCOL;"R";      row/col indicator toggle
"RTN","DDGF0",102,0)
 ;;SCT;F1_AU;       top of screen
"RTN","DDGF0",103,0)
 ;;SCB;F1_AD;       bottom of screen
"RTN","DDGF0",104,0)
 ;;SCR;F1_AR;       right edge of screen
"RTN","DDGF0",105,0)
 ;;SCL;F1_AL;       left edge of screen
"RTN","DDGF0",106,0)
 ;;SAVE;F1_"S";     save changes
"RTN","DDGF0",107,0)
 ;;SELECT;" ";      select an element
"RTN","DDGF0",108,0)
 ;;SELECT;$C(13);   select an element
"RTN","DDGF0",109,0)
 ;;SELFILE;F1_1;    select file
"RTN","DDGF0",110,0)
 ;;VIEW;F1_"V";     view toggle
"RTN","DDGF0",111,0)
 ;;EDIT;F3;         edit caption or data length
"RTN","DDGF0",112,0)
 ;;FLDADD;F2_"F";   add a new field
"RTN","DDGF0",113,0)
 ;;BKADD;F2_"B";    add a new block
"RTN","DDGF0",114,0)
 ;;NXTPG;F1_F1_AD;  go to next page
"RTN","DDGF0",115,0)
 ;;PRVPG;F1_F1_AU;  go to previous page
"RTN","DDGF0",116,0)
 ;;CLSPG;F1_"C";    close popup page
"RTN","DDGF0",117,0)
 ;;PGSEL;F1_"P";    select another page
"RTN","DDGF0",118,0)
 ;;PGADD;F2_"P";    add a new page
"RTN","DDGF0",119,0)
 ;;PGEDIT;F4_"P";   edit page attributes
"RTN","DDGF0",120,0)
 ;;FMSEL;F1_"M";    select another form
"RTN","DDGF0",121,0)
 ;;FMADD;F2_"M";    add a new form
"RTN","DDGF0",122,0)
 ;;FMEDIT;F4_"M";   edit form attributes
"RTN","DDGF0",123,0)
 ;;HELP;F1_"H"
"RTN","DDGF0",124,0)
 ;;
"RTN","DDGF0",125,0)
SMAP ;Keys for moving selected gadgets
"RTN","DDGF0",126,0)
 ;;LNU;AU;          line up
"RTN","DDGF0",127,0)
 ;;LND;AD;          line down
"RTN","DDGF0",128,0)
 ;;CHR;AR;          char right
"RTN","DDGF0",129,0)
 ;;CHL;AL;          char left
"RTN","DDGF0",130,0)
 ;;TBR;$C(9);       tab right
"RTN","DDGF0",131,0)
 ;;TBR;"S";          "   "
"RTN","DDGF0",132,0)
 ;;TBL;"Q";         tab left
"RTN","DDGF0",133,0)
 ;;TBL;"A";          "   "
"RTN","DDGF0",134,0)
 ;;ROWCOL;"R";      row/col indicator toggle
"RTN","DDGF0",135,0)
 ;;SCT;F1_AU;       top of screen
"RTN","DDGF0",136,0)
 ;;SCB;F1_AD;       bottom of screen
"RTN","DDGF0",137,0)
 ;;SCR;F1_AR;       right edge of screen
"RTN","DDGF0",138,0)
 ;;SCL;F1_AL;       left edge of screen
"RTN","DDGF0",139,0)
 ;;SUBPG;F1_"D";    go into a multiples pop-up page
"RTN","DDGF0",140,0)
 ;;DESELECT;" ";    deselect an element
"RTN","DDGF0",141,0)
 ;;DESELECT;$C(13); deselect an element
"RTN","DDGF0",142,0)
 ;;EDIT;F4;         edit properties
"RTN","DDGF0",143,0)
 ;;REORDER;F1_"O";  reorder fields in block
"RTN","DDGF0",144,0)
 ;;
"RTN","DDGF0",145,0)
DMAP ;Keys for changing data length
"RTN","DDGF0",146,0)
 ;;CHR;AR;          char right
"RTN","DDGF0",147,0)
 ;;CHL;AL;          char left
"RTN","DDGF0",148,0)
 ;;DONE;$C(13);     done
"RTN","DDGF0",149,0)
 ;;DONE;" ";        done
"RTN","DDGF0",150,0)
 ;;DONE;F3;         done
"RTN","DDGF0",151,0)
 ;;
"RTN","DIBT")
0^6^B23941529^B23693851
"RTN","DIBT",1,0)
DIBT ;SFISC/GFT,TKW,TOAD-STORE A SORT TEMPLATE ;11NOV2008
"RTN","DIBT",2,0)
 ;;22.0;VA FileMan;**82,160**;Mar 30, 1999;Build 21
"RTN","DIBT",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIBT",4,0)
MENU ;
"RTN","DIBT",5,0)
0 ; select and edit templates, until user quits
"RTN","DIBT",6,0)
 S DIC="^DOPT(""DIBT"",",DICF=DI
"RTN","DIBT",7,0)
 I '$D(^DOPT("DIBT",.402)) S ^(0)="TEMPLATE FILE^1.01" K ^("B") D
"RTN","DIBT",8,0)
 .F X=.4,.401,.402 S ^DOPT("DIBT",X,0)=$P(^DIC(X,0),U)
"RTN","DIBT",9,0)
 .N DIK S DIK=DIC D IXALL^DIK
"RTN","DIBT",10,0)
 S DIC(0)="QEAIN",DIC("A")="Select TEMPLATE File: "
"RTN","DIBT",11,0)
 S DIC("S")="I Y=.4!(Y=.401)!(Y=.402)"
"RTN","DIBT",12,0)
 D ^DIC K DIC Q:Y<0
"RTN","DIBT",13,0)
 K DTOUT F  Q:'$$T(+Y,DICF)  I $D(DTOUT) K DTOUT Q
"RTN","DIBT",14,0)
 Q
"RTN","DIBT",15,0)
 ;
"RTN","DIBT",16,0)
T(DDSFILE,DICF) ;=.4,.401,.402
"RTN","DIBT",17,0)
 N Y,DIC,DIERR,DDSPARM,DR,DA,DIN
"RTN","DIBT",18,0)
 W !! S DIC=DDSFILE,DIC("S")="I $P(^(0),U,4)="_DICF_",Y'<1",D="F"_DICF
"RTN","DIBT",19,0)
 S DIC(0)="AEQI" D IX^DIC I Y<0 Q 0
"RTN","DIBT",20,0)
 S DA=+Y,DIN=$$SCREEN G SCROLL:DIN=0 I 'DIN Q 0
"RTN","DIBT",21,0)
 S DIN=$S(DDSFILE=.4:"DIPTED",DDSFILE=.402:"DIETED",1:"DIBTED")
"RTN","DIBT",22,0)
 S DR="["_DIN_"]",DDSPARM="" D ^DDS Q '$D(DIERR)
"RTN","DIBT",23,0)
 ;
"RTN","DIBT",24,0)
SCROLL N DIE,DIOVRD,DR
"RTN","DIBT",25,0)
 S DIE=DDSFILE,DR=".01:3;5:7;10;707;491620",DIOVRD=1 D ^DIE Q 1
"RTN","DIBT",26,0)
 ;
"RTN","DIBT",27,0)
SCREEN(HELP) ;
"RTN","DIBT",28,0)
 N DIR,DIRUT,DUOUT,X,Y,DIERR
"RTN","DIBT",29,0)
 K DUZ("SCREEN") ;COMMENT OUT THIS LINE IF YOU WANT FILEMAN TO REMEMBER!
"RTN","DIBT",30,0)
 I $G(DUZ("SCREEN"))=0 Q 0
"RTN","DIBT",31,0)
 D SET^DDGLIB0 I $D(DIERR) Q 0
"RTN","DIBT",32,0)
 I '$G(DUZ("SCREEN")) D  I '$D(DUZ("SCREEN")) Q U  ;ABORT
"RTN","DIBT",33,0)
 .S DIR(0)="Y",DIR("A")="Do you want to use the screen-mode version",DIR("B")="YES"
"RTN","DIBT",34,0)
 .I $D(HELP) S DIR("?")=HELP
"RTN","DIBT",35,0)
 .D ^DIR I Y-1 S:Y=0 DUZ("SCREEN")=0 Q
"RTN","DIBT",36,0)
 .S DUZ("SCREEN")=1
"RTN","DIBT",37,0)
 D KILL^DDGLIB0()
"RTN","DIBT",38,0)
 ;I ^DD("OS")=9 U $I:VT=1 ;FOR DATATREE
"RTN","DIBT",39,0)
 Q +$G(DUZ("SCREEN"))
"RTN","DIBT",40,0)
 ;
"RTN","DIBT",41,0)
S ;
"RTN","DIBT",42,0)
 D S1^DIBT1 K DIRUT,DIROUT G Q^DIP:$D(DUOUT)!($D(DTOUT))
"RTN","DIBT",43,0)
 G N:X="",S:Y<0
"RTN","DIBT",44,0)
 S DIBT1=+Y
"RTN","DIBT",45,0)
SNEW K ^DIBT(DIBT1,2),^("BY0"),^("BY0D") S $P(^DIBT(DIBT1,0),U,7)=DT
"RTN","DIBT",46,0)
 I $G(BY(0))]"",$D(DPP(0)) D
"RTN","DIBT",47,0)
 . N DIBY,DIREC,%,I,D,F,T,Q1,Q2,O S %=DIBT1_"," S DIBY(.401,%,1622)=$P(BY(0),U,2),DIBY(.401,%,1623)=DPP(0)+1 D FILE^DIE("E","DIBY")
"RTN","DIBT",48,0)
 . F I=1:1:DPP(0) D
"RTN","DIBT",49,0)
 .. S F=$P($G(DPP(I,"F")),U,2),T=$P($G(DPP(I,"T")),U,2),O=$P($G(DPP(I)),U,4),Q1="" S:O["!" Q1=Q1_"!" S:O["#" Q1=Q1_"#" S Q2=$P($G(DPP(I)),U,5),O=$G(DPP(I,"OUT"))
"RTN","DIBT",50,0)
 .. S %="+"_I_","_DIBT1_"," K DIBY(.4011624,%)
"RTN","DIBT",51,0)
 .. S:F]"" DIBY(.4011624,%,1)=F S:T]"" DIBY(.4011624,%,2)=T S:Q1]"" DIBY(.4011624,%,3.1)=Q1 S:Q2]"" DIBY(.4011624,%,3.2)=Q2 S:O]"" DIBY(.4011624,%,4)=O
"RTN","DIBT",52,0)
 .. Q:'$D(DIBY(.4011624,%))  S DIBY(.4011624,%,.01)=I,DIREC(I)=I Q
"RTN","DIBT",53,0)
 . D UPDATE^DIE("E","DIBY","DIREC")
"RTN","DIBT",54,0)
 . Q
"RTN","DIBT",55,0)
 S (DIBT2,DIBT3)=+$G(DPP(0)) F  S DIBT3=$O(DPP(DIBT3)) Q:'DIBT3  S DIBT2=DIBT2+1 D
"RTN","DIBT",56,0)
 .N DIC,DA,DIE,DINUM,DIOVRD,DR,DO S X=$P(DPP(DIBT3),U) Q:+$P(X,"E")'=X  S DIC="^DIBT("_DIBT1_",2,",DIC(0)="L",DA(1)=DIBT1,DINUM=DIBT2,DIOVRD=1,DIC("P")=$P(^DD(.401,1621,0),U,2) D FILE^DICN K DIC,DA,DINUM,DIOVRD
"RTN","DIBT",57,0)
 .N A,B,C,D S $P(^DIBT(DIBT1,2,DIBT2,0),U,2,10)=$P(DPP(DIBT3),U,2,10)
"RTN","DIBT",58,0)
 .S A="A" F  S A=$O(DPP(DIBT3,A)) Q:A=""  S %=$G(DPP(DIBT3,A)) S:%]"" ^DIBT(DIBT1,2,DIBT2,A)=%
"RTN","DIBT",59,0)
 .S (C,D)=0 F A=-1:0 S A=$O(DPP(DIBT3,A)) Q:+$P(A,"E")'=A  D
"RTN","DIBT",60,0)
 ..I $G(DPP(DIBT3,A))]"" S C=C+1,%=1,%(1)=17,X=A,DINUM=C,DIC("DR")="1////"_DPP(DIBT3,A) D DICM
"RTN","DIBT",61,0)
 ..S B="" F  S B=$O(DPP(DIBT3,A,B)) Q:B=""  S D=D+1,%=2,%(1)=18,X=A,DINUM=D D DICM S:Y>0 ^DIBT(DIBT1,2,DIBT2,2,+Y,"RCOD")=$P(DPP(DIBT3,A,B),U,4,99)
"RTN","DIBT",62,0)
 ..Q
"RTN","DIBT",63,0)
 .S D=0,A="OV" F  S A=$O(DPP(DIBT3,A)) Q:$E(A,1,2)'="OV"  S B="" F  S B=$O(DPP(DIBT3,A,B)) Q:B=""  S C=$G(DPP(DIBT3,A,B)) I C]"" S D=D+1,%=3,%(1)=19,X=A,DINUM=D D DICM I Y>0 S $P(^DIBT(DIBT1,2,DIBT2,3,+Y,0),U,2)=B,^("OVF0")=C
"RTN","DIBT",64,0)
 .Q
"RTN","DIBT",65,0)
 I $D(DIBTOLD) K DIBTOLD D K Q
"RTN","DIBT",66,0)
 S DIBT2=+$G(DPP(0))
"RTN","DIBT",67,0)
S0 S DIBT2=DIBT2+1 G N:DIBT2>DPP,S0:'$D(DPP(DIBT2,"F")),S0:$P(DPP(DIBT2),U,4)["B"
"RTN","DIBT",68,0)
 S DIR("?",1)="Answer YES if you want the to allow the user to specify beginning and",DIR("?")="ending sort values when the print job is run."
"RTN","DIBT",69,0)
 W ! S DIR("A")="SHOULD TEMPLATE USER BE ASKED 'FROM'-'TO' RANGE FOR '"_$P(DPP(DIBT2),U,3)_"'",DIR("B")="NO",DIR(0)="Y" D ^DIR K DIR I $D(DIRUT) D K G Q^DIP
"RTN","DIBT",70,0)
 G:Y=0 S0
"RTN","DIBT",71,0)
S1 S ^DIBT(DIBT1,2,DIBT2,"ASK")=1
"RTN","DIBT",72,0)
 G S0
"RTN","DIBT",73,0)
 ;
"RTN","DIBT",74,0)
DICM S DIC="^DIBT("_DIBT1_",2,"_DIBT2_","_%_",",DA(2)=DIBT1,DA(1)=DIBT2,DIC(0)="L",DIOVRD=1,DIC("P")=$P(^DD(.4014,%(1),0),U,2)
"RTN","DIBT",75,0)
 N C,D
"RTN","DIBT",76,0)
 I %(1)=18 S DIC("DR")="1////"_B F C=1,2,3 S D=$P(DPP(DIBT3,A,B),U,C) I D]"" S DIC("DR")=DIC("DR")_";"_(C+1)_"////"_D
"RTN","DIBT",77,0)
 N A,B,DD,DO D FILE^DICN K DIC,DA,DINUM,DIOVRD Q
"RTN","DIBT",78,0)
 ;
"RTN","DIBT",79,0)
US S $P(^DIBT(DIBT1,0),U,7)=DT I '$O(^DIBT(+$G(DIBT1),2,0)) Q
"RTN","DIBT",80,0)
 N % F X=+$G(DPP(0)):0 S X=$O(DPP(X)) Q:'X  D
"RTN","DIBT",81,0)
 . F %="F","T","SER","TXT","IX","PTRIX","QCON","SRTTXT" K ^DIBT(DIBT1,2,X,%) I $G(DPP(X,%))]"" S:%'="SER" ^DIBT(DIBT1,2,X,%)=DPP(X,%)
"RTN","DIBT",82,0)
 . Q
"RTN","DIBT",83,0)
 Q
"RTN","DIBT",84,0)
 ;
"RTN","DIBT",85,0)
K K DIEDT,DIBT2,DIBT3 Q
"RTN","DIBT",86,0)
N D K G N^DIP1
"RTN","DICATT")
0^2^B12133640^B12030884
"RTN","DICATT",1,0)
DICATT ;SFISC/GFT,XAK-MODIFY FILE ATTR ;11NOV2008
"RTN","DICATT",2,0)
 ;;22.0;VA FileMan;**7,82,160**;Mar 30, 1999;Build 21
"RTN","DICATT",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICATT",4,0)
 I $D(DIAX) S %=2
"RTN","DICATT",5,0)
 E  S %=$$SCREEN^DIBT("^D SCREENQ^DICATT") Q:%=U  S %=2-%
"RTN","DICATT",6,0)
 G ^DICATTD:%=1 Q:%<2
"RTN","DICATT",7,0)
 S DLAYGO=1 D D^DICRW Q:Y<0  I $P($G(^DD(+Y,0,"DI")),U)["Y",($P(@(^DIC(+Y,0,"GL")_"0)"),U,4)) W !!,$C(7),"DATA DICTIONARY MODIFICATIONS ON ARCHIVE FILES ARE NOT ALLOWED!" Q
"RTN","DICATT",8,0)
 I '$D(DIC) D DIE^DIB Q:'$D(DG)  S DIC=DG
"RTN","DICATT",9,0)
 S:$D(DIAX) DIAXDIC=+$P(@(DIC_"0)"),U,2)
"RTN","DICATT",10,0)
EN ;
"RTN","DICATT",11,0)
 K I S Q="""",I(0)=DIC,B=+$P(@(DIC_"0)"),U,2),S=";"
"RTN","DICATT",12,0)
B ;
"RTN","DICATT",13,0)
 K DA,J,DIU0,DDA S A=B,DICL=0,J(0)=B I $D(^DD(A,0,"DDA")),^("DDA")["Y" S DDA=""
"RTN","DICATT",14,0)
M ;
"RTN","DICATT",15,0)
 I $G(Z)["W",A-B G B
"RTN","DICATT",16,0)
 W !!! K O,DQ,DIC,DIE,DG,M G Q^DIB:$D(DTOUT)
"RTN","DICATT",17,0)
 S O=1,E=0,DIC(0)="ALEQIZ",DIC="^DD("_A_"," S:$D(DICS) DIC("S")=DICS
"RTN","DICATT",18,0)
 S DIC("W")="S %=$P(^(0),U,2) I % W $P(""  (multiple)^  (word-processing)"",U,$P(^DD(+%,.01,0),U,2)[""W""+1)"
"RTN","DICATT",19,0)
 I $P(^DD(A,.01,0),U,2)["W" S DIC(0)="AEQZ",DIC("B")=.01
"RTN","DICATT",20,0)
 E  I $D(DA),$D(^DD(A,DA,0)),'$P(^(0),U,2),$P(^(0),U,4)'?.P S E=DA
"RTN","DICATT",21,0)
 D ^DIC S:$D(DDA)&$P(Y,U,3) DDA="N" I Y<0 G B:A-B,Q^DICATT2
"RTN","DICATT",22,0)
SV I '$P(Y,U,3) S DIU0=A,O(1)=$P(^DD(A,+Y,0),U,1,2),O(2)=$S($D(^(.1)):$P(^(.1),U),1:"") I $D(DDA) S DDA="E" D SV^DICATTA
"RTN","DICATT",23,0)
 S:$D(DDA) DDA(1)=A
"RTN","DICATT",24,0)
 S DIAC="AUDIT",DIFILE=A D ^DIAC S O=+% K DIAC,DIFILE
"RTN","DICATT",25,0)
SKP S (D0,DA)=+Y,DA(1)=A,DIE=DIC,M=Y(0),T=$P(M,U,2) S:T["C"!(T["W") O=0
"RTN","DICATT",26,0)
 S DR=$P(".01:.1;",U,DUZ(0)="@"!'$F(T,"X"))_$P("1.1;",U,O)_$S(DUZ(0)="@"&(T'["C")&(T'["W"):"1.2;",1:"")_$S(T["C":"8;",1:"8:9;10:")_"11;20:29"
"RTN","DICATT",27,0)
 S O=$S($P(Y,U,3):0,1:1_U_$P(M,U,2,99)),F=$P(M,U) K DIC,DQI
"RTN","DICATT",28,0)
 S X=0 F  S X=$O(^DD(A,DA,1,X)) Q:X'>0  I +^(X,0)=B,$P(^(0),B,2)?1"^"1.A S DQI=$P(^(0),U,2)
"RTN","DICATT",29,0)
 S X=-1 I 'T D DIE:O  Q:$D(DTOUT)  S:'$D(DA)&($D(DDA)) DDA="D" G TYPE^DICATT2:$D(DA),N:$P(O,U,4)?.P,^DICATT4
"RTN","DICATT",30,0)
 S DR=".01;8;9;10:11;20:29" D DIE I '$D(DA) S:$D(DDA) DDA="D" S DQ(+T)=0 G NEW^DICATT4
"RTN","DICATT",31,0)
 S X=$P($P(M,U,4),";"),M=^DD(A,DA,0),E=$P(M,U),A=+T,DICL=DICL+1,J(DICL)=A,Y=$E(Q,+X'=X),I(DICL)=Y_X_Y I E'=F S ^(0)=E_" SUB-FIELD^"_$P(^DD(A,0),U,2,9) K ^(0,"NM") S ^("NM",E)=""
"RTN","DICATT",32,0)
 G 5:$P(M,U,2)["W",N
"RTN","DICATT",33,0)
 ;
"RTN","DICATT",34,0)
 ;
"RTN","DICATT",35,0)
E S DE=^DD(A,E,0) W $P(DE,U) Q
"RTN","DICATT",36,0)
 ;
"RTN","DICATT",37,0)
P S DI=DIU0 D:$D(O(1))
"RTN","DICATT",38,0)
 .I '$D(DA) S DA=D0 D DIPZ^DIU0 Q
"RTN","DICATT",39,0)
 .I $D(^DD(DI,DA,0)),O(1)'=$P(^(0),U,1,2) D DIPZ^DIU0 Q
"RTN","DICATT",40,0)
 .I $D(^(.1)),O(2)'=$P(^(.1),U) D DIPZ^DIU0 Q
"RTN","DICATT",41,0)
 K DIU0 Q
"RTN","DICATT",42,0)
 ;
"RTN","DICATT",43,0)
N I $D(DDA),DDA]"" S:'$D(DA) DA=D0 D AUDT^DICATTA
"RTN","DICATT",44,0)
 D:$D(DIU0) P S DIZZ=$S(('O&$D(DIZ)):DIZ,1:$P(O,U,2,3)) G M
"RTN","DICATT",45,0)
 ;
"RTN","DICATT",46,0)
X W $C(7),"    '",F,"' DELETED!" I $D(DDA) S DDA=$S(DDA="":"D",1:"")
"RTN","DICATT",47,0)
 S DIK="^DD(A,",DA(1)=A D ^DIK G N
"RTN","DICATT",48,0)
 ;
"RTN","DICATT",49,0)
CHECK G:$P(^DD(A,DA,0),U,2)']"" X:$D(DTOUT) G NO^DICATT2
"RTN","DICATT",50,0)
 ;
"RTN","DICATT",51,0)
DIE ;
"RTN","DICATT",52,0)
 N I,J,DICATTED
"RTN","DICATT",53,0)
 S DICATTED=1 D ^DIE
"RTN","DICATT",54,0)
 Q
"RTN","DICATT",55,0)
 ;
"RTN","DICATT",56,0)
0 S C=$P(O,U,5,99) G @N
"RTN","DICATT",57,0)
1 ;
"RTN","DICATT",58,0)
2 G ^DICATT0
"RTN","DICATT",59,0)
3 ;
"RTN","DICATT",60,0)
4 G ^DICATT6
"RTN","DICATT",61,0)
5 S W="0;1",(Z,DIZ)="W^",C="Q",V=1,L=1 G ^DICATT2:O,SUB^DICATT1
"RTN","DICATT",62,0)
6 G ^DICATT3 ;COMPUTED
"RTN","DICATT",63,0)
7 G ^DICATT5
"RTN","DICATT",64,0)
8 G VP^DICATT4
"RTN","DICATT",65,0)
9 S (Z,DIZ)="K^",V=0,C="K:$L(X)>245 X D:$D(X) ^DIM",L=245
"RTN","DICATT",66,0)
 S:$P(^DD(A,DA,0),U,4)]"" W=$P(^(0),U,4) G ^DICATT2:O,SUB^DICATT1
"RTN","DICATT",67,0)
 ;
"RTN","DICATT",68,0)
SCREENQ ;
"RTN","DICATT",69,0)
 W !,"'YES' will invoke the ScreenMan editor.",!,"The same questions are asked in both screen & scrolling mode."
"RTN","DICATT0")
0^4^B10735912^B10633623
"RTN","DICATT0",1,0)
DICATT0 ;SFISC/GFT,XAK-DATES, NUMERIC ;1/7/2009
"RTN","DICATT0",2,0)
 ;;22.0;VA FileMan;**160**;Mar 30, 1999;Build 21
"RTN","DICATT0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICATT0",4,0)
 G @N
"RTN","DICATT0",5,0)
 ;
"RTN","DICATT0",6,0)
DIE K Y S DP=0 F  S DL=1,DP=$O(DQ(DP)) Q:DP=""  S:$D(DE(DP)) DG(DP)=DE(DP)
"RTN","DICATT0",7,0)
 S DP=-1 D DQ^DIED K DQ,DICATTZ G CHECK^DICATT:$D(Y)!$D(DTOUT),@(N_0)
"RTN","DICATT0",8,0)
 ;
"RTN","DICATT0",9,0)
1 S %DT="E",DQ="^I X'?1""DT"".NP D ^%DT S X=Y K:Y<0 X",DQ(1)="EARLIEST DATE (OPTIONAL)^D^^1"_DQ,DQ(0,2)="S:'$L(X) Y=""CAN""",DQ(3)="LATEST DATE^RD^^3"_DQ_" I $D(X),X<DG(1) K X"
"RTN","DICATT0",10,0)
 S P="<X!(" I C[P S DE(1)=$P($P(C,P,2),">X",1),DE(3)=$P($P(C,"K:",2),P,1)
"RTN","DICATT0",11,0)
 S DQ(4)="CAN DATE BE IMPRECISE (Y/N)^S^Y:YES;N:NO;^4^Q",DE(4)=$E("YN",$P(C,Q,2)["X"+1),DQ(4,3)="E.G., WOULD 'FEB, 1980' BE ALLOWED?"
"RTN","DICATT0",12,0)
 S DQ(5)="CAN TIME OF DAY BE ENTERED (Y/N)^S^Y:YES;N:NO;^5^S:X=""N"" (DG(7),DG(6))=X K:X=""N"" DQ(6)"
"RTN","DICATT0",13,0)
 S DQ(6)="CAN SECONDS BE ENTERED (Y/N)^S^Y:YES;N:NO;^6^S DG(6)=X",DE(6)=$E("NY",$P(C,Q,2)["S"+1)
"RTN","DICATT0",14,0)
 S DE(5)=$E("NY",$P(C,Q,2)["T"+1),DQ(5,3)="CAN USER ENTER TIME ALONG WITH DATE, AS IN 'JULY 20@4:30'?"
"RTN","DICATT0",15,0)
 S DQ(7)="IS TIME REQUIRED (Y/N)^S^Y:YES;N:NO;^7^Q",DQ(7,3)="MUST USER ENTER TIME ALONG WITH DATE",DQ(0,6)="I X=""N"" S Y=U,DQ=DQ+1",DE(7)=$E("NY",$P(C,Q,2)["R"+1)
"RTN","DICATT0",16,0)
 S DICATTZ=1 G DIE
"RTN","DICATT0",17,0)
 ;
"RTN","DICATT0",18,0)
10 S C="S %DT=""E"_$E("S",DG(6)="Y")_$E("T",DG(5)="Y")_$E("X",DG(4)="N")_$E("R",DG(7)="Y")_""" D ^%DT S X=Y K:"
"RTN","DICATT0",19,0)
 F X=1,3 G ND:'$D(DG(X)) S Y(X)=$S(DG(X):DG(X)\10000+1700,1:DG(X)) I DG(X)#100 S Y(X)=DG(X)#100_"/"_Y(X) I $E(DG(X),4,5) S Y(X)=+$E(DG(X),4,5)_"/"_Y(X)
"RTN","DICATT0",20,0)
 I DG(1)]"" S M="Type a date between "_Y(1)_" and "_Y(3)_".",C=C_DG(3)_P_DG(1)_">X) X" G ED
"RTN","DICATT0",21,0)
ND S C=C_"Y<1 X"
"RTN","DICATT0",22,0)
ED S Z="D^",L=DG(5)="Y"*5+7,DG(6)="" G H
"RTN","DICATT0",23,0)
 ;
"RTN","DICATT0",24,0)
2 K DG S DQ("A1")="!(X'["".""&($L(X)>15))!(X["".""&($L($P(+X,"".""))+$L($P(+X,""."",2))>15)) X"
"RTN","DICATT0",25,0)
 S DQ(1)="INCLUSIVE LOWER BOUND^R^^1^K:+X'=X"_DQ("A1"),DQ(2)="INCLUSIVE UPPER BOUND^R^^2^K:X<DG(1)!(+X'=X)"_DQ("A1"),DQ(3)="IS THIS A DOLLAR AMOUNT (Y/N)^S^Y:YES;N:NO;^3^Q" K DQ("A1")
"RTN","DICATT0",26,0)
 S P="1"".""",Z=$S(C["$":3,1:+$P(C,P,2)),DE(3)=$E("NY",C["$"+1),DE(5)=$S(Z:Z-1,1:0)
"RTN","DICATT0",27,0)
 S DQ(0,4)="S:X=""Y"" Y=U,DQ=9,DG(5)=2",DQ(5)="MAXIMUM NUMBER OF FRACTIONAL DIGITS^RN^^5^K:X'?1N X"
"RTN","DICATT0",28,0)
 I O S DE(1)=+$P(C,"X<",2),DE(2)=+$P(C,"X>",2)
"RTN","DICATT0",29,0)
 G DIE
"RTN","DICATT0",30,0)
20 I DG(1)>DG(2) W $C(7),"??" G 2
"RTN","DICATT0",31,0)
 S M="Type a "_$P("number^dollar amount",U,DG(3)="Y"+1)_" between "_DG(1)_" and "_DG(2)_", "_DG(5)_" decimal digit"_$E("s",DG(5)'=1)_"."
"RTN","DICATT0",32,0)
 S C="K:+X'=X",T=DG(5)+1,Z="!(X?.E"_P_T_"N.N)"
"RTN","DICATT0",33,0)
 I DG(3)="Y",DA-.001 S C="S:X[""$"" X=$P(X,""$"",2) K:X'?"_$P(".""-""",U,DG(1)<0)_".N."_P_".2N",Z=""
"RTN","DICATT0",34,0)
 S C=C_"!(X>"_DG(2)_")!(X<"_DG(1)_")"_Z_" X",L=$L(DG(2)\1)+T-(T=1),Z="NJ"_L_","_DG(5)_U
"RTN","DICATT0",35,0)
H S DIZ=Z G ^DICATT1
"RTN","DICATTD1")
0^11^B5668488^B5499736
"RTN","DICATTD1",1,0)
DICATTD1 ;SFISC/GFT- DATE,TIME ;2 FEB 2009
"RTN","DICATTD1",2,0)
 ;;22.0;VA FileMan;**42,160**;Mar 30, 1999;Build 21
"RTN","DICATTD1",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICATTD1",4,0)
 ;
"RTN","DICATTD1",5,0)
EARLY ;
"RTN","DICATTD1",6,0)
 S Y=">X" G Y
"RTN","DICATTD1",7,0)
 ;
"RTN","DICATTD1",8,0)
LATEST ;
"RTN","DICATTD1",9,0)
 S Y="<X"
"RTN","DICATTD1",10,0)
Y S Y=$F(DICATT5,Y) I Y S Y=$E(DICATT5,Y-9,Y-3) S:Y?.E1"DT" Y="DT" D:Y DD^%DT Q
"RTN","DICATTD1",11,0)
 K Y Q
"RTN","DICATTD1",12,0)
 ;
"RTN","DICATTD1",13,0)
POST1 ;check DATE
"RTN","DICATTD1",14,0)
 N Z,Y,%DT,I K DDSERROR
"RTN","DICATTD1",15,0)
 S %DT="T"
"RTN","DICATTD1",16,0)
 D  I $D(DDSERROR) D HLP^DDSUTL("'EARLIEST DATE' & 'LATEST DATE' ARE IN WRONG ORDER") S DDSBR="21^DICATT1^2.1" Q
"RTN","DICATTD1",17,0)
 .S Y=$$G(21) I Y="DT" S X=$$G(22) D:X]""  Q
"RTN","DICATTD1",18,0)
 ..I X'="DT" D ^%DT I Y<DT S DDSERROR=1 Q
"RTN","DICATTD1",19,0)
 .Q:Y=""  S X=Y D ^%DT S X=$$G(22) Q:X=""  I X="DT" S:Y>DT DDSERROR=1 Q
"RTN","DICATTD1",20,0)
 .S Z=Y D ^%DT I Y<Z S DDSERROR=1
"RTN","DICATTD1",21,0)
 S DICATT5N="S %DT=""E"_$E("S",$$G(25)=1)_$E("T",$$G(24)=1)_$E("X",$$G(23)=0)_$E("R",$$G(26)=1)_""" D ^%DT S X=Y K:"
"RTN","DICATTD1",22,0)
FROMTO K DICATTMN F I=21,22 S Z=$$G(I) Q:Z=""  D
"RTN","DICATTD1",23,0)
 .I Z="DT" S Y=Z,Z="CURRENT DATE"
"RTN","DICATTD1",24,0)
 .E  S X=Z D ^%DT S X=Y D DD^%DT S Z=Y,Y=X
"RTN","DICATTD1",25,0)
 .S DICATTMN(I)=Z,DICATT5N(I)=Y ;Z is readable, Y internal
"RTN","DICATTD1",26,0)
 I $D(DICATTMN(22)) S DICATTMN="Type a date between "_DICATTMN(21)_" and "_DICATTMN(22)_".",DICATT5N=DICATT5N_DICATT5N(22)_"<X!("_DICATT5N(21)_">X) X"
"RTN","DICATTD1",27,0)
 E  I $D(DICATTMN(21)) S DICATTMN="Type a date not earlier than "_DICATTMN(21)_".",DICATT5N=DICATT5N_DICATT5N(21)_">X X"
"RTN","DICATTD1",28,0)
 E  S DICATT5N=DICATT5N_"X<1 X",DICATTMN="(No range limit on date)"
"RTN","DICATTD1",29,0)
 S DICATTLN=$$G(24)=1*5+7
"RTN","DICATTD1",30,0)
 S DICATT2N="D",DICATT3N=""
"RTN","DICATTD1",31,0)
 S X=DICATT5N K DICATT5N S DICATT5N=X ;get rid of those damn subscripts
"RTN","DICATTD1",32,0)
CHNG I DICATT5N=DICATT5 K DICATTMN ;No DICATTMN means no change
"RTN","DICATTD1",33,0)
 D:$D(DICATTMN) PUT^DDSVALF(98,"DICATT",1,DICATTMN)
"RTN","DICATTD1",34,0)
 Q
"RTN","DICATTD1",35,0)
 ;
"RTN","DICATTD1",36,0)
G(I) N X Q $$GET^DDSVALF(I,"DICATT1",2.1,"I","")
"RTN","DICATTD2")
0^10^B2690922^B2653999
"RTN","DICATTD2",1,0)
DICATTD2 ;SFISC/GFT-NUMERIC FIELD ;1/7/2009
"RTN","DICATTD2",2,0)
 ;;22.0;VA FileMan;**42,160**;Mar 30, 1999;Build 21
"RTN","DICATTD2",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICATTD2",4,0)
 ;
"RTN","DICATTD2",5,0)
POST2 ;check NUMERIC
"RTN","DICATTD2",6,0)
 N L,D,DD,Z,T
"RTN","DICATTD2",7,0)
 S DD=$$G(34),D=$$G(33),Y=$$G(31) Q:Y=""  S L=$$G(32) Q:L=""
"RTN","DICATTD2",8,0)
 I L<Y S DDSERROR=1,DDSBR="31^DICATT2^2.2" D HLP^DDSUTL("'MINIMUM' & 'MAXIMUM' ARE IN WRONG ORDER") Q
"RTN","DICATTD2",9,0)
 S DICATTMN="Type a "_$P("number^dollar amount",U,$$G(33)=1+1)_" between "_Y_" and "_L_", "_DD_" decimal digit"_$E("s",DD'=1)_"."
"RTN","DICATTD2",10,0)
 S DICATT5N="K:+X'=X",T=DD+1,Z="!(X?.E"_"1""."""_T_".N)"
"RTN","DICATTD2",11,0)
DOLLAR I D,DICATTF-.001 S DICATT5N="S:X[""$"" X=$P(X,""$"",2) K:X'?"_$P(".""-""",U,Y<0)_".N.1""."".2N"
"RTN","DICATTD2",12,0)
 S DICATT5N=DICATT5N_"!(X>"_L_")!(X<"_Y_")"_Z_" X",DICATTLN=$L(L\1)+T-(T=1)+(L<0),DICATT2N="NJ"_DICATTLN_","_DD,DICATT3N=""
"RTN","DICATTD2",13,0)
CHNG I DICATT5N=DICATT5 K DICATTMN ;No DICATTMN means no change
"RTN","DICATTD2",14,0)
 D:$D(DICATTMN) PUT^DDSVALF(98,"DICATT",1,DICATTMN)
"RTN","DICATTD2",15,0)
 Q
"RTN","DICATTD2",16,0)
 ;
"RTN","DICATTD2",17,0)
G(I) N X Q $$GET^DDSVALF(I,"DICATT2",2.2,"I","")
"RTN","DICATTD4")
0^3^B1867202^B1862154
"RTN","DICATTD4",1,0)
DICATTD4 ;SFISC/GFT-FREE TEXT FIELDS ;1/7/2009
"RTN","DICATTD4",2,0)
 ;;22.0;VA FileMan;**42,160**;Mar 30, 1999;Build 21
"RTN","DICATTD4",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICATTD4",4,0)
 ;
"RTN","DICATTD4",5,0)
PRE4 ;PATTERN MATCH default
"RTN","DICATTD4",6,0)
 N I,Z,X,L,YY
"RTN","DICATTD4",7,0)
 S DICATT5P=" X",YY=0,I=0,L=1,Y="",Z=$P(DICATT5,")!'(",2,99) Q:Z=""
"RTN","DICATTD4",8,0)
L S I=I+1,X=$E(Z,I) G L:X'?.P Q:X=""  I X="""" S YY='YY G L
"RTN","DICATTD4",9,0)
 G L:YY I X="(" S L=L+1
"RTN","DICATTD4",10,0)
 G L:X'=")" S L=L-1 G L:L
"RTN","DICATTD4",11,0)
 S Y=$E(Z,1,I-1),DICATT5P=$E(Z,I+1,999) Q
"RTN","DICATTD4",12,0)
 ;
"RTN","DICATTD4",13,0)
POST4 ;check FREE TEXT
"RTN","DICATTD4",14,0)
 N L
"RTN","DICATTD4",15,0)
 S Y=$$G(68) Q:Y=""  S L=$$G(69) Q:L=""
"RTN","DICATTD4",16,0)
 I L<Y S DDSERROR=1,DDSBR="68^DICATT4^2.4" D HLP^DDSUTL("'MINIMUM' & 'MAXIMUM' ARE IN WRONG ORDER") Q
"RTN","DICATTD4",17,0)
 S X=$S(L=Y:L,1:Y_"-"_L),DICATTMN="Answer must be "_X_" character"_$E("s",X'=1)_" in length."
"RTN","DICATTD4",18,0)
 S X=$$G(70) I X]"" S X="!'("_X_")"
"RTN","DICATTD4",19,0)
 S DICATTLN=L,DICATT5N="K:$L(X)>"_L_"!($L(X)<"_Y_")"_X_DICATT5P
"RTN","DICATTD4",20,0)
 S DICATT2N="F",DICATT3N=""
"RTN","DICATTD4",21,0)
 D CHNG^DICATTD Q
"RTN","DICATTD4",22,0)
 ;
"RTN","DICATTD4",23,0)
G(I) N X Q $$GET^DDSVALF(I,"DICATT4",2.4)
"RTN","DIEV")
0^14^B33978709^B33402331
"RTN","DIEV",1,0)
DIEV ;SFISC/DPC-DATA VALIDATOR ;22SEP2009
"RTN","DIEV",2,0)
 ;;22.0;VA FileMan;**55,160**;Mar 30, 1999;Build 21
"RTN","DIEV",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIEV",4,0)
VAL(DIEVF,DIEVIEN,DIEVFLD,DIEVFLG,DIEVAL,DIEVANS,DIEVFAR,DIOUTAR) ;
"RTN","DIEV",5,0)
VALX ;
"RTN","DIEV",6,0)
 N DIEV0,DIEVP2,DA,D,I,C,G K DIEVANS
"RTN","DIEV",7,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DIEV",8,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DIEV",9,0)
 S DIEVFLG=$G(DIEVFLG) I '$$VERFLG^DIEFU(DIEVFLG,"HFERYUK") G OUT
"RTN","DIEV",10,0)
 D FLDVAL G:$G(DIEVAL)=U OUT
"RTN","DIEV",11,0)
IENS S G=$G(DIEVIEN) I G]"" S:G'?.E1"," G=G_"," S C=$L(G,",")-1 F I=1:1:C S D="D"_(C-I) N @D S @D=$P(G,",",I) I @D="" D BLD^DIALOG(308,$G(DIEVIEN)) G OUT
"RTN","DIEV",12,0)
 S DIEVIEN=G D DA^DIEFU(G,.DA)
"RTN","DIEV",13,0)
 D AUXVAL(DIEVF,DIEVIEN,DIEVFLD,DIEVFLG,DIEVAL,.DIEVANS,.DIEV0,.DIEVP2)
"RTN","DIEV",14,0)
 I $G(DIEVANS)=U!("@"[DIEVAL) G OUT
"RTN","DIEV",15,0)
MINVAL ;
"RTN","DIEV",16,0)
 D INT(DIEVF,DIEVFLD,DIEVFLG,DIEVAL,.DIEVANS,$G(DIEV0),$G(DIEVP2))
"RTN","DIEV",17,0)
 I DIEVANS=U D ERR G OUT
"RTN","DIEV",18,0)
 I DIEVFLG'["U",$G(DIEVIEN)'?."," D KEY(DIEVF,DIEVIEN,DIEVFLD,DIEVFLG,DIEVANS,.DIEVANS)
"RTN","DIEV",19,0)
OUT S DIEVANS=$G(DIEVANS,U)
"RTN","DIEV",20,0)
 I DIEVFLG["F",DIEVANS'=U D FDA
"RTN","DIEV",21,0)
 I $G(DIOUTAR)]"" D CALLOUT^DIEFU(DIOUTAR)
"RTN","DIEV",22,0)
 Q
"RTN","DIEV",23,0)
 ;
"RTN","DIEV",24,0)
FLDVAL ;
"RTN","DIEV",25,0)
 N DIEVOUT S DIEVOUT=0
"RTN","DIEV",26,0)
 I '$$VFILE^DIEFU(DIEVF,"D") S DIEVAL=U Q
"RTN","DIEV",27,0)
 I '$$VFIELD^DIEFU(DIEVF,DIEVFLD,"D") S DIEVAL=U Q
"RTN","DIEV",28,0)
 S DIEV0=^DD(DIEVF,DIEVFLD,0),DIEVP2=$P(DIEV0,U,2)
"RTN","DIEV",29,0)
 D DTYPE
"RTN","DIEV",30,0)
 I DIEVOUT=1 S DIEVAL=U
"RTN","DIEV",31,0)
 Q
"RTN","DIEV",32,0)
 ;
"RTN","DIEV",33,0)
AUXVAL(DIEVF,DIEVIEN,DIEVFLD,DIEVFLG,DIEVAL,DIEVANS,DIEV0,DIEVP2) ;
"RTN","DIEV",34,0)
 N DIEVOUT S DIEVOUT=0
"RTN","DIEV",35,0)
 I '$D(DIOVRD),$P($G(^DD($$FNO^DILIBF(DIEVF),0,"DI")),U,2)="Y",DIEVFLG'["Y" D  G AUXERR
"RTN","DIEV",36,0)
 . N INT,EXT S INT(1)=$$FILENM^DIEFU(DIEVF),EXT("FILE")=DIEVF
"RTN","DIEV",37,0)
 . D BLD^DIALOG(405,.INT,.EXT)
"RTN","DIEV",38,0)
 I $P(DIEV0,U,5,99)["DINUM","@"'[DIEVAL D  G AUXERR
"RTN","DIEV",39,0)
 . N EXT,INT S EXT("FILE")=DIEVF,EXT("FIELD")=DIEVFLD,(INT(1),EXT(1))="DINUMed"
"RTN","DIEV",40,0)
 . D BLD^DIALOG(520,.INT,.EXT)
"RTN","DIEV",41,0)
 I $E(DIEVAL)="?"!(DIEVP2["V"&(DIEVAL[".?")) N P S P(1)=DIEVF,P(2)=DIEVFLD D BLD^DIALOG(1610,"",.P) G AUXERR
"RTN","DIEV",42,0)
 I DIEVFLG["R" G:'$$VENTRY^DIEFU(DIEVF,DIEVIEN,"D9") AUXERR
"RTN","DIEV",43,0)
 I DIEVP2["I",$$DATA(DIEVF,DIEVFLD) N P S P("FIELD")=DIEVFLD,P("FILE")=DIEVF D BLD^DIALOG(710,.P,.P) G AUXERR
"RTN","DIEV",44,0)
 I "@"[DIEVAL D DELETE G:DIEVOUT AUXERR Q
"RTN","DIEV",45,0)
 I DIEVFLG["I" D
"RTN","DIEV",46,0)
 . S DIEVANS=DIEVAL
"RTN","DIEV",47,0)
 . I DIEVFLG["E" S DIEVANS(0)=$$EXTERNAL^DILFD(DIEVF,DIEVFLD,"",DIEVAL)
"RTN","DIEV",48,0)
 Q
"RTN","DIEV",49,0)
AUXERR S DIEVANS=U
"RTN","DIEV",50,0)
 Q
"RTN","DIEV",51,0)
 ;
"RTN","DIEV",52,0)
DTYPE ;
"RTN","DIEV",53,0)
 I DIEVP2 D  S DIEVOUT=1 Q
"RTN","DIEV",54,0)
 . N T,INT,EXT D DTYP^DIOU(DIEVF,DIEVFLD,.T)
"RTN","DIEV",55,0)
 . I T=5 S INT(1)="word-processing",EXT("FIELD")=DIEVFLD,EXT("FILE")=DIEVF D BLD^DIALOG(520,.INT,.EXT) Q
"RTN","DIEV",56,0)
 . S INT(1)="multi-valued",EXT("FIELD")=DIEVFLD,EXT("FILE")=DIEVF D BLD^DIALOG(520,.INT,.EXT)
"RTN","DIEV",57,0)
 I DIEVP2["C" N INT,EXT S INT(1)="computed",EXT("FIELD")=DIEVFLD,EXT("FILE")=DIEVF D BLD^DIALOG(520,.INT,.EXT) S DIEVOUT=1 Q
"RTN","DIEV",58,0)
 Q
"RTN","DIEV",59,0)
 ;
"RTN","DIEV",60,0)
DELETE ;
"RTN","DIEV",61,0)
 I $D(^DD(DIEVF,DIEVFLD,"DEL")) D
"RTN","DIEV",62,0)
 . N DIEVECNT S DIEVECNT=$G(DIERR)
"RTN","DIEV",63,0)
 . N I S I="" F  S I=$O(^DD(DIEVF,DIEVFLD,"DEL",I)) Q:I=""  X $G(^(I,0)) I  S DIEVOUT=1
"RTN","DIEV",64,0)
 . I DIEVECNT'=$G(DIERR) S DIEVOUT=1 D HKERR^DILIBF(DIEVF,$G(DIEVIEN),DIEVFLD,"DEL node")
"RTN","DIEV",65,0)
 I DIEVP2["R" D
"RTN","DIEV",66,0)
 . I DIEVFLD'=.01 S DIEVOUT=1 Q
"RTN","DIEV",67,0)
 . I '$D(^DD(DIEVF,0,"UP")) Q
"RTN","DIEV",68,0)
 . I $P($G(@$$ROOT^DILFD(DIEVF,DIEVIEN,1)@(0)),U,4)=1 S DIEVOUT=1
"RTN","DIEV",69,0)
 I 'DIEVOUT,DIEVFLG'["U",DIEVFLD'=.01 D  Q:DIEVOUT
"RTN","DIEV",70,0)
 . N DIEVKEY
"RTN","DIEV",71,0)
 . S DIEVKEY=0
"RTN","DIEV",72,0)
 . F  S DIEVKEY=$O(^DD("KEY","F",DIEVF,DIEVFLD,DIEVKEY)) Q:'DIEVKEY  D
"RTN","DIEV",73,0)
 . . Q:$D(^DD("KEY",DIEVKEY,0))[0
"RTN","DIEV",74,0)
 . . D ERR742^DIEVK1(DIEVF,DIEVFLD,DIEVKEY,DIEVIEN)
"RTN","DIEV",75,0)
 . . S DIEVOUT=1
"RTN","DIEV",76,0)
 I 'DIEVOUT S DIEVANS="" S:DIEVFLG["E" DIEVANS(0)=""
"RTN","DIEV",77,0)
 E  D
"RTN","DIEV",78,0)
 . N INT,EXT
"RTN","DIEV",79,0)
 . S INT(1)=$$FLDNM^DIEFU(DIEVF,DIEVFLD),INT(2)=$$FILENM^DIEFU(DIEVF)
"RTN","DIEV",80,0)
 . S EXT("FILE")=DIEVF,EXT("FIELD")=DIEVFLD
"RTN","DIEV",81,0)
 . D BLD^DIALOG(712,.INT,.EXT)
"RTN","DIEV",82,0)
 Q
"RTN","DIEV",83,0)
 ;
"RTN","DIEV",84,0)
DATA(DIEVF,DIEVFLD) ;
"RTN","DIEV",85,0)
 N DIEVNODE,DIEVSPOT,N S DIEVSPOT=" ",N=0
"RTN","DIEV",86,0)
 D GLRF^DIOU(DIEVF,DIEVFLD,.DIEVNODE,.DIEVSPOT)
"RTN","DIEV",87,0)
 I +DIEVSPOT D
"RTN","DIEV",88,0)
 . I $P($G(@DIEVNODE),U,DIEVSPOT)'="" S N=1
"RTN","DIEV",89,0)
 E  I $E(DIEVSPOT)="E" D
"RTN","DIEV",90,0)
 . N F,T
"RTN","DIEV",91,0)
 . S F=$P($P(DIEVSPOT,"E",2),",",1),T=$P(DIEVSPOT,",",2)
"RTN","DIEV",92,0)
 . I $TR($E($G(@DIEVNODE),F,T)," ")'="" S N=1
"RTN","DIEV",93,0)
 Q N
"RTN","DIEV",94,0)
 ;
"RTN","DIEV",95,0)
INT(%B1,%B2,DIEVFLG,X,DIEVANS,%B3,%B) ;
"RTN","DIEV",96,0)
 N %A,%E,%C,DIR,DIC,Y,DIE,%J,%T,%BA,DP,DIFLD,DDH,%BU,%I,%K,DQ,DIFILE,C,DIEVECNT,DIRDINUM
"RTN","DIEV",97,0)
 I $G(%B3)="" S %B3=^DD(%B1,%B2,0),%B=$P(%B3,U,2)
"RTN","DIEV",98,0)
 I %B["V" D VP^DIEV1(%B1,%B2,DIEVFLG,X,%B3,.DIEVANS) Q
"RTN","DIEV",99,0)
 I %B["N" D  Q:$G(DIEVANS)=U
"RTN","DIEV",100,0)
 . I $L($P(X,"."))>24 S DIEVANS=U Q
"RTN","DIEV",101,0)
 I %B["S" S X=$$UP^DILIBF(X)
"RTN","DIEV",102,0)
 S %A=%B1_","_%B2_",V",%E=0,DIR("V")="",%T=$E(%B1)
"RTN","DIEV",103,0)
 S DIEVECNT=$G(DIERR)
"RTN","DIEV",104,0)
 S:DIEVFLG["N" DIRDINUM=1 D 1^DIR1
"RTN","DIEV",105,0)
 I DIEVECNT'=$G(DIERR) S DIEVANS=U D HKERR^DILIBF(%B1,$G(DIEVIEN),%B2,"screen on a pointer or set of codes or in an input transform") K:$G(DIRDINUM) DINUM Q
"RTN","DIEV",106,0)
 I %E S DIEVANS=U K:$G(DIRDINUM) DINUM Q
"RTN","DIEV",107,0)
 S DIEVANS=$S(%B'["P":Y,1:$P(Y,U))
"RTN","DIEV",108,0)
 I DIEVFLG["E" D
"RTN","DIEV",109,0)
 . I %B["S"!(%B["D") S DIEVANS(0)=$P(Y(0),U)
"RTN","DIEV",110,0)
 . E  I %B["P" S DIEVANS(0)=Y(0,0)
"RTN","DIEV",111,0)
 . E  I %B["O" D
"RTN","DIEV",112,0)
 . . S DIEVECNT=$G(DIERR)
"RTN","DIEV",113,0)
 . . X $G(^DD(%B1,%B2,2))
"RTN","DIEV",114,0)
 . . I DIEVECNT'=$G(DIERR) D HKERR^DILIBF(%B1,$G(DIEVIEN),%B2,"output transform") Q
"RTN","DIEV",115,0)
 . . S DIEVANS(0)=Y
"RTN","DIEV",116,0)
 . . Q
"RTN","DIEV",117,0)
 . E  S DIEVANS(0)=Y
"RTN","DIEV",118,0)
 . Q
"RTN","DIEV",119,0)
 Q
"RTN","DIEV",120,0)
 ;
"RTN","DIEV",121,0)
KEY(DIEVF,DIEVIEN,DIEVFLD,DIEVFLG,DIEVAL,DIEVANS) ;checks Key integrity for a value
"RTN","DIEV",122,0)
 N DIEVKEY,DIEVFDA S DIEVKEY=""
"RTN","DIEV",123,0)
 S DIEVFDA(DIEVF,DIEVIEN,DIEVFLD)=DIEVAL
"RTN","DIEV",124,0)
 I '$$KEYVAL^DIEVK($E("K",DIEVFLG["K"),"DIEVFDA") K DIEVANS S DIEVANS=U
"RTN","DIEV",125,0)
 Q
"RTN","DIEV",126,0)
 ;
"RTN","DIEV",127,0)
FDA ;
"RTN","DIEV",128,0)
 I $G(DIEVFAR)="" D BLD^DIALOG(202,"FDA") Q
"RTN","DIEV",129,0)
 D LOAD^DIEF1(DIEVF,DIEVIEN,DIEVFLD,"",DIEVANS,DIEVFAR)
"RTN","DIEV",130,0)
 Q
"RTN","DIEV",131,0)
 ;
"RTN","DIEV",132,0)
ERR ;
"RTN","DIEV",133,0)
 N INT,EXT
"RTN","DIEV",134,0)
 S INT(1)=$$FLDNM^DIEFU(DIEVF,DIEVFLD),INT(2)=$$FILENM^DIEFU(DIEVF),(INT(3),EXT(3))=DIEVAL
"RTN","DIEV",135,0)
 S EXT("FILE")=DIEVF,EXT("FIELD")=DIEVFLD,EXT("IENS")=$G(DIEVIEN)
"RTN","DIEV",136,0)
 D BLD^DIALOG(701,.INT,.EXT)
"RTN","DIEV",137,0)
 I DIEVFLG["H" D GET^DIEH(DIEVF,"",DIEVFLD,"?b") ;DA() and D0,D1,etc. passed thru symbol table
"RTN","DIEV",138,0)
 Q
"RTN","DIEV",139,0)
 ;
"RTN","DIEV",140,0)
CHKX ;
"RTN","DIEV",141,0)
 N DIEV0,DIEVP2 K DIEVANS
"RTN","DIEV",142,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DIEV",143,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DIEV",144,0)
 S DIEVFLG=$G(DIEVFLG) I '$$VERFLG^DIEFU(DIEVFLG,"HEN") G OUT
"RTN","DIEV",145,0)
 D FLDVAL I $G(DIEVAL)=U D OUT Q
"RTN","DIEV",146,0)
 D MINVAL
"RTN","DIEV",147,0)
 Q
"RTN","DIK")
0^13^B37897212^B37829878
"RTN","DIK",1,0)
DIK ;SFISC/GFT,YJK,XAK-GATHER A FILE'S XREFS TO EXECUTE ;02/25/2009
"RTN","DIK",2,0)
 ;;22.0;VA FileMan;**41,109,160**;Mar 30, 1999;Build 21
"RTN","DIK",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIK",4,0)
 Q:"(,"'[$E($RE(DIK))  Q:'$D(@(DIK_"DA)"))  Q:$P($G(^DD($$GLO^DILIBF(DIK),0,"DI")),U,2)["Y"&'$D(DIOVRD)&'$G(DIFROM)  Q:DA'>0
"RTN","DIK",5,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIAU,DIKALLR
"RTN","DIK",6,0)
 D CHKS I $D(DIKZ1) N DIKIL S DIKIL=1 G @DIKGP
"RTN","DIK",7,0)
 S X=2 D DD G ^DIK1
"RTN","DIK",8,0)
 ;
"RTN","DIK",9,0)
DD1 D D,A Q
"RTN","DIK",10,0)
 ;
"RTN","DIK",11,0)
DD D DIKJ N DIKCHK S DIKCHK=1,DV=0 D D,A
"RTN","DIK",12,0)
 I $G(DIK(0))["s" S DU=1 Q
"RTN","DIK",13,0)
E S DV=$O(^DD(DH,"SB",DV))
"RTN","DIK",14,0)
 I DV>0 S DU=$O(^(DV,0)) G E:'$D(^DD(DV,.01,0)),E:$P(^(0),U,2)["W" S DW=$P($P(^DD(DH,DU,0),U,4),";") S:+DW'=DW DW=""""_DW_"""" S DV(DH,DU)=DW,DV(DH,DU,0)=DV,DU(DV)=DH D:$D(DIK0) CRT^DIKZ2 G E
"RTN","DIK",15,0)
 Q:$D(DIK0)
"RTN","DIK",16,0)
DH S DH=$O(DU(DH)) G:DH>0 DH:$D(DV(DH)),E
"RTN","DIK",17,0)
 F DH=DH(1):0 S DH=$O(DU(DH)) Q:DH'>0  D D,A
"RTN","DIK",18,0)
DV S DH=0 F  S DH=$O(DV(DH)) Q:'DH  S DU=0 F  S DU=$O(DV(DH,DU)) Q:'DU  I $G(DIKCHK),'$G(DIKCHK(DV(DH,DU,0))) S DV(DH,DU,"NOLOOP")=""
"RTN","DIK",19,0)
 S DU=1
"RTN","DIK",20,0)
 Q
"RTN","DIK",21,0)
 ;
"RTN","DIK",22,0)
DW I $O(^UTILITY("DIK",DIKJ,DH,DV,0))="" K ^UTILITY("DIK",DIKJ,DH,DV)
"RTN","DIK",23,0)
D S DV=$O(^DD(DH,"IX",DV)) Q:DV'>0  I '$D(^DD(DH,DV,0)) K ^DD(DH,"IX",DV) G D
"RTN","DIK",24,0)
 D 0
"RTN","DIK",25,0)
I F DW=0:0 S DW=$O(^DD(DH,DV,1,DW)) Q:DW'>0  I $D(^(DW,X)),"Q"'[^(X),$D(^(0)) S %=^(0) D INX
"RTN","DIK",26,0)
 G DW
"RTN","DIK",27,0)
INX I %["TRIGGER" S %=^(X),^UTILITY("DIK",DIKJ,DH,DV,DW)="D RCR",^(DW,0)=% Q
"RTN","DIK",28,0)
 I %["BULLETIN MESSAGE",$D(DIK(0)),DIK(0)["B" S %=$P("CREA^DELE",U,X)_"TE VALUE" W:$D(^(%)) !,"...('"_^(%)_"' BULLETIN WILL NOT BE TRIGGERED)..." Q
"RTN","DIK",29,0)
 I '$D(DIK0),X=2,$P(%,U),$P(%,U,2)]"",$P(%,U,3)="",+%=DH(1)&$G(DIKALLR)!$D(DU(+%)) D
"RTN","DIK",30,0)
 . S ^UTILITY("DIK",DIKJ,"KW",+%,$P(%,U,2))=DH_U_DV_U_DW
"RTN","DIK",31,0)
 . D CHK($G(DU(+%)),.DU,.DIKCHK)
"RTN","DIK",32,0)
 E  D
"RTN","DIK",33,0)
 . S ^UTILITY("DIK",DIKJ,DH,DV,DW)=^DD(DH,DV,1,DW,X)
"RTN","DIK",34,0)
 . D CHK(DH,.DU,.DIKCHK)
"RTN","DIK",35,0)
 Q
"RTN","DIK",36,0)
CHK(F,DU,DIKCHK) ;Set CHK(f) for file F and its parents
"RTN","DIK",37,0)
 Q:$D(DIK0)!'$G(DIKCHK)
"RTN","DIK",38,0)
 F  Q:'F  Q:$D(DIKCHK(F))  S DIKCHK(F)=1,F=$G(DU(F))
"RTN","DIK",39,0)
 Q
"RTN","DIK",40,0)
A F DV=0:0 S DV=$O(^DD(DH,"AUDIT",DV)) Q:DV'>0  D A1
"RTN","DIK",41,0)
 Q
"RTN","DIK",42,0)
A1 D 0 S ^UTILITY("DIK",DIKJ,DH,DV,99)="S DIIX="_(4-X)_" D:$G(DIK(0))'[""A"" AUDIT" D CHK(DH,.DU,.DIKCHK) Q
"RTN","DIK",43,0)
0 ;
"RTN","DIK",44,0)
 S DW=$P(^DD(DH,DV,0),U,4),^UTILITY("DIK",DIKJ,DH,DV)=$P(DW,";",1),DW=$P(DW,";",2)
"RTN","DIK",45,0)
 S ^UTILITY("DIK",DIKJ,DH,DV,0)=$S(DW:"S X=$P($G(^(X)),U,"_DW_")",1:"S X=$E($G(^(X)),"_+$E(DW,2,9)_","_$P(DW,",",2)_")"),DW=0 Q
"RTN","DIK",46,0)
 ;
"RTN","DIK",47,0)
IX ;
"RTN","DIK",48,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKALLR
"RTN","DIK",49,0)
 D CHKS I $D(DIKZ1) N DIKKS S DIKKS=1 G @DIKGP
"RTN","DIK",50,0)
 S X=2,DIKNM=1 D DD,1^DIK1
"RTN","DIK",51,0)
IX1 ;
"RTN","DIK",52,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKSET,DIKALLR
"RTN","DIK",53,0)
 I '$D(DIKNM) D CHKS I $D(DIKZ1) N DIKST S DIKST=1 G @DIKGP
"RTN","DIK",54,0)
 S X=1,DIKSET=1 D DD,1^DIK1
"RTN","DIK",55,0)
 ;
"RTN","DIK",56,0)
 D INDEX^DIKC(DIK,.DA,"","",$E("K",$D(DIKNM)#2)_"S"_$E("RI",$D(DIFROM)#2+1)_$E("s",$G(DIK(0))["s"))
"RTN","DIK",57,0)
 G Q
"RTN","DIK",58,0)
 ;
"RTN","DIK",59,0)
IX2 ;
"RTN","DIK",60,0)
 Q:$D(@(DIK_"0)"))[0
"RTN","DIK",61,0)
 N DIKJ,DIKS,DIN,DH,DU,DV,DW,DIKDA,DIKALLR
"RTN","DIK",62,0)
 S X=2 D DD,1^DIK1
"RTN","DIK",63,0)
 D INDEX^DIKC(DIK,.DA,"","","K"_$E("RI",$D(DIFROM)#2+1)_$E("s",$G(DIK(0))["s"))
"RTN","DIK",64,0)
 G Q
"RTN","DIK",65,0)
 ;
"RTN","DIK",66,0)
IXALL ;
"RTN","DIK",67,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKSET,DIKALLR
"RTN","DIK",68,0)
 D CHKS I $D(DIKZ1) N DIKSAT S DIKSAT=1,DA=0 G @DIKGP
"RTN","DIK",69,0)
 ;
"RTN","DIK",70,0)
 N DIKDASV,DIKSAVE
"RTN","DIK",71,0)
 M DIKDASV=DA S DIKDASV=0,DIKSAVE=DIK
"RTN","DIK",72,0)
 S (DA,DCNT)=0,X=1,DIKSET=1 D DD,CNT^DIK1
"RTN","DIK",73,0)
 ;
"RTN","DIK",74,0)
 D INDEX^DIKC(DIKSAVE,.DIKDASV,"","","S"_$E("RI",$D(DIFROM)#2+1)_$E("s",$G(DIK(0))["s"))
"RTN","DIK",75,0)
 G Q
"RTN","DIK",76,0)
 ;
"RTN","DIK",77,0)
IXALL2 ;
"RTN","DIK",78,0)
 Q:$D(@(DIK_"0)"))[0
"RTN","DIK",79,0)
 N DIKJ,DIKS,DIN,DH,DU,DV,DW,DIKDA,DIKDASV,DIKSAVE,DIKALLR
"RTN","DIK",80,0)
 M DIKDASV=DA S DIKDASV=0,DIKSAVE=DIK
"RTN","DIK",81,0)
 S DIKALLR=1,(DA,DCNT)=0,X=2 D DD,CNT^DIK1
"RTN","DIK",82,0)
 ;
"RTN","DIK",83,0)
 D INDEX^DIKC(DIKSAVE,.DIKDASV,"","","K"_$E("RI",$D(DIFROM)#2+1)_$E("s",$G(DIK(0))["s"))
"RTN","DIK",84,0)
 G Q
"RTN","DIK",85,0)
 ;
"RTN","DIK",86,0)
EN ;
"RTN","DIK",87,0)
 N DIKCRFIL,DIKCDIK,DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKALLR
"RTN","DIK",88,0)
 D N G:'$D(DH)!'$D(DA) Q
"RTN","DIK",89,0)
 S DIKCRFIL=DH M DIKCDIK=DIK
"RTN","DIK",90,0)
 S DIKNM=1,X=2 D:$D(DIKNX) PR,1^DIK1
"RTN","DIK",91,0)
 ;
"RTN","DIK",92,0)
EN1 ;
"RTN","DIK",93,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKALLR
"RTN","DIK",94,0)
 D @$S('$D(DIKNM):"N",1:"DIKJ") G:'$D(DH)!'$D(DA) Q
"RTN","DIK",95,0)
 I '$D(DIKNM) N DIKCRFIL,DIKCDIK S DIKCRFIL=DH M DIKCDIK=DIK
"RTN","DIK",96,0)
 S X=1 D:$D(DIKNX) PR,1^DIK1
"RTN","DIK",97,0)
 I $D(^DD("IX","AC",DIKCRFIL)) M DIK=DIKCDIK D INDEX^DIKC(DIKCRFIL,.DA,$P(DIK(1),U),$P(DIK(1),U,2,999),$E("K",$D(DIKNM))_"S"_$E("RI",$D(DIFROM)#2+1))
"RTN","DIK",98,0)
 G Q
"RTN","DIK",99,0)
 ;
"RTN","DIK",100,0)
EN2 ;
"RTN","DIK",101,0)
 N DIKCRFIL,DIKCDIK,DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKALLR
"RTN","DIK",102,0)
 D N G:'$D(DH)!'$D(DA) Q
"RTN","DIK",103,0)
 S DIKCRFIL=DH M DIKCDIK=DIK
"RTN","DIK",104,0)
 S X=2 D:$D(DIKNX) PR,1^DIK1
"RTN","DIK",105,0)
 I $D(^DD("IX","AC",DIKCRFIL)) M DIK=DIKCDIK D INDEX^DIKC(DIKCRFIL,.DA,$P(DIK(1),U),$P(DIK(1),U,2,999),"K"_$E("RI",$D(DIFROM)#2+1))
"RTN","DIK",106,0)
 G Q
"RTN","DIK",107,0)
 ;
"RTN","DIK",108,0)
ENALL ;
"RTN","DIK",109,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKXREF,DIKDASV,DIKSAVE,DHSAVE,DIKALLR
"RTN","DIK",110,0)
 D N G:'$D(DH) Q
"RTN","DIK",111,0)
 M DIKDASV=DA,DIKSAVE=DIK,DHSAVE=DH S DIKDASV=0
"RTN","DIK",112,0)
 S (DA,DCNT)=0,X=1 D PR,CNT^DIK1
"RTN","DIK",113,0)
 D:$D(^DD("IX","AC",DHSAVE)) INDEX^DIKC(DHSAVE,.DIKDASV,$P(DIKSAVE(1),U),$P(DIKSAVE(1),U,2,999),"S"_$E("RI",$D(DIFROM)#2+1))
"RTN","DIK",114,0)
 G Q
"RTN","DIK",115,0)
 ;
"RTN","DIK",116,0)
ENALL2 ;
"RTN","DIK",117,0)
 N DIKJ,DIKS,DIKZ1,DIN,DH,DU,DV,DW,DIKDA,DIKXREF,DIKDASV,DIKSAVE,DHSAVE,DIKALLR
"RTN","DIK",118,0)
 D N G:'$D(DH) Q
"RTN","DIK",119,0)
 M DIKDASV=DA,DIKSAVE=DIK,DHSAVE=DH S DIKDASV=0
"RTN","DIK",120,0)
 S DIKALLR=1,(DA,DCNT)=0,X=2 D PR,CNT^DIK1
"RTN","DIK",121,0)
 D:$D(^DD("IX","AC",DHSAVE)) INDEX^DIKC(DHSAVE,.DIKDASV,$P(DIKSAVE(1),U),$P(DIKSAVE(1),U,2,999),"K"_$E("RI",$D(DIFROM)#2+1))
"RTN","DIK",122,0)
 G Q
"RTN","DIK",123,0)
 ;
"RTN","DIK",124,0)
 ;
"RTN","DIK",125,0)
N Q:'$D(DIK)!'$D(DIK(1))!'$D(@(DIK_"0)"))  D DIKJ S DIKND=$P(DIK(1),U)
"RTN","DIK",126,0)
 I '$D(^DD(DH,"IX",DIKND)) K:'$D(^DD("IX","F",DH,DIKND)) DH Q
"RTN","DIK",127,0)
 I $P(DIK(1),U,2)="" D
"RTN","DIK",128,0)
 . S %=0 F A1=1:1 S %=$O(^DD(DH,DIKND,1,%)) Q:'%  S DIKNX(A1)=%
"RTN","DIK",129,0)
 E  F A1=1:1 Q:$P(DIK(1),U,A1+1)=""  S DIKNX(A1)=$P(DIK(1),U,A1+1)
"RTN","DIK",130,0)
 K A1,% Q
"RTN","DIK",131,0)
 ;
"RTN","DIK",132,0)
PR S DV=DIKND I '$D(^DD(DH,"IX",DV)),'$D(^DD(DH,"AUDIT",DV)) Q
"RTN","DIK",133,0)
 D 0 S DIKZ1=1 D CK K DIKZ1
"RTN","DIK",134,0)
 D:$D(^DD(DH,"AUDIT",DV)) A1 S DU=1 Q
"RTN","DIK",135,0)
 ;
"RTN","DIK",136,0)
CK Q:'$D(DIKNX(DIKZ1))
"RTN","DIK",137,0)
 F DW=0:0 S DW=$O(^DD(DH,DV,1,DW)) Q:DW'>0  I $D(^(DW,0)),(DW=DIKNX(DIKZ1))!($P(^(0),U,2)=DIKNX(DIKZ1)),$D(^(X)),"Q"'[^(X) S %=^(0) D INX
"RTN","DIK",138,0)
 S DIKZ1=DIKZ1+1 G CK
"RTN","DIK",139,0)
 ;
"RTN","DIK",140,0)
FREE(X) N V S V=$G(^UTILITY("DIK",X)) I 'V Q 1
"RTN","DIK",141,0)
 Q $H-1>V
"RTN","DIK",142,0)
 ;
"RTN","DIK",143,0)
DIKJ F DIKJ=$J:.01 I $$FREE(DIKJ) K ^UTILITY("DIK",DIKJ) S ^UTILITY("DIK",DIKJ)=$H Q
"RTN","DIK",144,0)
INT K DIKS,DIN,DH,DU,DV,DW S U="^",DH=+$P(@(DIK_"0)"),U,2),DH(1)=DH Q
"RTN","DIK",145,0)
CHKS ;
"RTN","DIK",146,0)
 I $D(@(DIK_"0)"))[0 S DIKZ1=1,DIKGP="Q^DIK1" Q
"RTN","DIK",147,0)
 S DIKZ1=+$P(^(0),"^",2) I DIKZ1,$D(^DD(DIKZ1,0,"DIK")),$$ROUEXIST^DILIBF(^("DIK")) S DIKGP="^"_^DD(DIKZ1,0,"DIK") Q
"RTN","DIK",148,0)
 K DIKZ1 Q
"RTN","DIK",149,0)
 ;
"RTN","DIK",150,0)
Q K DIKND,DIKNX,DIKZ1,DIKNM,DIAU,DIG,DIH,DIV,DIW,%,DH Q
"RTN","DIK1")
0^16^B14750350^B12914189
"RTN","DIK1",1,0)
DIK1 ;SFISC/GFT-ACTUAL INDEXER ;29MAR2009
"RTN","DIK1",2,0)
 ;;22.0;VA FileMan;**1,10,41,146,160**;Mar 30, 1999;Build 21
"RTN","DIK1",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIK1",4,0)
EN N DIC D DI
"RTN","DIK1",5,0)
 D
"RTN","DIK1",6,0)
 . N DIKSV S DIKSV=DIK N DIK,DIKJ,DIFKEP
"RTN","DIK1",7,0)
 . D INDEX^DIKC(DIKSV,.DA,"","","KT")
"RTN","DIK1",8,0)
 D K G Q:'$D(@(DIK_"0)")) ;IF ZERO NODE IS THERE, RE-SET IT
"RTN","DIK1",9,0)
 S Y=^(0),DH=$S($O(^(0))'>0:0,1:$P(Y,U,4)-1),X=$P($P(Y,U,3),U,DH>0) D 3:X=DA
"RTN","DIK1",10,0)
 S ^(0)=$P(Y,U,1,2)_U_X_U_DH
"RTN","DIK1",11,0)
IDENTF I DIK?1"^DD(".NP1",",$G(DA(1)),DIK[DA(1) K ^DD(DA(1),0,"ID",DA),^("W"_DA)
"RTN","DIK1",12,0)
Q K:$G(DIKJ) ^UTILITY("DIK",DIKJ)
"RTN","DIK1",13,0)
 K DB(0),DIKJ,DIKS,DIN,DH,DU,DV,DW,DIKGP Q
"RTN","DIK1",14,0)
 ;
"RTN","DIK1",15,0)
K S X="",Y=1 I $D(DIFKEP(DA))#2,DIK="^DIC(",$D(@(DIK_DA_",0,""GL"")")) S X=^("GL"),Y="^DIC("_DA_","
"RTN","DIK1",16,0)
 I X'=Y K @(DIK_"DA)"),X,Y Q
"RTN","DIK1",17,0)
 S X=DIK_"DA,",DH=@(X_"0)") K ^(0),^("%") S Y="""%""" F  S Y=$O(@(X_Y_")")) Q:$E(Y)'="%"  S Y=""""_Y_"""" K @(X_Y_")")
"RTN","DIK1",18,0)
 S @(X_"0)")=DH K X,Y
"RTN","DIK1",19,0)
 Q
"RTN","DIK1",20,0)
 ;
"RTN","DIK1",21,0)
3 N X1
"RTN","DIK1",22,0)
 S X1=X,X=+$O(^(X1),-1)
"RTN","DIK1",23,0)
 S:X'>0 X=+$O(^(X1))
"RTN","DIK1",24,0)
 Q
"RTN","DIK1",25,0)
 ;
"RTN","DIK1",26,0)
DI S (DIC,DIN)=DIK,DH=DH(DU),DV=1 F  S DV=$O(DA(DV)) Q:DV'>0  S DU=DU+1
"RTN","DIK1",27,0)
DIN S DV=0 F  S DV=$O(^UTILITY("DIK",DIKJ,DH,DV)) Q:DV=""  D R:$G(DIKSET)!(DV-.01)
"RTN","DIK1",28,0)
DVA S DV=$O(DV(DH,DV)) I DV="" Q:$G(DIKSET)  S DV=.01 D R:$D(^UTILITY("DIK",DIKJ,DH,DV)) Q
"RTN","DIK1",29,0)
 S X=DIN_DA_","_DV(DH,DV) I @("'$D("_X_"))") G DVA
"RTN","DIK1",30,0)
 S DU(DU)=DIN,DIN=X_",",DH(DU)=DH,DH=DV(DH,DV,0),DV(DU)=DV,DU=DU+1 F X=DU:-1:1 I $D(DA(X)) S DA(X+1)=DA(X)
"RTN","DIK1",31,0)
 S DA(1)=DA,DA=0
"RTN","DIK1",32,0)
DA I '$D(DV(DH(DU-1),DV,"NOLOOP")) F  S @("DA=$O("_DIN_"DA))") Q:DA'>0  D DIN
"RTN","DIK1",33,0)
 D:$D(^UTILITY("DIK",DIKJ,"KW",DH)) KW(DH)
"RTN","DIK1",34,0)
 S DU=DU-1,DIN=DU(DU),DH=DH(DU),DV=DV(DU),DA=DA(1) K DA(1) F X=2:1 G DVA:'$D(DA(X)) S DA(X-1)=DA(X) K DA(X)
"RTN","DIK1",35,0)
 ;EXECUTE CROSS-REFERENCES
"RTN","DIK1",36,0)
R S X=^UTILITY("DIK",DIKJ,DH,DV),%=^(DV,0) I @("$D("_DIN_DA_",X))[0") Q
"RTN","DIK1",37,0)
 X % Q:X']""  S DIKS=X,DW=0
"RTN","DIK1",38,0)
XEC S DW=$O(^UTILITY("DIK",DIKJ,DH,DV,DW)) Q:DW=""  D NXEC(^(DW)) S X=DIKS G XEC
"RTN","DIK1",39,0)
 ;
"RTN","DIK1",40,0)
NXEC(DICODE) ;New variables and execute programming hook
"RTN","DIK1",41,0)
 I DICODE="D RCR"
"RTN","DIK1",42,0)
 E  I $G(DW)=99,DICODE?.E1" AUDIT"
"RTN","DIK1",43,0)
 E  N DH,DIFKEP,DIK,DIKJ,DIKS,DIKSET,DIN,DU,DV,DW,KW
"RTN","DIK1",44,0)
 X DICODE
"RTN","DIK1",45,0)
 Q
"RTN","DIK1",46,0)
RCR K Y,%RCR F %="DIKS","DIK","DW","DH","DIN","DU","DV","X","KW","DIKSET" S %RCR(%)=""
"RTN","DIK1",47,0)
 S %RCR="RR^DIK1",Y=^UTILITY("DIK",DIKJ,DH,DV,DW,0) G STORLIST^%RCR
"RTN","DIK1",48,0)
 ;
"RTN","DIK1",49,0)
RR X Y Q
"RTN","DIK1",50,0)
 ;
"RTN","DIK1",51,0)
AUDIT N %,%F,%T,%D,DIKF,DIKDA Q:DIIX=3&($D(DIKNM)!$D(DIKKS))  S %=DV N DV S DV=%
"RTN","DIK1",52,0)
 S %F=DH F %=1:1 Q:'$D(^DD(%F,0,"UP"))  S %D=%F,%F=^("UP"),DV(%)=$O(^DD(%F,"SB",%D,0)) S:DV(%)="" DV(%)=-1
"RTN","DIK1",53,0)
 S DIKDA="",DIKF="" F %=%-1:-1:1 S DIKDA=DIKDA_DA(%)_",",DIKF=DIKF_DV(%)_","
"RTN","DIK1",54,0)
 I $D(^DD(DH,DV,"AX")) D NXEC(^("AX")) I '$T Q
"RTN","DIK1",55,0)
 D ADD^DIET S DIAU(DH,DV,DIKDA_DA)="^DIA("_%F_","_+Y_",",^DIA(%F,%D,0)=DIKDA_DA_U_%T_U_DIKF_DV_U_DUZ,^DIA(%F,"B",DIKDA_DA,%D)=""
"RTN","DIK1",56,0)
SET N C S (%F,C)=$P(^DD(DH,DV,0),U,2),Y=X D:Y]"" S^DIQ S @(DIAU(DH,DV,DIKDA_DA)_"DIIX)")=Y S:DIIX=2&($D(DIKNM)!$D(DIKKS)) ^(3)=Y
"RTN","DIK1",57,0)
 K DIAU I %F["P"!(%F["V")!(%F["S") S ^(DIIX+.1)=X_U_%F
"RTN","DIK1",58,0)
 Q
"RTN","DIK1",59,0)
 ;
"RTN","DIK1",60,0)
1 ;
"RTN","DIK1",61,0)
 N DIKLK
"RTN","DIK1",62,0)
 S DIKLK=DIK_DA_")" L +@DIKLK:10 K:'$T DIKLK D DI L:$D(DIKLK) -@DIKLK G Q
"RTN","DIK1",63,0)
 ;
"RTN","DIK1",64,0)
CNT ;
"RTN","DIK1",65,0)
 N DIKLK,DIKLAST S DIKLAST=$S(DA:DA,1:"")
"RTN","DIK1",66,0)
 S DU=$E(DIK,1,$L(DIK)-1),DIKLK=$S(DIK[",":DU_")",1:DU) L +@DIKLK:10 K:'$T DIKLK
"RTN","DIK1",67,0)
C I @("$O("_DIK_"DA))'>0") S $P(@(DIK_"0)"),U,4)=DCNT D:$D(^UTILITY("DIK",DIKJ,"KW",DH(1))) KW(DH(1)) K DCNT L:$D(DIKLK) -@DIKLK G Q ;**DI*22*146
"RTN","DIK1",68,0)
 S DA=$O(^(DA)) G C:$P($G(^(DA,0)),U)']"" S DIKLAST=DA,DU=1,DCNT=DCNT+1 S:DA="" DA=-1 D:(DCNT#100=0)  D DI K DB(0) G C
"RTN","DIK1",69,0)
 .I $D(IO)#2,$D(IO(0))#2,IO=IO(0),IO="" Q
"RTN","DIK1",70,0)
 .I '$D(ZTQUEUED) W "."
"RTN","DIK1",71,0)
 ;
"RTN","DIK1",72,0)
KW(FIL) ;Kill entire regular indexes
"RTN","DIK1",73,0)
 N NAM
"RTN","DIK1",74,0)
 S NAM="" F  S NAM=$O(^UTILITY("DIK",DIKJ,"KW",FIL,NAM)) Q:NAM=""  K @(DIN_""""_NAM_""")")
"RTN","DIK1",75,0)
 Q
"RTN","DINIT21")
0^7^B10881037^B9777646
"RTN","DINIT21",1,0)
DINIT21 ;SFISC/GFT-INITIALIZE VA FILEMAN ;4SEP2009
"RTN","DINIT21",2,0)
 ;;22.0;VA FileMan;**110,160**;Mar 30, 1999;Build 21
"RTN","DINIT21",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DINIT21",4,0)
DINITOSX G DD:'$O(^DD("OS",0)) W !!,"Do you want to change the MUMPS OPERATING SYSTEM File? NO//" R Y:60 Q:Y["^"!("Nn"[$E(Y))!('$T)
"RTN","DINIT21",5,0)
DD F I=1:1 S X=$T(DD+I),Y=$P(X," ",3,99) Q:X?.P  S D="^DD(""OS"","_$E($P(X," ",2),3,99)_")" S @D=Y
"RTN","DINIT21",6,0)
 ;;0 MUMPS OPERATING SYSTEM^.7
"RTN","DINIT21",7,0)
 ;;8,0 MSM^^127^5000^^1^63
"RTN","DINIT21",8,0)
 ;;8,1 B X
"RTN","DINIT21",9,0)
 ;;8,"SDP" O @("DIO:"_DLP) F %=0:0 U DIO R % Q:$ZA=X&($ZB>Y)!($ZA>X)  U IO W:$A(%)'=12 ! W %
"RTN","DINIT21",10,0)
 ;;8,"SDPEND" S X=$ZA,Y=$ZB
"RTN","DINIT21",11,0)
 ;;8,"XY" S $X=IOX,$Y=IOY
"RTN","DINIT21",12,0)
 ;;8,8 X ^DD("$O")
"RTN","DINIT21",13,0)
 ;;8,18 I $D(^ (X))
"RTN","DINIT21",14,0)
 ;;8,"ZS" ZR  X "S %Y=0 F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y=""""  Q:'$D(^(%Y))  ZI ^(%Y)" ZS @X
"RTN","DINIT21",15,0)
 ;;9,0 DTM-PC^^127^5000^^1^115
"RTN","DINIT21",16,0)
 ;;9,1 B X
"RTN","DINIT21",17,0)
 ;;9,8 D:$P($ZVER,"/",2)<4 ^%VARLOG X:$P($ZVER,"/",2)'<4 ^DD("$O")
"RTN","DINIT21",18,0)
 ;;9,18 I $ZRSTATUS(X)'=""
"RTN","DINIT21",19,0)
 ;;9,"SDP" O @("DIO:"_"(""R"":"_$P(DLP,":",2,9)) F %=0:0 U DIO R % Q:$ZIOS=3  U IO W:$A(%)'=12 ! W %
"RTN","DINIT21",20,0)
 ;;9,"SDPEND" Q
"RTN","DINIT21",21,0)
 ;;9,"XY" S $X=IOX,$Y=IOY
"RTN","DINIT21",22,0)
 ;;9,"ZS" S %X="" X "S %Y=0 F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y=""""  Q:'$D(^(%Y))  S %X=%X_$C(10)_^(%Y)" ZS @X:$E(%X,2,999999)
"RTN","DINIT21",23,0)
 ;;16,0 DSM for OpenVMS^^108^5000^^1^63
"RTN","DINIT21",24,0)
 ;;16,1 U @("$I:"_$P("NO",1,'X)_"CENABLE")
"RTN","DINIT21",25,0)
 ;;16,8 D DOLRO^%ZOSV
"RTN","DINIT21",26,0)
 ;;16,18 I $T(^@X)]""
"RTN","DINIT21",27,0)
 ;;16,"SDP" O DIO U DIO:DISCONNECT F %=0:0 U DIO R % Q:%="#$#"  U IO W:$A(%)'=12 ! W %
"RTN","DINIT21",28,0)
 ;;16,"SDPEND" W !,"#$#",! C IO
"RTN","DINIT21",29,0)
 ;;16,"XY" S $X=IOX,$Y=IOY
"RTN","DINIT21",30,0)
 ;;16,"ZS" ZR  X "S %Y=0 F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y=""""  Q:'$D(^(%Y))  ZI ^(%Y)" ZS @X
"RTN","DINIT21",31,0)
 ;;17,0 GT.M(VAX)^^250^15000^^1^250
"RTN","DINIT21",32,0)
 ;;17,1 U @("$I:"_$P("NO",1,'X)_"CENABLE")
"RTN","DINIT21",33,0)
 ;;17,8 X ^DD("$O") ;D DOLRO^%ZOSV
"RTN","DINIT21",34,0)
 ;;17,18 I $L($T(^@X))
"RTN","DINIT21",35,0)
 ;;17,"SDP" O DIO F  U DIO R % Q:%="#$#"  U IO W:$A(%)'=12 ! W %
"RTN","DINIT21",36,0)
 ;;17,"SDPEND" W !,"#$#",! C IO
"RTN","DINIT21",37,0)
 ;;17,"XY" S $X=IOX,$Y=IOY
"RTN","DINIT21",38,0)
 ;;17,"ZS" N %,%I,%F,%S S %I=$I,%F=$P($ZRO,",")_X_".m" O %F:(NEWVERSION) U %F X "S %S=0 F  S %S=$O(^UTILITY($J,0,%S)) Q:%S=""""  Q:'$D(^(%S))  S %=^UTILITY($J,0,%S) I $E(%)'="";"" W %,!" C %F U %I
"RTN","DINIT21",39,0)
 ;;18,0 CACHE/OpenM^^120^15000^^1^63
"RTN","DINIT21",40,0)
 ;;18,1 B X
"RTN","DINIT21",41,0)
 ;;18,8 X ^DD("$O")
"RTN","DINIT21",42,0)
 ;;18,18 I $T(^@X)]""
"RTN","DINIT21",43,0)
 ;;18,"SDP" C DIO O DIO F %=0:0 U DIO R % Q:%="#$#"  U IO W %
"RTN","DINIT21",44,0)
 ;;18,"SDPEND" W !,"#$#",! C IO
"RTN","DINIT21",45,0)
 ;;18,"XY" S $Y=IOY,$X=IOX
"RTN","DINIT21",46,0)
 ;;18,"ZS" ZR  X "S %Y=0 F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y=""""  Q:'$D(^(%Y))  ZI ^(%Y)" ZS @X
"RTN","DINIT21",47,0)
 ;;19,0 GT.M(UNIX)^^250^15000^^1^250
"RTN","DINIT21",48,0)
 ;;19,1 U @("$I:"_$P("NO",1,'X)_"CENABLE")
"RTN","DINIT21",49,0)
 ;;19,8 X ^DD("$O") ;D DOLRO^%ZOSV
"RTN","DINIT21",50,0)
 ;;19,18 I $L($T(^@X))
"RTN","DINIT21",51,0)
 ;;19,"SDP" O DIO F  U DIO R % Q:%="#$#"  U IO W:$A(%)'=12 ! W %
"RTN","DINIT21",52,0)
 ;;19,"SDPEND" W !,"#$#",! C IO
"RTN","DINIT21",53,0)
 ;;19,"XY" S $X=IOX,$Y=IOY
"RTN","DINIT21",54,0)
 ;;19,"ZS" N %,%I,%F,%S S %I=$I,%F=$P($P($P($ZRO,")"),"(",2)," ")_"/"_X_".m" O %F:(NEWVERSION) U %F X "S %S=0 F  S %S=$O(^UTILITY($J,0,%S)) Q:%S=""""  Q:'$D(^(%S))  S %=^UTILITY($J,0,%S) I $E(%)'="";"" W %,!" C %F U %I X "ZLINK X"
"RTN","DINIT21",55,0)
 ;;100,0 OTHER^^40^5000
"RTN","DINIT21",56,0)
 ;;100,1 Q
"RTN","DIPR160")
0^12^B9877265^n/a
"RTN","DIPR160",1,0)
DIPR160 ;O-OIFO/GMB-Change Routine Size ;2/3/2009
"RTN","DIPR160",2,0)
 ;;22.0;VA FileMan;**160**;Mar 30, 1999;Build 21
"RTN","DIPR160",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIPR160",4,0)
ENV ; Environmental Check
"RTN","DIPR160",5,0)
 D BMES^XPDUTL("Perform Environment Check...")
"RTN","DIPR160",6,0)
 D CHKSTOP
"RTN","DIPR160",7,0)
 D BMES^XPDUTL("Finished Environment Check.")
"RTN","DIPR160",8,0)
 Q
"RTN","DIPR160",9,0)
CHKSTOP ;
"RTN","DIPR160",10,0)
  ; Check XPDENV 0 = Loading; 1 = Installing
"RTN","DIPR160",11,0)
 I 'XPDENV Q  ; Loading Distribution - No Check
"RTN","DIPR160",12,0)
 ;
"RTN","DIPR160",13,0)
 ;
"RTN","DIPR160",14,0)
INSCHK ; Do Checks During Install Only
"RTN","DIPR160",15,0)
 W $C(7)
"RTN","DIPR160",16,0)
 D MES^XPDUTL("** Although Queuing is allowed - it is HIGHLY recommended that ALL Users and")
"RTN","DIPR160",17,0)
 D MES^XPDUTL("VISTA Background jobs be STOPPED before installation of this patch.  Failure")
"RTN","DIPR160",18,0)
 D MES^XPDUTL("to do so may result in 'source routine edited' error(s). Edits will be")
"RTN","DIPR160",19,0)
 D MES^XPDUTL("lost and record(s) may be left in an inconsistent state, for example,")
"RTN","DIPR160",20,0)
 D MES^XPDUTL("not all Cross-Referencing completed; which in turn may cause FUTURE")
"RTN","DIPR160",21,0)
 D MES^XPDUTL("VistA/FileMan Hard Errors or corrupted Data. **")
"RTN","DIPR160",22,0)
 ;
"RTN","DIPR160",23,0)
TMCHK ; Check to see if TaskMan is still running
"RTN","DIPR160",24,0)
 S X=$$TM^%ZTLOAD
"RTN","DIPR160",25,0)
 I X,'$D(^%ZTSCH("WAIT")) D
"RTN","DIPR160",26,0)
 . W $C(7)
"RTN","DIPR160",27,0)
 . D BMES^XPDUTL("* Warning TaskMan Has NOT Been Stopped or Placed in a WAIT State!")
"RTN","DIPR160",28,0)
 ;
"RTN","DIPR160",29,0)
LINH ; Check to see if Logons are Inhibited
"RTN","DIPR160",30,0)
 D GETENV^%ZOSV  ; $P(Y,"^",2) = Installing Volume
"RTN","DIPR160",31,0)
 S X=+$G(^%ZIS(14.5,"LOGON",$P(Y,"^",2)))
"RTN","DIPR160",32,0)
 I 'X D
"RTN","DIPR160",33,0)
 . W $C(7)
"RTN","DIPR160",34,0)
 . D BMES^XPDUTL("* Warning Logons are NOT Inhibited!")
"RTN","DIPR160",35,0)
 Q
"RTN","DIPR160",36,0)
POSTINIT ; Post-Init
"RTN","DIPR160",37,0)
 D BMES^XPDUTL("Beginning Post-Installation...")
"RTN","DIPR160",38,0)
 I $$ROUSIZE^DILF=15000 D
"RTN","DIPR160",39,0)
 . D MES^XPDUTL("  Global ^DD(""ROU"") is already set to 15000. No action taken.")
"RTN","DIPR160",40,0)
 E  D
"RTN","DIPR160",41,0)
 . D MES^XPDUTL("  I am changing global ^DD(""ROU"") from "_$$ROUSIZE^DILF_"...")
"RTN","DIPR160",42,0)
 . S ^DD("ROU")=15000
"RTN","DIPR160",43,0)
 . D MES^XPDUTL("                                    ...to "_$$ROUSIZE^DILF)
"RTN","DIPR160",44,0)
 N LINE
"RTN","DIPR160",45,0)
 S LINE=$G(^DD("OS",19,"ZS"))
"RTN","DIPR160",46,0)
 I LINE["$P($P($P(",LINE?.E1"ZLINK X""" D
"RTN","DIPR160",47,0)
 . D BMES^XPDUTL("  The ZSAVE code has already been corrected for UNIX. No action taken.")
"RTN","DIPR160",48,0)
 E  D
"RTN","DIPR160",49,0)
 . D BMES^XPDUTL("  I am changing ^DD(""OS"",19,""ZS"") to correct the ZSAVE code for UNIX.")
"RTN","DIPR160",50,0)
 . S LINE="N %I,%F,%S S %I=$I,%F=$P($P($P($ZRO,"")""),""("",2),"" "")_""/""_X_"".m"" O %F:(NEWVERSION) U %F X ""S %S=0 F  S %S=$O(^UTILITY($J,0,%S)) "
"RTN","DIPR160",51,0)
 . S ^DD("OS",19,"ZS")=LINE_"Q:%S=""""""""  Q:'$D(^(%S))  S %=^UTILITY($J,0,%S) I $E(%)'="""";"""" W %,!"" C %F U %I X ""ZLINK X"""
"RTN","DIPR160",52,0)
 D MES^XPDUTL("Finished Post-Installation.")
"RTN","DIPR160",53,0)
 Q
"RTN","DIPTED")
0^1^B42280045^B30495900
"RTN","DIPTED",1,0)
DIPTED ;SFISC/GFT-EDIT PRINT TEMPLATE ;02/24/2009
"RTN","DIPTED",2,0)
 ;;22.0;VA FileMan;**97,160**;Mar 30, 1999;Build 21
"RTN","DIPTED",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIPTED",4,0)
 ;
"RTN","DIPTED",5,0)
 N DIC,DIPT,DIPTED,DRK,DIPTEDTY,I,J
"RTN","DIPTED",6,0)
 S DIC=.4,DIC(0)="AEQ",DIC("S")="I $P(^(0),U,8)=7!'$P(^(0),U,8)" D ^DIC Q:Y<1
"RTN","DIPTED",7,0)
 K DIC
"RTN","DIPTED",8,0)
 S DIPT=+Y D E
"RTN","DIPTED",9,0)
 D PUT
"RTN","DIPTED",10,0)
K K ^TMP("DIPTED",$J),^UTILITY("DIP2",$J)
"RTN","DIPTED",11,0)
 Q
"RTN","DIPTED",12,0)
 ;
"RTN","DIPTED",13,0)
EDIT(DIPT) ; EDIT PRINT TEMPLATE 'DIPT' VIA VA FILEMAN SCREEN EDITOR
"RTN","DIPTED",14,0)
 N DIPTED,DRK,DIPTEDTY,I,J
"RTN","DIPTED",15,0)
E N DA,D0,DUOUT,DTOUT,DIPTEDER,DIPTH,L,DY,Y,DIPTX,D,C,Q,DIPTROW,DCL,DXS,DNP,DHD,DISH,DV,DJ,DL,DK,DIL
"RTN","DIPTED",16,0)
 X ^%ZOSF("EON")
"RTN","DIPTED",17,0)
 I '$D(^DIPT(DIPT,0)) W !,"NO TEMPLATE SELECTED",! Q
"RTN","DIPTED",18,0)
 S DIPTED="Print",DIPTEDTY=$P(^(0),U,8) I DIPTEDTY=7 S DIPTED="EXPORT FIELDS"
"RTN","DIPTED",19,0)
 S DIPTED=DIPTED_" Template """_$P(^(0),U)_""""
"RTN","DIPTED",20,0)
 D GET("^TMP(""DIPTED"",$J)")
"RTN","DIPTED",21,0)
 S DIPTH="Editing "_DIPTED,DIPTROW=1
"RTN","DIPTED",22,0)
DDW D EDIT^DDW("^TMP(""DIPTED"",$J)","M",DIPTH,"(File "_DRK_")",DIPTROW)
"RTN","DIPTED",23,0)
 K ^UTILITY($J,0),^UTILITY("DIP2",$J),I,J
"RTN","DIPTED",24,0)
 I $D(DTOUT)!$D(DUOUT) K ^TMP("DIPTED",$J) W $C(7),$$EZBLD^DIALOG(8077) Q
"RTN","DIPTED",25,0)
 S (DV,DNP)="",(DIL,DJ)=0,(DL,DXS)=1,DK=DRK,J(0)=DK,I(0)=^DIC(DK,0,"GL")
"RTN","DIPTED",26,0)
 D PROCESS("^TMP(""DIPTED"",$J)")
"RTN","DIPTED",27,0)
 X ^%ZOSF("EON")
"RTN","DIPTED",28,0)
 S DIPTROW=$O(DIPTEDER(0)) I DIPTROW W " ",DIPTEDER(DIPTROW) H 2 S DIPTH="ERROR!  Re-editing "_DIPTED K DIPTEDER G DDW
"RTN","DIPTED",29,0)
 I '$D(^UTILITY("DIP2",$J)) W "<NOTHING TO SAVE>",$C(7) G K
"RTN","DIPTED",30,0)
 S DDSCHG=1
"RTN","DIPTED",31,0)
 I $D(DXS)>9 M ^UTILITY("DIP2",$J,U,"DXS")=DXS
"RTN","DIPTED",32,0)
 M ^UTILITY("DIP2",$J,U,"DCL")=DCL
"RTN","DIPTED",33,0)
 I $D(DNP) S ^UTILITY("DIP2",$J,U,"DNP")=1
"RTN","DIPTED",34,0)
 I $G(DISH) S ^("SUB")=1
"RTN","DIPTED",35,0)
 I $G(DHD)]"" S ^("H")=DHD
"RTN","DIPTED",36,0)
 Q
"RTN","DIPTED",37,0)
 ;
"RTN","DIPTED",38,0)
GET(DIPTA,DIT) ;put displayable template into @DIPTA
"RTN","DIPTED",39,0)
 N DS,DIWD,D9,D0
"RTN","DIPTED",40,0)
 K @DIPTA
"RTN","DIPTED",41,0)
 I '$D(DIT) S DIT=$NA(^DIPT(DIPT)),D0=DIPT
"RTN","DIPTED",42,0)
 E  S D0=-1
"RTN","DIPTED",43,0)
 S (DRK,J(0))=$P(@DIT@(0),U,4),L=0,D(L)="0FIELD",C=",",D9="",Y=2,Q="""",DHD=$G(^("H")),DISH=$D(^("SUB"))
"RTN","DIPTED",44,0)
 F DS(1)=0:0 S DS(1)=$O(@DIT@("F",DS(1))) Q:DS(1)=""  S DY=^(DS(1)) D Y^DIPT
"RTN","DIPTED",45,0)
 D:D9]"" UP^DIPT
"RTN","DIPTED",46,0)
 F D=2:1 Q:'$D(DS(D))  S @DIPTA@(D-1)=$J("",D>2*$G(DIWD(D))*3)_DS(D) ;indentation showing level of subfiles
"RTN","DIPTED",47,0)
 Q
"RTN","DIPTED",48,0)
 ;
"RTN","DIPTED",49,0)
PROCESS(DIPTA) ;puts nodes into ^UTILITY("DIP2")
"RTN","DIPTED",50,0)
 N D0,DM,DQI,DA,ERR,P,S,LINE,X,DIETAB
"RTN","DIPTED",51,0)
 S DIETAB=0
"RTN","DIPTED",52,0)
 F LINE=1:1 Q:'$D(@DIPTA@(LINE))  K ERR S X=^(LINE) D
"RTN","DIPTED",53,0)
 .I X?1"^".E S LINE=999999999 K ^UTILITY("DIP2",$J) Q
"RTN","DIPTED",54,0)
 .S X=$$LINE(X) I X]"" S ^($O(^UTILITY("DIP2",$J,""),-1)+1)=X Q
"RTN","DIPTED",55,0)
 .I $D(ERR) W "LINE ",LINE S DIPTEDER(LINE)=ERR,LINE=-LINE Q  ;stop if we find one error
"RTN","DIPTED",56,0)
 I LINE<0 W " ERROR!" Q
"RTN","DIPTED",57,0)
 Q
"RTN","DIPTED",58,0)
 ;
"RTN","DIPTED",59,0)
LINE(X) ;returns X as component of Template.  DD number is currently 'DK'
"RTN","DIPTED",60,0)
 N DIC,DICMX,DATE,Y,DICOMPX,DICOMP,DP,DJ
"RTN","DIPTED",61,0)
 I X?." " Q ""
"RTN","DIPTED",62,0)
 F P=$L(X):-1:1 Q:$A(X,P)>32  S X=$E(X,1,P-1) ;strip off trailing spaces
"RTN","DIPTED",63,0)
 F P=0:1  Q:$A(X)-32  S X=$E(X,2,999) ;strip off 'P' leading spaces
"RTN","DIPTED",64,0)
 I P<DIETAB,DL>1 F  D U I DL-1*3'>P Q  ;pop Up (MAYBE SEVERAL LEVELS) if we find outdentation
"RTN","DIPTED",65,0)
 S DIETAB=P
"RTN","DIPTED",66,0)
F S (P,S)=""
"RTN","DIPTED",67,0)
LIT I $E(X)="""",$L(X,"""")#2 F I=3:2:$L(X,"""") Q:$P(X,"""",I)]""&($E($P(X,"""",I)'=$C(95)))
"RTN","DIPTED",68,0)
 I  I $P($P(X,"""",I),";")="" G DJ
"RTN","DIPTED",69,0)
 S DIC="^DD(DK,",DIC(0)="ZO"
"RTN","DIPTED",70,0)
DIC I X="NUMBER" S Y=0 G S
"RTN","DIPTED",71,0)
 D ^DIC G GF:Y>0
"RTN","DIPTED",72,0)
 I X="" D U:DL>2 Q X
"RTN","DIPTED",73,0)
STRIP I DIPTEDTY-7 D  G:'$D(D) DIC S X=$RE(X) D  S X=$RE(X) G:'$D(D) DIC ;from beginning, then end
"RTN","DIPTED",74,0)
 .F D="+","#","*","&","!" I $E(X)=D S P=D,X=$E(X,2,999) K D Q
"RTN","DIPTED",75,0)
 I X[";" G EXP:DIPTEDTY=7 S S=";"_$P(X,";",2,99)_S,X=$P(X,";") G DIC
"RTN","DIPTED",76,0)
HARD S DM=X,DQI="DIP(",DA="DXS("_DXS_C,S=S_";Z;"""_X_"""",DICOMP=DIL_$E("?",''L)_"TI",DICOMPX=""
"RTN","DIPTED",77,0)
 I X'?.E1":" S DICMX="X DICMX" D EN^DICOMP G QQ:'$D(X) D FLY^DIP22 S X=S G DJ
"RTN","DIPTED",78,0)
 G EXP:DIPTEDTY=7 S DICMX="S DIXX=DIXX("_DL_") D M" D ^DICOMPW
"RTN","DIPTED",79,0)
 I $D(X) D  S S=U_$P(DP,U,2)_U_$E(1,Y["m")_U_S,DIL(DL)=DIL,DV(DL)=DV,DL(DL)=DK,DK=+DP,DV=DV_-DP_C,DL=DL+1,DIL=+Y,Y=0,X=DV_S K P G VAL3 ;relational jump
"RTN","DIPTED",80,0)
 .N Y D OVFL^DIP22,F^DIP22
"RTN","DIPTED",81,0)
QQ S ERR="" Q ""
"RTN","DIPTED",82,0)
 ;
"RTN","DIPTED",83,0)
GF I $P(Y(0),U,2) D D S X=$P($P(Y(0),U,4),";"),I(DIL)=$S(+X=X:X,1:Q_X_Q),J(DIL)=DK G WORD:$P($G(^DD(DK,.01,0)),U,2)["W" Q "" ;down to a multiple
"RTN","DIPTED",84,0)
 I +Y=.001 S Y=0
"RTN","DIPTED",85,0)
S S X=+Y_S
"RTN","DIPTED",86,0)
DJ S X=DV_X
"RTN","DIPTED",87,0)
VAL3 I DIPTEDTY'=7!(S'[";W"&(S'[";m")) S S="" D P Q X
"RTN","DIPTED",88,0)
EXP S ERR="NOT ALLOWED WHEN SELECTING EXPORT FIELDS" Q ""
"RTN","DIPTED",89,0)
 ;
"RTN","DIPTED",90,0)
P D:$D(P)  Q
"RTN","DIPTED",91,0)
 .I P="" K DNP Q
"RTN","DIPTED",92,0)
 .I P="*" S DCL=$G(DCL)+1
"RTN","DIPTED",93,0)
 .S DCL(DK_U_+Y)=$S($T:DCL_P,1:P)
"RTN","DIPTED",94,0)
 ;
"RTN","DIPTED",95,0)
D S DIL(DL)=DIL,DV(DL)=DV,DL(DL)=DK,DK=+$P(^DD(DK,+Y,0),U,2),DL=DL+1,DIL=DIL+1,DV=DV_+Y_C,Y=0 Q  ;go Down a level
"RTN","DIPTED",96,0)
 ;
"RTN","DIPTED",97,0)
WORD I DIPTEDTY=7 G EXP
"RTN","DIPTED",98,0)
 S Y=.01 D P S X=DV_Y_S D U Q X
"RTN","DIPTED",99,0)
 ;
"RTN","DIPTED",100,0)
U S DL=DL-1,DV=DV(DL),DK=DL(DL),DIL=DIL(DL) F %=DIL:0 S %=$O(I(%)) Q:%=""  K I(%),J(%)
"RTN","DIPTED",101,0)
 Q
"RTN","DIPTED",102,0)
 ;
"RTN","DIPTED",103,0)
SAVEFLDS(Y) ;POST-SAVE OF 'DIPTED' SCREENMAN FORM
"RTN","DIPTED",104,0)
 N DMAX,J,X
"RTN","DIPTED",105,0)
 Q:'$D(^UTILITY("DIP2",$J))!'$G(Y)
"RTN","DIPTED",106,0)
CLEAR S $X=0,$Y=0 I $G(IOXY)]"" N DX,DY S (DY,DX)=0 X IOXY W $C(27,91,74)
"RTN","DIPTED",107,0)
 S Y=$$CLONE(Y) Q:'Y  ;ASK 'SAVE AS'
"RTN","DIPTED",108,0)
 D NOW^%DTC S $P(^DIPT(Y,0),U,2)=+$J(%,0,4)
"RTN","DIPTED",109,0)
 S $P(^DIPT(Y,0),U,5)=$G(DUZ)
"RTN","DIPTED",110,0)
 K ^DIPT(Y,"F") S J="" D  D J
"RTN","DIPTED",111,0)
 .F %=1:1 Q:'$D(^UTILITY("DIP2",$J,%))  S X=^(%) I X]"" D
"RTN","DIPTED",112,0)
 ..I $L(J)+$L(X)>150 D J S J=""
"RTN","DIPTED",113,0)
 ..S J=J_X_$C(126)
"RTN","DIPTED",114,0)
 K ^DIPT(Y,"DXS"),^("DCL"),^("DNP")
"RTN","DIPTED",115,0)
 M ^DIPT(Y)=^UTILITY("DIP2",$J,U)
"RTN","DIPTED",116,0)
 I $D(^DIPT(Y,"ROU")) K ^("ROU") I $D(^("IOM")) S IOM=^("IOM") K ^("IOM") I $D(^("ROUOLD")) S X=^("ROUOLD") I X]"",$G(DISYS),$D(^DD("OS",DISYS,"ZS")) S DMAX=^DD("ROU") D ENZ^DIPZ I $D(^DIPT(DIPZ,"H")) S DHD=^("H")
"RTN","DIPTED",117,0)
 D K
"RTN","DIPTED",118,0)
 Q
"RTN","DIPTED",119,0)
 ;
"RTN","DIPTED",120,0)
J S ^($O(^DIPT(+Y,"F",""),-1)+1)=J Q
"RTN","DIPTED",121,0)
 ;
"RTN","DIPTED",122,0)
CLONE(DA) ;
"RTN","DIPTED",123,0)
 N DIC,DIPTEDTY,DIPTEDFI,X,Y,DIPTEDNM,DDS
"RTN","DIPTED",124,0)
 I '$D(^DIPT(DA,0)) Q 0
"RTN","DIPTED",125,0)
 S (DIPTEDNM,DIC("B"))=$P(^(0),U)
"RTN","DIPTED",126,0)
ASK S DIPTEDFI=$P(^DIPT(DA,0),U,4),DIPTEDTY=$P(^(0),U,8) I 'DIPTEDFI Q 0
"RTN","DIPTED",127,0)
 S DIC=.4,DIC("A")="Save revised Print Template "_DIPTEDNM_" as: ",DIC(0)="AEQL",DIC("S")="I $P(^(0),U,4)=DIPTEDFI,$P(^(0),U,8)=DIPTEDTY"
"RTN","DIPTED",128,0)
 D ^DIC I Y<0 Q 0
"RTN","DIPTED",129,0)
 I +Y=DA Q DA
"RTN","DIPTED",130,0)
 I $O(^DIPT(+Y,0))]"" W !,$C(7),"Are you sure you want to overwrite this '",$P(Y,U,2),"' Template" S %=1 D YN^DICN I %-1 K DIC G ASK:%=2 Q 0
"RTN","DIPTED",131,0)
 L +^DIPT(+Y):5 E  W !,$C(7),"Sorry. Another user is editing this template." Q 0
"RTN","DIPTED",132,0)
 S ^DIPT("F"_DIPTEDFI,$P(Y,U,2),+Y)=1
"RTN","DIPTED",133,0)
 S $P(^DIPT(+Y,0),U,4)=DIPTEDFI,$P(^(0),U,8)=DIPTEDTY
"RTN","DIPTED",134,0)
 L -^DIPT(+Y)
"RTN","DIPTED",135,0)
 Q +Y
"RTN","DIPTED",136,0)
 ;
"RTN","DIPTED",137,0)
 ;
"RTN","DIPTED",138,0)
PUT ;save template from ^UTILITY
"RTN","DIPTED",139,0)
 I '$D(^UTILITY("DIP2",$J)) Q
"RTN","DIPTED",140,0)
 N DIC,DIPZ
"RTN","DIPTED",141,0)
 S DIC("B")=DIPT
"RTN","DIPTED",142,0)
SAVEAS S DIC=.4,DIC("A")="Save revised "_DIPTED_" as: ",DIC(0)="AEQL",DIC("S")="I $P(^(0),U,4)=DRK,$P(^(0),U,8)=DIPTEDTY"
"RTN","DIPTED",143,0)
 D ^DIC
"RTN","DIPTED",144,0)
 Q:Y<0  I $O(^DIPT(+Y,0))]"" W !,$C(7),"Are you sure you want to overwrite this '",$P(Y,U,2),"' Template" S %=1 D YN^DICN I %-1 Q:%<2  K DIC("B") G SAVEAS
"RTN","DIPTED",145,0)
 L +^DIPT(+Y):5 E  W !,$C(7),"Sorry. Another user is editing this template." Q
"RTN","DIPTED",146,0)
 S ^DIPT("F"_J(0),$P(Y,U,2),+Y)=1
"RTN","DIPTED",147,0)
 S $P(^DIPT(+Y,0),U,4)=J(0),$P(^(0),U,8)=DIPTEDTY
"RTN","DIPTED",148,0)
 L -^DIPT(+Y)
"RTN","DIPTED",149,0)
 D SAVEFLDS(+Y)
"RTN","DIPTED",150,0)
 Q
"RTN","DIPZ0")
0^8^B4318484^B4317224
"RTN","DIPZ0",1,0)
DIPZ0 ;SFISC/TKW-COMPILE PRINT TEMPLATES ;4NOV2008
"RTN","DIPZ0",2,0)
 ;;22.0;VA FileMan;**160**;Mar 30, 1999;Build 21
"RTN","DIPZ0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIPZ0",4,0)
 ;
"RTN","DIPZ0",5,0)
SIZ(DITYP) ;PROMPT FOR SIZE OF COMPILED ROUTINE
"RTN","DIPZ0",6,0)
 ;PARAMETER DITYP CONTAINS A NUMBER IN DIALOG FILE POINTING TO EITHER
"RTN","DIPZ0",7,0)
 ;TEXT FOR A TEMPLATE TYPE, OR TO THE TEXT 'CROSS-REFERENCES'.
"RTN","DIPZ0",8,0)
 N %,DIR
"RTN","DIPZ0",9,0)
 S %=$G(^DD("ROU")) S:'% %=$P($G(^DD("OS",DISYS,0)),U,4) S:'% %=5000
"RTN","DIPZ0",10,0)
 S DIR(0)="N^2400:"_%_":0",DIR("B")=%,DIR("A")=$$EZBLD^DIALOG(8027)
"RTN","DIPZ0",11,0)
 K % S %(1)=$$EZBLD^DIALOG(DITYP) D BLD^DIALOG(9002,.%,"","DIR(""?"")")
"RTN","DIPZ0",12,0)
 D ^DIR Q
"RTN","DIPZ0",13,0)
 ;
"RTN","DIPZ0",14,0)
RNM(DITYP) ;PROMPT FOR COMPILED ROUTINE NAME
"RTN","DIPZ0",15,0)
 ;PARAMETER SAME AS FOR SIZ.
"RTN","DIPZ0",16,0)
 N %,DIR,DIRNM
"RTN","DIPZ0",17,0)
 S DIRNM="" D
"RTN","DIPZ0",18,0)
 .I DITYP<8036 S DIRNM=$G(@(DIC_DIPZ_",""ROUOLD"")")),DIRNM(1)=$G(@(DIC_DIPZ_",""ROU"")"))
"RTN","DIPZ0",19,0)
 .E  S DIRNM=$G(@("^DD("_DIPZ_",0,""DIKOLD"")")),DIRNM(1)=$G(@("^DD("_DIPZ_",0,""DIK"")")) S:DIRNM="" DIRNM=DIRNM(1)
"RTN","DIPZ0",20,0)
 .Q
"RTN","DIPZ0",21,0)
 I DIRNM(1)]"" S DIR(0)="Y",DIR("B")="NO" D  D ^DIR K DIR Q:$D(DIRUT)  I Y D UNC Q
"RTN","DIPZ0",22,0)
 .K % S %(1)=$$EZBLD^DIALOG(DITYP),%(2)=DIRNM(1)
"RTN","DIPZ0",23,0)
 .D BLD^DIALOG(8028,.%,"","DIR(""A"")")
"RTN","DIPZ0",24,0)
 .K %(2) D BLD^DIALOG(9004,.%,"","DIR(""?"")")
"RTN","DIPZ0",25,0)
 .Q
"RTN","DIPZ0",26,0)
 S %=7 ;S:DITYP=8036 %=6
"RTN","DIPZ0",27,0)
 S DIR(0)="F^3:"_%_"^K:X'?1U.NU&(X'?1""%""1U.NU)!(X?1""DI"".E) X" S:DIRNM]"" DIR("B")=DIRNM
"RTN","DIPZ0",28,0)
 D BLD^DIALOG(8001,"","","DIR(""A"")"),BLD^DIALOG(9006,%,"","DIR(""?"")")
"RTN","DIPZ0",29,0)
 D ^DIR K DIR Q:$D(DIRUT)!(X="")
"RTN","DIPZ0",30,0)
 I $L(X)>6 D
"RTN","DIPZ0",31,0)
 .N A,% D BLD^DIALOG(8031,"","","A") W $C(7),! F %=0:0 S %=$O(A(%)) Q:'%  W A(%),!
"RTN","DIPZ0",32,0)
 .W ! Q
"RTN","DIPZ0",33,0)
 I $$ROUEXIST^DILIBF(X) K % S %(1)=U_X D BLD^DIALOG(8016,.%,"","DIR") W $C(7),!?5,DIR K DIR
"RTN","DIPZ0",34,0)
 Q
"RTN","DIPZ0",35,0)
UNC ;UNCOMPILE TEMPLATES/CROSS-REFS
"RTN","DIPZ0",36,0)
 N %,DIR I DITYP<8036 K @(DIC_DIPZ_",""ROU"")") D
"RTN","DIPZ0",37,0)
 . I DITYP=8033 D UNCAF^DIEZ(DIPZ)
"RTN","DIPZ0",38,0)
 E  S X=DIPZ D A^DIU21
"RTN","DIPZ0",39,0)
 S %(1)=$$EZBLD^DIALOG(DITYP) D BLD^DIALOG(8026,.%,"","DIR(""A"")")
"RTN","DIPZ0",40,0)
 W $C(7),!!,DIR("A")
"RTN","DIPZ0",41,0)
 S X="" Q
"RTN","DIPZ0",42,0)
 ;
"RTN","DIPZ0",43,0)
 ;DIALOG #8001  'Routine Name'
"RTN","DIPZ0",44,0)
 ;       #8016  'Note that...is already in the routine directory'
"RTN","DIPZ0",45,0)
 ;       #8027  'Maximum routine size on this computer...'
"RTN","DIPZ0",46,0)
 ;       #8028  '...currently compiled under namespace...UNCOMPILE...'
"RTN","DIPZ0",47,0)
 ;       #8031  'WARNING!!  Since the namespace...routine...so long...'
"RTN","DIPZ0",48,0)
 ;       #8033  'Input template'
"RTN","DIPZ0",49,0)
 ;       #8034  'Print Template'
"RTN","DIPZ0",50,0)
 ;       #8036  'Cross-Reference(s)'
"RTN","DIPZ0",51,0)
 ;       #9002  'This number will be used to determine how large...'
"RTN","DIPZ0",52,0)
 ;       #9004  'Answer YES to UNCOMPILE the ...'
"RTN","DIPZ0",53,0)
 ;       #9006  'Enter a valid MUMPS routine name...'
"RTN","DIU0")
0^9^B9844434^B10002829
"RTN","DIU0",1,0)
DIU0 ;SFISC/XAK-EDIT/DELETE A FILE ;12NOV2008
"RTN","DIU0",2,0)
 ;;22.0;VA FileMan;**82,116,76,160**;Mar 30, 1999;Build 21
"RTN","DIU0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIU0",4,0)
DIPZ ;
"RTN","DIU0",5,0)
 D PZ,DIEZ Q
"RTN","DIU0",6,0)
PZ ;Recompile PRINT Template routines
"RTN","DIU0",7,0)
 S DIU2=$G(J(0)) N DIC,C,F,I,J,M,O,Q,S,T,V,W,Y
"RTN","DIU0",8,0)
 F DIU0=0:0 S DIU0=$O(^DIPT("AF",DI,DA,DIU0)) Q:DIU0'>0  K ^(DIU0),^DIPT(DIU0,"ROU") S DMAX=^DD("ROU"),X=^DIPT(DIU0,"ROUOLD"),Y=DIU0,DIU1=DI D EN^DIPZ S DI=DIU1
"RTN","DIU0",9,0)
 S J(0)=DIU2 D DT Q
"RTN","DIU0",10,0)
 ;
"RTN","DIU0",11,0)
IN(DI,DA) ;Recompile INput Templates containing Field DA, File DI
"RTN","DIU0",12,0)
 N J,I D IJ^DIUTL(DI)
"RTN","DIU0",13,0)
DIEZ N DL,DH,DQ,DIE,DIC,DNM,DR,M,T,F,Q,Y
"RTN","DIU0",14,0)
 F DIU0=0:0 S DIU0=$O(^DIE("AF",DI,DA,DIU0)) Q:DIU0'>0  D
"RTN","DIU0",15,0)
 . S X=$G(^DIE(DIU0,"ROUOLD"))
"RTN","DIU0",16,0)
 . I X'?1(1A,1"%").7AN D  I X'?1(1A,1"%").7AN D UNC^DIEZ(DIU0) Q
"RTN","DIU0",17,0)
 .. S X=$P($G(^DIE(DIU0,"ROU")),U,2)
"RTN","DIU0",18,0)
 . K ^DIE("AF",DI,DA,DIU0),^DIE(DIU0,"ROU")
"RTN","DIU0",19,0)
 . S DMAX=^DD("ROU"),Y=DIU0,DIU1=DI
"RTN","DIU0",20,0)
 . D EN^DIEZ S DI=DIU1
"RTN","DIU0",21,0)
DT I $D(^DD(DI,DA)) S:$P($G(^DIC(J(0),"%A")),U,2)-DT ^DD(DI,DA,"DT")=DT
"RTN","DIU0",22,0)
 K DIU0,DIU1,DIU2 W ! Q
"RTN","DIU0",23,0)
 ;
"RTN","DIU0",24,0)
EN ;
"RTN","DIU0",25,0)
 I DIU,DIU(0)["S" G SUB
"RTN","DIU0",26,0)
 I DIU,$D(^DIC(DIU,0,"GL")) S DIU=^("GL")
"RTN","DIU0",27,0)
 G Q:"(,"'[$E($RE(DIU))!DIU S DIK="^DIC(",DG=$G(@(DIU_"0)")),(A,DA)=+$P(DG,U,2) G Q:'A
"RTN","DIU0",28,0)
 N DIKLGLBL I DIU(0)["D" S DIKLGLBL=$$CREF^DILF(DIU)
"RTN","DIU0",29,0)
 D ^DIK G 61
"RTN","DIU0",30,0)
6 ;
"RTN","DIU0",31,0)
 N DIKLGLBL
"RTN","DIU0",32,0)
 S DA=DI,%=$$SCREEN^DIBT("^D SCREENQ^DICATT") Q:%=U  G SCROLL:'%
"RTN","DIU0",33,0)
 G ^DIU20
"RTN","DIU0",34,0)
 ;
"RTN","DIU0",35,0)
SCROLL S DR=".01:10;"_$P(20,U,$S($D(^DIC(200,0)):^(0)["NEW PERSON",$D(^DIC(3,0)):^(0)["USER"!(^(0)["EMPLOY"),1:0))
"RTN","DIU0",36,0)
 S DIE=1,(A,DA)=DI,DIER=1 D  K DIER G N^DIU2:$D(DA)
"RTN","DIU0",37,0)
 .N A D ^DIE
"RTN","DIU0",38,0)
61 ; delete a FILE!
"RTN","DIU0",39,0)
 S DQ(A)=0 K ^DIA(A) I $G(DIKLGLBL)]"" K @DIKLGLBL
"RTN","DIU0",40,0)
63 W:DIU(0)["E" !?3,"Deleting the DATA DICTIONARY..." D KDD^DICATT4
"RTN","DIU0",41,0)
 Q:DIU(0)["S"  G Q:DIU(0)'["T"
"RTN","DIU0",42,0)
 F DIK="^DIE(","^DIPT(","^DIBT(" K @(DIK_"""F""_A)") W:DIU(0)["E" !?3,"Deleting the "_$P(^(0),U)_"S..." S DA=.9 F  S DA=$O(@(DIK_"DA)")) Q:DA'>0  I $D(^(DA,0)) S %=$P(^(0),U,4) I %=""!'$D(^DD(+%)) W:DIU(0)["E" "." D ^DIK
"RTN","DIU0",43,0)
 D FORM^DDSDEL(A,DIU(0)["E")
"RTN","DIU0",44,0)
Q K A,DA,DG,DIK,DQ Q
"RTN","DIU0",45,0)
 ;
"RTN","DIU0",46,0)
SUB G Q:'$D(^DD(DIU,0,"UP")) S DA(1)=^("UP"),DQ(DIU)=0
"RTN","DIU0",47,0)
 I DIU(0)'["D" S A=DA(1) D 63 S A=DIU G SE
"RTN","DIU0",48,0)
 S D0=DIU,S=";",Q=""""
"RTN","DIU0",49,0)
 F I=1:1 Q:'$D(^DD(DIU,0,"UP"))  S A=^("UP"),%=$O(^DD(A,"SB",DIU,0)) Q:%=""  Q:'$D(^DD(A,%,0))#2  S %(I)=$P($P(^(0),U,4),S),DIU=A S:+%(I)'=%(I) %(I)=Q_%(I)_Q I I=1 S (O,M)=^(0)
"RTN","DIU0",50,0)
 S DICL=I-2 F I=1:1:DICL+1 S I(I)=%(DICL-I+2)
"RTN","DIU0",51,0)
 S I(0)=^DIC(DIU,0,"GL") K %
"RTN","DIU0",52,0)
 D
"RTN","DIU0",53,0)
 . N DIU0TOP,DIU0SFIL S DIU0TOP=A,DIU0SFIL=D0
"RTN","DIU0",54,0)
 . N A,DA,D0,DICL,DIU,DQ,I,O,M,S,Q
"RTN","DIU0",55,0)
 . D INDEX^DIKC(DIU0TOP,"","","","KiRW"_DIU0SFIL)
"RTN","DIU0",56,0)
 D 63 S A=D0 D EN^DICATT4
"RTN","DIU0",57,0)
SE S DIK="^DD("_DA(1)_",",DA=$O(^DD(DA(1),"SB",A,0)) D ^DIK:DA
"RTN","DIU0",58,0)
 K D0,DICL,E,I,M,O,Q,S,T,X,Y G Q
"VER")
8^22.0
"BLD",762,6)
^141
**END**
**END**
