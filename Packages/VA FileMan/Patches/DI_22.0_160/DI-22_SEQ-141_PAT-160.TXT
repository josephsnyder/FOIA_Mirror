$TXT Created by BEUSCHEL,GARY at FM22-PATCH.FO-OAKLAND.MED.VA.GOV  (KIDS) on Tuesday, 10/06/09 at 14:48
=============================================================================
Run Date: DEC 23, 2009                     Designation: DI*22*160
Package : DI - VA FILEMAN                     Priority: Mandatory
Version : 22       SEQ #141                     Status: Released
                  Compliance Date: JAN 23, 2010
=============================================================================

Associated patches: (v)DI*22*55    <<= must be installed BEFORE `DI*22*160'
                    (v)DI*22*76    <<= must be installed BEFORE `DI*22*160'
                    (v)DI*22*97    <<= must be installed BEFORE `DI*22*160'
                    (v)DI*22*109   <<= must be installed BEFORE `DI*22*160'
                    (v)DI*22*110   <<= must be installed BEFORE `DI*22*160'
                    (v)DI*22*146   <<= must be installed BEFORE `DI*22*160'

Subject: RESPECT UP-ARROW OUT

Category: 
  - Routine

Description:
============

                           ** Notice: **
 ** See "Installation Instructions" section for Installation Warning **
  
 This patch addresses the following items:
  
 1) Remedy Ticket #283064: This patch fixes the following:
 Select VA FileMan Option: modify File Attributes
 Do you want to use the screen-mode version? YES// ^  <--up-arrow ignored!
 MODIFY WHAT FILE: DEVICE// ^  <--have to up-arrow again!
 (Routine DIBT, DICATT)
  
 2) Change the global, ^DD("ROU"), from 8,000 to 15,000. The SAC standard
 for maximum routine size is now 15,000 bytes. Changing ^DD("ROU") will
 allow input and print templates, as well as cross references, to be
 compiled into fewer routines. The existing FileMan API, $$ROUSIZE^DILF,
 returns the ^DD("ROU") setting.
    If a site so chooses, it may set ^DD("ROU") to any number, as long as
 it conforms to the SAC guidelines, and that setting will be observed as
 the maximum routine size for compilations on that machine.
 (Routines DINIT21, DIPZ0, DIU0, DIPR160)
  
 3) Correct default help prompts to add periods at the ends of sentences
 and to use mixed case. When a user creates a field, FileMan provides a
 default help prompt for several types of fields. Date field prompt is now
 mixed case (was all caps) and has a period at the end. Numeric field prompt
 no longer capitalizes the first letters of "decimal digits", and now has a
 period at the end. Free text field prompt for field created in screen
 mode now has a period at the end. (Free text field prompt for field created
 in roll-and-scroll mode already had period at the end.) 
 (Routines DICATT0, DICATTD1, DICATTD2, DICATTD4)
  
 4) On a VERY heavily loaded system, R+1^DIK1 *may* error with an undefined.
 The fix is to add $G around two global references, which are set in ^DIK.
 (Routine DIK)
  
 5) Remedy Ticket #301406: If the API VAL^DIE is called with an IENS which
 does NOT have a trailing comma, AND the field involved is uneditable, an
 UNDEFINED error occurs. The API now checks for the trailing comma and adds
 it if it is missing.
 (Routine DIEV)
 
 6) If a field is an identifier, and you delete the field from a file's
 data dictionary using the ^DIK API, the field is deleted, but the node
 in the DD, ^DD(file#,0,"ID",field#), which marks the field as an
 identifier, remains. The API now checks for and deletes the identifier
 node. Note - Here is the code to delete a field from a file:
 >S DIK="^DD("_file#_",",DA=field#,DA(1)=file# D ^DIK
 (Routine DIK1)
 
 7) The ZSAVE code in VA FileMan's OS file for Unix needs an update.
 Given a more complex path like this one:
 W $ZRO
 /home/vista/dev/o(/home/vista/dev/r /home/vista/dev/w) /usr/gtm()
 
 The current code (just a fragment), at ^DD("OS",19,"ZS"), gives you this:
 W $P($P($ZRO,")"),"(",2)
 /home/vista/dev/r /home/vista/dev/w
 
 If expanded to this it will work correctly:
 W $P($P($P($ZRO,")"),"(",2)," ")
 /home/vista/dev/r
 
 (Routine DINIT21, DIPR160)
  
 Documentation Changes
 =====================
 The VA FileMan v22.0 Advanced User Manual has been updated to change
 examples showing default help prompts for field types mentioned in item 3.
 
 The most up-to-date VA FileMan end-user documentation is available on the
 VHA Software Document Library (VDL) at the following Internet Website:
     http://www.va.gov/vdl/application.asp?appid=5
 
 NOTE: VistA documentation is made available online in Microsoft Word 
 format (.DOC) and Adobe Acrobat Portable Document Format (.PDF).
 
 The VA FileMan documentation is also available in HTML format at the 
 following Intranet Websites:
 
   * Getting Started Manual:
     http://vaww.vista.med.va.gov/fileman/docs/u1/index.shtml
 
   * Advanced User Manual:
     http://vaww.vista.med.va.gov/fileman/docs/u2/index.shtml
 
   * APIs/Programmer Manual:
     http://vaww.vista.med.va.gov/fileman/docs/pm/index.shtml
 
   * ScreenMan Tutorial:
     http://vaww.vista.med.va.gov/fileman/docs/scrnman/index.shtml
  
 Blood Bank Clearance
 ====================
 Clearance - 2/4/2009
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch DI*22*160 contains
 changes to a package referenced in VHA OI SEPG SOP 192-023 Review of
 VISTA Patches for Effects on VISTA Blood Bank Software. This patch does
 not alter or modify any VistA Blood Bank software design safeguards or
 safety critical elements functions.
  
 RISK ANALYSIS: Changes made by patch DI*22*160 have no effect on Blood
 Bank software functionality, therefore RISK is none.
  
 Remedy Tickets
 ==============
 283064
 301406
  
 Thanks to Test Sites 
 ====================
 Montana HCS
 North Chicago VAMC
 Bay Pines HCS 
  
 Routine Summary: 
 ================
 Please see the "Routine Information" section. 
 *Note: Routine: DIPR160 issues a warning during the installation of 
 this patch if it appears that TaskMan is still running and/or logons have
 not been inhibited.
  
 Installation Instructions:
 =========================
 ** Although queuing of this patch is allowed, it is HIGHLY RECOMMENDED
 that ALL Users be off the system and VISTA Background jobs be STOPPED 
 before this patch is installed. TaskMan should be stopped or placed in
 a wait state. Failure to do so may result in 'source routine edited'
 errors during a database update. Edits may be lost and records may be
 left in an inconsistent state. An error that occurs before a cross-
 reference is executed, for example, may lead to corrupted data or hard
 errors in the future. **
  
 The following installation instructions are based upon the premise that 
 the installer has heeded the above warning.
  
 Installation should take less than a minute.
  
      1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This 
 option will load the KIDS package onto your system.
  
      2.  The patch has now been loaded into a transport global on your 
 system. You now need to use KIDS to install the transport global.
  
      3.  On the KIDS menu, under the 'Installation' menu, use the 
 following options:
  
            Print Transport Global
            Compare Transport Global to Current System
            Verify Checksums in Transport Global
            Backup a Transport Global
  
      4.  In accordance with the warning at the beginning of the 
 installation instructions, make sure ALL interactive processes, and ALL 
 non-interactive background jobs are stopped following your site specific 
 procedures. TaskMan should be stopped or placed in a wait state. All users
 should be off the system. NOT performing this step could result in 'source
 routine edited' error during database updates, and records may be left in
 an inconsistent state.
  
      5.  On the KIDS menu, under the 'Installation' menu, use the 
 following option:
  
            Select Installation Option: Install Package(s)
            Select INSTALL NAME: DI*22.0*160
                                 ===========
  
 The Environment Check Routine DIPR160 runs automatically during this
 step. DIPR160 issues a warning if it appears that TaskMan is still 
 running or logons have not been inhibited. 
  
            Answer 'YES' to 'Want KIDS to INHIBIT LOGONs during the 
 install?'
            Answer 'NO' to 'Want to DISABLE Scheduled Options, Menu 
 Options, and Protocols?
  
 During the Post-Install process, you will see:
  Beginning Post-Installation...
    I am changing global ^DD("ROU") from <original>...
                                    ...to 15000
    I am changing ^DD(""OS"",19,""ZS"") to correct the ZSAVE code for UNIX.
  Finished Post-Installation.
  
      6.  Re-enable all processes stopped in step 4 above.
  
 Post Installation
 =================
 Upon successful installation of this patch, routine DIPR160
 may be deleted.
  
   Example
   =======
 >D ^ZTRDEL
  
 ROUTINE DELETE
  
 All Routines? No => No
  
 Routine: DIPR160
 Routine: 
 1 routine
  
 1 routines to DELETE, OK: NO// Y
 DIPR160  
 Done.
 
 
 

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;22.0;VA FileMan;**[Patch List]**;Mar 30, 1999;Build 21

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DDGF0
    Before: B25027473   After: B25027446  **160**
Routine Name: DIBT
    Before: B23693851   After: B23941529  **82,160**
Routine Name: DICATT
    Before: B12030884   After: B12133640  **7,82,160**
Routine Name: DICATT0
    Before: B10633623   After: B10735912  **160**
Routine Name: DICATTD1
    Before:  B5499736   After:  B5668488  **42,160**
Routine Name: DICATTD2
    Before:  B2653999   After:  B2690922  **42,160**
Routine Name: DICATTD4
    Before:  B1862154   After:  B1867202  **42,160**
Routine Name: DIEV
    Before: B33402331   After: B33978709  **55,160**
Routine Name: DIK
    Before: B37829878   After: B37897212  **41,109,160**
Routine Name: DIK1
    Before: B12914189   After: B14750350  **1,10,41,146,160**
Routine Name: DINIT21
    Before:  B9777646   After: B10881037  **110,160**
Routine Name: DIPR160
    Before:       n/a   After:  B9877265  **160**
Routine Name: DIPTED
    Before: B30495900   After: B42280045  **97,160**
Routine Name: DIPZ0
    Before:  B4317224   After:  B4318484  **160**
Routine Name: DIU0
    Before: B10002829   After:  B9844434  **82,116,76,160**
 
Routine list of preceding patches: 42, 55, 76, 97, 109, 110, 146

=============================================================================
User Information:
Entered By  : BEUSCHEL,GARY                 Date Entered  : JAN 12, 2009
Completed By: SINGH,GURBIR                  Date Completed: DEC 22, 2009
Released By : HARROD,PAUL                   Date Released : DEC 23, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
