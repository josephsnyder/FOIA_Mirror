Released EAS*1*88 SEQ #80
Extracted from mail message
**KIDS**:EAS*1.0*88^

**INSTALL NAME**
EAS*1.0*88
"BLD",7490,0)
EAS*1.0*88^ENROLLMENT APPLICATION SYSTEM^0^3090817^y
"BLD",7490,1,0)
^^2^2^3090811^^
"BLD",7490,1,1,0)
This patch a problem where users are experiencing a COMMAND system error
"BLD",7490,1,2,0)
when working with Long Term Care (LTC) means tests.
"BLD",7490,4,0)
^9.64PA^^
"BLD",7490,6)
2^
"BLD",7490,6.3)
3
"BLD",7490,"KRN",0)
^9.67PA^779.2^20
"BLD",7490,"KRN",.4,0)
.4
"BLD",7490,"KRN",.401,0)
.401
"BLD",7490,"KRN",.402,0)
.402
"BLD",7490,"KRN",.403,0)
.403
"BLD",7490,"KRN",.5,0)
.5
"BLD",7490,"KRN",.84,0)
.84
"BLD",7490,"KRN",3.6,0)
3.6
"BLD",7490,"KRN",3.8,0)
3.8
"BLD",7490,"KRN",9.2,0)
9.2
"BLD",7490,"KRN",9.8,0)
9.8
"BLD",7490,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",7490,"KRN",9.8,"NM",1,0)
EASECMT^^0^B37169032
"BLD",7490,"KRN",9.8,"NM","B","EASECMT",1)

"BLD",7490,"KRN",19,0)
19
"BLD",7490,"KRN",19.1,0)
19.1
"BLD",7490,"KRN",101,0)
101
"BLD",7490,"KRN",409.61,0)
409.61
"BLD",7490,"KRN",771,0)
771
"BLD",7490,"KRN",779.2,0)
779.2
"BLD",7490,"KRN",870,0)
870
"BLD",7490,"KRN",8989.51,0)
8989.51
"BLD",7490,"KRN",8989.52,0)
8989.52
"BLD",7490,"KRN",8994,0)
8994
"BLD",7490,"KRN","B",.4,.4)

"BLD",7490,"KRN","B",.401,.401)

"BLD",7490,"KRN","B",.402,.402)

"BLD",7490,"KRN","B",.403,.403)

"BLD",7490,"KRN","B",.5,.5)

"BLD",7490,"KRN","B",.84,.84)

"BLD",7490,"KRN","B",3.6,3.6)

"BLD",7490,"KRN","B",3.8,3.8)

"BLD",7490,"KRN","B",9.2,9.2)

"BLD",7490,"KRN","B",9.8,9.8)

"BLD",7490,"KRN","B",19,19)

"BLD",7490,"KRN","B",19.1,19.1)

"BLD",7490,"KRN","B",101,101)

"BLD",7490,"KRN","B",409.61,409.61)

"BLD",7490,"KRN","B",771,771)

"BLD",7490,"KRN","B",779.2,779.2)

"BLD",7490,"KRN","B",870,870)

"BLD",7490,"KRN","B",8989.51,8989.51)

"BLD",7490,"KRN","B",8989.52,8989.52)

"BLD",7490,"KRN","B",8994,8994)

"BLD",7490,"QUES",0)
^9.62^^
"BLD",7490,"REQB",0)
^9.611^1^1
"BLD",7490,"REQB",1,0)
EAS*1.0*70^1
"BLD",7490,"REQB","B","EAS*1.0*70",1)

"MBREQ")
0
"PKG",552,-1)
1^1
"PKG",552,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",552,20,0)
^9.402P^1^1
"PKG",552,20,1,0)
2^^EASXDR
"PKG",552,20,1,1)
 
"PKG",552,20,"B",2,1)

"PKG",552,22,0)
^9.49I^1^1
"PKG",552,22,1,0)
1.0^3010315^3010410^66481
"PKG",552,22,1,"PAH",1,0)
88^3090817^1258
"PKG",552,22,1,"PAH",1,1,0)
^^2^2^3090817
"PKG",552,22,1,"PAH",1,1,1,0)
This patch a problem where users are experiencing a COMMAND system error
"PKG",552,22,1,"PAH",1,1,2,0)
when working with Long Term Care (LTC) means tests.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","EASECMT")
0^1^B37169032^B36465428
"RTN","EASECMT",1,0)
EASECMT ;ALB/LBD - Means Test for LTC Co-Pay exemption ; 27 DEC 2001
"RTN","EASECMT",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**7,16,18,70,88**;Mar 15, 2001;Build 3
"RTN","EASECMT",3,0)
 ;
"RTN","EASECMT",4,0)
EN ; This is the entry point for the routine that will find the 
"RTN","EASECMT",5,0)
 ; financial test for a veteran that can be used to check if
"RTN","EASECMT",6,0)
 ; veteran's income is below the threshold and exempt from LTC
"RTN","EASECMT",7,0)
 ; co-payments.  If a financial test is not on file for the veteran
"RTN","EASECMT",8,0)
 ; it can be added through this process.
"RTN","EASECMT",9,0)
 ;  Input --      DFN = Patient IEN
"RTN","EASECMT",10,0)
 ;  Output --     DGEXMPT = 1 (exempt from LTC co-payments)
"RTN","EASECMT",11,0)
 ;                        = 0 or "" (not exempt from LTC co-payments)
"RTN","EASECMT",12,0)
 ;                DGOUT = 1 (user wants to exit from the process) 
"RTN","EASECMT",13,0)
 N DGCMPLT,DGMTI,DGMTDT,DGMTYPT,DGMTACT,DGL,DGCS,DGMSGF,DGREQF,DGDOM,DGDOM1,Y
"RTN","EASECMT",14,0)
 ; Does veteran have current LTC co-pay exemption test (type 4)?
"RTN","EASECMT",15,0)
 S Y=$$GETLTC4(DFN) I Y S DGEXMPT=$S($P(Y,U,3)="EXEMPT":1,1:0) Q
"RTN","EASECMT",16,0)
 ; Does veteran have current means test?
"RTN","EASECMT",17,0)
 S DGL=$$LST^DGMTU(DFN),DGMTI=+DGL,DGMTDT=$P(DGL,U,2),DGCS=$P(DGL,U,4)
"RTN","EASECMT",18,0)
 ; If last means test has status of Cat C or Pend. Adj. and vet agreed
"RTN","EASECMT",19,0)
 ; to pay MT copay, new means test is not required
"RTN","EASECMT",20,0)
 I ((DGCS="C")!(DGCS="P")),$P($G(^DGMT(408.31,DGMTI,0)),U,11)=1,DGMTDT>2991005 S DGEXMPT=0 D LTC4(DGMTI,DGEXMPT) Q
"RTN","EASECMT",21,0)
 ; If means test is required or more than a year old, do new means test
"RTN","EASECMT",22,0)
 I (DGCS="R")!($$OLD^DGMTU4(DGMTDT)) D  Q:$G(DGOUT)!(DGMTYPT=4)
"RTN","EASECMT",23,0)
 .S (DGADDF,DGMSGF)=1 D ^DGMTR S DGMTYPT=$S(DGREQF:1,1:4)
"RTN","EASECMT",24,0)
 .I '$$ASK(DGMTYPT) S DGOUT=1 Q
"RTN","EASECMT",25,0)
 .S DGMTACT="ADD" I DGMTYPT=1,$E(DGMTDT,1,3)=$E(DT,1,3) S DGMTACT="EDT"
"RTN","EASECMT",26,0)
 .D MT(DFN,DGMTYPT,DGMTACT,.DGMTI,.DGCMPLT)
"RTN","EASECMT",27,0)
 .I '$G(DGCMPLT) S DGOUT=1 Q
"RTN","EASECMT",28,0)
 .I DGMTYPT=4 D
"RTN","EASECMT",29,0)
 ..D DOM^DGMTR I '$G(DGDOM1) D COPYRX^DGMTR1(DFN,DGMTI)
"RTN","EASECMT",30,0)
 ..S Y=$$GETCODE^DGMTH($P($G(^DGMT(408.31,DGMTI,0)),U,3)),DGEXMPT=$S(Y=0:1,1:0)
"RTN","EASECMT",31,0)
 ; If no means test or means test is no longer required, check if
"RTN","EASECMT",32,0)
 ; there is an RX co-pay test, otherwise do new LTC co-pay exemption test
"RTN","EASECMT",33,0)
 I DGCS=""!(DGCS="N") D  Q:$G(DGOUT)!($G(DGMTYPT)=4)
"RTN","EASECMT",34,0)
 .S DGL=$$LST^DGMTU(DFN,DT,2),DGMTI=+DGL,DGMTDT=$P(DGL,U,2),DGCS=$P(DGL,U,4)
"RTN","EASECMT",35,0)
 .I DGMTI,'$$OLD^DGMTU4(DGMTDT),("^I^L^")'[("^"_DGCS_"^") Q
"RTN","EASECMT",36,0)
 .S DGMTYPT=4
"RTN","EASECMT",37,0)
 .I '$$ASK(DGMTYPT) S DGOUT=1 Q
"RTN","EASECMT",38,0)
 .D MT(DFN,DGMTYPT,"ADD",.DGMTI,.DGCMPLT)
"RTN","EASECMT",39,0)
 .I '$G(DGCMPLT) S DGOUT=1 Q
"RTN","EASECMT",40,0)
 .D DOM^DGMTR I '$G(DGDOM1) D COPYRX^DGMTR1(DFN,DGMTI)
"RTN","EASECMT",41,0)
 .S Y=$$GETCODE^DGMTH($P($G(^DGMT(408.31,DGMTI,0)),U,3))
"RTN","EASECMT",42,0)
 .S DGEXMPT=$S(Y=0:1,1:0)
"RTN","EASECMT",43,0)
 ; Check if veteran's income is below the pension threshold
"RTN","EASECMT",44,0)
 S DGEXMPT=$$THRES(DFN,DGMTDT)
"RTN","EASECMT",45,0)
 I DGEXMPT<0 W !!,"The income threshold check could not be completed due to an error." S DGOUT=1 Q
"RTN","EASECMT",46,0)
 ; Create LTC co-pay exemption test (type 4) by copying MT
"RTN","EASECMT",47,0)
 D LTC4(DGMTI,DGEXMPT)
"RTN","EASECMT",48,0)
 Q
"RTN","EASECMT",49,0)
 ;
"RTN","EASECMT",50,0)
THRES(DFN,DGMTDT) ; Is veteran's income below the pension threshold
"RTN","EASECMT",51,0)
 ; Input   -  DFN = Patient IEN
"RTN","EASECMT",52,0)
 ;            DGMTDT = Test date
"RTN","EASECMT",53,0)
 ; Output  -   = 1 (Below the threshold)
"RTN","EASECMT",54,0)
 ;             = 0 (Above the threshold)
"RTN","EASECMT",55,0)
 ;             = -1(Error)
"RTN","EASECMT",56,0)
 N DGDC,DGDEP,DGDET,DGERR,DGIN0,DGIN1,DGIN2,DGINI,DGINT,DGINTF,DGIRI
"RTN","EASECMT",57,0)
 N DGNC,DGND,DGNWT,DGNWTF,DGPRI,DGSP,DGVINI,DGVIR0,DGVIRI,DGTHRES
"RTN","EASECMT",58,0)
 N DGLY,DGMTPAR
"RTN","EASECMT",59,0)
 ; Get current single veteran pension threshold amount
"RTN","EASECMT",60,0)
 S DGTHRES=$$THRES^IBARXEU1(DGMTDT,1,0) I '+DGTHRES Q -1
"RTN","EASECMT",61,0)
 ; Calculate veteran's income level and check against the threshold
"RTN","EASECMT",62,0)
 S DGPRI=$O(^DGPR(408.12,"C",DFN_";DPT(",0)) I 'DGPRI Q -1
"RTN","EASECMT",63,0)
 D GETIENS^DGMTU2(DFN,DGPRI,DGMTDT) I '$G(DGIRI),'$G(DGINI) Q -1
"RTN","EASECMT",64,0)
 S DGVIRI=DGIRI,DGVINI=DGINI
"RTN","EASECMT",65,0)
 S DGLY=$$LYR^DGMTSCU1(DGMTDT) D PAR^DGMTSCU
"RTN","EASECMT",66,0)
 D DEP^DGMTSCU2,INC^DGMTSCU3 I '$D(DGINT) Q -1
"RTN","EASECMT",67,0)
 ; If vet declined to provide financial info, return 0 (above threshold)
"RTN","EASECMT",68,0)
 I $P($G(^DGMT(408.31,+$G(DGMTI),0)),U,14) Q 0
"RTN","EASECMT",69,0)
 I (DGINT-DGDET)'>+DGTHRES Q 1
"RTN","EASECMT",70,0)
 Q 0
"RTN","EASECMT",71,0)
 ;
"RTN","EASECMT",72,0)
MT(DFN,TYPE,ACT,DGMTI,DGCMPLT) ; Complete a means test or LTC co-pay exemption test
"RTN","EASECMT",73,0)
 ; Input    -  DFN = Patient IEN
"RTN","EASECMT",74,0)
 ;             TYPE = Type of test (1=MT; 4=LTC4)
"RTN","EASECMT",75,0)
 ;             ACT = Type of action (ADD or EDT)
"RTN","EASECMT",76,0)
 ;             DGMTI = If EDT action, IEN of test to be edited
"RTN","EASECMT",77,0)
 ; Output   -  DGCMPLT = 1 (MT completed)
"RTN","EASECMT",78,0)
 ;                     = 0 (MT not completed)
"RTN","EASECMT",79,0)
 ;             DGMTI = IEN of new test
"RTN","EASECMT",80,0)
 N DGMTYPT,DGMTACT,DGMTROU,DGMT0,DGSTA,TYPESAVE,DGCMPLT
"RTN","EASECMT",81,0)
 S DGCMPLT=0
"RTN","EASECMT",82,0)
 I $$LOCK^DGMTUTL(DFN) E  Q DGCMPLT
"RTN","EASECMT",83,0)
 S DGMTYPT=TYPE,DGMTACT=ACT
"RTN","EASECMT",84,0)
 S TYPESAVE=TYPE ;*GTS - EAS*1*70
"RTN","EASECMT",85,0)
 S DGMTDT=$S(DGMTACT="EDT":+$G(^DGMT(408.31,DGMTI,0)),1:DT) I 'DGMTDT D MT1 Q
"RTN","EASECMT",86,0)
 ;*GTS - EAS*1*70
"RTN","EASECMT",87,0)
 ; If adding a LTC CP Exemption test, TYPE indicates test copied from for ADD^DGMTA
"RTN","EASECMT",88,0)
 I DGMTACT="ADD" S:TYPE=4 TYPE=1 D ADD^DGMTA S TYPE=TYPESAVE I '$G(DGMTI) D MT1 Q
"RTN","EASECMT",89,0)
 S DGMTROU="MT1^EASECMT"
"RTN","EASECMT",90,0)
 G EN^DGMTSC
"RTN","EASECMT",91,0)
MT1 I $G(DGMTI) D
"RTN","EASECMT",92,0)
 .S DGMT0=$G(^DGMT(408.31,DGMTI,0)),DGSTA=$$GETCODE^DGMTH($P(DGMT0,U,3))
"RTN","EASECMT",93,0)
 .I DGSTA'="","ACP01"[DGSTA,$P(DGMT0,U,7)]"" S DGCMPLT=1
"RTN","EASECMT",94,0)
 .I 'DGCMPLT,TYPE=4 D DEL  ;Delete incomplete LTC copay exemption test
"RTN","EASECMT",95,0)
 D UNLOCK^DGMTUTL(DFN)
"RTN","EASECMT",96,0)
 Q
"RTN","EASECMT",97,0)
 ;
"RTN","EASECMT",98,0)
LTC4(DGMT,DGEXMPT) ; Create or update LTC copay exemption test (type 4) by copying
"RTN","EASECMT",99,0)
 ; means test
"RTN","EASECMT",100,0)
 ; Input   -   DGMT = Annual Means Test IEN of test to be copied
"RTN","EASECMT",101,0)
 ;         -   DGEXMPT = LTC copayments exemption status (optional)
"RTN","EASECMT",102,0)
 Q:'DGMT
"RTN","EASECMT",103,0)
 N DGMT0,DGMT2,DA,DIC,DIK,DLAYGO,X,DFN,DGMTI,DGCONVRT
"RTN","EASECMT",104,0)
 N DGMTA,DGMTP,DGMTACT,DGMTINF,DGMTYPT
"RTN","EASECMT",105,0)
 ; Quit if this is a LTC copay exemption test (type 4)
"RTN","EASECMT",106,0)
 S DGMT0=$G(^DGMT(408.31,DGMT,0)) I $P(DGMT0,U,19)=4 Q
"RTN","EASECMT",107,0)
 S DGMT2=$G(^DGMT(408.31,DGMT,2))
"RTN","EASECMT",108,0)
 ; Add a new LTC 4 test or edit an existing LTC 4 test?
"RTN","EASECMT",109,0)
 S DGMTI=$O(^DGMT(408.31,"AT",DGMT,0))
"RTN","EASECMT",110,0)
 S DGMTACT=$S(DGMTI:"EDT",1:"ADD")
"RTN","EASECMT",111,0)
 S DGMTP="" I DGMTACT="EDT" S DGMTP=$G(^DGMT(408.31,DGMTI,0))
"RTN","EASECMT",112,0)
 S DFN=$P(DGMT0,U,2)
"RTN","EASECMT",113,0)
 ; Add new entry to Annual Means Test file (#408.31) for LTC 4 test
"RTN","EASECMT",114,0)
 I DGMTACT="ADD" D  Q:DGMTI'>0
"RTN","EASECMT",115,0)
 .S X=+DGMT0,(DIC,DIK)="^DGMT(408.31,",DIC(0)="L",DLAYGO=408.31
"RTN","EASECMT",116,0)
 .D FILE^DICN S DGMTI=+Y
"RTN","EASECMT",117,0)
 .;*GTS - EAS*1*70
"RTN","EASECMT",118,0)
 .S DGCONVRT=$$VRCHKUP^DGMTU2(4,$P(DGMT0,"^",19),+DGMT0,+DGMT0)
"RTN","EASECMT",119,0)
 .S DATA(2.11)=1
"RTN","EASECMT",120,0)
 F I=.01,.02,.04,.05,.06,.11,.14,.15,.18,.23 S DATA(I)=$P(DGMT0,U,(I/.01))
"RTN","EASECMT",121,0)
 I '$D(DGEXMPT) S DGEXMPT=$$THRES(DFN,$P(DGMT0,U,1))
"RTN","EASECMT",122,0)
 S DATA(.03)=$S(DGEXMPT:15,1:14),DATA(.07)=DT
"RTN","EASECMT",123,0)
 S DATA(.019)=4,DATA(2.02)=$P(DGMT2,U,2),DATA(2.08)=DGMT
"RTN","EASECMT",124,0)
 S DATA(2.05)=$P(DGMT2,U,5)
"RTN","EASECMT",125,0)
 I $$UPD^DGENDBS(408.31,DGMTI,.DATA,.ERROR)
"RTN","EASECMT",126,0)
 K DATA,ERROR
"RTN","EASECMT",127,0)
 ; Update the LTC copay test (type 3), if status changed
"RTN","EASECMT",128,0)
 I DGMTACT="EDT" D UPLTC3(DGMTI)
"RTN","EASECMT",129,0)
 ; Update Audit file and IVM Patient file
"RTN","EASECMT",130,0)
 S DGMTYPT=4,DGMTINF=1 D AFTER^DGMTEVT
"RTN","EASECMT",131,0)
 D EN^DGMTAUD
"RTN","EASECMT",132,0)
 D EN^IVMPMTE
"RTN","EASECMT",133,0)
 Q
"RTN","EASECMT",134,0)
 ;
"RTN","EASECMT",135,0)
ASK(TYPE) ; Does user want to perform MT/LTC4 test now?
"RTN","EASECMT",136,0)
 ; Input   -   TYPE = Type of test, 1: MT; 4: LTC Copay Exemption
"RTN","EASECMT",137,0)
 ; Output  -   Y = 1 (YES)
"RTN","EASECMT",138,0)
 ;               = 0 (NO)
"RTN","EASECMT",139,0)
 N DIR,TST
"RTN","EASECMT",140,0)
 S TST=$S(TYPE=1:"Means Test",1:"LTC Copay Exemption Test")
"RTN","EASECMT",141,0)
 W !!,"The previous year's financial information is not on file for this veteran.",!,"A ",TST," is required."
"RTN","EASECMT",142,0)
 S DIR("A")="Do you wish to complete the "_TST_" at this time"
"RTN","EASECMT",143,0)
 S DIR("B")="NO",DIR(0)="Y"
"RTN","EASECMT",144,0)
 W ! D ^DIR
"RTN","EASECMT",145,0)
 Q +(Y)
"RTN","EASECMT",146,0)
 ;
"RTN","EASECMT",147,0)
GETLTC4(DFN,DGMTDT) ; Return last LTC co-pay exemption test (type 4),
"RTN","EASECMT",148,0)
 ; if less than a year old
"RTN","EASECMT",149,0)
 ; Input   -   DFN = Patient IEN
"RTN","EASECMT",150,0)
 ;             DGMTDT (optional) = Date of test
"RTN","EASECMT",151,0)
 ; Output  -   Y = Annual Means Test IEN^Date of Test^Status Name^
"RTN","EASECMT",152,0)
 ;                    Status Code^Source of Test
"RTN","EASECMT",153,0)
 ;               = "" (no current LTC co-pay exemption test)
"RTN","EASECMT",154,0)
 N Y
"RTN","EASECMT",155,0)
 S Y="" Q:'$G(DFN) Y I '$G(DGMTDT) S DGMTDT=DT
"RTN","EASECMT",156,0)
 S Y=$$LST^DGMTU(DFN,DGMTDT,4) I '(+Y) Q Y
"RTN","EASECMT",157,0)
 I $$OLD^DGMTU4($P(Y,U,2)) S Y=""
"RTN","EASECMT",158,0)
 Q Y
"RTN","EASECMT",159,0)
 ;
"RTN","EASECMT",160,0)
DEL ;Delete incomplete LTC Copay Exemption test (type 4)
"RTN","EASECMT",161,0)
 ; Input   -- DGMTI  LTC Copay Exemption test IEN
"RTN","EASECMT",162,0)
 N DA,DIK,DIE,DR,V
"RTN","EASECMT",163,0)
 Q:'$G(DGMTI)  Q:$P($G(^DGMT(408.31,DGMTI,0)),U,19)'=4
"RTN","EASECMT",164,0)
 ; Delete pointer in Income Relation file (#408.22)
"RTN","EASECMT",165,0)
 I $D(^DGMT(408.22,"AMT",DGMTI)) D
"RTN","EASECMT",166,0)
 .S DIE="^DGMT(408.22,",DR="31///@"
"RTN","EASECMT",167,0)
 .S V=$O(^DGMT(408.22,"AMT",DGMTI,0)) Q:'V
"RTN","EASECMT",168,0)
 .S IR=0 F  S IR=$O(^DGMT(408.22,"AMT",DGMTI,V,IR)) Q:'IR  S DA=$O(^(IR,0)) I DA D ^DIE
"RTN","EASECMT",169,0)
 ; Delete LTC Copay Exemption test from Annual Means Test file (#408.31)
"RTN","EASECMT",170,0)
 S DA=DGMTI,DIK="^DGMT(408.31,"
"RTN","EASECMT",171,0)
 D ^DIK
"RTN","EASECMT",172,0)
 Q
"RTN","EASECMT",173,0)
 ;
"RTN","EASECMT",174,0)
UPLTC3(DGMT4) ;If the status of a LTC Copay Exemption test (type 4) changes,
"RTN","EASECMT",175,0)
 ;update the status of the LTC Copay test (type 3), if necessary
"RTN","EASECMT",176,0)
 ;  Input   -- DGMT4  LTC Copay Exemption test IEN
"RTN","EASECMT",177,0)
 N DGMT3,DGMTS4,DGMTS3,DGS,DATA,ERROR
"RTN","EASECMT",178,0)
 Q:'DGMT4
"RTN","EASECMT",179,0)
 S DGMT3=$O(^DGMT(408.31,"AT",DGMT4,0)) Q:$G(^DGMT(408.31,+DGMT3,0))=""
"RTN","EASECMT",180,0)
 ; Get test status
"RTN","EASECMT",181,0)
 S DGMTS4=$$GETNAME^DGMTH($P(^DGMT(408.31,DGMT4,0),U,3))
"RTN","EASECMT",182,0)
 S DGMTS3=$$GETNAME^DGMTH($P(^DGMT(408.31,DGMT3,0),U,3))
"RTN","EASECMT",183,0)
 ; If test status is the same quit
"RTN","EASECMT",184,0)
 I DGMTS4=DGMTS3 Q
"RTN","EASECMT",185,0)
 ; If LTC copay test (type 3) is Exempt and the Reason for Exemption is
"RTN","EASECMT",186,0)
 ; anything other than 2 (Income Last Year Below Threshold), quit
"RTN","EASECMT",187,0)
 I DGMTS3="EXEMPT",$P($G(^DGMT(408.31,DGMT3,2)),U,7)'=2 Q
"RTN","EASECMT",188,0)
 ; Get IEN of Means Test Status and update LTC copay test
"RTN","EASECMT",189,0)
 S DGS="" F  S DGS=$O(^DG(408.32,"B",DGMTS4,DGS)) Q:'DGS  I $P(^DG(408.32,DGS,0),U,19)=3 Q
"RTN","EASECMT",190,0)
 S DATA(.03)=DGS,DATA(2.07)=$S(DGMTS4="EXEMPT":2,1:"@")
"RTN","EASECMT",191,0)
 I $$UPD^DGENDBS(408.31,DGMT3,.DATA,.ERROR)
"RTN","EASECMT",192,0)
 Q
"VER")
8.0^22.0
"BLD",7490,6)
^80
**END**
**END**
