Released EN*7*89 SEQ #84
Extracted from mail message
**KIDS**:EN*7.0*89^

**INSTALL NAME**
EN*7.0*89
"BLD",7951,0)
EN*7.0*89^ENGINEERING^0^3090526^y
"BLD",7951,1,0)
^^8^8^3090112^
"BLD",7951,1,1,0)
There is a known bug with some of the outputs where assignments are listed
"BLD",7951,1,2,0)
under a person that does not actually have that assignment. These outputs
"BLD",7951,1,3,0)
are searching the assignments for a specific person or equipment item. The
"BLD",7951,1,4,0)
problem is that the utility being used also includes assignments that
"BLD",7951,1,5,0)
partially match the search criteria. For example, a search for active
"BLD",7951,1,6,0)
assignments for a person with internal entry number 100 will also include
"BLD",7951,1,7,0)
any active assignments for other persons whose internal entry number 
"BLD",7951,1,8,0)
starts with 100 such as 1001, 10025 etc.
"BLD",7951,4,0)
^9.64PA^6916.3^1
"BLD",7951,4,6916.3,0)
6916.3
"BLD",7951,4,6916.3,2,0)
^9.641^6916.3^1
"BLD",7951,4,6916.3,2,6916.3,0)
IT ASSIGNMENT  (File-top level)
"BLD",7951,4,6916.3,2,6916.3,1,0)
^9.6411^1^1
"BLD",7951,4,6916.3,2,6916.3,1,1,0)
OWNER
"BLD",7951,4,6916.3,222)
y^n^p^^^^n^^n
"BLD",7951,4,6916.3,224)

"BLD",7951,4,"APDD",6916.3,6916.3)

"BLD",7951,4,"APDD",6916.3,6916.3,1)

"BLD",7951,4,"B",6916.3,6916.3)

"BLD",7951,6)
^83
"BLD",7951,6.3)
20
"BLD",7951,"ABPKG")
n
"BLD",7951,"INID")
^y
"BLD",7951,"INIT")
START^ENTIP89
"BLD",7951,"KRN",0)
^9.67PA^779.2^20
"BLD",7951,"KRN",.4,0)
.4
"BLD",7951,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",.401,0)
.401
"BLD",7951,"KRN",.402,0)
.402
"BLD",7951,"KRN",.403,0)
.403
"BLD",7951,"KRN",.403,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",.5,0)
.5
"BLD",7951,"KRN",.84,0)
.84
"BLD",7951,"KRN",3.6,0)
3.6
"BLD",7951,"KRN",3.6,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",3.8,0)
3.8
"BLD",7951,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",9.2,0)
9.2
"BLD",7951,"KRN",9.8,0)
9.8
"BLD",7951,"KRN",9.8,"NM",0)
^9.68A^12^5
"BLD",7951,"KRN",9.8,"NM",7,0)
ENTIRT^^0^B11562191
"BLD",7951,"KRN",9.8,"NM",8,0)
ENTIRX^^0^B23992664
"BLD",7951,"KRN",9.8,"NM",9,0)
ENTIRC^^0^B17990636
"BLD",7951,"KRN",9.8,"NM",10,0)
ENTIUTL^^0^B50281271
"BLD",7951,"KRN",9.8,"NM",12,0)
ENTIRRH^^0^B78858476
"BLD",7951,"KRN",9.8,"NM","B","ENTIRC",9)

"BLD",7951,"KRN",9.8,"NM","B","ENTIRRH",12)

"BLD",7951,"KRN",9.8,"NM","B","ENTIRT",7)

"BLD",7951,"KRN",9.8,"NM","B","ENTIRX",8)

"BLD",7951,"KRN",9.8,"NM","B","ENTIUTL",10)

"BLD",7951,"KRN",19,0)
19
"BLD",7951,"KRN",19,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",19.1,0)
19.1
"BLD",7951,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",7951,"KRN",101,0)
101
"BLD",7951,"KRN",409.61,0)
409.61
"BLD",7951,"KRN",771,0)
771
"BLD",7951,"KRN",779.2,0)
779.2
"BLD",7951,"KRN",870,0)
870
"BLD",7951,"KRN",8989.51,0)
8989.51
"BLD",7951,"KRN",8989.52,0)
8989.52
"BLD",7951,"KRN",8994,0)
8994
"BLD",7951,"KRN","B",.4,.4)

"BLD",7951,"KRN","B",.401,.401)

"BLD",7951,"KRN","B",.402,.402)

"BLD",7951,"KRN","B",.403,.403)

"BLD",7951,"KRN","B",.5,.5)

"BLD",7951,"KRN","B",.84,.84)

"BLD",7951,"KRN","B",3.6,3.6)

"BLD",7951,"KRN","B",3.8,3.8)

"BLD",7951,"KRN","B",9.2,9.2)

"BLD",7951,"KRN","B",9.8,9.8)

"BLD",7951,"KRN","B",19,19)

"BLD",7951,"KRN","B",19.1,19.1)

"BLD",7951,"KRN","B",101,101)

"BLD",7951,"KRN","B",409.61,409.61)

"BLD",7951,"KRN","B",771,771)

"BLD",7951,"KRN","B",779.2,779.2)

"BLD",7951,"KRN","B",870,870)

"BLD",7951,"KRN","B",8989.51,8989.51)

"BLD",7951,"KRN","B",8989.52,8989.52)

"BLD",7951,"KRN","B",8994,8994)

"BLD",7951,"QDEF")
^^^^^^^^^^
"BLD",7951,"QUES",0)
^9.62^^
"BLD",7951,"REQB",0)
^9.611^1^1
"BLD",7951,"REQB",1,0)
EN*7.0*87^2
"BLD",7951,"REQB","B","EN*7.0*87",1)

"FIA",6916.3)
IT ASSIGNMENT
"FIA",6916.3,0)
^ENG(6916.3,
"FIA",6916.3,0,0)
6916.3PI
"FIA",6916.3,0,1)
y^n^p^^^^n^^n
"FIA",6916.3,0,10)

"FIA",6916.3,0,11)

"FIA",6916.3,0,"RLRO")

"FIA",6916.3,0,"VR")
7.0^EN
"FIA",6916.3,6916.3)
1
"FIA",6916.3,6916.3,1)

"INIT")
START^ENTIP89
"IX",6916.3,6916.3,"AOA",0)
6916.3^AOA^Owner's IT equipment with active assignment.^R^^R^IR^I^6916.3^^^^^S
"IX",6916.3,6916.3,"AOA",.1,0)
^^3^3^3071120^
"IX",6916.3,6916.3,"AOA",.1,1,0)
Cross-reference by owner and equipment of active assignments.  An
"IX",6916.3,6916.3,"AOA",.1,2,0)
assignment is considered active if it does not have a value in the ENDED
"IX",6916.3,6916.3,"AOA",.1,3,0)
DATE/TIME field.
"IX",6916.3,6916.3,"AOA",1)
S ^ENG(6916.3,"AOA",X(1),X(2),DA)=""
"IX",6916.3,6916.3,"AOA",1.4)
S X=$S(X(3)="":1,1:0)
"IX",6916.3,6916.3,"AOA",2)
K ^ENG(6916.3,"AOA",X(1),X(2),DA)
"IX",6916.3,6916.3,"AOA",2.5)
K ^ENG(6916.3,"AOA")
"IX",6916.3,6916.3,"AOA",11.1,0)
^.114IA^3^3
"IX",6916.3,6916.3,"AOA",11.1,1,0)
1^F^6916.3^1^^1^F
"IX",6916.3,6916.3,"AOA",11.1,2,0)
2^F^6916.3^.01^^2^F
"IX",6916.3,6916.3,"AOA",11.1,3,0)
3^F^6916.3^7^^^F
"IX",6916.3,6916.3,"AOA2",0)
6916.3^AOA2^Owner's IT equipment with active assignment.^R^^R^IR^I^6916.3^^^^^S
"IX",6916.3,6916.3,"AOA2",.1,0)
^^3^3^3090109^
"IX",6916.3,6916.3,"AOA2",.1,1,0)
Cross-reference by owner of active assignments.  An assignment is 
"IX",6916.3,6916.3,"AOA2",.1,2,0)
considered active if it does not have a value in the ENDED DATE/TIME 
"IX",6916.3,6916.3,"AOA2",.1,3,0)
field.
"IX",6916.3,6916.3,"AOA2",1)
S ^ENG(6916.3,"AOA2",X(1),DA)=""
"IX",6916.3,6916.3,"AOA2",1.4)
S X=$S(X(2)="":1,1:0)
"IX",6916.3,6916.3,"AOA2",2)
K ^ENG(6916.3,"AOA2",X(1),DA)
"IX",6916.3,6916.3,"AOA2",2.5)
K ^ENG(6916.3,"AOA2")
"IX",6916.3,6916.3,"AOA2",11.1,0)
^.114IA^2^2
"IX",6916.3,6916.3,"AOA2",11.1,1,0)
1^F^6916.3^1^^1^F
"IX",6916.3,6916.3,"AOA2",11.1,1,3)

"IX",6916.3,6916.3,"AOA2",11.1,2,0)
2^F^6916.3^7^^^F
"IX",6916.3,6916.3,"AOA2",11.1,2,3)

"IX",6916.3,6916.3,"AOU",0)
6916.3^AOU^Owner with unsigned active assignment.^R^^R^IR^I^6916.3^^^^^S
"IX",6916.3,6916.3,"AOU",.1,0)
^^5^5^3071218^
"IX",6916.3,6916.3,"AOU",.1,1,0)
Cross-reference by owner of active assignments that have not been
"IX",6916.3,6916.3,"AOU",.1,2,0)
certified or electronically signed. An assignment is considered active if
"IX",6916.3,6916.3,"AOU",.1,3,0)
it does not have a value in the ENDED DATE/TIME field.  An assignment is
"IX",6916.3,6916.3,"AOU",.1,4,0)
considered as not signed or certified if it does not have a value in the
"IX",6916.3,6916.3,"AOU",.1,5,0)
SIGNED DATE/TIME field.
"IX",6916.3,6916.3,"AOU",1)
S ^ENG(6916.3,"AOU",X(1),DA)=""
"IX",6916.3,6916.3,"AOU",1.4)
S X=$S(X(2)=""&(X(3)=""):1,1:0)
"IX",6916.3,6916.3,"AOU",2)
K ^ENG(6916.3,"AOU",X(1),DA)
"IX",6916.3,6916.3,"AOU",2.5)
K ^ENG(6916.3,"AOU")
"IX",6916.3,6916.3,"AOU",11.1,0)
^.114IA^3^3
"IX",6916.3,6916.3,"AOU",11.1,1,0)
1^F^6916.3^1^^1^F
"IX",6916.3,6916.3,"AOU",11.1,1,3)

"IX",6916.3,6916.3,"AOU",11.1,2,0)
2^F^6916.3^7^^^F
"IX",6916.3,6916.3,"AOU",11.1,2,3)

"IX",6916.3,6916.3,"AOU",11.1,3,0)
3^F^6916.3^4^^^F
"IX",6916.3,6916.3,"AOU",11.1,3,3)

"MBREQ")
0
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
89^3090526
"PKG",33,22,1,"PAH",1,1,0)
^^8^8^3090526
"PKG",33,22,1,"PAH",1,1,1,0)
There is a known bug with some of the outputs where assignments are listed
"PKG",33,22,1,"PAH",1,1,2,0)
under a person that does not actually have that assignment. These outputs
"PKG",33,22,1,"PAH",1,1,3,0)
are searching the assignments for a specific person or equipment item. The
"PKG",33,22,1,"PAH",1,1,4,0)
problem is that the utility being used also includes assignments that
"PKG",33,22,1,"PAH",1,1,5,0)
partially match the search criteria. For example, a search for active
"PKG",33,22,1,"PAH",1,1,6,0)
assignments for a person with internal entry number 100 will also include
"PKG",33,22,1,"PAH",1,1,7,0)
any active assignments for other persons whose internal entry number 
"PKG",33,22,1,"PAH",1,1,8,0)
starts with 100 such as 1001, 10025 etc.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","ENTIP89")
0^^B462537^n/a
"RTN","ENTIP89",1,0)
ENTIP89 ;ALB/CXW - EN*7*89 POST INIT
"RTN","ENTIP89",2,0)
 ;;7.0;ENGINEERING;**89**;Aug 17, 1993;Build 20
"RTN","ENTIP89",3,0)
 ;;
"RTN","ENTIP89",4,0)
 ;This post-init routine is to index field #1 of file #6916.3.
"RTN","ENTIP89",5,0)
START ;
"RTN","ENTIP89",6,0)
 D BMES^XPDUTL("Indexing ""AOA2"" x-ref in Owner field #1 of file 6916.3")
"RTN","ENTIP89",7,0)
 N U,DIK S U="^"
"RTN","ENTIP89",8,0)
 S DIK="^ENG(6916.3,"
"RTN","ENTIP89",9,0)
 S DIK(1)="1^AOA2"
"RTN","ENTIP89",10,0)
 D ENALL^DIK
"RTN","ENTIP89",11,0)
 ;
"RTN","ENTIP89",12,0)
 D BMES^XPDUTL("Post-init process is complete.")
"RTN","ENTIP89",13,0)
 Q
"RTN","ENTIRC")
0^9^B17990636^B17968863
"RTN","ENTIRC",1,0)
ENTIRC ;WOIFO/LKG - Certify IT Acceptance ;2/5/08  14:48
"RTN","ENTIRC",2,0)
 ;;7.0;ENGINEERING;**87,89**;Aug 17, 1993;Build 20
"RTN","ENTIRC",3,0)
IN ;Entry point
"RTN","ENTIRC",4,0)
 N D,DIC,DTOUT,DUOUT,DIRUT,DIROUT,DIR,ENDA,ENDAC,ENNAME,ENI,ENJ,ENDATE,ENCNT,ENX,ENZ,X,X1,Y,L,DIC,FLDS,FR,TO,BY,IOP,DHD
"RTN","ENTIRC",5,0)
LOOPST ;
"RTN","ENTIRC",6,0)
 S:'$G(DT) DT=$$DT^XLFDT()
"RTN","ENTIRC",7,0)
 K D,DIC S DIC=200,DIC(0)="AEMQ",DIC("S")="I $D(^ENG(6916.3,""AOA"",Y))"
"RTN","ENTIRC",8,0)
 D ^DIC K DIC I $D(DTOUT)!$D(DUOUT)!(Y<1) G EX
"RTN","ENTIRC",9,0)
 S ENDA=+Y,ENNAME=$P(Y,U,2)
"RTN","ENTIRC",10,0)
 K D,^TMP($J,"ENITRC"),ENERR
"RTN","ENTIRC",11,0)
 D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AOA2","I $P(^(0),U,8)="""",$S($P(^(0),U,5)="""":1,$$FMDIFF^XLFDT(DT,$P(^(0),U,5))>359:1,1:0)","","^TMP($J,""ENITRC"")","ENERR")
"RTN","ENTIRC",12,0)
 I $P($G(^TMP($J,"ENITRC","DILIST",0)),U)'>0 W !!,"There are no unaccepted IT responsibilities to be certified." K DIR S DIR(0)="E" D ^DIR K DIR K ^TMP($J,"ENITRC") G EX:'Y,LOOPST
"RTN","ENTIRC",13,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX"),ENACL W !
"RTN","ENTIRC",14,0)
 S ^TMP($J,"SCR")=$P(^TMP($J,"ENITRC","DILIST",0),U)_"^IT RESPONSIBILITIES TO CERTIFY FOR "_ENNAME
"RTN","ENTIRC",15,0)
 S ^TMP($J,"SCR",0)="5;9;ENTRY #^15;20;MFG EQUIP NAME^37;25;MODEL^65;14;SERIAL#"
"RTN","ENTIRC",16,0)
 S ENI=0
"RTN","ENTIRC",17,0)
 F  S ENI=$O(^TMP($J,"ENITRC","DILIST",ENI)) Q:+ENI'>0  D
"RTN","ENTIRC",18,0)
 . N ENX,END,ENERR S ENX=$G(^TMP($J,"ENITRC","DILIST",ENI,0))
"RTN","ENTIRC",19,0)
 . S ENDAC=$P(ENX,U,2)_"," D GETS^DIQ(6914,ENDAC,"3;4;5","E","END","ENERR")
"RTN","ENTIRC",20,0)
 . S ^TMP($J,"SCR",ENI)=$P(ENX,U,2)_U_$E($G(END(6914,ENDAC,3,"E")),1,20)_U_$G(END(6914,ENDAC,4,"E"))_U_$G(END(6914,ENDAC,5,"E"))
"RTN","ENTIRC",21,0)
 . S ^TMP($J,"INDX",ENI)=$P(ENX,U)
"RTN","ENTIRC",22,0)
 K ^TMP($J,"ENITRC")
"RTN","ENTIRC",23,0)
 D EN2^ENPLS2(1) G:'$D(ENACL) EX
"RTN","ENTIRC",24,0)
 K DIR S DIR(0)="Y",DIR("A")="OK to continue",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRC",25,0)
 G:'Y!$D(DIRUT) EX
"RTN","ENTIRC",26,0)
 S ENDA=$O(^ENG(6916.2,"@"),-1)
"RTN","ENTIRC",27,0)
 I '$$CMP^XUSESIG1($P($G(^ENG(6916.2,ENDA,0)),U,3),$NAME(^ENG(6916.2,ENDA,1))) W !!,"Hand receipt text is corrupted - Please contact EPS AEMS/MERS support" G EX
"RTN","ENTIRC",28,0)
 K L,DIC,FLDS,FR,TO,BY,IOP,DHD
"RTN","ENTIRC",29,0)
 S L=0,DIC=6916.2,FLDS=1,FR=ENDA,TO=ENDA,BY="@NUMBER",IOP="HOME",DHD="@"
"RTN","ENTIRC",30,0)
 D EN1^DIP K DIR S DIR(0)="Y",DIR("A")="Is this the text on the signed, printed hand receipt",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRC",31,0)
 G:$D(DIRUT) EX I 'Y W !!,"Signed copy is not current.",!?5,"Please ask person to sign current version of hand receipt." K DIR S DIR(0)="E" D ^DIR K DIR G EX
"RTN","ENTIRC",32,0)
 K L,DIC,FLDS,FR,TO,BY,IOP,DHD
"RTN","ENTIRC",33,0)
 K DIR S DIR(0)="D^"_$$BEGDATE()_":"_DT_":EX",DIR("A")="Date person signed hard copy hand receipt" D ^DIR K DIR
"RTN","ENTIRC",34,0)
 I 'Y!$D(DIRUT) W !!,"Certification Aborted." G EX
"RTN","ENTIRC",35,0)
 S ENDATE=Y
"RTN","ENTIRC",36,0)
 K DIR S DIR(0)="Y",DIR("A")="OK to certify",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRC",37,0)
 G:'Y!$D(DIRUT) EX
"RTN","ENTIRC",38,0)
 D SIG^XUSESIG I X1="" W !,"<Failed Electronic Signature> Certification Aborted." G EX
"RTN","ENTIRC",39,0)
 S ENCNT=0,ENX=""
"RTN","ENTIRC",40,0)
 F  S ENX=$O(ENACL(ENX)) Q:ENX=""  D
"RTN","ENTIRC",41,0)
 . N ENXSTR S ENXSTR=$G(ENACL(ENX)) Q:ENXSTR=""
"RTN","ENTIRC",42,0)
 . I $L(ENXSTR,",")>0 D
"RTN","ENTIRC",43,0)
 . . F ENJ=1:1 S ENI=$P(ENXSTR,",",ENJ) Q:+ENI'>0  D
"RTN","ENTIRC",44,0)
 . . . S ENDA=^TMP($J,"INDX",ENI) L +^ENG(6916.3,ENDA):$S($G(DILOCKTM)>5:DILOCKTM,1:5) E  D MSG^ENTIRT(ENDA,"Certification") Q
"RTN","ENTIRC",45,0)
 . . . S ENZ=$$CERT^ENTIUTL1(ENDA,ENDATE)
"RTN","ENTIRC",46,0)
 . . . S:ENZ ENCNT=ENCNT+1 D:'ENZ MSG2(ENDA)
"RTN","ENTIRC",47,0)
 . . . L -^ENG(6916.3,ENDA)
"RTN","ENTIRC",48,0)
 W !!,ENCNT," assignment records were certified."
"RTN","ENTIRC",49,0)
 K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","ENTIRC",50,0)
 G:Y LOOPST
"RTN","ENTIRC",51,0)
EX ;
"RTN","ENTIRC",52,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX"),ENACL
"RTN","ENTIRC",53,0)
 Q
"RTN","ENTIRC",54,0)
MSG2(ENDA) ;error message on certification failure
"RTN","ENTIRC",55,0)
 N END,ENERR,ENDAC S ENDAC=ENDA_","
"RTN","ENTIRC",56,0)
 D GETS^DIQ(6916.3,ENDAC,".01;1","E","END","ENERR")
"RTN","ENTIRC",57,0)
 W !,"Assignment Equip Entry# ",$G(END(6916.3,ENDAC,.01,"E"))," for ",$G(END(6916.3,ENDAC,1,"E"))," is not active ",!?5,"and was not certified."
"RTN","ENTIRC",58,0)
 Q
"RTN","ENTIRC",59,0)
BEGDATE() ;Earliest date for certification
"RTN","ENTIRC",60,0)
 N ENDA,ENDATE,ENI,ENJ,ENASGNDT,ENX,ENXSTR
"RTN","ENTIRC",61,0)
 S ENX="",ENDATE=$$FMADD^XLFDT(DT,-359)
"RTN","ENTIRC",62,0)
 F  S ENX=$O(ENACL(ENX)) Q:ENX=""  D
"RTN","ENTIRC",63,0)
 . S ENXSTR=$G(ENACL(ENX)) Q:ENXSTR=""
"RTN","ENTIRC",64,0)
 . I $L(ENXSTR,",")>0 D
"RTN","ENTIRC",65,0)
 . . F ENJ=1:1 S ENI=$P(ENXSTR,",",ENJ) Q:+ENI'>0  D
"RTN","ENTIRC",66,0)
 . . . S ENDA=^TMP($J,"INDX",ENI),ENASGNDT=$P($P($G(^ENG(6916.3,ENDA,0)),U,3),".")
"RTN","ENTIRC",67,0)
 . . . S:ENASGNDT>ENDATE ENDATE=ENASGNDT
"RTN","ENTIRC",68,0)
 Q ENDATE
"RTN","ENTIRC",69,0)
 ;
"RTN","ENTIRC",70,0)
 ;ENTIRC
"RTN","ENTIRRH")
0^12^B78858476^B78760523
"RTN","ENTIRRH",1,0)
ENTIRRH ;WOIFO/LKG - Print hand receipt ;3/19/08  15:48
"RTN","ENTIRRH",2,0)
 ;;7.0;ENGINEERING;**87,89**;Aug 17, 1993;Build 20
"RTN","ENTIRRH",3,0)
ASK ;Main entry point
"RTN","ENTIRRH",4,0)
 N ENOPT D OP^XQCHK S ENOPT=$P(XQOPT,U)
"RTN","ENTIRRH",5,0)
 K DIR S DIR(0)="S^D:DATE OF SIGNATURE;S:SIGNED;U:UNSIGNED",DIR("A")="Print Hand Receipt for Unsigned or Signed IT assignments",DIR("B")="UNSIGNED"
"RTN","ENTIRRH",6,0)
 S DIR("?",1)="'D' selects assignments signed electronically or via wet signature on a"
"RTN","ENTIRRH",7,0)
 S DIR("?",2)="      given date, regardless of current status."
"RTN","ENTIRRH",8,0)
 S DIR("?",3)="'S' selects active assignments signed electronically or via wet signature."
"RTN","ENTIRRH",9,0)
 S DIR("?",4)="'U' selects active assignments not signed, either electronically or via wet"
"RTN","ENTIRRH",10,0)
 S DIR("?",5)="      signature or signed documents where the signature date is more than"
"RTN","ENTIRRH",11,0)
 S DIR("?")="      359 days ago.  Assignments must be re-signed annually."
"RTN","ENTIRRH",12,0)
 D ^DIR K DIR I $D(DIRUT) K DIRUT,DIROUT,DTOUT,DUOUT Q
"RTN","ENTIRRH",13,0)
 G:Y="D" USER^ENTIRRH1:ENOPT="ENIT PRINT HAND RCPT (COM)",ITST2^ENTIRRH1:ENOPT="ENIT PRINT HAND RCPT (IT)"
"RTN","ENTIRRH",14,0)
 G:Y="U" USTART:ENOPT="ENIT PRINT HAND RCPT (COM)",ITSTART:ENOPT="ENIT PRINT HAND RCPT (IT)"
"RTN","ENTIRRH",15,0)
 G:Y="S" USER:ENOPT="ENIT PRINT HAND RCPT (COM)",ITST2:ENOPT="ENIT PRINT HAND RCPT (IT)"
"RTN","ENTIRRH",16,0)
 W !,"UNKNOWN" Q
"RTN","ENTIRRH",17,0)
ITSTART ;Entry point for IT
"RTN","ENTIRRH",18,0)
 N ENDA,ENVR S ENVR=$O(^ENG(6916.2,"@"),-1) I ENVR'>0 W !,"There are no hand receipt templates on file." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",19,0)
 N DIC,DTOUT,DUOUT S DIC=200,DIC(0)="AEMQ",DIC("A")="IT Responsible Person: ",DIC("S")="I $D(^ENG(6916.3,""AOA"",Y))"
"RTN","ENTIRRH",20,0)
 D ^DIC I Y<1!$D(DTOUT)!$D(DUOUT) Q
"RTN","ENTIRRH",21,0)
 S ENDA=+Y
"RTN","ENTIRRH",22,0)
 S %ZIS="Q" D ^%ZIS I POP K POP Q
"RTN","ENTIRRH",23,0)
 I $D(IO("Q")) S ZTRTN="IN^ENTIRRH",ZTDESC="IT Equipment Hand Receipt Print",ZTSAVE("ENDA")="",ZTSAVE("ENVR")="" D ^%ZTLOAD,HOME^%ZIS K ZTSK,IO("Q") Q
"RTN","ENTIRRH",24,0)
 G IN
"RTN","ENTIRRH",25,0)
USTART ;User entry point
"RTN","ENTIRRH",26,0)
 N ENDA,ENVR S ENVR=$O(^ENG(6916.2,"@"),-1) I ENVR'>0 W !,"There are no hand receipt templates on file." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",27,0)
 I '$D(^ENG(6916.3,"AOA",DUZ)) W !,"You have no active IT assignments." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",28,0)
 S ENDA=DUZ
"RTN","ENTIRRH",29,0)
 S %ZIS="Q" D ^%ZIS I POP K POP Q
"RTN","ENTIRRH",30,0)
 I $D(IO("Q")) S ZTRTN="IN^ENTIRRH",ZTDESC="IT Equipment Hand Receipt Print",ZTSAVE("ENDA")="",ZTSAVE("ENVR")="" D ^%ZTLOAD,HOME^%ZIS K ZTSK,IO("Q") Q
"RTN","ENTIRRH",31,0)
 G IN
"RTN","ENTIRRH",32,0)
IN ;
"RTN","ENTIRRH",33,0)
 U IO
"RTN","ENTIRRH",34,0)
 N DIR,DIRUT,DIROUT,DTOUT,DUOUT,END,ENDAC,ENERR,ENI,ENLNCNT,ENMFGN,ENMODEL,ENNOW,ENPG,ENEQPT,ENX,ENNBR,ENSERNBR,ENNAME,ENSTN,X,Y
"RTN","ENTIRRH",35,0)
 S ENNAME=$$GET1^DIQ(200,ENDA_",",.01),ENNOW=$$FMTE^XLFDT($$NOW^XLFDT(),"2M"),ENPG=0,ENEQPT=1 S:'$G(DT) DT=$$DT^XLFDT()
"RTN","ENTIRRH",36,0)
 S ENSTN=+$O(^DIC(6910,0)),ENSTN=$$GET1^DIQ(6910,ENSTN_",",1)
"RTN","ENTIRRH",37,0)
 D HDR1 G:$D(DIRUT) EX
"RTN","ENTIRRH",38,0)
 K ^TMP($J,"ENITRRH"),ENERR
"RTN","ENTIRRH",39,0)
 D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AOA2","I $P(^(0),U,8)="""",$S($P(^(0),U,5)="""":1,$$FMDIFF^XLFDT(DT,$P(^(0),U,5))>359:1,1:0)","","^TMP($J,""ENITRRH"")","ENERR")
"RTN","ENTIRRH",40,0)
 I $P($G(^TMP($J,"ENITRRH","DILIST",0)),U)'>0 W !,"The are no unsigned IT assignments." G EX
"RTN","ENTIRRH",41,0)
 I '$$CMP^XUSESIG1($P($G(^ENG(6916.2,ENVR,0)),U,3),$NAME(^ENG(6916.2,ENVR,1))) W !!!,"Hand receipt text is corrupted - Please contact EPS AEMS/MERS support"  G EX
"RTN","ENTIRRH",42,0)
 S ENI=0
"RTN","ENTIRRH",43,0)
 F  S ENI=$O(^TMP($J,"ENITRRH","DILIST",ENI)) Q:+ENI'=ENI  D  Q:$D(DIRUT)
"RTN","ENTIRRH",44,0)
 . S ENX=$G(^TMP($J,"ENITRRH","DILIST",ENI,0))
"RTN","ENTIRRH",45,0)
 . S ENDAC=$P(ENX,U,2)_"," D GETS^DIQ(6914,ENDAC,"3;4;5","E","END","ENERR")
"RTN","ENTIRRH",46,0)
 . S ENNBR=$P(ENX,U,2),ENMFGN=$G(END(6914,ENDAC,3,"E")),ENMODEL=$G(END(6914,ENDAC,4,"E")),ENSERNBR=$G(END(6914,ENDAC,5,"E"))
"RTN","ENTIRRH",47,0)
 . I IOSL-1'>ENLNCNT D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",48,0)
 . W !,ENNBR,?11,$E(ENMFGN,1,20),?35,ENMODEL,?65,ENSERNBR S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",49,0)
 G:$D(DIRUT) EX
"RTN","ENTIRRH",50,0)
 S ENEQPT=0
"RTN","ENTIRRH",51,0)
 I IOSL-1'>ENLNCNT D HDR1 G:$D(DIRUT) EX
"RTN","ENTIRRH",52,0)
 I ENLNCNT>3 W !! S ENLNCNT=ENLNCNT+2
"RTN","ENTIRRH",53,0)
 S ENI=0 F  S ENI=$O(^ENG(6916.2,ENVR,1,ENI)) Q:+ENI'=ENI  D  Q:$D(DIRUT)
"RTN","ENTIRRH",54,0)
 . I IOSL-1'>ENLNCNT D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",55,0)
 . W !,$G(^ENG(6916.2,ENVR,1,ENI,0)) S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",56,0)
 G:$D(DIRUT) EX
"RTN","ENTIRRH",57,0)
 I IOSL-6'>ENLNCNT D HDR1 G:$D(DIRUT) EX
"RTN","ENTIRRH",58,0)
 W !!! S ENLNCNT=ENLNCNT+3
"RTN","ENTIRRH",59,0)
 W !,"Signature:______________________________   Date:________________"
"RTN","ENTIRRH",60,0)
 W !,?12,$P($$ESBLOCK^XUSESIG1(ENDA),U)
"RTN","ENTIRRH",61,0)
 I $E(IOST,1,2)="C-" K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","ENTIRRH",62,0)
EX S:$D(ZTQUEUED) ZTREQ="@" D ^%ZISC
"RTN","ENTIRRH",63,0)
 K ^TMP($J,"ENITRRH"),ENDA,ENVR
"RTN","ENTIRRH",64,0)
 Q
"RTN","ENTIRRH",65,0)
HDR1 ;Logic to print report heading
"RTN","ENTIRRH",66,0)
 I $E(IOST,1,2)="C-",ENPG K DIR S DIR(0)="E" D ^DIR K DIR Q:$D(DIRUT) 
"RTN","ENTIRRH",67,0)
 W:$E(IOST,1,2)="C-"!ENPG @IOF S ENPG=ENPG+1
"RTN","ENTIRRH",68,0)
 W $S($G(ENPRT)="SIGNED":"IT HAND RECEIPT/LOAN FORM FOR GOVERNMENT FURNISHED EQUIPMENT (GFE)   Page ",1:"INFORMATION TECHNOLOGY HAND RECEIPT FOR GOVERNMENT FURNISHED EQUIPMENT  Page "),ENPG
"RTN","ENTIRRH",69,0)
 W:$G(ENPRT)="SIGNED" !,"Electronic Accepted Substitute for VA Form 0887(a/b)"
"RTN","ENTIRRH",70,0)
 W !,"STATION: ",ENSTN,?14,"ASSIGNED TO: ",$E(ENNAME,1,30),?58,"Printed ",ENNOW,! S ENLNCNT=$S($G(ENPRT)="SIGNED":4,1:3)
"RTN","ENTIRRH",71,0)
 I ENEQPT W !,"ENTRY #",?11,"MFG EQUIP NAME",?35,"MODEL",?65,"SERIAL#",!,"---------",?11,"--------------------",?35,"--------------------------",?65,"----------" S ENLNCNT=ENLNCNT+2
"RTN","ENTIRRH",72,0)
 Q
"RTN","ENTIRRH",73,0)
 ;
"RTN","ENTIRRH",74,0)
ITST2 ;IT personnel entry point for printing signed hand receipts
"RTN","ENTIRRH",75,0)
 N ENDA
"RTN","ENTIRRH",76,0)
 N DIC,DTOUT,DUOUT S DIC=200,DIC(0)="AEMQ",DIC("S")="I $D(^ENG(6916.3,""AOA"",Y))"
"RTN","ENTIRRH",77,0)
 D ^DIC I Y<1!$D(DTOUT)!$D(DUOUT) Q
"RTN","ENTIRRH",78,0)
 S ENDA=+Y
"RTN","ENTIRRH",79,0)
 I '$$SIGNED(ENDA) W !,"There are no active, Signed/Certified IT assignments for "_$$GET1^DIQ(200,ENDA_",",.01)_"." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",80,0)
 S %ZIS="Q" D ^%ZIS I POP K POP Q
"RTN","ENTIRRH",81,0)
 I $D(IO("Q")) S ZTRTN="IN2^ENTIRRH",ZTDESC="IT Equipment Hand Receipt Print",ZTSAVE("ENDA")="" D ^%ZTLOAD,HOME^%ZIS K ZTSK,IO("Q") Q
"RTN","ENTIRRH",82,0)
 G IN2
"RTN","ENTIRRH",83,0)
USER ;User entry point for printing signed hand receipts
"RTN","ENTIRRH",84,0)
 I '$D(^ENG(6916.3,"AOA",DUZ)) W !,"You have no active IT assignments." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",85,0)
 N ENDA S ENDA=DUZ
"RTN","ENTIRRH",86,0)
 I '$$SIGNED(ENDA) W !,"You do not have any active, Signed/Certified IT assignments." K DIR S DIR(0)="E" D ^DIR K DIR Q
"RTN","ENTIRRH",87,0)
 S %ZIS="Q" D ^%ZIS I POP K POP Q
"RTN","ENTIRRH",88,0)
 I $D(IO("Q")) S ZTRTN="IN2^ENTIRRH",ZTDESC="IT Equipment Hand Receipt Print",ZTSAVE("ENDA")="" D ^%ZTLOAD,HOME^%ZIS K ZTSK,IO("Q") Q
"RTN","ENTIRRH",89,0)
 G IN2
"RTN","ENTIRRH",90,0)
IN2 ;
"RTN","ENTIRRH",91,0)
 N DIR,DIRUT,DIROUT,DTOUT,DUOUT,ENVR,ENPRT S ENPRT="SIGNED"
"RTN","ENTIRRH",92,0)
 S ENVR=0 F  S ENVR=$O(^ENG(6916.2,ENVR)) Q:+ENVR'=ENVR  D PRT Q:$D(DIRUT)
"RTN","ENTIRRH",93,0)
 G EX2
"RTN","ENTIRRH",94,0)
PRT U IO
"RTN","ENTIRRH",95,0)
 N END,ENDAC,ENERR,ENI,ENLNCNT,ENMFGN,ENMODEL,ENNOW,ENEQPT,ENPG,ENRDA,ENX,ENNBR,ENSERNBR,ENSIG,ENSIGNDT,ENNAME,ENSTN,ENVAL,X,Y S ENPG=0,ENEQPT=1
"RTN","ENTIRRH",96,0)
 S ENNAME=$$GET1^DIQ(200,ENDA_",",.01),ENNOW=$$FMTE^XLFDT($$NOW^XLFDT(),"2M")
"RTN","ENTIRRH",97,0)
 S ENSTN=+$O(^DIC(6910,0)),ENSTN=$$GET1^DIQ(6910,ENSTN_",",1)
"RTN","ENTIRRH",98,0)
 K ^TMP($J,"ENITRRH"),ENERR
"RTN","ENTIRRH",99,0)
 D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AOA2","I $P(^(0),U,6)=ENVR,"";SIGNED;CERTIFIED;""[("";""_$$GET1^DIQ(6916.3,Y_"","",20)_"";"")","","^TMP($J,""ENITRRH"")","ENERR")
"RTN","ENTIRRH",100,0)
 I $P($G(^TMP($J,"ENITRRH","DILIST",0)),U)'>0 K ^TMP($J,"ENITRRH") Q 
"RTN","ENTIRRH",101,0)
 D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",102,0)
 I '$$CMP^XUSESIG1($P($G(^ENG(6916.2,ENVR,0)),U,3),$NAME(^ENG(6916.2,ENVR,1))) W !!!,"Hand receipt v",$P($G(^ENG(6916.2,ENVR,0)),U)," text is corrupted.",!?5," - Please contact EPS AEMS/MERS support"  Q
"RTN","ENTIRRH",103,0)
 S ENI=0
"RTN","ENTIRRH",104,0)
 F  S ENI=$O(^TMP($J,"ENITRRH","DILIST",ENI)) Q:+ENI'=ENI  D  Q:$D(DIRUT)
"RTN","ENTIRRH",105,0)
 . N END,ENERR,ENERR1,ENERR2,ENERR3,ENERR4,X1,X2
"RTN","ENTIRRH",106,0)
 . S ENX=$G(^TMP($J,"ENITRRH","DILIST",ENI,0))
"RTN","ENTIRRH",107,0)
 . S ENDAC=$P(ENX,U,2)_"," D GETS^DIQ(6914,ENDAC,"3;4;5","E","END","ENERR")
"RTN","ENTIRRH",108,0)
 . S ENNBR=$P(ENX,U,2),ENMFGN=$G(END(6914,ENDAC,3,"E")),ENMODEL=$G(END(6914,ENDAC,4,"E")),ENSERNBR=$G(END(6914,ENDAC,5,"E"))
"RTN","ENTIRRH",109,0)
 . I IOSL-1'>ENLNCNT D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",110,0)
 . W !,ENNBR,?11,$E(ENMFGN,1,20),?35,ENMODEL,?65,ENSERNBR S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",111,0)
 . S ENRDA=$P(ENX,U) K ENERR,ENSIG,ENSIGNDT
"RTN","ENTIRRH",112,0)
 . S X=$G(^ENG(6916.3,ENRDA,1))
"RTN","ENTIRRH",113,0)
 . I X'="" D
"RTN","ENTIRRH",114,0)
 . . S X1=ENRDA,X2=1 D DE^XUSHSHP S ENSIG=$P(X,U),ENSIGNDT=$$FMTE^XLFDT($P(X,U,4))
"RTN","ENTIRRH",115,0)
 . . S:$P(X,U,8)'=$P($G(^ENG(6916.2,ENVR,0)),U,3) ENERR1=1
"RTN","ENTIRRH",116,0)
 . . S:$P(X,U,5)'=$P(ENX,U,2) ENERR2=1
"RTN","ENTIRRH",117,0)
 . . S:$P(X,U,6)'=$P($G(^ENG(6916.3,ENRDA,0)),U,2) ENERR3=1
"RTN","ENTIRRH",118,0)
 . . S:$P(X,U,4)'=$P($G(^ENG(6916.3,ENRDA,0)),U,5) ENERR4=1
"RTN","ENTIRRH",119,0)
 . I $D(ENSIGNDT) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !?4,"Signed: ",ENSIGNDT,?35,"Signature: /ES/",$G(ENSIG) S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",120,0)
 . I '$D(ENSIGNDT) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !,?4,"Signed: "_$$GET1^DIQ(6916.3,ENRDA_",",4),?35,"Certified by: ",$$GET1^DIQ(6916.3,ENRDA_",",6)  S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",121,0)
 . S ENVAL=$$LOAN($P(ENDAC,","))
"RTN","ENTIRRH",122,0)
 . W !,?2,"Issued By: ",$$ISSUEDBY(ENRDA),?49,"Contact #: ",$P(ENVAL,U,2) S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",123,0)
 . W !,?2,"Equipment Return Date: ",$$DATEDUE($P(ENDAC,","),$P(ENVAL,U)) S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",124,0)
 . I $G(ENERR1) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !?19,"** Hand Receipt Text Altered **" S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",125,0)
 . I $G(ENERR2) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !?19,"** Assigned Equipment Altered **" S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",126,0)
 . I $G(ENERR3) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !?19,"** Assigned Person Altered **" S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",127,0)
 . I $G(ENERR4) D:IOSL-1'>ENLNCNT HDR1 Q:$D(DIRUT)  W !?19,"** Date Signed Altered **" S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",128,0)
 Q:$D(DIRUT)  S ENEQPT=0
"RTN","ENTIRRH",129,0)
 I IOSL-3'>ENLNCNT D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",130,0)
 I ENLNCNT>3 W !! S ENLNCNT=ENLNCNT+2
"RTN","ENTIRRH",131,0)
 S ENI=0 F  S ENI=$O(^ENG(6916.2,ENVR,1,ENI)) Q:+ENI'=ENI  D  Q:$D(DIRUT)
"RTN","ENTIRRH",132,0)
 . I IOSL-1'>ENLNCNT D HDR1 Q:$D(DIRUT)
"RTN","ENTIRRH",133,0)
 . W !,$G(^ENG(6916.2,ENVR,1,ENI,0)) S ENLNCNT=ENLNCNT+1
"RTN","ENTIRRH",134,0)
 Q:$D(DIRUT)
"RTN","ENTIRRH",135,0)
 I $E(IOST,1,2)="C-" K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","ENTIRRH",136,0)
 Q
"RTN","ENTIRRH",137,0)
EX2 S:$D(ZTQUEUED) ZTREQ="@" D ^%ZISC
"RTN","ENTIRRH",138,0)
 K ^TMP($J,"ENITRRH"),ENDA
"RTN","ENTIRRH",139,0)
 Q
"RTN","ENTIRRH",140,0)
SIGNED(ENDA) ;Returns how many signed/certified, active assignments exist for this person
"RTN","ENTIRRH",141,0)
 N ENERR,ENCNT
"RTN","ENTIRRH",142,0)
 K ^TMP($J,"ENITRRH")
"RTN","ENTIRRH",143,0)
 D FIND^DIC(6916.3,"","@","PQX",ENDA,"","AOA2","I "";SIGNED;CERTIFIED;""[("";""_$$GET1^DIQ(6916.3,Y_"","",20)_"";"")","","^TMP($J,""ENITRRH"")","ENERR")
"RTN","ENTIRRH",144,0)
 S ENCNT=+$P($G(^TMP($J,"ENITRRH","DILIST",0)),U)
"RTN","ENTIRRH",145,0)
 K ^TMP($J,"ENITRRH")
"RTN","ENTIRRH",146,0)
 Q ENCNT
"RTN","ENTIRRH",147,0)
 ;
"RTN","ENTIRRH",148,0)
ISSUEDBY(ENRDA) ;Name of person assigning responsibility
"RTN","ENTIRRH",149,0)
 N ENARR,ENDA,ENNAME S ENDA=$$GET1^DIQ(6916.3,ENRDA_",",3,"I")
"RTN","ENTIRRH",150,0)
 S ENARR("FILE")=200,ENARR("IENS")=ENDA_",",ENARR("FIELD")=".01"
"RTN","ENTIRRH",151,0)
 S ENNAME=$$NAMEFMT^XLFNAME(.ENARR,"G","L35")
"RTN","ENTIRRH",152,0)
 Q ENNAME
"RTN","ENTIRRH",153,0)
 ;
"RTN","ENTIRRH",154,0)
DATEDUE(ENDA,ENADD) ;Returns Date Due for Return
"RTN","ENTIRRH",155,0)
 N ENINVDT,ENDT
"RTN","ENTIRRH",156,0)
 S ENINVDT=$$GET1^DIQ(6914,ENDA_",",23,"I") S:$G(ENADD)'>0 ENADD=90
"RTN","ENTIRRH",157,0)
 S ENDT=$S(ENINVDT="":DT,1:$$FMADD^XLFDT(ENINVDT,ENADD)),ENDT=$$FMTE^XLFDT(ENDT,"2M")
"RTN","ENTIRRH",158,0)
 Q ENDT
"RTN","ENTIRRH",159,0)
 ;
"RTN","ENTIRRH",160,0)
LOAN(ENEQ) ;Loan Data for Equipment
"RTN","ENTIRRH",161,0)
 ;input ENDA (equipment ien file 6914)
"RTN","ENTIRRH",162,0)
 ;return value = number of days^loan form phone
"RTN","ENTIRRH",163,0)
 N ENCMR,ENRET,ENY1
"RTN","ENTIRRH",164,0)
 S ENRET="90^" ;default number of days is 90
"RTN","ENTIRRH",165,0)
 S ENCMR=$P($G(^ENG(6914,ENEQ,2)),U,9)
"RTN","ENTIRRH",166,0)
 S ENY1=$S(ENCMR:$G(^ENG(6914.1,ENCMR,1)),1:"")
"RTN","ENTIRRH",167,0)
 I $P(ENY1,U) S $P(ENRET,U)=$P(ENY1,U) ;days for CMR (if specified)
"RTN","ENTIRRH",168,0)
 I $P(ENY1,U,2)]"" S $P(ENRET,U,2)=$P(ENY1,U,2) ;loan form phone for CMR
"RTN","ENTIRRH",169,0)
 Q ENRET
"RTN","ENTIRRH",170,0)
 ;
"RTN","ENTIRRH",171,0)
 ;ENTIRRH
"RTN","ENTIRT")
0^7^B11562191^B11537815
"RTN","ENTIRT",1,0)
ENTIRT ;WOIFO/LKG - TERMINATE RESPONSIBILITY ;2/4/08  12:32
"RTN","ENTIRT",2,0)
 ;;7.0;ENGINEERING;**87,89**;Aug 17, 1993;Build 20
"RTN","ENTIRT",3,0)
TERMLST ;Entry for list termination processing
"RTN","ENTIRT",4,0)
 N DA,DIR,DIROUT,DIRUT,DTOUT,DUOUT,DIC,D,ENACL,ENCNT,ENDA,ENMETHOD,ENERR,ENX,ENI,ENJ,X,Y
"RTN","ENTIRT",5,0)
LSTSTART S DIR(0)="S^E:EQUIPMENT;P:PERSON",DIR("A")="Specify method for selecting IT assignments"
"RTN","ENTIRT",6,0)
 D ^DIR K DIR G:$D(DIRUT) LSTEXIT
"RTN","ENTIRT",7,0)
 S ENMETHOD=Y
"RTN","ENTIRT",8,0)
 I ENMETHOD="E" D  G:$D(ENERR) LSTEXIT
"RTN","ENTIRT",9,0)
 . N D,DIC S DIC("S")="I $D(^ENG(6916.3,""AEA"",Y))" D GETEQ^ENUTL
"RTN","ENTIRT",10,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y<1) S ENERR=1 Q
"RTN","ENTIRT",11,0)
 . S ENDA=+Y
"RTN","ENTIRT",12,0)
 . K DIC,D,^TMP($J,"ENITTR"),ENERR
"RTN","ENTIRT",13,0)
 . D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AEA","I $P(^(0),U,8)=""""","","^TMP($J,""ENITTR"")","ENERR")
"RTN","ENTIRT",14,0)
 I ENMETHOD="P" D  G:$D(ENERR) LSTEXIT
"RTN","ENTIRT",15,0)
 . N D,DIC S DIC=200,DIC(0)="AEMQ",DIC("S")="I $D(^ENG(6916.3,""AOA"",Y))"
"RTN","ENTIRT",16,0)
 . D ^DIC I $D(DTOUT)!$D(DUOUT)!(Y<1) S ENERR=1 Q
"RTN","ENTIRT",17,0)
 . S ENDA=+Y
"RTN","ENTIRT",18,0)
 . K DIC,D,^TMP($J,"ENITTR"),ENERR
"RTN","ENTIRT",19,0)
 . D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AOA2","I $P(^(0),U,8)=""""","","^TMP($J,""ENITTR"")","ENERR")
"RTN","ENTIRT",20,0)
 I $P($G(^TMP($J,"ENITTR","DILIST",0)),U)'>0 W !!,"There are no active responsibilities for this "_$S(ENMETHOD="E":"equipment",ENMETHOD="P":"person",1:"")_"." K DIR S DIR(0)="E" D ^DIR K DIR K ^TMP($J,"ENITTR") G LSTEXIT:'Y,LSTSTART
"RTN","ENTIRT",21,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX"),ENACL
"RTN","ENTIRT",22,0)
 S ^TMP($J,"SCR")=$P(^TMP($J,"ENITTR","DILIST",0),U)_"^ACTIVE IT RESPONSIBILITIES"
"RTN","ENTIRT",23,0)
 S ^TMP($J,"SCR",0)="5;9;ENTRY #^15;20;MFG EQUIP NAME^37;30;OWNER^69;10;STATUS"
"RTN","ENTIRT",24,0)
 S ENI=0
"RTN","ENTIRT",25,0)
 F  S ENI=$O(^TMP($J,"ENITTR","DILIST",ENI)) Q:+ENI'>0  D
"RTN","ENTIRT",26,0)
 . N ENX S ENX=$G(^TMP($J,"ENITTR","DILIST",ENI,0))
"RTN","ENTIRT",27,0)
 . S ^TMP($J,"SCR",ENI)=$P(ENX,U,2)_U_$E($$GET1^DIQ(6914,$P(ENX,U,2)_",",3),1,20)_U_$P(ENX,U,3,4)
"RTN","ENTIRT",28,0)
 . S ^TMP($J,"INDX",ENI)=$P(ENX,U)
"RTN","ENTIRT",29,0)
 K ^TMP($J,"ENITTR")
"RTN","ENTIRT",30,0)
 D EN2^ENPLS2(1)
"RTN","ENTIRT",31,0)
 G:'$D(ENACL)!$D(DIRUT) LSTEXIT
"RTN","ENTIRT",32,0)
 S DIR(0)="Y",DIR("A")="OK to terminate assignments",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRT",33,0)
 G:'Y!$D(DIRUT) LSTEXIT
"RTN","ENTIRT",34,0)
 S ENCNT=0,ENX=""
"RTN","ENTIRT",35,0)
 F  S ENX=$O(ENACL(ENX)) Q:ENX=""  D
"RTN","ENTIRT",36,0)
 . N ENXSTR
"RTN","ENTIRT",37,0)
 . S ENXSTR=$G(ENACL(ENX)) Q:ENXSTR=""
"RTN","ENTIRT",38,0)
 . I $L(ENXSTR,",")>0 D
"RTN","ENTIRT",39,0)
 . . F ENJ=1:1 S ENI=$P(ENXSTR,",",ENJ) Q:+ENI'>0  D
"RTN","ENTIRT",40,0)
 . . . S DA=^TMP($J,"INDX",ENI) L +^ENG(6916.3,DA):$S($G(DILOCKTM)>5:DILOCKTM,1:5) E  D MSG(DA,"Termination") Q
"RTN","ENTIRT",41,0)
 . . . S X=$$TERM^ENTIUTL1(DA)
"RTN","ENTIRT",42,0)
 . . . L -^ENG(6916.3,DA) K DA
"RTN","ENTIRT",43,0)
 . . . S ENCNT=ENCNT+1
"RTN","ENTIRT",44,0)
 W !!,ENCNT," IT responsibilities were terminated." K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","ENTIRT",45,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX")
"RTN","ENTIRT",46,0)
 G LSTEXIT:'Y,LSTSTART
"RTN","ENTIRT",47,0)
LSTEXIT ;
"RTN","ENTIRT",48,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX")
"RTN","ENTIRT",49,0)
 Q
"RTN","ENTIRT",50,0)
MSG(ENDA,ENMSG) ;Write Error Message
"RTN","ENTIRT",51,0)
 N END,ENERR,ENDAC S ENDAC=ENDA_"," D GETS^DIQ(6916.3,ENDAC,".01;1","E","END","ENERR")
"RTN","ENTIRT",52,0)
 W !,"Assignment Equip Entry# ",$G(END(6916.3,ENDAC,.01,"E"))," for ",$G(END(6916.3,ENDAC,1,"E"))," is locked by another process.",!?10,ENMSG," was bypassed."
"RTN","ENTIRT",53,0)
 Q
"RTN","ENTIRT",54,0)
 ;
"RTN","ENTIRT",55,0)
 ;ENTIRT
"RTN","ENTIRX")
0^8^B23992664^B23968288
"RTN","ENTIRX",1,0)
ENTIRX ;WOIFO/LKG - TRANSFER RESPONSIBILITY ;2/5/08  14:58
"RTN","ENTIRX",2,0)
 ;;7.0;ENGINEERING;**87,89**;Aug 17, 1993;Build 20
"RTN","ENTIRX",3,0)
TERMLST ;Entry for transfer processing
"RTN","ENTIRX",4,0)
 N DA,DIR,DIROUT,DIRUT,DTOUT,DUOUT,DIC,D,ENA,ENACL,ENCNT,ENCNT2,ENDA,ENMETHOD,ENNAME,ENNBR,ENPER,ENRES,ENERR,ENX,ENI,ENJ,X,X1,Y
"RTN","ENTIRX",5,0)
LSTSTART S DIR(0)="S^E:EQUIPMENT;P:PERSON",DIR("A")="Specify method for selecting IT assignments"
"RTN","ENTIRX",6,0)
 D ^DIR K DIR G:$D(DIRUT)!$D(DIROUT)!$D(DTOUT)!$D(DUOUT) LSTEXIT
"RTN","ENTIRX",7,0)
 S ENMETHOD=Y
"RTN","ENTIRX",8,0)
 I ENMETHOD="E" D  G:$D(ENERR) LSTEXIT
"RTN","ENTIRX",9,0)
 . N D,DIC S DIC("S")="I $D(^ENG(6916.3,""AEA"",Y))" D GETEQ^ENUTL
"RTN","ENTIRX",10,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y<1) S ENERR=1 Q
"RTN","ENTIRX",11,0)
 . S ENDA=+Y
"RTN","ENTIRX",12,0)
 . K DIC,D,^TMP($J,"ENITTR"),ENERR
"RTN","ENTIRX",13,0)
 . D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AEA","I $P(^(0),U,8)=""""","","^TMP($J,""ENITTR"")","ENERR")
"RTN","ENTIRX",14,0)
 I ENMETHOD="P" D  G:$D(ENERR) LSTEXIT
"RTN","ENTIRX",15,0)
 . N D,DIC S DIC=200,DIC(0)="AEMQ",DIC("S")="I $D(^ENG(6916.3,""AOA"",Y))"
"RTN","ENTIRX",16,0)
 . D ^DIC I $D(DTOUT)!$D(DUOUT)!(Y<1) S ENERR=1 Q
"RTN","ENTIRX",17,0)
 . S ENDA=+Y
"RTN","ENTIRX",18,0)
 . K DIC,D,^TMP($J,"ENITTR"),ENERR
"RTN","ENTIRX",19,0)
 . D FIND^DIC(6916.3,"","@;.01;1;20","PQX",ENDA,"","AOA2","I $P(^(0),U,8)=""""","","^TMP($J,""ENITTR"")","ENERR")
"RTN","ENTIRX",20,0)
 I $P($G(^TMP($J,"ENITTR","DILIST",0)),U)'>0 W !!,"There are no active responsibilities for this "_$S(ENMETHOD="E":"equipment",ENMETHOD="P":"person",1:"")_"." K DIR S DIR(0)="E" D ^DIR K DIR K ^TMP($J,"ENITTR") G LSTEXIT:'Y,LSTSTART
"RTN","ENTIRX",21,0)
 K ^TMP($J,"SCR"),^TMP($J,"INDX"),ENACL
"RTN","ENTIRX",22,0)
 S ^TMP($J,"SCR")=$P(^TMP($J,"ENITTR","DILIST",0),U)_"^ACTIVE IT RESPONSIBILITIES"
"RTN","ENTIRX",23,0)
 S ^TMP($J,"SCR",0)="5;9;ENTRY #^15;20;MFG EQUIP NAME^37;30;OWNER^69;10;STATUS"
"RTN","ENTIRX",24,0)
 S ENI=0
"RTN","ENTIRX",25,0)
 F  S ENI=$O(^TMP($J,"ENITTR","DILIST",ENI)) Q:+ENI'>0  D
"RTN","ENTIRX",26,0)
 . N ENX S ENX=$G(^TMP($J,"ENITTR","DILIST",ENI,0))
"RTN","ENTIRX",27,0)
 . S ^TMP($J,"SCR",ENI)=$P(ENX,U,2)_U_$E($$GET1^DIQ(6914,$P(ENX,U,2)_",",3),1,20)_U_$P(ENX,U,3,4)
"RTN","ENTIRX",28,0)
 . S ^TMP($J,"INDX",ENI)=$P(ENX,U)
"RTN","ENTIRX",29,0)
 K ^TMP($J,"ENITTR")
"RTN","ENTIRX",30,0)
 D EN2^ENPLS2(1)
"RTN","ENTIRX",31,0)
 I '$D(ENACL)!$D(DIRUT)!$D(DIROUT) K ^TMP($J,"SCR"),^TMP($J,"INDX") G LSTEXIT
"RTN","ENTIRX",32,0)
ASKNAME K DIC S DIC=200,DIC(0)="AEMQ",DIC("A")="Select person for new assignment: "
"RTN","ENTIRX",33,0)
 D ^DIC I +Y<1!$D(DTOUT)!$D(DUOUT) G LSTEXIT
"RTN","ENTIRX",34,0)
 S ENPER=+Y,ENNAME=$P(Y,U,2) K DIR S DIR(0)="Y",DIR("A")="Assign responsibility to "_ENNAME,DIR("B")="NO"
"RTN","ENTIRX",35,0)
 D ^DIR G LSTEXIT:$D(DIRUT),ASKNAME:'Y
"RTN","ENTIRX",36,0)
 S DIR(0)="Y",DIR("A")="OK to transfer assignments",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRX",37,0)
 G:'Y!$D(DIRUT) LSTEXIT W !
"RTN","ENTIRX",38,0)
 S ENCNT=0,ENCNT2=0,ENX="" K ENA K ^TMP($J,"ENSIGN")
"RTN","ENTIRX",39,0)
 F  S ENX=$O(ENACL(ENX)) Q:ENX=""  D
"RTN","ENTIRX",40,0)
 . N ENXSTR
"RTN","ENTIRX",41,0)
 . S ENXSTR=$G(ENACL(ENX)) Q:ENXSTR=""
"RTN","ENTIRX",42,0)
 . I $L(ENXSTR,",")>0 D
"RTN","ENTIRX",43,0)
 . . F ENJ=1:1 S ENI=$P(ENXSTR,",",ENJ) Q:+ENI'>0  D
"RTN","ENTIRX",44,0)
 . . . S DA=^TMP($J,"INDX",ENI) L +^ENG(6916.3,DA):$S($G(DILOCKTM)>5:DILOCKTM,1:5) E  D MSG^ENTIRT(DA,"Transfer") Q
"RTN","ENTIRX",45,0)
 . . . S X=$$TERM^ENTIUTL1(DA)
"RTN","ENTIRX",46,0)
 . . . L -^ENG(6916.3,DA)
"RTN","ENTIRX",47,0)
 . . . S ENCNT=ENCNT+1
"RTN","ENTIRX",48,0)
 . . . S ENNBR=$P($G(^ENG(6916.3,DA,0)),U) Q:'ENNBR
"RTN","ENTIRX",49,0)
 . . . I '$D(ENA(ENNBR)) S ENRES=$$ASGN^ENTIUTL1(ENNBR,ENPER),ENA(ENNBR)=ENRES S:ENRES ENCNT2=ENCNT2+1 W:ENRES=0 !,ENNBR," is already assigned to ",ENNAME,"." S:(ENPER=DUZ)&ENRES ^TMP($J,"ENSIGN",ENRES)=""
"RTN","ENTIRX",50,0)
 W !!,ENCNT," IT responsibilities were terminated.",!,ENCNT2," assignments were created." K DIR S DIR(0)="E" D ^DIR K DIR K ^TMP($J,"SCR"),^TMP($J,"INDX") G:'Y LSTEXIT
"RTN","ENTIRX",51,0)
 I ENPER=DUZ,$$SIGNOK() D
"RTN","ENTIRX",52,0)
 . N L,DIC,FLDS,FR,TO,BY,IOP,DHD,ENMSG
"RTN","ENTIRX",53,0)
 . S DA=$O(^ENG(6916.2,"@"),-1)
"RTN","ENTIRX",54,0)
 . I '$$CMP^XUSESIG1($P($G(^ENG(6916.2,DA,0)),U,3),$NAME(^ENG(6916.2,DA,1))) W !!,"Hand receipt text is corrupted - Please contact EPS AEMS/MERS support." Q
"RTN","ENTIRX",55,0)
 . S L=0,DIC=6916.2,FLDS=1,FR=DA,TO=DA,BY="@NUMBER",IOP="HOME",DHD="@"
"RTN","ENTIRX",56,0)
 . D EN1^DIP
"RTN","ENTIRX",57,0)
 . K DIR S DIR(0)="Y",DIR("A")="OK to sign",DIR("B")="NO" D ^DIR K DIR
"RTN","ENTIRX",58,0)
 . Q:'Y!$D(DIRUT)
"RTN","ENTIRX",59,0)
 . D SIG^XUSESIG I X1="" W !,"<Invalid Electronic Signature> Signing Aborted." Q
"RTN","ENTIRX",60,0)
 . S ENDA="",ENCNT=0
"RTN","ENTIRX",61,0)
 . F  S ENDA=$O(^TMP($J,"ENSIGN",ENDA)) Q:ENDA=""  D
"RTN","ENTIRX",62,0)
 . . L +^ENG(6916.3,ENDA):$S($G(DILOCKTM)>5:DILOCKTM,1:5) E  D MSG^ENTIRT(ENDA,"Signature") Q
"RTN","ENTIRX",63,0)
 . . I $$SIGN^ENTIUTL1(ENDA) S ENCNT=ENCNT+1 K ^TMP($J,"ENSIGN",ENDA)
"RTN","ENTIRX",64,0)
 . . L -^ENG(6916.3,ENDA)
"RTN","ENTIRX",65,0)
 . W !!,ENCNT," assignment records were signed."
"RTN","ENTIRX",66,0)
 . S ENDA=""
"RTN","ENTIRX",67,0)
 . F  S ENDA=$O(^TMP($J,"ENSIGN",ENDA)) Q:ENDA=""  D
"RTN","ENTIRX",68,0)
 . . N END,ENERR,ENDAC S ENDAC=ENDA_"," D GETS^DIQ(6916.3,ENDAC,".01;1","E","END","ENERR")
"RTN","ENTIRX",69,0)
 . . W !,"Assignment Equip Entry# ",$G(END(6916.3,ENDAC,.01,"E"))," for ",$G(END(6916.3,ENDAC,1,"E"))," was not signed."
"RTN","ENTIRX",70,0)
 . . K ^TMP($J,"ENSIGN",ENDA)
"RTN","ENTIRX",71,0)
 G LSTSTART:'$D(DIRUT)
"RTN","ENTIRX",72,0)
LSTEXIT ;
"RTN","ENTIRX",73,0)
 K ^TMP($J,"ENSIGN"),^TMP($J,"ENITTR"),^TMP($J,"INDX"),^TMP($J,"SCR")
"RTN","ENTIRX",74,0)
 Q
"RTN","ENTIRX",75,0)
SIGNOK() ;Ask if want to sign for equipment
"RTN","ENTIRX",76,0)
 K DIR S DIR(0)="Y",DIR("A")="Do you want to sign to accept responsibility now",DIR("B")="NO"
"RTN","ENTIRX",77,0)
 D ^DIR K DIR
"RTN","ENTIRX",78,0)
 Q Y
"RTN","ENTIRX",79,0)
 ;
"RTN","ENTIRX",80,0)
 ;ENTIRX
"RTN","ENTIUTL")
0^10^B50281271^B50248814
"RTN","ENTIUTL",1,0)
ENTIUTL ;WOIFO/SAB - Engineering Utilities ;2/14/2008
"RTN","ENTIUTL",2,0)
 ;;7.0;ENGINEERING;**87,89**;Aug 17, 1993;Build 20
"RTN","ENTIUTL",3,0)
 ;
"RTN","ENTIUTL",4,0)
DISEQ(ENDA) ; Display Equipment
"RTN","ENTIUTL",5,0)
 N ENCMR,ENLOC,ENMFGR,ENMOD,ENNAM,ENSER,ENSVC
"RTN","ENTIUTL",6,0)
 ; display equipment data
"RTN","ENTIUTL",7,0)
 S ENCMR=$$GET1^DIQ(6914,ENDA,19)
"RTN","ENTIUTL",8,0)
 S ENLOC=$$GET1^DIQ(6914,ENDA,24)
"RTN","ENTIUTL",9,0)
 S ENSVC=$$GET1^DIQ(6914,ENDA,21)
"RTN","ENTIUTL",10,0)
 S ENNAM=$$GET1^DIQ(6914,ENDA,3)
"RTN","ENTIUTL",11,0)
 S ENMFGR=$$GET1^DIQ(6914,ENDA,1)
"RTN","ENTIUTL",12,0)
 S ENMOD=$$GET1^DIQ(6914,ENDA,4)
"RTN","ENTIUTL",13,0)
 S ENSER=$$GET1^DIQ(6914,ENDA,5)
"RTN","ENTIUTL",14,0)
 W !,"Entry #",?12,"CMR",?19,"Location",?41,"Using Service"
"RTN","ENTIUTL",15,0)
 W !,"---------",?12,"-----",?19,"--------------------"
"RTN","ENTIUTL",16,0)
 W ?41,"------------------------------"
"RTN","ENTIUTL",17,0)
 W !,ENDA,?12,ENCMR,?19,ENLOC,?41,ENSVC
"RTN","ENTIUTL",18,0)
 W !,ENNAM
"RTN","ENTIUTL",19,0)
 W !!,"Mfgr: ",ENMFGR
"RTN","ENTIUTL",20,0)
 W !,"Model: ",ENMOD,?39,"Serial #: ",ENSER
"RTN","ENTIUTL",21,0)
 Q
"RTN","ENTIUTL",22,0)
 ;
"RTN","ENTIUTL",23,0)
CAPEQ(ENDA,ENTAG,SITC,END) ; Captioned Equipment Display
"RTN","ENTIUTL",24,0)
 ; input
"RTN","ENTIUTL",25,0)
 ;   ENDA = equipment ien (file 6914)
"RTN","ENTIUTL",26,0)
 ;   ENTAG = (optional) line tag to call at page break
"RTN","ENTIUTL",27,0)
 ;         this utility expects there to be at least 5 lines to display
"RTN","ENTIUTL",28,0)
 ;         the normal data and will only issue page breaks during the
"RTN","ENTIUTL",29,0)
 ;         IT REMOTE LOCATION or IT COMMENTS output.
"RTN","ENTIUTL",30,0)
 ;   SITC = (optional) flag, true to suppress IT comments from printing
"RTN","ENTIUTL",31,0)
 ; output
"RTN","ENTIUTL",32,0)
 ;   END = true if user enter "^" or timed-out, passed by reference
"RTN","ENTIUTL",33,0)
 N ENCMR,ENI,ENITRL,ENLOC,ENLOCS,ENMFGR,ENMOD,ENNAM,ENSER,ENSVC,X
"RTN","ENTIUTL",34,0)
 S ENTAG=$G(ENTAG,"CAPEQHD^ENTIUTL")
"RTN","ENTIUTL",35,0)
 S END=$G(END)
"RTN","ENTIUTL",36,0)
 ; display equipment data
"RTN","ENTIUTL",37,0)
 S ENCMR=$$GET1^DIQ(6914,ENDA,19)
"RTN","ENTIUTL",38,0)
 S ENLOC=$$GET1^DIQ(6914,ENDA,24)
"RTN","ENTIUTL",39,0)
 S ENLOCS=$$GET1^DIQ(6914,ENDA,"24:1.5")
"RTN","ENTIUTL",40,0)
 S ENSVC=$$GET1^DIQ(6914,ENDA,21)
"RTN","ENTIUTL",41,0)
 S ENNAM=$$GET1^DIQ(6914,ENDA,3)
"RTN","ENTIUTL",42,0)
 S ENMFGR=$$GET1^DIQ(6914,ENDA,1)
"RTN","ENTIUTL",43,0)
 S ENMOD=$$GET1^DIQ(6914,ENDA,4)
"RTN","ENTIUTL",44,0)
 S ENSER=$$GET1^DIQ(6914,ENDA,5)
"RTN","ENTIUTL",45,0)
 W !,"Entry #: ",ENDA,?21,"CMR: ",ENCMR,?33,"Using Service: ",ENSVC
"RTN","ENTIUTL",46,0)
 W !,?2,"Location: ",ENLOC,?34,"Svc of Location: ",ENLOCS
"RTN","ENTIUTL",47,0)
 W !,?2,"Mfgr Name: ",$E(ENNAM,1,65) W:$E(ENNAM,66,80)]"" "*"
"RTN","ENTIUTL",48,0)
 W !,?2,"Mfgr: ",ENMFGR
"RTN","ENTIUTL",49,0)
 W !,?2,"Model: ",ENMOD,?41,"Ser. #: ",ENSER
"RTN","ENTIUTL",50,0)
 S ENITRL=$$GET1^DIQ(6914,ENDA,91)
"RTN","ENTIUTL",51,0)
 I ENITRL]"" D  Q:END
"RTN","ENTIUTL",52,0)
 . I $Y+3>IOSL D @ENTAG Q:END  D CAPEQHD1
"RTN","ENTIUTL",53,0)
 . N DIWF,DIWL,DIWR,X
"RTN","ENTIUTL",54,0)
 . K ^UTILITY($J,"W")
"RTN","ENTIUTL",55,0)
 . S DIWL=3,DIWR=79,DIWF="W|"
"RTN","ENTIUTL",56,0)
 . S X="IT Remote Location: " D ^DIWP
"RTN","ENTIUTL",57,0)
 . S X=ENITRL D ^DIWP
"RTN","ENTIUTL",58,0)
 . D ^DIWW
"RTN","ENTIUTL",59,0)
 I '$G(SITC),$O(^ENG(6914,ENDA,"ITC",0)) D
"RTN","ENTIUTL",60,0)
 . N DIWF,DIWL,DIWR,X
"RTN","ENTIUTL",61,0)
 . K ^UTILITY($J,"W")
"RTN","ENTIUTL",62,0)
 . S DIWL=3,DIWR=79,DIWF="W|"
"RTN","ENTIUTL",63,0)
 . S X="IT Comments: " D ^DIWP
"RTN","ENTIUTL",64,0)
 . S ENI=0 F  S ENI=$O(^ENG(6914,ENDA,"ITC",ENI)) Q:'ENI  D  Q:END
"RTN","ENTIUTL",65,0)
 . . I $Y+3>IOSL D @ENTAG Q:END  D CAPEQHD1
"RTN","ENTIUTL",66,0)
 . . S X=$G(^ENG(6914,ENDA,"ITC",ENI,0)) D ^DIWP
"RTN","ENTIUTL",67,0)
 . I END K ^UTILITY($J,"W") Q
"RTN","ENTIUTL",68,0)
 . I $Y+3>IOSL D @ENTAG I END K ^UTILITY($J,"W") Q
"RTN","ENTIUTL",69,0)
 . D ^DIWW
"RTN","ENTIUTL",70,0)
 Q
"RTN","ENTIUTL",71,0)
 ;
"RTN","ENTIUTL",72,0)
CAPEQHD ; Captioned Equipment Display Default Header
"RTN","ENTIUTL",73,0)
 I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR I 'Y S END=1 Q
"RTN","ENTIUTL",74,0)
 W @IOF
"RTN","ENTIUTL",75,0)
 Q
"RTN","ENTIUTL",76,0)
CAPEQHD1 ; Captioned Equipment Display Second Header
"RTN","ENTIUTL",77,0)
 W "Equipment Entry #: ",ENDA," (continued)"
"RTN","ENTIUTL",78,0)
 Q
"RTN","ENTIUTL",79,0)
 ;
"RTN","ENTIUTL",80,0)
DISASGN(ENDA) ; Display Active Assignments for Equipment to Screen
"RTN","ENTIUTL",81,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,ENADA,END,ENSTAT,X,Y
"RTN","ENTIUTL",82,0)
 ; display assignment data
"RTN","ENTIUTL",83,0)
 S END=0
"RTN","ENTIUTL",84,0)
 D DISASGNH
"RTN","ENTIUTL",85,0)
 I '$D(^ENG(6916.3,"AEA",ENDA)) W !," no active assignments" Q
"RTN","ENTIUTL",86,0)
 S ENADA=0
"RTN","ENTIUTL",87,0)
 F  S ENADA=$O(^ENG(6916.3,"AEA",ENDA,ENADA)) Q:'ENADA  D  Q:END
"RTN","ENTIUTL",88,0)
 . I $Y+4>IOSL D  Q:END
"RTN","ENTIUTL",89,0)
 . . S DIR(0)="E" D ^DIR K DIR I 'Y S END=1 Q
"RTN","ENTIUTL",90,0)
 . . W @(IOF) D DISASGNH W !," Entry #: ",ENDA," (continued)"
"RTN","ENTIUTL",91,0)
 . W !,$$GET1^DIQ(6916.3,ENADA,1)
"RTN","ENTIUTL",92,0)
 . W ?32,$P($$GET1^DIQ(6916.3,ENADA,2),"@")
"RTN","ENTIUTL",93,0)
 . S ENSTAT=$$GET1^DIQ(6916.3,ENADA,20)
"RTN","ENTIUTL",94,0)
 . W ?46,ENSTAT
"RTN","ENTIUTL",95,0)
 . I ENSTAT'="ASSIGNED" W ?57,$$GET1^DIQ(6916.3,ENADA,21)
"RTN","ENTIUTL",96,0)
 Q
"RTN","ENTIUTL",97,0)
DISASGNH ; Display Assignments Header
"RTN","ENTIUTL",98,0)
 W !!,"Responsible Person",?32,"Assigned DT",?46,"Status",?57,"Status DT"
"RTN","ENTIUTL",99,0)
 W !,"------------------------------",?32,"------------"
"RTN","ENTIUTL",100,0)
 W ?46,"---------",?57,"------------"
"RTN","ENTIUTL",101,0)
 Q
"RTN","ENTIUTL",102,0)
 ;
"RTN","ENTIUTL",103,0)
BLDHL2(ENSM,ENSMV,ENSRT) ; Build Header Line 2 String for Reports
"RTN","ENTIUTL",104,0)
 ; input
"RTN","ENTIUTL",105,0)
 ;   ENSM  = equipment selection method code
"RTN","ENTIUTL",106,0)
 ;   ENSMV = selection method ien value (for applicable methods)
"RTN","ENTIUTL",107,0)
 ;   ENSRT = sort by code
"RTN","ENTIUTL",108,0)
 ; returns string for page header second line
"RTN","ENTIUTL",109,0)
 N ENHL2
"RTN","ENTIUTL",110,0)
 ;
"RTN","ENTIUTL",111,0)
 S ENHL2=" for "
"RTN","ENTIUTL",112,0)
 S:ENSM="A" ENHL2=ENHL2_"All tracked IT equipment"
"RTN","ENTIUTL",113,0)
 S:ENSM="E" ENHL2=ENHL2_"selected equipment"
"RTN","ENTIUTL",114,0)
 S:ENSM="C" ENHL2=ENHL2_"CMR: "_$$GET1^DIQ(6914.1,ENSMV,.01)
"RTN","ENTIUTL",115,0)
 S:ENSM="U" ENHL2=ENHL2_"Using Service: "_$$GET1^DIQ(49,ENSMV,.01)
"RTN","ENTIUTL",116,0)
 S:ENSM="L" ENHL2=ENHL2_"Location: "_$$GET1^DIQ(6928,ENSMV,.01)
"RTN","ENTIUTL",117,0)
 S:ENSM="S" ENHL2=ENHL2_"Service of Loc: "_$$GET1^DIQ(49,ENSMV,.01)
"RTN","ENTIUTL",118,0)
 S ENHL2=ENHL2_" sorted by "
"RTN","ENTIUTL",119,0)
 S:ENSRT="E" ENHL2=ENHL2_"Entry #"
"RTN","ENTIUTL",120,0)
 S:ENSRT="C" ENHL2=ENHL2_"CMR"
"RTN","ENTIUTL",121,0)
 S:ENSRT="U" ENHL2=ENHL2_"Using Service"
"RTN","ENTIUTL",122,0)
 S:ENSRT="L" ENHL2=ENHL2_"Location"
"RTN","ENTIUTL",123,0)
 S:ENSRT="S" ENHL2=ENHL2_"Service of Loc."
"RTN","ENTIUTL",124,0)
 ;
"RTN","ENTIUTL",125,0)
 Q ENHL2
"RTN","ENTIUTL",126,0)
 ;
"RTN","ENTIUTL",127,0)
ADDNP ; Add New Person
"RTN","ENTIUTL",128,0)
 ; called by option ENIT ADD NEW PERSON
"RTN","ENTIUTL",129,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,ENX,X,Y
"RTN","ENTIUTL",130,0)
 W !!,"This option should only be used to add a person to the NEW PERSON"
"RTN","ENTIUTL",131,0)
 W !,"(#200) file when that person will be assigned responsibility for"
"RTN","ENTIUTL",132,0)
 W !,"IT equipment but is not already in the file and will NOT be given"
"RTN","ENTIUTL",133,0)
 W !,"a user account to sign on the computer.",!
"RTN","ENTIUTL",134,0)
 ;
"RTN","ENTIUTL",135,0)
 S DIR(0)="Y"
"RTN","ENTIUTL",136,0)
 S DIR("A")="Do you want to add an entry to the NEW PERSON file"
"RTN","ENTIUTL",137,0)
 S DIR("B")="NO"
"RTN","ENTIUTL",138,0)
 D ^DIR K DIR Q:$D(DIRUT)
"RTN","ENTIUTL",139,0)
 ;
"RTN","ENTIUTL",140,0)
 I Y W ! S ENX=$$ADD^XUSERNEW()
"RTN","ENTIUTL",141,0)
 I $P($G(ENX),U)>0,'$P(ENX,U,3) D
"RTN","ENTIUTL",142,0)
 . W !!,$P(ENX,U,2)," already exists with internal number ",$P(ENX,U),"."
"RTN","ENTIUTL",143,0)
 . W !,"If you want to enter a new record with that name, enter the"
"RTN","ENTIUTL",144,0)
 . W !,"name within quotes (e.g. ""Last,First"")",!
"RTN","ENTIUTL",145,0)
 Q
"RTN","ENTIUTL",146,0)
 ;
"RTN","ENTIUTL",147,0)
USRTRM ;Send MailMan message when user with active assignments is terminated
"RTN","ENTIUTL",148,0)
 Q:'$D(^ENG(6916.3,"AOA",XUIFN))
"RTN","ENTIUTL",149,0)
 N ENDA,ENERR,ENI,ENL,ENMFGNM,ENNAME,ENSPACE,ENTX,ENNBR,ENSTATUS,ENDATE,ENX,XMDUZ,XMMG,XMROU,XMSTRIP,XMSUB,XMTEXT,XMY,XMYBLOB,XMZ
"RTN","ENTIUTL",150,0)
 K ^TMP($J,"ENITUTL") S ENDA=XUIFN,$P(ENSPACE," ",41)=""
"RTN","ENTIUTL",151,0)
 D FIND^DIC(6916.3,"","@;.01;1;20;21","PQX",ENDA,"","AOA2","","","^TMP($J,""ENITUTL"")","ENERR")
"RTN","ENTIUTL",152,0)
 I $P($G(^TMP($J,"ENITUTL","DILIST",0)),U)'>0 K ^TMP($J,"ENITUTL") Q
"RTN","ENTIUTL",153,0)
 S ENNAME=$$GET1^DIQ(200,ENDA_",",".01","","","ENERR")
"RTN","ENTIUTL",154,0)
 S ENTX(1)="Owner: "_ENNAME_" ("_ENDA_")"
"RTN","ENTIUTL",155,0)
 S ENTX(2)="was terminated while having the following active IT responsibility assignments:"
"RTN","ENTIUTL",156,0)
 S ENTX(3)=" ",ENTX(4)="Entry#"_$E(ENSPACE,1,6)_"Mfg Equip Name"_$E(ENSPACE,1,11)_"Assignment Status"_$E(ENSPACE,1,3)_"Status Date",ENL=4
"RTN","ENTIUTL",157,0)
 S ENI=0
"RTN","ENTIUTL",158,0)
 F  S ENI=$O(^TMP($J,"ENITUTL","DILIST",ENI)) Q:+ENI'=ENI  D
"RTN","ENTIUTL",159,0)
 . S ENX=$G(^TMP($J,"ENITUTL","DILIST",ENI,0)) Q:ENX=""
"RTN","ENTIUTL",160,0)
 . S ENNBR=$P(ENX,U,2),ENSTATUS=$P(ENX,U,4),ENDATE=$P(ENX,U,5)
"RTN","ENTIUTL",161,0)
 . S ENMFGNM=$E($$GET1^DIQ(6914,ENNBR_",","3","","","ENERR"),1,20)
"RTN","ENTIUTL",162,0)
 . S ENL=ENL+1,ENTX(ENL)=ENNBR_$E(ENSPACE,$L(ENNBR)+1,12)_ENMFGNM_$E(ENSPACE,$L(ENMFGNM)+1,25)_ENSTATUS_$E(ENSPACE,$L(ENSTATUS)+1,20)_ENDATE
"RTN","ENTIUTL",163,0)
 S ENL=ENL+1,ENTX(ENL)=" ",ENL=ENL+1,ENTX(ENL)="   Number of Items= "_($P($G(^TMP($J,"ENITUTL","DILIST",0)),U)+0)
"RTN","ENTIUTL",164,0)
 S ENL=ENL+1,ENTX(ENL)=" ",ENL=ENL+1,ENTX(ENL)="These IT assignments are still active for "_ENNAME_".",ENL=ENL+1,ENTX(ENL)="If appropriate, use the transfer or terminate option to make changes."
"RTN","ENTIUTL",165,0)
 S XMDUZ="AEMS/MERS",XMSUB="Assigned Equipment of Terminated Owner: "_ENNAME
"RTN","ENTIUTL",166,0)
 S XMY("G.EN IT EQUIPMENT")="",XMTEXT="ENTX("
"RTN","ENTIUTL",167,0)
 D ^XMD
"RTN","ENTIUTL",168,0)
 K ^TMP($J,"ENITUTL")
"RTN","ENTIUTL",169,0)
 Q
"RTN","ENTIUTL",170,0)
 ;
"RTN","ENTIUTL",171,0)
 ;ENITUTL
"VER")
8.0^22.0
"^DD",6916.3,6916.3,1,0)
OWNER^RP200'I^VA(200,^0;2^Q
"^DD",6916.3,6916.3,1,1,0)
^.1
"^DD",6916.3,6916.3,1,1,1,0)
6916.3^C
"^DD",6916.3,6916.3,1,1,1,1)
S ^ENG(6916.3,"C",$E(X,1,30),DA)=""
"^DD",6916.3,6916.3,1,1,1,2)
K ^ENG(6916.3,"C",$E(X,1,30),DA)
"^DD",6916.3,6916.3,1,1,1,"%D",0)
^.101^1^1^3090106^^
"^DD",6916.3,6916.3,1,1,1,"%D",1,0)
Regular cross-reference by owner.
"^DD",6916.3,6916.3,1,1,1,"DT")
3071114
"^DD",6916.3,6916.3,1,3)
Select a person assigned responsibility for the equipment.
"^DD",6916.3,6916.3,1,21,0)
^^1^1^3071114^
"^DD",6916.3,6916.3,1,21,1,0)
The person assigned responsibility for the IT equipment item.
"^DD",6916.3,6916.3,1,"DT")
3090109
"BLD",7951,6)
^84
**END**
**END**
