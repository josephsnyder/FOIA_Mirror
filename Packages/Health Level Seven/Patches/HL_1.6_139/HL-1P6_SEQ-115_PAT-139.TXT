$TXT Created by MOORE,JIM at NXT.FO-OAKLAND.MED.VA.GOV  (KIDS) on Tuesday, 12/02/08 at 13:19
=============================================================================
Run Date: JUL 06, 2009                     Designation: HL*1.6*139
Package : HL - HEALTH LEVEL SEVEN             Priority: Mandatory
Version : 1.6       SEQ #115                    Status: Released
                  Compliance Date: AUG 06, 2009
=============================================================================

Associated patches: (v)HL*1.6*138  <<= must be installed BEFORE `HL*1.6*139'

Subject: HEALTH LEVEL SEVEN OPTIMIZED (HLO) ENHANCEMENTS

Category: 
  - Enhancement (Mandatory)
  - Routine
  - Data Dictionary

Description:
============

 Patch HL*1.6*139 provides several enhancements to
 Health Level Seven Optimized (HLO) software.
  
  Test Sites:
  ===========
  Montana HCS
  Upstate New York HCS (Bath)
  CMOP-NAT
  Oklahoma City
  
   
  REMEDY:  
  ======
  none
   
 
 
 Software Enhancements:
 ======================
  
 1) The HLO System Monitor will now perform a second check to determine the
    status of the listener.  The first check uses the HLO system parameters
    to find the IP address and port of the listener. If that check fails,
    a second check will use the IP address 0.0.0.0, which is the local system.
  
 2) The function $$ADDSEG^HLOAPI(HLMSTATE,SEG,ERROR,TOARY) will now return 
    the segment being added to the message in the optional fourth parameter.
    The developer can use this new feature by passing in a variable by
    reference to the function, as shown in the following example.
    
   Example: I $$ADDSEG^HLOAPI(.HLMSTATE,.SEG,.ERROR,.TOARY) ;--> TOARY will
   return the segment as a list of lines in this format:
  
         TOARY(1)
         TOARY(2)
         TOARY(3), etc.
  
    If the segment fits on a single line, only TOARY(1) is returned.
  
 3) A new field has been added to the HLO SYSTEM PARAMETERS (#779.1) file.
    The new field is UNSENT MSG RETENTION (DAYS) (#.12) field.
    This new field determines how long HLO messages are retained
    before purging if HLO has been unable to transmit them.  The
    default value is 45 days.  Sites can choose to retain  unsent
    messages however long they want by using the EDIT HLO SYSTEM PARAMETERS
    [EDIT HLO SYSTEM PARAMETERS] option to set the value of the
    UNSENT MSG RETENTION (DAYS) (#.12) field.
  
 4) A new option, EDIT HLO SYSTEM PARAMETERS [HLO EDIT SYSTEM PARAMETERS]
    option, has been added to the HLO MAIN MENU [HLO MAIN MENU] option.
    It is used to edit the system parameters used for HLO.
  
 5) HL7 EVENT field (#.02) and HL7 VERSION field (#.06) have been made
    identifiers in the MESSAGE TYPE ACTIONS field (#1) multiple of the
    HLO APPLICATION REGISTRY file (#779.2). 
  
 6) The DELETE QUEUE action of the HLO System Monitor option, located on
    the OUTGOING QUEUES screen,  has been changed so that it will delete
    the messages from the selected queue in the background.  Before this
    enhancement, deleting a queue with many messages on it could hang the
    user for several minutes while waiting for the deletion to complete. 
  
 7) The routine ^HLOCNRT1 was developed for the Hospital Acquired Infection
    and Influenza (HAIISS) project. The new routine can be called by
    the routing logic of a subscriber protocol.  Its purpose is to copy
    an HL7 message from the old HL7 1.6 engine to HLO and send it via
    HLO.  This allows new subscribers to existing HL7 1.6 messaging to
    use HLO.  This new routine is available only via private Integration
    Control Registration (ICR) to HAIISS and may not be used by other
    applications (ICR #5285). 
  
 8) The routine ^HLOAPI6 was developed to allow the VistA Data
    Extraction Framework (VDEF) application to verify that HLO is
    installed, running and has all the required parameters for a
    specific HL7 message type and HL7 event type.  These parameters must
    be defined prior to use by VDEF users before VDEF can use HLO. This
    new routine is available only via private ICR to VDEF and may not
    be used by other applications (ICR #5290). 
  
 Software Corrections:
 =====================
  
 1) In the HLO MESSAGE VIEWER [HLO MESSAGE VIEWER] option, when using the
    MESSAGE SEARCH action, at the following prompt, if the user entered lower
    case 'i' the message search would display the list of outgoing messages
    instead of the incoming messages. That has been fixed.
  
    Example:
  
    DM  DISPLAY MSG           ER  MESSAGE ERRORS        MS  MESSAGE SEARCH
    Select Action:Quit// MS   MESSAGE SEARCH  
    Enter the beginning date/time: Nov 17, 2008//  (NOV 17, 2008)
    Enter the ending date/time: NOW//  (NOV 18, 2008@18:51:28)
    Application: 
    HL7 Message Type: 
    HL7 Event: 
  
      Select one of the following:
  
           I         INCOMING
           O         OUTGOING
  
    Incoming or Outgoing: i  INCOMING
  
 2) The Visual Parser action the HLO Message Viewer would sometimes encounter
    a <MAXSTRING> error when parsing a message.  That has been fixed. 
  
 3) Corrects the spelling of the HLO APPLICATION REGISTRY option as it
    appears on the HLO MAIN MENU.   
   
 Installation Instructions:
 =========================
  
    1.  Users are allowed to be on the system during the installation. 
        Installation time is under 3 minutes.  
        
    2.  Disable the HL7 TCPIP services for the HLO multi-listener running on all
        nodes in the cluster. For example, at the VMS prompt in your production
        account:
  
          ISC6A1> TCPIP          <-- at the VMS prompt
          TCPIP> DISABLE SERVICE HLS5001CACHE  
  
          In your test account:
  
          ISC6A1> TCPIP          <-- at the VMS prompt
          TCPIP> DISABLE SERVICE HLS5026CACHE  
  
         You could also do this from the M programmer's prompt as follows:
  
         VISTA> D ^%CLI   <-- at the M programmer's prompt                       
         CLI command: TCPIP                 
         TCPIP> DISABLE SERVICE HLS5001CACHE  
  
    3.  Use the STOP HLO option of the HLO SYSTEM MONITOR screen to temporarily
        stop the transmission of HLO messages. Wait several minutes to insure 
        that all HLO processes have terminated.
  
        NOTE: There is a pre-install routine that will abort the installation
        if any HLO process is still running.  If the installation is aborted,
        verify that HLO is stopped, and restart the installation.
  
    4.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
  
    5.  This patch is now loaded into a transport global on your system.
        The next step is to use KIDS to install the Transport global.  On
        the KIDS menu, under the 'Installation' menu, use the following
        options:
  
           Verify Checksums in Transport Global
  
           Print Transport Global 
  
           Compare Transport Global to Current System 
  
           Backup a Transport Global
  
           Install Package(s) 
  
        When using the Install Package(s) menu option to install the patch
        build, you will be asked several questions.  The questions, and the
        answers you should supply, are shown below.
  
        INSTALL NAME: <HL*1.6*139>
  
        Want KIDS to Rebuild Menu Trees Upon Completion of Install?  <NO>
  
        Want KIDS to INHIBIT LOGONS during the install?  <NO>
  
        Want to DISABLE Scheduled Options, Menu Options,
  
          and Protocols?  <NO>
   
       A pre-install routine will verify that all HLO processes have been
       stopped before the installation will complete. 
   
    6. The post-init routine POST^HLOP139 will set the minimum number of 
       HLO processes to 1 for the CLIENT MESSAGE UPDATES and
       the SET SEARCH X-REF processes.  These processes are defined in
       the HLO PROCESS REGISTRY (file #779.3).
  
       NOTE: The routine HLOP139 will be automatically deleted upon
       completion of the installation.  
  
    7. Enable the HL7 TCPIP services for the multi-listeners
  
          For example, in a production account at the VMS prompt:
          ISC6A1> TCPIP             <-- at the VMS prompt
          TCPIP> ENABLE SERVICE HLS5001CACHE 
  
          For example, in a test account:
  
          ISC6A1> TCPIP             <-- at the VMS prompt
          TCPIP> ENABLE SERVICE HLS5026CACHE 
  
         You could also do this from the M programmer's prompt as follows:
  
         VISTA> D ^%CLI   <-- at the M programmer's prompt                       
         CLI command: TCPIP
         TCPIP> ENABLE SERVICE HLS5001CACHE   
  
    
    8. Use the  START HLO  option within the  HLO SYSTEM MONITOR  screen
       to resume transmission of HLO messages in your production account.
       This step is optional in test systems.
   
    9. On production systems, verify that outgoing messages have resumed
       being transmitted.  You can do this by monitoring the system via the
       HLO System Monitor for a few minutes to insure that the count of
       messages pending transmission is not growing.
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;1.6;HEALTH LEVEL SEVEN;**[Patch List]**;Oct 13, 1995;Build 11

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: HLOAPI
    Before: B91349575   After: B95686689  **126,133,138,139**
Routine Name: HLOAPI6
    Before:       n/a   After:  B9832520  **139**
Routine Name: HLOAPP
    Before: B11107696   After: B13112019  **126,132,137,139**
Routine Name: HLOCLNT
    Before: B73473677   After: B75551909  **126,130,131,134,137,139**
Routine Name: HLOCLNT1
    Before: B31047007   After: B32776376  **126,130,131,134,137,139**
Routine Name: HLOCNRT1
    Before:       n/a   After: B47676959  **139**
Routine Name: HLOP139
    Before:       n/a   After:  B1692838  **139**
Routine Name: HLOPROC1
    Before: B90713886   After: B91809391  **126,138,139**
Routine Name: HLOPRSR1
    Before: B20800062   After: B21086795  **138,139**
Routine Name: HLOPRSR2
    Before: B73937410   After: B77395727  **138,139**
Routine Name: HLOPURGE
    Before: B32660278   After: B32879435  **126,134,136,137,139**
Routine Name: HLOQUE1
    Before: B70409958   After: B78441748  **138,139**
Routine Name: HLOSRVR
    Before: B74637484   After: B77915377  **126,130,131,134,137,138,139**
Routine Name: HLOSRVR1
    Before: B66988549   After: B79956205  **126,130,131,133,134,137,138,139**
Routine Name: HLOT
    Before:  B2729395   After:  B3373728  **126,131,139**
Routine Name: HLOTCP
    Before: B54574560   After: B61182306  **126,131,134,137,138,139**
Routine Name: HLOTLNK
    Before: B23891993   After: B25754770  **126,130,131,139**
Routine Name: HLOUSR
    Before: B82341168   After: B90546721  **126,130,134,137,138,139**
Routine Name: HLOUSR3
    Before: B66058788   After: B66849245  **126,134,138,139**

=============================================================================
User Information:
Entered By  : MOORE,CHARLES J               Date Entered  : MAR 17, 2008
Completed By: BEST,LISA                     Date Completed: JUN 19, 2009
Released By : WHELAN,ROBERT E               Date Released : JUL 06, 2009
=============================================================================


Packman Mail Message:
=====================

$END TXT
