$TXT Created by HSU,RAYMOND at NXT.FO-OAKLAND.MED.VA.GOV  (KIDS) on Friday, 05/02/08 at 10:47
=============================================================================
Run Date: JUL 30, 2008                     Designation: HL*1.6*140
Package : HL - HEALTH LEVEL SEVEN             Priority: Mandatory
Version : 1.6       SEQ #112                    Status: Released
                  Compliance Date: AUG 30, 2008
=============================================================================

Associated patches: (v)HL*1.6*122  <<= must be installed BEFORE `HL*1.6*140'
                    (v)HL*1.6*123  <<= must be installed BEFORE `HL*1.6*140'

Subject: Reduce Cache Lock command impacts, enhance error trap, and protect IO variables

Category: 
  - Routine
  - Data Dictionary

Description:
============

 This patch changes and enhances the following functions:
  
 1. Changes the Cache Lock implementation in an effort to minimize
    processing delays.
   
 2. Enhances error prevention and trapping (in HLCSTCP1 and HLCSTCP4) that
    may be related to possible problems within the ^%ZIS global by making
    use of Kernel API HALT^ZU.
  
 3. Adds field, TCP/IP OPENFAIL TIMEOUT (#400.09),of HL LOGICAL LINK FILE
    to ScreenMan Form, HL7 LOGICAL LINK.
  
 4. Modify field, TCP/IP OPENFAIL TIMEOUT (#400.09),of HL LOGICAL LINK 
    FILE as follows:
  
               DESCRIPTION:      Enter the number of seconds for the TCP/IP
                                 Openfail Timeout. The default is 30 
                                 seconds if this field is left blank.
  
 5. Change variable, from IOF to HLTCPLNK("IOF") which is set by calling 
    Kernel API, $$FLUSHCHR^%ZISTCP, to fix the problem of Remedy HD 236547.
  
 6. During the testing of the patch, sites saw the following STATEs on the
    HL7 System Link Monitor screen.  The STATEs were introduced by patch
    HL*1.6*122 and an explanation of each STATE follows:
  
    TskLcked:
    A process has already been generated by TaskMan, the process is
    running, and the global ^HLCS("HLTCPLINK",<ien of the link>) has been
    locked by that process.
   
    Halt (Wr): (Disconnected with 'Wr-err'):
    (note: only the first 10 characters can be seen)
    The client link is abnormally disconnected by the remote COTS server,
    the client link can not "write" to the network, and may need to reopen
    the connection or restart a new process.
  
    Halt (Rd): (Disconnected with 'Rd-err'):
    (note: only the first 10 characters can be seen)
    The client link is abnormally disconnected by the remote COTS server,
    the client link can not "read" from the network, and may need to reopen
    the connection or restart a new process.
  
 7. "New" Kernel variables, IO,IOF,ION,IOT,IOST,POP in sub-entry 
    DIRECT^HLMA to protect application's IO* that calls the sub-entry.
  
  
 Test Sites:
 ===========
 LEBANON, PA
 LOMA LINDA, CA
 MARYLAND HCS
 NORTH TEXAS HCS
 SAN DIEGO, CA
 WASHINGTON DC
 BRONX, NY
 PORTLAND, OR 
 AUSTIN-MPI
  
  
 Remedy:
 =======
 HD 236547: hanging or superimposing in a list manager screen.
  
  
 INSTALLATION INSTRUCTIONS (takes fewer than 5 minutes):
 ========================================================
 Note: only experienced installer should attempt the install. 
  
   1.  Users are allowed to be on the system during the installation.  It 
       is highly recommended to install the patch during off-hours.
  
   2.  Disable the HL7 TCPIP services for the multi-listeners (listening 
       on port 5000) running on all nodes in the cluster, for example, at
       the VMS prompt:
  
         ISC6A1> TCPIP
         TCPIP> DISABLE SERVICE HLS5000CACHE  
  
   3.  Shutdown all Logical Links, incoming and outgoing filers using
       the Filer and Link Management options listed below:
  
         Stop All Messaging Background Processes [HL STOP ALL]
  
   4.  Shutdown the Link Manager using the Filer and Link Management
       option listed below:
  
         TCP Link Manager Start/Stop [HL START/STOP LINK MANAGER]
  
   5.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
       option will load the KIDS package onto your system.
  
   6.  This patch is now loaded into a transport global on your system.
       The next step is to use KIDS to install the Transport global.  On
       the KIDS menu, under the 'Installation' menu, use the following
       options:
  
          Verify Checksums in Transport Global
          Print Transport Global 
          Compare Transport Global to Current System 
          Backup a Transport Global
          Install Package(s) 
  
       When using the Install Package(s) menu option to install the 
       patch build, you will be asked several questions.  The questions,
       and the answers you should supply, are shown below.
  
        INSTALL NAME: <HL*1.6*140>
        Want KIDS to INHIBIT LOGONS during the install?  <NO>
        Want to DISABLE Scheduled Options, Menu Options,
          and Protocols?  <NO>
  
   7.  Start up all Logical Links and incoming and outgoing filers using
       the Filer and Link Management Option's 'Restart/Start All Links
       and Filers [HL TASK RESTART]' menu option.
       (Note those links that do not have "autostart" enabled will need
       to be restarted manually.)
   
   8.  Restart the Link Manager, that was shutdown in step 4, using the
       Filer and Link Management option listed below:
  
         TCP Link Manager Start/Stop [HL START/STOP LINK MANAGER]
  
   9. Enable the HL7 TCPIP services for the multi-listeners, for example, 
      at the VMS prompt:
  
         ISC6A1> TCPIP
         TCPIP> ENABLE SERVICE HLS5000CACHE 

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;1.6;HEALTH LEVEL SEVEN;**[Patch List]**;Oct 13, 1995;Build 5

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: HLCSIN
    Before: B34245145   After: B37729374  **2,30,14,19,62,109,115,122,140**
Routine Name: HLCSLM
    Before: B44055037   After: B44880128  **49,57,109,123,140**
Routine Name: HLCSTCP
    Before: B46918121   After: B47334373  **19,43,49,57,58,64,84,109,133,
                                           122,140**
Routine Name: HLCSTCP1
    Before: B70690150   After: B73767277  **19,43,57,64,71,133,132,122,140**
Routine Name: HLCSTCP2
    Before: B68574650   After: B70352129  **19,43,49,57,63,64,66,67,76,
                                           77,87,109,133,122,140**
Routine Name: HLCSTCP4
    Before: B39383548   After: B45823270  **109,122,140**
Routine Name: HLMA
    Before: B50301067   After: B52398960  **19,43,58,63,66,82,91,109,115,
                                           133,132,122,140**
Routine Name: HLTP3
    Before: B75102682   After: B75311331  **19,43,57,58,59,66,69,109,115,
                                           108,116,117,125,120,133,122,
                                           140**
 
Routine list of preceding patches: 122, 123

=============================================================================
User Information:
Entered By  : HSU,RAYMOND JL                Date Entered  : MAR 17, 2008
Completed By: GAYFIELD,LISA                 Date Completed: JUL 24, 2008
Released By : APOLONIO,AUGUSTO              Date Released : JUL 30, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
