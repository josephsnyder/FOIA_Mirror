$TXT Created by MOORE,JIM at NXT.FO-OAKLAND.MED.VA.GOV  (KIDS) on Friday, 08/29/08 at 12:30
=============================================================================
Run Date: OCT 08, 2008                     Designation: HL*1.6*138
Package : HL - HEALTH LEVEL SEVEN             Priority: Mandatory
Version : 1.6       SEQ #113                    Status: Released
                  Compliance Date: NOV 08, 2008
=============================================================================

Associated patches: (v)HL*1.6*137  <<= must be installed BEFORE `HL*1.6*138'

Subject: HLO MAINTENANCE PATCH

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Data Dictionary

Description:
============

 Patch HL*1.6*138 corrects several minor problems with
 HL7 OPTIMIZED (HLO) and provides several enhancements.
  
  Test Sites:
  ===========
  CMOP-NAT
  Bath
  Montana
  
   
  REMEDY:  
  ======
  HD0000000217284
  HD0000000229549
   
 Software Corrections:
 =====================
  
 1. Change Wording of Error Message.
    
    Messages must have either the receiving facility station number or the
    receiving station domain in the message header.  If neither is present,
    an error message is generated.  The wording of this message was changed
    from "RECEIVING FACILITY STATION # AND DOMAIN NOT SPECIFIED"  to
    "NEITHER RECEIVING FACILITY STATION # NOR DOMAIN SPECIFIED. AT LEAST
    ONE OR THE OTHER MUST BE SPECIFIED"  in order to clarify that one or
    the other (station number OR domain) must be present, but both are not
    required.
  
 2. Fix Page Count in the HLO SEQUENCE QUEUES screen of the HLO SYSTEM
    MONITOR (SM).
  
    When there are no messages pending on the HLO SEQUENCE QUEUES screen of
    the HLO SYSTEM MONITOR (SM), the sequence queue option screen
    incorrectly displayed the number of pages.  The code for this screen
    was modified to display "Page 0 of 0".
  
 3. Correct function $$REPROC^HLOAPI3 to prevent undefined error from
    occurring.
  
    Under certain conditions the routine that reprocesses incoming messages
    would cause an undefined error to occur.  The routine was changed to
    prevent such undefined errors from occurring.
  
 4. Correct HLO message building and processing routines to correctly replace
    escaped characters for MSA-3 fields containing error text.
  
    The message building and processing routines were not replacing HL7
    delimiters contained in the text fields of MSA-3 segments.  These routines
    were modified to replace the HL7 delimiters in those segments with escape
    codes.
     
 5. Fix Page Title on LP LIST PROCESSES option of the HLO SYSTEM MONITOR.
   
    The page title of the LP LIST PROCESSES option of the HLO SYSTEM
    MONITOR (SM) screen did not display the "P" in  PROCESS MANAGER.
    The code for the screen was modified such that the "P" would be properly
    displayed.
  
 6. Incoming messages that were rejected due to an unknown receiving
    application were not appearing on the list of message errors which is
    produced via the HLO MESSAGE ERRORS action on the HLO MESSAGE VIEWER
    screen, although the status was correctly being set to ERROR.  This was
    fixed.
  
 7. A bug has been corrected in the  RT RealTime Mode  within the  HLO SYSTEM
    MONITOR  screen. When queues become empty, their data structures are
    deleted automatically. In that situation, RealTime Mode caused an error,
    due to trying to read data structures which no longer exist.  That has
    been fixed.
  
 
 Software Enhancements:
 ======================
  
 1. Daily Recount of Queues to Update Counts of MESSAGES PENDING ON OUT QUEUES.
   
    Occasionally, the message counts displayed for pending queues may get out
    of synch with the actual number of messages pending on those queues, by
    just a message or two.  HLO was enhanced by recounting the messages
    pending on each queue at least once a day, and also each time HLO is
    started.
  
 2. Enhance the Message Status Display of the HLO MESSAGE VIEWER (MV).
  
    The Message  Status  display of the HLO MESSAGE VIEWER screen was enhanced
    by replacing the two letter status codes "SU" and "ER" with the words
    "SUCCESSFUL" and "ERROR".  In addition several new messages were added.
    If the message is an incoming message and is pending then the message
    "PENDING ON RECEIVING APPLICATION" is displayed in the status field.
    If the pending message is outgoing AND an acknowledgment was requested
    then the status message "TRANSMITTED, PENDING RECEIPT OF APPLICATION
    ACKNOWLEDGEMENT" is displayed.  Messages which have not been sent display
    "PENDING ON OUTGOING QUEUE  in the status field unless the message is at
    the top of the queue, in which case the status message is "TRANSMISSION
    IN PROGRESS".
    
 3. Enhance  DL DOWN LINKS  option in the HLO SYSTEM MONITOR screen
    Display of Down Links.
  
    The list of down links displayed on the  DOWN LINKS  option of the
    HLO SYSTEM MONITOR screen has been enhanced by the addition of the link
    name and the link port number.
  
 4. Add New Message Actions to the HLO MESSAGE VIEWER screen.
  
    Two new actions have been added to the Single Message Display screen within
    the HLO MESSAGE VIEWER screen, option  DM DISPLAY MESSAGE .  The first is
    the RS RESEND  action which allows outbound messages which have been
    previously sent, to be resent later by the user.  The second is the
    RP REPROCESS option which allows users reprocess an incoming message that
    has been processed.
  
 5. Add the HL EDIT LOGICAL LINK (EL) option to HLO MAIN MENU.
  
    HLO has been enhanced by the addition of the HL EDIT LOGICAL LINK (EL)
    option to the HLO main menu.  Previously this option could only be
    accessed from the HL7 Main Menu.
  
 6. A menu of actions has been added to the Outbound Queues screen.
  
    There are four new actions for outbound queues:
 
    DQ  DELETE QUEUE -     This can be used to remove all the messages
                           from an outbound queue.  ** EXTREME CARE MUST
                           BE USED **
    DT  DEL TOP MSG  -     This can be used to remove the top message from
                           a queue.  Using this action has the effect of
                           skipping the queue to the next message.
                           ** EXTREME CARE MUST BE USED **
    DM  DISPLAY MESSAGE -  This can be used to display a particular message
                           and the related administrative information. 
    RT  Real Time Display- This can be used to view changes to the outbound
                           queues as they occur. 
 
 7. Update of the  HLO SEQUENCE QUEUES  screen.
  
    The AQ ADVANCE QUEUE action on the HLO SEQUENCE QUEUES screen now provides
    the message ID of the message at the top of the queue as the default to
    the user prompt for that action.
  
 8. Add a HL7  VP VISUAL PARSER  option to the  Single Message Display  screen
    within the  HLO MESSAGE VIEWER  screen.
  
    The  Single Message Display  screen within HLO MESSAGE VIEWER screen, has
    been enhanced with the addition of a visual message parser option. This
    displays HL7 information about each segment and field as the user
    transverses through the message using the UP ARROW, DOWN ARROW, LEFT ARROW,
    and RIGHT ARROW keys.
   
 9. Add security keys to limit access to options/actions that delete messages
    or queues, and allow resending or reprocessing of message.
  
    Two new securities keys have been added to the  Security Key file (#19.1):
  
    The first key,  HLOMAIN  grants access to the HLO MAIN MENU screen, and
    within that menu, limits the user's ability to reprocess or resend
    messages.
  
    The second key,  HLOMGR  grants additional access to the  HLO SYSTEM
    MONITOR screen.  This key also grants the user access to message deletion,
    queue deletion, and message resend and reprocessing features.
  
 10. Add multiple verification prompts to message deletion, queue deletion,
     message resend and message reprocessing actions.  When attempting any of
     the above actions the following sequence of prompts is displayed:
  
     !!!!! WARNING! - What you are about to do can result in lost messages !!!!!
  
     Enter RETURN to continue or '^' to exit:
  
     !!!!! message sequencing problems and database corruption 
  
     Enter RETURN to continue or '^' to exit
  
     Are you sure you want to continue? Enter <Yes> to continue No// >Yes
     Please verify by entering <ConTinue>   >ConTinue
  
     ****************************************************************************
     ****************************************************************************
     NOTE: The responses to the last two user replies are CASE SENSITIVE, and 
     must be entered EXACTLY as shown.  This is to insure that user is
     reading the prompts and being careful before allowing deletions. 
     ****************************************************************************
     ****************************************************************************
  
 11. When displaying an outgoing message in the HLO MESSAGE VIEWER screen, the
     'TransDt/Tm' field is now suffixed with an indication of how many
     transmission attempts were made.  A date/time in that field means that the
     message was transmitted.
   
  
 Patch Distribution Components:
 ==============================
  
 Included Files:
    HLO MESSAGES (#778):              partial file definition
                                      fld: COMPLETION STATUS(#.2) 
    HLO SYSTEM PARAMETERS (#779.1):   partial file definition -
                                      fld: HLO RECOUNT ON/OFF FLAG (#.11)
    HLO SEGMENT DEFINITIONS (#779.5): full file definition
  
  
 Included Options:                                     
    HL EDIT LOGICAL LINKS                         
    HLO MAIN MENU                                
  
 Included Security Keys:                                 
    HLOMAIN                                       
    HLOMGR     
                                     
 Included Protocols:                             
    HLO ADVANCE SEQUENCE QUEUE                  
    HLO APPLICATION ERRORED MESSAGES            
    HLO BRIEF SYSTEM STATUS                     
    HLO DELETE TOP MESSAGE              
    HLO DISPLAY OUT-GOING QUEUE MENU          
    HLO DISPLAY OUT-GOING QUEUES               
    HLO DISPLAY PROCESSES                       
    HLO DISPLAY SINGLE MESSAGE                 
    HLO DOWN LINKS                              
    HLO DOWN LINKS MENU                           
    HLO INCOMING QUEUES                    
    HLO MESSAGE ERRORS               
    HLO MESSAGE REPROCESS                      
    HLO MESSAGE RESEND                     
    HLO MESSAGE SEARCH                         
    HLO MESSAGE SEARCH MENU                      
    HLO MESSAGE VIEWER MENU                   
    HLO MONITOR MODE                         
    HLO OUTBOUND DELETE                      
    HLO RESTART LINK                         
    HLO SCROLL MODE                           
    HLO SEQUENCE DELETE                       
    HLO SEQUENCE QUEUE MENU                     
    HLO SEQUENCE QUEUES                        
    HLO SET PURGE                               
    HLO SHUTDOWN LINK                          
    HLO SINGLE MESSAGE ACTIONS MENU             
    HLO START MENU                                 
    HLO START/STOP ONE QUEUE                     
    HLO STOP SYSTEM                           
    HLO SYSTEM MONITOR MENU                  
    HLO TEST LINK                               
    HLO VIEW A LINK                                
    HLO VISUAL PARSER                            
  
 Included List Templates:                                
    HLO DISPLAY INCOMING QUEUES                
    HLO DISPLAY OUT-GOING QUEUES              
    HLO DOWN LINKS                            
    HLO MESSAGE SEARCH                             
    HLO MESSAGE VIEWER                          
    HLO OUTBOUND QUEUES                            
    HLO SEQUENCE QUEUES                            
    HLO SINGLE MESSAGE DISPLAY                 
    HLO SYSTEM MONITOR                          
  
  
 Installation Instructions:
 =========================
  
    1.  Users are allowed to be on the system during the installation. 
        Installation time is under 5 minutes.  
        
        ***************************************************************
        Note:  The patch does include files with data. While KIDS loads
        the data the installation will appear to freeze for several minutes,
        but that is normal. 
        ***************************************************************
   
    2.  Disable the HL7 TCPIP services for the HLO multi-listener running on all
        nodes in the cluster. For example, at the VMS prompt in your production
        account:
  
          ISC6A1> TCPIP          <-- at the VMS prompt
          TCPIP> DISABLE SERVICE HLS5001CACHE  
  
          In your test account:
  
          ISC6A1> TCPIP          <-- at the VMS prompt
          TCPIP> DISABLE SERVICE HLS5026CACHE  
  
         You could also do this from the M programmer's prompt as follows:
  
         VISTA> D ^%CLI   <-- at the M programmer's prompt                       
         CLI command: TCPIP                 
         TCPIP> DISABLE SERVICE HLS5001CACHE  
  
    3.  Use the STOP HLO option of the HLO SYSTEM MONITOR screen to temporarily
        stop the transmission of HLO messages. Wait several minutes to insure 
        that all HLO processes have terminated.
  
        NOTE: There is a pre-install routine that will abort the installation
        if any HLO process is still running.  If the installation is aborted,
        verify that HLO is stopped, and restart the installation.
  
    4.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
        option will load the KIDS package onto your system.
  
    5.  This patch is now loaded into a transport global on your system.
        The next step is to use KIDS to install the Transport global.  On
        the KIDS menu, under the 'Installation' menu, use the following
        options:
  
           Verify Checksums in Transport Global
  
           Print Transport Global 
  
           Compare Transport Global to Current System 
  
           Backup a Transport Global
  
           Install Package(s) 
  
        When using the Install Package(s) menu option to install the patch
        build, you will be asked several questions.  The questions, and the
        answers you should supply, are shown below.
  
        INSTALL NAME: <HL*1.6*138>
  
        Want KIDS to Rebuild Menu Trees Upon Completion of Install?  <NO>
  
        Want KIDS to INHIBIT LOGONS during the install?  <NO>
  
        Want to DISABLE Scheduled Options, Menu Options,
  
          and Protocols?  <NO>
   
       A pre-install routine will verify that all HLO processes have been
       stopped before the installation will complete. 
  
    6. Enable the HL7 TCPIP services for the multi-listeners
  
          For example, in a production account at the VMS prompt:
          ISC6A1> TCPIP             <-- at the VMS prompt
          TCPIP> ENABLE SERVICE HLS5001CACHE 
  
          For example, in a test account:
  
          ISC6A1> TCPIP             <-- at the VMS prompt
          TCPIP> ENABLE SERVICE HLS5026CACHE 
  
         You could also do this from the M programmer's prompt as follows:
  
         VISTA> D ^%CLI   <-- at the M programmer's prompt                       
         CLI command: TCPIP
         TCPIP> ENABLE SERVICE HLS5001CACHE   
  
    7.  Allocate yourself the two new security keys, HLOMGR and HLOMAIN. 
        Otherwise you will not be able to proceed to step 8.
  
    8. Use the  START HLO  option within the  HLO SYSTEM MONITOR  screen
       to resume transmission of HLO messages in your production account.
       This step is optional in test systems.
   
    9. On production systems, verify that outgoing messages have resumed
       being transmitted.  You can do this by monitoring the system via the
       HLO System Monitor for a few minutes to insure that the count of
       messages pending transmission is not growing.
  
 Post Installation:
 =================
  
  Once installation is complete the Information Resource Manager will need to
  assign the two new security keys to the appropriate staff. 
  
  The HLOMAIN key gives access to the HLO MAIN MENU.  It also prevents users
  from deleting queues or messages and from resending or reprocessing messages.
  
  The HLOMGR key gives the holder access to all HLO functionality.  Holders of
  this key must also have the HLOMAIN key in order to have access to the HLO
  MAIN MENU.
 
 
 
 
 
 
 
 
 
 

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;1.6;HEALTH LEVEL SEVEN;**[Patch List]**;Oct 13, 1995;Build 34

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: HLOAPI
    Before: B35965894   After: B91349575  **126,133,138**
Routine Name: HLOAPI2
    Before: B49752437   After: B70584205  **126,131,133,134,137,138**
Routine Name: HLOAPI3
    Before: B45863930   After: B99815060  **126,133,134,137,138**
Routine Name: HLOAPI5
    Before:       n/a   After: B90305828  **138**
Routine Name: HLOASUB1
    Before: B62125339   After: B68656659  **126,134,138**
Routine Name: HLOF778
    Before: B31789914   After: B31915800  **126,134,137,138**
Routine Name: HLOF778A
    Before: B40119510   After: B40090633  **126,134,137,138**
Routine Name: HLOMSG
    Before: B49107650   After: B50637674  **126,134,137,138**
Routine Name: HLOPRE
    Before:   B892063   After:   B892063  **134,136,137,138**
Routine Name: HLOPROC1
    Before: B37655107   After: B90713886  **126,138**
Routine Name: HLOPRS
    Before: B28621487   After: B28621828  **118,126,133,132,134,138**
Routine Name: HLOPRSR1
    Before:       n/a   After: B20800062  **138**
Routine Name: HLOPRSR2
    Before:       n/a   After: B73937410  **138**
Routine Name: HLOPRSR3
    Before:       n/a   After: B71114349  **138**
Routine Name: HLOQUE
    Before: B51452458   After: B63465084  **126,132,134,137,138**
Routine Name: HLOQUE1
    Before:       n/a   After: B70409958  **138**
Routine Name: HLOSITE
    Before:  B5183865   After:  B6862294  **126,138**
Routine Name: HLOSRVR
    Before: B73015635   After: B74637484  **126,130,131,134,137,138**
Routine Name: HLOSRVR1
    Before: B72751153   After: B66988549  **126,130,131,133,134,137,138**
Routine Name: HLOSRVR2
    Before:  B4335684   After:  B5350765  **131,137,138**
Routine Name: HLOSRVR3
    Before:       n/a   After:  B2176219  **138**
Routine Name: HLOTCP
    Before: B46987670   After: B54574560  **126,131,134,137,138**
Routine Name: HLOUSR
    Before: B94026654   After: B82341168  **126,130,134,137,138**
Routine Name: HLOUSR1
    Before: B73632267   After:B105211577  **126,134,137,138**
Routine Name: HLOUSR2
    Before: B44868025   After: B47461747  **126,134,137,138**
Routine Name: HLOUSR3
    Before: B28592051   After: B66058788  **126,134,138**
Routine Name: HLOUSR4
    Before: B13499402   After: B15146335  **137,138**
Routine Name: HLOUSR5
    Before:       n/a   After: B13500475  **138**
Routine Name: HLOUSR6
    Before:       n/a   After: B15582735  **138**
Routine Name: HLOUSRA
    Before: B10710992   After: B13890812  **130,138**

=============================================================================
User Information:
Entered By  : MOORE,CHARLES J               Date Entered  : SEP 13, 2007
Completed By: GAYFIELD,LISA                 Date Completed: OCT 06, 2008
Released By : APOLONIO,AUGUSTO              Date Released : OCT 08, 2008
=============================================================================


Packman Mail Message:
=====================

$END TXT
