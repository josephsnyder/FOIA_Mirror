EMERGENCY Released GMPL*2*38 SEQ #33
Extracted from mail message
**KIDS**:GMPL*2.0*38^

**INSTALL NAME**
GMPL*2.0*38
"BLD",18784,0)
GMPL*2.0*38^PROBLEM LIST^0^3081113^y
"BLD",18784,1,0)
^^1^1^3081001^
"BLD",18784,1,1,0)
This patch contains a fix to an invalid values being set in file 9000011.
"BLD",18784,4,0)
^9.64PA^^
"BLD",18784,6)
^32
"BLD",18784,6.3)
3
"BLD",18784,"INIT")

"BLD",18784,"KRN",0)
^9.67PA^779.2^20
"BLD",18784,"KRN",.4,0)
.4
"BLD",18784,"KRN",.401,0)
.401
"BLD",18784,"KRN",.402,0)
.402
"BLD",18784,"KRN",.403,0)
.403
"BLD",18784,"KRN",.5,0)
.5
"BLD",18784,"KRN",.84,0)
.84
"BLD",18784,"KRN",3.6,0)
3.6
"BLD",18784,"KRN",3.8,0)
3.8
"BLD",18784,"KRN",9.2,0)
9.2
"BLD",18784,"KRN",9.8,0)
9.8
"BLD",18784,"KRN",9.8,"NM",0)
^9.68A^2^1
"BLD",18784,"KRN",9.8,"NM",2,0)
GMPLSAVE^^0^B29395469
"BLD",18784,"KRN",9.8,"NM","B","GMPLSAVE",2)

"BLD",18784,"KRN",19,0)
19
"BLD",18784,"KRN",19.1,0)
19.1
"BLD",18784,"KRN",101,0)
101
"BLD",18784,"KRN",409.61,0)
409.61
"BLD",18784,"KRN",771,0)
771
"BLD",18784,"KRN",779.2,0)
779.2
"BLD",18784,"KRN",870,0)
870
"BLD",18784,"KRN",8989.51,0)
8989.51
"BLD",18784,"KRN",8989.52,0)
8989.52
"BLD",18784,"KRN",8994,0)
8994
"BLD",18784,"KRN","B",.4,.4)

"BLD",18784,"KRN","B",.401,.401)

"BLD",18784,"KRN","B",.402,.402)

"BLD",18784,"KRN","B",.403,.403)

"BLD",18784,"KRN","B",.5,.5)

"BLD",18784,"KRN","B",.84,.84)

"BLD",18784,"KRN","B",3.6,3.6)

"BLD",18784,"KRN","B",3.8,3.8)

"BLD",18784,"KRN","B",9.2,9.2)

"BLD",18784,"KRN","B",9.8,9.8)

"BLD",18784,"KRN","B",19,19)

"BLD",18784,"KRN","B",19.1,19.1)

"BLD",18784,"KRN","B",101,101)

"BLD",18784,"KRN","B",409.61,409.61)

"BLD",18784,"KRN","B",771,771)

"BLD",18784,"KRN","B",779.2,779.2)

"BLD",18784,"KRN","B",870,870)

"BLD",18784,"KRN","B",8989.51,8989.51)

"BLD",18784,"KRN","B",8989.52,8989.52)

"BLD",18784,"KRN","B",8994,8994)

"BLD",18784,"QUES",0)
^9.62^^
"BLD",18784,"REQB",0)
^9.611^1^1
"BLD",18784,"REQB",1,0)
GMPL*2.0*37^2
"BLD",18784,"REQB","B","GMPL*2.0*37",1)

"MBREQ")
0
"PKG",232,-1)
1^1
"PKG",232,0)
PROBLEM LIST^GMPL^Automated Patient Problem List
"PKG",232,20,0)
^9.402P^^
"PKG",232,22,0)
^9.49I^1^1
"PKG",232,22,1,0)
2.0^2940825^2941214
"PKG",232,22,1,"PAH",1,0)
38^3081113
"PKG",232,22,1,"PAH",1,1,0)
^^1^1^3081113
"PKG",232,22,1,"PAH",1,1,1,0)
This patch contains a fix to an invalid values being set in file 9000011.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMPLSAVE")
0^2^B29395469^B29343254
"RTN","GMPLSAVE",1,0)
GMPLSAVE ; SLC/MKB/KER -- Save Problem List data ; 11/13/2008
"RTN","GMPLSAVE",2,0)
 ;;2.0;Problem List;**26,31,35,37,38**;Aug 25, 1994;Build 3
"RTN","GMPLSAVE",3,0)
 ;
"RTN","GMPLSAVE",4,0)
 ; External References
"RTN","GMPLSAVE",5,0)
 ;   DBIA 10018  ^DIE
"RTN","GMPLSAVE",6,0)
 ;   DBIA 10013  ^DIK
"RTN","GMPLSAVE",7,0)
 ;   DBIA 10013  IX1^DIK
"RTN","GMPLSAVE",8,0)
 ;   DBIA 10103  $$HTFM^XLFDT
"RTN","GMPLSAVE",9,0)
 ;
"RTN","GMPLSAVE",10,0)
EN ; Save Changes made to Existing Problem
"RTN","GMPLSAVE",11,0)
 N FLD,NOW,CHNGE,I,NIFN,TEXT,OLDTEXT,FAC,NODE,AUDITED,DR,DA,DIE,DIK
"RTN","GMPLSAVE",12,0)
 I $P($G(GMPFLD(1.14)),U)="0" S GMPFLD(1.14)=""
"RTN","GMPLSAVE",13,0)
 S:'GMPORIG(.01) GMPORIG(.01)=$$NOS^GMPLX
"RTN","GMPLSAVE",14,0)
 S:'GMPFLD(.01) GMPFLD(.01)=$$NOS^GMPLX
"RTN","GMPLSAVE",15,0)
 S:$D(GMPFLD(.01)) GMPFLD(.01)=+GMPFLD(.01)
"RTN","GMPLSAVE",16,0)
 S:$P(+GMPFLD(.01),U)=-1 GMPFLD(.01)=$$NOS^GMPLX ;chk for error from ICD
"RTN","GMPLSAVE",17,0)
 S:'GMPORIG(1.01) GMPORIG(1.01)="1^Unresolved"
"RTN","GMPLSAVE",18,0)
 S:'GMPFLD(1.01) GMPFLD(1.01)="1^Unresolved"
"RTN","GMPLSAVE",19,0)
 S:'GMPFLD(.05) I=$P(GMPFLD(.05),U,2),GMPFLD(.05)=$$PROVNARR^GMPLX(I,+GMPFLD(1.01))
"RTN","GMPLSAVE",20,0)
 S NOW=$$HTFM^XLFDT($H),AUDITED=0
"RTN","GMPLSAVE",21,0)
 S DR="1.02////"_$S('$D(GMPLUSER):"T",1:GMPFLD(1.02))
"RTN","GMPLSAVE",22,0)
 I GMPORIG(1.02)="T",GMPFLD(1.02)="P" D
"RTN","GMPLSAVE",23,0)
 . S CHNGE=GMPIFN_"^1.02^"_NOW_U_DUZ_"^T^P^Verified^"_DUZ
"RTN","GMPLSAVE",24,0)
 . D AUDIT^GMPLX(CHNGE,"")
"RTN","GMPLSAVE",25,0)
 I $P($G(GMPORIG(.12)),U)="I",$P(GMPFLD(.12),U)="A" D REACTV S AUDITED=1
"RTN","GMPLSAVE",26,0)
 I +$G(GMPORIG(1.01))'=(+GMPFLD(1.01)) D REFORM S AUDITED=1
"RTN","GMPLSAVE",27,0)
 S GMPFLD(.01)=+GMPFLD(.01) ;to remove text left by ?? lex (~)
"RTN","GMPLSAVE",28,0)
 F FLD=.01,.05,.12,.13,1.01,1.05,1.06,1.07,1.08,1.09,1.1,1.11,1.12,1.13,1.14,1.15,1.16,1.17,1.18 D
"RTN","GMPLSAVE",29,0)
 . Q:'$D(GMPFLD(FLD))  Q:$P($G(GMPORIG(FLD)),U)=$P($G(GMPFLD(FLD)),U)
"RTN","GMPLSAVE",30,0)
 . S DR=DR_";"_FLD_"////"_$S($P(GMPFLD(FLD),U)'="":$P(GMPFLD(FLD),U),1:"@")
"RTN","GMPLSAVE",31,0)
 . Q:AUDITED  S CHNGE=GMPIFN_U_FLD_U_NOW_U_DUZ_U_$P(GMPORIG(FLD),U)_U_$P(GMPFLD(FLD),U)_"^^"_+$G(GMPROV)
"RTN","GMPLSAVE",32,0)
 . D AUDIT^GMPLX(CHNGE,"")
"RTN","GMPLSAVE",33,0)
 S DA=GMPIFN,DIE="^AUPNPROB(" D ^DIE S GMPSAVED=1
"RTN","GMPLSAVE",34,0)
NOTES ; Save Changes to Notes
"RTN","GMPLSAVE",35,0)
 F I=0:0 S I=$O(GMPORIG(10,I)) Q:I'>0  I GMPORIG(10,I)'=GMPFLD(10,I) D
"RTN","GMPLSAVE",36,0)
 . S NIFN=+GMPFLD(10,I),FAC=$P(GMPFLD(10,I),U,2),TEXT=$P(GMPFLD(10,I),U,3),OLDTEXT=$P(GMPORIG(10,I),U,3)
"RTN","GMPLSAVE",37,0)
 . S NODE=$G(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0))
"RTN","GMPLSAVE",38,0)
 . I TEXT'="" S $P(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0),U,3)=TEXT D
"RTN","GMPLSAVE",39,0)
 .. I TEXT=OLDTEXT Q
"RTN","GMPLSAVE",40,0)
 .. S CHNGE=GMPIFN_"^1101^"_NOW_U_DUZ_"^C^^Note Modified^"_+$G(GMPROV)
"RTN","GMPLSAVE",41,0)
 . I TEXT=OLDTEXT Q
"RTN","GMPLSAVE",42,0)
 . I TEXT="" S CHNGE=GMPIFN_"^1101^"_NOW_U_DUZ_"^A^^Deleted Note^"_+$G(GMPROV)
"RTN","GMPLSAVE",43,0)
 . D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",44,0)
 . I TEXT="" D
"RTN","GMPLSAVE",45,0)
 .. S DIK="^AUPNPROB("_GMPIFN_",11,"_FAC_",11,"
"RTN","GMPLSAVE",46,0)
 .. S DA(2)=GMPIFN,DA(1)=FAC,DA=NIFN D ^DIK
"RTN","GMPLSAVE",47,0)
 I $D(GMPFLD(10,"NEW"))>9 D NEWNOTE
"RTN","GMPLSAVE",48,0)
EXIT ; Quit Saving Changes
"RTN","GMPLSAVE",49,0)
 D:$G(GMPSAVED) DTMOD^GMPLX(GMPIFN)
"RTN","GMPLSAVE",50,0)
 Q
"RTN","GMPLSAVE",51,0)
 ;
"RTN","GMPLSAVE",52,0)
REFORM ; Audit Entry that has been Reformulated
"RTN","GMPLSAVE",53,0)
 S CHNGE=GMPIFN_"^1.01^"_NOW_U_DUZ_U_+GMPORIG(1.01)_U_+GMPFLD(1.01)_"^Reformulated^"_+$G(GMPROV)
"RTN","GMPLSAVE",54,0)
 S NODE=$G(^AUPNPROB(GMPIFN,0))_U_$G(^AUPNPROB(GMPIFN,1))
"RTN","GMPLSAVE",55,0)
 D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",56,0)
 Q
"RTN","GMPLSAVE",57,0)
 ;
"RTN","GMPLSAVE",58,0)
REACTV ; Audit Entry that has been Reactivated
"RTN","GMPLSAVE",59,0)
 S CHNGE=GMPIFN_"^.12^"_NOW_U_DUZ_"^I^A^Reactivated^"_+$G(GMPROV)
"RTN","GMPLSAVE",60,0)
 S NODE=$G(^AUPNPROB(GMPIFN,0))_U_$G(^AUPNPROB(GMPIFN,1))
"RTN","GMPLSAVE",61,0)
 D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",62,0)
 Q
"RTN","GMPLSAVE",63,0)
 ;
"RTN","GMPLSAVE",64,0)
NEW ; Save Collected Values in new Problem Entry
"RTN","GMPLSAVE",65,0)
 ;   Output   DA (left defined)
"RTN","GMPLSAVE",66,0)
 N DATA,APCDLOOK,APCDALVR,NUM,I,DIK,GMPIFN,TEMP,X
"RTN","GMPLSAVE",67,0)
 I $P($G(GMPFLD(1.14)),U)="0" D
"RTN","GMPLSAVE",68,0)
 .I '$D(GMPFLD(1.18)) S GMPFLD(1.18)=GMPFLD(1.14)
"RTN","GMPLSAVE",69,0)
 .S GMPFLD(1.14)=""
"RTN","GMPLSAVE",70,0)
 S:'GMPFLD(.01) GMPFLD(.01)=$$NOS^GMPLX
"RTN","GMPLSAVE",71,0)
 S:$P(+GMPFLD(.01),U)=-1 GMPFLD(.01)=$$NOS^GMPLX ;chk for error from ICD
"RTN","GMPLSAVE",72,0)
 S GMPFLD(.01)=+GMPFLD(.01) ;to remove text left by ?? lex (~)
"RTN","GMPLSAVE",73,0)
 S:'GMPFLD(1.01) GMPFLD(1.01)="1^Unresolved"
"RTN","GMPLSAVE",74,0)
 S:'GMPFLD(.05) X=$P(GMPFLD(.05),U,2),GMPFLD(.05)=$$PROVNARR^GMPLX(X,+GMPFLD(1.01))
"RTN","GMPLSAVE",75,0)
 S DA=$$NEWPROB(+GMPFLD(.01),+GMPDFN) Q:DA'>0
"RTN","GMPLSAVE",76,0)
 S NUM=$$NEXTNMBR(+GMPDFN,+GMPVAMC),GMPSAVED=1 S:'NUM NUM=""
"RTN","GMPLSAVE",77,0)
 ;   Set Node 0
"RTN","GMPLSAVE",78,0)
 S DATA=^AUPNPROB(DA,0)_U_DT_"^^"_$P(GMPFLD(.05),U)_U_+GMPVAMC_U_+NUM_U_DT_"^^^^"_$P(GMPFLD(.12),U)_U_$P(GMPFLD(.13),U)
"RTN","GMPLSAVE",79,0)
 S ^AUPNPROB(DA,0)=DATA
"RTN","GMPLSAVE",80,0)
 ;   Set Node 1
"RTN","GMPLSAVE",81,0)
 S DATA=$P(GMPFLD(1.01),U) F I=1.02:.01:1.18 S DATA=DATA_U_$P($G(GMPFLD(+I)),U)
"RTN","GMPLSAVE",82,0)
 S ^AUPNPROB(DA,1)=DATA
"RTN","GMPLSAVE",83,0)
 ;   Set X-Refs
"RTN","GMPLSAVE",84,0)
 S DIK="^AUPNPROB(",(APCDLOOK,APCDALVR)=1 D IX1^DIK
"RTN","GMPLSAVE",85,0)
 I $D(GMPFLD(10,"NEW"))>9 S GMPIFN=DA D NEWNOTE
"RTN","GMPLSAVE",86,0)
 Q
"RTN","GMPLSAVE",87,0)
 ;
"RTN","GMPLSAVE",88,0)
NEWPROB(ICD,DFN) ; Creates New Problem Entry in file #9000011
"RTN","GMPLSAVE",89,0)
 N I,HDR,LAST,TOTAL,DA
"RTN","GMPLSAVE",90,0)
 L +^AUPNPROB(0):1 I '$T D  Q -1
"RTN","GMPLSAVE",91,0)
 . W !!,"Someone else is currently editing this file."
"RTN","GMPLSAVE",92,0)
 . W !,"Please try again later.",!
"RTN","GMPLSAVE",93,0)
 S HDR=$G(^AUPNPROB(0)) Q:HDR="" -1
"RTN","GMPLSAVE",94,0)
 S LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",95,0)
 F I=(LAST+1):1 Q:'$D(^AUPNPROB(I,0))
"RTN","GMPLSAVE",96,0)
 S DA=I,^AUPNPROB(DA,0)=ICD_U_DFN
"RTN","GMPLSAVE",97,0)
 S ^AUPNPROB("B",ICD,DA)="",^AUPNPROB("AC",DFN,DA)=""
"RTN","GMPLSAVE",98,0)
 S $P(^AUPNPROB(0),U,3,4)=DA_U_(TOTAL+1) L -^AUPNPROB(0)
"RTN","GMPLSAVE",99,0)
 Q DA
"RTN","GMPLSAVE",100,0)
 ;
"RTN","GMPLSAVE",101,0)
NEWNOTE ; Creates New Note Entries for Problem
"RTN","GMPLSAVE",102,0)
 ;   Requires GMPIFN   Pointer to Problem
"RTN","GMPLSAVE",103,0)
 ;            GMPROV   Current Provider
"RTN","GMPLSAVE",104,0)
 ;            GMPVAMC  Facility
"RTN","GMPLSAVE",105,0)
 N HDR,LAST,TOTAL,I,FAC,NIFN
"RTN","GMPLSAVE",106,0)
 L +^AUPNPROB(GMPIFN,11):1 I '$T Q
"RTN","GMPLSAVE",107,0)
 S FAC=+$O(^AUPNPROB(GMPIFN,11,"B",GMPVAMC,0)) I 'FAC D
"RTN","GMPLSAVE",108,0)
 . S:'$D(^AUPNPROB(GMPIFN,11,0)) ^(0)="^9000011.11PA^^"
"RTN","GMPLSAVE",109,0)
 . S HDR=^AUPNPROB(GMPIFN,11,0),LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",110,0)
 . F I=(LAST+1):1 Q:'$D(^AUPNPROB(GMPIFN,11,I,0))
"RTN","GMPLSAVE",111,0)
 . S ^AUPNPROB(GMPIFN,11,I,0)=GMPVAMC,^AUPNPROB(GMPIFN,11,"B",GMPVAMC,I)=""
"RTN","GMPLSAVE",112,0)
 . S FAC=I,$P(^AUPNPROB(GMPIFN,11,0),U,3,4)=FAC_U_(TOTAL+1)
"RTN","GMPLSAVE",113,0)
 I FAC'>0 G NNQ
"RTN","GMPLSAVE",114,0)
NN1 ; Get New Note
"RTN","GMPLSAVE",115,0)
 S:'$D(^AUPNPROB(GMPIFN,11,FAC,11,0)) ^(0)="^9000011.1111IA^^"
"RTN","GMPLSAVE",116,0)
 S HDR=^AUPNPROB(GMPIFN,11,FAC,11,0),LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",117,0)
 F I=(LAST+1):1 Q:'$D(^AUPNPROB(GMPIFN,11,FAC,11,I,0))
"RTN","GMPLSAVE",118,0)
 S NIFN=I
"RTN","GMPLSAVE",119,0)
 F I=0:0 S I=$O(GMPFLD(10,"NEW",I)) Q:I'>0  D
"RTN","GMPLSAVE",120,0)
 . S ^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0)=NIFN_"^^"_GMPFLD(10,"NEW",I)_"^A^"_DT_U_+$G(GMPROV)
"RTN","GMPLSAVE",121,0)
 . S ^AUPNPROB(GMPIFN,11,FAC,11,"B",NIFN,NIFN)=""
"RTN","GMPLSAVE",122,0)
 . S TOTAL=TOTAL+1,LAST=NIFN,NIFN=NIFN+1
"RTN","GMPLSAVE",123,0)
 S $P(^AUPNPROB(GMPIFN,11,FAC,11,0),U,3,4)=LAST_U_TOTAL
"RTN","GMPLSAVE",124,0)
NNQ ; Quit Getting New Notes
"RTN","GMPLSAVE",125,0)
 L -^AUPNPROB(GMPIFN,11)
"RTN","GMPLSAVE",126,0)
 Q
"RTN","GMPLSAVE",127,0)
 ;
"RTN","GMPLSAVE",128,0)
NEXTNMBR(DFN,VAMC) ; Returns Next Available Problem Number
"RTN","GMPLSAVE",129,0)
 N I,J,NUM S NUM=1,I="" I '$D(^AUPNPROB("AA",DFN,VAMC)) Q NUM
"RTN","GMPLSAVE",130,0)
 F  S I=$O(^AUPNPROB("AA",DFN,VAMC,I)) Q:I=""  S J=$E(I,2,999),NUM=+J
"RTN","GMPLSAVE",131,0)
 S NUM=NUM+1
"RTN","GMPLSAVE",132,0)
 Q NUM
"VER")
8.0^22.0
**END**
**END**
