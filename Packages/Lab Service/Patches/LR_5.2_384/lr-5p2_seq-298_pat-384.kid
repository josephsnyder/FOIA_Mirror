Released LR*5.2*384 SEQ #298
Extracted from mail message
**KIDS**:LR*5.2*384^

**INSTALL NAME**
LR*5.2*384
"BLD",7767,0)
LR*5.2*384^LAB SERVICE^0^3080627^y
"BLD",7767,1,0)
^^5^5^3080527^
"BLD",7767,1,1,0)
This patch is a general purpose lab patch that addresses 2 issues.
"BLD",7767,1,2,0)
It corrects a formatting issue in the option Search for Criticals
"BLD",7767,1,3,0)
(LRSORC).  It also resolves an issue in LR7OSUM1 where 2 identical
"BLD",7767,1,4,0)
values are compared and they are evaluated as different because
"BLD",7767,1,5,0)
one of the values has a trailing or leading 0.
"BLD",7767,4,0)
^9.64PA^^
"BLD",7767,6)
1^
"BLD",7767,6.3)
2
"BLD",7767,"ABPKG")
n
"BLD",7767,"KRN",0)
^9.67PA^8989.52^19
"BLD",7767,"KRN",.4,0)
.4
"BLD",7767,"KRN",.401,0)
.401
"BLD",7767,"KRN",.402,0)
.402
"BLD",7767,"KRN",.403,0)
.403
"BLD",7767,"KRN",.5,0)
.5
"BLD",7767,"KRN",.84,0)
.84
"BLD",7767,"KRN",3.6,0)
3.6
"BLD",7767,"KRN",3.8,0)
3.8
"BLD",7767,"KRN",9.2,0)
9.2
"BLD",7767,"KRN",9.8,0)
9.8
"BLD",7767,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7767,"KRN",9.8,"NM",1,0)
LRSORC1A^^0^B22607963
"BLD",7767,"KRN",9.8,"NM",2,0)
LR7OSUM1^^0^B46743574
"BLD",7767,"KRN",9.8,"NM","B","LR7OSUM1",2)

"BLD",7767,"KRN",9.8,"NM","B","LRSORC1A",1)

"BLD",7767,"KRN",19,0)
19
"BLD",7767,"KRN",19.1,0)
19.1
"BLD",7767,"KRN",101,0)
101
"BLD",7767,"KRN",409.61,0)
409.61
"BLD",7767,"KRN",771,0)
771
"BLD",7767,"KRN",870,0)
870
"BLD",7767,"KRN",8989.51,0)
8989.51
"BLD",7767,"KRN",8989.52,0)
8989.52
"BLD",7767,"KRN",8994,0)
8994
"BLD",7767,"KRN","B",.4,.4)

"BLD",7767,"KRN","B",.401,.401)

"BLD",7767,"KRN","B",.402,.402)

"BLD",7767,"KRN","B",.403,.403)

"BLD",7767,"KRN","B",.5,.5)

"BLD",7767,"KRN","B",.84,.84)

"BLD",7767,"KRN","B",3.6,3.6)

"BLD",7767,"KRN","B",3.8,3.8)

"BLD",7767,"KRN","B",9.2,9.2)

"BLD",7767,"KRN","B",9.8,9.8)

"BLD",7767,"KRN","B",19,19)

"BLD",7767,"KRN","B",19.1,19.1)

"BLD",7767,"KRN","B",101,101)

"BLD",7767,"KRN","B",409.61,409.61)

"BLD",7767,"KRN","B",771,771)

"BLD",7767,"KRN","B",870,870)

"BLD",7767,"KRN","B",8989.51,8989.51)

"BLD",7767,"KRN","B",8989.52,8989.52)

"BLD",7767,"KRN","B",8994,8994)

"BLD",7767,"QUES",0)
^9.62^^
"BLD",7767,"REQB",0)
^9.611^2^2
"BLD",7767,"REQB",1,0)
LR*5.2*286^2
"BLD",7767,"REQB",2,0)
LR*5.2*351^2
"BLD",7767,"REQB","B","LR*5.2*286",1)

"BLD",7767,"REQB","B","LR*5.2*351",2)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
384^3080627^33308
"PKG",26,22,1,"PAH",1,1,0)
^^5^5^3080627
"PKG",26,22,1,"PAH",1,1,1,0)
This patch is a general purpose lab patch that addresses 2 issues.
"PKG",26,22,1,"PAH",1,1,2,0)
It corrects a formatting issue in the option Search for Criticals
"PKG",26,22,1,"PAH",1,1,3,0)
(LRSORC).  It also resolves an issue in LR7OSUM1 where 2 identical
"PKG",26,22,1,"PAH",1,1,4,0)
values are compared and they are evaluated as different because
"PKG",26,22,1,"PAH",1,1,5,0)
one of the values has a trailing or leading 0.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LR7OSUM1")
0^2^B46743574^B40180103
"RTN","LR7OSUM1",1,0)
LR7OSUM1 ;DALOI/dcm - Silent Patient cum cont. ; Mar 11, 2003
"RTN","LR7OSUM1",2,0)
 ;;5.2;LAB SERVICE;**121,187,256,286,384**;Sep 27, 1994;Build 2
"RTN","LR7OSUM1",3,0)
 ;
"RTN","LR7OSUM1",4,0)
LRIDT ; from LR7OSUM
"RTN","LR7OSUM1",5,0)
 F  S LRIDT=$O(^LR(LRDFN,"CH",LRIDT)) Q:LRIDT<1!(LRIDT>LROUT)!(CT1>COUNT)  I $D(^(LRIDT,0)) S X=^(0),CT1=CT1+1 D LRIIDT
"RTN","LR7OSUM1",6,0)
 Q
"RTN","LR7OSUM1",7,0)
 ;
"RTN","LR7OSUM1",8,0)
LRIIDT ;
"RTN","LR7OSUM1",9,0)
 S (LRIIDT,LRVIDT)=$P(X,U,1),LRSUB=1,LRTNN=1,LRSPM=$P(X,U,5),LRTLOC=$E($P(X,U,11),1,7),LRVDT=$P(X,U,3),LRAN=$P(X,U,6)
"RTN","LR7OSUM1",10,0)
 Q:'$L(LRVDT)
"RTN","LR7OSUM1",11,0)
 D LRSUB
"RTN","LR7OSUM1",12,0)
 Q
"RTN","LR7OSUM1",13,0)
 ;
"RTN","LR7OSUM1",14,0)
 ;
"RTN","LR7OSUM1",15,0)
LRSUB ;
"RTN","LR7OSUM1",16,0)
 N LRTRES
"RTN","LR7OSUM1",17,0)
 S LRSUB=1
"RTN","LR7OSUM1",18,0)
 F  S LRSUB=$O(^LR(LRDFN,"CH",LRIDT,LRSUB)) Q:LRSUB<1  D
"RTN","LR7OSUM1",19,0)
 . S X=^LR(LRDFN,"CH",LRIDT,LRSUB)
"RTN","LR7OSUM1",20,0)
 . S LRTRES=$$TSTRES^LRRPU(LRDFN,"CH",LRIDT,LRSUB,"")
"RTN","LR7OSUM1",21,0)
 . D SUB1
"RTN","LR7OSUM1",22,0)
 Q
"RTN","LR7OSUM1",23,0)
SUB1 ;
"RTN","LR7OSUM1",24,0)
 S LRTSTVAL=$P(X,U,1),X1=$P(X,U,2)
"RTN","LR7OSUM1",25,0)
 S LRNOFL="",LRTST=$O(^LAB(60,"C","CH;"_LRSUB_";"_1,0))
"RTN","LR7OSUM1",26,0)
 Q:LRTST=""
"RTN","LR7OSUM1",27,0)
 Q:"IN"[$P(^LAB(60,LRTST,0),U,3)
"RTN","LR7OSUM1",28,0)
 I '$D(^LAB(64.5,"AC",LRSUB)) D MISC Q
"RTN","LR7OSUM1",29,0)
 K LRNON
"RTN","LR7OSUM1",30,0)
 D LRMH
"RTN","LR7OSUM1",31,0)
 I '$D(LRNON) D MISC
"RTN","LR7OSUM1",32,0)
 Q
"RTN","LR7OSUM1",33,0)
 ;
"RTN","LR7OSUM1",34,0)
LRMH ;
"RTN","LR7OSUM1",35,0)
 S LRMH=0
"RTN","LR7OSUM1",36,0)
 F  S LRMH=$O(^LAB(64.5,"AC",LRSUB,1,LRMH)) Q:LRMH<1  D LRSH
"RTN","LR7OSUM1",37,0)
 Q
"RTN","LR7OSUM1",38,0)
 ;
"RTN","LR7OSUM1",39,0)
LRSH ;
"RTN","LR7OSUM1",40,0)
 S LRSH=0
"RTN","LR7OSUM1",41,0)
 F  S LRSH=$O(^LAB(64.5,"AC",LRSUB,1,LRMH,LRSH)) Q:LRSH<1  D TST
"RTN","LR7OSUM1",42,0)
 Q
"RTN","LR7OSUM1",43,0)
 ;
"RTN","LR7OSUM1",44,0)
TST ;
"RTN","LR7OSUM1",45,0)
 S LRTSTS=0
"RTN","LR7OSUM1",46,0)
 F  S LRTSTS=$O(^LAB(64.5,"AC",LRSUB,1,LRMH,LRSH,LRTSTS)) Q:'LRTSTS  S LRSPM1=^(LRTSTS) D TST1
"RTN","LR7OSUM1",47,0)
 Q
"RTN","LR7OSUM1",48,0)
 ;
"RTN","LR7OSUM1",49,0)
 ;
"RTN","LR7OSUM1",50,0)
TST1 ;
"RTN","LR7OSUM1",51,0)
 Q:LRSPM'=LRSPM1
"RTN","LR7OSUM1",52,0)
SBSET ;
"RTN","LR7OSUM1",53,0)
 S LRMHN=$P(^LAB(64.5,1,1,LRMH,0),U,1),LRTF=^(1,LRSH,0),$P(LRTF,U,4)=$P(LRTF,U,3),$P(LRTF,U,3)=$P(^(1,0),U,4),LRNON=1
"RTN","LR7OSUM1",54,0)
 Q:$S('$D(SUBHEAD):0,1:'$D(SUBHEAD($P(LRTF,"^"))))
"RTN","LR7OSUM1",55,0)
 ;
"RTN","LR7OSUM1",56,0)
 ;**  LRTE=Total minor headings
"RTN","LR7OSUM1",57,0)
 ;** LRMHN=Major heading name^TE^Lab performing tests
"RTN","LR7OSUM1",58,0)
 ;**  LRTF=Minor header^Profile specimen^Total tests^Type of display
"RTN","LR7OSUM1",59,0)
 ;
"RTN","LR7OSUM1",60,0)
 S LRIIDT=LRVIDT
"RTN","LR7OSUM1",61,0)
 S:'$D(^TMP($J,LRDFN,LRMH)) ^(LRMH)=LRMHN
"RTN","LR7OSUM1",62,0)
 S:'$D(^TMP($J,LRDFN,LRMH,LRSH))!($D(^(LRSH))=10) ^(LRSH)=LRTF_U
"RTN","LR7OSUM1",63,0)
 S:'$D(^TMP($J,LRDFN,LRMH,LRSH,LRIDT,0)) ^(0)=LRTLOC_U_LRVIDT_U_LRVDT_U_LRAN_U_LRIDT
"RTN","LR7OSUM1",64,0)
 ;
"RTN","LR7OSUM1",65,0)
LRTSTVAL ;
"RTN","LR7OSUM1",66,0)
 ;
"RTN","LR7OSUM1",67,0)
 S ^TMP($J,LRDFN,LRMH,LRSH,LRIDT,LRTSTS)=$P(LRTRES,"^")_"^"_$P(LRTRES,"^",2)
"RTN","LR7OSUM1",68,0)
 S X=$P($G(^LAB(64.5,1,1,LRMH,1,LRSH,1,LRTSTS,0)),"^",3)
"RTN","LR7OSUM1",69,0)
 I $L(X) S ^TMP("LRT",$J,X)=$P(LRTF,"^")
"RTN","LR7OSUM1",70,0)
 I $D(^LR(LRDFN,"CH",LRIDT,1,0)),'$D(^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",0)) D TEXT
"RTN","LR7OSUM1",71,0)
 D CHKUN
"RTN","LR7OSUM1",72,0)
 I $O(^LAB(60,LRTST,1,LRSPM,1,0)),'$D(^TMP($J,"EVAL",LRTST,LRSPM)) D
"RTN","LR7OSUM1",73,0)
 . S ^TMP($J,"EVAL",LRTST,LRSPM)=""
"RTN","LR7OSUM1",74,0)
 . N I,L,X,TST
"RTN","LR7OSUM1",75,0)
 . S I=0,TST=$S($L($P($G(^LAB(60,LRTST,.1)),"^")):$P(^(.1),"^"),1:$P(^LAB(60,LRTST,0),"^"))
"RTN","LR7OSUM1",76,0)
 . S L=+$O(^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",9999999),-1),L=L+1,^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",L,0)="Evaluation for "_TST_":"
"RTN","LR7OSUM1",77,0)
 . F  S I=$O(^LAB(60,LRTST,1,LRSPM,1,I)) Q:'I  S X=^(I,0) S L=L+1,^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",L,0)=X
"RTN","LR7OSUM1",78,0)
 Q
"RTN","LR7OSUM1",79,0)
 ;
"RTN","LR7OSUM1",80,0)
 ;
"RTN","LR7OSUM1",81,0)
MISC ;
"RTN","LR7OSUM1",82,0)
 Q:$S('$D(SUBHEAD):0,1:'$D(SUBHEAD("MISCELLANEOUS TESTS")))
"RTN","LR7OSUM1",83,0)
 S LRTST=$O(^LAB(60,"C","CH;"_LRSUB_";"_1,0))
"RTN","LR7OSUM1",84,0)
 Q:LRTST=""
"RTN","LR7OSUM1",85,0)
 Q:"IN"[$P(^LAB(60,LRTST,0),U,3)
"RTN","LR7OSUM1",86,0)
 S LRTOP=LRSPM
"RTN","LR7OSUM1",87,0)
 ;
"RTN","LR7OSUM1",88,0)
 S:'$D(^TMP($J,LRDFN,"MISC",LRIDT,0)) ^(0)=LRIDT_U_LRVIDT_U_LRVDT_U_LRAN_U_LRSPM
"RTN","LR7OSUM1",89,0)
 ;S ^TMP($J,LRDFN,"MISC",LRIDT,LRTNN)=LRTSTVAL_U_LRSPM_U_LRTST_U_X1_U_LRSUB
"RTN","LR7OSUM1",90,0)
 S ^TMP($J,LRDFN,"MISC",LRIDT,LRTNN)=$P(LRTRES,"^")_U_LRSPM_U_LRTST_U_$P(LRTRES,"^",2)_U_LRSUB_U_$P(LRTRES,"^",3,6)
"RTN","LR7OSUM1",91,0)
 ;
"RTN","LR7OSUM1",92,0)
 S X=$S($D(^LAB(60,LRTST,.1)):$P(^(.1),"^"),1:$P(^LAB(60,LRTST,0),"^")),^TMP("LRT",$J,X)="MISCELLANEOUS TESTS"
"RTN","LR7OSUM1",93,0)
 ;
"RTN","LR7OSUM1",94,0)
 ; Grab specimen comments
"RTN","LR7OSUM1",95,0)
 I $D(^LR(LRDFN,"CH",LRIDT,1,0)),'$D(^TMP($J,LRDFN,"MISC",LRIDT,"TX",0)) D
"RTN","LR7OSUM1",96,0)
 . S ^TMP($J,LRDFN,"MISC",LRIDT,"TX",0)="",L=0
"RTN","LR7OSUM1",97,0)
 . F  S L=$O(^LR(LRDFN,"CH",LRIDT,1,L)) Q:L<1  S ^TMP($J,LRDFN,"MISC",LRIDT,"TX",L,0)=^LR(LRDFN,"CH",LRIDT,1,L,0)
"RTN","LR7OSUM1",98,0)
 ;
"RTN","LR7OSUM1",99,0)
 ; Grab test interpretation
"RTN","LR7OSUM1",100,0)
 I $O(^LAB(60,LRTST,1,LRSPM,1,0)) D
"RTN","LR7OSUM1",101,0)
 . N I,L,X,TST
"RTN","LR7OSUM1",102,0)
 . S I=0,TST=$S($L($P($G(^LAB(60,LRTST,.1)),"^")):$P(^(.1),"^"),1:$P(^LAB(60,LRTST,0),"^"))
"RTN","LR7OSUM1",103,0)
 . S:'$D(^TMP($J,LRDFN,"MISC",LRIDT,"TX",0)) ^TMP($J,LRDFN,"MISC",LRIDT,"TX",0)=""
"RTN","LR7OSUM1",104,0)
 . S L=+$O(^TMP($J,LRDFN,"MISC",LRIDT,"TX",9999999),-1),L=L+1
"RTN","LR7OSUM1",105,0)
 . S ^TMP($J,LRDFN,"MISC",LRIDT,"TX",L,0)="Evaluation for "_TST_":"
"RTN","LR7OSUM1",106,0)
 . F  S I=$O(^LAB(60,LRTST,1,LRSPM,1,I)) Q:'I  S X=^(I,0) S L=L+1,^TMP($J,LRDFN,"MISC",LRIDT,"TX",L,0)=X
"RTN","LR7OSUM1",107,0)
 ;
"RTN","LR7OSUM1",108,0)
 S LRTNN=LRTNN+1
"RTN","LR7OSUM1",109,0)
 Q
"RTN","LR7OSUM1",110,0)
 ;
"RTN","LR7OSUM1",111,0)
 ;
"RTN","LR7OSUM1",112,0)
TEXT ;
"RTN","LR7OSUM1",113,0)
 S LRYESCOM=0
"RTN","LR7OSUM1",114,0)
 S M=0
"RTN","LR7OSUM1",115,0)
 F  S M=$O(^LR(LRDFN,"CH",LRIDT,1,M)) Q:M<1!(LRYESCOM)  F N=1:1:$L(^LR(LRDFN,"CH",LRIDT,1,M,0)) Q:LRYESCOM  S:$E(^(0),N)'[$C(32) LRYESCOM=1
"RTN","LR7OSUM1",116,0)
 Q:'LRYESCOM
"RTN","LR7OSUM1",117,0)
 S L=0
"RTN","LR7OSUM1",118,0)
 F  S L=$O(^LR(LRDFN,"CH",LRIDT,1,L)) Q:L<1  S ^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",L,0)=^LR(LRDFN,"CH",LRIDT,1,L,0)
"RTN","LR7OSUM1",119,0)
 Q
"RTN","LR7OSUM1",120,0)
 ;
"RTN","LR7OSUM1",121,0)
 ;
"RTN","LR7OSUM1",122,0)
MICRO ;from LR7OSUM
"RTN","LR7OSUM1",123,0)
 Q:'$D(^LR(LRDFN,"MI"))
"RTN","LR7OSUM1",124,0)
 N MICROCNT
"RTN","LR7OSUM1",125,0)
 S:'$D(LRUNKNOW) LRUNKNOW=$P(^LAB(69.9,1,1),U,5)
"RTN","LR7OSUM1",126,0)
 S (LRONESPC,LRONETST)="",LREND=0,MICROCNT=GCNT+1
"RTN","LR7OSUM1",127,0)
 I $O(^LR(LRDFN,"MI",0)) S ^TMP("LRH",$J,"MICROBIOLOGY")=MICROCNT
"RTN","LR7OSUM1",128,0)
 S LRWRDVEW="",LRSB=0,LRIDT=LRIN
"RTN","LR7OSUM1",129,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:LRIDT<1!(LRIDT>LROUT)!(CT1>COUNT)  S LRNLOC=LRLLOC,CT1=CT1+1 D EN1^LR7OSMZ0 S LRLLOC=LRNLOC
"RTN","LR7OSUM1",130,0)
 I GCNT'>MICROCNT K ^TMP("LRH",$J,"MICROBIOLOGY")
"RTN","LR7OSUM1",131,0)
 K %,A,A1,AGE,B,B1,DFN,DOB,DZ,I,J,LR2ORMOR,LRAA,LRACC,LRACN,LRAD,LRADM,LRADX,LRAFS,LRAX,LRBUG,LRCMNT,LRCS,LRDCOM,LREF,LREND,LRIFN,LRLLT,LRMD,LRNLOC,LRNS,LROK,LRONESPC,LRONETST,LRORG,LRPRE,LRPRINT
"RTN","LR7OSUM1",132,0)
 Q
"RTN","LR7OSUM1",133,0)
 ;
"RTN","LR7OSUM1",134,0)
 ;
"RTN","LR7OSUM1",135,0)
CHKUN ; Check units and normals with cumulative report values
"RTN","LR7OSUM1",136,0)
 ; Add comment if these differ from file #64.5 values
"RTN","LR7OSUM1",137,0)
 ;
"RTN","LR7OSUM1",138,0)
 N I,L,LRFLAG,LRHI,LRLO,LRLOHI,LRX,LRY,TST
"RTN","LR7OSUM1",139,0)
 S LRX=$G(^LAB(64.5,"A",1,LRMH,LRSH,LRTSTS)),LRFLAG=0
"RTN","LR7OSUM1",140,0)
 S TST=$P($G(^LAB(64.5,1,1,LRMH,1,LRSH,1,LRTSTS,0)),"^",3)
"RTN","LR7OSUM1",141,0)
 S LRY="*** For test "_TST
"RTN","LR7OSUM1",142,0)
 ; Check units - if different generate comment
"RTN","LR7OSUM1",143,0)
 I $$UP^XLFSTR($P(LRX,"^",7))'=$$UP^XLFSTR($P(LRTRES,"^",5)) S LRY=LRY_" Units: "_$P(LRTRES,"^",5),LRFLAG=1
"RTN","LR7OSUM1",144,0)
 ;
"RTN","LR7OSUM1",145,0)
 ; Check normals - if different generate comment
"RTN","LR7OSUM1",146,0)
 S @("LRLO="_$S($P(LRX,"^",2)'="":$P(LRX,"^",2),$P(LRX,"^",11)'="":$P(LRX,"^",11),1:""""""))
"RTN","LR7OSUM1",147,0)
 ;
"RTN","LR7OSUM1",148,0)
 S @("LRHI="_$S($P(LRX,"^",3)'="":$P(LRX,"^",3),$P(LRX,"^",12)'="":$P(LRX,"^",12),1:""""""))
"RTN","LR7OSUM1",149,0)
 I LRLO'=$P(LRTRES,"^",3)!(LRHI'=$P(LRTRES,"^",4)) D
"RTN","LR7OSUM1",150,0)
 . ; check to see if these values are numeric and are different because of leading or trailing zeroes
"RTN","LR7OSUM1",151,0)
 . I '$$REALDIFF Q
"RTN","LR7OSUM1",152,0)
 . I LRFLAG S LRY=LRY_" and"
"RTN","LR7OSUM1",153,0)
 . S LRY=LRY_" Normals: "_$P(LRTRES,"^",3)_"-"_$P(LRTRES,"^",4),LRFLAG=1
"RTN","LR7OSUM1",154,0)
 ;
"RTN","LR7OSUM1",155,0)
 I 'LRFLAG Q
"RTN","LR7OSUM1",156,0)
 ;
"RTN","LR7OSUM1",157,0)
 S L=+$O(^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",9999999),-1),L=L+1
"RTN","LR7OSUM1",158,0)
 S LRY=LRY_" ***",^TMP($J,LRDFN,LRMH,LRSH,LRIDT,"TX",L,0)=LRY
"RTN","LR7OSUM1",159,0)
 Q
"RTN","LR7OSUM1",160,0)
 ;
"RTN","LR7OSUM1",161,0)
 ;
"RTN","LR7OSUM1",162,0)
REALDIFF() ;
"RTN","LR7OSUM1",163,0)
 ; function to determine if values are numeric and are different
"RTN","LR7OSUM1",164,0)
 ; solely because of leading or trailing zeroes
"RTN","LR7OSUM1",165,0)
 ;     returns 0 if difference is because of leading/trailing zeroes
"RTN","LR7OSUM1",166,0)
 ;     returns 1 if differences are meaningful
"RTN","LR7OSUM1",167,0)
 N LRTRESLO,LRTRESHI,DIFF
"RTN","LR7OSUM1",168,0)
 S LRTRESLO=$P(LRTRES,"^",3),LRTRESHI=$P(LRTRES,"^",4)
"RTN","LR7OSUM1",169,0)
 S DIFF=0
"RTN","LR7OSUM1",170,0)
 I LRLO'=LRTRESLO S DIFF=1 D
"RTN","LR7OSUM1",171,0)
 . I LRLO?.N!(LRLO?.N1".".N) D
"RTN","LR7OSUM1",172,0)
 . . I LRTRESLO?.N!(LRTRESLO?.N1".".N) D
"RTN","LR7OSUM1",173,0)
 . . . I +LRLO=+LRTRESLO S DIFF=0
"RTN","LR7OSUM1",174,0)
 I DIFF Q 1
"RTN","LR7OSUM1",175,0)
 I LRHI'=LRTRESHI S DIFF=1 D
"RTN","LR7OSUM1",176,0)
 . I LRHI?.N!(LRHI?.N1".".N) D
"RTN","LR7OSUM1",177,0)
 . . I LRTRESHI?.N!(LRTRESHI?.N1".".N) D
"RTN","LR7OSUM1",178,0)
 . . . I +LRHI=+LRTRESHI S DIFF=0
"RTN","LR7OSUM1",179,0)
 I DIFF Q 1
"RTN","LR7OSUM1",180,0)
 Q 0
"RTN","LRSORC1A")
0^1^B22607963^B22179224
"RTN","LRSORC1A",1,0)
LRSORC1A ;DALISC/DRH - LRSORC Continued ;07-22-93
"RTN","LRSORC1A",2,0)
 ;;5.2;LAB SERVICE;**201,344,351,384**;Sep 27, 1994;Build 2
"RTN","LRSORC1A",3,0)
INIT ;
"RTN","LRSORC1A",4,0)
 S U="^"
"RTN","LRSORC1A",5,0)
 D CONTROL
"RTN","LRSORC1A",6,0)
 Q
"RTN","LRSORC1A",7,0)
CONTROL ;
"RTN","LRSORC1A",8,0)
 D SORT
"RTN","LRSORC1A",9,0)
 Q
"RTN","LRSORC1A",10,0)
SORT ;
"RTN","LRSORC1A",11,0)
 W:$E(IOST,1,2)="C-" @IOF
"RTN","LRSORC1A",12,0)
 W:$E(IOST,1,2)="P-" !
"RTN","LRSORC1A",13,0)
 D HDR
"RTN","LRSORC1A",14,0)
 D PRINT
"RTN","LRSORC1A",15,0)
 D:'LREND SUMMARY
"RTN","LRSORC1A",16,0)
 D END
"RTN","LRSORC1A",17,0)
 Q
"RTN","LRSORC1A",18,0)
SUMMARY ;
"RTN","LRSORC1A",19,0)
 I ($Y>(IOSL-7)) D:$E(IOST,1,2)="C-" WAIT Q:LREND  W @IOF D HDR
"RTN","LRSORC1A",20,0)
 F I=$Y:1:(IOSL-6) W !
"RTN","LRSORC1A",21,0)
 W ?20,"END OF SPECIAL REPORT"
"RTN","LRSORC1A",22,0)
 Q
"RTN","LRSORC1A",23,0)
END ;
"RTN","LRSORC1A",24,0)
 D:($E(IOST,1,2)="C-")&('LREND) WAIT
"RTN","LRSORC1A",25,0)
 W @IOF D:'$D(ZTQUEUED) ^%ZISC
"RTN","LRSORC1A",26,0)
 K ^TMP("LR",$J)
"RTN","LRSORC1A",27,0)
 K ZTRTN,ZTIO,ZTDESC,ZTSAVE,ZTSK,ZTQUEUED,%ZIS,POP,%H,%DT,DTOUT,DUOUT
"RTN","LRSORC1A",28,0)
 K DIR,DIC,I,T,C,X,Y,L0,SEX,AGE,DFN,DOB,PNM,SSN,VA("BID"),VA("PID"),VAERR
"RTN","LRSORC1A",29,0)
 K LRAA,LRAD,LRDFN,LRDPF,LREND,LRFAN,LRIDT,LRLAN,LRLCS,LRSUB1,LRSUB2
"RTN","LRSORC1A",30,0)
 K LRLLOC,LRTX,LRTST,LRTVAL,LRCRTFLG,LRAN,LRSRT,LRPAG,LRDATE,LRDASH,LRDAT
"RTN","LRSORC1A",31,0)
 K LRLOC,LRPTS,LREDT,LRPDT,LRSDT,LRTREC,LRPREC,LREDAT,LRSDAT,LRSPDAT
"RTN","LRSORC1A",32,0)
 K LRWRD,LRHDR2,LRSUB3,LRAAA
"RTN","LRSORC1A",33,0)
 Q
"RTN","LRSORC1A",34,0)
PRINT ;
"RTN","LRSORC1A",35,0)
 S LRSUB1=""
"RTN","LRSORC1A",36,0)
 I $O(^TMP("LR",$J,LRSUB1))="" W !!?30,"NO MATCHING DATA FOUND",!! Q
"RTN","LRSORC1A",37,0)
 F  S LRSUB1=$O(^TMP("LR",$J,LRSUB1)) Q:(LRSUB1="")!(LREND)  D
"RTN","LRSORC1A",38,0)
 .S LRSUB2=""
"RTN","LRSORC1A",39,0)
 .F  S LRSUB2=$O(^TMP("LR",$J,LRSUB1,LRSUB2)) Q:(LRSUB2="")!(LREND)  D
"RTN","LRSORC1A",40,0)
 ..S LRSUB3=""
"RTN","LRSORC1A",41,0)
 ..F  S LRSUB3=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3)) Q:(LRSUB3="")!(LREND)  D
"RTN","LRSORC1A",42,0)
 ...S LRAN=""
"RTN","LRSORC1A",43,0)
 ...F  S LRAN=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN)) Q:(LRAN="")!(LREND)  D
"RTN","LRSORC1A",44,0)
 ....S LRPREC=^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN)
"RTN","LRSORC1A",45,0)
 ....S LRDPF=$P(LRPREC,U,4)
"RTN","LRSORC1A",46,0)
 ....S PNM=$P(LRPREC,U),SSN=$P(LRPREC,U,2),LRLOC=$P(LRPREC,U,3)
"RTN","LRSORC1A",47,0)
 ....S LRSPEC=$P(^LAB(61,$P(LRPREC,U,6),0),U)
"RTN","LRSORC1A",48,0)
 ....S LRSPNUM=$P(LRPREC,U,6)
"RTN","LRSORC1A",49,0)
 ....S LRSPDAT=$P(LRPREC,U,5)
"RTN","LRSORC1A",50,0)
 ....I ($Y>(IOSL-8)) D:$E(IOST,1,2)="C-" WAIT Q:LREND  W @IOF D HDR
"RTN","LRSORC1A",51,0)
 ....;S PNM1=$P(PNM,","),PNM2=$P(PNM,",",2)
"RTN","LRSORC1A",52,0)
 ....;S LRCHNG=PNM1 D CHNCASE^LRSORA2 S PNM1=LRCHNG
"RTN","LRSORC1A",53,0)
 ....;S LRCHNG=PNM2 D CHNCASE^LRSORA2 S PNM2=LRCHNG
"RTN","LRSORC1A",54,0)
 ....;S PNM=PNM1_","_PNM2
"RTN","LRSORC1A",55,0)
 ....;S LRCHNG=LRSPEC D CHNCASE^LRSORA2 S LRSPEC=LRCHNG
"RTN","LRSORC1A",56,0)
 ....W !,$E(PNM,1,22),?23,$E(SSN,1,11) W:LRDPF=2 ?35,$E(LRLOC,1,12),?48,$E(LRAN,1,14)
"RTN","LRSORC1A",57,0)
 ....W ?63,LRSPDAT
"RTN","LRSORC1A",58,0)
 ....W !," ",LRSPEC
"RTN","LRSORC1A",59,0)
 ....D PRNTST
"RTN","LRSORC1A",60,0)
 Q
"RTN","LRSORC1A",61,0)
PRNTST ;
"RTN","LRSORC1A",62,0)
 N LRRLO,LRRHI,LRCLO,LRCHI,LRTLO,LRTHI,LRFLAG,VAR
"RTN","LRSORC1A",63,0)
 S I=""
"RTN","LRSORC1A",64,0)
 F  S I=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"TST",I)) Q:(I="")!(LREND)  D
"RTN","LRSORC1A",65,0)
 .S LRTREC=^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"TST",I)
"RTN","LRSORC1A",66,0)
 .S LRTST=$P(LRTREC,U),LRTVAL=$P(LRTREC,U,2),LRCRTFLG=$P(LRTREC,U,3)
"RTN","LRSORC1A",67,0)
 .I ($Y>(IOSL-7)) D
"RTN","LRSORC1A",68,0)
 ..D CONT D:$E(IOST,1,2)="C-" WAIT Q:LREND
"RTN","LRSORC1A",69,0)
 ..W @IOF D HDR
"RTN","LRSORC1A",70,0)
 ..W !,$E(PNM,1,22),?23,$E(SSN,1,11) W:LRDPF=2 ?35,$E(LRLOC,1,12),?48,$E(LRAN,1,14)
"RTN","LRSORC1A",71,0)
 ..W ?63,LRSPDAT
"RTN","LRSORC1A",72,0)
 .Q:LREND
"RTN","LRSORC1A",73,0)
 .S LRTX=$P(LRTREC,U,5)
"RTN","LRSORC1A",74,0)
 .S LRFLAG=$P(LRTREC,U,6)
"RTN","LRSORC1A",75,0)
 .S LRREF=$G(^LAB(60,LRTX,1,LRSPNUM,0))
"RTN","LRSORC1A",76,0)
 .; set ranges  LRFLAG on - from file 63     LRFLAG off - from file 60
"RTN","LRSORC1A",77,0)
 .S LRRLO=$S(LRFLAG:$P(LRTREC,U,7),1:$P(LRREF,U,2))
"RTN","LRSORC1A",78,0)
 .S LRRHI=$S(LRFLAG:$P(LRTREC,U,8),1:$P(LRREF,U,3))
"RTN","LRSORC1A",79,0)
 .S LRCLO=$S(LRFLAG:$P(LRTREC,U,9),1:$P(LRREF,U,4))
"RTN","LRSORC1A",80,0)
 .S LRCHI=$S(LRFLAG:$P(LRTREC,U,10),1:$P(LRREF,U,5))
"RTN","LRSORC1A",81,0)
 .S LRTLO=$S(LRFLAG:$P(LRTREC,U,11),1:$P(LRREF,U,11))
"RTN","LRSORC1A",82,0)
 .S LRTHI=$S(LRFLAG:$P(LRTREC,U,12),1:$P(LRREF,U,12))
"RTN","LRSORC1A",83,0)
 .F VAR="LRRLO","LRRHI","LRCLO","LRCHI" I @VAR="" S @VAR="none"
"RTN","LRSORC1A",84,0)
 .;
"RTN","LRSORC1A",85,0)
 .S LRTST=$P($G(^LAB(60,LRTX,.1)),U)
"RTN","LRSORC1A",86,0)
 .I LRTST="" S LRTST=$E($P(^LAB(60,LRTX,0),U),1,10)
"RTN","LRSORC1A",87,0)
 .;I 'LRTST S LRTST=$E($P(^LAB(60,LRTX,0),U),1,10)
"RTN","LRSORC1A",88,0)
 .;S LRCHNG=LRTST D CHNCASE^LRSORA2 S LRTST=LRCHNG
"RTN","LRSORC1A",89,0)
 .W !,?2,$E(LRTST,1,9),?12,$J(LRTVAL,6)
"RTN","LRSORC1A",90,0)
 .W ?19,$E($P(LRREF,U,7),1,10),?28,LRCRTFLG
"RTN","LRSORC1A",91,0)
 . I 'LRTLO,('LRTHI) D RANGE
"RTN","LRSORC1A",92,0)
 . I LRTLO W ?32,"Ther: ",LRTLO,"-"
"RTN","LRSORC1A",93,0)
 . I LRTHI W LRTHI D CRITICL
"RTN","LRSORC1A",94,0)
 I '$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",0)) W !
"RTN","LRSORC1A",95,0)
 E  D COM
"RTN","LRSORC1A",96,0)
 Q
"RTN","LRSORC1A",97,0)
COM ;Print comments on specimen
"RTN","LRSORC1A",98,0)
 W !,"COMMENT(S): "
"RTN","LRSORC1A",99,0)
 S C=""
"RTN","LRSORC1A",100,0)
 F  S C=$O(^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",C)) Q:(C="")!(LREND)  D
"RTN","LRSORC1A",101,0)
 .I ($Y>(IOSL-7)) D
"RTN","LRSORC1A",102,0)
 ..D CONT D:$E(IOST,1,2)="C-" WAIT Q:LREND
"RTN","LRSORC1A",103,0)
 ..W @IOF D HDR
"RTN","LRSORC1A",104,0)
 ..W !,$E(PNM,1,22),?23,$E(SSN,1,11) W:LRDPF=2 ?35,$E(LRLOC,1,12),?48,$E(LRAN,1,14)
"RTN","LRSORC1A",105,0)
 ..W ?63,LRSPDAT
"RTN","LRSORC1A",106,0)
 ..;W !,PNM,?35,SSN W:LRDPF=2 " ",LRLOC,?60,LRAN
"RTN","LRSORC1A",107,0)
 ..;D HDR
"RTN","LRSORC1A",108,0)
 ..W !,"COMMENT(S): "
"RTN","LRSORC1A",109,0)
 .Q:LREND
"RTN","LRSORC1A",110,0)
 .W ?12,^TMP("LR",$J,LRSUB1,LRSUB2,LRSUB3,LRAN,"COM",C),!
"RTN","LRSORC1A",111,0)
 Q
"RTN","LRSORC1A",112,0)
HDR ;
"RTN","LRSORC1A",113,0)
 S LRPAG=LRPAG+1
"RTN","LRSORC1A",114,0)
 W "SPECIAL REPORT: SEARCHING FOR CRITICAL FLAGS  "
"RTN","LRSORC1A",115,0)
 W LRDATE,?65,"Pg ",LRPAG,!,LRHDR2,!
"RTN","LRSORC1A",116,0)
 D LRGLIN^LRX
"RTN","LRSORC1A",117,0)
 Q
"RTN","LRSORC1A",118,0)
RANGE ;
"RTN","LRSORC1A",119,0)
 W ?31,"Ref. Range: ",LRRLO,"-",LRRHI
"RTN","LRSORC1A",120,0)
 D CRITICL
"RTN","LRSORC1A",121,0)
 Q
"RTN","LRSORC1A",122,0)
CRITICL ;
"RTN","LRSORC1A",123,0)
 W ?57,"Critical: ",LRCLO,"-",LRCHI
"RTN","LRSORC1A",124,0)
 Q
"RTN","LRSORC1A",125,0)
WAIT ;
"RTN","LRSORC1A",126,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","LRSORC1A",127,0)
 S:($D(DTOUT))!($D(DUOUT)) LREND=1
"RTN","LRSORC1A",128,0)
 Q
"RTN","LRSORC1A",129,0)
CONT W !?10,"CONTINUED NEXT PAGE",! Q
"VER")
8.0^22.0
"BLD",7767,6)
^298
**END**
**END**
