Released LR*5.2*309 SEQ #309
Extracted from mail message
**KIDS**:LR*5.2*309^

**INSTALL NAME**
LR*5.2*309
"BLD",5534,0)
LR*5.2*309^LAB SERVICE^0^3090129^y
"BLD",5534,1,0)
^^344^344^3090129^
"BLD",5534,1,1,0)
BLOOD BANK
"BLD",5534,1,2,0)
==========
"BLD",5534,1,3,0)
 
"BLD",5534,1,4,0)
VISTA Laboratory Package patch LR*5.2*309 contains changes to 
"BLD",5534,1,5,0)
software controlled by VHA DIRECTIVE 2004-058, titled VISTA 
"BLD",5534,1,6,0)
BLOOD BANK SOFTWARE. Changes include: 
"BLD",5534,1,7,0)
  
"BLD",5534,1,8,0)
 File          Field               Action
"BLD",5534,1,9,0)
   
"BLD",5534,1,10,0)
63.09,20      DESCRIPTION         Delete
"BLD",5534,1,11,0)
 
"BLD",5534,1,12,0)
All of the above changes have been reviewed by the VISTA Blood Bank
"BLD",5534,1,13,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE
"BLD",5534,1,14,0)
control functions.
"BLD",5534,1,15,0)
 
"BLD",5534,1,16,0)
RISK ANALYSIS: Changes made by patch LR*5.2*309 have no effect on Blood
"BLD",5534,1,17,0)
Bank software functionality, therefore RISK is none.
"BLD",5534,1,18,0)
  
"BLD",5534,1,19,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*309 does not
"BLD",5534,1,20,0)
alter or modify any software design safeguards or safety critical 
"BLD",5534,1,21,0)
elements functions.
"BLD",5534,1,22,0)
  
"BLD",5534,1,23,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines
"BLD",5534,1,24,0)
and 1 files identified in Veterans Health Administration (VHA) Directive
"BLD",5534,1,25,0)
2004-058, group B listing. The changes have no effect on Blood Bank
"BLD",5534,1,26,0)
functionality or medical device control functions. There is no adverse
"BLD",5534,1,27,0)
potential to sites.
"BLD",5534,1,28,0)
 
"BLD",5534,1,29,0)
VALIDATION REQUIREMENTS BY OPTION: 
"BLD",5534,1,30,0)
  
"BLD",5534,1,31,0)
There are no Validation requirements or options to be validated
"BLD",5534,1,32,0)
in this patch.
"BLD",5534,1,33,0)
  
"BLD",5534,1,34,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL 
"BLD",5534,1,35,0)
FUNCTIONS:
"BLD",5534,1,36,0)
  
"BLD",5534,1,37,0)
There are no Test Case Scenarios associated with this patch.
"BLD",5534,1,38,0)
   
"BLD",5534,1,39,0)
DESCRIPTION: 
"BLD",5534,1,40,0)
============ 
"BLD",5534,1,41,0)
This patch removes one field, the DESCRIPTION field (#20), in the
"BLD",5534,1,42,0)
LAB DATA file (#63) CYTOPATHOLOGY sub-file (#63.09), and a reference to
"BLD",5534,1,43,0)
this field in routine ^LRAUAW.
"BLD",5534,1,44,0)
 
"BLD",5534,1,45,0)
Although it is highly unlikely that data exists in the DESCRIPTION 
"BLD",5534,1,46,0)
field (#20), the patch also checks for data that may have been entered in
"BLD",5534,1,47,0)
the field.  Any data that is found is moved to the ^XTMP("LR309")
"BLD",5534,1,48,0)
global and stored for 180 days before it is purged. If data is found,
"BLD",5534,1,49,0)
the installation routine also generates and sends a mail message to the
"BLD",5534,1,50,0)
holders of security keys LRLIASON and LRAPSUPER to be used as a source
"BLD",5534,1,51,0)
document to determine how the data should be handled if at all.
"BLD",5534,1,52,0)
The message contains the LR*5.2*309 Data Report which lists the data 
"BLD",5534,1,53,0)
found, the accession number, the patient's name, social security number
"BLD",5534,1,54,0)
and gender.
"BLD",5534,1,55,0)
 
"BLD",5534,1,56,0)
DATA DICTIONARY CHANGES: 
"BLD",5534,1,57,0)
======================== 
"BLD",5534,1,58,0)
 The following is a list of the Data Dictionary entry in LAB DATA file 
"BLD",5534,1,59,0)
(#63) that will be deleted by this patch:
"BLD",5534,1,60,0)
  
"BLD",5534,1,61,0)
63.09,20      DESCRIPTION            WP;0    WORD-PROCESSING #63.91
"BLD",5534,1,62,0)
 
"BLD",5534,1,63,0)
              DESCRIPTION:
"BLD",5534,1,64,0)
                                Word processing field for description
"BLD",5534,1,65,0)
  
"BLD",5534,1,66,0)
 
"BLD",5534,1,67,0)
MODIFICATION OF THE LRAUAW ROUTINE:
"BLD",5534,1,68,0)
===================================
"BLD",5534,1,69,0)
Patch LR*5.2*309 also makes changes to the LRAUAW routine to remove a
"BLD",5534,1,70,0)
reference to the DESCRIPTION field (#20) of the CYTOPATHOLOGY sub-file
"BLD",5534,1,71,0)
(#63.09) in the LAB DATA file (#63).  The change will be transparent to
"BLD",5534,1,72,0)
the user.
"BLD",5534,1,73,0)
 
"BLD",5534,1,74,0)
NEW SERVICE REQUEST (NSR): 
"BLD",5534,1,75,0)
========================== 
"BLD",5534,1,76,0)
N/A. 
"BLD",5534,1,77,0)
  
"BLD",5534,1,78,0)
ASSOCIATED E3R: 
"BLD",5534,1,79,0)
=============== 
"BLD",5534,1,80,0)
N/A.                                                                     
"BLD",5534,1,81,0)
 
"BLD",5534,1,82,0)
ASSOCIATED NOIS: 
"BLD",5534,1,83,0)
================ 
"BLD",5534,1,84,0)
N/A. 
"BLD",5534,1,85,0)
  
"BLD",5534,1,86,0)
ASSOCIATED REMEDY TICKETS: 
"BLD",5534,1,87,0)
========================== 
"BLD",5534,1,88,0)
 HD0000000093288 
"BLD",5534,1,89,0)
  
"BLD",5534,1,90,0)
TEST SITES: 
"BLD",5534,1,91,0)
=========== 
"BLD",5534,1,92,0)
   Altoona, PA - small
"BLD",5534,1,93,0)
   Wilmington, DE - medium
"BLD",5534,1,94,0)
   Biloxi, MS - large
"BLD",5534,1,95,0)
 
"BLD",5534,1,96,0)
  
"BLD",5534,1,97,0)
SOFTWARE RETRIEVAL: 
"BLD",5534,1,98,0)
==================== 
"BLD",5534,1,99,0)
 This patch is distributed by KIDS as a Packman message. 
"BLD",5534,1,100,0)
  
"BLD",5534,1,101,0)
INSTALLATION INSTRUCTIONS: 
"BLD",5534,1,102,0)
========================== 
"BLD",5534,1,103,0)
This patch can be installed with users on the system.  It is recommended 
"BLD",5534,1,104,0)
to disable the Anatomic Pathology [LRAP] option at the "DISABLE Scheduled
"BLD",5534,1,105,0)
Options, Menu Options, and Protocols?" prompt.
"BLD",5534,1,106,0)
  
"BLD",5534,1,107,0)
Install Time - less than 5 minutes. 
"BLD",5534,1,108,0)
  
"BLD",5534,1,109,0)
1. Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu. This 
"BLD",5534,1,110,0)
   option will load the KIDS patch onto your system.
"BLD",5534,1,111,0)
  
"BLD",5534,1,112,0)
2. On the 'Kernel Installation & Distribution System' Menu (KIDS), select 
"BLD",5534,1,113,0)
   the 'Installation' menu.
"BLD",5534,1,114,0)
  
"BLD",5534,1,115,0)
3. Use the 'Verify Checksum in Transport Global' option and verify that 
"BLD",5534,1,116,0)
   all routines have the correct checksums.
"BLD",5534,1,117,0)
  
"BLD",5534,1,118,0)
4. On the KIDS menu, under the 'Installation' menu, use the following 
"BLD",5534,1,119,0)
   options: 
"BLD",5534,1,120,0)
        Print Transport Global 
"BLD",5534,1,121,0)
        Compare Transport Global to Current System 
"BLD",5534,1,122,0)
        Backup a Transport Global 
"BLD",5534,1,123,0)
  
"BLD",5534,1,124,0)
5. Use the 'Install Package(s)' option under the 'Installation' menu and 
"BLD",5534,1,125,0)
   select the package 'LR*5.2*309'.
"BLD",5534,1,126,0)
 
"BLD",5534,1,127,0)
6. When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES// 
"BLD",5534,1,128,0)
   choose 'NO'.
"BLD",5534,1,129,0)
 
"BLD",5534,1,130,0)
7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and 
"BLD",5534,1,131,0)
   Protocols? YES//', disable the Anatomic Pathology [LRAP] option. 
"BLD",5534,1,132,0)
 
"BLD",5534,1,133,0)
  
"BLD",5534,1,134,0)
  
"BLD",5534,1,135,0)
INSTALLATION EXAMPLE: 
"BLD",5534,1,136,0)
===================== 
"BLD",5534,1,137,0)
 
"BLD",5534,1,138,0)
Example #1 without data:
"BLD",5534,1,139,0)
========================   
"BLD",5534,1,140,0)
Select Installation Option: install Package(s)
"BLD",5534,1,141,0)
Select INSTALL NAME: LR*5.2*309       Loaded from Distribution  
"BLD",5534,1,142,0)
8/5/08@14:25:46
"BLD",5534,1,143,0)
     => LR*5.2*309
"BLD",5534,1,144,0)
 
"BLD",5534,1,145,0)
This Distribution was loaded on Aug 05, 2008@14:25:46 with header of 
"BLD",5534,1,146,0)
   LR*5.2*309
"BLD",5534,1,147,0)
   It consisted of the following Install(s):
"BLD",5534,1,148,0)
     LR*5.2*309
"BLD",5534,1,149,0)
Checking Install for Package LR*5.2*309
"BLD",5534,1,150,0)
Will first run the Environment Check Routine, LR309
"BLD",5534,1,151,0)
 
"BLD",5534,1,152,0)
 
"BLD",5534,1,153,0)
               Sending install started alert to mail group G.LMI
"BLD",5534,1,154,0)
 
"BLD",5534,1,155,0)
                        --- Environment Check is Ok ---
"BLD",5534,1,156,0)
 
"BLD",5534,1,157,0)
Install Questions for LR*5.2*309
"BLD",5534,1,158,0)
 
"BLD",5534,1,159,0)
 
"BLD",5534,1,160,0)
 
"BLD",5534,1,161,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"BLD",5534,1,162,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// 
"BLD",5534,1,163,0)
 
"BLD",5534,1,164,0)
Enter options you wish to mark as 'Out Of Order': LRAP
"BLD",5534,1,165,0)
     1   LRAP       Anatomic pathology
"BLD",5534,1,166,0)
     2   LRAP ADD       Add patient(s) to report print queue
"BLD",5534,1,167,0)
     3   LRAP ALERT       Send an AP Alert
"BLD",5534,1,168,0)
     4   LRAP DELETE       Delete report print queue
"BLD",5534,1,169,0)
     5   LRAP ESIG SWITCH       Turn Electronic Signature On/Off
"BLD",5534,1,170,0)
Press <RETURN> to see more, '^' to exit this list, OR
"BLD",5534,1,171,0)
CHOOSE 1-5: 1  LRAP     Anatomic pathology
"BLD",5534,1,172,0)
 
"BLD",5534,1,173,0)
Enter options you wish to mark as 'Out Of Order': 
"BLD",5534,1,174,0)
 
"BLD",5534,1,175,0)
Enter protocols you wish to mark as 'Out Of Order': 
"BLD",5534,1,176,0)
 
"BLD",5534,1,177,0)
Delay Install (Minutes):  (0-60): 0// 
"BLD",5534,1,178,0)
 
"BLD",5534,1,179,0)
Enter the Device you want to print the Install messages.
"BLD",5534,1,180,0)
You can queue the install by enter a 'Q' at the device prompt.
"BLD",5534,1,181,0)
Enter a '^' to abort the install.
"BLD",5534,1,182,0)
 
"BLD",5534,1,183,0)
DEVICE: HOME// ;;1000  UCX/TELNET
"BLD",5534,1,184,0)
 
"BLD",5534,1,185,0)
 
"BLD",5534,1,186,0)
 Install Started for LR*5.2*309 : 
"BLD",5534,1,187,0)
               Aug 05, 2008@14:26:27
"BLD",5534,1,188,0)
 
"BLD",5534,1,189,0)
Build Distribution Date: Aug 01, 2008
"BLD",5534,1,190,0)
 
"BLD",5534,1,191,0)
 Installing Routines:
"BLD",5534,1,192,0)
               Aug 05, 2008@14:26:27
"BLD",5534,1,193,0)
 
"BLD",5534,1,194,0)
 Running Post-Install Routine: POST^LR309
"BLD",5534,1,195,0)
 
"BLD",5534,1,196,0)
                          *** Post install started ***
"BLD",5534,1,197,0)
 
"BLD",5534,1,198,0)
Searching for data in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"BLD",5534,1,199,0)
(#63.09) in LAB DATA file (#63).
"BLD",5534,1,200,0)
 
"BLD",5534,1,201,0)
                                   
"BLD",5534,1,202,0)
LR*5.2*309                                   
"BLD",5534,1,203,0)
--------------------------------------------------------------------------
"BLD",5534,1,204,0)
                                Search finished
"BLD",5534,1,205,0)
 
"BLD",5534,1,206,0)
                    No Data found in ^LR(D0,"CY",D1,"WP",0)
"BLD",5534,1,207,0)
 
"BLD",5534,1,208,0)
                         *** Post install completed ***
"BLD",5534,1,209,0)
 
"BLD",5534,1,210,0)
              Sending install completion alert to mail group G.LMI
"BLD",5534,1,211,0)
 
"BLD",5534,1,212,0)
 Updating Routine file...
"BLD",5534,1,213,0)
 
"BLD",5534,1,214,0)
 Updating KIDS files...
"BLD",5534,1,215,0)
 
"BLD",5534,1,216,0)
 LR*5.2*309 Installed. 
"BLD",5534,1,217,0)
               Aug 05, 2008@14:26:27
"BLD",5534,1,218,0)
 
"BLD",5534,1,219,0)
 
"BLD",5534,1,220,0)
--------------------------------------------------------------------------
"BLD",5534,1,221,0)
          +------------------------------------------------------------+
"BLD",5534,1,222,0)
  100%    |             25             50             75               |
"BLD",5534,1,223,0)
Complete  +------------------------------------------------------------+
"BLD",5534,1,224,0)
 
"BLD",5534,1,225,0)
 
"BLD",5534,1,226,0)
Install Completed
"BLD",5534,1,227,0)
 
"BLD",5534,1,228,0)
Example #2 with data:
"BLD",5534,1,229,0)
=====================
"BLD",5534,1,230,0)
 
"BLD",5534,1,231,0)
Select Installation Option: install Package(s)
"BLD",5534,1,232,0)
Select INSTALL NAME:    LR*5.2*309     Loaded from Distribution  
"BLD",5534,1,233,0)
8/5/08@10:06:42
"BLD",5534,1,234,0)
     => LR*5.2*309
"BLD",5534,1,235,0)
 
"BLD",5534,1,236,0)
This Distribution was loaded on Aug 05, 2008@10:06:42 with header of 
"BLD",5534,1,237,0)
   LR*5.2*309
"BLD",5534,1,238,0)
   It consisted of the following Install(s):
"BLD",5534,1,239,0)
     LR*5.2*309
"BLD",5534,1,240,0)
Checking Install for Package LR*5.2*309
"BLD",5534,1,241,0)
Will first run the Environment Check Routine, LR309
"BLD",5534,1,242,0)
 
"BLD",5534,1,243,0)
 
"BLD",5534,1,244,0)
               Sending install started alert to mail group G.LMI
"BLD",5534,1,245,0)
 
"BLD",5534,1,246,0)
                        --- Environment Check is Ok ---
"BLD",5534,1,247,0)
 
"BLD",5534,1,248,0)
Install Questions for LR*5.2*309
"BLD",5534,1,249,0)
 
"BLD",5534,1,250,0)
 
"BLD",5534,1,251,0)
 
"BLD",5534,1,252,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"BLD",5534,1,253,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// 
"BLD",5534,1,254,0)
 
"BLD",5534,1,255,0)
Enter options you wish to mark as 'Out Of Order': LRAP
"BLD",5534,1,256,0)
     1   LRAP       Anatomic pathology
"BLD",5534,1,257,0)
     2   LRAP ADD       Add patient(s) to report print queue
"BLD",5534,1,258,0)
     3   LRAP ALERT       Send an AP Alert
"BLD",5534,1,259,0)
     4   LRAP DELETE       Delete report print queue
"BLD",5534,1,260,0)
     5   LRAP ESIG SWITCH       Turn Electronic Signature On/Off
"BLD",5534,1,261,0)
Press <RETURN> to see more, '^' to exit this list, OR
"BLD",5534,1,262,0)
CHOOSE 1-5: 1  LRAP     Anatomic pathology
"BLD",5534,1,263,0)
 
"BLD",5534,1,264,0)
Enter options you wish to mark as 'Out Of Order': 
"BLD",5534,1,265,0)
 
"BLD",5534,1,266,0)
Enter protocols you wish to mark as 'Out Of Order': 
"BLD",5534,1,267,0)
 
"BLD",5534,1,268,0)
Delay Install (Minutes):  (0-60): 0// 
"BLD",5534,1,269,0)
 
"BLD",5534,1,270,0)
Enter the Device you want to print the Install messages.
"BLD",5534,1,271,0)
You can queue the install by enter a 'Q' at the device prompt.
"BLD",5534,1,272,0)
Enter a '^' to abort the install.
"BLD",5534,1,273,0)
 
"BLD",5534,1,274,0)
DEVICE: HOME// ;;1000  UCX/TELNET
"BLD",5534,1,275,0)
 
"BLD",5534,1,276,0)
 
"BLD",5534,1,277,0)
 Install Started for LR*5.2*309 : 
"BLD",5534,1,278,0)
               Aug 05, 2008@10:07:55
"BLD",5534,1,279,0)
 
"BLD",5534,1,280,0)
Build Distribution Date: Aug 01, 2008
"BLD",5534,1,281,0)
 
"BLD",5534,1,282,0)
 Installing Routines:
"BLD",5534,1,283,0)
               Aug 05, 2008@10:07:55
"BLD",5534,1,284,0)
 
"BLD",5534,1,285,0)
 Running Post-Install Routine: POST^LR309
"BLD",5534,1,286,0)
 
"BLD",5534,1,287,0)
                          *** Post install started ***
"BLD",5534,1,288,0)
 
"BLD",5534,1,289,0)
Searching for data in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"BLD",5534,1,290,0)
(#63.09) in LAB DATA file (#63).
"BLD",5534,1,291,0)
 
"BLD",5534,1,292,0)
                                Search finished
"BLD",5534,1,293,0)
 
"BLD",5534,1,294,0)
             Data entries have been found in ^LR(D0,"CY",D1,"WP",0)
"BLD",5534,1,295,0)
 
"BLD",5534,1,296,0)
The data found is sent in a mail message to all users
"BLD",5534,1,297,0)
who hold the security keys LRLIASON and LRAPSUPER. 
"BLD",5534,1,298,0)
The data will automatically be purged from the
"BLD",5534,1,299,0)
^XTMP("LR309", global in 180 days. 
"BLD",5534,1,300,0)
 
"BLD",5534,1,301,0)
 
"BLD",5534,1,302,0)
                                   
"BLD",5534,1,303,0)
LR*5.2*309                                   
"BLD",5534,1,304,0)
--------------------------------------------------------------------------
"BLD",5534,1,305,0)
 
"BLD",5534,1,306,0)
Data deleted from DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"BLD",5534,1,307,0)
(#63.09) in LAB DATA file (#63).
"BLD",5534,1,308,0)
 
"BLD",5534,1,309,0)
                         *** Post install completed ***
"BLD",5534,1,310,0)
 
"BLD",5534,1,311,0)
              Sending install completion alert to mail group G.LMI
"BLD",5534,1,312,0)
 
"BLD",5534,1,313,0)
 Updating Routine file...
"BLD",5534,1,314,0)
 
"BLD",5534,1,315,0)
 Updating KIDS files...
"BLD",5534,1,316,0)
 
"BLD",5534,1,317,0)
 LR*5.2*309 Installed. 
"BLD",5534,1,318,0)
               Aug 05, 2008@10:07:56
"BLD",5534,1,319,0)
 
"BLD",5534,1,320,0)
 
"BLD",5534,1,321,0)
--------------------------------------------------------------------------
"BLD",5534,1,322,0)
          +------------------------------------------------------------+
"BLD",5534,1,323,0)
  100%    |             25             50             75               |
"BLD",5534,1,324,0)
Complete  +------------------------------------------------------------+
"BLD",5534,1,325,0)
 
"BLD",5534,1,326,0)
 
"BLD",5534,1,327,0)
Install Completed
"BLD",5534,1,328,0)
 
"BLD",5534,1,329,0)
Routine Information:
"BLD",5534,1,330,0)
====================
"BLD",5534,1,331,0)
                                        
"BLD",5534,1,332,0)
 
"BLD",5534,1,333,0)
The second line of each of these routines now looks like:
"BLD",5534,1,334,0)
 ;;5.2;LAB SERVICE;**[Patch List]**;Sep 27, 1994;Build 21
"BLD",5534,1,335,0)
 
"BLD",5534,1,336,0)
The checksums below are new checksums, and
"BLD",5534,1,337,0)
 can be checked with CHECK1^XTSUMBLD.
"BLD",5534,1,338,0)
 
"BLD",5534,1,339,0)
Routine Name: LR309
"BLD",5534,1,340,0)
    Before:       n/a   After: B56461511  **309**
"BLD",5534,1,341,0)
Routine Name: LRAUAW
"BLD",5534,1,342,0)
    Before:  B5818727   After:  B5111264  **72,115,121,309**
"BLD",5534,1,343,0)
 
"BLD",5534,1,344,0)
Routine list of preceding patches: 121
"BLD",5534,4,0)
^9.64PA^^0
"BLD",5534,6)
13^
"BLD",5534,6.3)
23
"BLD",5534,"INI")

"BLD",5534,"INID")
y^y^
"BLD",5534,"INIT")
POST^LR309
"BLD",5534,"KRN",0)
^9.67PA^8989.52^19
"BLD",5534,"KRN",.4,0)
.4
"BLD",5534,"KRN",.401,0)
.401
"BLD",5534,"KRN",.402,0)
.402
"BLD",5534,"KRN",.403,0)
.403
"BLD",5534,"KRN",.5,0)
.5
"BLD",5534,"KRN",.84,0)
.84
"BLD",5534,"KRN",3.6,0)
3.6
"BLD",5534,"KRN",3.8,0)
3.8
"BLD",5534,"KRN",9.2,0)
9.2
"BLD",5534,"KRN",9.8,0)
9.8
"BLD",5534,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5534,"KRN",9.8,"NM",1,0)
LRAUAW^^0^B5111264
"BLD",5534,"KRN",9.8,"NM","B","LRAUAW",1)

"BLD",5534,"KRN",19,0)
19
"BLD",5534,"KRN",19,"NM",0)
^9.68A^^0
"BLD",5534,"KRN",19.1,0)
19.1
"BLD",5534,"KRN",101,0)
101
"BLD",5534,"KRN",409.61,0)
409.61
"BLD",5534,"KRN",771,0)
771
"BLD",5534,"KRN",870,0)
870
"BLD",5534,"KRN",8989.51,0)
8989.51
"BLD",5534,"KRN",8989.52,0)
8989.52
"BLD",5534,"KRN",8994,0)
8994
"BLD",5534,"KRN","B",.4,.4)

"BLD",5534,"KRN","B",.401,.401)

"BLD",5534,"KRN","B",.402,.402)

"BLD",5534,"KRN","B",.403,.403)

"BLD",5534,"KRN","B",.5,.5)

"BLD",5534,"KRN","B",.84,.84)

"BLD",5534,"KRN","B",3.6,3.6)

"BLD",5534,"KRN","B",3.8,3.8)

"BLD",5534,"KRN","B",9.2,9.2)

"BLD",5534,"KRN","B",9.8,9.8)

"BLD",5534,"KRN","B",19,19)

"BLD",5534,"KRN","B",19.1,19.1)

"BLD",5534,"KRN","B",101,101)

"BLD",5534,"KRN","B",409.61,409.61)

"BLD",5534,"KRN","B",771,771)

"BLD",5534,"KRN","B",870,870)

"BLD",5534,"KRN","B",8989.51,8989.51)

"BLD",5534,"KRN","B",8989.52,8989.52)

"BLD",5534,"KRN","B",8994,8994)

"BLD",5534,"PRE")
LR309
"BLD",5534,"PRET")

"BLD",5534,"QUES",0)
^9.62^^
"BLD",5534,"REQB",0)
^9.611^1^1
"BLD",5534,"REQB",1,0)
LR*5.2*121^2
"BLD",5534,"REQB","B","LR*5.2*121",1)

"INIT")
POST^LR309
"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2941128
"PKG",26,22,1,"PAH",1,0)
309^3090129^6473
"PKG",26,22,1,"PAH",1,1,0)
^^344^344^3090129
"PKG",26,22,1,"PAH",1,1,1,0)
BLOOD BANK
"PKG",26,22,1,"PAH",1,1,2,0)
==========
"PKG",26,22,1,"PAH",1,1,3,0)
 
"PKG",26,22,1,"PAH",1,1,4,0)
VISTA Laboratory Package patch LR*5.2*309 contains changes to 
"PKG",26,22,1,"PAH",1,1,5,0)
software controlled by VHA DIRECTIVE 2004-058, titled VISTA 
"PKG",26,22,1,"PAH",1,1,6,0)
BLOOD BANK SOFTWARE. Changes include: 
"PKG",26,22,1,"PAH",1,1,7,0)
  
"PKG",26,22,1,"PAH",1,1,8,0)
 File          Field               Action
"PKG",26,22,1,"PAH",1,1,9,0)
   
"PKG",26,22,1,"PAH",1,1,10,0)
63.09,20      DESCRIPTION         Delete
"PKG",26,22,1,"PAH",1,1,11,0)
 
"PKG",26,22,1,"PAH",1,1,12,0)
All of the above changes have been reviewed by the VISTA Blood Bank
"PKG",26,22,1,"PAH",1,1,13,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE
"PKG",26,22,1,"PAH",1,1,14,0)
control functions.
"PKG",26,22,1,"PAH",1,1,15,0)
 
"PKG",26,22,1,"PAH",1,1,16,0)
RISK ANALYSIS: Changes made by patch LR*5.2*309 have no effect on Blood
"PKG",26,22,1,"PAH",1,1,17,0)
Bank software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,18,0)
  
"PKG",26,22,1,"PAH",1,1,19,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*309 does not
"PKG",26,22,1,"PAH",1,1,20,0)
alter or modify any software design safeguards or safety critical 
"PKG",26,22,1,"PAH",1,1,21,0)
elements functions.
"PKG",26,22,1,"PAH",1,1,22,0)
  
"PKG",26,22,1,"PAH",1,1,23,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines
"PKG",26,22,1,"PAH",1,1,24,0)
and 1 files identified in Veterans Health Administration (VHA) Directive
"PKG",26,22,1,"PAH",1,1,25,0)
2004-058, group B listing. The changes have no effect on Blood Bank
"PKG",26,22,1,"PAH",1,1,26,0)
functionality or medical device control functions. There is no adverse
"PKG",26,22,1,"PAH",1,1,27,0)
potential to sites.
"PKG",26,22,1,"PAH",1,1,28,0)
 
"PKG",26,22,1,"PAH",1,1,29,0)
VALIDATION REQUIREMENTS BY OPTION: 
"PKG",26,22,1,"PAH",1,1,30,0)
  
"PKG",26,22,1,"PAH",1,1,31,0)
There are no Validation requirements or options to be validated
"PKG",26,22,1,"PAH",1,1,32,0)
in this patch.
"PKG",26,22,1,"PAH",1,1,33,0)
  
"PKG",26,22,1,"PAH",1,1,34,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL 
"PKG",26,22,1,"PAH",1,1,35,0)
FUNCTIONS:
"PKG",26,22,1,"PAH",1,1,36,0)
  
"PKG",26,22,1,"PAH",1,1,37,0)
There are no Test Case Scenarios associated with this patch.
"PKG",26,22,1,"PAH",1,1,38,0)
   
"PKG",26,22,1,"PAH",1,1,39,0)
DESCRIPTION: 
"PKG",26,22,1,"PAH",1,1,40,0)
============ 
"PKG",26,22,1,"PAH",1,1,41,0)
This patch removes one field, the DESCRIPTION field (#20), in the
"PKG",26,22,1,"PAH",1,1,42,0)
LAB DATA file (#63) CYTOPATHOLOGY sub-file (#63.09), and a reference to
"PKG",26,22,1,"PAH",1,1,43,0)
this field in routine ^LRAUAW.
"PKG",26,22,1,"PAH",1,1,44,0)
 
"PKG",26,22,1,"PAH",1,1,45,0)
Although it is highly unlikely that data exists in the DESCRIPTION 
"PKG",26,22,1,"PAH",1,1,46,0)
field (#20), the patch also checks for data that may have been entered in
"PKG",26,22,1,"PAH",1,1,47,0)
the field.  Any data that is found is moved to the ^XTMP("LR309")
"PKG",26,22,1,"PAH",1,1,48,0)
global and stored for 180 days before it is purged. If data is found,
"PKG",26,22,1,"PAH",1,1,49,0)
the installation routine also generates and sends a mail message to the
"PKG",26,22,1,"PAH",1,1,50,0)
holders of security keys LRLIASON and LRAPSUPER to be used as a source
"PKG",26,22,1,"PAH",1,1,51,0)
document to determine how the data should be handled if at all.
"PKG",26,22,1,"PAH",1,1,52,0)
The message contains the LR*5.2*309 Data Report which lists the data 
"PKG",26,22,1,"PAH",1,1,53,0)
found, the accession number, the patient's name, social security number
"PKG",26,22,1,"PAH",1,1,54,0)
and gender.
"PKG",26,22,1,"PAH",1,1,55,0)
 
"PKG",26,22,1,"PAH",1,1,56,0)
DATA DICTIONARY CHANGES: 
"PKG",26,22,1,"PAH",1,1,57,0)
======================== 
"PKG",26,22,1,"PAH",1,1,58,0)
 The following is a list of the Data Dictionary entry in LAB DATA file 
"PKG",26,22,1,"PAH",1,1,59,0)
(#63) that will be deleted by this patch:
"PKG",26,22,1,"PAH",1,1,60,0)
  
"PKG",26,22,1,"PAH",1,1,61,0)
63.09,20      DESCRIPTION            WP;0    WORD-PROCESSING #63.91
"PKG",26,22,1,"PAH",1,1,62,0)
 
"PKG",26,22,1,"PAH",1,1,63,0)
              DESCRIPTION:
"PKG",26,22,1,"PAH",1,1,64,0)
                                Word processing field for description
"PKG",26,22,1,"PAH",1,1,65,0)
  
"PKG",26,22,1,"PAH",1,1,66,0)
 
"PKG",26,22,1,"PAH",1,1,67,0)
MODIFICATION OF THE LRAUAW ROUTINE:
"PKG",26,22,1,"PAH",1,1,68,0)
===================================
"PKG",26,22,1,"PAH",1,1,69,0)
Patch LR*5.2*309 also makes changes to the LRAUAW routine to remove a
"PKG",26,22,1,"PAH",1,1,70,0)
reference to the DESCRIPTION field (#20) of the CYTOPATHOLOGY sub-file
"PKG",26,22,1,"PAH",1,1,71,0)
(#63.09) in the LAB DATA file (#63).  The change will be transparent to
"PKG",26,22,1,"PAH",1,1,72,0)
the user.
"PKG",26,22,1,"PAH",1,1,73,0)
 
"PKG",26,22,1,"PAH",1,1,74,0)
NEW SERVICE REQUEST (NSR): 
"PKG",26,22,1,"PAH",1,1,75,0)
========================== 
"PKG",26,22,1,"PAH",1,1,76,0)
N/A. 
"PKG",26,22,1,"PAH",1,1,77,0)
  
"PKG",26,22,1,"PAH",1,1,78,0)
ASSOCIATED E3R: 
"PKG",26,22,1,"PAH",1,1,79,0)
=============== 
"PKG",26,22,1,"PAH",1,1,80,0)
N/A.                                                                     
"PKG",26,22,1,"PAH",1,1,81,0)
 
"PKG",26,22,1,"PAH",1,1,82,0)
ASSOCIATED NOIS: 
"PKG",26,22,1,"PAH",1,1,83,0)
================ 
"PKG",26,22,1,"PAH",1,1,84,0)
N/A. 
"PKG",26,22,1,"PAH",1,1,85,0)
  
"PKG",26,22,1,"PAH",1,1,86,0)
ASSOCIATED REMEDY TICKETS: 
"PKG",26,22,1,"PAH",1,1,87,0)
========================== 
"PKG",26,22,1,"PAH",1,1,88,0)
 HD0000000093288 
"PKG",26,22,1,"PAH",1,1,89,0)
  
"PKG",26,22,1,"PAH",1,1,90,0)
TEST SITES: 
"PKG",26,22,1,"PAH",1,1,91,0)
=========== 
"PKG",26,22,1,"PAH",1,1,92,0)
   Altoona, PA - small
"PKG",26,22,1,"PAH",1,1,93,0)
   Wilmington, DE - medium
"PKG",26,22,1,"PAH",1,1,94,0)
   Biloxi, MS - large
"PKG",26,22,1,"PAH",1,1,95,0)
 
"PKG",26,22,1,"PAH",1,1,96,0)
  
"PKG",26,22,1,"PAH",1,1,97,0)
SOFTWARE RETRIEVAL: 
"PKG",26,22,1,"PAH",1,1,98,0)
==================== 
"PKG",26,22,1,"PAH",1,1,99,0)
 This patch is distributed by KIDS as a Packman message. 
"PKG",26,22,1,"PAH",1,1,100,0)
  
"PKG",26,22,1,"PAH",1,1,101,0)
INSTALLATION INSTRUCTIONS: 
"PKG",26,22,1,"PAH",1,1,102,0)
========================== 
"PKG",26,22,1,"PAH",1,1,103,0)
This patch can be installed with users on the system.  It is recommended 
"PKG",26,22,1,"PAH",1,1,104,0)
to disable the Anatomic Pathology [LRAP] option at the "DISABLE Scheduled
"PKG",26,22,1,"PAH",1,1,105,0)
Options, Menu Options, and Protocols?" prompt.
"PKG",26,22,1,"PAH",1,1,106,0)
  
"PKG",26,22,1,"PAH",1,1,107,0)
Install Time - less than 5 minutes. 
"PKG",26,22,1,"PAH",1,1,108,0)
  
"PKG",26,22,1,"PAH",1,1,109,0)
1. Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu. This 
"PKG",26,22,1,"PAH",1,1,110,0)
   option will load the KIDS patch onto your system.
"PKG",26,22,1,"PAH",1,1,111,0)
  
"PKG",26,22,1,"PAH",1,1,112,0)
2. On the 'Kernel Installation & Distribution System' Menu (KIDS), select 
"PKG",26,22,1,"PAH",1,1,113,0)
   the 'Installation' menu.
"PKG",26,22,1,"PAH",1,1,114,0)
  
"PKG",26,22,1,"PAH",1,1,115,0)
3. Use the 'Verify Checksum in Transport Global' option and verify that 
"PKG",26,22,1,"PAH",1,1,116,0)
   all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,117,0)
  
"PKG",26,22,1,"PAH",1,1,118,0)
4. On the KIDS menu, under the 'Installation' menu, use the following 
"PKG",26,22,1,"PAH",1,1,119,0)
   options: 
"PKG",26,22,1,"PAH",1,1,120,0)
        Print Transport Global 
"PKG",26,22,1,"PAH",1,1,121,0)
        Compare Transport Global to Current System 
"PKG",26,22,1,"PAH",1,1,122,0)
        Backup a Transport Global 
"PKG",26,22,1,"PAH",1,1,123,0)
  
"PKG",26,22,1,"PAH",1,1,124,0)
5. Use the 'Install Package(s)' option under the 'Installation' menu and 
"PKG",26,22,1,"PAH",1,1,125,0)
   select the package 'LR*5.2*309'.
"PKG",26,22,1,"PAH",1,1,126,0)
 
"PKG",26,22,1,"PAH",1,1,127,0)
6. When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES// 
"PKG",26,22,1,"PAH",1,1,128,0)
   choose 'NO'.
"PKG",26,22,1,"PAH",1,1,129,0)
 
"PKG",26,22,1,"PAH",1,1,130,0)
7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and 
"PKG",26,22,1,"PAH",1,1,131,0)
   Protocols? YES//', disable the Anatomic Pathology [LRAP] option. 
"PKG",26,22,1,"PAH",1,1,132,0)
 
"PKG",26,22,1,"PAH",1,1,133,0)
  
"PKG",26,22,1,"PAH",1,1,134,0)
  
"PKG",26,22,1,"PAH",1,1,135,0)
INSTALLATION EXAMPLE: 
"PKG",26,22,1,"PAH",1,1,136,0)
===================== 
"PKG",26,22,1,"PAH",1,1,137,0)
 
"PKG",26,22,1,"PAH",1,1,138,0)
Example #1 without data:
"PKG",26,22,1,"PAH",1,1,139,0)
========================   
"PKG",26,22,1,"PAH",1,1,140,0)
Select Installation Option: install Package(s)
"PKG",26,22,1,"PAH",1,1,141,0)
Select INSTALL NAME: LR*5.2*309       Loaded from Distribution  
"PKG",26,22,1,"PAH",1,1,142,0)
8/5/08@14:25:46
"PKG",26,22,1,"PAH",1,1,143,0)
     => LR*5.2*309
"PKG",26,22,1,"PAH",1,1,144,0)
 
"PKG",26,22,1,"PAH",1,1,145,0)
This Distribution was loaded on Aug 05, 2008@14:25:46 with header of 
"PKG",26,22,1,"PAH",1,1,146,0)
   LR*5.2*309
"PKG",26,22,1,"PAH",1,1,147,0)
   It consisted of the following Install(s):
"PKG",26,22,1,"PAH",1,1,148,0)
     LR*5.2*309
"PKG",26,22,1,"PAH",1,1,149,0)
Checking Install for Package LR*5.2*309
"PKG",26,22,1,"PAH",1,1,150,0)
Will first run the Environment Check Routine, LR309
"PKG",26,22,1,"PAH",1,1,151,0)
 
"PKG",26,22,1,"PAH",1,1,152,0)
 
"PKG",26,22,1,"PAH",1,1,153,0)
               Sending install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,154,0)
 
"PKG",26,22,1,"PAH",1,1,155,0)
                        --- Environment Check is Ok ---
"PKG",26,22,1,"PAH",1,1,156,0)
 
"PKG",26,22,1,"PAH",1,1,157,0)
Install Questions for LR*5.2*309
"PKG",26,22,1,"PAH",1,1,158,0)
 
"PKG",26,22,1,"PAH",1,1,159,0)
 
"PKG",26,22,1,"PAH",1,1,160,0)
 
"PKG",26,22,1,"PAH",1,1,161,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"PKG",26,22,1,"PAH",1,1,162,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// 
"PKG",26,22,1,"PAH",1,1,163,0)
 
"PKG",26,22,1,"PAH",1,1,164,0)
Enter options you wish to mark as 'Out Of Order': LRAP
"PKG",26,22,1,"PAH",1,1,165,0)
     1   LRAP       Anatomic pathology
"PKG",26,22,1,"PAH",1,1,166,0)
     2   LRAP ADD       Add patient(s) to report print queue
"PKG",26,22,1,"PAH",1,1,167,0)
     3   LRAP ALERT       Send an AP Alert
"PKG",26,22,1,"PAH",1,1,168,0)
     4   LRAP DELETE       Delete report print queue
"PKG",26,22,1,"PAH",1,1,169,0)
     5   LRAP ESIG SWITCH       Turn Electronic Signature On/Off
"PKG",26,22,1,"PAH",1,1,170,0)
Press <RETURN> to see more, '^' to exit this list, OR
"PKG",26,22,1,"PAH",1,1,171,0)
CHOOSE 1-5: 1  LRAP     Anatomic pathology
"PKG",26,22,1,"PAH",1,1,172,0)
 
"PKG",26,22,1,"PAH",1,1,173,0)
Enter options you wish to mark as 'Out Of Order': 
"PKG",26,22,1,"PAH",1,1,174,0)
 
"PKG",26,22,1,"PAH",1,1,175,0)
Enter protocols you wish to mark as 'Out Of Order': 
"PKG",26,22,1,"PAH",1,1,176,0)
 
"PKG",26,22,1,"PAH",1,1,177,0)
Delay Install (Minutes):  (0-60): 0// 
"PKG",26,22,1,"PAH",1,1,178,0)
 
"PKG",26,22,1,"PAH",1,1,179,0)
Enter the Device you want to print the Install messages.
"PKG",26,22,1,"PAH",1,1,180,0)
You can queue the install by enter a 'Q' at the device prompt.
"PKG",26,22,1,"PAH",1,1,181,0)
Enter a '^' to abort the install.
"PKG",26,22,1,"PAH",1,1,182,0)
 
"PKG",26,22,1,"PAH",1,1,183,0)
DEVICE: HOME// ;;1000  UCX/TELNET
"PKG",26,22,1,"PAH",1,1,184,0)
 
"PKG",26,22,1,"PAH",1,1,185,0)
 
"PKG",26,22,1,"PAH",1,1,186,0)
 Install Started for LR*5.2*309 : 
"PKG",26,22,1,"PAH",1,1,187,0)
               Aug 05, 2008@14:26:27
"PKG",26,22,1,"PAH",1,1,188,0)
 
"PKG",26,22,1,"PAH",1,1,189,0)
Build Distribution Date: Aug 01, 2008
"PKG",26,22,1,"PAH",1,1,190,0)
 
"PKG",26,22,1,"PAH",1,1,191,0)
 Installing Routines:
"PKG",26,22,1,"PAH",1,1,192,0)
               Aug 05, 2008@14:26:27
"PKG",26,22,1,"PAH",1,1,193,0)
 
"PKG",26,22,1,"PAH",1,1,194,0)
 Running Post-Install Routine: POST^LR309
"PKG",26,22,1,"PAH",1,1,195,0)
 
"PKG",26,22,1,"PAH",1,1,196,0)
                          *** Post install started ***
"PKG",26,22,1,"PAH",1,1,197,0)
 
"PKG",26,22,1,"PAH",1,1,198,0)
Searching for data in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"PKG",26,22,1,"PAH",1,1,199,0)
(#63.09) in LAB DATA file (#63).
"PKG",26,22,1,"PAH",1,1,200,0)
 
"PKG",26,22,1,"PAH",1,1,201,0)
                                   
"PKG",26,22,1,"PAH",1,1,202,0)
LR*5.2*309                                   
"PKG",26,22,1,"PAH",1,1,203,0)
--------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,204,0)
                                Search finished
"PKG",26,22,1,"PAH",1,1,205,0)
 
"PKG",26,22,1,"PAH",1,1,206,0)
                    No Data found in ^LR(D0,"CY",D1,"WP",0)
"PKG",26,22,1,"PAH",1,1,207,0)
 
"PKG",26,22,1,"PAH",1,1,208,0)
                         *** Post install completed ***
"PKG",26,22,1,"PAH",1,1,209,0)
 
"PKG",26,22,1,"PAH",1,1,210,0)
              Sending install completion alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,211,0)
 
"PKG",26,22,1,"PAH",1,1,212,0)
 Updating Routine file...
"PKG",26,22,1,"PAH",1,1,213,0)
 
"PKG",26,22,1,"PAH",1,1,214,0)
 Updating KIDS files...
"PKG",26,22,1,"PAH",1,1,215,0)
 
"PKG",26,22,1,"PAH",1,1,216,0)
 LR*5.2*309 Installed. 
"PKG",26,22,1,"PAH",1,1,217,0)
               Aug 05, 2008@14:26:27
"PKG",26,22,1,"PAH",1,1,218,0)
 
"PKG",26,22,1,"PAH",1,1,219,0)
 
"PKG",26,22,1,"PAH",1,1,220,0)
--------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,221,0)
          +------------------------------------------------------------+
"PKG",26,22,1,"PAH",1,1,222,0)
  100%    |             25             50             75               |
"PKG",26,22,1,"PAH",1,1,223,0)
Complete  +------------------------------------------------------------+
"PKG",26,22,1,"PAH",1,1,224,0)
 
"PKG",26,22,1,"PAH",1,1,225,0)
 
"PKG",26,22,1,"PAH",1,1,226,0)
Install Completed
"PKG",26,22,1,"PAH",1,1,227,0)
 
"PKG",26,22,1,"PAH",1,1,228,0)
Example #2 with data:
"PKG",26,22,1,"PAH",1,1,229,0)
=====================
"PKG",26,22,1,"PAH",1,1,230,0)
 
"PKG",26,22,1,"PAH",1,1,231,0)
Select Installation Option: install Package(s)
"PKG",26,22,1,"PAH",1,1,232,0)
Select INSTALL NAME:    LR*5.2*309     Loaded from Distribution  
"PKG",26,22,1,"PAH",1,1,233,0)
8/5/08@10:06:42
"PKG",26,22,1,"PAH",1,1,234,0)
     => LR*5.2*309
"PKG",26,22,1,"PAH",1,1,235,0)
 
"PKG",26,22,1,"PAH",1,1,236,0)
This Distribution was loaded on Aug 05, 2008@10:06:42 with header of 
"PKG",26,22,1,"PAH",1,1,237,0)
   LR*5.2*309
"PKG",26,22,1,"PAH",1,1,238,0)
   It consisted of the following Install(s):
"PKG",26,22,1,"PAH",1,1,239,0)
     LR*5.2*309
"PKG",26,22,1,"PAH",1,1,240,0)
Checking Install for Package LR*5.2*309
"PKG",26,22,1,"PAH",1,1,241,0)
Will first run the Environment Check Routine, LR309
"PKG",26,22,1,"PAH",1,1,242,0)
 
"PKG",26,22,1,"PAH",1,1,243,0)
 
"PKG",26,22,1,"PAH",1,1,244,0)
               Sending install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,245,0)
 
"PKG",26,22,1,"PAH",1,1,246,0)
                        --- Environment Check is Ok ---
"PKG",26,22,1,"PAH",1,1,247,0)
 
"PKG",26,22,1,"PAH",1,1,248,0)
Install Questions for LR*5.2*309
"PKG",26,22,1,"PAH",1,1,249,0)
 
"PKG",26,22,1,"PAH",1,1,250,0)
 
"PKG",26,22,1,"PAH",1,1,251,0)
 
"PKG",26,22,1,"PAH",1,1,252,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"PKG",26,22,1,"PAH",1,1,253,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// 
"PKG",26,22,1,"PAH",1,1,254,0)
 
"PKG",26,22,1,"PAH",1,1,255,0)
Enter options you wish to mark as 'Out Of Order': LRAP
"PKG",26,22,1,"PAH",1,1,256,0)
     1   LRAP       Anatomic pathology
"PKG",26,22,1,"PAH",1,1,257,0)
     2   LRAP ADD       Add patient(s) to report print queue
"PKG",26,22,1,"PAH",1,1,258,0)
     3   LRAP ALERT       Send an AP Alert
"PKG",26,22,1,"PAH",1,1,259,0)
     4   LRAP DELETE       Delete report print queue
"PKG",26,22,1,"PAH",1,1,260,0)
     5   LRAP ESIG SWITCH       Turn Electronic Signature On/Off
"PKG",26,22,1,"PAH",1,1,261,0)
Press <RETURN> to see more, '^' to exit this list, OR
"PKG",26,22,1,"PAH",1,1,262,0)
CHOOSE 1-5: 1  LRAP     Anatomic pathology
"PKG",26,22,1,"PAH",1,1,263,0)
 
"PKG",26,22,1,"PAH",1,1,264,0)
Enter options you wish to mark as 'Out Of Order': 
"PKG",26,22,1,"PAH",1,1,265,0)
 
"PKG",26,22,1,"PAH",1,1,266,0)
Enter protocols you wish to mark as 'Out Of Order': 
"PKG",26,22,1,"PAH",1,1,267,0)
 
"PKG",26,22,1,"PAH",1,1,268,0)
Delay Install (Minutes):  (0-60): 0// 
"PKG",26,22,1,"PAH",1,1,269,0)
 
"PKG",26,22,1,"PAH",1,1,270,0)
Enter the Device you want to print the Install messages.
"PKG",26,22,1,"PAH",1,1,271,0)
You can queue the install by enter a 'Q' at the device prompt.
"PKG",26,22,1,"PAH",1,1,272,0)
Enter a '^' to abort the install.
"PKG",26,22,1,"PAH",1,1,273,0)
 
"PKG",26,22,1,"PAH",1,1,274,0)
DEVICE: HOME// ;;1000  UCX/TELNET
"PKG",26,22,1,"PAH",1,1,275,0)
 
"PKG",26,22,1,"PAH",1,1,276,0)
 
"PKG",26,22,1,"PAH",1,1,277,0)
 Install Started for LR*5.2*309 : 
"PKG",26,22,1,"PAH",1,1,278,0)
               Aug 05, 2008@10:07:55
"PKG",26,22,1,"PAH",1,1,279,0)
 
"PKG",26,22,1,"PAH",1,1,280,0)
Build Distribution Date: Aug 01, 2008
"PKG",26,22,1,"PAH",1,1,281,0)
 
"PKG",26,22,1,"PAH",1,1,282,0)
 Installing Routines:
"PKG",26,22,1,"PAH",1,1,283,0)
               Aug 05, 2008@10:07:55
"PKG",26,22,1,"PAH",1,1,284,0)
 
"PKG",26,22,1,"PAH",1,1,285,0)
 Running Post-Install Routine: POST^LR309
"PKG",26,22,1,"PAH",1,1,286,0)
 
"PKG",26,22,1,"PAH",1,1,287,0)
                          *** Post install started ***
"PKG",26,22,1,"PAH",1,1,288,0)
 
"PKG",26,22,1,"PAH",1,1,289,0)
Searching for data in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"PKG",26,22,1,"PAH",1,1,290,0)
(#63.09) in LAB DATA file (#63).
"PKG",26,22,1,"PAH",1,1,291,0)
 
"PKG",26,22,1,"PAH",1,1,292,0)
                                Search finished
"PKG",26,22,1,"PAH",1,1,293,0)
 
"PKG",26,22,1,"PAH",1,1,294,0)
             Data entries have been found in ^LR(D0,"CY",D1,"WP",0)
"PKG",26,22,1,"PAH",1,1,295,0)
 
"PKG",26,22,1,"PAH",1,1,296,0)
The data found is sent in a mail message to all users
"PKG",26,22,1,"PAH",1,1,297,0)
who hold the security keys LRLIASON and LRAPSUPER. 
"PKG",26,22,1,"PAH",1,1,298,0)
The data will automatically be purged from the
"PKG",26,22,1,"PAH",1,1,299,0)
^XTMP("LR309", global in 180 days. 
"PKG",26,22,1,"PAH",1,1,300,0)
 
"PKG",26,22,1,"PAH",1,1,301,0)
 
"PKG",26,22,1,"PAH",1,1,302,0)
                                   
"PKG",26,22,1,"PAH",1,1,303,0)
LR*5.2*309                                   
"PKG",26,22,1,"PAH",1,1,304,0)
--------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,305,0)
 
"PKG",26,22,1,"PAH",1,1,306,0)
Data deleted from DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file 
"PKG",26,22,1,"PAH",1,1,307,0)
(#63.09) in LAB DATA file (#63).
"PKG",26,22,1,"PAH",1,1,308,0)
 
"PKG",26,22,1,"PAH",1,1,309,0)
                         *** Post install completed ***
"PKG",26,22,1,"PAH",1,1,310,0)
 
"PKG",26,22,1,"PAH",1,1,311,0)
              Sending install completion alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,312,0)
 
"PKG",26,22,1,"PAH",1,1,313,0)
 Updating Routine file...
"PKG",26,22,1,"PAH",1,1,314,0)
 
"PKG",26,22,1,"PAH",1,1,315,0)
 Updating KIDS files...
"PKG",26,22,1,"PAH",1,1,316,0)
 
"PKG",26,22,1,"PAH",1,1,317,0)
 LR*5.2*309 Installed. 
"PKG",26,22,1,"PAH",1,1,318,0)
               Aug 05, 2008@10:07:56
"PKG",26,22,1,"PAH",1,1,319,0)
 
"PKG",26,22,1,"PAH",1,1,320,0)
 
"PKG",26,22,1,"PAH",1,1,321,0)
--------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,322,0)
          +------------------------------------------------------------+
"PKG",26,22,1,"PAH",1,1,323,0)
  100%    |             25             50             75               |
"PKG",26,22,1,"PAH",1,1,324,0)
Complete  +------------------------------------------------------------+
"PKG",26,22,1,"PAH",1,1,325,0)
 
"PKG",26,22,1,"PAH",1,1,326,0)
 
"PKG",26,22,1,"PAH",1,1,327,0)
Install Completed
"PKG",26,22,1,"PAH",1,1,328,0)
 
"PKG",26,22,1,"PAH",1,1,329,0)
Routine Information:
"PKG",26,22,1,"PAH",1,1,330,0)
====================
"PKG",26,22,1,"PAH",1,1,331,0)
                                        
"PKG",26,22,1,"PAH",1,1,332,0)
 
"PKG",26,22,1,"PAH",1,1,333,0)
The second line of each of these routines now looks like:
"PKG",26,22,1,"PAH",1,1,334,0)
 ;;5.2;LAB SERVICE;**[Patch List]**;Sep 27, 1994;Build 21
"PKG",26,22,1,"PAH",1,1,335,0)
 
"PKG",26,22,1,"PAH",1,1,336,0)
The checksums below are new checksums, and
"PKG",26,22,1,"PAH",1,1,337,0)
 can be checked with CHECK1^XTSUMBLD.
"PKG",26,22,1,"PAH",1,1,338,0)
 
"PKG",26,22,1,"PAH",1,1,339,0)
Routine Name: LR309
"PKG",26,22,1,"PAH",1,1,340,0)
    Before:       n/a   After: B56461511  **309**
"PKG",26,22,1,"PAH",1,1,341,0)
Routine Name: LRAUAW
"PKG",26,22,1,"PAH",1,1,342,0)
    Before:  B5818727   After:  B5111264  **72,115,121,309**
"PKG",26,22,1,"PAH",1,1,343,0)
 
"PKG",26,22,1,"PAH",1,1,344,0)
Routine list of preceding patches: 121
"PRE")
LR309
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LR309")
0^^B56461511^n/a
"RTN","LR309",1,0)
LR309 ;DALOI/CKA - LR*5.2*309 PATCH ENVIRONMENT CHECK ROUTINE ;June 10, 2008
"RTN","LR309",2,0)
 ;;5.2;LAB SERVICE;**309**;Sep 27, 1994;Build 23
"RTN","LR309",3,0)
 ; 
"RTN","LR309",4,0)
 ; Use of ^XPDUTL is supported by Integration Agreement: 10141
"RTN","LR309",5,0)
 ; Use of ^XQALERT is supported by Integration Agreement: 10081
"RTN","LR309",6,0)
 ; Use of ^XLFSTR is supported by Integration Agreement: 10104
"RTN","LR309",7,0)
 ; Use of ^XLFDT is supported by Integration Agreement: 10103
"RTN","LR309",8,0)
 ; Use of ^DIK is supported by Integration Agreement: 10013
"RTN","LR309",9,0)
 ; Use of ^XUSER is supported by Integration Agreement: 2343
"RTN","LR309",10,0)
 ; Use of ^XMD is supported by Integration Agreement: 10070
"RTN","LR309",11,0)
 ; 
"RTN","LR309",12,0)
EN ; Does not prevent loading of the transport global.
"RTN","LR309",13,0)
 ;
"RTN","LR309",14,0)
 N XAQMSG,XQA,MSG
"RTN","LR309",15,0)
 I '$G(XPDENV) D
"RTN","LR309",16,0)
 .S XQAMSG="Transport global for patch "_$G(XPDNM,"Unknown patch")
"RTN","LR309",17,0)
 .S XQAMSG=XQAMSG_" loaded on "_$$HTE^XLFDT($H)
"RTN","LR309",18,0)
 .S XQA("G.LMI")=""
"RTN","LR309",19,0)
 .D SETUP^XQALERT
"RTN","LR309",20,0)
 .S MSG="Sending transport global loaded alert to mail group G.LMI"
"RTN","LR309",21,0)
 .D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM))
"RTN","LR309",22,0)
 I $G(XPDENV) D
"RTN","LR309",23,0)
 .S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")
"RTN","LR309",24,0)
 .S XQAMSG=XQAMSG_" started on "_$$HTE^XLFDT($H)
"RTN","LR309",25,0)
 .S XQA("G.LMI")=""
"RTN","LR309",26,0)
 .D SETUP^XQALERT
"RTN","LR309",27,0)
 .S MSG="Sending install started alert to mail group G.LMI"
"RTN","LR309",28,0)
 .D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM))
"RTN","LR309",29,0)
 D CHECK
"RTN","LR309",30,0)
 I XPDENV S XPDDIQ("XPZ1","B")="YES"
"RTN","LR309",31,0)
 D EXIT
"RTN","LR309",32,0)
 Q
"RTN","LR309",33,0)
 ;
"RTN","LR309",34,0)
POST ; KIDS Post install for LR*5.2*309
"RTN","LR309",35,0)
 N XQA,XQAMSG,LRRES,MSG,LRRMV
"RTN","LR309",36,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install started ***",IOM))
"RTN","LR309",37,0)
 D MATCH
"RTN","LR309",38,0)
 I $O(^XTMP("LR309",0)) D
"RTN","LR309",39,0)
 . D PRINT1
"RTN","LR309",40,0)
 . D SEND
"RTN","LR309",41,0)
 ; Remove the data dictionary entry for the Description field(#20)in
"RTN","LR309",42,0)
 ; Cytopathology sub-file(#63.09) in LAB DATA file (#63).
"RTN","LR309",43,0)
 D REMOVE
"RTN","LR309",44,0)
 ;If no data entries found in LAB DATA file #63 so it is okay to finish 
"RTN","LR309",45,0)
 I $O(^XTMP("LR309",""),-1)=0 D
"RTN","LR309",46,0)
 . K MSG
"RTN","LR309",47,0)
 . S MSG="No Data found in ^LR(D0,"_"""CY"""_",D1,"_"""WP"""_",0)"
"RTN","LR309",48,0)
 . D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",49,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install completed ***",IOM))
"RTN","LR309",50,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")
"RTN","LR309",51,0)
 S XQAMSG=XQAMSG_" completed on "_$$HTE^XLFDT($H)
"RTN","LR309",52,0)
 S XQA("G.LMI")=""
"RTN","LR309",53,0)
 D SETUP^XQALERT
"RTN","LR309",54,0)
 S MSG="Sending install completion alert to mail group G.LMI"
"RTN","LR309",55,0)
 D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM))
"RTN","LR309",56,0)
 Q
"RTN","LR309",57,0)
 ;
"RTN","LR309",58,0)
CHECK ; Perform environment check
"RTN","LR309",59,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LR309",60,0)
 .D BMES^XPDUTL($$CJ^XLFSTR("Terminal Device is not defined",IOM))
"RTN","LR309",61,0)
 .S XPDQUIT=2
"RTN","LR309",62,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LR309",63,0)
 .S MSG="Please log in to set local DUZ... variables"
"RTN","LR309",64,0)
 .D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",65,0)
 .S XPDQUIT=2
"RTN","LR309",66,0)
 I '($$ACTIVE^XUSER(DUZ)) D  Q
"RTN","LR309",67,0)
 .S MSG="You are not a valid user on this system"
"RTN","LR309",68,0)
 .D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",69,0)
 .S XPDQUIT=2
"RTN","LR309",70,0)
 Q
"RTN","LR309",71,0)
 ;
"RTN","LR309",72,0)
EXIT ;
"RTN","LR309",73,0)
 I $G(XPDQUIT) D
"RTN","LR309",74,0)
 .D BMES^XPDUTL($$CJ^XLFSTR("--- Install Environment Check FAILED ---",IOM))
"RTN","LR309",75,0)
 I '$G(XPDQUIT) D
"RTN","LR309",76,0)
 .D BMES^XPDUTL($$CJ^XLFSTR("--- Environment Check is Ok ---",IOM))
"RTN","LR309",77,0)
 Q
"RTN","LR309",78,0)
 ;
"RTN","LR309",79,0)
MATCH ;
"RTN","LR309",80,0)
 N LRDFN,LRI,XDATA1,LRMATFND,LREDATE,MSG,X,X1,X2,LRFNAM
"RTN","LR309",81,0)
 N SEX,AGE,PNM,SSN,LRCNT,LRIDT,XDATA,XDATA2
"RTN","LR309",82,0)
 K ^XTMP("LR309")
"RTN","LR309",83,0)
 S X=$$FMADD^XLFDT($$NOW^XLFDT,180,0,0,0)
"RTN","LR309",84,0)
 S ^XTMP("LR309",0)=X_"^"_$$NOW^XLFDT_"^LR309 DATA IN DESCRIPTION FIELD (#20)IN CYTOPATHOLOGY SUB-FILE(#63.09) IN LAB DATA FILE (#63) REPORT"
"RTN","LR309",85,0)
 S MSG="Searching for data in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file (#63.09) in LAB DATA file (#63)."
"RTN","LR309",86,0)
 D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",87,0)
 S (LRDFN,LRMATFND,LRCNT)=0
"RTN","LR309",88,0)
 F  S LRDFN=$O(^LR(LRDFN)) Q:LRDFN<1  D
"RTN","LR309",89,0)
 .Q:'$D(^LR(LRDFN,"CY"))
"RTN","LR309",90,0)
 .S LRIDT=0,(XDATA,XDATA2)=""
"RTN","LR309",91,0)
 .K LRDPF,VADM,PNM,SSN,VA
"RTN","LR309",92,0)
 .D PT^LRX
"RTN","LR309",93,0)
 .K LRANS,LRERR
"RTN","LR309",94,0)
 .S LRFNAM=$$GET1^DID(1,LRDPF,"","NAME","LRANS","LRERR")
"RTN","LR309",95,0)
 .I $G(LRERR) S LRFNAM="UNKNOWN"
"RTN","LR309",96,0)
 .F  S LRIDT=$O(^LR(LRDFN,"CY",LRIDT)) Q:LRIDT<1  D
"RTN","LR309",97,0)
 ..I $D(^LR(LRDFN,"CY",LRIDT,"WP")) D
"RTN","LR309",98,0)
 ...S LREDATE=$$FMTE^XLFDT($P(^LR(LRDFN,"CY",LRIDT,"WP",0),"^",5),1)
"RTN","LR309",99,0)
 ...S LRMATFND=1
"RTN","LR309",100,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"EDATE")=LREDATE
"RTN","LR309",101,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"SRC")=LRFNAM
"RTN","LR309",102,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"NAME")=PNM
"RTN","LR309",103,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"SSN")=$S($G(SSN):SSN,1:"Unknown")
"RTN","LR309",104,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"AGE")=$S($G(AGE):AGE,1:"Unknown")
"RTN","LR309",105,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"SEX")=$S(SEX="F":"FEMALE",SEX="M":"MALE",1:"Unknown")
"RTN","LR309",106,0)
 ...S ^XTMP("LR309",LRDFN,"CY",LRIDT,"ACN")=$P($G(^LR(LRDFN,"CY",LRIDT,0)),U,6)
"RTN","LR309",107,0)
 ...M ^XTMP("LR309",LRDFN,"CY",LRIDT,"WP")=^LR(LRDFN,"CY",LRIDT,"WP")
"RTN","LR309",108,0)
 ...K ^LR(LRDFN,"CY",LRIDT,"WP")
"RTN","LR309",109,0)
 S MSG="Search finished"
"RTN","LR309",110,0)
 D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",111,0)
 I $O(^XTMP("LR309",""),-1)>0 D
"RTN","LR309",112,0)
 .S MSG="Data entries have been found in ^LR(D0,"_"""CY"""_",D1,"_"""WP"""_",0)"
"RTN","LR309",113,0)
 .D BMES^XPDUTL($$CJ^XLFSTR(MSG,IOM)) K MSG
"RTN","LR309",114,0)
 .S MSG(1)=" "
"RTN","LR309",115,0)
 .S MSG(2)="The data found is sent in a mail message to all users"
"RTN","LR309",116,0)
 .S MSG(3)="who hold the security keys LRLIASON and LRAPSUPER. "
"RTN","LR309",117,0)
 .S MSG(4)="The data will automatically be purged from the"
"RTN","LR309",118,0)
 .S MSG(5)="^XTMP("_"""LR309"""_", global in 180 days. "
"RTN","LR309",119,0)
 .S MSG(6)=" "
"RTN","LR309",120,0)
 .S MSG(7)=" "
"RTN","LR309",121,0)
 .S MSG(8)=" "
"RTN","LR309",122,0)
 .S MSG(9)="Data deleted from DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file (#63.09) in"
"RTN","LR309",123,0)
 .S MSG(10)="LAB DATA file (#63)."
"RTN","LR309",124,0)
 .D MES^XPDUTL(.MSG)
"RTN","LR309",125,0)
 Q
"RTN","LR309",126,0)
REMOVE ;Removes the DD entry for field #20
"RTN","LR309",127,0)
 N DIK,DA,MSG
"RTN","LR309",128,0)
 S DIK="^DD(63.09,",DA=20,DA(1)=63.09 D ^DIK
"RTN","LR309",129,0)
 Q
"RTN","LR309",130,0)
RECIP ; Find recipients with LRAPSUPER key and LRLIASON key.
"RTN","LR309",131,0)
 S LRDUZ=0
"RTN","LR309",132,0)
 F  S LRDUZ=$O(^XUSEC("LRAPSUPER",LRDUZ)) Q:'LRDUZ  S XMY(LRDUZ)=""
"RTN","LR309",133,0)
 S LRDUZ=0
"RTN","LR309",134,0)
 F  S LRDUZ=$O(^XUSEC("LRLIASON",LRDUZ)) Q:'LRDUZ  S XMY(LRDUZ)=""
"RTN","LR309",135,0)
 K LRDUZ
"RTN","LR309",136,0)
 Q
"RTN","LR309",137,0)
PRINT1 ; Actually print the report
"RTN","LR309",138,0)
 K ^TMP($J)
"RTN","LR309",139,0)
 N LRDATA,LRPAT,LRDATE,LRDFN,LRNAM,LRACC,PNM,LRSTATE,LRIDT
"RTN","LR309",140,0)
 N LRLNCNT,LRI,LRPAGE,LRCURPNM,LRZTSK,LRLINE
"RTN","LR309",141,0)
 N LRPDF,VADM,SSN,SEX,VA
"RTN","LR309",142,0)
 I '$D(^XTMP("LR309")) Q
"RTN","LR309",143,0)
 S LRDFN=""
"RTN","LR309",144,0)
 S LRI=0,LRIDT=1
"RTN","LR309",145,0)
 S LRPAGE=0,LRLNCNT=0
"RTN","LR309",146,0)
 D HEADER2
"RTN","LR309",147,0)
 F  S LRDFN=$O(^XTMP("LR309",LRDFN)) Q:LRDFN=""  D
"RTN","LR309",148,0)
 . S LRIDT=""
"RTN","LR309",149,0)
 . K PNM,LRPDF,VADM,SSN,SEX,SSN,VA
"RTN","LR309",150,0)
 . D PT^LRX
"RTN","LR309",151,0)
 . F  S LRIDT=$O(^XTMP("LR309",LRDFN,"CY",LRIDT)) Q:LRIDT=""  D
"RTN","LR309",152,0)
 . . S LRACC=$P(^LR(LRDFN,"CY",LRIDT,0),U,6)
"RTN","LR309",153,0)
 . . I (LRI'=LRIDT) D
"RTN","LR309",154,0)
 . . . D PTHDR
"RTN","LR309",155,0)
 . . . S LRI=LRIDT  ; Flag so we do not repeat the entire patient header each time.
"RTN","LR309",156,0)
 . . D PRTDATA
"RTN","LR309",157,0)
 . . F LRI=1:1:2 S LRDATA=" " D MSG
"RTN","LR309",158,0)
 Q
"RTN","LR309",159,0)
 ;
"RTN","LR309",160,0)
PTHDR ; header for each new patient entry
"RTN","LR309",161,0)
 N LRDATA
"RTN","LR309",162,0)
 S LRDATA="Patient: "_^XTMP("LR309",LRDFN,"CY",LRIDT,"NAME")
"RTN","LR309",163,0)
 S LRDATA=LRDATA_" ("_^XTMP("LR309",LRDFN,"CY",LRIDT,"SRC")_" FILE)" D MSG
"RTN","LR309",164,0)
 S LRDATA=" GENDER: "_^XTMP("LR309",LRDFN,"CY",LRIDT,"SEX")
"RTN","LR309",165,0)
 S LRDATA=LRDATA_"    SSN: "_^XTMP("LR309",LRDFN,"CY",LRIDT,"SSN")
"RTN","LR309",166,0)
 S LRDATA=LRDATA_"    Accession Number: "_^XTMP("LR309",LRDFN,"CY",LRIDT,"ACN") D MSG
"RTN","LR309",167,0)
 S LRDATA=" AGE   : "_^XTMP("LR309",LRDFN,"CY",LRIDT,"AGE") D MSG
"RTN","LR309",168,0)
 S LRDATA=" " D MSG
"RTN","LR309",169,0)
 S LRDATA="Data Found in DESCRIPTION field (#20) in CYTOPATHOLOGY sub-file (63.09) in LAB" D MSG
"RTN","LR309",170,0)
 S LRDATA="DATA file (#63): " D MSG
"RTN","LR309",171,0)
 S LRDATA="==============================================================================" D MSG
"RTN","LR309",172,0)
 Q
"RTN","LR309",173,0)
 ;
"RTN","LR309",174,0)
PRTDATA ;
"RTN","LR309",175,0)
 N LRDATA,DIR,DIRUT,MSG
"RTN","LR309",176,0)
 S LRLINE=0
"RTN","LR309",177,0)
 F  S LRLINE=$O(^XTMP("LR309",LRDFN,"CY",LRIDT,"WP",LRLINE)) Q:LRLINE<1  D
"RTN","LR309",178,0)
 . S LRDATA=$G(^XTMP("LR309",LRDFN,"CY",LRIDT,"WP",LRLINE,0)) D MSG
"RTN","LR309",179,0)
 . S LRDATA=" " D MSG
"RTN","LR309",180,0)
 S LRDATA="-----------------------------------------------------------------------------" D MSG
"RTN","LR309",181,0)
 S LRDATA=" " D MSG
"RTN","LR309",182,0)
 Q
"RTN","LR309",183,0)
 ;
"RTN","LR309",184,0)
HEADER2 ; Prints header for all other pages
"RTN","LR309",185,0)
 N LRDATA
"RTN","LR309",186,0)
 S LRPAGE=LRPAGE+1
"RTN","LR309",187,0)
 S LRDATA="                              LR309 DATA REPORT            Page: "_LRPAGE D MSG
"RTN","LR309",188,0)
 S LRDATA=" " D MSG
"RTN","LR309",189,0)
 I (LRI=LRIDT) D
"RTN","LR309",190,0)
 . S LRDATA="Continuation of Patient: "_^XTMP("LR309",LRDFN,"CY",LRIDT,"NAME") D MSG
"RTN","LR309",191,0)
 . S LRDATA=" " D MSG
"RTN","LR309",192,0)
 F LRI=1:1:2 S LRDATA=" " D MSG
"RTN","LR309",193,0)
 Q
"RTN","LR309",194,0)
 ;
"RTN","LR309",195,0)
MSG S ^TMP($J,"LR309",LRLNCNT)=LRDATA S LRLNCNT=LRLNCNT+1
"RTN","LR309",196,0)
 Q 
"RTN","LR309",197,0)
SEND ;Send the message to users of the security keys LRLIASON and LRAPSUPER
"RTN","LR309",198,0)
 N DIFROM,XMY,XMSUB,XMTEXT,XMDUN
"RTN","LR309",199,0)
 D RECIP
"RTN","LR309",200,0)
 S XMSUB="LR*5.2*309 DATA REPORT"
"RTN","LR309",201,0)
 S XMTEXT="^TMP("_$J_",""LR309"","
"RTN","LR309",202,0)
 S XMDUN="LR*5.2*309"
"RTN","LR309",203,0)
 D ^XMD
"RTN","LR309",204,0)
 Q
"RTN","LRAUAW")
0^1^B5111264^B5818727
"RTN","LRAUAW",1,0)
LRAUAW ;AVAMC/REG/CKA - AUTOPSY DATA ENTRY ;8/11/97
"RTN","LRAUAW",2,0)
 ;;5.2;LAB SERVICE;**72,115,121,309**;Sep 27, 1994;Build 23
"RTN","LRAUAW",3,0)
 ;Reference to DIC supported by IA #916
"RTN","LRAUAW",4,0)
 S:'$D(LRMD) LRMD=""
"RTN","LRAUAW",5,0)
 W !!,"Enter Weights & Measurements "
"RTN","LRAUAW",6,0)
 S %=2
"RTN","LRAUAW",7,0)
 D YN^LRU
"RTN","LRAUAW",8,0)
 I %<0 D END^LRAPLG1 Q
"RTN","LRAUAW",9,0)
 S DA=LRDFN,DIE="^LR(",LRSD=LREXP
"RTN","LRAUAW",10,0)
 S DR="11;S LRRC=X;14///"_LRAC_";14.1;S LRLLOC=X;14.5;14.6;S LRSVC=X;12.1;S LRMD=X;13.5:13.8"
"RTN","LRAUAW",11,0)
 I %=1 D SET
"RTN","LRAUAW",12,0)
DIE W !
"RTN","LRAUAW",13,0)
 D ^DIE
"RTN","LRAUAW",14,0)
 I $D(Y) W $C(7),!!,"All Prompts were not answered  <ENTRY DELETED>" K ^LR(LRDFN,"AU"),^("AX") D X^LRAPLG1 Q
"RTN","LRAUAW",15,0)
 I $D(@(LRPF_DFN_",0)")),$P(^(0),"^",3) S X2=$P(^(0),"^",3),X1=LRSD D ^%DTC S AGE=$S(X>365.24:X\365.25,X>7:X\7_"w",X>0:X_"d",1:""),DR="12.5///"_AGE D ^DIE
"RTN","LRAUAW",16,0)
 S (LRCS,LRC(5))="",LRI=9999999-$P(LRSD,".")
"RTN","LRAUAW",17,0)
 D ^LRUWLF
"RTN","LRAUAW",18,0)
 D:LRCAPA ^LRAPSWK
"RTN","LRAUAW",19,0)
 D OERR^LR7OB63D
"RTN","LRAUAW",20,0)
 Q
"RTN","LRAUAW",21,0)
DEL ;from LRUDEL
"RTN","LRAUAW",22,0)
 W !,"DATE DIED ",Y
"RTN","LRAUAW",23,0)
 I $D(^LR(LRDFN,"AU")),$P(^("AU"),"^",3) W $C(7),"  Cannot delete a completed autopsy." Q
"RTN","LRAUAW",24,0)
 L +^LR(LRDFN,"AU"):1
"RTN","LRAUAW",25,0)
 I '$T W !!?10,"Someone else is editing this entry ",!,$C(7) L -^LR(LRDFN,"AU") Q
"RTN","LRAUAW",26,0)
 W "  OK to DELETE "
"RTN","LRAUAW",27,0)
 S %=2
"RTN","LRAUAW",28,0)
 D YN^LRU
"RTN","LRAUAW",29,0)
 Q:%'=1
"RTN","LRAUAW",30,0)
 D ACC^LR7OB1(LRAA,LRAD,LRAN,"OC") ;Cancel order
"RTN","LRAUAW",31,0)
 K ^LR(LRDFN,"AU"),^("AV"),^("AW"),^("AY"),^(33),^(80),^(81),^(82)
"RTN","LRAUAW",32,0)
 F A=0:0 S A=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,A)) Q:'A  K ^LRO(68,"AA",LRAA_"|"_LRAD_"|"_LRAN_"|"_A)
"RTN","LRAUAW",33,0)
 K ^LRO(68,LRAA,1,LRAD,1,LRAN),^LRO(68,LRAA,1,"AC",DUZ(2),LRAD,LRAN)
"RTN","LRAUAW",34,0)
 K ^LRO(68,LRAA,1,LRAD,1,"E",+LRRC,LRAN)
"RTN","LRAUAW",35,0)
 D X^LRAPLG1
"RTN","LRAUAW",36,0)
 Q
"RTN","LRAUAW",37,0)
SET S DR=DR_";16:24;26:31;25;31.1:31.4;25.1:25.9"
"RTN","LRAUAW",38,0)
 Q
"RTN","LRAUAW",39,0)
D ;get date died- called by DD(63,11,0),LRAPED,LRAPBK,LRAPS2,LRAPT2,
"RTN","LRAUAW",40,0)
 ;    LRAPAUSR,LRAPPF1,LRAPAUL,LRAPLG2
"RTN","LRAUAW",41,0)
 S A=^LR(DA,0),B=+$P(A,U,2),C=+$P(A,U,3),A=^DIC(B,0,"GL")
"RTN","LRAUAW",42,0)
 S LR(63,12)=$S($D(@(A_C_",.35)")):+^(.35),1:"")
"RTN","LRAUAW",43,0)
 S LR(63,.02)=$P(^DIC(B,0),U)
"RTN","LRAUAW",44,0)
 Q
"VER")
8.0^22.0
"BLD",5534,6)
^309
**END**
**END**
