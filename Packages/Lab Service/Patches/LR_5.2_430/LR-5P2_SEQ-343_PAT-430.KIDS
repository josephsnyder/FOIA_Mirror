Released LR*5.2*430 SEQ #343
Extracted from mail message
**KIDS**:LR*5.2*430^

**INSTALL NAME**
LR*5.2*430
"BLD",9426,0)
LR*5.2*430^LAB SERVICE^0^3130802^y
"BLD",9426,1,0)
^^5^5^3130724^^^
"BLD",9426,1,1,0)
This is a general maintenance patch for the laboratory
"BLD",9426,1,2,0)
package by the Vista Maintenance team that addresses
"BLD",9426,1,3,0)
issues with the Howdy software relating to exclusionary
"BLD",9426,1,4,0)
functionality and also issues with the Howdy Wait Time
"BLD",9426,1,5,0)
report and the Howdy Track Collection report.
"BLD",9426,4,0)
^9.64PA^69.86^1
"BLD",9426,4,69.86,0)
69.86
"BLD",9426,4,69.86,2,0)
^9.641^69.868^1
"BLD",9426,4,69.86,2,69.868,0)
COLLECTION TYPES (TO EXCLUDE)  (sub-file)
"BLD",9426,4,69.86,2,69.868,1,0)
^9.6411^.01^1
"BLD",9426,4,69.86,2,69.868,1,.01,0)
COLLECTION TYPE (TO EXCLUDE)
"BLD",9426,4,69.86,222)
y^y^p^^^^n^^n
"BLD",9426,4,69.86,224)

"BLD",9426,4,"APDD",69.86,69.868)

"BLD",9426,4,"APDD",69.86,69.868,.01)

"BLD",9426,4,"B",69.86,69.86)

"BLD",9426,6.3)
2
"BLD",9426,"ABPKG")
n
"BLD",9426,"INIT")
POST^LR430PST
"BLD",9426,"KRN",0)
^9.67PA^779.2^20
"BLD",9426,"KRN",.4,0)
.4
"BLD",9426,"KRN",.401,0)
.401
"BLD",9426,"KRN",.402,0)
.402
"BLD",9426,"KRN",.403,0)
.403
"BLD",9426,"KRN",.5,0)
.5
"BLD",9426,"KRN",.84,0)
.84
"BLD",9426,"KRN",3.6,0)
3.6
"BLD",9426,"KRN",3.8,0)
3.8
"BLD",9426,"KRN",9.2,0)
9.2
"BLD",9426,"KRN",9.8,0)
9.8
"BLD",9426,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",9426,"KRN",9.8,"NM",1,0)
LRHY4X^^0^B64257320
"BLD",9426,"KRN",9.8,"NM",2,0)
LRHYBC1^^0^B64831523
"BLD",9426,"KRN",9.8,"NM",3,0)
LR430PST^^0^B2130850
"BLD",9426,"KRN",9.8,"NM","B","LR430PST",3)

"BLD",9426,"KRN",9.8,"NM","B","LRHY4X",1)

"BLD",9426,"KRN",9.8,"NM","B","LRHYBC1",2)

"BLD",9426,"KRN",19,0)
19
"BLD",9426,"KRN",19.1,0)
19.1
"BLD",9426,"KRN",101,0)
101
"BLD",9426,"KRN",409.61,0)
409.61
"BLD",9426,"KRN",771,0)
771
"BLD",9426,"KRN",779.2,0)
779.2
"BLD",9426,"KRN",870,0)
870
"BLD",9426,"KRN",8989.51,0)
8989.51
"BLD",9426,"KRN",8989.52,0)
8989.52
"BLD",9426,"KRN",8994,0)
8994
"BLD",9426,"KRN","B",.4,.4)

"BLD",9426,"KRN","B",.401,.401)

"BLD",9426,"KRN","B",.402,.402)

"BLD",9426,"KRN","B",.403,.403)

"BLD",9426,"KRN","B",.5,.5)

"BLD",9426,"KRN","B",.84,.84)

"BLD",9426,"KRN","B",3.6,3.6)

"BLD",9426,"KRN","B",3.8,3.8)

"BLD",9426,"KRN","B",9.2,9.2)

"BLD",9426,"KRN","B",9.8,9.8)

"BLD",9426,"KRN","B",19,19)

"BLD",9426,"KRN","B",19.1,19.1)

"BLD",9426,"KRN","B",101,101)

"BLD",9426,"KRN","B",409.61,409.61)

"BLD",9426,"KRN","B",771,771)

"BLD",9426,"KRN","B",779.2,779.2)

"BLD",9426,"KRN","B",870,870)

"BLD",9426,"KRN","B",8989.51,8989.51)

"BLD",9426,"KRN","B",8989.52,8989.52)

"BLD",9426,"KRN","B",8994,8994)

"BLD",9426,"QUES",0)
^9.62^^
"BLD",9426,"REQB",0)
^9.611^1^1
"BLD",9426,"REQB",1,0)
LR*5.2*417^2
"BLD",9426,"REQB","B","LR*5.2*417",1)

"FIA",69.86)
HOWDY SITE FILE
"FIA",69.86,0)
^LRHY(69.86,
"FIA",69.86,0,0)
69.86
"FIA",69.86,0,1)
y^y^p^^^^n^^n
"FIA",69.86,0,10)

"FIA",69.86,0,11)

"FIA",69.86,0,"RLRO")

"FIA",69.86,0,"VR")
5.2^LR
"FIA",69.86,69.86)
1
"FIA",69.86,69.86,8)

"FIA",69.86,69.868)
1
"FIA",69.86,69.868,.01)

"INIT")
POST^LR430PST
"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
430^3130802
"PKG",26,22,1,"PAH",1,1,0)
^^5^5^3130802
"PKG",26,22,1,"PAH",1,1,1,0)
This is a general maintenance patch for the laboratory
"PKG",26,22,1,"PAH",1,1,2,0)
package by the Vista Maintenance team that addresses
"PKG",26,22,1,"PAH",1,1,3,0)
issues with the Howdy software relating to exclusionary
"PKG",26,22,1,"PAH",1,1,4,0)
functionality and also issues with the Howdy Wait Time
"PKG",26,22,1,"PAH",1,1,5,0)
report and the Howdy Track Collection report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LR430PST")
0^3^B2130850^n/a
"RTN","LR430PST",1,0)
LR430PST ;Post-init Routine for LR*5.2*430 ; 2/18/04 9:29am
"RTN","LR430PST",2,0)
 ;;5.2;LAB SERVICE;**430**;Dec 30, 1994;Build 2
"RTN","LR430PST",3,0)
 ;
"RTN","LR430PST",4,0)
PRE ; initiate pre-init process
"RTN","LR430PST",5,0)
 Q
"RTN","LR430PST",6,0)
 ;
"RTN","LR430PST",7,0)
POST ; initiate post-init process
"RTN","LR430PST",8,0)
 ;
"RTN","LR430PST",9,0)
 D 768005
"RTN","LR430PST",10,0)
 ;
"RTN","LR430PST",11,0)
 D EN^DDIOL("Post-init routine for patch LR*5.2*430 completed.",,"!!!!")
"RTN","LR430PST",12,0)
 ;
"RTN","LR430PST",13,0)
 Q
"RTN","LR430PST",14,0)
 ;
"RTN","LR430PST",15,0)
768005 ; Check Howdy Site file (#69.86) for collection type to exclude of "IC"
"RTN","LR430PST",16,0)
 ; If found, replace with "I"
"RTN","LR430PST",17,0)
 ;
"RTN","LR430PST",18,0)
 N LRHYSITE,LRHYSQ,LRHYTYPE,LRTYPEIC
"RTN","LR430PST",19,0)
 S LRTYPEI="I"
"RTN","LR430PST",20,0)
 S LRHYSITE=""
"RTN","LR430PST",21,0)
 F  S LRHYSITE=$O(^LRHY(69.86,LRHYSITE)) Q:LRHYSITE=""  Q:LRHYSITE'?.N  D
"RTN","LR430PST",22,0)
 . S LRHYSEQ=0
"RTN","LR430PST",23,0)
 . F  S LRHYSEQ=$O(^LRHY(69.86,LRHYSITE,8,LRHYSEQ)) Q:LRHYSEQ=""  Q:LRHYSEQ'?.N  D
"RTN","LR430PST",24,0)
 . . S LRHYTYPE=$G(^LRHY(69.86,LRHYSITE,8,LRHYSEQ,0)) Q:LRHYTYPE=""
"RTN","LR430PST",25,0)
 . . ;
"RTN","LR430PST",26,0)
 . . I LRHYTYPE="IC" D
"RTN","LR430PST",27,0)
 . . . S DA=LRHYSEQ,DA(1)=LRHYSITE,DIK="^LRHY(69.86,"_DA(1)_",8,"
"RTN","LR430PST",28,0)
 . . . D ^DIK
"RTN","LR430PST",29,0)
 . . . K DA,DIK
"RTN","LR430PST",30,0)
 . . . ;
"RTN","LR430PST",31,0)
 . . . S DA=LRHYSEQ,DA(1)=LRHYSITE,DIC="^LRHY(69.86,"_DA(1)_",8,",X=LRTYPEI,DIC(0)=""
"RTN","LR430PST",32,0)
 . . . D FILE^DICN
"RTN","LR430PST",33,0)
 . . . K DA,DIC
"RTN","LR430PST",34,0)
 ;
"RTN","LR430PST",35,0)
 Q
"RTN","LR430PST",36,0)
 ;
"RTN","LRHY4X")
0^1^B64257320^B61161096
"RTN","LRHY4X",1,0)
LRHY4X ;DALOI/HOAK - PHLEBOTOMY TAT ;4/13/1999
"RTN","LRHY4X",2,0)
 ;;5.2;LAB SERVICE;**405,417,430**;Sep 27, 1994;Build 2
"RTN","LRHY4X",3,0)
 ;
"RTN","LRHY4X",4,0)
 ;
"RTN","LRHY4X",5,0)
START ;
"RTN","LRHY4X",6,0)
 ;
"RTN","LRHY4X",7,0)
G ;
"RTN","LRHY4X",8,0)
 K ^TMP("LRHYMEDTAT",$J)
"RTN","LRHY4X",9,0)
 ;
"RTN","LRHY4X",10,0)
 K ^TMP("LRHYCOLLECTOR",$J)
"RTN","LRHY4X",11,0)
 ;
"RTN","LRHY4X",12,0)
 K ^TMP("LRHYTATDALLAS",$J)
"RTN","LRHY4X",13,0)
 K LRHYTECH1
"RTN","LRHY4X",14,0)
 K %DT
"RTN","LRHY4X",15,0)
 S %DT="AET"
"RTN","LRHY4X",16,0)
 S %DT("A")="Please enter date and time to start search: "
"RTN","LRHY4X",17,0)
 D ^%DT
"RTN","LRHY4X",18,0)
 Q:Y=-1
"RTN","LRHY4X",19,0)
 S LRSDT=Y
"RTN","LRHY4X",20,0)
 S LRODT=$P(LRSDT,".")
"RTN","LRHY4X",21,0)
 S %DT("A")="Please enter date and time to end search: "
"RTN","LRHY4X",22,0)
 D ^%DT
"RTN","LRHY4X",23,0)
 Q:Y=-1
"RTN","LRHY4X",24,0)
 S LREDT=Y
"RTN","LRHY4X",25,0)
 ;
"RTN","LRHY4X",26,0)
 D DEVICE
"RTN","LRHY4X",27,0)
 K ^TMP("LRHYMEDTAT",$J),^TMP("LRHYMEDFINAL",$J)
"RTN","LRHY4X",28,0)
 K ^TMP("LRHYCOLLECTOR",$J),^TMP("LRHYTATDALLAS",$J)
"RTN","LRHY4X",29,0)
 QUIT
"RTN","LRHY4X",30,0)
PAT ;
"RTN","LRHY4X",31,0)
 ;
"RTN","LRHY4X",32,0)
 ;
"RTN","LRHY4X",33,0)
 S LREND=0
"RTN","LRHY4X",34,0)
 S DIC="^DPT("
"RTN","LRHY4X",35,0)
 S DIC(0)="AEMQZ"
"RTN","LRHY4X",36,0)
 D ^DIC
"RTN","LRHY4X",37,0)
 S DFN=+Y
"RTN","LRHY4X",38,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHY4X",39,0)
 D ^VADPT,INP^VADPT
"RTN","LRHY4X",40,0)
 ;
"RTN","LRHY4X",41,0)
 QUIT
"RTN","LRHY4X",42,0)
 ;
"RTN","LRHY4X",43,0)
LRO69 ;
"RTN","LRHY4X",44,0)
Q ;
"RTN","LRHY4X",45,0)
 U IO
"RTN","LRHY4X",46,0)
 S LREND=0
"RTN","LRHY4X",47,0)
 S LRSTAR=0
"RTN","LRHY4X",48,0)
 D HEAD
"RTN","LRHY4X",49,0)
 S LRSN=0
"RTN","LRHY4X",50,0)
 S LRSTOP=0
"RTN","LRHY4X",51,0)
 S LRDRAW1=LRODT
"RTN","LRHY4X",52,0)
 F  S LRDRAW1=$O(^LRHY(69.87,"COLT",LRDRAW1)) Q:+LRDRAW1'>0!(LRDRAW1>LREDT)!(LRSTOP)  D
"RTN","LRHY4X",53,0)
 .  S LRUID=""
"RTN","LRHY4X",54,0)
 .  F  S LRUID=$O(^LRHY(69.87,"COLT",LRDRAW1,LRUID)) Q:LRUID=""  D
"RTN","LRHY4X",55,0)
 ..  ;
"RTN","LRHY4X",56,0)
 ..  S LRUID=$G(^LRHY(69.87,LRUID,0))
"RTN","LRHY4X",57,0)
 ..  I '$O(^LRO(68,"C",LRUID,0)) QUIT
"RTN","LRHY4X",58,0)
 ..  S LRAA=$O(^LRO(68,"C",LRUID,0))
"RTN","LRHY4X",59,0)
 ..  S LRAD=$O(^LRO(68,"C",LRUID,LRAA,0))
"RTN","LRHY4X",60,0)
 ..  S LRAN=$O(^LRO(68,"C",LRUID,LRAA,LRAD,0))
"RTN","LRHY4X",61,0)
 ..  D IN
"RTN","LRHY4X",62,0)
 D DISP
"RTN","LRHY4X",63,0)
 QUIT
"RTN","LRHY4X",64,0)
IN ;
"RTN","LRHY4X",65,0)
 S LR6987=$O(^LRHY(69.87,"B",LRUID,0)) Q:'$G(LR6987)
"RTN","LRHY4X",66,0)
 D
"RTN","LRHY4X",67,0)
 .  S LREND=0
"RTN","LRHY4X",68,0)
 .  K LRARIVE
"RTN","LRHY4X",69,0)
 .  S LRSN=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,5),LRORDT=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,4)
"RTN","LRHY4X",70,0)
 .  S LRACCTM=$G(^LRHY(69.87,LR6987,2))
"RTN","LRHY4X",71,0)
 .  S LRTKX=$G(^LRHY(69.87,LR6987,6))
"RTN","LRHY4X",72,0)
 .  S LRARIVE=$G(^LRHY(69.87,LR6987,8))
"RTN","LRHY4X",73,0)
 .  K LRNCOL
"RTN","LRHY4X",74,0)
 .  S LR3D=$P(LRDRAW1,".",2)
"RTN","LRHY4X",75,0)
 .  I $L(LR3D)'>3 S LR3D=LR3D_"0"
"RTN","LRHY4X",76,0)
 .  S LR3D=$E(LR3D,1,2)*60+$E(LR3D,3,4)
"RTN","LRHY4X",77,0)
 .  S LR3T=$P(LRACCTM,".",2)
"RTN","LRHY4X",78,0)
 .  I $L(LR3T)'>3 S LR3T=LR3T_"0"
"RTN","LRHY4X",79,0)
 .  S LR3T=$E(LR3T,1,2)*60+$E(LR3T,3,4)
"RTN","LRHY4X",80,0)
 .  S LRTAT=(LR3D-LR3T)
"RTN","LRHY4X",81,0)
 .  S LRDRAW=$E($P(LRDRAW1,".",2),1,2)_":"_$E($P(LRDRAW1,".",2),3,4)
"RTN","LRHY4X",82,0)
 .  S LRARIVE=$E($P(LRACCTM,".",2),1,2)_":"_$E($P(LRACCTM,".",2),3,4)
"RTN","LRHY4X",83,0)
 .  ;
"RTN","LRHY4X",84,0)
 .  K LRDFN
"RTN","LRHY4X",85,0)
 .  S LRDFN=+^LRO(68,LRAA,1,LRAD,1,LRAN,0)
"RTN","LRHY4X",86,0)
 .  K LRDPF D PT^LRX
"RTN","LRHY4X",87,0)
 .  S LRSSN=$P(SSN,"-",3)
"RTN","LRHY4X",88,0)
 .  S LRAC1=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,.2))
"RTN","LRHY4X",89,0)
 .  I LRAC1="" S LRAC1=$E($P(^LRO(68,LRAA,0),U),1,2)_" "_$E(LRAD,4,7)_" "_LRAN
"RTN","LRHY4X",90,0)
 .  S LRAANAME=$P(^LRO(68,LRAA,0),U)
"RTN","LRHY4X",91,0)
 .  ; check specimen not urine
"RTN","LRHY4X",92,0)
 .  S LRLLOC=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,7)
"RTN","LRHY4X",93,0)
 .  S LRSC0=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,13)
"RTN","LRHY4X",94,0)
 .  I $P($G(LRNCOL),U,4) S ^TMP("LRHYCOLLECTOR",$J,LRORDT_U_LRSN_U_LRUID,$P(LRNCOL,U,4))=""
"RTN","LRHY4X",95,0)
 .  K LRHYTECH
"RTN","LRHY4X",96,0)
 .  S LRHYTECH=$G(^LRHY(69.87,LR6987,12))
"RTN","LRHY4X",97,0)
 .  ;
"RTN","LRHY4X",98,0)
 .  ;
"RTN","LRHY4X",99,0)
 .  S LRHYTECH=$G(LRTKX)
"RTN","LRHY4X",100,0)
 .  I LRHYTECH S ^TMP("LRHYCOLLECTOR",$J,LRORDT_U_LRSN_U_LRUID,LRHYTECH)=""
"RTN","LRHY4X",101,0)
 .  ;
"RTN","LRHY4X",102,0)
 .  S LRSTAR=0
"RTN","LRHY4X",103,0)
 .  ;
"RTN","LRHY4X",104,0)
 .  S ^TMP("LRHYTATDALLAS",$J,$E(LRDRAW,1,2),LRORDT_U_LRSN_U_LRUID)=LRDRAW_U_PNM_U_LRSSN_U_LRARIVE_U_LRTAT_U_LRAC1_U_$G(LRSTAR)_U_$G(LRLLOC)
"RTN","LRHY4X",105,0)
 ;
"RTN","LRHY4X",106,0)
 QUIT
"RTN","LRHY4X",107,0)
 ;
"RTN","LRHY4X",108,0)
DISP ;
"RTN","LRHY4X",109,0)
 ;
"RTN","LRHY4X",110,0)
 ;
"RTN","LRHY4X",111,0)
 S LRTOTAL=0
"RTN","LRHY4X",112,0)
 S LRHYCT=0
"RTN","LRHY4X",113,0)
 U IO
"RTN","LRHY4X",114,0)
 S LRD=0
"RTN","LRHY4X",115,0)
 S LR7MORE=0
"RTN","LRHY4X",116,0)
 S LR7LESS=0
"RTN","LRHY4X",117,0)
 S LR700=0
"RTN","LRHY4X",118,0)
 N LRE,LRTECH,LREXLINE
"RTN","LRHY4X",119,0)
 ;
"RTN","LRHY4X",120,0)
 F  S LRD=$O(^TMP("LRHYTATDALLAS",$J,LRD)) Q:+LRD'>0  D
"RTN","LRHY4X",121,0)
 .  S LRE=""
"RTN","LRHY4X",122,0)
 .  F  S LRE=$O(^TMP("LRHYTATDALLAS",$J,LRD,LRE)) Q:+LRE'>0  S LRN=^(LRE) D
"RTN","LRHY4X",123,0)
 ..  S LRSN=$P(LRE,U,2)
"RTN","LRHY4X",124,0)
 ..  S LRDRAW=+LRN
"RTN","LRHY4X",125,0)
 ..  S LRDRAW=$P(LRN,U)
"RTN","LRHY4X",126,0)
 ..  S PNM=$P(LRN,U,2)
"RTN","LRHY4X",127,0)
 ..  S LRSSN=$P(LRN,U,3)
"RTN","LRHY4X",128,0)
 ..  S LRARIVE=$P(LRN,U,4)
"RTN","LRHY4X",129,0)
 ..  S LRTAT=$P(LRN,U,5)
"RTN","LRHY4X",130,0)
 ..  I LRTAT>7 S LR7MORE=LR7MORE+1
"RTN","LRHY4X",131,0)
 ..  I LRTAT<7 S LR7LESS=LR7LESS+1
"RTN","LRHY4X",132,0)
 ..  I LRTAT=7 S LR700=LR700+1
"RTN","LRHY4X",133,0)
 ..  S LRAC1=$P(LRN,U,6)
"RTN","LRHY4X",134,0)
 ..  S LRTECH=$O(^TMP("LRHYCOLLECTOR",$J,LRE,0))
"RTN","LRHY4X",135,0)
 ..  S LREXLINE=$S($L(LRTECH)>6:1,1:0)
"RTN","LRHY4X",136,0)
 ..  D CHK Q:LRSTOP
"RTN","LRHY4X",137,0)
 ..  K LREXLINE
"RTN","LRHY4X",138,0)
 ..  W !,+$E(LRD,1,2),?4,$E(PNM,1,14)," ",LRSSN,?25,"BLD",?30,LRARIVE,?37,LRDRAW,?44,LRTAT
"RTN","LRHY4X",139,0)
 ..  W ?49,LRTECH
"RTN","LRHY4X",140,0)
 ..  ;I $P(LRN,U,7)=1 W "*"
"RTN","LRHY4X",141,0)
 ..  I $L(LRTECH)>6 W !
"RTN","LRHY4X",142,0)
 ..  W ?56,LRAC1 ;accession
"RTN","LRHY4X",143,0)
 ..  W ?73,$E($P(LRN,U,8),1,7) ;clinic
"RTN","LRHY4X",144,0)
 ..  S LRHYCT=LRHYCT+1 S LRTOTAL=LRTOTAL+LRTAT
"RTN","LRHY4X",145,0)
 ..  S ^TMP("LRHYMEDTAT",$J,LRE)=LRTAT
"RTN","LRHY4X",146,0)
 Q:'LRHYCT
"RTN","LRHY4X",147,0)
 W !!,?10,"Mean TAT: "
"RTN","LRHY4X",148,0)
 W ?35,$P(LRTOTAL/LRHYCT,".")_"."_$E($P(LRTOTAL/LRHYCT,".",2),1,1),?41
"RTN","LRHY4X",149,0)
 D MEDIAN W ?41," Minutes"
"RTN","LRHY4X",150,0)
 W !,?10,"Total Time: ",?35,LRTOTAL,?41," Minutes"
"RTN","LRHY4X",151,0)
 W !,?10,"Total Patients Drawn: ",?35,LRHYCT,!
"RTN","LRHY4X",152,0)
 W !,?15,"TAT > 7 minutes: ",LR7MORE
"RTN","LRHY4X",153,0)
 W !,?15,"TAT < 7 minutes: ",LR7LESS
"RTN","LRHY4X",154,0)
 W !,?15,"TAT = 7 minutes: ",LR700
"RTN","LRHY4X",155,0)
 I LRHYCT=0 S LRHYCT=1
"RTN","LRHY4X",156,0)
 ;
"RTN","LRHY4X",157,0)
 ;
"RTN","LRHY4X",158,0)
 W !,?5,"Collectors: "
"RTN","LRHY4X",159,0)
 S LRN5=0
"RTN","LRHY4X",160,0)
 F  S LRN5=$O(^TMP("LRHYCOLLECTOR",$J,LRN5)) Q:+LRN5'>0  D
"RTN","LRHY4X",161,0)
 .  S LRHYTECH=0
"RTN","LRHY4X",162,0)
 .  F  S LRHYTECH=$O(^TMP("LRHYCOLLECTOR",$J,LRN5,LRHYTECH)) Q:+LRHYTECH'>0  D
"RTN","LRHY4X",163,0)
 ..  S LRHYTECH1(LRHYTECH,LRN5)=""
"RTN","LRHY4X",164,0)
 S LRHYTECH=0
"RTN","LRHY4X",165,0)
 F  S LRHYTECH=$O(LRHYTECH1(LRHYTECH)) Q:+LRHYTECH'>0  D
"RTN","LRHY4X",166,0)
 .  S LRHYCTC=0 S LRT0=0
"RTN","LRHY4X",167,0)
 .  F  S LRT0=$O(LRHYTECH1(LRHYTECH,LRT0)) Q:+LRT0'>0  D
"RTN","LRHY4X",168,0)
 ..  S LRHYCTC=LRHYCTC+1
"RTN","LRHY4X",169,0)
 .  I $D(^VA(200,LRHYTECH)) W !,?10,$P(^VA(200,LRHYTECH,0),U)
"RTN","LRHY4X",170,0)
 .  W ?40,LRHYCTC,?45," Drawn"
"RTN","LRHY4X",171,0)
 K DIR I IOST["C-" S DIR(0)="E" D ^DIR
"RTN","LRHY4X",172,0)
 D ^%ZISC
"RTN","LRHY4X",173,0)
 QUIT
"RTN","LRHY4X",174,0)
MEDIAN ;
"RTN","LRHY4X",175,0)
 N LR334 S LR334=0
"RTN","LRHY4X",176,0)
 F  S LR334=$O(^TMP("LRHYMEDTAT",$J,LR334)) Q:+LR334'>0  I +$G(^TMP("LRHYMEDTAT",$J,LR334))'>0 S ^TMP("LRHYMEDTAT",$J,LR334)=1
"RTN","LRHY4X",177,0)
 S LRSTUCK=0
"RTN","LRHY4X",178,0)
 K ^TMP("LRHYMEDFINAL",$J)
"RTN","LRHY4X",179,0)
 K LRTATN
"RTN","LRHY4X",180,0)
 S LRHYCT3=1
"RTN","LRHY4X",181,0)
BAK S LRX=0 S LRKIL=0 S LRNONONO=0 S LRM3=0
"RTN","LRHY4X",182,0)
 I $D(^TMP("LRHYMEDFINAL",$J)) D
"RTN","LRHY4X",183,0)
 .  I '$D(^TMP("LRHYMEDFINAL",$J,LRHYCT3)) S LRSTUCK=LRSTUCK+1
"RTN","LRHY4X",184,0)
STUCK I $G(LRSTUCK)>2 K ^TMP("LRHYMEDTAT",$J,LRDUP) S LRSTUCK=0
"RTN","LRHY4X",185,0)
 I '$D(^TMP("LRHYMEDTAT",$J)) G DONE QUIT
"RTN","LRHY4X",186,0)
 S LRHYCT3=LRHYCT3+1
"RTN","LRHY4X",187,0)
 S LRM1=$O(^TMP("LRHYMEDTAT",$J,LRX)) S (LRX,LRDUP)=LRM1
"RTN","LRHY4X",188,0)
 S LRM1=$G(^TMP("LRHYMEDTAT",$J,LRM1))
"RTN","LRHY4X",189,0)
TIC F  S LRX=$O(^TMP("LRHYMEDTAT",$J,LRX)) Q:+LRX'>0  S LRM2=^(LRX) D
"RTN","LRHY4X",190,0)
 .  S LRKIL=LRX
"RTN","LRHY4X",191,0)
 .  I LRM2=LRM1 S LRKIL=LRX S LRNOT=0 D
"RTN","LRHY4X",192,0)
 ..  F LRY=1:1:LRHYCT3 Q:'$D(^TMP("LRHYMEDFINAL",$J,LRY))  D
"RTN","LRHY4X",193,0)
 ...  I LRM1>+$O(^TMP("LRHYMEDFINAL",$J,LRY,0)) S LRNOT=1
"RTN","LRHY4X",194,0)
 K ^TMP("LRHYMEDTAT",$J,LRDUP) S LRKIL=LRX
"RTN","LRHY4X",195,0)
 I $G(LRNOT)=1 S LRX=LRX+.05 S LRNOT=0 G TIC
"RTN","LRHY4X",196,0)
 I LRKIL K ^TMP("LRHYMEDTAT",$J,LRKIL)
"RTN","LRHY4X",197,0)
 I +$O(^TMP("LRHYMEDTAT",$J,0)) G BAK
"RTN","LRHY4X",198,0)
 S LRHYCT3=0
"RTN","LRHY4X",199,0)
 S LRX=0
"RTN","LRHY4X",200,0)
 F  S LRX=$O(^TMP("LRHYMEDFINAL",$J,LRX)) Q:+LRX'>0  D
"RTN","LRHY4X",201,0)
 .  S LRHYCT3=LRHYCT3+1
"RTN","LRHY4X",202,0)
 .  S LRYTAT=$O(^TMP("LRHYMEDFINAL",$J,LRX,0))
"RTN","LRHY4X",203,0)
 .  S LRTATN(LRHYCT3)=LRYTAT
"RTN","LRHY4X",204,0)
 S LRX=LRHYCT3/2
"RTN","LRHY4X",205,0)
 Q:'LRX
"RTN","LRHY4X",206,0)
 I LRX[.5 S LRX1=$P(LRX,".") Q:'LRX1  S LRX2=LRX1+1 D
"RTN","LRHY4X",207,0)
 .  S LRX3=(LRTATN(LRX1)+LRTATN(LRX2))/2
"RTN","LRHY4X",208,0)
 E  S LRX3=LRTATN(LRX)
"RTN","LRHY4X",209,0)
 W !,?10,"Median TAT:",?35,LRX3
"RTN","LRHY4X",210,0)
 ;
"RTN","LRHY4X",211,0)
 QUIT
"RTN","LRHY4X",212,0)
HEAD ;
"RTN","LRHY4X",213,0)
 S LRSTOP=0
"RTN","LRHY4X",214,0)
 W @IOF
"RTN","LRHY4X",215,0)
 W "Date:",$$Y2K^LRX(DT)," ",$$CJ^XLFSTR("PATIENT WAIT TIME",IOM)
"RTN","LRHY4X",216,0)
 W !,"Time",?5,"Patient Name",?25,"Type",?30,"Arrive"
"RTN","LRHY4X",217,0)
 W ?37,"Drawn",?44,"TAT",?49,"TECH",?57,"ACCN"
"RTN","LRHY4X",218,0)
 W ?73,"Clinic"
"RTN","LRHY4X",219,0)
 QUIT
"RTN","LRHY4X",220,0)
CHK ;
"RTN","LRHY4X",221,0)
 Q:LRSTOP
"RTN","LRHY4X",222,0)
 S LRLINE=(IOSL-$Y)
"RTN","LRHY4X",223,0)
 I $E(IOST,1,2)["P-" D  QUIT
"RTN","LRHY4X",224,0)
 .  I LRLINE<(7+$G(LREXLINE)) D HEAD QUIT
"RTN","LRHY4X",225,0)
 ;
"RTN","LRHY4X",226,0)
 I LRLINE<(2+$G(LREXLINE)) D
"RTN","LRHY4X",227,0)
 .  Q:$E(IOST,1,2)'["C-"
"RTN","LRHY4X",228,0)
 .  K DIR S DIR(0)="E" D ^DIR
"RTN","LRHY4X",229,0)
 .  I $D(DUOUT)!($D(DIRUT)) S LRSTOP=1 Q
"RTN","LRHY4X",230,0)
 .  D HEAD
"RTN","LRHY4X",231,0)
 QUIT
"RTN","LRHY4X",232,0)
DONE ;
"RTN","LRHY4X",233,0)
 S LRHYCT3=0
"RTN","LRHY4X",234,0)
 S LRX=0
"RTN","LRHY4X",235,0)
 F  S LRX=$O(^TMP("LRHYMEDFINAL",$J,LRX)) Q:+LRX'>0  D
"RTN","LRHY4X",236,0)
 .  S LRHYCT3=LRHYCT3+1
"RTN","LRHY4X",237,0)
 .  S LRYTAT=$O(^TMP("LRHYMEDFINAL",$J,LRX,0))
"RTN","LRHY4X",238,0)
 .  S LRTATN(LRHYCT3)=LRYTAT
"RTN","LRHY4X",239,0)
 S LRX=LRHYCT3/2
"RTN","LRHY4X",240,0)
 I LRX[.5 S LRX1=$P(LRX,".") Q:'LRX1  S LRX2=LRX1+1 D
"RTN","LRHY4X",241,0)
 .  S LRX3=(LRTATN(LRX1)+LRTATN(LRX2))/2
"RTN","LRHY4X",242,0)
 E  S LRX3=LRTATN(LRX)
"RTN","LRHY4X",243,0)
 W !,?10,"Median TAT:",?35,LRX3
"RTN","LRHY4X",244,0)
 QUIT
"RTN","LRHY4X",245,0)
DEVICE ;
"RTN","LRHY4X",246,0)
 S ZTRTN="Q^LRHY4X"
"RTN","LRHY4X",247,0)
 ;
"RTN","LRHY4X",248,0)
 D IO^LRWU
"RTN","LRHY4X",249,0)
 ;
"RTN","LRHY4X",250,0)
 QUIT
"RTN","LRHY4X",251,0)
 QUIT
"RTN","LRHYBC1")
0^2^B64831523^B66006409
"RTN","LRHYBC1",1,0)
LRHYBC1 ;DALOI/HOAK - LAB PHLEB AND COLLECTION TIME UPDATER ;11/8/10 1:50pm
"RTN","LRHYBC1",2,0)
 ;;5.2;LAB SERVICE;**405,417,430**;Sep 27, 1994;Build 2
"RTN","LRHYBC1",3,0)
 ;
"RTN","LRHYBC1",4,0)
 ; This routine will be used to capture the phlebotomist and the
"RTN","LRHYBC1",5,0)
 ; specimen collection time.
"RTN","LRHYBC1",6,0)
 ;
"RTN","LRHYBC1",7,0)
 ; The barcoded specimen tubes will be waunded.
"RTN","LRHYBC1",8,0)
 ; The phlebotomist ID will then be waunded.
"RTN","LRHYBC1",9,0)
 ;
"RTN","LRHYBC1",10,0)
CONTROL ;
"RTN","LRHYBC1",11,0)
 K LRPTARIV
"RTN","LRHYBC1",12,0)
 K ^TMP("LRHY ASH",$J)
"RTN","LRHYBC1",13,0)
 K LRSCAN
"RTN","LRHYBC1",14,0)
 K DIC,LRHYTECH,LRHYDUZ,LRPHLEB,LRRECVR
"RTN","LRHYBC1",15,0)
 K DIR,DIC,DIE,LRARIVE,LRDRAW
"RTN","LRHYBC1",16,0)
 K DIC,LRHYTECH,LRHYDUZ,LRPHLEB
"RTN","LRHYBC1",17,0)
 K DIR,DIC,DIE,LRARIVE,LRDRAW
"RTN","LRHYBC1",18,0)
 S LRPL=1
"RTN","LRHYBC1",19,0)
 S LREND=0
"RTN","LRHYBC1",20,0)
 D TECH
"RTN","LRHYBC1",21,0)
 I U[X D END QUIT
"RTN","LRHYBC1",22,0)
 Q:X=""  D SINGLE
"RTN","LRHYBC1",23,0)
 D PTSCAN
"RTN","LRHYBC1",24,0)
 Q:X[U
"RTN","LRHYBC1",25,0)
 K LRPL
"RTN","LRHYBC1",26,0)
 K LRPTARIV
"RTN","LRHYBC1",27,0)
 QUIT
"RTN","LRHYBC1",28,0)
FINDER ;
"RTN","LRHYBC1",29,0)
 S DIC="^VA(200,"
"RTN","LRHYBC1",30,0)
 S DIC(0)="AEMQZ"
"RTN","LRHYBC1",31,0)
 S DIC("A")="Please enter employee number: "
"RTN","LRHYBC1",32,0)
 D ^DIC
"RTN","LRHYBC1",33,0)
 QUIT
"RTN","LRHYBC1",34,0)
TECH ;
"RTN","LRHYBC1",35,0)
 K DIC,LRHYTECH,LRHYDUZ,LRPHLEB,LRRECVR
"RTN","LRHYBC1",36,0)
 K DIR,DIC,DIE,LRARIVE,LRDRAW
"RTN","LRHYBC1",37,0)
 ;
"RTN","LRHYBC1",38,0)
 S X=""
"RTN","LRHYBC1",39,0)
 ;
"RTN","LRHYBC1",40,0)
 I X="" S X=DUZ G PST
"RTN","LRHYBC1",41,0)
 I U[X QUIT
"RTN","LRHYBC1",42,0)
 I $L(X)'=9 K DIC,LRHYTECH,LRHYDUZ,LRPHLEB,LRRECV G TECH
"RTN","LRHYBC1",43,0)
 ;
"RTN","LRHYBC1",44,0)
 ;
"RTN","LRHYBC1",45,0)
 ;
"RTN","LRHYBC1",46,0)
 ;
"RTN","LRHYBC1",47,0)
 K DIC
"RTN","LRHYBC1",48,0)
 K DIC,LRHYTECH,LRHYDUZ
"RTN","LRHYBC1",49,0)
 K Y
"RTN","LRHYBC1",50,0)
 S DIC=200
"RTN","LRHYBC1",51,0)
 S DIC(0)="MQZ"
"RTN","LRHYBC1",52,0)
 D ^DIC
"RTN","LRHYBC1",53,0)
 ;
"RTN","LRHYBC1",54,0)
 W Y
"RTN","LRHYBC1",55,0)
 ;
"RTN","LRHYBC1",56,0)
 I X[U QUIT
"RTN","LRHYBC1",57,0)
PST S Y=DUZ
"RTN","LRHYBC1",58,0)
 S (LRHYDUZ,LRHYTECH,LRPHLEB,LRRECVR)=+Y
"RTN","LRHYBC1",59,0)
 S LRHYDUZ=$P($G(^VA(200,LRHYDUZ,0)),U)
"RTN","LRHYBC1",60,0)
 QUIT
"RTN","LRHYBC1",61,0)
 ;
"RTN","LRHYBC1",62,0)
TIME ;
"RTN","LRHYBC1",63,0)
 ;
"RTN","LRHYBC1",64,0)
 ;
"RTN","LRHYBC1",65,0)
 ;
"RTN","LRHYBC1",66,0)
 S LREND=0
"RTN","LRHYBC1",67,0)
 S DIC="^DPT("
"RTN","LRHYBC1",68,0)
 S DIC(0)="AEMQZ"
"RTN","LRHYBC1",69,0)
 D ^DIC
"RTN","LRHYBC1",70,0)
 S DFN=+Y
"RTN","LRHYBC1",71,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHYBC1",72,0)
 D ^VADPT,INP^VADPT
"RTN","LRHYBC1",73,0)
 ;
"RTN","LRHYBC1",74,0)
 QUIT
"RTN","LRHYBC1",75,0)
 ;
"RTN","LRHYBC1",76,0)
SINGLE ;
"RTN","LRHYBC1",77,0)
 ; This block calls up the testing demographics.
"RTN","LRHYBC1",78,0)
 ;  LRHYD123 IS LRUID
"RTN","LRHYBC1",79,0)
 W !!
"RTN","LRHYBC1",80,0)
 S LRACC=""
"RTN","LRHYBC1",81,0)
 I $G(LRHYD123)'="" D EN^LA7ADL(LRHYD123)
"RTN","LRHYBC1",82,0)
 ;
"RTN","LRHYBC1",83,0)
 K LRHYD123
"RTN","LRHYBC1",84,0)
 ;
"RTN","LRHYBC1",85,0)
 K LRHN0,LRHNODE,LRN0,LR0NODE,LRPHLEB
"RTN","LRHYBC1",86,0)
 S X="D"
"RTN","LRHYBC1",87,0)
 D ^LRHYU5
"RTN","LRHYBC1",88,0)
 I LRAN<1 QUIT
"RTN","LRHYBC1",89,0)
SETFILE ;
"RTN","LRHYBC1",90,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) W !,"Doesn't exist." G SINGLE
"RTN","LRHYBC1",91,0)
 S LRUNC=1
"RTN","LRHYBC1",92,0)
 S LRORDT1=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,4)
"RTN","LRHYBC1",93,0)
 S LRHYD123=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,.3))
"RTN","LRHYBC1",94,0)
 ;  mdofied by Hoak per Joe for prior to free t-4
"RTN","LRHYBC1",95,0)
 I '$O(^LRHY(69.87,"B",LRHYD123,0)) D
"RTN","LRHYBC1",96,0)
 .  S DA=$P(^LRHY(69.87,0),U,3)
"RTN","LRHYBC1",97,0)
 .  S DA=DA+1
"RTN","LRHYBC1",98,0)
 .  S X=LRHYD123
"RTN","LRHYBC1",99,0)
 .  S DIE="^LRHY(69.87,"
"RTN","LRHYBC1",100,0)
 .  S DR=".01///"_X
"RTN","LRHYBC1",101,0)
 .  S DIK=DIE
"RTN","LRHYBC1",102,0)
 .  D ^DIE
"RTN","LRHYBC1",103,0)
 I '$G(DA) S DA=$P(^LRHY(69.87,0),U,3)+1
"RTN","LRHYBC1",104,0)
 S LRUID=LRHYD123
"RTN","LRHYBC1",105,0)
 S $P(^LRHY(69.87,0),U,3)=DA,$P(^LRHY(69.87,0),U,4)=DA
"RTN","LRHYBC1",106,0)
 S LRSPIEN=$O(^LRHY(69.87,"B",LRUID,0)) I $G(LRSPIEN) D
"RTN","LRHYBC1",107,0)
 .  N LRDT,LRSCAN
"RTN","LRHYBC1",108,0)
 .  S LRDT=$$NOW^XLFDT
"RTN","LRHYBC1",109,0)
 .  I '$G(LRLABTIM) S LRLABTIM=+$G(^LRO(68,LRAA,1,LRAD,1,LRAN,3))
"RTN","LRHYBC1",110,0)
 .  S LRSCAN=+$G(^LRO(68,LRAA,1,LRAD,1,LRAN,3))
"RTN","LRHYBC1",111,0)
 .  K DIE S DIE="^LRHY(69.87," S DR="2///"_LRSCAN S DA=LRSPIEN D ^DIE
"RTN","LRHYBC1",112,0)
 .  K DIE S DIE="^LRHY(69.87," S DR="4///"_LRDT S DA=LRSPIEN D ^DIE
"RTN","LRHYBC1",113,0)
 .  K DIE S DIE="^LRHY(69.87," S DR="6////"_LRHYTECH S DA=LRSPIEN D ^DIE
"RTN","LRHYBC1",114,0)
 .  K DIE S DIE="^LRHY(69.87," S DR="8///"_LRDT S DA=LRSPIEN D ^DIE
"RTN","LRHYBC1",115,0)
 S DIK=DIE D IX1^DIK
"RTN","LRHYBC1",116,0)
ZZ1 ;
"RTN","LRHYBC1",117,0)
 QUIT:$G(XQY0)'["PPOC"
"RTN","LRHYBC1",118,0)
 H 3
"RTN","LRHYBC1",119,0)
 S ^TMP("LRHY ASH",$J,LRAA,LRAD,LRAN)=""
"RTN","LRHYBC1",120,0)
 G SINGLE
"RTN","LRHYBC1",121,0)
 G END
"RTN","LRHYBC1",122,0)
 ;  Adding urgency to the display
"RTN","LRHYBC1",123,0)
 S LRTEST=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,0))
"RTN","LRHYBC1",124,0)
 S LRURG=$P($G(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRTEST,0)),U,2)
"RTN","LRHYBC1",125,0)
 ;
"RTN","LRHYBC1",126,0)
 ; Blink urgency if MED-EMERGE
"RTN","LRHYBC1",127,0)
 W !,$S($D(^LAB(62.05,+LRURG,0)):$P(^(0),U),1:"")," "
"RTN","LRHYBC1",128,0)
 ;
"RTN","LRHYBC1",129,0)
 ;
"RTN","LRHYBC1",130,0)
 D EDIT
"RTN","LRHYBC1",131,0)
 ;
"RTN","LRHYBC1",132,0)
 ;
"RTN","LRHYBC1",133,0)
 I $G(LREND) W !,"Please start over..." K LREND,LRIDTNEW
"RTN","LRHYBC1",134,0)
 D END
"RTN","LRHYBC1",135,0)
 QUIT
"RTN","LRHYBC1",136,0)
 ;
"RTN","LRHYBC1",137,0)
END ;
"RTN","LRHYBC1",138,0)
 K ^TMP("LRHY ASH",$J)
"RTN","LRHYBC1",139,0)
 K LRAA,LRAD,LRAN,LRBLOOD,LRARIVE,LRBLOOD,LRCE,LRDAT,LRDFN,LRIDT
"RTN","LRHYBC1",140,0)
 K LRDLA,LRDLC,LRDPF,LRDRAW,LRDT0,LRDTO,LRHYDUZ,LRHYNISH,LRPRAC
"RTN","LRHYBC1",141,0)
 K LRSN,LRTEST,LRURG,PNM,SSN,VAIN,VADM,LRHYTECH
"RTN","LRHYBC1",142,0)
 QUIT
"RTN","LRHYBC1",143,0)
 ;
"RTN","LRHYBC1",144,0)
EDIT ;
"RTN","LRHYBC1",145,0)
 S LRDFN=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U)
"RTN","LRHYBC1",146,0)
 S LRIDT=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U,5) ; old LRIDT
"RTN","LRHYBC1",147,0)
CHECK ;
"RTN","LRHYBC1",148,0)
 ;
"RTN","LRHYBC1",149,0)
PAST ;
"RTN","LRHYBC1",150,0)
 K LRHYDUZ
"RTN","LRHYBC1",151,0)
 ; look at Micro And CH subscripted tests
"RTN","LRHYBC1",152,0)
 I $D(^LR(LRDFN,"CH",LRIDT)) S LRSS="CH"
"RTN","LRHYBC1",153,0)
 E  S LRSS="MI"
"RTN","LRHYBC1",154,0)
 ;
"RTN","LRHYBC1",155,0)
 ;  run review option here and show it there has been a previous 
"RTN","LRHYBC1",156,0)
 ;  updating of this accession
"RTN","LRHYBC1",157,0)
 ;
"RTN","LRHYBC1",158,0)
 K LRARIVE
"RTN","LRHYBC1",159,0)
 ;
"RTN","LRHYBC1",160,0)
 ;
"RTN","LRHYBC1",161,0)
 W !
"RTN","LRHYBC1",162,0)
 ;  WE need an event to stop non-LRLAB key holders from entering
"RTN","LRHYBC1",163,0)
 ;  LAB ARRIVAL TIME
"RTN","LRHYBC1",164,0)
BACK G:'$D(^XUSEC("LRLAB",DUZ)) THERE
"RTN","LRHYBC1",165,0)
 G THERE
"RTN","LRHYBC1",166,0)
THERE ;
"RTN","LRHYBC1",167,0)
 W !
"RTN","LRHYBC1",168,0)
 K %DT
"RTN","LRHYBC1",169,0)
 D NOW^%DTC
"RTN","LRHYBC1",170,0)
 S %DT="AESRZ"
"RTN","LRHYBC1",171,0)
 S %DT("A")="Please enter updated DRAW/COLLECTION TIME: "
"RTN","LRHYBC1",172,0)
 ;
"RTN","LRHYBC1",173,0)
 ; Only default if lrlab owner
"RTN","LRHYBC1",174,0)
 I +LRDRAW7>0 S LRDRAW7=$$Y2K^LRX(LRDRAW7)
"RTN","LRHYBC1",175,0)
 E  S LRDRAW7=$$Y2K^LRX($P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U))
"RTN","LRHYBC1",176,0)
 I $D(^XUSEC("LRLAB",DUZ)) S %DT("B")=$P(LRDRAW7,"@")_"@"_$E($P(LRDRAW7,"@",2),1,5)
"RTN","LRHYBC1",177,0)
 ;
"RTN","LRHYBC1",178,0)
 I X="" G THERE
"RTN","LRHYBC1",179,0)
 I $D(DTOUT)!($D(DUOUT)) S LREND=1 QUIT
"RTN","LRHYBC1",180,0)
 I Y=-1 S LRUP="YES"
"RTN","LRHYBC1",181,0)
 E  S LRUP="NO"
"RTN","LRHYBC1",182,0)
 D NOW^%DTC S LRDRAW=%
"RTN","LRHYBC1",183,0)
 ;
"RTN","LRHYBC1",184,0)
 ;
"RTN","LRHYBC1",185,0)
 I $D(^XUSEC("LRLAB",DUZ)) G TIC
"RTN","LRHYBC1",186,0)
 ;
"RTN","LRHYBC1",187,0)
GUY ;  COLLECTOR DEMOGRAPHICS stuff this into LR...99 COMMENT FIELD.
"RTN","LRHYBC1",188,0)
 K LRPON
"RTN","LRHYBC1",189,0)
 S LRHYNISH=$P(^VA(200,LRHYTECH,0),U,2)
"RTN","LRHYBC1",190,0)
 I '$D(^XUSEC("LRLAB",LRHYTECH)) S LRPON=$P($G(^VA(200,LRHYTECH,0)),U)
"RTN","LRHYBC1",191,0)
 W !!!
"RTN","LRHYBC1",192,0)
 ;
"RTN","LRHYBC1",193,0)
 ; This global serves as an interim solution until lab files can
"RTN","LRHYBC1",194,0)
 ; be updated
"RTN","LRHYBC1",195,0)
TIC ;
"RTN","LRHYBC1",196,0)
 S LRARIVE=$G(LRARIVE,$P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U,3))
"RTN","LRHYBC1",197,0)
 S LRPTARIV=$G(LRPTARIV,LRARIVE)
"RTN","LRHYBC1",198,0)
 ;
"RTN","LRHYBC1",199,0)
 S LRAAX5=LRAA,LRADX6=LRAD,LRANX6=LRAN
"RTN","LRHYBC1",200,0)
 S LRHYDUZ=LRHYTECH
"RTN","LRHYBC1",201,0)
SET ;
"RTN","LRHYBC1",202,0)
 S $P(^LRO(69,LRDAT,1,LRSN,3),U)=$G(LRDRAW)
"RTN","LRHYBC1",203,0)
 S $P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U,3)=$G(LRDRAW)
"RTN","LRHYBC1",204,0)
 S $P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U)=$G(LRDRAW)
"RTN","LRHYBC1",205,0)
 ;
"RTN","LRHYBC1",206,0)
 H 2
"RTN","LRHYBC1",207,0)
 G SINGLE
"RTN","LRHYBC1",208,0)
 QUIT
"RTN","LRHYBC1",209,0)
PTSCAN ;
"RTN","LRHYBC1",210,0)
 ;
"RTN","LRHYBC1",211,0)
 W !!,"Please swipe PATIENT ID CARD or Type SSN: "
"RTN","LRHYBC1",212,0)
 R X:9999999 W !
"RTN","LRHYBC1",213,0)
 Q:X[U
"RTN","LRHYBC1",214,0)
 Q:X=""
"RTN","LRHYBC1",215,0)
 I $L(X)'=9 W !,"NO SUCH PATIENT" QUIT
"RTN","LRHYBC1",216,0)
 S DFN=$O(^DPT("SSN",X,0))
"RTN","LRHYBC1",217,0)
 S PNM=$P(^DPT(DFN,0),U) W !,PNM
"RTN","LRHYBC1",218,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHYBC1",219,0)
ACCNX ;
"RTN","LRHYBC1",220,0)
 S LRAA=0
"RTN","LRHYBC1",221,0)
 F  S LRAA=$O(^TMP("LRHY ASH",$J,LRAA)) Q:+LRAA'>0  D
"RTN","LRHYBC1",222,0)
 .  S LRAD=0
"RTN","LRHYBC1",223,0)
 .  F  S LRAD=$O(^TMP("LRHY ASH",$J,LRAA,LRAD)) Q:+LRAD'>0  D
"RTN","LRHYBC1",224,0)
 ..  S LRAN=0
"RTN","LRHYBC1",225,0)
 ..  F  S LRAN=$O(^TMP("LRHY ASH",$J,LRAA,LRAD,LRAN)) Q:+LRAN'>0  D P2
"RTN","LRHYBC1",226,0)
 QUIT
"RTN","LRHYBC1",227,0)
P2 ;
"RTN","LRHYBC1",228,0)
 N LRX S LRX=0
"RTN","LRHYBC1",229,0)
 F  S LRX=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,"B",LRX)) Q:+LRX'>0  D
"RTN","LRHYBC1",230,0)
 .  I LRDFN'=+^LRO(68,LRAA,1,LRAD,1,LRAN,0) W !,"WRONG PATIENT" QUIT
"RTN","LRHYBC1",231,0)
 .  W !,^LRO(68,LRAA,1,LRAD,1,LRAN,.2),?20,$P(^LAB(60,LRX,0),U)
"RTN","LRHYBC1",232,0)
 .  W !,"EVERYTHING MATCHES UP ",$P($P(^VA(200,LRHYTECH,0),U),",",2),", GREAT JOB!"
"RTN","LRHYBC1",233,0)
 .  H 3
"RTN","LRHYBC1",234,0)
 QUIT
"RTN","LRHYBC1",235,0)
LABIN ;
"RTN","LRHYBC1",236,0)
 D ^LRHYU4
"RTN","LRHYBC1",237,0)
 ;
"RTN","LRHYBC1",238,0)
 Q:LRAN=-1
"RTN","LRHYBC1",239,0)
 ;
"RTN","LRHYBC1",240,0)
 I $L(X)'=10 S X=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,.3))
"RTN","LRHYBC1",241,0)
 S LRUID=X
"RTN","LRHYBC1",242,0)
 S DA=$O(^LRHY(69.87,"B",LRUID,0))
"RTN","LRHYBC1",243,0)
 I '$G(DA) W !,"Incorrect UID try again..." H 2 G LABIN
"RTN","LRHYBC1",244,0)
 D NOW^%DTC K LRLABIN S LRLABIN=%
"RTN","LRHYBC1",245,0)
 K DIE
"RTN","LRHYBC1",246,0)
 S DIE=69.87
"RTN","LRHYBC1",247,0)
 S DR="10///"_LRLABIN_";12///"_DUZ
"RTN","LRHYBC1",248,0)
 D ^DIE
"RTN","LRHYBC1",249,0)
 G LABIN
"RTN","LRHYBC1",250,0)
DISPLAY ;
"RTN","LRHYBC1",251,0)
 S X="D"
"RTN","LRHYBC1",252,0)
 D ^LRHYU5 I 'LRAN W !,"MUST ENTER UID, TRY AGAIN" H 2 QUIT
"RTN","LRHYBC1",253,0)
 S LRUID=X
"RTN","LRHYBC1",254,0)
 S ZTRTN="D1^LRHYBC1" D IO^LRWU
"RTN","LRHYBC1",255,0)
 QUIT
"RTN","LRHYBC1",256,0)
D1 ;
"RTN","LRHYBC1",257,0)
 I $L(LRUID)'=10 S LRUID=X
"RTN","LRHYBC1",258,0)
 S LRDA=$O(^LRHY(69.87,"B",LRUID,0))
"RTN","LRHYBC1",259,0)
 ;
"RTN","LRHYBC1",260,0)
 ; FIX FOR NOT RUN PL
"RTN","LRHYBC1",261,0)
 I +$G(LRDA)'>0 W !,"NO Entry in HOWDY SPECIMEN TIMES BY UID File. Run Phlebotomy log." H 1 QUIT
"RTN","LRHYBC1",262,0)
 I '$G(^LRHY(69.87,LRDA,2)) D
"RTN","LRHYBC1",263,0)
 .  K DA,DR S DIE="^LRHY(69.87,",DA=LRDA,DR="2///"_$P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U) D ^DIE
"RTN","LRHYBC1",264,0)
 W !,"UID: ",LRUID
"RTN","LRHYBC1",265,0)
 W !,"WALK-UP SCAN TIME:",?50,$$Y2K^LRX(^LRHY(69.87,LRDA,2))
"RTN","LRHYBC1",266,0)
 W !,"COLLECTOR:",?50,?50,$P(^VA(200,^LRHY(69.87,LRDA,6),0),U)
"RTN","LRHYBC1",267,0)
 W !,"TIME SPECIMEN COLLECTED:",?50,$$Y2K^LRX(^LRHY(69.87,LRDA,8))
"RTN","LRHYBC1",268,0)
 Q:'$D(^LRHY(69.87,LRDA,10))
"RTN","LRHYBC1",269,0)
 W !,"TIME SCANNED INTO LAB:",?50,$$Y2K^LRX(^LRHY(69.87,LRDA,10))
"RTN","LRHYBC1",270,0)
 I $G(^LRHY(69.87,LRDA,12)) W !,"RECEIVED INTO LAB BY: ",?50,$P(^VA(200,^LRHY(69.87,LRDA,12),0),U)
"RTN","LRHYBC1",271,0)
 QUIT
"RTN","LRHYBC1",272,0)
BINBRD ;
"RTN","LRHYBC1",273,0)
 S ZTRTN="D2^LRHYBC1",ZTSAVE("PNM")=""
"RTN","LRHYBC1",274,0)
 S LRBBRD=$O(^LRHY(69.86,7,54,"B",0)) I $G(LRBBRD) S ZTIO=LRBBRD,ZTDTH=$H S:$D(ZTQUEUED) ZTREQ="@" D ^%ZTLOAD
"RTN","LRHYBC1",275,0)
 QUIT
"RTN","LRHYBC1",276,0)
D2 ;
"RTN","LRHYBC1",277,0)
 U IO
"RTN","LRHYBC1",278,0)
 W !,"PT:",PNM
"RTN","LRHYBC1",279,0)
 D ^%ZISC
"RTN","LRHYBC1",280,0)
 QUIT
"UP",69.86,69.868,-1)
69.86^8
"UP",69.86,69.868,0)
69.868
"VER")
8.0^22.0
"^DD",69.86,69.86,8,0)
COLLECTION TYPES (TO EXCLUDE)^69.868S^^8;0
"^DD",69.86,69.86,8,"DT")
3130731
"^DD",69.86,69.868,0)
COLLECTION TYPES (TO EXCLUDE) SUB-FIELD^^.01^1
"^DD",69.86,69.868,0,"NM","COLLECTION TYPES (TO EXCLUDE)")

"^DD",69.86,69.868,.01,0)
COLLECTION TYPE (TO EXCLUDE)^MS^LC:LAB COLLECTION;WC:WARD COLLECTION;SP:SEND PATIENT TO THE LAB;I:IMMEDIATE COLLECT;^0;1^Q
"^DD",69.86,69.868,.01,1,0)
^.1
"^DD",69.86,69.868,.01,1,1,0)
69.868^B
"^DD",69.86,69.868,.01,1,1,1)
S ^LRHY(69.86,DA(1),8,"B",$E(X,1,30),DA)=""
"^DD",69.86,69.868,.01,1,1,2)
K ^LRHY(69.86,DA(1),8,"B",$E(X,1,30),DA)
"^DD",69.86,69.868,.01,3)
Choose a collection type to exclude.
"^DD",69.86,69.868,.01,21,0)
^^1^1^3130731^
"^DD",69.86,69.868,.01,21,1,0)
This is a collection type to be excluded when Howdy runs.
"^DD",69.86,69.868,.01,"DT")
3130731
"BLD",9426,6)
^343
**END**
**END**
