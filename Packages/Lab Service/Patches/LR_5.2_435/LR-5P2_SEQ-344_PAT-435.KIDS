Released LR*5.2*435 SEQ #344
Extracted from mail message
**KIDS**:LR*5.2*435^

**INSTALL NAME**
LR*5.2*435
"BLD",9505,0)
LR*5.2*435^LAB SERVICE^0^3131023^y
"BLD",9505,1,0)
^^2^2^3131023^^
"BLD",9505,1,1,0)
This patch is a VM patch that addresses issues in the lab package
"BLD",9505,1,2,0)
related to the VHIC 4.0 card.
"BLD",9505,4,0)
^9.64PA^^
"BLD",9505,6.3)
1
"BLD",9505,"ABPKG")
n
"BLD",9505,"KRN",0)
^9.67PA^779.2^20
"BLD",9505,"KRN",.4,0)
.4
"BLD",9505,"KRN",.401,0)
.401
"BLD",9505,"KRN",.402,0)
.402
"BLD",9505,"KRN",.403,0)
.403
"BLD",9505,"KRN",.5,0)
.5
"BLD",9505,"KRN",.84,0)
.84
"BLD",9505,"KRN",3.6,0)
3.6
"BLD",9505,"KRN",3.8,0)
3.8
"BLD",9505,"KRN",9.2,0)
9.2
"BLD",9505,"KRN",9.8,0)
9.8
"BLD",9505,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",9505,"KRN",9.8,"NM",1,0)
LRHY0^^0^B38320113
"BLD",9505,"KRN",9.8,"NM",2,0)
LRHY01^^0^B41442608
"BLD",9505,"KRN",9.8,"NM",3,0)
LRHYAFT^^0^B93065494
"BLD",9505,"KRN",9.8,"NM",4,0)
LRDPA^^0^B27548025
"BLD",9505,"KRN",9.8,"NM","B","LRDPA",4)

"BLD",9505,"KRN",9.8,"NM","B","LRHY0",1)

"BLD",9505,"KRN",9.8,"NM","B","LRHY01",2)

"BLD",9505,"KRN",9.8,"NM","B","LRHYAFT",3)

"BLD",9505,"KRN",19,0)
19
"BLD",9505,"KRN",19.1,0)
19.1
"BLD",9505,"KRN",101,0)
101
"BLD",9505,"KRN",409.61,0)
409.61
"BLD",9505,"KRN",771,0)
771
"BLD",9505,"KRN",779.2,0)
779.2
"BLD",9505,"KRN",870,0)
870
"BLD",9505,"KRN",8989.51,0)
8989.51
"BLD",9505,"KRN",8989.52,0)
8989.52
"BLD",9505,"KRN",8994,0)
8994
"BLD",9505,"KRN","B",.4,.4)

"BLD",9505,"KRN","B",.401,.401)

"BLD",9505,"KRN","B",.402,.402)

"BLD",9505,"KRN","B",.403,.403)

"BLD",9505,"KRN","B",.5,.5)

"BLD",9505,"KRN","B",.84,.84)

"BLD",9505,"KRN","B",3.6,3.6)

"BLD",9505,"KRN","B",3.8,3.8)

"BLD",9505,"KRN","B",9.2,9.2)

"BLD",9505,"KRN","B",9.8,9.8)

"BLD",9505,"KRN","B",19,19)

"BLD",9505,"KRN","B",19.1,19.1)

"BLD",9505,"KRN","B",101,101)

"BLD",9505,"KRN","B",409.61,409.61)

"BLD",9505,"KRN","B",771,771)

"BLD",9505,"KRN","B",779.2,779.2)

"BLD",9505,"KRN","B",870,870)

"BLD",9505,"KRN","B",8989.51,8989.51)

"BLD",9505,"KRN","B",8989.52,8989.52)

"BLD",9505,"KRN","B",8994,8994)

"BLD",9505,"QUES",0)
^9.62^^
"BLD",9505,"REQB",0)
^9.611^3^3
"BLD",9505,"REQB",1,0)
LR*5.2*360^2
"BLD",9505,"REQB",2,0)
LR*5.2*405^2
"BLD",9505,"REQB",3,0)
LR*5.2*417^2
"BLD",9505,"REQB","B","LR*5.2*360",1)

"BLD",9505,"REQB","B","LR*5.2*405",2)

"BLD",9505,"REQB","B","LR*5.2*417",3)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^^0
"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
435^3131023
"PKG",26,22,1,"PAH",1,1,0)
^^2^2^3131023
"PKG",26,22,1,"PAH",1,1,1,0)
This patch is a VM patch that addresses issues in the lab package
"PKG",26,22,1,"PAH",1,1,2,0)
related to the VHIC 4.0 card.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","LRDPA")
0^4^B27548025^B27232185
"RTN","LRDPA",1,0)
LRDPA ;SLC/RWF/WTY/KLL - FILE OF FILES LOOKUP ON ENTITIES ; 2/28/03 4:10pm
"RTN","LRDPA",2,0)
 ;;5.2;LAB SERVICE;**137,121,153,202,211,248,305,360,435**;Sep 27, 1994;Build 1
"RTN","LRDPA",3,0)
 ;
"RTN","LRDPA",4,0)
 ;Reference to ^DIC( supported by IA #916
"RTN","LRDPA",5,0)
 ;Reference to ^DIC("AC" supported by IA #511
"RTN","LRDPA",6,0)
 ;Reference to ^ORD(100.99 supported by IA #2414
"RTN","LRDPA",7,0)
 ;Reference to ^DIC supported by IA #10006
"RTN","LRDPA",8,0)
 ;Reference to LK^ORX2 supported by IA #867
"RTN","LRDPA",9,0)
 ;Reference to ULK^ORX2 supported by IA #867
"RTN","LRDPA",10,0)
 ;Reference to $$DTIME^XUP supported by IA # -none available-
"RTN","LRDPA",11,0)
 ;Reference to EN^DDIOL supported by IA #10142
"RTN","LRDPA",12,0)
 ;
"RTN","LRDPA",13,0)
 ;IF '$D(DIC) USE PATIENT FILE, ALLOW "FILE:NAME" EXTENDED SYNTAX
"RTN","LRDPA",14,0)
 ;IF DIC=0 ASK FILE NAME, IF PATIENT FILE, USE DPA, 
"RTN","LRDPA",15,0)
 ;  OTHERWISE ^DIC LOOK-UP
"RTN","LRDPA",16,0)
 ;IF DIC=N^GLOBAL, LOOK-UP ON FILE N
"RTN","LRDPA",17,0)
 ;RETURN (DFN,Y)=IFN, LRDPF=N^GLOBAL, '$D(DIC), LRDFN=IFN OF ^LR 
"RTN","LRDPA",18,0)
 ; GLOBAL  PNM=NAME,SSN=SSN,SSN(1)=LAST4,SSN(2)=SSN WITHOUT '-'
"RTN","LRDPA",19,0)
 ;ROUTINE SSN^LRU CONTROLS SSN FORMAT
"RTN","LRDPA",20,0)
 ;ALSO WILL RETURN LRLABKY variable if not defined.
"RTN","LRDPA",21,0)
 ;LRLOOKUP=1 blocks ability to add new entries (lookup only)
"RTN","LRDPA",22,0)
 S:$G(LRREFFL) DIC="67^LRT(67"
"RTN","LRDPA",23,0)
 G:$G(LRORDRR)="R" ^LRDPAREF
"RTN","LRDPA",24,0)
 S X="",U="^",DTIME=$$DTIME^XUP(DUZ)
"RTN","LRDPA",25,0)
 S DIC(0)=$S('$D(DIC(0)):"EMQZ",DIC(0)["A":"EMQZ",1:DIC(0))
"RTN","LRDPA",26,0)
 S:DIC(0)'["Z" DIC(0)=DIC(0)_"Z"
"RTN","LRDPA",27,0)
 K DLAYGO I '($D(DIC)[0),DIC'=0,'$P(DIC,"^") S DIC=0
"RTN","LRDPA",28,0)
DPA ;from LRUPS
"RTN","LRDPA",29,0)
 D:'$D(LRLABKY) LABKEY^LRPARAM
"RTN","LRDPA",30,0)
 K VADM,VAIN,VA
"RTN","LRDPA",31,0)
 S LRDPF="" G ANY:'($D(DIC)[0)
"RTN","LRDPA",32,0)
 R !,"Select Patient Name: ",X:DTIME
"RTN","LRDPA",33,0)
DPA1 ;Entry point from PNAME^LRAPDA
"RTN","LRDPA",34,0)
 I X'?1"%"9N.E,$L($P(X,"^",2))'=18,X=""!(X["^") S DFN=-1 K DLAYGO G END
"RTN","LRDPA",35,0)
 ;The X'?1"%"9N.E was added since the VIC data stream contains a carat.
"RTN","LRDPA",36,0)
 ;The $L($P(X,"^",2))'=18 was added for VHIC 4.0
"RTN","LRDPA",37,0)
 I X="??" W !,"You may enter patient identification or enter a file name followed by "":"".",!,"You may enter ""?:?"" for more extended help." G DPA
"RTN","LRDPA",38,0)
EN1 ;from LRUG, LRUPS
"RTN","LRDPA",39,0)
 I X[":" S LRX=$P(X,":",2),X=$P(X,":",1),DIC=0 K:LRX="" LRX G ANY:X=""!(X["?") W !," File: ",X G FL
"RTN","LRDPA",40,0)
EN ;
"RTN","LRDPA",41,0)
 S:DIC(0)'["Z" DIC(0)=DIC(0)_"Z"
"RTN","LRDPA",42,0)
 S DIC="^DPT(",LRDPF="2^DPT(",VA200=""
"RTN","LRDPA",43,0)
 ; DLAYGO not allowed for DPT( on first pass
"RTN","LRDPA",44,0)
 S DIC("S")="S:X?1""%""9N.E1""?"" X=$E(X,2,10) I 1"
"RTN","LRDPA",45,0)
 ;The DIC("S") was added to preprocess any data from a VIC card. The VIC
"RTN","LRDPA",46,0)
 ;card data has guard codes before and after the patient data. The SSN
"RTN","LRDPA",47,0)
 ;is extracted if these guard codes exist. DIC("S") was added in several
"RTN","LRDPA",48,0)
 ;places and in all instances it is being killed immediately after use.
"RTN","LRDPA",49,0)
 D ^DIC K DIC("S"),DLAYGO K:Y>0 DUOUT
"RTN","LRDPA",50,0)
 ;Since VIC card data contains carats, DUOUT will be returned whenever
"RTN","LRDPA",51,0)
 ;the VIC card is used.  If the user ^'s out, Y will be equal to -1.
"RTN","LRDPA",52,0)
 ;If Y is greater than 0 the data is valid and DUOUT should be ignored.
"RTN","LRDPA",53,0)
 I Y<1 K DIC D LAYG G DPA
"RTN","LRDPA",54,0)
 S DFN=+Y,PNM=$P(Y(0),"^") D PT^LRX D:DOD'="" WARN G END
"RTN","LRDPA",55,0)
 ;
"RTN","LRDPA",56,0)
LAYG ;Don't allow DLAYGO on second pass.
"RTN","LRDPA",57,0)
 K DLAYGO S DIC(0)="EQMZ" Q
"RTN","LRDPA",58,0)
 Q:'$P($G(LRPARAM),"^",6)
"RTN","LRDPA",59,0)
 Q:'$D(LRLABKY)
"RTN","LRDPA",60,0)
 S DLAYGO=2 S DIC(0)="EQMZL"
"RTN","LRDPA",61,0)
 Q
"RTN","LRDPA",62,0)
ANY S:DIC'=0 LRDPF=+DIC_^DIC(+DIC,0,"GL") G FL1:DIC'=0 D FILE
"RTN","LRDPA",63,0)
 G NONE:Y=-1,FL0
"RTN","LRDPA",64,0)
 ;
"RTN","LRDPA",65,0)
FL S DIC="^DIC(",DIC(0)=$S(X]"":"EMQZ",1:"AEMQZ"),DIC("S")="I $D(^DIC(""AC"",""LR"",+Y))" D ^DIC G NONE:Y=-1
"RTN","LRDPA",66,0)
FL0 S LRDPF=+Y_^DIC(+Y,0,"GL"),DIC=LRDPF I +$G(LRDPF)=2 K DIC G LRDPA
"RTN","LRDPA",67,0)
FL1 ;
"RTN","LRDPA",68,0)
 D:'$D(LRLABKY) LABKEY^LRPARAM
"RTN","LRDPA",69,0)
 ;DLAYGO not allowed for DPT(
"RTN","LRDPA",70,0)
 I +LRDPF'=2,'$G(LRLOOKUP) S DLAYGO=+LRDPF
"RTN","LRDPA",71,0)
 S DIC="^"_$P(LRDPF,"^",2),DIC(0)=$S($D(LRX):"EMQZ",1:"AEMQZ")
"RTN","LRDPA",72,0)
 I '$G(LRLOOKUP) D
"RTN","LRDPA",73,0)
 .S DIC(0)=DIC(0)_$S(+LRDPF>60&(+LRDPF<70)&$D(LRLABKY):"L",+LRDPF>1000:"L",1:"")
"RTN","LRDPA",74,0)
 .S:DIC(0)["L" DLAYGO=+LRDPF
"RTN","LRDPA",75,0)
 S:$D(LRX) X=LRX K LRX,DIC("S")
"RTN","LRDPA",76,0)
 I X["?" S DIC("S")="S:X?1""%""9N.E1""?"" X=$E(X,2,10) I 1" D ^DIC K DIC("S") K:Y>0 DUOUT S:DIC(0)'["A" DIC(0)=DIC(0)_"A"
"RTN","LRDPA",77,0)
 W:DIC(0)'["A" "   Entry: ",X
"RTN","LRDPA",78,0)
 S DIC("S")="S:X?1""%""9N.E1""?"" X=$E(X,2,10) I 1"
"RTN","LRDPA",79,0)
 S:DIC="^LAB(62.3," DIC("S")=DIC("S")_" "_"I '$P(^LAB(62.3,Y,0),U,4)"
"RTN","LRDPA",80,0)
 D ^DIC K DIC("S") G NONE:Y=-1 S DFN=+Y,PNM=$P(Y(0),"^") D PT^LRX
"RTN","LRDPA",81,0)
 G END
"RTN","LRDPA",82,0)
NONE S Y=-1,DFN=-1,LRDFN=-1,LRDPF="0^NULL("
"RTN","LRDPA",83,0)
 K DIC,VAIN,VADM,VA S VA200="" Q
"RTN","LRDPA",84,0)
 Q
"RTN","LRDPA",85,0)
REASK S DFN=-1,DIC("S")="S:X?1""%""9N.E1""?"" X=$E(X,2,10) I 1",DIC(0)=DIC(0)_"A"
"RTN","LRDPA",86,0)
 D ^DIC K:Y>0 DUOUT K DIC("S") G:Y<1 END S DFN=+Y,PNM=$P(Y(0),"^") D PT^LRX
"RTN","LRDPA",87,0)
END ;from LROR, LRSETUP
"RTN","LRDPA",88,0)
 S:'$D(DFN) DFN=-1 S Y=DFN
"RTN","LRDPA",89,0)
 I DFN=-1 D  Q
"RTN","LRDPA",90,0)
 .S LRDFN=-1 K DIC,DLAYGO S VA200=""
"RTN","LRDPA",91,0)
 S X="^"_$P(LRDPF,"^",2)_Y_",""LR"")",LRDFN=+$S($D(@X):@X,1:-1)
"RTN","LRDPA",92,0)
 G E3:LRDFN>0
"RTN","LRDPA",93,0)
 L +^LR(0):5 I '$T D  Q
"RTN","LRDPA",94,0)
 .S MSG="The LAB DATA file is locked.  Please try again later."
"RTN","LRDPA",95,0)
 .D EN^DDIOL(MSG,"","!!") K MSG
"RTN","LRDPA",96,0)
 .S (DFN,LRDFN)=-1,VA200=""
"RTN","LRDPA",97,0)
 .K DIC,DLAYGO
"RTN","LRDPA",98,0)
 S LRDFN=$P(^LR(0),"^",3)+1
"RTN","LRDPA",99,0)
 I $D(@X) L -^LR(0) K DIC,DLAYGO G LRDPA
"RTN","LRDPA",100,0)
E2 I $D(^LR(LRDFN)) S LRDFN=LRDFN+1 G E2
"RTN","LRDPA",101,0)
 S ^LR(LRDFN,0)=LRDFN_"^"_+LRDPF_"^"_DFN,@X=LRDFN,^(0)=$P(^LR(0),"^",1,2)_"^"_LRDFN_"^"_(1+$P(^(0),"^",4)),^LR("B",LRDFN,LRDFN)="" L -^LR(0)
"RTN","LRDPA",102,0)
E3 I '$D(^LR(LRDFN,0))#2 W !!,"Internal patient ID incorrect in ^LR( for ",PNM,".  Contact Lab Coordinator.",$C(7) S LRDFN=-1 Q
"RTN","LRDPA",103,0)
 I LRDFN>0,$P(^LR(LRDFN,0),"^",2)'=+LRDPF!($P(^(0),"^",3)'=DFN) W !,$C(7),"Internal patient ID incorrect for ",PNM,".  Contact Lab Coordinator." S LRDFN=-1 Q
"RTN","LRDPA",104,0)
 D INF^LRX
"RTN","LRDPA",105,0)
 D ^LRDPA1:($D(LRDPAF)&(LRDFN>0)) K DIC,DLAYGO S VA200=""
"RTN","LRDPA",106,0)
 I DFN,$P($G(^ORD(100.99,1,"CONV")),"^")=0 D EN^LR7OV2(DFN_";"_$P(LRDPF,"^",2),1)
"RTN","LRDPA",107,0)
 Q
"RTN","LRDPA",108,0)
 ;
"RTN","LRDPA",109,0)
FILE I X'["?" W !,"Select FILE: " R X:DTIME I X["^"!(X="") S X="",Y=-1 Q
"RTN","LRDPA",110,0)
 D DICQ:X["?" G FILE:X=""
"RTN","LRDPA",111,0)
 S DIC="^DIC(",DIC(0)="EMQZ"
"RTN","LRDPA",112,0)
 S DIC("S")="I $D(^DIC(""AC"",""LR"",+Y)),+Y'=44"
"RTN","LRDPA",113,0)
 D ^DIC K DIC("S") I Y=-1 G FILE
"RTN","LRDPA",114,0)
 Q
"RTN","LRDPA",115,0)
DICQ ;
"RTN","LRDPA",116,0)
 S DIC="^DIC(",DIC(0)="EQZ",D="AC",X="LR"
"RTN","LRDPA",117,0)
 S DIC("S")="I +Y'=44"  D IX^DIC
"RTN","LRDPA",118,0)
 I Y=-1 S X="" Q
"RTN","LRDPA",119,0)
 S X=Y(0,0)
"RTN","LRDPA",120,0)
 K D,DIC S Y=1
"RTN","LRDPA",121,0)
 Q
"RTN","LRDPA",122,0)
% R %:DTIME Q:%=""!(%["N")!(%["Y")  W !,"Answer 'Y' or 'N': " G %
"RTN","LRDPA",123,0)
 ;
"RTN","LRDPA",124,0)
EN2(DFN,LOCK,TALK) ;Patient Lock
"RTN","LRDPA",125,0)
 ;TALK 1:write, 0:silent
"RTN","LRDPA",126,0)
 ;LOCK 1:lock, 0:unlock
"RTN","LRDPA",127,0)
 Q:'$G(DFN)
"RTN","LRDPA",128,0)
 S:'$D(LOCK) LOCK=0 S:'$D(TALK) TALK=0
"RTN","LRDPA",129,0)
 S X=DFN_";DPT("
"RTN","LRDPA",130,0)
 I LOCK D LK^ORX2
"RTN","LRDPA",131,0)
 I 'LOCK D ULK^ORX2
"RTN","LRDPA",132,0)
 Q
"RTN","LRDPA",133,0)
WARN ;Warn the user the patient has died and display date of death (LR*5.2*360)
"RTN","LRDPA",134,0)
 S Y=DOD D DD^LRX
"RTN","LRDPA",135,0)
 W !?10,@LRVIDO,"Patient ",PNM," died on: ",Y,@LRVIDOF,!
"RTN","LRDPA",136,0)
 S DIR(0)="Y"
"RTN","LRDPA",137,0)
 S DIR("A")="Do you wish to continue with this patient [Yes/No]"
"RTN","LRDPA",138,0)
 S DIR("T")=120
"RTN","LRDPA",139,0)
 D ^DIR K DIR
"RTN","LRDPA",140,0)
 I Y=0!($D(DIRUT)) S DFN=-1
"RTN","LRDPA",141,0)
 K DIRUT
"RTN","LRDPA",142,0)
 Q
"RTN","LRHY0")
0^1^B38320113^B39459893
"RTN","LRHY0",1,0)
LRHY0 ;DALOI/HOAK - HOWDY MAIN DRIVER ;10/15/10 11:00am
"RTN","LRHY0",2,0)
 ;;5.2;LAB SERVICE;**405,435**;Sep 27, 1994;Build 1
"RTN","LRHY0",3,0)
 ;
"RTN","LRHY0",4,0)
PICK ;
"RTN","LRHY0",5,0)
 ;  pick the site from Howdy Site FILE 69.86
"RTN","LRHY0",6,0)
 S LREND=0
"RTN","LRHY0",7,0)
 S DIC(0)="AEMQZ"
"RTN","LRHY0",8,0)
 S DIC=69.86
"RTN","LRHY0",9,0)
 D ^DIC
"RTN","LRHY0",10,0)
 I Y=-1 S LREND=1 QUIT
"RTN","LRHY0",11,0)
 S LRHYSITE=+Y
"RTN","LRHY0",12,0)
 K DIC
"RTN","LRHY0",13,0)
 ;
"RTN","LRHY0",14,0)
 I $G(^LRHY(69.86,LRHYSITE,0))["ALTER" S LRDEV=$O(^%ZIS(1,"B","NULL DEVICE",0)) G ALT
"RTN","LRHY0",15,0)
 ;
"RTN","LRHY0",16,0)
 ; Pick a printer
"RTN","LRHY0",17,0)
 S LRDEV=0
"RTN","LRHY0",18,0)
 K DIC
"RTN","LRHY0",19,0)
 S DIC(0)="EMQZ" K Y S LRHYCT2=1
"RTN","LRHY0",20,0)
 F  S LRDEV=$O(^LRHY(69.86,LRHYSITE,10,"B",LRDEV)) Q:+LRDEV'>0  D
"RTN","LRHY0",21,0)
 .  W !,LRHYCT2,". ",$P(^%ZIS(1,LRDEV,0),U)
"RTN","LRHY0",22,0)
 .  S LRX(LRHYCT2)=LRDEV S LRHYCT2=LRHYCT2+1
"RTN","LRHY0",23,0)
CHOOO W !,"Choose a label printer: " R X:DTIME W !
"RTN","LRHY0",24,0)
 I U[X S LREND=1 QUIT
"RTN","LRHY0",25,0)
 I X="" W !,"NOTHING SELECTED" S LREND=1 H 1 QUIT
"RTN","LRHY0",26,0)
 I '$D(LRX(X)) W !,"NUMBER NOT IN RANGE" H 1 G CHOOO
"RTN","LRHY0",27,0)
 I U[X S LREND=1 QUIT
"RTN","LRHY0",28,0)
 I 'X I $G(X)'="" W !,"enter the number please" G CHOOO
"RTN","LRHY0",29,0)
 S LRDEV=LRX(X)
"RTN","LRHY0",30,0)
 ;
"RTN","LRHY0",31,0)
 ;
"RTN","LRHY0",32,0)
ALT ;
"RTN","LRHY0",33,0)
 W ?11,$P(^%ZIS(1,LRDEV,0),U) H 2
"RTN","LRHY0",34,0)
 K DIC
"RTN","LRHY0",35,0)
 K LRHYCT2
"RTN","LRHY0",36,0)
 D USER^LRHYU
"RTN","LRHY0",37,0)
 ;
"RTN","LRHY0",38,0)
 ;
"RTN","LRHY0",39,0)
 QUIT
"RTN","LRHY0",40,0)
 ;
"RTN","LRHY0",41,0)
VET ; Primary API for Howdy!  Called by [LRHY PATIENT CARD SCAN] option.
"RTN","LRHY0",42,0)
 D XTMP^LRHYU
"RTN","LRHY0",43,0)
 N LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHY0",44,0)
 N LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHY0",45,0)
 N LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHY0",46,0)
 N LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHY0",47,0)
 N LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHY0",48,0)
 N LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHY0",49,0)
 N LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHY0",50,0)
 N LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHY0",51,0)
 K LRCCOMX,LRDUX,LREDT,LRDX,DIB,DIK
"RTN","LRHY0",52,0)
 K LR3D,LR33ORD,LR3T,LRANX6,LRCSQ,LRUP,LRHY3DT,LRHY3SN3
"RTN","LRHY0",53,0)
 K LRHYDJOB,LRHYSPC7,LRHYURG3,LRS3333,LRTAT
"RTN","LRHY0",54,0)
 K LRMERG,LRODRNUM,LRORDNUM,LRUNC,LRPARAM
"RTN","LRHY0",55,0)
 K LRHYCT3,LRHYCTC,IOTLC,LRC,LRHYCT3,LRHYCTC,LRHYTOK,LRKIL,LRLABNOD
"RTN","LRHY0",56,0)
 K LRLABSTP,LRLINE,LRLWC,LRN5,LRNONONO,LRNOT,LRNOTEST,LRNOUP,LRNT,LRNX0
"RTN","LRHY0",57,0)
 K LRODRUM,LRONE,LRORDSIZ,LRORDT,LRORDT1,LRM1,LRM2,LRM3,LRPHONE,LRORIEN
"RTN","LRHY0",58,0)
 K LRS,LRSC0,LRSDT,LRSN1,LRSPIEN,LRSSN,LRSTAR,LRSTOP,LRSTUCK
"RTN","LRHY0",59,0)
 K LRT0,LRTECH,LRTKX,LRTM7,LRTOTAL,LRTST,LRTUBE,LRTXT,LRUDT,LRUNK,LRURG7
"RTN","LRHY0",60,0)
 K LRURGA,LRURGNCY,LRURGT,LRURGZ19,LRX1,LRX2,LRX3,LRY1,LRYTAT,LR3,LR3MULT
"RTN","LRHY0",61,0)
 K LR3NX0,LR3ODT,M9,V,LRHYORDZ
"RTN","LRHY0",62,0)
 K LABCNT,LN,LR0NODE,LR68,LR6987,LR700,LR7LESS
"RTN","LRHY0",63,0)
 K LR7MORE,LRAANAME,LRAAZ,LRAC1,LRACCER,LRACCTM,LRACCXX
"RTN","LRHY0",64,0)
 K LRACNODE,LRACO,LRACTM,LRADD,LRBAR0,LRBAR1,LRBBRD
"RTN","LRHY0",65,0)
 K LRBINGO,LRCEN,LRCNTX,LRCTYPE,LRD,LRDA,LRDRAW0
"RTN","LRHY0",66,0)
 K LRDRAW1,LRDRAW7,LRDT,LRDTX,LRDUP,LRDUX,LREDT,LRDX
"RTN","LRHY0",67,0)
 K LRFINX
"RTN","LRHY0",68,0)
 ;
"RTN","LRHY0",69,0)
VET1 ; Code below executes to handle Patient episode.
"RTN","LRHY0",70,0)
 ; Then, Howdy waits here for next Patient
"RTN","LRHY0",71,0)
 ;
"RTN","LRHY0",72,0)
 I '$G(LRDEV) D PICK Q:LREND
"RTN","LRHY0",73,0)
 ;
"RTN","LRHY0",74,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD
"RTN","LRHY0",75,0)
 K ^TMP("LRHYDY",$J)
"RTN","LRHY0",76,0)
 D ^LRPARAM ; Set Howdy up as Lab user
"RTN","LRHY0",77,0)
 S LRHOWDY=1
"RTN","LRHY0",78,0)
 S LRHYCT=$G(LRHYCT,0)
"RTN","LRHY0",79,0)
 I LRHYCT=2 W !,"Please ask the clerk for assistance." K LRHYCT QUIT
"RTN","LRHY0",80,0)
 S LRODT=DT
"RTN","LRHY0",81,0)
 W @IOF
"RTN","LRHY0",82,0)
 K X
"RTN","LRHY0",83,0)
 ; 
"RTN","LRHY0",84,0)
 W !!,"Please swipe your ID CARD or Type SSN: "
"RTN","LRHY0",85,0)
 ;  %ZOSF("EOFF") = U $I:NOECHO
"RTN","LRHY0",86,0)
 ;  %ZOSF("EON") = U $I:ECHO
"RTN","LRHY0",87,0)
 X ^%ZOSF("EOFF")
"RTN","LRHY0",88,0)
 R X:9999999 W !
"RTN","LRHY0",89,0)
 I X=U X ^%ZOSF("EON") D BAKUSER^LRHYU QUIT
"RTN","LRHY0",90,0)
 X ^%ZOSF("EON")
"RTN","LRHY0",91,0)
 ; Code is set to read all types of VIC card as of 9/05/2005
"RTN","LRHY0",92,0)
 ;I $E(X,1,9)["-" D
"RTN","LRHY0",93,0)
 ;.  S X=$P(X,"-")_$P(X,"-",2)_$P(X,"-",3)
"RTN","LRHY0",94,0)
 ;I $E(X,1,1)'=0 I '$E(X,1,1) S X=$E(X,2,10)
"RTN","LRHY0",95,0)
 ;I $L(X)>10 S X=$E(X,2,10)
"RTN","LRHY0",96,0)
 ;I $L(X)'=9 W !,"Didn't read that Partner. " W:LRHYCT'=2 "Try again." H 2 S LRHYCT=LRHYCT+1 G VET
"RTN","LRHY0",97,0)
 ;
"RTN","LRHY0",98,0)
 K DFN,LRDFN,LRDPA,LRDPF,PNM,LRHYCT
"RTN","LRHY0",99,0)
 ; 
"RTN","LRHY0",100,0)
 ;S DFN=$O(^DPT("SSN",X,0))
"RTN","LRHY0",101,0)
 ;
"RTN","LRHY0",102,0)
 ; NEW CODE FOR VIC 4.0
"RTN","LRHY0",103,0)
 D RPCVIC^DPTLK(.DFN,X)
"RTN","LRHY0",104,0)
 ;
"RTN","LRHY0",105,0)
 I DFN<1 W !,"No record for this person." R X:15 G VET
"RTN","LRHY0",106,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHY0",107,0)
 ;
"RTN","LRHY0",108,0)
 I LRDFN D PT^LRX
"RTN","LRHY0",109,0)
 I 'LRDFN W !,"No Lab Data Available... Please check with clerk at the Desk." H 5 D LOG K X G VET
"RTN","LRHY0",110,0)
 K ^TMP("LRHYDY",$J,"LRHYDY",$J,LRDFN)
"RTN","LRHY0",111,0)
 ;
"RTN","LRHY0",112,0)
 ; this call checks order against the 69.86
"RTN","LRHY0",113,0)
 D ORDCHK^LRHYB
"RTN","LRHY0",114,0)
 ;
"RTN","LRHY0",115,0)
 ;
"RTN","LRHY0",116,0)
 ;
"RTN","LRHY0",117,0)
 I $G(LRMULT) W !!!,"Please check with clerk at the Desk" H 5 D LOG K X G VET
"RTN","LRHY0",118,0)
 I '$G(LRORD) S LREND=1 W !,$G(LRCTYPE)," No Orders found. Please check with clerk at the Desk" H 5 D LOG K X G VET
"RTN","LRHY0",119,0)
 D NOW^%DTC
"RTN","LRHY0",120,0)
 ;
"RTN","LRHY0",121,0)
 ;
"RTN","LRHY0",122,0)
 ;
"RTN","LRHY0",123,0)
PRT1 ;
"RTN","LRHY0",124,0)
 ;
"RTN","LRHY0",125,0)
 W @IOF
"RTN","LRHY0",126,0)
 D SCRNON^LRHYUTL
"RTN","LRHY0",127,0)
 S PNMALL="Howdy "_$P(PNM,",",2)_" "_$P(PNM,",")
"RTN","LRHY0",128,0)
 W !
"RTN","LRHY0",129,0)
 W IODHLT,"     ",PNMALL
"RTN","LRHY0",130,0)
 W !
"RTN","LRHY0",131,0)
 W IODHLB,"     ",PNMALL
"RTN","LRHY0",132,0)
 W !
"RTN","LRHY0",133,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,40)),IOM)
"RTN","LRHY0",134,0)
 W !,$$CJ^XLFSTR("Your Host is: "_$G(^LRHY(69.86,LRHYSITE,42)),IOM)
"RTN","LRHY0",135,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,44)),IOM)
"RTN","LRHY0",136,0)
 W !
"RTN","LRHY0",137,0)
 W IODHLT,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHY0",138,0)
 W !
"RTN","LRHY0",139,0)
 W IODHLB,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHY0",140,0)
 W !
"RTN","LRHY0",141,0)
 S LRXYZ=0
"RTN","LRHY0",142,0)
 F  S LRXYZ=$O(^LRHY(69.86,LRHYSITE,32,LRXYZ)) Q:+LRXYZ'>0  D
"RTN","LRHY0",143,0)
 .  W !
"RTN","LRHY0",144,0)
 .  W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,32,LRXYZ,0)),IOM)
"RTN","LRHY0",145,0)
 .  W !
"RTN","LRHY0",146,0)
 W *7 H 1 W *7 H 1 W *7
"RTN","LRHY0",147,0)
 ;
"RTN","LRHY0",148,0)
 I $D(^LRHY(69.86,7,54,"B")) D BINBRD^LRHYBC1
"RTN","LRHY0",149,0)
 H 5
"RTN","LRHY0",150,0)
QUITH ; 
"RTN","LRHY0",151,0)
 D SCRNOFF^LRHYUTL ; Turn off screen variables
"RTN","LRHY0",152,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD,LRHYCT
"RTN","LRHY0",153,0)
 K LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHY0",154,0)
 K LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHY0",155,0)
 K LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHY0",156,0)
 K LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHY0",157,0)
 K LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHY0",158,0)
 K LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHY0",159,0)
 K LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHY0",160,0)
 K LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHY0",161,0)
 K VAIN
"RTN","LRHY0",162,0)
 ;
"RTN","LRHY0",163,0)
 ;
"RTN","LRHY0",164,0)
 G VET1
"RTN","LRHY0",165,0)
 ;
"RTN","LRHY0",166,0)
 ;
"RTN","LRHY0",167,0)
 ;
"RTN","LRHY0",168,0)
ORDCHK ; This block to be used for future version
"RTN","LRHY0",169,0)
 QUIT
"RTN","LRHY0",170,0)
LOG ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHY0",171,0)
 I $G(LRMULT) QUIT
"RTN","LRHY0",172,0)
 Q:$G(LRSKIPNO)
"RTN","LRHY0",173,0)
 ;
"RTN","LRHY0",174,0)
 W !,"NO ORDERS"
"RTN","LRHY0",175,0)
 ;
"RTN","LRHY0",176,0)
 K LRDPF,PNM
"RTN","LRHY0",177,0)
 D PT^LRX
"RTN","LRHY0",178,0)
 D NOW^%DTC
"RTN","LRHY0",179,0)
 I '$G(LRDFN) S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(DFN) QUIT
"RTN","LRHY0",180,0)
 S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHY0",181,0)
 QUIT
"RTN","LRHY0",182,0)
 ;
"RTN","LRHY0",183,0)
 ;
"RTN","LRHY0",184,0)
LOG1 ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHY0",185,0)
 K LRORD,LRDPT,PNM
"RTN","LRHY0",186,0)
 W !,"MULTIPLE ORDERS"
"RTN","LRHY0",187,0)
 K LRDPF,PNM
"RTN","LRHY0",188,0)
 D PT^LRX
"RTN","LRHY0",189,0)
 D NOW^%DTC
"RTN","LRHY0",190,0)
 S ^TMP("LRHYDY",$J,"LR MULTIPLE ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHY0",191,0)
 S LRSKIPNO=1
"RTN","LRHY0",192,0)
 QUIT
"RTN","LRHY0",193,0)
ORDERS ;
"RTN","LRHY0",194,0)
 QUIT
"RTN","LRHY01")
0^2^B41442608^B42068305
"RTN","LRHY01",1,0)
LRHY01 ;DALOI/HOAK - HOWDY MAIN DRIVER ;10/15/10 11:02am
"RTN","LRHY01",2,0)
 ;;5.2;LAB SERVICE;**405,435**;Sep 27, 1994;Build 1
"RTN","LRHY01",3,0)
 ;
"RTN","LRHY01",4,0)
PICK ;
"RTN","LRHY01",5,0)
 ;  pick the site from Howdy Site FILE 69.86
"RTN","LRHY01",6,0)
 S LREND=0
"RTN","LRHY01",7,0)
 S DIC(0)="AEMQZ"
"RTN","LRHY01",8,0)
 S DIC=69.86
"RTN","LRHY01",9,0)
 D ^DIC
"RTN","LRHY01",10,0)
 I Y=-1 S LREND=1 QUIT
"RTN","LRHY01",11,0)
 S LRHYSITE=+Y
"RTN","LRHY01",12,0)
 K DIC
"RTN","LRHY01",13,0)
 ;
"RTN","LRHY01",14,0)
 N LRHY S LRHY="NUL" S LRHY=$O(^%ZIS(1,"B",LRHY))
"RTN","LRHY01",15,0)
 S LRDEV=$O(^%ZIS(1,"B",LRHY,0))
"RTN","LRHY01",16,0)
 D BINGO
"RTN","LRHY01",17,0)
 G ALT
"RTN","LRHY01",18,0)
 ;
"RTN","LRHY01",19,0)
 ; Pick a printer
"RTN","LRHY01",20,0)
 S LRDEV=0
"RTN","LRHY01",21,0)
 K DIC
"RTN","LRHY01",22,0)
 S DIC(0)="EMQZ" K Y S LRHYCT2=1
"RTN","LRHY01",23,0)
 F  S LRDEV=$O(^LRHY(69.86,LRHYSITE,10,"B",LRDEV)) Q:+LRDEV'>0  D
"RTN","LRHY01",24,0)
 .  W !,LRHYCT2,". ",$P(^%ZIS(1,LRDEV,0),U)
"RTN","LRHY01",25,0)
 .  S LRX(LRHYCT2)=LRDEV S LRHYCT2=LRHYCT2+1
"RTN","LRHY01",26,0)
CHOOO W !,"Choose a label printer: " R X:DTIME W !
"RTN","LRHY01",27,0)
 I X="" W !,"NOTHING SELECTED" S LREND=1 QUIT
"RTN","LRHY01",28,0)
 I U[X S LREND=1 QUIT
"RTN","LRHY01",29,0)
 I 'X I $G(X)'="" W !,"enter the number please" G CHOOO
"RTN","LRHY01",30,0)
 S LRDEV=LRX(X)
"RTN","LRHY01",31,0)
 ;
"RTN","LRHY01",32,0)
ALT ;
"RTN","LRHY01",33,0)
 W ?11,$P(^%ZIS(1,LRDEV,0),U) H 2
"RTN","LRHY01",34,0)
 K DIC
"RTN","LRHY01",35,0)
 K LRHYCT2
"RTN","LRHY01",36,0)
 ;
"RTN","LRHY01",37,0)
 QUIT
"RTN","LRHY01",38,0)
 ;
"RTN","LRHY01",39,0)
VET ; Primary API for Howdy!  Called by [LRHY PATIENT CARD SCAN] option.
"RTN","LRHY01",40,0)
 D XTMP^LRHYU
"RTN","LRHY01",41,0)
 N LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD
"RTN","LRHY01",42,0)
 N LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHY01",43,0)
 N LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHY01",44,0)
 N LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHY01",45,0)
 N LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHY01",46,0)
 N LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHY01",47,0)
 N LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHY01",48,0)
 N LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHY01",49,0)
 N LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHY01",50,0)
 K LR3D,LR33ORD,LR3T,LRANX6,LRCSQ,LRUP,LRHY3DT,LRHY3SN3
"RTN","LRHY01",51,0)
 K LRHYDJOB,LRHYSPC7,LRHYURG3,LRS3333,LRTAT
"RTN","LRHY01",52,0)
 K LRHY3DT3
"RTN","LRHY01",53,0)
 K LRHY3DT3
"RTN","LRHY01",54,0)
 K LRCCOMX
"RTN","LRHY01",55,0)
 K LRFINX
"RTN","LRHY01",56,0)
 ;
"RTN","LRHY01",57,0)
VET1 ; Code below executes to handle Patient episode.
"RTN","LRHY01",58,0)
 ; Then, Howdy waits here for next Patient
"RTN","LRHY01",59,0)
 I '$G(LRDEV) D PICK Q:LREND
"RTN","LRHY01",60,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD
"RTN","LRHY01",61,0)
 K ^TMP("LRHYDY",$J)
"RTN","LRHY01",62,0)
 D ^LRPARAM ; Set Howdy up as Lab user
"RTN","LRHY01",63,0)
 S LRHOWDY=1
"RTN","LRHY01",64,0)
 S LRHYCT=$G(LRHYCT,0)
"RTN","LRHY01",65,0)
 I LRHYCT=2 W !,"Please ask the clerk for assistance." K LRHYCT QUIT
"RTN","LRHY01",66,0)
 S LRODT=DT
"RTN","LRHY01",67,0)
 W @IOF
"RTN","LRHY01",68,0)
 K X
"RTN","LRHY01",69,0)
 ; 
"RTN","LRHY01",70,0)
 W !!,"Please swipe your ID CARD or Type SSN: "
"RTN","LRHY01",71,0)
 ;  %ZOSF("EOFF") = U $I:NOECHO
"RTN","LRHY01",72,0)
 ;  %ZOSF("EON") = U $I:ECHO
"RTN","LRHY01",73,0)
 X ^%ZOSF("EOFF")
"RTN","LRHY01",74,0)
 R X:9999999 W !
"RTN","LRHY01",75,0)
 I X=U X ^%ZOSF("EON") D BAKUSER^LRHYU QUIT
"RTN","LRHY01",76,0)
 X ^%ZOSF("EON")
"RTN","LRHY01",77,0)
 ; Code is set to read all types of VIC card as of 9/05/2005
"RTN","LRHY01",78,0)
 ;I $E(X,1,9)["-" D
"RTN","LRHY01",79,0)
 ;.  S X=$P(X,"-")_$P(X,"-",2)_$P(X,"-",3)
"RTN","LRHY01",80,0)
 ;I $E(X,1,1)'=0 I '$E(X,1,1) S X=$E(X,2,10)
"RTN","LRHY01",81,0)
 ;I $L(X)>10 S X=$E(X,2,10)
"RTN","LRHY01",82,0)
 ;I $L(X)'=9 W !,"Didn't read that Partner. " W:LRHYCT'=2 "Try again." H 2 S LRHYCT=LRHYCT+1 G VET
"RTN","LRHY01",83,0)
 K DFN,LRDFN,LRDPA,LRDPF,PNM,LRHYCT
"RTN","LRHY01",84,0)
 ; 
"RTN","LRHY01",85,0)
 ;S DFN=$O(^DPT("SSN",X,0))
"RTN","LRHY01",86,0)
 ;
"RTN","LRHY01",87,0)
 ; NEW CODE FOR VIC 4.0
"RTN","LRHY01",88,0)
 D RPCVIC^DPTLK(.DFN,X)
"RTN","LRHY01",89,0)
 ;
"RTN","LRHY01",90,0)
 I DFN<1 W !,"No record for this person." R X:15 G VET
"RTN","LRHY01",91,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHY01",92,0)
 ;
"RTN","LRHY01",93,0)
 I LRDFN D PT^LRX
"RTN","LRHY01",94,0)
 I 'LRDFN W !,"No Lab Data Available... Please check with clerk at the Desk." H 5 D LOG K X G VET
"RTN","LRHY01",95,0)
 K ^TMP("LRHYDY",$J,"LRHYDY",$J,LRDFN)
"RTN","LRHY01",96,0)
 ;
"RTN","LRHY01",97,0)
 ; this call checks order against the 69.86
"RTN","LRHY01",98,0)
 D ORDCHK^LRHYB
"RTN","LRHY01",99,0)
 ;
"RTN","LRHY01",100,0)
 ;
"RTN","LRHY01",101,0)
 ;
"RTN","LRHY01",102,0)
 I $G(LRMULT) W !!!,"Please check with clerk at the Desk" H 5 D LOG K X G VET
"RTN","LRHY01",103,0)
 I '$G(LRORD) S LREND=1 W !,$G(LRCTYPE)," No Orders found. Please check with clerk at the Desk" H 5 D LOG K X G VET
"RTN","LRHY01",104,0)
 D NOW^%DTC
"RTN","LRHY01",105,0)
 ;
"RTN","LRHY01",106,0)
 ;
"RTN","LRHY01",107,0)
 ;
"RTN","LRHY01",108,0)
PRT1 ;
"RTN","LRHY01",109,0)
 ;
"RTN","LRHY01",110,0)
 W @IOF
"RTN","LRHY01",111,0)
 D SCRNON^LRHYUTL
"RTN","LRHY01",112,0)
 S PNMALL="Howdy "_$P(PNM,",",2)_" "_$P(PNM,",")
"RTN","LRHY01",113,0)
 W !
"RTN","LRHY01",114,0)
 W IODHLT,"     ",PNMALL
"RTN","LRHY01",115,0)
 W !
"RTN","LRHY01",116,0)
 W IODHLB,"     ",PNMALL
"RTN","LRHY01",117,0)
 W !
"RTN","LRHY01",118,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,40)),IOM)
"RTN","LRHY01",119,0)
 W !,$$CJ^XLFSTR("Your Host is: "_$G(^LRHY(69.86,LRHYSITE,42)),IOM)
"RTN","LRHY01",120,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,44)),IOM)
"RTN","LRHY01",121,0)
 W !
"RTN","LRHY01",122,0)
 W IODHLT,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHY01",123,0)
 W !
"RTN","LRHY01",124,0)
 W IODHLB,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHY01",125,0)
 W !
"RTN","LRHY01",126,0)
 S LRXYZ=0
"RTN","LRHY01",127,0)
 F  S LRXYZ=$O(^LRHY(69.86,LRHYSITE,32,LRXYZ)) Q:+LRXYZ'>0  D
"RTN","LRHY01",128,0)
 .  W !
"RTN","LRHY01",129,0)
 .  W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,32,LRXYZ,0)),IOM)
"RTN","LRHY01",130,0)
 .  W !
"RTN","LRHY01",131,0)
 W *7 H 1 W *7 H 1 W *7
"RTN","LRHY01",132,0)
 ;
"RTN","LRHY01",133,0)
 I $D(^LRHY(69.86,LRHYSITE,54,"B")) D LRHYBING
"RTN","LRHY01",134,0)
 H 5
"RTN","LRHY01",135,0)
QUITH ; 
"RTN","LRHY01",136,0)
 D SCRNOFF^LRHYUTL ; Turn off screen variables
"RTN","LRHY01",137,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD,LRHYCT
"RTN","LRHY01",138,0)
 K LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHY01",139,0)
 K LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHY01",140,0)
 K LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHY01",141,0)
 K LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHY01",142,0)
 K LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHY01",143,0)
 K LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHY01",144,0)
 K LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHY01",145,0)
 K LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHY01",146,0)
 K VAIN
"RTN","LRHY01",147,0)
 ;
"RTN","LRHY01",148,0)
 ;
"RTN","LRHY01",149,0)
 G VET1
"RTN","LRHY01",150,0)
 ;
"RTN","LRHY01",151,0)
 ;
"RTN","LRHY01",152,0)
 ;
"RTN","LRHY01",153,0)
ORDCHK ; This block to be used for future version
"RTN","LRHY01",154,0)
 QUIT
"RTN","LRHY01",155,0)
LOG ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHY01",156,0)
 Q:$G(LRSKIPNO)
"RTN","LRHY01",157,0)
 ;
"RTN","LRHY01",158,0)
 W !,"NO ORDERS"
"RTN","LRHY01",159,0)
 ;
"RTN","LRHY01",160,0)
 K LRDPF,PNM
"RTN","LRHY01",161,0)
 D PT^LRX
"RTN","LRHY01",162,0)
 D NOW^%DTC
"RTN","LRHY01",163,0)
 I '$G(LRDFN) S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(DFN) QUIT
"RTN","LRHY01",164,0)
 S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHY01",165,0)
 QUIT
"RTN","LRHY01",166,0)
 ;
"RTN","LRHY01",167,0)
 ;
"RTN","LRHY01",168,0)
LOG1 ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHY01",169,0)
 K LRORD,LRDPT,PNM
"RTN","LRHY01",170,0)
 W !,"MULTIPLE ORDERS"
"RTN","LRHY01",171,0)
 K LRDPF,PNM
"RTN","LRHY01",172,0)
 D PT^LRX
"RTN","LRHY01",173,0)
 D NOW^%DTC
"RTN","LRHY01",174,0)
 S ^TMP("LRHYDY",$J,"LR MULTIPLE ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHY01",175,0)
 S LRSKIPNO=1
"RTN","LRHY01",176,0)
 QUIT
"RTN","LRHY01",177,0)
ORDERS ;
"RTN","LRHY01",178,0)
 QUIT
"RTN","LRHY01",179,0)
 ;
"RTN","LRHY01",180,0)
BINGO ;
"RTN","LRHY01",181,0)
 S LRBINGO=0
"RTN","LRHY01",182,0)
 K DIC S DIC(0)="EMQZ" K Y S LRHYCT3=1
"RTN","LRHY01",183,0)
 F  S LRBINGO=$O(^LRHY(69.86,LRHYSITE,54,"B",LRBINGO)) Q:+LRBINGO'>0  D
"RTN","LRHY01",184,0)
 .  W !!,LRHYCT3,". ",$P(^%ZIS(1,LRBINGO,0),U) W !
"RTN","LRHY01",185,0)
 .  S LRX(LRHYCT3)=LRBINGO S LRHYCT3=LRHYCT3+1
"RTN","LRHY01",186,0)
 N LRHYX W !,"Choose PPOC Bingo Board: " R LRHYX:DTIME W !
"RTN","LRHY01",187,0)
 I LRHYX[U W !,"NOTHING SELECTED " QUIT
"RTN","LRHY01",188,0)
 I LRHYX="" W !,"NOTHING SELECTED " QUIT
"RTN","LRHY01",189,0)
 I '+LRHYX W !,"CHOOSE A NUMBER " H 2 G BINGO
"RTN","LRHY01",190,0)
 Q:LRHYX[U
"RTN","LRHY01",191,0)
 I $G(LRHYX)["?" W !,"Choose  NUMBER " H 2 G BINGO
"RTN","LRHY01",192,0)
 I $D(LRX) S LRBINGO=LRX(LRHYX)
"RTN","LRHY01",193,0)
 Q:$G(LRBINGO)=""
"RTN","LRHY01",194,0)
 W !!
"RTN","LRHY01",195,0)
 W $P(^%ZIS(1,LRBINGO,0),U)
"RTN","LRHY01",196,0)
 W !
"RTN","LRHY01",197,0)
 S LRBINGO=$P(^%ZIS(1,LRBINGO,0),U)
"RTN","LRHY01",198,0)
 QUIT
"RTN","LRHY01",199,0)
LRHYBING ;
"RTN","LRHY01",200,0)
 ; Display Patient on Bingo board.
"RTN","LRHY01",201,0)
 W !,"SENDING TO BINGO BOARD ",LRBINGO H 2
"RTN","LRHY01",202,0)
 S ZTSAVE("PNM")=""
"RTN","LRHY01",203,0)
 S ZTRTN="PRIBB^LRHY01"
"RTN","LRHY01",204,0)
 S ZTDTH=$H
"RTN","LRHY01",205,0)
 S ZTDESC="PPOC BINGO PRINT"
"RTN","LRHY01",206,0)
 S ZTIO=$G(LRBINGO)
"RTN","LRHY01",207,0)
 S:$D(ZTQUEUED) ZTREQ="@" D ^%ZTLOAD
"RTN","LRHY01",208,0)
 ;
"RTN","LRHY01",209,0)
 QUIT
"RTN","LRHY01",210,0)
PRIBB ;
"RTN","LRHY01",211,0)
 W !,$G(PNM)
"RTN","LRHY01",212,0)
 QUIT
"RTN","LRHYAFT")
0^3^B93065494^B93771452
"RTN","LRHYAFT",1,0)
LRHYAFT ;DALOI/HOAK - HOWDY MAIN DRIVER WITH PPOC ADDON ;08/28/2005  ;12/13/10 11:19am
"RTN","LRHYAFT",2,0)
 ;;5.2;LAB SERVICE;**405,417,435**;Sep 27, 1994;Build 1
"RTN","LRHYAFT",3,0)
 ;
"RTN","LRHYAFT",4,0)
 ; TAKEN FROM LRHY0
"RTN","LRHYAFT",5,0)
PICK ;
"RTN","LRHYAFT",6,0)
 ;  pick the site from Howdy Site
"RTN","LRHYAFT",7,0)
 S LREND=0
"RTN","LRHYAFT",8,0)
 S DIC(0)="AEMQZ"
"RTN","LRHYAFT",9,0)
 S DIC=69.86
"RTN","LRHYAFT",10,0)
 D ^DIC
"RTN","LRHYAFT",11,0)
 I Y=-1 S LREND=1 QUIT
"RTN","LRHYAFT",12,0)
 S LRHYSITE=+Y
"RTN","LRHYAFT",13,0)
 K DIC
"RTN","LRHYAFT",14,0)
 ;
"RTN","LRHYAFT",15,0)
 ;
"RTN","LRHYAFT",16,0)
 ; Pick a printer
"RTN","LRHYAFT",17,0)
 I LRHYSITE=$O(^LRHY(69.86,"B","ALTERNATIVE",0)) ;QUIT
"RTN","LRHYAFT",18,0)
 S LRDEV=0
"RTN","LRHYAFT",19,0)
 K DIC
"RTN","LRHYAFT",20,0)
 S DIC(0)="EMQZ" K Y S LRHYCT2=1
"RTN","LRHYAFT",21,0)
 F  S LRDEV=$O(^LRHY(69.86,LRHYSITE,10,"B",LRDEV)) Q:+LRDEV'>0  D
"RTN","LRHYAFT",22,0)
 .  W !,LRHYCT2,". ",$P(^%ZIS(1,LRDEV,0),U)
"RTN","LRHYAFT",23,0)
 .  S LRX(LRHYCT2)=LRDEV S LRHYCT2=LRHYCT2+1
"RTN","LRHYAFT",24,0)
CHOOO W !,"Choose a label printer: " R X:DTIME W !
"RTN","LRHYAFT",25,0)
 I U[X S LREND=1 QUIT
"RTN","LRHYAFT",26,0)
 I 'X I $G(X)'="" W !,"enter the number please" G CHOOO
"RTN","LRHYAFT",27,0)
 S LRDEV=LRX(X)
"RTN","LRHYAFT",28,0)
 W ?11,$P(^%ZIS(1,LRDEV,0),U) H 2
"RTN","LRHYAFT",29,0)
 K DIC
"RTN","LRHYAFT",30,0)
 K LRHYCT2
"RTN","LRHYAFT",31,0)
 ;
"RTN","LRHYAFT",32,0)
 QUIT
"RTN","LRHYAFT",33,0)
 ;
"RTN","LRHYAFT",34,0)
VET ; Primary API for Howdy!  Called by [LRHY PATIENT CARD SCAN (PPOC)] option.
"RTN","LRHYAFT",35,0)
 K XX,LRAAX5,LRADX6,LRAN6,LRINFW,LRPREF,LRTOP,LR3UIDM,LRXL,ZTSAVE,ZTIO,ZTDTH,ZTDESC,ZTRTN
"RTN","LRHYAFT",36,0)
 K LR3CNT S LR3CNT=0
"RTN","LRHYAFT",37,0)
 S LR3CNT=1
"RTN","LRHYAFT",38,0)
 N LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD
"RTN","LRHYAFT",39,0)
 D KILL^%ZISS
"RTN","LRHYAFT",40,0)
 K LRSCAN
"RTN","LRHYAFT",41,0)
 K LRNOW,LRXCNT
"RTN","LRHYAFT",42,0)
 N LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHYAFT",43,0)
 N LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHYAFT",44,0)
 N LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHYAFT",45,0)
 N LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHYAFT",46,0)
 N LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHYAFT",47,0)
 N LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHYAFT",48,0)
 N LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHYAFT",49,0)
 N LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHYAFT",50,0)
 ;
"RTN","LRHYAFT",51,0)
VET1 ; Code below executes to handle Patient episode.
"RTN","LRHYAFT",52,0)
 K DIC
"RTN","LRHYAFT",53,0)
 I $G(LRHYSITE)="" S DIC=69.86,DIC(0)="AEMQZ" D ^DIC Q:'Y  S LRHYSITE=+Y
"RTN","LRHYAFT",54,0)
 I LRHYSITE=-1 W !,"No Howdy site selected. Goodbye. " K LRHYSITE,LRDEV,LRLABLIO QUIT
"RTN","LRHYAFT",55,0)
 ; Then, Howdy waits here for next Patient
"RTN","LRHYAFT",56,0)
 I $G(LRDEV)'="" G V2
"RTN","LRHYAFT",57,0)
 S DIC("A")="WHICH LABEL PRINTER:"
"RTN","LRHYAFT",58,0)
 S DIC="^%ZIS(2,"
"RTN","LRHYAFT",59,0)
 S DIC(0)="AEMQZ"
"RTN","LRHYAFT",60,0)
 S DIC=3.2
"RTN","LRHYAFT",61,0)
 S DIC="^%ZIS(1,"
"RTN","LRHYAFT",62,0)
 S DIC(0)="AEMQZN"
"RTN","LRHYAFT",63,0)
 I '$G(LRDEV) D ^DIC Q:+Y=0  S LRDEV=+Y S LRLABLIO=LRDEV
"RTN","LRHYAFT",64,0)
 I Y=-1 W !,"No device selected. Goodbye. " K LRLABLIO,LRDEV,LRHYSITE QUIT
"RTN","LRHYAFT",65,0)
 D ^LRHYBL1
"RTN","LRHYAFT",66,0)
 I $G(LRLABSTP)'="" S LRLABLIO=LRLABLIO_";"_LRLABSTP
"RTN","LRHYAFT",67,0)
 I '$G(LRDEV) D PICK Q:LREND
"RTN","LRHYAFT",68,0)
V2 ;
"RTN","LRHYAFT",69,0)
 ;
"RTN","LRHYAFT",70,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD
"RTN","LRHYAFT",71,0)
 D ^LRPARAM ; Set Howdy up as Lab user
"RTN","LRHYAFT",72,0)
 S LRHOWDY=1
"RTN","LRHYAFT",73,0)
 S LRHYCT=$G(LRHYCT,0)
"RTN","LRHYAFT",74,0)
 ;
"RTN","LRHYAFT",75,0)
 S LRODT=DT
"RTN","LRHYAFT",76,0)
 W @IOF
"RTN","LRHYAFT",77,0)
 K X
"RTN","LRHYAFT",78,0)
 ; 
"RTN","LRHYAFT",79,0)
 W !!,"Please swipe PATIENT ID CARD or Type SSN: "
"RTN","LRHYAFT",80,0)
 ; %ZOSF("EOFF") = U $I:NOECHO
"RTN","LRHYAFT",81,0)
 ; %ZOSF("EON") = U $I:ECHO
"RTN","LRHYAFT",82,0)
 R X:9999999 W !
"RTN","LRHYAFT",83,0)
 I X=U D SCROLOFF^LRHYBC9 QUIT
"RTN","LRHYAFT",84,0)
 ; Code is set to read all types of VIC card as of 9/05/2005
"RTN","LRHYAFT",85,0)
 ;I $E(X,1,9)["-" D
"RTN","LRHYAFT",86,0)
 ;.  S X=$P(X,"-")_$P(X,"-",2)_$P(X,"-",3)
"RTN","LRHYAFT",87,0)
 ;I $E(X,1,1)'=0 I '$E(X,1,1) S X=$E(X,2,10)
"RTN","LRHYAFT",88,0)
 ;I $L(X)>10 S X=$E(X,2,10)
"RTN","LRHYAFT",89,0)
 ;I $L(X)'=9 S LR3CNT=LR3CNT+1
"RTN","LRHYAFT",90,0)
 ;I $L(X)'=9 W !,"Didn't read that Partner. " W:LRHYCT'=2 "Try again." H 2 S LRHYCT=LRHYCT+1 G VET1
"RTN","LRHYAFT",91,0)
NSCN ;
"RTN","LRHYAFT",92,0)
 K DFN,LRDFN,LRDPA,LRDPF,PNM,LRHYCT
"RTN","LRHYAFT",93,0)
 ; 
"RTN","LRHYAFT",94,0)
 ;S DFN=$O(^DPT("SSN",X,0))
"RTN","LRHYAFT",95,0)
 ;
"RTN","LRHYAFT",96,0)
 ; NEW CODE FOR VHIC 4.0
"RTN","LRHYAFT",97,0)
 D RPCVIC^DPTLK(.DFN,X)
"RTN","LRHYAFT",98,0)
 I DFN<1 W !,"No record for this person." R X:15 G VET
"RTN","LRHYAFT",99,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","LRHYAFT",100,0)
 ;
"RTN","LRHYAFT",101,0)
 I LRDFN D PT^LRX
"RTN","LRHYAFT",102,0)
 I 'LRDFN W !,"No Lab Data Available... Please check with clerk at the Desk." H 5 D LOG K X G VET
"RTN","LRHYAFT",103,0)
 K ^TMP("LRHYDY",$J,"LRHYDY",$J,LRDFN)
"RTN","LRHYAFT",104,0)
 ;
"RTN","LRHYAFT",105,0)
 ; this call checks order against the 69.86
"RTN","LRHYAFT",106,0)
 W !,"I'M DOING THE BEST I CAN"
"RTN","LRHYAFT",107,0)
 ; HERE IS WHERE WE PRINT LABELS ACCESSIONED EARLIER 2/25/2009 DRH
"RTN","LRHYAFT",108,0)
PX ;
"RTN","LRHYAFT",109,0)
 N LRX,LRY
"RTN","LRHYAFT",110,0)
 I 'LRDFN S LRDFN=^DPT(DFN,"LR")
"RTN","LRHYAFT",111,0)
 W @IOF
"RTN","LRHYAFT",112,0)
 W !,PNM,?40,SSN,"   ",$$Y2K^LRX(DOB)
"RTN","LRHYAFT",113,0)
 S LRADD=$G(^DPT(DFN,.11))
"RTN","LRHYAFT",114,0)
 I LRADD'="" W !,$P(LRADD,U),?35," ",$P(LRADD,U,4)," ",$P(^DIC(5,$P(LRADD,U,5),0),U)
"RTN","LRHYAFT",115,0)
 S LRPHONE=$P($G(^DPT(DFN,.121)),U,10) I $G(LRPHONE) W " Ph#:",$G(LRPHONE)
"RTN","LRHYAFT",116,0)
 H 3
"RTN","LRHYAFT",117,0)
 S DIR("B")="NO",DIR(0)="Y",DIR("A")="PT CONFIRMATION PROMPT. Is this the correct Patient?"
"RTN","LRHYAFT",118,0)
 D ^DIR
"RTN","LRHYAFT",119,0)
 I Y[U D SCROLOFF^LRHYBC9 W @IOF QUIT
"RTN","LRHYAFT",120,0)
 I $G(Y(0))'="YES" W !!,"PT CONFIRMATION FAILED..." H 3 QUIT
"RTN","LRHYAFT",121,0)
 S LR3UID=""
"RTN","LRHYAFT",122,0)
 W @IOF
"RTN","LRHYAFT",123,0)
 D ENS^%ZISS
"RTN","LRHYAFT",124,0)
 W *27,*91,*109 W *27,*91,45,*109
"RTN","LRHYAFT",125,0)
 W IODHLT," ",PNM
"RTN","LRHYAFT",126,0)
 W !
"RTN","LRHYAFT",127,0)
 W IODHLB," ",PNM
"RTN","LRHYAFT",128,0)
 W !
"RTN","LRHYAFT",129,0)
 W !
"RTN","LRHYAFT",130,0)
 W IODHLT," ",SSN
"RTN","LRHYAFT",131,0)
 W !
"RTN","LRHYAFT",132,0)
 W IODHLB," ",SSN
"RTN","LRHYAFT",133,0)
 W *27,"[",40,";",37,"m",!
"RTN","LRHYAFT",134,0)
 W !
"RTN","LRHYAFT",135,0)
 W ! D LRGLIN^LRX W !
"RTN","LRHYAFT",136,0)
 S LRX=0
"RTN","LRHYAFT",137,0)
 S CNT=0
"RTN","LRHYAFT",138,0)
 K LRLABTIM S LRLABTIM=$O(^XTMP("LRHY LABELS",LRDFN,DT))
"RTN","LRHYAFT",139,0)
 I $G(LRLABTIM)="" W !,"NOTHING TO PRINT ON ",PNM H 2 QUIT
"RTN","LRHYAFT",140,0)
 D LRBOX^LRHYLRX(60,6,5,15," ")
"RTN","LRHYAFT",141,0)
 F  S LR3UID=$O(^XTMP("LRHY LABELS",LRDFN,LRLABTIM,LR3UID)) Q:LR3UID=""  D
"RTN","LRHYAFT",142,0)
 .  I $L(LR3UID)<10 W !,"UID < 10 CHRS. ACCESSION MANUALLY" H 2 QUIT
"RTN","LRHYAFT",143,0)
 .  K LRLABNO S LRLABNOD=$G(^XTMP("LRHY LABELS",LRDFN,LRLABTIM,LR3UID))
"RTN","LRHYAFT",144,0)
 .  S LRY=0
"RTN","LRHYAFT",145,0)
 .  S LRX=$O(^LRO(68,"C",LR3UID,0))
"RTN","LRHYAFT",146,0)
 .  I '$G(LRX) D MICRO
"RTN","LRHYAFT",147,0)
 .  Q:'$G(LRX)
"RTN","LRHYAFT",148,0)
 .  S LRY1=$O(^LRO(68,"C",LR3UID,LRX,0))
"RTN","LRHYAFT",149,0)
 .  S LRY=$O(^LRO(68,"C",LR3UID,LRX,LRY1,LRY))
"RTN","LRHYAFT",150,0)
 .  D
"RTN","LRHYAFT",151,0)
 ..  S LRLBL(LRX,LRY)=LRLABNOD
"RTN","LRHYAFT",152,0)
 ..  S CNT=CNT+1 S LABCNT(CNT)=LRLBL(LRX,LRY)
"RTN","LRHYAFT",153,0)
 ..  S LRXCNT(CNT)=LRX_U_LRY
"RTN","LRHYAFT",154,0)
 ..  S X=62,Y=5
"RTN","LRHYAFT",155,0)
 ..  S LRAD=$G(LRY1)
"RTN","LRHYAFT",156,0)
 ..  W !,CNT,") ",$P(LRLBL(LRX,LRY),U,6)
"RTN","LRHYAFT",157,0)
 ..  I '$G(LRAD) S LRAD=DT
"RTN","LRHYAFT",158,0)
 ..  W ?21,$P(^LAB(62,$P(^LRO(68,LRX,1,LRAD,1,LRY,5,1,0),U,2),0),U,3)
"RTN","LRHYAFT",159,0)
 S LRX=0
"RTN","LRHYAFT",160,0)
 S LRX=0
"RTN","LRHYAFT",161,0)
 S DY=5
"RTN","LRHYAFT",162,0)
 S DY=6
"RTN","LRHYAFT",163,0)
 F  S LRX=$O(LRLBL(LRX)) Q:+LRX'>0  S DX=62,LRC=$O(LRLBL(LRX,0)),LRAD=$P(LRLBL(LRX,LRC),U,2),DY=DY+1 X IOXY K LR3UID S LR3UID=$G(^LRO(68,LRX,1,LRAD,1,LRC,.3)) W LR3UID
"RTN","LRHYAFT",164,0)
 ;
"RTN","LRHYAFT",165,0)
 W !!
"RTN","LRHYAFT",166,0)
 W !! H 4
"RTN","LRHYAFT",167,0)
 D ENS^%ZISS S IOTM=16,IOBM=23
"RTN","LRHYAFT",168,0)
 ;
"RTN","LRHYAFT",169,0)
 W @IOSTBM
"RTN","LRHYAFT",170,0)
 W !!
"RTN","LRHYAFT",171,0)
 H 3
"RTN","LRHYAFT",172,0)
 W !
"RTN","LRHYAFT",173,0)
 S DX=0,DY=13 X IOXY
"RTN","LRHYAFT",174,0)
 S DX=0,DY=17 X IOXY
"RTN","LRHYAFT",175,0)
 W !!," Proceed with COLLECTION:" W *7
"RTN","LRHYAFT",176,0)
 W !!
"RTN","LRHYAFT",177,0)
 W !,"Select specimen(s) you actually collected to print corresponding labels:"
"RTN","LRHYAFT",178,0)
SL ;
"RTN","LRHYAFT",179,0)
 R LRS:DTIME W ! I LRS["-" G QQQ
"RTN","LRHYAFT",180,0)
QQQ ;
"RTN","LRHYAFT",181,0)
 F I=1:1:10 Q:+$P(LRS,",",I)'>0  S LRS3333=+$P(LRS,",",I) I '$D(LABCNT(LRS3333)) W !,"OUT OF RANGE" H 3 G PX
"RTN","LRHYAFT",182,0)
 K LRLBL
"RTN","LRHYAFT",183,0)
 I LRS["?" W !,"You may enter 1 OR 2 OR 1,2,3,etc NO DASHES(-) PLEASE " H 4 G PX
"RTN","LRHYAFT",184,0)
 I LRS["," F LRXX=1:1:CNT S I=$P(LRS,",",LRXX) Q:+I'>0  S LRX=$P(LRXCNT(I),U),LRY=$P(LRXCNT(I),U,2) D
"RTN","LRHYAFT",185,0)
 .  S LRAD=DT
"RTN","LRHYAFT",186,0)
 .  I $P(^LRO(68,LRX,0),U,3)="Y" S LRAD=$E(DT,1,3)_"0000"
"RTN","LRHYAFT",187,0)
 .  I $P(^LRO(68,LRX,0),U,3)="M" S LRAD=$E(DT,1,5)_"00"
"RTN","LRHYAFT",188,0)
 .  W !,"Sending to print: ",$P($G(^LRO(68,LRX,1,LRAD,1,LRY,.3)),U),"  ",$P(^LAB(62,$P(^LRO(68,LRX,1,LRAD,1,LRY,5,1,0),U,2),0),U,3)
"RTN","LRHYAFT",189,0)
 .  S LRORD=$G(^LRO(68,LRX,1,LRAD,1,LRY,.1))
"RTN","LRHYAFT",190,0)
 .  I $P($G(LRXCNT(I)),U,2)="" QUIT
"RTN","LRHYAFT",191,0)
 .  S LRLBL(LRX,$P(LRXCNT(I),U,2))=LABCNT(I)_$G(LRORD)
"RTN","LRHYAFT",192,0)
 .  S LR3UID=$P($G(^LRO(68,LRX,1,LRAD,1,LRY,.3)),U)
"RTN","LRHYAFT",193,0)
 .  D BCE^LRHYPH0
"RTN","LRHYAFT",194,0)
 .  K ^XTMP("LRHY LABELS",LRDFN,LRLABTIM,LR3UID)
"RTN","LRHYAFT",195,0)
 I LRS["-" W !,"DASHES ARE NOT PERMITTED. ENTER 1,2,3 ETC" H 1 G PX
"RTN","LRHYAFT",196,0)
 I $G(LRXCNT(+LRS))="" W !,"OUT OF RANGE. TRY AGAIN" H 2 G PX
"RTN","LRHYAFT",197,0)
 E  I $L(LRS)=1 I $G(LRXCNT(LRS))'="" S I=LRS Q:+I'>0  S LRX=$P(LRXCNT(I),U),LRY=$P(LRXCNT(I),U,2) D
"RTN","LRHYAFT",198,0)
 .  S LRAD=DT
"RTN","LRHYAFT",199,0)
 .  I $P(^LRO(68,LRX,0),U,3)="M" S LRAD=$E(DT,1,5)_"00"
"RTN","LRHYAFT",200,0)
 .  I $P(^LRO(68,LRX,0),U,3)="Y" S LRAD=$E(DT,1,3)_"0000"
"RTN","LRHYAFT",201,0)
 .  W !,"Sending to print: ",$P($G(^LRO(68,LRX,1,LRAD,1,LRY,.3)),U),"  ",$P(^LAB(62,$P(^LRO(68,LRX,1,LRAD,1,LRY,5,1,0),U,2),0),U,3)
"RTN","LRHYAFT",202,0)
 .  S LR3UID=$P($G(^LRO(68,LRX,1,LRAD,1,LRY,.3)),U)
"RTN","LRHYAFT",203,0)
 .  S LRORD=$G(^LRO(68,LRX,1,LRAD,1,LRY,.1))
"RTN","LRHYAFT",204,0)
 .  S LRLBL(LRX,$P(LRXCNT(LRS),U,2))=LABCNT(LRS)_$G(LRORD)
"RTN","LRHYAFT",205,0)
 .  W !,"REMOVING ",LR3UID H 2
"RTN","LRHYAFT",206,0)
 .  D BCE^LRHYPH0
"RTN","LRHYAFT",207,0)
 .  S LRSCAN=$G(LRLABTIM)
"RTN","LRHYAFT",208,0)
 .  K ^XTMP("LRHY LABELS",LRDFN,LRLABTIM,LR3UID)
"RTN","LRHYAFT",209,0)
 H 4
"RTN","LRHYAFT",210,0)
 I '$D(^XTMP("LRHY LABELS",LRDFN,LRLABTIM)) G VIE
"RTN","LRHYAFT",211,0)
 K DIR
"RTN","LRHYAFT",212,0)
 S DIR("A")="What shall we do with these?"
"RTN","LRHYAFT",213,0)
 ;
"RTN","LRHYAFT",214,0)
 S DIR(0)="S^1:Delete;C:Collect;"
"RTN","LRHYAFT",215,0)
 S DIR("B")="Delete"
"RTN","LRHYAFT",216,0)
 D ^DIR Q:X[U
"RTN","LRHYAFT",217,0)
 I Y="C" G PX
"RTN","LRHYAFT",218,0)
 I Y=1 D DEL7 W !,"Use Lab option > Accessioning Menu: Delete test from an accession [LRTSTOUT]" H 2
"RTN","LRHYAFT",219,0)
 ;
"RTN","LRHYAFT",220,0)
VIE ;
"RTN","LRHYAFT",221,0)
 D CONTROL^LRHYBC1
"RTN","LRHYAFT",222,0)
 H 3 W @IOF
"RTN","LRHYAFT",223,0)
 D SCROLOFF^LRHYBC9
"RTN","LRHYAFT",224,0)
 QUIT
"RTN","LRHYAFT",225,0)
MICRO ;
"RTN","LRHYAFT",226,0)
 S LRACNODE=^XTMP("LRHY LABELS",LRDFN,LRLABTIM,LR3UID)
"RTN","LRHYAFT",227,0)
 S LRACCXX=$P(LRACNODE,U,6)
"RTN","LRHYAFT",228,0)
 S LR68=$P(LRACCXX," ") S LRAA=$O(^LRO(68,"B",LR68,0))
"RTN","LRHYAFT",229,0)
 S LRAN=$P(LRACCXX," ",3)
"RTN","LRHYAFT",230,0)
 S LRAD=$P(LRACNODE,U,2)
"RTN","LRHYAFT",231,0)
 S LR3UIDM=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,.3))
"RTN","LRHYAFT",232,0)
 S LRX=$O(^LRO(68,"C",LR3UID,0))
"RTN","LRHYAFT",233,0)
 QUIT
"RTN","LRHYAFT",234,0)
 ;
"RTN","LRHYAFT",235,0)
PRT1 ;
"RTN","LRHYAFT",236,0)
 ;
"RTN","LRHYAFT",237,0)
 W @IOF
"RTN","LRHYAFT",238,0)
 D SCRNON^LRHYUTL
"RTN","LRHYAFT",239,0)
 K PNMALL S PNMALL="Howdy "_$P(PNM,",",2)_" "_$P(PNM,",")
"RTN","LRHYAFT",240,0)
 W !
"RTN","LRHYAFT",241,0)
 W IODHLT,"     ",PNMALL
"RTN","LRHYAFT",242,0)
 W !
"RTN","LRHYAFT",243,0)
 W IODHLB,"     ",PNMALL
"RTN","LRHYAFT",244,0)
 W !
"RTN","LRHYAFT",245,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,40)),IOM)
"RTN","LRHYAFT",246,0)
 W !,$$CJ^XLFSTR($G(^LRHY(69.86,LRHYSITE,44)),IOM)
"RTN","LRHYAFT",247,0)
 W !
"RTN","LRHYAFT",248,0)
 W IODHLT,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHYAFT",249,0)
 W !
"RTN","LRHYAFT",250,0)
 W IODHLB,"    Orders for date: "_$$Y2K^LRX(DT)
"RTN","LRHYAFT",251,0)
 W !
"RTN","LRHYAFT",252,0)
 S LRXYZ=0
"RTN","LRHYAFT",253,0)
 W *7 H 1 W *7 H 1 W *7
"RTN","LRHYAFT",254,0)
 ;
"RTN","LRHYAFT",255,0)
 H 5
"RTN","LRHYAFT",256,0)
QUITH ; 
"RTN","LRHYAFT",257,0)
 D SCRNOFF^LRHYUTL ; Turn off screen variables
"RTN","LRHYAFT",258,0)
 K LRDFN,PNM,LRSN,SSN,LRIDT,LRAA,LRAN,LRAD,LRHYCT
"RTN","LRHYAFT",259,0)
 K LRNPZZX,LRNODUP,LRLLOC,LRTSTZ99,LRACC,LRCDT,LRDPF,LRI
"RTN","LRHYAFT",260,0)
 K LRORD3,LRHYFIX,LRPLICK,LRPR,LRPRAC,LRQUIET,LRRB,LRSAMP,LRSND
"RTN","LRHYAFT",261,0)
 K LRSS,LRST,LRSTATUS,LRSUB1,LRTIC,LRTIM,LRTN,LRTREA,LRTS,LRTSORU
"RTN","LRHYAFT",262,0)
 K LRTST6,LRTT,LRUN,LRWLO,LRWLC,LRWRD,LRXYZ,LR3DTIME,LR3DTN
"RTN","LRHYAFT",263,0)
 K LR3SN,LRDT0,LREAL,LRFUTURE,LRGOTIT,LRHOWDY,LRHYHOK,LRIENZZ
"RTN","LRHYAFT",264,0)
 K LRNOTST,LRLBLBP,LRLLOC66,LRMAX2,LRNLT,LRNODUP,LRNONE,LRNPZZX,LRODT
"RTN","LRHYAFT",265,0)
 K LRODT0,LRHYOK,LRORD24,LRORU3,LRPAST,LRPIX,LRAHEAD,LRCHK,LRHYCT,LRCOL99
"RTN","LRHYAFT",266,0)
 K LRDT0,LRDUPT,LRHT1,LRIX,LROLLOC,LRX,LR3X
"RTN","LRHYAFT",267,0)
 K VAIN
"RTN","LRHYAFT",268,0)
 ;
"RTN","LRHYAFT",269,0)
 ;
"RTN","LRHYAFT",270,0)
 G VET
"RTN","LRHYAFT",271,0)
 ;
"RTN","LRHYAFT",272,0)
 ;
"RTN","LRHYAFT",273,0)
 ;
"RTN","LRHYAFT",274,0)
ORDCHK ; This block to be used for future version
"RTN","LRHYAFT",275,0)
 QUIT
"RTN","LRHYAFT",276,0)
LOG ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHYAFT",277,0)
 Q:$G(LRSKIPNO)
"RTN","LRHYAFT",278,0)
 ;
"RTN","LRHYAFT",279,0)
 W !,"NO ORDERS"
"RTN","LRHYAFT",280,0)
 ;
"RTN","LRHYAFT",281,0)
 K LRDPF,PNM
"RTN","LRHYAFT",282,0)
 D PT^LRX
"RTN","LRHYAFT",283,0)
 D NOW^%DTC
"RTN","LRHYAFT",284,0)
 I '$G(LRDFN) S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(DFN) QUIT
"RTN","LRHYAFT",285,0)
 S ^TMP("LRHYDY",$J,"LR NO ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHYAFT",286,0)
 QUIT
"RTN","LRHYAFT",287,0)
 ;
"RTN","LRHYAFT",288,0)
 ;
"RTN","LRHYAFT",289,0)
LOG1 ; Howdy will default to the clerks judgement when multiple orders found.
"RTN","LRHYAFT",290,0)
 K LRORD
"RTN","LRHYAFT",291,0)
 W !,"MULTIPLE ORDERS"
"RTN","LRHYAFT",292,0)
 K LRDPF,PNM
"RTN","LRHYAFT",293,0)
 D PT^LRX
"RTN","LRHYAFT",294,0)
 D NOW^%DTC
"RTN","LRHYAFT",295,0)
 S ^TMP("LRHYDY",$J,"LR MULTIPLE ORDERS",%)=$G(PNM)_U_$G(^LR(LRDFN,.1))_U_$G(SSN)
"RTN","LRHYAFT",296,0)
 K LRSKIPNO S LRSKIPNO=1
"RTN","LRHYAFT",297,0)
 QUIT
"RTN","LRHYAFT",298,0)
ORDERS ;
"RTN","LRHYAFT",299,0)
 QUIT
"RTN","LRHYAFT",300,0)
NOSCAN ;
"RTN","LRHYAFT",301,0)
 QUIT
"RTN","LRHYAFT",302,0)
DEL7 ;
"RTN","LRHYAFT",303,0)
 QUIT
"VER")
8.0^22.0
"BLD",9505,6)
^344
**END**
**END**

