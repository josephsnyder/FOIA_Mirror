Released PRC*5.1*173 SEQ #155
Extracted from mail message
**KIDS**:PRC*5.1*173^

**INSTALL NAME**
PRC*5.1*173
"BLD",7216,0)
PRC*5.1*173^IFCAP^0^3130516^y
"BLD",7216,1,0)
^^5^5^3130429^^^
"BLD",7216,1,1,0)
1. Monthly Accrual Document Cost Center issue
"BLD",7216,1,2,0)
 
"BLD",7216,1,3,0)
2. Audit/control File 442 Internal Entry number (IEN) setting
"BLD",7216,1,4,0)
 
"BLD",7216,1,5,0)
3. 1358 Adjustments causing FMS SO Document error
"BLD",7216,4,0)
^9.64PA^410^2
"BLD",7216,4,410,0)
410
"BLD",7216,4,410,2,0)
^9.641^410^1
"BLD",7216,4,410,2,410,0)
CONTROL POINT ACTIVITY  (File-top level)
"BLD",7216,4,410,2,410,1,0)
^9.6411^25^3
"BLD",7216,4,410,2,410,1,20,0)
COMMITTED (ESTIMATED) COST
"BLD",7216,4,410,2,410,1,25,0)
ADJUSTMENT $ AMOUNT
"BLD",7216,4,410,2,410,1,27,0)
TRANSACTION $ AMOUNT
"BLD",7216,4,410,222)
y^n^p^^^^n^^n
"BLD",7216,4,410,224)

"BLD",7216,4,442,0)
442
"BLD",7216,4,442,2,0)
^9.641^442^1
"BLD",7216,4,442,2,442,0)
PROCUREMENT & ACCOUNTING TRANSACTIONS  (File-top level)
"BLD",7216,4,442,2,442,1,0)
^9.6411^7.2^6
"BLD",7216,4,442,2,442,1,3.4,0)
SUBAMOUNT1
"BLD",7216,4,442,2,442,1,7.2,0)
ESTIMATED COST
"BLD",7216,4,442,2,442,1,91,0)
TOTAL AMOUNT
"BLD",7216,4,442,2,442,1,92,0)
NET AMOUNT
"BLD",7216,4,442,2,442,1,93,0)
LIQUIDATED AMOUNT
"BLD",7216,4,442,2,442,1,94,0)
ACTUAL 1358 BALANCE
"BLD",7216,4,442,222)
y^n^p^^^^n^^n
"BLD",7216,4,442,224)

"BLD",7216,4,"APDD",410,410)

"BLD",7216,4,"APDD",410,410,20)

"BLD",7216,4,"APDD",410,410,25)

"BLD",7216,4,"APDD",410,410,27)

"BLD",7216,4,"APDD",442,442)

"BLD",7216,4,"APDD",442,442,3.4)

"BLD",7216,4,"APDD",442,442,7.2)

"BLD",7216,4,"APDD",442,442,91)

"BLD",7216,4,"APDD",442,442,92)

"BLD",7216,4,"APDD",442,442,93)

"BLD",7216,4,"APDD",442,442,94)

"BLD",7216,4,"B",410,410)

"BLD",7216,4,"B",442,442)

"BLD",7216,6.3)
9
"BLD",7216,"ABPKG")
n
"BLD",7216,"KRN",0)
^9.67PA^779.2^20
"BLD",7216,"KRN",.4,0)
.4
"BLD",7216,"KRN",.401,0)
.401
"BLD",7216,"KRN",.402,0)
.402
"BLD",7216,"KRN",.403,0)
.403
"BLD",7216,"KRN",.5,0)
.5
"BLD",7216,"KRN",.84,0)
.84
"BLD",7216,"KRN",3.6,0)
3.6
"BLD",7216,"KRN",3.8,0)
3.8
"BLD",7216,"KRN",9.2,0)
9.2
"BLD",7216,"KRN",9.8,0)
9.8
"BLD",7216,"KRN",9.8,"NM",0)
^9.68A^4^2
"BLD",7216,"KRN",9.8,"NM",3,0)
PRCHNPO6^^0^B24682336
"BLD",7216,"KRN",9.8,"NM",4,0)
PRCB8B^^0^B13408384
"BLD",7216,"KRN",9.8,"NM","B","PRCB8B",4)

"BLD",7216,"KRN",9.8,"NM","B","PRCHNPO6",3)

"BLD",7216,"KRN",19,0)
19
"BLD",7216,"KRN",19.1,0)
19.1
"BLD",7216,"KRN",101,0)
101
"BLD",7216,"KRN",409.61,0)
409.61
"BLD",7216,"KRN",771,0)
771
"BLD",7216,"KRN",779.2,0)
779.2
"BLD",7216,"KRN",870,0)
870
"BLD",7216,"KRN",8989.51,0)
8989.51
"BLD",7216,"KRN",8989.52,0)
8989.52
"BLD",7216,"KRN",8994,0)
8994
"BLD",7216,"KRN","B",.4,.4)

"BLD",7216,"KRN","B",.401,.401)

"BLD",7216,"KRN","B",.402,.402)

"BLD",7216,"KRN","B",.403,.403)

"BLD",7216,"KRN","B",.5,.5)

"BLD",7216,"KRN","B",.84,.84)

"BLD",7216,"KRN","B",3.6,3.6)

"BLD",7216,"KRN","B",3.8,3.8)

"BLD",7216,"KRN","B",9.2,9.2)

"BLD",7216,"KRN","B",9.8,9.8)

"BLD",7216,"KRN","B",19,19)

"BLD",7216,"KRN","B",19.1,19.1)

"BLD",7216,"KRN","B",101,101)

"BLD",7216,"KRN","B",409.61,409.61)

"BLD",7216,"KRN","B",771,771)

"BLD",7216,"KRN","B",779.2,779.2)

"BLD",7216,"KRN","B",870,870)

"BLD",7216,"KRN","B",8989.51,8989.51)

"BLD",7216,"KRN","B",8989.52,8989.52)

"BLD",7216,"KRN","B",8994,8994)

"BLD",7216,"QDEF")
^^^^^^^^^^YES
"BLD",7216,"QUES",0)
^9.62^^
"BLD",7216,"REQB",0)
^9.611^7^2
"BLD",7216,"REQB",5,0)
PRC*5.1*129^2
"BLD",7216,"REQB",7,0)
PRC*5.1*142^2
"BLD",7216,"REQB","B","PRC*5.1*129",5)

"BLD",7216,"REQB","B","PRC*5.1*142",7)

"FIA",410)
CONTROL POINT ACTIVITY
"FIA",410,0)
^PRCS(410,
"FIA",410,0,0)
410I
"FIA",410,0,1)
y^n^p^^^^n^^n
"FIA",410,0,10)

"FIA",410,0,11)

"FIA",410,0,"RLRO")

"FIA",410,0,"VR")
5.1^PRC
"FIA",410,410)
1
"FIA",410,410,20)

"FIA",410,410,25)

"FIA",410,410,27)

"FIA",442)
PROCUREMENT & ACCOUNTING TRANSACTIONS
"FIA",442,0)
^PRC(442,
"FIA",442,0,0)
442I
"FIA",442,0,1)
y^n^p^^^^n^^n
"FIA",442,0,10)

"FIA",442,0,11)

"FIA",442,0,"RLRO")

"FIA",442,0,"VR")
5.1^PRC
"FIA",442,442)
1
"FIA",442,442,3.4)

"FIA",442,442,7.2)

"FIA",442,442,91)

"FIA",442,442,92)

"FIA",442,442,93)

"FIA",442,442,94)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
173^3130516
"PKG",455,22,1,"PAH",1,1,0)
^^5^5^3130516
"PKG",455,22,1,"PAH",1,1,1,0)
1. Monthly Accrual Document Cost Center issue
"PKG",455,22,1,"PAH",1,1,2,0)
 
"PKG",455,22,1,"PAH",1,1,3,0)
2. Audit/control File 442 Internal Entry number (IEN) setting
"PKG",455,22,1,"PAH",1,1,4,0)
 
"PKG",455,22,1,"PAH",1,1,5,0)
3. 1358 Adjustments causing FMS SO Document error
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCB8B")
0^4^B13408384^B13230822
"RTN","PRCB8B",1,0)
PRCB8B ;WISC/PLT-AUTO GENERATE FMS VT-DOCUMENTS ;11/12/96  15:42
"RTN","PRCB8B",2,0)
V ;;5.1;IFCAP;**71,142,173**;Oct 20, 2000;Build 9
"RTN","PRCB8B",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCB8B",4,0)
 QUIT  ;invalid entry
"RTN","PRCB8B",5,0)
 ;
"RTN","PRCB8B",6,0)
 ;.X = record id of file 2100.1 if generated, "" if fail
"RTN","PRCB8B",7,0)
 ;PRCFC data: ^1=ri of 440.7, ^2-...=date infor of prca from prcb1f
"RTN","PRCB8B",8,0)
 ;PRCID data ^1=file 2100.1 ri, ^2= document id (if regenerated)
"RTN","PRCB8B",9,0)
SV(X,PRCFC,PRCID) ;SV auto document
"RTN","PRCB8B",10,0)
 N PRCA,PRCB,PRCC,PRCDDT,PRCF,PRCQ,PRCRI,PRCSITE,PRCY,GECSFMS,PRCLACT,PRCAP,PRCDD,PRCDATA,PRCAMT
"RTN","PRCB8B",11,0)
 N PRCDI,PRCBOC,PRCEM,PRCIDL
"RTN","PRCB8B",12,0)
 N A,B,Z
"RTN","PRCB8B",13,0)
S S PRCRI(440.7)=$P(PRCFC,"^"),A=$P(PRCFC,"^",12),PRCSITE=$P(A,"-",2)
"RTN","PRCB8B",14,0)
 S PRCEM="E" I $G(PRCID)]"" S PRCRI(2100.1)=+PRCID,PRCID=$P(PRCID,"^",2)
"RTN","PRCB8B",15,0)
 I $G(PRCID)="" S A=$P(PRCFC,"^",12),PRCID=PRCSITE_$E(A,2,7),PRCID=$E(PRCID,1,3)_$TR($E(PRCID,4,7),"1234567890","ABCDEFGHIJ")_$E(PRCID,8,999)
"RTN","PRCB8B",16,0)
 I $G(PRCRI(2100.1)) D REBUILD^GECSUFM1(PRCRI(2100.1),"I",$$SEC1^PRC0C(PRCSITE),"","Edited Rejected Auto SV Document")
"RTN","PRCB8B",17,0)
 ;add entry in file 2100.1 if not rejected process
"RTN","PRCB8B",18,0)
 D:$G(PRCRI(2100.1))=""  G EXIT:PRCRI(2100.1)<1
"RTN","PRCB8B",19,0)
 . D CONTROL^GECSUFMS("I",PRCSITE,PRCID,"SV",$$SEC1^PRC0C(PRCSITE),$S(PRCEM="M":1,1:0),"","Auto SV Document")
"RTN","PRCB8B",20,0)
 . S PRCRI(2100.1)=GECSFMS("DA")
"RTN","PRCB8B",21,0)
 . QUIT
"RTN","PRCB8B",22,0)
 D SETPARAM^GECSSDCT(PRCRI(2100.1),$P(PRCFC,"^")_"/"_$P(PRCFC,"^",12))
"RTN","PRCB8B",23,0)
 ;set sv2 segment
"RTN","PRCB8B",24,0)
 S (PRCRI(440.701),PRCAMT)=0
"RTN","PRCB8B",25,0)
 F  S PRCRI(440.701)=$O(^PRCH(440.7,PRCRI(440.7),50,PRCRI(440.701))) QUIT:'PRCRI(440.701)  S PRCA=^(PRCRI(440.701),0) I $P(PRCA,"^",5)=""&($P(PRCA,"^",2)-$P(PRCA,"^",3))!$P(PRCA,"^",5) D
"RTN","PRCB8B",26,0)
 . S PRCAMT=$S($P(PRCA,"^",5)="":$P(PRCA,"^",2)-$P(PRCA,"^",3),1:$P(PRCA,"^",5))+PRCAMT
"RTN","PRCB8B",27,0)
 . QUIT
"RTN","PRCB8B",28,0)
 S PRCB=$$SV2 D SETCS^GECSSTAA(PRCRI(2100.1),PRCB)
"RTN","PRCB8B",29,0)
 ;set line segemnt
"RTN","PRCB8B",30,0)
 S PRCRI(440.701)=0 F  S PRCRI(440.701)=$O(^PRCH(440.7,PRCRI(440.7),50,PRCRI(440.701))) QUIT:'PRCRI(440.701)  S PRCA=^(PRCRI(440.701),0),PRCAMT=$S($P(PRCA,"^",5)="":$P(PRCA,"^",2)-$P(PRCA,"^",3),1:$P(PRCA,"^",5)) D:PRCAMT
"RTN","PRCB8B",31,0)
 . S PRCB=$$LINE(PRCA) D SETCS^GECSSTAA(PRCRI(2100.1),PRCB)
"RTN","PRCB8B",32,0)
 . QUIT
"RTN","PRCB8B",33,0)
 D SETSTAT^GECSSTAA(PRCRI(2100.1),"Q")
"RTN","PRCB8B",34,0)
EXIT S X=$G(PRCRI(2100.1))_"/"_PRCID
"RTN","PRCB8B",35,0)
 L -^PRCH(440.7,PRCRI(440.7))
"RTN","PRCB8B",36,0)
 QUIT
"RTN","PRCB8B",37,0)
 ;
"RTN","PRCB8B",38,0)
SV2() ;create sv2
"RTN","PRCB8B",39,0)
 N PRCDATA,A,B
"RTN","PRCB8B",40,0)
 S A=$$DATE^PRC0C($P(PRCFC,"^",10)+40,"H")
"RTN","PRCB8B",41,0)
 S A=$$DATE^PRC0C($P(A,"^",4)_"/1/"_$P(A,"^",3),"E")
"RTN","PRCB8B",42,0)
 D PIECE($P(A,"^",9),13,2),PIECE($E($P(A,"^"),3,4),12,2)
"RTN","PRCB8B",43,0)
 S A=$$DATE^PRC0C(DT,"I")
"RTN","PRCB8B",44,0)
 D PIECE("SV2",1,3),PIECE($E($P(A,"^",3),3,4),2,2),PIECE($P(A,"^",4),3,2),PIECE($P(A,"^",5),4,2)
"RTN","PRCB8B",45,0)
 D PIECE($P(A,"^",9),5,2),PIECE($E($P(A,"^"),3,4),6,2)
"RTN","PRCB8B",46,0)
 S B=$S(PRCAMT<0:-PRCAMT,1:PRCAMT)
"RTN","PRCB8B",47,0)
 D PIECE(PRCEM,7,1),PIECE($J(B,0,2),16,15)
"RTN","PRCB8B",48,0)
 QUIT PRCDATA_"^~"
"RTN","PRCB8B",49,0)
 ;
"RTN","PRCB8B",50,0)
LINE(PRCA) ;assemble line
"RTN","PRCB8B",51,0)
 N PRCDATA,PRCLIN,PRCSVA,PRCSVB,PRCREQ
"RTN","PRCB8B",52,0)
 N A,B,C
"RTN","PRCB8B",53,0)
 S PRCLIN="LIN"
"RTN","PRCB8B",54,0)
 S PRCDATA="SVA"
"RTN","PRCB8B",55,0)
 S A=$$FUND^PRC0C($P(PRCA,"/"),$P(PRCA,"/",2))
"RTN","PRCB8B",56,0)
 D DOCREQ^PRC0C(+A,"SPE","PRCREQ")
"RTN","PRCB8B",57,0)
 D PIECE($E(1000+PRCRI(440.701),2,4),2,3),PIECE("CC",3,2)
"RTN","PRCB8B",58,0)
 S A=$O(^PRCD(420.14,"UNQ",$P(PRCA,"/"),$P(PRCA,"/",2),1))
"RTN","PRCB8B",59,0)
 D PIECE($E($P(PRCA,"/",2),3,4),4,2) D:$P(PRCA,"/",2)'=A PIECE($E(A,3,4),5,2)
"RTN","PRCB8B",60,0)
 D PIECE($P(PRCA,"/"),6,6),PIECE(PRCSITE,8,7)
"RTN","PRCB8B",61,0)
 I $G(PRCREQ("CC"))'="N" D PIECE($P(PRCA,"/",5),10,7),PIECE("00",11,2)  ;PRC*5.1*173 set sub CC to '00'
"RTN","PRCB8B",62,0)
 D PIECE($P(PRCA,"/",4),12,9),PIECE($P(PRCA,"/",6),13,4)
"RTN","PRCB8B",63,0)
 D PIECE(220,23,4)
"RTN","PRCB8B",64,0)
 S PRCSVA=PRCDATA
"RTN","PRCB8B",65,0)
 S PRCDATA="SVB"
"RTN","PRCB8B",66,0)
 S A=$S(PRCAMT<0:-PRCAMT,1:PRCAMT)
"RTN","PRCB8B",67,0)
 D PIECE($J(A,0,2),2,15),PIECE($S(PRCAMT<0:"D",1:"I"),3,1),PIECE("E",5,1)
"RTN","PRCB8B",68,0)
 S PRCSVB=PRCDATA
"RTN","PRCB8B",69,0)
 QUIT PRCLIN_"^~"_PRCSVA_"^~"_PRCSVB_"^~"
"RTN","PRCB8B",70,0)
PIECE(A,B,C) ;set piece in variable PRCDATA, A-VALUE, B-PPECE #, C-LENGTH
"RTN","PRCB8B",71,0)
 S $P(PRCDATA,"^",B)=$E(A,1,C)
"RTN","PRCB8B",72,0)
 QUIT
"RTN","PRCHNPO6")
0^3^B24682336^B22810187
"RTN","PRCHNPO6",1,0)
PRCHNPO6 ;WISC/RHD-MISCELLANEOUS ROUTINES FROM P.O.ADD/EDIT 442 ;6/22/94  3:19 PM
"RTN","PRCHNPO6",2,0)
V ;;5.1;IFCAP;**129,173**;Oct 20, 2000;Build 9
"RTN","PRCHNPO6",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCHNPO6",4,0)
 ;
"RTN","PRCHNPO6",5,0)
EN1 ;INPUT TRANSFORM FOR FILE 442, P.O.DATE #.1
"RTN","PRCHNPO6",6,0)
 Q:'$D(^PRC(442,DA,0))  Q:'$P(^(0),U,3)  S PRCHSAVX=X,PRC("FY")=X S:'$D(PRC("SITE")) PRC("SITE")=+^(0) S X=$P(^(0),U,3)
"RTN","PRCHNPO6",7,0)
 D EN1^PRCHNPO5 S:$D(X) $P(^PRC(442,DA,0),U,4)=PRC("APP")
"RTN","PRCHNPO6",8,0)
 S X=PRCHSAVX K PRCHSAVX
"RTN","PRCHNPO6",9,0)
 Q
"RTN","PRCHNPO6",10,0)
 ;
"RTN","PRCHNPO6",11,0)
EN2 ;SCREEN--P.O.#['X' (FRESH FOOD) OR 'Z' (CASCA)--INVOICE ADDRESS="FISCAL", P.O.#['C' (CERT.INV.)--MOP='CERT.INV.', INV.ADDR.="FISCAL", IMPREST FUNDS--INV.ADDR.="".
"RTN","PRCHNPO6",12,0)
 ;PRC*5.1*129 modifies INVOICE ADDRESS default from 'FMS' to 'VA FSC'
"RTN","PRCHNPO6",13,0)
 S Z1=$E($P(^PRC(442,DA,0),"-",2),1,2),PRCHN("INV")="VA FSC",Z2=+$P(^(0),U,2) I $D(^PRCD(442.5,Z2,0)) S PRCHN("MP")=$P(^(0),U,3) I PRCHN("MP")=12 S Z1="IF",PRCHN("INV")="" G EN20
"RTN","PRCHNPO6",14,0)
 I (Z1["X")!(Z1["Z") S PRCHN("INV")="FISCAL" K Z1,Z2 Q
"RTN","PRCHNPO6",15,0)
 I Z1'["C" K Z1,Z2 Q
"RTN","PRCHNPO6",16,0)
 S PRCHN("MP")=2,$P(^PRC(442,DA,0),U,2)=2,^PRC(442,"F",2,DA)="",Z2=2,PRCHN("INV")="FISCAL"
"RTN","PRCHNPO6",17,0)
EN20 W !,"Method of Processing="_$P(^PRCD(442.5,Z2,0),U,1) K Z1,Z2
"RTN","PRCHNPO6",18,0)
 Q
"RTN","PRCHNPO6",19,0)
 ;
"RTN","PRCHNPO6",20,0)
EN3 ;SCREEN FCP--CALLED FROM PRCHNPO3
"RTN","PRCHNPO6",21,0)
 G:'$D(PRCHPO) FALSE S Z0=$E($P(^PRC(442,PRCHPO,0),"-",2),1,2),Z1=+$P(^PRCS(410,Y,0),"-",4)
"RTN","PRCHNPO6",22,0)
 ;
"RTN","PRCHNPO6",23,0)
EN4 ;SCREEN FCP FOR SPECIAL P.O.NUMBERS--Z0=1ST 2 DIGITS OF P.O.NO.,Z1=FCP
"RTN","PRCHNPO6",24,0)
 G:(Z0["H")&('$D(^PRC(420,"AD",1,PRC("SITE"),Z1))) FALSE
"RTN","PRCHNPO6",25,0)
 I Z0["G",$D(^PRC(411,+PRC("SITE"),0)),$D(^PRC(411.2,+$P(^(0),U,7),0)),"^DEPOT^VACO^DDC^"[("^"_$P(^(0),U,1)_"^") G TRUE
"RTN","PRCHNPO6",26,0)
 G:(Z0["G")&('$D(^PRC(420,"AD",2,PRC("SITE"),Z1)))&('$D(^PRC(420,"AD",3,PRC("SITE"),Z1)))&('$D(^PRC(420,"AD",4,PRC("SITE"),Z1))) FALSE
"RTN","PRCHNPO6",27,0)
 G:(Z0["Z")&('$D(^PRC(420,"AD",3,PRC("SITE"),Z1)))&('$D(^PRC(420,"AD",4,PRC("SITE"),Z1))) FALSE
"RTN","PRCHNPO6",28,0)
 I $G(PRCHPC)!$G(PRCHDELV) I '$D(^PRC(420,"C",DUZ,PRC("SITE"),Z1)) G FALSE
"RTN","PRCHNPO6",29,0)
 ;
"RTN","PRCHNPO6",30,0)
TRUE I 1 Q
"RTN","PRCHNPO6",31,0)
 ;
"RTN","PRCHNPO6",32,0)
FALSE I 0
"RTN","PRCHNPO6",33,0)
 Q
"RTN","PRCHNPO6",34,0)
 ;
"RTN","PRCHNPO6",35,0)
EN5 ;FILE #442, FIELD #1 (FCP) ONLINE HELP
"RTN","PRCHNPO6",36,0)
 S Z1=Y D EN4 ;S FLAG=1
"RTN","PRCHNPO6",37,0)
 Q
"RTN","PRCHNPO6",38,0)
 ;
"RTN","PRCHNPO6",39,0)
EST ;Find Line Item # for Field #13.1
"RTN","PRCHNPO6",40,0)
 S N="" F PRCHESTA=1:1 S N=$O(^PRC(442,PRCHPO,2,"B",N)) Q:'N
"RTN","PRCHNPO6",41,0)
 S N=0 F PRCHDIS=1:1 S N=$O(^PRC(442,PRCHPO,3,N)) Q:'N
"RTN","PRCHNPO6",42,0)
 S PRCHDIS=PRCHDIS+PRCHESTA-1,$P(^PRC(442,PRCHPO,0),U,18)=PRCHDIS,$P(^(0),U,14)=PRCHDIS
"RTN","PRCHNPO6",43,0)
 K N,PRCHESTA,PRCHDIS
"RTN","PRCHNPO6",44,0)
 Q
"RTN","PRCHNPO6",45,0)
 ;
"RTN","PRCHNPO6",46,0)
EN7 ;FILE 442, PKG.MULT. #3.1
"RTN","PRCHNPO6",47,0)
 D VEN^PRCHNPO5 Q:'$D(X)!($P(^PRC(442,DA(1),2,DA,0),U,5)="")
"RTN","PRCHNPO6",48,0)
 S:'$D(PRC("SITE")) PRC("SITE")=+^PRC(442,DA(1),0) S PRCHCV=+$P(^PRC(442,DA(1),1),U,1),PRCHCI=+$P(^(2,DA,0),U,5),PRCHCPO=DA(1) D EN7^PRCHCRD1
"RTN","PRCHNPO6",49,0)
 Q
"RTN","PRCHNPO6",50,0)
 ;
"RTN","PRCHNPO6",51,0)
EN8 ;FILE 442, P.O.NO. .01  CALLED BY THE SCREEN ON THE .01 FIELD
"RTN","PRCHNPO6",52,0)
 ;PRC*5.1*173 Will insure that the next IEN used is not below 20,000,000
"RTN","PRCHNPO6",53,0)
 ;            Start back at closest ien to last realistic ien using for 
"RTN","PRCHNPO6",54,0)
 ;            loop check to look for last used ien.
"RTN","PRCHNPO6",55,0)
 Q:'$D(X)  Q:$D(PRCHNEW)&$D(^PRC(442,"B",X))
"RTN","PRCHNPO6",56,0)
 N PRCEN442
"RTN","PRCHNPO6",57,0)
 ;PRC*5.1*129 modifies SACC lock violations
"RTN","PRCHNPO6",58,0)
 L +^PRC(442,0):$S($G(DILOCKTM)>5:DILOCKTM,1:5) I '$T W $C(7),"ANOTHER USER IS IS EDITING FILE 442 CONTROL NODE! Please retry in a minute." K X Q
"RTN","PRCHNPO6",59,0)
 S PRCEN442=$P(^PRC(442,0),"^",3)-2
"RTN","PRCHNPO6",60,0)
 I PRCEN442<20000000 D  S:PRCEN442=20000000 PRCEN442=99999999
"RTN","PRCHNPO6",61,0)
 . F I=90000000:-10000000:20000000 I $O(^PRC(442,I))-I>1000 S PRCEN442=$O(^PRC(442,I)) Q
"RTN","PRCHNPO6",62,0)
 F PRCEN442=PRCEN442:-2 I '$D(^PRC(442,PRCEN442)) L +^PRC(442,PRCEN442):$S($D(DILOCKTM):DILOCKTM,1:3) Q:$T
"RTN","PRCHNPO6",63,0)
 L -^PRC(442,0)
"RTN","PRCHNPO6",64,0)
 I PRCEN442'>0 K X
"RTN","PRCHNPO6",65,0)
 E  S DINUM=PRCEN442
"RTN","PRCHNPO6",66,0)
 L -^PRC(442,PRCEN442)
"RTN","PRCHNPO6",67,0)
 Q
"RTN","PRCHNPO6",68,0)
 ;
"RTN","PRCHNPO6",69,0)
EN9 ;FILE 442, MAX.ORD.QTY.#9.6
"RTN","PRCHNPO6",70,0)
 D VEN^PRCHNPO5 Q:'$D(X)!($P(^PRC(442,DA(1),2,DA,0),U,5)="")
"RTN","PRCHNPO6",71,0)
 S:'$D(PRC("SITE")) PRC("SITE")=+^PRC(442,DA(1),0) S PRCHCV=+$P(^PRC(442,DA(1),1),U,1),PRCHCI=+$P(^(2,DA,0),U,5),PRCHCPO=DA(1) D EN9^PRCHCRD1
"RTN","PRCHNPO6",72,0)
 Q
"RTN","PRCHNPO6",73,0)
 ;
"RTN","PRCHNPO6",74,0)
 ; ER-ER3 ARE CALLED FROM PRCHNPO1
"RTN","PRCHNPO6",75,0)
ER W !," ** Error in Discount ",PRCH,", item ",PRCHN," has a unit cost of zero ",$C(7) S PRCHER=""
"RTN","PRCHNPO6",76,0)
 Q
"RTN","PRCHNPO6",77,0)
 ;
"RTN","PRCHNPO6",78,0)
ER1 W !," ** Error in Discount ",PRCH,", item ",PRCHN," has been changed. Discount will be deleted",!?4,"and must be re-edited!",$C(7) S PRCHER="",DR="14///^S X=PRCH",DR(2,442.03)=".01///@" D ^DIE K DR
"RTN","PRCHNPO6",79,0)
 Q
"RTN","PRCHNPO6",80,0)
 ;
"RTN","PRCHNPO6",81,0)
ER2 W !," Type Code is undefined.",$C(7) K PRCHPO
"RTN","PRCHNPO6",82,0)
 Q
"RTN","PRCHNPO6",83,0)
 ;
"RTN","PRCHNPO6",84,0)
ER3 W !,$S('PRCHDT:"Breakout Code is undefined.",1:"Socioeconomic Group (FY89) not defined in Vendor file."),$C(7) K PRCHPO
"RTN","PRCHNPO6",85,0)
 Q
"RTN","PRCHNPO6",86,0)
 ;
"RTN","PRCHNPO6",87,0)
SPRMK ;FORMAT & DISPLAY REMARKS FROM REQUEST TO PO
"RTN","PRCHNPO6",88,0)
 Q:'$D(^PRCS(410,PRCHSY,"RM"))  K ^UTILITY($J,"W")
"RTN","PRCHNPO6",89,0)
 W !,"2237 Special Remarks: " S U="^",PRCHZZ=0,DIWL=1,DIWR=78,DIWF="W"
"RTN","PRCHNPO6",90,0)
 F PRCHJJ=0:0 S PRCHZZ=$O(^PRCS(410,PRCHSY,"RM",PRCHZZ)) Q:'PRCHZZ  I $D(^(PRCHZZ,0)) S X=^(0) D DIWP^PRCUTL($G(DA)),^DIWW
"RTN","PRCHNPO6",91,0)
 ;
"RTN","PRCHNPO6",92,0)
SP1 K PRCHJJ W !,"Would you like to transfer the Special Remarks to the New P.O. Comments" S %=1 D YN^DICN
"RTN","PRCHNPO6",93,0)
 I %=0 W !,"Enter 'Y' to have the Special Remarks added to the end of the P.O. Comments.",! G SP1
"RTN","PRCHNPO6",94,0)
 G END:%'=1 S:'$D(^PRC(442,D0,4,0)) ^(0)="^^0^0^"_DT S PRCHNN=$P(^(0),U,3),PRCHX=0
"RTN","PRCHNPO6",95,0)
 F I=0:0 S PRCHX=$O(^PRCS(410,PRCHSY,"RM",PRCHX)) Q:'PRCHX  I $D(^(PRCHX,0)) S PRCHNN=PRCHNN+1,^PRC(442,D0,4,PRCHNN,0)=^(0)
"RTN","PRCHNPO6",96,0)
 S ^PRC(442,D0,4,0)="^^"_PRCHNN_U_PRCHNN_U_DT
"RTN","PRCHNPO6",97,0)
 ;
"RTN","PRCHNPO6",98,0)
END K PRCHNN,PRCHX,PRCHZZ,DIWL,DIWR,DISF,I,%
"RTN","PRCHNPO6",99,0)
 Q
"VER")
8.0^22.0
"^DD",410,410,20,0)
COMMITTED (ESTIMATED) COST^RNJ10,2X^^4;1^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N1"."2N)!(X>9999999.99)!(X<0) X I $D(X) W "  $ ",$J(X,0,2)
"^DD",410,410,20,1,0)
^.1^^-1
"^DD",410,410,20,1,1,0)
410^AH^MUMPS
"^DD",410,410,20,1,1,1)
Q:$P(^PRCS(410,DA,4),U,3)'=""  S $P(^(4),"^",8)=X D TRANS^PRCSES
"^DD",410,410,20,1,1,2)
Q:$P(^PRCS(410,DA,4),U,3)'=""  S $P(^(4),"^",8)="" D TRANK^PRCSES
"^DD",410,410,20,1,1,"%D",0)
^^2^2^2930623^
"^DD",410,410,20,1,1,"%D",1,0)
This cross reference is used to set the committed
"^DD",410,410,20,1,1,"%D",2,0)
(estimated) cost.
"^DD",410,410,20,3)
Type a Dollar Amount between 0 and  9999999, 2 Decimal Digits.
"^DD",410,410,20,21,0)
^^2^2^2910514^
"^DD",410,410,20,21,1,0)
This is the estimated amount of the committed cost of
"^DD",410,410,20,21,2,0)
the requested item(s).
"^DD",410,410,20,"DT")
3130516
"^DD",410,410,25,0)
ADJUSTMENT $ AMOUNT^RNJ10,2X^^4;6^S:X["$" X=$P(X,"$",2) S:X["CR" X=-X K:+X'=X&(X'?."-".N1"."2N)!(X>9999999.99)!(X<-9999999.99) X I $D(X) W "  $ ",$J(X,0,2)
"^DD",410,410,25,1,0)
^.1^^-1
"^DD",410,410,25,1,2,0)
410^AJ^MUMPS
"^DD",410,410,25,1,2,1)
S $P(^PRCS(410,DA,4),"^",3)=X,$P(^(4),"^",8)=X D TRANS^PRCSES I $P(^PRCS(410,DA,4),"^",14)="Y" S X=$P(^(4),"^",8),$P(^(4),"^",3)="" D TRANK1^PRCSEZ
"^DD",410,410,25,1,2,2)
N PRCAAMT S PRCAAMT=X,$P(^PRCS(410,DA,4),"^",3)="",$P(^(4),"^",8)="" D TRANK^PRCSES I $P(^PRCS(410,DA,4),"^",14)="Y" S X=PRCAAMT D TRANS1^PRCSES
"^DD",410,410,25,1,2,"%D",0)
^^2^2^2970224^^^^
"^DD",410,410,25,1,2,"%D",1,0)
This cross reference is used to set the adjustment dollar
"^DD",410,410,25,1,2,"%D",2,0)
amount.
"^DD",410,410,25,1,2,"DT")
2970224
"^DD",410,410,25,3)
Type a Dollar Amount between -9999999 and 9999999, 2 Decimal Digits.
"^DD",410,410,25,21,0)
^^2^2^2940707^^
"^DD",410,410,25,21,1,0)
This is the adjustment dollar amount for this obligation
"^DD",410,410,25,21,2,0)
transaction.
"^DD",410,410,25,"DT")
3130516
"^DD",410,410,27,0)
TRANSACTION $ AMOUNT^NJ10,2X^^4;8^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?."-".N1"."2N)!(X>9999999.99)!(X<-9999999.99) X I $D(X) W "  $ ",$J(X,0,2)
"^DD",410,410,27,1,0)
^.1
"^DD",410,410,27,1,1,0)
410^AF^MUMPS
"^DD",410,410,27,1,1,1)
D TRANS^PRCSES
"^DD",410,410,27,1,1,2)
D TRANK^PRCSES
"^DD",410,410,27,1,1,"%D",0)
^^2^2^2930623^^
"^DD",410,410,27,1,1,"%D",1,0)
This cross reference is used to set the dollar
"^DD",410,410,27,1,1,"%D",2,0)
amount for the transaction.
"^DD",410,410,27,3)
Type a Dollar Amount between -9999999 and 9999999, 2 Decimal Digits.
"^DD",410,410,27,9)
^
"^DD",410,410,27,21,0)
^^1^1^2910514^
"^DD",410,410,27,21,1,0)
This is the transaction dollar amount.
"^DD",410,410,27,"DT")
3130515
"^DD",442,442,3.4,0)
SUBAMOUNT1^NJ9,2^^0;7^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N1"."2N)!(X>999999999.99)!(X<0) X
"^DD",442,442,3.4,3)
Type a Dollar Amount between 0 and  999999999, 2 Decimal Digits
"^DD",442,442,3.4,21,0)
^.001^1^1^3130425^^
"^DD",442,442,3.4,21,1,0)
This is the amount charged to the first subaccount.
"^DD",442,442,3.4,"DT")
3130429
"^DD",442,442,7.2,0)
ESTIMATED COST^NJ10,2^^0;11^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999.99)!(X<0) X
"^DD",442,442,7.2,3)
Type a Dollar Amount between 0 and 9999999, 2 Decimal Digits.
"^DD",442,442,7.2,21,0)
^^1^1^2940510^^
"^DD",442,442,7.2,21,1,0)
This is the estimated cost.
"^DD",442,442,7.2,"DT")
2940510
"^DD",442,442,91,0)
TOTAL AMOUNT^RNJ10,2^^0;15^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999999.99)!(X<0) X
"^DD",442,442,91,1,0)
^.1^^0
"^DD",442,442,91,3)
 (On P.O.=Total Amt.-Discounts+Ship/Handling  On 1358=Amt.not liquidated).  Type a Dollar Amount between 0 and 999999999, 2 Decimal Digits.
"^DD",442,442,91,5,1,0)
442.1^.01^1
"^DD",442,442,91,9)
^
"^DD",442,442,91,21,0)
^^1^1^2910517^
"^DD",442,442,91,21,1,0)
This is the total amount of the purchase order.
"^DD",442,442,91,"DT")
3050215
"^DD",442,442,92,0)
NET AMOUNT^NJ10,2^^0;16^S:X["$" X=$P(X,"$",2) K:X'?."-".N.1".".2N!(X>999999999.99)!(X<-999999999.99) X
"^DD",442,442,92,3)
(on P.O.=Total Amount-discounts-prompt payment+ship/handling.  1358's=Total Obligated Amount)  Type a Dollar Amount between -999999999 and 999999999, 2 Decimal Digits.
"^DD",442,442,92,21,0)
^^1^1^2910517^
"^DD",442,442,92,21,1,0)
This is the net amount of the purchase order.
"^DD",442,442,92,"DT")
3130429
"^DD",442,442,93,0)
LIQUIDATED AMOUNT^NJ10,2^^0;17^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999999.99)!(X<0) X
"^DD",442,442,93,3)
(On P.O.=Amount Received.  On 1358=Amount of Liquidation made against the 1358).  Type a Dollar Amount between 0 and 999999999, 2 Decimal Digits.
"^DD",442,442,93,21,0)
^^1^1^2910517^
"^DD",442,442,93,21,1,0)
This is the liquidated amount.
"^DD",442,442,93,"DT")
3130429
"^DD",442,442,94,0)
ACTUAL 1358 BALANCE^NJ12,2^^8;1^S:X["$" X=$P(X,"$",2) K:X'?."-".N.1".".2N!(X>999999999.99)!(X<-999999999.99) X
"^DD",442,442,94,3)
Type a Dollar Amount between -999999999 and 999999999, 2 Decimal Digits.
"^DD",442,442,94,21,0)
^^1^1^2930408^
"^DD",442,442,94,21,1,0)
This is the actual 1358 balance.
"^DD",442,442,94,"DT")
2911023
"BLD",7216,6)
^155
**END**
**END**
