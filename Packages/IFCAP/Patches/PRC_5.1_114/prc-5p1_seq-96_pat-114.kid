Released PRC*5.1*114 SEQ #96
Extracted from mail message
**KIDS**:PRC*5.1*114^

**INSTALL NAME**
PRC*5.1*114
"BLD",5341,0)
PRC*5.1*114^IFCAP^0^3080123^y
"BLD",5341,1,0)
^^10^10^3071105^^
"BLD",5341,1,1,0)
1. Involves the addition of a new Federal Supply Classification (FSC) 
"BLD",5341,1,2,0)
   Code to the FEDERAL SUPPLY CLASSIFICATION (#441.2) file.
"BLD",5341,1,3,0)
 
"BLD",5341,1,4,0)
2. A correction to an improper reference to the Vendor Product Number
"BLD",5341,1,5,0)
   during the transmission of the Electronic Request for Quotation (RFQ).
"BLD",5341,1,6,0)
 
"BLD",5341,1,7,0)
3. The creation of a new option that cleans out all record types in 
"BLD",5341,1,8,0)
   CALM/LOG CODE SHEET (#423) file and CALM/LOG TRANSMISSION
"BLD",5341,1,9,0)
   RECORD (#421.2) file for a given time frame.  This is needed to 
"BLD",5341,1,10,0)
   cleanup old data.  
"BLD",5341,4,0)
^9.64PA^^
"BLD",5341,6.3)
4
"BLD",5341,"ABPKG")
n
"BLD",5341,"INI")
START^PRCIN07
"BLD",5341,"INID")
^^y
"BLD",5341,"KRN",0)
^9.67PA^8989.52^19
"BLD",5341,"KRN",.4,0)
.4
"BLD",5341,"KRN",.401,0)
.401
"BLD",5341,"KRN",.402,0)
.402
"BLD",5341,"KRN",.403,0)
.403
"BLD",5341,"KRN",.5,0)
.5
"BLD",5341,"KRN",.84,0)
.84
"BLD",5341,"KRN",3.6,0)
3.6
"BLD",5341,"KRN",3.8,0)
3.8
"BLD",5341,"KRN",9.2,0)
9.2
"BLD",5341,"KRN",9.8,0)
9.8
"BLD",5341,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5341,"KRN",9.8,"NM",1,0)
PRCFACPS^^0^B15294807
"BLD",5341,"KRN",9.8,"NM",2,0)
PRCFALOG^^0^B1965582
"BLD",5341,"KRN",9.8,"NM",3,0)
PRCHQ4^^0^B41872556
"BLD",5341,"KRN",9.8,"NM",4,0)
PRCIN07^^0^B3425624
"BLD",5341,"KRN",9.8,"NM","B","PRCFACPS",1)

"BLD",5341,"KRN",9.8,"NM","B","PRCFALOG",2)

"BLD",5341,"KRN",9.8,"NM","B","PRCHQ4",3)

"BLD",5341,"KRN",9.8,"NM","B","PRCIN07",4)

"BLD",5341,"KRN",19,0)
19
"BLD",5341,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",5341,"KRN",19,"NM",1,0)
PRCHPM CS PURGE ALL^^0
"BLD",5341,"KRN",19,"NM",2,0)
PRCHPM CS BATCH MANAGEMENT^^0
"BLD",5341,"KRN",19,"NM",3,0)
PRCHPM CS BATCH & PRINT^^0
"BLD",5341,"KRN",19,"NM",4,0)
PRCHPM CS MODIFY BATCH PRI.^^0
"BLD",5341,"KRN",19,"NM",5,0)
PRCHPM CS REPRINT BATCH^^0
"BLD",5341,"KRN",19,"NM",6,0)
PRCHPM CS TRANSMISSION MENU^^0
"BLD",5341,"KRN",19,"NM",7,0)
PRCHPM CS PURGE^^0
"BLD",5341,"KRN",19,"NM","B","PRCHPM CS BATCH & PRINT",3)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS BATCH MANAGEMENT",2)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS MODIFY BATCH PRI.",4)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS PURGE",7)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS PURGE ALL",1)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS REPRINT BATCH",5)

"BLD",5341,"KRN",19,"NM","B","PRCHPM CS TRANSMISSION MENU",6)

"BLD",5341,"KRN",19.1,0)
19.1
"BLD",5341,"KRN",101,0)
101
"BLD",5341,"KRN",409.61,0)
409.61
"BLD",5341,"KRN",771,0)
771
"BLD",5341,"KRN",870,0)
870
"BLD",5341,"KRN",8989.51,0)
8989.51
"BLD",5341,"KRN",8989.52,0)
8989.52
"BLD",5341,"KRN",8994,0)
8994
"BLD",5341,"KRN","B",.4,.4)

"BLD",5341,"KRN","B",.401,.401)

"BLD",5341,"KRN","B",.402,.402)

"BLD",5341,"KRN","B",.403,.403)

"BLD",5341,"KRN","B",.5,.5)

"BLD",5341,"KRN","B",.84,.84)

"BLD",5341,"KRN","B",3.6,3.6)

"BLD",5341,"KRN","B",3.8,3.8)

"BLD",5341,"KRN","B",9.2,9.2)

"BLD",5341,"KRN","B",9.8,9.8)

"BLD",5341,"KRN","B",19,19)

"BLD",5341,"KRN","B",19.1,19.1)

"BLD",5341,"KRN","B",101,101)

"BLD",5341,"KRN","B",409.61,409.61)

"BLD",5341,"KRN","B",771,771)

"BLD",5341,"KRN","B",870,870)

"BLD",5341,"KRN","B",8989.51,8989.51)

"BLD",5341,"KRN","B",8989.52,8989.52)

"BLD",5341,"KRN","B",8994,8994)

"BLD",5341,"QUES",0)
^9.62^^
"BLD",5341,"REQB",0)
^9.611^1^1
"BLD",5341,"REQB",1,0)
PRC*5.1*63^2
"BLD",5341,"REQB","B","PRC*5.1*63",1)

"INI")
START^PRCIN07
"KRN",19,10411,-1)
0^3
"KRN",19,10411,0)
PRCHPM CS BATCH & PRINT^Batch and Print Code Sheet (LOG/GSA/DLA)^^R^^^^^^^^
"KRN",19,10411,1,0)
3
"KRN",19,10411,1,1,0)
This option allows PPM to print the actual LOG, GSA & DLA code sheets
"KRN",19,10411,1,2,0)
which have been created and signed, but not yet released to Austin.
"KRN",19,10411,1,3,0)
This is the final step that must be done before the actual transmission.
"KRN",19,10411,25)
BATCH^PRCFALOG
"KRN",19,10411,"U")
BATCH AND PRINT CODE SHEET (LO
"KRN",19,10439,-1)
0^4
"KRN",19,10439,0)
PRCHPM CS MODIFY BATCH PRI.^Modify Batch Priority (LOG/GSA/DLA)^^R^^^^^^^^
"KRN",19,10439,1,0)
^^3^3^2890524^^^^
"KRN",19,10439,1,1,0)
This option allows a PPM person to assign a higher (2) or
"KRN",19,10439,1,2,0)
lower (4) batch priority to a code sheet.  This can be used to insure 
"KRN",19,10439,1,3,0)
that a certain code sheet will be transmitted ahead of or after others.
"KRN",19,10439,25)
MBP^PRCFALOG
"KRN",19,10439,"U")
MODIFY BATCH PRIORITY (LOG/GSA
"KRN",19,10440,-1)
0^5
"KRN",19,10440,0)
PRCHPM CS REPRINT BATCH^Reprint a Batch (LOG/GSA/DLA)^^R^^^^^^^^
"KRN",19,10440,1,0)
^^2^2^2890524^^^^
"KRN",19,10440,1,1,0)
This option allows the user to reprint selected batches or all batches
"KRN",19,10440,1,2,0)
contained within a transmission number.
"KRN",19,10440,25)
REPRINT^PRCFALOG
"KRN",19,10440,99)
55626,31414
"KRN",19,10440,"U")
REPRINT A BATCH (LOG/GSA/DLA)
"KRN",19,10441,-1)
0^7
"KRN",19,10441,0)
PRCHPM CS PURGE^Purge Code Sheets (LOG/GSA/DLA)^^R^^PRCHPM CS PURGE CODE SHEETS^^^^^^
"KRN",19,10441,1,0)
^^3^3^2930317^^^^
"KRN",19,10441,1,1,0)
This option allows the user to delete LOG/GSA/DLA code sheets from the
"KRN",19,10441,1,2,0)
code sheet file, which have been transmitted to Austin or DLA and which
"KRN",19,10441,1,3,0)
exceed a selectable number of days in age.
"KRN",19,10441,25)
PURGE^PRCFALOG
"KRN",19,10441,99)
55626,32006
"KRN",19,10441,"U")
PURGE CODE SHEETS (LOG/GSA/DLA
"KRN",19,10446,-1)
0^2
"KRN",19,10446,0)
PRCHPM CS BATCH MANAGEMENT^Batch Management Menu (LOG/GSA/DLA)^^M^^^^^^^^
"KRN",19,10446,1,0)
^^3^3^2890524^
"KRN",19,10446,1,1,0)
Options allowing user to print and transmit LOG, GSA and DLA code
"KRN",19,10446,1,2,0)
sheets to Austin, and to perform other tasks needed to maintain and
"KRN",19,10446,1,3,0)
track the batches.
"KRN",19,10446,10,0)
^19.01IP^6^6
"KRN",19,10446,10,1,0)
10411^^5
"KRN",19,10446,10,1,"^")
PRCHPM CS BATCH & PRINT
"KRN",19,10446,10,2,0)
10439^^10
"KRN",19,10446,10,2,"^")
PRCHPM CS MODIFY BATCH PRI.
"KRN",19,10446,10,3,0)
10440^^15
"KRN",19,10446,10,3,"^")
PRCHPM CS REPRINT BATCH
"KRN",19,10446,10,4,0)
10447^^30
"KRN",19,10446,10,4,"^")
PRCHPM CS TRANSMISSION MENU
"KRN",19,10446,10,5,0)
10441^^25
"KRN",19,10446,10,5,"^")
PRCHPM CS PURGE
"KRN",19,10446,10,6,0)
12209^^26
"KRN",19,10446,10,6,"^")
PRCHPM CS PURGE ALL
"KRN",19,10446,99)
61004,56251
"KRN",19,10446,"U")
BATCH MANAGEMENT MENU (LOG/GSA
"KRN",19,10447,-1)
0^6
"KRN",19,10447,0)
PRCHPM CS TRANSMISSION MENU^Code Sheet Transmission Menu (LOG/GSA/DLA)^^M^^^^^^^^
"KRN",19,10447,1,0)
^^2^2^2940720^
"KRN",19,10447,1,1,0)
This is a menu option which provides several other options for the batching
"KRN",19,10447,1,2,0)
and transmission of LOG/GSA/DLA Code Sheets to Austin.
"KRN",19,10447,10,0)
^19.01IP^5^5
"KRN",19,10447,99)
58366,84290
"KRN",19,10447,"U")
CODE SHEET TRANSMISSION MENU (
"KRN",19,12209,-1)
0^1
"KRN",19,12209,0)
PRCHPM CS PURGE ALL^Purge All Code Sheets^^R^^PRCHPM CS PURGE CODE SHEETS^^^^^^IFCAP
"KRN",19,12209,1,0)
^^3^3^3060927^
"KRN",19,12209,1,1,0)
This option allows the user to delete all code sheets from the code sheet 
"KRN",19,12209,1,2,0)
file, which have been transmitted to Austin or DLA and which exceed a 
"KRN",19,12209,1,3,0)
selectable number of days in age.
"KRN",19,12209,25)
PURGE2^PRCFALOG
"KRN",19,12209,"U")
PURGE ALL CODE SHEETS
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
114^3080123
"PKG",455,22,1,"PAH",1,1,0)
^^10^10^3080123
"PKG",455,22,1,"PAH",1,1,1,0)
1. Involves the addition of a new Federal Supply Classification (FSC) 
"PKG",455,22,1,"PAH",1,1,2,0)
   Code to the FEDERAL SUPPLY CLASSIFICATION (#441.2) file.
"PKG",455,22,1,"PAH",1,1,3,0)
 
"PKG",455,22,1,"PAH",1,1,4,0)
2. A correction to an improper reference to the Vendor Product Number
"PKG",455,22,1,"PAH",1,1,5,0)
   during the transmission of the Electronic Request for Quotation (RFQ).
"PKG",455,22,1,"PAH",1,1,6,0)
 
"PKG",455,22,1,"PAH",1,1,7,0)
3. The creation of a new option that cleans out all record types in 
"PKG",455,22,1,"PAH",1,1,8,0)
   CALM/LOG CODE SHEET (#423) file and CALM/LOG TRANSMISSION
"PKG",455,22,1,"PAH",1,1,9,0)
   RECORD (#421.2) file for a given time frame.  This is needed to 
"PKG",455,22,1,"PAH",1,1,10,0)
   cleanup old data.  
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PRCFACPS")
0^1^B15294807^B14787797
"RTN","PRCFACPS",1,0)
PRCFACPS ;WISC@ALTOONA/CTB/DL-PURGE CODE SHEET CONTINUATION ;1/29/98 1300
"RTN","PRCFACPS",2,0)
V ;;5.1;IFCAP;**114**;Oct 20, 2000;Build 4
"RTN","PRCFACPS",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCFACPS",4,0)
DQ ;;PURGE CODE SHEETS AND TRANSMISSION RECORDS
"RTN","PRCFACPS",5,0)
 D:$D(ZTQUEUED) KILL^%ZTLOAD
"RTN","PRCFACPS",6,0)
 S PRCFNAME=$S(PRCFASYS["CLMCLIRRLOG":"FEE/FEN, Receiving Reports & LOG",PRCFASYS["CLM":"FEE/FEN",PRCFASYS["ISM":"ISM",PRCFASYS["IRS":"IRS",1:"LOG")
"RTN","PRCFACPS",7,0)
 L +^PRCF(423,0):5 I '$T S X="Code Sheet file unavailable - File lock timeout.*" D MSG^PRCFQ Q
"RTN","PRCFACPS",8,0)
 W:$D(IOF) @IOF W PRCFNAME_" CODE SHEET & TRANSMISSION RECORD DELETION TRANSCRIPT" D NOW^PRCFQ W ?IOM-$L(%X),%X
"RTN","PRCFACPS",9,0)
 S $P(LINE,"-",IOM-2)="" W !,LINE,!!,"Option queued by:  ",$S($D(DUZ):$P(^VA(200,DUZ,0),"^"),1:"Menu Manager"),!,"Date/Time queued:  ",PRCFA("QTIME"),!,"From Device:  ",PRCFA("QION")
"RTN","PRCFACPS",10,0)
 W !!!,PRCFNAME_" code sheet deletion has begun for station ",PRC("SITE"),!,"I am deleting all "_PRCFNAME_" code sheets created or transmitted on or before ",PRCFA("DATE"),".",!
"RTN","PRCFACPS",11,0)
 S (DA,J)=0,U="^" F K=1:1 S DA=$O(^PRCF(423,DA)) Q:'DA  D KILLCS
"RTN","PRCFACPS",12,0)
 W !!,"Done - deleted ",J," ",PRCFNAME," code sheets.  ",$P(^PRCF(423,0),"^",4)," code sheets remaining."
"RTN","PRCFACPS",13,0)
 W !!,"I will now begin cleaning up the Log Transmission Record file.",!,"I will delete all "_PRCFNAME_" batches and transmission records created on or before ",PRCFA("DATE"),!
"RTN","PRCFACPS",14,0)
 S (DA,JX)=0,DIK="^PRCF(421.2," F K=1:1 S DA=$O(^PRCF(421.2,DA)) Q:'DA  I $D(^(DA,0)) S X=^(0) I +$P(X,"-",2)>0!(PRCFASYS[$P(X,"-",2)),$P(X,"^",10)<PRCFA("KDATE"),(+X=PRC("SITE")!(+X="")) D ^DIK S JX=JX+1 W:JX#50=0 "."
"RTN","PRCFACPS",15,0)
 W !!,"Done - Deleted ",JX," Batch and Transmission records.  ",$P(^PRCF(421.2,0),"^",4)," transmission/batch records remaining.",!! Q
"RTN","PRCFACPS",16,0)
XREF ;CLEAN UP OF XREF'S IN FILE 423
"RTN","PRCFACPS",17,0)
 S XREF="A" F ZI=1:1 S XREF=$O(^PRCF(423,XREF)) Q:XREF=""  S VAL="" F ZJ=1:1 S VAL=$O(^PRCF(423,XREF,VAL)) Q:VAL=""  S DA=0 F ZK=1:1 S DA=$O(^PRCF(423,XREF,VAL,DA)) Q:DA=""  K:'$D(^PRCF(423,DA)) ^PRCF(423,XREF,VAL,DA)
"RTN","PRCFACPS",18,0)
 S XREF="C",VAL="" F ZJ=1:1 S VAL=$O(^PRCF(423,XREF,VAL)) Q:VAL=""  I VAL["^" S DA=0,VAL1=$P(VAL,"^") F ZK=1:1 S DA=$O(^PRCF(423,XREF,VAL,DA)) Q:DA=""  K ^PRCF(423,XREF,VAL,DA) S ^PRCF(423,XREF,VAL1,DA)=""
"RTN","PRCFACPS",19,0)
 K XREF,VAL,DA,ZI,ZJ,ZK Q
"RTN","PRCFACPS",20,0)
KILLCS S ZERO=$S($D(^PRCF(423,DA,0)):^(0),1:""),TRANS=$S($D(^("TRANS")):^("TRANS"),1:""),ZLOG=$S($D(^(300)):^(300),1:""),ONE=$S($D(^(1)):^(1),1:"")
"RTN","PRCFACPS",21,0)
 I ZERO="",TRANS="",ZLOG="",ONE G K
"RTN","PRCFACPS",22,0)
 I $P(ZERO,"^",2)'=PRC("SITE"),$P(ZERO,"^",2)]"" Q
"RTN","PRCFACPS",23,0)
 I PRCFASYS'[$P(ZERO,"^",10),$P(ZERO,"^",10)]"" Q
"RTN","PRCFACPS",24,0)
 I +$P(TRANS,U,3)>PRCFA("KDATE")!(+$P(TRANS,U,9)>PRCFA("KDATE")) Q
"RTN","PRCFACPS",25,0)
 S J=J+1 W:J#50=0 "."
"RTN","PRCFACPS",26,0)
 I $P(ZERO,U,6)'="" K ^PRCF(423,"C",$P(ZERO,U,6),DA)
"RTN","PRCFACPS",27,0)
 K:$P(ZERO,U,1)'="" ^PRCF(423,"B",$P(ZERO,U),DA)
"RTN","PRCFACPS",28,0)
 K:$P(TRANS,U,5)'="" ^PRCF(423,"AD",$P(TRANS,U,5),DA)
"RTN","PRCFACPS",29,0)
 K:$P(TRANS,U,6)]"" ^PRCF(423,"AE",$P(TRANS,U,6),DA)
"RTN","PRCFACPS",30,0)
 K:$P(ZLOG,U,24)]"" ^PRCF(423,"D",$P(ZLOG,U,24),DA)
"RTN","PRCFACPS",31,0)
 K:$P(ZLOG,U,25)]"" ^PRCF(423,"AN",$P(ZLOG,U,25),DA)
"RTN","PRCFACPS",32,0)
 K:$P(ONE,U,29)]"" ^PRCF(423,"AI",$P(ONE,U,29),DA)
"RTN","PRCFACPS",33,0)
K K ONE,ZERO,TRANS,ZLOG,^PRCF(423,"AC","N",DA)
"RTN","PRCFACPS",34,0)
 F ZX="AJ","AK","AL","AM" K ^PRCF(423,ZX,"Y",DA)
"RTN","PRCFACPS",35,0)
 K ^PRCF(423,DA),ZX S:$P(^PRCF(423,0),"^",4)>0 $P(^(0),U,4)=$P(^(0),U,4)-1 Q
"RTN","PRCFACPS",36,0)
 Q
"RTN","PRCFALOG")
0^2^B1965582^B925107
"RTN","PRCFALOG",1,0)
PRCFALOG ;WISC/CTB-LOG CODE SHEETS ;11-27-92/08:20
"RTN","PRCFALOG",2,0)
V ;;5.1;IFCAP;**114**;Oct 20, 2000;Build 4
"RTN","PRCFALOG",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCFALOG",4,0)
A S PRCHLOG="",PRCFASYS="LOGDLA" Q
"RTN","PRCFALOG",5,0)
B K PRCHLOG,PRCFASYS Q
"RTN","PRCFALOG",6,0)
CCS ;CREATE A CODE SHEET
"RTN","PRCFALOG",7,0)
 D A,EN1^PRCFAC,B Q
"RTN","PRCFALOG",8,0)
DCS ;DELETE A CODE SHEET
"RTN","PRCFALOG",9,0)
 D A,EN9^PRCFAC2,B Q
"RTN","PRCFALOG",10,0)
ECS ;EDIT A CODE SHEET
"RTN","PRCFALOG",11,0)
 D A,EN2^PRCFAC,B Q
"RTN","PRCFALOG",12,0)
EKCS ;EDIT A KEY PUNCHED CODE SHEET
"RTN","PRCFALOG",13,0)
 D A,EDIT^PRCFACR4,B Q
"RTN","PRCFALOG",14,0)
KCS ;KEY PUNCH A CODE SHEET
"RTN","PRCFALOG",15,0)
 D A,^PRCFACR3,B Q
"RTN","PRCFALOG",16,0)
GRAB ;GRAB A BATCH NUMBER
"RTN","PRCFALOG",17,0)
 D A,^PRCFACG,B Q
"RTN","PRCFALOG",18,0)
MBP ;MODIFY PRIORITY OF CODE SHEET WITHIN ITS BATCH
"RTN","PRCFALOG",19,0)
 D A,EN1^PRCFAC2,B Q
"RTN","PRCFALOG",20,0)
BATCH ;BATCH AND PRINT CODE SHEETS
"RTN","PRCFALOG",21,0)
 D A,EN^PRCFACP,B Q
"RTN","PRCFALOG",22,0)
REPRINT ;REPRINT A BATCH
"RTN","PRCFALOG",23,0)
 D A,EN^PRCFAC5,B Q
"RTN","PRCFALOG",24,0)
PURGE ;PURGE CODE SHEETS
"RTN","PRCFALOG",25,0)
 D A S PRCFASYS=PRCFASYS_"PHA" D EN^PRCFACPR,B Q
"RTN","PRCFALOG",26,0)
PURGE2 ;PURGE ALL CODE SHEETS
"RTN","PRCFALOG",27,0)
 W !!,"** YOU MUST SELECT A DESIGNATED PRINTER FOR PURGE TO FUNCTION PROPERLY."
"RTN","PRCFALOG",28,0)
 W !,"** DEFAULTING TO HOME DEVICE (0) WILL NOT PURGE DATA SINCE THE OPTION WILL BE "
"RTN","PRCFALOG",29,0)
 W !,"** TASKED.",!
"RTN","PRCFALOG",30,0)
 S PRCFASYS="CLMCLIRRLOGDLAPHAGSA" D EN^PRCFACPR,B Q
"RTN","PRCFALOG",31,0)
ADD ;ADD CODE SHEET TO PRINTED BATCH
"RTN","PRCFALOG",32,0)
 D A,ADD^PRCFACR2,B Q
"RTN","PRCFALOG",33,0)
DELETE ;DELETE CODE SHEET FROM PRINTED BATCH
"RTN","PRCFALOG",34,0)
 D A,REMOV^PRCFACR2,B Q
"RTN","PRCFALOG",35,0)
TRANSMIT ;TRANSMIT CODE SHEETS
"RTN","PRCFALOG",36,0)
 D A,SE^PRCFACR,B Q
"RTN","PRCFALOG",37,0)
RETRANS ;RETRANSMIT CODE SHEET BATCH
"RTN","PRCFALOG",38,0)
 D A,RT^PRCFACR5,B Q
"RTN","PRCFALOG",39,0)
INQUIRY ;BATCH/TRANSMISSION/RECEIVING REPORT INQUIRY
"RTN","PRCFALOG",40,0)
 D A,E14^PRCFAC3,B Q
"RTN","PRCHQ4")
0^3^B41872556^B41778600
"RTN","PRCHQ4",1,0)
PRCHQ4 ;WOIFO/LKG-RFQ Set up Transmission Records ;7/25/05  15:27
"RTN","PRCHQ4",2,0)
 ;;5.1;IFCAP;**63,114**;Oct 20, 2000;Build 4
"RTN","PRCHQ4",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCHQ4",4,0)
HE ;Set up Heading segment
"RTN","PRCHQ4",5,0)
 N PRCN0,PRCN1,PRCA,PRCB,PRCZ,DA,DIC,DR,DIQ,X,Y
"RTN","PRCHQ4",6,0)
 S PRCN0=$G(^PRC(444,PRCDA,0)),PRCN1=$G(^PRC(444,PRCDA,1))
"RTN","PRCHQ4",7,0)
 S X=$P(PRCN0,U,2) D JDN^PRCUTL S PRCA="HE^^"_Y_"^^"
"RTN","PRCHQ4",8,0)
 S X=$P(PRCN1,U,2) D JDN^PRCUTL S PRCA=PRCA_Y_"^"
"RTN","PRCHQ4",9,0)
 S PRCB=$P(PRCN0,U,3),X=$P(PRCB,".") D JDN^PRCUTL S X=$P(PRCB,".",2)
"RTN","PRCHQ4",10,0)
 S X=X_$E("000000",$L(X)+1,6),PRCA=PRCA_Y_"^"_X_"^^^^^0^0^0^^^^^|"
"RTN","PRCHQ4",11,0)
 K DA S DA=$P(PRCN0,U,4) I DA?1.N D
"RTN","PRCHQ4",12,0)
 . K ^UTILITY("DIQ1",$J)
"RTN","PRCHQ4",13,0)
 . S DIC=200,DR=".01;.135",DIQ(0)="I" D EN^DIQ1 K DIC,DIQ,DR
"RTN","PRCHQ4",14,0)
 . S $P(PRCA,"^",8,9)=^UTILITY("DIQ1",$J,200,DA,.01,"I")_"^"_^UTILITY("DIQ1",$J,200,DA,.135,"I")
"RTN","PRCHQ4",15,0)
 . K ^UTILITY("DIQ1",$J)
"RTN","PRCHQ4",16,0)
 S ^TMP($J,"STRING",1)=PRCA
"RTN","PRCHQ4",17,0)
 I $P(PRCA,U,3)'?7N S PRCZ(1)="Invalid RFQ Reference Date"
"RTN","PRCHQ4",18,0)
 I $P(PRCA,U,5)'?7N S PRCZ(2)="Invalid Requested Delivery Date"
"RTN","PRCHQ4",19,0)
 I $P(PRCA,U,6)'?7N S PRCZ(3)="Invalid RFQ Bids Due Date"
"RTN","PRCHQ4",20,0)
 I $P(PRCA,U,7)'?6N S PRCZ(4)="Invalid RFQ Bids Due Time"
"RTN","PRCHQ4",21,0)
 I $P(PRCA,U,8)="" S PRCZ(5)="Contracting Officer's Name is missing"
"RTN","PRCHQ4",22,0)
 I $P(PRCA,U,9)="" S PRCZ(6)="Contracting Officer's Commercial Phone # is missing"
"RTN","PRCHQ4",23,0)
 I $D(PRCZ) S PRCERR=3 D EN^DDIOL(.PRCZ)
"RTN","PRCHQ4",24,0)
 Q
"RTN","PRCHQ4",25,0)
VELST(PRCN) ;Gets list of solicited vendors from RFQ and invokes 'VE' setup
"RTN","PRCHQ4",26,0)
 N PRCX,PRCY,X,PRCW S PRCX=0,PRCW=0
"RTN","PRCHQ4",27,0)
 F  S PRCX=$O(^PRC(444,PRCDA,5,PRCX)) Q:PRCX'?1.N  D
"RTN","PRCHQ4",28,0)
 . S PRCY=$G(^PRC(444,PRCDA,5,PRCX,0)) Q:PRCY=""
"RTN","PRCHQ4",29,0)
 . S:$P(PRCY,U,2)="" $P(PRCY,U,2)=$P(^PRC(444,PRCDA,0),U,7),$P(^PRC(444,PRCDA,5,PRCX,0),U,2)=$P(PRCY,U,2)
"RTN","PRCHQ4",30,0)
 . Q:";b;e;"'[(";"_$P(PRCY,U,2)_";")
"RTN","PRCHQ4",31,0)
 . S PRCY=$P(PRCY,U)
"RTN","PRCHQ4",32,0)
 . S X=$S(PRCY["PRC(440,":$P($G(^PRC(440,$P(PRCY,";"),7)),U,12),1:$P($G(^PRC(444.1,$P(PRCY,";"),0)),U,2))
"RTN","PRCHQ4",33,0)
 . I X="" D DUNERR(PRCY) Q
"RTN","PRCHQ4",34,0)
 . D VE(X,.PRCN) S PRCW=PRCW+1
"RTN","PRCHQ4",35,0)
 I $P($G(^PRC(444,PRCDA,1)),U,8)="y" D VE("PUBLIC",.PRCN) S PRCW=PRCW+1
"RTN","PRCHQ4",36,0)
 Q PRCW
"RTN","PRCHQ4",37,0)
VE(PRCD,PRCC) ;Set up Vendor segment
"RTN","PRCHQ4",38,0)
 S PRCC=PRCC+1
"RTN","PRCHQ4",39,0)
 S ^TMP($J,"STRING",PRCC)="VE^"_PRCD_"^^^^^^^^^^^^^^^^^^|"
"RTN","PRCHQ4",40,0)
 S ^TMP($J,"VE",PRCD)=""
"RTN","PRCHQ4",41,0)
 Q
"RTN","PRCHQ4",42,0)
ST(PRCC) ;Setting up Ship to segment
"RTN","PRCHQ4",43,0)
 N PRCX,PRCY,DA,DIC,DR
"RTN","PRCHQ4",44,0)
 S PRCY=$G(^PRC(444,PRCDA,0)),PRCX=$P(PRCY,U,10)
"RTN","PRCHQ4",45,0)
 S:PRCX="" PRCX=$E($P(PRCY,U),1,3)
"RTN","PRCHQ4",46,0)
 S PRCY=$P($G(^PRC(444,PRCDA,1)),U,3) Q:PRCY'?1.N
"RTN","PRCHQ4",47,0)
 S PRCX=$G(^PRC(411,PRCX,1,PRCY,0)) Q:PRCX=""
"RTN","PRCHQ4",48,0)
 S PRCC=PRCC+1
"RTN","PRCHQ4",49,0)
 I $P(PRCX,U,9)]"" S ^TMP($J,"STRING",PRCC)="ST^"_$P(PRCX,U,9)_"^^^^^^^^^|" G STX
"RTN","PRCHQ4",50,0)
 S PRCY="ST^^"_$P(PRCX,U)_"^"_$P(PRCX,U,2)_"^"_$P(PRCX,U,3)_"^"_$P(PRCX,U,4)
"RTN","PRCHQ4",51,0)
 S PRCY=PRCY_"^^"_$P(PRCX,U,5)_"^^"_$TR($P(PRCX,U,7),"-")_"^|"
"RTN","PRCHQ4",52,0)
 S DA=$P(PRCX,U,6) I DA?1.N D
"RTN","PRCHQ4",53,0)
 . K ^UTILITY("DIQ1",$J) S DIC=5,DR=1 D EN^DIQ1
"RTN","PRCHQ4",54,0)
 . S $P(PRCY,U,9)=$E(^UTILITY("DIQ1",$J,5,DA,1),1,2) K ^UTILITY("DIQ1",$J)
"RTN","PRCHQ4",55,0)
 S ^TMP($J,"STRING",PRCC)=PRCY
"RTN","PRCHQ4",56,0)
STX Q
"RTN","PRCHQ4",57,0)
MI(PRCRFQ,PRCC) ;Set up Miscellaneous Information segment
"RTN","PRCHQ4",58,0)
 N PRCY
"RTN","PRCHQ4",59,0)
 S PRCY="MI^^^^"_PRCRFQ_"^^^^^^|",PRCC=PRCC+1
"RTN","PRCHQ4",60,0)
 S ^TMP($J,"STRING",PRCC)=PRCY
"RTN","PRCHQ4",61,0)
 Q
"RTN","PRCHQ4",62,0)
AC(PRCC) ;Set up Accounting Information segment
"RTN","PRCHQ4",63,0)
 N PRCY
"RTN","PRCHQ4",64,0)
 S PRCY="AC^^"_$P($G(^PRC(444,PRCDA,1)),U)_"^^^^^^^^^^^^^^^^|",PRCC=PRCC+1
"RTN","PRCHQ4",65,0)
 S ^TMP($J,"STRING",PRCC)=PRCY
"RTN","PRCHQ4",66,0)
 Q
"RTN","PRCHQ4",67,0)
TX(PRCN,PRCC) ;Set up Text segment (i.e. Administrative Certification
"RTN","PRCHQ4",68,0)
 ;;or 864 text)
"RTN","PRCHQ4",69,0)
 ;;Syntax of call: S X=$$TX^PRCHQ4(ARG1,.ARG2)
"RTN","PRCHQ4",70,0)
 ;; Returns number of lines in reformatted Word Processing field
"RTN","PRCHQ4",71,0)
 ;;ARG1: CLOSED GLOBAL ROOT
"RTN","PRCHQ4",72,0)
 ;;ARG2: CURRENT MESSAGE LINE COUNT
"RTN","PRCHQ4",73,0)
 N PRCI,PRCT,PRCX,X,DIWL,DIWR,DIWF
"RTN","PRCHQ4",74,0)
 S PRCX=0,DIWL=1,DIWR=70,DIWF="" K ^UTILITY($J,"W")
"RTN","PRCHQ4",75,0)
 F  S PRCX=$O(@PRCN@(PRCX)) Q:PRCX=""  D
"RTN","PRCHQ4",76,0)
 . Q:'$D(@PRCN@(PRCX,0))  S X=@PRCN@(PRCX,0) D ^DIWP
"RTN","PRCHQ4",77,0)
 ;I PRCN="^PRC(444,PRCDA,4)",$G(PRCTYPE)="00",$P($G(^PRC(444,PRCDA,1)),U,8)="y" D
"RTN","PRCHQ4",78,0)
 ;. S X="If you are not an electronic trading partner with VA, you may submit" D ^DIWP
"RTN","PRCHQ4",79,0)
 ;. S X="your bid by mail or FAX to the Contracting Office.  If you would" D ^DIWP
"RTN","PRCHQ4",80,0)
 ;. S X="like to register as a VA Electronic Trading Partner, please contact" D ^DIWP
"RTN","PRCHQ4",81,0)
 ;. S X="your Software Provider or VA EDI Staff at 512-326-6463." D ^DIWP
"RTN","PRCHQ4",82,0)
 S PRCT=$G(^UTILITY($J,"W",1))+0
"RTN","PRCHQ4",83,0)
 F PRCI=1:1:PRCT D
"RTN","PRCHQ4",84,0)
 . S PRCC=PRCC+1,X=$G(^UTILITY($J,"W",1,PRCI,0)) S:$L(X)=0 X=" " S X=$TR(X,"^")
"RTN","PRCHQ4",85,0)
 . S ^TMP($J,"STRING",PRCC)="TX^"_PRCI_"^"_X_"^|"
"RTN","PRCHQ4",86,0)
 K ^UTILITY($J,"W")
"RTN","PRCHQ4",87,0)
 Q PRCT
"RTN","PRCHQ4",88,0)
IT(PRCC) ;Set up Item segment (Also calls SC and DE to set up Delivery
"RTN","PRCHQ4",89,0)
 ;;Schedule and Description segments for item.)
"RTN","PRCHQ4",90,0)
 N PRCA,PRCB,PRCD,PRCE,PRCF,PRCG,PRCH,PRCK,PRCL,PRCY,PRCCNT
"RTN","PRCHQ4",91,0)
 S PRCA=0,PRCCNT=0
"RTN","PRCHQ4",92,0)
 F  S PRCA=$O(^PRC(444,PRCDA,2,PRCA)) Q:PRCA'?1.N  D
"RTN","PRCHQ4",93,0)
 . S PRCL=0
"RTN","PRCHQ4",94,0)
 . S PRCB=$G(^PRC(444,PRCDA,2,PRCA,0)) Q:PRCB=""
"RTN","PRCHQ4",95,0)
 . S PRCD=$G(^PRC(444,PRCDA,2,PRCA,1)),PRCG=$P(PRCB,U)
"RTN","PRCHQ4",96,0)
 . S PRCY="IT^"_PRCG_"^"_$S($P(PRCB,U,6)]"":$P(PRCB,U,6),$P(PRCB,U,5)>0:$P($G(^PRC(441.2,$P(PRCB,U,5),0)),U),1:"")_"^^^",PRCCNT=PRCCNT+1
"RTN","PRCHQ4",97,0)
 . I $P($G(^PRC(444,PRCDA,5,0)),U,4)=1,$P($G(^PRC(444,PRCDA,1)),U,8)'="y" S $P(PRCY,U,5)=$P($G(^PRC(444,PRCDA,2,PRCA,5)),U,2)
"RTN","PRCHQ4",98,0)
 . S PRCY=PRCY_$P(PRCB,U,9)_"^"_$P(PRCB,U,8)_"^"_($P(PRCB,U,2)*100)_"^^"
"RTN","PRCHQ4",99,0)
 . S PRCE=$P(PRCB,U,3) S:PRCE?1.N PRCH=$P($G(^PRCD(420.5,PRCE,0)),U),$P(PRCY,U,9)=PRCH
"RTN","PRCHQ4",100,0)
 . S PRCY=PRCY_"^^^^^^^^^^^^^"
"RTN","PRCHQ4",101,0)
 . S PRCE=$P(PRCB,U,7) S:PRCE?1.N PRCE=$P($P($G(^PRC(444.2,PRCE,0)),U)," "),$P(PRCY,U,22)=PRCE
"RTN","PRCHQ4",102,0)
 . S $P(PRCY,U,23,29)=$P(PRCD,U)_"^"_$P(PRCD,U,2)_"^"_$P(PRCB,U,11)_"^"_$P($G(^PRC(444,PRCDA,1)),U)_"^^^|"
"RTN","PRCHQ4",103,0)
 . S PRCC=PRCC+1,^TMP($J,"STRING",PRCC)=PRCY
"RTN","PRCHQ4",104,0)
 . S PRCF=PRCC
"RTN","PRCHQ4",105,0)
 . S $P(^TMP($J,"STRING",PRCF),U,21)=$$DE("^PRC(444,PRCDA,2,PRCA,2)",PRCG,.PRCC)
"RTN","PRCHQ4",106,0)
 . S $P(^TMP($J,"STRING",PRCF),U,27)=$$SC("^PRC(444,PRCDA,2,PRCA,4)",PRCG,PRCH,.PRCC,.PRCL)
"RTN","PRCHQ4",107,0)
 . I $P(^TMP($J,"STRING",PRCF),U,3)="" S PRCK(1)="Item #"_$P(PRCB,U)_": FSC and NSN missing"
"RTN","PRCHQ4",108,0)
 . I $P(^TMP($J,"STRING",PRCF),U,8)'>0 S PRCK(2)="Item #"_$P(PRCB,U)_": Quantity not greater than zero"
"RTN","PRCHQ4",109,0)
 . I $P(^TMP($J,"STRING",PRCF),U,9)="" S PRCK(3)="Item #"_$P(PRCB,U)_": Unit of Purchase missing"
"RTN","PRCHQ4",110,0)
 . I $P(^TMP($J,"STRING",PRCF),U,22)="" S PRCK(4)="Item #"_$P(PRCB,U)_": SIC Code missing"
"RTN","PRCHQ4",111,0)
 . I $P(^TMP($J,"STRING",PRCF),U,21)'>0 S PRCK(5)="Item #"_$P(PRCB,U)_": Item Description missing"
"RTN","PRCHQ4",112,0)
 . I $P(^TMP($J,"STRING",PRCF),U,27)>0,$P(^(PRCF),U,8)'=PRCL S PRCK(6)="Item #"_$P(PRCB,U)_": Total of Delivery Schedule NOT EQUAL to Line Quantity"
"RTN","PRCHQ4",113,0)
 S:PRCCNT>0 $P(^TMP($J,"STRING",1),U,12)=PRCCNT
"RTN","PRCHQ4",114,0)
 I PRCCNT'>0 S PRCK(7)="No Items in RFQ"
"RTN","PRCHQ4",115,0)
 I $D(PRCK) S PRCERR=2 D EN^DDIOL(.PRCK)
"RTN","PRCHQ4",116,0)
 Q
"RTN","PRCHQ4",117,0)
SC(PRCN,PRCIT,PRCU,PRCC,PRCJ) ;Set up Delivery Schedule for item
"RTN","PRCHQ4",118,0)
 N PRCW,PRCX,PRCY,PRCZ,X,Y
"RTN","PRCHQ4",119,0)
 S PRCX=0,PRCW=0
"RTN","PRCHQ4",120,0)
 F  S PRCX=$O(@PRCN@(PRCX)) Q:PRCX'?1.N  D
"RTN","PRCHQ4",121,0)
 . S PRCZ=$G(@PRCN@(PRCX,0)) Q:PRCZ=""
"RTN","PRCHQ4",122,0)
 . S X=$P(PRCZ,U,2) D JDN^PRCUTL
"RTN","PRCHQ4",123,0)
 . S PRCY="SC^"_PRCIT_"^"_$P(PRCZ,U)_"^"_($P(PRCZ,U,3)*100)_"^"_PRCU
"RTN","PRCHQ4",124,0)
 . S PRCY=PRCY_"^"_Y_"^|",PRCC=PRCC+1,PRCJ=PRCJ+$P(PRCY,U,4)
"RTN","PRCHQ4",125,0)
 . S ^TMP($J,"STRING",PRCC)=PRCY,PRCW=PRCW+1
"RTN","PRCHQ4",126,0)
 Q PRCW
"RTN","PRCHQ4",127,0)
DE(PRCN,PRCIT,PRCC) ;Set up Item Description segments
"RTN","PRCHQ4",128,0)
 N PRCI,PRCT,PRCX,X,DIWL,DIWR,DIWF
"RTN","PRCHQ4",129,0)
 S PRCX=0,DIWL=1,DIWR=70,DIWF="" K ^UTILITY($J,"W")
"RTN","PRCHQ4",130,0)
 F  S PRCX=$O(@PRCN@(PRCX)) Q:PRCX=""  D
"RTN","PRCHQ4",131,0)
 . Q:'$D(@PRCN@(PRCX,0))  S X=@PRCN@(PRCX,0) D ^DIWP
"RTN","PRCHQ4",132,0)
 S PRCT=$G(^UTILITY($J,"W",1))
"RTN","PRCHQ4",133,0)
 F PRCI=1:1:PRCT D
"RTN","PRCHQ4",134,0)
 . S PRCC=PRCC+1,X=$G(^UTILITY($J,"W",1,PRCI,0)) S:$L(X)=0 X=" " S X=$TR(X,"^")
"RTN","PRCHQ4",135,0)
 . S ^TMP($J,"STRING",PRCC)="DE^"_PRCIT_"^"_PRCI_"^"_X_"^|"
"RTN","PRCHQ4",136,0)
 K ^UTILITY($J,"W")
"RTN","PRCHQ4",137,0)
 Q PRCT
"RTN","PRCHQ4",138,0)
DUNERR(PRCA) ;Displays the Error Message for Vendor Lacking Dun #
"RTN","PRCHQ4",139,0)
 Q:$D(ZTQUEUED)
"RTN","PRCHQ4",140,0)
 N PRCB S PRCB="^"_$P(PRCA,";",2)_$P(PRCA,";")_",0)"
"RTN","PRCHQ4",141,0)
 S PRCB=$P(@PRCB,U)_" lacks a Dun # so NOT a recipient"
"RTN","PRCHQ4",142,0)
 D EN^DDIOL(PRCB)
"RTN","PRCHQ4",143,0)
 Q
"RTN","PRCIN07")
0^4^B3425624^n/a
"RTN","PRCIN07",1,0)
PRCIN07 ;SF/SWS-PREINSTALL *107 TO ADD 441.2 entry ;4-26-94/3:45 PM
"RTN","PRCIN07",2,0)
V ;;5.1;IFCAP;**114**;Oct 20, 2000;Build 4
"RTN","PRCIN07",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCIN07",4,0)
 Q
"RTN","PRCIN07",5,0)
START ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCIN07",6,0)
 N DIC,Y,NREC
"RTN","PRCIN07",7,0)
 S DIC="^PRC(441.2,",X=4235
"RTN","PRCIN07",8,0)
 D ^DIC
"RTN","PRCIN07",9,0)
 I Y=-1 D
"RTN","PRCIN07",10,0)
 .S (DIC,Y)=""
"RTN","PRCIN07",11,0)
 .S DIC="^PRC(441.2,",X=4235,DIC(0)=""
"RTN","PRCIN07",12,0)
 .D FILE^DICN
"RTN","PRCIN07",13,0)
 .I Y'=-1  S MREC=+Y
"RTN","PRCIN07",14,0)
 .S THISDESC="Hazardous Material Spill Containment and Clean-up Equipment and Material."
"RTN","PRCIN07",15,0)
 .S THISDESC=THISDESC_"  Includes Secondary Spill Containment Sumps; Liquid Spill Containment Pallets; Spill Containment Basins; Spill Containment Systems; Absorbent, Sorbent and Blotting Materials."
"RTN","PRCIN07",16,0)
 .S (DIC,Y)=""
"RTN","PRCIN07",17,0)
 .S DIE="^PRC(441.2,",DA=MREC,DR="1///Hazardous Material Spill;2///^S X=THISDESC;3///42;4///General;5///DLA/DASS"
"RTN","PRCIN07",18,0)
 .D ^DIE
"RTN","PRCIN07",19,0)
 K DIC,Y,MREC,DA,X
"RTN","PRCIN07",20,0)
 Q
"VER")
8.0^22.0
"BLD",5341,6)
^96
**END**
**END**
