Released PRC*5.1*117 SEQ #103
Extracted from mail message
**KIDS**:PRC*5.1*117^

**INSTALL NAME**
PRC*5.1*117
"BLD",5780,0)
PRC*5.1*117^IFCAP^0^3080812^y
"BLD",5780,1,0)
^^1^1^3080516^^
"BLD",5780,1,1,0)
1. Option allows PC Orders to avoid Approving Official review
"BLD",5780,4,0)
^9.64PA^^
"BLD",5780,6.3)
2
"BLD",5780,"ABPKG")
n
"BLD",5780,"KRN",0)
^9.67PA^8989.52^19
"BLD",5780,"KRN",.4,0)
.4
"BLD",5780,"KRN",.401,0)
.401
"BLD",5780,"KRN",.402,0)
.402
"BLD",5780,"KRN",.403,0)
.403
"BLD",5780,"KRN",.5,0)
.5
"BLD",5780,"KRN",.84,0)
.84
"BLD",5780,"KRN",3.6,0)
3.6
"BLD",5780,"KRN",3.8,0)
3.8
"BLD",5780,"KRN",9.2,0)
9.2
"BLD",5780,"KRN",9.8,0)
9.8
"BLD",5780,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5780,"KRN",9.8,"NM",1,0)
PRCH1D^^0^B32632291
"BLD",5780,"KRN",9.8,"NM",2,0)
PRCHAMU^^0^B53048308
"BLD",5780,"KRN",9.8,"NM",3,0)
PRCHINQ^^0^B9645635
"BLD",5780,"KRN",9.8,"NM","B","PRCH1D",1)

"BLD",5780,"KRN",9.8,"NM","B","PRCHAMU",2)

"BLD",5780,"KRN",9.8,"NM","B","PRCHINQ",3)

"BLD",5780,"KRN",19,0)
19
"BLD",5780,"KRN",19.1,0)
19.1
"BLD",5780,"KRN",101,0)
101
"BLD",5780,"KRN",409.61,0)
409.61
"BLD",5780,"KRN",771,0)
771
"BLD",5780,"KRN",870,0)
870
"BLD",5780,"KRN",8989.51,0)
8989.51
"BLD",5780,"KRN",8989.52,0)
8989.52
"BLD",5780,"KRN",8994,0)
8994
"BLD",5780,"KRN","B",.4,.4)

"BLD",5780,"KRN","B",.401,.401)

"BLD",5780,"KRN","B",.402,.402)

"BLD",5780,"KRN","B",.403,.403)

"BLD",5780,"KRN","B",.5,.5)

"BLD",5780,"KRN","B",.84,.84)

"BLD",5780,"KRN","B",3.6,3.6)

"BLD",5780,"KRN","B",3.8,3.8)

"BLD",5780,"KRN","B",9.2,9.2)

"BLD",5780,"KRN","B",9.8,9.8)

"BLD",5780,"KRN","B",19,19)

"BLD",5780,"KRN","B",19.1,19.1)

"BLD",5780,"KRN","B",101,101)

"BLD",5780,"KRN","B",409.61,409.61)

"BLD",5780,"KRN","B",771,771)

"BLD",5780,"KRN","B",870,870)

"BLD",5780,"KRN","B",8989.51,8989.51)

"BLD",5780,"KRN","B",8989.52,8989.52)

"BLD",5780,"KRN","B",8994,8994)

"BLD",5780,"QUES",0)
^9.62^^
"BLD",5780,"REQB",0)
^9.611^2^2
"BLD",5780,"REQB",1,0)
PRC*5.1*18^2
"BLD",5780,"REQB",2,0)
PRC*5.1*21^2
"BLD",5780,"REQB","B","PRC*5.1*18",1)

"BLD",5780,"REQB","B","PRC*5.1*21",2)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
117^3080812
"PKG",455,22,1,"PAH",1,1,0)
^^1^1^3080812
"PKG",455,22,1,"PAH",1,1,1,0)
1. Option allows PC Orders to avoid Approving Official review
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRCH1D")
0^1^B32632291^B32448640
"RTN","PRCH1D",1,0)
PRCH1D ;WISC/PLT-REMOVE PURCHASE CARD RECONCILIATION ;7/19/96  09:02
"RTN","PRCH1D",2,0)
V ;;5.1;IFCAP;**117**;Oct 20, 2000;Build 2
"RTN","PRCH1D",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCH1D",4,0)
 QUIT  ;invalid entry
"RTN","PRCH1D",5,0)
 ;
"RTN","PRCH1D",6,0)
EN ;remove reconcile purchase card order
"RTN","PRCH1D",7,0)
 N PRCA,PRCB,PRCQCD,PRCOPT,PRCRI,PRCDI,PRCDUZ,PRC,PRCC,PRCE,PRCF,PRCG,PRCVAL,PRCCP,PRCR,PRCSST,PRCSTC,PRCEDRM
"RTN","PRCH1D",8,0)
 N PRCSELF,PRCCN,PRCCNT,PCN
"RTN","PRCH1D",9,0)
 N A,B,C
"RTN","PRCH1D",10,0)
Q1 ;station
"RTN","PRCH1D",11,0)
 S PRCSST=1 D STA^PRCSUT S PRCSTC=SI G:$G(PRC("SITE"))=""!(Y<0)!(PRCSTC<1) EXIT
"RTN","PRCH1D",12,0)
 S PRCRI(420)=+PRC("SITE")
"RTN","PRCH1D",13,0)
 S PRCSELF=1 I $D(^PRC(440.5,"MAA",DUZ)) D  G EXIT:X=""!(X["^") S PRCSELF=Y
"RTN","PRCH1D",14,0)
 . D YN^PRC0A(.X,.Y,"Edit/Remove Reconciliation for your own purchase card orders","O","")
"RTN","PRCH1D",15,0)
 . QUIT
"RTN","PRCH1D",16,0)
 S PRCCN="" I PRCSELF=1 S PRCDUZ=DUZ G Q3
"RTN","PRCH1D",17,0)
Q21 S X("S")="I $P(^(2),U,3)=PRC(""SITE""),$P(^(0),U,9)=DUZ!($P(^(0),U,10)=DUZ)"
"RTN","PRCH1D",18,0)
 S X("W")="W ""    "",$P(^(0),U,11),""    "" W:$P(^(0),U,8) $P($G(^VA(200,$P(^(0),U,8),0)),U)"
"RTN","PRCH1D",19,0)
 D LOOKUP^PRC0B(.X,.Y,"440.5;^PRC(440.5,;","AEMOQS~~G^MAA^H^D","Select Purchase Credit Card/Holder: ")
"RTN","PRCH1D",20,0)
 I X["^"!(X="")!(Y<1) G Q1
"RTN","PRCH1D",21,0)
 S PRCRI(440.5)=+Y,PRCDUZ=$P(^PRC(440.5,PRCRI(440.5),0),U,8),PRCCN=$P(^(0),U)
"RTN","PRCH1D",22,0)
Q3 ;select oracle cc-record
"RTN","PRCH1D",23,0)
 K DIRUT,PCSTAT
"RTN","PRCH1D",24,0)
 S X("S")="I ""RD""[$P(^(0),U,16),$P(^(0),U,8)=PRC(""SITE""),$P(^(0),U,4)=PRCCN&'PRCSELF!($P(^(0),U,17)="_PRCDUZ_"&PRCSELF)"
"RTN","PRCH1D",25,0)
 S X("W")="W:$X>20 ! W $P(^(0),U,1),""   "",$E($P(^(0),U,9),4,5)_""-""_$E($P(^(0),U,9),6,7)_""-""_$E($P(^(0),U,9),2,3),""  $"",$J($P(^(0),U,14),0,2) W:$D(^(6)) ""   "",$P(^(6),U,1)"
"RTN","PRCH1D",26,0)
 W ! D LOOKUP^PRC0B(.X,.Y,"440.6;^PRCH(440.6,;","AEMOQS~~","Select Reconciled/Disputed C-Document/Purchase Card Order: ")
"RTN","PRCH1D",27,0)
 I Y<0!(X="") G EXIT
"RTN","PRCH1D",28,0)
 K X S PRCRI(440.6)=+Y,PRCRI(442)=$P($G(^PRCH(440.6,PRCRI(440.6),1)),"^",1),PCSTAT=$P($G(^PRCH(440.6,PRCRI(440.6),0)),"^",16)
"RTN","PRCH1D",29,0)
 I 'PRCRI(442) D EN^DDIOL("Not reconciled yet.") G Q3
"RTN","PRCH1D",30,0)
 ;
"RTN","PRCH1D",31,0)
 ;if the charge has been reconciled warn user before starting any changes
"RTN","PRCH1D",32,0)
 I $D(PRCRI(442)),$G(PCSTAT)="R"!($G(PCSTAT)="D") D  G:X="NO"!(X["^")!(X="") Q3
"RTN","PRCH1D",33,0)
 . W $C(7),!!,?25,"**** WARNING ****"
"RTN","PRCH1D",34,0)
 . S DIR("A",1)=""
"RTN","PRCH1D",35,0)
 . S DIR("A",2)="This charge is reconciled. If you 'Edit' it, another approval will be needed."
"RTN","PRCH1D",36,0)
 . S DIR("A",3)="If you 'Remove' the reconciliation, you must reconcile the charge and your "
"RTN","PRCH1D",37,0)
 . S DIR("A",4)="Approving Official will have to approve it again."
"RTN","PRCH1D",38,0)
 . S DIR("A",5)=""
"RTN","PRCH1D",39,0)
 . S DIR("A",6)="Use the action code DD (Display Document) if no change is desired."
"RTN","PRCH1D",40,0)
 . S DIR("A",7)=""
"RTN","PRCH1D",41,0)
 . S DIR("A")="Do you want to continue"
"RTN","PRCH1D",42,0)
 . S DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR Q:$D(DIRUT)
"RTN","PRCH1D",43,0)
 D ACT
"RTN","PRCH1D",44,0)
 G Q3
"RTN","PRCH1D",45,0)
 ;
"RTN","PRCH1D",46,0)
 ;
"RTN","PRCH1D",47,0)
EXIT QUIT
"RTN","PRCH1D",48,0)
ACT S PRCE=^PRC(442,PRCRI(442),0),PRCCP=$P($G(^(23)),"^",16),PRCR=$P($G(^(23)),"^",15) S:PRCR="" PRCR="N"
"RTN","PRCH1D",49,0)
 S X(1)=$TR($J("",79)," ","_")
"RTN","PRCH1D",50,0)
 S X(2)="   Action Code: ED: Edit        DO: Display Order    ND: Next Document",X(3)="                RM: Remove      DD: Display Document"
"RTN","PRCH1D",51,0)
 S Y(1)="Enter an action code"
"RTN","PRCH1D",52,0)
 D FT^PRC0A(.X,.Y,"Action","","")
"RTN","PRCH1D",53,0)
 I X["^"!(X="") QUIT
"RTN","PRCH1D",54,0)
 S Y=$$LU
"RTN","PRCH1D",55,0)
 I Y="ND" QUIT
"RTN","PRCH1D",56,0)
 I Y="DO" D  G ACT
"RTN","PRCH1D",57,0)
 . N D0 S D0=PRCRI(442) D ^PRCHDP1
"RTN","PRCH1D",58,0)
 . QUIT
"RTN","PRCH1D",59,0)
 I Y="DD" D DD G ACT
"RTN","PRCH1D",60,0)
 S PRCEDRM="" I Y="ED" S PRCEDRM=1 D RC^PRCH1A1 QUIT
"RTN","PRCH1D",61,0)
 I Y'="RM" D EN^DDIOL("Invalid Action code, try again") G ACT
"RTN","PRCH1D",62,0)
 ;remove conciliation
"RTN","PRCH1D",63,0)
 S PRCA=^PRCH(440.6,PRCRI(440.6),0),PRCB=$G(^(1))
"RTN","PRCH1D",64,0)
 D E20,ET
"RTN","PRCH1D",65,0)
 S PRCA=^PRCH(440.6,PRCRI(440.6),0),PRCB=$G(^(1))
"RTN","PRCH1D",66,0)
 S PRCRI(410)=$P(^PRC(442,PRCRI(442),0),"^",12)
"RTN","PRCH1D",67,0)
 D EDIT^PRC0B(.X,"440.6;^PRCH(440.6,;"_PRCRI(440.6),"44///N;15////N;45///@")
"RTN","PRCH1D",68,0)
 D EDIT^PRC0B(.X,"440.6;^PRCH(440.6,;"_PRCRI(440.6),"18///@;19///@;46///@;41///@;42///@")
"RTN","PRCH1D",69,0)
 ;if final payment entry removed
"RTN","PRCH1D",70,0)
 I $P(PRCB,"^",4)="Y" D
"RTN","PRCH1D",71,0)
 . S PRCST=$P(PRCA,"^",20) D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCRI(442),"58///@;44///@;.5///"_PRCST)
"RTN","PRCH1D",72,0)
 . I PRCRI(410) D EDIT^PRC0B(.X,"410;^PRCS(410,;"_PRCRI(410),"27////"_$P(PRCA,"^",19))
"RTN","PRCH1D",73,0)
 . S PRCRI=0 F  S PRCRI=$O(^PRC(442,PRCRI(442),13,PRCRI)) QUIT:'PRCRI  D:PRCRI ERS410^PRC0G(PRCRI_"^A")
"RTN","PRCH1D",74,0)
 . QUIT
"RTN","PRCH1D",75,0)
 S PRCC=$$FP^PRCH0A(PRCRI(442))
"RTN","PRCH1D",76,0)
 ;if last payment entry removed
"RTN","PRCH1D",77,0)
 I $P(PRCC,"^",2)="" S PRCST=$P(PRCA,"^",20) D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCRI(442),"58///@;44///@;.5///"_PRCST) G Q9
"RTN","PRCH1D",78,0)
 ;if not last payment entry removed
"RTN","PRCH1D",79,0)
 D:PRCRI(410)&PRCC
"RTN","PRCH1D",80,0)
 . N A,B
"RTN","PRCH1D",81,0)
 . S A=0,B=0 F  S A=$O(^PRCH(440.6,"PO",PRCRI(442),A)) QUIT:'A  S B=B+$P(^PRCH(440.6,A,0),"^",14)
"RTN","PRCH1D",82,0)
 . D EDIT^PRC0B(.X,"410;^PRCS(410,;"_PRCRI(410),"27////"_B)
"RTN","PRCH1D",83,0)
 . QUIT
"RTN","PRCH1D",84,0)
Q9 ;prompt status
"RTN","PRCH1D",85,0)
 K X
"RTN","PRCH1D",86,0)
 S X=+^PRC(442,PRCRI(442),7) S:X=40!(X=71) X=95 S X("B")=$P(^PRCD(442.3,X,0),"^")
"RTN","PRCH1D",87,0)
 S PRCVAL=",22,27,25,30,24,32,37,39,46,48,50,"
"RTN","PRCH1D",88,0)
 S:$O(^PRC(442,PRCRI(442),6,0)) PRCVAL=",22,27,25,26,30,31,23,24,29,32,34,37,38,39,44,46,47,48,49,50,51,"
"RTN","PRCH1D",89,0)
 S X("S")="N A S A=$P(^PRCD(442.3,+Y,0),U,2) I PRCVAL[("",""_A_"","")"
"RTN","PRCH1D",90,0)
 D LOOKUP^PRC0B(.X,.Y,"442.3;^PRCD(442.3,","AEMQ","AFTER Removing Change P.O. Status to: ")
"RTN","PRCH1D",91,0)
 I Y<0!(X="") D EN^DDIOL("The purchase card order status is required") G Q9
"RTN","PRCH1D",92,0)
 S PRCST=$P(^PRCD(442.3,+Y,0),"^",2)
"RTN","PRCH1D",93,0)
 D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCRI(442),".5///"_PRCST)
"RTN","PRCH1D",94,0)
 K PCN QUIT
"RTN","PRCH1D",95,0)
 ;
"RTN","PRCH1D",96,0)
E20 D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCRI(442),"20")
"RTN","PRCH1D",97,0)
 QUIT
"RTN","PRCH1D",98,0)
 ;
"RTN","PRCH1D",99,0)
ET S A=$$DDA4406^PRCH0A(PRCRI(440.6)),B=$$DDA442^PRCH0A(PRCRI(442)),$P(B,"^",17)="",PRCBOC=$P(B,"^",21),$P(B,"^",33)=$P(A,"^",33)
"RTN","PRCH1D",100,0)
 I A'=B D
"RTN","PRCH1D",101,0)
 . I $E(PRCA,13,15)>490 D EN^DDIOL("Enter ET-Document by FMS-ON LINE!") QUIT
"RTN","PRCH1D",102,0)
 . D EN^DDIOL("Generating ET-document to FMS...")
"RTN","PRCH1D",103,0)
 . D ET^PRCH8A(.X,PRCRI(440.6)_"^"_PRCRI(442)_"^2^"_PRCBOC,"")
"RTN","PRCH1D",104,0)
 . I X D EDIT^PRC0B(.X,"440.6;^PRCH(440.6,;"_PRCRI(440.6),"17////"_$P(X,"^"))
"RTN","PRCH1D",105,0)
 . QUIT
"RTN","PRCH1D",106,0)
 QUIT
"RTN","PRCH1D",107,0)
 ;
"RTN","PRCH1D",108,0)
 ;
"RTN","PRCH1D",109,0)
DD ;dispaly document
"RTN","PRCH1D",110,0)
 N A
"RTN","PRCH1D",111,0)
 D PIECE^PRC0B("440.6;^PRC(440.6,;"_PRCRI(440.6),".01;8;13;31;44","E","A")
"RTN","PRCH1D",112,0)
 W !,"Reconcile Doc: ",$G(A(440.6,PRCRI(440.6),.01,"E")),?32,"Purchase Date: ",$G(A(440.6,PRCRI(440.6),8,"E")),?60,"$Amount: ",$J($G(A(440.6,PRCRI(440.6),13,"E")),0,2)
"RTN","PRCH1D",113,0)
 W !,"Final Payment: ",$G(A(440.6,PRCRI(440.6),44,"E"))
"RTN","PRCH1D",114,0)
 W !,"Vendor Name: ",$G(A(440.6,PRCRI(440.6),31,"E"))
"RTN","PRCH1D",115,0)
 QUIT
"RTN","PRCH1D",116,0)
 ;
"RTN","PRCH1D",117,0)
LU() ;lower to upper
"RTN","PRCH1D",118,0)
 QUIT $TR(Y,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PRCHAMU")
0^2^B53048308^B52465897
"RTN","PRCHAMU",1,0)
PRCHAMU ;WISC/AKS-Modules helpful in amendments ;8/18/97  9:12
"RTN","PRCHAMU",2,0)
 ;;5.1;IFCAP;**21,117**;Oct 20, 2000;Build 2
"RTN","PRCHAMU",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHAMU",4,0)
 W !,"Call at the appropriate entry point",$C(7)
"RTN","PRCHAMU",5,0)
 Q
"RTN","PRCHAMU",6,0)
 ;
"RTN","PRCHAMU",7,0)
GETPO ;get a valid PO
"RTN","PRCHAMU",8,0)
 ;the variable RETURN is either the PO/REQ# or null if no PO is selected
"RTN","PRCHAMU",9,0)
 N DIC,D,Y,X,TRANS,PRCHSTAT
"RTN","PRCHAMU",10,0)
 S DIC="^PRC(442,",DIC(0)="QEAMZ",D="C"
"RTN","PRCHAMU",11,0)
 S DIC("A")=$S($D(PRCHREQ):"REQUISITION NO.: ",1:"PURCHASE ORDER: ")
"RTN","PRCHAMU",12,0)
 S DIC("S")="I +$P(^(0),U)=PRC(""SITE"")"_$S($D(PRCHREQ):",$P(^(0),U,2)=8!($P(^(0),U,2)=25)",1:",$P(^(0),U,2)<8!($P(^(0),U,2)=25)!($P(^(0),U,2)=26)")
"RTN","PRCHAMU",13,0)
 I $G(PRCHAUTH)=1 S DIC("S")="I +$P(^(0),U)=PRC(""SITE""),($P($G(^(23)),U,11)=""P""!($P($G(^(23)),U,11)=""S""))"
"RTN","PRCHAMU",14,0)
 I $G(PRCHAUTH)=2 S DIC("S")="I +$P(^(0),U)=PRC(""SITE""),$P($G(^(23)),U,11)=""D"""
"RTN","PRCHAMU",15,0)
 D ^DIC K DIC I Y<0 S OUT=1 Q
"RTN","PRCHAMU",16,0)
 ;A time-out/up-arrow check before locking the record.
"RTN","PRCHAMU",17,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PRCHAMU",18,0)
 ; Locking the 442 entry i.e. selected by the user to amend. 
"RTN","PRCHAMU",19,0)
 ; This lock is released ONLY at one exit point in EXIT^PRCHMA routine.
"RTN","PRCHAMU",20,0)
 ;
"RTN","PRCHAMU",21,0)
 S PRCENTRY=+Y,OUT=0
"RTN","PRCHAMU",22,0)
 L +^PRC(442,PRCENTRY):1 E  W !!,?5," Someone else is already editing this amendment record." S PRCFL=1 Q
"RTN","PRCHAMU",23,0)
 S X=$S($D(^PRC(442,+Y,7)):$P($G(^PRCD(442.3,+^(7),0)),U,2),1:"")
"RTN","PRCHAMU",24,0)
 I X="" W !,$C(7),"Invalid Supply Status" Q
"RTN","PRCHAMU",25,0)
 I X<20 W !,$C(7),"    This order is not properly signed yet!!" Q
"RTN","PRCHAMU",26,0)
 I X=45 W !,$C(7),"This is a cancelled " W:$D(PRCHREQ) "requisition." W:'$D(PRCHREQ) "purchase order." Q
"RTN","PRCHAMU",27,0)
 I $G(PRCHAUTH)=1 S PCARD=$P($G(^PRC(442,+Y,23)),U,8) D  I $G(PRCHFG) K PCARD,PRCHFG Q
"RTN","PRCHAMU",28,0)
 . I '$D(^PRC(440.5,"C",DUZ,PCARD)) W !,?5,"You are not authorized to amend this purchase card order." S PRCHFG=1
"RTN","PRCHAMU",29,0)
 K PCARD,PRCHFG
"RTN","PRCHAMU",30,0)
 I $G(PRCHAUTH)=2 S PRCHAUCP=$P(^PRC(442,+Y,0),U,3) D  I $G(PRCHAUFG) K PRCHAUCP,PRCHAUFG Q
"RTN","PRCHAMU",31,0)
 . I '$D(^PRC(420,PRC("SITE"),1,+PRCHAUCP,1,DUZ)) D  S PRCHAUFG=1
"RTN","PRCHAMU",32,0)
 . . W !!,"You are not an authorized user for "_$P(PRCHAUCP," ",1,2)_" control point.",!
"RTN","PRCHAMU",33,0)
 K PRCHAUCP,PRCHAUFG
"RTN","PRCHAMU",34,0)
 I '$D(TRANSCMP) I X=40!(X=41) D  Q:$G(TRANS)=1
"RTN","PRCHAMU",35,0)
 .Q:($P(^PRC(442,+Y,0),"^",2)=2)!($P(^PRC(442,+Y,0),"^",2)=4)
"RTN","PRCHAMU",36,0)
 .W $C(7),!!,?5,"Purchase orders (Excluding CERTIFIED INVOICE and GUARANTEED DELIVERY)",!,?5,"with a status of 'Transaction Complete' cannot be amended."
"RTN","PRCHAMU",37,0)
 .S TRANS=1
"RTN","PRCHAMU",38,0)
 I X=50!(X=51) D  Q
"RTN","PRCHAMU",39,0)
 . W $C(7),!!,?5,"Reconciled Purchase Card orders cannot be amended."
"RTN","PRCHAMU",40,0)
 I X=28!(X=33) W $C(7),!,"Amendment not allowed until after order has been obligated!!" Q
"RTN","PRCHAMU",41,0)
 I $D(^PRC(443.6,+Y,0)) S PRCHAM=$O(^PRC(443.6,+Y,6,0)) I PRCHAM="" D  Q
"RTN","PRCHAMU",42,0)
 .W !!?5,"This record is not set-up properly, it is being cleaned-up."
"RTN","PRCHAMU",43,0)
 .W !?5,"Please RE-START the amendment process.",!
"RTN","PRCHAMU",44,0)
 .D DEL
"RTN","PRCHAMU",45,0)
 I $D(^PRC(443.6,+Y,0)) S PRCHAM=$O(^PRC(443.6,+Y,6,0)) Q:PRCHAM'>0  D  Q:$D(FIS)
"RTN","PRCHAMU",46,0)
 .I $P($G(^PRC(443.6,+Y,6,PRCHAM,1)),U,2)]"" D
"RTN","PRCHAMU",47,0)
 ..W !!,?5,"Pending Amendment: ",PRCHAM,"       Status: Pending Fiscal Action" S FIS=1
"RTN","PRCHAMU",48,0)
 D FMS
"RTN","PRCHAMU",49,0)
 I $G(STATUS)]"" I $E(STATUS,1)="R"!($E(STATUS,1)="E") D  K STATUS Q
"RTN","PRCHAMU",50,0)
 .W !!,?5,"One of the previous documents has been rejected by",!,?5,"FMS or has errored in transmission.",!,?5,"This purchase order cannot be amended at this time."
"RTN","PRCHAMU",51,0)
 I $D(^PRC(443.6,+Y,0)) I $D(^PRC(443.6,+Y,11)) W !!,"There is a pending Adjustment Voucher against this purchase order" Q
"RTN","PRCHAMU",52,0)
 I $D(^PRC(443.6,+Y,0)) W $C(7),!!,?5,"*** There is already an amendment pending for this purchase order. ***" S PRCHNEW=111 D  Q:%'=1!$D(DEL)
"RTN","PRCHAMU",53,0)
 .S %=1,%B="",%A="         Would you like to Edit it" D ^PRCFYN W !
"RTN","PRCHAMU",54,0)
 .I %=2 S %B="",%A="         Would you like to delete it" D ^PRCFYN W ! D
"RTN","PRCHAMU",55,0)
 ..D:%=1 DEL
"RTN","PRCHAMU",56,0)
 S PRCHPO=+Y
"RTN","PRCHAMU",57,0)
 Q
"RTN","PRCHAMU",58,0)
AMENDNO ;gets next valid amendment number to create
"RTN","PRCHAMU",59,0)
 ;
"RTN","PRCHAMU",60,0)
 N I,%,%A,%B,PRCHEX,PRCHEX1
"RTN","PRCHAMU",61,0)
 S PRCHAM=1
"RTN","PRCHAMU",62,0)
 I $D(^PRC(442,PRCHPO,6)) D
"RTN","PRCHAMU",63,0)
 .S I=0 F  S I=$O(^PRC(442,PRCHPO,6,I)) Q:'I  S PRCHAM=I+1
"RTN","PRCHAMU",64,0)
 W !!?5,"Amendment Number: ",PRCHAM
"RTN","PRCHAMU",65,0)
 I $D(^PRC(443.6,PRCHPO,0)) W ! Q
"RTN","PRCHAMU",66,0)
 W !!,"...copying Purchase Order into work file...",! D WAIT^DICD W !
"RTN","PRCHAMU",67,0)
 F I=0,1,7,12,23 S ^PRC(443.6,PRCHPO,I)=$G(^PRC(442,PRCHPO,I))
"RTN","PRCHAMU",68,0)
 S $P(^PRC(443.6,0),"^",3)=PRCHPO,$P(^(0),"^",4)=$P(^(0),"^",4)+1
"RTN","PRCHAMU",69,0)
 S PRCHEX=$P(^PRC(443.6,PRCHPO,0),"^"),PRCHEX1=$P(PRCHEX,"-",2)
"RTN","PRCHAMU",70,0)
 S (^PRC(443.6,"B",PRCHEX,PRCHPO),^PRC(443.6,"E",PRCHEX1,PRCHPO))=""
"RTN","PRCHAMU",71,0)
 Q
"RTN","PRCHAMU",72,0)
 ;
"RTN","PRCHAMU",73,0)
INFO ; Ask for common information for amendments
"RTN","PRCHAMU",74,0)
 N DIE,DA,DR,FLGUP
"RTN","PRCHAMU",75,0)
 S ER=0,FLGUP=0,DIE="^PRC(443.6,",DA=PRCHPO,DR="[PRCHAMEND]"
"RTN","PRCHAMU",76,0)
 S:$D(PRCHAV) DR="[PRCHAMENDAV]"
"RTN","PRCHAMU",77,0)
 S:$G(PRCPROST)=90 DR="[PRCHAMENDPRO]"
"RTN","PRCHAMU",78,0)
 S:$G(PRCPROST)=6 DR="[PRCHAMENDPRO EDIT]"
"RTN","PRCHAMU",79,0)
 D ^DIE
"RTN","PRCHAMU",80,0)
 I $D(Y)!'FLGUP S ER=1 Q
"RTN","PRCHAMU",81,0)
 S DIE="^PRC(443.6,"_PRCHPO_",6,",DA=PRCHAM,DR="15///TODAY+4" D ^DIE
"RTN","PRCHAMU",82,0)
 I '$D(^PRC(443.6,PRCHPO,6,PRCHAM,1)) D  S ER=1 Q
"RTN","PRCHAMU",83,0)
 .W !,?5,"Can't continue without a Purchasing Agent !"
"RTN","PRCHAMU",84,0)
 ;S PRCHLC=$P(PRCH(0),U,14)
"RTN","PRCHAMU",85,0)
 Q
"RTN","PRCHAMU",86,0)
ASK ;Ask type amendment
"RTN","PRCHAMU",87,0)
 N PRCHREPO S PRCHREPO=$O(^PRC(443.6,PRCHPO,6,PRCHAM,3,"AC",32,0)) I PRCHREPO>0 S REPONUM=1 Q
"RTN","PRCHAMU",88,0)
 S ER=0 W !
"RTN","PRCHAMU",89,0)
 I '$G(PRCHAUTH) D
"RTN","PRCHAMU",90,0)
 . S DIC=$S($D(PRCHREQ):"^PRCD(441.6,",1:"^PRCD(442.2,")
"RTN","PRCHAMU",91,0)
 . S DIC("S")="I Y>19,($P(^(0),U,3)]"""")"
"RTN","PRCHAMU",92,0)
 . S DIC(0)="MQEAZ" D ^DIC K DIC
"RTN","PRCHAMU",93,0)
 I $G(PRCHAUTH) D
"RTN","PRCHAMU",94,0)
 . D:'$D(PRCHREQ) DIRPO^PRCHPCAR D:$D(PRCHREQ) DIRREQ^PRCHPCAR
"RTN","PRCHAMU",95,0)
 I Y<0 S ER=1 K PRCHVFLG Q
"RTN","PRCHAMU",96,0)
 I $D(PRCHREQ) D  G:ER ASK
"RTN","PRCHAMU",97,0)
 .I '$D(^PRCD(441.6,+Y,1)) D  S ER=1
"RTN","PRCHAMU",98,0)
 ..W !!?5,"Amendment Lines in 'Type of Requisition Amendment' file are not defined "
"RTN","PRCHAMU",99,0)
 I '$D(PRCHREQ) D  G:ER ASK
"RTN","PRCHAMU",100,0)
 .I '$D(^PRCD(442.2,+Y,1)) D  S ER=1
"RTN","PRCHAMU",101,0)
 ..W !!?5,"Amendment Lines in 'Type of Amendment' file are not defined "
"RTN","PRCHAMU",102,0)
 I $P($G(Y(0)),U,3)="" D
"RTN","PRCHAMU",103,0)
 . S Y(0)=$S($D(PRCHREQ):^PRCD(441.6,Y,0),1:^PRCD(442.2,Y,0))
"RTN","PRCHAMU",104,0)
 S PRCHAMDA=+Y,ROU=$P(Y(0),U,3),ROU=$TR(ROU,"~","^")
"RTN","PRCHAMU",105,0)
 S PRCHL1=$P(^PRCD(442.2,+Y,1),U),PRCHL2=$P(^(1),U,2)
"RTN","PRCHAMU",106,0)
 Q
"RTN","PRCHAMU",107,0)
UPDATE ;Update Delivery date, Original Delivery Date, Amendment status and
"RTN","PRCHAMU",108,0)
 ;Justification.
"RTN","PRCHAMU",109,0)
 I $G(DELIVER) D
"RTN","PRCHAMU",110,0)
 .S PRCHDT=$P(^PRC(443.6,PRCHPO,0),U,10)
"RTN","PRCHAMU",111,0)
 .I $P($G(^PRC(442,PRCHPO,23)),"^",11)'="S" S DIE="^PRC(443.6,",DA=PRCHPO,DR=7 D ^DIE K DIE
"RTN","PRCHAMU",112,0)
 .I PRCHDT,$P(^PRC(443.6,PRCHPO,0),U,20)="",$P(^(0),U,10)'=PRCHDT S $P(^(0),U,20)=PRCHDT
"RTN","PRCHAMU",113,0)
 .K PRCHDT
"RTN","PRCHAMU",114,0)
 S POSTAT=+$G(^PRC(443.6,PRCHPO,7))
"RTN","PRCHAMU",115,0)
 S AMSTAT=$S(POSTAT=25:26,POSTAT=30:31,POSTAT=40:71,POSTAT=6:83,POSTAT=84:85,POSTAT=86:87,POSTAT=90:91,POSTAT=92:93,POSTAT=94:95,POSTAT=96:97,POSTAT=45:45,1:POSTAT)
"RTN","PRCHAMU",116,0)
 I $G(PRCHAUTH)=1,(AMSTAT=40!(AMSTAT=71)) S AMSTAT=83
"RTN","PRCHAMU",117,0)
 S AMSTAT=$P(^PRCD(442.3,AMSTAT,0),U)
"RTN","PRCHAMU",118,0)
 S DIE="^PRC(443.6,PRCHPO,6,",DA(1)=PRCHPO,DA=PRCHAM,DR="9//^S X=AMSTAT;16"
"RTN","PRCHAMU",119,0)
 N AAREPO S AAREPO=$O(^PRC(443.6,PRCHPO,6,PRCHAM,3,"AC",32,0))
"RTN","PRCHAMU",120,0)
 I $G(CAN)=1!(AAREPO>0) S DR=16
"RTN","PRCHAMU",121,0)
 I $G(PRCPROST)=90 S DR="16////Prosthetic order cancelled"
"RTN","PRCHAMU",122,0)
 I $G(PRCPROST)=6 S DR="16////Prosthetic Cost Changes"
"RTN","PRCHAMU",123,0)
 D ^DIE K DIE,AMSTAT,POSTAT
"RTN","PRCHAMU",124,0)
 QUIT
"RTN","PRCHAMU",125,0)
FMS ;Checking FMS documents status
"RTN","PRCHAMU",126,0)
 ;
"RTN","PRCHAMU",127,0)
 N N,CODE
"RTN","PRCHAMU",128,0)
 S N=0,STATUS="" F  S N=$O(^PRC(442,+Y,10,N)) Q:N'>0  D  Q:$E(STATUS,1)="R"!($E(STATUS,1)="E")
"RTN","PRCHAMU",129,0)
 .I $E(^PRC(442,+Y,10,N,0),1,2)="MO"!($E(^(0),1,2)="SO") D
"RTN","PRCHAMU",130,0)
 ..S CODE=$P($G(^PRC(442,+Y,10,N,0)),U,4)
"RTN","PRCHAMU",131,0)
 ..S STATUS=$$STATUS^GECSSGET(CODE)
"RTN","PRCHAMU",132,0)
 Q
"RTN","PRCHAMU",133,0)
DEL ;Delete this amendment
"RTN","PRCHAMU",134,0)
 N PO,EXPO,EXPO1,N,ZERO,REC,PAT,ITEM
"RTN","PRCHAMU",135,0)
 S PO=+Y
"RTN","PRCHAMU",136,0)
 S EXPO=$P(^PRC(443.6,PO,0),U),EXPO1=$P(EXPO,"-",2)
"RTN","PRCHAMU",137,0)
 S N=0 F  S N=$O(^PRC(441.7,"B",EXPO,N)) Q:N'>0  D
"RTN","PRCHAMU",138,0)
 .S REC=^PRC(441.7,N,0)
"RTN","PRCHAMU",139,0)
 .S PAT=$P(REC,U)
"RTN","PRCHAMU",140,0)
 .S ITEM=$P(REC,U,2)
"RTN","PRCHAMU",141,0)
 .I ITEM>0 K ^PRC(441.7,"AG",PAT,ITEM,N)
"RTN","PRCHAMU",142,0)
 .K ^PRC(441.7,"B",PAT,N)
"RTN","PRCHAMU",143,0)
 .K ^PRC(441.7,N,0)
"RTN","PRCHAMU",144,0)
 .S ZERO=^PRC(441.7,0)
"RTN","PRCHAMU",145,0)
 .S $P(ZERO,U,4)=$P(ZERO,U,4)-1
"RTN","PRCHAMU",146,0)
 .S:$P(ZERO,U,4)<1 $P(ZERO,U,4)=""
"RTN","PRCHAMU",147,0)
 .S ^PRC(441.7,0)=ZERO
"RTN","PRCHAMU",148,0)
 K ^PRC(443.6,"B",EXPO),^PRC(443.6,"C",PO),^PRC(443.6,"D",PO)
"RTN","PRCHAMU",149,0)
 K ^PRC(443.6,"E",EXPO1),^PRC(443.6,PO)
"RTN","PRCHAMU",150,0)
 S ZERO=^PRC(443.6,0)
"RTN","PRCHAMU",151,0)
 S $P(ZERO,U,4)=$P(ZERO,U,4)-1
"RTN","PRCHAMU",152,0)
 S:$P(ZERO,U,4)<1 $P(ZERO,U,4)=""
"RTN","PRCHAMU",153,0)
 S ^PRC(443.6,0)=ZERO
"RTN","PRCHAMU",154,0)
 S DEL=1
"RTN","PRCHAMU",155,0)
 QUIT
"RTN","PRCHAMU",156,0)
 ;
"RTN","PRCHAMU",157,0)
MSG ;This subroutine is called by PRCHMA
"RTN","PRCHAMU",158,0)
 ;Display message for 'Vendor Change'
"RTN","PRCHAMU",159,0)
 N AA
"RTN","PRCHAMU",160,0)
 S AA="NOTE: The vendor has been changed."
"RTN","PRCHAMU",161,0)
 S AA=AA_"  Please review LINE ITEM & FPDS information"
"RTN","PRCHAMU",162,0)
 S AA=AA_"        for any necessary changes."
"RTN","PRCHAMU",163,0)
 D EN^DDIOL(AA) W !
"RTN","PRCHAMU",164,0)
 QUIT
"RTN","PRCHAMU",165,0)
 ;
"RTN","PRCHAMU",166,0)
MSG1 ;This subroutine is called by PRCHMA
"RTN","PRCHAMU",167,0)
 ;Source code was changed to 2
"RTN","PRCHAMU",168,0)
 N AA
"RTN","PRCHAMU",169,0)
 S AA="NOTE: THE CONTRACT WILL BE REMOVED FROM ALL ITEMS"
"RTN","PRCHAMU",170,0)
 D EN^DDIOL(AA) W !
"RTN","PRCHAMU",171,0)
 QUIT
"RTN","PRCHAMU",172,0)
 ;
"RTN","PRCHAMU",173,0)
SOURCE ;This subroutine is called by PRCHMA
"RTN","PRCHAMU",174,0)
 ;Source code was changed to 2
"RTN","PRCHAMU",175,0)
 ;Remove contract number from $P2 and AC x-reference.
"RTN","PRCHAMU",176,0)
 KILL SCE
"RTN","PRCHAMU",177,0)
 N CONTRACT,ITEM S ITEM=0
"RTN","PRCHAMU",178,0)
 F  S ITEM=$O(^PRC(443.6,PRCHPO,2,ITEM)) Q:'ITEM  D
"RTN","PRCHAMU",179,0)
 .  S CONTRACT=$G(^PRC(443.6,PRCHPO,2,ITEM,2))
"RTN","PRCHAMU",180,0)
 .  S CONTRACT=$P(CONTRACT,U,2)
"RTN","PRCHAMU",181,0)
 .  Q:CONTRACT=""
"RTN","PRCHAMU",182,0)
 .  S $P(^PRC(443.6,PRCHPO,2,ITEM,2),U,2)=""
"RTN","PRCHAMU",183,0)
 .  KILL ^PRC(443.6,PRCHPO,2,"AC",CONTRACT,ITEM)
"RTN","PRCHAMU",184,0)
 ;
"RTN","PRCHAMU",185,0)
 QUIT
"RTN","PRCHINQ")
0^3^B9645635^B7598278
"RTN","PRCHINQ",1,0)
PRCHINQ ;WISC/AKS-Add/Edit Surrogate Users and inquire Card Info ;6/8/96  13:38
"RTN","PRCHINQ",2,0)
 ;;5.1;IFCAP;**18,117**;Oct 20, 2000;Build 2
"RTN","PRCHINQ",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHINQ",4,0)
 QUIT
"RTN","PRCHINQ",5,0)
 ;
"RTN","PRCHINQ",6,0)
INQ ;Display purchase card information and allow add/editting of users
"RTN","PRCHINQ",7,0)
 ;
"RTN","PRCHINQ",8,0)
 N PRCHDA
"RTN","PRCHINQ",9,0)
 S DIC="^PRC(440.5,",DIC(0)="AEQM"
"RTN","PRCHINQ",10,0)
 S DIC("S")="I $P(^PRC(440.5,+Y,0),U,8)=DUZ"
"RTN","PRCHINQ",11,0)
 D ^DIC W !
"RTN","PRCHINQ",12,0)
 S (PRCHDA,DA)=+Y,DR="0:49" D EN^DIQ,EN^DDIOL("REPLACEMENT CHARGE CARD NUMBER: "_$P($G(^PRC(440.5,DA,50)),"^")):$P($G(^PRC(440.5,DA,50)),"^")]"" G:Y=-1 EXIT
"RTN","PRCHINQ",13,0)
 S %A="Would you like to add/delete a surrogate",%B="",%=2
"RTN","PRCHINQ",14,0)
 D ^PRCFYN G:%<1!(%=2) EXIT
"RTN","PRCHINQ",15,0)
MORE S DA(1)=PRCHDA,DIC="^PRC(440.5,"_DA(1)_",1,",DIC(0)="AEQLM"
"RTN","PRCHINQ",16,0)
 S DIC("S")="I +Y'=DUZ"
"RTN","PRCHINQ",17,0)
 D ^DIC K DIC
"RTN","PRCHINQ",18,0)
 I $P(Y,U,3)'=1 D
"RTN","PRCHINQ",19,0)
 . S DA=+Y,DIK="^PRC(440.5,"_DA(1)_",1,"
"RTN","PRCHINQ",20,0)
 . D ^DIK K Y,DA,DIK
"RTN","PRCHINQ",21,0)
 S %A="Would you like to add/delete another surrogate",%B="",%=2
"RTN","PRCHINQ",22,0)
 D ^PRCFYN G:%<1!(%=2) EXIT G MORE
"RTN","PRCHINQ",23,0)
 QUIT
"RTN","PRCHINQ",24,0)
STAT ;Amendment/Adjustment statuses from the dd, called from field #50, sub-
"RTN","PRCHINQ",25,0)
 ;field #9 of file #443.6
"RTN","PRCHINQ",26,0)
 N MOPPC S MOPPC=0
"RTN","PRCHINQ",27,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,2)=25 S MOPPC=1
"RTN","PRCHINQ",28,0)
 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",29,0)
 S:MOPPC DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",30,0)
 ;I $G(PRCHAUTH)=1 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,Z1=51:1,1:0)"
"RTN","PRCHINQ",31,0)
 I $G(PRCHAUTH)=1 D
"RTN","PRCHINQ",32,0)
 . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=23:1,Z1=26:1,Z1=31:1,1:0)"
"RTN","PRCHINQ",33,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",34,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " D
"RTN","PRCHINQ",35,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=29:1,Z1=34:1,Z1=38:1,1:0)"
"RTN","PRCHINQ",36,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " D
"RTN","PRCHINQ",37,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",38,0)
 D ^DIC K DIC,PRCHOLD,MOPPC S DIC=DIE,X=+Y K:Y<0 X
"RTN","PRCHINQ",39,0)
 QUIT
"RTN","PRCHINQ",40,0)
EXIT ;Kill variables and quit
"RTN","PRCHINQ",41,0)
 K Y,%A,%B,%,DIC
"RTN","PRCHINQ",42,0)
 QUIT
"RTN","PRCHINQ",43,0)
STAT1 ;Called from field #50, subfield #9, file #443.6
"RTN","PRCHINQ",44,0)
 N MOPPC S MOPPC=0
"RTN","PRCHINQ",45,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,2)=25 S MOPPC=1
"RTN","PRCHINQ",46,0)
 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",47,0)
 S:MOPPC DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",48,0)
 ;I $G(PRCHAUTH)=1 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,Z1=51:1,1:0)"
"RTN","PRCHINQ",49,0)
 I $G(PRCHAUTH)=1 D
"RTN","PRCHINQ",50,0)
 . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=23:1,Z1=26:1,Z1=31:1,1:0)"
"RTN","PRCHINQ",51,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",52,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " D
"RTN","PRCHINQ",53,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=29:1,Z1=34:1,Z1=38:1,1:0)"
"RTN","PRCHINQ",54,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " D
"RTN","PRCHINQ",55,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",56,0)
 K PRCHOLD,MOPPC
"RTN","PRCHINQ",57,0)
 QUIT
"RTN","PRCHINQ",58,0)
PAID ;To check if there is any payment made for this PO
"RTN","PRCHINQ",59,0)
 I $G(PRCHAUTH)=1 D
"RTN","PRCHINQ",60,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",61,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " S PAID=1
"RTN","PRCHINQ",62,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " S PAID=1
"RTN","PRCHINQ",63,0)
 QUIT
"VER")
8.0^22.0
"BLD",5780,6)
^103
**END**
**END**
