Released PRC*5.1*112 SEQ #100
Extracted from mail message
**KIDS**:PRC*5.1*112^

**INSTALL NAME**
PRC*5.1*112
"BLD",5311,0)
PRC*5.1*112^IFCAP^0^3070913^y
"BLD",5311,1,0)
^^7^7^3070912^^^
"BLD",5311,1,1,0)
Patch PRC*5.1*112 fixes the following:
"BLD",5311,1,2,0)
a)  A rounding problem with some of the numbers in the CLO GIP
"BLD",5311,1,3,0)
    REPORTS (CLRS) report.
"BLD",5311,1,4,0)
b)  A <SYNTAX> error when a line item list doesn't exactly match
"BLD",5311,1,5,0)
    the requested format.
"BLD",5311,1,6,0)
c)  A cross reference in file 420.14 (PRCD FUND) which was causing
"BLD",5311,1,7,0)
    wrong records to be pulled up.
"BLD",5311,4,0)
^9.64PA^420.14^1
"BLD",5311,4,420.14,0)
420.14
"BLD",5311,4,420.14,2,0)
^9.641^420.14^1
"BLD",5311,4,420.14,2,420.14,0)
PRCD FUND  (File-top level)
"BLD",5311,4,420.14,2,420.14,1,0)
^9.6411^3^3
"BLD",5311,4,420.14,2,420.14,1,.01,0)
FUND
"BLD",5311,4,420.14,2,420.14,1,2,0)
BUDGET FISCAL YEAR BEGIN
"BLD",5311,4,420.14,2,420.14,1,3,0)
BUDGET FISCAL YEAR END
"BLD",5311,4,420.14,222)
y^y^p^^^^n^^n
"BLD",5311,4,420.14,224)

"BLD",5311,4,"APDD",420.14,420.14)

"BLD",5311,4,"APDD",420.14,420.14,.01)

"BLD",5311,4,"APDD",420.14,420.14,2)

"BLD",5311,4,"APDD",420.14,420.14,3)

"BLD",5311,4,"B",420.14,420.14)

"BLD",5311,6.3)
2
"BLD",5311,"ABPKG")
n
"BLD",5311,"INI")
PRE^PRC51112
"BLD",5311,"INID")
^y^n
"BLD",5311,"INIT")
POST^PRC51112
"BLD",5311,"KRN",0)
^9.67PA^8989.52^19
"BLD",5311,"KRN",.4,0)
.4
"BLD",5311,"KRN",.401,0)
.401
"BLD",5311,"KRN",.402,0)
.402
"BLD",5311,"KRN",.403,0)
.403
"BLD",5311,"KRN",.5,0)
.5
"BLD",5311,"KRN",.84,0)
.84
"BLD",5311,"KRN",3.6,0)
3.6
"BLD",5311,"KRN",3.8,0)
3.8
"BLD",5311,"KRN",9.2,0)
9.2
"BLD",5311,"KRN",9.8,0)
9.8
"BLD",5311,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5311,"KRN",9.8,"NM",1,0)
PRCPLO2A^^0^B56847706
"BLD",5311,"KRN",9.8,"NM",2,0)
PRCHNPO3^^0^B38584901
"BLD",5311,"KRN",9.8,"NM",3,0)
PRC51112^^0^B1935159
"BLD",5311,"KRN",9.8,"NM","B","PRC51112",3)

"BLD",5311,"KRN",9.8,"NM","B","PRCHNPO3",2)

"BLD",5311,"KRN",9.8,"NM","B","PRCPLO2A",1)

"BLD",5311,"KRN",19,0)
19
"BLD",5311,"KRN",19.1,0)
19.1
"BLD",5311,"KRN",101,0)
101
"BLD",5311,"KRN",409.61,0)
409.61
"BLD",5311,"KRN",771,0)
771
"BLD",5311,"KRN",870,0)
870
"BLD",5311,"KRN",8989.51,0)
8989.51
"BLD",5311,"KRN",8989.52,0)
8989.52
"BLD",5311,"KRN",8994,0)
8994
"BLD",5311,"KRN","B",.4,.4)

"BLD",5311,"KRN","B",.401,.401)

"BLD",5311,"KRN","B",.402,.402)

"BLD",5311,"KRN","B",.403,.403)

"BLD",5311,"KRN","B",.5,.5)

"BLD",5311,"KRN","B",.84,.84)

"BLD",5311,"KRN","B",3.6,3.6)

"BLD",5311,"KRN","B",3.8,3.8)

"BLD",5311,"KRN","B",9.2,9.2)

"BLD",5311,"KRN","B",9.8,9.8)

"BLD",5311,"KRN","B",19,19)

"BLD",5311,"KRN","B",19.1,19.1)

"BLD",5311,"KRN","B",101,101)

"BLD",5311,"KRN","B",409.61,409.61)

"BLD",5311,"KRN","B",771,771)

"BLD",5311,"KRN","B",870,870)

"BLD",5311,"KRN","B",8989.51,8989.51)

"BLD",5311,"KRN","B",8989.52,8989.52)

"BLD",5311,"KRN","B",8994,8994)

"BLD",5311,"QUES",0)
^9.62^^
"BLD",5311,"REQB",0)
^9.611^1^1
"BLD",5311,"REQB",1,0)
PRC*5.1*98^2
"BLD",5311,"REQB","B","PRC*5.1*98",1)

"FIA",420.14)
PRCD FUND
"FIA",420.14,0)
^PRCD(420.14,
"FIA",420.14,0,0)
420.14I
"FIA",420.14,0,1)
y^y^p^^^^n^^n
"FIA",420.14,0,10)

"FIA",420.14,0,11)

"FIA",420.14,0,"RLRO")

"FIA",420.14,0,"VR")
5.1^PRC
"FIA",420.14,420.14)
1
"FIA",420.14,420.14,.01)

"FIA",420.14,420.14,2)

"FIA",420.14,420.14,3)

"INI")
PRE^PRC51112
"INIT")
POST^PRC51112
"IX",420.14,420.14,"UNQ",0)
420.14^UNQ^Unique xref by Fund and beginning and ending Fiscal Years.^R^^R^IR^I^420.14^^^^^LS
"IX",420.14,420.14,"UNQ",.1,0)
^^2^2^3070910^
"IX",420.14,420.14,"UNQ",.1,1,0)
This cross reference provides a unique entry for every FUND and
"IX",420.14,420.14,"UNQ",.1,2,0)
FISCAL YEAR combination.
"IX",420.14,420.14,"UNQ",1)
S ^PRCD(420.14,"UNQ",$E(X(1),1,30),$E(X(2),1,4),$E(X(3),1,4),DA)=""
"IX",420.14,420.14,"UNQ",2)
K ^PRCD(420.14,"UNQ",$E(X(1),1,30),$E(X(2),1,4),$E(X(3),1,4),DA)
"IX",420.14,420.14,"UNQ",2.5)
K ^PRCD(420.14,"UNQ")
"IX",420.14,420.14,"UNQ",11.1,0)
^.114IA^3^3
"IX",420.14,420.14,"UNQ",11.1,1,0)
1^F^420.14^.01^30^1^F
"IX",420.14,420.14,"UNQ",11.1,1,3)

"IX",420.14,420.14,"UNQ",11.1,2,0)
2^F^420.14^2^4^2^F
"IX",420.14,420.14,"UNQ",11.1,2,3)

"IX",420.14,420.14,"UNQ",11.1,3,0)
3^F^420.14^3^4^3^F
"IX",420.14,420.14,"UNQ",11.1,3,3)

"KEY",420.14,420.14,"A",0)
420.14^A^P^358
"KEY",420.14,420.14,"A",2,0)
^.312IA^3^3
"KEY",420.14,420.14,"A",2,1,0)
.01^420.14^1
"KEY",420.14,420.14,"A",2,2,0)
2^420.14^2
"KEY",420.14,420.14,"A",2,3,0)
3^420.14^3
"KEYPTR",420.14,420.14,"A")
420.14^UNQ
"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
112^3070913
"PKG",455,22,1,"PAH",1,1,0)
^^7^7^3070913
"PKG",455,22,1,"PAH",1,1,1,0)
Patch PRC*5.1*112 fixes the following:
"PKG",455,22,1,"PAH",1,1,2,0)
a)  A rounding problem with some of the numbers in the CLO GIP
"PKG",455,22,1,"PAH",1,1,3,0)
    REPORTS (CLRS) report.
"PKG",455,22,1,"PAH",1,1,4,0)
b)  A <SYNTAX> error when a line item list doesn't exactly match
"PKG",455,22,1,"PAH",1,1,5,0)
    the requested format.
"PKG",455,22,1,"PAH",1,1,6,0)
c)  A cross reference in file 420.14 (PRCD FUND) which was causing
"PKG",455,22,1,"PAH",1,1,7,0)
    wrong records to be pulled up.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRC51112")
0^3^B1935159^n/a
"RTN","PRC51112",1,0)
PRC51112 ;VMP/TJH - PRE & POST INSTALL INDEX CLEAN-UP FOR *112; 09/13/2007
"RTN","PRC51112",2,0)
 ;;5.1;IFCAP;**112**;Oct 20, 2000;Build 2
"RTN","PRC51112",3,0)
 ;
"RTN","PRC51112",4,0)
TOP ; No entry at top
"RTN","PRC51112",5,0)
 Q
"RTN","PRC51112",6,0)
 ;
"RTN","PRC51112",7,0)
PRE ; Pre-install segment
"RTN","PRC51112",8,0)
 ; remove the UNQ, UNQ1 and UNQ3 xref definitions from the Data Dictionary
"RTN","PRC51112",9,0)
 ; and Kill the existing index entries.
"RTN","PRC51112",10,0)
 D BMES^XPDUTL("Removing old 'UNQ' cross reference.......")
"RTN","PRC51112",11,0)
 D DELIX^DDMOD(420.14,.01,"UNQ","K")
"RTN","PRC51112",12,0)
 D DELIX^DDMOD(420.14,2,"UNQ1","K",)
"RTN","PRC51112",13,0)
 D DELIX^DDMOD(420.14,3,"UNQ3","K",)
"RTN","PRC51112",14,0)
 ; if there are any 'dangling' entries in the index, remove them too
"RTN","PRC51112",15,0)
 N PRC D
"RTN","PRC51112",16,0)
 . Q:'$D(^PRCD(420.14,"UNQ"))
"RTN","PRC51112",17,0)
 . S PRC=""
"RTN","PRC51112",18,0)
 . F  S PRC=$O(^PRCD(420.14,"UNQ",PRC)) Q:PRC=""  K ^PRCD(420.14,"UNQ",PRC)
"RTN","PRC51112",19,0)
 D BMES^XPDUTL("Removal complete.")
"RTN","PRC51112",20,0)
 D MES^XPDUTL("Installing new cross reference definition.")
"RTN","PRC51112",21,0)
XPRE Q  ; end of Pre-install processing
"RTN","PRC51112",22,0)
 ;
"RTN","PRC51112",23,0)
 ;
"RTN","PRC51112",24,0)
POST ; Post-install segment
"RTN","PRC51112",25,0)
 ; re-index file 420.14 using the New Style "UNQ" xref
"RTN","PRC51112",26,0)
 D BMES^XPDUTL("New 'UNQ' definition installed.")
"RTN","PRC51112",27,0)
 D MES^XPDUTL("Re-indexing.....")
"RTN","PRC51112",28,0)
 S DIK="^PRCD(420.14,",DIK(1)=".01^UNQ"
"RTN","PRC51112",29,0)
 D ENALL^DIK
"RTN","PRC51112",30,0)
 D BMES^XPDUTL("New 'UNQ' cross reference complete.")
"RTN","PRC51112",31,0)
XPOST Q
"RTN","PRCHNPO3")
0^2^B38584901^B37402491
"RTN","PRCHNPO3",1,0)
PRCHNPO3 ;WISC/RSD/RHD/SC-CONT. OF NEW PO ; 4/23/99 1:39pm
"RTN","PRCHNPO3",2,0)
V ;;5.1;IFCAP;*112*;Oct 20, 2000;Build 2
"RTN","PRCHNPO3",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCHNPO3",4,0)
 ;
"RTN","PRCHNPO3",5,0)
 S PRCHSZ=1
"RTN","PRCHNPO3",6,0)
 ;
"RTN","PRCHNPO3",7,0)
EN0 W !,"Enter a 2237 reference number. The FCP,Cost Center,Service,Delivery",!?3,"Location" W:PRCHSZ " and Line Items" W " will be transferred into this Purchase Order."
"RTN","PRCHNPO3",8,0)
 W !!,?10,"The 2237 Fiscal Year and Quarter must be earlier or same",!,?10,"as the P.O. Date Fiscal Year and Quarter.",!
"RTN","PRCHNPO3",9,0)
 I $O(^PRC(442,PRCHPO,13,0)) W !?3,"This Purchase Order already contains:" F I=0:0 S I=$O(^PRC(442,PRCHPO,13,I)) Q:'I  I $D(^PRCS(410,I,0)) W !?3,$P(^(0),U,1)
"RTN","PRCHNPO3",10,0)
 I '$D(^PRC(442,PRCHPO,1)),$P(^(1),U,15)="" W !!,"Cannot precede without a P.O. DATE" G Q
"RTN","PRCHNPO3",11,0)
 ;
"RTN","PRCHNPO3",12,0)
EN K PRCHSY S PRCHD=$P(^PRC(442,PRCHPO,1),U,15),PRCHSP=$P(^(0),U,12)
"RTN","PRCHNPO3",13,0)
 ;screen-out the Issue Book order if status is 65--Assigned to PPM Clerk, for nois MWV-0293-20011
"RTN","PRCHNPO3",14,0)
 S DIC="^PRC(443,"
"RTN","PRCHNPO3",15,0)
 S DIC(0)="AQEMZ"
"RTN","PRCHNPO3",16,0)
 I $G(PRCHZZZ9)'=1 S DIC("S")="I $P(^(0),U,3)]"""",""65,72""'[$P(^(0),U,7),$D(^PRCS(410,+Y,0)),+^(0)=PRC(""SITE""),$P(^(0),U,2)=""O"",$P(^(0),U,4)'=5,$D(^(""IT"",""AB"")) D EN3^PRCHNPO6"
"RTN","PRCHNPO3",17,0)
 I $G(PRCHZZZ9)=1 S DIC("S")="I $P(^(0),U,3)]"""",$P(^(0),U,7)=65,$D(^PRCS(410,+Y,0)),+^(0)=PRC(""SITE""),$P(^(0),U,2)=""O"",$P(^(0),U,4)'=5,$D(^(""IT"",""AB"")) D EN3^PRCHNPO6"
"RTN","PRCHNPO3",18,0)
 D ^DIC K DIC G:Y<0 Q S PRCHSY=+Y,PRCHSY(0)=Y(0),Y(0)=^PRCS(410,+Y,0),PRCHSX=$P(Y(0),U,1) I $D(^(1)),$P(^(1),U,3)="EM" W $C(7),!,"*** EMERGENCY ***"
"RTN","PRCHNPO3",19,0)
 ;I $D(^PRCS(410,+Y,0)),$P(^(0),U,4)=5 W !?3,"This is an Issue Book Order, and it can't be processed into a Purchase Order." Q
"RTN","PRCHNPO3",20,0)
 ;
"RTN","PRCHNPO3",21,0)
EN1 S PRCHRFQT=$$DATE^PRC0C($P(Y(0),"^",11),"I"),PRCHRFQT=$P(PRCHRFQT,U,1,2)
"RTN","PRCHNPO3",22,0)
 S PRC("BBFY")=+$$DATE^PRC0C($P(^PRCS(410,+Y,3),"^",11),"I")
"RTN","PRCHNPO3",23,0)
 ;S PRCHCFQT=$$DATE^PRC0C($P(^PRC(420,PRC("SITE"),0),U,9),"I"),PRCHCFQT=$P(PRCHCFQT,U,1,2)
"RTN","PRCHNPO3",24,0)
 S PRCHPFQT=$$DATE^PRC0C($P(^PRC(442,PRCHPO,1),"^",15),"I"),PRCHPFQT=$P(PRCHPFQT,U,1,2)
"RTN","PRCHNPO3",25,0)
 I PRCHRFQT'=PRCHPFQT W !,?10,"The Fiscal Year and Quarter on this 2237 is not",!,?10,"compatible with the PO Date.",!,$C(7) K PRCHRFQT,PRCHPFQT G EN
"RTN","PRCHNPO3",26,0)
 K PRCHRFQT,PRCHPFQT
"RTN","PRCHNPO3",27,0)
 I $P(^PRC(442,PRCHPO,0),U,3)]"",+$P(^PRC(442,PRCHPO,0),U,3)'=+$P(^PRCS(410,PRCHSY,3),U,1) W !?3,"Fund Control Point for this 2237 doesn't match the existing FCP in P.O.",$C(7) G EN
"RTN","PRCHNPO3",28,0)
 I $P(^PRC(442,PRCHPO,0),U,5)]"",+$P(^PRC(442,PRCHPO,0),U,5)'=+$P(^PRCS(410,PRCHSY,3),U,3) W !?3,"Cost Center for this 2237 doesn't match the Cost Center in P.O.",$C(7) G EN
"RTN","PRCHNPO3",29,0)
 S X="",Z="" I $D(^PRC(420,PRC("SITE"),1,+^PRCS(410,PRCHSY,3),0)) S X=$P(^(0),U,12),Z=$P(^(0),U,18)
"RTN","PRCHNPO3",30,0)
 I X'=2 S:Z'="" $P(^PRC(442,PRCHPO,17),U,1)=$E(Z,1,3) I Z="" W $C(7),!?3,"Fund Control point is missing LOG Department Number!!" G EN
"RTN","PRCHNPO3",31,0)
 I X I PRCHN("MP")=4!((X=3)&(PRCHN("MP")=3)) S Y=$P(^PRCD(442.5,PRCHN("MP"),0),U,1) W $C(7),!?3,"This Fund Control Point is not valid for a "_Y_" order." G EN
"RTN","PRCHNPO3",32,0)
 S EN=0 I $D(^PRC(411,"UP",PRC("SITE"))) D  G EN:EN=1
"RTN","PRCHNPO3",33,0)
 .I $P($G(^PRCS(410,+Y,0)),U,10)="" W $C(7),!!?3,"This 2237 does not have a substation.",! S EN=1 Q
"RTN","PRCHNPO3",34,0)
 .I $P($G(^PRCS(410,+Y,0)),U,10)'=$P($G(^PRC(442,PRCHPO,23)),U,7) W $C(7),!!?3,"The substation on this 2237 does not match the substation entered",!?3,"on this "_$S($D(PRCHNRQ):"requisition.",1:"purchase order."),! S EN=1
"RTN","PRCHNPO3",35,0)
 D SPRMK^PRCHNPO6
"RTN","PRCHNPO3",36,0)
 ;
"RTN","PRCHNPO3",37,0)
N Q:'PRCHSZ  K ^TMP($J,"PRCHS"),PRCHSIT S J=0,K=1,PRCHSIT(K)="" G:$D(PRCHPOST) 1
"RTN","PRCHNPO3",38,0)
 W !?3,"Line Items: " R PRCHX:DTIME G Q:PRCHX["^"!(PRCHX=""),HLP:$E(PRCHX)="?",1:"Aa"[$E(PRCHX)
"RTN","PRCHNPO3",39,0)
 F  Q:'$F(PRCHX,",,")  S PRCHX=$P(PRCHX,",,",1)_","_$P(PRCHX,",,",2,99) ; *112 remove consecutive commas
"RTN","PRCHNPO3",40,0)
 S:$E(PRCHX)="," PRCHX=$E(PRCHX,2,$L(PRCHX)) ; *112 remove leading comma
"RTN","PRCHNPO3",41,0)
 S:$E(PRCHX,$L(PRCHX))="," PRCHX=$E(PRCHX,1,$L(PRCHX)-1) ; *112 remove trailing comma
"RTN","PRCHNPO3",42,0)
 F I=1:1 S X=$P(PRCHX,",",I) Q:X=""  I +X'=X S X(1)=$P(X,":",1),X(2)=$P(X,":",2) K:+X(1)'=X(1)!(+X(2)'=X(2))!'(X(1)<X(2)) PRCHX Q:'$D(PRCHX)  S $P(PRCHX,",",I)=X(1)_":1:"_X(2)
"RTN","PRCHNPO3",43,0)
 I '$D(PRCHX) W " ??",$C(7) G N
"RTN","PRCHNPO3",44,0)
 X "F I="_PRCHX_" D IT Q:'$O(^TMP($J,""PRCHS"",0))" G:'$O(^TMP($J,"PRCHS",0)) N S ^(0)=J
"RTN","PRCHNPO3",45,0)
 ;
"RTN","PRCHNPO3",46,0)
3 G 2:J=+^PRCS(410,PRCHSY,10),Q:'$O(^TMP($J,"PRCHS",0)) W !,"A new 2237 will now be created with the following items: " F K=0:0 S K=$O(PRCHSIT(K)) Q:'K  W !?3,PRCHSIT(K)
"RTN","PRCHNPO3",47,0)
 S %A="     Do you wish to proceed",%B="",%=1 D ^PRCFYN I %'=1 G N
"RTN","PRCHNPO3",48,0)
 Q:$D(PRCHG)  S PRCHSIT=J,PRCHS=PRCHSY D WAIT^DICD,^PRCHSP D:PRCHSY=-1 ERR D:PRCHSY=-3 ERR1 D:PRCHSY=-2 ERR2 G:PRCHSY<0 EN D EN4^PRCHNPO2
"RTN","PRCHNPO3",49,0)
 G EN
"RTN","PRCHNPO3",50,0)
 ;
"RTN","PRCHNPO3",51,0)
1 S I=0 F  S I=$O(^PRCS(410,PRCHSY,"IT","AB",I)) Q:I=""  D IT
"RTN","PRCHNPO3",52,0)
 S:$O(^TMP($J,"PRCHS",0)) ^(0)=J
"RTN","PRCHNPO3",53,0)
 G 3
"RTN","PRCHNPO3",54,0)
 ;
"RTN","PRCHNPO3",55,0)
2 Q:$D(PRCHG)  S PRCHSIT=J,PRCHS="" D WAIT^DICD,^PRCHSP1
"RTN","PRCHNPO3",56,0)
 D:PRCHSY=-1 ERR
"RTN","PRCHNPO3",57,0)
 D:PRCHSY=-2 ERR2
"RTN","PRCHNPO3",58,0)
 D:PRCHSY=-3 ERR1
"RTN","PRCHNPO3",59,0)
 G:PRCHSY<0 EN
"RTN","PRCHNPO3",60,0)
 D EN4^PRCHNPO2
"RTN","PRCHNPO3",61,0)
 G EN
"RTN","PRCHNPO3",62,0)
 ;
"RTN","PRCHNPO3",63,0)
IT I $D(^PRCS(410,PRCHSY,"IT","AB",I)),$D(^PRCS(410,PRCHSY,"IT",$O(^(I,0)),0)) S ^TMP($J,"PRCHS",I)="",J=J+1 S:$L(PRCHSIT(K))>72 K=K+1,PRCHSIT(K)="" S PRCHSIT(K)=PRCHSIT(K)_I_"," Q
"RTN","PRCHNPO3",64,0)
 W !?5,"** ",I," IS AN INVALID LINE ITEM NUMBER",$C(7) K ^TMP($J,"PRCHS")
"RTN","PRCHNPO3",65,0)
 Q
"RTN","PRCHNPO3",66,0)
 ;
"RTN","PRCHNPO3",67,0)
HLP W !?3,"ENTER A LINE ITEM NUMBER IN THE FOLLOWING FORMAT:  1,2,3,4 OR 1:4 ",!?5," OR ENTER 'A' FOR ALL LINE ITEMS " S DIC="^PRCS(410,+PRCHSY,""IT"",",DIC(0)="E",X="??",D="AB" D IX^DIC K DIC G N
"RTN","PRCHNPO3",68,0)
 Q
"RTN","PRCHNPO3",69,0)
 ;
"RTN","PRCHNPO3",70,0)
Q S (DA,D0)=PRCHPO K C,DIC,X,PRCH,PRCHD,PRCHS,PRCHSP,PRCHSIT,PRCHJ,PRCHK,PRCHSLI,PRCHSX,PRCHSY,PRCHSZ,PRCHX,^TMP($J,"PRCHS"),EN,Y
"RTN","PRCHNPO3",71,0)
 S:0 Y="@1" ;<<< Removed the SET Y="@1" from this routine and put it into the template PRCH2138. <<<
"RTN","PRCHNPO3",72,0)
 Q
"RTN","PRCHNPO3",73,0)
 ;
"RTN","PRCHNPO3",74,0)
DT S X="T" D ^%DT S DT=Y
"RTN","PRCHNPO3",75,0)
 Q
"RTN","PRCHNPO3",76,0)
 ;
"RTN","PRCHNPO3",77,0)
EN2 ;CHECKS FCP PARAMETERS & SET Y, CALLED FROM PRCH2138,PRCHIFREG
"RTN","PRCHNPO3",78,0)
 S PRCHN("SFC")=+$P(^PRC(442,DA,0),"^",19)
"RTN","PRCHNPO3",79,0)
 S $P(^PRC(442,DA,18),U,2)=$S((PRCHN("SFC")=2)&(PRCHN("MP")=12):"B",PRCHN("SFC")=2:"A",PRCHN("SFC")=3:"J",1:"")
"RTN","PRCHNPO3",80,0)
 Q
"RTN","PRCHNPO3",81,0)
 ;
"RTN","PRCHNPO3",82,0)
ERR W !,$C(7),"Cannot get a transaction number at this time for the new transaction being split",!,"out.  Try again later!"
"RTN","PRCHNPO3",83,0)
 Q
"RTN","PRCHNPO3",84,0)
 ;
"RTN","PRCHNPO3",85,0)
ERR1 W !,$C(7),"Cannot find the 2237 you selected in file 410."
"RTN","PRCHNPO3",86,0)
 Q
"RTN","PRCHNPO3",87,0)
 ;
"RTN","PRCHNPO3",88,0)
ERR2 W !,$C(7),"Not continuing with this 2237."
"RTN","PRCHNPO3",89,0)
 Q
"RTN","PRCHNPO3",90,0)
 ;
"RTN","PRCHNPO3",91,0)
VENMSG ;message to alert users that vendors don't match and that IMF will
"RTN","PRCHNPO3",92,0)
 ;be updated.
"RTN","PRCHNPO3",93,0)
 W !!,"NOTE-Vendors on PO and 2237 don't match.  If you proceed IMF info"," will be used.  If there is no IMF entry for the item for this vendor one will ","be created."
"RTN","PRCHNPO3",94,0)
 N % S %=0
"RTN","PRCHNPO3",95,0)
 W !,"Would you like to proceed" D YN^DICN W !! I %'=1 S PRCHFLG=1
"RTN","PRCHNPO3",96,0)
 Q
"RTN","PRCPLO2A")
0^1^B56847706^B60268350
"RTN","PRCPLO2A",1,0)
PRCPLO2A ;WOIFO/DAP-stock status report (cont) ; 1/26/06 12:00pm
"RTN","PRCPLO2A",2,0)
V ;;5.1;IFCAP;**83,98,112**;Oct 20, 2000;Build 2
"RTN","PRCPLO2A",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCPLO2A",4,0)
 ;External reference to $$GET1^DIQ(4, is supported by ICR# 10090
"RTN","PRCPLO2A",5,0)
 ; *112 changes by: VMP, Holloway,T.
"RTN","PRCPLO2A",6,0)
 ;
"RTN","PRCPLO2A",7,0)
ENT ;*83 Building ^TMP with total result data, totaling logic pulled from PRCPRSS0
"RTN","PRCPLO2A",8,0)
 N PRCPIN,PRCPIN1,PRCPIN2,PRCPIN3,TOTVAL,TOTCLOS,TOTCLO1,TOTCLO2,SSRIEN
"RTN","PRCPLO2A",9,0)
 S U="^",STA=PRC("SITE"),INV=PRCP("I")
"RTN","PRCPLO2A",10,0)
 ;
"RTN","PRCPLO2A",11,0)
SSR1 ;*98 First Stock Status Report data field set
"RTN","PRCPLO2A",12,0)
 ;
"RTN","PRCPLO2A",13,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,1)=STA ;Station #
"RTN","PRCPLO2A",14,0)
 S DATRN=$$FMTE^XLFDT(DATESTRT)
"RTN","PRCPLO2A",15,0)
 S DATRN1=$P(DATRN," ",1)_","_$P(DATRN," ",2)
"RTN","PRCPLO2A",16,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,2)=DATRN1 ;Date Range
"RTN","PRCPLO2A",17,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,3)=INARNG ;Inactivity Range
"RTN","PRCPLO2A",18,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,4)=INV ;Inventory Point #
"RTN","PRCPLO2A",19,0)
 ;*83 Retrieve external inventory point name and primary/secondary/
"RTN","PRCPLO2A",20,0)
 ;warehouse indicator
"RTN","PRCPLO2A",21,0)
 S PRCPIN=$G(^PRCP(445,INV,0))
"RTN","PRCPLO2A",22,0)
 I PRCPIN'="" S PRCPIN1=$P(PRCPIN,"^",1),PRCPIN2=$P(PRCPIN1,"-",2,99)
"RTN","PRCPLO2A",23,0)
 I PRCPIN'="" S PRCPIN3=$P(PRCPIN,"^",3)
"RTN","PRCPLO2A",24,0)
 I PRCPIN="" S PRCPIN2="",PRCPIN3=""
"RTN","PRCPLO2A",25,0)
 S PRCPIN2=$TR(PRCPIN2,"*","|")  ; Needed due to "*" delimiter
"RTN","PRCPLO2A",26,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,5)=PRCPIN2 ;Inventory Point Name
"RTN","PRCPLO2A",27,0)
 S $P(^TMP($J,"PRCPSSR1",STA,INV),U,6)=PRCPIN3 ;P/S/W Indicator
"RTN","PRCPLO2A",28,0)
 ;
"RTN","PRCPLO2A",29,0)
 S PRCPDX=$TR(^TMP($J,"PRCPSSR1",STA,INV),"^","*"),DR="3///"_PRCPDX
"RTN","PRCPLO2A",30,0)
 D FILE
"RTN","PRCPLO2A",31,0)
 ;
"RTN","PRCPLO2A",32,0)
SSR2 ;*98 Second Stock Status Report data field set
"RTN","PRCPLO2A",33,0)
 ;
"RTN","PRCPLO2A",34,0)
 S TOTOPEN=0 F ACCT=1,2,3,6,8 S %=$P($G(^TMP($J,1,"OPEN",ACCT)),U,2),TOTOPEN=TOTOPEN+%
"RTN","PRCPLO2A",35,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,1)=TOTOPEN ;Std. Open Balance Total $
"RTN","PRCPLO2A",36,0)
 S TOTOPEN=0 F ACCT=1,2,3,6,8 S %=$P($G(^TMP($J,2,"OPEN",ACCT)),U,2),TOTOPEN=TOTOPEN+%
"RTN","PRCPLO2A",37,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,2)=TOTOPEN ;ODI Open Balance Total $
"RTN","PRCPLO2A",38,0)
 S TOTOPEN=0 F ACCT=1,2,3,6,8 S %=$P($G(^TMP($J,3,"OPEN",ACCT)),U,2),TOTOPEN=TOTOPEN+%
"RTN","PRCPLO2A",39,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,3)=TOTOPEN ;All Open Balance Total $
"RTN","PRCPLO2A",40,0)
 ;
"RTN","PRCPLO2A",41,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,4)=+$G(^TMP($J,1,"REC","TOTAL"))
"RTN","PRCPLO2A",42,0)
 ;Std. Receipts Total $
"RTN","PRCPLO2A",43,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,5)=+$G(^TMP($J,2,"REC","TOTAL"))
"RTN","PRCPLO2A",44,0)
 ;ODI Receipts Total $
"RTN","PRCPLO2A",45,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,6)=+$G(^TMP($J,3,"REC","TOTAL"))
"RTN","PRCPLO2A",46,0)
 ;All Receipts Total $
"RTN","PRCPLO2A",47,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,7)=+$G(^TMP($J,1,"ISS","TOTAL"))
"RTN","PRCPLO2A",48,0)
 ;Std. Usages Total $
"RTN","PRCPLO2A",49,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,8)=+$G(^TMP($J,2,"ISS","TOTAL"))
"RTN","PRCPLO2A",50,0)
 ;ODI Usages Total $
"RTN","PRCPLO2A",51,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,9)=+$G(^TMP($J,3,"ISS","TOTAL"))
"RTN","PRCPLO2A",52,0)
 ;All Usages Total $
"RTN","PRCPLO2A",53,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,10)=+$G(^TMP($J,1,"ADJ","TOTAL"))
"RTN","PRCPLO2A",54,0)
 ;Std. Adjustments Total $
"RTN","PRCPLO2A",55,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,11)=+$G(^TMP($J,2,"ADJ","TOTAL"))
"RTN","PRCPLO2A",56,0)
 ;ODI Adjustments Total $
"RTN","PRCPLO2A",57,0)
 S $P(^TMP($J,"PRCPSSR2",STA,INV),U,12)=+$G(^TMP($J,3,"ADJ","TOTAL"))
"RTN","PRCPLO2A",58,0)
 ;All Adjustments Total $
"RTN","PRCPLO2A",59,0)
 ;
"RTN","PRCPLO2A",60,0)
 S PRCPDX=$TR(^TMP($J,"PRCPSSR2",STA,INV),"^","*"),DR="4///"_PRCPDX
"RTN","PRCPLO2A",61,0)
 D FILE
"RTN","PRCPLO2A",62,0)
 ;
"RTN","PRCPLO2A",63,0)
SSR3 ;*98 Third Stock Status Report data field set
"RTN","PRCPLO2A",64,0)
 ;
"RTN","PRCPLO2A",65,0)
 S TOTCLOS=0
"RTN","PRCPLO2A",66,0)
 S TOTCLOS=$P($G(^TMP($J,"PRCPSSR2",STA,INV)),U,1)+$G(^TMP($J,1,"REC","TOTAL"))
"RTN","PRCPLO2A",67,0)
 S TOTCLOS=TOTCLOS+$G(^TMP($J,1,"ISS","TOTAL"))+$G(^TMP($J,1,"ADJ","TOTAL"))
"RTN","PRCPLO2A",68,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,1)=TOTCLOS ;Std. Closing Bal Total $
"RTN","PRCPLO2A",69,0)
 S TOTCLO1=0
"RTN","PRCPLO2A",70,0)
 S TOTCLO1=$P($G(^TMP($J,"PRCPSSR2",STA,INV)),U,2)+$G(^TMP($J,2,"REC","TOTAL"))
"RTN","PRCPLO2A",71,0)
 S TOTCLO1=TOTCLO1+$G(^TMP($J,2,"ISS","TOTAL"))+$G(^TMP($J,2,"ADJ","TOTAL"))
"RTN","PRCPLO2A",72,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,2)=TOTCLO1 ;ODI Closing Bal Total $
"RTN","PRCPLO2A",73,0)
 S TOTCLO2=0
"RTN","PRCPLO2A",74,0)
 S TOTCLO2=$P($G(^TMP($J,"PRCPSSR2",STA,INV)),U,3)+$G(^TMP($J,3,"REC","TOTAL"))
"RTN","PRCPLO2A",75,0)
 S TOTCLO2=TOTCLO2+$G(^TMP($J,3,"ISS","TOTAL"))+$G(^TMP($J,3,"ADJ","TOTAL"))
"RTN","PRCPLO2A",76,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,3)=TOTCLO2 ;All Closing Bal Total $
"RTN","PRCPLO2A",77,0)
 ;
"RTN","PRCPLO2A",78,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,4)=+$G(^TMP($J,1,"RECN","TOTAL"))
"RTN","PRCPLO2A",79,0)
 ;# Std. Receipts
"RTN","PRCPLO2A",80,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,5)=+$G(^TMP($J,2,"RECN","TOTAL"))
"RTN","PRCPLO2A",81,0)
 ;# ODI Receipts
"RTN","PRCPLO2A",82,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,6)=+$G(^TMP($J,3,"RECN","TOTAL"))
"RTN","PRCPLO2A",83,0)
 ;# All Receipts
"RTN","PRCPLO2A",84,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,7)=+$G(^TMP($J,1,"ISSN","TOTAL"))
"RTN","PRCPLO2A",85,0)
 ;# Std. Issues
"RTN","PRCPLO2A",86,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,8)=+$G(^TMP($J,2,"ISSN","TOTAL"))
"RTN","PRCPLO2A",87,0)
 ;# ODI Issues
"RTN","PRCPLO2A",88,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,9)=+$G(^TMP($J,3,"ISSN","TOTAL"))
"RTN","PRCPLO2A",89,0)
 ;# All Issues
"RTN","PRCPLO2A",90,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,10)=+$G(^TMP($J,1,"ADJN","TOTAL"))
"RTN","PRCPLO2A",91,0)
 ;# Std. Adjustments
"RTN","PRCPLO2A",92,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,11)=+$G(^TMP($J,2,"ADJN","TOTAL"))
"RTN","PRCPLO2A",93,0)
 ;# ODI Adjustments
"RTN","PRCPLO2A",94,0)
 S $P(^TMP($J,"PRCPSSR3",STA,INV),U,12)=+$G(^TMP($J,3,"ADJN","TOTAL"))
"RTN","PRCPLO2A",95,0)
 ;# All Adjustments
"RTN","PRCPLO2A",96,0)
 ;
"RTN","PRCPLO2A",97,0)
 S PRCPDX=$TR(^TMP($J,"PRCPSSR3",STA,INV),"^","*"),DR="5///"_PRCPDX
"RTN","PRCPLO2A",98,0)
 D FILE
"RTN","PRCPLO2A",99,0)
 ;
"RTN","PRCPLO2A",100,0)
SSR4 ;*98 Fourth Stock Status Report data field set
"RTN","PRCPLO2A",101,0)
 ;
"RTN","PRCPLO2A",102,0)
 ;*83 Turnover computation logic also pulled from PRCPRSS0
"RTN","PRCPLO2A",103,0)
 S DAYS=$P("31^28^31^30^31^30^31^31^30^31^30^31",U,+$E(DATESTRT,4,5))
"RTN","PRCPLO2A",104,0)
 I DAYS=28 S %=(17+$E(DATESTRT))_$E(DATESTRT,2,3),DAYS=$S(%#400=0:29,(%#4=0&(%#100'=0)):29,1:28)
"RTN","PRCPLO2A",105,0)
 ;
"RTN","PRCPLO2A",106,0)
 S %=($G(^TMP($J,1,"ISS","TOTAL"))*365)/DAYS,%=$S('TOTCLOS:0,1:-%/TOTCLOS)
"RTN","PRCPLO2A",107,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,1)=$J(%,0,2)
"RTN","PRCPLO2A",108,0)
 ;Std. Turnover
"RTN","PRCPLO2A",109,0)
 S %=($G(^TMP($J,2,"ISS","TOTAL"))*365)/DAYS,%=$S('TOTCLO1:0,1:-%/TOTCLO1)
"RTN","PRCPLO2A",110,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,2)=$J(%,0,2)
"RTN","PRCPLO2A",111,0)
 ;ODI Turnover
"RTN","PRCPLO2A",112,0)
 S %=($G(^TMP($J,3,"ISS","TOTAL"))*365)/DAYS,%=$S('TOTCLO2:0,1:-%/TOTCLO2)
"RTN","PRCPLO2A",113,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,3)=$J(%,0,2)
"RTN","PRCPLO2A",114,0)
 ;All Turnover
"RTN","PRCPLO2A",115,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,4)=+$G(^TMP($J,1,"INACTN","TOTAL"))
"RTN","PRCPLO2A",116,0)
 ;# Std. Inactive
"RTN","PRCPLO2A",117,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,5)=+$G(^TMP($J,2,"INACTN","TOTAL"))
"RTN","PRCPLO2A",118,0)
 ;# ODI Inactive
"RTN","PRCPLO2A",119,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,6)=+$G(^TMP($J,3,"INACTN","TOTAL"))
"RTN","PRCPLO2A",120,0)
 ;# All Inactive
"RTN","PRCPLO2A",121,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,7)=+$G(^TMP($J,1,"INACT","TOTAL"))
"RTN","PRCPLO2A",122,0)
 ;Std Inactive Total $
"RTN","PRCPLO2A",123,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,8)=+$G(^TMP($J,2,"INACT","TOTAL"))
"RTN","PRCPLO2A",124,0)
 ;ODI Inactive Total $
"RTN","PRCPLO2A",125,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,9)=+$G(^TMP($J,3,"INACT","TOTAL"))
"RTN","PRCPLO2A",126,0)
 ;All Inactive Total $
"RTN","PRCPLO2A",127,0)
 ;
"RTN","PRCPLO2A",128,0)
 S %=$S('$G(^TMP($J,1,"VALUE","TOTAL")):0,1:$G(^TMP($J,1,"INACT","TOTAL"))/$G(^TMP($J,1,"VALUE","TOTAL")))
"RTN","PRCPLO2A",129,0)
 I %="" S %=0
"RTN","PRCPLO2A",130,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,10)=$J(%,0,2)
"RTN","PRCPLO2A",131,0)
 ;Std. Inactive %
"RTN","PRCPLO2A",132,0)
 S %=$S('$G(^TMP($J,2,"VALUE","TOTAL")):0,1:$G(^TMP($J,2,"INACT","TOTAL"))/$G(^TMP($J,2,"VALUE","TOTAL")))
"RTN","PRCPLO2A",133,0)
 I %="" S %=0
"RTN","PRCPLO2A",134,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,11)=$J(%,0,2)
"RTN","PRCPLO2A",135,0)
 ;ODI Inactive %
"RTN","PRCPLO2A",136,0)
 S %=$S('$G(^TMP($J,3,"VALUE","TOTAL")):0,1:$G(^TMP($J,3,"INACT","TOTAL"))/$G(^TMP($J,3,"VALUE","TOTAL")))
"RTN","PRCPLO2A",137,0)
 I %="" S %=0
"RTN","PRCPLO2A",138,0)
 S $P(^TMP($J,"PRCPSSR4",STA,INV),U,12)=$J(%,0,2)
"RTN","PRCPLO2A",139,0)
 ;All Inactive %
"RTN","PRCPLO2A",140,0)
 ;
"RTN","PRCPLO2A",141,0)
 S PRCPDX=$TR(^TMP($J,"PRCPSSR4",STA,INV),"^","*"),DR="6///"_PRCPDX
"RTN","PRCPLO2A",142,0)
 D FILE
"RTN","PRCPLO2A",143,0)
 ;
"RTN","PRCPLO2A",144,0)
SSR5 ;*98 Fifth Stock Status Report data field set
"RTN","PRCPLO2A",145,0)
 ;
"RTN","PRCPLO2A",146,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,1)=+$G(^TMP($J,1,"LONGN","TOTAL"))
"RTN","PRCPLO2A",147,0)
 ;# Std. Long Supply
"RTN","PRCPLO2A",148,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,2)=+$G(^TMP($J,2,"LONGN","TOTAL"))
"RTN","PRCPLO2A",149,0)
 ;# ODI Long Supply
"RTN","PRCPLO2A",150,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,3)=+$G(^TMP($J,3,"LONGN","TOTAL"))
"RTN","PRCPLO2A",151,0)
 ;# All Long Supply
"RTN","PRCPLO2A",152,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,4)=+$G(^TMP($J,1,"LONG","TOTAL"))
"RTN","PRCPLO2A",153,0)
 ;Std. Long Supply Total $
"RTN","PRCPLO2A",154,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,5)=+$G(^TMP($J,2,"LONG","TOTAL"))
"RTN","PRCPLO2A",155,0)
 ;ODI Long Supply Total $
"RTN","PRCPLO2A",156,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,6)=+$G(^TMP($J,3,"LONG","TOTAL"))
"RTN","PRCPLO2A",157,0)
 ;All Long Supply Total $
"RTN","PRCPLO2A",158,0)
 ;
"RTN","PRCPLO2A",159,0)
 S %=$S('$G(^TMP($J,1,"VALUE","TOTAL")):0,1:$G(^TMP($J,1,"LONG","TOTAL"))/$G(^TMP($J,1,"VALUE","TOTAL")))
"RTN","PRCPLO2A",160,0)
 I %="" S %=0
"RTN","PRCPLO2A",161,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,7)=$J(%,0,2)
"RTN","PRCPLO2A",162,0)
 ;Std. Long Supply %
"RTN","PRCPLO2A",163,0)
 S %=$S('$G(^TMP($J,2,"VALUE","TOTAL")):0,1:$G(^TMP($J,2,"LONG","TOTAL"))/$G(^TMP($J,2,"VALUE","TOTAL")))
"RTN","PRCPLO2A",164,0)
 I %="" S %=0
"RTN","PRCPLO2A",165,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,8)=$J(%,0,2)
"RTN","PRCPLO2A",166,0)
 ;ODI Long Supply %
"RTN","PRCPLO2A",167,0)
 S %=$S('$G(^TMP($J,3,"VALUE","TOTAL")):0,1:$G(^TMP($J,3,"LONG","TOTAL"))/$G(^TMP($J,3,"VALUE","TOTAL")))
"RTN","PRCPLO2A",168,0)
 I %="" S %=0
"RTN","PRCPLO2A",169,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,9)=$J(%,0,2)
"RTN","PRCPLO2A",170,0)
 ;All Long Supply %
"RTN","PRCPLO2A",171,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,10)=+$G(^TMP($J,1,"CNT","TOTAL"))
"RTN","PRCPLO2A",172,0)
 ;# Std. Items
"RTN","PRCPLO2A",173,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,11)=+$G(^TMP($J,2,"CNT","TOTAL"))
"RTN","PRCPLO2A",174,0)
 ;# On-Demand Items
"RTN","PRCPLO2A",175,0)
 S $P(^TMP($J,"PRCPSSR5",STA,INV),U,12)=+$G(^TMP($J,3,"CNT","TOTAL"))
"RTN","PRCPLO2A",176,0)
 ;# All Items
"RTN","PRCPLO2A",177,0)
 ;
"RTN","PRCPLO2A",178,0)
 S PRCPDX=$TR(^TMP($J,"PRCPSSR5",STA,INV),"^","*"),DR="7///"_PRCPDX
"RTN","PRCPLO2A",179,0)
 D FILE
"RTN","PRCPLO2A",180,0)
 K Y
"RTN","PRCPLO2A",181,0)
 ;
"RTN","PRCPLO2A",182,0)
 Q
"RTN","PRCPLO2A",183,0)
 ;
"RTN","PRCPLO2A",184,0)
 ;*98 Created filing subroutine
"RTN","PRCPLO2A",185,0)
FILE ; Subroutine that creates entries in File #446.7 fields as they 
"RTN","PRCPLO2A",186,0)
 ; are created
"RTN","PRCPLO2A",187,0)
 ;
"RTN","PRCPLO2A",188,0)
 N PRCPDR,PRCPSNM,PRCPDA,PRCPDX,X,Y
"RTN","PRCPLO2A",189,0)
 S PRCPDR=DR
"RTN","PRCPLO2A",190,0)
 S SSRIEN=STA_INV
"RTN","PRCPLO2A",191,0)
 S DIC="^PRCP(446.7,",DIC(0)="L",DLAYGO=446.7,X=SSRIEN D ^DIC K DIC,DLAYGO
"RTN","PRCPLO2A",192,0)
 S PRCPDA=Y+0
"RTN","PRCPLO2A",193,0)
 ;*98 Send enhanced mail message if exception occurs during FileMan set
"RTN","PRCPLO2A",194,0)
 I Y=-1 N PRCPMSG D  Q
"RTN","PRCPLO2A",195,0)
 . S PRCPMSG(1)="Error saving to File #446.7 for Stock Status Report, related data: "
"RTN","PRCPLO2A",196,0)
 . S PRCPSNM=$$GET1^DIQ(4,STA_",",.01)
"RTN","PRCPLO2A",197,0)
 . S PRCPMSG(2)="",PRCPMSG(3)="Station: "_STA_" "_PRCPSNM
"RTN","PRCPLO2A",198,0)
 . S PRCPMSG(4)="Inventory Point: "_$P(^TMP($J,"PRCPSSR1",STA,INV),U,4)_" "_$P(^TMP($J,"PRCPSSR1",STA,INV),U,5)
"RTN","PRCPLO2A",199,0)
 . S PRCPMSG(5)="File #446.7 Field Set Attempted: "_PRCPDR
"RTN","PRCPLO2A",200,0)
 . D MAIL^PRCPLO3 Q
"RTN","PRCPLO2A",201,0)
 ;
"RTN","PRCPLO2A",202,0)
 S DIE="^PRCP(446.7,",DA=PRCPDA D ^DIE K DIE,DR,DA
"RTN","PRCPLO2A",203,0)
 ;
"RTN","PRCPLO2A",204,0)
 Q
"VER")
8.0^22.0
"^DD",420.14,420.14,.01,0)
FUND^RFX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>6!($L(X)<3)!'(X'?1P.E) X
"^DD",420.14,420.14,.01,1,0)
^.1^^-1
"^DD",420.14,420.14,.01,1,1,0)
420.14^B
"^DD",420.14,420.14,.01,1,1,1)
S ^PRCD(420.14,"B",$E(X,1,30),DA)=""
"^DD",420.14,420.14,.01,1,1,2)
K ^PRCD(420.14,"B",$E(X,1,30),DA)
"^DD",420.14,420.14,.01,3)
Answer must be 3-6 characters in length.
"^DD",420.14,420.14,.01,7.5)
S PRCLKUP=1
"^DD",420.14,420.14,.01,21,0)
^^1^1^2941109^^^^
"^DD",420.14,420.14,.01,21,1,0)
This is fund in this file.
"^DD",420.14,420.14,.01,"DT")
3070910
"^DD",420.14,420.14,2,0)
BUDGET FISCAL YEAR BEGIN^RNJ4,0X^^0;3^K:+X'=X!(X>9999)!(X<1900)!(X?.E1"."1N.N) X
"^DD",420.14,420.14,2,1,0)
^.1^^0
"^DD",420.14,420.14,2,3)
Type a Number between 1900 and 9999, 0 Decimal Digits
"^DD",420.14,420.14,2,21,0)
^^1^1^2941109^
"^DD",420.14,420.14,2,21,1,0)
This is used to store BUDGET FISCAL YEAR BEGIN data.
"^DD",420.14,420.14,2,"DT")
3070910
"^DD",420.14,420.14,3,0)
BUDGET FISCAL YEAR END^RNJ4,0X^^0;4^K:+X'=X!(X>9999)!(X<1900)!(X?.E1"."1N.N) X
"^DD",420.14,420.14,3,1,0)
^.1^^0
"^DD",420.14,420.14,3,3)
Type a Number between 1900 and 9999, 0 Decimal Digits
"^DD",420.14,420.14,3,21,0)
^^1^1^2941109^
"^DD",420.14,420.14,3,21,1,0)
This is used to store BUDGET FISCAL YEAR END data.
"^DD",420.14,420.14,3,"DT")
3070910
"BLD",5311,6)
^100
**END**
**END**
